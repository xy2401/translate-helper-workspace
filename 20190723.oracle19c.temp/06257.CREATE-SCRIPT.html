<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>CREATE SCRIPT</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Backup and Recovery Reference">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Backup and Recovery Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-backup-and-recovery-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T19:31:58-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96242-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="CREATE-CATALOG.html" title="Previous" type="text/html">
      <link rel="next" href="CROSSCHECK.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery Reference">
    <meta name="dcterms.isVersionOf" content="RCMRF">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="CREATE-CATALOG.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="CROSSCHECK.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Backup and Recovery Reference</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="rman-commands-at-sign-to-quit.html" property="item" typeof="WebPage"><span property="name"> RMAN Commands: @ (at sign) to QUIT</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">CREATE SCRIPT</li>
            </ol>
            <a id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946" name="GUID-4741C1E1-C365-4597-BF2F-8679145B4946"></a><a id="RCMRF90121"></a><a id="RCMRF90122"></a><a id="RCMRF90123"></a><a id="RCMRF90124"></a><a id="RCMRF90125"></a><a id="RCMRF118"></a>
            
            <h2 id="RCMRF-GUID-4741C1E1-C365-4597-BF2F-8679145B4946" class="sect2"><span class="enumeration_section">2.13 </span>CREATE SCRIPT
            </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-7E1CE28F-2DF4-4FDE-8EFF-B0DC8B87617D">Purpose</p>
                  <p>Use the <code class="codeph">CREATE SCRIPT</code> command to create a stored script in the recovery catalog. A stored script is a sequence of RMAN commands that is given a name and stored in the recovery catalog for later execution.
                  </p>
                  <div class="infoboxnotealso" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-F80C9D71-C597-4462-AB68-C3CAC7B4A7A0">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../bradv/managing-recovery-catalog.html#BRADV182" target="_blank"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> to learn how to use stored scripts
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph"><a href="REPLACE-SCRIPT.html#GUID-2C86EDA9-63BE-4F21-9138-AF75597D5ADF">REPLACE SCRIPT</a></code> to learn how to update a stored script
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-7D5AD48C-516A-4901-96DA-0A2620644B47">Prerequisites</p>
                  <p>Execute <code class="codeph">CREATE SCRIPT</code> only at the RMAN prompt. RMAN must be connected to a target database and a recovery catalog. The recovery catalog database must be open.
                  </p>
                  <p>If <code class="codeph">GLOBAL</code> is specified, then a global script with this name must not already exist in the recovery catalog. If <code class="codeph">GLOBAL</code> is not specified, then a local script must not already exist with the same name for the same target database. In you do not meet these prerequisites, then RMAN returns error <code class="codeph">RMAN-20401</code>.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__CHDBJHHH">
                  <p class="subhead1" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-EE2EC5C3-6726-45C6-9C03-380844A028E3">Usage Notes</p>
                  <p><a id="d39531e143" class="indexterm-anchor"></a>A stored script may be local or global. A local script is created for the current target database only, whereas a global script is available for use with any database registered in the recovery catalog.
                  </p>
                  <p>It is permissible to create a global script with the same name as a local script, or a local script with the same name as a global script.</p>
                  <p><span class="bold">Substitution Variables in Stored Scripts</span></p>
                  <p><a id="d39531e152" class="indexterm-anchor"></a><a id="d39531e156" class="indexterm-anchor"></a><a id="d39531e160" class="indexterm-anchor"></a><a id="d39531e162" class="indexterm-anchor"></a>RMAN supports the use of substitution variables in a stored script. <code class="codeph">&amp;1</code> indicates where to place the first value, <code class="codeph">&amp;2</code> indicate where to place the second value, and so on. Special characters must be quoted.
                  </p>
                  <p>The substitution variable syntax is <code class="codeph">&amp;</code><span class="italic"><code class="codeph">integer</code></span> followed by an optional period, for example, <code class="codeph">&amp;1.3</code>. The optional period is part of the variable and replaced with the value, thus enabling the substitution text to be immediately followed by another integer. For example, if you pass the value <code class="codeph">mybackup</code> to a command file that contains the substitution variable <code class="codeph">&amp;1.3</code>, then the result of the substitution is <code class="codeph">mybackup3</code>. To create the result <code class="codeph">mybackup.3</code>, use two periods in the syntax <code class="codeph">&amp;1..3</code>.
                  </p>
                  <p>When you create a stored script with substitution variables, you must provide example values at create time. You can provide these values with the <code class="codeph">USING</code> clause when starting RMAN (see <code class="codeph"><a href="RMAN.html#GUID-E5514ACB-59F6-4DB0-B4DB-64DF4C87CDE7">RMAN</a></code>) or enter them when prompted (see <a href="CREATE-SCRIPT.html#GUID-4741C1E1-C365-4597-BF2F-8679145B4946__CHDBBABA">Example 2-74</a>).
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-CAB25E5E-6891-499B-9438-0F75A80D0F26">Syntax</p>
                  <p><span class="bold"><span class="italic">createScript</span>::=</span></p>
                  <div class="figure" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-137B88F2-81A6-44B3-9469-FE7B9B2E60BF"><img src="img/createscript.gif" alt="Description of createscript.eps follows" title="Description of createscript.eps follows" longdesc="img_text/createscript.html"><br><a href="img_text/createscript.html">Description of the illustration createscript.eps</a></div>
                  <!-- class="figure" -->
                  <p><span class="italic"><a href="RUN.html#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B__CHDIDAJB">backupCommands::=</a></span>, <span class="italic"><a href="RUN.html#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B__CHDHAGID">maintenanceCommands::=</a></span>, <span class="italic"><a href="RUN.html#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B__CHDJFJFH">miscellaneousCommands::=</a></span>, <span class="italic"><a href="RUN.html#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B__CHDIFJGG">restoreCommands::=</a></span>)
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-DDE27E84-17F0-4873-A999-E2626088BDA6">Semantics</p>
                  <div class="tblformalwide" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-C30BB26E-F2E4-4A51-BBB8-39ACF3435EB0">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" summary="Describes CREATE SCRIPT command parameters" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d39531e249">Syntax Element</th>
                              <th align="left" valign="bottom" width="71%" id="d39531e252">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d39531e257" headers="d39531e249 ">
                                 <p><code class="codeph">CREATE OR REPLACE</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d39531e257 d39531e252 ">
                                 <p></p>
                                 <p>Creates a new script, if a script with the specified name does not exist. If a script with the specified name already exists, it is recreated.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d39531e266" headers="d39531e249 ">
                                 <p><code class="codeph">GLOBAL</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d39531e266 d39531e252 ">
                                 <p>Identifies the script as global.</p>
                                 <p><span class="bold">Note:</span> A virtual private catalog has read-only access to global scripts. Creating or updating global scripts must be done while connected to the base recovery catalog.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d39531e278" headers="d39531e249 ">
                                 <p><code class="codeph">SCRIPT </code><span class="italic"><code class="codeph">script_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d39531e278 d39531e252 ">
                                 <p>Specifies the name of the script. Quotes must be used around the script name when the name contains either spaces or reserved words.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d39531e289" headers="d39531e249 ">
                                 <p><code class="codeph">&nbsp;&nbsp;&nbsp;COMMENT</code><code class="codeph"> '</code><span class="italic"><code class="codeph">comment</code></span><code class="codeph">'</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d39531e289 d39531e252 ">
                                 <p>Associates an explanatory comment with the stored script in the recovery catalog. The comment is used in the output of <code class="codeph"><a href="LIST.html#GUID-2BAB704C-A3C9-4F76-8D96-4BD961FBEF2E">LIST</a></code> <code class="codeph">SCRIPT NAMES</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d39531e312" headers="d39531e249 ">
                                 <p><span class="italic"><code class="codeph">backupCommands</code></span></p>
                                 <p><span class="italic"><code class="codeph">maintenanceCommands</code></span></p>
                                 <p><span class="italic"><code class="codeph">miscellaneousCommands</code></span></p>
                                 <p><span class="italic"><code class="codeph">restoreCommands</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d39531e312 d39531e252 ">
                                 <p>Specifies commands to include in the stored script. The commands allowable within the brackets of the <code class="codeph">CREATE SCRIPT</code> <code class="codeph">'</code><span class="italic"><code class="codeph">script_name</code></span><code class="codeph">'</code> <code class="codeph">{</code><code class="codeph">...</code><code class="codeph">}</code> command are the same commands supported within a <code class="codeph"><a href="RUN.html#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B">RUN</a></code> command. Any command that is valid within a <code class="codeph">RUN</code> command is permitted in the stored script. The following commands are not valid within stored scripts: <code class="codeph"><a href="RUN.html#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B">RUN</a></code>, <code class="codeph"><a href="at-sign.html#GUID-7A3919FE-140B-4F50-BA2F-3CEE3285E771">@ (at sign)</a></code>, and <code class="codeph"><a href="double-at-sign.html#GUID-E2B8B99B-73CB-4D4E-8065-0B9F44AF8A52">@@ (double at sign)</a></code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d39531e375" headers="d39531e249 ">
                                 <p><code class="codeph">FROM&nbsp;FILE '</code><span class="italic"><code class="codeph">filename</code></span><code class="codeph">'</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d39531e375 d39531e252 ">
                                 <p>Reads the sequence of commands to define the script from the specified file.</p>
                                 <p>The file looks like the body of a valid stored script. The first line of the file must be a left brace (<code class="codeph">{</code>) and the last line must contain a right brace (<code class="codeph">}</code>). The RMAN commands in the file must be valid in a stored script.
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-2273A389-3036-417F-9BE6-3B323619421A">Examples</p>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__GUID-7478E03D-5943-4397-B276-6E03DE9F586B">
                  <p class="titleinexample">Example 2-72 Creating a Local Stored Script</p>
                  <p>Assume that you want to create a local stored script for backing up database <code class="codeph">prod</code>. You start RMAN, connect to <code class="codeph">prod</code> as <code class="codeph">TARGET</code>, and connect to a recovery catalog. You create a stored script called <code class="codeph">backup_whole</code> and then use <code class="codeph"><a href="EXECUTE-SCRIPT.html#GUID-553B5C55-0BA6-4B47-86A9-0BCF839CCE04">EXECUTE SCRIPT</a></code> to run it as follows:
                  </p><pre class="oac_no_warn" dir="ltr">CREATE SCRIPT backup_whole 
COMMENT "backup whole database and archived redo log files"
{
    BACKUP 
      INCREMENTAL LEVEL 0 TAG backup_whole
      FORMAT "/disk2/backup/%U"
      DATABASE PLUS ARCHIVELOG;
}
RUN { EXECUTE SCRIPT backup_whole; }</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__CHDFABFG">
                  <p class="titleinexample">Example 2-73 Creating a Global Stored Script</p>
                  <p>This example connects RMAN to target database <code class="codeph">prod</code> and recovery catalog database <code class="codeph">catdb</code> as catalog user <code class="codeph">rco</code>. The example creates a global script called <code class="codeph">global_backup_db</code> that backs up the database and archived redo log files:
                  </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET "sbu@prod AS SYSBACKUP"

target database Password: <span class="italic">password</span>
connected to target database: PROD (DBID=39525561)

RMAN&gt; CONNECT CATALOG rco@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; CREATE GLOBAL SCRIPT global_backup_db { BACKUP DATABASE PLUS ARCHIVELOG; }
RMAN&gt; EXIT;
</pre><p>You can now connect RMAN to a different target database such as <code class="codeph">prod2</code> and run the global stored script:
                  </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET "sbu@prod2 AS SYSBACKUP"

target database Password: <span class="italic">password</span>
connected to target database: PROD2 (DBID=36508508)

RMAN&gt; CONNECT CATALOG rco@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; RUN { EXECUTE SCRIPT global_backup_db; }</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4741C1E1-C365-4597-BF2F-8679145B4946__CHDBBABA">
                  <p class="titleinexample">Example 2-74 Creating a Stored Script That Uses Substitution Variables</p>
                  <p>The following example connects RMAN to a target database and recovery catalog and uses <code class="codeph"><a href="CREATE-SCRIPT.html#GUID-4741C1E1-C365-4597-BF2F-8679145B4946">CREATE SCRIPT</a></code> to create a backup script that includes three substitution variables. RMAN prompts you to enter initial values for the variables (user input is shown in bold).
                  </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET /
RMAN&gt; CONNECT CATALOG rco@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; CREATE SCRIPT backup_df 
2&gt; { BACKUP DATAFILE &amp;1 TAG &amp;2.1 FORMAT '/disk1/&amp;3_%U'; }
 Enter value for 1: <span class="bold">1</span>
 
Enter value for 2: <span class="bold">df1_backup</span>
 
Enter value for 3: <span class="bold">df1</span>

starting full resync of recovery catalog
full resync complete
created script backup_df
 </pre><p>When you run <code class="codeph"><a href="EXECUTE-SCRIPT.html#GUID-553B5C55-0BA6-4B47-86A9-0BCF839CCE04">EXECUTE SCRIPT</a></code>, you can pass different values to the script. The following example passes the values <code class="codeph">3</code>, <code class="codeph">test_backup</code>, and <code class="codeph">test</code> to the substitution variables in the stored script:
                  </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; RUN { EXECUTE SCRIPT backup_df USING 3 test_backup df3; }
</pre><p>After the values are substituted, the script executes as follows:</p><pre class="oac_no_warn" dir="ltr">BACKUP DATAFILE 3 TAG test_backup1 FORMAT '/disk1/df3_%U';</pre></div>
               <!-- class="example" -->
            </div>
         </div>
      </article>
   </body>
</html>