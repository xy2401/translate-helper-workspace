<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="An explanation is given of how to use the Oracle XML Developer's Kit (XDK) XQuery processor for Java.">
      <meta name="description" content="An explanation is given of how to use the Oracle XML Developer's Kit (XDK) XQuery processor for Java.">
      <title>Using the XQuery Processor for Java</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content="An explanation is given of how to use the Oracle XML Developer's Kit (XDK) XQuery processor for Java.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="xml-developers-kit-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T05:58:48-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96292-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-XSLT-processor-for-Java.html" title="Previous" type="text/html">
      <link rel="next" href="using-xquery-API-for-Java-to-access-XML-DB.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML Developers Kit Programmers Guide">
    <meta name="dcterms.isVersionOf" content="ADXDK">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-XSLT-processor-for-Java.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-xquery-API-for-Java-to-access-XML-DB.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XDK-for-Java.html" property="item" typeof="WebPage"><span property="name">Oracle XML Developer's Kit for Java</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Using the XQuery Processor for Java</li>
            </ol>
            <a id="GUID-9E6570F0-37BB-4690-BFF6-A2052B5B57E8" name="GUID-9E6570F0-37BB-4690-BFF6-A2052B5B57E8"></a><a id="ADXDK991"></a><a id="ADXDK99930"></a>
            
            <h2 id="ADXDK-GUID-9E6570F0-37BB-4690-BFF6-A2052B5B57E8" class="sect2"><span class="enumeration_chapter">15 </span>Using the XQuery Processor for Java
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>An explanation is given of how to use the Oracle XML Developer's Kit (XDK) XQuery processor for Java.</p>
               <div class="section"> </div>
               <!-- class="section" -->
            </div><a id="ADXDK114"></a><a id="ADXDK99995"></a><div class="props_rev_3"><a id="GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA" name="GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA"></a><h3 id="ADXDK-GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA" class="sect3">Introduction to the XQuery Processor for Java</h3>
               <div>
                  <p>XDK provides a standalone XQuery processor for use by Java applications. XQuery is the World Wide Web Consortium (W3C) standard query language for Extensible Markup Language (XML). Using XQuery to process XML within a Java application can improve developer productivity and application performance. </p>
                  <p>Applications written with XQuery often require less code, run faster, and use less memory than applications written fully in Java.</p>
                  <p>JSR 225: XQuery API for Java (XQJ) defines how queries can be executed from a Java application. To use XQJ, your application must run with Java version 1.6. In addition, these JAR files are required:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">jlib/oxquery.jar</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">jlib/xqjapi.jar</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">jlib/orai18n-mapping.jar</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">lib/xmlparserv2.jar</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">xdk/jlib/apache-xmlbeans.jar</code></p>
                     </li>
                  </ul>
                  <p>The directory paths for these Java Archive (JAR) files are relative to the <code class="codeph">ORACLE_HOME</code> directory of your Oracle Database installation. 
                  </p>
                  <p><a href="using-xquery-processor-for-Java.html#GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA__BAJCCHIC">Example 15-1</a> shows how to execute a simple "Hello World" query using XQuery API for Java (XQJ). Because the XQuery processor runs directly in the Java Virtual Machine (JVM), you need no database or server to run this example. The example prints the output <code class="codeph">&lt;hello-world&gt;2&lt;/hello-world&gt;</code>.
                  </p>
                  <p>This chapter describes the features and extensions that are specific to the Oracle implementation of XQuery. General information about XQuery and XQJ is documented outside of this document.</p>
                  <div class="infoboxnotealso" id="GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA__GUID-77A75716-1BC7-4010-9469-D56F11AA3588">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>, <code class="codeph">XQuery Packages</code>, for the related API documentation
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=jcp_org_jsr225" target="_blank"><span class="italic">JSR-000225 XQuery API for Java</span></a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquery_30" target="_blank"><span class="italic">XQuery 3.0: An XML Query Language</span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="infoboxnote" id="GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA__GUID-B3707335-F147-4DA1-9F43-DFB701A6152C">
                     <p class="notep1">Note:</p>
                     <p>Oracle also implements XQuery and XQJ as part of Oracle XML DB. See <a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-DDFFD115-A115-4B6C-805C-350AF78281EB" title="An explanation is given of how to use the XQuery API for Java (XQJ) to access Oracle XML DB.">Using XQuery API for Java to Access Oracle XML DB</a> for details about Oracle XML DB.
                     </p>
                  </div>
                  <div class="example" id="GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA__BAJCCHIC">
                     <p class="titleinexample">Example 15-1 Simple Query Using XQJ</p><pre class="oac_no_warn" dir="ltr">import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQSequence;
 
import oracle.xml.xquery.OXQDataSource;
 
public class HelloWorld {
    
    public static void main(String[] args) throws XQException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
        String query = "&lt;hello-world&gt;{1 + 1}&lt;/hello-world&gt;";
        XQPreparedExpression expr = con.prepareExpression(query);
        XQSequence result = expr.executeQuery();

        // prints "<code class="codeph">&lt;hello-world&gt;2&lt;/hello-world&gt;</code>"
        System.out.println(result.getSequenceAsString(null));
        
        result.close();
        expr.close();
        con.close();
    }
    
}
</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK115"></a><div class="props_rev_3"><a id="GUID-5E83610F-647D-4AE5-801B-878244FB6949" name="GUID-5E83610F-647D-4AE5-801B-878244FB6949"></a><h3 id="ADXDK-GUID-5E83610F-647D-4AE5-801B-878244FB6949" class="sect3">XQJ Entity Resolution</h3>
               <div>
                  <p>XDK extends XQJ with an entity resolver framework for controlling how documents, schemas, modules, collations, and external functions are obtained during query processing. The examples in this section show how to use an entity resolver for several types of entities.</p>
                  <p>See the class <code class="codeph">oracle.xml.xquery.OXQEntity</code> in <a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a> for a complete list of the types of entities that the query processor can request.
                  </p>
               </div><a id="ADXDK116"></a><a id="ADXDK117"></a><a id="ADXDK118"></a><a id="ADXDK112"></a><div class="props_rev_3"><a id="GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2" name="GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2"></a><h4 id="ADXDK-GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2" class="sect4">Resolution of Documents for fn:doc</h4>
                  <div>
                     <p>The example in this section shows how you can use an entity resolver to determine which document is returned by XQuery function <code class="codeph">fn:doc</code>.
                     </p>
                     <div class="section">
                        <p><a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJEEDAJ">Example 15-2</a> displays the contents of <code class="codeph">books.xml</code>.
                        </p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFFCBB">Example 15-3</a> displays the contents of <code class="codeph">books.xq</code>.
                        </p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFDEDF">Example 15-4</a> shows how to execute the query <code class="codeph">books.xq</code> with a custom entity resolver.
                        </p>
                        <p>The instance of <code class="codeph">MyEntityResolver</code> is passed to the XQuery processor by setting it on the connection. The XQuery processor invokes the entity resolver during query processing to get the document to be returned by the <code class="codeph">fn:doc</code> function.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJEEDAJ">
                        <p class="titleinexample">Example 15-2 books.xml</p><pre class="oac_no_warn" dir="ltr">&lt;books&gt;
  &lt;book&gt;
    &lt;title&gt;A Game of Thrones&lt;/title&gt;
    &lt;author&gt;&lt;first&gt;George&lt;/first&gt;&lt;last&gt;Martin&lt;/last&gt;&lt;/author&gt;
    &lt;price&gt;10.99&lt;/price&gt;
  &lt;/book&gt;
  &lt;book&gt;
    &lt;title&gt;The Pillars of the Earth&lt;/title&gt;
    &lt;author&gt;&lt;first&gt;Ken&lt;/first&gt;&lt;last&gt;Follett&lt;/last&gt;&lt;/author&gt;
    &lt;price&gt;7.99&lt;/price&gt;
  &lt;/book&gt;
&lt;/books&gt;
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFFCBB">
                        <p class="titleinexample">Example 15-3 books.xq</p><pre class="oac_no_warn" dir="ltr">for $book in fn:doc('books.xml')/books/book 
where xs:decimal($book/price) gt 10.00
return
  $book/title
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFDEDF">
                        <p class="titleinexample">Example 15-4 Executing a Query with a Custom Entity Resolver</p><pre class="oac_no_warn" dir="ltr">import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.URI;
 
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQSequence;
import javax.xml.xquery.XQStaticContext;
 
import oracle.xml.xquery.OXQConnection;
import oracle.xml.xquery.OXQDataSource;
import oracle.xml.xquery.OXQEntity;
import oracle.xml.xquery.OXQEntityKind;
import oracle.xml.xquery.OXQEntityLocator;
import oracle.xml.xquery.OXQEntityResolver;
import oracle.xml.xquery.OXQEntityResolverRequestOptions;
import oracle.xml.xquery.OXQView;

public class ResolveDocument {
 
    private static class MyEntityResolver extends OXQEntityResolver {
        @Override
        public OXQEntity resolveEntity(OXQEntityKind kind, OXQEntityLocator locator,
                OXQEntityResolverRequestOptions options) throws IOException {
            if (kind == OXQEntityKind.DOCUMENT) {
                URI systemId = locator.getSystemIdAsURI();
                if ("file".equals(systemId.getScheme())) {
                    File file = new File(systemId);
                    FileInputStream input = new FileInputStream(file);
                    OXQEntity result = new OXQEntity(input);
                    result.enlistCloseable(input);
                    return result;
                }
            }
            return null;
        }
    }
 
    public static void main(String[] args) throws XQException, IOException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
 
        // OXQView is used to access Oracle extensions on XQJ objects.
        OXQConnection ocon = OXQView.getConnection(con);
        ocon.setEntityResolver(new MyEntityResolver());
 
        File query = new File("books.xq");
        
        // Relative URIs are resolved against the base URI before invoking the entity resolver.
        // The relative URI 'books.xml' used in the query will be resolved against this URI.
        XQStaticContext ctx = con.getStaticContext();
        ctx.setBaseURI(query.toURI().toString());
 
        FileInputStream queryInput = new FileInputStream(query);
        XQPreparedExpression expr = con.prepareExpression(queryInput, ctx);
        queryInput.close();
        XQSequence result = expr.executeQuery();

        // Prints "<code class="codeph">&lt;title&gt;A Game of Thrones&lt;/title&gt;</code>"
        System.out.println(result.getSequenceAsString(null));
        
        result.close();
        expr.close();
        con.close();
    }
}
</pre><p>The example generates this output:</p><pre class="oac_no_warn" dir="ltr">&lt;title&gt;A Game of Thrones&lt;/title&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK188"></a><a id="ADXDK189"></a><a id="ADXDK108"></a><a id="ADXDK187"></a><div class="props_rev_3"><a id="GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF" name="GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF"></a><h4 id="ADXDK-GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF" class="sect4">Resolution of External XQuery Functions</h4>
                  <div>
                     <p>You can use an entity resolver to define the implementation of an XQuery external function.</p>
                     <div class="section">
                        <p>For each external XQuery function that is declared in a query, the entity resolver is called with the entity kind <code class="codeph">oracle.xml.xquery.OXQEntityKind.EXTERNAL_FUNCTION</code>. The <code class="codeph">oracle.xml.xquery.OXQEntityLocator</code> instance that is passed in the call to the entity resolver provides the name of the XQuery function and its argument types. The entity resolver can then return any class that extends <code class="codeph">oracle.xml.xquery.OXQFunctionEvaluator</code> and has a public constructor. The XQuery processor then instantiates the returned class. When the XQuery external function call is evaluated, method <code class="codeph">evaluate()</code> is invoked.
                        </p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJIFHBB">Example 15-5</a> displays an XQuery query that is the content of file <code class="codeph">trim.xq</code>.
                        </p>
                        <p>External XQuery function <code class="codeph">util:trim</code> removes white space from the beginning and end of a string value. This function is implemented in Java and called within the query.
                        </p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJFAIFJ">Example 15-6</a> uses <code class="codeph">trim.xq</code> and shows how to define the implementation of an external XQuery function. The entity resolver in this example returns a class that extends <code class="codeph">OXQFunctionEvaluator</code>. 
                        </p>
                        <p>In some cases it is more convenient to return a Java static method instead of a class. When a static method is returned, the query processor automatically maps the method arguments and the return value to the XQuery data model, as defined by the XQJ specification.</p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJEJAGB">Example 15-7</a> also runs <code class="codeph">trim.xq</code>, but in this case the external function is bound to a Java static method.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJIFHBB">
                        <p class="titleinexample">Example 15-5 trim.xq</p><pre class="oac_no_warn" dir="ltr">declare namespace util = "http://example.com/util";
 
declare function util:trim($arg as xs:string) as xs:string external;
 
(: a string with surrounding white space :)
declare variable $input := "   John Doe    ";
 
&lt;result&gt;{util:trim($input)}&lt;/result&gt;
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJFAIFJ">
                        <p class="titleinexample">Example 15-6 Defining the Implementation of an External XQuery Function</p><pre class="oac_no_warn" dir="ltr">import java.io.FileInputStream;
import java.io.IOException;
import java.util.Collections;
 
import javax.xml.namespace.QName;
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQSequence;
 
import oracle.xml.xquery.OXQConnection;
import oracle.xml.xquery.OXQDataSource;
import oracle.xml.xquery.OXQEntity;
import oracle.xml.xquery.OXQEntityKind;
import oracle.xml.xquery.OXQEntityLocator;
import oracle.xml.xquery.OXQEntityResolver;
import oracle.xml.xquery.OXQEntityResolverRequestOptions;
import oracle.xml.xquery.OXQFunctionContext;
import oracle.xml.xquery.OXQFunctionEvaluator;
import oracle.xml.xquery.OXQFunctionMetaData;
import oracle.xml.xquery.OXQView;

public class ResolveExternalFunction {
 
    public static class TrimFunction extends OXQFunctionEvaluator {
        @Override
        public XQSequence evaluate(OXQFunctionContext context, XQSequence[] params) throws XQException {
            XQConnection con = context.getConnection();
            XQSequence arg = params[0];
            String value = arg.getSequenceAsString(null);
            String trimmed = value.trim();
            return con.createSequence(Collections.singleton(trimmed).iterator());
        }
    }
    
    private static class MyEntityResolver extends OXQEntityResolver {
        @Override
        public OXQEntity resolveEntity(OXQEntityKind kind, OXQEntityLocator locator,
                OXQEntityResolverRequestOptions options) throws XQException, IOException {
            if (kind == OXQEntityKind.EXTERNAL_FUNCTION) {
                OXQFunctionMetaData metaData = (OXQFunctionMetaData)locator.getExtension();
                QName name = metaData.getName();
                int arity = metaData.getParameterTypes().length;
                if ("http://example.com/util".equals(name.getNamespaceURI()) &amp;&amp;
                    "trim".equals(name.getLocalPart()) &amp;&amp; arity == 1) {
                    return new OXQEntity(TrimFunction.class);
                }
            }
            return null;
        }
    }

    public static void main(String[] args) throws IOException, XQException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
        OXQConnection ocon = OXQView.getConnection(con);
        ocon.setEntityResolver(new MyEntityResolver());
 
        FileInputStream query = new FileInputStream("trim.xq");
        XQPreparedExpression expr = con.prepareExpression(query);
        query.close();

        XQSequence result = expr.executeQuery();

        System.out.println(result.getSequenceAsString(null));
 
        result.close();
        expr.close();
        con.close();
    }
}
</pre><p>The example prints this output:<code class="codeph"> &lt;result&gt;John Doe&lt;/result&gt;</code>.
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJEJAGB">
                        <p class="titleinexample">Example 15-7 Binding an External Function to a Java Static Method</p><pre class="oac_no_warn" dir="ltr">import java.io.FileInputStream;
import java.io.IOException;
import java.lang.reflect.Method;
 
import javax.xml.namespace.QName;
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQSequence;
 
import oracle.xml.xquery.OXQConnection;
import oracle.xml.xquery.OXQDataSource;
import oracle.xml.xquery.OXQEntity;
import oracle.xml.xquery.OXQEntityKind;
import oracle.xml.xquery.OXQEntityLocator;
import oracle.xml.xquery.OXQEntityResolver;
import oracle.xml.xquery.OXQEntityResolverRequestOptions;
import oracle.xml.xquery.OXQFunctionMetaData;
import oracle.xml.xquery.OXQView;

public class ResolveExternalFunction2 {
 
    public static String trim(String value) {
        return value.trim();
    }
    
    private static class MyEntityResolver extends OXQEntityResolver {
        @Override
        public OXQEntity resolveEntity(OXQEntityKind kind, OXQEntityLocator locator,
                OXQEntityResolverRequestOptions options) throws XQException, IOException {
            if (kind == OXQEntityKind.EXTERNAL_FUNCTION) {
                OXQFunctionMetaData metaData = (OXQFunctionMetaData)locator.getExtension();
                QName name = metaData.getName();
                int arity = metaData.getParameterTypes().length;
                if ("http://example.com/util".equals(name.getNamespaceURI()) &amp;&amp;
                    "trim".equals(name.getLocalPart()) &amp;&amp; arity == 1) {
                    Method staticMethod = null;
                    try {
                        staticMethod = ResolveExternalFunction2.class.getMethod("trim", String.class); 
                    } catch (NoSuchMethodException e) {
                        throw new IllegalStateException(e);
                    }
                    return new OXQEntity(staticMethod);
                }
            }
            return null;
        }
    }

    public static void main(String[] args) throws IOException, XQException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
        OXQConnection ocon = OXQView.getConnection(con);
        ocon.setEntityResolver(new MyEntityResolver());
 
        FileInputStream query = new FileInputStream("trim.xq");
        XQPreparedExpression expr = con.prepareExpression(query);
        query.close();
 
        XQSequence result = expr.executeQuery();

        // Prints "&lt;result&gt;John Doe&lt;/result&gt;"
        System.out.println(result.getSequenceAsString(null));
 
        result.close();
        expr.close();
        con.close();
    }
}
</pre><p>The example prints the same output as for <a href="using-xquery-processor-for-Java.html#GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJFAIFJ">Example 15-6</a>:<code class="codeph"> &lt;result&gt;John Doe&lt;/result&gt;</code>.
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK110"></a><a id="ADXDK111"></a><a id="ADXDK113"></a><a id="ADXDK109"></a><div class="props_rev_3"><a id="GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0" name="GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0"></a><h4 id="ADXDK-GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0" class="sect4">Resolution of Imported XQuery Modules</h4>
                  <div>
                     <p>The entity resolver can locate the XQuery modules imported by an XQuery library module.</p>
                     <p>An XQuery library module provides functions and variables that can be imported by other modules. For each imported module, the entity resolver is called with the entity kind <code class="codeph">oracle.xml.xquery.OXQEntityKind.MODULE</code>. Using the <code class="codeph">oracle.xml.xquery.OXQEntityLocator</code> instance, you can invoke the <code class="codeph">getSystemId()</code> method to get the location of the module being imported. If no location is provided in the module import, you can invoke the method <code class="codeph">getNamespace()</code> to get the target namespace of the module. The entity resolver can then return the corresponding library module.
                     </p>
                     <p>The example in this section shows how you can use an entity resolver to control the resolution of XQuery library modules.</p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJHBFFI">Example 15-8</a> displays the contents of <code class="codeph">math.xq</code>.
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJDCFCE">Example 15-9</a> displays the contents of <code class="codeph">main.xq</code>.
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJDGAIF">Example 15-10</a> shows how to execute a query that imports a library module.
                     </p>
                     <p>The query <code class="codeph">main.xq</code> imports the library module <code class="codeph">math.xq</code>, and then invokes the function <code class="codeph">math:circumference</code> to compute the circumference of a circle.
                     </p>
                     <div class="example" id="GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJHBFFI">
                        <p class="titleinexample">Example 15-8 math.xq</p><pre class="oac_no_warn" dir="ltr">module namespace math = "http://example.com/math";
 
declare variable $math:pi as xs:decimal := 3.14159265;
 
declare function math:circumference($diameter as xs:decimal) {
   $math:pi * $diameter
};
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJDCFCE">
                        <p class="titleinexample">Example 15-9 main.xq</p><pre class="oac_no_warn" dir="ltr">import module namespace math = "http://example.com/math" at "math.xq";
 
math:circumference(6.54)
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJDGAIF">
                        <p class="titleinexample">Example 15-10 Executing a Query that Imports a Library Module</p><pre class="oac_no_warn" dir="ltr">import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.URI;
 
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQSequence;
import javax.xml.xquery.XQStaticContext;
 
import oracle.xml.xquery.OXQConnection;
import oracle.xml.xquery.OXQDataSource;
import oracle.xml.xquery.OXQEntity;
import oracle.xml.xquery.OXQEntityKind;
import oracle.xml.xquery.OXQEntityLocator;
import oracle.xml.xquery.OXQEntityResolver;
import oracle.xml.xquery.OXQEntityResolverRequestOptions;
import oracle.xml.xquery.OXQView;

public class ResolveLibraryModule {
 
    private static class MyEntityResolver extends OXQEntityResolver {
        @Override
        public OXQEntity resolveEntity(OXQEntityKind kind, OXQEntityLocator locator,
                OXQEntityResolverRequestOptions options) throws IOException {
            if (kind == OXQEntityKind.MODULE) {
                URI systemId = locator.getSystemIdAsURI();
                if (systemId != null &amp;&amp; "file".equals(systemId.getScheme())) {
                    File file = new File(systemId);
                    FileInputStream input = new FileInputStream(file);
                    OXQEntity result = new OXQEntity(input);
                    result.enlistCloseable(input);
                    return result;
                }
            }
            return null;
        }
    }

    public static void main(String[] args) throws XQException, IOException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
 
        // OXQView is used to access Oracle extensions on XQJ objects.
        OXQConnection ocon = OXQView.getConnection(con);
        ocon.setEntityResolver(new MyEntityResolver());
 
        File query = new File("main.xq");
        
        // Relative URIs are resolved against the base URI before invoking the entity resolver.
        // The relative URI 'math.xq' used in the query will be resolved against this URI.
        XQStaticContext ctx = con.getStaticContext();
        ctx.setBaseURI(query.toURI().toString());
        
        FileInputStream queryInput = new FileInputStream(query);
        XQPreparedExpression expr = con.prepareExpression(queryInput, ctx);
        queryInput.close();

        XQSequence result = expr.executeQuery();

        // Prints the result: "20.546015931"
        System.out.println(result.getSequenceAsString(null));
        
        result.close();
        expr.close();
        con.close();
    }
}
</pre><p>The example generates this output:</p><pre class="oac_no_warn" dir="ltr">20.546015931</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK102"></a><a id="ADXDK103"></a><a id="ADXDK104"></a><a id="ADXDK101"></a><div class="props_rev_3"><a id="GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935" name="GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935"></a><h4 id="ADXDK-GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935" class="sect4">Resolution of XML Schemas Imported by an XQuery Query</h4>
                  <div>
                     <p>You can use an entity resolver to control which XML schema is imported by an XQuery query.</p>
                     <p>An XQuery schema import imports type definitions and declarations of elements and attributes from an XML schema. You can use imported declarations and definitions in a query to validate and test data instances.</p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJBFCBH">Example 15-11</a> displays the contents of XML schema file <code class="codeph">size.xsd</code>.
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJIDADH">Example 15-12</a> displays the contents of XQuery file <code class="codeph">size.xq</code>.
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJBEEGC">Example 15-13</a> shows how to execute a query that imports a schema. 
                     </p>
                     <p><code class="codeph">size.xq</code> uses the type <code class="codeph">shirt-size</code> defined in <code class="codeph">size.xsd</code> to test a list of values.
                     </p>
                     <div class="example" id="GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJBFCBH">
                        <p class="titleinexample">Example 15-11 size.xsd</p><pre class="oac_no_warn" dir="ltr">&lt;xs:schema 
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  targetNamespace="http://example.com/size"&gt;
 
  &lt;xs:simpleType name="shirt-size"&gt;
    &lt;xs:restriction base="xs:string"&gt;
      &lt;xs:enumeration value="XS"/&gt;
      &lt;xs:enumeration value="S"/&gt;
      &lt;xs:enumeration value="M"/&gt;
      &lt;xs:enumeration value="L"/&gt;
      &lt;xs:enumeration value="XL"/&gt;
    &lt;/xs:restriction&gt;
  &lt;/xs:simpleType&gt;
 
&lt;/xs:schema&gt;
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJIDADH">
                        <p class="titleinexample">Example 15-12 size.xq</p><pre class="oac_no_warn" dir="ltr">import schema namespace ns = "http://example.com/size" at "size.xsd";
 
for $size in ("S", "big", "XL", 42)
return
  if ($size castable as ns:shirt-size) then
    ns:shirt-size($size)
  else
    concat("INVALID:", $size)
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJBEEGC">
                        <p class="titleinexample">Example 15-13 Executing an XQuery Query that Imports an XML Schema</p><pre class="oac_no_warn" dir="ltr">import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.URI;
 
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQSequence;
import javax.xml.xquery.XQStaticContext;
 
import oracle.xml.xquery.OXQConnection;
import oracle.xml.xquery.OXQDataSource;
import oracle.xml.xquery.OXQEntity;
import oracle.xml.xquery.OXQEntityKind;
import oracle.xml.xquery.OXQEntityLocator;
import oracle.xml.xquery.OXQEntityResolver;
import oracle.xml.xquery.OXQEntityResolverRequestOptions;
import oracle.xml.xquery.OXQView;

public class ResolveSchema {
 
    private static class MyEntityResolver extends OXQEntityResolver {
        @Override
        public OXQEntity resolveEntity(OXQEntityKind kind, OXQEntityLocator locator,
                OXQEntityResolverRequestOptions options) throws IOException {
            if (kind == OXQEntityKind.SCHEMA) {
                URI systemId = locator.getSystemIdAsURI();
                if (systemId != null &amp;&amp; "file".equals(systemId.getScheme())) {
                    File file = new File(systemId);
                    FileInputStream input = new FileInputStream(file);
                    OXQEntity result = new OXQEntity(input);
                    result.enlistCloseable(input);
                    return result;
                }
            }
            return null;
        }
    }
  
   public static void main(String[] args) throws XQException, IOException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
 
        // OXQView is used to access Oracle extensions on XQJ objects.
        OXQConnection ocon = OXQView.getConnection(con);
        ocon.setEntityResolver(new MyEntityResolver());
 
        File query = new File("size.xq");
        
        // Relative URIs are resolved against the base URI before invoking the entity resolver.
        // The relative URI 'math.xq' used in the query will be resolved against this URI.
        XQStaticContext ctx = con.getStaticContext();
        ctx.setBaseURI(query.toURI().toString());
        
        FileInputStream queryInput = new FileInputStream(query);
        XQPreparedExpression expr = con.prepareExpression(queryInput, ctx);
        queryInput.close();
        
        XQSequence result = expr.executeQuery();

        // Prints "S INVALID:big XL INVALID:42"
        System.out.println(result.getSequenceAsString(null));
        
        result.close();
        expr.close();
        con.close();
    }
}
</pre><p>The example prints this output: <code class="codeph">S INVALID:big XL INVALID:42</code>.
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK107"></a><a id="ADXDK106"></a><div class="props_rev_3"><a id="GUID-93E92988-81E7-4591-9F18-631525C86F1B" name="GUID-93E92988-81E7-4591-9F18-631525C86F1B"></a><h4 id="ADXDK-GUID-93E92988-81E7-4591-9F18-631525C86F1B" class="sect4">Prefabricated Entity Resolvers for XQuery</h4>
                  <div>
                     <p>XDK includes several implementations of <code class="codeph">OXQEntityResolver</code> that you can use for common tasks such as file system and HTTP resolution. This can sometimes save you needing to implement your own entity resolver.
                     </p>
                     <div class="section">
                        <p><a href="using-xquery-processor-for-Java.html#GUID-93E92988-81E7-4591-9F18-631525C86F1B__BAJBBBBH">Example 15-14</a> shows how you can run the query in <a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFFCBB">Example 15-3</a> using a prefabricated file resolver.
                        </p>
                        <p>An instance of the factory <code class="codeph">oracle.xml.xquery.OXQFileResolverFactory</code> is created from the connection. Then, this factory is used to create an entity resolver that resolves schemas, modules, and documents against the file system. By contrast with this example, <a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFDEDF">Example 15-4</a> uses the custom entity resolver <code class="codeph">MyEntityResolver</code> to resolve only documents against the file system.
                        </p>
                        <p>XDK provides these entity resolver factories:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">oracle.xml.xquery.OXQFileResolverFactory</code>: Creates an entity resolver that resolves 'file:' URIs for schema, module, and document locations.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.xml.xquery.OXQHttpResolverFactory</code>: Creates an entity resolver that resolves 'http:' URIs for schema, module, and document locations.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.xml.xquery.OXQCompositeResolverFactory</code>: Creates an entity resolver that delegates requests to other entity resolvers. For any kind of request, the resolver returns the first nonnull result it receives from one of the delegate resolvers.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.xml.xquery.OXQJavaResolverFactory</code>: Creates an entity resolver that resolves external functions and modules to Java static methods or classes.
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-93E92988-81E7-4591-9F18-631525C86F1B__GUID-37F46B28-93FE-4626-9687-3CE8D39A4AD7">
                           <p class="notep1">See Also:</p>
                           <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>, package <code class="codeph">oracle.xml.xquery</code>, for API information about these factory interfaces
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-93E92988-81E7-4591-9F18-631525C86F1B__BAJBBBBH">
                        <p class="titleinexample">Example 15-14 Executing a Query with a Prefabricated File Resolver</p><pre class="oac_no_warn" dir="ltr">import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
 
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQSequence;
import javax.xml.xquery.XQStaticContext;
 
import oracle.xml.xquery.OXQConnection;
import oracle.xml.xquery.OXQDataSource;
import oracle.xml.xquery.OXQFileResolverFactory;
import oracle.xml.xquery.OXQView;

public class ResolverFactory {
    public static void main(String[] args) throws XQException, IOException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
 
        // OXQView is used to access Oracle extensions on XQJ objects.
        OXQConnection ocon = OXQView.getConnection(con);
        OXQFileResolverFactory factory = ocon.createEntityResolverFactory(OXQFileResolverFactory.class);
        ocon.setEntityResolver(factory.createResolver());
 
        File query = new File("books.xq");
        
        // Relative URIs are resolved against the base URI before invoking the entity resolver.
        // The relative URI 'books.xml' used in the query will be resolved against this URI.
        XQStaticContext ctx = con.getStaticContext();
        ctx.setBaseURI(query.toURI().toString());
 
        FileInputStream queryInput = new FileInputStream(query);
        XQPreparedExpression expr = con.prepareExpression(queryInput, ctx);
        queryInput.close();
        
        XQSequence result = expr.executeQuery();

        // Prints "&lt;title&gt;A Game of Thrones&lt;/title&gt;"
        System.out.println(result.getSequenceAsString(null));
        
        result.close();
        expr.close();
        con.close();
    }
}
</pre><p>The example prints this output: <code class="codeph">&lt;title&gt;A Game of Thrones&lt;/title&gt;</code>.
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-05361BD0-575E-4021-A099-86AB7DF83A2B" name="GUID-05361BD0-575E-4021-A099-86AB7DF83A2B"></a><h4 id="ADXDK-GUID-05361BD0-575E-4021-A099-86AB7DF83A2B" class="sect4">Resolution of Other Types of Entity</h4>
                  <div>
                     <p>You can use the XQJ entity resolver to obtain other entities, besides documents, schemas, modules, and external functions.</p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-05361BD0-575E-4021-A099-86AB7DF83A2B__GUID-08201187-0EB8-4C60-9998-4DDCBB022AA6" title="Describes various types of entity.">Table 15-1</a> describes these other entities.
                     </p>
                     <div class="tblformal" id="GUID-05361BD0-575E-4021-A099-86AB7DF83A2B__GUID-08201187-0EB8-4C60-9998-4DDCBB022AA6">
                        <p class="titleintable">Table 15-1 Descriptions of Various Types of Entity</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Descriptions of Various Types of Entity" summary="Describes various types of entity." frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d53703e1158">OXQEntityKind</th>
                                 <th align="left" valign="bottom" width="20%" id="d53703e1160">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1164" headers="d53703e1158 "><code class="codeph">TEXT</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1164 d53703e1160 ">Result of <code class="codeph">fn:unparsed-text</code> and <code class="codeph">fn:unparsed-text-lines</code>.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1176" headers="d53703e1158 "><code class="codeph">ENVIRONMENT_VARIABLE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1176 d53703e1160 ">Result of <code class="codeph">fn:available-environment-variables</code> and <code class="codeph">fn:environment-variable</code>.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1188" headers="d53703e1158 "><code class="codeph">DOCUMENT_TYPE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1188 d53703e1160 ">Static type for function <code class="codeph">fn:doc</code>.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1197" headers="d53703e1158 "><code class="codeph">COLLECTION</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1197 d53703e1160 ">Documents returned by <code class="codeph">fn:collection</code>.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1206" headers="d53703e1158 "><code class="codeph">URI_COLLECTION</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1206 d53703e1160 ">URIs returned by <code class="codeph">fn:uri-collection</code>.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1215" headers="d53703e1158 "><code class="codeph">XML_PARSER_FACTORY</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1215 d53703e1160 ">StAX implementation used for parsing XML data.</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1221" headers="d53703e1158 "><code class="codeph">XML_ENTITY</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1221 d53703e1160 ">Used when a StAX parser needs to resolve an external XML resource.</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1227" headers="d53703e1158 "><code class="codeph">UPD_PUT</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1227 d53703e1160 ">Controls the behavior of <code class="codeph">fn:put</code>.
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1236" headers="d53703e1158 "><code class="codeph">COLLATION</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1236 d53703e1160 ">Controls the behavior of collation URIs.</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>For details on how these entity types are used, see class <code class="codeph">oracle.xml.xquery.OXQEntity</code> in <a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>.
                     </p>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535" name="GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535"></a><h3 id="ADXDK-GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535" class="sect3">XQuery Output Declarations</h3>
               <div>
                  <p>XQuery 3.0 defines output declarations, which you can use to set the values of serialization parameters from within a query.</p>
                  <p>An output declaration is an option declaration in namespace <code class="codeph">http://www.w3.org/2010/xslt-xquery-serialization</code>. You use it in a query to declare and set serialization parameters on the static context. 
                  </p>
                  <p>By default, these static context serialization parameters are ignored, but they can be accessed using XQJ methods <code class="codeph">OXQPreparedExpression#getExpressionStaticContext()</code> and <code class="codeph">OXQStaticContext#getSerializationParameters()</code>. 
                  </p>
                  <p><a href="using-xquery-processor-for-Java.html#GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__ACCESSINGTHEVALUESOFOPTIONDECLARATI-AB3FDA80">Example 15-15</a> shows how to access the values of option declarations.
                  </p>
                  <p>You can also use an option declaration when serializing the result of a query. <a href="using-xquery-processor-for-Java.html#GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__USINGOPTIONDECLARATIONSWHENSERIALIZ-AB3FD4F9">Example 15-16</a> is similar to <a href="using-xquery-processor-for-Java.html#GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__ACCESSINGTHEVALUESOFOPTIONDECLARATI-AB3FDA80">Example 15-15</a>, but it uses the static context serialization parameters when serializing the result of the query.
                  </p>
                  <div class="infoboxnote" id="GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__GUID-451D1906-2A81-45B0-9E55-4C838105C0C1">
                     <p class="notep1">Note:</p>The URI value of option <code class="codeph">output:parameter-document</code> is resolved to a document using entity resolver <code class="codeph">OXQEntityResolver</code> and entity kind <code class="codeph">OXQEntityKind#DOCUMENT</code>  see <a href="using-xquery-processor-for-Java.html#GUID-05361BD0-575E-4021-A099-86AB7DF83A2B" title="You can use the XQJ entity resolver to obtain other entities, besides documents, schemas, modules, and external functions.">Resolution of Other Types of Entity</a>.
                  </div>
                  <div class="example" id="GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__ACCESSINGTHEVALUESOFOPTIONDECLARATI-AB3FDA80">
                     <p class="titleinexample">Example 15-15 Accessing the Values of Option Declarations</p><pre class="pre codeblock"><code>import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQStaticContext;

import oracle.xml.xquery.OXQDataSource;
import oracle.xml.xquery.OXQPreparedExpression;
import oracle.xml.xquery.OXQSerializationParameters;
import oracle.xml.xquery.OXQStaticContext;
import oracle.xml.xquery.OXQView;

public class OptionDeclarations1 {
    
    public static void main(String[] args) throws XQException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
        String query = 
            "declare option output:indent 'yes'; \n" +
            "declare option output:encoding 'UTF-16'; \n" + 
            "&lt;person&gt;&lt;first&gt;John&lt;/first&gt;&lt;last&gt;Doe&lt;/last&gt;&lt;/person&gt;";
        
        XQPreparedExpression expr = con.prepareExpression(query); 

        OXQPreparedExpression oexpr = OXQView.getPreparedExpression(expr);
        XQStaticContext ctx = oexpr.getExpressionStaticContext();
        OXQStaticContext octx = OXQView.getStaticContext(ctx);
        OXQSerializationParameters params = octx.getSerializationParameters();
        
        System.out.println("indent=" + params.isIndent());
        System.out.println("encoding=" + params.getEncoding());
        
        expr.close();
        con.close();
    }
}</code></pre><p>This produces the following output: </p><pre class="pre codeblock"><code>  indent=true
  encoding=UTF-16</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__USINGOPTIONDECLARATIONSWHENSERIALIZ-AB3FD4F9">
                     <p class="titleinexample">Example 15-16 Using Option Declarations When Serializing a Query Result</p><pre class="pre codeblock"><code>package oracle.xml.xquery.examples.published;

import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQResultSequence;
import javax.xml.xquery.XQStaticContext;

import oracle.xml.xquery.OXQDataSource;
import oracle.xml.xquery.OXQPreparedExpression;
import oracle.xml.xquery.OXQSerializationParameters;
import oracle.xml.xquery.OXQStaticContext;
import oracle.xml.xquery.OXQView;

public class OptionDeclarations2 {

    public static void main(String[] args) throws XQException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
        String query = 
            "declare option output:indent 'yes'; \n" +
            "declare option output:omit-xml-declaration 'no'; \n" + 
            "&lt;person&gt;&lt;first&gt;John&lt;/first&gt;&lt;last&gt;Doe&lt;/last&gt;&lt;/person&gt;";
        
        XQPreparedExpression expr = con.prepareExpression(query); 

        OXQPreparedExpression oexpr = OXQView.getPreparedExpression(expr);
        XQStaticContext ctx = oexpr.getExpressionStaticContext();
        OXQStaticContext octx = OXQView.getStaticContext(ctx);
        OXQSerializationParameters params = octx.getSerializationParameters();
        
        XQResultSequence result = expr.executeQuery();
        result.writeSequence(System.out, params.createProperties());
        result.close();
        
        expr.close();
        con.close();
    }
}
</code></pre><p>This produces the following output:</p><pre class="pre codeblock"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;person&gt;
    &lt;first&gt;John&lt;/first&gt;
    &lt;last&gt;Doe&lt;/last&gt;
&lt;/person&gt;</code></pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK119"></a><div class="props_rev_3"><a id="GUID-2F04CC88-EDFF-4449-9F3B-E797285A5879" name="GUID-2F04CC88-EDFF-4449-9F3B-E797285A5879"></a><h3 id="ADXDK-GUID-2F04CC88-EDFF-4449-9F3B-E797285A5879" class="sect3">Improving Application Performance and Scalability with XQuery</h3>
               <div>
                  <p>The XDK XQuery processor provides several features for improving the performance and scalability of your application.</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK120"></a><a id="ADXDK121"></a><a id="ADXDK190"></a><div class="props_rev_3"><a id="GUID-80E29834-C423-41F9-BE6D-D34388E15A98" name="GUID-80E29834-C423-41F9-BE6D-D34388E15A98"></a><h4 id="ADXDK-GUID-80E29834-C423-41F9-BE6D-D34388E15A98" class="sect4">Streaming Query Evaluation</h4>
                  <div>
                     <p>The XDK XQuery processor for Java supports streaming evaluation for many types of queries. Streaming evaluation requires a small amount of main memory, even when the input XML is very large.</p>
                     <div class="section">
                        <p>To facilitate streaming evaluation, the following actions are recommended:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Set the binding mode on the static context to deferred mode (see the method <code class="codeph">javax.xml.xquery.XQStaticContext.setBindingMode(int)</code> in <a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>). If the binding mode is not deferred, the input XML is fully materialized when it is bound.
                              </p>
                           </li>
                           <li>
                              <p>Provide the input XML as an instance of <code class="codeph">java.io.InputStream</code>, <code class="codeph">java.io.Reader</code>, or <code class="codeph">javax.xml.stream.XMLStreamReader</code>. Input XML is provided to the query processor by binding it to the expression, or by returning it from an entity resolver.
                              </p>
                           </li>
                           <li>
                              <p>Ensure that the <code class="codeph">javax.xml.xquery.XQSequence</code> instance is consumed in a way that does not require materialization:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>The string serialization methods <code class="codeph">getSequenceAsString(...)</code> and <code class="codeph">getItemAsString(...)</code> produce data as a string that is held in memory. Instead, use the <code class="codeph">writeSequence(...)</code> or the <code class="codeph">writeItem(...)</code> method to serialize the sequence.
                                    </p>
                                 </li>
                                 <li>
                                    <p>The <code class="codeph">getNode()</code> method builds a Document Object Model (DOM) node that is held in memory. Instead, consider using the <code class="codeph">getSequenceAsStream()</code> or the <code class="codeph">getItemAsStream()</code> method to get a Streaming API for XML (StAX) stream.
                                    </p>
                                 </li>
                                 <li>
                                    <p>The <code class="codeph">getItem()</code> method copies and materializes the current item in memory. Instead, use methods directly on the <code class="codeph">java.xml.xquery.XQSequence</code> instance to access the current item (see the interface <code class="codeph">javax.xml.xquery.XQItemAccessor</code> in <a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>).
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                        <p>The code shown in this section invokes a query using XQJ in a way that does not prevent streaming evaluation.</p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-80E29834-C423-41F9-BE6D-D34388E15A98__BAJCBHAA">Example 15-17</a> displays the contents of <code class="codeph">books2.xq</code>.
                        </p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-80E29834-C423-41F9-BE6D-D34388E15A98__BAJFEHHJ">Example 15-18</a> sets up the query to enable streaming evaluation. The example writes this output to file <code class="codeph">results.xml</code>: <code class="codeph">&lt;title&gt;A Game of Thrones&lt;/title&gt;</code>.
                        </p>
                        <p>The binding mode is set to the value <code class="codeph">BINDING_MODE_DEFERRED</code> to avoid materializing <code class="codeph">books.xml</code> when it is bound to the prepared expression. Likewise, the result is written to an output stream, and it is not materialized.
                        </p>
                        <p>To simplify the example, the input file <code class="codeph">books.xml</code> is small. Even if this file contained millions of books, evaluating the query would require only a small maximum heap size because only one book element is held in memory at one time. In contrast with the query <code class="codeph">books.xq</code>, shown in <a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFFCBB">Example 15-3</a>, the query <code class="codeph">books2.xq</code> does not require you to define an entity resolver. Both examples (<code class="codeph">books.xq</code> and <code class="codeph">books2.xq</code>) are streamable.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-80E29834-C423-41F9-BE6D-D34388E15A98__BAJCBHAA">
                        <p class="titleinexample">Example 15-17 books2.xq</p><pre class="oac_no_warn" dir="ltr">declare variable $doc external;
 
for $book in $doc/books/book
where xs:decimal($book/price) gt 10.00
return
  $book/title
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-80E29834-C423-41F9-BE6D-D34388E15A98__BAJFEHHJ">
                        <p class="titleinexample">Example 15-18 Facilitating Streaming Evaluation</p><pre class="oac_no_warn" dir="ltr">import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
 
import javax.xml.namespace.QName;
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQConstants;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQSequence;
import javax.xml.xquery.XQStaticContext;
 
import oracle.xml.xquery.OXQDataSource;
 
public class Streaming {
 
    public static void main(String[] args) throws XQException, IOException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
        
        XQStaticContext ctx = con.getStaticContext();
        ctx.setBindingMode(XQConstants.BINDING_MODE_DEFERRED);
        con.setStaticContext(ctx);
        
        FileInputStream input = new FileInputStream("books.xml");
        FileInputStream query = new FileInputStream("books2.xq");
        FileOutputStream output = new FileOutputStream("result.xml");
        
        XQPreparedExpression expr = con.prepareExpression(query);
        query.close();
        expr.bindDocument(new QName("doc"), input, null, null);
        
        XQSequence result = expr.executeQuery();

        // Writes "&lt;title&gt;A Game of Thrones&lt;/title&gt;" to file results.xml
        result.writeSequence(output, null);
        
        result.close();
        input.close();
        output.close();
        expr.close();
        con.close();
    }
}
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK122"></a><a id="ADXDK191"></a><div class="props_rev_3"><a id="GUID-C36470F9-CC26-4169-8C50-78852EC74583" name="GUID-C36470F9-CC26-4169-8C50-78852EC74583"></a><h4 id="ADXDK-GUID-C36470F9-CC26-4169-8C50-78852EC74583" class="sect4">External Storage</h4>
                  <div>
                     <p>Depending on the query, the processor might have to store part of the input XML in main memory during query evaluation. </p>
                     <div class="section">
                        <p>For example, this scenario can occur in cases such as these:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A sequence is sorted.</p>
                           </li>
                           <li>
                              <p>The value bound to a variable is used multiple times.</p>
                           </li>
                           <li>
                              <p>A path expression uses a reverse-axis step.</p>
                           </li>
                        </ul>
                        <p>To reduce memory usage in such cases, you can configure the XQuery processor to use external storage for materializing XML, rather than main memory. To enable the use of external storage, set the data source property <code class="codeph">OXQConstants.USE_EXTERNAL_STORAGE</code> to <code class="codeph">true</code>, and set an <code class="codeph">oracle.xml.scalable.PageManager</code> instance on the dynamic context.
                        </p>
                        <div class="infoboxnote" id="GUID-C36470F9-CC26-4169-8C50-78852EC74583__GUID-72A836B5-2C2C-491E-92C3-BEDE32CDD73A">
                           <p class="notep1">Note:</p>
                           <p>Using external storage can significantly reduce the amount of main memory that is consumed during query processing. However, it can also reduce performance.</p>
                        </div>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-C36470F9-CC26-4169-8C50-78852EC74583__BAJHJDID">Example 15-19</a> shows how to enable the XQuery processor to use disk-based storage rather than main memory when XML is materialized. The example writes this output to file <code class="codeph">results.xml</code>: <code class="codeph">&lt;title&gt;A Game of Thrones&lt;/title&gt;</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-C36470F9-CC26-4169-8C50-78852EC74583__BAJHJDID">
                        <p class="titleinexample">Example 15-19 Configuring the XQuery Processor to Use External Storage</p><pre class="oac_no_warn" dir="ltr">import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
 
import javax.xml.namespace.QName;
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQConstants;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQSequence;
import javax.xml.xquery.XQStaticContext;
 
import oracle.xml.scalable.FilePageManager;
import oracle.xml.xquery.OXQDataSource;
import oracle.xml.xquery.OXQPreparedExpression;
import oracle.xml.xquery.OXQView;

public class ExternalStorage {
 
    public static void main(String[] args) throws XQException, IOException {
        OXQDataSource ds = new OXQDataSource();
        ds.setProperty(OXQDataSource.USE_EXTERNAL_STORAGE, "true");
        
        XQConnection con = ds.getConnection();
        XQStaticContext ctx = con.getStaticContext();
        ctx.setBindingMode(XQConstants.BINDING_MODE_DEFERRED);
        con.setStaticContext(ctx);
        
        FileInputStream input = new FileInputStream("books.xml");
        FileInputStream query = new FileInputStream("books2.xq");
        FileOutputStream output = new FileOutputStream("results.xml");
        
        XQPreparedExpression expr = con.prepareExpression(query);
        query.close();
        expr.bindDocument(new QName("doc"), input, null, null);
        
        // Set a page manager that will be used by the XQuery processor if XML needs to be materialized
        OXQPreparedExpression oexpr = OXQView.getPreparedExpression(expr);
        File temporaryFile = File.createTempFile("books", ".pagefile");
        temporaryFile.deleteOnExit();
        oexpr.setPageManager(new FilePageManager(temporaryFile.getAbsolutePath()));
        
        XQSequence result = expr.executeQuery();

        // Writes to file results.xml: "&lt;title&gt;A Game of Thrones&lt;/title&gt;"
        result.writeSequence(output, null);
        
        result.close();
        input.close();
        output.close();
        expr.close();
        con.close();
    }
}
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK192"></a><div class="props_rev_3"><a id="GUID-729BCBC6-A03A-4397-BE61-6E0AB9B43A6D" name="GUID-729BCBC6-A03A-4397-BE61-6E0AB9B43A6D"></a><h4 id="ADXDK-GUID-729BCBC6-A03A-4397-BE61-6E0AB9B43A6D" class="sect4">Thread Safety for XQJ</h4>
                  <div>
                     <p>The Oracle implementation of XQJ is not thread-safe. For example, an instance of <code class="codeph">javax.xml.xquery.XQSequence</code> must be accessed by only one thread. However, a restricted form of thread safety is supported for managing instances of <code class="codeph">javax.xml.xquery.XQConnection</code>.
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>An instance of <code class="codeph">XQConnection</code> serves as a factory for creating instances of <code class="codeph">XQExpression</code>, <code class="codeph">XQPreparedExpression</code>, <code class="codeph">XQItem</code>, <code class="codeph">XQSequence</code>, <code class="codeph">XQItemType</code>, and <code class="codeph">XQSequenceType</code>. One thread can manage the creation of these objects for use by other threads. For example, <code class="codeph">XQPreparedExpression</code> instances created in one thread by the same connection can be used in other threads. Each <code class="codeph">XQPreparedExpression</code> instance, however, must be executed by only one thread. Any user-defined implementations of <code class="codeph">oracle.xml.xquery.OXQEntityResolver</code> that are specified must be thread-safe when expressions from the same connection are evaluated concurrently.
                           </p>
                        </li>
                        <li>
                           <p>Method <code class="codeph">XQConnection.close()</code> closes all <code class="codeph">XQExpression</code> and <code class="codeph">XQPreparedExpression</code> instances that were obtained from the connection. Closing those instances closes all <code class="codeph">XQResultSequence</code> and <code class="codeph">XQResultItem</code> instances obtained from the expressions. Method <code class="codeph">XQConnection.close()</code> can be called while expressions obtained from the connection are being processed in other threads. In that case, all registered resources held by the expressions (such as <code class="codeph">java.io.InputStream</code> and <code class="codeph">java.io.Reader</code>) are closed. This contract assumes that all registered resources support a thread-safe close method. For example, many JDK implementations of <code class="codeph">java.io.Closeable</code> satisfy this requirement. But, many implementations of <code class="codeph">javax.xml.stream.XMLStreamReader</code> do not provide a thread-safe close method. Implementations without this support can give unpredictable results if they are closed while a second thread is still reading (see interface <code class="codeph">oracle.xml.xquery.OXQCloseable</code> in <a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>).
                           </p>
                           <div class="infoboxnotealso" id="GUID-729BCBC6-A03A-4397-BE61-6E0AB9B43A6D__GUID-D41CBF61-90B5-4E84-99F7-23D92B3B1E12">
                              <p class="notep1">See Also:</p>
                              <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>, method <code class="codeph">oracle.xml.xquery.OXQConnection.copyExpression(XQPreparedExpression)</code></p>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADXDK183"></a><a id="ADXDK184"></a><a id="ADXDK185"></a><a id="ADXDK186"></a><a id="ADXDK182"></a><div class="props_rev_3"><a id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9" name="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9"></a><h3 id="ADXDK-GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9" class="sect3">Performing Updates</h3>
               <div>
                  <p>XDK extends XQJ with the ability to execute updating queries. XML documents can be read as an instance of <code class="codeph">javax.xml.xquery.XQItem</code>, and then modified using XQuery Update Facility extensions.
                  </p>
                  <div class="section">
                     <p> This feature is disabled by default. You can enable it by setting the update mode on the dynamic context to <code class="codeph">oracle.xml.xquery.OXQConstants.UPDATE_MODE_ENABLED</code>.
                     </p>
                     <p>Documents to be updated must be bound in deferred mode (see method <code class="codeph">javax.xml.xquery.XQStaticContext.setBindingMode(int)</code> in <a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>). If the binding mode is not set to deferred, the input bindings are copied before query execution. Thus, only the copy is updated.
                     </p>
                     <p>The example in this section shows how you can modify an XML document using the XQuery Update Facility.</p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJFCJCC">Example 15-20</a> displays the contents of <code class="codeph">configuration.xml</code>.
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJICABB">Example 15-21</a> displays the contents of <code class="codeph">update.xq</code>.
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJGJHDJ">Example 15-22</a> displays the contents of <code class="codeph">configuration.xml</code> after an update.
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJCDIFI">Example 15-23</a> shows how execute the query <code class="codeph">update.xq</code>.
                     </p>
                     <p>In the example, these actions occur:</p>
                     <ol>
                        <li>
                           <p>The XML file <code class="codeph">configuration.xml</code> is read as an instance of <code class="codeph">javax.xml.xquery.XQItem</code>.
                           </p>
                        </li>
                        <li>
                           <p>The item is bound to the prepared expression for the query <code class="codeph">update.xq</code>.
                           </p>
                        </li>
                        <li>
                           <p>The query <code class="codeph">update.xq</code> is executed.
                           </p>
                        </li>
                        <li>
                           <p>The modified document is written to the file <code class="codeph">configuration.xml</code>.
                           </p>
                        </li>
                     </ol>
                     <div class="infoboxnotealso" id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__GUID-9703B030-1DA9-4353-8A2D-6DDBDC23C543">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_tr_xquery_update10" target="_blank"><span class="italic">XQuery Update Facility 1.0</span></a></p>
                           </li>
                           <li>
                              <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>, interface <code class="codeph">oracle.xml.xquery.OXQDynamicContext</code></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJFCJCC">
                     <p class="titleinexample">Example 15-20 configuration.xml</p><pre class="oac_no_warn" dir="ltr">&lt;configuration&gt;
  &lt;property&gt;
    &lt;name&gt;hostname&lt;/name&gt;
    &lt;value&gt;example.com&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;timeout&lt;/name&gt;
    &lt;value&gt;1000&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJICABB">
                     <p class="titleinexample">Example 15-21 update.xq</p><pre class="oac_no_warn" dir="ltr">declare variable $doc external;
 
let $timeout := $doc/configuration/property[name eq "timeout"]
return
  replace value of node $timeout/value 
  with 2 * xs:integer($timeout/value)
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJGJHDJ">
                     <p class="titleinexample">Example 15-22 Updated File configuration.xml </p><pre class="oac_no_warn" dir="ltr">&lt;configuration&gt;
  &lt;property&gt;
    &lt;name&gt;hostname&lt;/name&gt;
    &lt;value&gt;example.com&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;timeout&lt;/name&gt;
    &lt;value&gt;2000&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJCDIFI">
                     <p class="titleinexample">Example 15-23 Executing the Updating Query update.xq</p><pre class="oac_no_warn" dir="ltr">import java.io.FileInputStream;
import java.io.IOException;
import java.io.FileOutputStream;
 
import javax.xml.namespace.QName;
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQConstants;
import javax.xml.xquery.XQException;
import javax.xml.xquery.XQItem;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.xquery.XQStaticContext;
 
import oracle.xml.xquery.OXQConstants;
import oracle.xml.xquery.OXQDataSource;
import oracle.xml.xquery.OXQView;
 
public class UpdateDocument {
    public static void main(String[] args) throws XQException, IOException {
        OXQDataSource ds = new OXQDataSource();
        XQConnection con = ds.getConnection();
        
        XQStaticContext ctx = con.getStaticContext();
        // Set the binding mode to deferred so the document
        // item is not copied when it is bound.
        ctx.setBindingMode(XQConstants.BINDING_MODE_DEFERRED);
        con.setStaticContext(ctx);
 
        FileInputStream input = new FileInputStream("configuration.xml");
        XQItem doc = con.createItemFromDocument(input, null, null);
        input.close();
        
        System.out.println("Before update: \n" + doc.getItemAsString(null));
        
        FileInputStream query = new FileInputStream("update.xq");
        XQPreparedExpression expr = con.prepareExpression(query);
        query.close();
        expr.bindItem(new QName("doc"), doc);
        // Enable updates (disabled by default)
        OXQView.getDynamicContext(expr).setUpdateMode(OXQConstants.UPDATE_MODE_ENABLED);
        expr.executeQuery();
 
        System.out.println("After update: \n" + doc.getItemAsString(null));
        
        // Write the modified document back to the file
        FileOutputStream out = new FileOutputStream("configuration.xml");
        doc.writeItem(out, null);

        expr.close();
        con.close();
    }
}
</pre></div>
                  <!-- class="example" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-19382C4B-0797-444D-9770-3620525E8978" name="GUID-19382C4B-0797-444D-9770-3620525E8978"></a><h3 id="ADXDK-GUID-19382C4B-0797-444D-9770-3620525E8978" class="sect3">Oracle XQuery Functions and Operators</h3>
               <div>
                  <p>Oracle supports the standard XQuery functions and operators, as well as some Oracle-specific functions.</p>
                  <p>Oracle-specific XQuery functions use namespace <code class="codeph">http://xmlns.oracle.com/xdk/xquery/function</code>. Namespace prefix <code class="codeph">ora-fn</code> is predeclared, and the module is automatically imported.
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-xquery-processor-for-Java.html#GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0" title="The standards and specifications to which the XDK XQuery processor for Java conforms are listed.">Standards and Specifications for the XQuery Processor for Java</a></li>
                     </ul>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-65FBF15D-D1FA-4648-89E4-C613295F2787" name="GUID-65FBF15D-D1FA-4648-89E4-C613295F2787"></a><h4 id="ADXDK-GUID-65FBF15D-D1FA-4648-89E4-C613295F2787" class="sect4">Oracle XQuery Functions for Duration, Date, and Time</h4>
                  <div>
                     <p>You can manipulate durations, dates, and times in XQuery using Oracle XQuery functions.</p>
                     <p>The Oracle XQuery functions are in namespace <code class="codeph">http://xmlns.oracle.com/xdk/xquery/function</code>. Namespace prefix<code class="codeph">ora-fn</code> is predeclared, and the module is automatically imported.
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317" name="GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317"></a><h5 id="ADXDK-GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317" class="sect5">ora-fn:date-from-string-with-format</h5>
                     <div>
                        <p>This Oracle XQuery function returns a new date value from a string according to a given pattern.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317__GUID-D0426020-8ED3-4A70-8E74-08F2EC4798DE">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:date-from-string-with-format($format as xs:string?,
                                    $dateString as xs:string?, 
                                    $locale as xs:string*)
                                   as xs:date?

ora-fn:date-from-string-with-format($format as xs:string?,
                                    $dateString as xs:string?)
                                   as xs:date?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317__GUID-0938493F-5CA4-4F91-98C2-CBB038543205">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code>: The pattern; see <a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="The $format argument identifies the various fields that compose a date or time value.">Format Argument</a></p>
                        <p><code class="codeph">$dateString</code>: An input string that represents a date 
                        </p>
                        <p><code class="codeph">$locale</code>: A one- to three-field value that represents the locale; see <a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="The $locale represents a specific geographic, political, or cultural region.">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317__GUID-3B95294E-D0F5-4380-BACD-BDF13E0F49F4">Example</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example returns the specified date in the current time zone:</p><pre class="oac_no_warn" dir="ltr">ora-fn:date-from-string-with-format("yyyy-MM-dd G", "2013-06-22 AD")</pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-44910E87-C56D-4F83-857F-412A08B0234A" name="GUID-44910E87-C56D-4F83-857F-412A08B0234A"></a><h5 id="ADXDK-GUID-44910E87-C56D-4F83-857F-412A08B0234A" class="sect5">ora-fn:date-to-string-with-format</h5>
                     <div>
                        <p>This Oracle XQuery function returns a date string with a given pattern.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-44910E87-C56D-4F83-857F-412A08B0234A__GUID-9CA1AFED-6BD7-4684-9535-0CD674D1F915">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:date-to-string-with-format($format as xs:string?,
                                  $date as xs:date?,
                                  *$locale as xs:string?)
                                 as xs:string?

ora-fn:date-to-string-with-format($format as xs:string?,
                                  $date as xs:date?)
                                 as xs:string?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-44910E87-C56D-4F83-857F-412A08B0234A__GUID-6AA4B590-E391-464E-855F-8ED5323DDD7F">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code>: The pattern; see <a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="The $format argument identifies the various fields that compose a date or time value.">Format Argument</a></p>
                        <p><code class="codeph">$date</code>: The date
                        </p>
                        <p><code class="codeph">$locale</code>: A one- to three-field value that represents the locale; see <a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="The $locale represents a specific geographic, political, or cultural region.">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-44910E87-C56D-4F83-857F-412A08B0234A__GUID-1A4CDB10-0773-47AF-9B7E-3949538E2BE9">Example</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example returns the string <code class="codeph">2013-07-15</code>:
                        </p><pre class="oac_no_warn" dir="ltr">ora-fn:date-to-string-with-format("yyyy-mm-dd", xs:date("2013-07-15"))</pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39" name="GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39"></a><h5 id="ADXDK-GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39" class="sect5">ora-fn:dateTime-from-string-with-format</h5>
                     <div>
                        <p>This Oracle XQuery function returns a new date-time value from an input string, according to a given pattern.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39__GUID-9583F604-CA13-42D6-933D-8ED70CE5DF1C">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:dateTime-from-string-with-format($format as xs:string?, 
                                        $dateTimeString as xs:string?,
                                        $locale as xs:string?)
                                       as xs:dateTime?

ora-fn:dateTime-from-string-with-format($format as xs:string?,
                                        $dateTimeString as xs:string?)
                                       as xs:dateTime?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39__GUID-C6C1828A-640E-4309-B4C4-D18191E4A06C">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code>: The pattern; see <a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="The $format argument identifies the various fields that compose a date or time value.">Format Argument</a></p>
                        <p><code class="codeph">$dateTimeString</code>: The date and time
                        </p>
                        <p><code class="codeph">$locale</code>: A one- to three-field value that represents the locale; see <a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="The $locale represents a specific geographic, political, or cultural region.">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39__GUID-C5D7690A-733D-4CE4-A655-03EDC25C7369">Examples</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example returns the specified date and 11:04:00AM in the current time zone:</p><pre class="pre codeblock"><code>ora-fn:dateTime-from-string-with-format("yyyy-MM-dd 'at' hh:mm", 
                                        "2013-06-22 at 11:04")
</code></pre><p>The next example returns the specified date and 12:00:00AM in the current time zone:</p><pre class="pre codeblock"><code>ora-fn:dateTime-from-string-with-format("yyyy-MM-dd G",
                                        "2013-06-22 AD") </code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E" name="GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E"></a><h5 id="ADXDK-GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E" class="sect5">ora-fn:dateTime-to-string-with-format</h5>
                     <div>
                        <p>This Oracle XQuery function returns a date and time string with a given pattern.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E__GUID-CA66F25E-532E-4D3F-8A4C-7795F8ADF837">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:dateTime-to-string-with-format($format as xs:string?,
                                      $dateTime as xs:dateTime?,
                                      $locale as xs:string?)
                                     as xs:string?

ora-fn:dateTime-to-string-with-format($format as xs:string?,
                                      $dateTime as xs:dateTime?)
                                     as xs:string?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E__GUID-15ECD024-8DEC-4F87-8BBF-00127A9B8363">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code>: The pattern; see <a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="The $format argument identifies the various fields that compose a date or time value.">Format Argument</a></p>
                        <p><code class="codeph">$dateTime</code>: The date and time
                        </p>
                        <p><code class="codeph">$locale</code>: A one- to three-field value that represents the locale; see <a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="The $locale represents a specific geographic, political, or cultural region.">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E__GUID-4B1EE99A-0FBF-4AB0-A2A5-3738BBD47665">Examples</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example returns the string <code class="codeph">07 JAN 2013 10:09 PM AD</code>:
                        </p><pre class="oac_no_warn" dir="ltr">ora-fn:dateTime-to-string-with-format("dd MMM yyyy hh:mm a G",
                                      xs:dateTime("2013-01-07T22:09:44"))
</pre><p>The next example returns the string "01-07-2013":</p><pre class="oac_no_warn" dir="ltr">ora-fn:dateTime-to-string-with-format("MM-dd-yyyy",
                                      xs:dateTime("2013-01-07T22:09:44")) </pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E" name="GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E"></a><h5 id="ADXDK-GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E" class="sect5">ora-fn:time-from-string-with-format</h5>
                     <div>
                        <p>This Oracle XQuery function returns a new time value from an input string, according to a given pattern.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E__GUID-EB82FFB7-EC29-4958-8877-1AFB91FF5496">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:time-from-string-with-format($format as xs:string?,
                                    $timeString as xs:string?,
                                    $locale as xs:string?)
                                   as xs:time?

ora-fn:time-from-string-with-format($format as xs:string?,
                                    $timeString as xs:string?)
                                   as xs:time?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E__GUID-3D5945FF-FF4C-4B33-9018-6BFBB77F07DD">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code>: The pattern; see <a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="The $format argument identifies the various fields that compose a date or time value.">Format Argument</a></p>
                        <p><code class="codeph">$timeString</code>: The time
                        </p>
                        <p><code class="codeph">$locale</code>: A one- to three-field value that represents the locale; see <a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="The $locale represents a specific geographic, political, or cultural region.">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E__GUID-E64FD76A-2FEA-4BA0-8B9E-29EE0A4CEBFF">Example</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example returns 9:45:22 PM in the current time zone:</p><pre class="pre codeblock"><code>ora-fn:time-from-string-with-format("HH.mm.ss", "21.45.22")
</code></pre><p>The next example returns 8:07:22 PM in the current time zone:</p><pre class="pre codeblock"><code>fn-bea:time-from-string-with-format("hh:mm:ss a", "8:07:22 PM") </code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E" name="GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E"></a><h5 id="ADXDK-GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E" class="sect5">ora-fn:time-to-string-with-format</h5>
                     <div>
                        <p>This Oracle XQuery function returns a time string with a given pattern.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E__GUID-BFC5D2B8-4F57-4F9F-B9F2-64CC4A9394A4">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:time-to-string-with-format($format as xs:string?,
                                  $time as xs:time?,
                                  $locale as xs:string?)
                                 as xs:string?

ora-fn:time-to-string-with-format($format as xs:string?, $time as xs:time?) as xs:string?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E__GUID-33F606FA-3F63-4D01-BB50-3B34EF68D130">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code>: The pattern; see <a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="The $format argument identifies the various fields that compose a date or time value.">Format Argument</a></p>
                        <p><code class="codeph">$time</code>: The time
                        </p>
                        <p><code class="codeph">$locale</code>: A one- to three-field value that represents the locale; see <a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="The $locale represents a specific geographic, political, or cultural region.">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E__GUID-14473823-9B73-4CEE-8CA1-8E5C9E425DA3">Examples</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example returns the string "10:09 PM":</p><pre class="pre codeblock"><code>ora-fn:time-to-string-with-format("hh:mm a", xs:time("22:09:44"))
</code></pre><p>The next example returns the string "22:09 PM":</p><pre class="pre codeblock"><code>ora-fn:time-to-string-with-format("HH:mm a", xs:time("22:09:44"))</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" name="GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346"></a><h5 id="ADXDK-GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" class="sect5">Format Argument</h5>
                     <p>The <code class="codeph">$format</code> argument identifies the various fields that compose a date or time value. 
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" name="GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B"></a><h5 id="ADXDK-GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" class="sect5">Locale Argument</h5>
                     <div>
                        <p>The <code class="codeph">$locale</code> represents a specific geographic, political, or cultural region. 
                        </p>
                        <p>It is defined by up to three fields:</p>
                        <ol>
                           <li>
                              <p><span class="bold">Language code</span>: The ISO 639 alpha-2 or alpha-3 language code, or the registered language subtags of up to eight letters. For example, <code class="codeph">en</code> for English and <code class="codeph">ja</code> for Japanese.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Country code</span>: The ISO 3166 alpha-2 country code or the UN M.49 numeric-3 area code. For example, <code class="codeph">US</code> for the United States and <code class="codeph">029</code> for the Caribbean.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Variant</span>: Indicates a variation of the locale, such as a particular dialect. Order multiple values in order of importance and separate them with an underscore (_). These values are case sensitive.
                              </p>
                           </li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B__GUID-7FFDC7E5-E939-4F3D-9BAF-8102FEDEB172">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=javase7_util_locale" target="_blank">Class Locale</a> in <cite>Java Standard Edition 7 Reference</cite></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-F8F59CE8-C172-4C5E-BBC9-208332B96CC2" name="GUID-F8F59CE8-C172-4C5E-BBC9-208332B96CC2"></a><h4 id="ADXDK-GUID-F8F59CE8-C172-4C5E-BBC9-208332B96CC2" class="sect4">Oracle XQuery Functions for Strings</h4>
                  <div>
                     <p>You can manipulate strings in XQuery using Oracle XQuery functions.</p>
                     <p>The Oracle XQuery functions are in namespace <code class="codeph">http://xmlns.oracle.com/xdk/xquery/function</code>. Namespace prefix<code class="codeph">ora-fn</code> is predeclared, and the module is automatically imported.
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194" name="GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194"></a><h5 id="ADXDK-GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194" class="sect5">ora-fn:pad-left</h5>
                     <div>
                        <p>Adds padding characters to the left of a string to create a fixed-length string. If the input string exceeds the specified size, then it is truncated to return a substring of the specified length. The default padding character is a space (ASCII 32).</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194__GUID-3AD17F46-E2B4-431C-BD96-C648E1383B6E">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:pad-left($str as xs:string?,
                $size as xs:integer?,
                $pad as xs:string?)
               as xs:string?

ora-fn:pad-left($str as xs:string?,
                $size as xs:integer?)
               as xs:string?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194__GUID-4F78678D-EEFA-4B9B-9326-161670A78C06">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$str</code>: The input string
                        </p>
                        <p><code class="codeph">$size</code>: The desired fixed length, which is obtained by adding padding characters to <code class="codeph">$str</code></p>
                        <p><code class="codeph">$pad</code>: The padding character
                        </p>
                        <p>If either argument is an empty sequence, then the function returns an empty sequence.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194__GUID-C255127C-3534-4ACC-B80E-76CE134A7650">Examples</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example prefixes <code class="codeph">"01</code>" to the input string up to the maximum of six characters. The returned string is "<code class="codeph">010abc</code>". The function returns one complete and one partial pad character.
                        </p><pre class="pre codeblock"><code>ora-fn:pad-left("abc", 6, "01")
</code></pre><p>The example returns only "<code class="codeph">ab</code>" because the input string exceeds the specified fixed length:
                        </p><pre class="pre codeblock"><code>ora-fn:pad-left("abcd", 2, "01")
</code></pre><p>This example prefixes spaces to the string up to the specified maximum of six characters. The returned string has a prefix of two spaces: "<code class="codeph">  abcd</code>":
                        </p><pre class="oac_no_warn" dir="ltr">ora-fn:pad-left("abcd", 6)
</pre><p>The next example returns only "<code class="codeph">ab</code>" because the input string exceeds the specified fixed length:
                        </p><pre class="oac_no_warn" dir="ltr">ora-fn:pad-left("abcd", 2)</pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0" name="GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0"></a><h5 id="ADXDK-GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0" class="sect5">ora-fn:pad-right</h5>
                     <div>
                        <p>Adds padding characters to the right of a string to create a fixed-length string. If the input string exceeds the specified size, then it is truncated to return a substring of the specified length. The default padding character is a space (ASCII 32).</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0__GUID-F7AD140B-8363-4264-B496-C447957B80F6">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:pad-right($str as xs:string?,
                 $size as xs:integer?,
                 $pad as xs:string?)
                as xs:string?

ora-fn:pad-right($str as xs:string?,
                 $size as xs:integer?)
                as xs:string?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0__GUID-531EEE67-8599-44DA-AE67-6C9061D1BA5C">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$str</code>: The input string
                        </p>
                        <p><code class="codeph">$size</code>: The desired fixed length, which is obtained by adding padding characters to <code class="codeph">$str</code></p>
                        <p><code class="codeph">$pad</code>: The padding character
                        </p>
                        <p>If either argument is an empty sequence, then the function returns an empty sequence.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0__GUID-90633DBA-E9C9-4412-A4FE-1FA366E9CCFF">Examples</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example appends "<code class="codeph">01</code>" to the input string up to the maximum of six characters. The returned string is "<code class="codeph">abc010</code>". The function returns one complete and one partial pad character.
                        </p><pre class="pre codeblock"><code>ora-fn:pad-right("abc", 6, "01")
</code></pre><p>This example returns only "<code class="codeph">ab</code>" because the input string exceeds the specified fixed length:
                        </p><pre class="pre codeblock"><code>ora-fn:pad-right("abcd", 2, "01")
</code></pre><p>This example appends spaces to the string up to the specified maximum of six characters. The returned string has a suffix of two spaces: "<code class="codeph">abcd  </code>":
                        </p><pre class="pre codeblock"><code>ora-fn:pad-right("abcd", 6)
</code></pre><p>The next example returns only "<code class="codeph">ab</code>" because the input string exceeds the specified fixed length:
                        </p><pre class="pre codeblock"><code>ora-fn:pad-right("abcd", 2)</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7" name="GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7"></a><h5 id="ADXDK-GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7" class="sect5">ora-fn:trim</h5>
                     <div>
                        <p>Removes any leading or trailing white space from a string.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7__GUID-71EA4AD3-9527-4814-B27A-B2DBC907E01B">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:trim($input as xs:string?) as xs:string?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7__GUID-5EBA07EE-1A98-4040-BBFC-1BF78061B1DA">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$input</code>: The string to trim. If <code class="codeph">$input</code> is an empty sequence, then the function returns an empty sequence. Other data types trigger an error.
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7__GUID-91596001-D79D-4865-A7F5-EAC729D3B2F3">Example</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example returns the string "<code class="codeph">abc</code>":
                        </p><pre class="pre codeblock"><code>ora-fn:trim("  abc  ")</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80" name="GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80"></a><h5 id="ADXDK-GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80" class="sect5">ora-fn:trim-left</h5>
                     <div>
                        <p>Removes any leading white space.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80__GUID-BBE9C459-9FF3-489C-9975-E8803D05D852">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:trim-left($input as xs:string?) as xs:string?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80__GUID-B6D41FD5-514C-47D3-A6F5-18BF291950AA">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$input</code>: The string to trim. If <code class="codeph">$input</code> is an empty sequence, then the function returns an empty sequence. Other data types trigger an error.
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80__GUID-279F233D-9F1A-49D4-92EC-1DDE09C06F46">Example</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example removes the leading spaces and returns the string "<code class="codeph">abc&nbsp;&nbsp;&nbsp;&nbsp;</code>":
                        </p><pre class="pre codeblock"><code>ora-fn:trim-left("    abc    ")</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92" name="GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92"></a><h5 id="ADXDK-GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92" class="sect5">ora-fn:trim-right</h5>
                     <div>
                        <p>Removes any trailing white space.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92__GUID-53BC7949-5ED4-49DE-83A2-D8615CD6CA26">Signature</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn:trim-right($input as xs:string?) as xs:string?</code></pre><div class="section">
                           <p class="subhead3" id="GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92__GUID-33F98649-53B9-46A4-BCA7-9508E7461482">Parameters</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$input</code>: The string to trim. If <code class="codeph">$input</code> is an empty sequence, then the function returns an empty sequence. Other data types trigger an error.
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92__GUID-64E1BB38-95AC-48A0-9F9C-CB480C527417">Example</p>
                        </div>
                        <!-- class="section" -->
                        <p>This example removes the trailing spaces and returns the string "<code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;abc</code>":
                        </p><pre class="pre codeblock"><code>ora-fn:trim-left("    abc    ")</code></pre></div>
                  </div>
               </div>
            </div><a id="ADXDK99996"></a><div class="props_rev_3"><a id="GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0" name="GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0"></a><h3 id="ADXDK-GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0" class="sect3">Standards and Specifications for the XQuery Processor for Java</h3>
               <div>
                  <p>The standards and specifications to which the XDK XQuery processor for Java conforms are listed.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquery_30" target="_blank"><span class="italic">XQuery 3.0: An XML Query Language</span></a></p>
                        <div class="infoboxnote" id="GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0__GUID-BD352653-E22D-451D-AD74-88E1515EDB8D">
                           <p class="notep1">Note:</p>All XQuery 1.0 level features are supported. XQuery 3.0 level features are supported except for the following: FLWOR window clause, FLWOR count clause, namespace constructors, decimal format declarations, <code class="codeph">fn:format-number</code>, <code class="codeph">fn:format-integer</code>, <code class="codeph">fn:format-date</code>, <code class="codeph">fn:format-time</code>, <code class="codeph">fn:path</code>, and higher order XQuery functions.
                        </div>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_tr_xquery_update10" target="_blank"><span class="italic">XQuery Update Facility 1.0</span></a></p>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xqueryx_30" target="_blank"><span class="italic">XQueryX 3.0</span></a>, the XML syntax for XQuery 3.0
                        </p>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=jcp_org_jsr225" target="_blank"><span class="italic">JSR-000225 XQuery API for Java</span></a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0__GUID-40808998-C99E-40AE-BCD8-CF1CDC2DCD22">
                     <p class="notep1">Note:</p>
                     <p>The XDK XQuery processor for Java is not interoperable with other XQJ implementations, including the Oracle XQJ implementation for Oracle XML DB. (See JSR-225: XQuery API for Java for the meaning of <span class="italic">interoperable</span>.)
                     </p>
                  </div>
               </div><a id="ADXDK99968"></a><a id="ADXDK99967"></a><div class="props_rev_3"><a id="GUID-19038D1D-9BB6-4973-BD8A-6C885A1300E0" name="GUID-19038D1D-9BB6-4973-BD8A-6C885A1300E0"></a><h4 id="ADXDK-GUID-19038D1D-9BB6-4973-BD8A-6C885A1300E0" class="sect4">Optional XQuery Features</h4>
                  <div>
                     <p>The XQuery specification defines certain features as optional. Links are provided to the standards that specify those that are supported by XDK.</p>
                     <p>These are the optional features supported by XDK:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xqueryschemaimport" target="_blank">Schema Import</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xqueryschemavalid" target="_blank">Validate Expressions</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquerystatictyping" target="_blank">Static Typing</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquerystaticupdate" target="_blank">Static Typing for Update</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquery_modules" target="_blank">Modules</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquery_serial8n" target="_blank">Serialization</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADXDK124"></a><a id="ADXDK125"></a><a id="ADXDK126"></a><a id="ADXDK127"></a><a id="ADXDK123"></a><div class="props_rev_3"><a id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53" name="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53"></a><h4 id="ADXDK-GUID-64686275-A3CA-4C60-934C-CA8CC6636E53" class="sect4">Implementation-Defined Items</h4>
                  <div>
                     <p>The XQJ and XQuery specifications leave the definition of certain aspects up to the implementation. The implementation-defined items for XDK are described briefly.</p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJHHFGH" title="table of xqj support">Table 15-2</a> summarizes the XQJ implementation-defined items.
                     </p>
                     <div class="tblformalwide" id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJHHFGH">
                        <p class="titleintable">Table 15-2 XQJ Implementation-Defined Items</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="XQJ Implementation-Defined Items" summary="table of xqj support" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="50%" id="d53703e4388">Description</th>
                                 <th align="left" valign="bottom" width="50%" id="d53703e4391">Behavior</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4396" headers="d53703e4388 ">
                                    <p>Class name of <code class="codeph">XQDataSource</code> implementation
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4396 d53703e4391 ">
                                    <p><code class="codeph">oracle.xml.xquery.OXQDataSource</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4408" headers="d53703e4388 ">
                                    <p>Properties defined on <code class="codeph">OXQDataSource</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4408 d53703e4391 ">
                                    <p>None. The username and password are silently ignored.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4417" headers="d53703e4388 ">
                                    <p>JDBC connection support</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4417 d53703e4391 ">
                                    <p>JDBC connections are not supported.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4424" headers="d53703e4388 ">
                                    <p>Commands</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4424 d53703e4391 ">
                                    <p>Not supported.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4431" headers="d53703e4388 ">
                                    <p>Cancelling of query execution with method <code class="codeph">XQPreparedExpression.cancel()</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4431 d53703e4391 ">
                                    <p>Yes.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4440" headers="d53703e4388 ">
                                    <p>Serialization</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4440 d53703e4391 ">
                                    <p>Yes.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4447" headers="d53703e4388 ">
                                    <p>Additional StAX or SAX events</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4447 d53703e4391 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4454" headers="d53703e4388 ">
                                    <p>User-defined schema types</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4454 d53703e4391 ">
                                    <p>Yes.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4461" headers="d53703e4388 ">
                                    <p>Node identity, document order, and full-node context preservation when a node is bound to an external variable</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4461 d53703e4391 ">
                                    <p>Not preserved.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4468" headers="d53703e4388 ">
                                    <p>Login timeout</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4468 d53703e4391 ">
                                    <p>Not supported.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4475" headers="d53703e4388 ">
                                    <p>Transactions</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4475 d53703e4391 ">
                                    <p>Not supported. An exception is thrown if a transaction method is called.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4483" headers="d53703e4388 ">
                                    <p><code class="codeph">XQItemAccessor.getNodeUri()</code> method behavior if the input node is not a document node
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4483 d53703e4391 ">
                                    <p>Exception.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4492" headers="d53703e4388 ">
                                    <p><code class="codeph">XQItemType.getTypeName()</code> method for anonymous types
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4492 d53703e4391 ">
                                    <p>A unique name.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4501" headers="d53703e4388 ">
                                    <p><code class="codeph">XQItemType.getSchemaURI()</code> method
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4501 d53703e4391 ">
                                    <p>The schema URI is returned when a type is created from XQJ. No otherwise.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4510" headers="d53703e4388 ">
                                    <p><code class="codeph">XQDataFactory.createItemFromDocument()</code> and <code class="codeph">bindDocument()</code> methods if the input is not a well-formed XML document
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4510 d53703e4391 ">
                                    <p>Exception.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4522" headers="d53703e4388 ">
                                    <p>Additional error codes returned by class <code class="codeph">XQQueryException</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4522 d53703e4391 ">
                                    <p>The qualified names of Oracle-specific error codes are in the namespace <code class="codeph">http://xmlns.oracle.com/xdk/xquery/errors</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4534" headers="d53703e4388 ">
                                    <p><code class="codeph">ConnectionPoolXQDataSource</code>, <code class="codeph">PooledXQConnection</code>, <code class="codeph">XQConnectionEvent</code>, <code class="codeph">XQConnectionEventListener</code> interfaces
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4534 d53703e4391 ">
                                    <p>No.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4552" headers="d53703e4388 ">
                                    <p><code class="codeph">XQDataSource.getConnection(java.sql.Connection)</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4552 d53703e4391 ">
                                    <p>JDBC connections are not supported. An exception is thrown if this method is called.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4560" headers="d53703e4388 ">
                                    <p><code class="codeph">XQDataSource.getConnection(java.lang.String, java.lang.String)</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4560 d53703e4391 ">
                                    <p>Same as <code class="codeph">getConnection()</code>. Parameters are ignored.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="infoboxnote" id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__GUID-025084F3-A4A8-44A1-9CF2-5F1CA576DEF0">
                        <p class="notep1">Note:</p>
                        <p>XDK support for the features in <a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJHHFGH" title="table of xqj support">Table 15-2</a> differs from the Oracle XML DB support for them.
                        </p>
                     </div>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJBDCIH" title="Table of implementation-defined items">Table 15-3</a> summarizes the XQuery implementation-defined items.
                     </p>
                     <div class="tblformalwide" id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJBDCIH">
                        <p class="titleintable">Table 15-3 XQuery Implementation-Defined Items</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="XQuery Implementation-Defined Items" summary="Table of implementation-defined items" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="49%" id="d53703e4594">Item</th>
                                 <th align="left" valign="bottom" width="51%" id="d53703e4597">Behavior</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4602" headers="d53703e4594 ">
                                    <p>The version of Unicode that is used to construct expressions</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4602 d53703e4597 ">
                                    <p>Depends on the version of Java used. Different Java versions support different versions of Unicode.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4609" headers="d53703e4594 ">
                                    <p>The statically-known collations</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4609 d53703e4597 ">
                                    <p>Unicode codepoint collation and collations derived from classes <code class="codeph">java.text.Collator</code> or <code class="codeph">oracle.i18n.text.OraCollator</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4622" headers="d53703e4594 ">
                                    <p>The implicit time zone.</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4622 d53703e4597 ">
                                    <p>Uses the default time zone, as determined by method <code class="codeph">java.util.Calendar.getInstance()</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4632" headers="d53703e4594 ">
                                    <p>The circumstances in which warnings are raised, and the ways in which warnings are handled</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4632 d53703e4597 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4639" headers="d53703e4594 ">
                                    <p>The method by which errors are reported to the external processing environment</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4639 d53703e4597 ">
                                    <p>Exception <code class="codeph">javax.xml.xquery.XQException</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4649" headers="d53703e4594 ">
                                    <p>Whether the implementation is based on the rules of XML 1.0 and XML Names, or the rules of XML 1.1 and XML Names 1.1</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4649 d53703e4597 ">
                                    <p>1.0.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4656" headers="d53703e4594 ">
                                    <p>Any components of the static context or dynamic context that are overwritten or augmented by the implementation</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4656 d53703e4597 ">
                                    <p>See <a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJGHGHD" title="Table of definitions for default context property values">Table 15-5</a>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4668" headers="d53703e4594 ">
                                    <p>Which of the optional axes are supported by the implementation, if the Full-Axis Feature is not supported</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4668 d53703e4597 ">
                                    <p>Full support.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4675" headers="d53703e4594 ">
                                    <p>The default handling of empty sequences returned by an ordering key (sortspec) in an order by clause (empty least or empty greatest)</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4675 d53703e4597 ">
                                    <p><code class="codeph">least</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4684" headers="d53703e4594 ">
                                    <p>The names and semantics of any extension expressions (pragmas) recognized by the implementation</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4684 d53703e4597 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4691" headers="d53703e4594 ">
                                    <p>The names and semantics of any option declarations recognized by the implementation</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4691 d53703e4597 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4699" headers="d53703e4594 ">
                                    <p>Protocols (if any) by which parameters can be passed to an external function, and the result of the function can be returned to the invoking query</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4699 d53703e4597 ">
                                    <p>Defined by XQJ.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4706" headers="d53703e4594 ">
                                    <p>The process by which the specific modules to be imported by a module import are identified, if the Module feature is supported (includes processing of location hints, if any)</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4706 d53703e4597 ">
                                    <p>Entity resolvers. See <a href="using-xquery-processor-for-Java.html#GUID-5E83610F-647D-4AE5-801B-878244FB6949" title="XDK extends XQJ with an entity resolver framework for controlling how documents, schemas, modules, collations, and external functions are obtained during query processing. The examples in this section show how to use an entity resolver for several types of entities.">XQJ Entity Resolution</a>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4719" headers="d53703e4594 ">
                                    <p>Any static typing extensions supported by the implementation, if the Static Typing feature is supported</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4719 d53703e4597 ">
                                    <p>Strict mode (based on subtype) and optimistic mode (based on type intersection). Optimistic mode is the default.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4726" headers="d53703e4594 ">
                                    <p>The means by which serialization is invoked, if the Serialization feature is supported</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4726 d53703e4597 ">
                                    <p>Defined by XQJ.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4733" headers="d53703e4594 ">
                                    <p>The default values for the <code class="codeph">byte-order-mark</code>, <code class="codeph">encoding</code>, <code class="codeph">media-type</code>, <code class="codeph">normalization-form</code>, <code class="codeph">omit-xml-declaration</code>, <code class="codeph">standalone</code>, and <code class="codeph">version</code> parameters, if the Serialization feature is supported
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4733 d53703e4597 ">
                                    <p>See the interface <code class="codeph">oracle.xml.xquery.OXQSerializationParameters</code> in <a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4771" headers="d53703e4594 ">
                                    <p>Limits on ranges of values for various data types.</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4771 d53703e4597 ">
                                    <p>Decimal and integer values have arbitrary precision.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4778" headers="d53703e4594 ">
                                    <p>The signatures of functions provided by the implementation or via an implementation-defined API (see the XQuery standard, section 2.1.1, <span class="italic">Static Context</span>). 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4778 d53703e4597 ">
                                    <p>See <a href="using-xquery-processor-for-Java.html#GUID-19382C4B-0797-444D-9770-3620525E8978" title="Oracle supports the standard XQuery functions and operators, as well as some Oracle-specific functions.">Oracle XQuery Functions and Operators</a>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4794" headers="d53703e4594 ">
                                    <p>Any environment variables provided by the implementation.</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4794 d53703e4597 ">
                                    <p>Entity resolvers. See <a href="using-xquery-processor-for-Java.html#GUID-5E83610F-647D-4AE5-801B-878244FB6949" title="XDK extends XQJ with an entity resolver framework for controlling how documents, schemas, modules, collations, and external functions are obtained during query processing. The examples in this section show how to use an entity resolver for several types of entities.">XQJ Entity Resolution</a>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4807" headers="d53703e4594 ">
                                    <p>Any rules used for static typing (see the XQuery standard, section 2.2.3.1, <span class="italic">Static Analysis Phase</span>).
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4807 d53703e4597 ">
                                    <p>Defaults to optimistic, pessimistic configurable.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4817" headers="d53703e4594 ">
                                    <p>Any serialization parameters provided by the implementation (see the XQuery standard, section 2.2.4 <span class="italic">Serialization</span>). 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4817 d53703e4597 ">
                                    <p>See <code class="codeph">OXQSerializationParameters</code>. See <a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4836" headers="d53703e4594 ">
                                    <p>The means by which the location hint for a serialization parameter document identifies the corresponding XDM instance (see the XQuery standard, section 2.2.4, <span class="italic">Serialization</span>).
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4836 d53703e4597 ">
                                    <p>Entity resolvers, <code class="codeph">OXQEntityKind.DOCUMENT</code>. See <a href="using-xquery-processor-for-Java.html#GUID-5E83610F-647D-4AE5-801B-878244FB6949" title="XDK extends XQJ with an entity resolver framework for controlling how documents, schemas, modules, collations, and external functions are obtained during query processing. The examples in this section show how to use an entity resolver for several types of entities.">XQJ Entity Resolution</a>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4856" headers="d53703e4594 ">
                                    <p>What error, if any, is returned if an external function's implementation does not return the declared result type (see the XQuery standard, section 2.2.5, <span class="italic">Consistency Constraints</span>).
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4856 d53703e4597 ">
                                    <p>&nbsp;<code class="codeph">XPTY0004</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4869" headers="d53703e4594 ">
                                    <p>Any annotations defined by the implementation, and their associated behavior (see the XQuery standard, section 4.15, <span class="italic">Annotations</span>).
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4869 d53703e4597 ">
                                    <p>You can use <code class="codeph">%ora-fn:context-item</code> to allow the context item of a function caller to be implicitly passed as the first argument to the function.
                                    </p>
                                    <p>For example, this query evaluates to <code class="codeph">e</code>, <code class="codeph">f</code>, <code class="codeph">g</code>:
                                    </p><pre class="pre codeblock"><code>&nbsp;declare %ora-fn:context-item
&nbsp;function local:foo($arg as node()) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-name($arg)
  };

(&lt;e/&gt;, &lt;f/&gt;)/local:foo(), local:foo(&lt;g/&gt;)</code></pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4895" headers="d53703e4594 ">
                                    <p>Any function assertions defined by the implementation.</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4895 d53703e4597 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4902" headers="d53703e4594 ">
                                    <p>The effect of function assertions understood by the implementation on section 2.5.6.3. The judgment subtype-assertions (AnnotationsA, AnnotationsB) .</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4902 d53703e4597 ">
                                    <p>Not applicable.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4909" headers="d53703e4594 ">
                                    <p>Any implementation-defined variables defined by the implementation. (see the XQuery standard, section 3.1.2, <span class="italic">Variable References</span>).
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4909 d53703e4597 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4919" headers="d53703e4594 ">
                                    <p>The ordering associated with <code class="codeph">fn:unordered</code> in the implementation (see the XQuery standard, section 3.11, <span class="italic">Ordered and Unordered Expressions</span>).
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4919 d53703e4597 ">
                                    <p>It does not change the order of the input sequence.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4932" headers="d53703e4594 ">
                                    <p>Any additional information provided for <code class="codeph">try</code>/<code class="codeph">catch</code> by variable <code class="codeph">err:additional</code> (see the XQuery standard, section 3.15, <span class="italic">Try/Catch Expressions</span>).
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4932 d53703e4597 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4951" headers="d53703e4594 ">
                                    <p>The default boundary-space policy (see the XQuery standard, section 4.3, <span class="italic">Boundary-space Declaration</span>). 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4951 d53703e4597 ">
                                    <p><code class="codeph">strip</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4963" headers="d53703e4594 ">
                                    <p>The default collation (see the XQuery standard, section 4.4, <span class="italic">Default Collation Declaration</span>).
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4963 d53703e4597 ">
                                    <p>Unicode.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4973" headers="d53703e4594 ">
                                    <p>The default base URI (see the XQuery standard, section 4.5, <span class="italic">Base URI Declaration</span>).
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4973 d53703e4597 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p><a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJEADJF" title="Table of implementation-defined XQUF items">Table 15-4</a> summarizes the XQuery Update Facility implementation-defined items.
                     </p>
                     <div class="tblformalwide" id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJEADJF">
                        <p class="titleintable">Table 15-4 XQuery Update Facility Implementation-Defined Items</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="XQuery Update Facility Implementation-Defined Items" summary="Table of implementation-defined XQUF items" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="37%" id="d53703e4998">Item</th>
                                 <th align="left" valign="bottom" width="63%" id="d53703e5001">Behavior</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d53703e5006" headers="d53703e4998 ">
                                    <p>The revalidation modes that are supported by this implementation.</p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d53703e5006 d53703e5001 ">
                                    <p><code class="codeph">skip</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d53703e5015" headers="d53703e4998 ">
                                    <p>The default revalidation mode for this implementation.</p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d53703e5015 d53703e5001 ">
                                    <p><code class="codeph">skip</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d53703e5024" headers="d53703e4998 ">
                                    <p>The mechanism (if any) by which an external function can return an XDM instance, or a pending update list, or both to the invoking query.</p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d53703e5024 d53703e5001 ">
                                    <p>Returning a pending update list from an external function is not supported.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d53703e5031" headers="d53703e4998 ">
                                    <p>The semantics of <code class="codeph">fn:put()</code>, including the kinds of nodes accepted as operands by this function.
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d53703e5031 d53703e5001 ">
                                    <p>Any node type is accepted. Storage of the node is determined by the entity resolver. See class <code class="codeph">oracle.xml.xquery.OXQEntity</code> in <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=JAXML" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>, specifically the documentation for entity kind <code class="codeph">UPD_PUT</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p><a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJGHGHD" title="Table of definitions for default context property values">Table 15-5</a> summarizes the default initial values for the static context.
                     </p>
                     <div class="tblformalwide" id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJGHGHD">
                        <p class="titleintable">Table 15-5 Default Initial Values for the Static Context</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Default Initial Values for the Static Context" summary="Table of definitions for default context property values" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="35%" id="d53703e5068">Context Component</th>
                                 <th align="left" valign="bottom" width="65%" id="d53703e5071">Default Value</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5076" headers="d53703e5068 ">
                                    <p>Statically known namespaces</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5076 d53703e5071 ">
                                    <p><code class="codeph">err</code>=<code class="codeph">http://w3.org/2005/xqt-errors</code></p>
                                    <p><code class="codeph">fn</code>=<code class="codeph">http://www.w3.org/2005/xpath-functions</code></p>
                                    <p><code class="codeph">local</code>=<code class="codeph">http://www.w3.org/2005/xquery-local-functions</code></p>
                                    <p><code class="codeph">math</code>=<code class="codeph">http://www.w3.org/2005/xpath-functions/math</code></p>
                                    <p><code class="codeph">ora-ext</code>=<code class="codeph">http://xmlns.oracle.com/xdk/xquery/extension</code></p>
                                    <p><code class="codeph">ora-java</code>=<code class="codeph">http://xmlns.oracle.com/xdk/xquery/java</code></p>
                                    <p><code class="codeph">ora-xml</code>=<code class="codeph">http://xmlns.oracle.com/xdk/xquery/xml</code></p>
                                    <p><code class="codeph">ora-fn</code>=<code class="codeph">http://xmlns.oracle.com/xdk/xquery/function</code></p>
                                    <p><code class="codeph">output</code>=<code class="codeph">http://www.w3.org/2010/xslt-xquery-serialization</code></p>
                                    <p><code class="codeph">xml</code>=<code class="codeph">http://www.w3.org/XML/1998/namespace</code></p>
                                    <p><code class="codeph">xs</code>=<code class="codeph">http://www.w3.org/2001/XMLSchema</code></p>
                                    <p><code class="codeph">xsi</code>=<code class="codeph">http://www.w3.org/2001/XMLSchema-instance</code></p>
                                    <p>Prefixes that begin with <code class="codeph">ora-</code> are reserved for use by Oracle. Additional prefixes that begin with <code class="codeph">ora-</code> may be added to the default statically known namespaces in a future release.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5162" headers="d53703e5068 ">
                                    <p>Default element/type namespace</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5162 d53703e5071 ">
                                    <p>No namespace.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5169" headers="d53703e5068 ">
                                    <p>Default function namespace</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5169 d53703e5071 ">
                                    <p><code class="codeph">fn</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5178" headers="d53703e5068 ">
                                    <p>In-scope schema types</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5178 d53703e5071 ">
                                    <p>Built-in types in <code class="codeph">xs</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5188" headers="d53703e5068 ">
                                    <p>In-scope element declarations</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5188 d53703e5071 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5195" headers="d53703e5068 ">
                                    <p>In-scope attribute declarations</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5195 d53703e5071 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5202" headers="d53703e5068 ">
                                    <p>In-scope variables</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5202 d53703e5071 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5209" headers="d53703e5068 ">
                                    <p>Context item static type</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5209 d53703e5071 ">
                                    <p><code class="codeph">item()</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5218" headers="d53703e5068 ">
                                    <p>Function signatures</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5218 d53703e5071 ">
                                    <p>Functions in namespace <code class="codeph">fn</code>, and constructors for built-in atomic types.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5228" headers="d53703e5068 ">
                                    <p>Statically known collations</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5228 d53703e5071 ">
                                    <p>Unicode codepoint collation and collations derived from class <code class="codeph">java.text.Collator</code> or <code class="codeph">oracle.i18n.text.OraCollator</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5241" headers="d53703e5068 ">
                                    <p>Default collation</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5241 d53703e5071 ">
                                    <p>Unicode codepoint collation:</p>
                                    <p><code class="codeph">http://www.w3.org/2005/xpath-functions/collation/codepoint</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5253" headers="d53703e5068 ">
                                    <p>Construction mode</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5253 d53703e5071 ">
                                    <p><code class="codeph">preserve</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5262" headers="d53703e5068 ">
                                    <p>Ordering mode</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5262 d53703e5071 ">
                                    <p><code class="codeph">ordered</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5271" headers="d53703e5068 ">
                                    <p>Default order for empty sequences</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5271 d53703e5071 ">
                                    <p><code class="codeph">least</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5280" headers="d53703e5068 ">
                                    <p>Boundary-space policy</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5280 d53703e5071 ">
                                    <p><code class="codeph">strip</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5289" headers="d53703e5068 ">
                                    <p>Copy-namespaces mode</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5289 d53703e5071 ">
                                    <p><code class="codeph">preserve</code>, <code class="codeph">no-inherit</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5301" headers="d53703e5068 ">
                                    <p>Base URI</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5301 d53703e5071 ">
                                    <p>As defined in the standard.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5308" headers="d53703e5068 ">
                                    <p>Statically known documents</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5308 d53703e5071 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5315" headers="d53703e5068 ">
                                    <p>Statically known collections</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5315 d53703e5071 ">
                                    <p>None.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5322" headers="d53703e5068 ">
                                    <p>Statically known default collection type</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5322 d53703e5071 ">
                                    <p><code class="codeph">node()*</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5331" headers="d53703e5068 ">
                                    <p>Serialization parameters</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5331 d53703e5071 ">
                                    <p>Same as the defaults for <code class="codeph">OXQSerializationParameters</code>. See <a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>