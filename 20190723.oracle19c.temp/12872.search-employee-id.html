<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Search by Employee ID</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="2 Day + Java Developer's Guide ">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="2 Day + Java Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="2-day-java-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T07:23:23-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2007, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96442-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="create-css-file.html" title="Previous" type="text/html">
      <link rel="next" href="update-employee-record.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="2 Day + Java Developer's Guide">
    <meta name="dcterms.isVersionOf" content="TDPJD">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="create-css-file.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="update-employee-record.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">2 Day + Java Developer's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Search by Employee ID</li>
            </ol>
            <a id="GUID-E732C6D3-DF21-49B8-8058-69BD0950EA2A" name="GUID-E732C6D3-DF21-49B8-8058-69BD0950EA2A"></a>
            
            <h2 id="TDPJD-GUID-E732C6D3-DF21-49B8-8058-69BD0950EA2A" class="sect2"><span class="enumeration_chapter">6 </span>Search by Employee ID
            </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-E732C6D3-DF21-49B8-8058-69BD0950EA2A__GUID-3C71F86E-0E3D-444B-90CC-8C2AFAD2D5DF"></p>
                  <p>“Search by Employee Id” is the functionality where we can search for a particular employee based on their employee Id which is the primary key.  The user needs to input the employee Id and submit the request.  </p>
               </div>
               <!-- class="section" -->
            </div>
            <div class="sect2"><a id="GUID-CAA720B4-F22A-4F3F-A6A1-ACF41CCC0CDB" name="GUID-CAA720B4-F22A-4F3F-A6A1-ACF41CCC0CDB"></a><h3 id="TDPJD-GUID-CAA720B4-F22A-4F3F-A6A1-ACF41CCC0CDB" class="sect3">Employee Java Bean</h3>
               <div>
                  <p><span class="bold">Class Name:</span> <code class="codeph">src/main/java/com/oracle/jdbc/samples/bean/EmployeeBean.java</code></p>
                  <p>Github Location: EmployeeBean.java</p>
                  <p>Description: New method getEmployee(int) for searching employee by ID. </p>
                  <p>Steps to be performed:</p>
                  <p><span class="bold">Step 1:</span> Declare a method <code class="codeph">getEmployee(int)</code></p>
                  <p>Step 1:Instructions for Declaring <code class="codeph">getEmployee(int) </code>method:
                  </p>
                  <p>1. The file EmployeeBean is already created on Day 1 for “ListAll” functionality. We can use the same class and add new methods for each one of the functionalities. </p>
                  <p>2. On the new line, declare a method getEmployee(int) that takes EmployeeId as a parameter. </p>
                  <p><code class="codeph">public List&lt;Employee&gt; </code><code class="codeph">getEmployee(int empId)</code>;
                  </p>
                  <p>Implement a new method <code class="codeph">getEmployee(int)</code> in <code class="codeph">EmployeeBeanImpl.java</code>. 
                  </p>
                  <p><span class="bold">Github Location</span>: <a href="https://github.com/oracle/oracle-db-examples/blob/master/java/HRWebApp/src/main/java/com/oracle/jdbc/samples/bean/JdbcBeanImpl.java" target="_blank">EmployeeBeanImpl.java</a></p>
                  <p>Description: Implement a new method getEmployee(int) to search employee by id. This method takes the employee Id as input parameter and returns an object of type Employee. </p>
                  <p><span class="bold">Steps to be Performed:</span></p>
                  <p><span class="bold">Step 2:</span> Implement a new method <code class="codeph">getEmployee(int)</code>:
                  </p>
                  <p><span class="bold">Step 2: Instructions to create <code class="codeph">getEmployee(int)</code> Method:</span></p>
                  <p>1. Declare the method <span class="italic">getEmployee(int)</span> that returns a List of the objects of type Employee. 
                  </p>
                  <p><code class="codeph">public List&lt;Employee&gt; getEmployee(int empId) { </code></p>
                  <p>2. Declare a variable for the return value of type List&lt;Employee&gt; </p>
                  <p><code class="codeph">List&lt;Employee&gt; returnValue = new ArrayList&lt;&gt;(); </code></p>
                  <p>3. The first try block is for the getting a database connection by invoking the method getConnection(). Declare a variable connection to establish a database connection. </p>
                  <p><code class="codeph">try (Connection connection = getConnection()) {</code></p>
                  <p>4. Start another try block for creating a PreparedStatement. PreparedStatement includes the query that needs to be executed to select an employee based on the employee id.</p>
                  <div class="p"><pre class="pre codeblock"><code>try (PreparedStatement preparedStatement = connection.prepareStatement("SELECT Employee_Id, First_Name, Last_Name, Email, Phone_Number, Job_Id, Salary FROM EMPLOYEES WHERE Employee_Id = ?")) {</code></pre>5. Set the input parameter which is the employee id for the query. </div>
                  <p><code class="codeph">preparedStatement.setInt(1, empId);</code></p>
                  <p>6. Start another try block for ResultSet.</p>
                  <p><code class="codeph">try (ResultSet resultSet = preparedStatement.executeQuery()) {</code></p>
                  <p>7. Check if there is anything returned.  If yes, then add it to returnValue; otherwise, throw an exception. </p>
                  <div class="p"><pre class="pre codeblock"><code>if(resultSet.next()) {
    returnValue.add(new Employee(resultSet));
  } else {
    throw new SQLException("No recrods found");
  }
</code></pre>8. Make sure to close the parenthesis for all the try blocks. There are a total of 3 try blocks which need to be closed. </div>
                  <p>9. Catch the SQLException and log the message in logger as shown below. </p>
                  <div class="p"><pre class="pre codeblock"><code>catch (SQLException ex) {
  logger.log(Level.SEVERE, null, ex);
  throw ex;
}
</code></pre>10. Return the List of Employees from the method getEmployee(int)</div>
                  <p><code class="codeph">return returnValue;</code></p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-AB8BA205-18D0-4A38-A1FE-86F069276779" name="GUID-AB8BA205-18D0-4A38-A1FE-86F069276779"></a><h3 id="TDPJD-GUID-AB8BA205-18D0-4A38-A1FE-86F069276779" class="sect3">Add the code to a Servlet to process the request</h3>
               <div>
                  <p><span class="bold">Class Name</span>: src/main/java/com/oracle/jdbc/samples/web/WebController.java
                  </p>
                  <p><span class="bold">Github Location</span>: <a href="https://github.com/oracle/oracle-db-examples/blob/master/java/HRWebApp/src/main/java/com/oracle/jdbc/samples/web/WebController.java" target="_blank">WebController.java</a></p>
                  <p><span class="bold">Description: </span>This servlet has already been created in Day 1.  We will be adding the relevant code to search by employee id. 
                  </p>
                  <p>Steps to be performed:</p>
                  <p><span class="bold">Step 3:</span> Add the code to search by employee id to the method <code class="codeph">processRequest()</code>.
                  </p>
                  <p><span class="bold">Step 3: Instruction for adding code to <code class="codeph">processRequest()</code>:</span> 
                  </p>
                  <p>1. Declare a varianle ID_KEY to capture the employee id. This is a global variable, hence, needs to be declared outside the method <code class="codeph">processRequest()</code> but within the <code class="codeph">WebController</code> class. 
                  </p>
                  <p><code class="codeph">private static final String ID_KEY = “id”;</code></p>
                  <p>2. The method processRequest() is already created in the “ListAll” feature.  Now, we will add the code to implement “Search by employee id” functionality.</p>
                  <p>3. Declare a variable value of the String type to capture the input from the user. </p>
                  <p><code class="codeph">String value = null;</code></p>
                  <p>4. In addition to what was added for “ListAll” feature, we will add an if condition to handle the new functionality. Get the employee id entered by the user and invoke the method getEmployee(int) to verify if the employee record exists.</p>
                  <div class="p"><pre class="pre codeblock"><code>if ((value = request.getParameter(ID_KEY)) != null) {
      int empId = Integer.valueOf(value).intValue();
      employeeList = employeeBean.getEmployee(empId);
   } else { 
      // Previously used getEmployees() method for Listall feature
      employeeList = employeeBean.getEmployees();
   }
</code></pre></div>
                  <p></p>
                  <p></p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-3CC4988A-D287-4CBC-BCA6-24B7A12B750D" name="GUID-3CC4988A-D287-4CBC-BCA6-24B7A12B750D"></a><h3 id="TDPJD-GUID-3CC4988A-D287-4CBC-BCA6-24B7A12B750D" class="sect3">Create a New HTML for Search by Employee Id</h3>
               <div>
                  <p><span class="bold">Class Name:</span></p>
                  <p><code class="codeph">src/main/webapp/listById.html</code></p>
                  <p>Github Location: <a href="https://github.com/oracle/oracle-db-examples/blob/master/java/HRWebApp/src/main/webapp/listById.html" target="_blank">listById.html</a></p>
                  <p>Description: This is the HTML that shows an input box for user to enter the employee id.  If the employee record is found, then the details of the employee will be shown on the page, otherwise, an error message will be displayed.</p>
                  <p><span class="bold">Steps to be performed:</span> 
                  </p>
                  <p>Step 4: Create the title, head, and stylesheet for the HTML page. </p>
                  <p>Step 5: Create a function to submit the input field i.e, employee id </p>
                  <p>Step 6: Create a method processResponse() &#x2013; To process the JSON response and show the results on the HTML page. </p>
                  <p>1. Create the title, stylesheet, and body for the HTML page. </p>
                  <div class="p"><pre class="pre codeblock"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
&lt;title&gt;List Employee by Id&lt;/title&gt;
&lt;!-- Specify the stylesheet here --&gt;
&lt;link rel="stylesheet" type="text/css" href="css/app.css" &gt;
&lt;!-- Bootstrap JS for the UI --&gt;
&lt;link rel="stylesheet" 
href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"&gt;
&lt;/head&gt;
</code></pre><span class="bold">Step 5: Instructions for handling the input field:</span></div>
                  <p>1. Start the &lt;body&gt; tag and a &lt;input&gt; tag for capturing the employee id. </p>
                  <div class="p"><pre class="pre codeblock"><code>&lt;body&gt;
&lt;div&gt;&lt;label&gt;Employee Id: &lt;/label&gt;
&lt;input id="empId" type="textfield"
onkeypress="return waitForEnter(event)"\&gt;
&lt;/div&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;script&gt;
function waitForEnter(e) {
  if (e.keyCode == 13) {
    var tb = document.getElementById("empId");
    fetchElementById(tb.value)
    return false;
  }
}
&lt;script&gt;
var xmlhttp = new XMLHttpRequest();
var url = "WebController";
</code></pre></div>
                  <p>3. Define the action when the requests are sent i.e., when the links for each one of the functionalities is selected. </p>
                  <div class="p"><pre class="pre codeblock"><code>xmlhttp.onreadystatechange=function() {
     if (xmlhttp.readyState == 4 &amp;&amp; xmlhttp.status == 200) {
       processResponse(xmlhttp.responseText);
     }
   }
xmlhttp.open("GET", url, true);
xmlhttp.send();
</code></pre><span class="bold">Step 6: Instructions for Creating <code class="codeph">processResponse()</code> method:</span></div>
                  <p>1. Create the function <code class="codeph">processResponse()</code> to display JSON results on HTML page. 
                  </p>
                  <div class="p"><pre class="pre codeblock"><code>function processResponse(response) {
//Process the JSON respnse into an array.
var arr = JSON.parse(response);
     var i;
var out = "&lt;table&gt;";
keys = Object.keys(arr[0]);

// Print Headers
out += "&lt;tr&gt;"
for(i = 0; i &lt; keys.length; ++i) {
out += "&lt;th&gt;"+keys[i]+"&lt;/th&gt;"
}
out += "&lt;/tr&gt;";
// Print values
for(j = 0; j &lt; arr.length; j++) {
out += "&lt;tr&gt;"
for(i = 0; i &lt; keys.length; ++i) {
out += "&lt;td&gt;"+arr[j][keys[i]]+"&lt;/td&gt;"

}
out += "&lt;/tr&gt;"
}
out += "&lt;/table&gt;";
document.getElementById("id-emp").innerHTML = out;
}</code></pre></div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>