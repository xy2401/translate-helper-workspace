<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="An explanation is given of how to use the Extensible Markup Language (XML) parser for C.">
      <meta name="description" content="An explanation is given of how to use the Extensible Markup Language (XML) parser for C.">
      <title>Using the XML Parser for C</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content="An explanation is given of how to use the Extensible Markup Language (XML) parser for C.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="xml-developers-kit-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T05:58:48-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96292-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-XSLT-and-XVM-processors-for-C.html" title="Previous" type="text/html">
      <link rel="next" href="using-binary-XML-with-C.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML Developers Kit Programmers Guide">
    <meta name="dcterms.isVersionOf" content="ADXDK">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-XSLT-and-XVM-processors-for-C.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-binary-XML-with-C.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XDK-for-C.html" property="item" typeof="WebPage"><span property="name">Oracle XML Developer's Kit for C</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Using the XML Parser for C</li>
            </ol>
            <a id="GUID-6A39885C-865B-4386-B49C-1FBAB09529C6" name="GUID-6A39885C-865B-4386-B49C-1FBAB09529C6"></a><a id="ADXDK1035"></a><a id="ADXDK1400"></a>
            
            <h2 id="ADXDK-GUID-6A39885C-865B-4386-B49C-1FBAB09529C6" class="sect2"><span class="enumeration_chapter">5 </span>Using the XML Parser for C
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>An explanation is given of how to use the Extensible Markup Language (XML) parser for C.</p>
               <div class="section"></div>
               <!-- class="section" -->
            </div><a id="ADXDK1036"></a><a id="ADXDK19749"></a><div class="props_rev_3"><a id="GUID-26A982BF-4D33-4C90-8BFA-F227D3C5CE5B" name="GUID-26A982BF-4D33-4C90-8BFA-F227D3C5CE5B"></a><h3 id="ADXDK-GUID-26A982BF-4D33-4C90-8BFA-F227D3C5CE5B" class="sect3">Introduction to the XML Parser for C</h3>
               <div>
                  <p>Topics here include prerequisites and standards for the XML parser for C.</p>
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-26A982BF-4D33-4C90-8BFA-F227D3C5CE5B__GUID-121BFA4D-E639-4F87-B8AC-D5E30303ADCB">
                        <p class="notep1">See Also:</p>
                        <p><a href="XML-parsing-for-Java.html#GUID-4BC9CC77-9343-421D-A5A0-9F073961DC75" title="XML parsing for Java is described.">Introduction to XML Parsing for Java</a> for a generic introduction to XML parsing with Document Object Model (DOM) and Simple API for XML (SAX). Much of the information in the introduction is language-independent and applies equally to C.
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19750"></a><div class="sect3"><a id="GUID-A2821602-38A1-4613-8DB4-5FEBD5C8027E" name="GUID-A2821602-38A1-4613-8DB4-5FEBD5C8027E"></a><h4 id="ADXDK-GUID-A2821602-38A1-4613-8DB4-5FEBD5C8027E" class="sect4">Prerequisites for Using the XML Parser for C</h4>
                  <div>
                     <p>The Oracle XML parser for C reads an XML document and uses DOM or SAX application programming interfaces (APIs) to provide programmatic access to its content and structure. You can use the parser in validating or nonvalidating mode. A pull parser is also available.</p>
                     <p>This chapter assumes that you are familiar with these technologies:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="glossary.html#GUID-0969F796-24C8-4A02-B671-B2EE8BD49F5B"><span class="xrefglossterm">Document Object Model (DOM)</span></a>. DOM is an in-memory tree representation of the structure of an XML document.
                           </p>
                        </li>
                        <li>
                           <p><a href="glossary.html#GUID-6B57591D-3889-4BCD-8598-58ED2DC9E9EE"><span class="xrefglossterm">Simple API for XML (SAX)</span></a>. SAX is a standard for event-based XML parsing.
                           </p>
                        </li>
                        <li>
                           <p><a href="using-XML-parser-for-C.html#GUID-C244DBA6-8578-4224-B21D-CD5FF48B0EEC" title="The XML Pull Parser is an implementation of the XML Events interface. The XML Pull Parser and the SAX parser are similar, but using the Pull Parser, the application (consumer) drives the events, while in SAX, the parser (producer) drives the events.">Using the XML Pull Parser for C</a>. Pull Parser uses XML events.
                           </p>
                        </li>
                        <li>
                           <p><a href="glossary.html#GUID-F2AC11F4-F0D2-4EFB-B28B-8114CC0D7C38"><span class="xrefglossterm">document type definition (DTD)</span></a>. An XML DTD defines the legal structure of an XML document.
                           </p>
                        </li>
                        <li>
                           <p><a href="glossary.html#GUID-25F8F1D2-58B2-4A3F-B38C-3C2652C9C19C"><span class="xrefglossterm">XML Schema</span></a>. Like a DTD, an XML schema defines the legal structure of an XML document.
                           </p>
                        </li>
                        <li>
                           <p><a href="glossary.html#GUID-55AB1901-F16B-4FBD-9C2B-7164C71662B0" title="Related element names or attributes within an XML document. Namespace syntax and usage are defined by a W3C recommendation. For example, element <xsl:apply-templates/&gt; is identified as part of the XSL namespace. Namespaces are declared in an XML document or a DTD before they are used, using this attribute syntax: xmlns:xsl="http://www.w3.org/TR/WD-xsl"."><span class="xrefglossterm">XML Namespaces</span></a>. Namespaces are a mechanism for differentiating element and attribute names.
                           </p>
                        </li>
                     </ul>
                     <p>If you require a general introduction to the preceding technologies, consult the XML resources listed in <a href="preface.html#GUID-2CD1F6B6-C8EC-42E3-97F2-589AABF9AFFB" title="Oracle resources that are related to this document are listed.">Related Documents</a>.
                     </p>
                  </div>
               </div><a id="ADXDK19751"></a><div class="props_rev_3"><a id="GUID-80662259-9C17-4F27-A03B-99CC6E1196EB" name="GUID-80662259-9C17-4F27-A03B-99CC6E1196EB"></a><h4 id="ADXDK-GUID-80662259-9C17-4F27-A03B-99CC6E1196EB" class="sect4">Standards and Specifications for  the XML Parser for C</h4>
                  <div>
                     <p>The standards and specifications for the XDK XML parser are described.</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>XML 1.0 is a W3C Recommendation. The Oracle XML Developer's Kit (XDK) for C API provides full support for XML 1.0 (Second Edition).</p>
                        </li>
                        <li>
                           <p>The DOM Level 1, Level 2, and Level 3 specifications are World Wide Web Consortium (W3C) Recommendations. The XDK for C API provides full support for DOM Level 1 and 2, but no support for Level 3. </p>
                        </li>
                        <li>
                           <p>SAX is available in version 1.0, which is deprecated, and 2.0. SAX is not a W3C specification. The XDK for C API provides full support for both SAX 1.0 and 2.0.</p>
                        </li>
                        <li>
                           <p>XML Namespaces is a W3C Recommendation.</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="XDK-standards.html#GUID-795A483B-12AC-4F6D-A606-6BE9DA963F0F" title="A description is given of the Oracle XML Developer's Kit (XDK) standards.">Oracle XML Developer's Kit Standards</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDK19752"></a><div class="props_rev_3"><a id="GUID-39C29945-6705-46C8-815B-DBBBF5D37C03" name="GUID-39C29945-6705-46C8-815B-DBBBF5D37C03"></a><h3 id="ADXDK-GUID-39C29945-6705-46C8-815B-DBBBF5D37C03" class="sect3">Using the XML Parser API for C</h3>
               <div>
                  <p>Oracle XML parser for C checks if an XML document is well-formed, and optionally validates it against a DTD. Your application can access the parsed data through the DOM or SAX APIs.</p>
               </div><a id="ADXDK19754"></a><a id="ADXDK19753"></a><div class="props_rev_3"><a id="GUID-CDED5CE7-8514-4680-90EE-47C82C4303E8" name="GUID-CDED5CE7-8514-4680-90EE-47C82C4303E8"></a><h4 id="ADXDK-GUID-CDED5CE7-8514-4680-90EE-47C82C4303E8" class="sect4">Overview of the Parser API for C</h4>
                  <div>
                     <p>The core of the XML parsing API are the XML, DOM, and SAX APIs. </p>
                     <p><a href="using-XML-parser-for-C.html#GUID-CDED5CE7-8514-4680-90EE-47C82C4303E8__CCHEDFAC" title="Summarizes the C APIs for the XML parser.">Table 5-1</a> describes the interfaces for these APIs. See <a href="../caxml/datatypes.html#CAXML00100" target="_blank"><span><cite>Oracle Database XML C API Reference</cite></span></a> for the complete API documentation.
                     </p>
                     <div class="tblformalwide" id="GUID-CDED5CE7-8514-4680-90EE-47C82C4303E8__CCHEDFAC">
                        <p class="titleintable">Table 5-1 Interfaces for XML, DOM, and SAX APIs</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Interfaces for XML, DOM, and SAX APIs" summary="Summarizes the C APIs for the XML parser." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="10%" id="d19652e581">Package</th>
                                 <th align="left" valign="bottom" width="62%" id="d19652e584">Interfaces</th>
                                 <th align="left" valign="bottom" width="27%" id="d19652e587">Function Name Convention</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="10%" id="d19652e592" headers="d19652e581 ">
                                    <p>XML</p>
                                 </td>
                                 <td align="left" valign="top" width="62%" headers="d19652e592 d19652e584 ">
                                    <p>This package implements a single <code class="codeph">XML</code> interface. The interface defines functions for these tasks:
                                    </p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>Creating and destroying contexts. A top-level XML context (<code class="codeph">xmlctx</code>) shares common information between cooperating XML components.
                                          </p>
                                       </li>
                                       <li>
                                          <p>Creating and parsing XML documents and DTDs.</p>
                                       </li>
                                    </ul>
                                 </td>
                                 <td align="left" valign="top" width="27%" headers="d19652e592 d19652e587 ">
                                    <p>Function names begin with the string <code class="codeph">Xml</code>. 
                                    </p>
                                    <p>See <a href="../caxml/package-XmlDiff-API.html#CAXML6192" target="_blank"><span><cite>Oracle Database XML C API Reference</cite></span></a> for API documentation.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="10%" id="d19652e626" headers="d19652e581 ">
                                    <p>DOM</p>
                                 </td>
                                 <td align="left" valign="top" width="62%" headers="d19652e626 d19652e584 ">
                                    <p>This package provides programmatic access to parsed XML. The package implements these interfaces:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p><code class="codeph">Attr</code> defines get and set functions for XML attributes.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">CharacterData</code> defines functions for manipulating character data.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">Document</code> defines functions for creating XML nodes, getting information about an XML document, and setting the DTD for a document.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">DocumentType</code> defines get functions for DTDs.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">Element</code> defines get and set functions for XML elements.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">Entity</code> defines get functions for XML entities.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">NamedNodeMap</code> defines get functions for named nodes.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">Node</code> defines get and set functions for XML nodes.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">NodeList</code> defines functions that free a node list and get a node from a list.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">Notation</code> defines functions that get the system and public ID from a node.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">ProcessingInstruction</code> defines get and set functions for processing instructions.
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">Text</code> defines a function that splits a text node into two.
                                          </p>
                                       </li>
                                    </ul>
                                 </td>
                                 <td align="left" valign="top" width="27%" headers="d19652e626 d19652e587 ">
                                    <p>Function names begin with the string <code class="codeph">XmlDom</code>. 
                                    </p>
                                    <p>See <a href="../caxml/package-DOM-API.html#CAXML00300" target="_blank"><span><cite>Oracle Database XML C API Reference</cite></span></a> for API documentation.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="10%" id="d19652e709" headers="d19652e581 ">
                                    <p>SAX</p>
                                 </td>
                                 <td align="left" valign="top" width="62%" headers="d19652e709 d19652e584 ">
                                    <p>This package provides programmatic access to parsed XML. The package implements the <code class="codeph">SAX</code> interface, which defines functions that receive notifications for SAX events.
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="27%" headers="d19652e709 d19652e587 ">
                                    <p>Function names begin with the string <code class="codeph">XmlSax</code>. 
                                    </p>
                                    <p>See <a href="../caxml/package-SAX-API.html#CAXML5908" target="_blank"><span><cite>Oracle Database XML C API Reference</cite></span></a> for API documentation.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="10%" id="d19652e733" headers="d19652e581 ">
                                    <p>XML Pull Parser</p>
                                 </td>
                                 <td align="left" valign="top" width="62%" headers="d19652e733 d19652e584 ">
                                    <p>XML events is a representation of an XML document which is similar to SAX events in that the document is represented as a sequence of events like start tag, end tag, comment, and so on. The difference is that SAX events are driven by the parser (producer) and XML events are driven by the application (consumer).</p>
                                 </td>
                                 <td align="left" valign="top" width="27%" headers="d19652e733 d19652e587 ">
                                    <p>Function names begin with the string <code class="codeph">XmlEv</code>.
                                    </p>
                                    <p>See <a href="../caxml/package-Event-API.html#CAXML02000" target="_blank"><span><cite>Oracle Database XML C API Reference</cite></span></a> for API documentation.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div><a id="ADXDK19756"></a><a id="ADXDK19755"></a><div class="props_rev_3"><a id="GUID-8D335450-FD8E-483D-974E-5BD5C05E2BB3" name="GUID-8D335450-FD8E-483D-974E-5BD5C05E2BB3"></a><h5 id="ADXDK-GUID-8D335450-FD8E-483D-974E-5BD5C05E2BB3" class="sect5">XML Parser for C Data Types</h5>
                     <div>
                        <p>The data types used in the XML parser for C are described.</p>
                        <p>See <a href="../caxml/datatypes.html#CAXML00100" target="_blank"><span><cite>Oracle Database XML C API Reference</cite></span></a> for the complete list of data types for XDK for C.
                        </p>
                        <div class="tblformal" id="GUID-8D335450-FD8E-483D-974E-5BD5C05E2BB3__G455054">
                           <p class="titleintable">Table 5-2  Data Types Used in the XML Parser for C </p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title=" Data Types Used in the XML Parser for C " summary="This table describes the data types used in the XML parser for C. Datatype and Description are the column names." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="17%" id="d19652e850">Data Type</th>
                                    <th align="left" valign="bottom" width="83%" id="d19652e853">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="17%" id="d19652e858" headers="d19652e850 ">
                                       <p><code class="codeph">oratext</code></p>
                                    </td>
                                    <td align="left" valign="top" width="83%" headers="d19652e858 d19652e853 ">
                                       <p>String pointer</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="17%" id="d19652e866" headers="d19652e850 ">
                                       <p><code class="codeph">xmlctx</code></p>
                                    </td>
                                    <td align="left" valign="top" width="83%" headers="d19652e866 d19652e853 ">
                                       <p>Master XML context </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="17%" id="d19652e874" headers="d19652e850 ">
                                       <p><code class="codeph">xmlsaxcb</code></p>
                                    </td>
                                    <td align="left" valign="top" width="83%" headers="d19652e874 d19652e853 ">
                                       <p>SAX callback structure (SAX only) </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="17%" id="d19652e882" headers="d19652e850 ">
                                       <p><code class="codeph">ub4</code></p>
                                    </td>
                                    <td align="left" valign="top" width="83%" headers="d19652e882 d19652e853 ">
                                       <p>32-bit (or larger) unsigned integer </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="17%" id="d19652e890" headers="d19652e850 ">
                                       <p><code class="codeph">uword</code></p>
                                    </td>
                                    <td align="left" valign="top" width="83%" headers="d19652e890 d19652e853 ">
                                       <p>Native unsigned integer </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div><a id="ADXDK19757"></a><div class="props_rev_3"><a id="GUID-42B8F527-3013-4896-80EF-624B983BA725" name="GUID-42B8F527-3013-4896-80EF-624B983BA725"></a><h5 id="ADXDK-GUID-42B8F527-3013-4896-80EF-624B983BA725" class="sect5">XML Parser for C Defaults</h5>
                     <div>
                        <p>The defaults for the XML parser for C are described.</p>
                        <p>These are the defaults:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Character set encoding is 8-bit encoding of Unicode (UTF-8). If all your documents are ASCII, then setting the encoding to US-ASCII increases performance.</p>
                           </li>
                           <li>
                              <p>The parser prints messages to <code class="codeph">stderr</code> unless an error handler is provided.
                              </p>
                           </li>
                           <li>
                              <p>The parser checks inputs documents for well-formedness but not validity. You can set the property "validate" to validate the input. </p>
                              <div class="infoboxnote" id="GUID-42B8F527-3013-4896-80EF-624B983BA725__GUID-8184CEC3-4F19-435D-97AA-FB84D46DC180">
                                 <p class="notep1">Note:</p>
                                 <p>Oracle recommends that you set the default encoding explicitly if using only single byte character sets (such as US-ASCII or any of the ISO-8859 character sets) for faster performance than is possible with multibyte character sets such as UTF-8.</p>
                              </div>
                           </li>
                           <li>
                              <p>The parser conforms with the XML 1.0 specification when processing white space, that is, the parser reports all white space to the application but indicates which white space can be ignored. However, some applications may prefer to set the property "discard-white space," which discards all white space between an end-element tag and this start-element tag.</p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-42B8F527-3013-4896-80EF-624B983BA725__GUID-0A91D34B-745C-4173-9F04-CF2D34969529">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../caxml/package-DOM-API.html#CAXML00300" target="_blank"><span><cite>Oracle Database XML C API Reference</cite></span></a> for the DOM, SAX, pull parser, and callback APIs.
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="ADXDK19759"></a><a id="ADXDK19758"></a><div class="props_rev_3"><a id="GUID-4C2307E5-610E-470C-B1BB-BA81D6D1D9D5" name="GUID-4C2307E5-610E-470C-B1BB-BA81D6D1D9D5"></a><h4 id="ADXDK-GUID-4C2307E5-610E-470C-B1BB-BA81D6D1D9D5" class="sect4">XML Parser for C Calling Sequence</h4>
                  <div>
                     <p>The calling sequence for the XML parser for C is illustrated.</p>
                     <div class="figure" id="GUID-4C2307E5-610E-470C-B1BB-BA81D6D1D9D5__BABCDCDC">
                        <p class="titleinfigure">Figure 5-1 XML Parser for C Calling Sequence</p><img src="img/adxdk096.gif" width="589" alt="Description of Figure 5-1 follows" title="Description of Figure 5-1 follows" longdesc="img_text/adxdk096.html"><br><a href="img_text/adxdk096.html">Description of "Figure 5-1 XML Parser for C Calling Sequence"</a></div>
                     <!-- class="figure" -->
                  </div>
               </div><a id="ADXDK19760"></a><div class="props_rev_3"><a id="GUID-12636E6D-1E3A-4B2C-941E-FF59196FD7DA" name="GUID-12636E6D-1E3A-4B2C-941E-FF59196FD7DA"></a><h4 id="ADXDK-GUID-12636E6D-1E3A-4B2C-941E-FF59196FD7DA" class="sect4">Using the XML Parser for C: Basic Process</h4>
                  <div>
                     <p>The basic process for using the XML parser for C is described.</p>
                     <div class="section">
                        <p>Perform these steps in your application:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Initialize the parsing process with the <code class="codeph">XmlCreate()</code> function. The following sample code fragment is from <code class="codeph">DOMNamespace.c</code>:</span><div><pre class="pre codeblock"><code>xmlctx     *xctx;
...
xctx = XmlCreate(&amp;ecode, (oratext *) "namespace_xctx", NULL);
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Parse the input item, which can be an XML document or string buffer.</span><div>
                              <p>If you are parsing with DOM, invoke the <code class="codeph">XmlLoadDom()</code> function. The following sample code fragment is from <code class="codeph">DOMNamespace.c</code>:
                              </p><pre class="pre codeblock"><code>xmldocnode *doc;
...
doc = XmlLoadDom(xctx, &amp;ecode, "file", DOCUMENT,
                 "validate", TRUE, "discard_whitespace", TRUE, NULL);
</code></pre><p>If you are parsing with SAX, invoke the <code class="codeph">XmlLoadSax()</code> function. The following sample code fragment is from <code class="codeph">SAXNamespace.c</code>:
                              </p><pre class="pre codeblock"><code>xmlerr      ecode;
...
ecode = XmlLoadSax(xctx, &amp;sax_callback, &amp;sc, "file", DOCUMENT,
                   "validate", TRUE, "discard_whitespace", TRUE, NULL);
</code></pre><p>If you are using the pull parser, then include these steps to create the event context and load the document to parse:</p><pre class="pre codeblock"><code>evctx = XmlEvCreatePPCtx(xctx, &amp;xerr, NULL);
XmlEvLoadPPDoc(xctx, evctx, "File", input_filenames[i], 0, NULL);
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>If you are using the DOM interface, then include these steps:</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Use the <code class="codeph">XmlLoadDom()</code> function to invoke <code class="codeph">XmlDomGetDocElem()</code>. This step invokes other DOM functions, which are typically node or print functions that output the DOM document, as required. The following sample code fragment is from <code class="codeph">DOMNamespace.c</code>:
                                    </p><pre class="pre codeblock"><code>printElements(xctx, XmlDomGetDocElem(xctx, doc));
</code></pre></li>
                                 <li>
                                    <p>Invoke the <code class="codeph">XmlFreeDocument()</code> function to clean up any data structures created during the parse process. The following sample code fragment is from <code class="codeph">DOMNamespace.c</code>:
                                    </p><pre class="pre codeblock"><code>XmlFreeDocument(xctx, doc);
</code></pre></li>
                              </ul>
                              <p>If you are using the SAX interface, then include these steps:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Process the results of the invocation of <code class="codeph">XmlLoadSax()</code> with a callback function, such as:
                                    </p><pre class="pre codeblock"><code>xmlsaxcb saxcb = {
 UserStartDocument,  /* user's own callback functions */
 UserEndDocument,
 /* ... */
}; 

if (XmlLoadSax(xctx, &amp;saxcb, NULL, "file", "some_file.xml", NULL) != 0)
  /* an error occured */
</code></pre></li>
                                 <li>
                                    <p>Register the callback functions. You can set any of the SAX callback functions to <code class="codeph">NULL</code> if not needed.
                                    </p>
                                 </li>
                              </ul>
                              <p>If you are using the pull parser, iterate over the events using:</p><pre class="pre codeblock"><code>cur_event = XmlEvNext(evctx);
</code></pre><p>Use the Get APIs to get information about that event.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Use <code class="codeph">XmlFreeDocument()</code> to clean up the memory and structures used during a parse. The program does not free memory allocated for parameters passed to the SAX callbacks or for nodes and data stored with the DOM parse tree until you invoke <code class="codeph">XMLFreeDocument()</code> or <code class="codeph">XMLDestroy()</code>. The following sample code fragment is from <code class="codeph">DOMNamespace.c</code>:</span><div><pre class="pre codeblock"><code>XmlFreeDocument(xctx, doc);
</code></pre><p>Either return to Step 2 or proceed to the next step.</p>
                              <p>For the pull parser invoke <code class="codeph">XmlEvCleanPPCtx()</code> to release memory and structures used during the parse. The application can invoke <code class="codeph">XmlEvLoadPPDoc()</code> again to parse another document. Or, it can invoke <code class="codeph">XMLEvDestroyPPCtx()</code> after which the pull parser context cannot be used again.
                              </p><pre class="pre codeblock"><code>XmlEvCleanPPCtx(xctx, evctx);
...
XmlEvDestroyPPCtx(xctx, evctx);
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Terminate the parsing process with <code class="codeph">XmlDestroy()</code>. The following sample code fragment is from <code class="codeph">DOMNamespace.c</code>:</span><div><pre class="pre codeblock"><code>(void) XmlDestroy(xctx);
</code></pre><p>If threads fork off somewhere in the sequence of invocations between initialization and termination, the application produces unpredictable behavior and results.</p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>You can use the memory callback functions <code class="codeph">XML_ALLOC_F</code> and <code class="codeph">XML_FREE_F</code> for your own memory allocation. If you do, then specify both functions.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="using-XML-parser-for-C.html#GUID-C244DBA6-8578-4224-B21D-CD5FF48B0EEC" title="The XML Pull Parser is an implementation of the XML Events interface. The XML Pull Parser and the SAX parser are similar, but using the Pull Parser, the application (consumer) drives the events, while in SAX, the parser (producer) drives the events.">Using the XML Pull Parser for C</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="ADXDK19762"></a><a id="ADXDK19761"></a><div class="props_rev_3"><a id="GUID-247C9003-4689-447B-94B1-1EAAD497C45C" name="GUID-247C9003-4689-447B-94B1-1EAAD497C45C"></a><h4 id="ADXDK-GUID-247C9003-4689-447B-94B1-1EAAD497C45C" class="sect4">Running the XML Parser for C Demo Programs</h4>
                  <div>
                     <p>The <code class="codeph">$ORACLE_HOME/xdk/demo/c/</code> (UNIX) and <code class="codeph">%ORACLE_HOME%\xdk\demo\c</code> (Windows) directories include several XML applications that show how to use the XML parser for C with the DOM and SAX interfaces. 
                     </p>
                     <div class="section">
                        <p><a href="using-XML-parser-for-C.html#GUID-247C9003-4689-447B-94B1-1EAAD497C45C__CCHJHGCD" title="Describes the subdirectories of the /demo/java directory.">Table 5-3</a> describes the demos.
                        </p>
                        <p>The <code class="codeph">make</code> utility compiles the source file <span class="italic"><code class="codeph">fileName.c</code></span> to produce the demo program <span class="italic"><code class="codeph">fileName</code></span> and the output file <span class="italic"><code class="codeph">fileName.out</code></span> . The  <span class="italic"><code class="codeph">fileName.std</code></span> is the expected output.
                        </p>
                        <div class="tblformalwide" id="GUID-247C9003-4689-447B-94B1-1EAAD497C45C__CCHJHGCD">
                           <p class="titleintable">Table 5-3 C Parser Demos</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="C Parser Demos" summary="Describes the subdirectories of the /demo/java directory." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="10%" id="d19652e1480">Directory</th>
                                    <th align="left" valign="bottom" width="16%" id="d19652e1483">Contents</th>
                                    <th align="left" valign="bottom" width="74%" id="d19652e1486">Demos</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d19652e1491" headers="d19652e1480 ">
                                       <p><code class="codeph">dom</code></p>
                                    </td>
                                    <td align="left" valign="top" width="16%" headers="d19652e1491 d19652e1483 "><pre class="oac_no_warn" dir="ltr">DOMNamespace.c
DOMSample.c
FullDom.c
FullDom.xml
NSExample.xml
Traverse.c
XPointer.c
class.xml
cleo.xml
pantry.xml</pre></td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1491 d19652e1486 ">
                                       <p>The following demo programs use the DOM API:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>The <code class="codeph">DOMNamespace</code> program uses Namespace extensions to the DOM API. It prints out all elements and attributes of <code class="codeph">NSExample.xml</code> along with full namespace information.
                                             </p>
                                          </li>
                                          <li>
                                             <p>The <code class="codeph">DOMSample</code> program uses DOM APIs to display an outline of <span class="italic">Cleopatra</span>, that is, the XML elements <code class="codeph">ACT</code> and <code class="codeph">SCENE</code>. The <code class="codeph">cleo.xml</code> document contains the XML version of Shakespeare's <span class="italic">The Tragedy of Antony and Cleopatra</span>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>The <code class="codeph">FullDom</code> program shows sample usage of the full DOM interface. It exercises all the invocations. The program accepts <code class="codeph">FullDom.xml</code>, which shows the use of entities, as input.
                                             </p>
                                          </li>
                                          <li>
                                             <p>The <code class="codeph">Traverse</code> program shows the use of DOM iterators, tree walkers, and ranges. The program accepts the <code class="codeph">class.xml</code> document, which describes a college Calculus course, as input.
                                             </p>
                                          </li>
                                          <li>
                                             <p>The <code class="codeph">XPointer</code> program shows the use of the XML Pointer Language by locating the children of the <code class="codeph">&lt;pantry&gt;</code> element in <code class="codeph">pantry.xml</code>.
                                             </p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d19652e1564" headers="d19652e1480 ">
                                       <p><code class="codeph">sax</code></p>
                                    </td>
                                    <td align="left" valign="top" width="16%" headers="d19652e1564 d19652e1483 "><pre class="oac_no_warn" dir="ltr">NSExample.xml
SAXNamespace.c
SAXSample.c
cleo.xml</pre></td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1564 d19652e1486 ">
                                       <p>The following demo programs use the SAX APIs:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>The <code class="codeph">SAXNamespace</code> program uses namespace extensions to the SAX API. It prints out all elements and attributes of <code class="codeph">NSExample.xml</code> along with full namespace information.
                                             </p>
                                          </li>
                                          <li>
                                             <p>The <code class="codeph">SAXSample</code> program uses SAX APIs to show all lines in the play <span class="italic">Cleopatra</span> containing a given word. If you do not specify a word, then it uses the word "death." The <code class="codeph">cleo.xml</code> document contains the XML version of Shakespeare's <span class="italic">The Tragedy of Antony and Cleopatra</span>.
                                             </p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>You can find documentation that describes how to compile and run the sample programs in the <code class="codeph">README</code> in the same directory. The basic steps are:
                        </p>
                        <ol>
                           <li>
                              <p>Change into the <code class="codeph">$ORACLE_HOME/xdk/demo/c</code> directory (UNIX) or <code class="codeph">%ORACLE_HOME%\xdk\demo\c</code> directory (Windows).
                              </p>
                           </li>
                           <li>
                              <p>Make sure that your environment variables are set as described in <a href="getting-started-with-XDK-for-C.html#GUID-8BCD12B3-3D56-4F00-8C2E-B46AA6A428B7" title="The UNIX environment variables required for use with XDK for C components is described.">Setting Up XDK for C Environment Variables on UNIX</a> and <a href="getting-started-with-XDK-for-C.html#GUID-C64E22E0-7FAE-4409-8A04-758F4458F0D9" title="The Windows environment variables required for use with the XDK for C components are described.">Setting Up XDK for C Environment Variables on Windows</a>.
                              </p>
                           </li>
                           <li>
                              <p>Run <code class="codeph">make</code> (UNIX) or <code class="codeph">Make.bat</code> (Windows) at the system prompt. The <code class="codeph">make</code> utility changes into each demo subdirectory and runs <code class="codeph">make</code> to do this:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>Compiles the C source files with the <code class="codeph">cc</code> utility. For example, the <code class="codeph">Makefile</code>  in the <code class="codeph">$ORACLE_HOME/xdk/demo/c/dom</code> directory includes these line:
                                    </p><pre class="oac_no_warn" dir="ltr">$(CC) -o DOMSample $(INCLUDE) $@.c $(LIB)
</pre></li>
                                 <li>
                                    <p>Runs each demo program and redirects the output to a file. For example, the <code class="codeph">Makefile</code>  in the <code class="codeph">$ORACLE_HOME/xdk/demo/c/dom</code> directory includes this line:
                                    </p><pre class="oac_no_warn" dir="ltr">./DOMSample &gt; DOMSample.out
</pre></li>
                              </ol>
                           </li>
                           <li>
                              <p>Compare the <code class="codeph">*.std</code> files to the <code class="codeph">*.out</code> files for each program. The <code class="codeph">*.std</code> file contains the expected output for each program. For example, <code class="codeph">DOMSample.std</code> contains the expected output from running <code class="codeph">DOMSample</code>.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19764"></a><a id="ADXDK19763"></a><div class="props_rev_3"><a id="GUID-D7F8125B-A91C-41FA-A75E-5B9E0C620645" name="GUID-D7F8125B-A91C-41FA-A75E-5B9E0C620645"></a><h4 id="ADXDK-GUID-D7F8125B-A91C-41FA-A75E-5B9E0C620645" class="sect4">Using the C XML Parser Command-Line Utility</h4>
                  <div>
                     <p>The <code class="codeph">xml</code> utility, which is located in <code class="codeph">$ORACLE_HOME/bin</code> (UNIX) or <code class="codeph">%ORACLE_HOME%\bin</code> (Windows), is a command-line interface that parses XML documents. It checks for both well-formedness and validity. 
                     </p>
                     <div class="section">
                        <p>To use <code class="codeph">xml</code> ensure that your environment is set up as described in <a href="getting-started-with-XDK-for-C.html#GUID-8BCD12B3-3D56-4F00-8C2E-B46AA6A428B7" title="The UNIX environment variables required for use with XDK for C components is described.">Setting Up XDK for C Environment Variables on UNIX</a> and <a href="getting-started-with-XDK-for-C.html#GUID-C64E22E0-7FAE-4409-8A04-758F4458F0D9" title="The Windows environment variables required for use with the XDK for C components are described.">Setting Up XDK for C Environment Variables on Windows</a>.
                        </p>
                        <p>Use this syntax on the command line to invoke <code class="codeph">xml</code>. Use <code class="codeph">xml.exe</code> for Windows:
                        </p><pre class="oac_no_warn" dir="ltr">xml [options] [document URI]
xml -f [options] [document filespec]
</pre><p><a href="using-XML-parser-for-C.html#GUID-D7F8125B-A91C-41FA-A75E-5B9E0C620645__G1016893" title="This table describes the command-line options. Option and Description are the columns.">Table 5-4</a> describes the command-line options.
                        </p>
                        <div class="tblformal" id="GUID-D7F8125B-A91C-41FA-A75E-5B9E0C620645__G1016893">
                           <p class="titleintable">Table 5-4 C XML Parser Command-Line Options </p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="C XML Parser Command-Line Options " summary="This table describes the command-line options. Option and Description are the columns." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="26%" id="d19652e1821">Option</th>
                                    <th align="left" valign="bottom" width="74%" id="d19652e1824">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1829" headers="d19652e1821 ">
                                       <p><code class="codeph">-B</code> BaseURI
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1829 d19652e1824 ">
                                       <p>Sets the base URI for the XSLT processor. The base URI of <code class="codeph">http://pqr/xsl.txt</code> resolves <code class="codeph">pqr.txt</code> to <code class="codeph">http://pqr/pqr.txt</code>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1847" headers="d19652e1821 ">
                                       <p><code class="codeph">-c</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1847 d19652e1824 ">
                                       <p>Checks well-formedness, but performs no validation.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1855" headers="d19652e1821 ">
                                       <p><code class="codeph">-e </code><span class="italic"><code class="codeph">encoding</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1855 d19652e1824 ">
                                       <p>Specifies default input file encoding ("incoding").</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1866" headers="d19652e1821 ">
                                       <p><code class="codeph">-E</code> <span class="italic"><code class="codeph">encoding</code></span> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1866 d19652e1824 ">
                                       <p>Specifies DOM/SAX encoding ("outcoding").</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1879" headers="d19652e1821 ">
                                       <p><code class="codeph">-f</code> <span class="italic"><code class="codeph">file</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1879 d19652e1824 ">
                                       <p>Interprets the file as filespec, not URI.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1891" headers="d19652e1821 ">
                                       <p><code class="codeph">-G</code> <span class="italic"><code class="codeph">xptr_exprs</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1891 d19652e1824 ">
                                       <p>Evaluates <code class="codeph">XPointer</code> scheme examples given in a file.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1906" headers="d19652e1821 ">
                                       <p><code class="codeph">-h</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1906 d19652e1824 ">
                                       <p>Shows usage help and basic list of command-line options.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1914" headers="d19652e1821 ">
                                       <p><code class="codeph">-hh</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1914 d19652e1824 ">
                                       <p>Shows complete list command-line options.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1922" headers="d19652e1821 ">
                                       <p><code class="codeph">-i</code><span class="italic"><code class="codeph"> n</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1922 d19652e1824 ">
                                       <p>Specifies the number of times to iterate the <code class="codeph">XSLT</code> processing.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1936" headers="d19652e1821 ">
                                       <p><code class="codeph">-l</code> <span class="italic"><code class="codeph">language</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1936 d19652e1824 ">
                                       <p>Specifies the language for error reporting.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1948" headers="d19652e1821 ">
                                       <p><code class="codeph">-n</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1948 d19652e1824 ">
                                       <p>Traverses the DOM and reports the number of elements, as shown in this sample output:</p><pre class="oac_no_warn" dir="ltr">ELEMENT       1
 PCDATA       1
    DOC       1
  TOTAL       3 * 60 = 180</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1959" headers="d19652e1821 ">
                                       <p><code class="codeph">-o </code><span class="italic"><code class="codeph">XSLoutfile</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1959 d19652e1824 ">
                                       <p>Specifies the output file of the <code class="codeph">XSLT</code> processor.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1973" headers="d19652e1821 ">
                                       <p><code class="codeph">-p </code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1973 d19652e1824 ">
                                       <p>Prints the document/DTD structures after the parse. For example, the root element <code class="codeph">&lt;greeting&gt;hello&lt;/greeting&gt;</code> is printed as:
                                       </p><pre class="oac_no_warn" dir="ltr">+---ELEMENT greeting 
    +---PCDATA "hello"</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1986" headers="d19652e1821 ">
                                       <p><code class="codeph">-P</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1986 d19652e1824 ">
                                       <p>Prints the document from the root element. For example, the root element <code class="codeph">&lt;greeting&gt;hello&lt;/greeting&gt;</code> is printed as:
                                       </p><pre class="oac_no_warn" dir="ltr">&lt;greeting&gt;hello&lt;/greeting&gt;</pre></td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e1999" headers="d19652e1821 ">
                                       <p><code class="codeph">-PP</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e1999 d19652e1824 ">
                                       <p>Prints from the root node (DOC) and includes the XML declaration.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e2007" headers="d19652e1821 ">
                                       <p><span class="italic"><code class="codeph">-PE encoding</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e2007 d19652e1824 ">
                                       <p>Specifies the encoding for <code class="codeph">-P</code> or <code class="codeph">-PP</code> output.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e2022" headers="d19652e1821 ">
                                       <p><code class="codeph">-PX</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e2022 d19652e1824 ">
                                       <p>Includes the XML declaration in the output.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e2030" headers="d19652e1821 ">
                                       <p><code class="codeph">-s </code><span class="italic"><code class="codeph">stylesheet</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e2030 d19652e1824 ">
                                       <p>Specifies the <code class="codeph">XSLT</code> stylesheet.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e2044" headers="d19652e1821 ">
                                       <p><code class="codeph">-v</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e2044 d19652e1824 ">
                                       <p>Displays the XDK parser version, and then exits.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e2052" headers="d19652e1821 ">
                                       <p><code class="codeph">-V </code><span class="italic"><code class="codeph">var value</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e2052 d19652e1824 ">
                                       <p>Tests top-level variables in <code class="codeph">CXSLT</code>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e2066" headers="d19652e1821 ">
                                       <p><code class="codeph">-w</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e2066 d19652e1824 ">
                                       <p>Preserves all white space.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e2074" headers="d19652e1821 ">
                                       <p><code class="codeph">-W</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e2074 d19652e1824 ">
                                       <p>Stops parsing after a warning.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d19652e2083" headers="d19652e1821 ">
                                       <p><code class="codeph">-x</code></p>
                                    </td>
                                    <td align="left" valign="top" width="74%" headers="d19652e2083 d19652e1824 ">
                                       <p>Exercises the SAX interface and prints the document, as shown in this sample output:</p><pre class="oac_no_warn" dir="ltr">StartDocument
XMLDECL version='1.0' encoding=FALSE
&lt;greeting&gt;
    "hello"
&lt;/greeting&gt;
EndDocument</pre></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19766"></a><a id="ADXDK19767"></a><a id="ADXDK19765"></a><div class="props_rev_3"><a id="GUID-60CB9C7B-A2E9-4BAC-8A3C-9591230C9445" name="GUID-60CB9C7B-A2E9-4BAC-8A3C-9591230C9445"></a><h5 id="ADXDK-GUID-60CB9C7B-A2E9-4BAC-8A3C-9591230C9445" class="sect5">Using the XML Parser Command-Line Utility: Example</h5>
                     <div>
                        <p>You can test <code class="codeph">xml</code> documents using the various XML files located in <code class="codeph">$ORACLE_HOME/xdk/demo/c</code>.
                        </p>
                        <div class="section">
                           <p> <a href="using-XML-parser-for-C.html#GUID-60CB9C7B-A2E9-4BAC-8A3C-9591230C9445__BGBFHECI">Example 5-1</a> displays the contents of <code class="codeph">NSExample.xml</code>.
                           </p>
                           <p>You can parse this file, count the number of elements, and display the DOM tree as shown in this example:</p><pre class="pre codeblock"><code>xml -np NSEample.xml &gt; xml.out
</code></pre><p><a href="using-XML-parser-for-C.html#GUID-60CB9C7B-A2E9-4BAC-8A3C-9591230C9445__GUID-D6CBD9FF-F2C6-452A-9C86-BA2C70A5973D">Example 5-2</a>shows the output.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-60CB9C7B-A2E9-4BAC-8A3C-9591230C9445__BGBFHECI">
                           <p class="titleinexample">Example 5-1 NSExample.xml</p><pre class="pre codeblock"><code>&lt;!DOCTYPE doc [
&lt;!ELEMENT doc (child*)&gt;
&lt;!ATTLIST doc xmlns:nsprefix CDATA #IMPLIED&gt;
&lt;!ATTLIST doc xmlns CDATA #IMPLIED&gt;
&lt;!ATTLIST doc nsprefix:a1 CDATA #IMPLIED&gt;
&lt;!ELEMENT child (#PCDATA)&gt;
]&gt;
&lt;doc nsprefix:a1 = "v1" xmlns="http://www.w3c.org" 
     xmlns:nsprefix="http://www.oracle.com"&gt;
&lt;child&gt;
This element inherits the default Namespace of doc.
&lt;/child&gt;
&lt;/doc&gt;
</code></pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-60CB9C7B-A2E9-4BAC-8A3C-9591230C9445__GUID-D6CBD9FF-F2C6-452A-9C86-BA2C70A5973D">
                           <p class="titleinexample">Example 5-2 xml.out</p><pre class="pre codeblock"><code>   ELEMENT       2
    PCDATA       1
       DOC       1
       DTD       1
  ELEMDECL       2
  ATTRDECL       3
     TOTAL      10 * 112 = 1120
+---ELEMENT doc [nsprefix:a1='v1'*, xmlns='http://www.w3c.org'*, xmlns:nsprefix=
'http://www.oracle.com'*]
    +---ELEMENT child
        +---PCDATA "
This element inherits the default Namespace of doc.
"</code></pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="ADXDK1037"></a><a id="ADXDK19768"></a><div class="props_rev_3"><a id="GUID-0C749FC8-C0B3-41AF-9382-82F0E4FC3BEF" name="GUID-0C749FC8-C0B3-41AF-9382-82F0E4FC3BEF"></a><h3 id="ADXDK-GUID-0C749FC8-C0B3-41AF-9382-82F0E4FC3BEF" class="sect3">Using the DOM API for C</h3>
               <div>
                  <p>Topics here include controlling encoding for XML documents, using NULL-terminated and length-encoded functions, and handling errors.</p>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div><a id="ADXDK19769"></a><div class="props_rev_3"><a id="GUID-8C9F7915-889D-417F-8E6A-3118AD8C883B" name="GUID-8C9F7915-889D-417F-8E6A-3118AD8C883B"></a><h4 id="ADXDK-GUID-8C9F7915-889D-417F-8E6A-3118AD8C883B" class="sect4">Controlling the Data Encoding of XML Documents for the C API</h4>
                  <div>
                     <p>XML data occurs in many encodings. You can control the XML encoding in various ways. </p>
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Specify a default encoding to assume for files that are not self-describing</p>
                           </li>
                           <li>
                              <p>Specify the presentation encoding for DOM or SAX</p>
                           </li>
                           <li>
                              <p>Re-encode when a DOM is serialized</p>
                           </li>
                        </ul>
                        <p>Input XML data is always encoded. Some encodings are entirely self-describing, such as 16-bit encoding of Unicode (UTF-16), which requires a specific Byte Order Mark (BOM) before the start of the actual data. The <code class="codeph">XMLDecl</code> or Multipurpose Internet Mail Extensions (MIME) header of the document can also specify an encoding. If the application cannot determine the specific encoding, then it applies the default input encoding. If you do not provide a default, then the application assumes UTF-8 on ASCII platforms and UTF-EBCDIC on EBCDIC platforms.
                        </p>
                        <p>The API makes a provision for cases when the encoding data of the input document is corrupt. For example, suppose an ASCII document with an <code class="codeph">XMLDecl</code> of <code class="codeph">encoding=ascii</code> is blindly converted to EBCDIC. The new EBCDIC document contains (in EBCDIC) an <code class="codeph">XMLDecl</code> that incorrectly claims the document is ASCII. The correct behavior for a program that is re-encoding XML data is to regenerate but not convert the <code class="codeph">XMLDecl</code>. The <code class="codeph">XMLDecl</code> is metadata, not data itself. This rule is often ignored, however, which causes corrupt documents. To work around this problem, the API provides an additional flag that enables you to forcibly set the input encoding, thereby overcoming an incorrect <code class="codeph">XMLDecl</code>.
                        </p>
                        <p>The precedence rules for determining input encoding are:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Forced encoding as specified by the user</span><div>
                              <div class="infoboxnote" id="GUID-8C9F7915-889D-417F-8E6A-3118AD8C883B__GUID-6E34C31E-0805-4430-B307-A0C0686AA8CC">
                                 <p class="notep1">Note:</p>
                                 <p>Forced encoding can cause a fatal error if there is a conflict. For example, the input document is UTF-16 and starts with a UTF-16 BOM, but the user specifies a forced UTF-8 encoding. In this case, the parser objects about the conflict.</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Protocol specification (HTTP header, and so on)</span></li>
                        <li class="stepexpand"><span><code class="codeph">XMLDecl</code> specification</span></li>
                        <li class="stepexpand"><span>User's default input encoding</span></li>
                        <li class="stepexpand"><span>The default, which is UTF-8 on ASCII platforms or UTF-E on EBCDIC platforms</span></li>
                     </ol>
                     <div class="section">
                        <p>After the application has determined the input encoding, it can parse the document and present the data. You are allowed to choose the presentation encoding; the data is in that encoding regardless of the original input encoding.</p>
                        <p>When an application writes back a DOM in serialized form, it can choose at that time to re-encode the presentation data. Thus, you can place the serialized document in any encoding.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19771"></a><a id="ADXDK19770"></a><div class="props_rev_3"><a id="GUID-ABFE98DC-EB47-4733-BF8F-C3371FA30646" name="GUID-ABFE98DC-EB47-4733-BF8F-C3371FA30646"></a><h4 id="ADXDK-GUID-ABFE98DC-EB47-4733-BF8F-C3371FA30646" class="sect4">Using NULL-Terminated and Length-Encoded C API Functions</h4>
                  <div>
                     <p>The native string representation in C is null-terminated. Thus, the primary DOM interface takes and returns null-terminated strings. When stored in table form, however, Oracle XML DB data is <span class="italic">not</span> null-terminated but <span class="italic">length-encoded</span>. Consequently, XDK provides an additional set of length-encoded APIs for the high-frequency cases to improve performance. 
                     </p>
                     <p>In particular, the DOM functions in <a href="using-XML-parser-for-C.html#GUID-ABFE98DC-EB47-4733-BF8F-C3371FA30646__CCHBCCCF" title="This table lists NULL-Terminated and Length-Encoded C API Functions. NULL-Terminated API and Length-Encoded API are the columns.">Table 5-5</a> have dual APIs.
                     </p>
                     <div class="tblformal" id="GUID-ABFE98DC-EB47-4733-BF8F-C3371FA30646__CCHBCCCF">
                        <p class="titleintable">Table 5-5 NULL-Terminated and Length-Encoded C API Functions </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="NULL-Terminated and Length-Encoded C API Functions " summary="This table lists NULL-Terminated and Length-Encoded C API Functions. NULL-Terminated API and Length-Encoded  API are the columns." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="45%" id="d19652e2530">NULL-Terminated API</th>
                                 <th align="left" valign="bottom" width="55%" id="d19652e2533">Length-Encoded API</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d19652e2538" headers="d19652e2530 ">
                                    <p><code class="codeph">XmlDomGetNodeName()</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d19652e2538 d19652e2533 ">
                                    <p><code class="codeph">XmlDomGetNodeNameLen()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d19652e2547" headers="d19652e2530 ">
                                    <p><code class="codeph">XmlDomGetNodeLocal()</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d19652e2547 d19652e2533 ">
                                    <p><code class="codeph">XmlDomGetNodeLocalLen()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d19652e2556" headers="d19652e2530 ">
                                    <p><code class="codeph">XmlDomGetNodeURI()</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d19652e2556 d19652e2533 ">
                                    <p><code class="codeph">XmlDomGetNodeURILen()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d19652e2565" headers="d19652e2530 ">
                                    <p><code class="codeph">XmlDomGetNodeValue()</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d19652e2565 d19652e2533 ">
                                    <p><code class="codeph">XmlDomGetNodeValueLen()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d19652e2574" headers="d19652e2530 ">
                                    <p><code class="codeph">XmlDomGetAttrName()</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d19652e2574 d19652e2533 ">
                                    <p><code class="codeph">XmlDomGetAttrNameLen()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d19652e2583" headers="d19652e2530 ">
                                    <p><code class="codeph">XmlDomGetAttrLocal()</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d19652e2583 d19652e2533 ">
                                    <p><code class="codeph">XmlDomGetAttrLocalLen()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d19652e2592" headers="d19652e2530 ">
                                    <p><code class="codeph">XmlDomGetAttrURI()</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d19652e2592 d19652e2533 ">
                                    <p><code class="codeph">XmlDomGetAttrURILen()</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d19652e2601" headers="d19652e2530 ">
                                    <p><code class="codeph">XmlDomGetAttrValue()</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d19652e2601 d19652e2533 ">
                                    <p><code class="codeph">XmlDomGetAttrValueLen()</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="ADXDK19772"></a><div class="props_rev_3"><a id="GUID-462C7E68-35A3-4CD9-A767-B0F900E92BE8" name="GUID-462C7E68-35A3-4CD9-A767-B0F900E92BE8"></a><h4 id="ADXDK-GUID-462C7E68-35A3-4CD9-A767-B0F900E92BE8" class="sect4">Handling Errors with the C API</h4>
                  <div>
                     <p>The C API functions typically either return a numeric error code (0 for success, nonzero on failure), or pass back an error code through a variable. In all cases, the API stores error codes. Your application can retrieve the most recent error by invoking the <code class="codeph">XmlDomGetLastError()</code> function.
                     </p>
                     <div class="section">
                        <p>By default, the functions output error messages to <code class="codeph">stderr</code>. However, you can register an error message callback at initialization time. When an error occurs, the application invokes the registered callback and does not print an error. 
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ADXDK99935"></a><a id="ADXDK99918"></a><div class="props_rev_3"><a id="GUID-B36E81CE-DD87-4619-B308-708175CCDD0B" name="GUID-B36E81CE-DD87-4619-B308-708175CCDD0B"></a><h3 id="ADXDK-GUID-B36E81CE-DD87-4619-B308-708175CCDD0B" class="sect3">Using orastream Functions</h3>
               <div>
                  <p>The orastream function API is an interface that enables you to stream large chunks of data out of a node instead of getting it all in one piece. Nodes of greater than 64 KB are thus accessible.</p>
                  <div class="section">
                     <p>The orastream API represents a generic input or output stream. This interface is available to XDK users through <code class="codeph">xml.h</code> and is defined by the <code class="codeph">orastream</code> data structure and a set of functions that implement the interface. The creator of the stream passes a list of stream function addresses, along with a stream context to <code class="codeph">OraStreamInit</code>. This function returns an instance of an <code class="codeph">orastream</code> structure.
                     </p>
                     <p>Several stream properties are specified at the time of initialization. If read or write is provided, the stream operates in byte mode using <code class="codeph">OraStreamRead()</code> and <code class="codeph">OraStreamWrite()</code>. If "read_char" or "write_char" is provided, the stream operates in character mode using <code class="codeph">OraStreamReadChar()</code> and <code class="codeph">OraStreamWriteChar()</code>. In character mode only complete characters are read or written and are never split over buffer boundaries.
                     </p>
                     <p>A stream context is used to represent the state of the orastream and it persists for the lifetime of a stream.</p>
                     <p>Just like the input or output streams in Java, a source or a sink for the data is always specified. Output streams store the address of the external stream or object where they must populate the data. Similarly, input streams store the address of the object that is read.</p>
                     <p>Here are the orastream functions:</p><pre class="oac_no_warn" dir="ltr">struct orastream;
typedef struct orastream orastream;
typedef ub4 oraerr; /* Error code: zero is success, non-zero is failure */
</pre><pre class="oac_no_warn" dir="ltr">/* Initialize (Create) &amp; Destroy (Terminate) stream object */
 
orastream  *OraStreamInit(void *sctx, void *sid, oraerr *err, ...);
oraerr     OraStreamTerm(orastream *stream);
 
/* Set or Change SID (streamID) for stream (returns old stream ID through osid)*/
 
oraerr     OraStreamSid(orastream *stream, void *sid, void **osid);
 
/* Is a stream readable or writable? */
 
boolean    OraStreamReadable(orastream *stream);
boolean    OraStreamWritable(orastream *stream);
 
/* Open &amp; Close stream */
 
oraerr     OraStreamOpen(orastream *stream, ubig_ora *length);
oraerr     OraStreamClose(orastream *stream);
 
/* Read | Write byte stream */
 
oraerr     OraStreamRead(orastream *stream, oratext *dest, ubig_ora size,
           oratext **start, ubig_ora *nread, ub1 *eoi);
oraerr     OraStreamWrite(orastream *stream, oratext *src, ubig_ora size,
           ubig_ora *nwrote);
 
/* Read | Write char stream */
 
oraerr     OraStreamReadChar(orastream *stream, oratext *dest, ubig_ora size,
           oratext **start, ubig_ora *nread, ub1 *eoi);
oraerr     OraStreamWriteChar(orastream *stream, oratext *src, ubig_ora size,
           ubig_ora *nwrote);
 
/* Return handles for stream */
 
orastreamhdl *OraStreamHandle(orastream *stream);
 
/* Returns status: if the stream object is currently opened or not */

boolean OraStreamIsOpen(orastream *stream);
</pre><p>The stream error codes are:</p><pre class="oac_no_warn" dir="ltr">#define ORASTREAM_ERR_NULL_POINTER      1      /* NULL pointer given */
#define ORASTREAM_ERR_BAD_STREAM        2      /* invalid stream object */
#define ORASTREAM_ERR_WRONG_DECTION     3      /* tried wrong-direction I/O */
#define ORASTREAM_ERR_UNKNOWN_PROPERTY  4      /* unknown creation prop */
#define ORASTREAM_ERR_NO_DIRECTION      5      /* neither read nor write? */
#define ORASTREAM_ERR_BI_DIRECTION      6      /* both read any write? */
#define ORASTREAM_ERR_NOT_OPEN          7      /* stream not open */
#define ORASTREAM_ERR_WRONG_MODE        8      /* wrote byte/char mode */
/* --- Open errors --- */
#define ORASTREAM_ERR_CANT_OPEN         10     /* can't open stream */
/* --- Close errors --- */
#define ORASTREAM_ERR_CANT_CLOSE        20     /* can't close stream */</pre><div class="infoboxnotealso" id="GUID-B36E81CE-DD87-4619-B308-708175CCDD0B__GUID-A39B7D88-BB54-490A-A7C1-B6A327B1FC53">
                        <p class="notep1">See Also:</p>
                        <p><a href="../caxml/package-Orastream-API.html#CAXML01400" target="_blank"><span><cite>Oracle Database XML C API Reference</cite></span></a> for reference information such as parameter definitions in the orastream API
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-B36E81CE-DD87-4619-B308-708175CCDD0B__GUID-C03C7044-B5BF-4362-9F13-A1CD877C0ED2">
                     <p class="titleinexample">Example 5-3 Using orastream Functions</p><pre class="oac_no_warn" dir="ltr">int test_read()
{
   xmlctx *xctx = NULL;
   oratext *barray, *docName = "NSExample.xml";
   orastream* ostream = (orastream *) 0;
   xmlerr ecode = 0;
   ub4 wcount = 0;
   ubig_ora  destsize, nread;
   oraerr oerr = 0;
   ub1 eoi = 0;
   nread = destsize = 1024;
   if (!(xctx = XmlCreateNew(&amp;ecode, (oratext *)"stream_xctx", NULL, wcount,
                             NULL)))
    {
       printf("Failed to create XML context, error %u\n", (unsigned)ecode);
       return -1;
    }
 
   barray = XmlAlloc(xctx, sizeof(oratext) * destsize);
    
   /* open function should be specified in order to read correctly. */
   if (!(ostream = OraStreamInit(NULL,docName, (oraerr *)&amp;ecode,
                                 "open", fileopen,  
                                 "read", fileread,
                                 NULL)))
   {
      printf("Failed to initialize OrsStream, error %u\n",(unsigned)ecode);
      return -1;
   }  
 
   /* check readable and writable  */
    if (OraStreamReadable(ostream))
       printf("ostream is readable\n");
    else
       printf("ostream is not readable\n");
 
     if (OraStreamWritable(ostream))
       printf("ostream is writable\n");
    else
       printf("ostream is not writable\n");
    
    if (oerr = OraStreamRead(ostream, barray, destsize, &amp;barray, &amp;nread, &amp;eoi))
    {
      printf("Failed to read due to orastream was not open, error %u\n", oerr);
    }
 
   /* open orastream */
   OraStreamOpen(ostream, NULL);
 
   /* read document */
   OraStreamRead(ostream, barray, destsize, &amp;barray, &amp;nread, &amp;eoi);
   
   OraStreamTerm(ostream);
    
   XmlDestroy(xctx);
   return 0;
}
ORASTREAM_OPEN_F(fileopen, sctx, sid, hdl, length)
{
    FILE *fh = NULL;
 
    printf("Opening orastream %s...\n", (oratext *)sid);
 
    if (sid &amp;&amp; ((fh= fopen(sid, "r")) != NULL))
    {
        printf("Opening orastream %s...\n", (oratext *)sid);
    }
    else
    {
         printf("Failed to open input file.\n");
         return -1;
     }
 
    /* store file handle generically, NULL means stdout */
    hdl-&gt;ptr_orastreamhdl = fh;
 
    return XMLERR_OK;
}
 
ORASTREAM_READ_F(fileread, sctx, sid, hdl,
                         dest, size, start, nread, eoi)
{
    FILE *fh = NULL;
    int i =0;
    printf("Reading orastream %s ...\n", (oratext *)sid);
    
    // read data from file to dest
    if ((fh = (FILE *) hdl-&gt;ptr_orastreamhdl) != NULL)
        *nread = fread(dest, 1, size, fh);
    printf("Read %d bytes from orastream...\n", (int) *nread);
 
    *eoi = (*nread &lt; size);
    if (start)
        *start = dest;
 
    printf("printing document ...\n");
    for(i =0; i &lt; *nread; i++)
    printf("%c", (char)dest[i]);
    printf("\nend ...\n");
    return ORAERR_OK;
}</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK19773"></a><div class="props_rev_3"><a id="GUID-34FE324C-DF9F-4FE7-B2EF-48FE4FB38B6E" name="GUID-34FE324C-DF9F-4FE7-B2EF-48FE4FB38B6E"></a><h3 id="ADXDK-GUID-34FE324C-DF9F-4FE7-B2EF-48FE4FB38B6E" class="sect3">Using the SAX API for C</h3>
               <div>
                  <p>To use SAX, initialize an <code class="codeph">xmlsaxcb</code> structure with function pointers and pass it to <code class="codeph">XmlLoadSax()</code>. You can also include a pointer to a user-defined context structure, which you pass to each SAX function.
                  </p>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-34FE324C-DF9F-4FE7-B2EF-48FE4FB38B6E__GUID-883F4A36-85D5-40CA-B3D1-BCD12F56ED17">
                        <p class="notep1">See Also:</p>
                        <p><a href="../caxml/package-SAX-API.html#CAXML5908" target="_blank"><span><cite>Oracle Database XML C API Reference</cite></span></a> for the SAX callback structure
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADXDK1038"></a><a id="ADXDK1410"></a><div class="props_rev_3"><a id="GUID-C244DBA6-8578-4224-B21D-CD5FF48B0EEC" name="GUID-C244DBA6-8578-4224-B21D-CD5FF48B0EEC"></a><h3 id="ADXDK-GUID-C244DBA6-8578-4224-B21D-CD5FF48B0EEC" class="sect3">Using the XML Pull Parser for C</h3>
               <div>
                  <p>The XML Pull Parser is an implementation of the XML Events interface. The XML Pull Parser and the SAX parser are similar, but using the Pull Parser, the application (consumer) drives the events, while in SAX, the parser (producer) drives the events. </p>
                  <div class="section">
                     <p>Both the XML Pull Parser and SAX represent the document as a sequence of events, with start tags, end tags, and comments. XML Pull Parser gives control to the application by exposing a simple set of APIs and an underlying set of events. Methods such as <code class="codeph">XmlEvNext</code> allow an application to ask for (or pull) the next event, rather than handling the event in a callback, as in SAX. Thus, the application has more procedural control over XML processing. Also, the application can decide to stop further processing, unlike a SAX application, which parses the entire document.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div><a id="ADXDK19774"></a><div class="props_rev_3"><a id="GUID-9440C355-936A-44ED-99A9-80B49758D000" name="GUID-9440C355-936A-44ED-99A9-80B49758D000"></a><h4 id="ADXDK-GUID-9440C355-936A-44ED-99A9-80B49758D000" class="sect4">Using Basic XML Pull Parsing Capabilities</h4>
                  <div>
                     <p>The steps required to use the XML Pull Parser are described.</p>
                     <ol>
                        <li class="stepexpand"><span>Invoke <code class="codeph">XmlCreate</code> to initialize the XML meta-context.</span></li>
                        <li class="stepexpand"><span>Initialize the Pull Parser context by invoking the <code class="codeph">XmlEvCreatePPCtx</code> function, which creates and returns the event context.</span><div>
                              <p>The <code class="codeph">XmlEvCreatePPCtx</code> function supports all the properties supported by <code class="codeph">XmlLoadDom</code> and <code class="codeph">XmlLoadSax</code>, plus some additional ones.
                              </p>
                              <p>The <code class="codeph">XmlEvCreatePPCtx</code> and <code class="codeph">XmlEvCreatePPCtxVA</code> functions are fully implemented.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Ensure that the event context is passed to all subsequent invocations of the Pull Parser.</span></li>
                        <li class="stepexpand"><span>Terminate the Pull Parser context by invoking the  <code class="codeph">XmlEvDestoryPPCtx</code> function, to clean up memory. </span></li>
                        <li class="stepexpand"><span>Destroy the XML meta-context by invoking the <code class="codeph">XmlDestoryCtx</code> function.</span></li>
                     </ol>
                  </div><a id="ADXDK19776"></a><a id="ADXDK19775"></a><div class="props_rev_3"><a id="GUID-DC1CF9B5-DCD1-4743-950B-EDBFD9E5ABEF" name="GUID-DC1CF9B5-DCD1-4743-950B-EDBFD9E5ABEF"></a><h5 id="ADXDK-GUID-DC1CF9B5-DCD1-4743-950B-EDBFD9E5ABEF" class="sect5">XML Event Context</h5>
                     <div>
                        <p>The XML event context structure is shown.</p>
                        <div class="example" id="GUID-DC1CF9B5-DCD1-4743-950B-EDBFD9E5ABEF__CCHJDIHJ">
                           <p class="titleinexample">Example 5-4 XML Event Context</p><pre class="pre codeblock"><code>typedef  struct {
   void *ctx_xmlevctx;                   /* implementation specific context */
   xmlevdisp *disp_xmlevctx;             /* dispatch table */
   ub4 checkword_xmlevctx;               /* checkword for integrity check */
   ub4 flags_xmlevctx;                   /* mode; default: expand_entity */
   struct xmlevctx *input_xmlevctx;      /* input xmlevctx; chains the XML Event
                                            context */
} xmlevctx;</code></pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADXDK19777"></a><div class="props_rev_3"><a id="GUID-60864BD6-729A-409C-B06E-D5454040A0B3" name="GUID-60864BD6-729A-409C-B06E-D5454040A0B3"></a><h5 id="ADXDK-GUID-60864BD6-729A-409C-B06E-D5454040A0B3" class="sect5">About the XML Event Context</h5>
                     <div>
                        <p>Each XML Pull Parser is allowed to create its own context and implement its own API functions. </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Dispatch Table</p>
                              <p>The dispatch table, <code class="codeph">disp_xmlevctx</code>, contains one pointer for each API function, except for the <code class="codeph">XmlEvCreatePPCtx</code>, <code class="codeph">XmlEvCreatePPCtxVA</code>, <code class="codeph">XmlEvDestoryPPCtx</code>, <code class="codeph">XmlEvLoadPPDoc</code>, and <code class="codeph">XmlEvCleanPPCtx</code> functions.
                              </p>
                              <p>When the event context is created, the pointer <code class="codeph">disp_xmlevctx</code> is initialized with the address of that static table. 
                              </p>
                           </li>
                           <li>
                              <p>Implementation-Specific Event Context</p>
                              <p>The field <code class="codeph">ctx_xmlevctx</code> must be initialized with the address of the context specific to this invocation of the particular implementation. The implementation-specific event context is of type <code class="codeph">*void</code>, so that it can differ for different applications. 
                              </p>
                           </li>
                           <li>
                              <p>Input Event Context</p>
                              <p>Each Pull Parser can specify an input event context, <code class="codeph">xmlevctx</code>. This field enables the parser to chain multiple event producers. As a result, if a dispatch function is specified as <code class="codeph">NULL</code> in a context, the application uses the next non-null dispatch function in the chain of input event contexts. The base <code class="codeph">xmlevctx</code> must ensure that all dispatch function pointers are non-null.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADXDK19778"></a><div class="props_rev_3"><a id="GUID-75020C67-9F3A-46DA-81C9-08CA086135E8" name="GUID-75020C67-9F3A-46DA-81C9-08CA086135E8"></a><h4 id="ADXDK-GUID-75020C67-9F3A-46DA-81C9-08CA086135E8" class="sect4">Parsing Multiple XML Documents</h4>
                  <div>
                     <p>After creating and initializing the XML Event Context, an application can parse multiple documents using repeated invocations of <code class="codeph">XmlEvLoadPPDoc</code> and <code class="codeph">XmlEvCleanPPCtx</code>. 
                     </p>
                     <div class="section">
                        <p>The properties defined by the application during the XML Event Context creation cannot be changed for each invocation of the <code class="codeph">XmlLoadPPDoc</code> function. to change the properties, destroy the event context and then re-create it.
                        </p>
                        <p>After <code class="codeph">XmlEvCleanPPCtx</code> cleans up the internal structure of the current parser, the event context can be reused to parse another document.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19780"></a><a id="ADXDK19781"></a><a id="ADXDK19782"></a><a id="ADXDK19779"></a><div class="props_rev_3"><a id="GUID-48E4B443-A445-4BAA-9A5F-11096A355BFE" name="GUID-48E4B443-A445-4BAA-9A5F-11096A355BFE"></a><h4 id="ADXDK-GUID-48E4B443-A445-4BAA-9A5F-11096A355BFE" class="sect4">ID Callback</h4>
                  <div>
                     <p>You can provide a callback to convert text-based names to 8-byte identifiers (IDs).</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-48E4B443-A445-4BAA-9A5F-11096A355BFE__GUID-0143E44D-3A5F-4A52-948B-74767635184B"> Callback Function Signature</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">typedef  sb8 (*xmlev_id_cb_funcp)( void *ctx , ub1 type, ub1 *token, ub4 tok_len,
              sb8 nmspid, boolean isAttribute);</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-48E4B443-A445-4BAA-9A5F-11096A355BFE__GUID-E631A425-2160-4FAD-853D-AC9748E7D519">Return Value</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p><code class="codeph">sb8</code>: an 8-byte ID.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-48E4B443-A445-4BAA-9A5F-11096A355BFE__GUID-018164CB-A939-4A4E-ACAE-7B50251EFFB4">Arguments</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>*<code class="codeph">ctx</code>: The implementation context. 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">type</code>: The type, which is indicated by this enumeration:
                              </p><pre class="oac_no_warn" dir="ltr">typedef enum 
{
  XML_EVENT_ID_URI,
  XML_EVENT_ID_QNAME,
}xmlevidtype;
</pre></li>
                           <li>
                              <p>*<code class="codeph">token</code> and <code class="codeph">tok_len</code>: The actual text to be converted. 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">nmspid</code>: The namespace ID. 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">isAttribute</code>: A Boolean value indicating an attribute.
                              </p>
                           </li>
                        </ul>
                        <p>Internally, the <code class="codeph">XmlEvGetTagId</code> and <code class="codeph">XmlEvGetAttrID</code> APIs invoke this callback twice, once to fetch the namespace ID and once to fetch the actual ID of the tag or the attribute <code class="codeph">Qname</code>.
                        </p>
                        <p>The <code class="codeph">XmlEvGetTagUriID</code> and <code class="codeph">XmlEvGetAttrUriID</code> functions invoke this callback once to get the ID of the corresponding Universal Resource Identifier (URI).
                        </p>
                        <p>If a callback is not supplied, an error <code class="codeph">XML_ERR_EVENT_NOIDCBK</code> is returned when these APIs are used.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19783"></a><div class="props_rev_3"><a id="GUID-D17D4D58-50E4-4C6E-BA79-91E5F196F04C" name="GUID-D17D4D58-50E4-4C6E-BA79-91E5F196F04C"></a><h4 id="ADXDK-GUID-D17D4D58-50E4-4C6E-BA79-91E5F196F04C" class="sect4">Error Handling for the XML Pull Parser</h4>
                  <div>
                     <p>Error handling for the XML Pull Parser is described.</p>
                  </div><a id="ADXDK19784"></a><div class="props_rev_3"><a id="GUID-1D5E95DB-55EE-44A7-8360-D530BEAD6477" name="GUID-1D5E95DB-55EE-44A7-8360-D530BEAD6477"></a><h5 id="ADXDK-GUID-1D5E95DB-55EE-44A7-8360-D530BEAD6477" class="sect5">Parser Errors</h5>
                     <div>
                        <p>Errors raised by the parser are described.</p>
                        <p>The XML Pull Parser returns the message <code class="codeph">XML_EVENT_FATAL_ERROR</code> when it throws an error because the input document is malformed. Function <code class="codeph">XmlEvGetError</code> is provided to get the error number and message.
                        </p>
                        <p>During the <code class="codeph">XmlEvCreatePPCtx</code> operation, any error handler supplied by the application during <code class="codeph">XmlCreate</code> is overridden. The application must invoke the <code class="codeph">XmlErrSetHandler</code> function after the <code class="codeph">XmlEvDestroyPPCtx</code> operation to restore the original callback.
                        </p>
                     </div>
                  </div><a id="ADXDK19785"></a><div class="props_rev_3"><a id="GUID-A32A6E3E-CA3E-4ED5-9FA3-AFC9DC357331" name="GUID-A32A6E3E-CA3E-4ED5-9FA3-AFC9DC357331"></a><h5 id="ADXDK-GUID-A32A6E3E-CA3E-4ED5-9FA3-AFC9DC357331" class="sect5">Programming Errors</h5>
                     <div>
                        <p>To handle programmatic errors. XDK provides a callback that the application can supply when creating an event context. This callback is invoked when the application invokes an illegal API. </p>
                        <div class="section">
                           <p>The callback signature is:</p><pre class="oac_no_warn" dir="ltr">typedef  void (* xmlev_err_cb_funcp)(xmlctx *xctx, xmlevctx *evctx, 
        xmlevtype cur_event);
</pre><p>An example of an illegal API invocation is:</p>
                           <p><code class="codeph">XmlEvGetName</code> cannot be called for the <code class="codeph">XML_EVENT_CHARACTERS</code> event.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADXDK19788"></a><a id="ADXDK19790"></a><a id="ADXDK19792"></a><a id="ADXDK19786"></a><div class="props_rev_3"><a id="GUID-DAE9B130-2651-403C-8442-A71634C12312" name="GUID-DAE9B130-2651-403C-8442-A71634C12312"></a><h4 id="ADXDK-GUID-DAE9B130-2651-403C-8442-A71634C12312" class="sect4">Sample Pull Parser Application</h4>
                  <div>
                     <p>A sample pull parser application, a document to be parsed, and a list of the events that the application generates from the document are presented.</p>
                     <p><a href="using-XML-parser-for-C.html#GUID-DAE9B130-2651-403C-8442-A71634C12312__BABCJHAB">Example 5-5</a> shows the sample application code.
                     </p>
                     <p><a href="using-XML-parser-for-C.html#GUID-DAE9B130-2651-403C-8442-A71634C12312__BGBCACGI">Example 5-6</a> shows the sample document to be parsed.
                     </p>
                     <p><a href="using-XML-parser-for-C.html#GUID-DAE9B130-2651-403C-8442-A71634C12312__BGBBEAEB">Example 5-7</a> shows the sequence of events generated when the attribute events property is <code class="codeph">FALSE</code> and the expand entities properties is <code class="codeph">TRUE</code>.
                     </p>
                     <div class="example" id="GUID-DAE9B130-2651-403C-8442-A71634C12312__BABCJHAB">
                        <p class="titleinexample">Example 5-5 Sample Pull Parser Application Example</p><pre class="oac_no_warn" dir="ltr"># include "xml.h"
# include "xmlev.h"
...
xmlctx *xctx;
xmlevctx *evtcx;
if (!(xctx = XmlCreate(&amp;xerr, (oratext *) "test")))
{
    printf("Failed to create XML context, error %u\n", (unsigned) xerr);
    return -1;
}
...
if(!(evctx = XmlEvCreatePPCtx(xctx, &amp;xerr, NULL)))
{
   printf("Failed to create EVENT context, error %u\n", (unsigned) xerr);
   return -1;
 }
for(i = 0; i &lt; numDocs; i++)
{
  if (xerr = XmlEvLoadPPDoc(xctx, evctx, "file", input_filenames[i], 0, NULL)
     {
       printf("Failed to load the document, error %u\n", (unsigned) xerr);
       return -1;
     }
...
  for(;;)
  {
    xmlevtype cur_event;
    cur_event = XmlEvNext(evctx);
    switch(cur_event)
         {
               case XML_EVENT_FATAL_ERROR:
                     XmlEvGetError(evctx, (oratext **)&amp;errmsg);
                          printf("Error %s\n", errmsg);
               return;
               case XML_EVENT_START_ELEMENT:
                     printf("&lt;%s&gt;", XmlEvGetName0(evctx));
               break;
               case XML_EVENT_END_DOCUMENT:
                     printf("&lt;%s&gt;", XmlEvGetName0(evctx));
               return;
         }
  }
  XmlEvCleanPPCtx(xctx, evctx);
}
XmlEvDestroyPPCtx(xctx, evctx);
XmlDestroy(xctx);
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-DAE9B130-2651-403C-8442-A71634C12312__BGBCACGI">
                        <p class="titleinexample">Example 5-6 Sample Document to Parse</p><pre class="oac_no_warn" dir="ltr">&lt;!DOCTYPE doc [
&lt;!ENTITY ent SYSTEM "file:attendees.txt"&gt;
&lt;!ELEMENT doc ANY&gt;
&lt;!ELEMENT meeting (topic, date, publishAttendees)&gt;
&lt;!ELEMENT publishAttendees (#PCDATA)&gt;
&lt;!ELEMENT topic (#PCDATA)&gt;
&lt;!ELEMENT date (#PCDATA)&gt;
]&gt;
&lt;!-- Begin Document --&gt;
&lt;doc&gt;
  &lt;!-- Info about the meeting --&gt;
  &lt;meeting&gt;
    &lt;topic&gt;Group meeting&lt;/topic&gt;
    &lt;date&gt;April 25, 2005&lt;/date&gt;
    &lt;publishAttendees&gt;&amp;ent;&lt;/publishAttendees&gt;
  &lt;/meeting&gt;
&lt;/doc&gt;
&lt;!-- End Document --&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-DAE9B130-2651-403C-8442-A71634C12312__BGBBEAEB">
                        <p class="titleinexample">Example 5-7 Events Generated by Parsing a Sample Document</p><pre class="oac_no_warn" dir="ltr">XML_EVENT_START_DOCUMENT
XML_EVENT_START_DTD
XML_EVENT_PE_DECLARATION
XML_EVENT_ELEMENT_DECLARATION
XML_EVENT_ELEMENT_DECLARATION
XML_EVENT_ELEMENT_DECLARATION
XML_EVENT_ELEMENT_DECLARATION
XML_EVENT_ELEMENT_DECLARATION
XML_EVENT_END_DTD 
XML_EVENT_COMMENT
XML_EVENT_START_ELEMENT
XML_EVENT_SPACE
XML_EVENT_COMMENT
XML_EVENT_SPACE
XML_EVENT_START_ELEMENT
XML_EVENT_START_ELEMENT
XML_EVENT_CHARACTERS
XML_EVENT_END_ELEMENT
XML_EVENT_START_ELEMENT
XML_EVENT_CHARACTERS
XML_EVENT_END_ELEMENT
XML_EVENT_START_ELEMENT
XML_EVENT_START_ENTITY
XML_EVENT_CHARACTERS
XML_EVENT_END_ENTITY
XML_EVENT_END_ELEMENT
XML_EVENT_END_ELEMENT
XML_EVENT_SPACE
XML_EVENT_END_ELEMENT
XML_EVENT_COMMENT
XML_EVENT_END_DOCUMENT</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK19793"></a><div class="props_rev_3"><a id="GUID-0B3D2810-F81E-4748-9E2B-152865F2A8B3" name="GUID-0B3D2810-F81E-4748-9E2B-152865F2A8B3"></a><h3 id="ADXDK-GUID-0B3D2810-F81E-4748-9E2B-152865F2A8B3" class="sect3">Using OCI and the XDK for C API</h3>
               <div>
                  <p>This section describes accessing XDK for C functions from Oracle Call Interface (OCI).</p>
               </div><a id="ADXDK19795"></a><a id="ADXDK19794"></a><div class="props_rev_3"><a id="GUID-0E4FBFA3-1B16-4886-A5B9-A0F5A8FA9693" name="GUID-0E4FBFA3-1B16-4886-A5B9-A0F5A8FA9693"></a><h4 id="ADXDK-GUID-0E4FBFA3-1B16-4886-A5B9-A0F5A8FA9693" class="sect4">Using XMLType Functions and Descriptions</h4>
                  <div>
                     <p>You can use the C API for XML with <code class="codeph">XMLType</code> columns in the database. An Oracle Call Interface (OCI) program can access XML data stored in a table by initializing the values of OCI handles.
                     </p>
                     <div class="section">
                        <p>This applies to handles such as these:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Environment handle</p>
                           </li>
                           <li>
                              <p>Service handle</p>
                           </li>
                           <li>
                              <p>Error handle</p>
                           </li>
                           <li>
                              <p>Optional parameters</p>
                           </li>
                        </ul>
                        <p>The program can pass these input values to the function <code class="codeph">OCIXmlDbInitXmlCtx()</code>, which returns an XML context. After the program invokes the C API, the function <code class="codeph">OCIXmlDbFreeXmlCtx()</code> frees the context.
                        </p>
                        <div class="tblformal" id="GUID-0E4FBFA3-1B16-4886-A5B9-A0F5A8FA9693__CCHBDJDE">
                           <p class="titleintable">Table 5-6 XMLType Functions </p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="XMLType Functions " summary="This table describes a few of the functions for XML operations. Description and Function Name are the columns." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="42%" id="d19652e4208">Function Name</th>
                                    <th align="left" valign="bottom" width="58%" id="d19652e4211">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4216" headers="d19652e4208 ">
                                       <p><code class="codeph">XmlCreateDocument()</code></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4216 d19652e4211 ">
                                       <p>Create empty <code class="codeph">XMLType</code> instance
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4227" headers="d19652e4208 ">
                                       <p><code class="codeph">XmlLoadDom()</code> and so on
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4227 d19652e4211 ">
                                       <p>Create from a source buffer</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4236" headers="d19652e4208 ">
                                       <p><code class="codeph">XmlXPathEvalexpr()</code> and family
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4236 d19652e4211 ">
                                       <p>Extract an <code class="codeph">XPath</code> expression
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4248" headers="d19652e4208 ">
                                       <p><code class="codeph">XmlXslProcess()</code> and family
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4248 d19652e4211 ">
                                       <p>Transform using an Extensible Stylesheet Language Transformation (XSLT) stylesheet</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4257" headers="d19652e4208 ">
                                       <p><code class="codeph">XmlXPathEvalexpr()</code> and family
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4257 d19652e4211 ">
                                       <p>Check if an <code class="codeph">XPath</code> exists
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4269" headers="d19652e4208 ">
                                       <p><code class="codeph">XmlDomIsSchemaBased()</code></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4269 d19652e4211 ">
                                       <p>Is document schema-based?</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4277" headers="d19652e4208 ">
                                       <p><code class="codeph">XmlDomGetSchema()</code></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4277 d19652e4211 ">
                                       <p>Get schema information</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4285" headers="d19652e4208 ">
                                       <p><code class="codeph">XmlDomGetNodeURI()</code></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4285 d19652e4211 ">
                                       <p>Get document namespace</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4293" headers="d19652e4208 ">
                                       <p><code class="codeph">XmlSchemaValidate()</code></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4293 d19652e4211 ">
                                       <p>Validate using schema</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4301" headers="d19652e4208 ">
                                       <p>Cast <code class="codeph">(void *)</code> to <code class="codeph">(xmldocnode *)</code></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4301 d19652e4211 ">
                                       <p>Get DOM from <code class="codeph">XMLType</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="42%" id="d19652e4315" headers="d19652e4208 ">
                                       <p>Cast <code class="codeph">(xmldocnode *)</code> to <code class="codeph">(void *)</code></p>
                                    </td>
                                    <td align="left" valign="top" width="58%" headers="d19652e4315 d19652e4211 ">
                                       <p>Get <code class="codeph">XMLType</code> from DOM
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19796"></a><div class="props_rev_3"><a id="GUID-AFBCF39A-784B-4D78-9613-6E11EEBE4A20" name="GUID-AFBCF39A-784B-4D78-9613-6E11EEBE4A20"></a><h4 id="ADXDK-GUID-AFBCF39A-784B-4D78-9613-6E11EEBE4A20" class="sect4">Initializing an XML Context for Oracle XML DB</h4>
                  <div>
                     <p>An XML context is a required parameter in each C DOM API function. This opaque context encapsulates information pertaining to data encoding, error message language, and so on. The contents of this XML context are different for XDK applications and for Oracle XML DB applications.</p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-AFBCF39A-784B-4D78-9613-6E11EEBE4A20__GUID-0EF7C0D6-C9B5-4ED6-8B63-7C282A5E238F">
                           <p class="notep1">Note:</p>
                           <p>Do not use an XML context for XDK in an Oracle XML DB application, or an XML context for Oracle XML DB in an XDK application.</p>
                        </div>
                        <p>For Oracle XML DB, the two OCI functions that initialize and free an XML context have these prototypes:</p><pre class="oac_no_warn" dir="ltr">xmlctx *OCIXmlDbInitXmlCtx (OCIEnv *envhp, OCISvcCtx *svchp, OCIError *errhp,
       ocixmldbparam *params, ub4 num_params);

void OCIXmlDbFreeXmlCtx (xmlctx *xctx);
</pre><div class="infoboxnotealso" id="GUID-AFBCF39A-784B-4D78-9613-6E11EEBE4A20__GUID-F3A2423D-C0FF-4FF9-82D3-3C6377347C10">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../lnoci/oci-xml-databse-functions.html#LNOCI220" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a> for reference material on the functions
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../lnoci/index.html" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a> for a discussion about OCI support for XML
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../caxml/package-DOM-API.html#CAXML00300" target="_blank"><span><cite>Oracle Database XML C API Reference</cite></span></a> for reference information on the DOM APIs
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19797"></a><div class="props_rev_3"><a id="GUID-E6F4271E-BBF5-46C2-B8AB-C1702175BBB0" name="GUID-E6F4271E-BBF5-46C2-B8AB-C1702175BBB0"></a><h4 id="ADXDK-GUID-E6F4271E-BBF5-46C2-B8AB-C1702175BBB0" class="sect4">Creating XMLType Instances on the Client</h4>
                  <div>
                     <p>You can construct new <code class="codeph">XMLType</code> instances on the client by using the <code class="codeph">XmlLoadDom()</code> invocations. 
                     </p>
                     <div class="section">
                        <p>Follow these basic steps:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>You must initialize the <code class="codeph">xmlctx</code>, as showd in the example in <a href="using-XML-parser-for-C.html#GUID-0C749FC8-C0B3-41AF-9382-82F0E4FC3BEF" title="Topics here include controlling encoding for XML documents, using NULL-terminated and length-encoded functions, and handling errors.">Using the DOM API for C</a>.</span></li>
                        <li class="stepexpand"><span>You can construct the XML data itself from these sources:</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>User buffer</p>
                                 </li>
                                 <li>
                                    <p>Local file</p>
                                 </li>
                                 <li>
                                    <p>URI</p>
                                 </li>
                              </ul>
                              <p>The return value from these is an <code class="codeph">(xmldocnode *)</code>, which you can use in the rest of the common C API.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>You can cast the <code class="codeph">(xmldocnode *)</code> to a (<code class="codeph">void *)</code> and directly provide it as the bind value if required.</span></li>
                     </ol>
                     <div class="section">
                        <p>You can construct empty <code class="codeph">XMLType</code> instances by invoking <code class="codeph">XmlCreateDocument()</code>. This function would be equivalent to an <code class="codeph">OCIObjectNew()</code> for other types. You can operate on the <code class="codeph">(xmldocnode *)</code> returned by the preceding invocation and finally cast it to a <code class="codeph">(void *)</code> if it must be provided as a bind value.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19798"></a><div class="props_rev_3"><a id="GUID-62F87C40-EB28-4B61-9CE1-2692C7EB5F60" name="GUID-62F87C40-EB28-4B61-9CE1-2692C7EB5F60"></a><h4 id="ADXDK-GUID-62F87C40-EB28-4B61-9CE1-2692C7EB5F60" class="sect4">Operating on XML Data in the Database Server</h4>
                  <div>
                     <p>You can operate on XML data in Oracle Database using OCI statements. You can bind and define <code class="codeph">XMLType</code> values using <code class="codeph">xmldocnode</code> and use OCI statements to extract XML data from the database. You can use this data directly in C DOM functions or bind values directly to SQL statements.
                     </p>
                  </div>
               </div><a id="ADXDK19800"></a><a id="ADXDK19801"></a><a id="ADXDK19799"></a><div class="props_rev_3"><a id="GUID-649191E3-099B-49C4-97E3-4DC58F3960C0" name="GUID-649191E3-099B-49C4-97E3-4DC58F3960C0"></a><h4 id="ADXDK-GUID-649191E3-099B-49C4-97E3-4DC58F3960C0" class="sect4">Using OCI and the XDK for C API: Examples</h4>
                  <div>
                     <p>Examples show how to use the DOM API to construct and save an XML schema-based document and to modify a database document.</p>
                     <div class="section">
                        <p><a href="using-XML-parser-for-C.html#GUID-649191E3-099B-49C4-97E3-4DC58F3960C0__CCHHJFAE">Example 5-8</a> shows how to construct a schema-based document with the DOM API and save it to the database. You must include the header files <code class="codeph">xml.h</code> and <code class="codeph">ocixmldb.h</code>.
                        </p>
                        <p><a href="using-XML-parser-for-C.html#GUID-649191E3-099B-49C4-97E3-4DC58F3960C0__CCHDJDBE">Example 5-9</a> shows how to get a document from the database and modify it with the DOM API.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-649191E3-099B-49C4-97E3-4DC58F3960C0__CCHHJFAE">
                        <p class="titleinexample">Example 5-8 Constructing a Schema-Based Document with the DOM API</p><pre class="pre codeblock"><code>#include &lt;xml.h&gt;
#include &lt;ocixmldb.h&gt;
static oratext tlpxml_test_sch[] = "&lt;TOP xmlns='example1.xsd'\n\
xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' \n\
xsi:schemaLocation='example1.xsd example1.xsd'/&gt;";

void example1()
{
    OCIEnv *envhp;
    OCIError *errhp;
    OCISvcCtx *svchp;
    OCIStmt *stmthp;
    OCIDuration dur;
    OCIType *xmltdo;

    xmldocnode  *doc;
    ocixmldbparam params[1];
    xmlnode *quux, *foo, *foo_data;
    xmlerr       err;

    /* Initialize envhp, svchp, errhp, dur, stmthp */
    /* ........ */

    /* Get an xml context */
    params[0].name_ocixmldbparam = XCTXINIT_OCIDUR;
    params[0].value_ocixmldbparam = &amp;dur;
    xctx = OCIXmlDbInitXmlCtx(envhp, svchp, errhp, params, 1);

    /* Start processing */ 
    printf("Supports XML 1.0: %s\n",
       XmlHasFeature(xctx, (oratext *) "xml", (oratext *) "1.0") ? "YES" : "NO");

    /* Parsing a schema-based document */
    if (!(doc = XmlLoadDom(xctx, &amp;err, "buffer", tlpxml_test_sch,
                          "buffer_length", sizeof(tlpxml_test_sch)-1,
                          "validate", TRUE, NULL)))
    {
       printf("Parse failed, code %d\n");
       return;
    }

    /* Create some elements and add them to the document */
    top = XmlDomGetDocElem(xctx, doc);
    quux = (xmlnode *) XmlDomCreateElem(xctx ,doc, (oratext *) "QUUX");
    foo = (xmlnode *) XmlDomCreateElem(xctx, doc, (oratext *) "FOO");
    foo_data = (xmlnode *) XmlDomCreateText(xctx, doc, (oratext *)"foo's data");
    foo_data = XmlDomAppendChild(xctx, (xmlnode *) foo, (xmlnode *) foo_data);
    foo = XmlDomAppendChild(xctx, quux, foo);
    quux = XmlDomAppendChild(xctx, top, quux);

    XmlSaveDom(xctx, &amp;err, top, "stdio", stdout, NULL);
    XmlSaveDom(xctx, &amp;err, doc, "stdio", stdout, NULL);

    /* Insert the document to my_table */
    ins_stmt = "insert into my_table values (:1)";

    status = OCITypeByName(envhp, errhp, svchp, (const text *) "SYS",
                   (ub4) strlen((char *)"SYS"), (const text *) "XMLTYPE",
                   (ub4) strlen((char *)"XMLTYPE"), (CONST text *) 0,
                   (ub4) 0, dur, OCI_TYPEGET_HEADER,
                   (OCIType **) &amp;xmltdo)) ;

    if (status == OCI_SUCCESS)
    {
       exec_bind_xml(svchp, errhp, stmthp, (void *)doc, xmltdo, ins_stmt));
    }

   /* free xml ctx */
   OCIXmlDbFreeXmlCtx(xctx);
}

/*--------------------------------------------------------*/
/* execute a sql statement which binds xml data */
/*--------------------------------------------------------*/
sword exec_bind_xml(svchp, errhp, stmthp, xml, xmltdo, sqlstmt)
OCISvcCtx *svchp;
OCIError *errhp;
OCIStmt *stmthp;
void *xml;
OCIType *xmltdo;
OraText *sqlstmt;
{
   OCIBind *bndhp1 = (OCIBind *) 0;
   OCIBind *bndhp2 = (OCIBind *) 0;
   sword  status = 0;
   OCIInd ind = OCI_IND_NOTNULL;
   OCIInd *indp = &amp;ind;

   if(status = OCIStmtPrepare(stmthp, errhp, (OraText *)sqlstmt,
                    (ub4)strlen((char *)sqlstmt),
                    (ub4) OCI_NTV_SYNTAX, (ub4) OCI_DEFAULT)) {
     return OCI_ERROR;
   }

   if(status = OCIBindByPos(stmthp, &amp;bndhp1, errhp, (ub4) 1, (dvoid *) 0,
                   (sb4) 0, SQLT_NTY, (dvoid *) 0, (ub2 *)0,
                   (ub2 *)0, (ub4) 0, (ub4 *) 0, (ub4) OCI_DEFAULT)) {
     return OCI_ERROR;
   }

   if(status = OCIBindObject(bndhp1, errhp, (CONST OCIType *) xmltdo,
               (dvoid **) &amp;xml, (ub4 *) 0, (dvoid **) &amp;indp, (ub4 *) 0)) {
     return OCI_ERROR;
   }

   if(status = OCIStmtExecute(svchp, stmthp, errhp, (ub4) 1, (ub4) 0,
                (CONST OCISnapshot*) 0, (OCISnapshot*) 0, (ub4) OCI_DEFAULT)) {
     return OCI_ERROR;
  }

   return OCI_SUCCESS;
}
</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-649191E3-099B-49C4-97E3-4DC58F3960C0__CCHDJDBE">
                        <p class="titleinexample">Example 5-9 Modifying a Database Document with the DOM API</p><pre class="pre codeblock"><code>#include &lt;xml.h&gt;
#include &lt;ocixmldb.h&gt;
sword example2()
{
    OCIEnv *envhp;
    OCIError *errhp;
    OCISvcCtx *svchp;
    OCIStmt *stmthp;
    OCIDuration dur;
    OCIType *xmltdo;
  
    xmldocnode  *doc;
    xmlnodelist *item_list; ub4 ilist_l;
    ocixmldbparam params[1];
    text *sel_xml_stmt = (text *)"SELECT xml_col FROM my_table";
    ub4    xmlsize = 0;
    sword  status = 0;
    OCIDefine *defnp = (OCIDefine *) 0;

    /* Initialize envhp, svchp, errhp, dur, stmthp */
    /* ... */

    /* Get an xml context */
    params[0].name_ocixmldbparam = XCTXINIT_OCIDUR;
    params[0].value_ocixmldbparam = &amp;dur;
    xctx = OCIXmlDbInitXmlCtx(envhp, svchp, errhp, params, 1);

    /* Start processing */
    if(status = OCITypeByName(envhp, errhp, svchp, (const text *) "SYS",
                   (ub4) strlen((char *)"SYS"), (const text *) "XMLTYPE",
                   (ub4) strlen((char *)"XMLTYPE"), (CONST text *) 0,
                   (ub4) 0, dur, OCI_TYPEGET_HEADER,
                   (OCIType **) xmltdo_p)) {
       return OCI_ERROR;
    }

    if(!(*xmltdo_p)) {
       printf("NULL tdo returned\n");
       return OCI_ERROR;
    }

    if(status = OCIStmtPrepare(stmthp, errhp, (OraText *)selstmt,
                    (ub4)strlen((char *)selstmt),
                    (ub4) OCI_NTV_SYNTAX, (ub4) OCI_DEFAULT)) {
      return OCI_ERROR;
    }

    if(status = OCIDefineByPos(stmthp, &amp;defnp, errhp, (ub4) 1, (dvoid *) 0,
                   (sb4) 0, SQLT_NTY, (dvoid *) 0, (ub2 *)0,
                   (ub2 *)0, (ub4) OCI_DEFAULT)) {
       return OCI_ERROR;
    }

    if(status = OCIDefineObject(defnp, errhp, (OCIType *) *xmltdo_p,
                            (dvoid **) &amp;doc,
                            &amp;xmlsize, (dvoid **) 0, (ub4 *) 0)) {
      return OCI_ERROR;
    }

    if(status = OCIStmtExecute(svchp, stmthp, errhp, (ub4) 1, (ub4) 0,
                 (CONST OCISnapshot*) 0, (OCISnapshot*) 0, (ub4) OCI_DEFAULT)) {
      return OCI_ERROR;
    }

    /* We have the doc. Now we can operate on it */
    printf("Getting Item list...\n");

   item_list = XmlDomGetElemsByTag(xctx,(xmlelemnode *) elem,(oratext *)"Item"); 
    ilist_l   = XmlDomGetNodeListLength(xctx, item_list);
    printf(" Item list length = %d \n", ilist_l);

    for (i = 0; i &lt; ilist_l; i++)
    {
      elem = XmlDomGetNodeListItem(xctx, item_list, i);
      printf("Elem Name:%s\n", XmlDomGetNodeName(xctx, fragelem));
      XmlDomRemoveChild(xctx, fragelem);
    }

    XmlSaveDom(xctx, &amp;err, doc, "stdio", stdout, NULL);

   /* free xml ctx */
   OCIXmlDbFreeXmlCtx(xctx);

   return OCI_SUCCESS;
}</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>