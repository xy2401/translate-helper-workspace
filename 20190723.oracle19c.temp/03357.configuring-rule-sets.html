<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">
      <meta name="description" content="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">
      <title>Configuring Rule Sets</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Administrator's Guide ">
      <meta property="og:description" content="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Administrator's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-vault-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-28T15:24:22-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96302-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="configuring-realms.html" title="Previous" type="text/html">
      <link rel="next" href="configuring-command-rules.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Vault Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="DVADM">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="configuring-realms.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="configuring-command-rules.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Administrator's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Configuring Rule Sets </li>
            </ol>
            <a id="GUID-41914FF0-20E0-4878-8124-C6C976C19104" name="GUID-41914FF0-20E0-4878-8124-C6C976C19104"></a><a id="DVADM006"></a>
            
            <h2 id="DVADM-GUID-41914FF0-20E0-4878-8124-C6C976C19104" class="sect2"><span class="enumeration_chapter">5 </span>Configuring Rule Sets 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-AAC9F751-6498-4FD0-BB0E-64A6E2BB4E4A">What Are Rule Sets?</a><br>A rule set is a collection of one or more rules. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-6308CB8B-6777-44AF-A523-F1A956591F6D">Rule Sets and Rules in a Multitenant Environment</a><br>In a multitenant environment, you can create a rule set and its associated rules in the application root.
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-AE122705-6BAD-4B72-8321-C25187545589">Default Rule Sets</a><br>Oracle Database Vault provides a set of default rules sets that you can customize for your needs. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444">Creating a Rule Set</a><br>To create a rule set, you first create the rule set itself, and then you can edit the rule set to associate it with one or more rules. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F">Creating a Rule to Add to a Rule Set</a><br>A rule defines the behavior that you want to control; a rule set is a named collection of rules.
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-DB38EF41-865C-41D6-89AD-3C9E32084E82">Removing Rule Set References to Oracle Database Vault Components</a><br>Before you remove a rule set, you should remove the rule set references to Oracle Database Vault components.
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-24510A4C-39FA-4701-91A2-6E213BD9AE59">Deleting a Rule Set</a><br>You can use Enterprise Manager Cloud Control to find reference to the rule set and then delete the rule set. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3">How Rule Sets Work</a><br>Understanding how rule sets work helps to create more effective rule sets.
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97">Tutorial: Creating an Email Alert for Security Violations</a><br>This tutorial demonstrates how to use the <code class="codeph">UTL_MAIL</code> PL/SQL package and an access control list to create an email alert for security violations. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-D9AA1CCC-065C-4DFE-A078-908123401816">Tutorial: Configuring Two-Person Integrity, or Dual Key Security</a><br>This tutorial demonstrates how to use Oracle Database Vault to control the authorization of two users. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34">Guidelines for Designing Rule Sets</a><br>Oracle provides guidelines for designing rule sets.
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-980369CA-666C-4E3A-8F90-572F7F34CEC7">How Rule Sets Affect Performance</a><br>The number and complexity of rules can slow database performance. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7">Rule Set and Rule Related Reports and Data Dictionary Views</a><br>Oracle Database Vault provides reports and data dictionary views that are useful for analyzing rule sets and the rules within them.
                  </li>
               </ul>
            </div>
            <a id="DVADM70170"></a><div class="props_rev_3"><a id="GUID-AAC9F751-6498-4FD0-BB0E-64A6E2BB4E4A" name="GUID-AAC9F751-6498-4FD0-BB0E-64A6E2BB4E4A"></a><h3 id="DVADM-GUID-AAC9F751-6498-4FD0-BB0E-64A6E2BB4E4A" class="sect3">What Are Rule Sets?</h3>
               <div>
                  <p>A rule set is a collection of one or more rules. </p>
                  <p>You can associate the rule set with a realm authorization, factor assignment, command rule, or secure application role. </p>
                  <p>The rule set evaluates to true or false based on the evaluation of each rule it contains and the evaluation type (<span class="italic">All True</span> or <span class="italic">Any True</span>). A rule within a rule set is a PL/SQL expression that evaluates to true or false. You can create a rule and add the rule to multiple rule sets. 
                  </p>
                  <p>You can use rule sets to accomplish the following activities: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>As a further restriction to realm authorization, to define the conditions under which realm authorization is active</p>
                     </li>
                     <li>
                        <p>To define when to allow a command rule</p>
                     </li>
                     <li>
                        <p>To enable a secure application role</p>
                     </li>
                     <li>
                        <p>To define when to assign the identity of a factor</p>
                     </li>
                  </ul>
                  <p>When you create a rule set, Oracle Database Vault makes it available for selection when you configure the authorization for a realm, command rule, factor, or secure application role. </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="configuring-rule-sets.html#GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7" title="Oracle Database Vault provides reports and data dictionary views that are useful for analyzing rule sets and the rules within them.">Rule Set and Rule Related Reports and Data Dictionary Views</a></li>
                        <li><a href="oracle-database-vault-rule-set-apis.html#GUID-66E0EDFE-B4F0-4B5B-9657-B6C4737A37BF" title="You can use the DBMS_MACADM PL/SQL package and a set of Oracle Database Vault rule functions to manage rule sets.">Oracle Database Vault Rule Set APIs</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" name="GUID-6308CB8B-6777-44AF-A523-F1A956591F6D"></a><h3 id="DVADM-GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" class="sect3">Rule Sets and Rules in a Multitenant Environment</h3>
               <div>
                  <p>In a multitenant environment, you can create a rule set and its associated rules in the application root.</p>
                  <p>A common realm must use a common rule set when the associated realm or command rule is evaluated by Database Vault. The common rule set and its rules can only be created in the application root. After the common rule set is created, it exists in every container that is associated with the root where the common rule set is created. The common rule set can only include common rules.</p>
                  <p>To configure a common rule set and its rules, you must be commonly granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="configuring-command-rules.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" title="In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.">Command Rules in a Multitenant Environment</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DVADM70171"></a><div class="props_rev_3"><a id="GUID-AE122705-6BAD-4B72-8321-C25187545589" name="GUID-AE122705-6BAD-4B72-8321-C25187545589"></a><h3 id="DVADM-GUID-AE122705-6BAD-4B72-8321-C25187545589" class="sect3">Default Rule Sets</h3>
               <div>
                  <p>Oracle Database Vault provides a set of default rules sets that you can customize for your needs. </p>
                  <div class="section">
                     <p>You can find a full list of rule sets by querying the <code class="codeph">DBA_DV_RULE_SET</code> data dictionary view. To find rules that are associated with a rule set, query the <code class="codeph">DBA_DV_RULE_SET_RULE</code> data dictionary view.
                     </p>
                     <p>The default rule sets are as follows: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">Allow Dumping Datafile Header:</span> This rule set prevents the dumping of data blocks.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Allow Fine Grained Control for Alter System: </span>This rule set enables you to control the ability of users to set initialization parameters using the <code class="codeph">ALTER SYSTEM</code> SQL statement.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Allow Fine Grained Control of System Parameters:</span><span class="bold"> Note:</span> This rule set has been deprecated.
                           </p>
                           <p>This rule set provides a very flexible, fine-grained control over initialization parameters that manage system security, dump or destination location, backup and restore settings, optimizer settings, PL/SQL debugging, and security parameters. It affects the following initialization parameters, based on the associated rules of this rule set:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="bold">Are System Security Parameters Allowed rule:</span> Cannot set <code class="codeph">O7_DICTIONARY_ACCESSIBILITY</code></p>
                              </li>
                              <li>
                                 <p><span class="bold">Are Dump or Dest Parameters Allowed rule:</span> Cannot set the following parameters:
                                 </p>
                                 <div class="tblformal" id="GUID-AE122705-6BAD-4B72-8321-C25187545589__GUID-92E14AAF-1BEC-410A-A38D-988BD54A2261">
                                    <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="Are Dump or Desk Parameters Allowed rule, from left to right, top to bottom" width="90%" frame="hsides" border="1" rules="rows">
                                       <thead>
                                          <tr align="left" valign="top">
                                             <th align="left" valign="bottom" width="50%" id="d18924e609">Parameter B-D</th>
                                             <th align="left" valign="bottom" width="50%" id="d18924e611">Parameters D-U</th>
                                          </tr>
                                       </thead>
                                       <tbody>
                                          <tr align="left" valign="top">
                                             <td align="left" valign="top" width="50%" id="d18924e615" headers="d18924e609 ">
                                                <p><code class="codeph">BACKGROUND_DUMP_DEST</code></p>
                                             </td>
                                             <td align="left" valign="top" width="50%" headers="d18924e615 d18924e611 ">
                                                <p><code class="codeph">DB_RECOVERY_FILE_DEST</code></p>
                                             </td>
                                          </tr>
                                          <tr align="left" valign="top">
                                             <td align="left" valign="top" width="50%" id="d18924e624" headers="d18924e609 ">
                                                <p><code class="codeph">CORE_DUMP_DEST</code></p>
                                             </td>
                                             <td align="left" valign="top" width="50%" headers="d18924e624 d18924e611 ">
                                                <p><code class="codeph">DIAGNOSTIC_DEST</code></p>
                                             </td>
                                          </tr>
                                          <tr align="left" valign="top">
                                             <td align="left" valign="top" width="50%" id="d18924e633" headers="d18924e609 ">
                                                <p><code class="codeph">DUMP_DATAFILE</code></p>
                                             </td>
                                             <td align="left" valign="top" width="50%" headers="d18924e633 d18924e611 ">
                                                <p><code class="codeph">LOG_ARCHIVE_MIN_SUCCEED_DEST</code></p>
                                             </td>
                                          </tr>
                                          <tr align="left" valign="top">
                                             <td align="left" valign="top" width="50%" id="d18924e642" headers="d18924e609 ">
                                                <p><code class="codeph">USER_DUMP_DEST</code></p>
                                             </td>
                                             <td align="left" valign="top" width="50%" headers="d18924e642 d18924e611 ">
                                                <p><code class="codeph">LOG_ARCHIVE_TRACE</code></p>
                                             </td>
                                          </tr>
                                          <tr align="left" valign="top">
                                             <td align="left" valign="top" width="50%" id="d18924e651" headers="d18924e609 ">
                                                <p><code class="codeph">DB_CREATE_ONLINE_LOG_DEST</code></p>
                                             </td>
                                             <td align="left" valign="top" width="50%" headers="d18924e651 d18924e611 ">
                                                <p><code class="codeph">USER_DUMP_DEST</code></p>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </div>
                                 <!-- class="inftblhruleinformal" -->
                              </li>
                              <li>
                                 <p><span class="bold">Are Backup Restore Parameters Allowed rule:</span> Cannot set <code class="codeph">RECYCLEBIN</code> (but does not prevent disabling the recycle bin)
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Are Database File Parameters Allowed rule:</span> Cannot set <code class="codeph">CONTROL_FILES</code></p>
                              </li>
                              <li>
                                 <p><span class="bold">Are Optimizer Parameters Allowed rule:</span> Can set <code class="codeph">OPTIMIZER_SECURE_VIEW_MERGING = FALSE</code> (but <code class="codeph">TRUE</code> not allowed)
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Are PL-SQL Parameters Allowed rule:</span> Can set <code class="codeph">PLSQL_DEBUG = FALSE</code> (but <code class="codeph">TRUE</code> not allowed).
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Are Security Parameters Allowed rule:</span> Cannot set the following:
                                 </p>
                                 <div class="tblformal" id="GUID-AE122705-6BAD-4B72-8321-C25187545589__GUID-1A7ECDA0-75B3-428E-9B2C-63766279E2B4">
                                    <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="Are Security Parameters Allowed, left to right, top to bottom" width="90%" frame="hsides" border="1" rules="rows">
                                       <thead>
                                          <tr align="left" valign="top">
                                             <th align="left" valign="bottom" width="50%" id="d18924e709">Parameters A-A</th>
                                             <th align="left" valign="bottom" width="50%" id="d18924e711">Parameters O-S</th>
                                          </tr>
                                       </thead>
                                       <tbody>
                                          <tr align="left" valign="top">
                                             <td align="left" valign="top" width="50%" id="d18924e715" headers="d18924e709 ">
                                                <p><code class="codeph">AUDIT_SYS_OPERATIONS = FALSE</code></p>
                                             </td>
                                             <td align="left" valign="top" width="50%" headers="d18924e715 d18924e711 ">
                                                <p><code class="codeph">OS_ROLES = TRUE</code></p>
                                             </td>
                                          </tr>
                                          <tr align="left" valign="top">
                                             <td align="left" valign="top" width="50%" id="d18924e724" headers="d18924e709 ">
                                                <p><code class="codeph">AUDIT_TRAIL = NONE</code> or <code class="codeph">FALSE</code></p>
                                             </td>
                                             <td align="left" valign="top" width="50%" headers="d18924e724 d18924e711 ">
                                                <p><code class="codeph">REMOTE_OS_ROLES = TRUE</code></p>
                                             </td>
                                          </tr>
                                          <tr align="left" valign="top">
                                             <td align="left" valign="top" width="50%" id="d18924e736" headers="d18924e709 ">
                                                <p><code class="codeph">AUDIT_SYSLOG_LEVEL</code></p>
                                             </td>
                                             <td align="left" valign="top" width="50%" headers="d18924e736 d18924e711 ">
                                                <p><code class="codeph">SQL92_SECURITY = FALSE</code></p>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </div>
                                 <!-- class="inftblhruleinformal" -->
                              </li>
                           </ul>
                           <p>See <a href="../refrn/initialization-parameters.html#REFRN001" target="_blank"><span class="italic">Oracle Database Reference</span></a> for detailed information about initialization parameters.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Allow Sessions:</span> Controls the ability to create a session in the database. This rule set enables you to add rules to control database logins using the CONNECT command rule. The CONNECT command rule is useful to control or limit <code class="codeph">SYSDBA</code> access to programs that require its use. This rule set is not populated. 
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Allow System Parameters:</span> <span class="bold"> Note:</span> This rule set has been deprecated. 
                           </p>
                           <p>Controls the ability to set system initialization parameters. Since Oracle Database 11<span class="italic">g</span> Release 2 (11.2), the Allow Fine Grained Control of System Parameters rule set has replaced this rule set, but it is still supported for backward compatibility. The Allow System Parameters rule set is not associated with any commands, but its rules are still available and can be used with any custom rule set. Oracle recommends that you use the Allow Fine Grained Control of System Parameters rule set.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Can Grant VPD Administration:</span> Controls the ability to grant the <code class="codeph">GRANT EXECUTE</code> or <code class="codeph">REVOKE EXECUTE</code> privileges on the Oracle Virtual Private Database <code class="codeph">DBMS_RLS</code> package, with the <code class="codeph">GRANT</code> and <code class="codeph">REVOKE</code> statements.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Can Maintain Accounts/Profiles:</span> Controls the roles that manage user accounts and profiles, through the <code class="codeph">CREATE USER</code>, <code class="codeph">DROP USER</code>, <code class="codeph">CREATE PROFILE</code>, <code class="codeph">ALTER PROFILE</code>, or <code class="codeph">DROP PROFILE</code> statements. 
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Can Maintain Own Account:</span> Allows the accounts with the <code class="codeph">DV_ACCTMGR</code> role to manage user accounts and profiles with the <code class="codeph">ALTER USER</code> statement. Also allows individual accounts to change their own password using the <code class="codeph">ALTER USER</code> statement. See <a href="oracle-database-vault-schemas-roles-and-accounts.html#GUID-BE9F1454-3798-4B2E-A07D-98A3B6263802" title="The DV_ACCTMGR role is a powerful role, used for accounts management.">DV_ACCTMGR Database Vault Account Manager Role</a> for more information about the <code class="codeph">DV_ACCTMGR</code> role.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Disabled:</span> Convenience rule set to quickly disable security configurations like realms, command rules, factors, and secure application roles.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Enabled:</span> Convenience rule set to quickly enable system features.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Not allow to set AUDIT_SYS_OPERATIONS to False: </span>Prevents the <code class="codeph">AUDIT_SYS_OPERATIONS</code> initialization parameter from being set to <code class="codeph">FALSE</code>. If unified auditing is enabled, then the <code class="codeph">AUDIT_SYS_OPERATIONS</code> parameter has no effect.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Not allow to set OPTIMIZER_SECURE_VIEW_MERGING to True: </span>Prevents the <code class="codeph">OPTIMIZER_SECURE_VIEW_MERGING</code> initialization parameter from being set to <code class="codeph">TRUE</code>. 
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Not allow to set OS_ROLES to True: </span> Prevents the <code class="codeph">OS_ROLES</code> initialization parameter from being set to <code class="codeph">TRUE</code>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Not allow to set PLSQL_DEBUG to True: </span> Prevents the <code class="codeph">PLSQL_DEBUG</code> initialization parameter from being set to <code class="codeph">TRUE</code>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Not allow to set REMOTE_OS_ROLES to True: </span> Prevents the <code class="codeph">REMOTE_OS_ROLES</code> initialization parameter from being set to <code class="codeph">TRUE</code>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Not allow to set SQL92_SECURITY to False: </span>Prevents the <code class="codeph">SQL92_SECURITY</code> from being set to <code class="codeph">FALSE</code>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Not allow to turn off AUDIT_TRAIL: </span></p>Prevents the <code class="codeph">AUDIT_TRAIL</code> initialization parameter from being turned off. If unified auditing is enabled, then the <code class="codeph">AUDIT_TRAIL</code> parameter has no effect.
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DVADM70172"></a><div class="props_rev_3"><a id="GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444" name="GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444"></a><h3 id="DVADM-GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444" class="sect3">Creating a Rule Set</h3>
               <div>
                  <p>To create a rule set, you first create the rule set itself, and then you can edit the rule set to associate it with one or more rules. </p>
                  <div class="section"> You can associate a new rule with the rule set, add existing rules to the rule set, or delete a rule association from the rule set. </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Log in to Oracle Database Vault Administrator from Cloud Control as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege. <a href="getting-started-with-oracle-database-vault.html#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for managing Oracle Database Vault.">Logging in to Oracle Database Vault from Oracle Enterprise Cloud Control</a> explains how to log in.</span></li>
                     <li class="stepexpand"><span>In the Administration page, under Database Vault Components, click <span class="bold">Rule Sets</span>.</span></li>
                     <li class="stepexpand"><span>In the Rule Sets page, click <span class="bold">Create</span> to display the Create Rule Sets page. </span><div><br><img src="img/create_rulesets122.png" alt="Description of create_rulesets122.png follows" title="Description of create_rulesets122.png follows" longdesc="img_text/create_rulesets122.html"><br><a href="img_text/create_rulesets122.html">Description of the illustration create_rulesets122.png</a><br><div class="figure" id="GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444__GUID-CBBDE68C-61AE-4911-A5BA-01D5305A3DE1"></div>
                           <!-- class="figure" -->
                        </div>
                     </li>
                     <li class="stepexpand"><span>In the General page, enter the following information: </span><div>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="bold">Name:</span> Enter a name for the rule set. It can contain up to 90 characters in mixed-case. Spaces are allowed. This attribute is mandatory.
                                 </p>
                                 <p>Oracle suggests that you start the name with a verb and complete it with the realm or command rule name to which the rule set is attached. For example: </p><pre class="oac_no_warn" dir="ltr">Limit SQL*Plus access
</pre></li>
                              <li>
                                 <p><span class="bold">Description:</span> Enter a description of the functionality for the rule set. It can have up to 1024 characters in mixed-case. This attribute is optional.
                                 </p>
                                 <p>You may want to document the business requirement of the rule set. For example:   </p><pre class="oac_no_warn" dir="ltr">Rule to limit access to SQL*Plus
</pre></li>
                              <li>
                                 <p><span class="bold">Static Rule Set:</span> You can control how often the rule set is evaluated when it is accessed during a user session. A static rule set is evaluated once when accessed for the first time in a user session. After that, the evaluated value is re-used in the user session. On the other hand, a non-static rule set is evaluated every time it is accessed.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Status:</span> Select either <span class="bold">Enabled</span> or <span class="bold">Disabled</span> to enable or disable the rule set during run time. This attribute is mandatory.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Evaluation Options:</span> If you plan to assign multiple rules to a rule set, then select one of the following settings:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><span class="bold">All True:</span> All rules in the rule set must evaluate to true for the rule set itself to evaluate to true.
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Any True:</span> At least one rule in the rule set must evaluate to true for the rule set itself to evaluate to true.
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Click <span class="bold">Next</span> to display the Associate with Rules page. </span></li>
                     <li class="stepexpand"><span>Select one of the following options: </span><div>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="bold">Add Existing Rule:</span> Double-click from the list of available rules to move them to the Selected Rules list, and then click <span class="bold">OK</span>. 
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Create Rule:</span> Enter a name and <code class="codeph">WHERE</code> clause expression that evaluates to true or false. Click <span class="bold">OK</span>. See <a href="configuring-rule-sets.html#GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" title="A rule defines the behavior that you want to control; a rule set is a named collection of rules.">Creating a Rule to Add to a Rule Set</a> for more information.
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Click <span class="bold">Next</span> to display the Error handling and Audit options page. </span></li>
                     <li class="stepexpand"><span>Enter the following information: </span><div>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="bold">Error Handling:</span> Select either <span class="bold">Show Error Message</span> or <span class="bold">Do Not Show Error Message</span>.
                                 </p>
                                 <p>An advantage of selecting <span class="bold">Do Not Show Error Message</span> and then enabling auditing is that you can track the activities of a potential intruder. The audit report reveals the activities of the intruder, yet the intruder is unaware that you are doing this because he or she does not see any error messages. 
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Fail Code:</span> Enter a number in the ranges of  -20000 to -20999 or 20000 to 20999. The error code is displayed with the <span class="bold">Fail Message</span> (created next) when the rule set evaluates to false or one of the associated rules contains an invalid PL/SQL expression. If you omit this setting, then Oracle Database Vault displays a generic error code.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Fail Message:</span> Enter a message, up to 80 characters in mixed-case, to associate with the fail code you specified under <span class="bold">Fail Code</span>. The error message is displayed when the rule set evaluates to false or one of the associated rules contains an invalid PL/SQL expression. If you do not specify an error message, then Oracle Database Vault displays a generic error message.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Custom Event Handler Option:</span> Select one of the following options to determine when to run the <span class="bold">Custom Event Handler Logic</span> (created next).
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><span class="bold">Handler Disabled:</span> Does not run any custom event method.
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Execute On Failure:</span> Runs the custom event method when the rule set evaluates to false or one of the associated rules contains an invalid PL/SQL expression.
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Execute On Success:</span> Runs the custom event method when the rule set evaluates to true.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>You can create a custom event method to provide special processing outside the standard Oracle Database Vault rule set auditing features. For example, you can use an event handler to initiate a workflow process or send event information to an external system. </p>
                              </li>
                              <li>
                                 <p><span class="bold">Custom Event Handler Logic:</span> Enter a PL/SQL expression up to 255 characters in mixed-case. An expression may include any package procedure or standalone procedure. You can create your own expression or use the PL/SQL interfaces described in <a href="oracle-database-vault-rule-set-apis.html#GUID-66E0EDFE-B4F0-4B5B-9657-B6C4737A37BF" title="You can use the DBMS_MACADM PL/SQL package and a set of Oracle Database Vault rule functions to manage rule sets.">Oracle Database Vault Rule Set APIs</a>.
                                 </p>
                                 <p>Write the expression as a fully qualified procedure (such as <span class="italic"><code class="codeph">schema</code></span>.<span class="italic"><code class="codeph">procedure_name</code></span>). Do not include any other form of SQL statements. If you are using application package procedures or standalone procedures, you must provide <code class="codeph">DVSYS</code> with the <code class="codeph">EXECUTE</code> privilege on the object. The procedure signature can be in one of the following two forms:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><code class="codeph">PROCEDURE</code> <span class="italic"><code class="codeph">my_ruleset_handler(</code></span><span class="italic"><code class="codeph">p_ruleset_name</code></span><code class="codeph"> IN VARCHAR2,</code> <span class="italic"><code class="codeph">p_ruleset_rules</code></span> <code class="codeph">IN BOOLEAN)</code>: Use this form when the name of the rule set and its return value are required in the handler processing.
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">PROCEDURE</code> <span class="italic"><code class="codeph">my_ruleset_handler</code></span>: Use this form when the name of the rule set and its return value are not required in the handler processing.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>Be aware that you cannot use invoker's rights procedures as event handlers. Doing so can cause the rule set evaluation to fail unexpectedly. Only use definer's rights procedures as event handlers.</p>
                                 <p>Use the following syntax:</p><pre class="oac_no_warn" dir="ltr"><span class="italic">myschema</span>.<span class="italic">my_ruleset_handler</span>
</pre></li>
                              <li>
                                 <p><span class="bold">Audit Options:</span> Select from the following options to generate an audit record for the rule set in a non-unified auditing environment. Oracle Database Vault writes the audit trail to the <code class="codeph">DVSYS.AUDIT_TRAIL$</code> table. (If you have enabled unified auditing, then this setting does not capture audit records. Instead, you must create unified audit policies to capture this information.)
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><span class="bold">Audit Disabled:</span> Does not create an audit record under any circumstances.
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Audit on Success:</span> Creates an audit record when the rule set evaluates to true.
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Audit On Failure:</span> Creates an audit record when the rule set evaluates to false or one of the associated rules contains an invalid PL/SQL expression.
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Audit On Success or Failure:</span> Creates an audit record whenever a rule set is evaluated.
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Click <span class="bold">Next</span> to display the Review page. </span></li>
                     <li class="stepexpand"><span>Review the settings, and if they are satisfactory, click <span class="bold">Finish</span>. </span></li>
                  </ol>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-E2477C97-F87A-4FCF-A8C7-AFACA707B444__GUID-83538986-4E3D-4F9A-B5DA-3C06F335F5DA">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="auditing-oracle-database-vault.html#GUID-9E9C7DBE-A8C5-4F02-8E90-F7311D47AB92" title="You can audit activities in Oracle Database Vault, such as changes to policy configurations.">Auditing Oracle Database Vault</a> for more information about audit records in the <code class="codeph">DVSYS.AUDIT_TRAIL$</code> table
                           </p>
                        </li>
                        <li>
                           <p><a href="../dbseg/configuring-audit-policies.html#DBSEG419" target="_blank"><span><cite>Oracle Database Security Guide</cite></span></a> for information about creating unified audit policies for Database Vault
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DVADM70177"></a><div class="props_rev_3"><a id="GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" name="GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F"></a><h3 id="DVADM-GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" class="sect3">Creating a Rule to Add to a Rule Set</h3>
               <div>
                  <p>A rule defines the behavior that you want to control; a rule set is a named collection of rules.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-FDD7A2C2-4E6A-4D84-828C-7040F4B297DA">About Creating Rules</a><br>You can create rules during the rule set creation process, or independently of it. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-A5550945-496A-411D-922F-B4BFDEA85FD9">Default Rules</a><br>Default rules are rules that have commonly used behavior, such as checking if an action evaluates to true or false. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-AAAFC806-8DB8-45A7-A058-B7CD352B0C50">Creating a New Rule</a><br>You can create a new rule in Enterprise Manager Cloud Control. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-2D82F552-0D94-44B8-9F81-2F42E0EAA4FD">Adding Existing Rules to a Rule Set</a><br>After you have created one or more rules, you can use Enterprise Manager Cloud Control to add to a rule set. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-D22EB64B-F62F-4747-B218-FE1C7C3BC709">Removing a Rule from a Rule Set</a><br>Before you remove a rule from a rule set, you can locate the various references to it using Cloud Control. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               <a id="DVADM71223"></a><div class="props_rev_3"><a id="GUID-FDD7A2C2-4E6A-4D84-828C-7040F4B297DA" name="GUID-FDD7A2C2-4E6A-4D84-828C-7040F4B297DA"></a><h4 id="DVADM-GUID-FDD7A2C2-4E6A-4D84-828C-7040F4B297DA" class="sect4">About Creating Rules</h4>
                  <div>
                     <p>You can create rules during the rule set creation process, or independently of it. </p>
                     <p>After you create the rule, you can associate a rule set with one or more additional rules.</p>
                     <p>If you create a new rule during the rule set creation process, the rule is automatically added to the current rule set. You also can add existing rules to the rule set. Alternatively, you can omit adding rules to the rule set and use it as a template for rule sets you may want to create in the future. </p>
                     <p>You can add as many rules that you want to a rule set, but for better design and performance, you should keep the rule sets simple. See <a href="configuring-rule-sets.html#GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34" title="Oracle provides guidelines for designing rule sets.">Guidelines for Designing Rule Sets</a> for additional advice.
                     </p>
                     <p>The rule set evaluation depends on the evaluation of its rules using the Evaluation Options (<span class="bold">All True</span> or <span class="bold">Any True</span>). If a rule set is disabled, Oracle Database Vault evaluates the rule set to true without evaluating its rules.
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="configuring-rule-sets.html#GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3" title="Understanding how rule sets work helps to create more effective rule sets.">How Rule Sets Work</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" title="A rule defines the behavior that you want to control; a rule set is a named collection of rules.">Creating a Rule to Add to a Rule Set</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DVADM71280"></a><a id="DVADM71279"></a><div class="props_rev_3"><a id="GUID-A5550945-496A-411D-922F-B4BFDEA85FD9" name="GUID-A5550945-496A-411D-922F-B4BFDEA85FD9"></a><h4 id="DVADM-GUID-A5550945-496A-411D-922F-B4BFDEA85FD9" class="sect4">Default Rules</h4>
                  <div>
                     <p>Default rules are rules that have commonly used behavior, such as checking if an action evaluates to true or false. </p>
                     <div class="section">
                        <p>You can find a full list of rules by querying the <code class="codeph">DBA_DV_RULE</code> data dictionary view.<a href="configuring-rule-sets.html#GUID-A5550945-496A-411D-922F-B4BFDEA85FD9__CHDGGDFC" title="Describes default rules">Table 5-1</a> lists the current default Oracle Database rules.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-A5550945-496A-411D-922F-B4BFDEA85FD9__CHDGGDFC">
                        <p class="titleintable">Table 5-1 Current Default Oracle Database Vault Rules</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Current Default Oracle Database Vault Rules" summary="Describes default rules" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="41%" id="d18924e1776">Rule</th>
                                 <th align="left" valign="bottom" width="59%" id="d18924e1779">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1784" headers="d18924e1776 ">
                                    <p>Are Backup Restore Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1784 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Checks if the current SQL statement attempts to turn on the <code class="codeph">RECYCLEBIN</code> parameter
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1796" headers="d18924e1776 ">
                                    <p>Are Database File Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1796 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Checks if the current SQL statement attempts to alter control file related configuration</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1805" headers="d18924e1776 ">
                                    <p>Are Dump Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1805 d18924e1779 ">
                                    <p>Checks if the current SQL statement attempts to alter initialization parameters related to the destination of a dump </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1812" headers="d18924e1776 ">
                                    <p>Are Dest Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1812 d18924e1779 ">
                                    <p>Checks if the current SQL statement attempts to alter initialization parameters related to the size limit of a dump </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1819" headers="d18924e1776 ">
                                    <p>Are Dump or Dest Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1819 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Checks if the current SQL statement attempts to alter initialization parameters related to the size limit or destination of dump </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1828" headers="d18924e1776 ">
                                    <p>Are Optimizer Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1828 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Checks if the current SQL statement attempts to alter the setting for the <code class="codeph">OPTIMIZER_SECURE_VIEW_MERGING</code> parameter
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1840" headers="d18924e1776 ">
                                    <p>Are PL-SQL Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1840 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Checks if the current SQL statement attempts to alter the <code class="codeph">PLSQL_DEBUG</code> initialization parameter.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1852" headers="d18924e1776 ">
                                    <p>Are Security Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1852 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Checks if there is an attempt to disable the following initialization parameters:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p><code class="codeph">AUDIT_SYS_OPERATIONS</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">AUDIT_TRAIL</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">AUDIT_SYSLOG_LEVEL</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">SQL92_SECURITY</code></p>
                                       </li>
                                    </ul>
                                    <p>Note that if you have enabled unified auditing, then the <code class="codeph">AUDIT_SYS_OPERATIONS</code>, <code class="codeph">AUDIT_TRAIL</code>, and <code class="codeph">AUDIT_SYSLOG_LEVEL</code> parameters have no effect.
                                    </p>
                                    <p>This rule prevents any attempt to enable the following parameters:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p><code class="codeph">OS_ROLES</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">REMOTE_OS_ROLES</code></p>
                                       </li>
                                    </ul>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1900" headers="d18924e1776 ">
                                    <p>Are System Security Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1900 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Prevents modification of the following parameters:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p><code class="codeph">O7_DICTIONARY_ACCESSIBILITY</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">DYNAMIC_RLS_POLICIES</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">_SYSTEM_TRIG_ENABLED</code></p>
                                       </li>
                                    </ul>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1922" headers="d18924e1776 ">
                                    <p>False</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1922 d18924e1779 ">
                                    <p>Evaluates to <code class="codeph">FALSE</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1931" headers="d18924e1776 ">
                                    <p>Is Alter DVSYS Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1931 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Checks if the logged-in user can execute the <code class="codeph">ALTER USER</code> statement on other users successfully
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1944" headers="d18924e1776 ">
                                    <p>Is Database Administrator</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1944 d18924e1779 ">
                                    <p>Checks if a user has been granted the <code class="codeph">DBA</code> role
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1954" headers="d18924e1776 ">
                                    <p>Is Drop User Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1954 d18924e1779 ">
                                    <p>Checks if the logged in user can drop users</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1961" headers="d18924e1776 ">
                                    <p>Is Dump of Block Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1961 d18924e1779 ">
                                    <p>Checks if the dumping of blocks is allowed</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1968" headers="d18924e1776 ">
                                    <p>Is First Day of Month</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1968 d18924e1779 ">
                                    <p>Checks if the specified date is the first day of the month</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1975" headers="d18924e1776 ">
                                    <p>Is Label Administrator</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1975 d18924e1779 ">
                                    <p>Checks if the user has been granted the <code class="codeph">LBAC_DBA</code> role
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1985" headers="d18924e1776 ">
                                    <p>Is Last Day of Month</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1985 d18924e1779 ">
                                    <p>Checks if the specified date is the last day of the month</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e1992" headers="d18924e1776 ">
                                    <p>Is _dynamic_rls_init Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e1992 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Prevent modification of the <code class="codeph">DYNAMIC_RLS_POLICIES</code> parameter
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2004" headers="d18924e1776 ">
                                    <p>Is Parameter Value False</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2004 d18924e1779 ">
                                    <p>Checks if a specified parameter value has been set to <code class="codeph">FALSE</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2013" headers="d18924e1776 ">
                                    <p>Is Parameter Value None</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2013 d18924e1779 ">
                                    <p>Checks if a specified parameter value has been set to <code class="codeph">NONE</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2022" headers="d18924e1776 ">
                                    <p>Is Parameter Value Not False</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2022 d18924e1779 ">
                                    <p>Checks if a specified parameter value has been set to <code class="codeph">&lt;&gt; FALSE</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2031" headers="d18924e1776 ">
                                    <p>Is Parameter Value Not None</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2031 d18924e1779 ">
                                    <p>Checks if a specified parameter value has been set to <code class="codeph">&lt;&gt; NONE</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2041" headers="d18924e1776 ">
                                    <p>Is Parameter Value Not Off</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2041 d18924e1779 ">
                                    <p>Checks if a specified parameter value has been set to <code class="codeph">&lt;&gt; OFF</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2050" headers="d18924e1776 ">
                                    <p>Is Parameter Value Not On</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2050 d18924e1779 ">
                                    <p>Checks if a specified parameter value has been set to <code class="codeph">&lt;&gt; ON</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2059" headers="d18924e1776 ">
                                    <p>Is Parameter Value Not True</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2059 d18924e1779 ">
                                    <p>Checks if a specified parameter value has been set to <code class="codeph">&lt;&gt; TRUE</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2068" headers="d18924e1776 ">
                                    <p>Is Parameter Value Off</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2068 d18924e1779 ">
                                    <p>Checks if a specified parameter value has been set to <code class="codeph">OFF</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2077" headers="d18924e1776 ">
                                    <p>Is Parameter Value On</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2077 d18924e1779 ">
                                    <p>Checks if a specified parameter value has been set to <code class="codeph">ON</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2086" headers="d18924e1776 ">
                                    <p>Is Parameter Value True</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2086 d18924e1779 ">
                                    <p>Checks if a specified parameter value has been set to <code class="codeph">TRUE</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2095" headers="d18924e1776 ">
                                    <p>Is SYS or SYSTEM User</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2095 d18924e1779 ">
                                    <p>Checks if the user is <code class="codeph">SYS</code> or <code class="codeph">SYSTEM</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2107" headers="d18924e1776 ">
                                    <p>Is Security Administrator</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2107 d18924e1779 ">
                                    <p>Checks if a user has been granted the <code class="codeph">DV_ADMIN</code> role
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2117" headers="d18924e1776 ">
                                    <p>Is Security Owner</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2117 d18924e1779 ">
                                    <p>Checks if a user has been granted the <code class="codeph">DV_OWNER</code> role
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2127" headers="d18924e1776 ">
                                    <p>Is User Manager</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2127 d18924e1779 ">
                                    <p>Checks if a user has been granted the <code class="codeph">DV_ACCTMGR</code> role
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2137" headers="d18924e1776 ">
                                    <p>Is _system_trig_enabled Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2137 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Checks if the user tries to modify the following system parameters, but in database recovery operations, this rule permits these parameters to be changed.</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p><code class="codeph">AUDIT_SYS_OPERATIONS</code>: Prevents users from setting it to <code class="codeph">FALSE</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">AUDIT_TRAIL</code>: Prevents users from setting it to <code class="codeph">NONE</code> or <code class="codeph">FALSE</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">AUDIT_SYSLOG_LEVEL</code>: Blocks all operations on this parameter
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">CONTROL_FILES</code>: Blocks all operations
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">OPTIMIZER_SECURE_VIEW_MERGING</code>: Prevents users from setting it to <code class="codeph">TRUE</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">OS_ROLES</code>: Prevents users from setting it to <code class="codeph">TRUE</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">PLSQL_DEBUG</code>: Prevents users from setting it to <code class="codeph">ON</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">RECYCLEBIN</code>: Prevents users from setting it to <code class="codeph">ON</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">REMOTE_OS_ROLES</code>: Prevents users from setting it to <code class="codeph">TRUE</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">SQL92_SECURITY</code>: Prevents users from setting it to <code class="codeph">FALSE</code></p>
                                       </li>
                                    </ul>
                                    <p>Note that if you have enabled unified auditing, then the <code class="codeph">AUDIT_SYS_OPERATIONS</code>, <code class="codeph">AUDIT_TRAIL</code>, and <code class="codeph">AUDIT_SYSLOG_LEVEL</code> parameters have no effect.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2228" headers="d18924e1776 ">
                                    <p>Is o7_dictionary_accessibility Parameters Allowed</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2228 d18924e1779 ">
                                    <p>Note: This default rule has been deprecated.</p>
                                    <p>Checks if current SQL statement attempts to alter the setting of the <code class="codeph">O7_DICTIONARY_ACCESSIBILITY</code> parameter
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2240" headers="d18924e1776 ">
                                    <p>Login User Is Object User</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2240 d18924e1779 ">
                                    <p>Checks if the logged in user is the same as the user about to be altered by the current SQL statement</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2247" headers="d18924e1776 ">
                                    <p>No Exempt Access Policy Role</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2247 d18924e1779 ">
                                    <p>Checks if the user has been granted the <code class="codeph">EXEMPT ACCESS POLICY</code> role or is user <code class="codeph">SYS</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2259" headers="d18924e1776 ">
                                    <p>Not Export Session</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2259 d18924e1779 ">
                                    <p>Obsolete</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d18924e2266" headers="d18924e1776 ">
                                    <p>True</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d18924e2266 d18924e1779 ">
                                    <p>Evaluates to <code class="codeph">TRUE</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" title="A rule defines the behavior that you want to control; a rule set is a named collection of rules.">Creating a Rule to Add to a Rule Set</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70178"></a><div class="props_rev_3"><a id="GUID-AAAFC806-8DB8-45A7-A058-B7CD352B0C50" name="GUID-AAAFC806-8DB8-45A7-A058-B7CD352B0C50"></a><h4 id="DVADM-GUID-AAAFC806-8DB8-45A7-A058-B7CD352B0C50" class="sect4">Creating a New Rule</h4>
                  <div>
                     <p>You can create a new rule in Enterprise Manager Cloud Control. </p>
                     <ol>
                        <li class="stepexpand"><span>Log in to Oracle Database Vault Administrator from Cloud Control as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege. <a href="getting-started-with-oracle-database-vault.html#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for managing Oracle Database Vault.">Logging in to Oracle Database Vault from Oracle Enterprise Cloud Control</a> explains how to log in.</span></li>
                        <li class="stepexpand"><span>In the Administration page, under Database Vault Components, click <span class="bold">Rules</span>.</span></li>
                        <li class="stepexpand"><span>Click the <span class="bold">Create</span> button.</span></li>
                        <li class="stepexpand"><span>In the Create Rule page, enter the following settings:</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">Name:</span> Enter a name for the rule. Use up to 90 characters in mixed-case.
                                    </p>
                                    <p>Oracle suggests that you start the name with a verb and complete the name with the purpose of the rule. For example:</p><pre class="oac_no_warn" dir="ltr">Prevent non-admin access to SQL*Plus
</pre><p>Because rules do not have a <span class="bold">Description</span> field, make the name explicit but be sure to not exceed over 90 characters. 
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Rule Expression:</span> Enter a PL/SQL expression that fits the following requirements: 
                                    </p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>It is valid in a SQL <code class="codeph">WHERE</code> clause.
                                          </p>
                                       </li>
                                       <li>
                                          <p>It can be a freestanding and valid PL/SQL Boolean expression such as the following: </p><pre class="oac_no_warn" dir="ltr">TO_CHAR(SYSDATE,'HH24') = '12'
</pre></li>
                                       <li>
                                          <p>It must evaluate to a Boolean (<code class="codeph">TRUE</code> or <code class="codeph">FALSE</code>) value. 
                                          </p>
                                       </li>
                                       <li>
                                          <p>It must be no more than 1024 characters long. </p>
                                       </li>
                                       <li>
                                          <p>It can contain existing and compiled PL/SQL functions from the current database instance. Ensure that these are fully qualified functions (such as <span class="italic"><code class="codeph">schema</code></span>. <span class="italic"><code class="codeph">function_name</code></span>). Do not include any other form of SQL statements.
                                          </p>
                                          <p>Be aware that you cannot use invoker's rights procedures with rule expressions. Doing so will cause the rule evaluation to fail unexpectedly. Only use definer's rights procedures with rule expressions.</p>
                                          <p>If you want to use application package functions or standalone functions, you must grant the <code class="codeph">DVSYS</code> account the <code class="codeph">EXECUTE</code> privilege on the function. Doing so reduces the chances of errors when you add new rules. 
                                          </p>
                                       </li>
                                       <li>
                                          <p>Ensure that the rule works. You can test the syntax by running the following statement in SQL*Plus:</p><pre class="oac_no_warn" dir="ltr">SELECT <span class="italic">rule_expression</span> FROM DUAL;
</pre><p>For example, suppose you have created the following the rule expression:</p><pre class="oac_no_warn" dir="ltr">SYS_CONTEXT('USERENV','SESSION_USER') != 'TSMITH'
</pre><p>You could test this expression as follows: </p><pre class="oac_no_warn" dir="ltr">SELECT SYS_CONTEXT('USERENV','SESSION_USER') FROM DUAL;
</pre><p>For the Boolean example listed earlier, you would enter the following:</p><pre class="oac_no_warn" dir="ltr">SELECT TO_CHAR(SYSDATE,'HH24')FROM DUAL;
</pre></li>
                                    </ul>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Click <span class="bold">OK</span>.</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="oracle-database-vault-rule-set-apis.html#GUID-9CC41BCB-1335-4230-8547-977AD105E47B" title="Oracle Database Vault provides functions to use in rule sets to inspect the SQL statement that the rule set protects.">Oracle Database Vault PL/SQL Rule Set Functions</a></li>
                           <li><a href="oracle-database-vault-rule-set-apis.html#GUID-1B24D370-46E3-445E-91CC-8E621F5E94CB" title="The DBMS_MACADM rule set procedures enable you to configure both rule sets and individual rules that go within these rule sets.">DBMS_MACADM Rule Set Procedures</a></li>
                           <li><a href="oracle-database-vault-utility-apis.html#GUID-5A0CB405-9A3C-48ED-B18F-3A8013D436E3" title="Oracle Database Vault provides a set of utility APIs in the DBMS_MACUTL PL/SQL package.">Oracle Database Vault Utility APIs</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" title="A rule defines the behavior that you want to control; a rule set is a named collection of rules.">Creating a Rule to Add to a Rule Set</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DVADM70181"></a><div class="props_rev_3"><a id="GUID-2D82F552-0D94-44B8-9F81-2F42E0EAA4FD" name="GUID-2D82F552-0D94-44B8-9F81-2F42E0EAA4FD"></a><h4 id="DVADM-GUID-2D82F552-0D94-44B8-9F81-2F42E0EAA4FD" class="sect4">Adding Existing Rules to a Rule Set</h4>
                  <div>
                     <p>After you have created one or more rules, you can use Enterprise Manager Cloud Control to add to a rule set. </p>
                     <ol>
                        <li class="stepexpand"><span>Log in to Oracle Database Vault Administrator from Cloud Control as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege. <a href="getting-started-with-oracle-database-vault.html#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for managing Oracle Database Vault.">Logging in to Oracle Database Vault from Oracle Enterprise Cloud Control</a> explains how to log in.</span></li>
                        <li class="stepexpand"><span>In the Administration page, under Database Vault Components, click <span class="bold">Rule Sets</span>.</span></li>
                        <li class="stepexpand"><span>Select the rule set to which you want to add an existing rule, and then click <span class="bold">Edit</span>.</span></li>
                        <li class="stepexpand"><span>Click <span class="bold">Next</span> until you reach the Associate with Rules page.</span></li>
                        <li class="stepexpand"><span>Click <span class="bold">Add Existing Rule</span> to display the Add Existing Rules dialog box. </span></li>
                        <li class="stepexpand"><span>In the Add Existing Rules page, select the rules you want, and then click <span class="bold">Move</span> (or <span class="bold">Move All</span>, if you want all of them) to move them to the Selected Rules list.</span><div>
                              <p>You can select multiple rules by holding down the <span class="bold">Ctrl</span> key as you click each rule. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Click <span class="bold">OK</span>. </span></li>
                        <li class="stepexpand"><span>Click <span class="bold">Done</span>, then click <span class="bold">Finish</span>.</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" title="A rule defines the behavior that you want to control; a rule set is a named collection of rules.">Creating a Rule to Add to a Rule Set</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM71224"></a><div class="props_rev_3"><a id="GUID-D22EB64B-F62F-4747-B218-FE1C7C3BC709" name="GUID-D22EB64B-F62F-4747-B218-FE1C7C3BC709"></a><h4 id="DVADM-GUID-D22EB64B-F62F-4747-B218-FE1C7C3BC709" class="sect4">Removing a Rule from a Rule Set</h4>
                  <div>
                     <p>Before you remove a rule from a rule set, you can locate the various references to it using Cloud Control. </p>
                     <ol>
                        <li class="stepexpand"><span>Log in to Oracle Database Vault Administrator from Cloud Control as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege. <a href="getting-started-with-oracle-database-vault.html#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for managing Oracle Database Vault.">Logging in to Oracle Database Vault from Oracle Enterprise Cloud Control</a> explains how to log in.</span></li>
                        <li class="stepexpand"><span>In the Administration page, under Database Vault Components, click <span class="bold">Rule Sets</span>.</span><div>
                              <p>If you are not sure which rule set contains that rule that you want to remove, then select <span class="bold">Rules</span> from Database Vault Components, select the rule that you want to remove, and then select the <span class="bold">View</span> option (but not the <span class="bold">View</span> menu). The rule sets that are associated with the rule are listed in Rule Set Usages.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Select the rule set to which you want to add an existing rule, and then click <span class="bold">Edit</span>.</span></li>
                        <li class="stepexpand"><span>Click <span class="bold">Next</span> until you reach the Associate with Rules page.</span></li>
                        <li class="stepexpand"><span>Select the rule you want to delete and click <span class="bold">Remove</span>. </span></li>
                        <li class="stepexpand"><span>Click <span class="bold">Done</span>, then click <span class="bold">Finish</span>. </span></li>
                     </ol>
                     <div class="section">
                        <p>After you remove the rule from the rule set, the rule still exists. If you want, you can associate it with other rule sets. If you want to delete the rule, then you can do so from the Rules page.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-1DEA3C18-91A0-475A-B001-8DC97372B40F" title="A rule defines the behavior that you want to control; a rule set is a named collection of rules.">Creating a Rule to Add to a Rule Set</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DVADM71225"></a><div class="props_rev_3"><a id="GUID-DB38EF41-865C-41D6-89AD-3C9E32084E82" name="GUID-DB38EF41-865C-41D6-89AD-3C9E32084E82"></a><h3 id="DVADM-GUID-DB38EF41-865C-41D6-89AD-3C9E32084E82" class="sect3">Removing Rule Set References to Oracle Database Vault Components</h3>
               <div>
                  <p>Before you remove a rule set, you should remove the rule set references to Oracle Database Vault components.</p>
                  <ol>
                     <li class="stepexpand"><span>Log in to Oracle Database Vault Administrator from Cloud Control as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege. <a href="getting-started-with-oracle-database-vault.html#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for managing Oracle Database Vault.">Logging in to Oracle Database Vault from Oracle Enterprise Cloud Control</a> explains how to log in.</span></li>
                     <li class="stepexpand"><span>Find the references to the rule set that you want to delete. </span><div>
                           <p>In the Rule Sets page, select the rule set and then click the <span class="bold">View</span> button (but not the <span class="bold">View</span> menu). In the View Rule Set page, check the Ruleset Usages area for the references to the rule set that you want to remove. Click <span class="bold">OK</span>.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>In the Administration page, under Database Vault Components, select the component that contains the reference to the rule set (such as <span class="bold">Realms</span>).</span></li>
                     <li class="stepexpand"><span>Select the object, and then click <span class="bold">Edit</span>. </span></li>
                     <li class="stepexpand"><span>Click <span class="bold">Next</span> until you reach the authorizations page. </span></li>
                     <li class="stepexpand"><span>Select the authorization with the rule set and then click <span class="bold">Edit</span>, and then remove the referenced object.</span></li>
                     <li class="stepexpand"><span>Click <span class="bold">Done</span>, then click <span class="bold">Finish</span>. </span></li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DVADM70182"></a><div class="props_rev_3"><a id="GUID-24510A4C-39FA-4701-91A2-6E213BD9AE59" name="GUID-24510A4C-39FA-4701-91A2-6E213BD9AE59"></a><h3 id="DVADM-GUID-24510A4C-39FA-4701-91A2-6E213BD9AE59" class="sect3">Deleting a Rule Set</h3>
               <div>
                  <p>You can use Enterprise Manager Cloud Control to find reference to the rule set and then delete the rule set. </p>
                  <ol>
                     <li class="stepexpand"><span>Log in to Oracle Database Vault Administrator from Cloud Control as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege. <a href="getting-started-with-oracle-database-vault.html#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for managing Oracle Database Vault.">Logging in to Oracle Database Vault from Oracle Enterprise Cloud Control</a> explains how to log in.</span></li>
                     <li class="stepexpand"><span>Remove references to the rule set. </span></li>
                     <li class="stepexpand"><span>Select the rule set that you want to remove and click <span class="bold">Delete</span>.</span></li>
                     <li class="stepexpand"><span>In the Confirmation window, click <span class="bold">Yes</span>.</span><div>
                           <p>The rule set is deleted. Optionally, you can choose to remove the existing associations with rules before deleting the rule set.</p>
                        </div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="configuring-rule-sets.html#GUID-DB38EF41-865C-41D6-89AD-3C9E32084E82" title="Before you remove a rule set, you should remove the rule set references to Oracle Database Vault components.">Removing Rule Set References to Oracle Database Vault Components</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="DVADM70183"></a><div class="props_rev_3"><a id="GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3" name="GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3"></a><h3 id="DVADM-GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3" class="sect3">How Rule Sets Work</h3>
               <div>
                  <p>Understanding how rule sets work helps to create more effective rule sets.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-5A6D122C-4DB2-4DED-85EC-E8D42657622E">How Oracle Database Vault Evaluates Rules</a><br>Oracle Database Vault evaluates the rules within a rule set as a collection of expressions. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-C54D769A-258E-4226-9AF2-37DF33A29C50">Nested Rules within a Rule Set</a><br>You can nest one or more rules within the rule set. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-D0169640-4949-4726-84AB-3656B20A03BF">Creating Rules to Apply to Everyone Except One User</a><br>You can also create rules to apply to everyone <span class="italic">except</span> one user (for example, a privileged user). 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               <a id="DVADM70184"></a><div class="props_rev_3"><a id="GUID-5A6D122C-4DB2-4DED-85EC-E8D42657622E" name="GUID-5A6D122C-4DB2-4DED-85EC-E8D42657622E"></a><h4 id="DVADM-GUID-5A6D122C-4DB2-4DED-85EC-E8D42657622E" class="sect4">How Oracle Database Vault Evaluates Rules</h4>
                  <div>
                     <p>Oracle Database Vault evaluates the rules within a rule set as a collection of expressions. </p>
                     <p>If you have set <span class="bold">Evaluation Options</span> to <span class="bold">All True</span> and if a rule evaluates to false, then the evaluation stops at that point, instead of attempting to evaluate the rest of the rules in the rule set. Similarly, if <span class="bold">Evaluation Options</span> is set to <span class="bold">Any True</span> and if a rule evaluates to true, the evaluation stops at that point. If a rule set is disabled, Oracle Database Vault evaluates it to true without evaluating its rules. 
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3" title="Understanding how rule sets work helps to create more effective rule sets.">How Rule Sets Work</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70186"></a><div class="props_rev_3"><a id="GUID-C54D769A-258E-4226-9AF2-37DF33A29C50" name="GUID-C54D769A-258E-4226-9AF2-37DF33A29C50"></a><h4 id="DVADM-GUID-C54D769A-258E-4226-9AF2-37DF33A29C50" class="sect4">Nested Rules within a Rule Set</h4>
                  <div>
                     <p>You can nest one or more rules within the rule set. </p>
                     <p>For example, suppose you want to create a nested rule, Is Corporate Network During Maintenance, that performs the following two tasks: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>It limits table modifications only when the database session originates within the corporate network. </p>
                        </li>
                        <li>
                           <p>It restricts table modifications during the system maintenance window scheduled between 10:00 p.m. and 10:59 p.m.</p>
                        </li>
                     </ul>
                     <p>The rule definition would be as follows: </p><pre class="oac_no_warn" dir="ltr">DVF.F$NETWORK = 'Corporate' AND TO_CHAR(SYSDATE,'HH24') between '22' AND '23'
</pre></div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="oracle-database-vault-factor-apis.html#GUID-364245B9-C339-488A-8D49-B8B01B667857" title="Oracle Database Vault maintains the DVF schema functions when you use the DBMS_MACADM PL/SQL package to manage the various factors.">Oracle Database Vault DVF PL/SQL Factor Functions</a></li>
                           <li><a href="configuring-factors.html#GUID-26DF59FF-D0BF-496A-8D5B-6B2B6AC99822" title="Factors enable you to base Database Vault restrictions on attributes such as a client IP address or a domain.">Configuring Factors</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3" title="Understanding how rule sets work helps to create more effective rule sets.">How Rule Sets Work</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DVADM70187"></a><div class="props_rev_3"><a id="GUID-D0169640-4949-4726-84AB-3656B20A03BF" name="GUID-D0169640-4949-4726-84AB-3656B20A03BF"></a><h4 id="DVADM-GUID-D0169640-4949-4726-84AB-3656B20A03BF" class="sect4">Creating Rules to Apply to Everyone Except One User</h4>
                  <div>
                     <p>You can also create rules to apply to everyone <span class="italic">except</span> one user (for example, a privileged user). 
                     </p>
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To create a rule that excludes specific users, user the <code class="codeph">SYS_CONTEXT</code> function. 
                              </p>
                           </li>
                        </ul>
                        <p>For example: </p><pre class="oac_no_warn" dir="ltr">SYS_CONTEXT('USERENV','SESSION_USER') = 'SUPERADMIN_USER' OR <span class="italic">additional_rule</span>
</pre><p>If the current user is a privileged user, then the system evaluates the rule to true without evaluating <span class="italic"><code class="codeph">additional_rule</code></span>. If the current user is not a privileged user, then the evaluation of the rule depends on the evaluation of <span class="italic"><code class="codeph">additional_rule</code></span>.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-BFA919E1-0941-4246-BCA6-D9BC03B1CCB3" title="Understanding how rule sets work helps to create more effective rule sets.">How Rule Sets Work</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DVADM50058"></a><div class="props_rev_3"><a id="GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" name="GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97"></a><h3 id="DVADM-GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" class="sect3">Tutorial: Creating an Email Alert for Security Violations</h3>
               <div>
                  <p>This tutorial demonstrates how to use the <code class="codeph">UTL_MAIL</code> PL/SQL package and an access control list to create an email alert for security violations. 
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-D43A729D-6528-46ED-9CB8-55591745C6F8">About This Tutorial</a><br>In tutorial, you create an email alert that is sent when a user attempts to alter a table outside a maintenance period. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-16C3DDD7-A749-46FE-BC65-D523C4EBCC63">Step 1: Install and Configure the UTL_MAIL PL/SQL Package</a><br>The <code class="codeph">UTL_MAIL</code> PL/SQL package, which you must manually install, has procedures to manage email notifications. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-478D9B85-F2FC-47DE-8F35-40E4E5A6D6EC">Step 2: Create an Email Security Alert PL/SQL Procedure</a><br>User <code class="codeph">leo_dvowner</code> can use the <code class="codeph">CREATE PROCEDURE</code> statement to create the email security alert.
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-2E877560-EDF1-4835-9F5C-CDD67201DDB0">Step 3: Configure an Access Control List File for Network Services</a><br>Before you can use <code class="codeph">UTL_MAIL</code>, you must configure an access control list (ACL) to enable fine-grained access to external network services. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-FAF67375-E88D-42B2-A107-F940BC3C0616">Step 4: Create a Rule Set and a Command Rule to Use the Email Security Alert</a><br>To create the rule set and command rule, you can use <code class="codeph">DBMS_MACADM</code> PL/SQL package.
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-1AEEE3DA-9104-4DA4-836A-C5AE5AC028E8">Step 5: Test the Email Security Alert</a><br>After the alert has been created, it is ready to be tested.
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-ED7B98BF-87DD-4893-9992-FF0319FE9788">Step 6: Remove the Components for This Tutorial</a><br>You can remove the components that you created for this tutorial if you no longer need them. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               <a id="DVADM71115"></a><div class="props_rev_3"><a id="GUID-D43A729D-6528-46ED-9CB8-55591745C6F8" name="GUID-D43A729D-6528-46ED-9CB8-55591745C6F8"></a><h4 id="DVADM-GUID-D43A729D-6528-46ED-9CB8-55591745C6F8" class="sect4">About This Tutorial</h4>
                  <div>
                     <p>In tutorial, you create an email alert that is sent when a user attempts to alter a table outside a maintenance period. </p>
                     <p>To do this, you must create a rule to set the maintenance period hours, attach this rule to a rule set, and then create a command rule to allow the user to alter the table. You then associate the rule set with this command rule, which then sends the email alert when the user attempts to use the <code class="codeph">ALTER TABLE</code> SQL statement outside the maintenance period. 
                     </p>
                     <div class="infoboxnote" id="GUID-D43A729D-6528-46ED-9CB8-55591745C6F8__GUID-2D4AE163-0DB8-4315-9BCF-D3BA522BB49E">
                        <p class="notep1">Note:</p>
                        <p>To complete this tutorial, you must use a database that has an SMTP server.</p>
                     </div>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" title="This tutorial demonstrates how to use the UTL_MAIL PL/SQL package and an access control list to create an email alert for security violations.">Tutorial: Creating an Email Alert for Security Violations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70188"></a><div class="props_rev_3"><a id="GUID-16C3DDD7-A749-46FE-BC65-D523C4EBCC63" name="GUID-16C3DDD7-A749-46FE-BC65-D523C4EBCC63"></a><h4 id="DVADM-GUID-16C3DDD7-A749-46FE-BC65-D523C4EBCC63" class="sect4">Step 1: Install and Configure the UTL_MAIL PL/SQL Package</h4>
                  <div>
                     <p>The <code class="codeph">UTL_MAIL</code> PL/SQL package, which you must manually install, has procedures to manage email notifications. 
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Log into the database instance as <code class="codeph">SYS</code> using the <code class="codeph">SYSDBA</code> administrative privilege. </span><div><pre class="oac_no_warn" dir="ltr">sqlplus sys as sysdba
Enter password: <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>In a multitenant environment, connect to the appropriate pluggable database (PDB). </span><div>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">CONNECT SYS@my_pdb AS SYSDBA
Enter password: <span class="italic">password</span>
</pre><p>To find the available PDBs, run the <code class="codeph">show pdbs</code> command. To check the current PDB, run the <code class="codeph">show con_name</code> command. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Install the <code class="codeph">UTL_MAIL</code> package. </span><div><pre class="oac_no_warn" dir="ltr">@$ORACLE_HOME/rdbms/admin/utlmail.sql
@$ORACLE_HOME/rdbms/admin/prvtmail.plb
</pre><p>The <code class="codeph">UTL_MAIL</code> package enables you to manage email. See <a href="../arpls/UTL_MAIL.html#ARPLS384" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information about <code class="codeph">UTL_MAIL</code>. However, be aware that currently, the <code class="codeph">UTL_MAIL</code> PL/SQL package do not support SSL servers.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Check the current value of the <code class="codeph">SMTP_OUT_SERVER</code> parameter, and make a note of this value so that you can restore it when you complete this tutorial.</span><div>
                              <p>For example: </p><pre class="oac_no_warn" dir="ltr">SHOW PARAMETER SMTP_OUT_SERVER
</pre><p>Output similar to the following appears:</p><pre class="oac_no_warn" dir="ltr">NAME                    TYPE              VALUE
----------------------- ----------------- ----------------------------------
SMTP_OUT_SERVER         string            some_value.example.com
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Issue the following <code class="codeph">ALTER SYSTEM</code> statement:</span><div><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET SMTP_OUT_SERVER="<span class="italic">imap_mail_server.example.com</span>";
</pre><p>Replace <span class="italic"><code class="codeph">imap_mail_server.example.com</code></span> with the name of your SMTP server, which you can find in the account settings in your email tool. Enclose these settings in double quotation marks. For example: 
                              </p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET SMTP_OUT_SERVER="my_imap_mail_server.example.com"
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as <code class="codeph">SYS</code> using the <code class="codeph">SYSOPER</code> privilege and then restart the database. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT SYS AS SYSOPER <span class="italic">-- Or, CONNECT SYS@hrpdb AS SYSOPER</span>
Enter password: <span class="italic">password</span>

SHUTDOWN IMMEDIATE
STARTUP
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Ensure that the <code class="codeph">SMTP_OUT_SERVER</code> parameter setting is correct.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT SYS AS SYSDBA <span class="italic">-- Or, CONNECT SYS@hrpdb AS SYSDBA</span>
Enter password: <span class="italic">password</span>

SHOW PARAMETER SMTP_OUT_SERVER
</pre><p>Output similar to the following appears:</p><pre class="oac_no_warn" dir="ltr">NAME                    TYPE              VALUE
----------------------- ----------------- ----------------------------------
SMTP_OUT_SERVER         string            my_imap_mail_server.example.com</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" title="This tutorial demonstrates how to use the UTL_MAIL PL/SQL package and an access control list to create an email alert for security violations.">Tutorial: Creating an Email Alert for Security Violations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70189"></a><div class="props_rev_3"><a id="GUID-478D9B85-F2FC-47DE-8F35-40E4E5A6D6EC" name="GUID-478D9B85-F2FC-47DE-8F35-40E4E5A6D6EC"></a><h4 id="DVADM-GUID-478D9B85-F2FC-47DE-8F35-40E4E5A6D6EC" class="sect4">Step 2: Create an Email Security Alert PL/SQL Procedure</h4>
                  <div>
                     <p>User <code class="codeph">leo_dvowner</code> can use the <code class="codeph">CREATE PROCEDURE</code> statement to create the email security alert.
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Ensure that you are connected as a user who has privileges to perform the grants described in this step, and then grant these privileges to a user who has been granted the <code class="codeph">DV_OWNER</code> role. You should also be authorized as an owner of the Oracle System Privilege and Role Management realm.</span><div>
                              <p>(Alternatively, you can select a user who has been granted the <code class="codeph">DV_ADMIN</code> role, but for this tutorial, you will select a user who has the <code class="codeph">DV_OWNER</code> role.)
                              </p>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">CONNECT dba_psmith <span class="italic">-- Or, CONNECT dba_psmith@hrpdb</span>
Enter password: <span class="italic">password</span>

GRANT CREATE PROCEDURE, DROP ANY PROCEDURE TO leo_dvowner;
GRANT EXECUTE ON UTL_TCP TO leo_dvowner;
GRANT EXECUTE ON UTL_SMTP TO leo_dvowner;
GRANT EXECUTE ON UTL_MAIL TO leo_dvowner;
GRANT EXECUTE ON DBMS_NETWORK_ACL_ADMIN TO leo_dvowner;
</pre><p>The <code class="codeph">UTL_TCP</code>, <code class="codeph">UTL_SMTP</code>, <code class="codeph">UTL_MAIL</code>, and <code class="codeph">DBMS_NETWORK_ACL_ADMIN</code> PL/SQL packages will be used by the email security alert that you create. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Connect to SQL*Plus as the <code class="codeph">DV_OWNER</code> user. </span><div>
                              <p>For example: </p><pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner <span class="italic">-- Or, CONNECT leo_dvowner@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create the following procedure: </span><div><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PROCEDURE email_alert AS
msg varchar2(20000) := 'Realm violation occurred for the ALTER TABLE Command Security Policy rule set. The time is: '; 
BEGIN
  msg := msg||to_char(SYSDATE, 'Day DD MON, YYYY HH24:MI:SS'); 
UTL_MAIL.SEND (
    sender      =&gt; '<span class="italic">youremail@example.com</span>',
    recipients  =&gt; '<span class="italic">recipientemail@example.com</span>',
    subject     =&gt; 'Table modification attempted outside maintenance!',
    message     =&gt; msg); 
END email_alert;
/
</pre><p>Replace <span class="italic"><code class="codeph">youremail@example.com</code></span> with your email address, and <span class="italic"><code class="codeph">recipientemail@example.com</code></span> with the email address of the person you want to receive the notification.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Grant the <code class="codeph">EXECUTE</code> permission on this procedure to <code class="codeph">DVSYS</code>. </span><div><pre class="oac_no_warn" dir="ltr">GRANT EXECUTE ON email_alert TO DVSYS;</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" title="This tutorial demonstrates how to use the UTL_MAIL PL/SQL package and an access control list to create an email alert for security violations.">Tutorial: Creating an Email Alert for Security Violations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70190"></a><div class="props_rev_3"><a id="GUID-2E877560-EDF1-4835-9F5C-CDD67201DDB0" name="GUID-2E877560-EDF1-4835-9F5C-CDD67201DDB0"></a><h4 id="DVADM-GUID-2E877560-EDF1-4835-9F5C-CDD67201DDB0" class="sect4">Step 3: Configure an Access Control List File for Network Services</h4>
                  <div>
                     <p>Before you can use <code class="codeph">UTL_MAIL</code>, you must configure an access control list (ACL) to enable fine-grained access to external network services. 
                     </p>
                     <div class="section">
                        <p>For detailed information about fine-grained access to external network services, see <a href="../dbseg/managing-fine-grained-access-in-pl-sql-packages-and-types.html#DBSEG40012" target="_blank"><span><cite>Oracle Database Security Guide</cite></span></a>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>As the <code class="codeph">DV_OWNER</code> user, in SQL*Plus, configure the following access control setting and its privilege definitions.</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_NETWORK_ACL_ADMIN.APPEND_HOST_ACE(
  host       =&gt; '<span class="italic">SMTP_OUT_SERVER_setting</span>',
  lower_port =&gt; 25,
  ace        =&gt;  xs$ace_type(privilege_list =&gt; xs$name_list('smtp'),
                             principal_name =&gt; 'LEO_DVOWNER,
                             principal_type =&gt; xs_acl.ptype_db));
END;
/
</pre><p>In this example: </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="italic"><code class="codeph">lower_port</code></span>: Enter the port number that your email tool specifies for its outgoing server. Typically, this setting is 25. Enter this value for both the <code class="codeph">lower_port</code> and <code class="codeph">upper_port</code> settings. (Currently, the <code class="codeph">UTL_MAIL</code> package does not support SSL. If your mail server is an SSL server, then enter 25 for the port number, even if the mail server uses a different port number.)
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">principal_name</code>: Replace <code class="codeph">LEO_DVOWNER</code> with the name of the <code class="codeph">DV_OWNER</code> user.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">host</code>: For the <span class="italic"><code class="codeph">SMTP_OUT_SERVER_setting</code></span>, enter the <code class="codeph">SMTP_OUT_SERVER</code> setting that you set for the <code class="codeph">SMTP_OUT_SERVER</code> parameter in <a href="configuring-rule-sets.html#GUID-16C3DDD7-A749-46FE-BC65-D523C4EBCC63" title="The UTL_MAIL PL/SQL package, which you must manually install, has procedures to manage email notifications.">Step 1: Install and Configure the UTL_MAIL PL/SQL Package</a>. This setting should match exactly the setting that your email tool specifies for its outgoing server.
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Commit your changes to the database. </span><div><pre class="oac_no_warn" dir="ltr">COMMIT;
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Test the settings that you have created so far. </span><div><pre class="oac_no_warn" dir="ltr">EXEC EMAIL_ALERT;
COMMIT;
</pre><p>SQL*Plus should display a <code class="codeph">PL/SQL procedure successfully completed</code> message, and in a moment, depending on the speed of your email server, you should receive the email alert.
                              </p>
                              <p>If you receive an <code class="codeph">ORA-24247: network access denied by access control list (ACL)</code> error followed by <code class="codeph">ORA-06512: at</code> <span class="italic"><code class="codeph">string</code></span><code class="codeph">line</code> <span class="italic"><code class="codeph">string</code></span> errors, then check the settings in the access control list file. 
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" title="This tutorial demonstrates how to use the UTL_MAIL PL/SQL package and an access control list to create an email alert for security violations.">Tutorial: Creating an Email Alert for Security Violations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70191"></a><div class="props_rev_3"><a id="GUID-FAF67375-E88D-42B2-A107-F940BC3C0616" name="GUID-FAF67375-E88D-42B2-A107-F940BC3C0616"></a><h4 id="DVADM-GUID-FAF67375-E88D-42B2-A107-F940BC3C0616" class="sect4">Step 4: Create a Rule Set and a Command Rule to Use the Email Security Alert</h4>
                  <div>
                     <p>To create the rule set and command rule, you can use <code class="codeph">DBMS_MACADM</code> PL/SQL package.
                     </p>
                     <ol>
                        <li class="stepexpand"><span>As the <code class="codeph">DV_OWNER</code> user, create the following rule set:</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_MACADM.CREATE_RULE_SET(
&nbsp;&nbsp;rule_set_name    =&gt; 'ALTER TABLE Command Security Policy', 
&nbsp;&nbsp;description      =&gt; 'This rule set allows ALTER TABLE only during the 
                       maintenance period.', 
&nbsp;&nbsp;enabled          =&gt; DBMS_MACUTL.G_YES,
&nbsp;&nbsp;eval_options     =&gt; DBMS_MACUTL.G_RULESET_EVAL_ALL,
&nbsp;&nbsp;audit_options    =&gt; DBMS_MACUTL.G_RULESET_AUDIT_FAIL,
&nbsp;&nbsp;fail_options     =&gt; DBMS_MACUTL.G_RULESET_FAIL_SILENT,
&nbsp;&nbsp;fail_message     =&gt;&nbsp;'',
&nbsp;&nbsp;fail_code        =&gt; NULL,
&nbsp;&nbsp;handler_options  =&gt; DBMS_MACUTL.G_RULESET_HANDLER_FAIL,
&nbsp;&nbsp;handler          =&gt; 'leo_dvowner.email_alert');
END;
/
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create a rule similar to the following. </span><div>
                              <p>For now, set the rule expression to be during the time you test it. For example, if you want to test it between 2 p.m. and 3 p.m., create the rule as follows: </p><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_MACADM.CREATE_RULE(
  rule_name  =&gt; 'Restrict Access to Maintenance Period', 
  rule_expr  =&gt; 'TO_CHAR(SYSDATE,''HH24'') BETWEEN ''14'' AND ''15''');
END;
/
</pre><p>Ensure that you use two single quotation marks instead of double quotation marks for <code class="codeph">HH24</code>, <code class="codeph">14</code>, and <code class="codeph">15</code>. 
                              </p>
                              <p>You can check the system time on your computer by issuing the following SQL statement:</p><pre class="oac_no_warn" dir="ltr">SELECT TO_CHAR(SYSDATE,'HH24') FROM DUAL;
</pre><p>Output similar to the following appears:</p><pre class="oac_no_warn" dir="ltr">TO
--
14
</pre><p>Later on, when you are satisfied that the rule works, you can update it to a time when your site typically performs maintenance work (for example, between 7 p.m. and 10 p.m), as follows:</p><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_MACADM.UPDATE_RULE(
  rule_name  =&gt; 'Restrict Access to Maintenance Period', 
  rule_expr  =&gt; 'TO_CHAR(SYSDATE,''HH24'') BETWEEN ''16'' AND ''22''');
END;
/
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Add the Restrict Access to Maintenance Period rule to the ALTER TABLE Command Security Policy rule set. </span><div><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_MACADM.ADD_RULE_TO_RULE_SET(
  rule_set_name =&gt; 'ALTER TABLE Command Security Policy', 
  rule_name     =&gt; 'Restrict Access to Maintenance Period'); 
END;
/
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create the following command rule: </span><div><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_MACADM.CREATE_COMMAND_RULE(
&nbsp;&nbsp;command         =&gt; 'ALTER TABLE', 
&nbsp;&nbsp;rule_set_name   =&gt; 'ALTER TABLE Command Security Policy', 
&nbsp;&nbsp;object_owner    =&gt; 'SCOTT', 
&nbsp;&nbsp;object_name     =&gt; '%', 
&nbsp;&nbsp;enabled         =&gt; DBMS_MACUTL.G_YES);
END; 
/
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Commit these updates to the database. </span><div><pre class="oac_no_warn" dir="ltr">COMMIT;</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" title="This tutorial demonstrates how to use the UTL_MAIL PL/SQL package and an access control list to create an email alert for security violations.">Tutorial: Creating an Email Alert for Security Violations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70192"></a><div class="props_rev_3"><a id="GUID-1AEEE3DA-9104-4DA4-836A-C5AE5AC028E8" name="GUID-1AEEE3DA-9104-4DA4-836A-C5AE5AC028E8"></a><h4 id="DVADM-GUID-1AEEE3DA-9104-4DA4-836A-C5AE5AC028E8" class="sect4">Step 5: Test the Email Security Alert</h4>
                  <div>
                     <p>After the alert has been created, it is ready to be tested.</p>
                     <ol>
                        <li class="stepexpand"><span>Connect to SQL*Plus as user <code class="codeph">SCOTT</code>.</span><div>
                              <p>For example: </p><pre class="oac_no_warn" dir="ltr">CONNECT SCOTT <span class="italic">-- Or, CONNECT SCOTT@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre><p>If the <code class="codeph">SCOTT</code> account is locked and expired, then a user with the <code class="codeph">DV_ACCTMGR</code> role can unlock this account and create a new password as follows:
                              </p><pre class="oac_no_warn" dir="ltr">ALTER USER SCOTT ACCOUNT UNLOCK IDENTIFIED BY <span class="italic">password</span>;
</pre><p>Follow the guidelines in <a href="../dbseg/configuring-authentication.html#DBSEG33223" target="_blank"><span><cite>Oracle Database Security Guide</cite></span></a> to replace <span class="italic"><code class="codeph">password</code></span> with a password that is secure. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>As the user <code class="codeph">SCOTT</code>, create a test table. </span><div><pre class="oac_no_warn" dir="ltr">CREATE TABLE mytest (col1 number);
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Change the system time on your computer to a time when the ALTER TABLE Command Security Policy rule set takes place.</span><div>
                              <p>For example, if you set the test period time to between 2 p.m. and 3 p.m., do the following: </p>
                              <p><span class="bold">UNIX:</span> Log in as root and use the <code class="codeph">date</code> command to set the time. For example, assuming the date today is August 15, 2012, you would enter the following: 
                              </p><pre class="oac_no_warn" dir="ltr">$ su root
Password: <span class="italic">password</span>

$ date -s "08/15/2012 14:48:00"
</pre><p><span class="bold">Windows:</span> Double-click the clock icon, which is typically at the lower right corner of the screen. In the Date and Time Properties window, set the time to 2 p.m., and then click <span class="bold">OK</span>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Try altering the <code class="codeph">my_test</code> table.</span><div><pre class="oac_no_warn" dir="ltr">ALTER TABLE mytest ADD (col2 number);

Table altered.
</pre><p><code class="codeph">SCOTT</code> should be able to alter the <code class="codeph">mytest</code> table during this time. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Reset the system time to a time outside the Restrict Access to Maintenance Period time.</span></li>
                        <li class="stepexpand"><span>Log in as <code class="codeph">SCOTT</code> and try altering the <code class="codeph">my_test</code> table again.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT SCOTT <span class="italic">-- Or, CONNECT SCOTT@hrpdb</span>
Enter password: <span class="italic">password</span>

ALTER TABLE mytest ADD (col3 number);
</pre><p>The following output should appear:</p><pre class="oac_no_warn" dir="ltr">ORA-47400: Command Rule violation for ALTER TABLE on SCOTT.MYTEST
</pre><p><code class="codeph">SCOTT</code> cannot alter the <code class="codeph">mytest</code> table. In a moment, you should receive an email with the subject header <code class="codeph">Table modification attempted outside maintenance!</code> and with a message similar to the following: 
                              </p><pre class="oac_no_warn" dir="ltr">Realm violation occurred for the ALTER TABLE Command Security Policy rule set. The time is: Wednesday 15 AUG, 2012 14:24:25
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Reset the system time to the correct time.</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" title="This tutorial demonstrates how to use the UTL_MAIL PL/SQL package and an access control list to create an email alert for security violations.">Tutorial: Creating an Email Alert for Security Violations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70193"></a><div class="props_rev_3"><a id="GUID-ED7B98BF-87DD-4893-9992-FF0319FE9788" name="GUID-ED7B98BF-87DD-4893-9992-FF0319FE9788"></a><h4 id="DVADM-GUID-ED7B98BF-87DD-4893-9992-FF0319FE9788" class="sect4">Step 6: Remove the Components for This Tutorial</h4>
                  <div>
                     <p>You can remove the components that you created for this tutorial if you no longer need them. </p>
                     <ol>
                        <li class="stepexpand"><span>Connect to SQL*Plus as the <code class="codeph">DV_OWNER</code> user.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner <span class="italic">-- Or, CONNECT leo_dvowner@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>In the order shown, drop the Oracle Database Vault rule components. </span><div><pre class="oac_no_warn" dir="ltr">EXEC DBMS_MACADM.DELETE_RULE_FROM_RULE_SET('ALTER TABLE Command Security Policy', 'Restrict Access to Maintenance Period');
EXEC DBMS_MACADM.DELETE_RULE('Restrict Access to Maintenance Period');
EXEC DBMS_MACADM.DELETE_COMMAND_RULE('ALTER TABLE', 'SCOTT', '%');
EXEC DBMS_MACADM.DELETE_RULE_SET('ALTER TABLE Command Security Policy');
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Drop the <code class="codeph">email_alert</code> PL/SQL procedure. </span><div><pre class="oac_no_warn" dir="ltr">DROP PROCEDURE email_alert;
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as user <code class="codeph">SCOTT</code> and remove the <code class="codeph">mytest</code> table. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT SCOTT <span class="italic">-- Or, CONNECT SCOTT@hrpdb</span>
Enter password: <span class="italic">password</span>

DROP TABLE mytest;
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as a user who has privileges to revoke privileges from other users.</span><div>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">CONNECT dba_psmith <span class="italic">-- Or, CONNECT dba_psmith@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Revoke the <code class="codeph">EXECUTE</code> privilege on the <code class="codeph">UTL_TCP</code>, <code class="codeph">UTL_SMTP</code>, and <code class="codeph">UTL_MAIL</code> PL/SQL packages from the <code class="codeph">DV_OWNER</code> user.</span><div>
                              <p>For example: </p><pre class="oac_no_warn" dir="ltr">REVOKE EXECUTE ON UTL_TCP FROM leo_dvowner;
REVOKE EXECUTE ON UTL_SMTP FROM leo_dvowner;
REVOKE EXECUTE ON UTL_MAIL FROM leo_dvowner;
REVOKE EXECUTE ON DBMS_NETWORK_ACL_ADMIN FROM leo_dvowner;
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Set the <code class="codeph">SMTP_OUT_SERVER</code> parameter to its original value. </span><div>
                              <p>For example: </p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET SMTP_OUT_SERVER="some_value.example.com";
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as <code class="codeph">SYS</code> with the <code class="codeph">SYSOPER</code> administrative privilege and then restart the database. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT SYS AS SYSOPER <span class="italic">-- Or, CONNECT SYS@hrpdb AS SYSOPER</span>
Enter password: <span class="italic">password</span>

SHUTDOWN IMMEDIATE
STARTUP</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" title="This tutorial demonstrates how to use the UTL_MAIL PL/SQL package and an access control list to create an email alert for security violations.">Tutorial: Creating an Email Alert for Security Violations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DVADM70194"></a><div class="props_rev_3"><a id="GUID-D9AA1CCC-065C-4DFE-A078-908123401816" name="GUID-D9AA1CCC-065C-4DFE-A078-908123401816"></a><h3 id="DVADM-GUID-D9AA1CCC-065C-4DFE-A078-908123401816" class="sect3">Tutorial: Configuring Two-Person Integrity, or Dual Key Security</h3>
               <div>
                  <p>This tutorial demonstrates how to use Oracle Database Vault to control the authorization of two users. </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-F84E9514-A74D-4354-AE2B-F9AEDBD77C36">About This Tutorial</a><br>In this tutorial, you configure a rule set that defines two-person integrity (TPI). 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-5EDF2BCE-C39C-4EF9-BF22-4814F22AA7E6">Step 1: Create Users for This Tutorial</a><br>You must create two users for this tutorial, <code class="codeph">patch_boss</code> and <code class="codeph">patch_user.</code></li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-572E823B-9551-4B15-BA7F-32E468E7D3ED">Step 2: Create a Function to Check if User patch_boss Is Logged In</a><br>The behavior of the Database Vault settings will be determined by the function.
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-312BAFD1-5704-430E-A6CE-311E47D4F042">Step 3: Create Rules, a Rule Set, and a Command Rule to Control User Access</a><br>Next, you must create two rules, a rule set to which you will add them, and a command rule. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-B09ABAAA-AE06-458B-8FF2-A41A99ED672D">Step 4: Test the Users' Access</a><br>After the rules have been created, they are ready to be tested.
                     </li>
                     <li class="ulchildlink"><a href="configuring-rule-sets.html#GUID-200A09DC-119E-40B1-B42B-2176ED117772">Step 5: Remove the Components for This Tutorial</a><br>You can remove the components that you created for this tutorial if you no longer need them. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               <a id="DVADM71116"></a><div class="props_rev_3"><a id="GUID-F84E9514-A74D-4354-AE2B-F9AEDBD77C36" name="GUID-F84E9514-A74D-4354-AE2B-F9AEDBD77C36"></a><h4 id="DVADM-GUID-F84E9514-A74D-4354-AE2B-F9AEDBD77C36" class="sect4">About This Tutorial</h4>
                  <div>
                     <p>In this tutorial, you configure a rule set that defines two-person integrity (TPI). </p>
                     <p>This feature is also called dual key security, dual key connection, and two-man rule security. In this type of security, two users are required to authorize an action instead of one user. </p>
                     <p>The idea is that one user provides a safety check for the other user before that user can proceed with a task. Two-person integrity provides an additional layer of security for actions that potentially can be dangerous. This type of scenario is often used for tasks such as database patch updates, which is what this tutorial will demonstrate. One user, <code class="codeph">patch_user</code> must log into perform a database patch upgrade, but the only way that he can do this is if his manager, <code class="codeph">patch_boss</code> is already logged in. You will create a function, rules, a rule set, and a command rule to control <code class="codeph">patch_user</code>'s ability to log in.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-D9AA1CCC-065C-4DFE-A078-908123401816" title="This tutorial demonstrates how to use Oracle Database Vault to control the authorization of two users.">Tutorial: Configuring Two-Person Integrity, or Dual Key Security</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70195"></a><div class="props_rev_3"><a id="GUID-5EDF2BCE-C39C-4EF9-BF22-4814F22AA7E6" name="GUID-5EDF2BCE-C39C-4EF9-BF22-4814F22AA7E6"></a><h4 id="DVADM-GUID-5EDF2BCE-C39C-4EF9-BF22-4814F22AA7E6" class="sect4">Step 1: Create Users for This Tutorial</h4>
                  <div>
                     <p>You must create two users for this tutorial, <code class="codeph">patch_boss</code> and <code class="codeph">patch_user.</code></p>
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">patch_boss</code> acts in a supervisory role: If <code class="codeph">patch_boss</code> is not logged in, then the <code class="codeph">patch_user</code> user cannot log in.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">patch_user</code> is the user who is assigned to perform the patch upgrade. However, for this tutorial, user <code class="codeph">patch_user</code> does not actually perform a patch upgrade. He only attempts to log in. 
                              </p>
                           </li>
                        </ul>
                        <p>To create the users:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Log into the database instance as a user who has been granted the <code class="codeph">DV_ACCTMGR</code> role.</span><div>
                              <p>For example: </p><pre class="oac_no_warn" dir="ltr">sqlplus bea_dvacctmgr
Enter password: <span class="italic">password</span>
</pre><p>In a multitenant environment, you must log in to the appropriate pluggable database (PDB). For example:</p><pre class="oac_no_warn" dir="ltr">sqlplus bea_dvacctmgr@hrpdb
Enter password: <span class="italic">password</span>
</pre><p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Create the following users and grant them the <code class="codeph">CREATE SESSION</code> privilege. </span><div><pre class="oac_no_warn" dir="ltr">GRANT CREATE SESSION TO patch_boss IDENTIFIED BY <span class="italic">password</span>;
GRANT CREATE SESSION TO patch_user IDENTIFIED BY <span class="italic">password</span>;
</pre><p>Follow the guidelines in <a href="../dbseg/configuring-authentication.html#DBSEG33223" target="_blank"><span><cite>Oracle Database Security Guide</cite></span></a> to replace <span class="italic"><code class="codeph">password</code></span> with a password that is secure. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Connect as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT SYS AS SYSDBA <span class="italic">-- Or, CONNECT SYS@hrpdb</span> AS SYSDBA
Enter password: <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Grant the following privileges to the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> user. </span><div>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">GRANT CREATE PROCEDURE TO leo_dvowner;
GRANT SELECT ON V_$SESSION TO leo_dvowner;
</pre><p>The <code class="codeph">V_$SESSION</code> table is the underlying table for the <code class="codeph">V$SESSION</code> dynamic view. 
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>In a real-world scenario, you also would log in as the <code class="codeph">DV_OWNER</code> user and grant the <code class="codeph">DV_PATCH_ADMIN</code> role to user <code class="codeph">patch_user</code> (but not to <code class="codeph">patch_boss</code>). But because you are not really going to perform a database patch upgrade in this tutorial, you do not need to grant this role to user <code class="codeph">patch_user</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-D9AA1CCC-065C-4DFE-A078-908123401816" title="This tutorial demonstrates how to use Oracle Database Vault to control the authorization of two users.">Tutorial: Configuring Two-Person Integrity, or Dual Key Security</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70196"></a><div class="props_rev_3"><a id="GUID-572E823B-9551-4B15-BA7F-32E468E7D3ED" name="GUID-572E823B-9551-4B15-BA7F-32E468E7D3ED"></a><h4 id="DVADM-GUID-572E823B-9551-4B15-BA7F-32E468E7D3ED" class="sect4">Step 2: Create a Function to Check if User patch_boss Is Logged In</h4>
                  <div>
                     <p>The behavior of the Database Vault settings will be determined by the function.</p>
                     <div class="section">The function that you must create, <code class="codeph">check_boss_logged_in</code>, does just that: When user <code class="codeph">patch_user</code> tries to log into the database instance, it checks if user <code class="codeph">patch_boss</code> is already logged in by querying the <code class="codeph">V$SESSION</code> data dictionary view.
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Connect as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role. </span><div>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner <span class="italic">-- Or, CONNECT leo_dvowner@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create the <code class="codeph">check_boss_logged_in</code> function as follows: </span><div><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE FUNCTION check_boss_logged_in
return varchar2
authid definer as 
 
v_session_number number := 0;
v_allow varchar2(10)    := 'TRUE';
v_deny varchar2(10)     := 'FALSE';
 
BEGIN
  SELECT COUNT(*) INTO v_session_number
  FROM SYS.V_$SESSION
  WHERE USERNAME = 'PATCH_BOSS'; -- Enter the user name in capital letters.
 
 IF v_session_number &gt; 0
  THEN RETURN v_allow;
 ELSE
  RETURN v_deny;
 END IF;
END check_boss_logged_in;
/
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Grant the <code class="codeph">EXECUTE</code> privilege on the <code class="codeph">check_boss_logged_in</code> function to the <code class="codeph">DVSYS</code> schema. </span><div><pre class="oac_no_warn" dir="ltr">GRANT EXECUTE ON check_boss_logged_in to DVSYS;</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-D9AA1CCC-065C-4DFE-A078-908123401816" title="This tutorial demonstrates how to use Oracle Database Vault to control the authorization of two users.">Tutorial: Configuring Two-Person Integrity, or Dual Key Security</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70197"></a><div class="props_rev_3"><a id="GUID-312BAFD1-5704-430E-A6CE-311E47D4F042" name="GUID-312BAFD1-5704-430E-A6CE-311E47D4F042"></a><h4 id="DVADM-GUID-312BAFD1-5704-430E-A6CE-311E47D4F042" class="sect4">Step 3: Create Rules, a Rule Set, and a Command Rule to Control User Access</h4>
                  <div>
                     <p>Next, you must create two rules, a rule set to which you will add them, and a command rule. </p>
                     <div class="section">The rule set triggers the <code class="codeph">check_boss_logged_in</code> function when user <code class="codeph">patch_user</code> tries to logs in to the database. 
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Connect as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role. </span><div>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner <span class="italic">-- Or, CONNECT leo_dvowner@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create the Check if Boss Is Logged In rule, which checks that the <code class="codeph">patch_user</code> user is logged in to the database. In the definition, replace <code class="codeph">leo_dvowner</code> with the name of the <code class="codeph">DVOWNER</code> or <code class="codeph">DV_ADMIN</code> user who created the <code class="codeph">check_boss_logged_in</code> function. </span><div>
                              <p>If the <code class="codeph">check_boss_logged_in</code> function returns <code class="codeph">TRUE</code> (that is, <code class="codeph">patch_boss</code> is logged in to another session), then <code class="codeph">patch_user</code> can log in. 
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_MACADM.CREATE_RULE(
   rule_name =&gt; 'Check if Boss Is Logged In',
   rule_expr =&gt; 'SYS_CONTEXT(''USERENV'',''SESSION_USER'') = ''PATCH_USER'' and leo_dvowner.check_boss_logged_in =  ''TRUE'' ');
END;
/
</pre><p>Enter the user name, <code class="codeph">PATCH_USER</code>, in upper-case letters, which is how the <code class="codeph">SESSION_USER</code> parameter stores it. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Create the Allow Connect for Other Database Users rule, which ensures that the user logged in (<code class="codeph">patch_user</code>) is not user <code class="codeph">patch_boss</code>. It also enables all other valid users to log in.</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
 DBMS_MACADM.CREATE_RULE(
  rule_name =&gt; 'Allow Connect for Other Database Users',
  rule_expr =&gt; 'SYS_CONTEXT(''USERENV'',''SESSION_USER'') != ''PATCH_USER''');
END;
/
COMMIT;
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create the Dual Connect for Boss and Patch rule set, and then add the two rules to it. </span><div><pre class="oac_no_warn" dir="ltr">BEGIN
    DBMS_MACADM.CREATE_RULE_SET(
     rule_set_name     =&gt; 'Dual Connect for Boss and Patch',
     description       =&gt; 'Checks if both boss and patch users are logged in.',
     enabled           =&gt; DBMS_MACUTL.G_YES,
     eval_options      =&gt; 2,
     audit_options     =&gt; DBMS_MACUTL.G_RULESET_AUDIT_FAIL,
     fail_options      =&gt; DBMS_MACUTL.G_RULESET_FAIL_SILENT,
     fail_message      =&gt;'',
     fail_code         =&gt; NULL,
     handler_options   =&gt; DBMS_MACUTL.G_RULESET_HANDLER_OFF,
     handler           =&gt; ''
     );
END;
/

BEGIN
    DBMS_MACADM.ADD_RULE_TO_RULE_SET(
     rule_set_name     =&gt; 'Dual Connect for Boss and Patch',
     rule_name         =&gt; 'Check if Boss Is Logged In'
   );
END;
/

BEGIN
    DBMS_MACADM.ADD_RULE_TO_RULE_SET(
     rule_set_name     =&gt; 'Dual Connect for Boss and Patch',
     rule_name         =&gt; 'Allow Connect for Other Database Users'
   );
END;
/
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create the following CONNECT command rule, which permits user <code class="codeph">patch_user</code> to connect to the database only if <code class="codeph">patch_boss</code> is already logged in.</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
   DBMS_MACADM.CREATE_COMMAND_RULE(
    command            =&gt; 'CONNECT',
    rule_set_name      =&gt; 'Dual Connect for Boss and Patch',
    object_owner       =&gt; '%',
    object_name        =&gt; '%',
    enabled            =&gt; DBMS_MACUTL.G_YES);
END;
/
COMMIT;</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-D9AA1CCC-065C-4DFE-A078-908123401816" title="This tutorial demonstrates how to use Oracle Database Vault to control the authorization of two users.">Tutorial: Configuring Two-Person Integrity, or Dual Key Security</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70198"></a><div class="props_rev_3"><a id="GUID-B09ABAAA-AE06-458B-8FF2-A41A99ED672D" name="GUID-B09ABAAA-AE06-458B-8FF2-A41A99ED672D"></a><h4 id="DVADM-GUID-B09ABAAA-AE06-458B-8FF2-A41A99ED672D" class="sect4">Step 4: Test the Users' Access</h4>
                  <div>
                     <p>After the rules have been created, they are ready to be tested.</p>
                     <ol>
                        <li class="stepexpand"><span>Exit SQL*Plus. </span><div><pre class="oac_no_warn" dir="ltr">EXIT
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create a second shell, for example: </span><div><pre class="oac_no_warn" dir="ltr">xterm &amp;
</pre></div>
                        </li>
                        <li class="stepexpand"><span>In the first shell, try to log in as user <code class="codeph">patch_user</code>.</span><div><pre class="oac_no_warn" dir="ltr">sqlplus patch_user <span class="italic">-- Or, sqlplus patch_user@hrpdb</span>
Enter password: <span class="italic">password</span>

ERROR:
ORA-47400: Command Rule violation for CONNECT on LOGON

Enter user-name:
</pre><p>User <code class="codeph">patch_user</code> cannot log in until user <code class="codeph">patch_boss</code> is already logged in. (Do not try the <code class="codeph">Enter user-name</code> prompt yet.)
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>In the second shell and then log in as user <code class="codeph">patch_boss</code>. </span><div><pre class="oac_no_warn" dir="ltr">sqlplus patch_boss <span class="italic">-- Or, sqlplus patch_boss@hrpdb</span>
Enter password: <span class="italic">password</span>
Connected. 
</pre><p>User <code class="codeph">patch_boss</code> can log in.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Go back to the first shell, and then try logging in as user <code class="codeph">patch_user</code> again.</span><div><pre class="oac_no_warn" dir="ltr">Enter user_name: patch_user
Enter password: <span class="italic">password</span>
</pre><p>This time, user <code class="codeph">patch_user</code> is deemed a valid user, so now he can log in.
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-D9AA1CCC-065C-4DFE-A078-908123401816" title="This tutorial demonstrates how to use Oracle Database Vault to control the authorization of two users.">Tutorial: Configuring Two-Person Integrity, or Dual Key Security</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70199"></a><div class="props_rev_3"><a id="GUID-200A09DC-119E-40B1-B42B-2176ED117772" name="GUID-200A09DC-119E-40B1-B42B-2176ED117772"></a><h4 id="DVADM-GUID-200A09DC-119E-40B1-B42B-2176ED117772" class="sect4">Step 5: Remove the Components for This Tutorial</h4>
                  <div>
                     <p>You can remove the components that you created for this tutorial if you no longer need them. </p>
                     <ol>
                        <li class="stepexpand"><span>In the session for the user <code class="codeph">patch_boss</code>, exit SQL*Plus and then close the shell.</span><div><pre class="oac_no_warn" dir="ltr">EXIT
</pre></div>
                        </li>
                        <li class="stepexpand"><span>In the first shell, connect the <code class="codeph">DV_ACCTMGR</code> user and remove the users you created. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT bea_dvacctmgr <span class="italic">-- Or, CONNECT bea_dvacctmgr@hrpdb</span>
Enter password: <span class="italic">password</span>

DROP USER patch_boss;
DROP USER patch_user;
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as a user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege and revoke the privileges that you had granted to the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> user.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT SYS AS SYSDBA <span class="italic">-- Or, CONNECT SYS@hrpdb</span> AS SYSDBA
Enter password: <span class="italic">password</span>

REVOKE CREATE PROCEDURE FROM leo_dvowner;
REVOKE SELECT ON V_$SESSION FROM leo_dvowner;
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> user and drop the rules, rule set, and command rule, in the order shown.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner <span class="italic">-- Or, CONNECT leo_dvowner@hrpdb</span>
Enter password: <span class="italic">password</span>

DROP FUNCTION check_boss_logged_in;
EXEC DBMS_MACADM.DELETE_COMMAND_RULE('CONNECT', '%', '%');
EXEC DBMS_MACADM.DELETE_RULE_FROM_RULE_SET('Dual Connect for Boss and Patch', 'Check if Boss Is Logged In');
EXEC DBMS_MACADM.DELETE_RULE_FROM_RULE_SET('Dual Connect for Boss and Patch', 'Allow Connect for Other Database Users');
EXEC DBMS_MACADM.DELETE_RULE('Check if Boss Is Logged In');
EXEC DBMS_MACADM.DELETE_RULE('Allow Connect for Other Database Users');
EXEC DBMS_MACADM.DELETE_RULE_SET('Dual Connect for Boss and Patch');
COMMIT;</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-D9AA1CCC-065C-4DFE-A078-908123401816" title="This tutorial demonstrates how to use Oracle Database Vault to control the authorization of two users.">Tutorial: Configuring Two-Person Integrity, or Dual Key Security</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DVADM70200"></a><div class="props_rev_3"><a id="GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34" name="GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34"></a><h3 id="DVADM-GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34" class="sect3">Guidelines for Designing Rule Sets</h3>
               <div>
                  <p>Oracle provides guidelines for designing rule sets.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>You can share rules among multiple rule sets. This lets you develop a library of reusable rule expressions. Oracle recommends that you design such rules to be discrete, single-purpose expressions. </p>
                     </li>
                     <li>
                        <p>You can design a rule set so that its evaluation is static, that is, it is evaluated only once during a user session. Alternatively, it can be evaluated each time the rule set is accessed. If the rule set is evaluated only once, then the evaluated value is reused throughout the user session each time the rule set is accessed. Using static evaluation is useful in cases where the rule set must be accessed multiple times but the conditions on which the rule set depend do not change during that session. An example would be a SELECT command rule associated with a rule set when the same <code class="codeph">SELECT</code> statement occurs multiple times and if the evaluated value is acceptable to use again, rather than evaluating the rule set each time the <code class="codeph">SELECT</code> occurs. 
                        </p>
                        <p>To control the static evaluation of the rule set, set the <code class="codeph">is_static</code> parameter of the <code class="codeph">CREATE_RULE_SET</code> or <code class="codeph">UPDATE_RULE_SET</code> procedures of the <code class="codeph">DBMS_MACADM</code> PL/SQL package. See <a href="oracle-database-vault-rule-set-apis.html#GUID-1B24D370-46E3-445E-91CC-8E621F5E94CB" title="The DBMS_MACADM rule set procedures enable you to configure both rule sets and individual rules that go within these rule sets.">DBMS_MACADM Rule Set Procedures</a> for more information.
                        </p>
                     </li>
                     <li>
                        <p>Use Oracle Database Vault factors in your rule expressions to provide reusability and trust in the values used by your rule expressions. Factors can provide contextual information to use in your rules expressions. </p>
                     </li>
                     <li>
                        <p>You can use custom event handlers to extend Oracle Database Vault security policies to integrate external systems for error handling or alerting. Using Oracle utility packages such as <code class="codeph">UTL_TCP</code>, <code class="codeph">UTL_HTTP</code>, <code class="codeph">UTL_MAIL</code>, <code class="codeph">UTL_SMTP</code>, or <code class="codeph">DBMS_AQ</code> can help you to achieve this type of integration. 
                        </p>
                     </li>
                     <li>
                        <p>Test rule sets thoroughly for various accounts and scenarios either on a test database or on a test realm or command rule for nonsensitive data before you apply them to realms and command rules that protect sensitive data. You can test rule expressions directly with the following SQL statement: </p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT SYSDATE from DUAL where <span class="italic">rule expression</span>
</pre></li>
                     <li>
                        <p>You can nest rule expressions inside a single rule. This helps to achieve more complex situations where you would need a logical <code class="codeph">AND</code> for a subset of rules and a logical <code class="codeph">OR</code> with the rest of the rules. See the definition for the Is Corporate Network During Maintenance rule set under <a href="configuring-rule-sets.html#GUID-744EC9BB-0804-4F91-BA0F-7D5584EA5B97" title="This tutorial demonstrates how to use the UTL_MAIL PL/SQL package and an access control list to create an email alert for security violations.">Tutorial: Creating an Email Alert for Security Violations</a> for an example. 
                        </p>
                     </li>
                     <li>
                        <p>You cannot use invoker's rights procedures with rule expressions. Only use definer's rights procedures with rule expressions.</p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DVADM70201"></a><div class="props_rev_3"><a id="GUID-980369CA-666C-4E3A-8F90-572F7F34CEC7" name="GUID-980369CA-666C-4E3A-8F90-572F7F34CEC7"></a><h3 id="DVADM-GUID-980369CA-666C-4E3A-8F90-572F7F34CEC7" class="sect3">How Rule Sets Affect Performance</h3>
               <div>
                  <p>The number and complexity of rules can slow database performance. </p>
                  <p>Rule sets govern the performance for execution of certain operations. For example, if you have a very large number of rules in a rule set governing a <code class="codeph">SELECT</code> statement, performance could degrade significantly. 
                  </p>
                  <p>If you have rule sets that require many rules, performance improves if you move all the rules to logic defined in a single PL/SQL standalone or package function. However, if a rule is used by other rule sets, there is little performance effect on your system. </p>
                  <p>If possible, consider setting the rule set to use static evaluation, assuming this is compatible with the associated command rule's usage. See <a href="configuring-rule-sets.html#GUID-F99FE15B-869E-44CC-A6C4-CC9BACD6BE34" title="Oracle provides guidelines for designing rule sets.">Guidelines for Designing Rule Sets</a> for more information. 
                  </p>
                  <p>You can check system performance by running tools such as Oracle Enterprise Manager (including Oracle Enterprise Manager Cloud Control, which is installed by default with Oracle Database), Automatic Workload Repository (AWR), and <code class="codeph">TKPROF</code>. 
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-980369CA-666C-4E3A-8F90-572F7F34CEC7__ORACLEDATABASEPERFORMANCETUNINGGUID-630E988B">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../tgdba/performance-tuning-overview.html#TGDBA025" target="_blank"><span><cite>Oracle Database Performance Tuning Guide</cite></span></a> to learn how to monitor database performance
                           </p>
                        </li>
                        <li>
                           <p><a href="../tgsql/performing-application-tracing.html#TGSQL809" target="_blank"><span><cite>Oracle Database SQL Tuning Guide</cite></span></a> to monitor the performance of individual SQL and PL/SQL statements
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DVADM70203"></a><a id="DVADM70204"></a><a id="DVADM70202"></a><div class="props_rev_3"><a id="GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7" name="GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7"></a><h3 id="DVADM-GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7" class="sect3">Rule Set and Rule Related Reports and Data Dictionary Views</h3>
               <div>
                  <p>Oracle Database Vault provides reports and data dictionary views that are useful for analyzing rule sets and the rules within them.</p>
                  <div class="section">
                     <p><a href="configuring-rule-sets.html#GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7__BABBJDEI" title="rule set reports">Table 5-2</a> lists the Oracle Database Vault reports. See <a href="oracle-database-vault-reports.html#GUID-1B6D02DE-3FB2-4ADB-9916-4491B37FDECD" title="Oracle Database Vault provides reports that track activities, such as the Database Vault configuration settings.">Oracle Database Vault Reports</a> for information about how to run these reports. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7__BABBJDEI">
                     <p class="titleintable">Table 5-2 Reports Related to Rule Sets</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Reports Related to Rule Sets" summary="rule set reports" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="47%" id="d18924e6724">Report</th>
                              <th align="left" valign="bottom" width="53%" id="d18924e6727">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d18924e6732" headers="d18924e6724 ">
                                 <p><a href="oracle-database-vault-reports.html#GUID-162BB69D-9C1F-4FB8-959E-1B8C21FE6FF9" title="The Rule Set Configuration Issues Report displays Oracle Database Vault rule set configuration issues.">Rule Set Configuration Issues Report</a></p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d18924e6732 d18924e6727 ">
                                 <p>Lists rule sets that have no rules defined or enabled</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d18924e6743" headers="d18924e6724 ">
                                 <p><a href="oracle-database-vault-reports.html#GUID-0BEBF077-C4BA-471B-8789-85BD5A758421" title="The Secure Application Configuration Issues Report displays Database Vault secure application role configuration issues.">Secure Application Configuration Issues Report</a></p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d18924e6743 d18924e6727 ">
                                 <p>Lists secure application roles that have incomplete or disabled rule sets</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d18924e6754" headers="d18924e6724 ">
                                 <p><a href="oracle-database-vault-reports.html#GUID-DB10DAF0-4E4C-4A11-A9B8-A227DC82D8AA" title="The Command Rule Configuration Issues Report displays command rules that have configuration issues.">Command Rule Configuration Issues Report</a></p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d18924e6754 d18924e6727 ">
                                 <p>Lists rule sets that are incomplete or disabled</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p><a href="configuring-rule-sets.html#GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7__BABIFDJJ" title="Rule Set Data Dictionary Views">Table 5-3</a> lists data dictionary views that provide information about existing rules and rule sets. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-FABD139C-F858-40F8-AD5D-6089F517F2E7__BABIFDJJ">
                     <p class="titleintable">Table 5-3 Data Dictionary Views Used for Rules and Rule Sets</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Data Dictionary Views Used for Rules and Rule Sets" summary="Rule Set Data Dictionary Views" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="47%" id="d18924e6781">Data Dictionary View</th>
                              <th align="left" valign="bottom" width="53%" id="d18924e6784">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d18924e6789" headers="d18924e6781 ">
                                 <p><a href="oracle-database-vault-data-dictionary-views.html#GUID-97C96089-0EE4-4A57-8257-1F9F61606245" title="The DBA_DV_RULE data dictionary view lists the rules that have been defined.">DBA_DV_RULE View</a></p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d18924e6789 d18924e6784 ">
                                 <p>Lists the rules that have been defined</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d18924e6803" headers="d18924e6781 ">
                                 <p><a href="oracle-database-vault-data-dictionary-views.html#GUID-A7FD62EB-A8E4-4279-A0D5-1677493AC202" title="The DBA_DV_RULE_SET data dictionary view lists the rules sets that have been created.">DBA_DV_RULE_SET View</a></p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d18924e6803 d18924e6784 ">
                                 <p>Lists the rule sets that have been created</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d18924e6817" headers="d18924e6781 ">
                                 <p><a href="oracle-database-vault-data-dictionary-views.html#GUID-52C00874-C14D-44F6-A89A-CCB5E07FBE3E" title="The DBA_DV_RULE_SET_RULE data dictionary view lists rules that are associated with existing rule sets.">DBA_DV_RULE_SET_RULE View</a></p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d18924e6817 d18924e6784 ">
                                 <p>Lists rules that are associated with existing rule sets</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>