<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter explains how database processes DDL statements to create objects, DML to modify data, and queries to retrieve data.">
      <meta name="description" content="This chapter explains how database processes DDL statements to create objects, DML to modify data, and queries to retrieve data.">
      <title>SQL Processing</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Tuning Guide">
      <meta property="og:description" content="This chapter explains how database processes DDL statements to create objects, DML to modify data, and queries to retrieve data.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Tuning Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-tuning-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-31T14:57:08-08:00">
      <meta name="dcterms.title" content="SQL Tuning Guide">
      <meta name="dcterms.dateCopyrighted" content="2013, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96095-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="query-optimizer-fundamentals.html" title="Previous" type="text/html">
      <link rel="next" href="query-optimizer-concepts.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGSQL">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="query-optimizer-fundamentals.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="query-optimizer-concepts.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Tuning Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="query-optimizer-fundamentals.html" property="item" typeof="WebPage"><span property="name">Query Optimizer Fundamentals</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">SQL Processing </li>
            </ol>
            <a id="GUID-B3415175-41F2-4EBB-95CF-5F8B5C39E927" name="GUID-B3415175-41F2-4EBB-95CF-5F8B5C39E927"></a>
            
            <h2 id="TGSQL-GUID-B3415175-41F2-4EBB-95CF-5F8B5C39E927" class="sect2"><span class="enumeration_chapter">3 </span>SQL Processing 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter explains how database processes DDL statements to create objects, DML to modify data, and queries to retrieve data.</p>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="sql-processing.html#GUID-873A7B2C-CD17-428A-8AE2-5B08906E45FB">About SQL Processing</a><br><strong class="term">SQL processing</strong> is the parsing, optimization, row source generation, and execution of a SQL statement. 
                  </li>
                  <li class="ulchildlink"><a href="sql-processing.html#GUID-BEB00996-3614-45F4-991B-2585E08D8C97">How Oracle Database Processes DML</a><br>Most DML statements have a query component. In a query, execution of a cursor places the results of the query into a set of rows called the <strong class="term">result set</strong>.
                  </li>
                  <li class="ulchildlink"><a href="sql-processing.html#GUID-C7B96C36-3AE9-4120-A511-C4B2992275DD">How Oracle Database Processes DDL</a><br>Oracle Database processes DDL differently from DML.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="query-optimizer-fundamentals.html#GUID-EF45F82A-F17D-4C79-9B6A-8CBBB95F0684" title="To tune Oracle SQL, you must understand the query optimizer. The optimizer is built-in software that determines the most efficient method for a statement to access data.">Query Optimizer Fundamentals</a></p>
                  </div>
               </div>
            </div>
            <a id="TGSQL177"></a><a id="TGSQL175"></a><a id="TGSQL176"></a><div class="props_rev_3"><a id="GUID-873A7B2C-CD17-428A-8AE2-5B08906E45FB" name="GUID-873A7B2C-CD17-428A-8AE2-5B08906E45FB"></a><h3 id="TGSQL-GUID-873A7B2C-CD17-428A-8AE2-5B08906E45FB" class="sect3"><span class="enumeration_section">3.1 </span>About SQL Processing
               </h3>
               <div>
                  <p><strong class="term">SQL processing</strong> is the parsing, optimization, row source generation, and execution of a SQL statement. 
                  </p>
                  <p>The following figure depicts the general stages of SQL processing. Depending on the statement, the database may omit some of these stages.</p>
                  <div class="figure" id="GUID-873A7B2C-CD17-428A-8AE2-5B08906E45FB__BABHAJJE">
                     <p class="titleinfigure">Figure 3-1 Stages of SQL Processing</p><img src="img/cncpt250.gif" alt="Description of Figure 3-1 follows" title="Description of Figure 3-1 follows" longdesc="img_text/cncpt250.html"><br><a href="img_text/cncpt250.html">Description of "Figure 3-1 Stages of SQL Processing"</a></div>
                  <!-- class="figure" -->
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="sql-processing.html#GUID-8CF633B1-EAC4-47C7-9189-C479ADEF1FFA">SQL Parsing</a><br>The first stage of SQL processing is <strong class="term">parsing</strong>.
                     </li>
                     <li class="ulchildlink"><a href="sql-processing.html#GUID-0196D949-6B0F-4DB0-BCCF-768F16B0964C">SQL Optimization</a><br>During optimization, Oracle Database must perform a hard parse at least once for every unique DML statement and performs the optimization during this parse. 
                     </li>
                     <li class="ulchildlink"><a href="sql-processing.html#GUID-E052E274-586D-4D76-960F-B831140F7B94">SQL Row Source Generation</a><br>The <strong class="term">row source generator</strong> is software that receives the optimal execution plan from the optimizer and produces an iterative execution plan that is usable by the rest of the database.
                     </li>
                     <li class="ulchildlink"><a href="sql-processing.html#GUID-CC83C349-364F-4AB4-8113-0FD6753EF3FB">SQL Execution</a><br>During execution, the SQL engine executes each row source in the tree produced by the row source generator. This step is the only mandatory step in DML processing.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-B3415175-41F2-4EBB-95CF-5F8B5C39E927" title="This chapter explains how database processes DDL statements to create objects, DML to modify data, and queries to retrieve data.">SQL Processing</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL178"></a><div class="props_rev_3"><a id="GUID-8CF633B1-EAC4-47C7-9189-C479ADEF1FFA" name="GUID-8CF633B1-EAC4-47C7-9189-C479ADEF1FFA"></a><h4 id="TGSQL-GUID-8CF633B1-EAC4-47C7-9189-C479ADEF1FFA" class="sect4"><span class="enumeration_section">3.1.1 </span>SQL Parsing
                  </h4>
                  <div>
                     <p>The first stage of SQL processing is <strong class="term">parsing</strong>.
                     </p>
                     <p>The parsing stage involves separating the pieces of a SQL statement into a data structure that other routines can process. The database parses a statement when instructed by the application, which means that only the applicationÂ­, and not the database itself, can reduce the number of parses.</p>
                     <p>When an application issues a SQL statement, the application makes a <a href="glossary.html#GUID-B7B23E36-A65E-43CD-AE96-37B62EA8CB32"><span class="xrefglossterm">parse call</span></a> to the database to prepare the statement for execution. The parse call opens or creates a <a href="glossary.html#GUID-B29D6FB9-8D89-4124-A14F-E0FAEDAB2AA5"><span class="xrefglossterm">cursor</span></a>, which is a handle for the session-specific <a href="glossary.html#GUID-CD39D395-8176-4A4F-AEEA-4971F8CB7C58"><span class="xrefglossterm">private SQL area</span></a> that holds a parsed SQL statement and other processing information. The cursor and private SQL area are in the program global area (PGA).
                     </p>
                     <p>During the parse call, the database performs checks that identify the errors that can be found <span class="italic">before statement execution</span>. Some errors cannot be caught by parsing. For example, the database can encounter deadlocks or errors in data conversion only during statement execution.
                     </p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="sql-processing.html#GUID-26F3EC36-A200-482E-AAE5-35248A118873">Syntax Check</a><br>Oracle Database must check each SQL statement for syntactic validity.
                        </li>
                        <li class="ulchildlink"><a href="sql-processing.html#GUID-EBB3A725-BF76-4B7C-A3A0-1D8CE20EFF7C">Semantic Check</a><br>The semantics of a statement are its meaning. A semantic check determines whether a statement is meaningful, for example, whether the objects and columns in the statement exist. 
                        </li>
                        <li class="ulchildlink"><a href="sql-processing.html#GUID-BFF0B26C-0A5D-4F79-B01E-8E1C4064A6AD">Shared Pool Check</a><br>During the parse, the database performs a shared pool check to determine whether it can skip resource-intensive steps of statement processing.
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-8CF633B1-EAC4-47C7-9189-C479ADEF1FFA__GUID-E4A08F0E-B2E7-4D1C-8457-DF580481A02E">
                        <p class="notep1">See Also:</p>
                        <p><a href="../cncpt/data-concurrency-and-consistency.html#CNCPT1336" target="_blank"><span><cite>Oracle Database Concepts</cite></span></a> to learn about deadlocks
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-873A7B2C-CD17-428A-8AE2-5B08906E45FB" title="SQL processing is the parsing, optimization, row source generation, and execution of a SQL statement.">About SQL Processing</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="TGSQL179"></a><div class="props_rev_3"><a id="GUID-26F3EC36-A200-482E-AAE5-35248A118873" name="GUID-26F3EC36-A200-482E-AAE5-35248A118873"></a><h5 id="TGSQL-GUID-26F3EC36-A200-482E-AAE5-35248A118873" class="sect5"><span class="enumeration_section">3.1.1.1 </span>Syntax Check
                     </h5>
                     <div>
                        <p>Oracle Database must check each SQL statement for syntactic validity.</p>
                        <p>A statement that breaks a rule for well-formed SQL syntax fails the check. For example, the following statement fails because the keyword <code class="codeph">FROM</code> is misspelled as <code class="codeph">FORM</code>:
                        </p><pre class="pre codeblock"><code>SQL&gt; SELECT * FORM employees;
SELECT * FORM employees
         *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected</code></pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-8CF633B1-EAC4-47C7-9189-C479ADEF1FFA" title="The first stage of SQL processing is parsing.">SQL Parsing</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL180"></a><div class="props_rev_3"><a id="GUID-EBB3A725-BF76-4B7C-A3A0-1D8CE20EFF7C" name="GUID-EBB3A725-BF76-4B7C-A3A0-1D8CE20EFF7C"></a><h5 id="TGSQL-GUID-EBB3A725-BF76-4B7C-A3A0-1D8CE20EFF7C" class="sect5"><span class="enumeration_section">3.1.1.2 </span>Semantic Check
                     </h5>
                     <div>
                        <p>The semantics of a statement are its meaning. A semantic check determines whether a statement is meaningful, for example, whether the objects and columns in the statement exist. </p>
                        <p>A syntactically correct statement can fail a semantic check, as shown in the following example of a query of a nonexistent table:</p><pre class="pre codeblock"><code>SQL&gt; SELECT * FROM nonexistent_table;
SELECT * FROM nonexistent_table
              *
ERROR at line 1:
ORA-00942: table or view does not exist</code></pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-8CF633B1-EAC4-47C7-9189-C479ADEF1FFA" title="The first stage of SQL processing is parsing.">SQL Parsing</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL182"></a><a id="TGSQL181"></a><div class="props_rev_3"><a id="GUID-BFF0B26C-0A5D-4F79-B01E-8E1C4064A6AD" name="GUID-BFF0B26C-0A5D-4F79-B01E-8E1C4064A6AD"></a><h5 id="TGSQL-GUID-BFF0B26C-0A5D-4F79-B01E-8E1C4064A6AD" class="sect5"><span class="enumeration_section">3.1.1.3 </span>Shared Pool Check
                     </h5>
                     <div>
                        <p>During the parse, the database performs a shared pool check to determine whether it can skip resource-intensive steps of statement processing.</p>
                        <p>To this end, the database uses a hashing algorithm to generate a hash value for every SQL statement. The statement hash value is the <a href="glossary.html#GUID-894D17CF-F10C-4BD5-B2A2-E3AC23759B78"><span class="xrefglossterm">SQL ID</span></a> shown in <code class="codeph">V$SQL.SQL_ID</code>. This hash value is deterministic within a version of Oracle Database, so the same statement in a single instance or in different instances has the same SQL ID.
                        </p>
                        <p>When a user submits a SQL statement, the database searches the <a href="glossary.html#GUID-577D0DD3-FB98-4B1B-BCFB-95313BB35C01"><span class="xrefglossterm">shared SQL area</span></a> to see if an existing parsed statement has the same hash value. The hash value of a SQL statement is distinct from the following values:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Memory address for the statement </p>
                              <p>Oracle Database uses the SQL ID to perform a keyed read in a lookup table. In this way, the database obtains possible memory addresses of the statement.</p>
                           </li>
                           <li>
                              <p>Hash value of an <a href="glossary.html#GUID-800F2BE7-A383-4FF3-A9A6-FCE786AABA3B"><span class="xrefglossterm">execution plan</span></a> for the statement
                              </p>
                              <p>A SQL statement can have multiple plans in the shared pool. Typically, each plan has a different hash value. If the same SQL ID has multiple plan hash values, then the database knows that multiple plans exist for this SQL ID.</p>
                           </li>
                        </ul>
                        <p>Parse operations fall into the following categories, depending on the type of statement submitted and the result of the hash check:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Hard parse</p>
                              <p>If Oracle Database cannot reuse existing code, then it must build a new executable version of the application code. This operation is known as a <a href="glossary.html#GUID-AB764C9E-2F03-49A9-BF8B-36A9FBD03BCE"><span class="xrefglossterm">hard parse</span></a>, or a <a href="glossary.html#GUID-D12396D3-DCDA-4A61-8891-64AD81876EFD"><span class="xrefglossterm">library cache miss</span></a>.
                              </p>
                              <div class="infoboxnote" id="GUID-BFF0B26C-0A5D-4F79-B01E-8E1C4064A6AD__GUID-BB11D2CF-1232-49C2-A010-BC21F727B77A">
                                 <p class="notep1">Note:</p>
                                 <p>The database always performs a hard parse of DDL.</p>
                              </div>
                              <p>During the hard parse, the database accesses the library cache and data dictionary cache numerous times to check the data dictionary. When the database accesses these areas, it uses a serialization device called a <a href="glossary.html#GUID-B1C1EE03-1E9E-45F9-BD12-3B05654F7615"><span class="xrefglossterm">latch</span></a> on required objects so that their definition does not change. Latch contention increases statement execution time and decreases concurrency.
                              </p>
                           </li>
                           <li>
                              <p>Soft parse</p>
                              <p>A <a href="glossary.html#GUID-BA91B10B-FBA3-4DF6-B59B-9AA57C683D33"><span class="xrefglossterm">soft parse</span></a> is any parse that is not a hard parse. If the submitted statement is the same as a reusable SQL statement in the shared pool, then Oracle Database reuses the existing code. This reuse of code is also called a <a href="glossary.html#GUID-22628BDA-52D1-4349-827A-071163A13D1A"><span class="xrefglossterm">library cache hit</span></a>.
                              </p>
                              <p>Soft parses can vary in how much work they perform. For example, configuring the session shared SQL area can sometimes reduce the amount of latching in the soft parses, making them "softer."</p>
                              <p>In general, a soft parse is preferable to a hard parse because the database skips the optimization and row source generation steps, proceeding straight to execution.</p>
                           </li>
                        </ul>
                        <p>The following graphic is a simplified representation of a shared pool check of an <code class="codeph">UPDATE</code> statement in a dedicated server architecture.
                        </p>
                        <div class="figure" id="GUID-BFF0B26C-0A5D-4F79-B01E-8E1C4064A6AD__BABDFGJD">
                           <p class="titleinfigure">Figure 3-2 Shared Pool Check</p><img src="img/cncpt251.gif" alt="Description of Figure 3-2 follows" title="Description of Figure 3-2 follows" longdesc="img_text/cncpt251.html"><br><a href="img_text/cncpt251.html">Description of "Figure 3-2 Shared Pool Check"</a></div>
                        <!-- class="figure" -->
                        <p>If a check determines that a statement in the shared pool has the same hash value, then the database performs semantic and environment checks to determine whether the statements have the same meaning. Identical syntax is not sufficient. For example, suppose two different users log in to the database and issue the following SQL statements:</p><pre class="pre codeblock"><code>CREATE TABLE my_table ( some_col INTEGER );
SELECT * FROM my_table;
</code></pre><p>The <code class="codeph">SELECT</code> statements for the two users are syntactically identical, but two separate schema objects are named <code class="codeph">my_table</code>. This semantic difference means that the second statement cannot reuse the code for the first statement.
                        </p>
                        <p>Even if two statements are semantically identical, an environmental difference can force a hard parse. In this context, the <a href="glossary.html#GUID-689C2576-297D-471D-8575-86FAE0185AAD"><span class="xrefglossterm">optimizer environment</span></a> is the totality of session settings that can affect execution plan generation, such as the work area size or optimizer settings (for example, the optimizer mode). Consider the following series of SQL statements executed by a single user:
                        </p><pre class="pre codeblock"><code>ALTER SESSION SET OPTIMIZER_MODE=ALL_ROWS;
ALTER SYSTEM FLUSH SHARED_POOL;               # optimizer environment 1
SELECT * FROM sh.sales;

ALTER SESSION SET OPTIMIZER_MODE=FIRST_ROWS;  # optimizer environment 2
SELECT * FROM sh.sales;

ALTER SESSION SET SQL_TRACE=true;             # optimizer environment 3
SELECT * FROM sh.sales;
</code></pre><p>In the preceding example, the same <code class="codeph">SELECT</code> statement is executed in three different optimizer environments. Consequently, the database creates three separate shared SQL areas for these statements and forces a hard parse of each statement.
                        </p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-BFF0B26C-0A5D-4F79-B01E-8E1C4064A6AD__GUID-D4B61C91-2173-4F68-A257-F72ECADE3297">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../cncpt/memory-architecture.html#CNCPT007" target="_blank"><span><cite>Oracle Database Concepts</cite></span></a> to learn about private SQL areas and shared SQL areas
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../tgdba/tuning-shared-pool-and-large-pool.html#TGDBA558" target="_blank"><span><cite>Oracle Database Performance Tuning Guide</cite></span></a> to learn how to configure the shared pool
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../cncpt/data-concurrency-and-consistency.html#CNCPT1358" target="_blank"><span><cite>Oracle Database Concepts</cite></span></a> to learn about latches
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-8CF633B1-EAC4-47C7-9189-C479ADEF1FFA" title="The first stage of SQL processing is parsing.">SQL Parsing</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL183"></a><div class="props_rev_3"><a id="GUID-0196D949-6B0F-4DB0-BCCF-768F16B0964C" name="GUID-0196D949-6B0F-4DB0-BCCF-768F16B0964C"></a><h4 id="TGSQL-GUID-0196D949-6B0F-4DB0-BCCF-768F16B0964C" class="sect4"><span class="enumeration_section">3.1.2 </span>SQL Optimization
                  </h4>
                  <div>
                     <p>During optimization, Oracle Database must perform a hard parse at least once for every unique DML statement and performs the optimization during this parse. </p>
                     <p>The database does not optimize DDL. The only exception is when the DDL includes a DML component such as a subquery that requires optimization.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-873A7B2C-CD17-428A-8AE2-5B08906E45FB" title="SQL processing is the parsing, optimization, row source generation, and execution of a SQL statement.">About SQL Processing</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL185"></a><a id="TGSQL184"></a><div class="props_rev_3"><a id="GUID-E052E274-586D-4D76-960F-B831140F7B94" name="GUID-E052E274-586D-4D76-960F-B831140F7B94"></a><h4 id="TGSQL-GUID-E052E274-586D-4D76-960F-B831140F7B94" class="sect4"><span class="enumeration_section">3.1.3 </span>SQL Row Source Generation
                  </h4>
                  <div>
                     <p>The <strong class="term">row source generator</strong> is software that receives the optimal execution plan from the optimizer and produces an iterative execution plan that is usable by the rest of the database.
                     </p>
                     <p>The iterative plan is a binary program that, when executed by the SQL engine, produces the result set. The plan takes the form of a combination of steps. Each step returns a <a href="glossary.html#GUID-88998F10-D77C-43B5-B148-E649BF366DC2"><span class="xrefglossterm">row set</span></a>. The next step either uses the rows in this set, or the last step returns the rows to the application issuing the SQL statement.
                     </p>
                     <p>A <a href="glossary.html#GUID-BDE98BD8-BC33-45AD-97BF-81831BF94B04"><span class="xrefglossterm">row source</span></a> is a row set returned by a step in the execution plan along with a control structure that can iteratively process the rows. The row source can be a table, view, or result of a join or grouping operation.
                     </p>
                     <p>The row source generator produces a <a href="glossary.html#GUID-8C474809-DFD4-4EA6-90FE-A17882D07E58"><span class="xrefglossterm">row source tree</span></a>, which is a collection of row sources. The row source tree shows the following information:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>An ordering of the tables referenced by the statement</p>
                        </li>
                        <li>
                           <p>An access method for each table mentioned in the statement</p>
                        </li>
                        <li>
                           <p>A join method for tables affected by join operations in the statement</p>
                        </li>
                        <li>
                           <p>Data operations such as filter, sort, or aggregation</p>
                        </li>
                     </ul>
                     <div class="example" id="GUID-E052E274-586D-4D76-960F-B831140F7B94__BABGEIBF">
                        <p class="titleinexample">Example 3-1 Execution Plan</p>
                        <p>This example shows the execution plan of a <code class="codeph">SELECT</code> statement when <code class="codeph">AUTOTRACE</code> is enabled. The statement selects the last name, job title, and department name for all employees whose last names begin with the letter <code class="codeph">A</code>. The execution plan for this statement is the output of the row source generator.
                        </p><pre class="pre codeblock"><code>SELECT e.last_name, j.job_title, d.department_name 
FROM   hr.employees e, hr.departments d, hr.jobs j
WHERE  e.department_id = d.department_id
AND    e.job_id = j.job_id
AND    e.last_name LIKE 'A%';
 
Execution Plan
----------------------------------------------------------
Plan hash value: 975837011

--------------------------------------------------------------------------------
| Id| Operation                     | Name        |Rows|Bytes|Cost(%CPU)|Time  |
--------------------------------------------------------------------------------
| 0 | SELECT STATEMENT              |             |  3 | 189 | 7(15)| 00:00:01 |
|*1 |  HASH JOIN                    |             |  3 | 189 | 7(15)| 00:00:01 |
|*2 |   HASH JOIN                   |             |  3 | 141 | 5(20)| 00:00:01 |
| 3 |    TABLE ACCESS BY INDEX ROWID| EMPLOYEES   |  3 |  60 | 2 (0)| 00:00:01 |
|*4 |     INDEX RANGE SCAN          | EMP_NAME_IX |  3 |     | 1 (0)| 00:00:01 |
| 5 |    TABLE ACCESS FULL          | JOBS        | 19 | 513 | 2 (0)| 00:00:01 |
| 6 |   TABLE ACCESS FULL           | DEPARTMENTS | 27 | 432 | 2 (0)| 00:00:01 |
--------------------------------------------------------------------------------
 
Predicate Information (identified by operation id):
---------------------------------------------------
 
   1 - access("E"."DEPARTMENT_ID"="D"."DEPARTMENT_ID")
   2 - access("E"."JOB_ID"="J"."JOB_ID")
   4 - access("E"."LAST_NAME" LIKE 'A%')
       filter("E"."LAST_NAME" LIKE 'A%')</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-873A7B2C-CD17-428A-8AE2-5B08906E45FB" title="SQL processing is the parsing, optimization, row source generation, and execution of a SQL statement.">About SQL Processing</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL187"></a><a id="TGSQL186"></a><div class="props_rev_3"><a id="GUID-CC83C349-364F-4AB4-8113-0FD6753EF3FB" name="GUID-CC83C349-364F-4AB4-8113-0FD6753EF3FB"></a><h4 id="TGSQL-GUID-CC83C349-364F-4AB4-8113-0FD6753EF3FB" class="sect4"><span class="enumeration_section">3.1.4 </span>SQL Execution
                  </h4>
                  <div>
                     <p>During execution, the SQL engine executes each row source in the tree produced by the row source generator. This step is the only mandatory step in DML processing.</p>
                     <p><a href="sql-processing.html#GUID-CC83C349-364F-4AB4-8113-0FD6753EF3FB__BABJECHA">Figure 3-3</a> is an <a href="glossary.html#GUID-CB39EBA4-C228-4A41-960C-B0D180FA9A13"><span class="xrefglossterm">execution tree</span></a>, also called a <span class="italic">parse tree</span>, that shows the flow of row sources from one step to another in the plan in <a href="sql-processing.html#GUID-E052E274-586D-4D76-960F-B831140F7B94__BABGEIBF">Example 3-1</a>. In general, the order of the steps in execution is the <span class="italic">reverse</span> of the order in the plan, so you read the plan from the bottom up.
                     </p>
                     <p>Each step in an execution plan has an ID number. The numbers in <a href="sql-processing.html#GUID-CC83C349-364F-4AB4-8113-0FD6753EF3FB__BABJECHA">Figure 3-3</a> correspond to the <code class="codeph">Id</code> column in the plan shown in <a href="sql-processing.html#GUID-E052E274-586D-4D76-960F-B831140F7B94__BABGEIBF">Example 3-1</a>. Initial spaces in the <code class="codeph">Operation</code> column of the plan indicate hierarchical relationships. For example, if the name of an operation is preceded by two spaces, then this operation is a child of an operation preceded by one space. Operations preceded by one space are children of the <code class="codeph">SELECT</code> statement itself.
                     </p>
                     <div class="figure" id="GUID-CC83C349-364F-4AB4-8113-0FD6753EF3FB__BABJECHA">
                        <p class="titleinfigure">Figure 3-3 Row Source Tree</p><img src="img/cncpt001.gif" alt="Description of Figure 3-3 follows" title="Description of Figure 3-3 follows" longdesc="img_text/cncpt001.html"><br><a href="img_text/cncpt001.html">Description of "Figure 3-3 Row Source Tree"</a></div>
                     <!-- class="figure" -->
                     <p>In <a href="sql-processing.html#GUID-CC83C349-364F-4AB4-8113-0FD6753EF3FB__BABJECHA">Figure 3-3</a>, each node of the tree acts as a row source, which means that each step of the execution plan in <a href="sql-processing.html#GUID-E052E274-586D-4D76-960F-B831140F7B94__BABGEIBF">Example 3-1</a> either retrieves rows from the database or accepts rows from one or more row sources as input. The SQL engine executes each row source as follows:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Steps indicated by the black boxes physically retrieve data from an object in the database. These steps are the access paths, or techniques for retrieving data from the database.</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Step 6 uses a full table scan to retrieve all rows from the <code class="codeph">departments</code> table.
                                 </p>
                              </li>
                              <li>
                                 <p>Step 5 uses a full table scan to retrieve all rows from the <code class="codeph">jobs</code> table.
                                 </p>
                              </li>
                              <li>
                                 <p>Step 4 scans the <code class="codeph">emp_name_ix</code> index in order, looking for each key that begins with the letter <code class="codeph">A</code> and retrieving the corresponding rowid. For example, the rowid corresponding to <code class="codeph">Atkinson</code> is <code class="codeph">AAAPzRAAFAAAABSAAe</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>Step 3 retrieves from the <code class="codeph">employees</code> table the rows whose rowids were returned by Step 4. For example, the database uses rowid <code class="codeph">AAAPzRAAFAAAABSAAe</code> to retrieve the row for <code class="codeph">Atkinson</code>.
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>Steps indicated by the clear boxes operate on row sources.</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Step 2 performs a <a href="glossary.html#GUID-FF45796B-8A90-45C6-8A40-0B308B72AF7C"><span class="xrefglossterm">hash join</span></a>, accepting row sources from Steps 3 and 5, joining each row from the Step 5 row source to its corresponding row in Step 3, and returning the resulting rows to Step 1.
                                 </p>
                                 <p>For example, the row for employee <code class="codeph">Atkinson</code> is associated with the job name <code class="codeph">Stock Clerk</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>Step 1 performs another hash join, accepting row sources from Steps 2 and 6, joining each row from the Step 6 source to its corresponding row in Step 2, and returning the result to the client.</p>
                                 <p>For example, the row for employee <code class="codeph">Atkinson</code> is associated with the department named <code class="codeph">Shipping</code>.
                                 </p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p>In some execution plans the steps are iterative and in others sequential. The hash join shown in <a href="sql-processing.html#GUID-E052E274-586D-4D76-960F-B831140F7B94__BABGEIBF">Example 3-1</a> is sequential. The database completes the steps in their entirety based on the join order. The database starts with the index range scan of <code class="codeph">emp_name_ix</code>. Using the rowids that it retrieves from the index, the database reads the matching rows in the <code class="codeph">employees</code> table, and then scans the <code class="codeph">jobs</code> table. After it retrieves the rows from the <code class="codeph">jobs</code> table, the database performs the hash join.
                     </p>
                     <p>During execution, the database reads the data from disk into memory if the data is not in memory. The database also takes out any locks and latches necessary to ensure data integrity and logs any changes made during the SQL execution. The final stage of processing a SQL statement is closing the cursor.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-873A7B2C-CD17-428A-8AE2-5B08906E45FB" title="SQL processing is the parsing, optimization, row source generation, and execution of a SQL statement.">About SQL Processing</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL188"></a><div class="props_rev_3"><a id="GUID-BEB00996-3614-45F4-991B-2585E08D8C97" name="GUID-BEB00996-3614-45F4-991B-2585E08D8C97"></a><h3 id="TGSQL-GUID-BEB00996-3614-45F4-991B-2585E08D8C97" class="sect3"><span class="enumeration_section">3.2 </span>How Oracle Database Processes DML
               </h3>
               <div>
                  <p>Most DML statements have a query component. In a query, execution of a cursor places the results of the query into a set of rows called the <strong class="term">result set</strong>.
                  </p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="sql-processing.html#GUID-422F679D-80AD-42CF-B38C-7D22A550E2AA">How Row Sets Are Fetched</a><br>Result set rows can be fetched either a row at a time or in groups. 
                     </li>
                     <li class="ulchildlink"><a href="sql-processing.html#GUID-7F6D150A-DC47-4A34-8455-ECA648206297">Read Consistency</a><br>In general, a query retrieves data by using the Oracle Database read consistency mechanism, which guarantees that all data blocks read by a query are consistent to a single point in time. 
                     </li>
                     <li class="ulchildlink"><a href="sql-processing.html#GUID-14D902DA-5CAC-4892-BE8B-880A4F8A6914">Data Changes</a><br>DML statements that must change data use read consistency to retrieve only the data that matched the search criteria when the modification began.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-B3415175-41F2-4EBB-95CF-5F8B5C39E927" title="This chapter explains how database processes DDL statements to create objects, DML to modify data, and queries to retrieve data.">SQL Processing</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-422F679D-80AD-42CF-B38C-7D22A550E2AA" name="GUID-422F679D-80AD-42CF-B38C-7D22A550E2AA"></a><h4 id="TGSQL-GUID-422F679D-80AD-42CF-B38C-7D22A550E2AA" class="sect4"><span class="enumeration_section">3.2.1 </span>How Row Sets Are Fetched
                  </h4>
                  <div>
                     <p>Result set rows can be fetched either a row at a time or in groups. </p>
                     <p>In the fetch stage, the database selects rows and, if requested by the query, orders the rows. Each successive fetch retrieves another row of the result until the last row has been fetched.</p>
                     <p>In general, the database cannot determine for certain the number of rows to be retrieved by a query until the last row is fetched. Oracle Database retrieves the data in response to fetch calls, so that the more rows the database reads, the more work it performs. For some queries the database returns the first row as quickly as possible, whereas for others it creates the entire result set before returning the first row.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-BEB00996-3614-45F4-991B-2585E08D8C97" title="Most DML statements have a query component. In a query, execution of a cursor places the results of the query into a set of rows called the result set.">How Oracle Database Processes DML</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL189"></a><div class="props_rev_3"><a id="GUID-7F6D150A-DC47-4A34-8455-ECA648206297" name="GUID-7F6D150A-DC47-4A34-8455-ECA648206297"></a><h4 id="TGSQL-GUID-7F6D150A-DC47-4A34-8455-ECA648206297" class="sect4"><span class="enumeration_section">3.2.2 </span>Read Consistency
                  </h4>
                  <div>
                     <p>In general, a query retrieves data by using the Oracle Database read consistency mechanism, which guarantees that all data blocks read by a query are consistent to a single point in time. </p>
                     <p>Read consistency uses undo data to show past versions of data. For an example, suppose a query must read 100 data blocks in a full table scan. The query processes the first 10 blocks while DML in a different session modifies block 75. When the first session reaches block 75, it realizes the change and uses undo data to retrieve the old, unmodified version of the data and construct a noncurrent version of block 75 in memory.</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-7F6D150A-DC47-4A34-8455-ECA648206297__GUID-D9C83CC9-747D-4DBB-B825-3B1A7269B8B7">
                        <p class="notep1">See Also:</p>
                        <p><a href="../cncpt/data-concurrency-and-consistency.html#CNCPT020" target="_blank"><span><cite>Oracle Database Concepts</cite></span></a> to learn about multiversion read consistency
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-BEB00996-3614-45F4-991B-2585E08D8C97" title="Most DML statements have a query component. In a query, execution of a cursor places the results of the query into a set of rows called the result set.">How Oracle Database Processes DML</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL190"></a><div class="props_rev_3"><a id="GUID-14D902DA-5CAC-4892-BE8B-880A4F8A6914" name="GUID-14D902DA-5CAC-4892-BE8B-880A4F8A6914"></a><h4 id="TGSQL-GUID-14D902DA-5CAC-4892-BE8B-880A4F8A6914" class="sect4"><span class="enumeration_section">3.2.3 </span>Data Changes
                  </h4>
                  <div>
                     <p>DML statements that must change data use read consistency to retrieve only the data that matched the search criteria when the modification began.</p>
                     <p>Afterward, these statements retrieve the data blocks as they exist in their current state and make the required modifications. The database must perform other actions related to the modification of the data such as generating redo and undo data.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-BEB00996-3614-45F4-991B-2585E08D8C97" title="Most DML statements have a query component. In a query, execution of a cursor places the results of the query into a set of rows called the result set.">How Oracle Database Processes DML</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL191"></a><div class="props_rev_3"><a id="GUID-C7B96C36-3AE9-4120-A511-C4B2992275DD" name="GUID-C7B96C36-3AE9-4120-A511-C4B2992275DD"></a><h3 id="TGSQL-GUID-C7B96C36-3AE9-4120-A511-C4B2992275DD" class="sect3"><span class="enumeration_section">3.3 </span>How Oracle Database Processes DDL
               </h3>
               <div>
                  <p>Oracle Database processes DDL differently from DML.</p>
                  <p>For example, when you create a table, the database does not optimize the <code class="codeph">CREATE TABLE</code> statement. Instead, Oracle Database parses the DDL statement and carries out the command.
                  </p>
                  <p>The database processes DDL differently because it is a means of defining an object in the data dictionary. Typically, Oracle Database must parse and execute many <a href="glossary.html#GUID-4BBB2EED-7E8C-4BAF-A3B3-B1CEF98342AC"><span class="xrefglossterm">recursive SQL</span></a> statements to execute a DDL statement. Suppose you create a table as follows:
                  </p><pre class="pre codeblock"><code>CREATE TABLE mytable (mycolumn INTEGER);
</code></pre><p>Typically, the database would run dozens of recursive statements to execute the preceding statement. The recursive SQL would perform actions such as the following:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Issue a <code class="codeph">COMMIT</code> before executing the <code class="codeph">CREATE TABLE</code> statement
                        </p>
                     </li>
                     <li>
                        <p>Verify that user privileges are sufficient to create the table</p>
                     </li>
                     <li>
                        <p>Determine which tablespace the table should reside in</p>
                     </li>
                     <li>
                        <p>Ensure that the tablespace quota has not been exceeded</p>
                     </li>
                     <li>
                        <p>Ensure that no object in the schema has the same name</p>
                     </li>
                     <li>
                        <p>Insert rows that define the table into the data dictionary</p>
                     </li>
                     <li>
                        <p>Issue a <code class="codeph">COMMIT</code> if the DDL statement succeeded or a <code class="codeph">ROLLBACK</code> if it did not
                        </p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-C7B96C36-3AE9-4120-A511-C4B2992275DD__GUID-302442FA-173D-444D-A365-653658578EED">
                     <p class="notep1">See Also:</p>
                     <p><a href="../adfns/sql-processing-for-application-developers.html#ADFNS134" target="_blank"><span><cite>Oracle Database Development Guide</cite></span></a> to learn about processing DDL, transaction control, and other types of statements
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="sql-processing.html#GUID-B3415175-41F2-4EBB-95CF-5F8B5C39E927" title="This chapter explains how database processes DDL statements to create objects, DML to modify data, and queries to retrieve data.">SQL Processing</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>