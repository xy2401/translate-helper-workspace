<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>FLASHBACK DATABASE</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Backup and Recovery Reference">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Backup and Recovery Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-backup-and-recovery-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T19:31:58-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96242-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="EXIT.html" title="Previous" type="text/html">
      <link rel="next" href="GRANT.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery Reference">
    <meta name="dcterms.isVersionOf" content="RCMRF">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="EXIT.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="GRANT.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Backup and Recovery Reference</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="rman-commands-at-sign-to-quit.html" property="item" typeof="WebPage"><span property="name"> RMAN Commands: @ (at sign) to QUIT</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">FLASHBACK DATABASE</li>
            </ol>
            <a id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511" name="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511"></a><a id="RCMRF90179"></a><a id="RCMRF90180"></a><a id="RCMRF90181"></a><a id="RCMRF90182"></a><a id="RCMRF90183"></a><a id="RCMRF90184"></a><a id="RCMRF90185"></a><a id="RCMRF90186"></a><a id="RCMRF194"></a>
            
            <h2 id="RCMRF-GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511" class="sect2"><span class="enumeration_section">2.23 </span>FLASHBACK DATABASE
            </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-FF0297E6-D3A4-4F32-9240-C9C90C246611">Purpose</p>
                  <p>Use the <code class="codeph">FLASHBACK DATABASE</code> command to rewind the database to a target time, SCN, log sequence number, or restore point.
                  </p>
                  <p>This command undoes changes made by Oracle Database to the data files that exist when you run the command. Flashback can fix logical failures, but not physical failures. As a result, you cannot use the command to recover from disk failures or the accidental deletion of data files.</p>
                  <p><code class="codeph">FLASHBACK DATABASE</code> is usually much faster than a <code class="codeph">RESTORE</code> operation followed by point-in-time recovery because no data files are restored. The time needed to perform <code class="codeph">FLASHBACK DATABASE</code> depends on the number of changes made to the database since the desired flashback time. On the other hand, the time needed to do a traditional point-in-time recovery from restored backups depends on the size of the database.
                  </p>
                  <p>Flashback Database operations also have several uses in a Data Guard environment.</p>
                  <p></p>
                  <div class="infoboxnote" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-926D918C-C68F-4DDA-AA90-0E2BC531004A">
                     <p class="notep1">Note:</p>
                     <p>Flashback operations on a proxy PDB are not supported.</p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-9542FCC1-A4BB-47DA-A324-0CC951B94118">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../sqlrf/FLASHBACK-DATABASE.html#SQLRF01801" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a> for a complete list of command prerequisites and usage notes for <code class="codeph">FLASHBACK DATABASE</code></p>
                        </li>
                        <li>
                           <p><a href="../sbydb/managing-oracle-data-guard-role-transitions.html#SBYDB00717" target="_blank"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to learn about uses of Flashback Database in a Data Guard environment
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-E58D48FE-99B0-4AE0-BFE0-2B9EDEA2ADEE">Prerequisites</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>You can run this command from the RMAN prompt or from within a <code class="codeph"><a href="RUN.html#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B">RUN</a></code> command.
                        </p>
                     </li>
                     <li>
                        <p>RMAN must be connected as <code class="codeph">TARGET</code> to a database, which must be Oracle Database 10<span class="italic">g</span> or later. The target database must be mounted with a current control file, that is, the control file cannot be a backup or re-created.
                        </p>
                     </li>
                     <li>
                        <p>The database must run in <a id="d52514e175" class="indexterm-anchor"></a><code class="codeph">ARCHIVELOG</code> mode.
                        </p>
                     </li>
                     <li>
                        <p>The fast recovery area must be configured to enable flashback logging.</p>
                        <p>Flashback logs are stored as Oracle-managed files in the fast recovery area and cannot be created if no fast recovery area is configured.</p>
                     </li>
                     <li>
                        <p>You must enable flashback logging before the target time for flashback by issuing the SQL statement <code class="codeph">ALTER DATABASE ... FLASHBACK ON</code>.
                        </p>
                        <p>Query <a id="d52514e193" class="indexterm-anchor"></a><a id="d52514e195" class="indexterm-anchor"></a><code class="codeph">V$DATABASE.FLASHBACK_ON</code> to see whether flashback logging has been enabled.
                        </p>
                     </li>
                     <li>
                        <p>You cannot use <code class="codeph">FLASHBACK DATABASE</code> to return to a point in time before the restore or re-creation of a control file. If the database control file is restored from backup or re-created, then all existing flashback log information is discarded.
                        </p>
                     </li>
                     <li>
                        <p>The database must contain no online tablespaces for which flashback functionality was disabled with the SQL statement <code class="codeph">ALTER TABLESPACE ... FLASHBACK OFF</code>.
                        </p>
                     </li>
                  </ul>
                  <p><span class="bold">Prerequisites for Flashback Operations on PDBs</span></p>
                  <p>The following are additional prerequisites for performing flashback operations on a pluggable database (PDB):</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The <code class="codeph">COMPATIBLE</code> initialization parameter must be set to 12.2.0.0 or higher.
                        </p>
                     </li>
                     <li>
                        <p>RMAN must be connected to the root as a common user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.
                        </p>
                     </li>
                     <li>
                        <p>The PDB on which a Flashback Database operation is being performed must be closed. Other PDBs may be open and operational.</p>
                     </li>
                     <li>
                        <p>The root must be open when opening the PDB with resetlogs.</p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-A520F5D4-5956-4AD4-A7A9-4ACA1A3B50A8">Usage Notes</p>
                  <p>A Flashback Database operation applies to the whole database. You cannot flash back individual tablespaces. A Flashback Database operation is similar to a database point-in-time recovery (DBPITR) performed with <code class="codeph"><a href="RECOVER.html#GUID-CA98040F-9865-4F4F-BAF2-91C518612E95">RECOVER</a></code>, but RMAN uses <a id="d52514e251" class="indexterm-anchor"></a><strong class="term">flashback logs</strong> to undo changes to a point before the target time or SCN. RMAN automatically restores from backup any archived redo log files that are needed and recovers the database to make it consistent. RMAN never flashes back data for temporary tablespaces.
                  </p>
                  <p>The earliest SCN that can be used for a Flashback Database operation depends on the setting of the <a id="d52514e258" class="indexterm-anchor"></a><a id="d52514e260" class="indexterm-anchor"></a><code class="codeph">DB_FLASHBACK_RETENTION_TARGET </code>initialization parameter, and on the actual retention of flashback logs permitted by available disk. View the current database SCN in <a id="d52514e267" class="indexterm-anchor"></a><a id="d52514e269" class="indexterm-anchor"></a><code class="codeph">V$DATABASE.CURRENT_SCN</code>.
                  </p>
                  <p>In a multitenant environment, you can perform a flashback database operation either for the whole CDB or for a particular PDB. When using restore points, you can rewind the PDB either to a PDB restore point or CDB restore point.</p>
                  <div class="infoboxnotealso" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-28F09663-1D01-4E46-8387-BE17A0E3DCFF">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>“Overview of Restore Points in a Multitenant Environment” in <a href="../bradv/using-flasback-database-restore-points.html#BRADV-GUID-1150031F-3C15-40C8-BA91-A387F75DC49A" target="_blank"><span><cite>Oracle Database Backup and Recovery User’s Guide</cite></span></a> for information about PDB restore points and CDB restore points
                           </p>
                        </li>
                        <li>
                           <p>”Performing Point-in-Time Recovery of CDBs and PDBs” in <a href="../bradv/rman-performing-flashback-dbpitr.html#BRADV-GUID-26CD7EC8-12AC-4073-BB8D-A68502112E48" target="_blank"><span><cite>Oracle Database Backup and Recovery User’s Guide</cite></span></a> for the steps to rewind a PDB to a specific point in time
                           </p>
                        </li>
                     </ul>
                  </div>
                  <p><span class="bold">Effect of NOLOGGING Operations on Flashback Database</span></p>
                  <p><a id="d52514e302" class="indexterm-anchor"></a><a id="d52514e304" class="indexterm-anchor"></a>When using <code class="codeph">FLASHBACK DATABASE</code> with a target time at which a <code class="codeph">NOLOGGING</code> operation was in progress, block corruption is likely in the database objects and data files affected by the <code class="codeph">NOLOGGING</code> operation. For example, assume that you do a direct-path <code class="codeph">INSERT</code> operation in <code class="codeph">NOLOGGING</code> mode and that the operation runs from 9:00 to 9:15 on April 3. If you later use Flashback Database to return to 09:07 on this date, then the objects and data files updated by the direct-path <code class="codeph">INSERT</code> may be left with block corruption after Flashback Database completes.
                  </p>
                  <p>If possible, avoid using <code class="codeph">FLASHBACK DATABASE</code> with a target time or SCN that coincides with a <code class="codeph">NOLOGGING</code> operation. Also, perform a full or incremental backup of the affected data files immediately after any <code class="codeph">NOLOGGING</code> operation to ensure recoverability to points in time after the operation. If you expect to use <code class="codeph">FLASHBACK DATABASE</code> to return to a point in time during an operation such as a direct-path <code class="codeph">INSERT</code>, then consider performing the operation in <code class="codeph">LOGGING</code> mode.
                  </p>
                  <div class="infoboxnotealso" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-7B9A6F67-2A6D-4226-A0F1-9FDEF895B93C">
                     <p class="notep1">See Also:</p>
                     <p>The discussion of <code class="codeph">logging_clause</code> in <a href="../sqlrf/Common-SQL-DDL-Clauses.html#SQLRF021" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about operations that support <code class="codeph">NOLOGGING</code> mode
                     </p>
                  </div>
                  <p><span class="bold">Effect of Data File Status Changes on Flashback Database</span></p>
                  <p>The <code class="codeph">FLASHBACK DATABASE</code> command does not start modifying the database until it has made sure that it has all the files and resources that it needs. A Flashback Database operation does not fail due to missing data files, redo log files, or flashback logs.
                  </p>
                  <p><a id="d52514e373" class="indexterm-anchor"></a>If a data file has changed status between the current SCN and the target SCN of the flashback, then the <code class="codeph">FLASHBACK DATABASE</code> command behaves differently depending on the nature of the status change. Refer to <a href="FLASHBACK-DATABASE.html#GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__G1040866" title="Describes effects of FLASHBACK DATABASE command">Table 2-8</a> for details.
                  </p>
                  <div class="tblformalwide" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__G1040866">
                     <p class="titleintable">Table 2-8 How FLASHBACK DATABASE Responds to Data File Status Changes</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="How FLASHBACK DATABASE Responds to Data File Status Changes" summary="Describes effects of FLASHBACK DATABASE command" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="28%" id="d52514e396">If this data file operation occurred during the flashback window ...</th>
                              <th align="left" valign="bottom" width="72%" id="d52514e399">Then the FLASHBACK DATABASE command ...</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d52514e404" headers="d52514e396 ">
                                 <p>Added</p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d52514e404 d52514e399 ">
                                 <p>Removes the data file record from the control file.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d52514e411" headers="d52514e396 ">
                                 <p>Dropped</p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d52514e411 d52514e399 ">
                                 <p>Adds the data file to the control file, but marks it as offline and does not flash it back. You can then restore and recover the data file to the same time or SCN.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d52514e418" headers="d52514e396 ">
                                 <p>Renamed</p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d52514e418 d52514e399 ">
                                 <p>Ignores the renaming. The data file retains its current name.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d52514e425" headers="d52514e396 ">
                                 <p>Resized</p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d52514e425 d52514e399 ">
                                 <p>May fail. You can take the data file offline and then rerun the <code class="codeph">FLASHBACK DATABASE</code> command. The data file is not flashed back. You can then restore and recover the data file to the same time or SCN.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d52514e435" headers="d52514e396 ">
                                 <p>Taken offline</p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d52514e435 d52514e399 ">
                                 <p>Ignores the operation. The data file retains its current online status.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d52514e442" headers="d52514e396 ">
                                 <p>Brought online</p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d52514e442 d52514e399 ">
                                 <p>Ignores the operation. The data file retains its current offline status.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d52514e449" headers="d52514e396 ">
                                 <p>Made read-only or read/write</p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d52514e449 d52514e399 ">
                                 <p>Changes the status of the data file in the control file.</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p><span class="bold">Tablespaces with Flashback Logging Disabled</span> 
                  </p>
                  <p>It is possible for the <code class="codeph">ALTER TABLESPACE ... FLASHBACK OFF</code> statement to have been executed for some tablespaces. If <code class="codeph">FLASHBACK DATABASE</code> has insufficient flashback data to rewind a tablespace to the target SCN, then RMAN issues an error and does not modify the database. Whenever <code class="codeph">FLASHBACK DATABASE</code> fails or is interrupted, the database is left mounted.
                  </p>
                  <p>In this scenario, query <a id="d52514e472" class="indexterm-anchor"></a><a id="d52514e474" class="indexterm-anchor"></a><code class="codeph">V$TABLESPACE</code> to determine which tablespaces have flashback logging disabled. You have the following options:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Take the data files in the affected tablespaces offline. Afterwards, run <code class="codeph"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B">RESTORE</a></code> and then <code class="codeph"><a href="RECOVER.html#GUID-CA98040F-9865-4F4F-BAF2-91C518612E95">RECOVER</a></code> to bring these data files to the same point in time as the rest of the database.
                        </p>
                     </li>
                     <li>
                        <p>Drop the affected data files with the <code class="codeph">ALTER DATABASE DATAFILE ... OFFLINE FOR DROP</code> statement. You can then open the database with the <code class="codeph">RESETLOGS</code> option. After the database is open, execute <code class="codeph">DROP TABLESPACE</code> statements for the tablespaces that contain the dropped data files.
                        </p>
                     </li>
                  </ul>
                  <p><span class="bold">State of the Database After Flashback Database</span></p>
                  <p>After running <code class="codeph">FLASHBACK DATABASE</code>, the database may not be left at the SCN most immediately before the target time. Events other than transactions can cause the database SCN to be updated. If you use the <code class="codeph">FLASHBACK DATABASE TO</code> form of the command, and if a transaction is associated with the target SCN, then after the flashback the database includes all changes up to and including this transaction. Otherwise, all changes up to but <span class="italic">not</span> including this transaction are included in the data files, whether you use the <code class="codeph">FLASHBACK DATABASE TO</code> or <code class="codeph">FLASHBACK DATABASE TO BEFORE</code> form of the command. Changes after the specified target SCN are never applied because of <code class="codeph">FLASHBACK DATABASE</code>.
                  </p>
                  <p>After <code class="codeph">FLASHBACK DATABASE</code> completes, you may want to open the database read-only and run queries to ensure that you achieved the intended result. If you are not satisfied, then you can use <code class="codeph"><a href="RECOVER.html#GUID-CA98040F-9865-4F4F-BAF2-91C518612E95">RECOVER</a></code> <code class="codeph">DATABASE</code> to recover the database to its state when you started the flashback. You can then rerun <code class="codeph">FLASHBACK DATABASE</code>. 
                  </p>
                  <p>If you are satisfied with the results of the flashback, then you can <code class="codeph">OPEN RESETLOGS</code> to abandon all changes after the target time. Alternatively, you can use <a id="d52514e552" class="indexterm-anchor"></a>Data Pump to export lost data, use <code class="codeph">RECOVER DATABASE</code> to return the database to its state before the flashback operation, and then use Data Pump to reimport the lost data.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-2EE61A50-C56B-40A7-9E3B-3BD8914768A2">Syntax</p>
                  <p><span class="bold"><span class="italic">flashback</span>::=</span></p>
                  <div class="figure" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-173FCE36-660B-43FF-8BBE-85140AF93006"><img src="img/flashback.gif" alt="Description of flashback.eps follows" title="Description of flashback.eps follows" longdesc="img_text/flashback.html"><br><a href="img_text/flashback.html">Description of the illustration flashback.eps</a></div>
                  <!-- class="figure" -->
                  <p><span class="bold"><span class="italic">flashbackObject::=</span></span></p>
                  <div class="figure" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-0CC7F15E-83F1-4EFE-89C7-4A41351D72EA"><img src="img/flashbackobject.gif" alt="Description of flashbackobject.eps follows" title="Description of flashbackobject.eps follows" longdesc="img_text/flashbackobject.html"><br><a href="img_text/flashbackobject.html">Description of the illustration flashbackobject.eps</a></div>
                  <!-- class="figure" -->
                  <p>(<span class="italic"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC__BABDEJAC">deviceSpecifier::=</a></span>)
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-3296CC02-8186-406C-8D4D-F6083A26193D">Semantics</p>
                  <p><span class="bold"><span class="italic">flashback::=</span></span></p>
                  <div class="tblformalwide" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-B7C2B514-7EB1-4A8B-A31A-E5F2CC85EAF3">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" summary="Describes FLASHBACK DATABASE command parameters" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d52514e597">Syntax Element</th>
                              <th align="left" valign="bottom" width="71%" id="d52514e600">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e605" headers="d52514e597 ">
                                 <p><code class="codeph">DEVICE&nbsp;TYPE</code> <span class="italic"><code class="codeph"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d52514e605 d52514e600 ">
                                 <p>Allocates automatic channels for the specified device type only. For example, if you configure automatic disk and tape channels, and issue <code class="codeph">FLASHBACK ... DEVICE TYPE DISK</code>, then RMAN allocates only disk channels. RMAN may need to restore redo logs from backup during the flashback database process. Changes between the last flashback log and the target time must be re-created based on the archived redo log. If no automatic channels are allocated for tape and a needed redo log is on tape, then the <code class="codeph">FLASHBACK DATABASE</code> operation fails.
                                 </p>
                                 <p><span class="bold">See Also:</span> <span class="italic"><code class="codeph"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></code></span></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p><span class="bold"><span class="italic">flashbackObject::=</span></span></p>
                  <div class="tblformalwide" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-446C244B-D830-4839-82CA-9E4B4EC1E63B">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" summary="Describes the flashbackObject clause parameters" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d52514e645">Syntax Element</th>
                              <th align="left" valign="bottom" width="71%" id="d52514e648">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e653" headers="d52514e645 ">
                                 <p><code class="codeph">DATABASE</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d52514e653 d52514e648 ">
                                 <p>Rewinds the entire database.</p>
                                 <p>For CDBs, rewinds the entire CDB including all its PDBs.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e663" headers="d52514e645 ">
                                 <p><code class="codeph">PLUGGABLE DATABASE</code> <span class="italic">pdb_name</span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d52514e663 d52514e648 ">
                                 <p></p>
                                 <p>Rewinds the specified PDB. All other PDBs can be open and operational, but the specified PDB must be closed.</p>
                                 <p>When the CDB uses shared undo, an auxiliary destination is used to store temporary files used during the flashback operation. The default auxiliary destination is the fast recovery area. You can use the <code class="codeph">AUXILIARY DESTINATION</code> clause to explicitly specify an alternate auxiliary destination that is not the fast recovery area. 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e680" headers="d52514e645 ">
                                 <p><code class="codeph">TO&nbsp;BEFORE&nbsp;SCN</code> <span class="italic"><code class="codeph">integer</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d52514e680 d52514e648 ">
                                 <p>Returns the database to its state just before the specified SCN. Any changes at an SCN lower than that specified are applied, but if there is a change associated with the specified SCN it is not applied. By default, the provided SCN resolves to the current or ancestor incarnation. You can override the default by using the <code class="codeph"><a href="RESET-DATABASE.html#GUID-C0C00F35-F21F-4657-AE9B-652C4DCE5817">RESET DATABASE</a></code> <code class="codeph">INCARNATION</code> command.
                                 </p>
                                 <p>Query <code class="codeph">OLDEST_FLASHBACK_SCN</code> in<a id="d52514e704" class="indexterm-anchor"></a><a id="d52514e706" class="indexterm-anchor"></a> <code class="codeph">V$FLASHBACK_DATABASE_LOG</code> to see the approximate lowest SCN to which you can flash back.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e715" headers="d52514e645 ">
                                 <p><code class="codeph">TO&nbsp;BEFORE&nbsp;SEQUENCE</code> <span class="italic"><code class="codeph">integer</code></span> <code class="codeph">[THREAD&nbsp;</code><span class="italic"><code class="codeph">integer</code></span>]
                                 </p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d52514e715 d52514e648 ">
                                 <p>Specifies a redo log sequence number and thread as an upper limit. RMAN applies changes up to (but not including) the last change in the log with the specified sequence and thread number.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e734" headers="d52514e645 ">
                                 <p><code class="codeph">TO&nbsp;BEFORE&nbsp;RESETLOGS</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d52514e734 d52514e648 ">
                                 <p>Returns the database to its state including all changes up to the SCN of the most recent <code class="codeph">OPEN RESETLOGS</code>.
                                 </p>
                                 <p><span class="bold">Note:</span> <code class="codeph">FLASHBACK DATABASE</code> can only return the database to a point before the most recent <code class="codeph">OPEN RESETLOGS</code> operation if your database has been upgraded to Oracle Database 10<span class="italic">g</span> Release 2 or later.
                                 </p>
                                 <p>For PDBs, the Flashback Operation must return the PDB to its state including all changes up to the most recent <code class="codeph">OPEN RESETLOGS</code> operation on the CDB or the most recent <code class="codeph">OPEN RESETLOGS</code> operation on the PDB, whichever of the two is more recent.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e766" headers="d52514e645 "><code class="codeph">TO&nbsp;BEFORE&nbsp;TIME</code> <code class="codeph">'</code><span class="italic"><code class="codeph">date_string</code></span><code class="codeph">'</code></td>
                              <td align="left" valign="top" width="71%" headers="d52514e766 d52514e648 ">
                                 <p>Returns the database to its state including all changes up to but not including changes at the specified time.</p>
                                 <p>Query <code class="codeph">OLDEST_FLASHBACK_TIME</code> in <code class="codeph">V$FLASHBACK_DATABASE_LOG</code> to see the approximate lowest time to which you can flash back.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e789" headers="d52514e645 ">
                                 <p><code class="codeph">TO&nbsp;SCN</code> <span class="italic"><code class="codeph">integer</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d52514e789 d52514e648 ">
                                 <p>Returns the database to the point up to (and including) the specified SCN. By default, the provided SCN resolves to the current or ancestor incarnation. You can override the default by using the RMAN <code class="codeph"><a href="RESET-DATABASE.html#GUID-C0C00F35-F21F-4657-AE9B-652C4DCE5817">RESET DATABASE</a></code> command to set the recovery target incarnation.
                                 </p>
                                 <p>Query <code class="codeph">OLDEST_FLASHBACK_SCN</code> in <code class="codeph">V$FLASHBACK_DATABASE_LOG</code> to see the approximate lowest SCN to which you can flash back.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e814" headers="d52514e645 ">
                                 <p><code class="codeph">TO SEQUENCE</code>&nbsp;<span class="italic"><code class="codeph">integer</code></span> <code class="codeph">THREAD</code>&nbsp;<span class="italic"><code class="codeph">integer</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d52514e814 d52514e648 ">
                                 <p>Specifies a redo log sequence number and thread as an upper limit. RMAN applies changes up to (and including) the last change in the log with the specified sequence and thread number.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e833" headers="d52514e645 "><code class="codeph">TO&nbsp;RESTORE&nbsp;POINT</code> <span class="italic"><code class="codeph">restore_point_name</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d52514e833 d52514e648 ">
                                 <p>Returns the database to the SCN associated with the specified restore point. This can be an ordinary restore point or a guaranteed restore point.</p>
                                 <p></p>
                                 <p>For CDBs, you must specify a CDB restore point. The entire CDB is returned to the SCN associated with the specified CDB restore point.</p>
                                 <p>For PDBs, you can specify either a CDB restore point, PDB restore point, or a clean PDB restore point. RMAN returns the PDB to the SCN associated with the specified restore point. The remaining PDBs in the CDB are not impacted by a flashback operation on a particular PDB.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e849" headers="d52514e645 ">
                                 <p><code class="codeph">TO&nbsp;TIME</code> <code class="codeph">'</code><span class="italic"><code class="codeph">date_string</code></span><code class="codeph">'</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d52514e849 d52514e648 ">
                                 <p>Returns the database to its state at the specified time. You can use any SQL <code class="codeph">DATE</code> expressions to convert the time to the current format, for example, <code class="codeph">FLASHBACK DATABASE TO TIME 'SYSDATE-7'</code>.
                                 </p>
                                 <p>Query <code class="codeph">OLDEST_FLASHBACK_TIME</code> in <code class="codeph">V$FLASHBACK_DATABASE_LOG</code> to see the approximate lowest time to which you can flash back.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d52514e879" headers="d52514e645 "><code class="codeph">AUXILIARY DESTINATION</code> <span class="italic"><code class="codeph">’location'</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d52514e879 d52514e648 ">Specifies the location where temporary database files used during flashback database operations in a multitenant environment are stored. When a CDB uses shared undo, you must specify an auxiliary destination. For CDBs that use local undo, specifying an auxiliary destination is optional.</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-89CCFF02-2F27-47B7-957D-037F359E019D">Examples</p>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-B06750EF-60BF-4F29-B4E9-4A0CF78734B8">
                  <p class="titleinexample">Example 2-99 FLASHBACK DATABASE to a Specific SCN</p>
                  <p>Assume that you inserted corrupted rows in many tables at 5:00 p.m. on February 14. You connect SQL*Plus to the database and query the earliest SCN in the flashback window:</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT OLDEST_FLASHBACK_SCN, OLDEST_FLASHBACK_TIME
  2  FROM   V$FLASHBACK_DATABASE_LOG;

OLDEST_FLASHBACK_SCN OLDEST_FLASHBACK
-------------------- ----------------
              411010 2013/02/14 16:49
</pre><p>You then open a new terminal, start the RMAN client, and connect to the target database and recovery catalog. You enter RMAN commands as follows (sample output for the <code class="codeph">FLASHBACK DATABASE</code> is included):
                  </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; SHUTDOWN IMMEDIATE
RMAN&gt; STARTUP MOUNT
RMAN&gt; FLASHBACK DATABASE TO SCN 411010;
 
Starting flashback at 15-FEB-13
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=104 device type=DISK
 
 
starting media recovery
media recovery complete, elapsed time: 00:00:07
 
Finished flashback at 15-FEB-13
 
RMAN&gt; ALTER DATABASE OPEN RESETLOGS;</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-2AF2053C-B92D-4BFE-855F-CF9537B93C6B">
                  <p class="titleinexample">Example 2-100 FLASHBACK DATABASE to a Restore Point</p>
                  <p>Assume that you are preparing to load a massive number of updates to the database. You create a guaranteed restore point before the performing the updates:</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE RESTORE POINT before_update GUARANTEE FLASHBACK DATABASE;
</pre><p>The bulk update fails, leaving the database with extensive corrupted data. You start an RMAN session, connect to the target database and recovery catalog, and list the guaranteed restore points:</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; LIST RESTORE POINT ALL;

SCN              RSP Time  Type       Time      Name
---------------- --------- ---------- --------- ----
412742                     GUARANTEED 15-FEB-13 BEFORE_UPDATE
</pre><p>You mount the database, flash back the database to the restore point (sample output included), and then open the database with the <code class="codeph">RESETLOGS</code> option:
                  </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; SHUTDOWN IMMEDIATE
RMAN&gt; STARTUP MOUNT
RMAN&gt; FLASHBACK DATABASE TO RESTORE POINT 'BEFORE_UPDATE';
 
Starting flashback at 15-FEB-13
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=104 device type=DISK
 
 
starting media recovery
 
archived log for thread 1 with sequence 34 is already on disk as file /disk2/oracle/oradata/prod/arch/archive1_34_614598462.dbf
media recovery complete, elapsed time: 00:00:01
Finished flashback at 15-FEB-13
 
RMAN&gt; ALTER DATABASE OPEN RESETLOGS;</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-584AC79A-40C5-45CA-8C63-DED3BE3A4511__GUID-8500E0E0-C41D-4AFF-A2CF-91A179142AC5">
                  <p class="titleinexample">Example 2-101 FLASHBACK DATABASE for a PDB to a Guaranteed PDB Restore Point</p>
                  <p>Assume that you need to upgrade an application that performs DML operations on the tables in the PDB <code class="codeph">hr_pdb</code>. Before you perform the application upgrade, you create a guaranteed PDB restore point in <code class="codeph">hr_pdb</code> when connected to the PDB (the PDB is mounted):
                  </p><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE RESTORE POINT hr_pdb_grp_before_upgrade GUARENTEE FLASHBACK DATABASE;</pre><p>The application upgrade fails leaving the PDB with corrupted data. You want to rewind the PDB to its state before the upgrade failure. You start SQL*Plus, connect to the CDB as a common user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege, and then run the following command to view all the restore points:
                  </p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT name, guarantee_flashback_database, pdb_restore_point, con_id 
     FROM v$restore_point;

NAME                          GUARANTEE_FLASHBACK_DATABASE PDB_RESTORE_POINT  CON_ID
----------------------------- ---------------------------  -----------------  ------
CDB_GRP_BEFORE_PATCH                 YES                   		NO              0
HR_PDB_GRP_BEFORE_UPGRADE            YES                   		YES             1</pre><p>The output indicates that the restore point <code class="codeph">HR_PDB_GRP_BEFORE_UPGRADE</code> is a guaranteed PDB restore point. You can reverse the effects of data corruption by rewinding <code class="codeph">hr_pdb</code> to this guaranteed PDB restore point. To perform a flashback operation for <code class="codeph">hr_pdb</code>, this PDB must be closed. All other PDBs in the CDB can remain open and operational.
                  </p>
                  <p>You place the CDB in mount mode, flash back the PDB to the guaranteed PDB restore point, and then open the PDB with resetlogs. In this example, the CDB uses shared undo and, therefore, an auxiliary instance is used to store temporary files during the flashback operation.</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; SHUTDOWN IMMEDIATE;
RMAN&gt; STARTUP MOUNT;
RMAN&gt; FLASHBACK PLUGGABLE DATABASE hr_pdb TO RESTORE POINT hr_pdb_grp_before_upgrade 
      AUXILIARY DESTINATION '/temp/aux_dest';
RMAN&gt; ALTER PLUGGABLE DATABASE hr_pdb OPEN RESETLOGS;</pre></div>
               <!-- class="example" -->
            </div>
         </div>
      </article>
   </body>
</html>