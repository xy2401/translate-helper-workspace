<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">
      <meta name="description" content="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">
      <title>Raster Algebra and Analytics</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="GeoRaster Developer's Guide ">
      <meta property="og:description" content="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="GeoRaster Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="spatial-and-graph-georaster-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-14T11:48:45-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E94793-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="georaster-data-manipulation.html" title="Previous" type="text/html">
      <link rel="next" href="image-processing-virtual-mosaic.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Spatial and Graph GeoRaster Developer's Guide">
    <meta name="dcterms.isVersionOf" content="GEORS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="georaster-data-manipulation.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="image-processing-virtual-mosaic.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">GeoRaster Developer's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Raster Algebra and Analytics</li>
            </ol>
            <a id="GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" name="GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF"></a><a id="GEORS1215"></a>
            
            <h2 id="GEORS-GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" class="sect2"><span class="enumeration_chapter">5 </span>Raster Algebra and Analytics
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling. </p>
               <p>It contains the following major sections.</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-A6F087DC-1E7E-4426-B778-8554A25B3494">Raster Algebra Language</a><br>Raster algebra is commonly used in raster data analysis and GIS modeling. In GeoRaster, raster algebra is supported by the GeoRaster raster algebra language.
                  </li>
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9">Cell Value-Based Conditional Queries</a><br>Using cell-based conditional queries, you can generate a new GeoRaster object based on a specified condition.
                  </li>
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F">Cell Value-Based Conditional Updates (Edits)</a><br>You can update raster cell values based on conditions.
                  </li>
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-C6250398-2364-4FEE-B06E-644B5F1251AB">Mathematical Operations</a><br>A major use of raster algebra is to apply mathematical models to raster layers from different sources.
                  </li>
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E">Classification Operations</a><br>Classification (segmentation) operations can be applied on source GeoRaster objects to generate new objects.
                  </li>
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-B1A7F654-E438-48F1-9EB6-55268FA260B1">Statistical Operations</a><br>To apply statistical operations on one or more layers, which are from one or more GeoRaster objects, the following types of operations are available.
                  </li>
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-022F5214-9D1E-44B4-8487-967C93CC2954">Logical Operations</a><br>A major use of raster algebra is to apply logical models to raster layers from different sources; that is, you can apply logical operations on one or more layers, from one or more GeoRaster objects, to generate a new GeoRaster object.
                  </li>
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B">Raster Data Scaling and Offsetting</a><br>You can perform raster data scaling and offsetting operations.
                  </li>
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27">Raster Data Casting</a><br>Raster data casting maps cell values from one data type to another.
                  </li>
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166">Cartographic Modeling</a><br>Raster algebra is widely used in cartographic modeling and is considered an essential component of GIS systems. Using the PL/SQL and the raster algebra expressions and functions, you can conduct cartographic modeling over a large number of rasters and images of virtually unlimited size.
                  </li>
                  <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-90AF506E-C29A-464F-95F8-2923E79AFE9B">Terrain Modeling and Analysis</a><br>You can use the data from input GeoRaster objects to perform terrain modeling and analysis.
                  </li>
               </ul>
            </div>
            <a id="GEORS1216"></a><div class="props_rev_3"><a id="GUID-A6F087DC-1E7E-4426-B778-8554A25B3494" name="GUID-A6F087DC-1E7E-4426-B778-8554A25B3494"></a><h3 id="GEORS-GUID-A6F087DC-1E7E-4426-B778-8554A25B3494" class="sect3"><span class="enumeration_section">5.1 </span>Raster Algebra Language
               </h3>
               <div>
                  <p>Raster algebra is commonly used in raster data analysis and GIS modeling. In GeoRaster, raster algebra is supported by the GeoRaster raster algebra language.</p>
                  <p>The GeoRaster raster algebra language is an extension to the Oracle PL/SQL language. PL/SQL provides declarations of variables and constants, general mathematical expressions, basic functions, statements, and programming capabilities. GeoRaster provides a raster algebra expression language and a set of raster algebra functions for raster layer operations. The raster algebra expression language includes general arithmetic, casting, logical, and relational operators and allows any combination of them. The raster algebra functions enable the usage of the expressions and support cell value-based conditional queries, mathematical modeling, classify operations, and cell value-based updates or edits over one or many raster layers from one or many GeoRaster objects.</p>
                  <p>This combination of the PL/SQL language and GeoRaster algebraic expressions and functions provides an easy-to-use, powerful way to define raster analyses as algebraic expressions, so that users can easily apply algebraic functions on raster data to derive new results. For example, a simple raster operation can use two or more raster layers with the same dimension sizes to produce a new raster layer by using algebraic operations (addition, subtraction, and so on), or a sophisticated raster operation to generate a Normalized Difference Vegetation Index (NDVI) from multiple bands of satellite imagery.</p>
                  <p>GeoRaster supports raster algebra local operations, so the raster algebra operations work on individual raster cells, or pixels.</p>
                  <p>The following is the GeoRaster raster algebra expression language definition:</p><pre class="oac_no_warn" dir="ltr">&lt;arithmeticExpr&gt; ::=
                &lt;unaryArithmeticExpr&gt;
              | &lt;binaryArithmeticExpr&gt;
              | &lt;functionalArithmeticExpr&gt;
              | &lt;conditionalExpr&gt;
              | &lt;castingExpr&gt;
              | &lt;booleanExpr&gt;
              | &lt;constantNumber&gt;
              | &lt;identifier&gt;
              | ( &lt;arithmeticExpr&gt; )

&lt;unaryArithmeticExpr&gt; ::=
                ( &lt;unaryArithmeticOp&gt; &lt;arithmeticExpr&gt; ) 

&lt;unaryArithmeticOp&gt; ::=                  
                +
              | -

&lt;binaryArithmeticExpr&gt; ::=
                &lt;arithmeticExpr&gt; &lt;binaryArithmeticOp&gt; &lt;arithmeticExpr&gt; 

&lt;binaryArithmeticOp&gt; ::=
                +
              | -
              | *
              | /
              | %

&lt;functionalArithmeticExpr&gt; ::=
                &lt;statisticalFunction&gt; ( )
              | &lt;numericFunction_with_1_param&gt; ( &lt;arithmeticExpr&gt; )
              | &lt;numericFunction_with_2_param&gt; ( &lt;arithmeticExpr&gt; , &lt;arithmeticExpr&gt; )
              | &lt;numericFunction_with_3_param&gt; ( &lt;arithmeticExpr&gt; , &lt;arithmeticExpr&gt; , &lt;arithmeticExpr&gt; )

&lt;statisticalFunction&gt; ::=
                min
              | max
              | mean
              | median
              | std
              | minority
              | majority
              | sum
              | variety

&lt;numericFunction_with_1_param&gt; ::=
                abs
              | sqrt
              | exp
              | exp2
              | exp10
              | log
              | ln
              | log2
              | sin
              | cos
              | tan
              | sinh
              | cosh
              | tanh
              | arcsin
              | arccos
              | arctan
              | arcsinh
              | arccosh
              | arctanh
              | ceil
              | floor
              | factorial

&lt;numericFunction_with_2_param&gt; ::=
                power
              | max2
              | min2

&lt;numericFunction_with_3_param&gt; ::=
                max3
              | min3

&lt;conditionalExpr&gt; ::=
          &lt;conditionalFunction&gt; ( &lt;booleanExpr&gt; , &lt;arithmeticExpr&gt; , &lt;arithmeticExpr&gt; )

&lt;conditionalFunction&gt; ::=
                condition
 
&lt;castingExpr&gt; ::=
                &lt;castingFunction&gt; ( &lt;arithmeticExpr&gt; )

&lt;castingFunction&gt; ::=  
                castint
              | castonebit               
              | casttwobit
              | castfourbit
              | casteightbit
              | castBoolean

&lt;booleanExpr&gt; ::=
                &lt;unaryBooleanExpr&gt;
              | &lt;binaryBooleanExpr&gt;
              | ( &lt;booleanExpr&gt; )

&lt;unaryBooleanExpr&gt; ::=
                &lt;unaryBooleanOp&gt; &lt;booleanExpr&gt;

&lt;unaryBooleanOp&gt; ::=
                !

&lt;binaryBooleanExpr&gt; ::=
                &lt;booleanExpr&gt; &lt;binaryBooleanOp&gt; &lt;booleanExpr&gt;
              | &lt;arithmeticExpr&gt; &lt;comparisonOp&gt; &lt;arithmeticExpr&gt;

&lt;binaryBooleanOp&gt; ::=
                &amp;
              | |
              | ^   

&lt;comparisonOp&gt; ::=
                =
              | &lt;
              | &gt;
              | &gt;=
              | &lt;=
              | !=
                   
&lt;constantNumber&gt; ::=
                &lt;double number&gt;

&lt;identifier&gt; ::=
                { &lt;ID&gt; , &lt;band&gt; }
              | { &lt;band&gt; }

&lt;ID&gt; ::=
                &lt;integer number&gt;

&lt;band&gt; ::=
                &lt;integer number&gt;</pre><p>The precedence of the algebraic operators (+, -, *, /, and so on) in the expression language complies with general conventions. However, in any case where the expression might be misinterpreted, you should use parentheses to clarify which interpretation is intended.</p>
                  <p>The <code class="codeph">booleanExpr</code> can be used as <code class="codeph">arithmeticExpr</code>, as defined in the GeoRaster raster algebra expression language. In this case, the <code class="codeph">TRUE</code> and <code class="codeph">FALSE</code> evaluation results of <code class="codeph">booleanExpr</code> are cast to numeric values 1 and 0, respectively.
                  </p>
                  <p>The <code class="codeph">identifier</code> in the expression refers to a raster layer of a GeoRaster object. It is either a single <code class="codeph">band</code> number if there is only one GeoRaster object involved, or a pair of (<code class="codeph">ID</code>, <code class="codeph">band</code>) where <code class="codeph">ID</code> refers to one of GeoRaster objects in the expression and band refers to a specific layer of that GeoRaster object. The <code class="codeph">band</code> number in this language refers to the ordinate number of a layer along the band dimension in the cell space, so it always starts with 0 (zero). The GeoRaster ID number always starts with 0 (zero).
                  </p>
                  <p>The following procedures provide the main support for raster algebra operations:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="sdo-geor-ra-ref.html#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a> takes <code class="codeph">arithmeticExpr</code> to perform mathematical operations or modeling, <code class="codeph">conditionalExpr</code> and <code class="codeph">booleanExpr</code> to perform logical operations, and <code class="codeph">statisticalFunction</code> expression to perform statistical analysis.
                        </p>
                     </li>
                     <li>
                        <p><a href="sdo-geor-ra-ref.html#GUID-67FDA0FA-D055-4821-964F-600660861A72">SDO_GEOR_RA.findCells</a> searches/masks cells based on a <code class="codeph">booleanExpr</code> condition.
                        </p>
                     </li>
                     <li>
                        <p><a href="sdo-geor-ra-ref.html#GUID-D9DA6608-7D97-4428-B1B2-002C371846E9">SDO_GEOR_RA.classify</a> applies <code class="codeph">arithmeticExpr</code> to cells and then segments the raster.
                        </p>
                     </li>
                     <li>
                        <p><a href="sdo-geor-ra-ref.html#GUID-7F1A50AC-9595-4AC3-83E3-D7233C9FAF2E">SDO_GEOR_RA.rasterUpdate</a> updates cell values of a raster based on different <code class="codeph">booleanExpr</code> conditions.
                        </p>
                     </li>
                     <li>
                        <p><a href="sdo-geor-ra-ref.html#GUID-B879FE32-88C6-4C85-95B8-47B7EDEE8C02">SDO_GEOR_RA.diff</a> and <a href="sdo-geor-ra-ref.html#GUID-D6105A06-3CC0-42C9-AC57-81333017C3A4">SDO_GEOR_RA.over</a> perform logical operations without using expressions.
                        </p>
                     </li>
                     <li>
                        <p><a href="sdo-geor-ra-ref.html#GUID-90E78211-B677-4D22-8CF8-2E7BB7740F39">SDO_GEOR_RA.stack</a> and many other subprograms perform statistical analysis or generate statistics.
                        </p>
                     </li>
                  </ul>
                  <p>These raster algebra functions take many layers from one or many GeoRaster objects, apply <code class="codeph">booleanExpr</code> and/or <code class="codeph">arithmeticExpr</code> expressions over those layers, do the specific algebraic computation or modeling, and output a new GeoRaster object. The expressions can be defined in any way based on the syntax described earlier in this section.
                  </p>
                  <p>All raster algebra functions require that the raster layers overlap each other and have the same dimension sizes and resolution if they are georeferenced, or have the same dimension sizes if they are not georeferenced. Before you apply raster algebra operations over two or more GeoRaster objects, you can use the <a href="sdo-geor-ra-ref.html#GUID-B64A8557-B92D-4588-812D-2F767338EA68">SDO_GEOR_RA.isOverlap</a> function to determine if the GeoRaster objects are of the same size and cover the same ground area.
                  </p>
                  <p>Raster and image databases are generally very large. Querying and manipulating such databases are computationally intensive operations. To improve performance, all GeoRaster raster algebra functions are parallelized. You should always consider applying parallel processing when using multi-CPU or multicore servers.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE">Examples of Raster Algebra Expressions</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               <a id="GEORS1248"></a><a id="GEORS1249"></a><a id="GEORS1250"></a><a id="GEORS1247"></a><div class="props_rev_3"><a id="GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE" name="GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE"></a><h4 id="GEORS-GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE" class="sect4"><span class="enumeration_section">5.1.1 </span>Examples of Raster Algebra Expressions
                  </h4>
                  <div>
                     <p>This section contains examples showing how to define raster algebra expressions.</p>
                     <div class="example" id="GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABCFFDB">
                        <p class="titleinexample">Example 5-1 Finding Pixels Based on a Comparison (&gt;)</p>
                        <p><a href="raster-algebra-and-analytics.html#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABCFFDB">Example 5-1</a> finds all pixels that meet the condition defined by algebra expression <code class="codeph">'{1}&gt;200'</code> , because there is only one GeoRaster object involved in the procedure, so <code class="codeph">{1}</code> refers to the cell value of second layer (<code class="codeph">{0}</code> would be for the first layer), and <code class="codeph">'{1}&gt;200'</code> means any pixels whose second layer value is greater than 200. The example assumes that the source GeoRaster object has at least two layers.
                        </p><pre class="oac_no_warn" dir="ltr">DECLARE 
  geor       MDSYS.SDO_GEORASTER;
  geor1      MDSYS.SDO_GEORASTER;
BEGIN
  select georaster into geor from georaster_table where georid = 1;
  select georaster into geor1 from georaster_table where georid = 5 for update;
  sdo_geor_ra.findcells(geor, '{1}&gt;200','blocking=optimalpadding, blocking=true, blocksize=(512,512,3)',geor1);
  update georaster_table set georaster = geor1 where georid = 5;
  commit;
END;
/
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABHIBDJ">
                        <p class="titleinexample">Example 5-2 Generating a GeoRaster Object Based on an Expressions Array</p>
                        <p><a href="raster-algebra-and-analytics.html#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABHIBDJ">Example 5-2</a> generates a new GeoRaster object <code class="codeph">geor2</code> from two input GeoRaster objects <code class="codeph">geor</code> and <code class="codeph">geor1</code> based on the algebra expressions array <code class="codeph">SDO_STRING2_ARRAY('{0,0}-0.5*{1,0}','{0,1}-0.5*{1,1}','{0,2}-0.5*{1,2}')</code>. The example assumes that both of the source GeoRaster objects are images with three bands.
                        </p><pre class="oac_no_warn" dir="ltr">DECLARE
  geor       MDSYS.SDO_GEORASTER;
  geor1      MDSYS.SDO_GEORASTER;
  geor2      MDSYS.SDO_GEORASTER;
  geo_array  MDSYS.SDO_GEORASTER_ARRAY;
BEGIN
  select georaster into geor from georaster_table where georid = 1;
  select georaster into geor1 from georaster_table where georid = 2;
  insert into georaster_table values (17, sdo_geor.init('rdt_1', 17)) returning georaster into geor2;
  geo_array:=MDSYS.SDO_GEORASTER_ARRAY(geor,geor1);
  sdo_geor_ra.rasterMathOp(geo_array,<span class="bold">SDO_STRING2_ARRAY('{0,0}-0.5*{1,0}','{0,1}-0.5*{1,1}','{0,2}-0.5*{1,2}')</span>,null,geor2);
  update georaster_table set georaster = geor2 where georid = 17;
  commit;
END;
/
</pre><p>In the algebra expressions array in <a href="raster-algebra-and-analytics.html#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABHIBDJ">Example 5-2</a>:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">{0,0}</code> refers to the cell value of band 0 of the first input GeoRaster object <code class="codeph">geor</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">{0,1}</code> refers to the cell value of band 1 of the first input GeoRaster object <code class="codeph">geor</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">{0,2}</code> refers to the cell value of band 2 of the first input GeoRaster object <code class="codeph">geor</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">{1,0}</code> refers to the cell value of band 0 of the second input GeoRaster object <code class="codeph">geor1</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">{1,1}</code> refers to the cell value of band 1 of the second input GeoRaster object <code class="codeph">geor1</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">{1,2}</code> refers to the cell value of band 2 of the second input GeoRaster object <code class="codeph">geor1</code>.
                              </p>
                           </li>
                        </ul>
                        <p>In <a href="raster-algebra-and-analytics.html#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABHIBDJ">Example 5-2</a>, then, the target GeoRaster object <code class="codeph">geor2</code> will have three bands, and:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The cell value of band 0 of target GeoRaster object <code class="codeph">geor2</code> is: <code class="codeph">{0,0}-0.5*{1,0}</code></p>
                           </li>
                           <li>
                              <p>The cell value of band 1 of target GeoRaster object <code class="codeph">geor2</code> is: <code class="codeph">{0,1}-0.5*{1,1}</code></p>
                           </li>
                           <li>
                              <p>The cell value of band 2 of target GeoRaster object <code class="codeph">geor2</code> is: <code class="codeph">{0,2}-0.5*{1,2}</code></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABEFCFH">
                        <p class="titleinexample">Example 5-3 Updating a GeoRaster Object Based on an Expressions Array</p>
                        <p><a href="raster-algebra-and-analytics.html#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABEFCFH">Example 5-3</a> updates cell values of the input GeoRaster object based on the algebra expression array <code class="codeph">SDO_STRING2_ARRAY('(abs({0}-{1})=48)&amp;({2}-{1}=-101)','2*{0}-{1}/3=108')</code>. The example assumes that the source GeoRaster object has three layers.
                        </p><pre class="oac_no_warn" dir="ltr">DECLARE
  geor       MDSYS.SDO_GEORASTER;
  geor1      MDSYS.SDO_GEORASTER;
begin
  select georaster into geor from georaster_table where georid = 1;
  sdo_geor_ra.rasterUpdate(geor,0,<span class="bold">SDO_STRING2_ARRAY('(abs({0}-{1})=48)&amp;({2}-{1}=-101)','2*{0}-{1}/3=108'),SDO_STRING2_ARRAYSET(SDO_STRING2_ARRAY('123','54','89'),SDO_STRING2_ARRAY('98','56','123'))</span>);
END;
/
</pre><p>In <a href="raster-algebra-and-analytics.html#GUID-E2DA56C4-CCC3-48FD-87FE-98B6966DE3BE__BABEFCFH">Example 5-3</a>, for each pixel:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If <code class="codeph">(abs({0}-{1})=48)&amp;({2}-{1}=-101)</code> is true, then the cell values of the three layers will be updated to <code class="codeph">('123','54','89')</code>.
                              </p>
                           </li>
                           <li>
                              <p>If <code class="codeph">2*{0}-{1}/3=108</code> is true, then the cell values of the three layers will be updated to <code class="codeph">('98','56','123')</code>.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-A6F087DC-1E7E-4426-B778-8554A25B3494" title="Raster algebra is commonly used in raster data analysis and GIS modeling. In GeoRaster, raster algebra is supported by the GeoRaster raster algebra language.">Raster Algebra Language</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="GEORS1252"></a><a id="GEORS1253"></a><a id="GEORS1254"></a><a id="GEORS1251"></a><div class="props_rev_3"><a id="GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9" name="GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9"></a><h3 id="GEORS-GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9" class="sect3"><span class="enumeration_section">5.2 </span>Cell Value-Based Conditional Queries
               </h3>
               <div>
                  <p>Using cell-based conditional queries, you can generate a new GeoRaster object based on a specified condition.</p>
                  <p>In addition to their use in space-based queries on rasters (such as with <a href="SDO_GEOR-reference.html#GUID-CC66F0CA-96A9-4C4F-AB94-AEB5FE53C83D">SDO_GEOR.getRasterSubset</a>), cell value-based queries are particularly useful in analytics and application modeling. To perform cell value based conditional queries and generate a new GeoRaster object based on the specified condition, you can use the <a href="sdo-geor-ra-ref.html#GUID-67FDA0FA-D055-4821-964F-600660861A72">SDO_GEOR_RA.findCells</a> procedure and specify an appropriate <code class="codeph">condition</code> parameter.
                  </p>
                  <p>The <code class="codeph">condition</code> parameter must specify a valid <code class="codeph">booleanExpr</code> value (explained in <a href="raster-algebra-and-analytics.html#GUID-A6F087DC-1E7E-4426-B778-8554A25B3494" title="Raster algebra is commonly used in raster data analysis and GIS modeling. In GeoRaster, raster algebra is supported by the GeoRaster raster algebra language.">Raster Algebra Language</a>). The procedure computes the <code class="codeph">booleanExpr</code> against each cell in the source GeoRaster object. If the result is <code class="codeph">TRUE</code>, the original cell values are kept in the output GeoRaster object; if the result is <code class="codeph">FALSE</code>, the <code class="codeph">bgValues</code> are used to fill cell values in the output GeoRaster object. This can also be considered as a masking operation.
                  </p>
                  <div class="example" id="GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABDGJGJ">
                     <p class="titleinexample">Example 5-4 Conditional Query</p>
                     <p><a href="raster-algebra-and-analytics.html#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABDGJGJ">Example 5-4</a> calls the <a href="sdo-geor-ra-ref.html#GUID-67FDA0FA-D055-4821-964F-600660861A72">SDO_GEOR_RA.findCells</a> procedure to find all pixels where the value of the second band is greater than 200. Because the bgValues parameter is not specified, the value 0 is used as the background value to fill all pixels that make the condition false. The example assumes that the source GeoRaster object is an image with more than two bands.
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  INSERT into georaster_table values (5, sdo_geor.init('rdt_1', 5)) returning georaster into geor1;
  <span class="bold">sdo_geor_ra.findcells(geor, '{ 1 }&gt;200',</span> 'blocking=optimalpadding, blocksize=(512,512,3)', geor1);
  UPDATE georaster_table set georaster = geor1 WHERE georid = 5;
  COMMIT;
END;
/
 
<span class="bold">-- This pixel is set to (0,0,0) because the cell value of the</span>
<span class="bold">-- second band is 136, which is not greater than 200.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,'') FROM georaster_table WHERE georid =1 OR georid=5 ORDER BY georid;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
SDO_NUMBER_ARRAY(0, 0, 0)
 
2 rows selected.
 
<span class="bold">-- This pixel keeps the original values because the cell value</span>
<span class="bold">-- of the second band is greater than 200.</span>
SELECT sdo_geor.getcellvalue(georaster,0,132,116,'') FROM georaster_table WHERE georid =1 OR georid=5 ORDER BY georid;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,132,116,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(242, 225, 233)
SDO_NUMBER_ARRAY(242, 225, 233)
 
2 rows selected.
 
<span class="bold">-- This pixel keeps the original values because the cell value</span>
<span class="bold">-- of the second band is greater than 200.</span>
SELECT sdo_geor.getcellvalue(georaster,0,261,185,'') FROM georaster_table WHERE georid =1 OR georid=5 ORDER BY georid;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,261,185,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(255, 214, 2)
SDO_NUMBER_ARRAY(255, 214, 2)
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABEGDCE">
                     <p class="titleinexample">Example 5-5 Conditional Query with nodata Parameter</p>
                     <p><a href="raster-algebra-and-analytics.html#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABEGDCE">Example 5-5</a> is basically the same as <a href="raster-algebra-and-analytics.html#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABDGJGJ">Example 5-4</a>, except that the <code class="codeph">nodata</code> parameter value is set to <code class="codeph">'TRUE'</code>, so that all NODATA pixels keep their original values from the input GeoRaster object in the output GeoRaster object.
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  INSERT into georaster_table values (5, sdo_geor.init('rdt_1', 5)) returning georaster into geor1;
  <span class="bold">sdo_geor_ra.findcells(geor, '{ 1 }&gt;200',</span> null, geor1, null, <span class="bold">'TRUE'</span>);
  UPDATE georaster_table set georaster = geor1 WHERE georid = 5;
  COMMIT;
END;
/
 
SELECT sdo_geor.getcellvalue(georaster,0,30,30,'') FROM georaster_table WHERE georid =1;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
 
1 row selected.
 
<span class="bold">-- This pixel keeps its original cell values because it is nodata, even though</span>
<span class="bold">-- the cell value of the second band is not greater than 200.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,'') FROM georaster_table WHERE georid=5;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
 
1 row selected.
 </pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABEDCHD">
                     <p class="titleinexample">Example 5-6 Conditional Query with parallelParam</p>
                     <p><a href="raster-algebra-and-analytics.html#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABEDCHD">Example 5-6</a> finds all pixels that meet all of the following conditions:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The cell value of the first band is between (100,200).</p>
                        </li>
                        <li>
                           <p>The cell value of the second band is between [50,250].</p>
                        </li>
                        <li>
                           <p>The cell value of the third band is greater than 100.</p>
                        </li>
                     </ul>
                     <p>In addition, because <code class="codeph">parallelParam</code> is specified as <code class="codeph">'parallel=4'</code>, the procedure in <a href="raster-algebra-and-analytics.html#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9__BABEDCHD">Example 5-6</a> will run in parallel with four processes.
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE 
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN
   SELECT georaster INTO geor FROM georaster_table WHERE georid = 2;
   INSERT into georaster_table values (10, sdo_geor.init('rdt_1', 10)) returning georaster into geor1;
   <span class="bold">sdo_geor_ra.findcells(geor,'({1}&gt;=50)&amp;({1}&lt;=250)&amp;({0}&gt;100)&amp;({0}&lt;200)&amp;{2}&gt;100) '</span>,null,geor1,null,'false',<span class="bold">'parallel=4'</span>);
   UPDATE georaster_table SET georaster = geor1 WHERE georid = 10;
   COMMIT;
END;
/</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1256"></a><a id="GEORS1257"></a><a id="GEORS1255"></a><div class="props_rev_3"><a id="GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F" name="GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F"></a><h3 id="GEORS-GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F" class="sect3"><span class="enumeration_section">5.3 </span>Cell Value-Based Conditional Updates (Edits)
               </h3>
               <div>
                  <p>You can update raster cell values based on conditions.</p>
                  <p>This section pertains to cell value-based raster updates and not space-based raster updates, both of which types of update are described in <a href="georaster-data-manipulation.html#GUID-D78B30EA-E592-4D34-94AC-AB2B1435D60E">Querying and Updating GeoRaster Cell Data</a>.
                  </p>
                  <p>To update raster cell values based on conditions, you can use the <a href="sdo-geor-ra-ref.html#GUID-7F1A50AC-9595-4AC3-83E3-D7233C9FAF2E">SDO_GEOR_RA.rasterUpdate</a> procedure and specify appropriate <code class="codeph">condition</code> and <code class="codeph">vals</code> parameters.
                  </p>
                  <p>The <code class="codeph">condition</code> parameter specifies an array of Boolean expressions, and the <code class="codeph">vals</code> parameter specifies an array of arrays of math expressions. (See the raster algebra operation explanations in <a href="raster-algebra-and-analytics.html#GUID-A6F087DC-1E7E-4426-B778-8554A25B3494" title="Raster algebra is commonly used in raster data analysis and GIS modeling. In GeoRaster, raster algebra is supported by the GeoRaster raster algebra language.">Raster Algebra Language</a>). For each cell, if <code class="codeph">condition</code> is <code class="codeph">TRUE</code>, its cell value is updated to the result of the corresponding math expression in the <code class="codeph">vals</code> array.
                  </p>
                  <div class="example" id="GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABJEABJ">
                     <p class="titleinexample">Example 5-7 Cell Value-Based Update</p>
                     <p><a href="raster-algebra-and-analytics.html#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABJEABJ">Example 5-7</a> assumes that the GeoRaster object to be updated is an image with three bands, and it calls the <a href="sdo-geor-ra-ref.html#GUID-7F1A50AC-9595-4AC3-83E3-D7233C9FAF2E">SDO_GEOR_RA.rasterUpdate</a> procedure to do the following:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>For any pixels if abs(first_band_value - second_band_value)=48 and (third_band_value - second_band_value=-101), then the three band values will be updated to (123,54,89), respectively.</p>
                        </li>
                        <li>
                           <p>For any pixels if (2*first_band_value - second_band_value/3)=108, then the three band values will be updated to (98,56,123), respectively.</p>
                        </li>
                     </ul>
                     <p><a href="raster-algebra-and-analytics.html#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABJEABJ">Example 5-7</a> also includes several calls to the <a href="SDO_GEOR-reference.html#GUID-1E61D84B-F431-4532-B16E-E005596D4DAC">SDO_GEOR.getCellValue</a> function to show "before" and "after" values. 
                     </p><pre class="oac_no_warn" dir="ltr">SELECT sdo_geor.getcellvalue(georaster,0,30,30,'') FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
 
1 row selected.
 
SELECT sdo_geor.getcellvalue(georaster,0,130,130,'') FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,130,130,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(64, 60, 48)
 
1 row selected.

SELECT sdo_geor.getcellvalue(georaster,0,230,230,'') FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,230,230,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(11,11, 11)
 
1 row selected.
 
DECLARE
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN

  SELECT georaster into geor FROM georaster_table WHERE georid = 1;
  <span class="bold">sdo_geor_ra.rasterUpdate(geor,0,SDO_STRING2_ARRAY('(abs({0}-{1})=48)&amp;({2}-{1}=-101)','2*{0}-{1}/3=108'),SDO_STRING2_ARRAYSET(SDO_STRING2_ARRAY('123','54','89'),SDO_STRING2_ARRAY('98','56','123')));</span>
END;
/
 
PL/SQL procedure successfully completed.
 
show errors;
No errors.
 
<span class="bold">-- This pixel gets updated because it meets the first condition.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,'') FROM georaster_table WHERE georid =1;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(123, 54, 89)
 
1 row selected.
 
<span class="bold">--This pixel gets updated because it meets the second condition.</span>
SELECT sdo_geor.getcellvalue(georaster,0,130,130,'') FROM georaster_table WHERE georid=1;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,130,130,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(98, 56, 123)
 
1 row selected.

<span class="bold">-- This pixel keeps its original values because it does not meet any condition</span>
<span class="bold">-- in the "condition" array.</span>
SELECT sdo_geor.getcellvalue(georaster,0,230,230,'') FROM georaster_table WHERE georid =1;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,230,230,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(11,11, 11)
 
1 row selected.
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABHCBGB">
                     <p class="titleinexample">Example 5-8 Cell Value-Based Update with nodata Parameter</p>
                     <p><a href="raster-algebra-and-analytics.html#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABHCBGB">Example 5-8</a> is basically the same as <a href="raster-algebra-and-analytics.html#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABJEABJ">Example 5-7</a>, except that the <code class="codeph">nodata</code> parameter value is set to <code class="codeph">'TRUE'</code>, so that all NODATA pixels keep their original values from the input GeoRaster object in the output GeoRaster object.
                     </p><pre class="oac_no_warn" dir="ltr">SELECT sdo_geor.getcellvalue(georaster,0,30,30,'') FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
 
1 row selected.
 
SELECT sdo_geor.getcellvalue(georaster,0,130,130,'') FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,130,130,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(64, 60, 48)
 
1 row selected.

SELECT sdo_geor.getcellvalue(georaster,0,230,230,'') FROM georaster_table WHERE georid =1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,230,230,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(11,11, 11)
 
1 row selected.
 
DECLARE
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN

  SELECT georaster into geor FROM georaster_table WHERE georid = 1;
  <span class="bold">sdo_geor.addNODATA(geor, 1,88);</span>
  <span class="bold">sdo_geor_ra.rasterUpdate</span>(geor,0,SDO_STRING2_ARRAY('(abs({0}-{1})=48)&amp;({2}-{1}=-101)','2*{0}-{1}/3=108'),SDO_STRING2_ARRAYSET(SDO_STRING2_ARRAY('123','54','89'),SDO_STRING2_ARRAY('98','56','123')),null,<span class="bold">'true'</span>);
END;
/
 
PL/SQL procedure successfully completed.

<span class="bold">-- This pixel keeps its original values because it is a NODATA pixel.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,'') FROM georaster_table WHERE georid =1;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
 
1 row selected.
 
--This pixel gets updated because it meets the second condition.
SELECT sdo_geor.getcellvalue(georaster,0,130,130,'') FROM georaster_table WHERE georid=1;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,130,130,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(98, 56, 123)
 
1 row selected.</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1259"></a><a id="GEORS1260"></a><a id="GEORS1261"></a><a id="GEORS1258"></a><div class="props_rev_3"><a id="GUID-C6250398-2364-4FEE-B06E-644B5F1251AB" name="GUID-C6250398-2364-4FEE-B06E-644B5F1251AB"></a><h3 id="GEORS-GUID-C6250398-2364-4FEE-B06E-644B5F1251AB" class="sect3"><span class="enumeration_section">5.4 </span>Mathematical Operations
               </h3>
               <div>
                  <p>A major use of raster algebra is to apply mathematical models to raster layers from different sources.</p>
                  <p>To apply mathematical operations on one or multiple layers, which could be from one or more GeoRaster objects, to generate a new GeoRaster object, you can use the <a href="sdo-geor-ra-ref.html#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a> procedure. 
                  </p>
                  <p>For most formats of this procedure, the <code class="codeph">operation</code> parameter specifies an array of <code class="codeph">arithmeticExpr</code> strings used to calculate raster cell values in the output GeoRaster object. Each element of the array corresponds to a layer in the output GeoRaster object. 
                  </p>
                  <p>Note that <code class="codeph">booleanExpr</code> can be also used as <code class="codeph">arithmeticExpr</code>, as is done in <a href="raster-algebra-and-analytics.html#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F__BABHCBGB">Example 5-8</a>.
                  </p>
                  <div class="example" id="GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABIEHFB">
                     <p class="titleinexample">Example 5-9 Mathematical Operations (1)</p>
                     <p><a href="raster-algebra-and-analytics.html#GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABIEHFB">Example 5-9</a> calls the <a href="sdo-geor-ra-ref.html#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a> procedure to generate a new 6-layer GeoRaster object from a 3-layer source GeoRaster object, and follows these rules to calculate cell values of the target GeoRaster object:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The cell value of the first three layers of target GeoRaster object is equal to the value of the corresponding layer of source GeoRaster object, minus 10.</p>
                        </li>
                        <li>
                           <p>The cell value of the last three layers of target GeoRaster object is equal to the value of the first three layers of the source GeoRaster object, respectively.</p>
                        </li>
                     </ul><pre class="oac_no_warn" dir="ltr">DECLARE
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
  geor2  SDO_GEORASTER;
BEGIN
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  INSERT into georaster_table values (16, sdo_geor.init('rdt_1', 16)) returning georaster into geor1;
  <span class="bold">sdo_geor_ra.rasterMathOp(geor,SDO_STRING2_ARRAY('{0,0}-10','{0,1}-10','{0,2}-10','{0,0}','{0,1}','{0,2}'),null,geor1);</span>
  UPDATE georaster_table SET georaster = geor1 WHERE georid = 16;
  COMMIT;
END;
/
 
PL/SQL procedure successfully completed.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid=1;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181, 163, 159)
 
1 row selected.
 
<span class="bold">--  In the results of the next SELECT statement, note:</span>
<span class="bold">--  171=181-10</span>
<span class="bold">--  153=163-10</span>
<span class="bold">--  149=159-10</span>
<span class="bold">--  181=181</span>
<span class="bold">--  163=163</span>
<span class="bold">--  159=159</span>
SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid =16;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(171, 153, 149, 181, 163, 159)
 
1 row selected.
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABBCEJB">
                     <p class="titleinexample">Example 5-10 Mathematical Operations (2)</p>
                     <p><a href="raster-algebra-and-analytics.html#GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABBCEJB">Example 5-10</a> applies an operation on a 2-element GeoRaster array (containing two 3-layer source GeoRaster objects) to generate a new 3-layer GeoRaster object. 
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  geor2      SDO_GEORASTER;
  geo_array  SDO_GEORASTER_ARRAY;
BEGIN
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  SELECT georaster INTO geor2 FROM georaster_table WHERE georid = 2;
  INSERT into georaster_table values (17, sdo_geor.init('rdt_1', 17)) returning georaster into geor1;
  <span class="bold">geo_array:=SDO_GEORASTER_ARRAY(geor,geor2);</span>
  <span class="bold">sdo_geor_ra.rasterMathOp(geo_array,SDO_STRING2_ARRAY('{0,0}-0.5*{1,0}','{0,1}-0.5*{1,1}','{0,2}-0.5*{1,2}'),null,geor1,'false',null,'parallel=4');</span>
  UPDATE georaster_table SET georaster = geor1 WHERE georid = 17;
  COMMIT;
END;
/
 
PL/SQL procedure successfully completed.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid=1 or georid=2;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181, 163, 159)
SDO_NUMBER_ARRAY(60, 80, 90)
 
2 rows selected.
 
<span class="bold">-- In the results of the next SELECT statement, note:</span>
<span class="bold">-- 151=181-0.5*60</span>
<span class="bold">-- 123=163-0.5*80</span>
<span class="bold">-- 114=159-0.5*90</span>
SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid =17;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(151, 123 114)
 
1 row selected.
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABGBIIG">
                     <p class="titleinexample">Example 5-11 Mathematical Operations (3)</p>
                     <p><a href="raster-algebra-and-analytics.html#GUID-C6250398-2364-4FEE-B06E-644B5F1251AB__BABGBIIG">Example 5-11</a> applies a subtraction operation on two 3-layer input GeoRaster objects to generate a new GeoRaster object. The example also includes several calls to the <a href="SDO_GEOR-reference.html#GUID-1E61D84B-F431-4532-B16E-E005596D4DAC">SDO_GEOR.getCellValue</a> function to show "before" and "after" values.
                     </p><pre class="oac_no_warn" dir="ltr">SELECT sdo_geor.getcellvalue(georaster,0,10,10,'0-2') FROM georaster_table WHERE georid=1 OR georid=5 ORDER BY georid;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,10,10,'0-2')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 137, 32)
SDO_NUMBER_ARRAY(98, 147, 42)
 
2 rows selected.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,'0-2') FROM georaster_table WHERE georid=1 OR georid=5 ORDER BY georid;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'0-2')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181, 163, 159)
SDO_NUMBER_ARRAY(191, 173, 169)
 
2 rows selected.
 
DECLARE
  geor0  SDO_GEORASTER;
  geor   SDO_GEORASTER;
  geor1  SDO_GEORASTER;
BEGIN
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  SELECT georaster INTO geor0 FROM georaster_table WHERE georid = 5;
  INSERT into georaster_table values (6, sdo_geor.init('rdt_1', 6)) returning georaster into geor1;
  sdo_geor_ra.rasterMathOp(geor0,geor,null,<span class="bold">sdo_geor_ra.OPERATOR_SUBTRACT</span>,null,geor1);
  UPDATE georaster_table SET georaster = geor1 WHERE georid = 6;
  COMMIT;
END;
/
 
PL/SQL procedure successfully completed.
 
SELECT sdo_geor.getcellvalue(georaster,0,10,10,'0-2') FROM georaster_table WHERE georid=6;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,10,10,'0-2')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(10, 10, 10)
 
1 row selected.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,'0-2') FROM georaster_table WHERE georid=6;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'0-2')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(10, 10, 10)
 
1 row selected.
</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1263"></a><a id="GEORS1264"></a><a id="GEORS1262"></a><div class="props_rev_3"><a id="GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E" name="GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E"></a><h3 id="GEORS-GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E" class="sect3"><span class="enumeration_section">5.5 </span>Classification Operations
               </h3>
               <div>
                  <p>Classification (segmentation) operations can be applied on source GeoRaster objects to generate new objects.</p>
                  <p><a id="d21717e1014" class="indexterm-anchor"></a>To apply simple classification operations on source GeoRaster objects and generate new GeoRaster objects based on your specifications, you can use the <a href="sdo-geor-ra-ref.html#GUID-D9DA6608-7D97-4428-B1B2-002C371846E9">SDO_GEOR_RA.classify</a> procedure and specify the <code class="codeph">expression</code>, <code class="codeph">rangeArray</code>, and <code class="codeph">valueArray</code> parameters. This classification procedure is also called <span class="italic">segmentation</span>.
                  </p>
                  <p>The <code class="codeph">expression</code> parameter is used to compute values that are used to map into the value ranges defined in the <code class="codeph">rangeArray</code> parameter. The <code class="codeph">rangeArray</code> parameter specifies a number array that defines ranges for classifying cell values, and this array must have at least one element. The <code class="codeph">valueArray</code> parameter is a number array that defines the target cell value for each range, and its length must be the length of <code class="codeph">rangeArray</code> plus one.
                  </p>
                  <div class="example" id="GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E__BABDFCHH">
                     <p class="titleinexample">Example 5-12 Classification</p>
                     <p><a href="raster-algebra-and-analytics.html#GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E__BABDFCHH">Example 5-12</a> calls the <a href="sdo-geor-ra-ref.html#GUID-D9DA6608-7D97-4428-B1B2-002C371846E9">SDO_GEOR_RA.classify</a> procedure to apply a segmentation operation on the value of the first band of the input GeoRaster object. The example assumes that the GeoRaster object is an image.
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  rangeArray SDO_NUMBER_ARRAY;
  valueArray SDO_NUMBER_ARRAY;
BEGIN
  rangeArray:=sdo_number_array(70,80,90,100,110,120,130,140,150,160,170,180);
  valueArray:=sdo_number_array(70,80,90,100,110,120,130,140,150,160,170,180,190);
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  INSERT into georaster_table values (5, sdo_geor.init('rdt_1', 5)) returning georaster into geor1;
  <span class="bold">sdo_geor_ra.classify(geor,'{0}',rangeArray,valueArray,null,geor1);</span>
  UPDATE georaster_table SET georaster = geor1 WHERE georid = 5;
  COMMIT;
END;
/
 
PL/SQL procedure successfully completed.
 
<span class="bold">-- In the next statement, the target value is 90 because the value of the</span>
<span class="bold">-- first band of source GeoRaster object is 88, which is between 80 and 90.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,'') FROM georaster_table WHERE georid =1 OR georid =5 ORDER BY georid;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
SDO_NUMBER_ARRAY(90)
 
2 rows selected.
 
<span class="bold">-- In the next statement, the target value is 190 because the value of the</span>
<span class="bold">-- first band of source GeoRaster object is 242, which is greater than 180.</span>
SELECT sdo_geor.getcellvalue(georaster,0,132,116,'') FROM georaster_table WHERE georid =1 OR georid =5 ORDER BY georid;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,132,116,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(242, 225, 233)
SDO_NUMBER_ARRAY(190)
 
2 rows selected.
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E__BABDBHDC">
                     <p class="titleinexample">Example 5-13 Classification with nodata and nodataValue Parameters</p>
                     <p><a href="raster-algebra-and-analytics.html#GUID-57DE5ACD-7DE9-4871-9DF0-CC685DF5114E__BABDBHDC">Example 5-13</a> calls the <a href="sdo-geor-ra-ref.html#GUID-D9DA6608-7D97-4428-B1B2-002C371846E9">SDO_GEOR_RA.classify</a> procedure to apply a segmentation operation on the value of the first layer of the source GeoRaster object, and to set the <code class="codeph">nodata</code> parameter to <code class="codeph">'TRUE'</code> and the <code class="codeph">nodataValue</code> parameter to 5, so that all NODATA pixels will be set with a NODATA value of 5 in the target GeoRaster object.
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  rangeArray SDO_NUMEBR_ARRAY;
  valueArray SDO_NUMEBR_ARRAY;
BEGIN
  rangeArray:=sdo_number_array(70,80,90,100,110,120,130,140,150,160,170,180);
  valueArray:=sdo_number_array(70,80,90,100,110,120,130,140,150,160,170,180,190);
  SELECT georaster INTO geor FROM georaster_table WHERE georid = 1;
  <span class="bold">sdo_geor.addNODATA(geor, 2,136);</span>
  INSERT into georaster_table values (5, sdo_geor.init('rdt_1', 5)) returning georaster into geor1;
  sdo_geor_ra.classify(geor,'{0}',rangeArray,valueArray,null,geor1,<span class="bold">'true'</span><span class="bold">,5</span>);
  UPDATE georaster_table SET georaster = geor1 WHERE georid = 5;
END;
/
 
PL/SQL procedure successfully completed.
 
<span class="bold">-- In the next statement, the target value of the cell is 5 because the value</span>
<span class="bold">-- of the second layer of the input GeoRaster object is 136, which is nodata.</span>
SELECT sdo_geor.getcellvalue(georaster,0,30,30,'') FROM georaster_table WHERE georid =1 OR georid =5 ORDER BY georid;

SDO_GEOR.GETCELLVALUE(GEORASTER,0,30,30,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(88, 136, 35)
SDO_NUMBER_ARRAY(5)
 
2 rows selected.</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-B1A7F654-E438-48F1-9EB6-55268FA260B1" name="GUID-B1A7F654-E438-48F1-9EB6-55268FA260B1"></a><h3 id="GEORS-GUID-B1A7F654-E438-48F1-9EB6-55268FA260B1" class="sect3"><span class="enumeration_section">5.6 </span>Statistical Operations
               </h3>
               <div>
                  <p>To apply statistical operations on one or more layers, which are from one or more GeoRaster objects, the following types of operations are available.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-9FF22F4B-19E8-45B2-9811-8ABA00268613">On-the-Fly Statistical Analysis</a><br></li>
                     <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-94CA2FD0-EAF3-4ED9-803F-9129DD2E0584">Stack Statistical Analysis</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               <a id="GEORS1265"></a><div class="props_rev_3"><a id="GUID-9FF22F4B-19E8-45B2-9811-8ABA00268613" name="GUID-9FF22F4B-19E8-45B2-9811-8ABA00268613"></a><h4 id="GEORS-GUID-9FF22F4B-19E8-45B2-9811-8ABA00268613" class="sect4"><span class="enumeration_section">5.6.1 </span>On-the-Fly Statistical Analysis
                  </h4>
                  <div>
                     <p>Many applications require statistical analysis. GeoRaster provides statistical analysis functions that dynamically ("on the fly") compute complete statistical values for a GeoRaster object or the following individual statistical values: minimum, maximum, mean, median, mode, and standard deviation. You can do this without generating a histogram and updating the GeoRaster object metadata.</p>
                     <p>These subprograms support pyramids, band by band and the aggregation of specified band numbers. Each subprogram returns an SDO_NUMBER_ARRAY object or a number.</p>
                     <p>See the reference information for explanations and examples of these on-the-fly statistics computation subprograms:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="SDO_GEOR-reference.html#GUID-96B2E47F-17E2-491D-9FF6-AC7BEFB434D7">SDO_GEOR.generateStatistics</a></p>
                        </li>
                        <li>
                           <p><a href="SDO_GEOR-reference.html#GUID-FD88A636-A97B-456E-A07A-DE2D6AE54545">SDO_GEOR.generateStatisticsMax</a></p>
                        </li>
                        <li>
                           <p><a href="SDO_GEOR-reference.html#GUID-CE118FEB-6F5D-4B42-9D95-2989355D7222">SDO_GEOR.generateStatisticsMean</a></p>
                        </li>
                        <li>
                           <p><a href="SDO_GEOR-reference.html#GUID-5726F33E-CDE7-4793-9973-B0F779E629E8">SDO_GEOR.generateStatisticsMedian</a></p>
                        </li>
                        <li>
                           <p><a href="SDO_GEOR-reference.html#GUID-963EB183-C710-471B-A1DA-9665D93FE2DC">SDO_GEOR.generateStatisticsMin</a></p>
                        </li>
                        <li>
                           <p><a href="SDO_GEOR-reference.html#GUID-D36B7F54-FEF4-4111-AF3F-99A193BEC0D9">SDO_GEOR.generateStatisticsMode</a></p>
                        </li>
                        <li>
                           <p><a href="SDO_GEOR-reference.html#GUID-453A78AC-CCDB-4E87-9A67-7C2C113B1C57">SDO_GEOR.generateStatisticsSTD</a></p>
                        </li>
                     </ul>
                     <p>These subprograms do not modify the metadata in the GeoRaster object, except for some formats of <a href="SDO_GEOR-reference.html#GUID-96B2E47F-17E2-491D-9FF6-AC7BEFB434D7">SDO_GEOR.generateStatistics</a> that set statistical data in the GeoRaster object metadata and return a string value of <code class="codeph">TRUE</code> or <code class="codeph">FALSE</code> instead of an SDO_NUMBER_ARRAY object.
                     </p>
                     <p>GeoRaster also provides statistical analysis functions that compute the area weighted statistical mean value for the cells and sub-cells within a specific window of the input GeoRaster object, and that calculate the three&#x2013;dimensional (3D) surface area represented by digital elevation model (DEM) data that is stored in a GeoRaster object. See the reference information for explanations and examples of these on-the-fly statistics computation functions:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="SDO_GEOR-reference.html#GUID-179F3873-50F9-48A9-A54C-644A0DABF231">SDO_GEOR.generateAreaWeightedMean</a></p>
                        </li>
                        <li>
                           <p><a href="SDO_GEOR_UTL-reference.html#GUID-7D97E9ED-64E7-44BD-8920-0CAF4B297DA1">SDO_GEOR_UTL.calcSurfaceArea</a></p>
                        </li>
                     </ul>
                     <p>These two functions support irregular polygon clipping and sub-cell computation, thus providing very accurate results.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-B1A7F654-E438-48F1-9EB6-55268FA260B1" title="To apply statistical operations on one or more layers, which are from one or more GeoRaster objects, the following types of operations are available.">Statistical Operations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-94CA2FD0-EAF3-4ED9-803F-9129DD2E0584" name="GUID-94CA2FD0-EAF3-4ED9-803F-9129DD2E0584"></a><h4 id="GEORS-GUID-94CA2FD0-EAF3-4ED9-803F-9129DD2E0584" class="sect4"><span class="enumeration_section">5.6.2 </span>Stack Statistical Analysis
                  </h4>
                  <div>
                     <p>Stack statistical analysis generates a new one-layer GeoRaster object from one or more layers, which are from one or more GeoRaster objects, by computing one of the following statistical values for each cell: max, min, median, std, sum, minority, majority, or diversity.</p>
                     <p>To perform stack statistical analysis, you have the following options:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Use the <a href="sdo-geor-ra-ref.html#GUID-90E78211-B677-4D22-8CF8-2E7BB7740F39">SDO_GEOR_RA.stack</a> procedure.
                           </p>
                           <p>This option is more intuitive and does not require constructing raster algebra expressions (especially for GeoRaster objects with many layers), and it allows you to specify a list of layers instead of all layers.</p>
                        </li>
                        <li>
                           <p>Use the <a href="sdo-geor-ra-ref.html#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a> procedure.
                           </p>
                           <p>This option is more flexible and powerful, allowing you to perform more comlpicated statistical analysis.</p>
                        </li>
                     </ul>
                     <div class="example" id="GUID-94CA2FD0-EAF3-4ED9-803F-9129DD2E0584__GUID-3C6CEF84-6802-4A13-A81B-2E29C0BA1FDA">
                        <p class="titleinexample">Example 5-14 Using SDO_GEOR_RA.stack</p>
                        <p>This example uses the first option for performing stack statistical analysis. It calls the <a href="sdo-geor-ra-ref.html#GUID-90E78211-B677-4D22-8CF8-2E7BB7740F39">SDO_GEOR_RA.stack</a> procedure to generate a new GeoRaster object by computing the maximum (max) value of layers 2 and 5 of two 3&#x2013;layer source GeoRaster objects.
                        </p><pre class="pre codeblock"><code>DECLARE
  geor       MDSYS.SDO_GEORASTER;
  geor1      MDSYS.SDO_GEORASTER;
  geor2      MDSYS.SDO_GEORASTER;
  geom       mdsys.sdo_geometry;
BEGIN
  geom:= sdo_geometry(2003,82394, NULL,
                      sdo_elem_info_array(1, 1003, 1),
                      sdo_ordinate_array(20283.775, 1011087.9,
                                         18783.775, 1008687.9,
                                         21783.775, 1008687.9,
                                         22683.775+0.001, 1009587.9+0.001,
                                         20283.775, 1011087.9));
  select georaster into geor from georaster_table where georid = 100;
  select georaster into geor2 from georaster_table where georid = 102;
  select georaster into geor1 from georaster_table where georid = 101 for update;
  sdo_geor_ra.stack(SDO_GEORASTER_ARRAY(geor,geor2),geom,SDO_NUMBER_ARRAY(2,5),'max',null,geor1,'false',0,'TRUE');
  update georaster_table set georaster = geor1 where georid = 101;
END;
/
 
PL/SQL procedure successfully completed.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid=100;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(121, 66, 181)
 
1 row selected.

SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid=102;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(33, 55, 56)
 
1 row selected.

--  In the results of the next SELECT statement, note:
--  max(181,56)  ==&gt;  181

SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid =101;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181)
 
1 row selected.
</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-94CA2FD0-EAF3-4ED9-803F-9129DD2E0584__GUID-77AE3ADC-60DA-4455-A8C2-C9C0FFB3C421">
                        <p class="titleinexample">Example 5-15 Using SDO_GEOR_RA.rasterMathOp</p>
                        <p>This example uses the second option for performing stack statistical analysis. It calls the <a href="sdo-geor-ra-ref.html#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">sdo_GEOR_RA.rasterMathOp</a> specifying a statistical operation (max) to perform an operation similar to the preceding example, except that this example applies to all layers.
                        </p><pre class="pre codeblock"><code>DECLARE
  geor       MDSYS.SDO_GEORASTER;
  geor1      MDSYS.SDO_GEORASTER;
  geor2      MDSYS.SDO_GEORASTER;
  geo_array  MDSYS.SDO_GEORASTER_ARRAY;
BEGIN
  select georaster into geor from georaster_table where georid = 100;
  select georaster into geor1 from georaster_table where georid = 101;
  select georaster into geor2 from georaster_table where georid = 102 for update;
  geo_array:=MDSYS.SDO_GEORASTER_ARRAY(geor,geor1);
  sdo_geor_ra.rasterMathOp(geo_array,SDO_STRING2_ARRAY('max()'),null,geor2);
  update georaster_table set georaster = geor2 where georid = 102;
  commit;
END;
/

PL/SQL procedure successfully completed. 

SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid=100;
 SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'') 
-------------------------------------------------------------------------------- 
SDO_NUMBER_ARRAY(181, 163, 159) 
1 row selected. 

SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid=101; 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'') 
-------------------------------------------------------------------------------- 
SDO_NUMBER_ARRAY(181, 122, 159) 1 row selected. 

-- In the results of the next SELECT statement, note:
-- max(181,163,159,181,122,159)  ==&gt; 181

SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid =102;
 SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
 --------------------------------------------------------------------------------
 SDO_NUMBER_ARRAY(181) 
1 row selected. 
</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-B1A7F654-E438-48F1-9EB6-55268FA260B1" title="To apply statistical operations on one or more layers, which are from one or more GeoRaster objects, the following types of operations are available.">Statistical Operations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-022F5214-9D1E-44B4-8487-967C93CC2954" name="GUID-022F5214-9D1E-44B4-8487-967C93CC2954"></a><h3 id="GEORS-GUID-022F5214-9D1E-44B4-8487-967C93CC2954" class="sect3"><span class="enumeration_section">5.7 </span>Logical Operations
               </h3>
               <div>
                  <p>A major use of raster algebra is to apply logical models to raster layers from different sources; that is, you can apply logical operations on one or more layers, from one or more GeoRaster objects, to generate a new GeoRaster object.</p>
                  <p>To apply logical operations, you can either use raster algebra procedures with logical expressions, which is more flexible and powerful and mostly be used for some complicated raster logical operations, or use raster algebra procedures only, which are straightforward and do not require constructing complicated logical expressions. However, using raster algebra procedures only (that is, without logical expressions) has some limitations and is mainly used  for some specific raster logical operations.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-4CA82053-00A1-44BF-B675-969796BA8735">Using Raster Algebra Procedures with Logical Expressions</a><br></li>
                     <li class="ulchildlink"><a href="raster-algebra-and-analytics.html#GUID-DDCEB15D-3C90-4317-B8B5-A633AD248519">Using Raster Algebra Functions Only</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-4CA82053-00A1-44BF-B675-969796BA8735" name="GUID-4CA82053-00A1-44BF-B675-969796BA8735"></a><h4 id="GEORS-GUID-4CA82053-00A1-44BF-B675-969796BA8735" class="sect4"><span class="enumeration_section">5.7.1 </span>Using Raster Algebra Procedures with Logical Expressions
                  </h4>
                  <div>
                     <p>GeoRaster logical expressions can be conditional expressions, boolean expressions, or both, which can take any combination of unary and binary boolean operators (!, &amp;, |, ^) and comparison operators (=, &lt;, &gt;, &lt;=, &gt;=, !=).</p>
                     <p>To apply logical expressions on the raster data, you must use&nbsp;raster algebra procedures defined in the SDO_GEOR_RA&nbsp;package and specify appropriate parameters with your constructed logical expressions.</p>
                     <div class="example" id="GUID-4CA82053-00A1-44BF-B675-969796BA8735__GUID-825B0A0C-1E5C-414E-A112-B1AA14B374A3">
                        <p class="titleinexample">Example 5-16 Using SDO_GEOR_RA.rasterMathOp with condition operators</p>
                        <p>This example implements logic described in the following pseudocode to implement 3&#x2013;band raster data segmentation:</p><pre class="pre codeblock"><code> if ( (layer1 &lt; 100) 
      &amp; (layer2&lt; 1000) 
      &amp; (layer3&lt; 500)) 
 then output = 10
 elsif ( (layer1 &lt; 200) 
         &amp; (layer2&lt; 2000) 
         &amp; (layer3&lt; 1000))
 then output = 20
 elsif ( (layer1 &lt; 300) 
         &amp; (layer2&lt; 3000) 
         &amp; (layer3&lt; 1500))
 then output = 30
 elsif ( (layer1 &lt; 400) 
         &amp; (layer2&lt; 4000) 
         &amp; (layer3&lt; 2000))
 then output = 40
 elsif ( (layer1 &lt; 500) 
         &amp; (layer2&lt; 5000) 
         &amp; (layer3&lt; 2500))
 then output = 50
 else
      output = 0
</code></pre><p>The example calls the <a href="sdo-geor-ra-ref.html#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a> procedure, as follows
                        </p><pre class="pre codeblock"><code>DECLARE 
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  mycursor   sys_refcursor;
  expr       varchar2(1024);
BEGIN
  select georaster into geor from georaster_table where georid = 100;
  select georaster into geor1 from georaster_table where georid = 101 for update;
  --construct logical expression 
  expr :='condition((({0}&lt;100)&amp;({1}&lt;1000)&amp;({2}&lt;500)),'||
                   '10,'||
                   'condition((({0}&lt;200)&amp;({1}&lt;2000)&amp;({2}&lt;1000)),'||
                             '20,'||
                             'condition((({0}&lt;300)&amp;({1}&lt;3000)&amp;({2}&lt;1500)),'||
                                       '30,'||
                                       'condition((({0}&lt;400)&amp;({1}&lt;4000)&amp;({2}&lt;2000)),'||
                                                 '40,'||
                                                 'condition((({0}&lt;500)&amp;({1}&lt;5000)&amp;({2}&lt;2500)),'||
                                                           '50,'||
                                                           '0)'||
                                                ')'||
                                      ')'||
                            ')'||
                  ')';
                
  sdo_geor_ra.rasterMathOp(geor, sdo_string2_array(expr),null, geor1, 'true', 0, 'parallel=4');
  update georaster_table set georaster = geor1 where georid = 101;
  commit;
END;
/
</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-4CA82053-00A1-44BF-B675-969796BA8735__GUID-F583AD13-36E6-4804-9D9E-0640119C70EC">
                        <p class="titleinexample">Example 5-17 Using SDO_GEOR_RA.rasterMathOp with a condition operator</p>
                        <p>This example uses statistical functions and arithmetic operations to implement the simple logic described in the following pseudocode:</p><pre class="pre codeblock"><code>if (sum()&gt;min()*3) 
then
   output = sqrt(layer0+layer2)
else
   output = layer1*1.5
</code></pre><p>The example calls the <a href="sdo-geor-ra-ref.html#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a> procedure, as follows
                        </p><pre class="pre codeblock"><code>DECLARE 
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  mycursor   sys_refcursor;
  expr       varchar2(1024);
BEGIN
  select georaster into geor from georaster_table where georid = 100;
  select georaster into geor1 from georaster_table where georid = 101 for update;
  --construct logical expression 
  expr :='condition(sum()&gt;min()*3,sqrt({0}+{2}),{1}*1.5)';               
  sdo_geor_ra.rasterMathOp(geor, sdo_string2_array(expr),null, geor1, 'true', 0, 'parallel=4');
  update georaster_table set georaster = geor1 where georid = 101;
  commit;
END;
/
</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-022F5214-9D1E-44B4-8487-967C93CC2954" title="A major use of raster algebra is to apply logical models to raster layers from different sources; that is, you can apply logical operations on one or more layers, from one or more GeoRaster objects, to generate a new GeoRaster object.">Logical Operations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-DDCEB15D-3C90-4317-B8B5-A633AD248519" name="GUID-DDCEB15D-3C90-4317-B8B5-A633AD248519"></a><h4 id="GEORS-GUID-DDCEB15D-3C90-4317-B8B5-A633AD248519" class="sect4"><span class="enumeration_section">5.7.2 </span>Using Raster Algebra Functions Only
                  </h4>
                  <div>
                     <p>To perform logical operations using only raster algebra functions, you have the following options</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Use the <a href="sdo-geor-ra-ref.html#GUID-B879FE32-88C6-4C85-95B8-47B7EDEE8C02">SDO_GEOR_RA.diff</a> procedure.
                           </p>
                           <p>For example, if a cell value in raster A is different from the cell value in raster B, the cell value in raster A is returned. If the cell values are the same, the value 0 (zero) is returned.</p>
                        </li>
                        <li>
                           <p>Use the <a href="sdo-geor-ra-ref.html#GUID-D6105A06-3CC0-42C9-AC57-81333017C3A4">SDO_GEOR_RA.over</a> procedure.
                           </p>
                           <p>For example, if a cell value in raster A is not equal to 0 (zero), the cell value in raster A is returned. If the cell value in raster A is equal to 0, the cell value in raster B is returned.</p>
                        </li>
                     </ul>
                     <div class="example" id="GUID-DDCEB15D-3C90-4317-B8B5-A633AD248519__GUID-825B0A0C-1E5C-414E-A112-B1AA14B374A3">
                        <p class="titleinexample">Example 5-18 Using SDO_GEOR_RA.diff</p>
                        <p>This example calls the <a href="sdo-geor-ra-ref.html#GUID-B879FE32-88C6-4C85-95B8-47B7EDEE8C02">SDO_GEOR_RA.diff</a> procedure to generate a new GeoRaster object from two 3&#x2013;layer source GeoRaster objects.
                        </p><pre class="pre codeblock"><code>DECLARE
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  geor2      SDO_GEORASTER;
  geom       sdo_geometry;
BEGIN
  select georaster into geor from georaster_table where georid = 100;
  select georaster into geor1 from georaster_table where georid = 101;
  select georaster into geor2 from georaster_table where georid = 102 for update;
  geom:=null;
  sdo_geor_ra.diff(geor,geor1,geom,null,geor2);
  update georaster_table set georaster = geor2 where georid = 102;
END;
/
 
PL/SQL procedure successfully completed.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid=100;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181, 163, 159)
 
1 row selected.

SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid=101;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181, 122, 159)
 
1 row selected.

--  In the results of the next SELECT statement, note:
--  181 =181  ==&gt;  0
--  163!=122  ==&gt;  163
--  159 =159  ==&gt;  0

SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid =102;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(0, 163, 0)
 
1 row selected.
</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-DDCEB15D-3C90-4317-B8B5-A633AD248519__GUID-2F65268D-B52A-4D58-88B3-08CEF286AC63">
                        <p class="titleinexample">Example 5-19 Using SDO_GEOR_RA.over</p>
                        <p>This example calls the <a href="sdo-geor-ra-ref.html#GUID-D6105A06-3CC0-42C9-AC57-81333017C3A4">SDO_GEOR_RA.over</a> procedure to generate a new GeoRaster object from two 3&#x2013;layer source GeoRaster objects.
                        </p><pre class="pre codeblock"><code>DECLARE
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  geor2      SDO_GEORASTER;
  geom       sdo_geometry;
BEGIN
  select georaster into geor from georaster_table where georid = 102;
  select georaster into geor1 from georaster_table where georid = 101;
  select georaster into geor2 from georaster_table where georid = 100 for update;
  geom:=null;
  sdo_geor_ra.over(geor,geor1,geom,null,geor2);
  update georaster_table set georaster = geor2 where georid = 100;
END;
/
 
PL/SQL procedure successfully completed.
 
SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid=102;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(0, 163, 0)
 
1 row selected.

SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid=101;
 
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181, 122, 159)
 
1 row selected.

--  In the results of the next SELECT statement, note:
--  0 =0    ==&gt;  181      result from georid=101
--  163!=0  ==&gt;  163      result from georid=102
--  0 =0    ==&gt;  159      result from georid=101

SELECT sdo_geor.getcellvalue(georaster,0,100,100,'') FROM georaster_table WHERE georid =100;
SDO_GEOR.GETCELLVALUE(GEORASTER,0,100,100,'')
--------------------------------------------------------------------------------
SDO_NUMBER_ARRAY(181, 163, 159)
 
1 row selected.
</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-022F5214-9D1E-44B4-8487-967C93CC2954" title="A major use of raster algebra is to apply logical models to raster layers from different sources; that is, you can apply logical operations on one or more layers, from one or more GeoRaster objects, to generate a new GeoRaster object.">Logical Operations</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="GEORS1267"></a><a id="GEORS1268"></a><a id="GEORS1269"></a><a id="GEORS1266"></a><div class="props_rev_3"><a id="GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B" name="GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B"></a><h3 id="GEORS-GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B" class="sect3"><span class="enumeration_section">5.8 </span>Raster Data Scaling and Offsetting
               </h3>
               <div>
                  <p>You can perform raster data scaling and offsetting operations.</p>
                  <p>Raster algebra has many applications, such as cartographic modeling (see <a href="raster-algebra-and-analytics.html#GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166" title="Raster algebra is widely used in cartographic modeling and is considered an essential component of GIS systems. Using the PL/SQL and the raster algebra expressions and functions, you can conduct cartographic modeling over a large number of rasters and images of virtually unlimited size.">Cartographic Modeling</a>), vegetation index computing (see <a href="image-processing-virtual-mosaic.html#GUID-C2D99D00-071F-4BBC-A0A5-50C6F0FAF355" title='In remote sensing, the Normalized Difference Vegetation Index (NDVI) is a widely used vegetation index, enabling users to quickly identify vegetated areas and monitor the growth and "condition" of plants.'>Vegetation Index Computation</a>), and tasseled cap transformation (see <a href="image-processing-virtual-mosaic.html#GUID-2530F5D2-7386-4DD4-877A-F004F2109912" title="Tasseled Cap Transformation (TCT) is a useful tool for analyzing physical ground features using remotely sensed imagery.">Tasseled Cap Transformation</a>). Topics in this chapter and in <a href="image-processing-virtual-mosaic.html#GUID-EB60166B-6A52-4974-AF16-139CD6480EBC" title="This chapter describes advanced image processing capabilities, including GCP georeferencing, reprojection, rectification, orthorectification, warping, image scaling, stretching, filtering, masking, segmentation, NDVI computation, Tasseled Cap Transformation, image appending, bands merging, and large-scale advanced image mosaicking."> Image Processing and Virtual Mosaic</a> describe a few sample applications of the GeoRaster raster algebra.
                  </p>
                  <div class="example" id="GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABFGGJJ">
                     <p class="titleinexample">Example 5-20 Converting DEM Data from Feet to Meters</p>
                     <p>The cell value of a GeoRaster object may represent a quantitative attribute of spatial objects, which could be in a specific unit. For example, the elevation data in a DEM GeoRaster object could be in the unit of feet. An application may require you to convert the elevations into another unit, such as meters, for georectification and other operations. You can use the raster algebra to scale the DEM data from feet into meters (that is, unit conversion), as shown in <a href="raster-algebra-and-analytics.html#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABFGGJJ">Example 5-20</a>. 
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE 
  geor1    SDO_GEORASTER;
  geor2    SDO_GEORASTER;
BEGIN
  --Source GeoRaster object with a single DEM layer
  select georaster into geor1 from georaster_table where georid = 1;
  --To store the output DEM layer
  select georaster into geor2 from georaster_table where georid = 2 for update;
  --Scale elevation from feet to meters using the unit factor
  sdo_geor_ra.rasterMathOp(geor1,SDO_STRING2_ARRAY('{0} * 0.3048'),null,geor2);
  --Commit changes to the output georaster object
  update georaster_table set georaster = geor2 where georid = 2;
  commit;
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABJHCFE">
                     <p class="titleinexample">Example 5-21 Offsetting DEM by Geoid Height</p>
                     <p>The cell data of a GeoRaster object may need to be offset by a constant for further processing. For example, a DEM layer may represent orthometric elevation instead of ellipsoidal elevation. To orthorectify a raw image georeferenced by an RPC model requires ellipsoidal elevation. <a href="raster-algebra-and-analytics.html#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABJHCFE">Example 5-21</a> offsets the orthometric DEM by the geoid height, resulting in an ellipsoidal DEM. 
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE 
  geor1    SDO_GEORASTER;
  geor2    SDO_GEORASTER;
BEGIN
  --Source GeoRaster object with a single orthometric DEM layer
  select georaster into geor1 from georaster_table where georid = 1;
  --To store the output DEM layer
  select georaster into geor2 from georaster_table where georid = 2 for update;
  --Offset elevation by geoid height to get ellipsoidal elevation
  sdo_geor_ra.rasterMathOp(geor1,SDO_STRING2_ARRAY('{0} - 28.8'),null,geor2);
  --Commit changes to the output GeoRaster object
  update georaster_table set georaster = geor2 where georid = 2;
  commit;
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABIFHIJ">
                     <p class="titleinexample">Example 5-22 Converting (Scaling) and Offsetting</p>
                     <p>You can combine the operations of <a href="raster-algebra-and-analytics.html#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABFGGJJ">Example 5-20</a> and <a href="raster-algebra-and-analytics.html#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABJHCFE">Example 5-21</a> into a single simple step, as shown in <a href="raster-algebra-and-analytics.html#GUID-34B59129-70AC-4E51-BF6D-2E43AA2A813B__BABIFHIJ">Example 5-22</a>. 
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE 
  geor1    SDO_GEORASTER;
  geor2    SDO_GEORASTER;
BEGIN
  --Source GeoRaster object with a single DEM layer
  select georaster into geor1 from georaster_table where georid = 1;
  --To store the output DEM layer
  select georaster into geor2 from georaster_table where georid = 2 for update;
  --Scale elevation from feet to meters and offset elevation by geoid height
  sdo_geor_ra.rasterMathOp(geor1,SDO_STRING2_ARRAY('{0} * 0.3048 - 28.8'),null,geor2);
  --Commit changes to the output georaster object
  update georaster_table set georaster = geor2 where georid = 2;
  commit;
END;
/</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1271"></a><a id="GEORS1270"></a><div class="props_rev_3"><a id="GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27" name="GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27"></a><h3 id="GEORS-GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27" class="sect3"><span class="enumeration_section">5.9 </span>Raster Data Casting
               </h3>
               <div>
                  <p>Raster data casting maps cell values from one data type to another.</p>
                  <p>In GeoRaster, there are two types of casting operations: one uses the <code class="codeph">cellDepth</code> keyword in the <code class="codeph">storageParam</code> parameter of operations, and the other uses the <code class="codeph">castingExpr</code> operation in the GeoRaster raster algebra. (<code class="codeph">castingExpr</code> is one of the <code class="codeph">arithmeticExpr</code> operations, as described in <a href="raster-algebra-and-analytics.html#GUID-A6F087DC-1E7E-4426-B778-8554A25B3494" title="Raster algebra is commonly used in raster data analysis and GIS modeling. In GeoRaster, raster algebra is supported by the GeoRaster raster algebra language.">Raster Algebra Language</a>.)
                  </p>
                  <p>Whenever you apply an operation which stores the raster data result into a new GeoRaster object, you can use the <code class="codeph">cellDepth</code> keyword in the <code class="codeph">storageParam</code> parameter of that operation. (The <code class="codeph">cellDepth</code> keyword and its values are described in <a href="georaster-overview-and-concepts.html#GUID-4B5901B5-879D-4E5F-BE73-2242F3D7CF9D__CHDHJCBF" title="This 2 column table lists the storageParam Keywords for Raster Data. Column 1 is the keyword. Column 2 explains the keyword.">Table 1-1</a>.) If the <code class="codeph">cellDepth</code> is specified, the target GeoRaster object will be created using that <code class="codeph">cellDepth</code> value, and the raster cell data will be automatically cast to that <code class="codeph">cellDepth</code> value for storage. You can directly use <code class="codeph">cellDepth</code> in the <code class="codeph">storageParam</code> parameter to do the casting if the source data is in lower cell depth and the resulting data is in higher cell depth. In this case, the casting is transparent and fast.
                  </p>
                  <p>However, if you specify a <span class="italic">lower</span> cell depth for data in higher cell depth, changing the cell depth using the <code class="codeph">cellDepth</code> keyword in the <code class="codeph">storageParam</code> parameter can cause loss or change of data and reduced precision or quality. To have better control of the precision and accuracy, you can use the Raster Algebra casting operator, <code class="codeph">castingExpr</code>.
                  </p>
                  <p>For example, assume you have a raster with a cell depth of <code class="codeph">32BIT_REAL</code> and a value range in [0.0, 100.0). You can use <a href="raster-algebra-and-analytics.html#GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27__BABGCGIG">Example 5-23</a> to perform linear segmentation of the raster into 10 different classes, each of which has a cell value that is a multiple of 10 (0, 10, 20, , 90), using the <code class="codeph">castint</code> operator. This operation casts all cell values to their closest lower multiple of 10; for example, all numbers from 60 to 69 are cast to 60.
                  </p>
                  <div class="example" id="GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27__BABGCGIG">
                     <p class="titleinexample">Example 5-23 Linear Segmentation of a Raster</p><pre class="oac_no_warn" dir="ltr">DECLARE 
  geor1    SDO_GEORASTER;
  geor2    SDO_GEORASTER;
BEGIN
  --Source georaster object with cell value range [0.0,100.0) 
  select georaster into geor1 from georaster_table where georid = 1;
  --Target georaster object to store the output layer
  select georaster into geor2 from georaster_table where georid = 2 for update;
  --Linearly segment the source raster into 10 classes and store in 8BIT cell depth
  sdo_geor_ra.rasterMathOp(geor1,
    SDO_STRING2_ARRAY('(<span class="bold">castint({0}/10)*10</span>'),
    '<span class="bold">celldepth=8BIT</span>',
    geor2);
  --Commit changes to the output georaster object
  update georaster_table set georaster = geor2 where georid = 2;
  commit;
END;
/
</pre><p>As shown in <a href="raster-algebra-and-analytics.html#GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27__BABGCGIG">Example 5-23</a>, you can combine the usage of the <code class="codeph">cellDepth</code> keyword in the <code class="codeph">storageParam</code> parameter with the raster algebra casting operator, so that the result can be calculated correctly as well as stored in an appropriate and concise way. In <a href="raster-algebra-and-analytics.html#GUID-13B8293B-2AE1-4687-B98A-9463EF42AC27__BABGCGIG">Example 5-23</a>, the output cell values are integers equal to or less than 90, so the resulting raster can be stored using <code class="codeph">8BIT</code> cell depth (instead of <code class="codeph">32BIT_REAL</code>), which saves storage space. 
                     </p>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1273"></a><a id="GEORS1272"></a><div class="props_rev_3"><a id="GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166" name="GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166"></a><h3 id="GEORS-GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166" class="sect3"><span class="enumeration_section">5.10 </span>Cartographic Modeling
               </h3>
               <div>
                  <p>Raster algebra is widely used in cartographic modeling and is considered an essential component of GIS systems. Using the PL/SQL and the raster algebra expressions and functions, you can conduct cartographic modeling over a large number of rasters and images of virtually unlimited size.</p>
                  <p>For example, a cartographic modeling process for wildfire evaluation might retrieve the elevation, slope, aspect, temperature, wetness, and other information from a series of raster layers and then evaluate the cells one-by-one to create a resulting raster map, which can be further classified to create a thematic map. Change analysis, site selection, suitability analysis, climate modeling, and oil field evaluation using the raster layer overlay technique are other typical cartographic modeling processes. In those cases, arithmetic, relational, and logical operations may need to be combined.</p>
                  <p>Assume that a hypothetical cartographic model involves seven different raster layers and has an expression as follows. and that the modeling result is a raster map with 0 and 1 as cell values:</p><pre class="oac_no_warn" dir="ltr">output = 1 if ( (100 &lt; layer1 &lt;= 500) 
                &amp; (layer2 == 3 or layer2 == 10) 
                &amp; ( (layer3+layer4) * log(Layer5) / sqrt(layer5) ) &gt;= layer6) 
                || (layer7 != 1) ) 
                is TRUE and
         0 if otherwise
</pre><p><a href="raster-algebra-and-analytics.html#GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166__BABGEBDG">Example 5-24</a> shows how to run the preceding cartographic model in GeoRaster and store the result as a bitmap.
                  </p>
                  <div class="example" id="GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166__BABGEBDG">
                     <p class="titleinexample">Example 5-24 Cartographic Modeling</p><pre class="oac_no_warn" dir="ltr">DECLARE 
  geor       SDO_GEORASTER;
  geor1      SDO_GEORASTER;
  mycursor   sys_refcursor;
  expr       varchar2(1024);
BEGIN
  --7 source GeoRaster objects, each of which contains one source layer in the order of 1 to 7
  OPEN mycursor FOR
    select georaster from georaster_table where georid &gt;0 and georid &lt;=7 order by georid;
  --Output GeoRaster object to contain the result
  insert into georaster_table (georid, georaster) values (8, sdo_geor.init('RDT_1',8))
    returning georaster into geor1;
  --Modeling using arithmeticExpr, booleanExpr, and rasterMathOp 
  expr := 
   'condition(
         ( (100&lt;{0,0}) &amp; ({0,0}&lt;=500) )
           &amp; ( ({1,0}=3) | ({1,0}=10) )
           &amp; ( ( ( ({2,0}+{3,0}) * log({4,0} ) / sqrt({4,0}) ) &gt;= {5,0} ) | ({6,0}!=1) 
         ),
         1,
         0)';
  sdo_geor_ra.rasterMathOp(mycursor, sdo_string2_array(expr), 
                           'celldepth=1BIT', geor1, 'true', 0, 'parallel=4');
  update georaster_table set georaster = geor1 where georid = 8;
  commit;
END;
/
</pre><p>The process in <a href="raster-algebra-and-analytics.html#GUID-F2EBC84A-8BB8-484B-9F32-FC88D4E5F166__BABGEBDG">Example 5-24</a> considers NODATA and will assign 0 (zero) to any cell that is a NODATA cell in one or more source layers. It is also parallelized into four processes to leverage multiple CPUs of the database server to improve performance. 
                     </p>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-90AF506E-C29A-464F-95F8-2923E79AFE9B" name="GUID-90AF506E-C29A-464F-95F8-2923E79AFE9B"></a><h3 id="GEORS-GUID-90AF506E-C29A-464F-95F8-2923E79AFE9B" class="sect3"><span class="enumeration_section">5.11 </span>Terrain Modeling and Analysis
               </h3>
               <div>
                  <p>You can use the data from input GeoRaster objects to perform terrain modeling and analysis.</p>
                  <p>The <a href="SDO_GEOR_GDAL-reference.html#GUID-1129639F-CFCD-40EB-ADE0-400EC9B4A459">SDO_GEOR_GDAL.dem</a> procedure uses the data from an input GeoRaster object to generate output based on the specified <code class="codeph">processing</code> parameter. The input GeoRaster object is usually a Digital Elevation Model, and the <code class="codeph">processing</code> values could be a value such as <code class="codeph">hillshade</code>, <code class="codeph">slope</code>, <code class="codeph">aspect</code>, <code class="codeph">color-relief</code>, or <code class="codeph">roughness</code>.
                  </p>
                  <div class="example" id="GUID-90AF506E-C29A-464F-95F8-2923E79AFE9B__GUID-5D8A86BF-1F62-466C-A93A-236F46B32556">
                     <p class="titleinexample">Example 5-25 Hillshade</p>
                     <p>If the <code class="codeph">processing</code> parameter value is <code class="codeph">hillshade</code> the procedue generates a grayscale image that represent the shadows of the elevated areas over the adjacent areas, mimicking the visual effect of sunlight.
                     </p>
                     <p>This example creates a hillshade image.</p><pre class="pre codeblock"><code>DECLARE
  gr1 sdo_georaster;
  gr2 sdo_georaster;
BEGIN
  select raster into gr1 from imagery where id = 1;
  delete from imagery where id = 2;
  insert into imagery values(2, sdo_geor.init('imagery_rdt',2))
         returning raster into gr2;
  sdo_geor_gdal.dem(gr1, gr2, 'hillshade');
  update imagery set raster = gr2 where id = 2;
  commit;
END;
/
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-90AF506E-C29A-464F-95F8-2923E79AFE9B__GUID-60221756-B417-4C62-80F2-70A1D4F81D2B">
                     <p class="titleinexample">Example 5-26 Slope</p>
                     <p>The procedure can generate a slope or aspect raster based on the elevation values of an input raster. In that case the output pixel values does not produce a visual appealing output, but a useful raster surface that might be used for land use and land allocation analyses. For example, it could be used to define areas good for wine production based on the slope and the angle of exposure to the sun (aspect). </p>
                     <p>The following example creates a raster representing the slope generated from raster elevation data. The resulting pixel values will be represented in percentage, instead of the default degree output.</p><pre class="pre codeblock"><code>DECLARE
  gr1 sdo_georaster;
  gr3 sdo_georaster;
BEGIN
  select raster into gr1 from imagery where id = 1;
  delete from imagery where id = 3;
  insert into imagery values(3, sdo_geor.init('imagery_rdt', 3))
         returning raster into gr3;
  sdo_geor_gdal.dem(gr1, gr3, 'slope', 'slopevalue=percent');
  update imagery set raster = gr3 where id = 3;
  commit;
END;
/
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-90AF506E-C29A-464F-95F8-2923E79AFE9B__GUID-551953E4-596F-425D-BC7D-3F54FA847919">
                     <p class="titleinexample">Example 5-27 Aspect</p>
                     <p>This example creates a raster representing the aspect o generated from raster elevation data. The pixel representing flat areas will have the value 0 instead of the default -9999.</p><pre class="pre codeblock"><code>DECLARE
  gr1 sdo_georaster;
  gr4 sdo_georaster;
BEGIN
  select raster into gr1 from imagery where id = 1;
  delete from imagery where id = 4;
  insert into imagery values(4, sdo_geor.init('imagery_rdt', 4))
         returning raster into gr4;
  sdo_geor_gdal.dem(gr1, gr4, 'aspect', 'zeroforflat=yes');
  update imagery set raster = gr4 where id = 4;
  commit;
END;
/
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-90AF506E-C29A-464F-95F8-2923E79AFE9B__GUID-CAFD8DB2-7F40-4243-AFE1-226D6F38FAA9">
                     <p class="titleinexample">Example 5-28 Color-relief</p>
                     <p>This example creates a raster representing the color-relief  generated from raster elevation data using the file colorfile.txt. For this example, the <code class="codeph">colorfile.txt</code> file contains the following "elevation-percent red green blue" values
                     </p><pre class="oac_no_warn" dir="ltr">0%  180   0 255
10%  70   0 255
20%   0  70 255
30%   0 180 255
40%   0 255 180
50%   0 255  70
60%  70 255   0
70% 180 255   0
80% 255 180   0
90% 255  70   0
nv    0   0   0
</pre><pre class="pre codeblock"><code>DECLARE
  gr1 sdo_georaster;
  gr5 sdo_georaster;
BEGIN
  select raster into gr1 from imagery where id = 1;
  delete from imagery where id = 5;
  insert into imagery values(5, sdo_geor.init('imagery_rdt', 5))
         returning raster into gr5;
  sdo_geor_gdal.dem(inGeoRaster    =&gt; gr1,
                    outGeoRaster   =&gt; gr5, 
                    processing     =&gt; 'color-relief', 
                    colorDirectory =&gt; 'mydir,
                    colorFilename  =&gt; 'colorfile.txt');
  update imagery set raster = gr5 where id = 5;
  commit;
END;
/
</code></pre><p>In addition to the operations shown in these examples, you can use the procedure to generate  Terrain Ruggedness Index (TRI) maps,  Topographic Position Index (TPI) maps, and roughness maps from DEM GeoRaster objects.</p>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>