<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="SQL Performance Analyzer supports testing database upgrades from Oracle9i and later releases to Oracle Database 10g Release 2 or newer releases.">
      <meta name="description" content="SQL Performance Analyzer supports testing database upgrades from Oracle9i and later releases to Oracle Database 10g Release 2 or newer releases.">
      <title>Testing a Database Upgrade</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Testing Guide ">
      <meta property="og:description" content="SQL Performance Analyzer supports testing database upgrades from Oracle9i and later releases to Oracle Database 10g Release 2 or newer releases.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Testing Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="testing-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-07T01:43:11-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2008, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96279-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-spa-quick-check.html" title="Previous" type="text/html">
      <link rel="next" href="database-replay.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Testing Guide">
    <meta name="dcterms.isVersionOf" content="RATUG">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-spa-quick-check.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="database-replay.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Testing Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="sql-performance-analyzer.html" property="item" typeof="WebPage"><span property="name"> SQL Performance Analyzer </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Testing a Database Upgrade </li>
            </ol>
            <a id="GUID-41A30909-3D5B-4A53-A757-B3497498D36B" name="GUID-41A30909-3D5B-4A53-A757-B3497498D36B"></a><a id="RATUG210"></a>
            
            <h2 id="RATUG-GUID-41A30909-3D5B-4A53-A757-B3497498D36B" class="sect2"><span class="enumeration_chapter">8 </span> Testing a Database Upgrade 
            </h2>
         </header>
         <div class="ind">
            <div>
               <div><span>SQL Performance Analyzer supports testing database upgrades from Oracle9<span class="italic">i</span> and later releases to Oracle Database 10<span class="italic">g</span> Release 2 or newer releases.</span> The methodology used to test a database upgrade from Oracle9<span class="italic">i</span> Database and Oracle Database 10<span class="italic">g</span> Release 1 is slightly different from the one used to test a database upgrade from Oracle Database 10<span class="italic">g</span> Release 2 and later releases, so both methodologies are described here.
               </div>
               <p>This chapter describes how to use SQL Performance Analyzer in a database upgrade and contains the following sections:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="testing-a-database-upgrade.html#GUID-54F449B7-987E-496E-AD15-97F0B6A70C66" title="SQL Performance Analyzer supports testing database upgrades of Oracle9i Database and Oracle Database 10g Release 1 to Oracle Database 11g Release 2 or higher releases.">Upgrading from Oracle9i Database and Oracle Database 10g Release 1</a></p>
                  </li>
                  <li>
                     <p><a href="testing-a-database-upgrade.html#GUID-AD6C3094-99C3-4F3D-A387-C7C70ACC43C4" title="You can use SQL Performance Analyzer to test the impact on SQL response time of a database upgrade from Oracle Database 10g Release 2 or a newer release to any later release by capturing a SQL tuning set on the production system, then executing it twice remotely over a database link on a test system—first to create a pre-change SQL trial, then again to create a post-change SQL trial.">Upgrading from Oracle Database 10g Release 2 and Newer Releases</a></p>
                  </li>
                  <li>
                     <p><a href="testing-a-database-upgrade.html#GUID-DAF2B96B-20A0-408D-BDD7-364AC1113614" title="In some cases, SQL Performance Analyzer may identify SQL statements whose performance regressed after you upgrade the database on the test system.">Tuning Regressed SQL Statements After Testing a Database Upgrade</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-41A30909-3D5B-4A53-A757-B3497498D36B__GUID-93AF8955-8816-4CF0-A6C0-2C1AD9DD91B0">
                  <p class="notep1">See Also:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="q">"<a href="introduction-to-oracle-database-testing.html#GUID-F2920E05-3680-4699-B074-92DBEF682B70" title="System changes—such as a upgrading a database or adding an index—may cause changes to execution plans of SQL statements, resulting in a significant impact on SQL performance.">SQL Performance Analyzer</a>"</span> for information about using SQL Performance Analyzer in other cases
                        </p>
                     </li>
                     <li>
                        <p><a href="../upgrd/oracle-database-releases-that-support-direct-upgrade.html#UPGRD-GUID-7AA90913-D8AB-4EBA-944F-31FA01D6BE5D" target="_blank"><span><cite>Oracle Database Upgrade Guide</cite></span></a> for information on upgrade paths for Oracle Database 12<span class="italic">c</span></p>
                     </li>
                  </ul>
               </div>
            </div><a id="RATUG249"></a><a id="RATUG211"></a><div class="props_rev_3"><a id="GUID-54F449B7-987E-496E-AD15-97F0B6A70C66" name="GUID-54F449B7-987E-496E-AD15-97F0B6A70C66"></a><h3 id="RATUG-GUID-54F449B7-987E-496E-AD15-97F0B6A70C66" class="sect3"><span class="enumeration_section">8.1 </span>Upgrading from Oracle9<span class="italic">i</span> Database and Oracle Database 10<span class="italic">g</span> Release 1
               </h3>
               <div>
                  <div><span>SQL Performance Analyzer supports testing database upgrades of Oracle9<span class="italic">i</span> Database and Oracle Database 10<span class="italic">g</span> Release 1 to Oracle Database 11g Release 2 or higher releases.</span> Use the following steps and see <a href="testing-a-database-upgrade.html#GUID-54F449B7-987E-496E-AD15-97F0B6A70C66__CIAHCDCE">Figure 8-1</a>:
                  </div>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Building a SQL tuning set from SQL trace files captured on the production system</p>
                     </li>
                     <li>
                        <p>Executing the SQL tuning set on the upgraded database remotely over a database link</p>
                     </li>
                     <li>
                        <p>Comparing the results to those captured on the production system</p>
                     </li>
                  </ul>
                  <p>Because SQL Performance Analyzer only accepts a set of SQL statements stored in a SQL tuning set as its <a id="d14012e260" class="indexterm-anchor"></a>input source, and SQL tuning sets are not supported for Oracle9<span class="italic">i</span> Database, a SQL tuning set must be constructed so that it can be used as an input source for SQL Performance Analyzer if you are upgrading from Oracle9<span class="italic">i</span> Database.
                  </p>
                  <div class="figure" id="GUID-54F449B7-987E-496E-AD15-97F0B6A70C66__CIAHCDCE">
                     <p class="titleinfigure">Figure 8-1 SQL Performance Analyzer Workflow for Database Upgrade from Oracle9i or 10g Release 1 to Oracle Database 11g Release 2 or Higher</p><img src="img/ratug003b.png" width="511" alt="Description of Figure 8-1 follows" title="Description of Figure 8-1 follows" longdesc="img_text/ratug003b.html"><br><a href="img_text/ratug003b.html">Description of "Figure 8-1 SQL Performance Analyzer Workflow for Database Upgrade from Oracle9i or 10g Release 1 to Oracle Database 11g Release 2 or Higher"</a></div>
                  <!-- class="figure" -->
                  <p>Before the database upgrade can be tested, ensure that the following conditions are met:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a id="d14012e281" class="indexterm-anchor"></a>The <a id="d14012e284" class="indexterm-anchor"></a>production system which you are upgrading from is running Oracle9<span class="italic">i</span> (9.2.0.8) or Oracle Database 10<span class="italic">g</span> Release 1 (10.1.0.5).
                        </p>
                     </li>
                     <li>
                        <p>The <a id="d14012e298" class="indexterm-anchor"></a>test system which you are upgrading to is running Oracle Database 11<span class="italic">g</span> Release 2 or higher.
                        </p>
                        <p>The database version can be release 11.2.0.3 or higher.</p>
                     </li>
                     <li>
                        <p>The test system must resemble the production system as closely as possible because the performance on both systems will be compared to each other.</p>
                     </li>
                     <li>
                        <p>The hardware configurations on both systems must also be as similar as possible.</p>
                     </li>
                  </ul>
                  <p>You will also need to set up a separate SQL Performance Analyzer <a id="d14012e316" class="indexterm-anchor"></a>system running Oracle Database 12<span class="italic">c</span> Release 2. You will be using this system to build a SQL tuning set and to run SQL Performance Analyzer. Neither your production data or schema need to be available on this system, since the SQL tuning set will be built using statistics stored in the SQL trace files from the production system. SQL Performance Analyzer tasks will be executed remotely on the test system to generate the execution plan and statistics for the SQL trial over a database link that you specify. The database link must be a public database link that connects to a user with the <code class="codeph">EXECUTE</code> privilege for the <code class="codeph">DBMS_SQLPA</code> package and the <code class="codeph">ADVISOR</code> privilege on the test system. You should also drop any existing <code class="codeph">PLAN_TABLE</code> from the user's schema on the test system.
                  </p>
                  <p>Once the upgrade environment is configured as described, perform the steps as described in the following procedure to use SQL Performance Analyzer in a database upgrade from Oracle9<span class="italic">i</span> or Oracle Database 10<span class="italic">g</span> Release 1 to a newer release.
                  </p>
                  <ol>
                     <li>
                        <p>Enable the <a id="d14012e349" class="indexterm-anchor"></a>SQL Trace facility on the production system, as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-216BB723-4FC6-4AD6-A641-79BE9AD9F819" title="Oracle9i uses the SQL Trace facility to collect performance data on individual SQL statements.">Enabling SQL Trace on the Production System</a>"</span>.
                        </p>
                        <p>To minimize the performance impact on the production system and still be able to fully capture a representative set of SQL statements, consider enabling SQL Trace for only a subset of the sessions, for as long as required, to capture all important SQL statements at least once.</p>
                     </li>
                     <li>
                        <p>On the production system, create a <a id="d14012e369" class="indexterm-anchor"></a>mapping table, as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-EB1B032E-CFF2-4057-B9BE-02AF45383316" title="To convert the user and object identifier numbers stored in the SQL trace files to their respective names, you need to provide a table that specifies each mapping.">Creating a Mapping Table</a>"</span>.
                        </p>
                        <p>This mapping table will be used to convert the user and object identifier numbers in the SQL trace files to their string equivalents.</p>
                     </li>
                     <li>
                        <p>Move the <a id="d14012e386" class="indexterm-anchor"></a>SQL trace files and the <a id="d14012e391" class="indexterm-anchor"></a>mapping table from the production system to the SQL Performance Analyzer system, as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-EB1B032E-CFF2-4057-B9BE-02AF45383316" title="To convert the user and object identifier numbers stored in the SQL trace files to their respective names, you need to provide a table that specifies each mapping.">Creating a Mapping Table</a>"</span>.
                        </p>
                     </li>
                     <li>
                        <p>On the SQL Performance Analyzer system, construct a <a id="d14012e406" class="indexterm-anchor"></a>SQL tuning set using the SQL trace files, as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-E6298851-9BF4-4B96-8F93-D5483278F8DA" title="Once the SQL trace files and mapping table are moved to the SQL Performance Analyzer system, you can build a SQL tuning set using the DBMS_SQLTUNE package.">Building a SQL Tuning Set</a>"</span>.
                        </p>
                        <p>The SQL tuning set will contain the SQL statements captured in the SQL trace files, along with their relevant execution context and statistics.</p>
                     </li>
                     <li>
                        <p>On the SQL Performance Analyzer system, use SQL Performance Analyzer to create a <a id="d14012e426" class="indexterm-anchor"></a>SQL Performance Analyzer task and convert the contents in the <a id="d14012e433" class="indexterm-anchor"></a>SQL tuning set into a pre-upgrade <a id="d14012e438" class="indexterm-anchor"></a>SQL trial that will be used as a baseline for comparison, then remotely test execute the SQL statements on the test system over a database link to build a post-upgrade <a id="d14012e445" class="indexterm-anchor"></a>SQL trial, as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-5B437942-8CF6-4F6C-864B-996BB61B4C26" title="Once the SQL tuning set is built, you can use SQL Performance Analyzer to build a pre-upgrade SQL trial from the execution plans and run-time statistics in the SQL tuning set. After the pre-upgrade SQL trial is built, perform a test execute or generate plans of SQL statements in the SQL tuning set on the test system to build a post-upgrade SQL trial.">Testing Database Upgrades from Oracle9i Database and Oracle Database 10g Release 1</a>"</span>.
                        </p>
                     </li>
                     <li>
                        <p>Compare <a id="d14012e462" class="indexterm-anchor"></a>SQL performance and fix <a id="d14012e467" class="indexterm-anchor"></a>regressed SQL.
                        </p>
                        <p>SQL Performance Analyzer compares the performance of SQL statements read from the SQL tuning set during the pre-upgrade SQL trial to those captured from the remote test execution during the post-upgrade SQL trial. A report is produced to identify any changes in execution plans or performance of the SQL statements.</p>
                        <p>If the report reveals any regressed SQL statements, you can make further changes to fix the regressed SQL, as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-DAF2B96B-20A0-408D-BDD7-364AC1113614" title="In some cases, SQL Performance Analyzer may identify SQL statements whose performance regressed after you upgrade the database on the test system.">Tuning Regressed SQL Statements After Testing a Database Upgrade</a>"</span>.
                        </p>
                        <p>Repeat the process of executing the SQL tuning set and comparing its performance to a previous execution to test any changes made until you are satisfied with the outcome of the analysis.</p>
                     </li>
                  </ol>
               </div><a id="RATUG212"></a><div class="props_rev_3"><a id="GUID-216BB723-4FC6-4AD6-A641-79BE9AD9F819" name="GUID-216BB723-4FC6-4AD6-A641-79BE9AD9F819"></a><h4 id="RATUG-GUID-216BB723-4FC6-4AD6-A641-79BE9AD9F819" class="sect4"><span class="enumeration_section">8.1.1 </span>Enabling SQL Trace on the Production System
                  </h4>
                  <div>
                     <div><span>Oracle9<span class="italic">i</span> uses the SQL Trace facility to collect performance data on individual SQL statements.</span> The information generated by SQL Trace is stored in SQL trace files. SQL Performance Analyzer consumes the following information from these files:
                     </div>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>SQL text and username under which parse occurred</p>
                        </li>
                        <li>
                           <p>Bind values for each execution</p>
                        </li>
                        <li>
                           <p>CPU and elapsed times</p>
                        </li>
                        <li>
                           <p>Physical reads and logical reads</p>
                        </li>
                        <li>
                           <p>Number of rows processed</p>
                        </li>
                        <li>
                           <p>Execution plan for each SQL statement (only captured if the cursor for the SQL statement is closed)</p>
                        </li>
                     </ul>
                     <p>Although it is possible to enable <a id="d14012e599" class="indexterm-anchor"></a>SQL Trace for an instance, it is recommended that you enable SQL Trace for a subset of sessions instead. When the SQL Trace facility is enabled for an instance, performance statistics for all SQL statements executed in the instance are stored into SQL trace files. Using SQL Trace in this way can have a severe performance impact and may result in increased system overhead, excessive CPU usage, and inadequate disk space. It is required that <a id="d14012e604" class="indexterm-anchor"></a>trace level be set to 4 to capture bind values, along with the execution plans.
                     </p>
                     <p>For production systems running Oracle Database 10<span class="italic">g</span> Release 1, use the <code class="codeph">DBMS_MONITOR</code>.<code class="codeph">SESSION_TRACE_ENABLE</code> procedure to enable SQL Trace transparently in another session. You should also enable binds explicitly by setting the <code class="codeph">binds</code> procedure parameter to <code class="codeph">TRUE</code> (its default value is <code class="codeph">FALSE</code>).
                     </p>
                     <p>After enabling SQL Trace, identify the SQL trace files containing statistics for a representative set of SQL statements that you want to use with SQL Performance Analyzer. You can then copy the <a id="d14012e632" class="indexterm-anchor"></a>SQL trace files to the SQL Performance Analyzer system. Once the SQL workload is captured in the SQL trace files, disable SQL Trace on the production system.
                     </p>
                     <div class="infoboxnotealso" id="GUID-216BB723-4FC6-4AD6-A641-79BE9AD9F819__GUID-04CB243D-C80C-44C9-8BD4-8CB977623260">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../tgsql/performing-application-tracing.html#TGSQL791" target="_blank"><span><cite>Oracle Database SQL Tuning Guide</cite></span></a> for additional considerations when using SQL Trace, such as setting initialization parameters to manage SQL trace files
                              </p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_MONITOR.html#ARPLS091" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about the <code class="codeph">DBMS_MONITOR</code> package
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="RATUG213"></a><div class="props_rev_3"><a id="GUID-EB1B032E-CFF2-4057-B9BE-02AF45383316" name="GUID-EB1B032E-CFF2-4057-B9BE-02AF45383316"></a><h4 id="RATUG-GUID-EB1B032E-CFF2-4057-B9BE-02AF45383316" class="sect4"><span class="enumeration_section">8.1.2 </span>Creating a Mapping Table
                  </h4>
                  <div>
                     <div><span>To convert the user and object identifier numbers stored in the SQL trace files to their respective names, you need to provide a table that specifies each mapping.</span> The SQL Performance Analyzer system will read this mapping table when converting the trace files into a SQL tuning set.
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-EB1B032E-CFF2-4057-B9BE-02AF45383316__GUID-6A560705-8951-46AF-8404-509EAC4C34EE">To create a mapping table:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Run the following SQL statements on the production database:</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE mapping AS
    SELECT object_id id, owner, SUBSTR(object_name, 1, 30) name FROM dba_objects
    WHERE object_type NOT IN ('CONSUMER GROUP', 'EVALUATION CONTEXT', 'FUNCTION',
                              'INDEXTYPE', 'JAVA CLASS', 'JAVA DATA',
                              'JAVA RESOURCE', 'LIBRARY', 'LOB', 'OPERATOR',
                              'PACKAGE', 'PACKAGE BODY', 'PROCEDURE', 'QUEUE',
                              'RESOURCE PLAN', 'SYNONYM', 'TRIGGER', 'TYPE',
                              'TYPE BODY')
    UNION ALL
    SELECT user_id id, username owner, null name FROM dba_users;
</pre><p>Once the <a id="d14012e760" class="indexterm-anchor"></a>mapping table is created, you can use Data Pump to transport it to the SQL Performance Analyzer system.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-EB1B032E-CFF2-4057-B9BE-02AF45383316__GUID-44377AC2-8BF6-4E6E-901F-2A6251A477A1">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../sutil/oracle-data-pump-overview.html#SUTIL100" target="_blank"><span><cite>Oracle Database Utilities</cite></span></a> for information about using Data Pump
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG250"></a><a id="RATUG214"></a><div class="props_rev_3"><a id="GUID-E6298851-9BF4-4B96-8F93-D5483278F8DA" name="GUID-E6298851-9BF4-4B96-8F93-D5483278F8DA"></a><h4 id="RATUG-GUID-E6298851-9BF4-4B96-8F93-D5483278F8DA" class="sect4"><span class="enumeration_section">8.1.3 </span>Building a SQL Tuning Set
                  </h4>
                  <div>
                     <p>Once the SQL trace files and mapping table are moved to the SQL Performance Analyzer system, you can build a SQL tuning set using the <code class="codeph">DBMS_SQLTUNE</code> package.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-E6298851-9BF4-4B96-8F93-D5483278F8DA__GUID-BE4F4F1C-8061-40E3-9B40-FC6091830082">To build a SQL tuning set:</p>
                        <ol>
                           <li>
                              <p>Copy the SQL trace files to a directory on the SQL Performance Analyzer system.</p>
                           </li>
                           <li>
                              <p>Create a directory object for this directory.</p>
                           </li>
                           <li>
                              <p>Use the <code class="codeph">DBMS_SQLTUNE</code>.<a id="d14012e880" class="indexterm-anchor"></a><code class="codeph">SELECT_SQL_TRACE</code> function to read the SQL statements from the SQL trace files.
                              </p>
                              <p>For each SQL statement, only information for a single execution is collected. The execution frequency of each SQL statement is not captured. Therefore, when performing a comparison analysis for a production system running Oracle Database 10<span class="italic">g</span> Release 1 and older releases, you should ignore the workload-level statistics in the SQL Performance Analyzer report and only evaluate performance changes on an execution level.
                              </p>
                              <p>The following example reads the contents of SQL trace files stored in the <code class="codeph">sql_trace_prod</code> directory object and loads them into a SQL tuning set. 
                              </p><pre class="oac_no_warn" dir="ltr">DECLARE
  cur sys_refcursor;
BEGIN
  DBMS_SQLTUNE.CREATE_SQLSET('my_sts_9i');
  OPEN cur FOR
    SELECT VALUE (P) 
    FROM table(DBMS_SQLTUNE.SELECT_SQL_TRACE('sql_trace_prod', '%ora%')) P;
  DBMS_SQLTUNE.LOAD_SQLSET('my_sts_9i', cur);
  CLOSE cur;
END;
/
</pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The syntax for the <code class="codeph">SELECT_SQL_TRACE</code> function is as follows:
                        </p><pre class="oac_no_warn" dir="ltr">  DBMS_SQLTUNE.SELECT_SQL_TRACE ( 
    directory              IN VARCHAR2,
    file_name              IN VARCHAR2 := NULL,
    mapping_table_name     IN VARCHAR2 := NULL,
    mapping_table_owner    IN VARCHAR2 := NULL,
    select_mode            IN POSITIVE := SINGLE_EXECUTION,
    options                IN BINARY_INTEGER := LIMITED_COMMAND_TYPE,
    pattern_start          IN VARCHAR2 := NULL,
    parttern_end           IN VARCHAR2 := NULL,
    result_limit           IN POSITIVE := NULL)
  RETURN sys.sqlset PIPELINED;
</pre><p><a href="testing-a-database-upgrade.html#GUID-E6298851-9BF4-4B96-8F93-D5483278F8DA__CIAHBDDF" title="This table lists the parameters and descriptions of each parameter for the DBMS_SQLTUNE.SELECT_SQL_TRACE function">Table 8-1</a> describes the available parameters for the <code class="codeph">SELECT_SQL_TRACE</code> function.
                        </p>
                        <div class="tblformal" id="GUID-E6298851-9BF4-4B96-8F93-D5483278F8DA__CIAHBDDF">
                           <p class="titleintable">Table 8-1 DBMS_SQLTUNE.SELECT_SQL_TRACE Function Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_SQLTUNE.SELECT_SQL_TRACE Function Parameters" summary="This table lists the parameters and descriptions of each parameter for the DBMS_SQLTUNE.SELECT_SQL_TRACE function" width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d14012e926">Parameter</th>
                                    <th align="left" valign="bottom" width="69%" id="d14012e929">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d14012e934" headers="d14012e926 ">
                                       <p><code class="codeph">directory</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d14012e934 d14012e929 ">
                                       <p>Specifies the directory object pointing to the directory where the SQL trace files are stored.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d14012e942" headers="d14012e926 ">
                                       <p><code class="codeph">file_name</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d14012e942 d14012e929 ">
                                       <p>Specifies all or part of the name of the SQL trace files to process. If unspecified, the current or most recent trace file in the specified directory will be used. % wildcards are supported for matching trace file names.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d14012e950" headers="d14012e926 ">
                                       <p><code class="codeph">mapping_table_name</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d14012e950 d14012e929 ">
                                       <p>Specifies the name of the mapping table. If set to the default value of <code class="codeph">NULL</code>, mappings from the current database will be used. Note that the mapping table name is not case-sensitive.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d14012e961" headers="d14012e926 ">
                                       <p><code class="codeph">mapping_table_owner</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d14012e961 d14012e929 ">
                                       <p>Specifies the schema where the mapping table resides. If set to <code class="codeph">NULL</code>, the current schema will be used.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d14012e972" headers="d14012e926 ">
                                       <p><code class="codeph">select_mode</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d14012e972 d14012e929 ">
                                       <p>Specifies the mode for selecting SQL statements from the trace files. The default value is <code class="codeph">SINGLE_EXECUTION</code>. In this mode, only statistics for a single execution per SQL statement will be loaded into the SQL tuning set. The statistics are not cumulative, as is the case with other SQL tuning set data source table functions.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d14012e983" headers="d14012e926 ">
                                       <p><code class="codeph">options</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d14012e983 d14012e929 ">
                                       <p>Specifies the options for the operation. The default value is <code class="codeph">LIMITED_COMMAND_TYPE</code>, only SQL types that are meaningful to SQL Performance Analyzer (such as <code class="codeph">SELECT</code>, <code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, and <code class="codeph">DELETE</code>) are returned from the SQL trace files.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d14012e1006" headers="d14012e926 ">
                                       <p><code class="codeph">pattern_start</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d14012e1006 d14012e929 ">
                                       <p>Specifies the opening delimiting pattern of the trace file sections to consider. This parameter is currently not used.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d14012e1014" headers="d14012e926 ">
                                       <p><code class="codeph">pattern_end</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d14012e1014 d14012e929 ">
                                       <p>Specifies the closing delimiting pattern of the trace file sections to process. This parameter is currently not used.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d14012e1022" headers="d14012e926 ">
                                       <p><code class="codeph">result_limit</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d14012e1022 d14012e929 ">
                                       <p>Specifies the top SQL from the (filtered) source. The default value is 2<sup>31</sup>, which represents unlimited.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnotealso" id="GUID-E6298851-9BF4-4B96-8F93-D5483278F8DA__GUID-159E47A0-CA66-4876-815D-E3734504CC0C">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS220" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about the <code class="codeph">DBMS_SQLTUNE</code> package
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="RATUG296"></a><div class="props_rev_3"><a id="GUID-5B437942-8CF6-4F6C-864B-996BB61B4C26" name="GUID-5B437942-8CF6-4F6C-864B-996BB61B4C26"></a><h4 id="RATUG-GUID-5B437942-8CF6-4F6C-864B-996BB61B4C26" class="sect4"><span class="enumeration_section">8.1.4 </span>Testing Database Upgrades from Oracle9<span class="italic">i</span> Database and Oracle Database 10<span class="italic">g</span> Release 1
                  </h4>
                  <div>
                     <div><span>Once the SQL tuning set is built, you can use SQL Performance Analyzer to build a pre-upgrade SQL trial from the execution plans and run-time statistics in the SQL tuning set. After the pre-upgrade SQL trial is built, perform a test execute or generate plans of SQL statements in the SQL tuning set on the test system to build a post-upgrade SQL trial.</span> SQL Performance Analyzer test executes the SQL statements using a public database link that you specify by connecting to the test system remotely and generating the execution plans and statistics for the SQL trial. The database link should exist on the SQL Performance Analyzer system and connect to a remote user with privileges to execute the SQL tuning set on the test system.
                     </div>
                     <p>You can run SQL Performance Analyzer to test a database upgrade from Oracle9<span class="italic">i</span> Database or Oracle Database 10<span class="italic">g</span> Release 1 using Oracle Enterprise Manager or APIs, as described in the following sections:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="testing-a-database-upgrade.html#GUID-83C485F8-C27E-44F9-A74C-2B3AF3DE75C1" title="To test a database upgrade from Oracle9i Database or Oracle Database 10g Release 1 using SQL Performance Analyzer:">Testing Database Upgrades from Releases 9.x and 10.1 Using Cloud Control</a></p>
                        </li>
                        <li>
                           <p><a href="testing-a-database-upgrade.html#GUID-C0CE4A85-70A6-40F7-A6EB-83612EBA8916" title="This section describes how to test database upgrades from Oracle Database releases 9.x and 10.1 using APIs.">Testing Database Upgrades from Releases 9.x and 10.1 Using APIs</a></p>
                        </li>
                     </ul>
                  </div><a id="RATUG297"></a><div class="props_rev_3"><a id="GUID-83C485F8-C27E-44F9-A74C-2B3AF3DE75C1" name="GUID-83C485F8-C27E-44F9-A74C-2B3AF3DE75C1"></a><h5 id="RATUG-GUID-83C485F8-C27E-44F9-A74C-2B3AF3DE75C1" class="sect5"><span class="enumeration_section">8.1.4.1 </span>Testing Database Upgrades from Releases 9.x and 10.1 Using Cloud Control
                     </h5>
                     <div>
                        <p>To test a database upgrade from Oracle9<span class="italic">i</span> Database or Oracle Database 10<span class="italic">g</span> Release 1 using SQL Performance Analyzer:
                        </p>
                        <div class="section">
                           <ol>
                              <li>
                                 <p>From the <span class="bold">Performance</span> menu, select <span class="bold">SQL</span>, then <span class="bold">SQL Performance Analyzer</span>.
                                 </p>
                                 <p>If the Database Login page appears, then log in as a user with administrator privileges.</p>
                                 <p>The SQL Performance Analyzer Home page appears.</p>
                              </li>
                              <li>
                                 <p>Under SQL Performance Analyzer Workflows, click <span class="bold">Upgrade from 9i or 10.1</span>.
                                 </p>
                                 <p>The Upgrade from 9i or higher releases page appears.</p>
                                 <div class="figure" id="GUID-83C485F8-C27E-44F9-A74C-2B3AF3DE75C1__GUID-36F0628A-F82D-4E5D-8540-4DEAFD178701"><img src="img/spa_upgrade_9i_101.gif" width="363" alt="Description of spa_upgrade_9i_101.gif follows" title="Description of spa_upgrade_9i_101.gif follows" longdesc="img_text/spa_upgrade_9i_101.html"><br><a href="img_text/spa_upgrade_9i_101.html">Description of the illustration spa_upgrade_9i_101.gif</a></div>
                                 <!-- class="figure" -->
                              </li>
                              <li>
                                 <p>Under Task Information:</p>
                                 <ol type="a">
                                    <li>
                                       <p>In the Task Name field, enter the name of the task.</p>
                                    </li>
                                    <li>
                                       <p>In the SQL Tuning Set field, enter the name of the SQL tuning set that was built.</p>
                                       <p>Alternatively, click the search icon to search for the SQL tuning set using the Search and Select: SQL Tuning Set window.</p>
                                       <p>The selected SQL tuning set now appears in the SQL Tuning Set field.</p>
                                    </li>
                                    <li>
                                       <p>In the Description field, optionally enter a description of the task.</p>
                                    </li>
                                 </ol>
                              </li>
                              <li>
                                 <p>In the Creation Method field, select:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><span class="bold">Execute SQLs</span> to generate both execution plans and statistics for each SQL statement in the SQL tuning set by actually running the SQL statements remotely on the test system over a public database link.
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Generate Plans</span> to create execution plans remotely on the test system over a public database link without actually running the SQL statements.
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>In the Per-SQL Time Limit list, determine the time limit for SQL execution during the trial by performing one of the following actions:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Select <span class="bold">5 minutes</span>.
                                       </p>
                                       <p>The execution will run each SQL statement in the SQL tuning set up to 5 minutes and gather performance data.</p>
                                    </li>
                                    <li>
                                       <p>Select <span class="bold">Unlimited</span>.
                                       </p>
                                       <p>The execution will run each SQL statement in the SQL tuning set to completion and gather performance data. Collecting execution statistics provides greater accuracy in the performance analysis but takes a longer time. Using this setting is not recommended because the task may be stalled by one SQL statement for a prolonged time period.</p>
                                    </li>
                                    <li>
                                       <p>Select <span class="bold">Customize</span> and enter the specified number of seconds, minutes, or hours.
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>In the Database Link field, enter the global name of a public database link connecting to a user with the <code class="codeph">EXECUTE</code> privilege for the <code class="codeph">DBMS_SQLPA</code> package and the <code class="codeph">ADVISOR</code> privilege on the test system.
                                 </p>
                                 <p>Alternatively, click the search icon to search for and select a database link, or click <span class="bold">Create Database Link</span> to create a database link using the Create Database Link page.
                                 </p>
                              </li>
                              <li>
                                 <p>In the Comparison Metric list, select the comparison metric to use for the comparison analysis:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><span class="bold">Elapsed Time</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">CPU Time</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">User I/O Time</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Buffer Gets</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Physical I/O</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Optimizer Cost</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">I/O Interconnect Bytes</span></p>
                                    </li>
                                 </ul>
                                 <p>Optimizer Cost is the only comparison metric available if you generated execution plans only in the SQL trials.</p>
                                 <p>To perform the comparison analysis by using more than one comparison metric, perform separate comparison analyses by repeating this procedure with different metrics. </p>
                              </li>
                              <li>
                                 <p>Under Schedule:</p>
                                 <ol type="a">
                                    <li>
                                       <p>In the Time Zone list, select your time zone code.</p>
                                    </li>
                                    <li>
                                       <p>Select <span class="bold">Immediately</span> to start the task now, or <span class="bold">Later</span> to schedule the task to start at a time specified using the Date and Time fields.
                                       </p>
                                    </li>
                                 </ol>
                              </li>
                              <li>
                                 <p>Click <span class="bold">Submit</span>.
                                 </p>
                                 <p>The SQL Performance Analyzer Home page appears.</p>
                                 <p>In the SQL Performance Analyzer Tasks section, the status of this task is displayed. To refresh the status icon, click <span class="bold">Refresh</span>. After the task completes, the Status field changes to Completed.
                                 </p>
                              </li>
                              <li>
                                 <p>Under SQL Performance Analyzer Tasks, select the task and click the link in the Name column.</p>
                                 <p>The SQL Performance Analyzer Task page appears.</p>
                                 <p>This page contains the following sections:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>SQL Tuning Set</p>
                                       <p>This section summarizes information about the SQL tuning set, including its name, owner, description, and the number of SQL statements it contains.</p>
                                    </li>
                                    <li>
                                       <p>SQL Trials</p>
                                       <p>This section includes a table that lists the SQL trials used in the SQL Performance Analyzer task.</p>
                                    </li>
                                    <li>
                                       <p>SQL Trial Comparisons</p>
                                       <p>This section contains a table that lists the results of the SQL trial comparisons</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Click the icon in the Comparison Report column.</p>
                                 <p>The SQL Performance Analyzer Task Result page appears.</p>
                              </li>
                              <li>
                                 <p>Review the results of the performance analysis, as described in <span class="q">"<a href="comparing-sql-trials.html#GUID-98608C0D-8BA8-4F10-94D8-3AE987087CBF" title="When a SQL Performance Analyzer task is completed, the resulting data is generated into a SQL Performance Analyzer report that compares the pre-change and post-change SQL performance.">Reviewing the SQL Performance Analyzer Report Using Oracle Enterprise Manager</a>"</span>.
                                 </p>
                                 <p>If regressed SQL statements are found following the database upgrade, tune them as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-DAF2B96B-20A0-408D-BDD7-364AC1113614" title="In some cases, SQL Performance Analyzer may identify SQL statements whose performance regressed after you upgrade the database on the test system.">Tuning Regressed SQL Statements After Testing a Database Upgrade</a>"</span>.
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG298"></a><div class="props_rev_3"><a id="GUID-C0CE4A85-70A6-40F7-A6EB-83612EBA8916" name="GUID-C0CE4A85-70A6-40F7-A6EB-83612EBA8916"></a><h5 id="RATUG-GUID-C0CE4A85-70A6-40F7-A6EB-83612EBA8916" class="sect5"><span class="enumeration_section">8.1.4.2 </span>Testing Database Upgrades from Releases 9.x and 10.1 Using APIs
                     </h5>
                     <div>
                        <p>This section describes how to test database upgrades from Oracle Database releases 9.x and 10.1 using APIs.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-C0CE4A85-70A6-40F7-A6EB-83612EBA8916__GUID-55072CAE-4DF0-4306-892A-7E0A291186C8">To test a database upgrade from releases 9.x and 10.1:</p>
                           <ol>
                              <li>
                                 <p>On the system running SQL Performance Analyzer, create an analysis task.</p>
                              </li>
                              <li>
                                 <p>Build the pre-upgrade <a id="d14012e1561" class="indexterm-anchor"></a>SQL trial from the execution plans and run-time statistics in the SQL tuning set by calling the <a id="d14012e1568" class="indexterm-anchor"></a><code class="codeph">EXECUTE_ANALYSIS_TASK</code> procedure using the following parameters:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Set the <code class="codeph">task_name</code> parameter to the name of the SQL Performance Analyzer task that you want to execute.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Set the <code class="codeph">execution_type</code> parameter to <code class="codeph">CONVERT SQLSET</code> to direct SQL Performance Analyzer to treat the statistics in the SQL tuning set as a trial execution.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Specify a name to identify the execution using the <code class="codeph">execution_name</code> parameter. If not specified, then SQL Performance Analyzer automatically generates a name for the task execution.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>The following example executes the SQL Performance Analyzer task named <code class="codeph">my_spa_task</code> as a trial execution:
                                 </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_SQLPA.EXECUTE_ANALYSIS_TASK(task_name =&gt; 'my_spa_task', -
       execution_type =&gt; 'CONVERT SQLSET', - 
       execution_name =&gt; 'my_trial_9i');
</pre></li>
                              <li>
                                 <p>Build the post-upgrade SQL trial by performing an explain plan or test execute using the <code class="codeph">EXECUTE_ANALYSIS_TASK</code> procedure:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Set the <code class="codeph">execution_type</code> parameter to <code class="codeph">EXPLAIN PLAN</code> or <code class="codeph">TEST EXECUTE</code>:
                                       </p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>If you choose to use <code class="codeph">EXPLAIN PLAN</code>, only execution plans will be generated. Subsequent comparisons will only be able to yield a list of changed plans without making any conclusions about performance changes.
                                             </p>
                                          </li>
                                          <li>
                                             <p>If you choose to use <code class="codeph">TEST EXECUTE</code>, the SQL workload will be executed to completion. This effectively builds the post-upgrade SQL trial using the statistics and execution plans generated from the test system. Using <code class="codeph">TEST EXECUTE</code> is recommended to capture the SQL execution plans and performance data at the source, thereby resulting in a more accurate analysis.
                                             </p>
                                          </li>
                                       </ul>
                                    </li>
                                    <li>
                                       <p>Set the <code class="codeph">DATABASE_LINK</code> task parameter to the global name of a public database link connecting to a user with the <code class="codeph">EXECUTE</code> privilege for the <code class="codeph">DBMS_SQLPA</code> package and the <code class="codeph">ADVISOR</code> privilege on the test system.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>The following example performs a test execute of the SQL statements remotely over a database link:</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_SQLPA.EXECUTE_ANALYSIS_TASK(task_name =&gt; 'my_spa_task', -
       execution_type =&gt; 'TEST EXECUTE', - 
       execution_name =&gt; 'my_remote_trial_10g', -
       execution_params =&gt; dbms_advisor.arglist('database_link',
                                                'LINK.A.B.C.BIZ.COM'));
</pre></li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-C0CE4A85-70A6-40F7-A6EB-83612EBA8916__GUID-19AC2B2A-59AB-483A-A126-C5D8E869CB3F">
                              <p class="notep1">See Also:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="q">"<a href="creating-an-analysis-task.html#GUID-A00000CF-F2DA-4138-BBFB-6FA03D889EBA" title="This section describes how to create a SQL Performance Analyzer task by using the DBMS_SQLPA.CREATE_ANALYSIS_TASK function. A task is a database container for SQL Performance Analyzer execution inputs and results.">Creating an Analysis Task Using APIs</a>"</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">"<a href="creating-a-pre-change-sql-trial.html#GUID-93D5C8A9-7E85-4467-B3E4-323B1732BA5D" title="This section describes how to build the pre-change performance data by using the DBMS_SQLPA package.">Creating a Pre-Change SQL Trial Using APIs</a>"</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">"<a href="creating-a-post-change-sql-trial.html#GUID-0C96536D-8129-4794-8527-1AA9FD240E2C" title="This section describes how to collect the post-change SQL performance data using the DBMS_SQLPA package.">Creating a Post-Change SQL Trial Using APIs</a>"</span></p>
                                 </li>
                                 <li>
                                    <p><a href="../arpls/DBMS_SQLPA.html#ARPLS229" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_SQLPA.EXECUTE_ANALYSIS_TASK</code> function
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="RATUG221"></a><div class="props_rev_3"><a id="GUID-AD6C3094-99C3-4F3D-A387-C7C70ACC43C4" name="GUID-AD6C3094-99C3-4F3D-A387-C7C70ACC43C4"></a><h3 id="RATUG-GUID-AD6C3094-99C3-4F3D-A387-C7C70ACC43C4" class="sect3"><span class="enumeration_section">8.2 </span>Upgrading from Oracle Database 10<span class="italic">g</span> Release 2 and Newer Releases
               </h3>
               <div>
                  <p>You can use SQL Performance Analyzer to test the impact on SQL response time of a database upgrade from Oracle Database 10<span class="italic">g</span> Release 2 or a newer release to any later release by capturing a SQL tuning set on the production system, then executing it twice remotely over a database link on a test system—first to create a pre-change SQL trial, then again to create a post-change SQL trial.
                  </p>
                  <div class="section">
                     <p>Before the database upgrade can be tested, ensure that the following conditions are met:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a id="d14012e1797" class="indexterm-anchor"></a>The <a id="d14012e1800" class="indexterm-anchor"></a>production system which you are upgrading from is running Oracle Database 10<span class="italic">g</span> Release 2 or a newer release.
                           </p>
                        </li>
                        <li>
                           <p>Initially, the <a id="d14012e1811" class="indexterm-anchor"></a>test system should also be running the same release of Oracle Database.
                           </p>
                        </li>
                        <li>
                           <p>The test system must contain an exact copy of the production data found on the production system.</p>
                        </li>
                        <li>
                           <p>The hardware configuration must be as similar to the production system as possible.</p>
                        </li>
                     </ul>
                     <p>You will also need to set up a separate SQL Performance Analyzer <a id="d14012e1824" class="indexterm-anchor"></a>system running Oracle Database 11<span class="italic">g</span> Release 2. You will be using this system to run SQL Performance Analyzer. Neither your production data or schema need to be available on this system, since the SQL tuning set will be built using statistics stored in the SQL trace files from the production system. SQL Performance Analyzer tasks will be executed remotely on the test system to generate the execution plan and statistics for the SQL trial over a database link that you specify. The database link must be a public database link that connects to a user with the <code class="codeph">EXECUTE</code> privilege for the <code class="codeph">DBMS_SQLPA</code> package and the <code class="codeph">ADVISOR</code> privilege on the test system. You should also drop any existing <code class="codeph">PLAN_TABLE</code> from the user's schema on the test system.
                     </p>
                     <p>Once the upgrade environment is configured as described, perform the steps as described in the following procedure to use SQL Performance Analyzer in a database upgrade from Oracle Database 10<span class="italic">g</span> Release 2 or a newer release to any later release.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>On the production system, capture the SQL workload that you intend to analyze and store it in a SQL tuning set, as described in <span class="q">"<a href="introduction-to-sql-performance-analyzer.html#GUID-3828F92F-62BC-4A5E-8303-9720DCCB64B4" title="Before running SQL Performance Analyzer, capture a set of SQL statements on the production system that represents the SQL workload which you intend to analyze.">Capturing the SQL Workload</a>"</span>.</span></li>
                     <li class="stepexpand"><span>Set up the test system so that it matches the production environment as closely as possible, as described in <span class="q">"<a href="introduction-to-sql-performance-analyzer.html#GUID-15E99CE8-282C-4A7E-BD3B-B7C2B93DE0C1" title="After you have captured the SQL workload into a SQL tuning set on the production system, you can conduct SQL Performance Analyzer analysis on the same database where the workload was captured or on a different database.">Setting Up the Test System</a>"</span>.</span></li>
                     <li class="stepexpand"><span>Transport the SQL tuning set to the SQL Performance Analyzer system.</span><div>
                           <p>For information about transporting SQL tuning sets using:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Oracle Enterprise Manager, see <a href="../tdppt/tuning-sql-statements.html#TDPPT159" target="_blank"><span><cite>Oracle Database 2 Day + Performance Tuning Guide</cite></span></a></p>
                              </li>
                              <li>
                                 <p>APIs, see <a href="../tgsql/managing-sql-tuning-sets.html#TGSQL516" target="_blank"><span><cite>Oracle Database SQL Tuning Guide</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>On the SQL Performance Analyzer system, create a <a id="d14012e1897" class="indexterm-anchor"></a>SQL Performance Analyzer task using the SQL tuning set as its input source.</span><div>
                           <p>Remotely test execute the SQL statements in the SQL tuning set on the test system over a database link to build a pre-upgrade <a id="d14012e1907" class="indexterm-anchor"></a>SQL trial that will be used as a baseline for comparison, as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-8C91E358-5D93-4B6C-861F-50D506B621AE" title="Once the SQL tuning set is transported to the SQL Performance Analyzer system, you can use SQL Performance Analyzer to build a pre-upgrade SQL trial by executing or generating plans of SQL statements in the SQL tuning set on the test system.">Testing Database Upgrades from Oracle Database 10g Release 2 and Newer Releases</a>"</span>.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Upgrade the test system.</span></li>
                     <li class="stepexpand"><span>Remotely test execute the SQL statements a second time on the upgraded test system over a database link to build a post-upgrade <a id="d14012e1927" class="indexterm-anchor"></a>SQL trial, as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-8C91E358-5D93-4B6C-861F-50D506B621AE" title="Once the SQL tuning set is transported to the SQL Performance Analyzer system, you can use SQL Performance Analyzer to build a pre-upgrade SQL trial by executing or generating plans of SQL statements in the SQL tuning set on the test system.">Testing Database Upgrades from Oracle Database 10g Release 2 and Newer Releases</a>"</span>.</span></li>
                     <li class="stepexpand"><span>Compare <a id="d14012e1944" class="indexterm-anchor"></a>SQL performance and fix <a id="d14012e1949" class="indexterm-anchor"></a>regressed SQL.</span><div>
                           <p>SQL Performance Analyzer compares the performance of SQL statements read from the SQL tuning set during the pre-upgrade SQL trial to those captured from the remote test execution during the post-upgrade SQL trial. A report is produced to identify any changes in execution plans or performance of the SQL statements.</p>
                           <p>If the report reveals any regressed SQL statements, you can make further changes to fix the regressed SQL, as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-DAF2B96B-20A0-408D-BDD7-364AC1113614" title="In some cases, SQL Performance Analyzer may identify SQL statements whose performance regressed after you upgrade the database on the test system.">Tuning Regressed SQL Statements After Testing a Database Upgrade</a>"</span>.
                           </p>
                           <p>Repeat the process of executing the SQL tuning set and comparing its performance to a previous execution to test any changes made until you are satisfied with the outcome of the analysis.</p>
                        </div>
                     </li>
                  </ol>
               </div><a id="RATUG299"></a><div class="props_rev_3"><a id="GUID-8C91E358-5D93-4B6C-861F-50D506B621AE" name="GUID-8C91E358-5D93-4B6C-861F-50D506B621AE"></a><h4 id="RATUG-GUID-8C91E358-5D93-4B6C-861F-50D506B621AE" class="sect4"><span class="enumeration_section">8.2.1 </span>Testing Database Upgrades from Oracle Database 10<span class="italic">g</span> Release 2 and Newer Releases
                  </h4>
                  <div>
                     <div><span>Once the SQL tuning set is transported to the SQL Performance Analyzer system, you can use SQL Performance Analyzer to build a pre-upgrade SQL trial by executing or generating plans of SQL statements in the SQL tuning set on the test system.</span> SQL Performance Analyzer test executes the SQL statements using a database link that you specify by connecting to the test system remotely and generating the execution plans and statistics for the SQL trial. The database link should exist on the SQL Performance Analyzer system and connect to a remote user with privileges to execute the SQL tuning set on the test system.
                     </div>
                     <p><a id="d14012e2058" class="indexterm-anchor"></a>After the pre-upgrade SQL trial is built, you need to upgrade the test system. Once the database has been upgraded, SQL Performance Analyzer will need to execute or generate plans of SQL statements in the SQL tuning set a second time on the upgraded test system to build a post-upgrade SQL trial. Alternatively, if hardware resources are available, you can use another upgraded test system to execute the second remote SQL trial. This method can be useful in helping you investigate issues identified by SQL Performance Analyzer.
                     </p>
                     <p>You can run SQL Performance Analyzer to test a database upgrade from Oracle Database 10<span class="italic">g</span> Release 2 or a newer release using Oracle Enterprise Manager or APIs, as described in the following sections:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="testing-a-database-upgrade.html#GUID-9C3A484E-2D3F-4BFA-AB7E-6ED088838FDE" title="To test a database upgrade from Oracle Database 10g Release 2 or a newer release using SQL Performance Analyzer:">Testing Database Upgrades from Releases 10.2 and Higher Using Cloud Control</a></p>
                        </li>
                        <li>
                           <p><a href="testing-a-database-upgrade.html#GUID-37F2F22F-2303-4CF6-BC29-74B8C5D80431" title="This section describes how to test database upgrades from Oracle Database releases 10.2 and higher using APIs.">Testing Database Upgrades from Releases 10.2 and Higher Using APIs</a></p>
                        </li>
                     </ul>
                  </div><a id="RATUG300"></a><div class="props_rev_3"><a id="GUID-9C3A484E-2D3F-4BFA-AB7E-6ED088838FDE" name="GUID-9C3A484E-2D3F-4BFA-AB7E-6ED088838FDE"></a><h5 id="RATUG-GUID-9C3A484E-2D3F-4BFA-AB7E-6ED088838FDE" class="sect5"><span class="enumeration_section">8.2.1.1 </span>Testing Database Upgrades from Releases 10.2 and Higher Using Cloud Control
                     </h5>
                     <div>
                        <p>To test a database upgrade from Oracle Database 10<span class="italic">g</span> Release 2 or a newer release using SQL Performance Analyzer:
                        </p>
                        <div class="section">
                           <ol>
                              <li>
                                 <p>From the <span class="bold">Performance</span> menu, select <span class="bold">SQL</span>, then <span class="bold">SQL Performance Analyzer</span>.
                                 </p>
                                 <p>If the Database Login page appears, then log in as a user with administrator privileges.</p>
                                 <p>The SQL Performance Analyzer Home page appears.</p>
                              </li>
                              <li>
                                 <p>Under SQL Performance Analyzer Workflows, click <span class="bold">Upgrade from 10.2 or 11g</span>.
                                 </p>
                                 <p>The Upgrade from 10.2 or higher releases page appears.</p>
                                 <div class="figure" id="GUID-9C3A484E-2D3F-4BFA-AB7E-6ED088838FDE__GUID-E666360B-31A9-4AEB-B997-B5B2E16F30B7"><img src="img/spa_upgrade_102_11g.gif" width="360" alt="Description of spa_upgrade_102_11g.gif follows" title="Description of spa_upgrade_102_11g.gif follows" longdesc="img_text/spa_upgrade_102_11g.html"><br><a href="img_text/spa_upgrade_102_11g.html">Description of the illustration spa_upgrade_102_11g.gif</a></div>
                                 <!-- class="figure" -->
                              </li>
                              <li>
                                 <p>Under Task Information:</p>
                                 <ol type="a">
                                    <li>
                                       <p>In the Task Name field, enter the name of the task.</p>
                                    </li>
                                    <li>
                                       <p>In the SQL Tuning Set field, enter the name of the SQL tuning set that was built.</p>
                                       <p>Alternatively, click the search icon to search for the SQL tuning set using the Search and Select: SQL Tuning Set window.</p>
                                       <p>The selected SQL tuning set now appears in the SQL Tuning Set field.</p>
                                    </li>
                                    <li>
                                       <p>In the Description field, optionally enter a description of the task.</p>
                                    </li>
                                 </ol>
                              </li>
                              <li>
                                 <p>In the Creation Method field, select:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><span class="bold">Execute SQLs</span> to generate both execution plans and statistics for each SQL statement in the SQL tuning set by actually running the SQL statements remotely on the test system over a public database link.
                                       </p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Generate Plans</span> to create execution plans remotely on the test system over a public database link without actually running the SQL statements.
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>In the Per-SQL Time Limit list, determine the time limit for SQL execution during the trial by performing one of the following actions:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Select <span class="bold">5 minutes</span>.
                                       </p>
                                       <p>The execution will run each SQL statement in the SQL tuning set up to 5 minutes and gather performance data.</p>
                                    </li>
                                    <li>
                                       <p>Select <span class="bold">Unlimited</span>.
                                       </p>
                                       <p>The execution will run each SQL statement in the SQL tuning set to completion and gather performance data. Collecting execution statistics provides greater accuracy in the performance analysis but takes a longer time. Using this setting is not recommended because the task may be stalled by one SQL statement for a prolonged time period.</p>
                                    </li>
                                    <li>
                                       <p>Select <span class="bold">Customize</span> and enter the specified number of seconds, minutes, or hours.
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>In the Database Link field, enter the global name of a public database link connecting to a user with the <code class="codeph">EXECUTE</code> privilege for the <code class="codeph">DBMS_SQLPA</code> package and the <code class="codeph">ADVISOR</code> privilege on the pre-upgrade system.
                                 </p>
                                 <p>Alternatively, click the search icon to search for and select a database link, or click <span class="bold">Create Database Link</span> to create a database link using the Create Database Link page.
                                 </p>
                              </li>
                              <li>
                                 <p>Under Post-upgrade Trial:</p>
                                 <ol type="a">
                                    <li>
                                       <p>Select <span class="bold">Use the same system as in the pre-upgrade trial</span> to use the same system for executing both the pre-upgrade and post-upgrade trials.
                                       </p>
                                       <p>Oracle recommends using this option to avoid possible errors due to different system configurations. When using this option, you will need to upgrade the test database to the higher database version before the post-upgrade trial is executed.</p>
                                    </li>
                                    <li>
                                       <p>In the Database Link field, enter the global name of a public database link connecting to a user with the <code class="codeph">EXECUTE</code> privilege for the <code class="codeph">DBMS_SQLPA</code> package and the <code class="codeph">ADVISOR</code> privilege on the post-upgrade system.
                                       </p>
                                    </li>
                                 </ol>
                              </li>
                              <li>
                                 <p>In the Comparison Metric list, select the comparison metric to use for the comparison analysis:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><span class="bold">Elapsed Time</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">CPU Time</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">User I/O Time</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Buffer Gets</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Physical I/O</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">Optimizer Cost</span></p>
                                    </li>
                                    <li>
                                       <p><span class="bold">I/O Interconnect Bytes</span></p>
                                    </li>
                                 </ul>
                                 <p>Optimizer Cost is the only comparison metric available if you generated execution plans only in the SQL trials.</p>
                                 <p>To perform the comparison analysis by using more than one comparison metric, perform separate comparison analyses by repeating this procedure with different metrics. </p>
                              </li>
                              <li>
                                 <p>Under Schedule:</p>
                                 <ol type="a">
                                    <li>
                                       <p>In the Time Zone list, select your time zone code.</p>
                                    </li>
                                    <li>
                                       <p>Select <span class="bold">Immediately</span> to start the task now, or <span class="bold">Later</span> to schedule the task to start at a time specified using the Date and Time fields.
                                       </p>
                                    </li>
                                 </ol>
                              </li>
                              <li>
                                 <p>Click <span class="bold">Submit</span>.
                                 </p>
                                 <p>The SQL Performance Analyzer Home page appears.</p>
                                 <p>In the SQL Performance Analyzer Tasks section, the status of this task is displayed. To refresh the status icon, click <span class="bold">Refresh</span>.
                                 </p>
                                 <p>If you are using the same system to execute both the pre-upgrade and post-upgrade trials, you will need to upgrade the database after the pre-upgrade trial step is completed. After the database is upgraded, the post-upgrade trial can be executed. After the task completes, the Status field changes to Completed.</p>
                              </li>
                              <li>
                                 <p>Under SQL Performance Analyzer Tasks, select the task and click the link in the Name column.</p>
                                 <p>The SQL Performance Analyzer Task page appears.</p>
                                 <p>This page contains the following sections:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>SQL Tuning Set</p>
                                       <p>This section summarizes information about the SQL tuning set, including its name, owner, description, and the number of SQL statements it contains.</p>
                                    </li>
                                    <li>
                                       <p>SQL Trials</p>
                                       <p>This section includes a table that lists the SQL trials used in the SQL Performance Analyzer task.</p>
                                    </li>
                                    <li>
                                       <p>SQL Trial Comparisons</p>
                                       <p>This section contains a table that lists the results of the SQL trial comparisons</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Click the icon in the Comparison Report column.</p>
                                 <p>The SQL Performance Analyzer Task Result page appears.</p>
                              </li>
                              <li>
                                 <p>Review the results of the performance analysis, as described in <span class="q">"<a href="comparing-sql-trials.html#GUID-98608C0D-8BA8-4F10-94D8-3AE987087CBF" title="When a SQL Performance Analyzer task is completed, the resulting data is generated into a SQL Performance Analyzer report that compares the pre-change and post-change SQL performance.">Reviewing the SQL Performance Analyzer Report Using Oracle Enterprise Manager</a>"</span>.
                                 </p>
                                 <p>If regressed SQL statements are found following the database upgrade, tune them as described in <span class="q">"<a href="testing-a-database-upgrade.html#GUID-DAF2B96B-20A0-408D-BDD7-364AC1113614" title="In some cases, SQL Performance Analyzer may identify SQL statements whose performance regressed after you upgrade the database on the test system.">Tuning Regressed SQL Statements After Testing a Database Upgrade</a>"</span>.
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="RATUG301"></a><div class="props_rev_3"><a id="GUID-37F2F22F-2303-4CF6-BC29-74B8C5D80431" name="GUID-37F2F22F-2303-4CF6-BC29-74B8C5D80431"></a><h5 id="RATUG-GUID-37F2F22F-2303-4CF6-BC29-74B8C5D80431" class="sect5"><span class="enumeration_section">8.2.1.2 </span>Testing Database Upgrades from Releases 10.2 and Higher Using APIs
                     </h5>
                     <div>
                        <p>This section describes how to test database upgrades from Oracle Database releases 10.2 and higher using APIs.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-37F2F22F-2303-4CF6-BC29-74B8C5D80431__GUID-AC7D234F-7D14-4EED-A228-B3A0DE3BC1A7">To test a database upgrade from releases 10.2 and higher:</p>
                           <ol>
                              <li>
                                 <p>On the system running SQL Performance Analyzer, create an analysis task.</p>
                              </li>
                              <li>
                                 <p>Build the pre-upgrade <a id="d14012e2498" class="indexterm-anchor"></a>SQL trial by performing an explain plan or test execute of SQL statements in the SQL tuning set.
                                 </p>
                                 <p>Call the <a id="d14012e2507" class="indexterm-anchor"></a><code class="codeph">EXECUTE_ANALYSIS_TASK</code> procedure using the following parameters:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Set the <code class="codeph">task_name</code> parameter to the name of the SQL Performance Analyzer task that you want to execute.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Set the <code class="codeph">execution_type</code> parameter to <code class="codeph">EXPLAIN PLAN</code> or <code class="codeph">TEST EXECUTE</code>:
                                       </p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>If you choose to use <code class="codeph">EXPLAIN PLAN</code>, only execution plans will be generated. Subsequent comparisons will only be able to yield a list of changed plans without making any conclusions about performance changes.
                                             </p>
                                          </li>
                                          <li>
                                             <p>If you choose to use <code class="codeph">TEST EXECUTE</code>, the SQL workload will be executed to completion. This effectively builds the pre-upgrade SQL trial using the statistics and execution plans generated from the test system. Using <code class="codeph">TEST EXECUTE</code> is recommended to capture the SQL execution plans and performance data at the source, thereby resulting in a more accurate analysis.
                                             </p>
                                          </li>
                                       </ul>
                                    </li>
                                    <li>
                                       <p>Specify a name to identify the execution using the <code class="codeph">execution_name</code> parameter. If not specified, then SQL Performance Analyzer automatically generates a name for the task execution.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Set the <code class="codeph">DATABASE_LINK</code> task parameter to the global name of a public database link connecting to a user with the <code class="codeph">EXECUTE</code> privilege for the <code class="codeph">DBMS_SQLPA</code> package and the <code class="codeph">ADVISOR</code> privilege on the test system.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>The following example executes the SQL Performance Analyzer task named <code class="codeph">my_spa_task</code> and performs a test execute of the SQL statements remotely over a database link:
                                 </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_SQLPA.EXECUTE_ANALYSIS_TASK(task_name =&gt; 'my_spa_task', -
       execution_type =&gt; 'TEST EXECUTE', - 
       execution_name =&gt; 'my_remote_trial_10g', -
       execution_params =&gt; dbms_advisor.arglist('database_link',
                                                'LINK.A.B.C.BIZ.COM'));
</pre></li>
                              <li>
                                 <p>Build the post-upgrade SQL trial by performing an explain plan or test execute using the <code class="codeph">EXECUTE_ANALYSIS_TASK</code> procedure:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Set the <code class="codeph">execution_type</code> parameter to <code class="codeph">EXPLAIN PLAN</code> or <code class="codeph">TEST EXECUTE</code>:
                                       </p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>If you choose to use <code class="codeph">EXPLAIN PLAN</code>, only execution plans will be generated. Subsequent comparisons will only be able to yield a list of changed plans without making any conclusions about performance changes.
                                             </p>
                                          </li>
                                          <li>
                                             <p>If you choose to use <code class="codeph">TEST EXECUTE</code>, the SQL workload will be executed to completion. This effectively builds the post-upgrade SQL trial using the statistics and execution plans generated from the test system. Using <code class="codeph">TEST EXECUTE</code> is recommended to capture the SQL execution plans and performance data at the source, thereby resulting in a more accurate analysis.
                                             </p>
                                          </li>
                                       </ul>
                                    </li>
                                    <li>
                                       <p>Set the <code class="codeph">DATABASE_LINK</code> task parameter to the global name of a public database link connecting to a user with the <code class="codeph">EXECUTE</code> privilege for the <code class="codeph">DBMS_SQLPA</code> package and the <code class="codeph">ADVISOR</code> privilege on the test system.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>The following example performs a test execute of the SQL statements remotely over a database link:</p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_SQLPA.EXECUTE_ANALYSIS_TASK(task_name =&gt; 'my_spa_task', -
       execution_type =&gt; 'TEST EXECUTE', - 
       execution_name =&gt; 'my_remote_trial_12c', -
       execution_params =&gt; dbms_advisor.arglist('database_link',
                                                'LINK.A.B.C.BIZ.COM'));
</pre></li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-37F2F22F-2303-4CF6-BC29-74B8C5D80431__GUID-B8B76035-B369-4BC6-AF5B-05432664D260">
                              <p class="notep1">See Also:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="q">"<a href="creating-an-analysis-task.html#GUID-A00000CF-F2DA-4138-BBFB-6FA03D889EBA" title="This section describes how to create a SQL Performance Analyzer task by using the DBMS_SQLPA.CREATE_ANALYSIS_TASK function. A task is a database container for SQL Performance Analyzer execution inputs and results.">Creating an Analysis Task Using APIs</a>"</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">"<a href="creating-a-pre-change-sql-trial.html#GUID-93D5C8A9-7E85-4467-B3E4-323B1732BA5D" title="This section describes how to build the pre-change performance data by using the DBMS_SQLPA package.">Creating a Pre-Change SQL Trial Using APIs</a>"</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">"<a href="creating-a-post-change-sql-trial.html#GUID-0C96536D-8129-4794-8527-1AA9FD240E2C" title="This section describes how to collect the post-change SQL performance data using the DBMS_SQLPA package.">Creating a Post-Change SQL Trial Using APIs</a>"</span></p>
                                 </li>
                                 <li>
                                    <p><a href="../arpls/DBMS_SQLPA.html#ARPLS229" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_SQLPA.EXECUTE_ANALYSIS_TASK</code> function
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="RATUG228"></a><div class="sect2"><a id="GUID-DAF2B96B-20A0-408D-BDD7-364AC1113614" name="GUID-DAF2B96B-20A0-408D-BDD7-364AC1113614"></a><h3 id="RATUG-GUID-DAF2B96B-20A0-408D-BDD7-364AC1113614" class="sect3"><span class="enumeration_section">8.3 </span>Tuning Regressed SQL Statements After Testing a Database Upgrade
               </h3>
               <div>
                  <p>In some cases, SQL Performance Analyzer may identify SQL statements whose performance regressed after you upgrade the database on the test system.</p>
                  <p>You can tune the regressed <a id="d14012e2758" class="indexterm-anchor"></a>SQL statements by using the SQL Tuning Advisor or SQL plan baselines, as described in <a href="comparing-sql-trials.html#GUID-848B84A7-CB08-4728-9E3A-CBDD70E89E63" title="After the post-change SQL performance data is built, you can compare the performance data collected in the pre-change SQL trial to the post-change SQL trial by running a comparison analysis using SQL Performance Analyzer.">Comparing SQL Trials</a>. This involves using APIs to build a subset of a SQL tuning set with only the regressed SQL statements, transport this subset of regressed SQL statements to the remote database, and running the SQL Tuning Advisor on the remote database.
                  </p>
                  <p>Oracle Enterprise Manager does not provide support for fixing regressions after running SQL Performance Analyzer involving one or more remote SQL trials.</p>
                  <p>If you are upgrading from Oracle Database 10<span class="italic">g</span> Release 2 and newer releases, you can also create SQL plan baselines to instruct the optimizer to select existing execution plans in the future.
                  </p>
                  <div class="infoboxnotealso" id="GUID-DAF2B96B-20A0-408D-BDD7-364AC1113614__GUID-ADE891DF-A4A9-4127-AAB0-AF3FDBE8FA97">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="comparing-sql-trials.html#GUID-0B629FA1-FF45-44D0-BB2D-28FF762BC102">Tuning Regressed SQL Statements From a Remote SQL Trial Using APIs</a>"</span></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="comparing-sql-trials.html#GUID-48F67DD6-70B6-49CC-B4B3-72F2D80E6DDD">Creating SQL Plan Baselines Using APIs</a>"</span></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>