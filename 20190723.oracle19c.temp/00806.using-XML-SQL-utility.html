<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="An explanation is given of how to use the Extensible Markup Language (XML) SQL Utility (XSU).">
      <meta name="description" content="An explanation is given of how to use the Extensible Markup Language (XML) SQL Utility (XSU).">
      <title>Using the XML SQL Utility</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content="An explanation is given of how to use the Extensible Markup Language (XML) SQL Utility (XSU).">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="xml-developers-kit-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T05:58:48-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96292-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="determining-XML-differences-using-Java.html" title="Previous" type="text/html">
      <link rel="next" href="using-TransX-utility.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML Developers Kit Programmers Guide">
    <meta name="dcterms.isVersionOf" content="ADXDK">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="determining-XML-differences-using-Java.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-TransX-utility.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XDK-for-Java.html" property="item" typeof="WebPage"><span property="name">Oracle XML Developer's Kit for Java</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Using the XML SQL Utility</li>
            </ol>
            <a id="GUID-4C9A3F2F-A2A7-4CBF-BCD4-FD667D559945" name="GUID-4C9A3F2F-A2A7-4CBF-BCD4-FD667D559945"></a><a id="ADXDK1007"></a><a id="ADXDK070"></a>
            
            <h2 id="ADXDK-GUID-4C9A3F2F-A2A7-4CBF-BCD4-FD667D559945" class="sect2"><span class="enumeration_chapter">21 </span>Using the XML SQL Utility
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>An explanation is given of how to use the Extensible Markup Language (XML) SQL Utility (XSU).</p>
               <div class="section"> </div>
               <!-- class="section" -->
            </div><a id="ADXDK1008"></a><a id="ADXDK19392"></a><div class="props_rev_3"><a id="GUID-B8EF3AD4-E94A-487D-969F-2C1B2E095687" name="GUID-B8EF3AD4-E94A-487D-969F-2C1B2E095687"></a><h3 id="ADXDK-GUID-B8EF3AD4-E94A-487D-969F-2C1B2E095687" class="sect3">Introduction to the XML SQL Utility (XSU)</h3>
               <div>
                  <p>XML SQL Utility (XSU) is an Oracle XML Developer's Kit (XDK) component that lets you transfer XML data using Oracle SQL statements.</p>
                  <p></p>
                  <p>You can use <a href="glossary.html#GUID-A564495D-ED7B-4F52-8FCA-944CF3BB274D"><span class="xrefglossterm">XML SQL Utility (XSU)</span></a> to perform these tasks:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Transform data in object-relational database tables or views into XML. XSU can query the database and return the result set as an XML document.</p>
                     </li>
                     <li>
                        <p>Extract data from an XML document and use canonical mapping to insert the data into a table or a view or update or delete values of the appropriate columns or attributes.</p>
                     </li>
                  </ul>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19393"></a><div class="props_rev_3"><a id="GUID-AE298459-AB63-4B8E-8D3F-07AB9114DA77" name="GUID-AE298459-AB63-4B8E-8D3F-07AB9114DA77"></a><h4 id="ADXDK-GUID-AE298459-AB63-4B8E-8D3F-07AB9114DA77" class="sect4">Prerequisites for Using the XML SQL Utility (XSU)</h4>
                  <div>
                     <p>Prerequisites for using the XML SQL Utility (XSU) are covered.</p>
                     <p>This section assumes that you are familiar with these technologies:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Oracle Database structured query language (SQL). XSU transfers XML to and from a database through <code class="codeph">SELECT</code> statements and data manipulation language (DML).
                           </p>
                        </li>
                        <li>
                           <p>Procedural Language/Structured Query Language (PL/SQL). XDK supplies a PL/SQL application programming interface (API) for XSU that mirrors the Java API.</p>
                        </li>
                        <li>
                           <p><a href="glossary.html#GUID-6ABA93DA-F986-43F2-97D2-23AA0EA6455C"><span class="xrefglossterm">Java Database Connectivity (JDBC)</span></a>. Java applications that use XSU to transfer XML to and from a database require a JDBC connection.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADXDK19394"></a><div class="props_rev_3"><a id="GUID-8D708D9D-F93B-46A2-B96A-7458A2F6C36B" name="GUID-8D708D9D-F93B-46A2-B96A-7458A2F6C36B"></a><h4 id="ADXDK-GUID-8D708D9D-F93B-46A2-B96A-7458A2F6C36B" class="sect4">XSU Features</h4>
                  <div>
                     <p>The main features provided by XML SQL Utility (XSU) are described.</p>
                     <p>XSU:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Dynamically generates document type definitions (DTDs) or XML schemas.</p>
                        </li>
                        <li>
                           <p>Generates XML documents in their string or Document Object Model (DOM) representations.</p>
                        </li>
                        <li>
                           <p>Performs simple transformations during generation such as modifying default tag names for each <code class="codeph">&lt;ROW&gt;</code> element. You can also register an XSL transformation that XSU applies to the generated XML documents as needed.
                           </p>
                        </li>
                        <li>
                           <p>Generates XML as a stream of Simple API for XML (SAX2) callbacks.</p>
                        </li>
                        <li>
                           <p>Supports XML attributes during generation, which enables you to specify that a particular column or group of columns maps to an XML attribute instead of an XML element.</p>
                        </li>
                        <li>
                           <p>Allows SQL-to-XML-tag escaping. Sometimes column names are not valid XML tag names. To avoid this problem you can either alias all the column names or turn on tag escaping.</p>
                        </li>
                        <li>
                           <p>Supports <code class="codeph">XMLType</code> columns in objects or tables.
                           </p>
                        </li>
                        <li>
                           <p>Inserts XML into relational database tables or views. When given an XML document, XSU can also update or delete records from a database object.</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADXDK19395"></a><div class="props_rev_3"><a id="GUID-1805B089-C277-4899-9C31-FF44C6866FEF" name="GUID-1805B089-C277-4899-9C31-FF44C6866FEF"></a><h4 id="ADXDK-GUID-1805B089-C277-4899-9C31-FF44C6866FEF" class="sect4">XSU Restrictions</h4>
                  <div>
                     <p>Some restrictions for using XSU are described.</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>XSU can store data only in a single table. You can store XML across tables, however, by using the Oracle Extensible Stylesheet Language Transformation (XSLT) processor to transform a document into multiple documents and inserting them separately. You can also define views over multiple tables and perform insertions into the views. If a view is nonupdatable (because of complex joins), then you can use <code class="codeph">INSTEAD</code> <code class="codeph">OF</code> triggers over the views to perform the inserts.
                           </p>
                        </li>
                        <li>
                           <p>You cannot use XSU to load XML data stored in attributes into a database schema, but you can use an XSLT transformation to change the attributes into elements.</p>
                        </li>
                        <li>
                           <p>By default XSU is case-sensitive. You can either use the correct case, or specify that case is to be ignored.</p>
                        </li>
                        <li>
                           <p>XSU cannot generate a relational database schema from an input DTD.</p>
                        </li>
                        <li>
                           <p>Inserting into <code class="codeph">XMLType</code> tables using XSU is not supported.  <code class="codeph">XMLType</code> columns are supported. 
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADXDK1009"></a><a id="ADXDK19396"></a><div class="props_rev_3"><a id="GUID-D3D785EB-E345-4F37-B7A7-7462BAA0F247" name="GUID-D3D785EB-E345-4F37-B7A7-7462BAA0F247"></a><h3 id="ADXDK-GUID-D3D785EB-E345-4F37-B7A7-7462BAA0F247" class="sect3">Using the XML SQL Utility: Overview</h3>
               <div>
                  <p>Topics here include basic XSU use, installing XSU, running the XSU demo programs, and using the XSU command-line utility.</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19397"></a><div class="props_rev_3"><a id="GUID-0DD4527B-DA4B-404D-B52C-15027C8C22BF" name="GUID-0DD4527B-DA4B-404D-B52C-15027C8C22BF"></a><h4 id="ADXDK-GUID-0DD4527B-DA4B-404D-B52C-15027C8C22BF" class="sect4">Using XSU: Basic Process</h4>
                  <div>
                     <p>The basic process of using XSU is described.</p>
                     <div class="section">
                        <p>XSU is accessible through  Java classes <code class="codeph">OracleXML</code><code class="codeph">Query</code> and <code class="codeph">OracleXMLSave</code> in package <code class="codeph">oracle.xml.sql.query</code>. Use class <code class="codeph">OracleXMLQuery</code> to generate XML from relational data and class <code class="codeph">OracleXMLSave</code> to perform DML.
                        </p>
                        <p>You can write these types of XSU applications:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Java programs that run inside the database and access the internal XSU Java API</p>
                           </li>
                           <li>
                              <p>Java programs that run on the client and access the client-side XSU Java API</p>
                           </li>
                           <li>
                              <p>PL/SQL programs that access XSU through PL/SQL packages</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19399"></a><a id="ADXDK19398"></a><div class="props_rev_3"><a id="GUID-1B9C1372-3D9D-4628-8426-5C715225D616" name="GUID-1B9C1372-3D9D-4628-8426-5C715225D616"></a><h5 id="ADXDK-GUID-1B9C1372-3D9D-4628-8426-5C715225D616" class="sect5">Generating XML with the XSU Java API: Basic Process</h5>
                     <div>
                        <p>Class <code class="codeph">OracleXMLQuery</code> makes up the XML generation part of the XSU Java API.
                        </p>
                        <div class="section">
                           <p> <a href="using-XML-SQL-utility.html#GUID-1B9C1372-3D9D-4628-8426-5C715225D616__BABJAEAE">Figure 21-1</a> shows the basic process for generating XML with XSU.
                           </p>
                           <p>The basic steps in <a href="using-XML-SQL-utility.html#GUID-1B9C1372-3D9D-4628-8426-5C715225D616__BABJAEAE">Figure 21-1</a> are:
                           </p>
                           <div class="figure" id="GUID-1B9C1372-3D9D-4628-8426-5C715225D616__BABJAEAE">
                              <p class="titleinfigure">Figure 21-1 Generating XML with XSU</p><img src="img/adxdk032.gif" width="600" alt="Description of Figure 21-1 follows" title="Description of Figure 21-1 follows" longdesc="img_text/adxdk032.html"><br><a href="img_text/adxdk032.html">Description of "Figure 21-1 Generating XML with XSU"</a></div>
                           <!-- class="figure" -->
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create a JDBC connection to the database. Normally, you establish a connection with the <code class="codeph">DriverManager</code> class, which manages a set of JDBC drivers. After the JDBC drivers are loaded, invoke <code class="codeph">getConnection()</code>. When it finds the right driver, this method returns a <code class="codeph">Connection</code> object that represents a database session. All SQL statements are executed within the context of this session.</span><div>
                                 <p>You have these options:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Create the connection with the JDBC Oracle Call Interface (OCI) driver. This code fragment shows this technique:</p><pre class="oac_no_warn" dir="ltr">// import the Oracle driver class
import oracle.jdbc.*;
// load the Oracle JDBC driver
DriverManager.registerDriver(new oracle.jdbc.OracleDriver());     
// create the connection
Connection conn =
   DriverManager.getConnection("jdbc:oracle:oci:@","hr","<span class="italic">password</span>");
</pre><p>The preceding example uses the default connection for the JDBC OCI driver.</p>
                                    </li>
                                 </ul>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Create the connection with the JDBC thin driver. The thin driver is written in pure Java and can be called from any Java program. This code fragment shows this technique:</p><pre class="oac_no_warn" dir="ltr">Connection conn =        
   DriverManager.getConnection("jdbc:oracle:thin:@dlsun489:1521:ORCL",
     "hr","<span class="italic">password</span>");
</pre><p>The thin driver requires the host name (<code class="codeph">dlsun489</code>), port number (1521), and the Oracle system identifier (SID), <code class="codeph">ORCL</code>. The database must have an active Transmission Control Protocol/Internet Protocol (TCP/IP) listener.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Use default connection used by the server-side internal JDBC driver. This driver runs within a default session and default transaction context. You are already connected to the database; your SQL operations are part of the default transaction. Thus, you do not have to register the driver. Create the <code class="codeph">Connection</code> object:
                                       </p><pre class="oac_no_warn" dir="ltr">Connection conn = new oracle.jdbc.OracleDriver().defaultConnection ();</pre></li>
                                 </ul>
                                 <div class="infoboxnote" id="GUID-1B9C1372-3D9D-4628-8426-5C715225D616__GUID-66AED7BB-EAD2-4B70-AD5E-F296DF002103">
                                    <p class="notep1">Note:</p>
                                    <p><code class="codeph">OracleXMLDataSetExtJdbc</code> is used only for Oracle JDBC, whereas <code class="codeph">OracleXMLDataSetGenJdbc</code> is used for non-Oracle JDBC. These classes are in the oracle.xml.sql.dataset package.
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Create an XML query object and assign it a SQL query. You create an <code class="codeph">OracleXMLQuery</code> Class instance by passing a SQL query to the constructor, as shown in this example:</span><div><pre class="oac_no_warn" dir="ltr">OracleXMLQuery qry = new OracleXMLQuery (conn, "SELECT * from EMPLOYEES");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Configure the XML query object by invoking <code class="codeph">OracleXMLQuery</code> methods. This example specifies that only 20 rows are to be included in the result set:</span><div><pre class="oac_no_warn" dir="ltr">xmlQry.setMaxRows(20); 
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Return a DOM object or string by invoking <code class="codeph">OracleXMLQuery</code> methods. For example, get a DOM object:</span><div><pre class="oac_no_warn" dir="ltr">XMLDocument domDoc = (XMLDocument)qry.getXMLDOM();
</pre><p>Get a string object:</p><pre class="oac_no_warn" dir="ltr">String xmlString = qry.getXMLString();
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Perform additional processing on the string or DOM as needed.</span><div>
                                 <div class="infoboxnotealso" id="GUID-1B9C1372-3D9D-4628-8426-5C715225D616__GUID-F77748C1-6B42-4BDC-8F91-042959F91653">
                                    <p class="notep1">See Also:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p><a href="../jjdev/Java-introduction.html#JJDEV01000" target="_blank"><span><cite>Oracle Database Java Developer’s Guide</cite></span></a> to learn about Oracle JDBC
                                          </p>
                                       </li>
                                       <li>
                                          <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a> to learn about <code class="codeph">OracleXMLQuery</code> methods
                                          </p>
                                       </li>
                                    </ul>
                                 </div>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div><a id="ADXDK19401"></a><a id="ADXDK19400"></a><div class="props_rev_3"><a id="GUID-24C29C76-152A-4609-AB5A-2C1DC2986CCB" name="GUID-24C29C76-152A-4609-AB5A-2C1DC2986CCB"></a><h5 id="ADXDK-GUID-24C29C76-152A-4609-AB5A-2C1DC2986CCB" class="sect5">Performing DML with the XSU Java API: Basic Process</h5>
                     <div>
                        <p>Use the <code class="codeph">OracleXMLSave</code> class to insert, update, and delete XML in the database. 
                        </p>
                        <div class="section">
                           <p><a href="using-XML-SQL-utility.html#GUID-24C29C76-152A-4609-AB5A-2C1DC2986CCB__BABCEFEJ">Figure 21-2</a> shows the basic process.
                           </p>
                           <div class="figure" id="GUID-24C29C76-152A-4609-AB5A-2C1DC2986CCB__BABCEFEJ">
                              <p class="titleinfigure">Figure 21-2 Storing XML in the Database Using XSU</p><img src="img/adxdk013.gif" width="516" alt="Description of Figure 21-2 follows" title="Description of Figure 21-2 follows" longdesc="img_text/adxdk013.html"><br><a href="img_text/adxdk013.html">Description of "Figure 21-2 Storing XML in the Database Using XSU"</a></div>
                           <!-- class="figure" -->
                           <p>The basic steps in <a href="using-XML-SQL-utility.html#GUID-24C29C76-152A-4609-AB5A-2C1DC2986CCB__BABCEFEJ">Figure 21-2</a> are:
                           </p>
                           <ol>
                              <li>
                                 <p>Create a JDBC connection to the database. This step is identical to the first step described in <a href="using-XML-SQL-utility.html#GUID-1B9C1372-3D9D-4628-8426-5C715225D616" title="Class OracleXMLQuery makes up the XML generation part of the XSU Java API.">Generating XML with the XSU Java API: Basic Process</a>.
                                 </p>
                              </li>
                              <li>
                                 <p>Create an XML save object and assign it a table on which to perform DML. Pass a table or view name to the constructor, as shown in this example:</p><pre class="oac_no_warn" dir="ltr">OracleXMLSave sav = new OracleXMLSave(conn, "employees");
</pre></li>
                              <li>
                                 <p>Specify the primary key columns. For example, this code specifies that <code class="codeph">employee_id</code> is the key column:
                                 </p><pre class="oac_no_warn" dir="ltr">String [] keyColNames = new String[1];
keyColNames[0] = "EMPLOYEE_ID";
sav.setKeyColumnList(keyColNames);
</pre></li>
                              <li>
                                 <p>Configure the XML save object by invoking <code class="codeph">OracleXMLSave</code> methods. This example specifies an update of the <code class="codeph">salary</code> and <code class="codeph">job_id</code> columns:
                                 </p><pre class="oac_no_warn" dir="ltr">String[] updateColNames = new String[2];
updateColNames[0] = "SALARY";
updateColNames[1] = "JOB_ID";
sav.setUpdateColumnList(updateColNames); // set the columns to update
</pre></li>
                              <li>
                                 <p>Invoke the <code class="codeph">insertXML()</code>, <code class="codeph">updateXML()</code>, or <code class="codeph">deleteXML()</code> methods on the <code class="codeph">OracleXMLSave</code> object. This example shows an update:
                                 </p><pre class="oac_no_warn" dir="ltr">// Assume that the user passes in this XML document as the first argument
sav.updateXML(sav.getURL(argv[0]));
</pre><p>When performing the DML, XSU performs these tasks:</p>
                                 <ol type="a">
                                    <li>
                                       <p>Parses the input XML document.</p>
                                    </li>
                                    <li>
                                       <p>Matches element names to column names in the target table or view.</p>
                                    </li>
                                    <li>
                                       <p>Converts the elements to SQL types and binds them to the appropriate statement.</p>
                                    </li>
                                 </ol>
                              </li>
                              <li>
                                 <p>Close the <code class="codeph">OracleXMLSave</code> object and deallocate all contexts associated with it, as shown in this example:
                                 </p><pre class="oac_no_warn" dir="ltr">sav.close();</pre><div class="infoboxnotealso" id="GUID-24C29C76-152A-4609-AB5A-2C1DC2986CCB__GUID-0CA94A29-CD03-4C25-A2E6-EF3D4DEB4A80">
                                    <p class="notep1">See Also:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p><a href="../jjdev/Java-introduction.html#JJDEV01000" target="_blank"><span><cite>Oracle Database Java Developer’s Guide</cite></span></a> to learn about JDBC
                                          </p>
                                       </li>
                                       <li>
                                          <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a> to learn about <code class="codeph">OracleXMLSave</code></p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADXDK19404"></a><div class="props_rev_3"><a id="GUID-2BEECD17-A1B8-40F0-9363-CED111CAE8A2" name="GUID-2BEECD17-A1B8-40F0-9363-CED111CAE8A2"></a><h4 id="ADXDK-GUID-2BEECD17-A1B8-40F0-9363-CED111CAE8A2" class="sect4">Installing XSU</h4>
                  <div>
                     <p>XSU is included as part of Oracle Database, along with the other XDK utilities. </p>
                     <div class="section">
                        <p><a href="getting-started-with-XDK-for-Java.html#GUID-D26168D9-2F21-4B5A-9F7B-F1D4B66F0EB4" title="The dependencies of XDK for Java components when using Java Development Kit (JDK) are described.">XDK for Java Component Dependencies</a> describes the XSU components and dependencies.
                        </p>
                        <p>By default, the Oracle Universal Installer installs XSU on disk and loads it into the database. No user intervention is required. If you did not load XSU in the database when installing Oracle, you can install XSU manually as follows:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span>Ensure that Oracle XML DB is installed (it is installed by default as part of Oracle Database).</span></li>
                        <li><span>Load the <code class="codeph">xsu12.jar</code> file into the database. This JAR file, which has a dependency on <code class="codeph">xdb.jar</code> for <code class="codeph">XMLType</code> access, is described in <a href="getting-started-with-XDK-for-Java.html#GUID-D26168D9-2F21-4B5A-9F7B-F1D4B66F0EB4__BACCJCEA" title="Component, Library, and Notes are the columns.">Table 11-1</a>.</span></li>
                        <li><span>Run the <code class="codeph">$ORACLE_HOME/rdbms/admin/dbmsxsu.sql</code> script. This SQL script builds the XSU PL/SQL API.</span></li>
                     </ol>
                     <div class="section">
                        <p>As explained in <a href="using-XML-SQL-utility.html#GUID-0DD4527B-DA4B-404D-B52C-15027C8C22BF" title="The basic process of using XSU is described.">Using XSU: Basic Process</a>, you do not have to load XSU into the database to use it. XSU can reside in any tier that supports Java.
                        </p> 
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19406"></a><a id="ADXDK19405"></a><div class="props_rev_3"><a id="GUID-87BA0272-6037-4262-98DA-6BB40FAF2BAF" name="GUID-87BA0272-6037-4262-98DA-6BB40FAF2BAF"></a><h5 id="ADXDK-GUID-87BA0272-6037-4262-98DA-6BB40FAF2BAF" class="sect5">XSU in the Database</h5>
                     <div>
                        <p> The typical architecture is shown for applications that use the XSU libraries installed in the database.</p>
                        <p><a href="using-XML-SQL-utility.html#GUID-87BA0272-6037-4262-98DA-6BB40FAF2BAF__BABFHEJD">Figure 21-3</a> illustrates this typical architecture. XML generated from XSU running in the database can be placed in advanced queues in the database to be queued to other systems or clients. You deliver the XML internally through stored procedures in the database or externally through web servers or application servers.
                        </p>
                        <p>In <a href="using-XML-SQL-utility.html#GUID-87BA0272-6037-4262-98DA-6BB40FAF2BAF__BABFHEJD">Figure 21-3</a> all lines are bidirectional. Because XSU can generate and save data, resources can deliver XML to XSU running inside the database, which can then insert it in the appropriate database tables.
                        </p>
                        <div class="figure" id="GUID-87BA0272-6037-4262-98DA-6BB40FAF2BAF__BABFHEJD">
                           <p class="titleinfigure">Figure 21-3 Running XSU in the Database</p><img src="img/adxdk018.gif" width="600" alt="Description of Figure 21-3 follows" title="Description of Figure 21-3 follows" longdesc="img_text/adxdk018.html"><br><a href="img_text/adxdk018.html">Description of "Figure 21-3 Running XSU in the Database"</a></div>
                        <!-- class="figure" -->
                     </div>
                  </div><a id="ADXDK19408"></a><a id="ADXDK19407"></a><div class="props_rev_3"><a id="GUID-E7494F31-25A2-49A9-9631-24F872DAC692" name="GUID-E7494F31-25A2-49A9-9631-24F872DAC692"></a><h5 id="ADXDK-GUID-E7494F31-25A2-49A9-9631-24F872DAC692" class="sect5">XSU in an Application Server</h5>
                     <div>
                        <p>You can run XSU in an application server.</p>
                        <p>Your application architecture may require an application server in the middle tier. The application tier can be a database or an application server that supports Java programs.</p>
                        <p>You can generate XML in the middle tier from SQL queries or <code class="codeph">ResultSets</code> for various reasons, for example, to integrate different JDBC data sources in the middle tier. In this case, you can install XSU in your middle tier, thereby enabling your Java programs to make use of XSU through its Java API. 
                        </p>
                        <p><a href="using-XML-SQL-utility.html#GUID-E7494F31-25A2-49A9-9631-24F872DAC692__BABIGADF">Figure 21-4</a> shows a typical architecture for running XSU in a middle tier. In the middle tier, data from JDBC sources is converted by XSU into XML and then sent to web servers or other systems. Again, the process is bidirectional, which means that the data can be put back into the JDBC sources (database tables or views) with XSU. If a database is used as the application server, then you can use the PL/SQL front end instead of Java.
                        </p>
                        <div class="figure" id="GUID-E7494F31-25A2-49A9-9631-24F872DAC692__BABIGADF">
                           <p class="titleinfigure">Figure 21-4 Running XSU in the Middle Tier</p><img src="img/adxdk019.gif" width="592" alt="Description of Figure 21-4 follows" title="Description of Figure 21-4 follows" longdesc="img_text/adxdk019.html"><br><a href="img_text/adxdk019.html">Description of "Figure 21-4 Running XSU in the Middle Tier"</a></div>
                        <!-- class="figure" -->
                     </div>
                  </div><a id="ADXDK19410"></a><a id="ADXDK19409"></a><div class="props_rev_3"><a id="GUID-AB070D7C-D012-4B0B-8DF9-4ABA55EB6026" name="GUID-AB070D7C-D012-4B0B-8DF9-4ABA55EB6026"></a><h5 id="ADXDK-GUID-AB070D7C-D012-4B0B-8DF9-4ABA55EB6026" class="sect5">XSU in a Web Server</h5>
                     <div>
                        <p>You can run XSU in a web server because the web server supports Java servlets.</p>
                        <p><a href="using-XML-SQL-utility.html#GUID-AB070D7C-D012-4B0B-8DF9-4ABA55EB6026__BABEHFAH">Figure 21-5</a> shows XSU running in a web server. 
                        </p>
                        <div class="figure" id="GUID-AB070D7C-D012-4B0B-8DF9-4ABA55EB6026__BABEHFAH">
                           <p class="titleinfigure">Figure 21-5 Running XSU in a Web Server</p><img src="img/adxdk020.gif" width="600" alt="Description of Figure 21-5 follows" title="Description of Figure 21-5 follows" longdesc="img_text/adxdk020.html"><br><a href="img_text/adxdk020.html">Description of "Figure 21-5 Running XSU in a Web Server"</a></div>
                        <!-- class="figure" -->
                        <p>You can write Java servlets that use XSU. XSQL Servlet is a standard servlet provided by Oracle. It is built on top of XSU and provides a template-like interface to XSU functionality. To perform XML processing in the web server and avoid intricate servlet programming, you can use the XSQL Servlet. </p>
                        <div class="infoboxnotealso" id="GUID-AB070D7C-D012-4B0B-8DF9-4ABA55EB6026__GUID-8F34D0AF-4079-4B84-91FE-CE242F74ED93">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../adxdb/generation-of-XML-data-from-relational-data.html#ADXDB1600" target="_blank"><span><cite>Oracle XML&nbsp;DB Developer’s Guide</cite></span></a>, especially the chapter on generating XML, for examples on using XSU with <code class="codeph">XMLType</code></p>
                              </li>
                              <li>
                                 <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a> to learn about the classes <code class="codeph">OracleXMLQuery</code> and <code class="codeph">OracleXMLSave</code></p>
                              </li>
                              <li>
                                 <p><a href="using-XSQL-pages-publishing-framework.html#GUID-A1834D2F-B962-4881-AE7A-F323FF11384D" title="An explanation is given of how to use the basic features of the XSQL pages publishing framework.">Using the XSQL Pages Publishing Framework</a> to learn about XSQL Servlet
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="ADXDK19412"></a><a id="ADXDK19411"></a><div class="props_rev_3"><a id="GUID-DBFFD584-82E8-45F8-82F0-E1BFFE6BC162" name="GUID-DBFFD584-82E8-45F8-82F0-E1BFFE6BC162"></a><h4 id="ADXDK-GUID-DBFFD584-82E8-45F8-82F0-E1BFFE6BC162" class="sect4">Running the XSU Demo Programs</h4>
                  <div>
                     <p>Demo programs for XSU are included in <code class="codeph">$ORACLE_HOME/xdk/demo/java/xsu</code>. 
                     </p>
                     <div class="section">
                        <p><a href="using-XML-SQL-utility.html#GUID-DBFFD584-82E8-45F8-82F0-E1BFFE6BC162__BABICEIE" title="This table describes the XML files and programs that you can use to test XSU. File and Description are the Columns.">Table 21-1</a> describes the XML files and programs that you can use to test XSU.
                        </p>
                        <div class="tblformalwide" id="GUID-DBFFD584-82E8-45F8-82F0-E1BFFE6BC162__BABICEIE">
                           <p class="titleintable">Table 21-1 XSU Sample Files </p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="XSU Sample Files " summary="This table describes the XML files and programs that you can use to test XSU. File and Description are the Columns." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="33%" id="d77774e1636">File</th>
                                    <th align="left" valign="bottom" width="67%" id="d77774e1639">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1644" headers="d77774e1636 ">
                                       <p><code class="codeph">createObjRelSchema.sql</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1644 d77774e1639 ">
                                       <p>A SQL script that sets up an object-relational schema and populates it. See <a href="using-XML-SQL-utility.html#GUID-A0899DAA-0B1D-482C-99E6-E995F2B535C8" title="XSU can generate an XML document from an object-relational schema.">XML Mapping Against an Object-Relational Schema</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1658" headers="d77774e1636 ">
                                       <p><code class="codeph">createObjRelSchema2.sql</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1658 d77774e1639 ">
                                       <p>A SQL script that sets up an object-relational schema and populates it. See <a href="using-XML-SQL-utility.html#GUID-9BD36D83-085B-418B-AA50-1A01E3322D41" title="You can perform source customizations by altering the SQL query or the database schema.">Altering the Database Schema or SQL Query</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1672" headers="d77774e1636 ">
                                       <p><code class="codeph">createRelSchema.sql</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1672 d77774e1639 ">
                                       <p>A SQL script that creates a relational table and then creates a customer view that contains a customer object on top of it. See <a href="using-XML-SQL-utility.html#GUID-9BD36D83-085B-418B-AA50-1A01E3322D41" title="You can perform source customizations by altering the SQL query or the database schema.">Altering the Database Schema or SQL Query</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1686" headers="d77774e1636 ">
                                       <p><code class="codeph">customer.xml</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1686 d77774e1639 ">
                                       <p>An XML document that describes a customer. See <a href="using-XML-SQL-utility.html#GUID-9BD36D83-085B-418B-AA50-1A01E3322D41" title="You can perform source customizations by altering the SQL query or the database schema.">Altering the Database Schema or SQL Query</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1700" headers="d77774e1636 ">
                                       <p><code class="codeph">domTest.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1700 d77774e1639 ">
                                       <p>A program that generates a DOM tree and then traverses it in document order, printing the nodes one by one. See <a href="using-XML-SQL-utility.html#GUID-3839ED46-BD8B-4069-972A-DEBB031C6F57" title="To generate a DOM tree from the XML generated by XSU, you can directly request a DOM document from XSU. This technique saves the overhead of creating a string representation of the XML document and then parsing it to generate the DOM tree.">Generating a DOM Tree with OracleXMLQuery</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1714" headers="d77774e1636 ">
                                       <p><code class="codeph">index.txt</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1714 d77774e1639 ">
                                       <p>A README that describes the programs in the demo directory.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1722" headers="d77774e1636 ">
                                       <p><code class="codeph">mapColumnToAtt.sql</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1722 d77774e1639 ">
                                       <p>A SQL script that queries the <code class="codeph">employees</code> table, rendering <code class="codeph">employee_id</code> as an XML attribute. See <a href="using-XML-SQL-utility.html#GUID-9BD36D83-085B-418B-AA50-1A01E3322D41" title="You can perform source customizations by altering the SQL query or the database schema.">Altering the Database Schema or SQL Query</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1742" headers="d77774e1636 ">
                                       <p><code class="codeph">new_emp.xml</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1742 d77774e1639 ">
                                       <p>An XML document that describes a new employee. See <a href="using-XML-SQL-utility.html#GUID-D005B919-A669-4BF9-A22A-2F75ECE3B82D" title="The textInsert program is described.">Running the testInsert Program</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1759" headers="d77774e1636 ">
                                       <p><code class="codeph">new_emp2.xml</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1759 d77774e1639 ">
                                       <p>An XML document that describes a new employee. See <a href="using-XML-SQL-utility.html#GUID-ACDEFAC1-46BE-4363-90C4-027897AD1AD9" title="The testInsertSubset program is described.">Running the testInsertSubset Program</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1776" headers="d77774e1636 ">
                                       <p><code class="codeph">noRowsTest.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1776 d77774e1639 ">
                                       <p>A program that throws an exception when there are no more rows. See <a href="using-XML-SQL-utility.html#GUID-4F096761-00BB-4A94-9368-F91C7ACA9D2C" title="When there are no rows to process, XSU returns a null string. You can throw an exception each time there are no more rows, however, so that a program can process this exception using exception handlers.">Raising a No Rows Exception</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1793" headers="d77774e1636 ">
                                       <p><code class="codeph">pageTest.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1793 d77774e1639 ">
                                       <p>A program that uses the JDBC <code class="codeph">ResultSet</code> to generate XML one page at a time. See <a href="using-XML-SQL-utility.html#GUID-788FD888-45E4-4B7F-91CD-0151398196CF" title="You might want to perform a query and then retrieve a previous page of results from within the result set. To enable scrolling, instantiate the Oracle.jdbc.ResultSet class. You can use the ResultSet object to move back and forth within the result set and use XSU to generate XML each time.">Generating Scrollable Result Sets</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1817" headers="d77774e1636 ">
                                       <p><code class="codeph">paginateResults.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1817 d77774e1639 ">
                                       <p>A program that generates an XML page that paginates results. See <a href="using-XML-SQL-utility.html#GUID-790B346F-11A5-493A-B34A-E972069F95EC" title="The paginateResults.java program shows how you can generate an XML page that paginates results. The output XML displays only 20 rows of the hr table.">Paginating Results with OracleXMLQuery: Example</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1837" headers="d77774e1636 ">
                                       <p><code class="codeph">refCurTest.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1837 d77774e1639 ">
                                       <p>A program that generates XML from the results of the SQL query defined in the <code class="codeph">testRefCur</code> function. See <a href="using-XML-SQL-utility.html#GUID-B77E1941-0B4C-4B73-8EBC-25357E3DA75C" title="You can initialize a CallableStatement object, execute a PL/SQL function that returns a cursor variable, get the OracleResultSet object, and send it to an OracleXMLQuery object to obtain the desired XML data.">Generating XML from Cursor Objects</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1863" headers="d77774e1636 ">
                                       <p><code class="codeph">samp1.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1863 d77774e1639 ">
                                       <p>A program that queries the <code class="codeph">scott.emp</code> table, then generates an XML document from the query results.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1874" headers="d77774e1636 ">
                                       <p><code class="codeph">samp10.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1874 d77774e1639 ">
                                       <p>A program that inserts <code class="codeph">sampdoc.xml</code> into the <code class="codeph">xmltest_tab1</code> table.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1888" headers="d77774e1636 ">
                                       <p><code class="codeph">samp2.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1888 d77774e1639 ">
                                       <p>A program that queries the <code class="codeph">scott.emp</code> table, then generates an XML document from the query results. This program demonstrates how you can customize the generated XML document.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1899" headers="d77774e1636 ">
                                       <p><code class="codeph">sampdoc.xml</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1899 d77774e1639 ">
                                       <p>A sample XML data document that <code class="codeph">samp10.java</code> inserts into the database.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1910" headers="d77774e1636 ">
                                       <p><code class="codeph">samps.sql</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1910 d77774e1639 ">
                                       <p>A SQL script that creates the <code class="codeph">xmltest_tab1</code> table used by <code class="codeph">samp10.java</code>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1924" headers="d77774e1636 ">
                                       <p><code class="codeph">testDeleteKey.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1924 d77774e1639 ">
                                       <p>A program that limits the number of elements used to identify a row, which improves performance by caching the <code class="codeph">DELETE</code> statement and batching transactions. See <a href="using-XML-SQL-utility.html#GUID-2D3D2A64-0291-4D19-9783-4BD518C8E95D" title="To use only the key values as predicates on the DELETE statement, invoke the OracleXMLSave.setKeyColumnList() method. This approach limits the number of elements used to identify a row, which has the benefit of improving performance by caching the DELETE statement and batching transactions. The testDeleteKey.java program shows this technique.">Deleting by Key with OracleXMLSave</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1953" headers="d77774e1636 ">
                                       <p><code class="codeph">testDeleteRow.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1953 d77774e1639 ">
                                       <p>A program that accepts an XML document file name as input and deletes the rows corresponding to the elements in the document. See <a href="using-XML-SQL-utility.html#GUID-FD22DD32-C1F3-475E-8F5C-A735E2DC6FFE" title="The testDeleteRow.java demo program accepts an XML document file name as input and deletes the rows corresponding to the elements in the document.">Deleting by Row with OracleXMLSave</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1970" headers="d77774e1636 ">
                                       <p><code class="codeph">testException.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1970 d77774e1639 ">
                                       <p>A sample program shown that throws a runtime exception and then gets the parent exception by invoking <code class="codeph">Exception.getParentException()</code>. See <a href="using-XML-SQL-utility.html#GUID-3184503E-9C0D-4DFF-984E-5D1C6512AA42" title="The testException.java demo program throws a runtime exception and then gets the parent exception by invoking Exception.getParentException().">Getting the Parent Exception</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e1993" headers="d77774e1636 ">
                                       <p><code class="codeph">testInsert.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e1993 d77774e1639 ">
                                       <p>A Java program that inserts XML values into all columns of the <code class="codeph">hr.employees</code> table. See <a href="using-XML-SQL-utility.html#GUID-FBDEFAFC-567F-48C5-85F1-B33680A85CA0" title="The testInsert.java demo program inserts XML values into all columns of the hr.employees table.">Inserting XML into All Columns with OracleXMLSave</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e2017" headers="d77774e1636 ">
                                       <p><code class="codeph">testInsertSubset.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e2017 d77774e1639 ">
                                       <p>A program shown that inserts XML data into a subset of columns. See <a href="using-XML-SQL-utility.html#GUID-220FC06C-0D3F-427D-ACEC-B37753B43189" title="In some situations, you might not want to insert values into all columns. For example, the group of values that you get might not be the complete set, requiring you to use triggers or default values for the remaining columns.">Inserting XML into a Subset of Columns with OracleXMLSave</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e2031" headers="d77774e1636 ">
                                       <p><code class="codeph">testRef.sql</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e2031 d77774e1639 ">
                                       <p>A PL/SQL script that creates a function that defines a REF cursor and returns it. Every time the <code class="codeph">testRefCur</code> function is called, it opens a cursor object for the <code class="codeph">SELECT</code> query and returns that cursor instance. See <a href="using-XML-SQL-utility.html#GUID-B77E1941-0B4C-4B73-8EBC-25357E3DA75C" title="You can initialize a CallableStatement object, execute a PL/SQL function that returns a cursor variable, get the OracleResultSet object, and send it to an OracleXMLQuery object to obtain the desired XML data.">Generating XML from Cursor Objects</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e2060" headers="d77774e1636 ">
                                       <p><code class="codeph">testUpdate.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e2060 d77774e1639 ">
                                       <p>A sample program that updates the <code class="codeph">hr.employees</code> table by invoking the <code class="codeph">OracleXMLSave.setKeyColumnList()</code> method. See <a href="using-XML-SQL-utility.html#GUID-646799B4-73D6-4AD1-94F1-E614343D65F6" title="Examples show how to update the fields in a table or view. You supply the table or view name and an XML document. XSU parses the document (if a string is given) and creates one or more UPDATE statements into which it binds all of the values.">Updating Rows Using OracleXMLSave</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e2083" headers="d77774e1636 ">
                                       <p><code class="codeph">testUpdateList.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e2083 d77774e1639 ">
                                       <p>Suppose you want to update only the salary and job title for each employee and ignore the other information. If you know that all the elements to be updated are the same for all <code class="codeph">ROW</code> elements in the XML document, then you can use the <code class="codeph">OracleXMLSave.setUpdateColumnNames()</code> method to specify the columns. See <a href="using-XML-SQL-utility.html#GUID-BF4F12F6-1EC7-4B6D-BEEC-A9D9D5816D8B">Updating a Column List Using OracleXMLSave</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e2102" headers="d77774e1636 ">
                                       <p><code class="codeph">testXMLSQL.java</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e2102 d77774e1639 ">
                                       <p>A sample program that uses XSU to generate XML as a <code class="codeph">String</code> object. This program queries the <code class="codeph">hr.employees</code> table and prints the result set to standard output. See <a href="using-XML-SQL-utility.html#GUID-40A59B26-5039-45FB-BCC0-6C886C573E80" title="The testXMLSQL.java demo program uses XSU to generate XML as a String object. The program queries table hr.employees and prints the result set to standard output.">Generating a String with OracleXMLQuery</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e2131" headers="d77774e1636 ">
                                       <p><code class="codeph">upd_emp.xml</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e2131 d77774e1639 ">
                                       <p>An XML document that contains updated salary and other information for a series of employees. See <a href="using-XML-SQL-utility.html#GUID-E1F2B493-A35D-4069-AE61-310538FA2FF0" title="The testUpdate program is described.">Running the testUpdate Program</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e2148" headers="d77774e1636 ">
                                       <p><code class="codeph">upd_emp2.xml</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e2148 d77774e1639 ">
                                       <p>An XML document that contains updated salary and other information for a series of employees. See <a href="using-XML-SQL-utility.html#GUID-E1F2B493-A35D-4069-AE61-310538FA2FF0" title="The testUpdate program is described.">Running the testUpdate Program</a>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d77774e2165" headers="d77774e1636 ">
                                       <p><code class="codeph">updateEmployee.sql</code></p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d77774e2165 d77774e1639 ">
                                       <p>An XML document that contains new data for two employees. See <a href="using-XML-SQL-utility.html#GUID-F631E856-2DF4-4926-90AA-BFF97840F90F" title="The testUpdateList program is described.">Running the testUpdateList Program</a>.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>The steps for running the demos are:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Change into the <code class="codeph">$ORACLE_HOME/xdk/demo/java/xsu</code> directory (UNIX) or <code class="codeph">%ORACLE_HOME%\xdk\demo\java\xsu</code> directory (Windows).</span></li>
                        <li class="stepexpand"><span>Ensure that your environment variables are set as described in <a href="getting-started-with-XDK-for-Java.html#GUID-EA5DB831-1D91-453A-AF7B-7B55343B1720" title="You can set up the XDK for Java environment using either an environment variable or a command-line option.">Setting Up the XDK for Java Environment</a>. In particular, ensure that the Java classpath includes <code class="codeph">xsu12.jar</code> for XSU and <code class="codeph">ojdbc6.jar</code> (Java 1.6) for JDBC. If you use a multibyte character set other than UTF-8, ISO8859-1, or JA16SJIS, then place <code class="codeph">orai18n.jar</code> in your classpath so that JDBC can convert the character set of the input file to the database character set.</span></li>
                        <li class="stepexpand"><span>Compile the Java programs as shown in this example:</span><div><pre class="oac_no_warn" dir="ltr">javac samp1.java samp2.java samp10.java
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect to a database as user <code class="codeph">hr</code> and run SQL script <code class="codeph">createRelSchema</code>:</span><div><pre class="oac_no_warn" dir="ltr">CONNECT hr
@$ORACLE_HOME/xdk/demo/java/xsu/createRelSchema
</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>These sections describe the XSU demos in detail.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19414"></a><a id="ADXDK19415"></a><a id="ADXDK19413"></a><div class="props_rev_3"><a id="GUID-939256D1-157F-4736-B74D-3288C60A3069" name="GUID-939256D1-157F-4736-B74D-3288C60A3069"></a><h4 id="ADXDK-GUID-939256D1-157F-4736-B74D-3288C60A3069" class="sect4">Using the XSU Command-Line Utility</h4>
                  <div>
                     <p>XDK includes a command-line Java interface for XSU. XSU command-line options are provided through the Java class <code class="codeph">OracleXML</code>.
                     </p>
                     <div class="section">
                        <p>To use this API ensure that your Java classpath is set as described in <a href="getting-started-with-XDK-for-Java.html#GUID-EA5DB831-1D91-453A-AF7B-7B55343B1720" title="You can set up the XDK for Java environment using either an environment variable or a command-line option.">Setting Up the XDK for Java Environment</a>.
                        </p>
                        <p>To print usage information for XSU to standard output, run this command: </p><pre class="oac_no_warn" dir="ltr">java OracleXML
</pre><p>To use XSU, invoke it with either the <code class="codeph">getXML</code> or <code class="codeph">putXML</code> parameter:
                        </p><pre class="oac_no_warn" dir="ltr">java OracleXML getXML <span class="italic"><code class="codeph">options</code></span>
java OracleXML putXML <span class="italic"><code class="codeph">options</code></span>
</pre><p><a href="using-XML-SQL-utility.html#GUID-939256D1-157F-4736-B74D-3288C60A3069__BABGDFFJ" title="This table describes the getXML options.">Table 21-2</a> describes the <code class="codeph">getXML</code> options. 
                        </p>
                        <div class="tblformalwide" id="GUID-939256D1-157F-4736-B74D-3288C60A3069__BABGDFFJ">
                           <p class="titleintable">Table 21-2 getXML Options</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="getXML Options" summary="This table describes the getXML options." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="38%" id="d77774e2365">getXML Option</th>
                                    <th align="left" valign="bottom" width="62%" id="d77774e2368">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2373" headers="d77774e2365 ">
                                       <p><code class="codeph">-user</code> "<span class="italic"><code class="codeph">username</code></span>/<span class="italic"><code class="codeph">password"</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2373 d77774e2368 ">
                                       <p>Specifies the user name and password to connect to the database. The connect string is also specified. You can specify the user name and password as part of the connect string.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2389" headers="d77774e2365 ">
                                       <p><code class="codeph">-conn</code> <span class="italic"><code class="codeph">"JDBC_connect_string"</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2389 d77774e2368 ">
                                       <p>Specifies the JDBC database connect string. By default the connect string is: "<code class="codeph">jdbc:oracle:oci:@</code>".
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2404" headers="d77774e2365 ">
                                       <p><code class="codeph">-withDTD</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2404 d77774e2368 ">
                                       <p>Instructs the XSU to generate the DTD along with the XML document.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2412" headers="d77774e2365 ">
                                       <p><code class="codeph">-withSchema</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2412 d77774e2368 ">
                                       <p>Instructs the XSU to generate the schema along with the XML document.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2420" headers="d77774e2365 ">
                                       <p><code class="codeph">-rowsetTag</code> <span class="italic"><code class="codeph">tag_name</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2420 d77774e2368 ">
                                       <p>Specifies the rowset tag, which is tag that encloses all the XML elements corresponding to the records returned by the query. The default rowset tag is <code class="codeph">&lt;ROWSET&gt;</code>. If you specify an empty string ("") for rowset, then XSU omits the rowset element. 
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2435" headers="d77774e2365 ">
                                       <p><code class="codeph">-rowTag</code> <span class="italic"><code class="codeph">tag_name</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2435 d77774e2368 ">
                                       <p>Specifies the row tag that encloses the data corresponding to a database row. The default row tag is <code class="codeph">&lt;ROW&gt;</code>. If you specify an empty string ("") for the row tag, then XSU omits the row tag.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2450" headers="d77774e2365 ">
                                       <p><code class="codeph">-rowIdAttr</code> <span class="italic"><code class="codeph">row_id_attribute_name</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2450 d77774e2368 ">
                                       <p>Names the attribute of the <code class="codeph">ROW</code> element that keeps track of the cardinality of the <code class="codeph">rows</code>. By default this attribute is <code class="codeph">num</code>. If you specify an empty string as the <code class="codeph">rowID</code> attribute, then XSU omits the attribute.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2474" headers="d77774e2365 ">
                                       <p> -<code class="codeph">rowIdColumn</code> <span class="italic"><code class="codeph">row_Id_column_name</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2474 d77774e2368 ">
                                       <p>Specifies that the value of a scalar column from the query is to be used as the value of the <code class="codeph">rowID</code> attribute.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2490" headers="d77774e2365 ">
                                       <p><code class="codeph">-collectionIdAttr</code> <span class="italic"><code class="codeph">collect_id_attr_name</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2490 d77774e2368 ">
                                       <p>Names the attribute of an XML list element that keeps track of the cardinality of the elements of the list. The generated XML lists correspond to either a cursor query, or collection. If you specify an empty string ("") as the <code class="codeph">rowID</code> attribute, then XSU omits the attribute.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2505" headers="d77774e2365 ">
                                       <p><code class="codeph">-useTypeForCollElemTag</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2505 d77774e2368 ">
                                       <p>Specifies the use type name for the column-element tag. By default XSU uses the <code class="codeph">column-name_item</code>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2516" headers="d77774e2365 ">
                                       <p><code class="codeph">-useNullAttrId</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2516 d77774e2368 ">
                                       <p>Specifies the attribute <code class="codeph">NULL (TRUE/FALSE)</code> to indicate the nullness of an element.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2528" headers="d77774e2365 ">
                                       <p><code class="codeph">-styleSheet</code> <span class="italic"><code class="codeph">stylesheet_URI</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2528 d77774e2368 ">
                                       <p>Specifies the stylesheet in the XML processing instruction.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2540" headers="d77774e2365 ">
                                       <p><code class="codeph">-stylesheetType</code> <span class="italic"><code class="codeph">stylesheet_type</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2540 d77774e2368 ">
                                       <p>Specifies the stylesheet type in the XML processing instruction.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2552" headers="d77774e2365 ">
                                       <p><code class="codeph">-setXSLT </code><span class="italic"><code class="codeph">URI</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2552 d77774e2368 ">
                                       <p>Specifies the XSLT stylesheet to apply to the XML document.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2563" headers="d77774e2365 ">
                                       <p><code class="codeph">-setXSLTRef</code> <span class="italic"><code class="codeph">URI</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2563 d77774e2368 ">
                                       <p>Sets the XSLT external entity reference.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2575" headers="d77774e2365 ">
                                       <p><code class="codeph">-useLowerCase | -useUpperCase</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2575 d77774e2368 ">
                                       <p>Generates lowercase or uppercase tag names. The default is to match the case of the SQL object names from which the tags are generated.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2583" headers="d77774e2365 ">
                                       <p><code class="codeph">-withEscaping</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2583 d77774e2368 ">
                                       <p>Specifies the treatment of characters that are legal in SQL object names but illegal in XML tags. If such a character is encountered, then it is escaped so that it does not throw an exception.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2591" headers="d77774e2365 ">
                                       <p><code class="codeph">-errorTag</code> <span class="italic"><code class="codeph">error tag_name</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2591 d77774e2368 ">
                                       <p>Specifies the tag to enclose error messages that are formatted as XML.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2603" headers="d77774e2365 ">
                                       <p><code class="codeph">-raiseException</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2603 d77774e2368 ">
                                       <p>Specifies that XSU must throw a Java exception. By default XSU catches any error and produces the XML error.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2611" headers="d77774e2365 ">
                                       <p><code class="codeph">-raiseNoRowsException</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2611 d77774e2368 ">
                                       <p>Raises an exception if no rows are returned.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2619" headers="d77774e2365 ">
                                       <p><code class="codeph">-useStrictLegalXMLCharCheck</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2619 d77774e2368 ">
                                       <p>Performs strict checking on input data.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2627" headers="d77774e2365 ">
                                       <p><code class="codeph">-maxRows</code> <span class="italic"><code class="codeph">maximum_rows</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2627 d77774e2368 ">
                                       <p>Specifies the maximum number of rows to be retrieved and converted to XML.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2640" headers="d77774e2365 ">
                                       <p><code class="codeph">-skipRows </code><span class="italic"><code class="codeph">number_of_rows_to_skip</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2640 d77774e2368 ">
                                       <p>Specifies the number of rows to be skipped.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2651" headers="d77774e2365 ">
                                       <p><code class="codeph">-encoding</code> <span class="italic"><code class="codeph">encoding_name</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2651 d77774e2368 ">
                                       <p>Specifies the character set encoding of the generated XML.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2663" headers="d77774e2365 ">
                                       <p><code class="codeph">-dateFormat</code> <span class="italic"><code class="codeph">date_format</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2663 d77774e2368 ">
                                       <p>Specifies the date format for the date values in the XML document.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2675" headers="d77774e2365 ">
                                       <p><code class="codeph">-fileName</code> <span class="italic"><code class="codeph">SQL_query_fileName</code></span> | <span class="italic"><code class="codeph">SQL_query</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2675 d77774e2368 ">
                                       <p>Specifies the file name that contains the query or the query itself.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p><a href="using-XML-SQL-utility.html#GUID-939256D1-157F-4736-B74D-3288C60A3069__BABEFCDB" title="putXML Option and Description are the columns.">Table 21-3</a> describes the <code class="codeph">putXML</code> options. 
                        </p>
                        <div class="tblformalwide" id="GUID-939256D1-157F-4736-B74D-3288C60A3069__BABEFCDB">
                           <p class="titleintable">Table 21-3 putXML Options </p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="putXML Options " summary="putXML Option and Description are the columns." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="38%" id="d77774e2709">putXML Options</th>
                                    <th align="left" valign="bottom" width="62%" id="d77774e2712">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2717" headers="d77774e2709 ">
                                       <p><code class="codeph">-user "</code><span class="italic"><code class="codeph">username</code></span>/<span class="italic"><code class="codeph">password"</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2717 d77774e2712 ">
                                       <p>Specifies the user name and password to connect to the database. The connect string is also specified. You can specify the user name and password as part of the connect string.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2732" headers="d77774e2709 ">
                                       <p><code class="codeph">-conn</code> <span class="italic"><code class="codeph">"JDBC_connect_string"</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2732 d77774e2712 ">
                                       <p>Specifies the JDBC database connect string. By default the connect string is: "<code class="codeph">jdbc:oracle:oci:@</code>".
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2747" headers="d77774e2709 ">
                                       <p><code class="codeph">-batchSize</code> <span class="italic"><code class="codeph">batching_size</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2747 d77774e2712 ">
                                       <p>Specifies the batch size that controls the number of rows that are batched together and inserted in a single trip to the database to improve performance.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2759" headers="d77774e2709 ">
                                       <p><code class="codeph">-commitBatch</code> <span class="italic"><code class="codeph">commit_size</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2759 d77774e2712 ">
                                       <p>Specifies the number of inserted records after which a commit is to be executed. If the autocommit is <code class="codeph">TRUE</code> (the default), then setting <code class="codeph">commitBatch</code> has no consequence.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2777" headers="d77774e2709 ">
                                       <p><code class="codeph">-rowTag</code> <span class="italic"><code class="codeph">tag_name</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2777 d77774e2712 ">
                                       <p>Specifies the <code class="codeph">row</code> tag, which is tag used to enclose the data corresponding to a database row. The default row tag is <code class="codeph">&lt;ROW&gt;</code>. If you specify an empty string for the row tag, then XSU omits the row tag.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2795" headers="d77774e2709 ">
                                       <p><code class="codeph">-dateFormat</code> <span class="italic"><code class="codeph">date_format</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2795 d77774e2712 ">
                                       <p>Specifies the date format for the date values in the XML document.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2807" headers="d77774e2709 ">
                                       <p><code class="codeph">-withEscaping</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2807 d77774e2712 ">
                                       <p>Turns on reverse mapping if SQL to XML name escaping was used when generating the doc.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2815" headers="d77774e2709 ">
                                       <p><code class="codeph">-ignoreCase</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2815 d77774e2712 ">
                                       <p>Makes the matching of the column names with tag names case insensitive. For example, <code class="codeph">EmpNo</code> matches with <code class="codeph">EMPNO</code> if <code class="codeph">ignoreCase</code> is on.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2832" headers="d77774e2709 ">
                                       <p><code class="codeph">-preserveWhitespace</code></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2832 d77774e2712 ">
                                       <p>Preserves the white space in the inserted XML document.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2840" headers="d77774e2709 ">
                                       <p><code class="codeph">-setXSLT</code><span class="italic"><code class="codeph"> URI</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2840 d77774e2712 ">
                                       <p>Specifies the XSLT to apply to the XML document before inserting. </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2851" headers="d77774e2709 ">
                                       <p><code class="codeph">-setXSLTRef</code> <span class="italic"><code class="codeph">URI</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2851 d77774e2712 ">
                                       <p>Sets the XSLT external entity reference.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2864" headers="d77774e2709 ">
                                       <p><code class="codeph">-fileName</code> <span class="italic"><code class="codeph">file_name</code></span> | <code class="codeph">-URL </code><span class="italic"><code class="codeph">URL</code></span> | <code class="codeph">-xmlDoc</code> <span class="italic"><code class="codeph">xml_document</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2864 d77774e2712 ">
                                       <p>Specifies the XML document to insert: a local file, a URL, or an XML document as a string on the command line.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="38%" id="d77774e2889" headers="d77774e2709 ">
                                       <p><span class="italic"><code class="codeph">table_name</code></span></p>
                                    </td>
                                    <td align="left" valign="top" width="62%" headers="d77774e2889 d77774e2712 ">
                                       <p>Specifies the name of the table to put the values into.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19416"></a><div class="props_rev_3"><a id="GUID-174D770C-41CE-48E3-A55D-1ADFEF0E6465" name="GUID-174D770C-41CE-48E3-A55D-1ADFEF0E6465"></a><h5 id="ADXDK-GUID-174D770C-41CE-48E3-A55D-1ADFEF0E6465" class="sect5">Generating XML with the XSU Command-Line Utility</h5>
                     <div>
                        <p>To generate XML from the database schema use the <code class="codeph">getXML</code> parameter. 
                        </p>
                        <div class="section">
                           <p>For example, to generate an XML document by querying the <code class="codeph">employees</code> table in the <code class="codeph">hr</code> schema, you can use this syntax:
                           </p><pre class="oac_no_warn" dir="ltr">java OracleXML getXML -user "hr/<span class="italic">password</span>" "SELECT * FROM employees"
</pre><p>The preceding command performs these tasks:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li><span>Connects to the current default database</span></li>
                           <li><span>Executes the specified <code class="codeph">SELECT</code> query</span></li>
                           <li><span>Converts the SQL result set to XML</span></li>
                           <li><span>Prints the XML to standard output</span></li>
                        </ol>
                        <div class="section">
                           <p>The<code class="codeph"> getXML</code> parameter supports a wide range of options, which are explained in <a href="using-XML-SQL-utility.html#GUID-939256D1-157F-4736-B74D-3288C60A3069__BABGDFFJ" title="This table describes the getXML options.">Table 21-2</a>.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADXDK071"></a><div class="props_rev_3"><a id="GUID-02BD7152-7DDE-4525-81B5-9DA84AD57113" name="GUID-02BD7152-7DDE-4525-81B5-9DA84AD57113"></a><h5 id="ADXDK-GUID-02BD7152-7DDE-4525-81B5-9DA84AD57113" class="sect5">Generating XMLType Data with the XSU Command-Line Utility</h5>
                     <div>
                        <p>You can use XSU to generate XML from tables with <code class="codeph">XMLType</code> columns. 
                        </p>
                        <div class="section">
                           <p>Suppose that you run the demo script <code class="codeph">setup_xmltype.sql</code> to create and populate the <code class="codeph">parts</code> table. You can generate XML from this table with XSU:
                           </p><pre class="oac_no_warn" dir="ltr">java OracleXML getXML -user "hr/<span class="italic">password</span>" -rowTag "Part" "SELECT * FROM parts"
</pre><p>The output of the command is shown below:</p><pre class="pre codeblock"><code>&lt;?xml version = '1.0'?&gt;
&lt;ROWSET&gt;
   &lt;Part num="1"&gt;
      &lt;PARTNO&gt;1735&lt;/PARTNO&gt;
      &lt;PARTNAME&gt;Gizmo&lt;/PARTNAME&gt;
      &lt;PARTDESC&gt;
         &lt;Description&gt;
           &lt;Title&gt;Description of the Gizmo&lt;/Title&gt;
           &lt;Author&gt;John Smith&lt;/Author&gt;
           &lt;Body&gt;
             The &lt;b&gt;Gizmo&lt;/b&gt; is &lt;i&gt;grand&lt;/i&gt;.
           &lt;/Body&gt;
         &lt;/Description&gt;
      &lt;/PARTDESC&gt;
   &lt;/Part&gt;
&lt;/ROWSET&gt;</code></pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADXDK19417"></a><div class="props_rev_3"><a id="GUID-760FF626-748B-4216-B8BC-EF8CC1A2B89A" name="GUID-760FF626-748B-4216-B8BC-EF8CC1A2B89A"></a><h5 id="ADXDK-GUID-760FF626-748B-4216-B8BC-EF8CC1A2B89A" class="sect5">Performing DML with the XSU Command-Line Utility</h5>
                     <div>
                        <p>An example shows how to  insert an XML document into a database table.</p>
                        <div class="section">
                           <p>To insert an XML document called <code class="codeph">new_employees.xml</code> into the <code class="codeph">hr.employees</code> table, use this syntax:
                           </p><pre class="oac_no_warn" dir="ltr">java OracleXML putXML -user "hr/<span class="italic">password</span>" -fileName "new_employees.xml" employees
</pre><p>The preceding command performs these tasks:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li><span>Connects to the current database as <code class="codeph">hr</code></span></li>
                           <li><span>Reads the XML document named <code class="codeph">new_emp.xml</code></span></li>
                           <li><span>Parses the XML document, matching the tags with column names</span></li>
                           <li><span>Inserts the values appropriately into the <code class="codeph">employees</code> table</span></li>
                        </ol>
                        <div class="section">
                           <p>The<code class="codeph"> getXML</code> parameter supports a wide range of options, which are explained in <a href="using-XML-SQL-utility.html#GUID-939256D1-157F-4736-B74D-3288C60A3069__BABGDFFJ" title="This table describes the getXML options.">Table 21-2</a>.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="ADXDK1010"></a><a id="ADXDK19418"></a><div class="props_rev_3"><a id="GUID-4922BDF4-3588-4348-9509-16BB8AB1A691" name="GUID-4922BDF4-3588-4348-9509-16BB8AB1A691"></a><h3 id="ADXDK-GUID-4922BDF4-3588-4348-9509-16BB8AB1A691" class="sect3">Programming with the XSU Java API</h3>
               <div>
                  <p>Topics here include using OracleXMLQuery and OracleXMLSave to perform various operations, and handling XSU Java exceptions.</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19419"></a><div class="props_rev_3"><a id="GUID-40A59B26-5039-45FB-BCC0-6C886C573E80" name="GUID-40A59B26-5039-45FB-BCC0-6C886C573E80"></a><h4 id="ADXDK-GUID-40A59B26-5039-45FB-BCC0-6C886C573E80" class="sect4">Generating a String with OracleXMLQuery</h4>
                  <div>
                     <p>The <code class="codeph">testXMLSQL.java</code> demo program uses XSU to generate XML as a <code class="codeph">String</code> object. The program queries table <code class="codeph">hr.employees</code> and prints the result set to standard output.
                     </p>
                     <div class="section">
                        <p>The <code class="codeph">testXMLSQL.java</code> program follows these steps:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Register the JDBC driver and create a database connection. This code fragment uses the OCI JDBC driver and connects with the user name <code class="codeph">hr</code>:</span><div><pre class="oac_no_warn" dir="ltr">import oracle.jdbc.*;...Connection conn  = getConnection("hr","<span class="italic">password</span>");
...
private static Connection getConnection(String username, String password)
    throws SQLException
{
// register the JDBC driver
  DriverManager.registerDriver(new oracle.jdbc.OracleDriver()); 
// create the connection using the OCI driver
  Connection conn =
    DriverManager.getConnection("jdbc:oracle:oci:@",username,password);
  return conn;
}
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create an XML query object and initialize it with a SQL query. This code fragment initializes the object with a <code class="codeph">SELECT</code> statement on <code class="codeph">hr.employees</code>:</span><div><pre class="oac_no_warn" dir="ltr">OracleXMLQuery qry = new OracleXMLQuery(conn, "SELECT * FROM employees");
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Get the query result set as a <code class="codeph">String</code> object. The <code class="codeph">getXMLString()</code> method transforms the object-relational data specified in the constructor into an XML document. This example shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">String str = qry.getXMLString();
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Close the query object to release any resources, as shown in this code:</span><div><pre class="oac_no_warn" dir="ltr">qry.close();</pre></div>
                        </li>
                     </ol>
                  </div><a id="ADXDK19420"></a><div class="props_rev_3"><a id="GUID-EDD35813-2EC5-485F-9FF9-A62E6524F4B4" name="GUID-EDD35813-2EC5-485F-9FF9-A62E6524F4B4"></a><h5 id="ADXDK-GUID-EDD35813-2EC5-485F-9FF9-A62E6524F4B4" class="sect5">Running the testXMLSQL Program</h5>
                     <div>
                        <p>The <code class="codeph">testXMLSQL</code> program is described.
                        </p>
                        <div class="section">
                           <p>To run the <code class="codeph">testXMLSQL.java</code> program perform these steps:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li><span>Compile <code class="codeph">testXMLSQL.java</code> with <code class="codeph">javac</code>.</span></li>
                           <li><span>Execute <code class="codeph">java testXMLSQL</code> on the command line.</span></li>
                        </ol>
                        <div class="section">
                           <p>You must have the <code class="codeph">CLASSPATH</code> pointing to this directory for the Java executable to find the class. Alternatively, use visual Java tools such as Oracle JDeveloper to compile and run this program. When run, this program prints out the XML file to the screen. This code shows sample output with some rows edited out:
                           </p><pre class="oac_no_warn" dir="ltr">&lt;?xml version = '1.0'?&gt;
&lt;ROWSET&gt;
   &lt;ROW num="1"&gt;
      &lt;EMPLOYEE_ID&gt;100&lt;/EMPLOYEE_ID&gt;
      &lt;FIRST_NAME&gt;Steven&lt;/FIRST_NAME&gt;
      &lt;LAST_NAME&gt;King&lt;/LAST_NAME&gt;
      &lt;EMAIL&gt;SKING&lt;/EMAIL&gt;
      &lt;PHONE_NUMBER&gt;515.123.4567&lt;/PHONE_NUMBER&gt;
      &lt;HIRE_DATE&gt;6/17/1987 0:0:0&lt;/HIRE_DATE&gt;
      &lt;JOB_ID&gt;AD_PRES&lt;/JOB_ID&gt;
      &lt;SALARY&gt;24000&lt;/SALARY&gt;
      &lt;DEPARTMENT_ID&gt;90&lt;/DEPARTMENT_ID&gt;
   &lt;/ROW&gt;
&lt;!-- ROW num="2" through num="107" ... --&gt;
&lt;/ROWSET&gt;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADXDK19421"></a><div class="props_rev_3"><a id="GUID-3839ED46-BD8B-4069-972A-DEBB031C6F57" name="GUID-3839ED46-BD8B-4069-972A-DEBB031C6F57"></a><h4 id="ADXDK-GUID-3839ED46-BD8B-4069-972A-DEBB031C6F57" class="sect4">Generating a DOM Tree with OracleXMLQuery</h4>
                  <div>
                     <p>To generate a DOM tree from the XML generated by XSU, you can directly request a DOM document from XSU. This technique saves the overhead of creating a string representation of the XML document and then parsing it to generate the DOM tree.</p>
                     <div class="section">
                        <p>XSU invokes the Oracle XML parser to construct the DOM tree from the data values. The <code class="codeph">domTest.java</code> demo program generates a DOM tree and then traverses it in document order, printing the nodes one by one.
                        </p>
                        <p>The first two steps in the <code class="codeph">domTest.java</code> program are the same as in the <code class="codeph">testXMLSQL.java</code> program described in <a href="using-XML-SQL-utility.html#GUID-40A59B26-5039-45FB-BCC0-6C886C573E80" title="The testXMLSQL.java demo program uses XSU to generate XML as a String object. The program queries table hr.employees and prints the result set to standard output.">Generating a String with OracleXMLQuery</a>. The program proceeds as follows:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Get the DOM by invoking <code class="codeph">getXMLDOM()</code> method. The following example shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">XMLDocument domDoc = (XMLDocument)qry.getXMLDOM();
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Print the DOM tree. The following code prints to standard output:</span><div><pre class="oac_no_warn" dir="ltr">domDoc.print(System.out);
</pre><p>You can also create a <code class="codeph">StringWriter</code> and wrap it in a <code class="codeph">PrintWriter</code>:
                              </p><pre class="oac_no_warn" dir="ltr">StringWriter s = new StringWriter(10000);
domDoc.print(new PrintWriter(s));
System.out.println(" The string version ---&gt; \n"+s.toString());
</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>After compiling the program, run it from the command line:</p><pre class="oac_no_warn" dir="ltr">java domTest</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK1011"></a><a id="ADXDK19422"></a><div class="props_rev_3"><a id="GUID-0C64EE95-DAF1-4A51-B35E-C1C0C10C96C5" name="GUID-0C64EE95-DAF1-4A51-B35E-C1C0C10C96C5"></a><h4 id="ADXDK-GUID-0C64EE95-DAF1-4A51-B35E-C1C0C10C96C5" class="sect4">Paginating Results with OracleXMLQuery</h4>
                  <div>
                     <p>Topics here include limiting the rows in a result set, keeping an object open during a user session, and paginating results using <code class="codeph">OracleXMLQuery</code>.
                     </p>
                     <div class="section"> </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19424"></a><a id="ADXDK19423"></a><div class="props_rev_3"><a id="GUID-F777424E-1212-4F8E-A134-3CD61A07DDB0" name="GUID-F777424E-1212-4F8E-A134-3CD61A07DDB0"></a><h5 id="ADXDK-GUID-F777424E-1212-4F8E-A134-3CD61A07DDB0" class="sect5">Limiting the Number of Rows in the Result Set </h5>
                     <div>
                        <p>Different ways to limit the number of rows in a result set are described.</p>
                        <div class="section">
                           <p>In <code class="codeph">testXMLSQL.java</code> and <code class="codeph">domTest.java</code>, XSU generated XML from all rows returned by the query. Suppose that you query a table that contains 1000 rows, but you want only 100 rows at a time. One approach is to execute one query to get the first 100 rows, another to get the next 100 rows, and so on. With this technique you cannot skip the first five rows of the query and then generate the result. To avoid these problems, use these Java methods:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">OracleXMLSave.setSkipRows()</code> forces XSU to skip the desired number of rows before starting to generate the result. The command-line equivalent to this method is the <code class="codeph">-skipRows</code> parameter.
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">OracleXMLSave.setMaxRows()</code> limits the number of rows converted to XML. The command-line equivalent to this method is the <code class="codeph">-maxRows</code> parameter.
                                 </p>
                              </li>
                           </ul>
                           <p><a href="using-XML-SQL-utility.html#GUID-F777424E-1212-4F8E-A134-3CD61A07DDB0__BABHCFIG">Example 21-1</a> sets <code class="codeph">skipRows</code> to a value of <code class="codeph">5</code> and <code class="codeph">maxRows</code> to a value of <code class="codeph">1</code>, which causes XSU to skip the first 5 rows and then generate XML for the next row when querying the <code class="codeph">hr.employees</code> table.
                           </p>
                           <p>The following shows sample output (only row 6 of the query result set is returned):</p><pre class="oac_no_warn" dir="ltr">&lt;?xml version = '1.0'?&gt;
&lt;ROWSET&gt;
   &lt;ROW num="6"&gt;
      &lt;EMPLOYEE_ID&gt;105&lt;/EMPLOYEE_ID&gt;
      &lt;FIRST_NAME&gt;David&lt;/FIRST_NAME&gt;
      &lt;LAST_NAME&gt;Austin&lt;/LAST_NAME&gt;
      &lt;EMAIL&gt;DAUSTIN&lt;/EMAIL&gt;
      &lt;PHONE_NUMBER&gt;590.423.4569&lt;/PHONE_NUMBER&gt;
      &lt;HIRE_DATE&gt;6/25/1997 0:0:0&lt;/HIRE_DATE&gt;
      &lt;JOB_ID&gt;IT_PROG&lt;/JOB_ID&gt;
      &lt;SALARY&gt;4800&lt;/SALARY&gt;
      &lt;MANAGER_ID&gt;103&lt;/MANAGER_ID&gt;
      &lt;DEPARTMENT_ID&gt;60&lt;/DEPARTMENT_ID&gt;
   &lt;/ROW&gt;
&lt;/ROWSET&gt;</pre></div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-F777424E-1212-4F8E-A134-3CD61A07DDB0__BABHCFIG">
                           <p class="titleinexample">Example 21-1 Specifying skipRows and maxRows on the Command Line</p><pre class="oac_no_warn" dir="ltr">java OracleXML getXML -user "hr/<span class="italic">password</span>" -skipRows 5 -maxRows 1 \
  "SELECT * FROM employees"
</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADXDK19425"></a><div class="props_rev_3"><a id="GUID-9CECA907-B96B-4165-B774-9D9F777C6DBB" name="GUID-9CECA907-B96B-4165-B774-9D9F777C6DBB"></a><h5 id="ADXDK-GUID-9CECA907-B96B-4165-B774-9D9F777C6DBB" class="sect5">Keeping an Object Open for the Duration of the User's Session</h5>
                     <div>
                        <p>In some situations, you might want to keep a query object open for the duration of the user session. You can handle such cases with the <code class="codeph">maxRows()</code> method and the <code class="codeph">keepObjectOpen()</code> method.
                        </p>
                        <div class="section">
                           <p>Consider a web search engine that paginates search results. The first page lists 10 results, the next page lists 10 more, and so on. To perform this task with XSU, request 10 rows at a time and keep the <code class="codeph">ResultSet</code> open so that the next time you ask XSU for more results, it starts generating from where the last generation finished. If <code class="codeph">OracleXMLQuery</code> creates a result set from the SQL query string, then it typically closes the <code class="codeph">ResultSet</code> internally because it assumes no more results are required. Thus, you must invoke <code class="codeph">keepObjectOpen()</code> to keep the cursor active. 
                           </p>
                           <p>A different case requiring an open query object is when the number of rows or number of columns in a row is very large. In this case, you can generate multiple small documents rather than one large document.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="using-XML-SQL-utility.html#GUID-790B346F-11A5-493A-B34A-E972069F95EC" title="The paginateResults.java program shows how you can generate an XML page that paginates results. The output XML displays only 20 rows of the hr table.">Paginating Results with OracleXMLQuery: Example</a></li>
                           </ul>
                        </div>
                     </div>
                     
                  </div><a id="ADXDK19426"></a><div class="props_rev_3"><a id="GUID-790B346F-11A5-493A-B34A-E972069F95EC" name="GUID-790B346F-11A5-493A-B34A-E972069F95EC"></a><h5 id="ADXDK-GUID-790B346F-11A5-493A-B34A-E972069F95EC" class="sect5">Paginating Results with OracleXMLQuery: Example</h5>
                     <div>
                        <p>The <code class="codeph">paginateResults.java</code> program shows how you can generate an XML page that paginates results. The output XML displays only 20 rows of the <code class="codeph">hr</code> table.
                        </p>
                        <div class="section">
                           <p>The <code class="codeph">paginateResults.java</code> program shows how you can generate an XML page that paginates results. The output XML displays only 20 rows of the <code class="codeph">hr</code> table.
                           </p>
                           <p>The first step of the <code class="codeph">paginateResults.java</code> program, which creates the connection, is the same as in <code class="codeph">testXMLSQL.java</code>. The program continues as follows:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create a SQL statement object and initialize it with a SQL query. The following code fragment sets two options in <code class="codeph">java.sql.ResultSet</code>:</span><div><pre class="oac_no_warn" dir="ltr">Statement stmt = conn.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE, 
                                      ResultSet.CONCUR_READ_ONLY);
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create the query as a string and execute it by invoking <code class="codeph">Statement.executeQuery()</code>. The return object is of type <code class="codeph">ResultSet</code>. The following example shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">String sCmd = "SELECT first_name, last_name FROM hr.employees"; 
ResultSet rs = stmt.executeQuery(sCmd); 
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create the query object, as shown in this code:</span><div><pre class="oac_no_warn" dir="ltr">OracleXMLQuery xmlQry = new OracleXMLQuery(conn, rs);
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Configure the query object. The following code specifies that the query object is open for the duration of the session. It also limits the number of rows returned to 20:</span><div><pre class="oac_no_warn" dir="ltr">xmlQry.keepObjectOpen(true); 
xmlQry.setRowsetTag("ROWSET"); 
xmlQry.setRowTag("ROW"); 
xmlQry.setMaxRows(20); 
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Retrieve the result as a <code class="codeph">String</code> and print:</span><div><pre class="oac_no_warn" dir="ltr">String sXML = xmlQry.getXMLString(); 
System.out.println(sXML);
</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>After compiling the program, run it from the command line:</p><pre class="oac_no_warn" dir="ltr">java paginateResults</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADXDK19427"></a><div class="props_rev_3"><a id="GUID-788FD888-45E4-4B7F-91CD-0151398196CF" name="GUID-788FD888-45E4-4B7F-91CD-0151398196CF"></a><h4 id="ADXDK-GUID-788FD888-45E4-4B7F-91CD-0151398196CF" class="sect4">Generating Scrollable Result Sets</h4>
                  <div>
                     <p>You might want to perform a query and then retrieve a previous page of results from within the result set. To enable scrolling, instantiate the <code class="codeph">Oracle.jdbc.ResultSet</code> class. You can use the <code class="codeph">ResultSet</code> object to move back and forth within the result set and use XSU to generate XML each time.
                     </p>
                     <div class="section">
                        <p>The <code class="codeph">pageTest.java</code> program shows how to use the JDBC <code class="codeph">ResultSet</code> to generate XML a page at a time. Using <code class="codeph">ResultSet</code> may be necessary in cases that are not handled directly by XSU, for example, when setting the batch size and binding values.
                        </p>
                        <p>The <code class="codeph">pageTest.java</code> program creates a <code class="codeph">pageTest</code> object and initializes it with a SQL query. The constructor for the <code class="codeph">pageTest</code> object performs these steps:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Create a JDBC connection by invoking the same <code class="codeph">getConnection()</code> method defined in <code class="codeph">paginateResults.java</code>:</span><div><pre class="oac_no_warn" dir="ltr">Connection conn;
...
conn  = getConnection("hr","<span class="italic">password</span>");
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create a statement:</span><div><pre class="oac_no_warn" dir="ltr">Statement stmt;
...
stmt = conn.createStatement();
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Execute the query passed to the constructor to get the scrollable result set. The following code shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">ResultSet rset = stmt.executeQuery(sqlQuery);
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create a query object by passing references to the connection and result set objects to the constructor. The following code fragment shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">OracleXMLQuery qry;
...
qry = new OracleXMLQuery(conn,rset); 
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Configure the query object. The following code fragment specifies that the query object be kept open, and that it raise an exception when there are no more rows:</span><div><pre class="oac_no_warn" dir="ltr">qry.keepObjectOpen(true);
qry.setRaiseNoRowsException(true);
qry.setRaiseException(true);
</pre></div>
                        </li>
                        <li class="stepexpand"><span>After creating the query object by passing it the string <code class="codeph">"SELECT * FROM employees"</code>, the program loops through the result set. The <code class="codeph">getResult()</code> method receives integer values specifying the start row and end row of the set. It sets the maximum number of rows to retrieve by calculating the difference of these values and then retrieves the result as a string. The following <code class="codeph">while</code> loop retrieves and prints ten rows at a time:</span><div><pre class="oac_no_warn" dir="ltr">int i = 0;
while ((str = test.getResult(i,i+10))!= null)
{
  System.out.println(str);
  i+= 10;
}
</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>After compiling the program, run it from the command line:</p><pre class="oac_no_warn" dir="ltr">java pageTest</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19428"></a><div class="props_rev_3"><a id="GUID-B77E1941-0B4C-4B73-8EBC-25357E3DA75C" name="GUID-B77E1941-0B4C-4B73-8EBC-25357E3DA75C"></a><h4 id="ADXDK-GUID-B77E1941-0B4C-4B73-8EBC-25357E3DA75C" class="sect4">Generating XML from Cursor Objects</h4>
                  <div>
                     <p> You can initialize a <code class="codeph">CallableStatement</code> object, execute a PL/SQL function that returns a cursor variable, get the <code class="codeph">OracleResultSet</code> object, and send it to an <code class="codeph">OracleXMLQuery</code> object to obtain the desired XML data.
                     </p>
                     <div class="section">
                        <p>Class <code class="codeph">OracleXMLQuery</code> provides XML conversion only for query strings or <code class="codeph">ResultSet</code> objects. If your program uses PL/SQL procedures that return <code class="codeph">REF</code> cursors, then how do you perform the conversion? You can use the <code class="codeph">ResultSet</code> conversion mechanism described in <a href="using-XML-SQL-utility.html#GUID-788FD888-45E4-4B7F-91CD-0151398196CF" title="You might want to perform a query and then retrieve a previous page of results from within the result set. To enable scrolling, instantiate the Oracle.jdbc.ResultSet class. You can use the ResultSet object to move back and forth within the result set and use XSU to generate XML each time.">Generating Scrollable Result Sets</a>.
                        </p>
                        <p><code class="codeph">REF</code> cursors are references to cursor objects in PL/SQL. These cursor objects are SQL statements over which a program can iterate to get a set of values. The cursor objects are converted into <code class="codeph">OracleResultSet</code> objects in the Java world. In your Java program you can initialize a <code class="codeph">CallableStatement</code> object, execute a PL/SQL function that returns a cursor variable, get the <code class="codeph">OracleResultSet</code> object, and then send it to the <code class="codeph">OracleXMLQuery</code> object to get the desired XML.
                        </p>
                        <p>Consider the <code class="codeph">testRef</code> PL/SQL package defined in the <code class="codeph">testRef.sql</code> script. It creates a function that defines a <code class="codeph">REF</code> cursor and returns it. Every time the <code class="codeph">testRefCur</code> PL/SQL function is called, it opens a cursor object for the <code class="codeph">SELECT</code> query and returns that cursor instance. To convert the object to XML, do this:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span>Run the <code class="codeph">testRef.sql</code> script to create the <code class="codeph">testRef</code> package in the <code class="codeph">hr</code> schema.</span></li>
                        <li><span>Compile and run the <code class="codeph">refCurTest.java</code> program to generate XML from the results of the SQL query defined in the <code class="codeph">testRefCur</code> function.</span></li>
                     </ol>
                     <div class="section">
                        <p>To apply the stylesheet, you can use the <code class="codeph">applyStylesheet</code><span class="italic"> </span>command, which forces the stylesheet to be applied before generating the output.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19429"></a><div class="props_rev_3"><a id="GUID-555483DC-5765-4E8B-B99A-96832941FB54" name="GUID-555483DC-5765-4E8B-B99A-96832941FB54"></a><h4 id="ADXDK-GUID-555483DC-5765-4E8B-B99A-96832941FB54" class="sect4">Inserting Rows with OracleXMLSave</h4>
                  <div>
                     <p>To insert a document into a table or view, supply the table or view name and the document. XSU parses the document and creates an <code class="codeph">INSERT</code> statement into which it binds the values. By default, XSU inserts values into all columns of the table or view. 
                     </p>
                     <div class="section">
                        <p>An absent element is treated as a <code class="codeph">NULL</code> value. The following example shows how you can store the XML document generated from the <code class="codeph">hr.employees</code> table in the table.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19430"></a><div class="props_rev_3"><a id="GUID-FBDEFAFC-567F-48C5-85F1-B33680A85CA0" name="GUID-FBDEFAFC-567F-48C5-85F1-B33680A85CA0"></a><h5 id="ADXDK-GUID-FBDEFAFC-567F-48C5-85F1-B33680A85CA0" class="sect5">Inserting XML into All Columns with OracleXMLSave</h5>
                     <div>
                        <p>The <code class="codeph">testInsert.java</code> demo program inserts XML values into all columns of the <code class="codeph">hr.employees</code> table.
                        </p>
                        <div class="section">
                           <p></p>
                           <p>The program follows these steps:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create a JDBC OCI connection. The program invokes the same <code class="codeph">getConnection()</code> method used by the previous examples in this chapter:</span><div><pre class="oac_no_warn" dir="ltr">Connection conn = getConnection("hr","<span class="italic">password</span>");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create an XML save object. You initialize the object by passing it the <code class="codeph">Connection</code> reference and the name of the table on which you want to perform DML. The following example shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">OracleXMLSave sav = new OracleXMLSave(conn, "employees");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Insert the data in an input XML document into the <code class="codeph">hr.employees</code> table. The following code fragment creates a URL from the document file name specified on the command line:</span><div><pre class="oac_no_warn" dir="ltr">sav.insertXML(sav.getURL(argv[0]));
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Close the XML save object:</span><div><pre class="oac_no_warn" dir="ltr">sav.close();</pre></div>
                           </li>
                        </ol>
                     </div><a id="ADXDK19431"></a><div class="props_rev_3"><a id="GUID-D005B919-A669-4BF9-A22A-2F75ECE3B82D" name="GUID-D005B919-A669-4BF9-A22A-2F75ECE3B82D"></a><h6 id="ADXDK-GUID-D005B919-A669-4BF9-A22A-2F75ECE3B82D" class="sect6">Running the testInsert Program</h6>
                        <div>
                           <p>The <code class="codeph">textInsert</code> program is described.
                           </p>
                           <div class="section">
                              <p>Assume that you write the <code class="codeph">new_emp.xml</code> document to describe new employee Janet Smith, who has employee ID 7369. You pass the file name <code class="codeph">new_emp.xml</code> as an argument to the <code class="codeph">testInsert</code> program:
                              </p><pre class="oac_no_warn" dir="ltr">java testInsert "new_emp.xml"
</pre><p>The program inserts a new row in the <code class="codeph">employees</code> table that contains the values for the columns specified. Any absent element inside the row element is treated as <code class="codeph">NULL</code>.
                              </p>
                              <p>Running the program generates an <code class="codeph">INSERT</code> statement of this form:
                              </p><pre class="oac_no_warn" dir="ltr">INSERT INTO hr.employees 
  (employee_id, first_name, last_name, email, phone_number, hire_date, 
   salary, commission_pct, manager_id, department_id)
VALUES
  (?, ?, ?, ?, ?, ?, ?, ?, ?, ?);     
</pre><p>XSU matches the element tags in the input XML document that match the column names and binds their values. </p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div><a id="ADXDK19432"></a><div class="props_rev_3"><a id="GUID-220FC06C-0D3F-427D-ACEC-B37753B43189" name="GUID-220FC06C-0D3F-427D-ACEC-B37753B43189"></a><h5 id="ADXDK-GUID-220FC06C-0D3F-427D-ACEC-B37753B43189" class="sect5">Inserting XML into a Subset of Columns with OracleXMLSave</h5>
                     <div>
                        <p>In some situations, you might not want to insert values into all columns. For example, the group of values that you get might not be the complete set, requiring you to use triggers or default values for the remaining columns. </p>
                        <div class="section">
                           <p>The <code class="codeph">testInsertSubset.java</code> demo program shows how to handle this case. It follows these steps:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create a JDBC OCI connection. The program invokes the same <code class="codeph">getConnection()</code> method used by the previous examples in this chapter:</span><div><pre class="oac_no_warn" dir="ltr">Connection conn = getConnection("hr","<span class="italic">password</span>");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create an XML save object. Initialize the object by passing it the <code class="codeph">Connection</code> reference and the name of the table on which you want to perform DML. The following example shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">OracleXMLSave sav = new OracleXMLSave(conn, "employees");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create an array of strings. Each element of the array must contain the name of a column in which values are inserted. The following code fragment specifies the names of five columns:</span><div><pre class="oac_no_warn" dir="ltr">String [] colNames = new String[5];
colNames[0] = "EMPLOYEE_ID";
colNames[1] = "LAST_NAME";
colNames[2] = "EMAIL";
colNames[3] = "JOB_ID";
colNames[4] = "HIRE_DATE";
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Configure the XML save object to update the specified columns. The following statement passes a reference to the array to the <code class="codeph">OracleXMLSave.setUpdateColumnList()</code> method:</span><div><pre class="oac_no_warn" dir="ltr">sav.setUpdateColumnList(colNames);
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Insert the data in an input XML document into the <code class="codeph">hr.employees</code> table. The following code fragment creates a URL from the document file name specified on the command line:</span><div><pre class="oac_no_warn" dir="ltr">sav.insertXML(sav.getURL(argv[0]));
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Close the XML save object:</span><div><pre class="oac_no_warn" dir="ltr">sav.close();</pre></div>
                           </li>
                        </ol>
                     </div><a id="ADXDK19433"></a><div class="props_rev_3"><a id="GUID-ACDEFAC1-46BE-4363-90C4-027897AD1AD9" name="GUID-ACDEFAC1-46BE-4363-90C4-027897AD1AD9"></a><h6 id="ADXDK-GUID-ACDEFAC1-46BE-4363-90C4-027897AD1AD9" class="sect6">Running the testInsertSubset Program</h6>
                        <div>
                           <p>The <code class="codeph">testInsertSubset</code> program is described.
                           </p>
                           <div class="section">
                              <p>Assume that you use the <code class="codeph">new_emp2.xml</code> document to store data for new employee Adams, who has employee ID 7400. You pass <code class="codeph">new_emp2.xml</code> as an argument to the <code class="codeph">testInsert</code> program:
                              </p><pre class="oac_no_warn" dir="ltr">java testInsert new_emp2.xml
</pre><p>The program ignores values for the columns that were not specified in the input file. It performs an <code class="codeph">INSERT</code> for each <code class="codeph">ROW</code> element in the input and batches the <code class="codeph">INSERT</code> statements by default.
                              </p>
                              <p>The program generates this <code class="codeph">INSERT</code> statement:
                              </p><pre class="oac_no_warn" dir="ltr">INSERT INTO hr.employees (employee_id, last_name, email, job_id, hire_date) 
  VALUES (?, ?, ?, ?, ?);</pre></div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div>
               </div><a id="ADXDK19434"></a><div class="props_rev_3"><a id="GUID-646799B4-73D6-4AD1-94F1-E614343D65F6" name="GUID-646799B4-73D6-4AD1-94F1-E614343D65F6"></a><h4 id="ADXDK-GUID-646799B4-73D6-4AD1-94F1-E614343D65F6" class="sect4">Updating Rows Using OracleXMLSave</h4>
                  <div>
                     <p>Examples show how to update the fields in a table or view. You supply the table or view name and an XML document. XSU parses the document (if a string is given) and creates one or more <code class="codeph">UPDATE</code> statements into which it binds all of the values.
                     </p>
                     <div class="section">
                        <p>The following examples use an XML document to update table <code class="codeph">hr.employees</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19435"></a><div class="props_rev_3"><a id="GUID-06AF6382-FDFC-4FC1-A65B-C0C66F658175" name="GUID-06AF6382-FDFC-4FC1-A65B-C0C66F658175"></a><h5 id="ADXDK-GUID-06AF6382-FDFC-4FC1-A65B-C0C66F658175" class="sect5">Updating Key Columns Using OracleXMLSave</h5>
                     <div>
                        <p>Demo program <code class="codeph">testUpdate.java</code> invokes method <code class="codeph">OracleXMLSave.setKeyColumnList()</code> to update table <code class="codeph">hr.employees</code>.
                        </p>
                        <div class="section">
                           <p><code class="codeph">testUpdate.java</code> follows these steps:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create a JDBC OCI connection. The program invokes the same <code class="codeph">getConnection()</code> method used by the previous examples in this chapter:</span><div><pre class="oac_no_warn" dir="ltr">Connection conn = getConnection("hr","<span class="italic">password</span>");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create an XML save object. You initialize the object by passing it the <code class="codeph">Connection</code> reference and the name of the table on which you want to perform DML. The following example shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">OracleXMLSave sav = new OracleXMLSave(conn, "employees");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create a single-element <code class="codeph">String</code> array to hold the name of the primary key column in the table to be updated. The following code fragment specifies the name of the <code class="codeph">employee_id</code> column:</span><div><pre class="oac_no_warn" dir="ltr">String [] keyColNames = new String[1];
colNames[0] = "EMPLOYEE_ID";
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Set the XML save object to the primary key specified in the array. The following statement passes a reference to the <code class="codeph">keyColNames</code> array to the <code class="codeph">OracleXMLSave.setKeyColumnList()</code> method:</span><div><pre class="oac_no_warn" dir="ltr">sav.setKeyColumnList(keyColNames);
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Update the rows specified in the input XML document. The following statement creates a URL from the file name specified on the command line:</span><div><pre class="oac_no_warn" dir="ltr">sav.updateXML(sav.getURL(argv[0]));
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Close the XML save object:</span><div><pre class="oac_no_warn" dir="ltr">sav.close();</pre></div>
                           </li>
                        </ol>
                     </div><a id="ADXDK19437"></a><a id="ADXDK19436"></a><div class="props_rev_3"><a id="GUID-E1F2B493-A35D-4069-AE61-310538FA2FF0" name="GUID-E1F2B493-A35D-4069-AE61-310538FA2FF0"></a><h6 id="ADXDK-GUID-E1F2B493-A35D-4069-AE61-310538FA2FF0" class="sect6">Running the testUpdate Program</h6>
                        <div>
                           <p>The <code class="codeph">testUpdate</code> program is described.
                           </p>
                           <div class="section">
                              <p>You can use XSU to update specified fields in a table. <a href="using-XML-SQL-utility.html#GUID-E1F2B493-A35D-4069-AE61-310538FA2FF0__BABJCJDJ">Example 21-2</a> shows <code class="codeph">upd_emp.xml</code>, which contains updated salary and other information for the two employees that you just added, 7369 and 7400.
                              </p>
                              <p>For updates, supply XSU with the list of key column names in the <code class="codeph">WHERE</code> clause of the <code class="codeph">UPDATE</code> statement. In the <code class="codeph">hr.employees</code> table the <code class="codeph">employee_id</code> column is the key.
                              </p>
                              <p>Pass the file name <code class="codeph">upd_emp.xml</code> as an argument to the preceding program:
                              </p><pre class="oac_no_warn" dir="ltr">java testUpdate upd_emp.xml
</pre><p>The program generates two <code class="codeph">UPDATE</code> statements. For the first <code class="codeph">ROW</code> element, the program generates an <code class="codeph">UPDATE</code> statement to update the <code class="codeph">SALARY</code> field:
                              </p><pre class="oac_no_warn" dir="ltr">UPDATE hr.employees SET salary = 3250 WHERE employee_id = 7400;</pre><p>For the second <code class="codeph">ROW</code> element the program generates this statement:
                              </p><pre class="oac_no_warn" dir="ltr">UPDATE hr.employees SET job_id = 'SA_REP' AND MANAGER_ID = 145 
  WHERE employee_id = 7369;</pre></div>
                           <!-- class="section" -->
                           <div class="example" id="GUID-E1F2B493-A35D-4069-AE61-310538FA2FF0__BABJCJDJ">
                              <p class="titleinexample">Example 21-2 upd_emp.xml</p><pre class="oac_no_warn" dir="ltr">&lt;?xml version='1.0'?&gt;
&lt;ROWSET&gt;
 &lt;ROW num="1"&gt;
    &lt;EMPLOYEE_ID&gt;7400&lt;/EMPLOYEE_ID&gt;
    &lt;SALARY&gt;3250&lt;/SALARY&gt;
 &lt;/ROW&gt;
 &lt;ROW num="2"&gt;
    &lt;EMPLOYEE_ID&gt;7369&lt;/EMPLOYEE_ID&gt;
    &lt;JOB_ID&gt;SA_REP&lt;/JOB_ID&gt;
    &lt;MANAGER_ID&gt;145&lt;/MANAGER_ID&gt;
 &lt;/ROW&gt;
&lt;!-- additional rows ... --&gt;
&lt;/ROWSET&gt;
</pre></div>
                           <!-- class="example" -->
                        </div>
                     </div>
                  </div><a id="ADXDK19438"></a><div class="props_rev_3"><a id="GUID-BF4F12F6-1EC7-4B6D-BEEC-A9D9D5816D8B" name="GUID-BF4F12F6-1EC7-4B6D-BEEC-A9D9D5816D8B"></a><h5 id="ADXDK-GUID-BF4F12F6-1EC7-4B6D-BEEC-A9D9D5816D8B" class="sect5">Updating a Column List Using OracleXMLSave</h5>
                     <div>
                        <p></p>
                        <div class="section">
                           <p>You can update a table using only a subset of the elements in an XML document, by specifying a list of columns. This is fast because XSU uses the same <code class="codeph">UPDATE</code> statement, with bind variables for all of the <code class="codeph">ROW</code> elements. Other tags in the document can be ignored.
                           </p>
                           <div class="infoboxnote" id="GUID-BF4F12F6-1EC7-4B6D-BEEC-A9D9D5816D8B__GUID-5E0033C1-2F3C-4CAA-BBBE-A9E65CDB0A5B">
                              <p class="notep1">Note:</p>
                              <p>When you specify a list of columns to update, if an element corresponding to an update column is absent, XSU treats it as <code class="codeph">NULL</code>.
                              </p>
                           </div>
                           <p>Suppose you want to update the salary and job title for each employee and ignore the other data. If you know that all the elements to be updated are the same for all <code class="codeph">ROW</code> elements in the XML document, then you can use the <code class="codeph">OracleXMLSave.setUpdateColumnNames()</code> method to specify the columns. The <code class="codeph">testUpdateList.java</code> program shows this technique.
                           </p>
                           <p>The <code class="codeph">testUpdateList.java</code> program follows these steps:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create a JDBC OCI connection. The program invokes the same <code class="codeph">getConnection()</code> method used by the previous examples in this chapter:</span><div><pre class="oac_no_warn" dir="ltr">Connection conn = getConnection("hr","<span class="italic">password</span>");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create an XML save object. You initialize the object by passing it the <code class="codeph">Connection</code> reference and the name of the table on which you want to perform DML. The following example shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">OracleXMLSave sav = new OracleXMLSave(conn, "employees");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create an array of type <code class="codeph">String</code> to hold the name of the primary key column in the table to be updated. The array contains only one element, which is the name of the primary key column in the table to be updated. The following code fragment specifies the name of the <code class="codeph">employee_id</code> column:</span><div><pre class="oac_no_warn" dir="ltr">String [] colNames = new String[1];
colNames[0] = "EMPLOYEE_ID";
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Set the XML save object to the primary key specified in the array. The following statement passes a reference to the <code class="codeph">colNames</code> array to the <code class="codeph">OracleXMLSave.setKeyColumnList()</code> method:</span><div><pre class="oac_no_warn" dir="ltr">sav.setKeyColumnList(keyColNames);
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create an array of type <code class="codeph">String</code> to hold the name of the columns to be updated. The following code fragment specifies the name of the <code class="codeph">employee_id</code> column:</span><div><pre class="oac_no_warn" dir="ltr">String[] updateColNames = new String[2];
updateColNames[0] = "SALARY";
updateColNames[1] = "JOB_ID";
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Set the XML save object to the list of columns to be updated. The following statement performs this task:</span><div><pre class="oac_no_warn" dir="ltr">sav.setUpdateColumnList(updateColNames);
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Update the rows specified in the input XML document. The following code fragment creates a URL from the file name specified on the command line:</span><div><pre class="oac_no_warn" dir="ltr">sav.updateXML(sav.getURL(argv[0]));
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Close the XML save object:</span><div><pre class="oac_no_warn" dir="ltr">sav.close();</pre></div>
                           </li>
                        </ol>
                     </div><a id="ADXDK19439"></a><div class="props_rev_3"><a id="GUID-F631E856-2DF4-4926-90AA-BFF97840F90F" name="GUID-F631E856-2DF4-4926-90AA-BFF97840F90F"></a><h6 id="ADXDK-GUID-F631E856-2DF4-4926-90AA-BFF97840F90F" class="sect6">Running the testUpdateList Program</h6>
                        <div>
                           <p>The <code class="codeph">testUpdateList</code> program is described.
                           </p>
                           <div class="section">
                              <p>Suppose that you use the sample XML document <code class="codeph">upd_emp2.xml</code> to store new data for employees Steven King, who has an employee ID of 100, and William Gietz, who has an employee identifier (ID) of 206. You pass <code class="codeph">upd_emp2.xml</code> as an argument to the <code class="codeph">testUpdateList</code> program:
                              </p><pre class="oac_no_warn" dir="ltr">java testUpdateList upd_emp2.xml
</pre><p>In this example, the program generates two <code class="codeph">UPDATE</code> statements. For the first <code class="codeph">ROW</code> element, the program generates this statement:
                              </p><pre class="oac_no_warn" dir="ltr">UPDATE hr.employees SET salary = 8350 AND job_id = 'AC_ACCOUNT' 
  WHERE employee_id = 100;</pre><p>For the second <code class="codeph">ROW</code> element the program generates this statement:
                              </p><pre class="oac_no_warn" dir="ltr">UPDATE hr.employees SET salary = 25000 AND job_id = 'AD_PRES' 
  WHERE employee_id = 206;</pre></div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div>
               </div><a id="ADXDK19440"></a><div class="props_rev_3"><a id="GUID-2E4CC584-0613-4BC2-9C9B-252AE6A91A84" name="GUID-2E4CC584-0613-4BC2-9C9B-252AE6A91A84"></a><h4 id="ADXDK-GUID-2E4CC584-0613-4BC2-9C9B-252AE6A91A84" class="sect4">Deleting Rows using XSU</h4>
                  <div>
                     <p>When deleting from XML documents, you can specify a list of key columns. XSU uses these columns in the <code class="codeph">WHERE</code> clause of the <code class="codeph">DELETE</code> statement. If you do not supply the key column names, then XSU creates a new <code class="codeph">DELETE</code> statement for each <code class="codeph">ROW</code> element of the XML document. 
                     </p>
                     <div class="section">
                        <p>The list of columns in the <code class="codeph">WHERE</code> clause of the <code class="codeph">DELETE</code> statement matches those in the <code class="codeph">ROW</code> element.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19441"></a><div class="props_rev_3"><a id="GUID-FD22DD32-C1F3-475E-8F5C-A735E2DC6FFE" name="GUID-FD22DD32-C1F3-475E-8F5C-A735E2DC6FFE"></a><h5 id="ADXDK-GUID-FD22DD32-C1F3-475E-8F5C-A735E2DC6FFE" class="sect5">Deleting by Row with OracleXMLSave</h5>
                     <div>
                        <p>The <code class="codeph">testDeleteRow.java</code> demo program accepts an XML document file name as input and deletes the rows corresponding to the elements in the document.
                        </p>
                        <div class="section">
                           <p>The <code class="codeph">testDeleteRow.java</code> program follows these steps:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create a JDBC OCI connection. The program invokes the same <code class="codeph">getConnection()</code> method used by the previous examples in this chapter:</span><div><pre class="oac_no_warn" dir="ltr">Connection conn = getConnection("hr","<span class="italic">password</span>");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create an XML save object. You initialize the object by passing it the <code class="codeph">Connection</code> reference and the name of the table on which you want to perform DML. The following example shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">OracleXMLSave sav = new OracleXMLSave(conn, "employees");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Delete the rows specified in the input XML document. The following code fragment creates a URL from the file name specified on the command line:</span><div><pre class="oac_no_warn" dir="ltr">sav.deleteXML(sav.getURL(argv[0]));
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Close the XML save object:</span><div><pre class="oac_no_warn" dir="ltr">sav.close();</pre></div>
                           </li>
                        </ol>
                     </div><a id="ADXDK19442"></a><div class="props_rev_3"><a id="GUID-C40831D5-A4B1-47EF-90E4-7C5859D9DBFC" name="GUID-C40831D5-A4B1-47EF-90E4-7C5859D9DBFC"></a><h6 id="ADXDK-GUID-C40831D5-A4B1-47EF-90E4-7C5859D9DBFC" class="sect6">Running the testDelete Program</h6>
                        <div>
                           <p>The <code class="codeph">testDelete</code> program is described.
                           </p>
                           <div class="section">
                              <p>This section shows how to delete the employees 7400 and 7369 that you added in <a href="using-XML-SQL-utility.html#GUID-555483DC-5765-4E8B-B99A-96832941FB54" title="To insert a document into a table or view, supply the table or view name and the document. XSU parses the document and creates an INSERT statement into which it binds the values. By default, XSU inserts values into all columns of the table or view.">Inserting Rows with OracleXMLSave</a>.
                              </p>
                              <p>To make this example work correctly, connect to the database and disable a constraint on the <code class="codeph">hr.job_history</code> table:
                              </p><pre class="oac_no_warn" dir="ltr">CONNECT hr
ALTER TABLE job_history
  DISABLE CONSTRAINT JHIST_EMP_FK;
EXIT
</pre><p>Now pass <code class="codeph">upd_emp.xml</code> to the <code class="codeph">testDeleteRow</code> program:
                              </p><pre class="oac_no_warn" dir="ltr">java testDeleteRow upd_emp.xml
</pre><p>The program forms the <code class="codeph">DELETE</code> statements based on the tag names present in each <code class="codeph">ROW</code> element in the XML document. It executes these statements:
                              </p><pre class="oac_no_warn" dir="ltr">DELETE FROM hr.employees WHERE salary = 3250 AND employee_id = 7400;
DELETE FROM hr.employees WHERE job_id = 'SA_REP' AND MANAGER_ID = 145 
  AND employee_id = 7369;</pre></div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div><a id="ADXDK19443"></a><div class="props_rev_3"><a id="GUID-2D3D2A64-0291-4D19-9783-4BD518C8E95D" name="GUID-2D3D2A64-0291-4D19-9783-4BD518C8E95D"></a><h5 id="ADXDK-GUID-2D3D2A64-0291-4D19-9783-4BD518C8E95D" class="sect5">Deleting by Key with OracleXMLSave</h5>
                     <div>
                        <p>To use only the key values as predicates on the <code class="codeph">DELETE</code> statement, invoke the <code class="codeph">OracleXMLSave.setKeyColumnList()</code> method. This approach limits the number of elements used to identify a row, which has the benefit of improving performance by caching the <code class="codeph">DELETE</code> statement and batching transactions. The <code class="codeph">testDeleteKey.java</code> program shows this technique.
                        </p>
                        <div class="section">
                           <p>The <code class="codeph">testDeleteKey.java</code> program follows these steps:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create a JDBC OCI connection. The program invokes the same <code class="codeph">getConnection()</code> method used by the previous examples in this chapter:</span><div><pre class="oac_no_warn" dir="ltr">Connection conn = getConnection("hr","<span class="italic">password</span>");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create an XML save object. You initialize the object by passing it the <code class="codeph">Connection</code> reference and the name of the table on which you want to perform DML. The following example shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">OracleXMLSave sav = new OracleXMLSave(conn, "employees");
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create an array of type <code class="codeph">String</code> to hold the name of the primary key column in the table. The array contains only one element. The following code fragment specifies the name of the <code class="codeph">employee_id</code> column:</span><div><pre class="oac_no_warn" dir="ltr">String [] colNames = new String[1];
colNames[0] = "EMPLOYEE_ID";
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Set the XML save object to the primary key specified in the array. The following statement passes a reference to the <code class="codeph">colNames</code> array to the <code class="codeph">OracleXMLSave.setKeyColumnList()</code> method:</span><div><pre class="oac_no_warn" dir="ltr">sav.setKeyColumnList(keyColNames);
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Delete the rows specified in the input XML document. The following code fragment creates a URL from the file name specified on the command line:</span><div><pre class="oac_no_warn" dir="ltr">sav.deleteXML(sav.getURL(argv[0]));
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Close the XML save object:</span><div><pre class="oac_no_warn" dir="ltr">sav.close();</pre></div>
                           </li>
                        </ol>
                     </div><a id="ADXDK19444"></a><div class="props_rev_3"><a id="GUID-079034DA-8188-4CA1-99DB-519BC2269DCD" name="GUID-079034DA-8188-4CA1-99DB-519BC2269DCD"></a><h6 id="ADXDK-GUID-079034DA-8188-4CA1-99DB-519BC2269DCD" class="sect6">Running the testDeleteKey Program</h6>
                        <div>
                           <p>The <code class="codeph">testDeleteKey</code> program is described.
                           </p>
                           <div class="section">
                              <p>This section shows how to delete employees 7400 and 7369 that you added in <a href="using-XML-SQL-utility.html#GUID-06AF6382-FDFC-4FC1-A65B-C0C66F658175" title="Demo program testUpdate.java invokes method OracleXMLSave.setKeyColumnList() to update table hr.employees.">Updating Key Columns Using OracleXMLSave</a>. If you deleted these employees in the previous example, you can add them back to the <code class="codeph">employees</code> table:
                              </p><pre class="oac_no_warn" dir="ltr">java testInsert new_emp.xml
java testInsert new_emp2.xml
</pre><p>Delete employees 7400 and 7369 by passing the same <code class="codeph">upd_emp.xml</code> document to the <code class="codeph">testDeleteRow</code> program:
                              </p><pre class="oac_no_warn" dir="ltr">java testDeleteKey upd_emp.xml
</pre><p>The program forms this single generated <code class="codeph">DELETE</code> statement:
                              </p><pre class="oac_no_warn" dir="ltr">DELETE FROM hr.employees WHERE employee_id=?;
</pre><p>The program executes these <code class="codeph">DELETE</code> statements, one for each employee:
                              </p><pre class="oac_no_warn" dir="ltr">DELETE FROM hr.employees WHERE employee_id = 7400;
DELETE FROM hr.employees WHERE employee_id = 7369;</pre></div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div>
               </div><a id="ADXDK19445"></a><div class="props_rev_3"><a id="GUID-6A0346A5-E903-4819-A4CA-BCC00EBA732A" name="GUID-6A0346A5-E903-4819-A4CA-BCC00EBA732A"></a><h4 id="ADXDK-GUID-6A0346A5-E903-4819-A4CA-BCC00EBA732A" class="sect4">Handling XSU Java Exceptions</h4>
                  <div>
                     <p>XSU catches all exceptions that occur during processing and throws <code class="codeph">oracle.xml.sql.OracleXMLSQLException</code>, which is a generic runtime exception. The invoking program need not catch this exception if it can still perform the appropriate action. The exception class provides methods to get error messages and any parent exceptions.
                     </p>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19446"></a><div class="props_rev_3"><a id="GUID-3184503E-9C0D-4DFF-984E-5D1C6512AA42" name="GUID-3184503E-9C0D-4DFF-984E-5D1C6512AA42"></a><h5 id="ADXDK-GUID-3184503E-9C0D-4DFF-984E-5D1C6512AA42" class="sect5">Getting the Parent Exception</h5>
                     <div>
                        <p>The <code class="codeph">testException.java</code> demo program throws a runtime exception and then gets the parent exception by invoking <code class="codeph">Exception.getParentException()</code>.
                        </p>
                        <p>Running the program generates this error message:</p><pre class="oac_no_warn" dir="ltr">Caught SQL Exception:ORA-00904: "SD": invalid identifier</pre></div>
                  </div><a id="ADXDK19447"></a><div class="props_rev_3"><a id="GUID-4F096761-00BB-4A94-9368-F91C7ACA9D2C" name="GUID-4F096761-00BB-4A94-9368-F91C7ACA9D2C"></a><h5 id="ADXDK-GUID-4F096761-00BB-4A94-9368-F91C7ACA9D2C" class="sect5">Raising a No Rows Exception</h5>
                     <div>
                        <p>When there are no rows to process, XSU returns a <code class="codeph">null</code> string. You can throw an exception each time there are no more rows, however, so that a program can process this exception using exception handlers. 
                        </p>
                        <div class="section">
                           <p>When a program invokes <code class="codeph">OracleXMLQuery.setRaiseNoRowsException()</code>, XSU raises an <code class="codeph">oracle.xml.sql.OracleXMLSQLNoRowsException</code> whenever there are no rows to generate for the output. This is a runtime exception and need not be caught.
                           </p>
                           <p>The <code class="codeph">noRowsTest.java</code> demo program instantiates the <code class="codeph">pageTest</code> class defined in <code class="codeph">pageTest.java</code>. The condition to check the termination changed from checking whether the result is <code class="codeph">null</code> to an exception handler.
                           </p>
                           <p>The <code class="codeph">noRowsTest.java</code> program creates a <code class="codeph">pageTest</code> object and initializes it with a SQL query. The program proceeds as follows:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Configure the query object or raise a no rows exception. The following code fragment shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">pageTest test = new pageTest("SELECT * from employees");
...
test.qry.setRaiseNoRowsException(true);
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Loop through the result set infinitely, retrieving ten rows at a time. When no rows are available, the program throws an exception. The following code fragment invokes <code class="codeph">pageTest.nextPage()</code>, which scrolls through the result set ten rows at a time:</span><div><pre class="oac_no_warn" dir="ltr">try
{
  while(true)
    System.out.println(test.nextPage());
}
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Catch the no rows exception and print "END OF OUTPUT". The following code shows this technique:</span><div><pre class="oac_no_warn" dir="ltr">catch(oracle.xml.sql.OracleXMLSQLNoRowsException e)
{
  System.out.println(" END OF OUTPUT "); 
  try
  {
    test.close();
  }
  catch ( Exception ae )
  {
    ae.printStackTrace(System.out);
  }
}
</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>After compiling the program, run it from the command line:</p><pre class="oac_no_warn" dir="ltr">java noRowsTest</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="ADXDK1013"></a><a id="ADXDK19475"></a><div class="sect2"><a id="GUID-33F51125-6078-4BC0-83BA-A529E2C47724" name="GUID-33F51125-6078-4BC0-83BA-A529E2C47724"></a><h3 id="ADXDK-GUID-33F51125-6078-4BC0-83BA-A529E2C47724" class="sect3">Tips and Techniques for Programming with XSU</h3>
               <div>
                  <p>This section provides tips and techniques for writing programs with XSU.</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK1014"></a><a id="ADXDK19476"></a><div class="props_rev_3"><a id="GUID-84D83A32-328E-440D-A7F1-244803CAE38E" name="GUID-84D83A32-328E-440D-A7F1-244803CAE38E"></a><h4 id="ADXDK-GUID-84D83A32-328E-440D-A7F1-244803CAE38E" class="sect4">How XSU Maps Between SQL and XML</h4>
                  <div>
                     <p>The mapping between SQL and XML is described.</p>
                     <p>The fundamental component of a table is a column, whereas the fundamental components of an XML document are elements and attributes. How do tables map to XML documents? For example, if the <code class="codeph">hr.employees</code> table has a column called <code class="codeph">last_name</code>, how is this structure represented in XML: as an <code class="codeph">&lt;EMPLOYEES&gt;</code> element with a <code class="codeph">last_name</code> attribute or as a <code class="codeph">&lt;LAST_NAME&gt;</code> element within a different root element? This section answers such questions by describing how SQL maps to XML and the reverse.
                     </p>
                     <div class="section"> </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19477"></a><div class="props_rev_3"><a id="GUID-15AC5AA9-6628-44A3-BF97-B0C0EBD81976" name="GUID-15AC5AA9-6628-44A3-BF97-B0C0EBD81976"></a><h5 id="ADXDK-GUID-15AC5AA9-6628-44A3-BF97-B0C0EBD81976" class="sect5">Default SQL-to-XML Mapping</h5>
                     <div>
                        <p>The default mapping of SQL data to XML data is described.</p>
                        <p>To display data from some column of the <code class="codeph">hr.employees</code> table as an XML document, run XSU at the command line:
                        </p><pre class="oac_no_warn" dir="ltr">java OracleXML getXML -user "hr/<span class="italic">password</span>" -withschema \
  "SELECT employee_id, last_name, hire_date FROM employees"
</pre><p>XSU outputs an XML document based on the input query. The root element of the document is <code class="codeph">&lt;DOCUMENT&gt;</code>. The following shows sample output, with extraneous lines replaced by comments:
                        </p><pre class="oac_no_warn" dir="ltr">&lt;?xml version = '1.0'?&gt;
&lt;DOCUMENT xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;
   &lt;xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;
   &lt;!-- children of schema element ... --&gt;
   &lt;/xsd:schema&gt;
   &lt;ROWSET xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 &nbsp;&nbsp;&nbsp;&nbsp;xsi:noNamespaceSchemaLocation="#/DOCUMENT/xsd:schema[not(@targetNamespace)]"&gt;
      &lt;ROW num="1"&gt;
         &lt;EMPLOYEE_ID&gt;100&lt;/EMPLOYEE_ID&gt;
         &lt;LAST_NAME&gt;King&lt;/LAST_NAME&gt;
         &lt;HIRE_DATE&gt;6/17/1987 0:0:0&lt;/HIRE_DATE&gt;
      &lt;/ROW&gt;
      &lt;!-- additional rows ... --&gt;
   &lt;/ROWSET&gt;
&lt;/DOCUMENT&gt;
</pre><p>In the generated XML, the rows returned by the SQL query are children of the <code class="codeph">&lt;ROWSET&gt;</code> element. The XML document has these features:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The <code class="codeph">&lt;ROWSET&gt;</code> element has zero or more <code class="codeph">&lt;ROW&gt;</code> child elements corresponding to the number of rows returned. If the query generates no rows, then no <code class="codeph">&lt;ROW&gt;</code> elements are included; if the query generates one row, then one <code class="codeph">&lt;ROW&gt;</code> element is included, and so forth.
                              </p>
                           </li>
                           <li>
                              <p>Each <code class="codeph">&lt;ROW&gt;</code> element contains data from one table row. Specifically, each <code class="codeph">&lt;ROW&gt;</code> element has one or more child elements whose names and content are identical to the database columns specified in the <code class="codeph">SELECT</code> statement.
                              </p>
                           </li>
                        </ul>
                     </div><a id="ADXDK19479"></a><a id="ADXDK19478"></a><div class="props_rev_3"><a id="GUID-A0899DAA-0B1D-482C-99E6-E995F2B535C8" name="GUID-A0899DAA-0B1D-482C-99E6-E995F2B535C8"></a><h6 id="ADXDK-GUID-A0899DAA-0B1D-482C-99E6-E995F2B535C8" class="sect6">XML Mapping Against an Object-Relational Schema</h6>
                        <div>
                           <p>XSU can generate an XML document from an object-relational schema.</p>
                           <p>Run the <code class="codeph">createObjRelSchema.sql</code> script in SQL*Plus to set up and populate an object-relational schema. The schema contains a <code class="codeph">dept1</code> table with two columns that employ user-defined types.
                           </p>
                           <p>You can query the <code class="codeph">dept1</code> table by invoking XSU from the command line:
                           </p><pre class="oac_no_warn" dir="ltr">% java OracleXML getXML -user "hr/<span class="italic">password</span>" -withschema "SELECT * FROM dept1"
</pre><p>XSU returns the XML document shown in <a href="using-XML-SQL-utility.html#GUID-A0899DAA-0B1D-482C-99E6-E995F2B535C8__BABBHAFE">Example 21-3</a>, which is altered so that extraneous lines are replaced by comments.
                           </p>
                           <p>As in the previous example, the mapping is canonical, that is, <code class="codeph">&lt;ROWSET&gt;</code> contains <code class="codeph">&lt;ROW&gt;</code> child elements, which in turn contain child elements corresponding to the columns in <code class="codeph">dept1</code>. For example, the <code class="codeph">&lt;DEPTNAME&gt;</code> element corresponds to the <code class="codeph">dept1.deptname</code> column. The elements corresponding to scalar type columns contain the data from the columns.
                           </p>
                           <div class="example" id="GUID-A0899DAA-0B1D-482C-99E6-E995F2B535C8__BABBHAFE">
                              <p class="titleinexample">Example 21-3 XSU-Generated Sample Document</p><pre class="oac_no_warn" dir="ltr">&lt;?xml version='1.0'?&gt;
&lt;DOCUMENT xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;
   &lt;schema targetNamespace="http://xmlns.oracle.com/xdb/SYSTEM"      
           xmlns="http://www.w3.org/2001/XMLSchema"
           xmlns:SYSTEM="http://xmlns.oracle.com/xdb/SYSTEM"&gt;
   &lt;!-- children of schema element ... --&gt;
   &lt;/xsd:schema&gt;
   &lt;ROWSET xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:noNamespaceSchemaLocation="#/DOCUMENT/xsd:schema[not(@targetNamespace)]"&gt;
      &lt;ROW num="1"&gt;
         &lt;DEPTNO&gt;120&lt;/DEPTNO&gt;
         &lt;DEPTNAME&gt;Treasury&lt;/DEPTNAME&gt;
         &lt;DEPTADDR&gt;
            &lt;STREET&gt;2004 Charade Rd&lt;/STREET&gt;
            &lt;CITY&gt;Seattle&lt;/CITY&gt;
            &lt;STATE&gt;WA&lt;/STATE&gt;
            &lt;ZIP&gt;98199&lt;/ZIP&gt;
         &lt;/DEPTADDR&gt;
         &lt;EMPLIST&gt;
            &lt;EMPLIST_ITEM&gt;
               &lt;EMPLOYEE_ID&gt;1&lt;/EMPLOYEE_ID&gt;
               &lt;LAST_NAME&gt;Mehta&lt;/LAST_NAME&gt;
               &lt;SALARY&gt;6000&lt;/SALARY&gt;
               &lt;EMPLOYEE_ADDRESS&gt;
                  &lt;STREET&gt;500 Main Road&lt;/STREET&gt;
                  &lt;CITY&gt;Seattle&lt;/CITY&gt;
                  &lt;STATE&gt;WA&lt;/STATE&gt;
                  &lt;ZIP&gt;98199&lt;/ZIP&gt;
               &lt;/EMPLOYEE_ADDRESS&gt;
            &lt;/EMPLIST_ITEM&gt;
         &lt;/EMPLIST&gt;
      &lt;/ROW&gt;
   &lt;/ROWSET&gt;
&lt;/DOCUMENT&gt;
 </pre></div>
                           <!-- class="example" -->
                        </div>
                     </div><a id="ADXDK19480"></a><div class="props_rev_3"><a id="GUID-99C85F15-FAEA-4A8D-954B-0F0283819DF4" name="GUID-99C85F15-FAEA-4A8D-954B-0F0283819DF4"></a><h6 id="ADXDK-GUID-99C85F15-FAEA-4A8D-954B-0F0283819DF4" class="sect6">Default Mapping of Complex Type Columns to XML</h6>
                        <div>
                           <p>The default mapping of complex-type columns to XML data is described.</p>
                           <p>The situation is more complex with elements corresponding to a complex-type column. In <a href="using-XML-SQL-utility.html#GUID-A0899DAA-0B1D-482C-99E6-E995F2B535C8__BABBHAFE">Example 21-3</a>, <code class="codeph">&lt;DEPTADDR&gt;</code> corresponds to the <code class="codeph">dept1.deptAddr</code> column, which is of object type <code class="codeph">AddressType</code>. Consequently, <code class="codeph">&lt;DEPTADDR&gt;</code> contains child elements corresponding to the attributes specified in the type <code class="codeph">AddressType</code>. The <code class="codeph">AddressType</code> attribute <code class="codeph">street</code> corresponds to the child XML element <code class="codeph">&lt;STREET&gt;</code> and so forth. These subelements can contain data or subelements of their own, depending on whether the attribute they correspond to is of a simple or complex type.
                           </p>
                        </div>
                     </div><a id="ADXDK19481"></a><div class="props_rev_3"><a id="GUID-0ECE1E50-CF88-4E63-87E4-C2C6CA856178" name="GUID-0ECE1E50-CF88-4E63-87E4-C2C6CA856178"></a><h6 id="ADXDK-GUID-0ECE1E50-CF88-4E63-87E4-C2C6CA856178" class="sect6">Default Mapping of Collections to XML</h6>
                        <div>
                           <p>The default mapping of database collections to XML data is described.</p>
                           <p>When dealing with elements corresponding to database collections, the situation is also different. In <a href="using-XML-SQL-utility.html#GUID-A0899DAA-0B1D-482C-99E6-E995F2B535C8__BABBHAFE">Example 21-3</a>, the <code class="codeph">&lt;EMPLIST&gt;</code> element corresponds to the <code class="codeph">emplist</code> column of type <code class="codeph">EmployeeListType</code>. Consequently, the <code class="codeph">&lt;EMPLIST&gt;</code> element contains a list of <code class="codeph">&lt;EMPLIST_ITEM&gt;</code> elements, each corresponding to an element of the collection. Note:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The <code class="codeph">&lt;ROW&gt;</code> elements contain a cardinality attribute <code class="codeph">num</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>If a particular column or attribute value is <code class="codeph">NULL</code>, then for that row, the corresponding XML element is omitted.
                                 </p>
                              </li>
                              <li>
                                 <p>If a top-level scalar column name starts with the at sign (<code class="codeph">@</code>) character, then the column is mapped to an XML attribute instead of an XML element.
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="ADXDK19482"></a><div class="props_rev_3"><a id="GUID-F74783F7-7230-49F0-BE0E-83F04B5C7A37" name="GUID-F74783F7-7230-49F0-BE0E-83F04B5C7A37"></a><h5 id="ADXDK-GUID-F74783F7-7230-49F0-BE0E-83F04B5C7A37" class="sect5">Default XML-to-SQL Mapping</h5>
                     <div>
                        <p>The default mapping of XML data to SQL data is described.</p>
                        <p>XML to SQL mapping is the reverse of SQL to XML mapping. Consider these differences when using XSU to map XML to SQL:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>When transforming XML to SQL, XSU ignores XML attributes. Thus, there is really no mapping of XML attributes to SQL.</p>
                           </li>
                           <li>
                              <p>When transforming SQL to XML, XSU performs the mapping on a single <code class="codeph">ResultSet</code> created by a SQL query. The query can span multiple database tables or views. When transforming XML into SQL, note: 
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>To insert one XML document into multiple tables or views, you must create an object-relational view over the target schema.</p>
                                 </li>
                                 <li>
                                    <p>If the view is not updatable, then you can use <code class="codeph">INSTEAD OF INSERT</code> triggers.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                        <p>If the XML document does not perfectly map to the target database schema, then you can perform these actions:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Modify the target. Create an object-relational view over the target schema and make the view the new target.</p>
                           </li>
                           <li>
                              <p>Modify the XML document by using XSLT to transform the XML document. You can register the XSLT stylesheet with XSU so that the incoming XML is automatically transformed before it attempts any mapping.</p>
                           </li>
                           <li>
                              <p>Modify XSU's XML-to-SQL mapping. You can instruct XSU to perform case-insensitive matching of XML elements to database columns or attributes. For example, you can instruct XSU to do this:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Use the name of the element corresponding to a database row instead of <code class="codeph">ROW</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Specify the date format to use when parsing dates in the XML document.</p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                  </div><a id="ADXDK19483"></a><div class="props_rev_3"><a id="GUID-9E8CFEF1-E081-4D54-A397-06823C55F39E" name="GUID-9E8CFEF1-E081-4D54-A397-06823C55F39E"></a><h5 id="ADXDK-GUID-9E8CFEF1-E081-4D54-A397-06823C55F39E" class="sect5">Customizing Generated XML</h5>
                     <div>
                        <p>In some situations, you might need to generate XML with a specific structure. Because the desired structure might differ from the default structure of the generated XML document, you need to have some flexibility in this process. </p>
                        <div class="section"> </div>
                        <!-- class="section" -->
                     </div><a id="ADXDK19485"></a><a id="ADXDK19486"></a><a id="ADXDK19484"></a><div class="props_rev_3"><a id="GUID-9BD36D83-085B-418B-AA50-1A01E3322D41" name="GUID-9BD36D83-085B-418B-AA50-1A01E3322D41"></a><h6 id="ADXDK-GUID-9BD36D83-085B-418B-AA50-1A01E3322D41" class="sect6">Altering the Database Schema or SQL Query</h6>
                        <div>
                           <p>You can perform source customizations by altering the SQL query or the database schema. </p>
                           <div class="section">
                              <p>The simplest and most powerful source customizations include:</p>
                           </div>
                           <!-- class="section" -->
                           <div class="section">
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>In the database schema, create an object-relational view that maps to the desired XML document structure.</p>
                                 </li>
                                 <li>
                                    <p>In your query, do this:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>Use cursor subqueries or cast-multiset constructs to create nesting in the XML document that comes from a flat schema. </p>
                                       </li>
                                       <li>
                                          <p>Alias column and attribute names to get the desired XML element names.</p>
                                       </li>
                                       <li>
                                          <p>Alias top-level scalar type columns with identifiers that begin with the at sign (@) to make them map to an XML attribute instead of an XML element. For example, executing these statement generates an XML document in which the <code class="codeph">&lt;ROW&gt;</code> element has the attribute <code class="codeph">empno</code>:
                                          </p><pre class="oac_no_warn" dir="ltr">SELECT employee_name AS "@empno",... FROM employees;
</pre></li>
                                    </ul>
                                 </li>
                              </ul>
                              <p>Consider the <code class="codeph">customer.xml</code> document shown in <a href="using-XML-SQL-utility.html#GUID-9BD36D83-085B-418B-AA50-1A01E3322D41__BABCIAJB">Example 21-4</a>.
                              </p>
                              <p>Suppose you must design a set of database tables to store this data. Because the XML is nested more than one level, you can use an object-relational database schema that maps canonically to the preceding XML document. Run the <code class="codeph">createObjRelSchema2.sql</code> script in SQL*Plus to create such a database schema.
                              </p>
                              <p>You can load the data in the <code class="codeph">customer.xml</code> document into the <code class="codeph">customer_tab</code> table created by the script. Invoke XSU for Java from the command line:
                              </p><pre class="oac_no_warn" dir="ltr">java OracleXML putXML -user "hr/<span class="italic">password</span>" -fileName customer.xml customer_tab
</pre><p>To load <code class="codeph">customer.xml</code> into a database schema that is not object-relational, you can create objects in views on top of a standard relational schema. For example, you can create a relational table that contains the necessary columns, then create a customer view that contains a customer object on top of it, as shown in the <code class="codeph">createRelSchema.sql</code> script in <a href="using-XML-SQL-utility.html#GUID-9BD36D83-085B-418B-AA50-1A01E3322D41__BABBCCEG">Example 21-5</a>.
                              </p>
                              <p>You can load data into <code class="codeph">customer_view</code>:
                              </p><pre class="oac_no_warn" dir="ltr">java OracleXML putXML -user "hr/<span class="italic">password</span>" -fileName customer.xml customer_view
</pre><p>Alternatively, you can flatten your XML with XSLT and then insert it directly into a relational schema. However, this is the least recommended option.</p>
                              <p>To map a particular column or a group of columns to an XML attribute instead of an XML element, you can create an alias for the column name and prepend the at sign (@) before the name of this alias. For example, you can use the <code class="codeph">mapColumnToAtt.sql</code> script to query the <code class="codeph">hr.employees</code> table, rendering <code class="codeph">employee_id</code> as an XML attribute.
                              </p>
                              <p>You can run the <code class="codeph">mapColumnToAtt.sql</code> script from the command line:
                              </p><pre class="oac_no_warn" dir="ltr">java OracleXML getXML -user "hr/<span class="italic">password</span>" -fileName "mapColumnToAtt.sql"</pre><div class="infoboxnote" id="GUID-9BD36D83-085B-418B-AA50-1A01E3322D41__GUID-7F410CB4-C4B1-4A73-A6EA-0BDEEA414ED8">
                                 <p class="notep1">Note:</p>
                                 <p>All attributes must appear <span class="italic">before</span> any nonattribute.
                                 </p>
                              </div>
                           </div>
                           <!-- class="section" -->
                           <div class="example" id="GUID-9BD36D83-085B-418B-AA50-1A01E3322D41__BABCIAJB">
                              <p class="titleinexample">Example 21-4 customer.xml</p><pre class="oac_no_warn" dir="ltr">&lt;?xml version = "1.0"?&gt;
&lt;ROWSET&gt;
 &lt;ROW num="1"&gt;
  &lt;CUSTOMER&gt;
   &lt;CUSTOMERID&gt;1044&lt;/CUSTOMERID&gt;
   &lt;FIRSTNAME&gt;Paul&lt;/FIRSTNAME&gt;
   &lt;LASTNAME&gt;Astoria&lt;/LASTNAME&gt;
   &lt;HOMEADDRESS&gt;
    &lt;STREET&gt;123 Cherry Lane&lt;/STREET&gt;
    &lt;CITY&gt;SF&lt;/CITY&gt;
    &lt;STATE&gt;CA&lt;/STATE&gt;
    &lt;ZIP&gt;94132&lt;/ZIP&gt;
   &lt;/HOMEADDRESS&gt;
  &lt;/CUSTOMER&gt;
 &lt;/ROW&gt;
&lt;/ROWSET&gt;
</pre></div>
                           <!-- class="example" -->
                           <div class="example" id="GUID-9BD36D83-085B-418B-AA50-1A01E3322D41__BABBCCEG">
                              <p class="titleinexample">Example 21-5 createRelSchema.sql</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE hr.cust_tab
 ( customerid NUMBER(10), 
   firstname VARCHAR2(20), 
   lastname VARCHAR2(20),
   street VARCHAR2(40),
   city VARCHAR2(20),
   state VARCHAR2(20),
   zip VARCHAR2(20)
 );

CREATE VIEW customer_view 
AS
SELECT customer_type(customerid, firstname, lastname,
       address_type(street,city,state,zip)) customer
FROM cust_tab;
</pre></div>
                           <!-- class="example" -->
                        </div>
                     </div><a id="ADXDK19487"></a><div class="props_rev_3"><a id="GUID-F32325DC-C31E-4EEC-B778-F960E9AB606C" name="GUID-F32325DC-C31E-4EEC-B778-F960E9AB606C"></a><h6 id="ADXDK-GUID-F32325DC-C31E-4EEC-B778-F960E9AB606C" class="sect6">Modifying XSU</h6>
                        <div>
                           <p>XSU lets you modify the rules that it uses to transform SQL data into XML. </p>
                           <p>You can make any of these changes when mapping SQL to XML:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Change or omit the <code class="codeph">&lt;ROWSET&gt;</code> or <code class="codeph">&lt;ROW&gt;</code> tag.
                                 </p>
                              </li>
                              <li>
                                 <p>Change or omit the attribute <code class="codeph">num</code>, which is the cardinality attribute of the <code class="codeph">&lt;ROW&gt;</code> element.
                                 </p>
                              </li>
                              <li>
                                 <p>Specify the case for the generated XML element names.</p>
                              </li>
                              <li>
                                 <p>Specify that XML elements corresponding to elements of a collection must have a cardinality attribute.</p>
                              </li>
                              <li>
                                 <p>Specify the format for dates in the XML document.</p>
                              </li>
                              <li>
                                 <p>Specify that null values in the XML document must be indicated with a nullness attribute rather than by omitting the element.</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="ADXDK19488"></a><div class="props_rev_3"><a id="GUID-67C89C5D-ACB8-4DC0-850B-64A3DEA2BC07" name="GUID-67C89C5D-ACB8-4DC0-850B-64A3DEA2BC07"></a><h4 id="ADXDK-GUID-67C89C5D-ACB8-4DC0-850B-64A3DEA2BC07" class="sect4">How XSU Processes SQL Statements</h4>
                  <div>
                     <p>How XSU processes SQL statements is described.</p>
                  </div><a id="ADXDK19489"></a><div class="props_rev_3"><a id="GUID-96EB8765-1F41-4E7E-9E9A-0E6864CB795A" name="GUID-96EB8765-1F41-4E7E-9E9A-0E6864CB795A"></a><h5 id="ADXDK-GUID-96EB8765-1F41-4E7E-9E9A-0E6864CB795A" class="sect5">How XSU Queries the Database</h5>
                     <div>
                        <p>XSU executes SQL queries and retrieves the <code class="codeph">ResultSet</code> from the database. XSU then acquires and analyzes metadata about the <code class="codeph">ResultSet</code>.
                        </p>
                        <p>Using the mapping described in <a href="using-XML-SQL-utility.html#GUID-15AC5AA9-6628-44A3-BF97-B0C0EBD81976" title="The default mapping of SQL data to XML data is described.">Default SQL-to-XML Mapping</a>, XSU processes the SQL result set and converts it into an XML document.
                        </p>
                        <p>XSU cannot handle certain types of queries, especially those that mix columns of type <code class="codeph">LONG</code> or <code class="codeph">LONG RAW</code> with <code class="codeph">CURSOR()</code> expressions in the <code class="codeph">SELECT</code> clause. <code class="codeph">LONG</code> and <code class="codeph">LONG RAW</code> are two examples of data types that JDBC accesses as streams and whose use is deprecated. If you migrate these columns to <code class="codeph">CLOBs</code>, then the queries succeed.
                        </p>
                     </div>
                  </div><a id="ADXDK19490"></a><div class="props_rev_3"><a id="GUID-A8CBE301-616E-42E7-949E-D4E7EF61ED84" name="GUID-A8CBE301-616E-42E7-949E-D4E7EF61ED84"></a><h5 id="ADXDK-GUID-A8CBE301-616E-42E7-949E-D4E7EF61ED84" class="sect5">How XSU Inserts Rows</h5>
                     <div>
                        <p>The steps that XSU performs when inserting an XML document into a table or view are described.</p>
                        <p>When inserting the contents of an XML document into a table or view, XSU does the following:</p>
                        <ol>
                           <li>
                              <p>Retrieves metadata about the target table or view. </p>
                           </li>
                           <li>
                              <p>Generates a SQL <code class="codeph">INSERT</code> statement based on the metadata. For example, assume that the target table is <code class="codeph">dept1</code> and the XML document is generated from <code class="codeph">dept1</code>. XSU generates this <code class="codeph">INSERT</code> statement:
                              </p><pre class="oac_no_warn" dir="ltr">INSERT INTO dept1 (deptno, deptname, deptaddr, emplist) VALUES (?,?,?,?)
</pre></li>
                           <li>
                              <p>Parses the XML document, and for each record, it binds the appropriate values to the appropriate columns or attributes. For example, it binds the values for <code class="codeph">INSERT</code> statement:
                              </p><pre class="oac_no_warn" dir="ltr">deptno   &lt;- 100
deptname &lt;- SPORTS
deptaddr &lt;- AddressType('100 Redwood Shores Pkwy','Redwood Shores',
                        'CA','94065')
emplist  &lt;- EmployeeListType(EmployeeType(7369,'John',100000,
            AddressType('300 Embarcadero','Palo Alto','CA','94056'),...)
</pre></li>
                           <li>
                              <p>Executes the statement. You can optimize <code class="codeph">INSERT</code> processing to insert in batches and commit in batches.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="using-XML-SQL-utility.html#GUID-15AC5AA9-6628-44A3-BF97-B0C0EBD81976" title="The default mapping of SQL data to XML data is described.">Default SQL-to-XML Mapping</a></li>
                           </ul>
                        </div>
                        <div class="infoboxnotealso" id="GUID-A8CBE301-616E-42E7-949E-D4E7EF61ED84__GUID-5A066F06-FFDD-4845-BF8C-0D942E8D1EF9">
                           <p class="notep1">See Also:</p>
                           <p><a href="using-XML-SQL-utility.html#GUID-555483DC-5765-4E8B-B99A-96832941FB54" title="To insert a document into a table or view, supply the table or view name and the document. XSU parses the document and creates an INSERT statement into which it binds the values. By default, XSU inserts values into all columns of the table or view.">Inserting Rows with OracleXMLSave</a> for more detail on batching
                           </p>
                        </div>
                     </div>
                     
                  </div><a id="ADXDK19491"></a><div class="props_rev_3"><a id="GUID-ED1B2C18-4548-4AEB-B94D-3610375D9A2E" name="GUID-ED1B2C18-4548-4AEB-B94D-3610375D9A2E"></a><h5 id="ADXDK-GUID-ED1B2C18-4548-4AEB-B94D-3610375D9A2E" class="sect5">How XSU Updates Rows</h5>
                     <div>
                        <p>Updates and delete statements differ from inserts in that they can affect more than one row in the database table. </p>
                        <p>For inserts, each <code class="codeph">&lt;ROW&gt;</code> element of the XML document can affect at most one row in the table if no triggers or constraints are on the table. With updates and deletes, the XML element can match more than one row if the matching columns are not key columns in the table. 
                        </p>
                        <p>For update statements, you must provide a list of key columns that XSU must identify the row to update. For example, assume that you have an XML document that contains this fragment:</p><pre class="pre codeblock"><code>&lt;ROWSET&gt;
  &lt;ROW num="1"&gt;
    &lt;DEPTNO&gt;100&lt;/DEPTNO&gt;
    &lt;DEPTNAME&gt;SportsDept&lt;/DEPTNAME&gt;
  &lt;/ROW&gt;
&lt;/ROWSET&gt;
</code></pre><p>You want to change the <code class="codeph">DEPTNAME</code> value from <code class="codeph">Sports</code> to <code class="codeph">SportsDept</code>. If you supply the <code class="codeph">DEPTNO</code> as the key column, then XSU generates this <code class="codeph">UPDATE</code> statement:
                        </p><pre class="pre codeblock"><code>UPDATE dept1 SET deptname = ? WHERE deptno = ?
</code></pre><p>XSU binds the values in this way:</p><pre class="pre codeblock"><code>deptno &lt;- 100
deptname &lt;- SportsDept
</code></pre><p>For updates, you can also choose to update only a set of columns and not all the elements present in the XML document.</p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="using-XML-SQL-utility.html#GUID-646799B4-73D6-4AD1-94F1-E614343D65F6" title="Examples show how to update the fields in a table or view. You supply the table or view name and an XML document. XSU parses the document (if a string is given) and creates one or more UPDATE statements into which it binds all of the values.">Updating Rows Using OracleXMLSave</a></li>
                           </ul>
                        </div>
                     </div>
                     
                  </div><a id="ADXDK19492"></a><div class="props_rev_3"><a id="GUID-1333299E-2764-42FC-ACBF-FD1AC00BCF4B" name="GUID-1333299E-2764-42FC-ACBF-FD1AC00BCF4B"></a><h5 id="ADXDK-GUID-1333299E-2764-42FC-ACBF-FD1AC00BCF4B" class="sect5">How XSU Deletes Rows</h5>
                     <div>
                        <p>For row deletions, you can choose to provide a set of key columns, so that XSU can identify the rows to be deleted. If you do not provide a set of key columns then the <code class="codeph">DELETE</code> statement tries to match all the columns in the document.
                        </p>
                        <p>Assume that you pass this document to XSU:</p><pre class="pre codeblock"><code>&lt;ROWSET&gt;
 &lt;ROW num="1"&gt;
  &lt;DEPTNO&gt;100&lt;/DEPTNO&gt;
  &lt;DEPTNAME&gt;Sports&lt;/DEPTNAME&gt;
  &lt;DEPTADDR&gt;
      &lt;STREET&gt;100 Redwood Shores Pkwy&lt;/STREET&gt;
      &lt;CITY&gt;Redwood Shores&lt;/CITY&gt;
      &lt;STATE&gt;CA&lt;/STATE&gt;
      &lt;ZIP&gt;94065&lt;/ZIP&gt;
  &lt;/DEPTADDR&gt;
 &lt;/ROW&gt;
 &lt;!-- additional rows ... --&gt;
&lt;/ROWSET&gt;
</code></pre><p>XSU builds a <code class="codeph">DELETE</code> statement for each <code class="codeph">ROW</code> element:
                        </p><pre class="pre codeblock"><code>DELETE FROM dept1 WHERE deptno = ? AND deptname = ? AND deptaddr = ?
</code></pre><p>The binding is:</p><pre class="pre codeblock"><code>deptno   &lt;- 100
deptname &lt;- sports
deptaddr &lt;- addresstype('100 redwood shores pkwy','redwood city','ca',
            '94065')</code></pre></div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="using-XML-SQL-utility.html#GUID-2E4CC584-0613-4BC2-9C9B-252AE6A91A84" title="When deleting from XML documents, you can specify a list of key columns. XSU uses these columns in the WHERE clause of the DELETE statement. If you do not supply the key column names, then XSU creates a new DELETE statement for each ROW element of the XML document.">Deleting Rows using XSU</a></li>
                           </ul>
                        </div>
                     </div>
                     
                  </div><a id="ADXDK19493"></a><div class="props_rev_3"><a id="GUID-F30015F9-A177-4E4A-A9B5-7540DE85906C" name="GUID-F30015F9-A177-4E4A-A9B5-7540DE85906C"></a><h5 id="ADXDK-GUID-F30015F9-A177-4E4A-A9B5-7540DE85906C" class="sect5">How XSU Commits After DML</h5>
                     <div>
                        <p>By default, XSU performs no explicit commits. If <code class="codeph">AUTOCOMMIT</code> is on, which is the default for a JDBC connection, then after each batch of statement executions XSU executes a <code class="codeph">COMMIT</code>. 
                        </p>
                        <p>You can override this behavior by turning <code class="codeph">AUTOCOMMIT</code> off and then using <code class="codeph">setCommitBatch</code> to specify the number of statement executions before XSU commits. If an error occurs, then XSU rolls back to either the state the target table was in before the call to XSU, or the state after the last commit made during the current call to XSU.
                        </p>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>