<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The DBMS_NETWORK_ACL_UTILITY package provides the utility functions to facilitate the evaluation of access control list (ACL) assignments governing TCP connections to network hosts.">
      <meta name="description" content="The DBMS_NETWORK_ACL_UTILITY package provides the utility functions to facilitate the evaluation of access control list (ACL) assignments governing TCP connections to network hosts.">
      <title>DBMS_NETWORK_ACL_UTILITY</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="PL/SQL Packages and Types Reference">
      <meta property="og:description" content="The DBMS_NETWORK_ACL_UTILITY package provides the utility functions to facilitate the evaluation of access control list (ACL) assignments governing TCP connections to network hosts.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="PL/SQL Packages and Types Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-pl-sql-packages-and-types-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-25T11:24:34-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96430-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="DBMS_NETWORK_ACL_ADMIN.html" title="Previous" type="text/html">
      <link rel="next" href="DBMS_ODCI.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference">
    <meta name="dcterms.isVersionOf" content="ARPLS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="DBMS_NETWORK_ACL_ADMIN.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="DBMS_ODCI.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">PL/SQL Packages and Types Reference</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> DBMS_NETWORK_ACL_UTILITY</li>
            </ol>
            <a id="GUID-61CE01B2-4FB9-4ADF-81A7-E01516983AF3" name="GUID-61CE01B2-4FB9-4ADF-81A7-E01516983AF3"></a><a id="ARPLS221"></a><a id="ARPLS221"></a>
            
            <h2 id="ARPLS-GUID-61CE01B2-4FB9-4ADF-81A7-E01516983AF3" class="sect2"><span class="enumeration_chapter">111 </span> DBMS_NETWORK_ACL_UTILITY
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The <code class="codeph">DBMS_NETWORK_ACL_UTILITY</code> package provides the utility functions to facilitate the evaluation of access control list (ACL) assignments governing TCP connections to network hosts. 
               </p>
               <div class="infoboxnotealso" id="GUID-61CE01B2-4FB9-4ADF-81A7-E01516983AF3__GUID-89FF037F-5C1E-40D9-8F1E-3AE658467ED2">
                  <p class="notep1">See Also:</p>
                  <p>For more information, see <a href="../dbseg/managing-fine-grained-access-in-pl-sql-packages-and-types.html#DBSEG40012" target="_blank">""Managing Fine-grained Access to External Network Services""</a> in <span class="italic">Oracle Database Security Guide</span></p>
               </div>
               <p>The chapter contains the following topics: </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="DBMS_NETWORK_ACL_UTILITY.html#GUID-3BBC15F6-AE46-45C0-B6BB-C1E8391E1621" title="EXECUTE on the DBMS_NETWORK_ACL_UTILITY package is granted to PUBLIC.">Security Model</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_NETWORK_ACL_UTILITY.html#GUID-B2A196D9-AC54-4548-B018-233C4B468997" title="The CONTAINS_HOST Function in this package indicates if a domain or subnet contains a given host or IP address.">Examples</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_NETWORK_ACL_UTILITY.html#GUID-8F46B737-F221-4F0E-8055-8EF2AF8C74C1" title="This table lists and briefly describes the DBMS_NETWORK_ACL_UTILITY package subprograms.">Summary of DBMS_NETWORK_ACL_UTILITY Subprograms</a></p>
                  </li>
               </ul>
            </div><a id="ARPLS74591"></a><a id="ARPLS74591"></a><div class="props_rev_3"><a id="GUID-3BBC15F6-AE46-45C0-B6BB-C1E8391E1621" name="GUID-3BBC15F6-AE46-45C0-B6BB-C1E8391E1621"></a><h3 id="ARPLS-GUID-3BBC15F6-AE46-45C0-B6BB-C1E8391E1621" class="sect3"><span class="enumeration_section">111.1 </span>DBMS_NETWORK_ACL_UTILITY Security Model
               </h3>
               <div>
                  <p><code class="codeph">EXECUTE</code> on the <code class="codeph">DBMS_NETWORK_ACL_UTILITY</code> package is granted to <code class="codeph">PUBLIC</code>.
                  </p>
               </div>
            </div><a id="ARPLS67244"></a><a id="ARPLS67245"></a><a id="ARPLS67246"></a><a id="ARPLS67245"></a><a id="ARPLS67246"></a><a id="ARPLS67244"></a><div class="props_rev_3"><a id="GUID-B2A196D9-AC54-4548-B018-233C4B468997" name="GUID-B2A196D9-AC54-4548-B018-233C4B468997"></a><h3 id="ARPLS-GUID-B2A196D9-AC54-4548-B018-233C4B468997" class="sect3"><span class="enumeration_section">111.2 </span>DBMS_NETWORK_ACL_UTILITY Examples
               </h3>
               <div>
                  <p>The CONTAINS_HOST Function in this package indicates if a domain or subnet contains a given host or IP address.</p>
                  <div class="section">
                     <p>It can be used in conjunction with the <a href="DBMS_NETWORK_ACL_ADMIN.html#GUID-9BD00A5B-73B2-4C15-8338-DE686B5EF0D1" title="This function checks if a privilege is granted to or denied from the user in an ACL by specifying the object ID of the access control list.">CHECK_PRIVILEGE_ACLID Function</a> in the <a href="DBMS_NETWORK_ACL_ADMIN.html#GUID-254AE700-B355-4EBC-84B2-8EE32011E692" title="The DBMS_NETWORK_ACL_ADMIN package provides the interface to administer the network Access Control List (ACL)."> DBMS_NETWORK_ACL_ADMIN </a> package to determine the privilege assignments affecting a user's permission to access a network host. The return value of the <code class="codeph">CONTAINS_HOST</code> Function in can also be used to order the ACL assignments by their precedence.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-B2A196D9-AC54-4548-B018-233C4B468997__GUID-14E71C1F-36FF-4D04-9791-F03408ED25E3">Example 1</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>For example, for SCOTT's permission to connect to <span>www.hr.example.com</span>:
                     </p><pre class="oac_no_warn" dir="ltr">  SELECT host, lower_port, upper_port, acl,
     DECODE(
         DBMS_NETWORK_ACL_ADMIN.CHECK_PRIVILEGE_ACLID(aclid, 'SCOTT', 'connect'),
            1, 'GRANTED', 0, 'DENIED', NULL) privilege
     FROM (SELECT host, acl, aclid, lower_port, upper_port,
               DBMS_NETWORK_ACL_UTILITY.CONTAINS_HOST('www.hr.example.com', host)
                 precedence
          FROM dba_network_acls)
 WHERE precedence &gt; 0
 ORDER BY precedence DESC, lower_port nulls LAST;


   HOST                 LOWER_PORT UPPER_PORT  ACL                 PRIVILEGE
   -------------------- ---------- ---------- -------------------- ---------
   www.hr.example.com          80         80  /sys/acls/www.xml    GRANTED
   www.hr.example.com        3000       3999  /sys/acls/www.xml    GRANTED
   www.hr.example.com                         /sys/acls/www.xml    GRANTED
   *.hr.example.com                           /sys/acls/all.xml
   *.example.com                              /sys/acls/all.xml</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-B2A196D9-AC54-4548-B018-233C4B468997__GUID-C75E547D-BBA2-4D73-937D-3DFD158DD50E">Example 2</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>For example, for <code class="codeph">SCOTT</code>'s permission to do domain name resolution for www.hr.example.com:
                     </p><pre class="oac_no_warn" dir="ltr">SELECT host, acl,
  DECODE(
    DBMS_NETWORK_ACL_ADMIN.CHECK_PRIVILEGE_ACLID(aclid, 'SCOTT', 'resolve'),
      1, 'GRANTED', 0, 'DENIED', null) privilege
  FROM (SELECT host, acl, aclid,
               DBMS_NETWORK_ACL_UTILITY.CONTAINS_HOST('www.hr.example.com', host)
                 precedence
          FROM dba_network_acls
         WHERE lower_port IS NULL AND upper_port IS NULL)
 WHERE precedence &gt; 0
 ORDER BY precedence DESC;

HOST                   ACL                          PRIVILEGE
---------------------- ---------------------------- ---------
www.hr.example.com     /sys/acls/hr-www.xml         GRANTED
*.hr.example.com       /sys/acls/hr-domain.xml
*.example.com          /sys/acls/corp-domain.xml
 </pre><p>Note that the "resolve" privilege takes effect only in ACLs assigned without any port range (when <code class="codeph">lower_port</code> and <code class="codeph">upper_port</code> are <code class="codeph">NULL</code>). For this reason, the example does not include <code class="codeph">lower_port</code> and <code class="codeph">upper_port</code> columns in the query.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="DBMS_NETWORK_ACL_UTILITY.html#GUID-C1F73B38-4A74-4193-BA12-B5E980CAC9D2" title="This function determines if the given host is equal to or contained in the given host, domain, or subnet. It handles different representation of the same IP address or subnet. For example, an IPv4-mapped IPv6 address is considered equal to the IPv4-native address it represents. It does not perform domain name resolution when evaluating the host or domain.">CONTAINS_HOST Function</a></li>
                     </ul>
                  </div>
               </div>
            </div><a id="ARPLS67247"></a><a id="ARPLS67248"></a><a id="ARPLS67248"></a><a id="ARPLS67247"></a><div class="props_rev_3"><a id="GUID-8F46B737-F221-4F0E-8055-8EF2AF8C74C1" name="GUID-8F46B737-F221-4F0E-8055-8EF2AF8C74C1"></a><h3 id="ARPLS-GUID-8F46B737-F221-4F0E-8055-8EF2AF8C74C1" class="sect3"><span class="enumeration_section">111.3 </span>Summary of DBMS_NETWORK_ACL_UTILITY Subprograms
               </h3>
               <div>
                  <p>This table lists and briefly describes the <code class="codeph">DBMS_NETWORK_ACL_UTILITY</code> package subprograms.
                  </p>
                  <div class="tblformal" id="GUID-8F46B737-F221-4F0E-8055-8EF2AF8C74C1__GUID-EED15A15-191B-4F84-BA23-DA0273EB1322">
                     <p class="titleintable">Table 111-1 DBMS_NETWORK_ACL_UTILITY Package Subprograms</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_NETWORK_ACL_UTILITY Package Subprograms" summary="This table lists and briefly describes the DBMS_NETWORK_ACL_UTILITY Package Subprograms." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="39%" id="d642114e490">Subprogram</th>
                              <th align="left" valign="bottom" width="61%" id="d642114e493">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d642114e498" headers="d642114e490 ">
                                 <p><a href="DBMS_NETWORK_ACL_UTILITY.html#GUID-C1F73B38-4A74-4193-BA12-B5E980CAC9D2" title="This function determines if the given host is equal to or contained in the given host, domain, or subnet. It handles different representation of the same IP address or subnet. For example, an IPv4-mapped IPv6 address is considered equal to the IPv4-native address it represents. It does not perform domain name resolution when evaluating the host or domain.">CONTAINS_HOST Function</a></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d642114e498 d642114e493 ">
                                 <p>Determines if the given host is equal to or contained in the given host, domain, or subnet</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d642114e510" headers="d642114e490 ">
                                 <p><a href="DBMS_NETWORK_ACL_UTILITY.html#GUID-1A313889-7017-49D9-B538-6ECCAEB685ED" title="This function returns the domain level of the given host name, domain, or subnet.">DOMAIN_LEVEL Function</a></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d642114e510 d642114e493 ">
                                 <p>Returns the domain level of the given host name, domain, or subnet</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d642114e522" headers="d642114e490 ">
                                 <p><a href="DBMS_NETWORK_ACL_UTILITY.html#GUID-47189B92-450F-40B0-B695-DF52AD3FC555" title="For a given host, this function returns the domains whose ACL assigned determines if a user has the privilege to access the given host or not. When the IP address of the host is given, return the subnets instead.">DOMAINS Function</a></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d642114e522 d642114e493 ">
                                 <p>For a given host, this function returns the domains whose ACL assigned is used to determine if a user has the privilege to access the given host or not.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d642114e534" headers="d642114e490 ">
                                 <p><a href="DBMS_NETWORK_ACL_UTILITY.html#GUID-5F4D22AC-CB77-4BFF-9F16-AA7AD7B70125" title="This function determines if the two given hosts, domains, or subnets are equal. It handles different representation of the same IP address or subnet. For example, an IPv4-mapped IPv6 address is considered equal to the IPv4- native address it represents. It does not perform domain name resolution when comparing the two hosts or domains.">EQUALS_HOST Function</a></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d642114e534 d642114e493 ">
                                 <p>Determines if the two given hosts, domains, or subnets are equal</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="ARPLS67249"></a><a id="ARPLS67250"></a><a id="ARPLS67250"></a><a id="ARPLS67249"></a><div class="props_rev_3"><a id="GUID-C1F73B38-4A74-4193-BA12-B5E980CAC9D2" name="GUID-C1F73B38-4A74-4193-BA12-B5E980CAC9D2"></a><h4 id="ARPLS-GUID-C1F73B38-4A74-4193-BA12-B5E980CAC9D2" class="sect4"><span class="enumeration_section">111.3.1 </span>CONTAINS_HOST Function
                  </h4>
                  <div>
                     <p>This function determines if the given host is equal to or contained in the given host, domain, or subnet. It handles different representation of the same IP address or subnet. For example, an IPv4-mapped IPv6 address is considered equal to the IPv4-native address it represents. It does not perform domain name resolution when evaluating the host or domain.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C1F73B38-4A74-4193-BA12-B5E980CAC9D2__GUID-0149CB9C-6B00-4A69-88A6-FE7B6CFCC3BE">Syntax </p><pre class="oac_no_warn" dir="ltr">DBMS_NETWORK_ACL_UTILITY.CONTAINS_HOST (
   host      IN    VARCHAR2,
   domain    IN    VARCHAR2)
 RETURN NUMBER;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C1F73B38-4A74-4193-BA12-B5E980CAC9D2__GUID-CA33815C-EC12-4BB1-80C9-1CE5DA3B4A34">Parameters</p>
                        <div class="tblformal" id="GUID-C1F73B38-4A74-4193-BA12-B5E980CAC9D2__GUID-2CEA8D68-CDF2-4669-981E-09943A9F3E46">
                           <p class="titleintable">Table 111-2 CONTAINS_HOST Function Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="CONTAINS_HOST Function Parameters" summary="This table describes the Parameters of DBMS_NETWORK_ACL_UTILITY.CONTAINS_HOST subprogram." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d642114e655">Parameter</th>
                                    <th align="left" valign="bottom" width="69%" id="d642114e658">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d642114e663" headers="d642114e655 ">
                                       <p><code class="codeph">host</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d642114e663 d642114e658 ">
                                       <p>Network host</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d642114e671" headers="d642114e655 ">
                                       <p><code class="codeph">domain</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d642114e671 d642114e658 ">
                                       <p>Network host, domain, or subnet</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C1F73B38-4A74-4193-BA12-B5E980CAC9D2__GUID-933F0FFC-FCC3-4BE0-9601-F4B1AF47AB70">Return Values</p>
                        <p>Returns a non-<code class="codeph">NULL</code> value if the given host is equal to or contained in the related host, domain, or subnet:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If <code class="codeph">domain</code> is a hostname, returns the level of its domain + 1
                              </p>
                           </li>
                           <li>
                              <p>If <code class="codeph">domain</code> is a domain name, returns the domain level
                              </p>
                           </li>
                           <li>
                              <p>If <code class="codeph">domain</code> is an IP address or subnet, return the number of significant address bits of the IP address or subnet
                              </p>
                           </li>
                           <li>
                              <p>If domain is the wildcard "*", returns 0</p>
                           </li>
                        </ul>
                        <p>The non-<code class="codeph">NULL</code> value returned indicates the precedence of the domain or subnet for ACL assignment. The higher the value, the higher is the precedence. <code class="codeph">NULL</code> will be returned if the host is not equal to or contained in the given host, domain or subnet.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C1F73B38-4A74-4193-BA12-B5E980CAC9D2__GUID-348056D8-0F34-4FEC-9610-F50954AD67A0">Examples</p><pre class="oac_no_warn" dir="ltr">SELECT host, acl, precedence
  FROM (select host, acl,
               DBMS_NETWORK_ACL_UTILITY.CONTAINS_HOST('192.0.2.3', host)
                 precedence
          FROM dba_network_acls)
 WHERE precedence &gt; 0
 ORDER BY precedence DESC;

HOST                   ACL                        PRECEDENCE
---------------------- -------------------------- ----------
192.0.2.3              /sys/acls/hr-www.xml               32
::ffff:192.0.2.0/120   /sys/acls/hr-domain.xml            24
::ffff:192.0.0.0/104   /sys/acls/corp-domain.xml           8</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS67251"></a><a id="ARPLS67252"></a><a id="ARPLS67252"></a><a id="ARPLS67251"></a><div class="props_rev_3"><a id="GUID-1A313889-7017-49D9-B538-6ECCAEB685ED" name="GUID-1A313889-7017-49D9-B538-6ECCAEB685ED"></a><h4 id="ARPLS-GUID-1A313889-7017-49D9-B538-6ECCAEB685ED" class="sect4"><span class="enumeration_section">111.3.2 </span>DOMAIN_LEVEL Function
                  </h4>
                  <div>
                     <p>This function returns the domain level of the given host name, domain, or subnet.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-1A313889-7017-49D9-B538-6ECCAEB685ED__GUID-968BD924-FE97-470A-AA1C-A6AA765549BE">Syntax </p><pre class="oac_no_warn" dir="ltr">DBMS_NETWORK_ACL_UTILITY.DOMAIN_LEVEL (
    host  IN VARCHAR2) 
  RETURN NUMBER;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1A313889-7017-49D9-B538-6ECCAEB685ED__GUID-BF3D185C-EE32-4931-96CA-021EEA067EEA">Parameters</p>
                        <div class="tblformal" id="GUID-1A313889-7017-49D9-B538-6ECCAEB685ED__GUID-35C85D29-F46C-4F2F-8751-AA01E7CC7D08">
                           <p class="titleintable">Table 111-3 DOMAIN_LEVEL Function Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DOMAIN_LEVEL Function Parameters" summary="This table describes the Parameters of DBMS_NETWORK_ACL_UTILITY.DOMAIN_LEVEL subprogram." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d642114e832">Parameter</th>
                                    <th align="left" valign="bottom" width="69%" id="d642114e835">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d642114e840" headers="d642114e832 ">
                                       <p><code class="codeph">host</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d642114e840 d642114e835 ">
                                       <p>Network host, domain, or subnet</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1A313889-7017-49D9-B538-6ECCAEB685ED__GUID-28F220C5-A754-492F-A153-96C13DC9BBA0">Return Values</p>
                        <p>The domain level of the given host, domain, or subnet.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1A313889-7017-49D9-B538-6ECCAEB685ED__GUID-F08581D7-9CED-45D0-BCB9-F6085149ED3B">Usage Notes</p>
                        <p>Note that this function cannot handle IPv6 addresses and subnets, and subnets in CIDR notation.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1A313889-7017-49D9-B538-6ECCAEB685ED__GUID-B7CF24A6-48BB-4116-8ED2-6195C98CC9D7">Examples</p><pre class="oac_no_warn" dir="ltr">SELECT host, acl, domain_level
  FROM (select host, acl,
               DBMS_NETWORK_ACL_UTILITY.DOMAIN_LEVEL(host) domain_level
          FROM dba_network_acls)
 order by domain_level desc;

HOST                   ACL                          DOMAIN_LEVEL
---------------------- ---------------------------- ------------
www.hr.example.com     /sys/acls/hr-www.xml                    4
*.hr.example.com       /sys/acls/hr-domain.xml                 3
*.example.com          /sys/acls/corp-domain.xml               2</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS67253"></a><a id="ARPLS67254"></a><a id="ARPLS67254"></a><a id="ARPLS67253"></a><div class="props_rev_3"><a id="GUID-47189B92-450F-40B0-B695-DF52AD3FC555" name="GUID-47189B92-450F-40B0-B695-DF52AD3FC555"></a><h4 id="ARPLS-GUID-47189B92-450F-40B0-B695-DF52AD3FC555" class="sect4"><span class="enumeration_section">111.3.3 </span>DOMAINS Function
                  </h4>
                  <div>
                     <p>For a given host, this function returns the domains whose ACL assigned determines if a user has the privilege to access the given host or not. When the IP address of the host is given, return the subnets instead.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-47189B92-450F-40B0-B695-DF52AD3FC555__GUID-45D59413-7ED7-4D4B-AB4C-E1EF1B3FC774">Syntax </p><pre class="oac_no_warn" dir="ltr">DBMS_NETWORK_ACL_UTILITY.DOMAINS (
    host  IN VARCHAR2) 
  RETURN DOMAIN_TABLE PIPELINED;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-47189B92-450F-40B0-B695-DF52AD3FC555__GUID-455FBCDE-A2C2-4256-B0C5-E33E058660C5">Parameters</p>
                        <div class="tblformal" id="GUID-47189B92-450F-40B0-B695-DF52AD3FC555__GUID-86F85162-A50C-46A0-890C-0D751D823E94">
                           <p class="titleintable">Table 111-4 DOMAINS Function Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DOMAINS Function Parameters" summary="This table describes the Parameters of DBMS_NETWORK_ACL_UTILITY.DOMAINS subprogram." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d642114e972">Parameter</th>
                                    <th align="left" valign="bottom" width="69%" id="d642114e975">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d642114e980" headers="d642114e972 ">
                                       <p><code class="codeph">host</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d642114e980 d642114e975 ">
                                       <p>Network host</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-47189B92-450F-40B0-B695-DF52AD3FC555__GUID-0B5A5263-401A-4143-8313-6840D46B94BA">Return Values</p>
                        <p>The domains or subnets for the given host.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-47189B92-450F-40B0-B695-DF52AD3FC555__GUID-C5DF877F-0A7C-48B0-98EA-82323ADB514A">Usage Notes</p>
                        <p>Note that this function cannot handle IPv6 addresses. Nor can it generate subnets of arbitrary number of prefix bits for an IPv4 address.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-47189B92-450F-40B0-B695-DF52AD3FC555__GUID-A89FCD4F-2CE1-4F1E-850C-3106383F3F6D">Examples</p><pre class="oac_no_warn" dir="ltr">select * from table(dbms_network_acl_utility.domains('www.hr.example.com'));
 
DOMAINS
--------------------------
www.hr.example.com
*.hr.example.com
*.example.com
*.com
*</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS67255"></a><a id="ARPLS67256"></a><a id="ARPLS67256"></a><a id="ARPLS67255"></a><div class="props_rev_3"><a id="GUID-5F4D22AC-CB77-4BFF-9F16-AA7AD7B70125" name="GUID-5F4D22AC-CB77-4BFF-9F16-AA7AD7B70125"></a><h4 id="ARPLS-GUID-5F4D22AC-CB77-4BFF-9F16-AA7AD7B70125" class="sect4"><span class="enumeration_section">111.3.4 </span>EQUALS_HOST Function
                  </h4>
                  <div>
                     <p>This function determines if the two given hosts, domains, or subnets are equal. It handles different representation of the same IP address or subnet. For example, an IPv4-mapped IPv6 address is considered equal to the IPv4- native address it represents. It does not perform domain name resolution when comparing the two hosts or domains.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5F4D22AC-CB77-4BFF-9F16-AA7AD7B70125__GUID-1789F2D0-0A0F-4B3D-ACA3-E52E89BFF418">Syntax </p><pre class="oac_no_warn" dir="ltr">DBMS_NETWORK_ACL_UTILITY.EQUALS_HOST (
   host1    IN    VARCHAR2,
   host2    IN    VARCHAR2)
 RETURN NUMBER;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5F4D22AC-CB77-4BFF-9F16-AA7AD7B70125__GUID-70230497-A8D1-4C31-8C5D-75F0DE2B2CA5">Parameters</p>
                        <div class="tblformal" id="GUID-5F4D22AC-CB77-4BFF-9F16-AA7AD7B70125__GUID-9B485FFF-50F0-40C6-913E-6444A170D9A6">
                           <p class="titleintable">Table 111-5 EQUALS_HOST Function Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="EQUALS_HOST Function Parameters" summary="This table describes the Parameters of DBMS_NETWORK_ACL_UTILITY.EQUALS_HOST subprogram." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d642114e1112">Parameter</th>
                                    <th align="left" valign="bottom" width="69%" id="d642114e1115">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d642114e1120" headers="d642114e1112 ">
                                       <p><code class="codeph">host</code>1
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d642114e1120 d642114e1115 ">
                                       <p>Network host, domain, or subnet to compare</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d642114e1129" headers="d642114e1112 ">
                                       <p><code class="codeph">host</code>2
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d642114e1129 d642114e1115 ">
                                       <p>Network host, domain, or subnet to compare</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5F4D22AC-CB77-4BFF-9F16-AA7AD7B70125__GUID-2C765EB1-C1D7-4696-97F2-5E29B0E34E3C">Return Values</p>
                        <p>1 if the two hosts, domains, or subnets are equal. 0 otherwise.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5F4D22AC-CB77-4BFF-9F16-AA7AD7B70125__GUID-6C88E109-A761-4B65-B32F-9F71ECEDB12E">Examples</p><pre class="oac_no_warn" dir="ltr">SELECT host, acl
  FROM dba_network_acls
 WHERE DBMS_NETWORK_ACL_UTILITY.EQUALS_HOST('192.0.2.*', host) = 1;
 
HOST                   ACL
---------------------- ----------------------------
::ffff:192.0.2.0/120   /sys/acls/hr-domain.xml</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>