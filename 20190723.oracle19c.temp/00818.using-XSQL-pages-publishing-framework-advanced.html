<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="An explanation is given of how to use advanced features of the XSQL pages publishing framework.">
      <meta name="description" content="An explanation is given of how to use advanced features of the XSQL pages publishing framework.">
      <title>Using the XSQL Pages Publishing Framework: Advanced Topics</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content="An explanation is given of how to use advanced features of the XSQL pages publishing framework.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="xml-developers-kit-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T05:58:48-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96292-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-XSQL-pages-publishing-framework.html" title="Previous" type="text/html">
      <link rel="next" href="XDK-for-C-plus-plus.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML Developers Kit Programmers Guide">
    <meta name="dcterms.isVersionOf" content="ADXDK">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-XSQL-pages-publishing-framework.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="XDK-for-C-plus-plus.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XDK-for-Java.html" property="item" typeof="WebPage"><span property="name">Oracle XML Developer's Kit for Java</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Using the XSQL Pages Publishing Framework: Advanced Topics</li>
            </ol>
            <a id="GUID-02EA5758-7A8F-4FD7-B9F1-F346E759CD79" name="GUID-02EA5758-7A8F-4FD7-B9F1-F346E759CD79"></a><a id="ADXDK1026"></a><a id="ADXDK090"></a>
            
            <h2 id="ADXDK-GUID-02EA5758-7A8F-4FD7-B9F1-F346E759CD79" class="sect2"><span class="enumeration_chapter">25 </span>Using the XSQL Pages Publishing Framework: Advanced Topics
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>An explanation is given of how to use advanced features of the XSQL pages publishing framework.</p>
               <div class="section"> </div>
               <!-- class="section" -->
            </div>
            <div>
               <div class="relinfo">
                  <p><strong>Related Topics</strong></p>
                  <ul>
                     <li><a href="using-XSQL-pages-publishing-framework.html#GUID-A1834D2F-B962-4881-AE7A-F323FF11384D" title="An explanation is given of how to use the basic features of the XSQL pages publishing framework.">Using the XSQL Pages Publishing Framework</a></li>
                  </ul>
               </div>
               <div class="infoboxnotealso" id="GUID-02EA5758-7A8F-4FD7-B9F1-F346E759CD79__GUID-0B517870-1FD9-4127-A5FC-E740678183F8">
                  <p class="notep1">See Also:</p>
                  <p><a href="using-XSQL-pages-publishing-framework.html#GUID-A1834D2F-B962-4881-AE7A-F323FF11384D" title="An explanation is given of how to use the basic features of the XSQL pages publishing framework.">Using the XSQL Pages Publishing Framework</a> for information about basic features
                  </p>
               </div>
            </div>
            <a id="ADXDK19642"></a><div class="props_rev_3"><a id="GUID-2B89944D-0FF0-41C7-9547-C3F363718DF6" name="GUID-2B89944D-0FF0-41C7-9547-C3F363718DF6"></a><h3 id="ADXDK-GUID-2B89944D-0FF0-41C7-9547-C3F363718DF6" class="sect3">Customizing the XSQL Configuration File Name</h3>
               <div>
                  <p>By default, the XSQL pages framework expects the configuration file to be named <code class="codeph">XSQLConfig.xml</code>. When moving between development, test, and production environments, you can switch among different versions of a configuration file. To override the name of the configuration file read by the XSQL page processor, set system property <code class="codeph">xsql.config</code>.
                  </p>
                  <div class="section">
                     <p>The simplest technique is to specify a Java Virtual Machine (JVM) command-line flag such as <code class="codeph">-Dxsql.config=</code><span class="italic"><code class="codeph">MyConfigFile.xml </code></span>by defining a servlet initialization parameter named <code class="codeph">xsql.config</code>. Add an <code class="codeph">&lt;init-param&gt;</code> element to your <code class="codeph">web.xml</code> file as part of the <code class="codeph">&lt;servlet&gt;</code> tag that defines the XSQL Servlet:
                     </p><pre class="oac_no_warn" dir="ltr">&lt;servlet&gt;
  &lt;servlet-name&gt;XSQL&lt;/servlet-name&gt;
  &lt;servlet-class&gt;oracle.xml.xsql.XSQLServlet&lt;/servlet-class&gt;
  &lt;init-param&gt;
    &lt;param-name&gt;xsql.config&lt;/param-name&gt;
    &lt;param-value&gt;MyConfigFile.xml&lt;/param-value&gt;
    &lt;description&gt;
       Please Use MyConfigFile.xml instead of XSQLConfig.xml
    &lt;/description&gt;
  &lt;/init-param&gt;
&lt;/servlet&gt;
</pre><p>The servlet initialization parameter is applicable only to the servlet-based use of the XSQL engine. When using the <code class="codeph">XSQLCommandLine</code> or <code class="codeph">XSQLRequest</code> programmatic interfaces, use the <code class="codeph">System</code> parameter instead.
                     </p>
                     <div class="infoboxnote" id="GUID-2B89944D-0FF0-41C7-9547-C3F363718DF6__GUID-DBDBCC92-551C-47DE-9577-37078DFC028F">
                        <p class="notep1">Note:</p>
                        <p>The configuration file is always read from the <code class="codeph">CLASSPATH</code>. For example, if you specify a custom configuration parameter file named <code class="codeph">MyConfigFile.xml</code>, then the XSQL processor attempts to read the XML file as a resource from the <code class="codeph">CLASSPATH</code>. In a servlet environment like Java Platform, Enterprise Edition (Java EE), you must place your <code class="codeph">MyConfigFile.xml</code> in the <code class="codeph">.\WEB-INF\classes</code> directory (or another top-level directory on the <code class="codeph">CLASSPATH</code>). If both the servlet initialization parameter and the <code class="codeph">System</code> parameter are provided, then the servlet initialization parameter value is used.
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADXDK1027"></a><a id="ADXDK19643"></a><div class="props_rev_3"><a id="GUID-3C0CC5DB-60EB-4093-996C-E0E0463401D1" name="GUID-3C0CC5DB-60EB-4093-996C-E0E0463401D1"></a><h3 id="ADXDK-GUID-3C0CC5DB-60EB-4093-996C-E0E0463401D1" class="sect3">Controlling How Stylesheets Are Processed</h3>
               <div>
                  <p>Topics here include an overview of client stylesheets, controlling content type, assigning stylesheets dynamically, processing stylesheets in a client, and providing multiple stylesheets.</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19644"></a><div class="props_rev_3"><a id="GUID-EE8B7B0D-B5E4-4B95-9CBB-7B7C4D747980" name="GUID-EE8B7B0D-B5E4-4B95-9CBB-7B7C4D747980"></a><h4 id="ADXDK-GUID-EE8B7B0D-B5E4-4B95-9CBB-7B7C4D747980" class="sect4">Overriding Client Stylesheets</h4>
                  <div>
                     <p>If the current XSQL page being requested allows it, you can supply an Extensible Stylesheet Language Transformation (XSLT) stylesheet URL in the request. This technique lets you override the default stylesheet or apply a stylesheet where none is applied by default. </p>
                     <div class="section">
                        <p>The client-initiated stylesheet URL is provided by supplying the <code class="codeph">xml-stylesheet</code> parameter as part of the request. The valid values for this parameter are:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Any relative URL interpreted relative to the XSQL page being processed.</p>
                           </li>
                           <li>
                              <p>Any absolute URL that uses the HTTP protocol scheme, provided it references a trusted host as defined in the XSQL configuration file.</p>
                           </li>
                           <li>
                              <p>The literal value <code class="codeph">none</code>. Setting <code class="codeph">xml-stylesheet=none</code> is useful during development to temporarily "short-circuit" the XSLT stylesheet processing to determine what XML datagram your stylesheet is seeing. Use this technique to determine why a stylesheet is not producing expected results.
                              </p>
                           </li>
                        </ul>
                        <p>You can allow client override of stylesheets for an XSQL page in these ways:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Setting the <code class="codeph">allow-client-style</code> configuration parameter to <code class="codeph">no</code> in the XSQL configuration file
                              </p>
                           </li>
                           <li>
                              <p>Explicitly including an <code class="codeph">allow-client-style="no"</code> attribute on the document element of any XSQL page
                              </p>
                           </li>
                        </ul>
                        <p>If client-override of stylesheets has been globally disabled by default in the XSQL configuration file, any page can still enable client-override explicitly by including an <code class="codeph">allow-client-style="yes"</code> attribute on the document element of that page.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19646"></a><a id="ADXDK19645"></a><div class="props_rev_3"><a id="GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B" name="GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B"></a><h4 id="ADXDK-GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B" class="sect4">Controlling the Content Type of the Returned Document</h4>
                  <div>
                     <p>Setting the content type of the data you serve lets a requesting client correctly interpret the data you return. If your stylesheet uses an <code class="codeph">&lt;xsl:output&gt;</code> element then the XSQL processor infers the media type and the encoding of the returned document from the <code class="codeph">media-type</code> and <code class="codeph">encoding</code> attributes of <code class="codeph">&lt;xsl:output&gt;</code>.
                     </p>
                     <div class="section">
                        <p>The stylesheet in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B__BABGFJAC">Example 25-1</a> uses the <code class="codeph">media-type="application/vnd.ms-excel"</code> attribute on <code class="codeph">&lt;xsl:output&gt;</code>. This instruction transforms the results of an XSQL page containing a standard query of the <code class="codeph">hr.employees</code> table into Microsoft Excel format.
                        </p>
                        <p>The following XSQL page uses the stylesheet in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B__BABGFJAC">Example 25-1</a>:
                        </p><pre class="oac_no_warn" dir="ltr">&lt;?xml version="1.0"?&gt;
&lt;?xml-stylesheet href="empToExcel.xsl" type="text/xsl"?&gt;
<span class="bold">&lt;xsql:query connection="hr" xmlns:xsql="urn:oracle-xsql"&gt;</span>
  SELECT   employee_id, email, salary 
  FROM     employees 
  ORDER BY salary DESC
&lt;/xsql:query&gt;</pre></div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-92BEFB8C-8AB0-4B03-80FE-C1C18B88310B__BABGFJAC">
                        <p class="titleinexample">Example 25-1 empToExcel.xsl</p><pre class="oac_no_warn" dir="ltr">&lt;?xml version="1.0"?&gt;
&lt;xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;
  &lt;xsl:output method="html" media-type="application/vnd.ms-excel"/&gt;
  &lt;xsl:template match="/"&gt;
   &lt;html&gt;
     &lt;table&gt;
       &lt;tr&gt;&lt;th&gt;Id&lt;/th&gt;&lt;th&gt;Email&lt;/th&gt;&lt;th&gt;Salary&lt;/th&gt;&lt;/tr&gt;
       &lt;xsl:for-each select="ROWSET/ROW"&gt;
         &lt;tr&gt;
           &lt;td&gt;&lt;xsl:value-of select="EMPLOYEE_ID"/&gt;&lt;/td&gt;
           &lt;td&gt;&lt;xsl:value-of select="EMAIL"/&gt;&lt;/td&gt;
           &lt;td&gt;&lt;xsl:value-of select="SALARY"/&gt;&lt;/td&gt;
         &lt;/tr&gt;
       &lt;/xsl:for-each&gt;
     &lt;/table&gt;
   &lt;/html&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19648"></a><a id="ADXDK19649"></a><a id="ADXDK19647"></a><div class="props_rev_3"><a id="GUID-61EA0E25-8824-4223-98C0-E839EAC130BA" name="GUID-61EA0E25-8824-4223-98C0-E839EAC130BA"></a><h4 id="ADXDK-GUID-61EA0E25-8824-4223-98C0-E839EAC130BA" class="sect4">Assigning the Stylesheet Dynamically</h4>
                  <div>
                     <p>If you include an <code class="codeph">&lt;?xml-stylesheet?&gt;</code> instruction at the top of your <code class="codeph">.xsql</code> file, then the XSQL page processor considers it for use in transforming the resulting XML datagram. 
                     </p>
                     <div class="section">
                        <p>Consider the <code class="codeph">emp_test.xsql</code> page shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-61EA0E25-8824-4223-98C0-E839EAC130BA__BABBEJCD">Example 25-2</a>.
                        </p>
                        <p>The page in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-61EA0E25-8824-4223-98C0-E839EAC130BA__BABBEJCD">Example 25-2</a> uses the <code class="codeph">emp.xsl</code> stylesheet to transform the results of the <code class="codeph">employees</code> query in the server tier before returning the response to the requester. The processor accesses the stylesheet by the URL provided in the <code class="codeph">href</code> pseudo-attribute on the <code class="codeph">&lt;?xml-stylesheet?&gt;</code> processing instruction.
                        </p>
                        <p>For example, to change XSLT stylesheets dynamically based on arguments passed to the XSQL servlet, you can use a lexical parameter in the <code class="codeph">href</code> attribute of your <code class="codeph">xml-stylesheet</code> processing instruction, as shown in this sample instruction:
                        </p><pre class="oac_no_warn" dir="ltr">&lt;?xml-stylesheet type="text/xsl" <span class="bold">href="{@filename}.xsl</span>"?&gt;
</pre><p>You can then pass the value of the <code class="codeph">filename</code> parameter as part of the URL request to XSQL servlet.
                        </p>
                        <p>You can also use the <a href="XSQL-pages-reference.html#GUID-002F1541-47DD-4C9B-A0D3-8F45A5D3A51F" title="Element <xsql:set-page-param&gt; is described.">&lt;xsql:set-page-param&gt;</a> element in an XSQL page to set the value of the parameter based on a SQL query. For example, the XSQL page in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-61EA0E25-8824-4223-98C0-E839EAC130BA__BABIEJED">Example 25-3</a> selects the name of the stylesheet to use from a table by assigning the value of a page-private parameter.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-61EA0E25-8824-4223-98C0-E839EAC130BA__BABBEJCD">
                        <p class="titleinexample">Example 25-2 emp_test.xsql</p><pre class="oac_no_warn" dir="ltr">&lt;?xml version="1.0"?&gt;
<span class="bold">&lt;?xml-stylesheet type="text/xsl" href="emp.xsl"?&gt;</span>
&lt;page connection="demo" xmlns:xsql="urn:oracle-xsql"&gt;
  &lt;xsql:query&gt;
    SELECT   * 
    FROM     employees
    ORDER BY salary DESC
  &lt;/xsql:query&gt;
&lt;/page&gt;
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-61EA0E25-8824-4223-98C0-E839EAC130BA__BABIEJED">
                        <p class="titleinexample">Example 25-3 emp_test_dynamic.xsql</p><pre class="oac_no_warn" dir="ltr">&lt;?xml version="1.0"?&gt;
&lt;?xml-stylesheet type="text/xsl" href="<span class="bold">{@sheet}</span>.xsl"?&gt;
&lt;page connection="demo" xmlns:xsql="urn:oracle-xsql"&gt;
  &lt;xsql:set-page-param bind-params="UserCookie" <span class="bold">name="sheet"</span>&gt;
    SELECT stylesheet_name
    FROM   user_prefs
    WHERE  username = ?
  &lt;/xsql:set-page-param&gt;
  &lt;xsql:query&gt;
    SELECT   * 
    FROM     employees 
    ORDER BY salary DESC
  &lt;/xsql:query&gt;
&lt;/page&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19650"></a><div class="props_rev_3"><a id="GUID-4CFA584A-4454-4E2A-A957-03BF39050E0C" name="GUID-4CFA584A-4454-4E2A-A957-03BF39050E0C"></a><h4 id="ADXDK-GUID-4CFA584A-4454-4E2A-A957-03BF39050E0C" class="sect4">Processing XSLT Stylesheets in the Client</h4>
                  <div>
                     <p>How to process XSLT stylesheets in the client is described.</p>
                     <div class="section">
                        <p>Some browsers support processing XSLT stylesheets in the client. These browsers recognize the stylesheet to be processed for an XML document by using an <code class="codeph">&lt;?xml-stylesheet?&gt;</code> processing instruction. The use of <code class="codeph">&lt;?xml-stylesheet?&gt;</code> for this purpose is part of the W3C Recommendation from June 29, 1999 entitled "Associating Stylesheets with XML Documents, Version 1.0".
                        </p>
                        <p>By default, the XSQL pages processor performs XSLT transformations in the server. By adding <code class="codeph">client="yes"</code> to your <code class="codeph">&lt;?xml-stylesheet?&gt;</code> processing instruction in your XSQL page, however, you can defer XSLT processing to the client. The processor serves the XML datagram "raw" with the current <code class="codeph">&lt;?xml-stylesheet?&gt;</code> element at the top of the document.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19653"></a><a id="ADXDK19652"></a><a id="ADXDK19651"></a><div class="props_rev_3"><a id="GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21" name="GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21"></a><h4 id="ADXDK-GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21" class="sect4">Providing Multiple Stylesheets</h4>
                  <div>
                     <p>You can include multiple <code class="codeph">&lt;?xml-stylesheet?&gt;</code> processing instructions at the top of an XSQL page.
                     </p>
                     <div class="section">
                        <p>The instructions can contain an optional <code class="codeph">media</code> pseudo-attribute. If specified, the processor case-insensitively compares the value of the <code class="codeph">media</code> pseudo-attribute with the value of the User-Agent string in the HTTP header. If the value of the <code class="codeph">media</code> pseudo-attribute matches part of the User-Agent string, then the processor selects the current <code class="codeph">&lt;?xml-stylesheet?&gt;</code> instruction for use. Otherwise, the processor ignores the instruction and continues looking. The processor uses the first matching processing instruction in document order. An instruction <span class="italic">without</span> a <code class="codeph">media</code> pseudo-attribute matches all user agents.
                        </p>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21__BABBBEBB">Example 25-4</a> shows multiple processing instructions at the top of an XSQL file. The processor uses <code class="codeph">doyouxml-lynx.xsl</code> for Lynx browsers, <code class="codeph">doyouxml-ie.xsl</code> for Internet Explorer 5.0 or 5.5 browsers, and <code class="codeph">doyouxml.xsl</code> for all others.
                        </p>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21__G1043042" title="This table summarizes the supported pseudo-attributes allowed on the <?xml-stylesheet?&gt; processing instruction. Attribute Name and Description are the columns.">Table 25-1</a> summarizes the supported pseudo-attributes allowed on the <code class="codeph">&lt;?xml-stylesheet?&gt;</code> processing instruction.
                        </p>
                        <div class="tblformalwide" id="GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21__G1043042">
                           <p class="titleintable">Table 25-1 Pseudo-Attributes for &lt;?xml-stylesheet ?&gt; </p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="Pseudo-Attributes for <?xml-stylesheet ?&gt; " summary="This table summarizes the supported pseudo-attributes allowed on the <?xml-stylesheet?&gt; processing instruction. Attribute Name and Description are the columns." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="23%" id="d104050e980">Attribute Name</th>
                                    <th align="left" valign="bottom" width="77%" id="d104050e983"> Description </th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d104050e988" headers="d104050e980 "><pre class="oac_no_warn" dir="ltr">type = "string"</pre></td>
                                    <td align="left" valign="top" width="77%" headers="d104050e988 d104050e983 ">
                                       <p>Indicates the Multipurpose Internet Mail Extensions (MIME) type of the associated stylesheet. For XSLT stylesheets, this attribute must be set to the string <code class="codeph">text/xsl</code>.
                                       </p>
                                       <p>This attribute may be present <span class="italic">or</span> absent when using the <code class="codeph">serializer</code> attribute, depending on whether an XSLT stylesheet must execute before invoking the serializer, or not.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d104050e1006" headers="d104050e980 "><pre class="oac_no_warn" dir="ltr">href = "URL"</pre></td>
                                    <td align="left" valign="top" width="77%" headers="d104050e1006 d104050e983 ">
                                       <p>Indicates the relative or absolute URL to the XSLT stylesheet to be used. If an absolute URL is supplied that uses the <code class="codeph">http</code> protocol scheme, the IP address of the resource must be a trusted host listed in the XSQL configuration file (by default, named <code class="codeph">XSQLConfig.xml</code>). 
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d104050e1019" headers="d104050e980 "><pre class="oac_no_warn" dir="ltr">media = "string"</pre></td>
                                    <td align="left" valign="top" width="77%" headers="d104050e1019 d104050e983 ">
                                       <p>Performs a case-<span class="italic">insensitive</span> match on the <code class="codeph">User-Agent</code> string from the HTTP header sent by the requesting device. This attribute is optional. The current <code class="codeph">&lt;?xml-stylesheet?&gt;</code> processing instruction is used only if the <code class="codeph">User-Agent</code> string contains the value of the <code class="codeph">media</code> attribute; otherwise it is ignored.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d104050e1041" headers="d104050e980 "><pre class="oac_no_warn" dir="ltr">client = "boolean"</pre></td>
                                    <td align="left" valign="top" width="77%" headers="d104050e1041 d104050e983 ">
                                       <p>Defers the processing of the associated XSLT stylesheet to the client if set to <code class="codeph">yes</code>. The raw XML datagram is sent to the client with the current <code class="codeph">&lt;?xml-stylesheet?&gt;</code> instruction at the top of the document. The default if not specified is to perform the transformation in the server.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d104050e1054" headers="d104050e980 "><pre class="oac_no_warn" dir="ltr">serializer = "string"</pre></td>
                                    <td align="left" valign="top" width="77%" headers="d104050e1054 d104050e983 ">
                                       <p>By default, the XSQL page processor uses:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>XML Document Object Model (DOM) serializer if no XSLT stylesheet is used</p>
                                          </li>
                                          <li>
                                             <p>XSLT processor serializer if an XSLT stylesheet is used</p>
                                          </li>
                                       </ul>
                                       <p>Specifying this pseudo-attribute indicates that a custom serializer implementation must be used instead. </p>
                                       <p>Valid values are either the name of a custom serializer defined in the <code class="codeph">&lt;serializerdefs&gt;</code> section of the XSQL configuration file or the string <code class="codeph">java:fully.qualified.Classname</code>. If both an XSLT stylesheet and the serializer attribute are present, then the processor performs the XSLT transformation first, then invokes the custom serializer to render the final result to the <code class="codeph">OutputStream</code> or <code class="codeph">PrintWriter</code>.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-5DC69499-8476-48C7-9368-7AFA8D92EF21__BABBBEBB">
                        <p class="titleinexample">Example 25-4 Multiple &lt;?xml-stylesheet ?&gt; Processing Instructions</p><pre class="oac_no_warn" dir="ltr">&lt;?xml version="1.0"?&gt;
&lt;?xml-stylesheet type="text/xsl" media="lynx" href="doyouxml-lynx.xsl" ?&gt;
&lt;?xml-stylesheet type="text/xsl" media="msie 5" href="doyouxml-ie.xsl" ?&gt;
&lt;?xml-stylesheet type="text/xsl" href="doyouxml.xsl" ?&gt;
&lt;page xmlns:xsql="urn:oracle-xsql" connection="demo"&gt;
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK1028"></a><a id="ADXDK19654"></a><div class="props_rev_3"><a id="GUID-9AE06DA9-6F80-4182-896A-DA902ADC57D1" name="GUID-9AE06DA9-6F80-4182-896A-DA902ADC57D1"></a><h3 id="ADXDK-GUID-9AE06DA9-6F80-4182-896A-DA902ADC57D1" class="sect3">Working with Array-Valued Parameters</h3>
               <div>
                  <p>Topics here include using array values for parameters, including page or session parameters and parameters in SQL or PL/SQL code</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19656"></a><a id="ADXDK19655"></a><div class="props_rev_3"><a id="GUID-26DC324B-D279-4894-BF15-61CF8137522C" name="GUID-26DC324B-D279-4894-BF15-61CF8137522C"></a><h4 id="ADXDK-GUID-26DC324B-D279-4894-BF15-61CF8137522C" class="sect4">Supplying Values for Array-Valued Parameters</h4>
                  <div>
                     <p>Request parameters, session parameters, and page-private parameters can have arrays of strings as values. To treat to the value of a parameter as an array, add two empty square brackets to the end of its name. </p>
                     <div class="section">
                        <p>For example, if an HTML form is posted with four occurrences of a input control named <code class="codeph">productid</code>, then use the notation <code class="codeph">productid[]</code> to refer to the array-valued <code class="codeph">productid</code> parameter. If you refer to an array-valued parameter without using the array-brackets notation, then the XSQL processor uses the value of the first array entry.
                        </p>
                        <div class="infoboxnote" id="GUID-26DC324B-D279-4894-BF15-61CF8137522C__GUID-FA0D55C1-1240-4918-862E-924EAA476063">
                           <p class="notep1">Note:</p>
                           <p>The XSQL processor does not support use of numbers inside the array brackets. That is, you can refer to <code class="codeph">productid</code> or <code class="codeph">productid[]</code>, but not <code class="codeph">productid[2]</code>.
                           </p>
                        </div>
                        <p>Suppose that you refer to an array-valued parameter as a lexical substitution parameter inside an action handler attribute value or inside the content of an action handler element. The XSQL page processor converts its value to a comma-delimited list of non-null and nonempty strings in the order that they exist in the array. <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-26DC324B-D279-4894-BF15-61CF8137522C__BABEGJHI">Example 25-5</a> shows an XSQL page with an array-valued parameter.
                        </p>
                        <p>You can invoke the XSQL command-line utility to supply multiple values for the <code class="codeph">productid</code> parameter in <code class="codeph">Page.xsql</code>:
                        </p><pre class="oac_no_warn" dir="ltr">xsql Page.xsql productid=111 productid=222 productid=333 productid=444
</pre><p>The preceding command sets the <code class="codeph">productid[]</code> array-valued parameter to the value {"<code class="codeph">111</code>","<code class="codeph">222</code>","<code class="codeph">333</code>","<code class="codeph">444</code>"}. The XSQL page processor replaces the <code class="codeph">{@productid[]}</code> expression in the query with the string "111,222,333,444". 
                        </p>
                        <p>You can also pass multivalued parameters programmatically through the <code class="codeph">XSQLRequest</code> application programming interface (API), which accepts a <code class="codeph">java.util.Dictionary</code> of named parameters. You can use a <code class="codeph">Hashtable</code> and invoke its <code class="codeph">put(name,value)</code> method to add <code class="codeph">String</code>-valued parameters to the request. To add multivalued parameters, put a value of type <code class="codeph">String[]</code> instead of type <code class="codeph">String</code>.
                        </p>
                        <div class="infoboxnote" id="GUID-26DC324B-D279-4894-BF15-61CF8137522C__GUID-7FF8435E-0F70-4262-9E5D-33283B9601FC">
                           <p class="notep1">Note:</p>
                           <p>Only request parameters, page-private parameters, and session parameters can use string arrays. The <a href="XSQL-pages-reference.html#GUID-69D0F80D-6C91-458B-B19A-41E2FD4F3400" title="Element <xsql:set-stylesheet-param&gt; is described.">&lt;xsql:set-stylesheet-param&gt;</a> and <a href="XSQL-pages-reference.html#GUID-AAD3692A-5322-4167-9F20-0BEB81413765" title="Element <xsql:set-cookie&gt; is described.">&lt;xsql:set-cookie&gt;</a> actions support only working with parameters as simple string values. To refer to a multivalued parameter in your XSLT stylesheet, use <a href="XSQL-pages-reference.html#GUID-7E25FEC6-00BE-4CDB-8841-35B4FF82D4AC" title="Element <xsql:include-param&gt; is described.">&lt;xsql:include-param&gt;</a> to include the multivalued parameter into your XSQL datapage, then use an XPath expression in the stylesheet to refer to the values from the datapage.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-26DC324B-D279-4894-BF15-61CF8137522C__BABEGJHI">
                        <p class="titleinexample">Example 25-5 Using an Array-Valued Parameter in an XSQL Page</p><pre class="oac_no_warn" dir="ltr">&lt;page xmlns:xsql="urn:oracle-xsql"&gt;
  &lt;xsql:query&gt;
    SELECT description
    FROM product
    WHERE productid in ( {@productid[]} )  /* Using lexical parameter */
  &lt;/xsql:query&gt;
&lt;/page&gt;
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19657"></a><div class="props_rev_3"><a id="GUID-942C03B8-1201-44CA-94A5-A23AC1B17960" name="GUID-942C03B8-1201-44CA-94A5-A23AC1B17960"></a><h4 id="ADXDK-GUID-942C03B8-1201-44CA-94A5-A23AC1B17960" class="sect4">Setting Array-Valued Page or Session Parameters from Strings</h4>
                  <div>
                     <p>You can set the value of a page-private parameter or a session parameter from strings.</p>
                     <div class="section">
                        <p>You can set the value of a page-private parameter to a string-array value by using array brackets notation on the name:</p><pre class="oac_no_warn" dir="ltr">&lt;!-- param name contains array brackets --&gt;
&lt;xsql:set-page-param name="names[]" value="Tom Jane Joe"/&gt;
</pre><p>You set the value similarly for session parameters, as shown in this example:</p><pre class="oac_no_warn" dir="ltr">&lt;xsql:set-session-param name="dates[]" value="12-APR-1962 15-JUL-1968"/&gt;
</pre><p>By default, when the name of the parameter uses array brackets, the XSQL processor treats the value as a space-or-comma-delimited list and tokenizes it. </p>
                        <p>The resulting string array value contains these separate tokens. In the preceding examples, parameter <code class="codeph">names[]</code> is the string array {"<code class="codeph">Tom</code>", "<code class="codeph">Jane</code>", "<code class="codeph">Joe</code>"} and parameter <code class="codeph">dates[]</code> is the string array {"<code class="codeph">12-APR-1962</code>", "<code class="codeph">15-JUL-1968</code>"}.
                        </p>
                        <p>To handle strings that contain spaces, the tokenization algorithm first checks the string for the presence of commas. If at least one comma is found in the string, then commas are used as the token delimiter. For example, this action sets the value of the <code class="codeph">names[]</code> parameter to the string array {"<code class="codeph">Tom Jones</code>", "<code class="codeph">Jane York</code>"}:
                        </p><pre class="oac_no_warn" dir="ltr">&lt;!-- param name contains array brackets --&gt;
&lt;xsql:set-page-param name="names[]" value="Tom Jones,Jane York"/&gt;
</pre><p>By default, when you set a parameter whose name does not end with the array-brackets, then the string-tokenization does not occur. Thus, this action sets the parameter <code class="codeph">names</code> to the literal string "<code class="codeph">Tom Jones,Jane York</code>":
                        </p><pre class="oac_no_warn" dir="ltr">&lt;!-- param name does NOT contain array brackets --&gt;
&lt;xsql:set-page-param name="names" value="Tom Jones,Jane York"/&gt;
</pre><p>You can force the string to be tokenized by including the <code class="codeph">treat-list-as-array="yes"</code> attribute on the <a href="XSQL-pages-reference.html#GUID-002F1541-47DD-4C9B-A0D3-8F45A5D3A51F" title="Element <xsql:set-page-param&gt; is described.">&lt;xsql:set-page-param&gt;</a> or <a href="XSQL-pages-reference.html#GUID-95912581-8779-4BF5-8B48-7BD49919AFE5" title="Element <xsql:set-session-param&gt; is described.">&lt;xsql:set-session-param&gt;</a> actions. When this attribute is set, the XSQL processor assigns a comma-delimited string of the tokenized values to the parameter. For example, this action sets the <code class="codeph">names</code> parameter to the literal string "<code class="codeph">Tom,Jane,Joe</code>":
                        </p><pre class="oac_no_warn" dir="ltr">&lt;!-- param name does NOT contain array brackets --&gt;
&lt;xsql:set-page-param name="names" value="Tom Jane Joe"
                     treat-list-as-array="yes"/&gt;
</pre><p>When you are setting the value of a simple string-valued parameter and you are tokenizing the value with <code class="codeph">treat-list-as-array="yes"</code>, you can include the <code class="codeph">quote-array-values="yes"</code> attribute to surround the comma-delimited values with single quotation marks. Thus, this action assigns the literal string value "<code class="codeph">'Tom Jones','Jane York','Jimmy'</code>" to the <code class="codeph">names</code> parameter:
                        </p><pre class="oac_no_warn" dir="ltr">&lt;!--  param name does NOT contain array brackets --&gt;
&lt;xsql:set-page-param name="names" value="Tom Jones,Jane York,Jimmy"
                     treat-list-as-array="yes"
                     quote-array-values="yes"/&gt;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19659"></a><a id="ADXDK19660"></a><a id="ADXDK19661"></a><a id="ADXDK19658"></a><div class="props_rev_3"><a id="GUID-81F6D961-7250-4527-82E3-E0100E399292" name="GUID-81F6D961-7250-4527-82E3-E0100E399292"></a><h4 id="ADXDK-GUID-81F6D961-7250-4527-82E3-E0100E399292" class="sect4">Binding Array-Valued Parameters in SQL and PL/SQL Statements</h4>
                  <div>
                     <p>Where string-valued scalar bind variables are supported in an XSQL page, you can also bind array-valued parameters. Use the array parameter name, for example, <code class="codeph">myparam[]</code>, in the list of parameter names that you supply for attribute <code class="codeph">bind-params</code>. This technique lets you process array-valued parameters in SQL statements and PL/SQL procedures.
                     </p>
                     <div class="section">
                        <p></p>
                        <p>The XSQL processor binds array-valued parameters as a nested table object type named <code class="codeph">XSQL_TABLE_OF_VARCHAR</code>. You must create this type in your current schema with this DDL statement:
                        </p><pre class="oac_no_warn" dir="ltr">CREATE TYPE xsql_table_of_varchar AS TABLE OF VARCHAR2(2000);
</pre><p>Although the type must have the name <code class="codeph">xsql_table_of_varchar</code>, you can change the dimension of the <code class="codeph">VARCHAR2</code> string, if necessary. You must make the dimension long enough for any string value you expect to handle in your array-valued string parameters.
                        </p>
                        <p>Consider the PL/SQL function shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABHBICE">Example 25-6</a>.
                        </p>
                        <p>The XSQL page in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">Example 25-7</a> shows how to bind two array-valued parameters in a SQL statement that uses <code class="codeph">testTableFunction</code>.
                        </p>
                        <p>Executing the XSQL page in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">Example 25-7</a> generates this datagram:
                        </p><pre class="oac_no_warn" dir="ltr">&lt;page someNames="aa,bb,cc" someValues="11,22,33"&gt;
  &lt;ROWSET&gt;
    &lt;ROW num="1"&gt;
      &lt;EXAMPLE&gt;aa=11:bb=22:cc=33&lt;/EXAMPLE&gt;
    &lt;/ROW&gt;
  &lt;/ROWSET&gt;
&lt;/page&gt;
</pre><p>This technique shows that the XSQL processor bound the array-valued <code class="codeph">someNames[]</code> and <code class="codeph">someValues[]</code> parameters as table collection types. It iterated over the values and concatenated them to produce the "<code class="codeph">aa=11:bb=22:cc=33</code>" string value as the return value of the PL/SQL function.
                        </p>
                        <p>You can mix any number of regular parameters and array-valued parameters in your bind-params string. Use the array-bracket notation for the parameters to be bound as arrays.</p>
                        <div class="infoboxnote" id="GUID-81F6D961-7250-4527-82E3-E0100E399292__GUID-871921D0-7228-4172-A515-197120A522FE">
                           <p class="notep1">Note:</p>
                           <p>If you run the page in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">Example 25-7</a> but you have not created the <code class="codeph">XSQL_TABLE_OF_VARCHAR</code> type as showd earlier, then you receive an error such as:
                           </p><pre class="oac_no_warn" dir="ltr">&lt;page someNames="aa,bb,cc" someValues="11,22,33"&gt;
  &lt;xsql-error code="17074" action="xsql:query"&gt;
    &lt;statement&gt;
     select testTableFunction(?,?) as example from dual
    &lt;/statement&gt;
    &lt;message&gt;
      invalid name pattern: SCOTT.XSQL_TABLE_OF_VARCHAR
    &lt;/message&gt;
  &lt;/xsql-error&gt;
&lt;/page&gt;</pre></div>
                        <p>Because the XSQL processor binds array parameters as nested table collection types, you can use the <code class="codeph">TABLE()</code> operator with the <code class="codeph">CAST()</code> operator in SQL to treat the nested table bind variable value as a table of values. You can then query this table. This technique is especially useful in subqueries. The page in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABJDBIB">Example 25-8</a> uses an array-valued parameter containing employee IDs to restrict the rows queried from <code class="codeph">hr.employees</code>.
                        </p>
                        <p>The XSQL page in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABJDBIB">Example 25-8</a> generates a datagram such as:
                        </p><pre class="oac_no_warn" dir="ltr">&lt;page&gt;
  &lt;ROWSET&gt;
    &lt;ROW num="1"&gt;
      &lt;NAME&gt;Alana Walsh&lt;/NAME&gt;
      &lt;SALARY&gt;3100&lt;/SALARY&gt;
    &lt;/ROW&gt;
    &lt;ROW num="2"&gt;
      &lt;NAME&gt;Kevin Feeny&lt;/NAME&gt;
      &lt;SALARY&gt;3000&lt;/SALARY&gt;
    &lt;/ROW&gt;
  &lt;/ROWSET&gt;
&lt;/page&gt;
</pre><p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">Example 25-7</a> and <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-81F6D961-7250-4527-82E3-E0100E399292__BABJDBIB">Example 25-8</a> show how to use <code class="codeph">bind-params</code> with <a href="XSQL-pages-reference.html#GUID-A54C8FC8-D81E-466F-8DE9-E425387A6563" title="Element <xsql:query&gt; is described.">&lt;xsql:query&gt;</a>, but these techniques work for <a href="XSQL-pages-reference.html#GUID-B44BC32C-50EF-480F-834E-062BD5AE4866" title="Element <xsql:dml&gt; is described.">&lt;xsql:dml&gt;</a>, <a href="XSQL-pages-reference.html#GUID-7F7A66D1-BFBB-402A-A2DD-C2A98349CAA7" title="Element <xsql:include-owa&gt; is described.">&lt;xsql:include-owa&gt;</a>, <a href="XSQL-pages-reference.html#GUID-0E5978EA-0322-45EC-8B22-EA0F3C41D9B8" title="Element <xsql:ref-cursor-function&gt; is described.">&lt;xsql:ref-cursor-function&gt;</a>, and other actions that accept SQL or PL/SQL statements. 
                        </p>
                        <p>PL/SQL index-by tables work with the OCI JDBC driver but not the JDBC thin driver. By using the nested table collection type <code class="codeph">XSQL_TABLE_OF_VARCHAR</code>, you can use array-valued parameters with either driver. In this way you avoid losing the programming flexibility of working with array values in PL/SQL.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-81F6D961-7250-4527-82E3-E0100E399292__BABHBICE">
                        <p class="titleinexample">Example 25-6 testTableFunction</p><pre class="oac_no_warn" dir="ltr">FUNCTION testTableFunction(p_name  XSQL_TABLE_OF_VARCHAR,
                           p_value XSQL_TABLE_OF_VARCHAR)
RETURN VARCHAR2 IS
  lv_ret     VARCHAR2(4000);
  lv_numElts INTEGER;
BEGIN
  IF p_name IS NOT NULL THEN
    lv_numElts := p_name.COUNT;
    FOR j IN 1..lv_numElts LOOP
      IF (j &gt; 1) THEN
        lv_ret := lv_ret||':';
      END IF;
      lv_ret := lv_ret||p_name(j)||'='||p_value(j);
    END LOOP;
  END IF;
  RETURN lv_ret;
END;
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-81F6D961-7250-4527-82E3-E0100E399292__BABFJGDH">
                        <p class="titleinexample">Example 25-7 XSQL Page with Array-Valued Parameters</p><pre class="oac_no_warn" dir="ltr">&lt;page xmlns:xsql="urn:oracle-xsql" connection="demo"
      someNames="aa,bb,cc" someValues="11,22,33"&gt;
  &lt;xsql:query bind-params="someNames[] someValues[]"&gt;
    SELECT testTableFunction(?,?) AS example 
    FROM dual
  &lt;/xsql:query&gt;
&lt;/page&gt;
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-81F6D961-7250-4527-82E3-E0100E399292__BABJDBIB">
                        <p class="titleinexample">Example 25-8 Using an Array-Valued Parameter to Restrict Rows</p><pre class="oac_no_warn" dir="ltr">&lt;page xmlns:xsql="urn:oracle-xsql" connection="hr"&gt;
  &lt;xsql:set-page-param name="someEmployees[]" value="196,197"/&gt;
  &lt;xsql:query bind-params="someEmployees[]"&gt;
    SELECT first_name||' '||last_name AS name, salary
    FROM employees
    WHERE employee_id IN (
        SELECT * FROM TABLE(CAST( ? AS xsql_table_of_varchar))
     )
   &lt;/xsql:query&gt;
&lt;/page&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK19663"></a><a id="ADXDK19662"></a><div class="props_rev_3"><a id="GUID-399504CA-5039-4004-9500-EBAF0A516928" name="GUID-399504CA-5039-4004-9500-EBAF0A516928"></a><h3 id="ADXDK-GUID-399504CA-5039-4004-9500-EBAF0A516928" class="sect3">Setting Error Parameters on Built-In Actions</h3>
               <div>
                  <p>You can set a page-private parameter on a built-in XSQL action when the action reports a nonfatal error.</p>
                  <div class="section">
                     <p>The XSQL page processor determines whether an action encountered a nonfatal error during its execution. For example, an attempt to insert a row or invoke a stored procedure can fail with a database exception that gets included in your XSQL data page as an<code class="codeph"> &lt;xsql-error&gt;</code> element.
                     </p>
                     <p>Use attribute <code class="codeph">error-param</code> on the action to set a page-private parameter on a built-in XSQL action when the action reports a nonfatal error. For example, to set parameter <code class="codeph">dml-error</code> when the statement inside action <a href="XSQL-pages-reference.html#GUID-B44BC32C-50EF-480F-834E-062BD5AE4866" title="Element <xsql:dml&gt; is described.">&lt;xsql:dml&gt;</a> encounters a database error, you can use the technique shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-399504CA-5039-4004-9500-EBAF0A516928__BABFDBEB">Example 25-9</a>.
                     </p>
                     <p>If the execution of action <code class="codeph">&lt;xsql:dml&gt;</code> encounters an error then the XSQL processor sets the page-private parameter <code class="codeph">dml-error</code> to the string <code class="codeph">"Error"</code>. If the execution is successful then the XSQL processor does not assign a value to the error parameter. In <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-399504CA-5039-4004-9500-EBAF0A516928__BABFDBEB">Example 25-9</a>, if the page-private parameter <code class="codeph">dml-error</code> already exists then it retains its current value. If it does not exist then it continues not to exist.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-399504CA-5039-4004-9500-EBAF0A516928__BABFDBEB">
                     <p class="titleinexample">Example 25-9 Setting an Error Parameter</p><pre class="pre codeblock"><code>&lt;xsql:dml error-param="dml-error" bind-params="val"&gt;
  INSERT INTO yourtable(somecol) 
    VALUES(?)
&lt;/xsql:dml&gt;
</code></pre></div>
                  <!-- class="example" -->
               </div><a id="ADXDK19665"></a><a id="ADXDK19664"></a><div class="props_rev_3"><a id="GUID-12DFFF06-F092-4FFB-8EF1-AA3B3C0D6255" name="GUID-12DFFF06-F092-4FFB-8EF1-AA3B3C0D6255"></a><h4 id="ADXDK-GUID-12DFFF06-F092-4FFB-8EF1-AA3B3C0D6255" class="sect4">Using Conditional Logic with Error Parameters </h4>
                  <div>
                     <p>How to get conditional behavior in your XSQL page template is described.</p>
                     <div class="section">
                        <p>By using the error parameter in combination with <a href="XSQL-pages-reference.html#GUID-7B3A4D36-BB66-4FB0-85F9-33BC84CE6613" title="Element <xsql:if-param&gt; is described.">&lt;xsql:if-param&gt;</a>, you can achieve conditional behavior in your XSQL page template. For example, assume that your connection definition sets the <code class="codeph">AUTOCOMMIT</code> flag to <code class="codeph">false</code> on the connection named <code class="codeph">demo</code> in the XSQL configuration file. The XSQL page shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-12DFFF06-F092-4FFB-8EF1-AA3B3C0D6255__BABJGFFA">Example 25-10</a> shows how you might roll back the changes made by a previous action if a subsequent action encounters an error.
                        </p>
                        <p>If you have written custom action handlers, and if your custom actions invoke <code class="codeph">reportMissingAttribute()</code>, <code class="codeph">reportError()</code>, or <code class="codeph">reportErrorIncludingStatement()</code> to report nonfatal action errors, then they automatically pick up this feature as well.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-12DFFF06-F092-4FFB-8EF1-AA3B3C0D6255__BABJGFFA">
                        <p class="titleinexample">Example 25-10 Achieving Conditional Behavior with an Error Parameter</p><pre class="pre codeblock"><code>&lt;!-- NOTE: Connection "demo" must not set to autocommit! --&gt;
&lt;page connection="demo" xmlns:xsql="urn:oracle-xsql"&gt;
  &lt;xsql:dml error-param="dml-error" bind-params="val"&gt;
    INSERT INTO yourtable(somecol) 
      VALUES(?)
  &lt;/xsql:dml&gt;
  &lt;!-- This second statement will commit if it succeeds --&gt;
  &lt;xsql:dml commit="yes" error-param="dml-error" bind-params="val2"&gt;
    INSERT INTO anothertable(anothercol)
      VALUES(?)
  &lt;/xsql:dml&gt;
  &lt;xsql:if-param name="dml-error" exists="yes"&gt;
    &lt;xsql:dml&gt;
      ROLLBACK
    &lt;/xsql:dml&gt;
  &lt;/xsql:if-param&gt;
&lt;/page&gt;
</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19667"></a><a id="ADXDK19666"></a><div class="props_rev_3"><a id="GUID-52292147-F1A3-4C5D-942A-41CBDAC5499D" name="GUID-52292147-F1A3-4C5D-942A-41CBDAC5499D"></a><h4 id="ADXDK-GUID-52292147-F1A3-4C5D-942A-41CBDAC5499D" class="sect4">Formatting XSQL Action Handler Errors</h4>
                  <div>
                     <p>Errors raised by the processing of XSQL action elements are reported as XML elements in a uniform way. This fact enables XSLT stylesheets to detect their presence and optionally format them for presentation.</p>
                     <div class="section">
                        <p></p>
                        <p>The action element in error is replaced in the page by this element:</p><pre class="oac_no_warn" dir="ltr">&lt;xsql-error action="xxx"&gt; 
</pre><p>Depending on the error the <code class="codeph">&lt;xsql-error&gt;</code> element contains:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A nested <code class="codeph">&lt;message&gt;</code> element 
                              </p>
                           </li>
                           <li>
                              <p>A <code class="codeph">&lt;statement&gt;</code> element with the offending SQL statement
                              </p>
                           </li>
                        </ul>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-52292147-F1A3-4C5D-942A-41CBDAC5499D__BABDCABJ">Example 25-11</a> shows an XSLT stylesheet that uses this information to display error information on the screen.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-52292147-F1A3-4C5D-942A-41CBDAC5499D__BABDCABJ">
                        <p class="titleinexample">Example 25-11 XSLT Stylesheet</p><pre class="oac_no_warn" dir="ltr">&lt;xsl:if test="//xsql-error"&gt;
     &lt;table style="background:yellow"&gt;
        &lt;xsl:for-each select="//xsql-error"&gt;
           &lt;tr&gt;
            &lt;td&gt;&lt;b&gt;Action&lt;/b&gt;&lt;/td&gt;
            &lt;td&gt;&lt;xsl:value-of select="@action"/&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr valign="top"&gt;
            &lt;td&gt;&lt;b&gt;Message&lt;/b&gt;&lt;/td&gt;
            &lt;td&gt;&lt;xsl:value-of select="message"/&gt;&lt;/td&gt;
           &lt;/tr&gt;
          &lt;/xsl:for-each&gt;
     &lt;/table&gt;
&lt;/xsl:if&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK19669"></a><a id="ADXDK19670"></a><a id="ADXDK19671"></a><a id="ADXDK19672"></a><a id="ADXDK19673"></a><a id="ADXDK19668"></a><div class="props_rev_3"><a id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B" name="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B"></a><h3 id="ADXDK-GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B" class="sect3">Including XMLType Query Results in XSQL Pages</h3>
               <div>
                  <p>Oracle Database supports <code class="codeph">XMLType</code> for storing and querying XML-based database content. 
                  </p>
                  <div class="section">
                     <p>You can exploit database XML features to produce XML data for inclusion in your XSQL pages by using one of these techniques:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-A54C8FC8-D81E-466F-8DE9-E425387A6563" title="Element <xsql:query&gt; is described.">&lt;xsql:query&gt;</a> handles any query including columns of type <code class="codeph">XMLType</code>, but it handles XML markup in <code class="codeph">CLOB</code> and <code class="codeph">VARCHAR2</code> columns as literal text.
                           </p>
                        </li>
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-AE499EA9-A8C5-4274-98C6-8499ADF7ED55" title="Element <xsql:include-xml&gt; is described.">&lt;xsql:include-xml&gt;</a> parses and includes a single <code class="codeph">CLOB</code> or string-based XML document retrieved from a query.
                           </p>
                        </li>
                     </ul>
                     <p>One difference between the preceding approaches is that <code class="codeph">&lt;xsql:include-xml&gt;</code> parses the literal XML appearing in a CLOB or string value as needed to turn it into a tree of elements and attributes. In contrast, <code class="codeph">&lt;xsql:query&gt;</code> leaves XML markup in <code class="codeph">CLOB</code> or string-valued columns as literal text.
                     </p>
                     <p>Another difference is that while <code class="codeph">&lt;xsql:query&gt;</code> can handle query results of any number of columns and rows, <code class="codeph">&lt;xsql:include-xml&gt;</code> works on a single column of a single row. Accordingly, when using <code class="codeph">&lt;xsql:include-xml&gt;</code>, the <code class="codeph">SELECT</code> statement inside it returns a single row containing a single column. The column can either be a <code class="codeph">CLOB</code> or a <code class="codeph">VARCHAR2</code> value containing a well-formed XML document. The XSQL engine parses the XML document and includes it in your XSQL page.
                     </p>
                     <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABCEICG">Example 25-12</a> uses nested <code class="codeph">XmlAgg()</code> functions to aggregate the results of a dynamically-constructed XML document containing departments and nested employees. The functions aggregate the document into a single "result" document wrapped in a <code class="codeph">&lt;DepartmentList&gt;</code> element.
                     </p>
                     <p>In another example, suppose you have many <code class="codeph">&lt;Movie&gt;</code> XML documents stored in a table of <code class="codeph">XMLType</code> called <code class="codeph">movies.</code> Each document might look like the one shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABEGAFH">Example 25-13</a>.
                     </p>
                     <p>You can use the built-in XPath query features to extract an aggregate list of all cast members who have received Oscar awards from any movie in the database. <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABFHAFD">Example 25-14</a> shows a sample query.
                     </p>
                     <p>To include this query result of <code class="codeph">XMLType</code> in your XSQL page, paste the query inside an <code class="codeph">&lt;xsql:query&gt;</code> element. Make sure you include an alias for the query expression, as shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABBHBFF">Example 25-15</a>.
                     </p>
                     <p>You can use the combination of <code class="codeph">XmlElement()</code> and <code class="codeph">XmlAgg()</code> to make the database aggregate all of the XML fragments identified by the query into single, well-formed XML document. The functions work to produce a well-formed result like this:
                     </p><pre class="oac_no_warn" dir="ltr">&lt;AwardedActors&gt;
  &lt;Actor&gt;...&lt;/Actor&gt;
  &lt;Actress&gt;...&lt;/Actress&gt;
&lt;/AwardedActors&gt;
</pre><p>You can use the standard XSQL bind variable capabilities in the middle of an XPath expression if you concatenate the bind variable into the expression. For example, to parameterize the value <code class="codeph">Oscar</code> into a parameter named <code class="codeph">award-from</code>, you can use an XSQL page like the one shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABIEIIH">Example 25-16</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABCEICG">
                     <p class="titleinexample">Example 25-12 Aggregating a Dynamically-Constructed XML Document</p><pre class="oac_no_warn" dir="ltr">&lt;xsql:query connection="hr" xmlns:xsql="urn:oracle-xsql"&gt;
  SELECT XmlElement("DepartmentList",
           XmlAgg(
             XmlElement("Department", 
               XmlAttributes(department_id AS "Id"),
               XmlForest(department_name AS "Name"),
               (SELECT XmlElement("Employees",
                         XmlAgg( 
                           XmlElement("Employee",
                             XmlAttributes(employee_id AS "Id"),
                             XmlForest(first_name||' '||last_name AS "Name",
                                       salary   AS "Salary",
                                       job_id   AS "Job")
                           )
                         )
                       )
                FROM employees e 
                WHERE e.department_id = d.department_id
               )
             )
           )
         ) AS result
  FROM departments d
  ORDER BY department_name
&lt;/xsql:query&gt;
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABEGAFH">
                     <p class="titleinexample">Example 25-13 Movie XML Document</p><pre class="oac_no_warn" dir="ltr">&lt;Movie Title="The Talented Mr.Ripley" RunningTime="139" Rating="R"&gt;
  &lt;Director&gt;
    &lt;First&gt;Anthony&lt;/First&gt;
    &lt;Last&gt;Minghella&lt;/Last&gt;
  &lt;/Director&gt;
  &lt;Cast&gt;
    &lt;Actor Role="Tom Ripley"&gt;
      &lt;First&gt;Matt&lt;/First&gt;
      &lt;Last&gt;Damon&lt;/Last&gt;
    &lt;/Actor&gt;
    &lt;Actress Role="Marge Sherwood"&gt;
      &lt;First&gt;Gwyneth&lt;/First&gt;
      &lt;Last&gt;Paltrow&lt;/Last&gt;
    &lt;/Actress&gt;
    &lt;Actor Role="Dickie Greenleaf"&gt;
      &lt;First&gt;Jude&lt;/First&gt;
      &lt;Last&gt;Law&lt;/Last&gt;
      &lt;Award From="BAFTA" Category="Best Supporting Actor"/&gt;
    &lt;/Actor&gt;
  &lt;/Cast&gt;
&lt;/Movie&gt;
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABFHAFD">
                     <p class="titleinexample">Example 25-14 Using XPath to Extract an Aggregate List</p><pre class="oac_no_warn" dir="ltr">SELECT XMLELEMENT("AwardedActors",
           XMLAGG(EXTRACT(VALUE(m),
                  '/Movie/Cast/*[Award[@From="Oscar"]]')))
FROM movies m
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABBHBFF">
                     <p class="titleinexample">Example 25-15 Including an XMLType Query Result</p><pre class="oac_no_warn" dir="ltr">&lt;xsql:query connection="demo" xmlns:xsql="urn:oracle-xsql"&gt;
  SELECT XMLELEMENT("AwardedActors",
           XMLAGG(EXTRACT(VALUE(m),
                  '/Movie/Cast/*[Award[@From="Oscar"]]'))) AS result
  FROM movies m
&lt;/xsql:query&gt;
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-77A49187-C2FD-4799-A3C3-EB209BE75F8B__BABIEIIH">
                     <p class="titleinexample">Example 25-16 Using XSQL Bind Variables in an XPath Expression</p><pre class="oac_no_warn" dir="ltr">&lt;xsql:query connection="orcl92" xmlns:xsql="urn:oracle-xsql"
            award-from="Oscar"  bind-params="award-from"&gt;
  /* Using a bind variable in an XPath expression */
  SELECT XMLELEMENT("AwardedActors",
           XMLAGG(EXTRACT(VALUE(m),
                  '/Movie/Cast/*[Award[@From="'|| ? ||'"]]'))) AS result
  FROM movies m
&lt;/xsql:query&gt;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK19674"></a><div class="props_rev_3"><a id="GUID-4DCCB6F2-01D9-442A-BE70-D8EC70884D67" name="GUID-4DCCB6F2-01D9-442A-BE70-D8EC70884D67"></a><h3 id="ADXDK-GUID-4DCCB6F2-01D9-442A-BE70-D8EC70884D67" class="sect3">Handling Posted XML Content</h3>
               <div>
                  <p>In addition to simplifying the assembly and transformation of XML content, the XSQL pages framework helps you handle posted XML content. </p>
                  <div class="section">
                     <p>Built-in actions provide these advantages:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Simplify the handling of posted data from both XML document and HTML forms</p>
                        </li>
                        <li>
                           <p>Enable data to be posted directly into a database table by using XSU</p>
                        </li>
                     </ul>
                     <p>XSU can perform database inserts, updates, and deletes based on the content of an XML document in canonical form for a target table or view. For a specified table, the canonical XML form of its data is given by one row of XML output from a <code class="codeph">SELECT *</code> query. When given an XML document in this form, XSU can automate the DML operation.
                     </p>
                     <p>By combining XSU with XSLT, you can transform XML in any format into the canonical format expected by a given table. XSU can then perform DML on the resulting canonical XML.</p>
                     <p>The following built-in XSQL actions make it possible for you to exploit this capability from within your XSQL pages:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-A45E6112-F904-4665-959B-1AF39413E2F7" title="Element <xsql:insert-request&gt; is described.">&lt;xsql:insert-request&gt;</a></p>
                           <p>Insert the optionally transformed XML document that was posted in the request into a table.</p>
                        </li>
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-5514ECD7-5E7E-49D9-B52B-C8374404EC5B" title="Element <xsql:update-request&gt; is described.">&lt;xsql:update-request&gt;</a></p>
                           <p>Update the optionally transformed XML document that was posted in the request into a table or view.</p>
                        </li>
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-87E28D28-C22E-4468-BA26-3EE5801C14B4" title="Element <xsql:delete-request&gt; is described.">&lt;xsql:delete-request&gt;</a></p>
                           <p>Delete the optionally transformed XML document that was posted in the request from a table or view.</p>
                        </li>
                        <li>
                           <p><a href="XSQL-pages-reference.html#GUID-E21DCCD0-AE99-47FA-A5D5-DD064D6E74CB" title="Element <xsql:insert-param&gt; is described.">&lt;xsql:insert-param&gt;</a></p>
                           <p>Insert the optionally transformed XML document that was posted as the value of a request parameter into a table or view.</p>
                        </li>
                     </ul>
                     <p>If you target a database view with your insert, then you can create <code class="codeph">INSTEAD OF INSERT</code> triggers on the view to further automate the handling of the posted information. For example, an <code class="codeph">INSTEAD OF INSERT</code> trigger on a view can use PL/SQL to check for the existence of a record and intelligently choose whether to do an <code class="codeph">INSERT</code> or an <code class="codeph">UPDATE</code> depending on the result of this check.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19676"></a><a id="ADXDK19675"></a><div class="props_rev_3"><a id="GUID-56E150D2-3FE9-4ED4-A39B-9374B5CC4351" name="GUID-56E150D2-3FE9-4ED4-A39B-9374B5CC4351"></a><h4 id="ADXDK-GUID-56E150D2-3FE9-4ED4-A39B-9374B5CC4351" class="sect4">Understanding XML Posting Options</h4>
                  <div>
                     <p>An overview is provided of XML posting options.</p>
                     <p>The XSQL pages framework can handle posted data in these scenarios: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>A client program sends an HTTP <code class="codeph">POST</code> message that targets an XSQL page. The request body contains an XML document; the HTTP header reports a <code class="codeph">ContentType</code> of "<code class="codeph">text/xml</code>".
                           </p>
                           <p>In this case, <code class="codeph">&lt;xsql:insert-request&gt;</code>, <code class="codeph">&lt;xsql:update-request&gt;</code>, or <code class="codeph">&lt;xsql:delete-request&gt;</code> can insert, update, or delete the content of the posted XML in the target table. If you transform the posted XML with XSLT, then the posted document is the source for the transformation.
                           </p>
                        </li>
                        <li>
                           <p>A client program sends an HTTP <code class="codeph">GET</code> request for an XSQL page, one of whose parameters contains an XML document.
                           </p>
                           <p>In this case, you can use the <code class="codeph">&lt;xsql:insert-param&gt;</code> action to insert the content of the posted XML parameter value in the target table. If you transform the posted XML document with XSLT, then the XML document in the parameter value is the source document for this transformation.
                           </p>
                        </li>
                        <li>
                           <p>A browser submits an HTML form with <code class="codeph">method</code>=<code class="codeph">"POST"</code> whose action targets an XSQL page. The request body of the HTTP <code class="codeph">POST</code> message contains an encoded version of the form fields and values with a <code class="codeph">ContentType</code> of "<code class="codeph">application/x-www-form-urlencoded</code>".
                           </p>
                           <p>In this case, the request does not contain an XML document, but an encoded version of the form parameters. To make all three of these cases uniform, however, the XSQL page processor materializes on demand an XML document from the form parameters, session variables, and cookies contained in the request. The XSLT processor transforms this dynamically-materialized XML document into canonical form for DML by using <code class="codeph">&lt;xsql:insert&gt;</code>, <code class="codeph">&lt;xsql:update-request&gt;</code>, or <code class="codeph">&lt;xsql:delete-request&gt;</code>.
                           </p>
                        </li>
                     </ul>
                     <p>When working with posted HTML forms, the dynamically materialized XML document has the form shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-56E150D2-3FE9-4ED4-A39B-9374B5CC4351__BABBACHJ">Example 25-17</a>.
                     </p>
                     <p>If multiple parameters are posted with the same name, then the XSQL processor automatically creates multiple <code class="codeph">&lt;row&gt;</code> elements to make subsequent processing easier. Assume that a request posts or includes these parameters and values:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">id</code> = <code class="codeph">101</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">name</code> = <code class="codeph">Steve</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">id</code> = <code class="codeph">102</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">name</code> = <code class="codeph">Sita</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">operation</code> = <code class="codeph">update</code></p>
                        </li>
                     </ul>
                     <p>The XSQL page processor creates a set of parameters as follows:</p><pre class="oac_no_warn" dir="ltr">&lt;request&gt;
  &lt;parameters&gt;
    &lt;row&gt;
      &lt;id&gt;101&lt;/id&gt;
      &lt;name&gt;Steve&lt;/name&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;id&gt;102&lt;/id&gt;
      &lt;name&gt;Sita&lt;/name&gt;
    &lt;/row&gt;
    &lt;operation&gt;update&lt;/operation&gt;
  &lt;/parameters&gt;
  ...
&lt;/request&gt;
</pre><p>You must provide an XSLT stylesheet that transforms this materialized XML document containing the request parameters into canonical format for your target table. Thus, you can build an XSQL page:</p><pre class="oac_no_warn" dir="ltr">&lt;!-- 
 | ShowRequestDocument.xsql
 | Show Materialized XML Document for an HTML Form
 +--&gt;
&lt;xsql:include-request-params xmlns:xsql="urn:oracle-xsql"/&gt;
</pre><p>With this page in place, you can temporarily modify your HTML form to post to the <code class="codeph">ShowRequestDocument.xsql</code> page. In the browser you see the "raw" XML for the materialized XML request document, which you can save and use to develop the XSL transformation.
                     </p>
                     <div class="example" id="GUID-56E150D2-3FE9-4ED4-A39B-9374B5CC4351__BABBACHJ">
                        <p class="titleinexample">Example 25-17 XML Document Generated from HTML Form</p><pre class="oac_no_warn" dir="ltr">&lt;request&gt;
  &lt;parameters&gt;
    &lt;firstparamname&gt;firstparamvalue&lt;/firstparamname&gt;
     ... 
    &lt;lastparamname&gt;lastparamvalue&lt;/lastparamname&gt;
  &lt;/parameters&gt;
  &lt;session&gt;
    &lt;firstparamname&gt;firstsessionparamvalue&lt;/firstparamname&gt;
      ...
    &lt;lastparamname&gt;lastsessionparamvalue&lt;/lastparamname&gt;
  &lt;/session&gt;
  &lt;cookies&gt;
    &lt;firstcookie&gt;firstcookievalue&lt;/firstcookiename&gt;
       ... 
    &lt;lastcookie&gt;firstcookievalue&lt;/lastcookiename&gt;
  &lt;/cookies&gt;
&lt;/request&gt;
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADXDK19678"></a><a id="ADXDK19677"></a><div class="props_rev_3"><a id="GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17" name="GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17"></a><h3 id="ADXDK-GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17" class="sect3">Producing PDF Output with the FOP Serializer</h3>
               <div>
                  <p>Using the XSQL pages framework support for custom serializers, the <code class="codeph">oracle.xml.xsql.serializers.XSQLFOPSerializer</code> class provides integration with the Apache Formatting Objects Processor (FOP). The FOP processor renders a PDF document from an XML document containing XSL Formatting Objects.
                  </p>
                  <div class="section">
                     <p>As described in <a href="using-XSQL-pages-publishing-framework.html#GUID-2F3D4C05-7E99-4E7D-994B-09A15331D01B__CHECIJCH" title="This table lists the demo subdirectories and explains the included demos. Demonstration Name and Description are the columns.">Table 24-1</a>, the demo directory includes the <code class="codeph">emptablefo.xsl</code> stylesheet and <code class="codeph">emptable.xsql</code> page as illustrations. If you get an error trying to use the FOP serializer, then probably you do not have all of the required JAR files in the <code class="codeph">CLASSPATH</code>. The <code class="codeph">XSQLFOPSerializer</code> class resides in the separate <code class="codeph">xml.jar</code> file, which must be included in the <code class="codeph">CLASSPATH</code> to use the FOP integration. You must also add these additional Java archives to your <code class="codeph">CLASSPATH</code>:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">fop.jar</code>—from Apache, version 0.20.3 or later
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">batik.jar</code>—from the FOP distribution
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">avalon-framework-4.0.jar</code>—from FOP distribution
                           </p>
                        </li>
                        <li>
                           <p>l<code class="codeph">ogkit-1.0.jar</code>—from FOP distribution
                           </p>
                        </li>
                     </ul>
                     <p>In case you want to customize the implementation, the source code for the FOP serializer provided in this release is shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17__BABJCBHC">Example 25-18</a>.
                     </p>
                     <div class="infoboxnotealso" id="GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17__GUID-0563D88A-BF5B-442A-99A6-11A62938C015">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=apache_org_fop" target="_blank"><span class="italic">Apache FOP</span></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-AD1462CE-B917-48FF-B33A-37F0CA95AB17__BABJCBHC">
                     <p class="titleinexample">Example 25-18 Source Code for FOP Serializer</p><pre class="oac_no_warn" dir="ltr">package oracle.xml.xsql.serializers;
import org.w3c.dom.Document;
import org.apache.log.Logger;
import org.apache.log.Hierarchy;
import org.apache.fop.messaging.MessageHandler;
import org.apache.log.LogTarget;
import oracle.xml.xsql.XSQLPageRequest;
import oracle.xml.xsql.XSQLDocumentSerializer;
import org.apache.fop.apps.Driver;
import org.apache.log.output.NullOutputLogTarget;
/**
 * Tested with the FOP 0.20.3RC release from 19-Jan-2002
 */
public class XSQLFOPSerializer implements XSQLDocumentSerializer {
  private static final String PDFMIME = "application/pdf";
  public void serialize(Document doc, XSQLPageRequest env) throws Throwable {
    try { 
      // First make sure we can load the driver
      Driver FOPDriver = new Driver();
      // Tell FOP not to spit out any messages by default.
      // You can modify this code to create your own FOP Serializer
      // that logs the output to one of many different logger targets
      // using the Apache LogKit API
      Logger logger=Hierarchy.getDefaultHierarchy().getLoggerFor("XSQLServlet");
      logger.setLogTargets(new LogTarget[]{new NullOutputLogTarget()});
      FOPDriver.setLogger(logger);
      // Some of FOP's messages appear to still use MessageHandler.
      MessageHandler.setOutputMethod(MessageHandler.NONE);
      // Then set the content type before getting the reader
      env.setContentType(PDFMIME);
      FOPDriver.setOutputStream(env.getOutputStream());
      FOPDriver.setRenderer(FOPDriver.RENDER_PDF); FOPDriver.render(doc);
    }
    catch (Exception e) {
      // Cannot write PDF output for the error anyway.
      // So maybe this stack trace will be useful info
      e.printStackTrace(System.err);
    }
  }
}</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK1029"></a><a id="ADXDK19679"></a><div class="props_rev_3"><a id="GUID-D39E450F-9C2C-4240-A5E3-C5FCC4D57A42" name="GUID-D39E450F-9C2C-4240-A5E3-C5FCC4D57A42"></a><h3 id="ADXDK-GUID-D39E450F-9C2C-4240-A5E3-C5FCC4D57A42" class="sect3">Performing XSQL Customizations</h3>
               <div>
                  <p>XSQL customization topics are presented.</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19680"></a><div class="props_rev_3"><a id="GUID-26A83890-40B5-4D18-86A7-E72CCD97D2AC" name="GUID-26A83890-40B5-4D18-86A7-E72CCD97D2AC"></a><h4 id="ADXDK-GUID-26A83890-40B5-4D18-86A7-E72CCD97D2AC" class="sect4">Writing Custom XSQL Action Handlers</h4>
                  <div>
                     <p>The XSQL pages engine processes an XSQL page by looking for action elements from the <code class="codeph">xsql</code> namespace and invoking an appropriate action element handler class to process each action. The processor supports any action that implements the <code class="codeph">XSQLActionHandler</code> interface. All of the built-in actions implement this interface. 
                     </p>
                     <div class="section">
                        <p>When a task requires custom processing, and none of the built-in actions listed in <a href="XSQL-pages-reference.html#GUID-A87F53F2-87BB-4422-90EF-4032D97C54BE__BJEFBDGB" title="This table lists XSQL Configuration File Settings. Configuration Setting Name and Description are the columns.">Table 33-2</a> does exactly what you need, you can write your own actions.
                        </p>
                        <p></p>
                        <p>The XSQL engine processes the actions in a page in the following way. For each action in the page, the engine performs these steps:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span>Constructs an instance of the action handler class using the default constructor</span></li>
                        <li><span>Initializes the handler instance with the action element object and the page processor context by invoking the method <code class="codeph">init(Element actionElt,XSQLPageRequest context</code>)</span></li>
                        <li><span>Invokes the method that allows the handler to handle the action <code class="codeph">handleAction</code> (<code class="codeph">Node</code> result)</span></li>
                     </ol>
                     <div class="section">
                        <p>For built-in actions, the engine can map the XSQL action element name to the Java class that implements the handler of the action. <a href="XSQL-pages-reference.html#GUID-A87F53F2-87BB-4422-90EF-4032D97C54BE__BJEFBDGB" title="This table lists XSQL Configuration File Settings. Configuration Setting Name and Description are the columns.">Table 33-2</a> lists the built-in actions and their corresponding classes.
                        </p>
                        <p>For user-defined actions, use this built-in action, replacing <code class="codeph">fully.qualified.Classname</code> with the name of your class:
                        </p><pre class="pre codeblock"><code>&lt;xsql:action handler="fully.qualified.Classname" ... /&gt;
</code></pre><p>The <code class="codeph">handler</code> attribute provides the fully qualified name of the Java class that implements the custom action handler. 
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADXDK19682"></a><a id="ADXDK19683"></a><a id="ADXDK19684"></a><a id="ADXDK19681"></a><div class="props_rev_3"><a id="GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F" name="GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F"></a><h5 id="ADXDK-GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F" class="sect5">Implementing the XSQLActionHandler Interface</h5>
                     <div>
                        <p>To create a custom action handler, provide a class that implements To create a custom action handler, provide a class that implements <code class="codeph">oracle.xml.xsql.XSQLActionHandler</code> interface <code class="codeph">oracle.xml.xsql.XSQLActionHandler</code>. Most custom action handlers extend <code class="codeph">oracle.xml.xsql.XSQLActionHandlerImpl</code>, which provides a default implementation of the <code class="codeph">init()</code> method and offers useful helper methods.
                        </p>
                        <div class="section">
                           <p>When an action handler's <code class="codeph">handleAction()</code> method is invoked by the XSQL pages processor, a DOM fragment is passed to the action implementation. The action handler appends any dynamically created XML content returned to the page to the root node. 
                           </p>
                           <p>The XSQL processor conceptually replaces the action element in the XSQL page with the content of this document fragment. It is legal for an action handler to append nothing to this fragment if it has no XML content to add to the page.</p>
                           <p>While writing your custom action handlers, some methods on the <code class="codeph">XSQLActionHandlerImpl</code> class are helpful. <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__G1043068" title="This table helpful methods in the XSQLActionHandlerImpl class. Method Name and Description are the columns.">Table 25-2</a> lists these methods.
                           </p>
                           <div class="tblformalwide" id="GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__G1043068">
                              <p class="titleintable">Table 25-2 Helpful Methods in the XSQLActionHandlerImpl Class</p>
                              <table cellpadding="4" cellspacing="0" class="FormalWide" title="Helpful Methods in the XSQLActionHandlerImpl Class" summary="This table helpful methods in the XSQLActionHandlerImpl class. Method Name and Description are the columns." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="31%" id="d104050e3246">Method Name</th>
                                       <th align="left" valign="bottom" width="69%" id="d104050e3249">Description </th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3254" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">getActionElement</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3254 d104050e3249 ">
                                          <p>Returns the current action element being handled.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3261" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">getActionElementContent</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3261 d104050e3249 ">
                                          <p>Returns the text content of the current action element, with all lexical parameters substituted appropriately.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3268" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">getPageRequest</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3268 d104050e3249 ">
                                          <p>Returns the current XSQL pages processor context. Using this object you do this:</p>
                                          <ul style="list-style-type: disc;">
                                             <li>
                                                <p><code class="codeph">setPageParam()</code></p>
                                                <p>Set a page parameter value.</p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">getPostedDocument()/setPostedDocument()</code></p>
                                                <p>Get or set the posted XML document.</p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">translateURL()</code></p>
                                                <p>Translate a relative URL to an absolute URL.</p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">getRequestObject()/setRequestObject()</code></p>
                                                <p>Get or set objects in the page request context that can be shared across actions in a single page.</p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">getJDBCConnection()</code></p>
                                                <p>Gets the JDBC connection in use by this page (possible null if no connection in use).</p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">getRequestType()</code></p>
                                                <p>Detect whether you are running in the Servlet, Command Line, or Programmatic context. For example, if the request type is Servlet then you can cast the <code class="codeph">XSQLPageRequest</code> object to the more specific <code class="codeph">XSQLServletPageRequest</code> to access servlet-specific methods such as <code class="codeph">getHttpServletRequest</code>, <code class="codeph">getHttpServletResponse</code>, and <code class="codeph">getServletContext</code>.
                                                </p>
                                                <p></p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3328" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">getAttributeAllowingParam</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3328 d104050e3249 ">
                                          <p>Retrieves the attribute value from an element, resolving any XSQL lexical parameter references that might appear in value of the attribute. Typically this method is applied to the action element itself, but it is also useful for accessing attributes of subelements. To access an attribute value without allowing lexical parameters, use the standard <code class="codeph">getAttribute()</code> method on the DOM <code class="codeph">Element</code> interface.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3341" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">appendSecondaryDocument</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3341 d104050e3249 ">
                                          <p>Appends the contents of an external XML document to the root of the action handler result content.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3348" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">addResultElement</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3348 d104050e3249 ">
                                          <p>Simplifies appending a single element with text content to the root of the action handler result content. </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3355" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">firstColumnOfFirstRow</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3355 d104050e3249 ">
                                          <p>Returns the first column value of the first row of a SQL statement. Requires the current page to have a connection attribute on its document element, or an error is returned.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3362" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">getBindVariableCount</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3362 d104050e3249 ">
                                          <p>Returns the number of tokens in the space-delimited list of <code class="codeph">bind-params</code>. This number indicates how many bind variables are expected to be bound to parameters.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3372" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">handleBindVariables</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3372 d104050e3249 ">
                                          <p>Manages the binding of JDBC bind variables that appear in a prepared statement with the parameter values specified in the <code class="codeph">bind-params</code> attribute on the current action element. If the statement is already using several bind variables before invoking this method, you can pass the number of existing bind variable slots in use as well.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3382" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">reportErrorIncludingStatement</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3382 d104050e3249 ">
                                          <p>Reports an error. The error includes the offending (SQL) statement that caused the problem and optionally includes a numeric error code.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3389" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">reportFatalError</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3389 d104050e3249 ">
                                          <p>Reports a fatal error. </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3397" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">reportMissingAttribute</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3397 d104050e3249 ">
                                          <p>Reports an error that a required action handler attribute is missing by using the <code class="codeph">&lt;xsql-error&gt;</code> element.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3407" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">reportStatus</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3407 d104050e3249 ">
                                          <p>Reports action handler status by using the <code class="codeph">&lt;xsql-status&gt;</code> element.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3417" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">requiredConnectionProvided</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3417 d104050e3249 ">
                                          <p>Checks whether a connection is available for this request and outputs an errorgram into the page if no connection is available.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d104050e3424" headers="d104050e3246 "><pre class="oac_no_warn" dir="ltr">variableValue</pre></td>
                                       <td align="left" valign="top" width="69%" headers="d104050e3424 d104050e3249 ">
                                          <p>Returns the value of a lexical parameter, taking into account all scoping rules that might determine its default value.</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__BABDHCCI">Example 25-19</a> shows a custom action handler named <code class="codeph">MyIncludeXSQLHandler</code> that leverages a built-in action handler. It uses arbitrary Java code to modify the XML fragment returned by this handler before appending its result to the XSQL page.
                           </p>
                           <p>You might have to write custom action handlers that work differently based on whether the page is requested through the XSQL servlet, the XSQL command-line utility, or programmatically through the <code class="codeph">XSQLRequest</code> class.You can invoke <code class="codeph">getPageRequest()</code> in your action handler implementation to get a reference to the <code class="codeph">XSQLPageRequest</code> interface for the current page request. By invoking <code class="codeph">getRequestType()</code> on the <code class="codeph">XSQLPageRequest</code> object, you can determine whether the request is coming from the Servlet, Command Line, or Programmatic routes. If the return value is <code class="codeph">Servlet</code>, then you can access the HTTP servlet request, response, and servlet context objects as shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__BABDDIGI">Example 25-20</a>.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__BABDHCCI">
                           <p class="titleinexample">Example 25-19 MyIncludeXSQLHandler.java</p><pre class="oac_no_warn" dir="ltr">import oracle.xml.xsql.*;
import oracle.xml.xsql.actions.XSQLIncludeXSQLHandler;
import org.w3c.dom.*;
import java.sql.SQLException;
public class MyIncludeXSQLHandler extends XSQLActionHandlerImpl {
  XSQLActionHandler nestedHandler = null;
  public void init(XSQLPageRequest req, Element action) {
    super.init(req, action);
    // Create an instance of an XSQLIncludeXSQLHandler and init() the handler by 
    // passing the current request/action. This assumes the XSQLIncludeXSQLHandler 
    // will pick up its href="xxx.xsql" attribute from the current action element.
    nestedHandler = new XSQLIncludeXSQLHandler();
    nestedHandler.init(req,action);
  }
  public void handleAction(Node result) throws SQLException {
    DocumentFragment df=result.getOwnerDocument().createDocumentFragment();
    nestedHandler.handleAction(df);
    // Custom Java code here can work on the returned document fragment
    // before appending the final, modified document to the result node.
    // For example, add an attribute to the first child.
    Element e = (Element)df.getFirstChild();
    if (e != null) {
      e.setAttribute("ExtraAttribute","SomeValue");
    }
    result.appendChild(df);
  }
}
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-DFBE1960-184A-4C15-9F8D-2FC08633EF4F__BABDDIGI">
                           <p class="titleinexample">Example 25-20 Testing for the Servlet Request</p><pre class="oac_no_warn" dir="ltr">XSQLServletPageRequest xspr = (XSQLServletPageRequest)getPageRequest();
if (xspr.getRequestType().equals("Servlet")) {
  HttpServletRequest     req  = xspr.getHttpServletRequest();
  HttpServletResponse   resp  = xspr.getHttpServletResponse();
  ServletContext        cont  = xspr.getServletContext();
  // Do something here with req, resp, or cont. Note that writing to the response 
  // directly from a handler produces unexpected results. All the servlet or your 
  // custom Serializer to write to the servlet response output stream at the right 
  // moment later when all action elements have been processed.
}</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADXDK19685"></a><div class="props_rev_3"><a id="GUID-84654614-3CE1-4A4F-891E-94B145257B56" name="GUID-84654614-3CE1-4A4F-891E-94B145257B56"></a><h5 id="ADXDK-GUID-84654614-3CE1-4A4F-891E-94B145257B56" class="sect5">Using Multivalued Parameters in Custom XSQL Actions</h5>
                     <div>
                        <p><code class="codeph">XSQLActionHandlerImpl</code> is the base class for custom XSQL actions. 
                        </p>
                        <div class="section">
                           <p>It supports:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Array-named lexical parameter substitution</p>
                              </li>
                              <li>
                                 <p>Array-named bind variables</p>
                              </li>
                              <li>
                                 <p>Simple-valued parameters</p>
                              </li>
                           </ul>
                           <p>If your custom actions use methods such as <code class="codeph">getAttributeAllowingParam()</code>, <code class="codeph">getActionElementContent()</code>, or <code class="codeph">handleBindVariables()</code> from this base class, you pick up multivalued parameter functionality for free in your custom actions.
                           </p>
                           <p>Use the <code class="codeph">getParameterValues()</code> method on the <code class="codeph">XSQLPageRequest</code> interface to explicitly get a parameter value as a <code class="codeph">String[]</code>. The helper method <code class="codeph">variableValues()</code> in <code class="codeph">XSQLActionHandlerImpl</code> enables you to use this functionality from within a custom action handler if you must do so programmatically. 
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADXDK19687"></a><a id="ADXDK19686"></a><div class="props_rev_3"><a id="GUID-9A5E5942-FA04-4C9D-BF46-3FBA294C5E33" name="GUID-9A5E5942-FA04-4C9D-BF46-3FBA294C5E33"></a><h4 id="ADXDK-GUID-9A5E5942-FA04-4C9D-BF46-3FBA294C5E33" class="sect4">Implementing Custom XSQL Serializers</h4>
                  <div>
                     <p>You can implement a user-defined serializer class to control how the final XSQL datapage is serialized to a text or binary stream. A user-defined serializer must implement interface <code class="codeph">oracle.xml.xsql.XSQLDocumentSerializer</code>.
                     </p>
                     <div class="section">
                        <p>Interface <code class="codeph">oracle.xml.xsql.XSQLDocumentSerializer</code> contains this single method:
                        </p><pre class="pre codeblock"><code>void serialize(org.w3c.dom.Document doc, XSQLPageRequest env) throws Throwable;
</code></pre><p>Only DOM-based serializers are supported. A custom serializer class is expected to perform these steps:</p>
                        <ol>
                           <li>
                              <p>Set the content type of the serialized stream before writing any content to the output <code class="codeph">PrintWriter</code> (or <code class="codeph">OutputStream</code>).
                              </p>
                              <p>Set the type by invoking <code class="codeph">setContentType()</code> on the <code class="codeph">XSQLPageRequest</code> passed to your serializer. When setting the content type, you can set a MIME type:
                              </p><pre class="oac_no_warn" dir="ltr">env.setContentType("text/html");
</pre><p>Alternatively, you can set a MIME type with an explicit output encoding character set:</p><pre class="oac_no_warn" dir="ltr">env.setContentType("text/html;charset=Shift_JIS");
</pre></li>
                           <li>
                              <p>Invoke either <code class="codeph">getWriter()</code> or <code class="codeph">getOutputStream()</code> (but not both) on the <code class="codeph">XSQLPageRequest</code> to get the appropriate <code class="codeph">PrintWriter</code> or <code class="codeph">OutputStream</code> for serializing the content.
                              </p>
                           </li>
                        </ol>
                        <p>The custom serializer in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-9A5E5942-FA04-4C9D-BF46-3FBA294C5E33__BABDGGCJ">Example 25-21</a> shows a simple implementation that serializes an HTML document containing the name of the document element of the current XSQL data page.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-9A5E5942-FA04-4C9D-BF46-3FBA294C5E33__BABDGGCJ">
                        <p class="titleinexample">Example 25-21 Custom Serializer</p><pre class="oac_no_warn" dir="ltr">package oracle.xml.xsql.serializers;
import org.w3c.dom.Document;
import java.io.PrintWriter;
import oracle.xml.xsql.*;

public class XSQLSampleSerializer implements XSQLDocumentSerializer {
  public void serialize(Document doc, XSQLPageRequest env) throws Throwable {
    String encoding = env.getPageEncoding();  // Use same encoding as XSQL page
                                              // template. Set to specific
                                              // encoding if necessary
    String mimeType = "text/html"; // Set this to the appropriate content type
    // (1) Set content type using the setContentType on the XSQLPageRequest
    if (encoding != null &amp;&amp; !encoding.equals("")) {
      env.setContentType(mimeType+";charset="+encoding);
    }
    else {
      env.setContentType(mimeType);
    }
    // (2) Get the output writer from the XSQLPageRequest
    PrintWriter e = env.getWriter();
    // (3) Serialize the document to the writer
    e.println("&lt;html&gt;Document element is &lt;b&gt;"+
              doc.getDocumentElement().getNodeName()+"&lt;/b&gt;&lt;/html&gt;");
  }
}</pre></div>
                     <!-- class="example" -->
                  </div><a id="ADXDK19688"></a><div class="props_rev_3"><a id="GUID-7BC3B483-F753-48D5-82C0-D738095CE8CE" name="GUID-7BC3B483-F753-48D5-82C0-D738095CE8CE"></a><h5 id="ADXDK-GUID-7BC3B483-F753-48D5-82C0-D738095CE8CE" class="sect5">Techniques for Using a Custom Serializer</h5>
                     <div>
                        <p>There are two ways to use a custom serializer, depending on whether you must first perform an XSLT transformation before serializing. </p>
                        <div class="section">
                           <p>To perform an XSLT transformation before using a custom serializer, add the <code class="codeph">serializer="java:fully.qualified.ClassName"</code> in the <code class="codeph">&lt;?xml-stylesheet?&gt;</code> processing instruction at the top of your page. The following examples shows this technique:
                           </p><pre class="oac_no_warn" dir="ltr">&lt;?xml version="1.0?&gt;
&lt;?xml-stylesheet type="text/xsl" href="mystyle.xsl"
                 serializer="java:my.pkg.MySerializer"?&gt;
</pre><p>If you need only the custom serializer, omit the <code class="codeph">type</code> and <code class="codeph">href</code> attributes. The following example shows this technique:
                           </p><pre class="oac_no_warn" dir="ltr">&lt;?xml version="1.0?&gt;
&lt;?xml-stylesheet serializer="java:my.pkg.MySerializer"?&gt;
</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADXDK19690"></a><a id="ADXDK19691"></a><a id="ADXDK19689"></a><div class="props_rev_3"><a id="GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7" name="GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7"></a><h5 id="ADXDK-GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7" class="sect5">Assigning a Short Name to a Custom Serializer</h5>
                     <div>
                        <p>You can assign a short name to your custom serializers in the <code class="codeph">&lt;serializerdefs&gt;</code> section of the XSQL configuration file. You can then use the short name in the serializer attribute, to save typing. The short name is case-sensitive.
                        </p>
                        <div class="section">
                           <p>Assume that you have the information shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7__BABJGEEH">Example 25-22</a> in your XSQL configuration file. You can use the short names "Sample" or "FOP" in a stylesheet instruction:
                           </p><pre class="oac_no_warn" dir="ltr">&lt;?xml-stylesheet type="text/xsl" href="emp-to-xslfo.xsl" serializer="FOP"?&gt;
&lt;?xml-stylesheet serializer="Sample"?&gt;
</pre><p>The <code class="codeph">XSQLPageRequest</code> interface supports both a <code class="codeph">getWriter()</code> and a <code class="codeph">getOutputStream()</code> method. Custom serializers can invoke <code class="codeph">getOutputStream()</code> to return an <code class="codeph">OutputStream</code> instance into which binary data can be serialized. When you use the XSQL servlet, writing to this output stream writes binary information to the servlet output stream.
                           </p>
                           <p>The serializer shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7__BABEJAHC">Example 25-23</a> shows an example of writing a dynamic GIF image. In this example the GIF image is a static "ok" icon, but it shows the basic technique that a more sophisticated image serializer must use.
                           </p>
                           <p>Using the XSQL command-line utility, the binary information is written to the target output file. Using the <code class="codeph">XSQLRequest</code> API, two constructors exist that allow the caller to supply the target <code class="codeph">OutputStream</code> to use for the results of page processing. 
                           </p>
                           <p>Your serializer must either invoke <code class="codeph">getWriter()</code> for textual output or <code class="codeph">getOutputStream()</code> for binary output but not both. Invoking both in the same request raises an error.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7__BABJGEEH">
                           <p class="titleinexample">Example 25-22 Assigning Short Names to Custom Serializers</p><pre class="oac_no_warn" dir="ltr">&lt;XSQLConfig&gt;
  &lt;!--and so on. --&gt;
  &lt;serializerdefs&gt;
    &lt;serializer&gt;
      &lt;name&gt;Sample&lt;/name&gt;
      &lt;class&gt;oracle.xml.xsql.serializers.XSQLSampleSerializer&lt;/class&gt;
    &lt;/serializer&gt;
    &lt;serializer&gt;
      &lt;name&gt;FOP&lt;/name&gt;
      &lt;class&gt;oracle.xml.xsql.serializers.XSQLFOPSerializer&lt;/class&gt;
    &lt;/serializer&gt;
  &lt;/serializerdefs&gt;
&lt;/XSQLConfig&gt;
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-759AE99A-23BA-4CCE-AEF7-F4B3F77892E7__BABEJAHC">
                           <p class="titleinexample">Example 25-23 Writing a Dynamic GIF Image</p><pre class="oac_no_warn" dir="ltr">package oracle.xml.xsql.serializers;
import org.w3c.dom.Document;
import java.io.*;
import oracle.xml.xsql.*;

public class XSQLSampleImageSerializer implements XSQLDocumentSerializer {
   // Byte array representing a small "ok" GIF image
   private static byte[] okGif =
     {(byte)0x47,(byte)0x49,(byte)0x46,(byte)0x38,
      (byte)0x39,(byte)0x61,(byte)0xB,(byte)0x0,
      (byte)0x9,(byte)0x0,(byte)0xFFFFFF80,(byte)0x0,
      (byte)0x0,(byte)0x0,(byte)0x0,(byte)0x0,
      (byte)0xFFFFFFFF,(byte)0xFFFFFFFF,(byte)0xFFFFFFFF,(byte)0x2C,
      (byte)0x0,(byte)0x0,(byte)0x0,(byte)0x0,
      (byte)0xB,(byte)0x0,(byte)0x9,(byte)0x0,
      (byte)0x0,(byte)0x2,(byte)0x14,(byte)0xFFFFFF8C,
      (byte)0xF,(byte)0xFFFFFFA7,(byte)0xFFFFFFB8,(byte)0xFFFFFF9B,
      (byte)0xA,(byte)0xFFFFFFA2,(byte)0x79,(byte)0xFFFFFFE9,
      (byte)0xFFFFFF85,(byte)0x7A,(byte)0x27,(byte)0xFFFFFF93,
      (byte)0x5A,(byte)0xFFFFFFE3,(byte)0xFFFFFFEC,(byte)0x75,
      (byte)0x11,(byte)0xFFFFFF85,(byte)0x14,(byte)0x0,
      (byte)0x3B};

  public void serialize(Document doc, XSQLPageRequest env) throws Throwable {
    env.setContentType("image/gif");
    OutputStream os = env.getOutputStream();
    os.write(okGif,0,okGif.length);
    os.flush();
  }
}
</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADXDK19692"></a><div class="props_rev_3"><a id="GUID-DCB347E9-A50A-4EB2-A419-CAC9E21C60AF" name="GUID-DCB347E9-A50A-4EB2-A419-CAC9E21C60AF"></a><h4 id="ADXDK-GUID-DCB347E9-A50A-4EB2-A419-CAC9E21C60AF" class="sect4">Using a Custom XSQL Connection Manager for JDBC Data Sources</h4>
                  <div>
                     <p>As an alternative to defining your named connections in the XSQL configuration file, you can use one of two <code class="codeph">XSQLConnectionManager</code> implementations provided. These let you use your servlet container's JDBC data source implementation and related connection pooling features. 
                     </p>
                     <div class="section">
                        <p>This XSQL pages framework provides this alternative connection manager implementations:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">oracle.xml.xsql.XSQLDatasourceConnectionManager </code></p>
                              <p>Consider using this connection manager if your servlet container's data source implementation does <span class="italic">not </span>use the Oracle JDBC driver. Features of the XSQL pages system such as <code class="codeph">&lt;xsql:ref-cursor-function&gt;</code> and <code class="codeph">&lt;xsql:include-owa&gt;</code> are not available when you do not use an Oracle JDBC driver.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.xml.xsql.XSQLOracleDatasourceConnectionManager </code></p>
                              <p>Consider using this connection manager when your data source implementation returns JDBC <code class="codeph">PreparedStatement</code> and <code class="codeph">CallableStatement</code> objects that implement the <code class="codeph">oracle.jdbc.PreparedStatement</code> and <code class="codeph">oracle.jdbc.CallableStatement</code> interfaces. The Oracle WebLogic Server has a data source implementation that performs this task.
                              </p>
                           </li>
                        </ul>
                        <p>When using either of the preceding alternative connection manager implementations, the value of the connection attribute in your XSQL page template is the Java Naming and Directory Interface (JNDI) name used to look up your desired data source. For example, the value of the connection attribute might look like:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">jdbc/scottDS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">java:comp/env/jdbc/MyDatasource</code></p>
                           </li>
                        </ul>
                        <p>If you are not using the default XSQL pages connection manager, then needed connection pooling functionality must be provided by the alternative connection manager implementation. In the case of the preceding two options based on JDBC data sources, you must properly configure your servlet container to supply the connection pooling. See your servlet container documentation for instructions on how to properly configure the data sources to offer pooled connections.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADXDK19693"></a><div class="sect3"><a id="GUID-C01D126B-2CF1-46AB-92A6-62A83471A1E8" name="GUID-C01D126B-2CF1-46AB-92A6-62A83471A1E8"></a><h4 id="ADXDK-GUID-C01D126B-2CF1-46AB-92A6-62A83471A1E8" class="sect4">Writing Custom XSQL Connection Managers</h4>
                  <div>
                     <p>You can provide a custom connection manager to replace the built-in connection management mechanism. </p>
                     <p>To provide a custom connection manager implementation, you must perform these steps:</p>
                     <ol>
                        <li>
                           <p>Write a connection manager factory class that implements the <code class="codeph">oracle.xml.xsql.XSQLConnectionManagerFactory</code> interface.
                           </p>
                        </li>
                        <li>
                           <p>Write a connection manager class that implements the <code class="codeph">oracle.xml.xsql.XSQLConnectionManager</code> interface.
                           </p>
                        </li>
                        <li>
                           <p>Change the name of the <code class="codeph">XSQLConnectionManagerFactory</code> class in your XSQL configuration file.
                           </p>
                        </li>
                     </ol>
                     <p>The XSQL servlet uses your connection management scheme instead of the XSQL pages default scheme.</p>
                     <p>You can set your custom connection manager factory as the default connection manager factory by providing the class name in the XSQL configuration file. Set the factory in this section:</p><pre class="pre codeblock"><code>&lt;!--
 | Set the name of the XSQL Connection Manager Factory
 | implementation. The class must implement the
 | oracle.xml.xsql.XSQLConnectionManagerFactory interface.
 | If unset, the default is to use the built-in connection
 | manager implementation in 
 | oracle.xml.xsql.XSQLConnectionManagerFactoryImpl
+--&gt;
  &lt;connection-manager&gt;
      &lt;factory&gt;oracle.xml.xsql.XSQLConnectionManagerFactoryImpl&lt;/factory&gt;
  &lt;/connection-manager&gt;
</code></pre><p>In addition to specifying the default connection manager factory, you can associate a custom connection factory with a <code class="codeph">XSQLRequest</code> object by using APIs provided. 
                     </p>
                     <p>The responsibility of the <code class="codeph">XSQLConnectionManagerFactory</code> is to return an instance of an <code class="codeph">XSQLConnectionManager</code> for use by the current request. In a multithreaded environment such as a servlet engine, the <code class="codeph">XSQLConnectionManager</code> object must ensure that a single <code class="codeph">XSQLConnection</code> instance is not used by two different threads. This aim is realized by marking the connection as in use for the time between the <code class="codeph">getConnection()</code> and <code class="codeph">releaseConnection()</code> method invocations. The default XSQL connection manager implementation automatically pools named connections and adheres to this thread-safe policy.
                     </p>
                     <p>If your custom implementation of <code class="codeph">XSQLConnectionManager</code> implements the optional <code class="codeph">oracle.xml.xsql.XSQLConnectionManagerCleanup</code> interface, then your connection manager can clean up any resources it has allocated. For example, if your servlet container invokes the <code class="codeph">destroy()</code> method on the <code class="codeph">XSQLServlet</code> servlet, which can occur during online administration of the servlet for example, the connection manager has a chance to clean up resources as part of the servlet destruction process.
                     </p>
                  </div><a id="ADXDK19694"></a><div class="props_rev_3"><a id="GUID-2CEAD8D1-7014-49DF-94E9-0E2A68275DFE" name="GUID-2CEAD8D1-7014-49DF-94E9-0E2A68275DFE"></a><h5 id="ADXDK-GUID-2CEAD8D1-7014-49DF-94E9-0E2A68275DFE" class="sect5">Accessing Authentication Information in a Custom Connection Manager</h5>
                     <div>
                        <p>To use the HTTP authentication mechanism to get the user name and password to connect to the database, write a customized connection manager. You can then invoke a <code class="codeph">getConnection()</code> method to get the needed information.
                        </p>
                        <div class="section">
                           <p>You can write a Java program that follows these steps:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li><span>Pass an instance of the <code class="codeph">oracle.xml.xsql.XSQLPageRequest</code> interface to the <code class="codeph">getConnection()</code> method. </span></li>
                           <li><span>Invoke <code class="codeph">getRequestType()</code> to ensure that the request type is <code class="codeph">Servlet</code>.</span></li>
                           <li><span>Cast the <code class="codeph">XSQLPageRequest</code> object to an <code class="codeph">XSQLServletPageRequest</code>.</span></li>
                           <li><span>Invoke <code class="codeph">getHttpServletRequest()</code> on the result of the preceding step.</span></li>
                           <li><span>Get the authentication information from the <code class="codeph">javax.servlet.http.HttpServletResponse</code> object returned by the previous invocation.</span></li>
                        </ol>
                     </div>
                  </div>
               </div><a id="ADXDK19696"></a><a id="ADXDK19695"></a><div class="props_rev_3"><a id="GUID-0D913A5C-2BCF-4647-BACC-7DC1A329A8D4" name="GUID-0D913A5C-2BCF-4647-BACC-7DC1A329A8D4"></a><h4 id="ADXDK-GUID-0D913A5C-2BCF-4647-BACC-7DC1A329A8D4" class="sect4">Implementing a Custom XSQLErrorHandler</h4>
                  <div>
                     <p>You can control how serious page processor errors such as an unavailable connection are reported to users by implementing interface <code class="codeph">oracle.xml.xsql.XSQLErrorHandler</code>.
                     </p>
                     <div class="section">
                        <p>The interface contains this single method signature:</p><pre class="oac_no_warn" dir="ltr">public interface XSQLErrorHandler {
  public void handleError( XSQLError err, XSQLPageRequest env);
}
</pre><p>You can provide a class that implements the <code class="codeph">XSQLErrorHandler</code> interface to customize how the XSQL pages processor writes error messages. The new <code class="codeph">XSQLError</code> object encapsulates the error information and provides access to the error code, formatted error message, and so on. 
                        </p>
                        <p><a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-0D913A5C-2BCF-4647-BACC-7DC1A329A8D4__BABEHDDD">Example 25-24</a> shows a sample implementation of <code class="codeph">XSQLErrorHandler</code>.
                        </p>
                        <p>You can control which custom <code class="codeph">XSQLErrorHandler</code> implementation is used in these distinct ways:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Define the name of a custom <code class="codeph">XSQLErrorHandler</code> implementation class in the XSQL configuration file. You must provide the fully qualified class name of your error handler class as the value of the <code class="codeph">/XSQLConfig/processor/error-handler/class</code> entry.
                              </p>
                              <p>If the XSQL processor can load this class, and if it correctly implements the <code class="codeph">XSQLErrorHandler</code> interface, then it uses this class as a singleton and replaces the default implementation globally wherever page processor errors are reported.
                              </p>
                           </li>
                           <li>
                              <p>Override the error writer on a per page basis by using the <code class="codeph">errorHandler</code> (or <code class="codeph">xsql:errorHandler</code>) attribute on the document element of the page. The attribute value is the fully qualified class name of a class that implements the <code class="codeph">XSQLErrorHandler</code> interface. This class reports the errors only for this page. The class is instantiated on each page request by the page engine.
                              </p>
                           </li>
                        </ul>
                        <p>You can use a combination of the preceding approaches if needed.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-0D913A5C-2BCF-4647-BACC-7DC1A329A8D4__BABEHDDD">
                        <p class="titleinexample">Example 25-24 myErrorHandler class</p><pre class="oac_no_warn" dir="ltr">package example;
import oracle.xml.xsql.*;
import java.io.*;
public class myErrorHandler implements XSQLErrorHandler {
  public void logError( XSQLError err, XSQLPageRequest env) {
    // Must set the content type before writing anything out
    env.setContentType("text/html");
    PrintWriter pw = env.getErrorWriter();
    pw.println("&lt;H1&gt;ERROR&lt;/H1&gt;&lt;hr&gt;"+err.getMessage());    
  }
}
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK19698"></a><a id="ADXDK19699"></a><a id="ADXDK19700"></a><a id="ADXDK19697"></a><div class="props_rev_3"><a id="GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8" name="GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8"></a><h4 id="ADXDK-GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8" class="sect4">Providing a Custom XSQL Logger Implementation</h4>
                  <div>
                     <p>You can optionally register custom code to handle the logging of the start and end of each XSQL page request. Your custom logger code must provide an implementation of interfaces <code class="codeph">oracle.xml.xsql.XSQLLoggerFactory</code> and <code class="codeph">oracle.xml.xsql.XSQLLogger</code>.
                     </p>
                     <div class="section">
                        <p>The <code class="codeph">XSQLLoggerFactory</code> interface contains this single method:
                        </p><pre class="oac_no_warn" dir="ltr">public interface XSQLLoggerFactory {
  public XSQLLogger create( XSQLPageRequest env);
}
</pre><p>You can provide a class that implements the <code class="codeph">XSQLLoggerFactory</code> interface to decide how <code class="codeph">XSQLLogger</code> objects are created (or reused) for logging. The XSQL processor holds a reference to the <code class="codeph">XSQLLogger</code> object returned by the factory for the duration of a page request. The processor uses it to log the start and end of each page request by invoking the <code class="codeph">logRequestStart()</code> and <code class="codeph">logRequestEnd()</code> methods.
                        </p>
                        <p>The <code class="codeph">XSQLLogger</code> interface is:
                        </p><pre class="oac_no_warn" dir="ltr">public interface XSQLLogger {
   public void logRequestStart(XSQLPageRequest env) ;
   public void logRequestEnd(XSQLPageRequest env);
}
</pre><p>The classes in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABEGBFA">Example 25-25</a> and <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABBDEGD">Example 25-26</a> show a trivial implementation of a custom logger. The <code class="codeph">XSQLLogger</code> implementation in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABEGBFA">Example 25-25</a> notes the time the page request started. It then logs the page request end by printing the name of the page request and the elapsed time to <code class="codeph">System.out</code>.
                        </p>
                        <p>The factory implementation is shown in <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABBDEGD">Example 25-26</a>.
                        </p>
                        <p>To register a custom logger factory, edit the <code class="codeph">XSQLConfig.xml</code> file and provide the name of your custom logger factory class as the content to the <code class="codeph">/XSQLConfig/processor/logger/factory</code> element. <a href="using-XSQL-pages-publishing-framework-advanced.html#GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABHCGBD">Example 25-27</a> shows this technique.
                        </p>
                        <p>By default, <code class="codeph">&lt;logger&gt;</code> section is commented out. There is no default logger.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABEGBFA">
                        <p class="titleinexample">Example 25-25 SampleCustomLogger Class</p><pre class="oac_no_warn" dir="ltr">package example;
import oracle.xml.xsql.*;
public class SampleCustomLogger implements XSQLLogger  {
  long start = 0;
  public void logRequestStart(XSQLPageRequest env) {
    start = System.currentTimeMillis();
  }
  public void logRequestEnd(XSQLPageRequest env) {
    long secs = System.currentTimeMillis() - start;
    System.out.println("Request for " + env.getSourceDocumentURI()
                        + " took "+ secs + "ms");
  }
}
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABBDEGD">
                        <p class="titleinexample">Example 25-26 SampleCustomLoggerFactory Class</p><pre class="oac_no_warn" dir="ltr">package example;
import oracle.xml.xsql.*;
public class SampleCustomLoggerFactory implements XSQLLoggerFactory {
  public XSQLLogger create(XSQLPageRequest env) {
    return new SampleCustomLogger();
  }
}
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-2571E21E-CB76-4B80-8233-E4ACB4D81EB8__BABHCGBD">
                        <p class="titleinexample">Example 25-27 Registering a Custom Logger Factory</p><pre class="oac_no_warn" dir="ltr">&lt;XSQLConfig&gt;
    :
  &lt;processor&gt;
         :
      &lt;logger&gt;
         &lt;factory&gt;example.SampleCustomLoggerFactory&lt;/factory&gt;
      &lt;/logger&gt;
         :
   &lt;/processor&gt;
&lt;/XSQLConfig&gt;
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>