<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The external tables feature is a complement to existing SQL*Loader functionality. It enables you to access data in external sources as if it were in a table in the database.">
      <meta name="description" content="The external tables feature is a complement to existing SQL*Loader functionality. It enables you to access data in external sources as if it were in a table in the database.">
      <title>External Tables Concepts</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Utilities ">
      <meta property="og:description" content="The external tables feature is a complement to existing SQL*Loader functionality. It enables you to access data in external sources as if it were in a table in the database.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Utilities">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-utilities.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-04-23T19:07:17-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96081-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="oracle-external-tables.html" title="Previous" type="text/html">
      <link rel="next" href="oracle_loader-access-driver.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Utilities">
    <meta name="dcterms.isVersionOf" content="SUTIL">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-external-tables.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="oracle_loader-access-driver.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Utilities </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-external-tables.html" property="item" typeof="WebPage"><span property="name"> External Tables</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> External Tables Concepts</li>
            </ol>
            <a id="GUID-44323E01-7D72-45EC-915A-99E596769D9E" name="GUID-44323E01-7D72-45EC-915A-99E596769D9E"></a><a id="SUTIL011"></a>
            
            <h2 id="SUTIL-GUID-44323E01-7D72-45EC-915A-99E596769D9E" class="sect2"><span class="enumeration_chapter">14 </span> External Tables Concepts
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The external tables feature is a complement to existing SQL*Loader functionality. It enables you to access data in external sources as if it were in a table in the database. </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="oracle-external-tables-concepts.html#GUID-ACF1D3AA-1D61-4682-AEC5-42C944756E12">How Are External Tables Created?</a><br>External tables are created using the SQL <code class="codeph">CREATE</code> <code class="codeph">TABLE...ORGANIZATION EXTERNAL</code> statement. 
                  </li>
                  <li class="ulchildlink"><a href="oracle-external-tables-concepts.html#GUID-05AA7C84-2C2D-45CE-8F52-392D4A2B4864">Location of Data Files and Output Files</a><br>Data files and output files must be located on the server. You must have a directory object that specifies the location from which to read and write files. 
                  </li>
                  <li class="ulchildlink"><a href="oracle-external-tables-concepts.html#GUID-07D30CE6-128D-426F-8B76-B13E1C53BD5A">Access Parameters for External Tables</a><br>To modify the default behavior of the access driver for external tables, specify access parameters. 
                  </li>
                  <li class="ulchildlink"><a href="oracle-external-tables-concepts.html#GUID-7AB423F1-C688-4A1C-A940-77C221839BCA">Data Type Conversion During External Table Use</a><br>Conversion errors can occur when external tables are read from and when they are written to.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="oracle-external-tables.html#GUID-038ED956-A6EE-4C6D-B7C9-0D406B8088B6">External Tables</a></p>
                  </div>
               </div>
            </div>
            <a id="SUTIL1357"></a><div class="props_rev_3"><a id="GUID-ACF1D3AA-1D61-4682-AEC5-42C944756E12" name="GUID-ACF1D3AA-1D61-4682-AEC5-42C944756E12"></a><h3 id="SUTIL-GUID-ACF1D3AA-1D61-4682-AEC5-42C944756E12" class="sect3"><span class="enumeration_section">14.1 </span>How Are External Tables Created?
               </h3>
               <div>
                  <p>External tables are created using the SQL <code class="codeph">CREATE</code> <code class="codeph">TABLE...ORGANIZATION EXTERNAL</code> statement. 
                  </p>
                  <p>Note that SQL*Loader may be the better choice in data loading situations that require additional indexing of the staging table. See <a href="oracle-sql-loader-concepts.html#GUID-AC0DBDB3-BD68-45A4-ABA3-3DE38BB038ED" title="This section describes important differences between loading data with external tables, using the ORACLE_LOADER access driver, as opposed to loading data with SQL*Loader conventional and direct path loads.">Behavior Differences Between SQL*Loader and External Tables</a> for more information about how load behavior differs between SQL*Loader and external tables.
                  </p>
                  <p>As of Oracle Database 12<span class="italic">c</span> Release 2 (12.2.0.1), you can partition data contained in external tables, which allows you to take advantage of the same performance improvements provided when you partition tables stored in a database (for example, partition pruning).
                  </p>
                  <div class="infoboxnotealso" id="GUID-ACF1D3AA-1D61-4682-AEC5-42C944756E12__GUID-68CAF487-8DC2-4A11-84A3-231E140C7E3F">
                     <p class="notep1">See Also:</p>
                     <p><a href="../admin/managing-tables.html#ADMIN01507" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> for additional information about creating and managing external tables, and about partitioning them.
                     </p>
                  </div>
                  <div class="infoboxnote" id="GUID-ACF1D3AA-1D61-4682-AEC5-42C944756E12__GUID-A01A2BC3-CFE0-429C-A41E-9D86ACF56C3A">
                     <p class="notep1">Note:</p>
                     <p>External tables can be used as inline external tables in SQL statements, thus eliminating the need to create an external table as a persistent database object in the data dictionary. For additional information, see <a href="../sqlrf/SELECT.html#SQLRF-GUID-CFA006CA-6FF1-4972-821E-6996142A51C6" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a>.
                     </p>
                  </div>
                  <p>When you create an external table, you specify the following attributes:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">TYPE</code> — specifies the type of external table. Each type of external table is supported by its own access driver.
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">ORACLE_LOADER</code> — this is the default access driver. It loads data from external tables to internal tables. The data must come from text data files. (The <code class="codeph">ORACLE_LOADER</code> access driver cannot perform unloads; that is, it cannot move data from an internal table to an external table.)
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ORACLE_DATAPUMP</code> — this access driver can perform both loads and unloads. The data must come from binary dump files. Loads to internal tables from external tables are done by fetching from the binary dump files. Unloads from internal tables to external tables are done by populating the binary dump files of the external table. The <code class="codeph">ORACLE_DATAPUMP</code> access driver can write dump files only as part of creating an external table with the SQL <code class="codeph">CREATE TABLE AS SELECT</code> statement. Once the dump file is created, it can be read any number of times, but it cannot be modified (that is, no DML operations can be performed).
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ORACLE_HDFS</code> — extracts data stored in a Hadoop&nbsp;Distributed File System (HDFS).
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ORACLE_HIVE</code> — extracts data stored in Apache HIVE.
                              </p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p><code class="codeph">DEFAULT</code> <code class="codeph">DIRECTORY</code> — specifies the default directory to use for all input and output files that do not explicitly name a directory object. The location is specified with a directory object, not a directory path. You must create the directory object before you create the external table; otherwise, an error is generated. See <a href="oracle-external-tables-concepts.html#GUID-05AA7C84-2C2D-45CE-8F52-392D4A2B4864" title="Data files and output files must be located on the server. You must have a directory object that specifies the location from which to read and write files.">Location of Data Files and Output Files</a> for more information.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">ACCESS</code> <code class="codeph">PARAMETERS</code> — describe the external data source and implement the type of external table that was specified. Each type of external table has its own access driver that provides access parameters unique to that type of external table. Access parameters are optional. See <a href="oracle-external-tables-concepts.html#GUID-07D30CE6-128D-426F-8B76-B13E1C53BD5A" title="To modify the default behavior of the access driver for external tables, specify access parameters.">Access Parameters</a>.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">LOCATION</code> — specifies the data files for the external table.
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>For <code class="codeph">ORACLE_LOADER</code> and <code class="codeph">ORACLE_DATAPUMP</code>, the files are named in the form <span class="italic"><code class="codeph">directory:file</code></span>. The <span class="italic"><code class="codeph">directory</code></span> portion is optional. If it is missing, then the default directory is used as the directory for the file. If you are using the <code class="codeph">ORACLE_LOADER</code> access driver, then you can use wildcards in the file name: an asterisk (*) signifies multiple characters, a question mark (?) signifies a single character.
                              </p>
                           </li>
                           <li>
                              <p>For <code class="codeph">ORACLE_HDFS</code>, the <code class="codeph">LOCATION</code> clause is a list of Uniform Resource Identifiers (URIs) for a directory or for a file. There is no directory object associated with a URI.
                              </p>
                           </li>
                           <li>
                              <p>For <code class="codeph">ORACLE_HIVE</code>, the <code class="codeph">LOCATION</code> clause is not used. Instead, the Hadoop HCatalog table is read to obtain information about the location of the data source (which could be a file or another database).
                              </p>
                           </li>
                        </ul>
                     </li>
                  </ul>
                  <p>The following examples briefly show the use of attributes for each of the access drivers.</p>
                  <div class="example" id="GUID-ACF1D3AA-1D61-4682-AEC5-42C944756E12__GUID-C0EE1690-9140-4243-80FC-EA88AC886123">
                     <p class="titleinexample">Example 14-1 Specifying Attributes for the ORACLE_LOADER Access Driver</p>
                     <p>The following example uses the <code class="codeph">ORACLE_LOADER</code> access driver to show the use of each of these attributes (it assumes that the default directory <code class="codeph">def_dir1</code> already exists):
                     </p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE emp_load
  2    (employee_number      CHAR(5),
  3     employee_dob         CHAR(20),
  4     employee_last_name   CHAR(20),
  5     employee_first_name  CHAR(15),
  6     employee_middle_name CHAR(15),
  7     employee_hire_date   DATE)
  8  ORGANIZATION EXTERNAL
  9    (<span class="bold">TYPE</span> ORACLE_LOADER
 10     <span class="bold">DEFAULT DIRECTORY</span> def_dir1
 11     <span class="bold">ACCESS PARAMETERS</span>
 12       (RECORDS DELIMITED BY NEWLINE
 13        FIELDS (employee_number      CHAR(2),
 14                employee_dob         CHAR(20),
 15                employee_last_name   CHAR(18),
 16                employee_first_name  CHAR(11),
 17                employee_middle_name CHAR(11),
 18                employee_hire_date   CHAR(10) date_format DATE mask "mm/dd/yyyy"
 19               )
 20       )
 21     <span class="bold">LOCATION</span> ('info.dat')
 22    );
 
Table created.
</code></pre><p>The information you provide through the access driver ensures that data from the data source is processed so that it matches the definition of the external table. The fields listed after <code class="codeph">CREATE</code> <code class="codeph">TABLE</code> <code class="codeph">emp_load</code> are actually defining the metadata for the data in the <code class="codeph">info</code>.<code class="codeph">dat</code> source file. 
                     </p>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-ACF1D3AA-1D61-4682-AEC5-42C944756E12__GUID-B81DE8BA-774C-48AA-86AD-55E41B276AC3">
                     <p class="titleinexample">Example 14-2 Specifying Attributes for the ORACLE_DATAPUMP Access Driver</p>
                     <p>This example creates an external table named <code class="codeph">inventories_xt</code> and populates the dump file for the external table with the data from table <code class="codeph">inventories</code> in the <code class="codeph">oe</code> sample schema.
                     </p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE inventories_xt
2 ORGANIZATION EXTERNAL
3 (
4 TYPE ORACLE_DATAPUMP
5 DEFAULT DIRECTORY def_dir1
6 LOCATION ('inv_xt.dmp')
7 )
8 AS SELECT * FROM inventories;
Table created.</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-ACF1D3AA-1D61-4682-AEC5-42C944756E12__GUID-94542F48-C4CF-47E9-8089-7ABF3BC9E666">
                     <p class="titleinexample">Example 14-3 Specifying Attributes for the ORACLE_HDFS Access Driver</p><pre class="pre codeblock"><code>CREATE TABLE sales_external
(   time_id           DATE NOT NULL, …
    amount_sold       NUMBER(10,2)
)
ORGANIZATION EXTERNAL 
(  TYPE ORACLE_HDFS
   ACCESS PARAMETERS (com.oracle.bigdata.cluster=hadoop1)
   LOCATION (“hdfs:/usr/sales_1.csv”, “hdfs:/usr/my_sales_*.csv”)
)</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-ACF1D3AA-1D61-4682-AEC5-42C944756E12__GUID-5441F127-0F76-4B74-B6A6-EE23C5CBF7A8">
                     <p class="titleinexample">Example 14-4 Specifying Attributes for the ORACLE_HIVE Access Driver</p><pre class="pre codeblock"><code>CREATE TABLE sales_external
(   time_id           DATE NOT NULL, …
    amount_sold       NUMBER(10,2)
)
ORGANIZATION EXTERNAL 
(   TYPE ORACLE_HIVE
    ACCESS PARAMETERS (com.oracle.bigdata.cluster=hadoop1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                       com.oracle.bigdata.tablename=default.ratings_hive_table)
);</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="oracle-external-tables-concepts.html#GUID-44323E01-7D72-45EC-915A-99E596769D9E" title="The external tables feature is a complement to existing SQL*Loader functionality. It enables you to access data in external sources as if it were in a table in the database.">External Tables Concepts</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="SUTIL1359"></a><div class="props_rev_3"><a id="GUID-05AA7C84-2C2D-45CE-8F52-392D4A2B4864" name="GUID-05AA7C84-2C2D-45CE-8F52-392D4A2B4864"></a><h3 id="SUTIL-GUID-05AA7C84-2C2D-45CE-8F52-392D4A2B4864" class="sect3"><span class="enumeration_section">14.2 </span>Location of Data Files and Output Files
               </h3>
               <div>
                  <p>Data files and output files must be located on the server. You must have a directory object that specifies the location from which to read and write files. </p>
                  <div class="infoboxnote" id="GUID-05AA7C84-2C2D-45CE-8F52-392D4A2B4864__GUID-45EEFFDC-F14B-4FFD-AF03-349102267FCD">
                     <p class="notep1">Note:</p>The information in this section about directory objects does not apply to data files for the <code class="codeph">ORACLE_HDFS</code> access driver or <code class="codeph">ORACLE_HIVE</code> access driver. With the <code class="codeph">ORACLE_HDFS</code> driver, the location of data is specified with a list of URIs for a directory or for a file, and there is no directory object associated with a URI. The <code class="codeph">ORACLE_HIVE</code> driver does not specify a data source location; it reads the Hive metastore table to get that information, so no directory object is needed.
                  </div>
                  <p>The access driver runs inside the database server. This behavior is different from SQL*Loader, which is a client program that sends the data to be loaded over to the server. This difference has the following implications:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The server requires access to files that the access driver can load.</p>
                     </li>
                     <li>
                        <p>The server must create and write the output files created by the access driver: the log file, bad file, discard file, and also any dump files created by the <code class="codeph">ORACLE_DATAPUMP</code> access driver.
                        </p>
                     </li>
                  </ul>
                  <p>To specify the location from which to read and write files, the access driver requires that you use a directory object. A directory object maps a name to a directory name on the file system. For example, the following statement creates a directory object named <code class="codeph">ext_tab_dir</code> that is mapped to a directory located at <code class="codeph">/usr/apps/datafiles.</code></p><pre class="oac_no_warn" dir="ltr">CREATE DIRECTORY ext_tab_dir AS '/usr/apps/datafiles';
</pre><p>DBAs or any user can create directory objects with the <code class="codeph">CREATE</code> <code class="codeph">ANY</code> <code class="codeph">DIRECTORY</code> privilege. 
                  </p>
                  <div class="infoboxnote" id="GUID-05AA7C84-2C2D-45CE-8F52-392D4A2B4864__GUID-92D64368-0498-4BCD-AAF8-D4F444B61A6C">
                     <p class="notep1">Note:</p>
                     <p>To use external tables in an Oracle Real Applications Cluster (Oracle RAC) configuration, you must ensure that the directory object path is on a cluster-wide file system.</p>
                  </div>
                  <p>After a directory is created, the user creating the directory object must grant <code class="codeph">READ</code> and <code class="codeph">WRITE</code> privileges on the directory to other users. These privileges must be explicitly granted, rather than assigned by using roles. For example, to allow the server to read files on behalf of user <code class="codeph">scott</code> in the directory named by <code class="codeph">ext_tab_dir</code>, the user who created the directory object must execute the following command:
                  </p><pre class="oac_no_warn" dir="ltr">GRANT READ ON DIRECTORY ext_tab_dir TO scott;
</pre><p>The <code class="codeph">SYS</code> user is the only user that can own directory objects, but the <code class="codeph">SYS</code> user can grant other users the privilege to create directory objects.<code class="codeph">READ</code> or <code class="codeph">WRITE</code> permission to a directory object means only that Oracle Database reads or writes that file on your behalf. You are not given direct access to those files outside of the Oracle database unless you have the appropriate operating system privileges. Similarly, the Oracle database requires permission from the operating system to read and write files in the directories.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="oracle-external-tables-concepts.html#GUID-44323E01-7D72-45EC-915A-99E596769D9E" title="The external tables feature is a complement to existing SQL*Loader functionality. It enables you to access data in external sources as if it were in a table in the database.">External Tables Concepts</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="SUTIL1358"></a><div class="props_rev_3"><a id="GUID-07D30CE6-128D-426F-8B76-B13E1C53BD5A" name="GUID-07D30CE6-128D-426F-8B76-B13E1C53BD5A"></a><h3 id="SUTIL-GUID-07D30CE6-128D-426F-8B76-B13E1C53BD5A" class="sect3"><span class="enumeration_section">14.3 </span>Access Parameters for External Tables
               </h3>
               <div>
                  <p>To modify the default behavior of the access driver for external tables, specify access parameters. </p>
                  <p>When you create an external table of a particular type, you can specify access parameters to modify the default behavior of the access driver. Each access driver has its own syntax for access parameters. Oracle provides the following access drivers for use with external tables: <code class="codeph">ORACLE_LOADER</code> , <code class="codeph">ORACLE_DATAPUMP</code>, <code class="codeph">ORACLE_HDFS</code>, and <code class="codeph">ORACLE_HIVE</code>.
                  </p>
                  <div class="infoboxnote" id="GUID-07D30CE6-128D-426F-8B76-B13E1C53BD5A__GUID-A53BD2B8-51CE-478E-B02A-B0D8B1BA9542">
                     <p class="notep1">Note:</p>
                     <p>These access parameters are collectively referred to as the <code class="codeph">opaque_format_spec</code> in the SQL <code class="codeph">CREATE TABLE...ORGANIZATION EXTERNAL</code> statement.
                     </p>
                  </div>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-07D30CE6-128D-426F-8B76-B13E1C53BD5A__GUID-195C9544-02C6-4F63-B2A2-9586DD340712">
                     <p class="notep1">See Also:</p>
                     <p></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="oracle_loader-access-driver.html#GUID-EA56D498-E8BB-4E02-8ABF-12E7083ED9D5" title="The ORACLE_LOADER access driver provides a set of access parameters unique to external tables of the type ORACLE_LOADER.">The ORACLE_LOADER Access Driver</a></p>
                        </li>
                        <li>
                           <p><a href="oracle_datapump-access-driver.html#GUID-084DC623-9656-499C-885B-D8180C07704B" title="The ORACLE_DATAPUMP access driver provides a set of access parameters that are unique to external tables of the type ORACLE_DATAPUMP.">The ORACLE_DATAPUMP Access Driver</a></p>
                        </li>
                        <li>
                           <p><a href="oracle_hdfs-oracle_hive-access-drivers.html#GUID-597D7F45-D37F-49CE-A7E5-C92C7D707AE9" title="The properties used to create an external table that uses the ORACLE_HDFS or ORACLE_HIVE access drivers are specified in a SQL CREATE TABLE ORGANIZATION EXTERNAL statement, in the opaque_format_spec clause of ACCESS PARAMETERS.">ORACLE_HDFS and ORACLE_HIVE Access Drivers</a></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/CREATE-TABLE.html#SQLRF01402" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about specifying <code class="codeph">opaque_format_spec</code> when using the SQL <code class="codeph">CREATE TABLE</code> statement
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="oracle-external-tables-concepts.html#GUID-44323E01-7D72-45EC-915A-99E596769D9E" title="The external tables feature is a complement to existing SQL*Loader functionality. It enables you to access data in external sources as if it were in a table in the database.">External Tables Concepts</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="SUTIL1365"></a><div class="props_rev_3"><a id="GUID-7AB423F1-C688-4A1C-A940-77C221839BCA" name="GUID-7AB423F1-C688-4A1C-A940-77C221839BCA"></a><h3 id="SUTIL-GUID-7AB423F1-C688-4A1C-A940-77C221839BCA" class="sect3"><span class="enumeration_section">14.4 </span>Data Type Conversion During External Table Use
               </h3>
               <div>
                  <p>Conversion errors can occur when external tables are read from and when they are written to.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-7AB423F1-C688-4A1C-A940-77C221839BCA__GUID-B7E4AA53-3D5A-4D82-8D0D-AEB1E9901C8F">Conversion Errors When Reading External Tables</p>
                     <p>When you select rows from an external table, the access driver performs any transformations necessary to make the data from the data source match the data type of the corresponding column in the external table.  Depending on the data and the types of transformations required, the transformation can encounter errors.</p>
                     <p>To illustrate the types of data conversion problems that can occur when reading from an external table, suppose you create the following external table <code class="codeph">KV_TAB_XT</code> with two columns: <code class="codeph">KEY</code> whose data type is <code class="codeph">VARCHAR2(4)</code> and <code class="codeph">VAL</code> whose data type is <code class="codeph">NUMBER</code>.
                     </p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE KV_TAB_XT (KEY, VARCHAR2(4), VAL NUMBER)
2 ORGANIZATION EXTERNAL
3 (DEFAULT DIRECTORY DEF_DIR1 LOCATION (‘key_val.csv’));</code></pre><p> The external table <code class="codeph">KV_TAB_XT</code> uses default values for the access parameters, which means:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Records are delimited by new lines.</p>
                        </li>
                        <li>
                           <p>The data file and the database have the same character set.</p>
                        </li>
                        <li>
                           <p>The fields in the data file have the same name and are in the same order as the columns in the external table.</p>
                        </li>
                        <li>
                           <p>The data type of the field is <code class="codeph">CHAR(255)</code>.
                           </p>
                        </li>
                        <li>
                           <p>Data for each field is terminated by a comma.</p>
                        </li>
                     </ul>
                     <p>The records in the data file for the <code class="codeph">KV_TAB_XT</code> external table should be:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>A string, up to 4 bytes long.&nbsp; If the string is empty, then the value for the field is <code class="codeph">NULL</code>.
                           </p>
                        </li>
                        <li>
                           <p>A terminating comma.</p>
                        </li>
                        <li>
                           <p>A string of numeric characters.&nbsp;If the string is empty, then the value for this field is <code class="codeph">NULL</code>.
                           </p>
                        </li>
                        <li>
                           <p>An optional terminating comma.</p>
                        </li>
                     </ul>
                     <p>When the access driver reads a record from the data file, it verifies that the length of the value of the <code class="codeph">KEY</code> field in the data file is less than or equal to 4, and it attempts to convert the value of the <code class="codeph">VAL</code> field in the data file to an Oracle number.
                     </p>
                     <p>If the length of the value of the <code class="codeph">KEY</code> field is greater than 4 or if there is a non-numeric character in the value for <code class="codeph">VAL</code>, then the <code class="codeph">ORACLE_LOADER</code> access driver rejects the row which results in a copy of the row being written to the bad file and an error message being written to the log file.
                     </p>
                     <p>All access drivers have to handle conversion from the data type of fields in the source for the external table and the data type for the columns of the external tables.&nbsp; The following are some examples of the types of conversions and checks that access drivers perform:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Convert character data from character set used by the source data to the character set used by the database.</p>
                        </li>
                        <li>
                           <p>Convert from character data to numeric data.</p>
                        </li>
                        <li>
                           <p>Convert from numeric data to character data.</p>
                        </li>
                        <li>
                           <p>Convert from character data to a date or timestamp.</p>
                        </li>
                        <li>
                           <p>Convert from a date or timestamp to character data.</p>
                        </li>
                        <li>
                           <p>Convert from character data to an interval data type.</p>
                        </li>
                        <li>
                           <p>Convert from an interval data type to a character data.</p>
                        </li>
                        <li>
                           <p>Verify that the length of data value for a character column does not exceed the length limits of that column.</p>
                        </li>
                     </ul>
                     <p>When the access driver encounters an error doing the required conversion or verification, it can decide how to handle the error. When the <code class="codeph">ORACLE_LOADER</code> and <code class="codeph">ORACLE_DATAPUMP</code> access drivers encounter errors, they reject the record and write an error message to the log file.&nbsp;It is as if that record were not in the data source.&nbsp; When the <code class="codeph">ORACLE_HDFS</code> and <code class="codeph">ORACLE_HIVE</code> access drivers encounter errors, the value of the field in which the error is encountered is set to NULL. This is in keeping with the behavior of how Hive handles errors in Hadoop.
                     </p>
                     <p>Even after the access driver has converted the data from the data source to match the data type of the external table columns, the SQL statement that is accessing the external table could require additional data type conversions. If any of these additional conversions encounter an error, then the entire statement fails. (The exception to this is if you use the DML error logging feature in the SQL statement to handle these errors.) These conversions are the same as any that might normally be required when executing a SQL statement. For example, suppose you change the definition of the <code class="codeph">KV_TAB_XT</code> external table to only have columns with character data types, and then you execute an <code class="codeph">INSERT</code> statement to load data from the external table into another table that has a <code class="codeph">NUMBER</code> data type for column <code class="codeph">VAL</code>:
                     </p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE KV_TAB_XT (KEY VARCHAR2(20), VAL VARCHAR2(20))
2 ORGANIZATION EXTERNAL
3 (DEFAULT DIRECTORY DEF_DIR1 LOCATION (‘key_val.csv’));
4 CREATE TABLE KV_TAB (KEY VARCHAR2(4), VAL NUMBER);
5 INSERT INTO KV_TAB SELECT * FROM KV_TAB_XT;</code></pre><p>In this example, the access driver will not reject a record if the data for <code class="codeph">VAL</code> contains a non-numeric character because the data type of <code class="codeph">VAL</code> in the external table is now <code class="codeph">VARCHAR2</code> (instead of <code class="codeph">NUMBER</code>).  However, SQL execution now needs to handle the conversion from character data type in <code class="codeph">KV_TAB_XT</code> to number data type in <code class="codeph">KV_TAB</code>.  If there is a non-numeric character in the value for <code class="codeph">VAL</code> in the external table, then SQL raises a conversion error and rolls back any rows that were inserted. To avoid conversion errors in SQL execution, try to make the data types of the columns in the external table match the data types expected by other tables or functions that will be using the values of those columns.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-7AB423F1-C688-4A1C-A940-77C221839BCA__GUID-5F43FDDF-21F7-4131-9085-CB1DEE6D2D57">Conversion Errors When Writing to External Tables</p>
                     <p>The <code class="codeph">ORACLE_DATAPUMP</code> access driver allows you to use a <code class="codeph">CREATE TABLE AS SELECT</code> statement to unload data into an external table. Data conversion occurs if the data type of a column in the <code class="codeph">SELECT</code> expression does not match the data type of the column in the external table. If SQL encounters an error converting the data type, then SQL aborts the statement and the data file will not be readable.
                     </p>
                     <p>To avoid problems with conversion errors that cause the operation to fail, the data type of the column in the external table should match the data type of the column in the source table or expression used to write to the external table. This is not always possible because external tables do not support all data types. In these cases, the unsupported data types in the source table must be converted into a data type that the external table can support. The following <code class="codeph">CREATE TABLE</code> statement shows an example of this:
                     </p><pre class="pre codeblock"><code>CREATE TABLE LONG_TAB_XT (LONG_COL CLOB) 
ORGANIZATION EXTERNAL...SELECT TO_LOB(LONG_COL) FROM LONG_TAB;</code></pre><p>The source table named <code class="codeph">LONG_TAB</code> has a <code class="codeph">LONG</code> column, therefore the corresponding column in the external table being created, <code class="codeph">LONG_TAB_XT</code>, must be a <code class="codeph">CLOB</code> and the <code class="codeph">SELECT</code> subquery that is used to populate the external table must use the <code class="codeph">TO_LOB</code> operator to load the column.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="oracle-external-tables-concepts.html#GUID-44323E01-7D72-45EC-915A-99E596769D9E" title="The external tables feature is a complement to existing SQL*Loader functionality. It enables you to access data in external sources as if it were in a table in the database.">External Tables Concepts</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>