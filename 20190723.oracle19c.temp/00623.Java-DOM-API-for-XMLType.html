<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">
      <meta name="description" content="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">
      <title>Java DOM API for XMLType</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Developer's Guide ">
      <meta property="og:description" content="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="xml-db-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-30T12:32:42-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96222-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="PLSQL-package-DBMS_XMLSTORE.html" title="Previous" type="text/html">
      <link rel="next" href="C-API-for-XMLType.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML DB Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADXDB">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="PLSQL-package-DBMS_XMLSTORE.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="C-API-for-XMLType.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XMLType-APIs.html" property="item" typeof="WebPage"><span property="name"> XMLType APIs</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Java DOM API for XMLType</li>
            </ol>
            <a id="GUID-4C510052-8A31-4917-8567-0E2825927C54" name="GUID-4C510052-8A31-4917-8567-0E2825927C54"></a><a id="ADXDB1300"></a>
            
            <h2 id="ADXDB-GUID-4C510052-8A31-4917-8567-0E2825927C54" class="sect2"><span class="enumeration_chapter">13 </span> Java DOM API for XMLType
            </h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='Java-DOM-API-for-XMLType'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
            </noscript>
            <div>
               <p>The Java DOM API for <code class="codeph">XMLType</code> lets you operate on <code class="codeph">XMLType</code> instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).
               </p>
               <div class="section"></div>
               <!-- class="section" -->
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-353F087D-90D2-4337-B346-342E002FED36">Overview of Java DOM API for XMLType</a><br>Oracle XML&nbsp;DB supports the Java Document Object Model (DOM) Application Program Interface (API) for <code class="codeph">XMLType</code>. This is a generic API for client and server, for both XML Schema-based and non-schema-based documents. 
                  </li>
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-225EFCBA-435C-4461-A3A1-54FC14AFF530">Access to XMLType Data Using JDBC</a><br>Java Database Connectivity (JDBC) is a SQL-based way for Java applications to access any data in Oracle Database, including XML documents in Oracle XML&nbsp;DB. 
                  </li>
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-2F228754-D548-44F2-8C09-7DFAB1793799">Manipulating XML Database Documents Using JDBC</a><br>You can update, insert, and delete <code class="codeph">XMLType</code> data stored in the database using Java Database Connectivity (JDBC) with Oracle XML&nbsp;DB.
                  </li>
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-B41ECF30-93FD-43D2-9F12-649890E68C52">Loading a Large XML Document into the Database Using JDBC</a><br>To load a large XML document into the database using Java Database Connectivity (JDBC), use a Java <code class="codeph">CLOB</code> object to hold the document, and use Java method <code class="codeph">insertXML()</code> to perform the insertion.
                  </li>
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-AB51C56E-03E8-4B86-8D99-7C59E35F3DAF">MS Windows Java Security Manager Permissions for Java DOM API with a Thick Connection</a><br>If you use Java Security Manager (class <code class="codeph">SecurityManager</code>) on MS Windows to implement a security policy for your application, then you must add certain permissions to your security policy file, in order to use the Java DOM API for <code class="codeph">XMLType</code> with a thick connection.
                  </li>
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-7C93723D-5D83-4444-BD06-216BECAE4983">Creating XML Schema-Based Documents</a><br>To create XML Schema-based documents, Java DOM API for <code class="codeph">XMLType</code> uses an extension to specify which XML schema URL to use. It also verifies that the DOM being created conforms to the specified XML schema, that is, that the appropriate children are being inserted under the appropriate documents.
                  </li>
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-71138EC1-A710-4557-91C0-7CEBE4BD90B5">XMLType Instance Representation in Java (JDBC or SQLJ)</a><br>An <code class="codeph">XMLType</code> instance is represented in Java by <code class="codeph">oracle.xdb.XMLType</code>. When an instance of <code class="codeph">XMLType</code> is fetched using JDBC or a SQLJ client, it is automatically manifested as an object of the provided <code class="codeph">XMLType</code> class. 
                  </li>
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-6144192C-114A-4120-B117-D7FB6B871CDE">Classes of Java DOM API for XMLType</a><br>Oracle XML&nbsp;DB supports the W3C DOM Level 2 Recommendation. It also provides Oracle-specific extensions, to facilitate interfacing your application with Oracle XML Developer's Kit for Java. The Java DOM API for <code class="codeph">XMLType</code> provides classes that implement W3C DOM interfaces.
                  </li>
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-F5F719CF-F383-4677-A655-6329C1E462FA">Using the Java DOM API for XMLType</a><br>Retrieve data from an <code class="codeph">XMLType</code> table or column and obtain a Java <code class="codeph">XMLDocument</code> instance from it. Manipulate elements of the DOM tree for the data using the Java DOM API for <code class="codeph">XMLType</code>.
                  </li>
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-292AD380-743C-4E36-BDD1-039A279006C0">Large XML Node Handling with Java</a><br>Oracle XML&nbsp;DB provides abstract streams and stream-manipulation methods that you can use to handle XML nodes that are larger than 64 K bytes. Use Java classes <code class="codeph">XMLNode</code> and <code class="codeph">XMLAttr</code>, together with a thick or kprb connection, to manipulate large nodes.
                  </li>
                  <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-1234728D-0732-4DC6-82EF-9D372702061F">Using the Java DOM API and JDBC with Binary XML</a><br>You can use the Java DOM API for XML and Java Database Connectivity (JDBC) to read or write XML data that is encoded as binary XML from or to Oracle XML DB. Doing so involves the usual read and write procedures. 
                  </li>
               </ul>
               <div class="relinfo">
                  <p><strong>Related Topics</strong></p>
                  <ul>
                     <li><a href="query-and-update-XML.html#GUID-8F3B9C09-6877-4E43-A6E7-873BF0E74DAB" title="XQuery API for Java (XQJ), also known as JSR-225, provides an industry-standard way for Java programs to access XML data using XQuery. It lets you evaluate XQuery expressions against XML data sources and process the results as XML data.">Using XQuery with XQJ to Access Database Data</a></li>
                  </ul>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="XMLType-APIs.html#GUID-6209297F-DBE4-4F31-85F1-4083BF5BDE01" title="You can use Oracle XML&nbsp;DB XMLType PL/SQL, Java, C APIs, and Oracle Data Provider for .NET (ODP.NET) to access and manipulate XML data.">XMLType APIs</a></p>
                  </div>
               </div>
            </div>
            <a id="ADXDB4931"></a><div class="props_rev_3"><a id="GUID-353F087D-90D2-4337-B346-342E002FED36" name="GUID-353F087D-90D2-4337-B346-342E002FED36"></a><h3 id="ADXDB-GUID-353F087D-90D2-4337-B346-342E002FED36" class="sect3"><span class="enumeration_section">13.1 </span>Overview of Java DOM API for XMLType
               </h3>
               <div>
                  <p>Oracle XML&nbsp;DB supports the Java Document Object Model (DOM) Application Program Interface (API) for <code class="codeph">XMLType</code>. This is a generic API for client and server, for both XML Schema-based and non-schema-based documents. 
                  </p>
                  <p> DOM is a tree-based object representation of XML documents in dynamic memory that enables programmatic access to their elements and attributes. The DOM object and interface are part of a W3C recommendation. As discussed in <a href="PLSQL-APIs-for-XMLType.html#GUID-2D5B2D47-9CFF-49D0-9BD8-114BBE48A289" title="There are several PL/SQL packages that provide APIs for XMLType.">PL/SQL APIs for XMLType</a>, the Oracle XML&nbsp;DB DOM APIs are compliant with the W3C DOM Level 1.0 and Level 2.0 Core Recommendation. 
                  </p>
                  <p>The Java DOM API for <code class="codeph">XMLType</code> handles all well-formed XML documents stored in Oracle XML&nbsp;DB. It presents a uniform view of an XML document, whether it is XML Schema-based or non-schema-based and whatever the underlying <code class="codeph">XMLType</code> storage model. The Java DOM API works on both client and server. 
                  </p>
                  <p>The Java DOM API for <code class="codeph">XMLType</code> can be used to construct an <code class="codeph">XMLType</code> instance from data encoded in different character sets. 
                  </p>
                  <p>You can use the Java DOM API for <code class="codeph">XMLType</code> to access XML documents stored in Oracle XML&nbsp;DB Repository from Java applications. Naming conforms to the Java binding for DOM as specified by the W3C DOM Recommendation. The repository can contain both XML schema-based and non-schema-based documents.
                  </p>
                  <p>To access <code class="codeph">XMLType</code> data using JDBC, use the class <code class="codeph">oracle.xdb.XMLType</code>.
                  </p>
                  <p>The Java DOM API for <code class="codeph">XMLType</code> is implemented using Java package <code class="codeph">oracle.xml.parser.v2</code>.
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-353F087D-90D2-4337-B346-342E002FED36__GUID-7FDBC05D-9534-4E94-9AE2-CD0DE91D2B10">
                     <p class="notep1">See Also:</p>
                     <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB4933"></a><div class="props_rev_3"><a id="GUID-225EFCBA-435C-4461-A3A1-54FC14AFF530" name="GUID-225EFCBA-435C-4461-A3A1-54FC14AFF530"></a><h3 id="ADXDB-GUID-225EFCBA-435C-4461-A3A1-54FC14AFF530" class="sect3"><span class="enumeration_section">13.2 </span>Access to XMLType Data Using JDBC
               </h3>
               <div>
                  <p>Java Database Connectivity (JDBC) is a SQL-based way for Java applications to access any data in Oracle Database, including XML documents in Oracle XML&nbsp;DB. </p>
                  <p>You use Java class <code class="codeph">oracle.xdb.XMLType</code> or Java interface <code class="codeph">java.sql.SQLXML</code> to create XML data.
                  </p>
                  <p>The JDBC 4.0 standard data type for XML data is <code class="codeph">java.sql.SQLXML</code>. Method <code class="codeph">getObject()</code> returns an object of type <code class="codeph">oracle.xdb.XMLType</code>. Starting with Oracle Database 11g Release 2 (11.2.0.3), <code class="codeph">oracle.xdb.XMLType</code> implements interface <code class="codeph">java.sql.SQLXML</code>.
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179">Using JDBC to Access XML Documents in Oracle XML&nbsp;DB</a><br>JDBC users can query an <code class="codeph">XMLType</code> table to obtain a JDBC <code class="codeph">XMLType</code> interface that supports all SQL/XML functions supported by SQL data type <code class="codeph">XMLType</code>. The Java (JDBC) API for <code class="codeph">XMLType</code> interface can implement the DOM document interface. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB4935"></a><a id="ADXDB5887"></a><a id="ADXDB4937"></a><a id="ADXDB4938"></a><a id="ADXDB4934"></a><div class="props_rev_3"><a id="GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179" name="GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179"></a><h4 id="ADXDB-GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179" class="sect4"><span class="enumeration_section">13.2.1 </span>Using JDBC to Access XML Documents in Oracle XML&nbsp;DB
                  </h4>
                  <div>
                     <p>JDBC users can query an <code class="codeph">XMLType</code> table to obtain a JDBC <code class="codeph">XMLType</code> interface that supports all SQL/XML functions supported by SQL data type <code class="codeph">XMLType</code>. The Java (JDBC) API for <code class="codeph">XMLType</code> interface can implement the DOM document interface. 
                     </p>
                     <div class="section">
                        <p><a href="Java-DOM-API-for-XMLType.html#GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179__CHDHEGED">Example 13-1</a> illustrates how to use JDBC to query an <code class="codeph">XMLType</code> table.
                        </p>
                        <p>You can select <code class="codeph">XMLType</code> data using JDBC in any of these ways:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Use SQL/XML function <code class="codeph">XMLSerialize</code> in SQL, and obtain the result as an <code class="codeph">oracle.jdbc.OracleClob</code> or <code class="codeph">java.lang.String</code> instance in Java. The Java snippet in <a href="Java-DOM-API-for-XMLType.html#GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179__CHDGIDFE">Example 13-2</a> illustrates this.
                              </p>
                           </li>
                           <li>
                              <p>Call method <code class="codeph">getSQLXML()</code> in the <code class="codeph">ResultSet</code> to obtain the whole <code class="codeph">SQLXML</code> instance. The return value of this method is of type <code class="codeph">java.sql.SQLXML</code>. Then you can use Java methods in interface <code class="codeph">SQLXML</code> to access the data. <a href="Java-DOM-API-for-XMLType.html#GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179__CHDJJHCE">Example 13-3</a> shows how to do this.
                              </p>
                           </li>
                        </ul>
                        <p><a href="Java-DOM-API-for-XMLType.html#GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179__CHDJJHCE">Example 13-3</a> shows the use of method <code class="codeph">getObject()</code> to directly obtain an <code class="codeph">XMLType</code> instance from <code class="codeph">ResultSet</code>.
                        </p>
                        <p><a href="Java-DOM-API-for-XMLType.html#GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179__CHDGFDCD">Example 13-4</a> shows how to bind an output parameter of type <code class="codeph">XMLType</code> to a SQL statement. The output parameter is registered as having data type <code class="codeph">XMLType</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179__CHDHEGED">
                        <p class="titleinexample">Example 13-1 Querying an XMLType Table Using JDBC</p><pre class="pre codeblock"><code>PreparedStatement statement = connection.prepareStatement("SELECT e.poDoc FROM po_xml_tab e"); 

ResultSet resultSet = statement.executeQuery();

while(resultSet.next())
{
  // Get result as SQLXML data.
  // Use that to get a DomSource instance.
  SQLXML sqlXml = resultSet.<span class="bold">getSQLXML</span>(1);
  DomSource source = sqlXml.<span class="bold">getSource</span>(DOMSource.class);

  // Get document from the DomSource instance as a DOM node.
  Document document = (Document) source.<span class="bold">getNode</span>();
  
  // Use the document object
  ...
}</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179__CHDGIDFE">
                        <p class="titleinexample">Example 13-2 Selecting XMLType Data Using getString() and getCLOB()</p><pre class="pre codeblock"><code>PreparedStatement statement = connection.prepareStatement(
  "SELECT <span class="bold">XMLSerialize</span>(DOCUMENT e.poDoc <span class="bold">AS CLOB</span>) poDoc, " +
  "<span class="bold">XMLSerialize</span>(DOCUMENT e.poDoc <span class="bold">AS VARCHAR2(2000)</span>) poString " +
  " FROM po_xml_tab e");
     
ResultSet resultSet = statement.executeQuery();
while(resultSet.next())
{
  // The first result is an OracleClob instance
  <span class="bold">OracleClob</span> clob = resultSet.<span class="bold">getClob</span>(1));
  
  // The second result is a String instance
  String poString = resultSet.<span class="bold">getString</span>(2);

  // Use clob and poString
  ... 
}</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179__CHDJJHCE">
                        <p class="titleinexample">Example 13-3 Returning XMLType Data Using getSQLXML()</p><pre class="pre codeblock"><code>PreparedStatement statement = connection.prepareStatement(
                           "SELECT e.poDoc FROM po_xml_tab e"); 

ResultSet resultSet = statement.executeQuery(); 

while(resultSet.next())
{ 
  // Get the SQLXML
  SQLXML sqlXml = resultSet.<span class="bold">getSQLXML</span>(1); 

  // Convert the SQLXML to an xmlString instance
  String xmlString = sqlXml.<span class="bold">getString</span>();

  //Use the xmlString instance
  ...
}</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-01FFCF6C-0197-417E-B1E6-6CF2FF770179__CHDGFDCD">
                        <p class="titleinexample">Example 13-4 Returning XMLType Data Using an Output Parameter</p><pre class="pre codeblock"><code>public void doCall (String[] args) throws Exception 
{ 
  //  CREATE OR REPLACE FUNCTION getPurchaseOrder(reference VARCHAR2) 
  //  RETURN XMLTYPE 
  //  AS 
  //    xml XMLTYPE; 
  //  BEGIN 
  //    SELECT OBJECT_VALUE INTO xml 
  //      FROM purchaseorder 
  //      WHERE XMLCast(XMLQuery('$p/PurchaseOrder/Reference'
  //                             PASSING OBJECT_VALUE AS "p" RETURNING CONTENT)
  //                    AS VARCHAR2(30))
  //            = reference;
  //      RETURN xml; 
  //  END;
  
  String SQLTEXT = "{? = call getPurchaseOrder('BLAKE-2002100912333601PDT')}"; 
  super.doSomething(args); 
  createConnection(); 
  try 
  { 
    System.out.println("SQL := " + SQLTEXT); 
    CallableStatement sqlStatement = getConnection().prepareCall(SQLTEXT); 
    sqlStatement.<span class="bold">registerOutParameter</span> (1, java.sql.Types.SQLXML); 
    sqlStatement.execute(); 

    SQLXML sqlXml = sqlStatement.<span class="bold">getSQLXML</span>(1); 
    System.out.println(sqlXml.<span class="bold">getString</span>()); 
  } 
  catch (SQLException exception) 
  { 
    if (sqlStatement != null) 
    { 
      sqlStatement.close(); 
      throw exception; 
    } 
  }
}</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-225EFCBA-435C-4461-A3A1-54FC14AFF530" title="Java Database Connectivity (JDBC) is a SQL-based way for Java applications to access any data in Oracle Database, including XML documents in Oracle XML&nbsp;DB.">Access to XMLType Data Using JDBC</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDB5889"></a><a id="ADXDB5890"></a><a id="ADXDB4941"></a><a id="ADXDB4942"></a><a id="ADXDB5891"></a><a id="ADXDB5892"></a><a id="ADXDB4939"></a><div class="props_rev_3"><a id="GUID-2F228754-D548-44F2-8C09-7DFAB1793799" name="GUID-2F228754-D548-44F2-8C09-7DFAB1793799"></a><h3 id="ADXDB-GUID-2F228754-D548-44F2-8C09-7DFAB1793799" class="sect3"><span class="enumeration_section">13.3 </span>Manipulating XML Database Documents Using JDBC
               </h3>
               <div>
                  <p>You can update, insert, and delete <code class="codeph">XMLType</code> data stored in the database using Java Database Connectivity (JDBC) with Oracle XML&nbsp;DB.
                  </p>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-2F228754-D548-44F2-8C09-7DFAB1793799__GUID-6BBA39E0-1407-4055-A108-5DBEB6E92930">
                        <p class="notep1">Note:</p>
                        <p><code class="codeph">XMLType</code> method <code class="codeph">transform()</code> works only with the OCI driver. 
                        </p>
                        <p>Not all <code class="codeph">oracle.xdb.XMLType</code> functions are supported by the thin JDBC driver. If you do not use <code class="codeph">oracle.xdb.XMLType</code> classes and the OCI driver, you could lose performance benefits associated with the intelligent handling of XML.
                        </p>
                     </div>
                     <p>You can update, insert, or delete <code class="codeph">XMLType</code> data in either of these ways:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Bind a string to an <code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, or <code class="codeph">DELETE</code> statement, and use the <code class="codeph">XMLType</code> constructor inside SQL to construct the XML instance. <a href="Java-DOM-API-for-XMLType.html#GUID-2F228754-D548-44F2-8C09-7DFAB1793799__CHDJFABC">Example 13-5</a> illustrates this.
                           </p>
                        </li>
                        <li>
                           <p>Use <code class="codeph">setSQLXML()</code> in a <code class="codeph">PreparedStatement</code> instance to set an entire <code class="codeph">XMLType</code> instance. <a href="Java-DOM-API-for-XMLType.html#GUID-2F228754-D548-44F2-8C09-7DFAB1793799__CHDJBADD">Example 13-6</a> illustrates this.
                           </p>
                        </li>
                     </ul>
                     <p>When selecting <code class="codeph">SQLXML</code> values, JDBC describes the column as <code class="codeph">SQLXML</code>. You can select the column type name and compare it with <code class="codeph">SQLXML</code> to see whether you are dealing with a <code class="codeph">SQLXML</code> instance. <a href="Java-DOM-API-for-XMLType.html#GUID-2F228754-D548-44F2-8C09-7DFAB1793799__I1031938">Example 13-7</a> illustrates this.
                     </p>
                     <p><a href="Java-DOM-API-for-XMLType.html#GUID-2F228754-D548-44F2-8C09-7DFAB1793799__I1031963">Example 13-8</a> updates element <code class="codeph">discount</code> inside element <code class="codeph">PurchaseOrder</code> stored in an <code class="codeph">XMLType</code> column. It uses JDBC and <code class="codeph">SQLXML</code>. It uses the XML parser to update a DOM tree and write the updated XML value to the <code class="codeph">XMLType</code> column.
                     </p>
                     <p><a href="Java-DOM-API-for-XMLType.html#GUID-2F228754-D548-44F2-8C09-7DFAB1793799__CHDBDGFB">Example 13-9</a> shows the updated purchase order that results from <a href="Java-DOM-API-for-XMLType.html#GUID-2F228754-D548-44F2-8C09-7DFAB1793799__I1031963">Example 13-8</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-2F228754-D548-44F2-8C09-7DFAB1793799__CHDJFABC">
                     <p class="titleinexample">Example 13-5 Updating an XMLType Column Using SQL Constructor XMLType and Java String</p><pre class="pre codeblock"><code>PreparedStatement statement =
    connection.prepareStatement("UPDATE po_xml_tab SET poDoc = <span class="bold">XMLType</span>(?)");

String poString = "&lt;PO&gt;&lt;PONO&gt;200&lt;/PONO&gt;&lt;PNAME&gt;PO_2&lt;/PNAME&gt;&lt;/PO&gt;";

// Bind the string
statement.setString(1,poString);
statement.execute();</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-2F228754-D548-44F2-8C09-7DFAB1793799__CHDJBADD">
                     <p class="titleinexample">Example 13-6 Updating an XMLType Column Using SQLXML</p><pre class="pre codeblock"><code>PreparedStatement statement =
    connection.prepareStatement("UPDATE po_xml_tab SET poDoc = ?");

String xmlString = "&lt;PO&gt;&lt;PONO&gt;200&lt;/PONO&gt;&lt;PNAME&gt;PO_2&lt;/PNAME&gt;&lt;/PO&gt;";
SQLXML sqlXml = connection.createSQLXML();
sqlXml.setString(xmlString);

// Bind the SQLXML
statement.<span class="bold">setSQLXML</span>(1, sqlXml);
statement.execute();</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-2F228754-D548-44F2-8C09-7DFAB1793799__I1031938">
                     <p class="titleinexample">Example 13-7 Retrieving Metadata About an XMLType Column Using JDBC</p><pre class="pre codeblock"><code>PreparedStatement statement =
    connection.prepareStatement("SELECT poDoc FROM po_xml_tab");
ResultSet resultSet = statement.executeQuery();

// Get the resultSet metadata
ResultSetMetaData mdata = (ResultSetMetaData)resultSet.<span class="bold">getMetaData</span>();

// The column type is SQLXML
if (mdata.getColumnType(1) == java.sql.Types.SQLXML)
{
  // It is a SQLXML instance
}</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-2F228754-D548-44F2-8C09-7DFAB1793799__I1031963">
                     <p class="titleinexample">Example 13-8 Updating an XMLType Column Using JDBC</p><pre class="pre codeblock"><code>public class UpdateXMLType
{
  static String qryStr =
    "SELECT x.poDoc from po_xml_tab x " +
    "WHERE XMLCast(XMLQuery('/PO/PONO/text()'" +
    " PASSING x.poDoc RETURNING CONTENT)" +
    " AS NUMBER)" +
    " = 200";

  static String updateXML(String xmlTypeStr)
  {
    System.out.println("\n===============================");
    System.out.println(xmlTypeStr);
    System.out.println("===============================");
    String outXML = null;

    try
    {
      DOMParser parser = new DOMParser();
      parser.setValidationMode(false);
      parser.setPreserveWhitespace (true);
      parser.parse(new StringReader(xmlTypeStr));

      System.out.println("XML string is well-formed");
      XMLDocument document = parser.getDocument();
      NodeList nl = document.getElementsByTagName("<span class="bold">DISCOUNT</span>");

      for(int i=0;i&lt;nl.getLength();i++)      {
        XMLElement discount = (XMLElement)nl.item(i);
        XMLNode textNode    = (XMLNode)discount.getFirstChild();
        textNode.setNodeValue("10");
      }

      StringWriter sw = new StringWriter();
      document.print(new PrintWriter(sw));
      outXML = sw.toString();

      //Print modified xml
      System.out.println("\n===============================");
      System.out.println("Updated PurchaseOrder:");
      System.out.println(outXML);
      System.out.println("===============================");
    }
    catch (Exception e)
    {
      e.printStackTrace(System.out);
    }
    return outXML;
  }

  public static void main(String args[]) throws Exception
  {
    try
    {
      PreparedStatement statement = connection.createStatement();
      ResultSet resultSet = statement.executeQuery(qryStr);

      while(orset.next())
      {
        //retrieve PurchaseOrder xml document from database
        SQLXML sqlXml = resultSet.getSQLXML(1);

        //store this PurchaseOrder in po_xml_hist table
        statement = connection.prepareStatement("INSERT INTO po_xml_hist VALUES(?)");
        statement.setSQLXML(1,sqlXml); // bind the SQLXML instance
        statement.execute();

        //update "DISCOUNT" element
        String newXML = updateXML(sqlXml.getString());
        // create a new instance of an XMLtype from the updated value
        SQLXML sqlXml2 = connection.createSQLXML();
        sqlXml2.setString(newXml);
        
        // update PurchaseOrder xml document in database
        statement = connection.prepareStatement(
                       "UPDATE po_xml_tab x SET x.poDoc =? WHERE " +
                       "XMLCast(XMLQuery('/PO/PONO/text()'" +
                       " PASSING value(xmltab) RETURNING CONTENT)" +
                       " AS NUMBER)" +
                       "= 200");

        statement.setSQLXML(1, sqlXml2); // bind the XMLType instance
        statement.execute();
        connection.commit();
        System.out.println("PurchaseOrder 200 Updated!");
      }

      //delete PurchaseOrder 1001
      statement.execute("DELETE FROM po_xml x WHERE" +
                        "XMLCast(XMLQuery('/PurchaseOrder/PONO/text()'" +
                        " PASSING value(xmltab) RETURNING CONTENT)" +
                        " AS NUMBER)" +
                        "= 1001");

      System.out.println("PurchaseOrder 1001 deleted!");
    }
    catch(Exception e)
    {
      e.printStackTrace(System.out);
    }
  }
}
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-2F228754-D548-44F2-8C09-7DFAB1793799__CHDBDGFB">
                     <p class="titleinexample">Example 13-9 Updated Purchase-Order Document</p><pre class="pre codeblock"><code>&lt;?xml version = "1.0"?&gt;
&lt;PurchaseOrder&gt;
  &lt;PONO&gt;200&lt;/PONO&gt;
  &lt;CUSTOMER&gt;
   &lt;CUSTNO&gt;2&lt;/CUSTNO&gt;
   &lt;CUSTNAME&gt;John Nike&lt;/CUSTNAME&gt;
   &lt;ADDRESS&gt;
    &lt;STREET&gt;323 College Drive&lt;/STREET&gt;
    &lt;CITY&gt;Edison&lt;/CITY&gt;
    &lt;STATE&gt;NJ&lt;/STATE&gt;
    &lt;ZIP&gt;08820&lt;/ZIP&gt;
   &lt;/ADDRESS&gt;
   &lt;PHONELIST&gt;
    &lt;VARCHAR2&gt;609-555-1212&lt;/VARCHAR2&gt;
    &lt;VARCHAR2&gt;201-555-1212&lt;/VARCHAR2&gt;
   &lt;/PHONELIST&gt;
  &lt;/CUSTOMER&gt;
  &lt;ORDERDATE&gt;20-APR-97&lt;/ORDERDATE&gt;
  &lt;SHIPDATE&gt;20-MAY-97 12.00.00.000000 AM&lt;/SHIPDATE&gt;
  &lt;LINEITEMS&gt;
   &lt;LINEITEM_TYP LineItemNo="1"&gt;
    &lt;ITEM StockNo="1004"&gt;
     &lt;PRICE&gt;6750&lt;/PRICE&gt;
     &lt;TAXRATE&gt;2&lt;/TAXRATE&gt;
    &lt;/ITEM&gt;
    &lt;QUANTITY&gt;1&lt;/QUANTITY&gt;
    <span class="bold">&lt;DISCOUNT&gt;10&lt;/DISCOUNT&gt;</span>
   &lt;/LINEITEM_TYP&gt;
   &lt;LINEITEM_TYP LineItemNo="2"&gt;
    &lt;ITEM StockNo="1011"&gt;
     &lt;PRICE&gt;4500.23&lt;/PRICE&gt;
     &lt;TAXRATE&gt;2&lt;/TAXRATE&gt;
    &lt;/ITEM&gt;
    &lt;QUANTITY&gt;2&lt;/QUANTITY&gt;
    <span class="bold">&lt;DISCOUNT&gt;10&lt;/DISCOUNT&gt;</span>
   &lt;/LINEITEM_TYP&gt;
  &lt;/LINEITEMS&gt;
  &lt;SHIPTOADDR&gt;
   &lt;STREET&gt;55 Madison Ave&lt;/STREET&gt;
   &lt;CITY&gt;Madison&lt;/CITY&gt;
   &lt;STATE&gt;WI&lt;/STATE&gt;
   &lt;ZIP&gt;53715&lt;/ZIP&gt;
  &lt;/SHIPTOADDR&gt;
&lt;/PurchaseOrder&gt;
</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB5893"></a><a id="ADXDB5894"></a><a id="ADXDB4944"></a><div class="props_rev_3"><a id="GUID-B41ECF30-93FD-43D2-9F12-649890E68C52" name="GUID-B41ECF30-93FD-43D2-9F12-649890E68C52"></a><h3 id="ADXDB-GUID-B41ECF30-93FD-43D2-9F12-649890E68C52" class="sect3"><span class="enumeration_section">13.4 </span>Loading a Large XML Document into the Database Using JDBC
               </h3>
               <div>
                  <p>To load a large XML document into the database using Java Database Connectivity (JDBC), use a Java <code class="codeph">CLOB</code> object to hold the document, and use Java method <code class="codeph">insertXML()</code> to perform the insertion.
                  </p>
                  <div class="section">
                     <p>If a large XML document (greater than 4000 characters, typically) is inserted into an <code class="codeph">XMLType</code> table or column using a <code class="codeph">String</code> object in JDBC, this run-time error occurs:
                     </p><pre class="oac_no_warn" dir="ltr">"java.sql.SQLException: Data size bigger than max size for this type"
</pre><p>This error can be avoided by using a Java <code class="codeph">OracleClob</code> object to hold the large XML document. <a href="Java-DOM-API-for-XMLType.html#GUID-B41ECF30-93FD-43D2-9F12-649890E68C52__CHDCHFIG">Example 13-10</a> shows code that uses this technique. It defines <code class="codeph">XMLType</code> method <code class="codeph">insertXML()</code>, which can be used to insert a large XML document into <code class="codeph">XMLType</code> column <code class="codeph">purchaseOrder</code> of table <code class="codeph">poTable</code>. The same approach can be used for an <code class="codeph">XMLType</code> table. 
                     </p>
                     <p>Method <code class="codeph">insertXML()</code> uses an <code class="codeph">OracleClob</code> object that contains the XML document. Interface <code class="codeph">OracleClob</code> is a sub-interface of the standard JDBC interface <code class="codeph">java.sql.Clob</code>. Method <code class="codeph">insertXML()</code> binds the <code class="codeph">OracleClob</code> object to a JDBC prepared statement, which inserts the data into the <code class="codeph">XMLType</code> column.
                     </p>
                     <p>The prerequisites for using <code class="codeph">insertXML()</code> are as follows:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Oracle Database, release 9.2.0.1 or later.</p>
                        </li>
                        <li>
                           <p>The target database table. Execute the following SQL before running the example:</p>
                           <p><code class="codeph">CREATE TABLE poTable (purchaseOrder XMLType);</code></p>
                        </li>
                     </ul>
                     <p>The formal parameters of <code class="codeph">XMLType</code> method <code class="codeph">insertXML()</code> are as follows:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="italic"><code class="codeph">xmlString</code></span> &#x2013; XML data to be inserted into the <code class="codeph">XMLType</code> column
                           </p>
                        </li>
                        <li>
                           <p><span class="italic"><code class="codeph">connection</code></span> &#x2013; database connection object (Oracle Connection Object)
                           </p>
                        </li>
                     </ul>
                     <p>Java method <code class="codeph">insertXML()</code> calls method <code class="codeph">getCLOB()</code> to create and return the <code class="codeph">CLOB</code> object that holds the XML data. The formal parameters of method <code class="codeph">getCLOB()</code>, which is defined in <a href="Java-DOM-API-for-XMLType.html#GUID-B41ECF30-93FD-43D2-9F12-649890E68C52__CHDFFDJH">Example 13-11</a>, are as follows:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="italic"><code class="codeph">xmlString</code></span> &#x2013; XML data to be inserted into the <code class="codeph">XMLType</code> column
                           </p>
                        </li>
                        <li>
                           <p><span class="italic"><code class="codeph">connection</code></span> &#x2013; database connection object (Oracle Connection Object)
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-B41ECF30-93FD-43D2-9F12-649890E68C52__GUID-853A0A6C-0A7D-41F8-AD92-FF2658A0AE06">
                        <p class="notep1">See Also:</p>
                        <p><a href="../adlob/overview-of-supplied-LOB-APIs.html#ADLOB45482" target="_blank"><span><cite>Oracle Database SecureFiles and Large Objects Developer's Guide</cite></span></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-B41ECF30-93FD-43D2-9F12-649890E68C52__CHDCHFIG">
                     <p class="titleinexample">Example 13-10 Inserting an XMLType column using JDBC</p><pre class="oac_no_warn" dir="ltr">private void <span class="bold">insertXML</span>(Connection connection, String xmlString)
{
  OracleClob clob = null;
  try
  {
    String query = "INSERT INTO potable (purchaseOrder) VALUES (XMLType(?)) ";

    // Get the statement Object
    PreparedStatement statement = connection.prepareStatement(query);

    // Get the OracleClob instance from xmlString
    clob = <span class="bold">getOracleClob</span>(connection, xmlString);
    statement.setObject(1, clob);

    // Execute the prepared statement
    if (statement.executeUpdate () == 1)
    {
      System.out.println ("Successfully inserted a Purchase Order");
    }
  }
  catch(Exception exp)
  {
    exp.printStackTrace();
  }
  finally 
  {
    if(clob !=null)
      clob.close();
  }
}</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-B41ECF30-93FD-43D2-9F12-649890E68C52__CHDFFDJH">
                     <p class="titleinexample">Example 13-11 Converting an XML String to an OracleClob Instance</p><pre class="oac_no_warn" dir="ltr">private OracleClob <span class="bold">getOracleClob</span>(Connection connection, String xmlString) throws SQLException
{
    OracleClob clob =(OracleClob) connection.createClob();
    clob.setString(1, xmlString);
    return clob;
}</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB6347"></a><a id="ADXDB6346"></a><div class="props_rev_3"><a id="GUID-AB51C56E-03E8-4B86-8D99-7C59E35F3DAF" name="GUID-AB51C56E-03E8-4B86-8D99-7C59E35F3DAF"></a><h3 id="ADXDB-GUID-AB51C56E-03E8-4B86-8D99-7C59E35F3DAF" class="sect3"><span class="enumeration_section">13.5 </span>MS Windows Java Security Manager Permissions for Java DOM API with a Thick Connection 
               </h3>
               <div>
                  <p>If you use Java Security Manager (class <code class="codeph">SecurityManager</code>) on MS Windows to implement a security policy for your application, then you must add certain permissions to your security policy file, in order to use the Java DOM API for <code class="codeph">XMLType</code> with a thick connection.
                  </p>
                  <p><a href="Java-DOM-API-for-XMLType.html#GUID-AB51C56E-03E8-4B86-8D99-7C59E35F3DAF__CACBACJG">Example 13-12</a> shows the contents of such a policy file, where the workspace folder that contains the jars related to Oracle XML&nbsp;DB is <code class="codeph">c:\myworkspace</code>. (The policy file must be in the same folder.)
                  </p>
                  <p>The libraries used in <a href="Java-DOM-API-for-XMLType.html#GUID-AB51C56E-03E8-4B86-8D99-7C59E35F3DAF__CACBACJG">Example 13-12</a> are <code class="codeph">orageneric12</code> and <code class="codeph">oraxml12</code>. The last two characters (<code class="codeph">12</code> here) must correspond to your major database release number (so for Oracle Database 13 Release 2, for example, you would use <code class="codeph">orageneric</code><span class="bold"><code class="codeph">13</code></span> and <code class="codeph">oraxml</code><span class="bold"><code class="codeph">13</code></span>). 
                  </p>
                  <p>After you have created the policy file, you can invoke your program using the following command-line switches:</p><pre class="pre codeblock"><code>-Djava.security.manager=default -Djava.security.policy=c:\myworkspace\ojdbc.policy</code></pre><div class="example" id="GUID-AB51C56E-03E8-4B86-8D99-7C59E35F3DAF__CACBACJG">
                     <p class="titleinexample">Example 13-12 Policy File Granting Permissions for Java DOM API</p><pre class="pre codeblock"><code>grant codeBase "file:<code class="codeph">c:\myworkspace</code>" {
  permission java.lang.RuntimePermission "loadLibrary.orageneric12";
  permission java.lang.RuntimePermission "loadLibrary.oraxml12";
}
 
grant codeBase "file:c:\myworkspace\<span class="bold">xdb6.jar</span>" {
  permission java.lang.RuntimePermission "loadLibrary.orageneric12";
  permission java.lang.RuntimePermission "loadLibrary.oraxml12";
}
 
grant codeBase "file:c:\myworkspace\<span class="bold">ojdbc6.jar</span>" {
  permission java.lang.RuntimePermission "loadLibrary.orageneric12";
  permission java.lang.RuntimePermission "loadLibrary.oraxml12";
}
</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB4948"></a><a id="ADXDB4947"></a><div class="props_rev_3"><a id="GUID-7C93723D-5D83-4444-BD06-216BECAE4983" name="GUID-7C93723D-5D83-4444-BD06-216BECAE4983"></a><h3 id="ADXDB-GUID-7C93723D-5D83-4444-BD06-216BECAE4983" class="sect3"><span class="enumeration_section">13.6 </span>Creating XML Schema-Based Documents
               </h3>
               <div>
                  <p>To create XML Schema-based documents, Java DOM API for <code class="codeph">XMLType</code> uses an extension to specify which XML schema URL to use. It also verifies that the DOM being created conforms to the specified XML schema, that is, that the appropriate children are being inserted under the appropriate documents.
                  </p>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-7C93723D-5D83-4444-BD06-216BECAE4983__GUID-28F18FFC-0830-4BFA-97ED-B50F1CF9957F">
                        <p class="notep1">Note:</p>
                        <p>The Java DOM API for <code class="codeph">XMLType</code> does <span class="italic">not</span> perform type and constraint checks.
                        </p>
                     </div>
                     <p>Once the DOM object has been created, it can be saved to Oracle XML&nbsp;DB Repository using the Oracle XML&nbsp;DB resource API for Java. The XML document is stored in the appropriate format:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>As a BLOB instance for non-schema-based documents.</p>
                        </li>
                        <li>
                           <p>In the format specified by the XML schema for XML schema-based documents.</p>
                        </li>
                     </ul>
                     <p><a href="Java-DOM-API-for-XMLType.html#GUID-7C93723D-5D83-4444-BD06-216BECAE4983__CHDGCCEB">Example 13-13</a> shows how you can use the Java DOM API for <code class="codeph">XMLType</code> to create a DOM object and store it in the format specified by the associated XML schema. Validation against the XML schema is not shown here.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-7C93723D-5D83-4444-BD06-216BECAE4983__CHDGCCEB">
                     <p class="titleinexample">Example 13-13 Creating a DOM Object with the Java DOM API</p><pre class="pre codeblock"><code>PreparedStatement statement = connection.prepareStatement(
                                "update po_xml_XMLTypetab set poDoc = ? ");                              
String xmlString = "&lt;PO&gt;&lt;PONO&gt;200&lt;/PONO&gt;&lt;PNAME&gt;PO_2&lt;/PNAME&gt;&lt;/PO&gt;";

OracleClob clob = (OracleClob)connection.createClob();
clob.setString(1, xmlString);
SQLXML sqlXml    = clob.toSQLXML();

DOMSource domSource = sqlXml.getSource(DOMSource.class);
Document  document  = (Document) domSource.getNode();
Element   rootElem  = document.createElement("PO");
document.insertBefore(document, rootElem, null);

SQLXML sqlXml2 = clob.toSQLXML();

DOMResult domResult = sqlXml2.setResult(DomResult.class);
domResult.setNode(document);
statement.setSQLXML(1, sqlXml2);
statement.execute();</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB4949"></a><div class="props_rev_3"><a id="GUID-71138EC1-A710-4557-91C0-7CEBE4BD90B5" name="GUID-71138EC1-A710-4557-91C0-7CEBE4BD90B5"></a><h3 id="ADXDB-GUID-71138EC1-A710-4557-91C0-7CEBE4BD90B5" class="sect3"><span class="enumeration_section">13.7 </span>XMLType Instance Representation in Java (JDBC or SQLJ)
               </h3>
               <div>
                  <p>An <code class="codeph">XMLType</code> instance is represented in Java by <code class="codeph">oracle.xdb.XMLType</code>. When an instance of <code class="codeph">XMLType</code> is fetched using JDBC or a SQLJ client, it is automatically manifested as an object of the provided <code class="codeph">XMLType</code> class. 
                  </p>
                  <p>You can bind objects of this class as values to Data Manipulation Language (DML) statements where an <code class="codeph">XMLType</code> is expected.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB4951"></a><a id="ADXDB4950"></a><div class="props_rev_3"><a id="GUID-6144192C-114A-4120-B117-D7FB6B871CDE" name="GUID-6144192C-114A-4120-B117-D7FB6B871CDE"></a><h3 id="ADXDB-GUID-6144192C-114A-4120-B117-D7FB6B871CDE" class="sect3"><span class="enumeration_section">13.8 </span>Classes of Java DOM API for XMLType
               </h3>
               <div>
                  <p>Oracle XML&nbsp;DB supports the W3C DOM Level 2 Recommendation. It also provides Oracle-specific extensions, to facilitate interfacing your application with Oracle XML Developer's Kit for Java. The Java DOM API for <code class="codeph">XMLType</code> provides classes that implement W3C DOM interfaces.
                  </p>
                  <p><code class="codeph">XMLDocument</code> is a class that represents the DOM for the instantiated XML document. You can retrieve a <code class="codeph">SQLXML</code> instance from a document and a connection object as follows:
                  </p><pre class="pre codeblock"><code>SQLXML sqlXml = connection.createSQLXML();
DOMResult domResult = sqlXml.setResult(DOMResult.class);
domResult.setNode(document);</code></pre><p><a href="Java-DOM-API-for-XMLType.html#GUID-6144192C-114A-4120-B117-D7FB6B871CDE__CACFFCEG" title="This table describes the Java DOM API for XMLType classes. It includes a listing of the equivalent W3C classes.">Table 13-1</a> lists the Java DOM API for <code class="codeph">XMLType</code> classes and the W3C DOM interfaces they implement. The Java DOM API classes are in package <code class="codeph">oracle.xml.parser.v2</code>.
                  </p>
                  <div class="tblformal" id="GUID-6144192C-114A-4120-B117-D7FB6B871CDE__CACFFCEG">
                     <p class="titleintable">Table 13-1 Java DOM API for XMLType: Classes</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Java DOM API for XMLType: Classes" summary="This table describes the Java DOM API for XMLType classes. It includes a listing of the equivalent W3C classes." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="43%" id="d73809e1286">Java DOM API for XMLType Class</th>
                              <th align="left" valign="bottom" width="57%" id="d73809e1289">W3C DOM Interface Recommendation Class</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1294" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLDocument</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1294 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.Document </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1301" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLCDATA</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1301 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.CDataSection </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1308" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLComment</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1308 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.Comment </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1315" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLPI</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1315 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.ProcessingInstruction </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1322" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLText </pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1322 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.Text </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1329" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLEntity</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1329 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.Entity </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1336" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">DTD</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1336 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.DocumentType </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1343" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLNotation</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1343 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.Notation </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1350" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLAttr</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1350 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.Attribute </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1357" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLDomImplementation</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1357 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.DOMImplementation </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1364" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLElement</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1364 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.Element </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1372" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLAttrList</pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1372 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.NamedNodeMap </pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="43%" id="d73809e1379" headers="d73809e1286 "><pre class="oac_no_warn" dir="ltr">XMLNode </pre></td>
                              <td align="left" valign="top" width="57%" headers="d73809e1379 d73809e1289 "><pre class="oac_no_warn" dir="ltr">org.w3c.dom.Node </pre></td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-6144192C-114A-4120-B117-D7FB6B871CDE__GUID-4A9A738F-C544-4D3A-9A32-EA60E66C8C5A">
                     <p class="notep1">See Also:</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdb&amp;id=otn_db_xmldb_overview" target="_blank">Oracle XML DB on OTN</a> for Oracle extensions for interfacing an application with Oracle XML Developer's Kit for Java
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB4954"></a><a id="ADXDB4953"></a><div class="props_rev_3"><a id="GUID-F5F719CF-F383-4677-A655-6329C1E462FA" name="GUID-F5F719CF-F383-4677-A655-6329C1E462FA"></a><h3 id="ADXDB-GUID-F5F719CF-F383-4677-A655-6329C1E462FA" class="sect3"><span class="enumeration_section">13.9 </span>Using the Java DOM API for XMLType
               </h3>
               <div>
                  <p>Retrieve data from an <code class="codeph">XMLType</code> table or column and obtain a Java <code class="codeph">XMLDocument</code> instance from it. Manipulate elements of the DOM tree for the data using the Java DOM API for <code class="codeph">XMLType</code>.
                  </p>
                  <div class="section">
                     <p>The Java DOM API for <code class="codeph">XMLType</code> lets you find and retrieve nodes within a document at any level. You can use it to create XML documents programmatically, including on the fly (dynamically). These documents can conform to a registered XML schema or not. The Java API for <code class="codeph">XMLType</code> conforms to the DOM 2.0 recommendation, and it is namespace-aware.
                     </p>
                     <p><a href="Java-DOM-API-for-XMLType.html#GUID-F5F719CF-F383-4677-A655-6329C1E462FA__I1031454">Figure 13-1</a> illustrates how to use the Java DOM API for <code class="codeph">XMLType</code>.<a id="fn_1" name="fn_1" href="#fn_1" onclick="footdisplay(1, "This assumes that your XML data is pre-registered with an XML schema, and that it is stored in an XMLType column.")"><sup>Foot&nbsp;1</sup></a> These are the steps:
                     </p>
                     <ol>
                        <li>
                           <p>Retrieve the XML data from the <code class="codeph">XMLType</code> table or <code class="codeph">XMLType</code> column in the table. When you fetch XML data, Oracle creates a <code class="codeph">Document</code> instance. You can then use method <code class="codeph">getNode()</code> to retrieve an <code class="codeph">XMLDocument</code> instance. 
                           </p>
                        </li>
                        <li>
                           <p>Use the Java DOM API for <code class="codeph">XMLType</code> to manipulate elements of the DOM tree. The <code class="codeph">XMLType</code> instance holds the modified data, but the data is sent back using a JDBC update.
                           </p>
                        </li>
                     </ol>
                     <p>The <code class="codeph">XMLType</code> and <code class="codeph">XMLDocument</code> instances should be closed using method <code class="codeph">free()</code> in the respective classes. This frees any underlying memory that is held.
                     </p>
                     <div class="figure" id="GUID-F5F719CF-F383-4677-A655-6329C1E462FA__I1031454">
                        <p class="titleinfigure">Figure 13-1 Using the Java DOM API for XMLType</p><img src="img/adxdb024b.png" width="292" alt="Description of Figure 13-1 follows" title="Description of Figure 13-1 follows" longdesc="img_text/adxdb024b.html"><br><a href="img_text/adxdb024b.html">Description of "Figure 13-1 Using the Java DOM API for XMLType"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB1150"></a><div class="props_rev_3"><a id="GUID-292AD380-743C-4E36-BDD1-039A279006C0" name="GUID-292AD380-743C-4E36-BDD1-039A279006C0"></a><h3 id="ADXDB-GUID-292AD380-743C-4E36-BDD1-039A279006C0" class="sect3"><span class="enumeration_section">13.10 </span>Large XML Node Handling with Java
               </h3>
               <div>
                  <p>Oracle XML&nbsp;DB provides abstract streams and stream-manipulation methods that you can use to handle XML nodes that are larger than 64 K bytes. Use Java classes <code class="codeph">XMLNode</code> and <code class="codeph">XMLAttr</code>, together with a thick or kprb connection, to manipulate large nodes.
                  </p>
                  <div class="infoboxnote" id="GUID-292AD380-743C-4E36-BDD1-039A279006C0__GUID-221D5813-F9B6-44D4-B048-142BF6FF7A49">
                     <p class="notep1">Note:</p>
                     <p>The large-node feature works only with a thick or kprb connection. It does not work with a thin connection.</p>
                  </div>
                  <p>Prior to Oracle Database 11g Release 1 (11.1), each text node or attribute value processed by Oracle XML&nbsp;DB was limited in size to 64 K bytes. Starting with release 11.1, this restriction no longer applies.</p>
                  <p>The former restrictions on the size of nodes were because the Java methods to set and get a node value supported only arguments of type <code class="codeph">java.lang.String</code>. The maximum size of a string is dependent on the implementation of the Java VM, but it is bounded. Prior to Release 11.1, the Java DOM APIs to manage a node value, contained within class <code class="codeph">oracle.xdb.dom.XDBNode.java</code>, were these:
                  </p><pre class="oac_no_warn" dir="ltr">public String getNodeValue ();
public void setNodeValue (String value);
</pre><p>Prior to Release 11.1, the Java DOM APIs to manage an attribute, contained within class <code class="codeph">oracle.xdb.dom.XDBAttribute.java</code>, were these:
                  </p><pre class="oac_no_warn" dir="ltr">public String getValue ();
public void setValue (String value);
</pre><p>Package <code class="codeph">oracle.xdb.dom</code> is deprecated, starting with Oracle Database 11g Release 1 (11.1). Java classes <code class="codeph">XDBNode</code> and <code class="codeph">XDBAttribute</code> in that package are replaced by classes <code class="codeph">XMLNode</code> and <code class="codeph">XMLAttr</code>, respectively, in package <code class="codeph">oracle.xml.parser.v2</code>. In addition, these DOM APIs were extended in Release 11.1 to support text and binary node values of arbitrary size.
                  </p>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-385EA5A7-6646-4EA6-8443-5BF243C149B4">Stream Extensions to Java DOM</a><br>All Java <code class="codeph">String</code>, <code class="codeph">Reader</code>, and <code class="codeph">Writer</code> data is represented in UCS2, which might be different from the database character set. Additionally, node character data is tagged with a character set id, which is set at the time the node value is populated.
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="PLSQL-APIs-for-XMLType.html#GUID-27F60B86-33DC-4E4B-B870-DDCBCF7819F6" title="Oracle XML&nbsp;DB provides abstract streams and stream-manipulation methods that you can use to handle XML nodes that are larger than 64 K bytes.">Large Node Handling Using DBMS_XMLDOM</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB4955"></a><div class="props_rev_3"><a id="GUID-385EA5A7-6646-4EA6-8443-5BF243C149B4" name="GUID-385EA5A7-6646-4EA6-8443-5BF243C149B4"></a><h4 id="ADXDB-GUID-385EA5A7-6646-4EA6-8443-5BF243C149B4" class="sect4"><span class="enumeration_section">13.10.1 </span>Stream Extensions to Java DOM
                  </h4>
                  <div>
                     <p>All Java <code class="codeph">String</code>, <code class="codeph">Reader</code>, and <code class="codeph">Writer</code> data is represented in UCS2, which might be different from the database character set. Additionally, node character data is tagged with a character set id, which is set at the time the node value is populated.
                     </p>
                     <p>The following methods of <code class="codeph">oracle.xml.parser.v2.XMLNode.java</code> can be used to access nodes of size greater than 64 KB. These APIs throw exceptions if you try to get or set a node that is not a leaf node (attribute, <code class="codeph">PI</code>, <code class="codeph">CDATA</code>, and so on). Also, be sure to use <code class="codeph">close()</code> which actually writes the value and frees resources used to maintain the state for streaming access to nodes.
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-83D45962-6911-4E8D-AA76-7DB19C4B5288">Get-Pull Model</a><br>You can use methods <code class="codeph">getNodeValueAsBinaryStream()</code> and <code class="codeph">getNodeValueAsCharacterStream()</code> to  retrieve the value of a DOM node, using a parser that is in pull mode. Oracle XML&nbsp;DB reads the event data from an input stream written by the parser.
                        </li>
                        <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-1A5DF09B-C27C-45EC-B22A-A9D235883AB1">Get-Push Model</a><br>In this model, you retrieve the value of a DOM node, using a parser that is in push mode. Oracle XML&nbsp;DB writes the node data to an output stream that the parser reads.
                        </li>
                        <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-5528C4C8-C076-4B03-AC18-F16BCC3C3DFE">Set-Pull Model</a><br>In this model, you set the value of a DOM node, using a parser that is in pull mode. Oracle XML&nbsp;DB reads the event data from an input stream written by the parser.
                        </li>
                        <li class="ulchildlink"><a href="Java-DOM-API-for-XMLType.html#GUID-EDECA2DC-5808-4549-8F99-0B5092208529">Set-Push Model</a><br>In this model, you set the value of a DOM node, using a parser that is in push mode. Oracle XML&nbsp;DB writes the node data to an output stream that the parser reads.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-292AD380-743C-4E36-BDD1-039A279006C0" title="Oracle XML&nbsp;DB provides abstract streams and stream-manipulation methods that you can use to handle XML nodes that are larger than 64 K bytes. Use Java classes XMLNode and XMLAttr, together with a thick or kprb connection, to manipulate large nodes.">Large XML Node Handling with Java</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADXDB4956"></a><div class="props_rev_3"><a id="GUID-83D45962-6911-4E8D-AA76-7DB19C4B5288" name="GUID-83D45962-6911-4E8D-AA76-7DB19C4B5288"></a><h5 id="ADXDB-GUID-83D45962-6911-4E8D-AA76-7DB19C4B5288" class="sect5"><span class="enumeration_section">13.10.1.1 </span>Get-Pull Model
                     </h5>
                     <div>
                        <p>You can use methods <code class="codeph">getNodeValueAsBinaryStream()</code> and <code class="codeph">getNodeValueAsCharacterStream()</code> to  retrieve the value of a DOM node, using a parser that is in pull mode. Oracle XML&nbsp;DB reads the event data from an input stream written by the parser.
                        </p>
                        <p>For a binary input stream:</p><pre class="pre codeblock"><code>public java.io.InputStream getNodeValueAsBinaryStream () 
  throws java.io.IOException,
         DOMException;
</code></pre><p>Method <code class="codeph">getNodeValueAsBinaryStream()</code> returns an instance of<code class="codeph"> java.io.InputStream</code> that can be read using the defined methods for this class. The data type of the node must be <code class="codeph">RAW</code> or <code class="codeph">BLOB</code>. If not, an <code class="codeph">IOException</code> is thrown. The following example fragment illustrates reading the value of a node in binary 50-byte segments:
                        </p><pre class="pre codeblock"><code>...
oracle.xml.parser.v2.XMLNode node = null;
...
java.io.InputStream value = node.getNodeValueAsBinaryStream ();
// now read InputStream...
byte buffer [] = new byte [50];
int returnValue = 0;
while ((returnValue = value.read (buffer)) != -1)
{
  // process next 50 bytes of node
}
...
</code></pre><p>For a character input stream:</p><pre class="pre codeblock"><code>public java.io.Reader getNodeValueAsCharacterStream() 
  throws java.io.IOException,
         DOMException;
</code></pre><p>Method <code class="codeph">getNodeValueAsCharacterStream()</code> returns an instance of <code class="codeph">java.io.Reader</code> that can be read using the defined methods for this class. If the data type of the node is neither character nor <code class="codeph">CLOB</code>, the node data is first converted to character. All node data is ultimately in character format and is converted to <code class="codeph">UCS2</code>, if necessary. The following example fragment illustrates reading the node value in segments of 50 characters:
                        </p><pre class="pre codeblock"><code>...
oracle.xml.parser.v2.XMLNode node = null;
...
java.io.Reader value = node.getNodeValueAsCharacterStream ();
// now read InputStream
char buffer [] = new char [50];
int returnValue = 0;
while ((returnValue = value.read (buffer)) != -1)
{
  // process next 50 characters of node
}
...</code></pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-385EA5A7-6646-4EA6-8443-5BF243C149B4" title="All Java String, Reader, and Writer data is represented in UCS2, which might be different from the database character set. Additionally, node character data is tagged with a character set id, which is set at the time the node value is populated.">Stream Extensions to Java DOM</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB4957"></a><div class="props_rev_3"><a id="GUID-1A5DF09B-C27C-45EC-B22A-A9D235883AB1" name="GUID-1A5DF09B-C27C-45EC-B22A-A9D235883AB1"></a><h5 id="ADXDB-GUID-1A5DF09B-C27C-45EC-B22A-A9D235883AB1" class="sect5"><span class="enumeration_section">13.10.1.2 </span>Get-Push Model
                     </h5>
                     <div>
                        <p>In this model, you retrieve the value of a DOM node, using a parser that is in push mode. Oracle XML&nbsp;DB writes the node data to an output stream that the parser reads.</p>
                        <p>For a binary output stream:</p><pre class="pre codeblock"><code>public void getNodeValueAsBinaryStream (java.io.OutputStream pushValue) 
  throws java.io.IOException,
         DOMException;
</code></pre><p>The state of the <code class="codeph">java.io.OutputStream</code> specified by <code class="codeph">pushValue</code> must be open. The data type of the node must be <code class="codeph">RAW</code> or <code class="codeph">BLOB</code>. If not, an <code class="codeph">IOException</code> is thrown. The node binary data is written to <code class="codeph">pushValue</code> using method <code class="codeph">write()</code> of <code class="codeph">OutputStream</code>, and method <code class="codeph">close()</code> is called when the node value has been completely written to the stream.
                        </p>
                        <p>For a character output stream:</p><pre class="pre codeblock"><code>public void getNodeValueAsCharacterStream (java.io.Writer pushValue) 
  throws java.io.IOException,
         DOMException;
</code></pre><p>The state of the <code class="codeph">java.io.Writer</code> specified by <code class="codeph">pushValue</code> must be open. If the data type of the node is neither character nor <code class="codeph">CLOB</code>, then the data is first converted to character. The node data, always in character format, is converted, as necessary, to <code class="codeph">UCS2</code> and then pushed into the <code class="codeph">java.io.Writer</code>.
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-385EA5A7-6646-4EA6-8443-5BF243C149B4" title="All Java String, Reader, and Writer data is represented in UCS2, which might be different from the database character set. Additionally, node character data is tagged with a character set id, which is set at the time the node value is populated.">Stream Extensions to Java DOM</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB4958"></a><div class="props_rev_3"><a id="GUID-5528C4C8-C076-4B03-AC18-F16BCC3C3DFE" name="GUID-5528C4C8-C076-4B03-AC18-F16BCC3C3DFE"></a><h5 id="ADXDB-GUID-5528C4C8-C076-4B03-AC18-F16BCC3C3DFE" class="sect5"><span class="enumeration_section">13.10.1.3 </span>Set-Pull Model
                     </h5>
                     <div>
                        <p>In this model, you set the value of a DOM node, using a parser that is in pull mode. Oracle XML&nbsp;DB reads the event data from an input stream written by the parser.</p>
                        <p>For a binary input stream:</p><pre class="pre codeblock"><code>public void setNodeValueAsBinaryStream (java.io.InputStream pullValue) 
  throws java.io.IOException,
         DOMException;
</code></pre><p>The state of the <code class="codeph">java.io.InputStream</code> specified by <code class="codeph">pullValue</code> must be open. The data type of the node must be <code class="codeph">RAW</code> or <code class="codeph">BLOB</code>. If not, an <code class="codeph">IOException</code> is thrown. The binary data from <code class="codeph">pullValue</code> is read in its entirety using method <code class="codeph">read()</code> of <code class="codeph">InputStream</code> and replaces the node value.
                        </p><pre class="pre codeblock"><code>import java.io.InputStream;
import oracle.xml.parser.*;
...
oracle.xml.parser.v2.XMLNode node = null;
...
byte [] buffer = new byte [500];
java.io.InputStream  istream; //user-defined input stream
node.setNodeValueAsBinaryStream (istream);
</code></pre><p>For a character input stream:</p><pre class="pre codeblock"><code>public void setNodeValueAsCharacterStream (java.io.Reader pullValue) 
  throws java.io.IOException,
         DOMException;
</code></pre><p>The state of the <code class="codeph">java.io.Reader</code> specified by <code class="codeph">pullValue</code> must be open. If the data type of the node is neither character nor <code class="codeph">CLOB</code>, the character data is converted from <code class="codeph">UCS2</code> to the node data type. If the data type of the node is character or <code class="codeph">CLOB</code>, then the character data read from <code class="codeph">pullValue</code> is converted from <code class="codeph">UCS2</code> to the character set of the node.
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-385EA5A7-6646-4EA6-8443-5BF243C149B4" title="All Java String, Reader, and Writer data is represented in UCS2, which might be different from the database character set. Additionally, node character data is tagged with a character set id, which is set at the time the node value is populated.">Stream Extensions to Java DOM</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB4959"></a><div class="props_rev_3"><a id="GUID-EDECA2DC-5808-4549-8F99-0B5092208529" name="GUID-EDECA2DC-5808-4549-8F99-0B5092208529"></a><h5 id="ADXDB-GUID-EDECA2DC-5808-4549-8F99-0B5092208529" class="sect5"><span class="enumeration_section">13.10.1.4 </span>Set-Push Model
                     </h5>
                     <div>
                        <p>In this model, you set the value of a DOM node, using a parser that is in push mode. Oracle XML&nbsp;DB writes the node data to an output stream that the parser reads.</p>
                        <p>For a binary output stream:</p><pre class="pre codeblock"><code>public java.io.OutputStream setNodeValueAsBinaryStream () 
  throws java.io.IOException,
         DOMException;
</code></pre><p>Method <code class="codeph">setNodeValueAsBinaryStream()</code> returns an instance of <code class="codeph">java.io.OutputStream</code>, into which the caller can write the node value. The data type of the node must be <code class="codeph">RAW</code> or <code class="codeph">BLOB</code>. Otherwise, an <code class="codeph">IOException</code> is raised. The following example fragment illustrates setting the value of a node to binary data by writing to the implementation of <code class="codeph">java.io.OutputStream</code> provided by Oracle XML&nbsp;DB or Oracle XML Developer's Kit.
                        </p>
                        <p>For a character output stream:</p><pre class="pre codeblock"><code>public java.io.Writer setNodeValueAsCharacterStream () 
  throws java.io.IOException,
         DOMException;
</code></pre><p>Method <code class="codeph">setNodeValueAsCharacterStream()</code> returns an instance of <code class="codeph">java.io.Writer</code> into which the caller can write the node value. The character data written is first converted from <code class="codeph">UCS2</code> to the node character set, if necessary. If the data type of the node is neither character nor <code class="codeph">CLOB</code>, then the character data is converted to the node data type. Similarly, the following example fragment illustrates setting the value of a node to character data by writing to the implementation of <code class="codeph">java.io.Writer</code> provided by Oracle XML&nbsp;DB or Oracle XML Developer's Kit.
                        </p><pre class="pre codeblock"><code>import java.io.Writer;
import oracle.xml.parser.*;
...
oracle.xml.parser.v2.XMLNode node = null;
...
char [] buffer = new char [500];
java.io.Writer  writer = node.setNodeValueAsCharacterStream ();
for (int k = 0; k &lt; 10; k++)
{
  byte segment [] = new byte [50];
  // copy next subset of buffer into segment
  writer.write (segment);
}
writer.flush ();
writer.close();</code></pre><p>Oracle XML&nbsp;DB creates a <code class="codeph">writer</code> or <code class="codeph">OutputStream</code> and passes it to the user who calls method <code class="codeph">write()</code> repeatedly until the complete node value has been written. The new node value is reflected only when the user calls method <code class="codeph">close()</code>. 
                        </p>
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-EDECA2DC-5808-4549-8F99-0B5092208529__GUID-D1751450-44F5-4233-AE1C-1E9F13D4AFF0">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a></p>
                              </li>
                              <li>
                                 <p><a href="../caxml/package-DOM-API.html#CAXML-GUID-1A4B5DBB-1B8C-4963-AEC4-C5DC0709C325" target="_blank"><span><cite>Oracle Database XML C API Reference </cite></span></a> for information about C functions for large nodes
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-385EA5A7-6646-4EA6-8443-5BF243C149B4" title="All Java String, Reader, and Writer data is represented in UCS2, which might be different from the database character set. Additionally, node character data is tagged with a character set id, which is set at the time the node value is populated.">Stream Extensions to Java DOM</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="ADXDB4961"></a><a id="ADXDB4960"></a><div class="props_rev_3"><a id="GUID-1234728D-0732-4DC6-82EF-9D372702061F" name="GUID-1234728D-0732-4DC6-82EF-9D372702061F"></a><h3 id="ADXDB-GUID-1234728D-0732-4DC6-82EF-9D372702061F" class="sect3"><span class="enumeration_section">13.11 </span>Using the Java DOM API and JDBC with Binary XML
               </h3>
               <div>
                  <p>You can use the Java DOM API for XML and Java Database Connectivity (JDBC) to read or write XML data that is encoded as binary XML from or to Oracle XML DB. Doing so involves the usual read and write procedures. </p>
                  <div class="section">
                     <p>XML data can be stored in Oracle XML DB using data type <code class="codeph">XMLType</code>, and one of the storage models for this abstract data type is binary XML, a compact, XML Schema-aware encoding of XML data. You can use binary XML as a storage model for <code class="codeph">XMLType</code> in the database, but you can also use it for XML data located outside the database. Client-side processing of XML data can involve data stored in Oracle XML DB or transient data that resides outside the database.
                     </p>
                     <p>Binary XML is XML Schema-aware and can use various encoding schemes, depending on your needs and your data. Because of this, in order to manipulate binary XML data, you must have both the data and this metadata about the relevant XML schemas and encodings. </p>
                     <p>For <code class="codeph">XMLType</code> data stored in the database, this metadata is also stored in the database. However, depending on how your database and data are set up, the metadata might not be on the same server as the data it applies to. If this is the case, then, before you can read or write binary XML data from or to the database, you must carry out these steps:
                     </p>
                     <ol>
                        <li>
                           <p>Create a context instance for the metadata.</p>
                        </li>
                        <li>
                           <p>Associate this context with a data connection that you use to access binary XML data in the database. A data connection can be a dedicated connection or a connection pool. You use methods <code class="codeph">getDedicatedConn()</code> and <code class="codeph">getConnPool()</code> in class <code class="codeph">java.sql.Connection</code> to obtain handles to these two types of connection, respectively.
                           </p>
                        </li>
                     </ol>
                     <p>Then, when your application needs to encode or decode binary XML data on the data connection, it automatically fetches the metadata needed for that. The overall sequence of actions is thus as follows:</p>
                     <ol>
                        <li>
                           <p>Create an XML data connection object, in class <code class="codeph">java.sql.Connection</code>.
                           </p>
                        </li>
                        <li>
                           <p>Create one or more metadata contexts, as needed, using method <code class="codeph">BinXMLMetadataProviderFactory.createDBMetadataProvider()</code> in package <code class="codeph">oracle.xml.binxml</code>. A metadata context is sometimes referred to as a metadata repository. You can create a metadata context from a dedicated connection or from a connection pool.
                           </p>
                        </li>
                        <li>
                           <p>Associate the metadata context(s) with the binary XML data connection(s). Use method <code class="codeph">DBBinXMLMetadataProvider.associateDataConnection()</code> in package <code class="codeph">oracle.xml.binxml</code> to do this.
                           </p>
                        </li>
                        <li>
                           <p>(Optional) If the XML data originated outside of the database, use method <code class="codeph">oracle.xdb.XMLType.setFormatPref()</code> to specify that XML data to be sent to the database be encoded in the binary XML format. This applies to a DOM document (class <code class="codeph">oracle.xdb.XMLType</code>). If you do not specify binary XML, the data is sent to the database as text.
                           </p>
                        </li>
                        <li>
                           <p>Use the usual Java methods to read and write XML data from and to the database. Whenever it is needed for encoding or decoding binary XML documents, the necessary metadata is fetched automatically using the metadata context.</p>
                           <p>Use the Java DOM API for XML to operate on the XML data at the client level.</p>
                        </li>
                     </ol>
                     <p><a href="Java-DOM-API-for-XMLType.html#GUID-1234728D-0732-4DC6-82EF-9D372702061F__CHDJJAED">Example 13-14</a> illustrates this.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-1234728D-0732-4DC6-82EF-9D372702061F__GUID-BC392FC9-DE8C-47C9-9CDE-B1AE0E385A68">
                        <p class="notep1">See Also:</p>
                        <p><a href="../adxdk/using-binary-XML-with-Java.html#ADXDK4440" target="_blank"><span><cite>Oracle XML Developer's Kit Programmer's Guide</cite></span></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-1234728D-0732-4DC6-82EF-9D372702061F__CHDJJAED">
                     <p class="titleinexample">Example 13-14 Using the Java DOM API with a Binary XML Column</p><pre class="oac_no_warn" dir="ltr">class PrintBinaryXML
{
  public static void printBinXML() throws SQLException, BinXMLException
  {
    // Create datasource to connect to local database
    OracleDataSource ods = new OracleDataSource();
    ods.setURL("jdbc:oracle:kprb");
    
    System.out.println("Starting Binary XML Java Example");

    // Create data connection
    Connection connection = ods.<span class="bold">getConnection</span>();
    // Create binary XML metadata context, using connection pool
    DBBinXMLMetadataProvider repos =
      <span class="bold">BinXMLMetadataProviderFactory.createDBMetadataProvider</span>();
    repos.<span class="bold">setConnectionPool</span>(ods);

    // Associate metadata context with data connection
    repos.<span class="bold">associateDataConnection</span>(connection);

    // Query XML data stored in SQLXML column as binary XML
    Statement statement = connection.createStatement();
    ResultSet resultSet = statement.executeQuery("SELECT doc FROM po_binxmltab");

    // Get the SQLXML object
    while (resultSet.next())
    {
      SQLXML sqlXml = resultSet.getSQLXML(1);

      // Convert SQLXML to a String
      String xmlString = sqlXml.getString();
      System.out.println(xmlString);
    }

    resultSet.close();
    statement.close();
    connection.close();

    System.out.println("Completed Binary XML Java Example");
  }
}</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="intro-to-XML-DB.html#GUID-B8507F44-B010-4384-94E6-101131DD7D88" title="XMLType is an abstract data type that provides different storage models to best fit your data and your use of it. As an abstract data type, your applications and database queries gain in flexibility: the same interface is available for all XMLType operations.">XMLType Storage Models</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="Java-DOM-API-for-XMLType.html#GUID-4C510052-8A31-4917-8567-0E2825927C54" title="The Java DOM API for XMLType lets you operate on XMLType instances using a DOM. You can use it to manipulate XML data in Java, including fetching it through Java Database Connectivity (JDBC).">Java DOM API for XMLType</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <hr><br><p style="text-decoration:underline">Footnote Legend</p>Footnote&nbsp;1: 
            <p>This assumes that your XML data is pre-registered with an XML schema, and that it is stored in an <code class="codeph">XMLType</code> column.
            </p><br></div>
      </article>
   </body>
</html>