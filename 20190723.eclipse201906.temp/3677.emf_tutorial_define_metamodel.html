<html>
<head>
<title>Defining an EMF metamodel</title>
<link href="book.css" rel="stylesheet" type="text/css"/>
<meta content="DocBook XSL Stylesheets V1.75.1" name="generator"/>
<link rel="home" href="index.html" title="Xpand Documentation"/>
<link rel="up" href="emf_tutorial.html" title="Getting Started"/>
<link rel="prev" href="emf_tutorial_overview.html" title="Tutorial overview"/>
<link rel="next" href="emf_tutorial_generate_emf_tooling.html" title="Generating the EMF tooling"/>
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<h1 xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0">Defining an EMF metamodel</h1>
<div class="section" title="Defining an EMF metamodel">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both">
<a name="emf_tutorial_define_metamodel"/>Defining an EMF metamodel</h2>
</div>
</div>
</div>
<p>To illustrate the metamodel, before we deal with the intricacies of
    EMF, here is the metamodel in UML: </p>
<div class="figure">
<a name="emf_tutorial_sample_metamodel"/>
<p class="title">
<b>Figure 1. Sample metamodel</b>
</p>
<div class="figure-contents">
<div class="mediaobject">
<img src="images/emf_tutorial/metamodel.gif" alt="Sample metamodel"/>
</div>
</div>
</div>
<p>
<br class="figure-break"/>
</p>
<div class="section" title="Creating an EMF project">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="emf_tutorial_creating_emf_project"/>Creating an EMF project</h3>
</div>
</div>
</div>
<p>Create an EMF project as depicted below:</p>
<div class="figure">
<a name="emf_tutorial_create_emf_project"/>
<p class="title">
<b>Figure 2. Create EMF project</b>
</p>
<div class="figure-contents">
<div class="mediaobject">
<img src="images/emf_tutorial/create_emf_project.png" alt="Create EMF project"/>
</div>
</div>
</div>
<br class="figure-break"/>
<p>It is important that you create an EMF projec<a name="N10060" class="indexterm"/>t, not just a simple or a Java project. Name it
      <code class="filename">xpand.demo.emf.datamodel</code>.</p>
</div>
<div class="section" title="Defining the (meta)model">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="emf_tutorial_defining_metamodel"/>Defining the (meta)model</h3>
</div>
</div>
</div>
<p>Create a new source folder <code class="filename">metamodel</code> in that project. Then, create a
      new Ecore model in that source folder named
      <code class="filename">data.ecore</code>. Use <span class="type">EPackage</span> as the model
      object. </p>
<div class="figure">
<a name="emf_tutorial_create_ecore_model"/>
<p class="title">
<b>Figure 3. Create new Ecore model</b>
</p>
<div class="figure-contents">
<div class="mediaobject">
<img src="images/emf_tutorial/create_ecore_model.png" alt="Create new Ecore model"/>
</div>
</div>
</div>
<p>
<br class="figure-break"/>This opens the Ecore Editor. You will see a root package with
      name <code class="varname">null</code>. Open the Properties View (context menu).
      Set the following properties for the package: </p>
<div class="itemizedlist">
<ul class="itemizedlist" type="disc">
<li class="listitem">
<p>Name: data</p>
</li>
<li class="listitem">
<p>Ns prefix: data</p>
</li>
<li class="listitem">
<p>Ns URI: http://www.xpand.org/xpand.demo.emf.datamodel</p>
</li>
</ul>
</div>
<p> </p>
<div class="figure">
<a name="emf_tutorial_adjust_namespace_settings"/>
<p class="title">
<b>Figure 4. Adjust namespace settings</b>
</p>
<div class="figure-contents">
<div class="mediaobject">
<img src="images/emf_tutorial/create_ecore_model_adjust_namespace.png" alt="Adjust namespace settings"/>
</div>
</div>
</div>
<p>
<br class="figure-break"/>
</p>
<p>Create the following Ecore model.<sup>[<a href="#ftn.N100A4" name="N100A4" class="footnote">1</a>]</sup>Make sure you set the following properties
      <span class="emphasis">
<em>exactly</em>
</span> as described next:</p>
<p>Within the <span class="package">data</span> package, create these
      <code class="classname">EClass</code> elements with their attributes:<sup>[<a href="#ftn.N100B6" name="N100B6" class="footnote">2</a>]</sup>
</p>
<div class="informaltable">
<a name="emf_tutorial_metamodel_attributes"/>
<table cellspacing="0" cellpadding="10" style="border-collapse: collapse;border-bottom: 0.5pt solid ; ">
<colgroup>
<col align="left"/>
<col align="left"/>
<col align="left"/>
</colgroup>
<thead>
<tr>
<th style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EClass name</th>
<th style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EAttribute name</th>
<th style="border-bottom: 2 solid #000000; " align="left">EAttribute EType</th>
</tr>
</thead>
<tbody>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">DataModel</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">name</td>
<td style="border-bottom: 2 solid #000000; " align="left">EString</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Entity</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">name</td>
<td style="border-bottom: 2 solid #000000; " align="left">EString</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Attribute</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">name</td>
<td style="border-bottom: 2 solid #000000; " align="left">EString</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">type</td>
<td style="border-bottom: 2 solid #000000; " align="left">EString</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EntityReference</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">name</td>
<td style="border-bottom: 2 solid #000000; " align="left">EString</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; " align="left">toMany</td>
<td style="" align="left">EBoolean</td>
</tr>
</tbody>
</table>
</div>
<p>Now, it is time to create references between the model elements.
      Add children of type <code class="classname">EReferences</code> as
      follows:<sup>[<a href="#ftn.N1010E" name="N1010E" class="footnote">3</a>]</sup>
</p>
<div class="informaltable">
<a name="emf_tutorial_metamodel_references"/>
<table cellspacing="0" cellpadding="10" width="100%" style="border-collapse: collapse;border-bottom: 0.5pt solid ; ">
<colgroup>
<col align="left"/>
<col align="left"/>
<col align="left"/>
<col align="left"/>
</colgroup>
<thead>
<tr>
<th style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EClass</th>
<th style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EReference name</th>
<th style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EReference attribute name</th>
<th style="border-bottom: 2 solid #000000; " align="left">EReference attribute value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">DataModel</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">entity</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EType</td>
<td style="border-bottom: 2 solid #000000; " align="left">Entity</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">containment</td>
<td style="border-bottom: 2 solid #000000; " align="left">true</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Lowerbound</td>
<td style="border-bottom: 2 solid #000000; " align="left">0</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Upperbound</td>
<td style="border-bottom: 2 solid #000000; " align="left">-1</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Entity</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">attribute</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EType</td>
<td style="border-bottom: 2 solid #000000; " align="left">Attribute</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">containment</td>
<td style="border-bottom: 2 solid #000000; " align="left">true</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Lowerbound</td>
<td style="border-bottom: 2 solid #000000; " align="left">1</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Upperbound</td>
<td style="border-bottom: 2 solid #000000; " align="left">-1</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Entity</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">reference</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EType</td>
<td style="border-bottom: 2 solid #000000; " align="left">EntityReference</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">containment</td>
<td style="border-bottom: 2 solid #000000; " align="left">true</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Lowerbound</td>
<td style="border-bottom: 2 solid #000000; " align="left">0</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Upperbound</td>
<td style="border-bottom: 2 solid #000000; " align="left">-1</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EntityReference</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">target</td>
<td class="auto-generated" style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; "> </td>
<td class="auto-generated" style="border-bottom: 2 solid #000000; "> </td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">EType</td>
<td style="border-bottom: 2 solid #000000; " align="left">Entity</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">containment</td>
<td style="border-bottom: 2 solid #000000; " align="left">false</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Lowerbound</td>
<td style="border-bottom: 2 solid #000000; " align="left">1</td>
</tr>
<tr>
<td style="border-right: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; " align="left"> </td>
<td style="border-right: 2 solid #000000; " align="left">Upperbound</td>
<td style="" align="left">1</td>
</tr>
</tbody>
</table>
</div>
<div class="figure">
<a name="emf_tutorial_metamodel_structure"/>
<p class="title">
<b>Figure 5. Metamodel structure</b>
</p>
<div class="figure-contents">
<div class="mediaobject">
<img src="images/emf_tutorial/create_ecore_model_mm_structure.png" alt="Metamodel structure"/>
</div>
</div>
</div>
<p>
<br class="figure-break"/>
</p>
<p>EMF saves the model we created above in its own dialect of
      XMI<a name="N101D9" class="indexterm"/>. To avoid any ambiguities, here is the complete XMI
      source for the metamodel. It goes into the file
      <code class="filename">data.ecore</code>: </p>
<pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ecore:EPackage xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ecore="http://www.eclipse.org/emf/2002/Ecore" name="data"
    nsURI="http://www.xpand.org/xpand.demo.emf.datamodel" nsPrefix="data"&gt;
  &lt;eClassifiers xsi:type="ecore:EClass" name="DataModel"&gt;
    &lt;eStructuralFeatures xsi:type="ecore:EAttribute" name="name"
      eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/&gt;
    &lt;eStructuralFeatures xsi:type="ecore:EReference" name="entity" upperBound="-1"
        eType="#//Entity" containment="true"/&gt;
  &lt;/eClassifiers&gt;
  &lt;eClassifiers xsi:type="ecore:EClass" name="Entity"&gt;
    &lt;eStructuralFeatures xsi:type="ecore:EAttribute" name="name"
      eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/&gt;
    &lt;eStructuralFeatures xsi:type="ecore:EReference" name="attribute" lowerBound="1"
        upperBound="-1" eType="#//Attribute" containment="true"/&gt;
    &lt;eStructuralFeatures xsi:type="ecore:EReference" name="reference" upperBound="-1"
        eType="#//EntityReference" containment="true"/&gt;
  &lt;/eClassifiers&gt;
  &lt;eClassifiers xsi:type="ecore:EClass" name="Attribute"&gt;
    &lt;eStructuralFeatures xsi:type="ecore:EAttribute" name="name"
      eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/&gt;
    &lt;eStructuralFeatures xsi:type="ecore:EAttribute" name="type"
      eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/&gt;
  &lt;/eClassifiers&gt;
  &lt;eClassifiers xsi:type="ecore:EClass" name="EntityReference"&gt;
    &lt;eStructuralFeatures xsi:type="ecore:EAttribute" name="name"
      eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/&gt;
    &lt;eStructuralFeatures xsi:type="ecore:EAttribute" name="toMany"
      eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EBoolean"/&gt;
    &lt;eStructuralFeatures xsi:type="ecore:EReference" name="target" lowerBound="1"
        eType="#//Entity"/&gt;
  &lt;/eClassifiers&gt;
&lt;/ecore:EPackage&gt;
</pre>
</div>
<div class="footnotes">
<br/>
<hr align="left" width="100"/>
<div class="footnote">
<p>
<sup>[<a href="#N100A4" name="ftn.N100A4" class="para">1</a>] </sup>To add children, right-click on the element to which you want
          to add these children and select the type of the child from the
          list. To configure the properties, open the properties dialog by
          selecting <span class="guimenu">Show Properties View</span> at the bottom of
          any of the context menus. Note that this is not an EMF tutorial. For
          more details on how to build EMF (meta-)models, please refer to the
          EMF documentation.</p>
</div>
<div class="footnote">
<p>
<sup>[<a href="#N100B6" name="ftn.N100B6" class="para">2</a>] </sup>Attributes are children of type
          <code class="classname">EAttribute</code>. Please fill in the
          <span class="property">Name</span> and the <span class="property">EType</span>
          properties.</p>
</div>
<div class="footnote">
<p>
<sup>[<a href="#N1010E" name="ftn.N1010E" class="para">3</a>] </sup>Note: there are a couple of <span class="emphasis">
<em>-1's</em>
</span> ...
          don't miss the minus! Also, the containment flag is essential. If
          containment is <code class="literal">true</code> you will be able to create
          children of the referenced type, otherwise you can only reference
          them.</p>
</div>
</div>
</div>
</body>
</html>
