<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">
      <meta name="description" content="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">
      <title>GeoRaster Data Query and Manipulation</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="GeoRaster Developer's Guide ">
      <meta property="og:description" content="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="GeoRaster Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="spatial-and-graph-georaster-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-14T11:48:45-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E94793-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="georaster-database-creation-management.html" title="Previous" type="text/html">
      <link rel="next" href="raster-algebra-and-analytics.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Spatial and Graph GeoRaster Developer's Guide">
    <meta name="dcterms.isVersionOf" content="GEORS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="georaster-database-creation-management.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="raster-algebra-and-analytics.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">GeoRaster Developer's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">GeoRaster Data Query and Manipulation</li>
            </ol>
            <a id="GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" name="GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA"></a>
            
            <h2 id="GEORS-GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" class="sect2"><span class="enumeration_chapter">4 </span>GeoRaster Data Query and Manipulation
            </h2>
         </header>
         <div class="ind">
            <div>
               <div><span>This chapter describes how to perform several important GeoRaster data query and manipulation operations.</span> Typical GeoRaster data query and manipulation involve most or all of the operations described.
               </div>
               <p>See also the operations in <a href="georaster-database-creation-management.html#GUID-92D80CF0-F503-40BE-B1E6-D06A1DF033B6" title="This chapter describes how to perform important GeoRaster database creation and management operations.">GeoRaster Database Creation and Management</a>.
               </p>
               <p>Other chapters in this book cover advanced topics (<a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a> and <a href="image-processing-virtual-mosaic.html#GUID-EB60166B-6A52-4974-AF16-139CD6480EBC" title="This chapter describes advanced image processing capabilities, including GCP georeferencing, reprojection, rectification, orthorectification, warping, image scaling, stretching, filtering, masking, segmentation, NDVI computation, Tasseled Cap Transformation, image appending, bands merging, and large-scale advanced image mosaicking."> Image Processing and Virtual Mosaic</a>), and provide detailed reference information about GeoRaster PL/SQL packages (<a href="SDO_GEOR-reference.html#GUID-587A19B6-40FF-4F1C-AC13-556891070C30" title="The SDO_GEOR package contains subprograms (functions and procedures) for creating, modifying, and retrieving information about GeoRaster objects. This chapter presents reference information, with one or more examples, for each subprogram."> SDO_GEOR Package Reference</a>, <a href="SDO_GEOR_ADMIN-reference.html#GUID-6F9B00F3-56C1-4AF9-82A6-DFBAB1BB489E" title="The SDO_GEOR_ADMIN package contains subprograms (functions and procedures) for administrative operations related to GeoRaster. This chapter presents reference information, with one or more examples, for each subprogram."> SDO_GEOR_ADMIN Package Reference</a>, <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-92406947-E079-487D-B0D0-3342ECC23E34" title="The SDO_GEOR_AGGR package contains subprograms (functions and procedures) for performing advanced large-scale mosaicking, appending, and virtual mosaic operations on GeoRaster objects. This chapter presents reference information, with one or more examples, for each subprogram."> SDO_GEOR_AGGR Package Reference</a>, <a href="sdo-geor-ra-ref.html#GUID-7E8EC42B-D663-49EF-B6D8-158A0EC10333" title="The SDO_GEOR_RA package contains subprograms (functions and procedures) for raster algebra and analytic operations related to GeoRaster. This chapter presents reference information, with one or more examples, for each subprogram."> SDO_GEOR_RA Package Reference</a>, and <a href="SDO_GEOR_UTL-reference.html#GUID-080B4F44-F59D-4E2A-AA97-FF209C69C4D2" title="The SDO_GEOR_UTL package contains subprograms (functions and procedures) for utility operations related to GeoRaster. This chapter presents reference information, with one or more examples, for each subprogram."> SDO_GEOR_UTL Package Reference</a>).
               </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-13578486-979A-410B-94BB-863DBB4AA7E2">Querying and Searching GeoRaster Objects</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-C27E5446-4222-447C-9661-19A5AA8CE9FC">Changing and Optimizing Raster Storage</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-5D4085E6-5A61-4AC1-B386-C7E1ABA63174">Copying GeoRaster Objects</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-01A627A0-0EC5-4FAE-AA6A-950116E2FBB8">Subsetting GeoRaster Objects with Polygon Clipping</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-DB762BC3-88BA-4716-9F0C-A4DC4AEC624F">Querying and Updating GeoRaster Metadata</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-D78B30EA-E592-4D34-94AC-AB2B1435D60E">Querying and Updating GeoRaster Cell Data</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-8C2E91C6-54EF-4285-9B6F-83002E347B3E">Interpolating Cell Values</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-D5389E0F-A151-4476-8EA6-DCA329FEFB31">Processing and Analyzing GeoRaster Objects</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-AA00D7EE-B6ED-4A42-9475-F353CB5989AC">Monitoring and Reporting GeoRaster Operation Progress</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-900D8B54-15B7-4044-AF7F-7BC6854535FE">Compressing and Decompressing GeoRaster Objects</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-3FE51533-061E-4A2F-BB3E-49A723FE3553">Deleting GeoRaster Objects, and Performing Actions on GeoRaster Tables and RDTs</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-CA53EDD9-AC59-479F-8280-82EAF85A2141">Performing Cross-Schema Operations</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-EF5B66A9-DD46-4178-96F6-B699D4AF3808">Managing Memory to Improve Performance</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-7AB60C10-E48E-4281-A03A-DA38FFA9F121">Updating GeoRaster Objects Before Committing</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-0603D2D3-AD36-4F30-970D-038309F55A17">Updating GeoRaster Objects in a Loop</a><br></li>
                  <li class="ulchildlink"><a href="georaster-data-manipulation.html#GUID-A77AAC5B-B0EE-4F8A-9569-79A14D88658B">Using Template-Related Subprograms to Develop GeoRaster Applications</a><br></li>
               </ul>
            </div>
            <a id="GEORS1243"></a><div class="props_rev_3"><a id="GUID-13578486-979A-410B-94BB-863DBB4AA7E2" name="GUID-13578486-979A-410B-94BB-863DBB4AA7E2"></a><h3 id="GEORS-GUID-13578486-979A-410B-94BB-863DBB4AA7E2" class="sect3"><span class="enumeration_section">4.1 </span>Querying and Searching GeoRaster Objects
               </h3>
               <div>
                  <p>GeoRaster tables are regular relational tables that can have various columns, such as an ID number, a name, a timestamp, and a unique description in the form of a string. These columns can be indexed, and GeoRaster objects can be queried using the standard database indexing and query statements, as shown in many examples in this manual.</p>
                  <p>After the GeoRaster tables are spatially indexed (see <a href="georaster-database-creation-management.html#GUID-F31E1BAD-DE81-462E-8103-7A67CF7A8D0E">Indexing GeoRaster Objects</a>), you can quickly query or search GeoRaster objects using a geometry as well. For example, you may want to find all images (maybe hundreds or more) inside a specific region and then generate full pyramids for each image, as in the following example.
                  </p>
                  <div class="example" id="GUID-13578486-979A-410B-94BB-863DBB4AA7E2__GUID-A4E581D7-EC1C-48E2-AD01-D4FB2B0E4BD0">
                     <p class="titleinexample">Example 4-1 Searching GeoRaster Objects and Generating Pyramids for Them</p><pre class="oac_no_warn" dir="ltr">DECLARE
  type curtype is ref cursor;
  my_cursor curtype;
  stmt varchar2(1000);
  tid     number;
  gr    sdo_georaster;
  gm  sdo_geometry;
BEGIN
  -- 1. Define the query area in EPSG 4326 (WGS84) coordinate system
  gm := sdo_geometry(2003, 4326, null,
              sdo_elem_info_array(1,1003,3),
              sdo_ordinate_array(5,6,30,30));
 
  -- 2. Define the query statement on the GeoRaster table (city_images)using the given geometry
  stmt := 'select id from city_images t ' ||
    'where sdo_inside(t.image.spatialextent, :1)=''TRUE''';
 
  -- 3. Spatially query all images INSIDE the query area 
  --    and generate full pyramids for each of the images
  open my_cursor for stmt using gm;
  loop
    fetch my_cursor into tid;
    exit when my_cursor%NOTFOUND;
    -- retrieve the image to generate the pyramids
    select image into gr from city_images where id = tid for update;
    sdo_geor.generatePyramid(gr, 'resampling=bilinear', null, ‘parallel=4’);
    update city_images set image=gr
       where id = tid;
    commit; 
  end loop;
  close my_cursor;
END;
</pre><p>You can also wrap up such blocks into a PL/SQL procedure and store it in the database, then call the stored procedure directly. These features enable you to organize complex processes and automate database administration tasks.</p>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1000"></a><div class="props_rev_3"><a id="GUID-C27E5446-4222-447C-9661-19A5AA8CE9FC" name="GUID-C27E5446-4222-447C-9661-19A5AA8CE9FC"></a><h3 id="GEORS-GUID-C27E5446-4222-447C-9661-19A5AA8CE9FC" class="sect3"><span class="enumeration_section">4.2 </span>Changing and Optimizing Raster Storage
               </h3>
               <div>
                  <p>You can change or specify some aspects of the way raster image data is or will be stored: the raster blocking size, cell depth, interleaving type, and other aspects. Such flexibility allows you to optimize the raster data storage format to save disk space and improve application performance.</p>
                  <p>To load and process a GeoRaster object to create another GeoRaster object, you can specify storage parameters with GeoRaster PL/SQL subprograms. That is, you can specify the output format when you call functions or procedures such as <a href="SDO_GEOR-reference.html#GUID-07B69D26-239F-4C52-A2D2-E776B2BABF8B">SDO_GEOR.importFrom</a>, <a href="SDO_GEOR-reference.html#GUID-827C49FA-3759-4EC3-8ED5-A9A4E623EEEB">SDO_GEOR.subset</a>, <a href="SDO_GEOR-reference.html#GUID-FAC58FA1-3707-498F-BC69-7D36C17BDFA1">SDO_GEOR.rectify</a>, <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-D47B17BE-79C2-4610-B75A-D03182FD40FB">SDO_GEOR_AGGR.append</a>, <a href="SDO_GEOR-reference.html#GUID-859F107A-4D75-4C36-B9FC-690FA202789C">SDO_GEOR.mergeLayers</a>,  <a href="SDO_GEOR-reference.html#GUID-5C7E6DDA-B9C1-4A67-9C1B-5FA35D2FB7C1">SDO_GEOR.createTemplate</a>, <a href="sdo-geor-ra-ref.html#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a>, and <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-85F23FB6-7F4B-40C4-B023-25DE37FA53BF">SDO_GEOR_AGGR.mosaicSubset</a>. You cannot directly make such changes on an existing GeoRaster object; however, you can use the <a href="SDO_GEOR-reference.html#GUID-9C8E8AE6-4C33-4813-B94A-A69C6206E8C4">SDO_GEOR.changeFormatCopy</a>procedure, and specify the desired storage parameter values with the <code class="codeph">storageParam</code> parameter, to make a copy of the existing GeoRaster object.
                  </p>
                  <p>The <code class="codeph">storageParam</code> parameter for the resulting GeoRaster objects should be based on factors such as the data size, dimension sizes, and application needs, as you determine them. However, the block sizes can also be optimized automatically based on the dimension sizes of the GeoRaster object and the desired output required by users, so that each GeoRaster object uses only minimum padding space but still meets the application requirements. Depending on the raster dimension size and your desired blocking size, padding might waste some storage space, so you should always consider specifying <code class="codeph">blocking=OPTIMALPADDING</code> in the <code class="codeph">storageParam</code> parameter for the output GeoRaster when a GeoRaster procedure is called.
                  </p>
                  <p>For more information, see <a href="georaster-overview-and-concepts.html#GUID-4B5901B5-879D-4E5F-BE73-2242F3D7CF9D">Storage Parameters</a>, especially <a href="georaster-overview-and-concepts.html#GUID-4B5901B5-879D-4E5F-BE73-2242F3D7CF9D__CHDHJCBF" title="This 2 column table lists the storageParam Keywords for Raster Data. Column 1 is the keyword. Column 2 explains the keyword.">Table 1-1</a>. For examples of applying optimal padding, see the PL/SQL example at the end of <a href="georaster-overview-and-concepts.html#GUID-4B5901B5-879D-4E5F-BE73-2242F3D7CF9D">Storage Parameters</a> and the GDAL example in <a href="georaster-database-creation-management.html#GUID-FFB6CD25-B4AC-4746-BAC5-E9ED82D763F0">Loading with Blocking and Optimal Padding</a></p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1001"></a><div class="props_rev_3"><a id="GUID-5D4085E6-5A61-4AC1-B386-C7E1ABA63174" name="GUID-5D4085E6-5A61-4AC1-B386-C7E1ABA63174"></a><h3 id="GEORS-GUID-5D4085E6-5A61-4AC1-B386-C7E1ABA63174" class="sect3"><span class="enumeration_section">4.3 </span>Copying GeoRaster Objects
               </h3>
               <div>
                  <div class="section">
                     <p>To copy a GeoRaster object, you must either copy it into an empty GeoRaster object or overwrite an existing valid GeoRaster object. (Empty GeoRaster objects are explained in <a href="georaster-overview-and-concepts.html#GUID-C4D574D6-340B-49DC-95BD-87FDEB11CE16">Blank and Empty GeoRaster Objects</a>.) To make an identical copy of the source GeoRaster object, use the <a href="SDO_GEOR-reference.html#GUID-72D93D49-BF98-4AB9-8FEA-C386A1BE1071">SDO_GEOR.copy</a> procedure; to make a copy that includes storage format changes, use the <a href="SDO_GEOR-reference.html#GUID-9C8E8AE6-4C33-4813-B94A-A69C6206E8C4">SDO_GEOR.changeFormatCopy</a> procedure (see <a href="georaster-data-manipulation.html#GUID-C27E5446-4222-447C-9661-19A5AA8CE9FC">Changing and Optimizing Raster Storage</a>).
                     </p>
                     <p>To copy a GeoRaster object using an empty GeoRaster object, follow these steps:</p>
                     <ol>
                        <li>
                           <p>Initialize an empty GeoRaster object while inserting it into the destination table, returning the empty GeoRaster object.</p>
                        </li>
                        <li>
                           <p>Use the <a href="SDO_GEOR-reference.html#GUID-72D93D49-BF98-4AB9-8FEA-C386A1BE1071">SDO_GEOR.copy</a> or <a href="SDO_GEOR-reference.html#GUID-9C8E8AE6-4C33-4813-B94A-A69C6206E8C4">SDO_GEOR.changeFormatCopy</a> procedure to copy the GeoRaster object into the returned empty GeoRaster object.
                           </p>
                        </li>
                        <li>
                           <p>Use UPDATE statement to update the desired row in the destination table so that its GeoRaster column contains the copied GeoRaster object.</p>
                        </li>
                        <li>
                           <p>When you are ready to commit the transaction, use the COMMIT statement.</p>
                        </li>
                     </ol>
                     <p>For an example of copying using an empty GeoRaster object, see the example for the <a href="SDO_GEOR-reference.html#GUID-72D93D49-BF98-4AB9-8FEA-C386A1BE1071">SDO_GEOR.copy</a> procedure in<a href="SDO_GEOR-reference.html#GUID-587A19B6-40FF-4F1C-AC13-556891070C30" title="The SDO_GEOR package contains subprograms (functions and procedures) for creating, modifying, and retrieving information about GeoRaster objects. This chapter presents reference information, with one or more examples, for each subprogram."> SDO_GEOR Package Reference</a>.
                     </p>
                     <p>To copy a GeoRaster object so that it overwrites (replaces) an existing GeoRaster object, follow these steps:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li><span>Select the existing GeoRaster object for update.</span></li>
                     <li><span>Use the <a href="SDO_GEOR-reference.html#GUID-72D93D49-BF98-4AB9-8FEA-C386A1BE1071">SDO_GEOR.copy</a> or <a href="SDO_GEOR-reference.html#GUID-9C8E8AE6-4C33-4813-B94A-A69C6206E8C4">SDO_GEOR.changeFormatCopy</a> procedure to copy the selected GeoRaster object into either a valid existing GeoRaster object or an empty GeoRaster object.</span></li>
                     <li><span>Use UPDATE statement to update the desired row in the destination table so that its GeoRaster column contains the copied GeoRaster object.</span></li>
                     <li><span>When you are ready to commit the transaction, use the COMMIT statement.</span></li>
                  </ol>
                  <div class="section">
                     <p>For an example of copying to replace an existing GeoRaster object and to change its storage format, see the example for the <a href="SDO_GEOR-reference.html#GUID-9C8E8AE6-4C33-4813-B94A-A69C6206E8C4">SDO_GEOR.changeFormatCopy</a> procedure in <a href="SDO_GEOR-reference.html#GUID-587A19B6-40FF-4F1C-AC13-556891070C30" title="The SDO_GEOR package contains subprograms (functions and procedures) for creating, modifying, and retrieving information about GeoRaster objects. This chapter presents reference information, with one or more examples, for each subprogram."> SDO_GEOR Package Reference</a>.
                     </p>
                     <p>Parallel copying and subsetting are supported with the <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-85F23FB6-7F4B-40C4-B023-25DE37FA53BF">SDO_GEOR_AGGR.mosaicSubset</a> procedure. For parallelized copying and change format copying, See <a href="image-processing-virtual-mosaic.html#GUID-8BA68795-65F7-40A6-AD9C-8E774B527176__CHDIAIBB">Example 6-24</a> in <a href="image-processing-virtual-mosaic.html#GUID-8BA68795-65F7-40A6-AD9C-8E774B527176">Parallel Compression, Copying, and Subsetting</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-01A627A0-0EC5-4FAE-AA6A-950116E2FBB8" name="GUID-01A627A0-0EC5-4FAE-AA6A-950116E2FBB8"></a><h3 id="GEORS-GUID-01A627A0-0EC5-4FAE-AA6A-950116E2FBB8" class="sect3"><span class="enumeration_section">4.4 </span>Subsetting GeoRaster Objects with Polygon Clipping
               </h3>
               <div>
                  <p>With GeoRaster, subsetting means cropping rasters spatially, extracting or duplicating raster layers, or doing both together. To perform subsetting, use the <a href="SDO_GEOR-reference.html#GUID-827C49FA-3759-4EC3-8ED5-A9A4E623EEEB">SDO_GEOR.subset</a> procedure. For example, you can call this procedure to crop a small area or obtain a subset of a few layers of a GeoRaster object, to duplicate layers, to specify storage parameters such as blocking and interleaving for the resulting object, and to perform polygon clipping. 
                  </p>
                  <p>For examples, see the <a href="SDO_GEOR-reference.html#GUID-827C49FA-3759-4EC3-8ED5-A9A4E623EEEB">SDO_GEOR.subset</a> reference topic. 
                  </p>
                  <p>You can also use the <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-85F23FB6-7F4B-40C4-B023-25DE37FA53BF">SDO_GEOR_AGGR.mosaicSubset</a> procedure to perform subsetting with parallelism (see <a href="image-processing-virtual-mosaic.html#GUID-8BA68795-65F7-40A6-AD9C-8E774B527176">Parallel Compression, Copying, and Subsetting</a>).
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1002"></a><div class="props_rev_3"><a id="GUID-DB762BC3-88BA-4716-9F0C-A4DC4AEC624F" name="GUID-DB762BC3-88BA-4716-9F0C-A4DC4AEC624F"></a><h3 id="GEORS-GUID-DB762BC3-88BA-4716-9F0C-A4DC4AEC624F" class="sect3"><span class="enumeration_section">4.5 </span>Querying and Updating GeoRaster Metadata
               </h3>
               <div>
                  <p>You can query metadata for a GeoRaster object, and you can update many attributes of the metadata.</p>
                  <p>You can use many functions, most of whose names start with <span class="italic">get</span>, to query the metadata and ancillary information (for example, <a href="SDO_GEOR-reference.html#GUID-2063052F-9197-45EC-9E94-2CE3761A9D16">SDO_GEOR.getTotalLayerNumber</a> and <a href="SDO_GEOR-reference.html#GUID-6BE36C22-6E17-4E96-9928-29EB46869425">SDO_GEOR.hasPseudoColor</a>).
                  </p>
                  <p>You can use several subprograms, most of whose names start with <span class="italic">set</span>, to update metadata and ancillary data (for example, <a href="SDO_GEOR-reference.html#GUID-0406AB05-BA9B-4331-8613-B480A9F12C09">SDO_GEOR.setSRS</a> and <a href="SDO_GEOR-reference.html#GUID-0A226840-C338-4B71-B705-47F7CDD6FC09">SDO_GEOR.setColorMap</a>).
                  </p>
                  <p>For many of the <span class="italic">get</span> functions, there is a corresponding procedure, whose name starts with <span class="italic">set</span>, to set, modify, or delete the value of a metadata attribute. For most <span class="italic">set</span> procedures, to delete the value of the metadata attribute that the procedure is designed to modify, specify a null value for the attribute. For example, to delete the bin table for a layer of a GeoRaster object, call the <a href="SDO_GEOR-reference.html#GUID-2D5830C4-DBF6-4338-86B6-0D10EBF5BF23">SDO_GEOR.setBinTable</a> procedure and specify a null <code class="codeph">tableName</code> parameter. However, in most cases you cannot specify a null value for other related attributes. For example, you cannot specify a null <code class="codeph">layerNumber</code> parameter in a call to the <a href="SDO_GEOR-reference.html#GUID-2D5830C4-DBF6-4338-86B6-0D10EBF5BF23">SDO_GEOR.setBinTable</a> procedure.
                  </p>
                  <p>Note the following recommendations, requirements, and restrictions:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Most GeoRaster metadata can also be retrieved using XMLType methods or XML-specific SQL functions, such as&nbsp;<code class="codeph">extract</code>, and be modified using&nbsp;XQuery Update. However, if a GeoRaster <span class="italic">get</span> or <span class="italic">set</span> subprogram exists for the metadata attribute you want to retrieve or change, use the GeoRaster subprogram instead of an XMLType interface, because the GeoRaster subprograms validate any changes before they are made. If you do call XMLType methods or XML-specific SQL functions to update metadata, you should validate the GeoRaster object before you commit the transaction.
                        </p>
                     </li>
                     <li>
                        <p>Never directly set the metadata to be null.</p>
                     </li>
                     <li>
                        <p>Do not directly update the rasterType attribute of a GeoRaster object; instead, call the <a href="SDO_GEOR-reference.html#GUID-E04962DA-2B64-4FF0-9DFC-C498A761A8A8">SDO_GEOR.setRasterType</a> procedure.
                        </p>
                     </li>
                     <li>
                        <p>To change the raster data table name, use the <a href="SDO_GEOR_UTL-reference.html#GUID-9B5168A6-2624-4E80-B8C8-DC4815B94E36">SDO_GEOR_UTL.renameRDT</a> procedure.
                        </p>
                     </li>
                     <li>
                        <p>In general, you should not directly update the attributes of a GeoRaster object, except for the <code class="codeph">spatialExtent</code> attribute.
                        </p>
                     </li>
                     <li>
                        <p>After updating a GeoRaster object's metadata or cell data (or both) and before you commit a database transaction, you should call the SQL UPDATE statement to update the GeoRaster object (see <a href="georaster-data-manipulation.html#GUID-7AB60C10-E48E-4281-A03A-DA38FFA9F121">Updating GeoRaster Objects Before Committing</a>).
                        </p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1003"></a><div class="props_rev_3"><a id="GUID-D78B30EA-E592-4D34-94AC-AB2B1435D60E" name="GUID-D78B30EA-E592-4D34-94AC-AB2B1435D60E"></a><h3 id="GEORS-GUID-D78B30EA-E592-4D34-94AC-AB2B1435D60E" class="sect3"><span class="enumeration_section">4.6 </span>Querying and Updating GeoRaster Cell Data
               </h3>
               <div>
                  <p>To query cell (pixel) data of a GeoRaster object for processing and visualization, you can query the raster data for a cell (pixel), a range of cells, or the entire raster of a GeoRaster object:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="SDO_GEOR-reference.html#GUID-1E61D84B-F431-4532-B16E-E005596D4DAC">SDO_GEOR.getCellValue</a> returns cell values of one or multiple layers or bands for a specified location.
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR-reference.html#GUID-A5CB5BAE-B73C-43BF-8196-E21FD1196275">SDO_GEOR.getCellValues</a> returns the cell values of one or more cells in an array. 
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR-reference.html#GUID-3997A37D-60FD-4F24-A9D0-F90E9BCCC523">SDO_GEOR.evaluateDouble</a> evaluates a direct location based on neighboring cell values by using a specified interpolation method, and returns the raster values (double precision numbers) for the specified bands or layers for that location. (See <a href="georaster-data-manipulation.html#GUID-8C2E91C6-54EF-4285-9B6F-83002E347B3E">Interpolating Cell Values</a> for more information.)
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR-reference.html#GUID-0E56C4EF-7AA4-4EA1-9E82-B5534193178C">SDO_GEOR.evaluateDoubles</a> evaluates multiple locations using a specified interpolation method, and returns the raster values (double precision numbers) for the specified band or layer for those locations.
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR-reference.html#GUID-CC66F0CA-96A9-4C4F-AB94-AEB5FE53C83D">SDO_GEOR.getRasterSubset</a> creates a single BLOB object or a single in-memory SDO_NUMBER_ARRAY object  containing all cells of a precise subset of the GeoRaster object (as specified by a rectangular window or a clipping polygon geometry, layer or band numbers, and pyramid level). This BLOB object or SDO_NUMBER_ARRAY object contains only raster cells and no related metadata.
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR-reference.html#GUID-4C357F31-6844-4CF2-BB86-E49A15F40522">SDO_GEOR.getRasterData</a> creates a single BLOB object containing all cells of the GeoRaster object at a specified pyramid level. This BLOB object contains only raster cells and no related metadata.
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR-reference.html#GUID-684DC2C4-0F25-4EC8-A18C-8E1985A172E9">SDO_GEOR.getRasterBlocks</a> returns an object that includes all image data inside or touching a specified window. Specifically, it returns an object of the SDO_RASTERSET collection type that identifies all blocks of a specified pyramid level that are inside or touch a specified window.
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR-reference.html#GUID-9B3FA7F4-E6CA-4FDB-9DF9-EFEC63C19A55">SDO_GEOR.reproject</a> not only transforms a whole GeoRaster object from one projected coordinate system to another, but can also include the same capability as <a href="SDO_GEOR-reference.html#GUID-CC66F0CA-96A9-4C4F-AB94-AEB5FE53C83D">SDO_GEOR.getRasterSubset</a> by directly transforming the query result into a different coordinate system on-the-fly.
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR-reference.html#GUID-FAC58FA1-3707-498F-BC69-7D36C17BDFA1">SDO_GEOR.rectify</a> performs reprojection, rectification, or orthorectification on all or part of a georeferenced GeoRaster object based on a query window. The resulting object can be a new GeoRaster object (for persistent storage) or a BLOB (for temporary use).
                        </p>
                     </li>
                     <li>
                        <p><a href="sdo-geor-ra-ref.html#GUID-67FDA0FA-D055-4821-964F-600660861A72">SDO_GEOR_RA.findCells</a> generates a new GeoRaster object based on the cell values using the GeoRaster Raster Algebra language. (See <a href="raster-algebra-and-analytics.html#GUID-FF9C7591-6CCB-41B2-941D-7998F94B8FE9" title="Using cell-based conditional queries, you can generate a new GeoRaster object based on a specified condition.">Cell Value-Based Conditional Queries</a> for more information.)
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-85F23FB6-7F4B-40C4-B023-25DE37FA53BF">SDO_GEOR_AGGR.mosaicSubset</a> mosaics a number of GeoRaster objects into one GeoRaster object.
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-89303715-7E1A-46B9-8CDE-0228C48388D7">SDO_GEOR_AGGR.getMosaicSubset</a> lets you query a virtual mosaic and returns a mosaicked subset on-the-fly.
                        </p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR-reference.html#GUID-15EE67B7-1CB4-46C9-AAA3-5823D9D9C87F">SDO_GEOR.getBitmapMask</a>, <a href="SDO_GEOR-reference.html#GUID-FD56B2AC-429D-4558-8C49-93B9FEE7B963">SDO_GEOR.getBitmapMaskSubset</a>, <a href="SDO_GEOR-reference.html#GUID-6F14DFC5-C9F1-44DF-8D39-771A642E9189">SDO_GEOR.getBitmapMaskValue</a>, and <a href="SDO_GEOR-reference.html#GUID-168512A1-60B7-4C69-BADB-EB605E72A9CC">SDO_GEOR.getBitmapMaskValues</a> let you query bitmap masks on the basis of a full raster, a window, or single cells.
                        </p>
                     </li>
                  </ul>
                  <p>You can also use the <a href="SDO_GEOR-reference.html#GUID-6261233E-5E90-479C-97FD-8125C28EC838">SDO_GEOR.exportTo</a> procedure to export all or part of a raster image to a BLOB object (binary image format) or to a file of a specified file format type.
                  </p>
                  <p>There are two types of raster updates: space-based and cell value-based</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Space-based raster update allows you update a GeoRaster object's raster data inside a specified window entirely using either a single value or another GeoRaster object. </p>
                        <p>To update or change the value of raster cells in a specified window to a single value, you can use the <a href="SDO_GEOR-reference.html#GUID-7F2859CD-4A33-4711-A926-5CFA405C7551">SDO_GEOR.changeCellValue</a> procedure. To change the value of raster cells specified by row/column arrays or by a multipoint geometry to new values, you can use the <a href="SDO_GEOR-reference.html#GUID-087181AF-7695-4B17-A764-C63AF9096FA4">SDO_GEOR.changeCellValues</a>procedure. You can call the <a href="SDO_GEOR-reference.html#GUID-ED3D72BF-B5C4-46B1-832C-287BF7696B3E">SDO_GEOR.updateRaster</a> procedure to update a specified pyramid of a specified area, or the overlapping parts of one GeoRaster object, with a specified pyramid and specified bands or layers of another GeoRaster object. Both the <a href="SDO_GEOR-reference.html#GUID-7F2859CD-4A33-4711-A926-5CFA405C7551">SDO_GEOR.changeCellValue</a> and the <a href="SDO_GEOR-reference.html#GUID-ED3D72BF-B5C4-46B1-832C-287BF7696B3E">SDO_GEOR.updateRaster</a> procedures support all pyramid levels, including the original raster data (that is, pyramid level 0). 
                        </p>
                        <p>The <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-D47B17BE-79C2-4610-B75A-D03182FD40FB">SDO_GEOR_AGGR.append</a> procedure can also be used to update an existing image with a new image (see <a href="image-processing-virtual-mosaic.html#GUID-EE1AFE0D-730E-49DC-80AF-E99504D14156" title="You can append one image to another image when the two images have the same number of bands.">Image Appending</a>).
                        </p>
                     </li>
                     <li>
                        <p>Cell value-based raster update allows you update a GeoRaster object's raster data based on the cell values using the GeoRaster Raster Algebra language.</p>
                        <p><a href="sdo-geor-ra-ref.html#GUID-7F1A50AC-9595-4AC3-83E3-D7233C9FAF2E">SDO_GEOR_RA.rasterUpdate</a> selects cells from the specified GeoRaster object based on Boolean strings specified in the <code class="codeph">conditions</code> parameter, and updates corresponding cell values by calculating expression strings specified in the <code class="codeph">vals</code> parameter. Both the <code class="codeph">conditions</code> and <code class="codeph">vals</code> parameters can be complicated expressions using the raster algebra language. (See <a href="raster-algebra-and-analytics.html#GUID-0AEAF37F-6147-4CC7-9573-929B1EF6B44F" title="You can update raster cell values based on conditions.">Cell Value-Based Conditional Updates (Edits)</a> for more information.)
                        </p>
                     </li>
                  </ul>
                  <p>If statistics are already set in the GeoRaster object when you perform space-based or raster cell value-based updates, the statistics are not removed or updated automatically after you run the raster update procedures. If necessary, you should remove or regenerate the statistics.</p>
                  <div class="infoboxnote" id="GUID-D78B30EA-E592-4D34-94AC-AB2B1435D60E__GUID-B2B388D0-6C32-4AF5-B4A0-3432DB0214E2">
                     <p class="notep1">Note:</p>
                     <p>If you use any procedure that adds or overwrites data in the input GeoRaster object, you should make a copy of the original GeoRaster object and use the procedure on the copied object. After you are satisfied with the result of the procedure, you can discard the original GeoRaster object if you wish. </p>
                  </div>
                  <p>If you want to change the raster data table name, the attributes of a GeoRaster object, or any other metadata, see the recommendations, requirements, and restrictions noted in <a href="georaster-data-manipulation.html#GUID-DB762BC3-88BA-4716-9F0C-A4DC4AEC624F">Querying and Updating GeoRaster Metadata</a>.
                  </p>
                  <p>After updating a GeoRaster object's metadata or cell data (or both) and before you commit a database transaction, you should call the SQL UPDATE statement to update the GeoRaster object (see <a href="georaster-data-manipulation.html#GUID-7AB60C10-E48E-4281-A03A-DA38FFA9F121">Updating GeoRaster Objects Before Committing</a>).
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1244"></a><div class="props_rev_3"><a id="GUID-8C2E91C6-54EF-4285-9B6F-83002E347B3E" name="GUID-8C2E91C6-54EF-4285-9B6F-83002E347B3E"></a><h3 id="GEORS-GUID-8C2E91C6-54EF-4285-9B6F-83002E347B3E" class="sect3"><span class="enumeration_section">4.7 </span>Interpolating Cell Values
               </h3>
               <div>
                  <p>GeoRaster objects are grid coverages. The "evaluate" operation of a grid coverage is also called <span class="bold">grid interpolation</span>, a method for interpolating cell values at point positions between the cells or within the cells. This operation in GeoRaster is performed by the <a href="SDO_GEOR-reference.html#GUID-3997A37D-60FD-4F24-A9D0-F90E9BCCC523">SDO_GEOR.evaluateDouble</a> function, which evaluates any point in the raster and returns a double number value for that location. You can use any one of the six different interpolation methods (listed in <a href="georaster-overview-and-concepts.html#GUID-3BD837FF-70CF-44B3-8489-242FF4590D61" title="Many image and raster transformations and operations involve pixel or cell resampling and interpolation.">Resampling and Interpolation</a>) to do the evaluation. For example, if a georaster object is a DEM layer, you can find out the elevation of a random point location, using the following example:
                  </p><pre class="oac_no_warn" dir="ltr">SELECT SDO_GEOR.evaluateDouble(a.georaster, 0, 
    SDO_GEOMETRY(2001, 4326, SDO_POINT_TYPE(112.704, 41.917, NULL),
                 NULL, NULL),
    '1', 
    'interpolationMethod=BILINEAR') 
  FROM georaster_table a WHERE raster_name='myDEM';
</pre><p>If you call <a href="SDO_GEOR-reference.html#GUID-3997A37D-60FD-4F24-A9D0-F90E9BCCC523">SDO_GEOR.evaluateDouble</a> with <code class="codeph">'interpolationMethod=NN'</code>, the GeoRaster object is treated as a discrete raster and the preceding is the same as calling <a href="SDO_GEOR-reference.html#GUID-1E61D84B-F431-4532-B16E-E005596D4DAC">SDO_GEOR.getCellValue</a>, which gives you the same value (that is, the cell value) at a different point location inside a cell. In this case, you can directly call <a href="SDO_GEOR-reference.html#GUID-1E61D84B-F431-4532-B16E-E005596D4DAC">SDO_GEOR.getCellValue</a> instead, particularly when you query only the cell values of a single band. Other interpolation methods treat the raster as a continuous surface and may give you different values at different point locations inside a cell.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1004"></a><div class="props_rev_3"><a id="GUID-D5389E0F-A151-4476-8EA6-DCA329FEFB31" name="GUID-D5389E0F-A151-4476-8EA6-DCA329FEFB31"></a><h3 id="GEORS-GUID-D5389E0F-A151-4476-8EA6-DCA329FEFB31" class="sect3"><span class="enumeration_section">4.8 </span>Processing and Analyzing GeoRaster Objects
               </h3>
               <div>
                  <p>You can perform a variety of raster and image processing operations on GeoRaster data, including changing the internal raster storage format, subsetting (cropping), scaling, rotating, masking, stretching, filtering, dodging, reprojecting (from one coordinate system to another), rectifying, orthorectifying, warping, mosaicking, appending, and generating pyramids. GeoRaster also supports virtual mosaic. Some relevant subprograms are <a href="SDO_GEOR-reference.html#GUID-9C8E8AE6-4C33-4813-B94A-A69C6206E8C4">SDO_GEOR.changeFormatCopy</a>, <a href="SDO_GEOR-reference.html#GUID-827C49FA-3759-4EC3-8ED5-A9A4E623EEEB">SDO_GEOR.subset</a>, <a href="SDO_GEOR-reference.html#GUID-9B3FA7F4-E6CA-4FDB-9DF9-EFEC63C19A55">SDO_GEOR.reproject</a>, <a href="SDO_GEOR-reference.html#GUID-FAC58FA1-3707-498F-BC69-7D36C17BDFA1">SDO_GEOR.rectify</a>, <a href="SDO_GEOR-reference.html#GUID-896CB187-FAC1-4A2C-9921-B98AC4E92F3B">SDO_GEOR.generatePyramid</a>, <a href="SDO_GEOR-reference.html#GUID-351B293B-CE47-45E0-92F0-DC7A52D84FDF">SDO_GEOR.deletePyramid</a>, <a href="SDO_GEOR-reference.html#GUID-3F7A39BD-67FB-40B7-9143-32FA5DFD9628">SDO_GEOR.scaleCopy</a>, <a href="SDO_GEOR-reference.html#GUID-859F107A-4D75-4C36-B9FC-690FA202789C">SDO_GEOR.mergeLayers</a>, <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-85F23FB6-7F4B-40C4-B023-25DE37FA53BF">SDO_GEOR_AGGR.mosaicSubset</a>, <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-89303715-7E1A-46B9-8CDE-0228C48388D7">SDO_GEOR_AGGR.getMosaicSubset</a>, and <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-D47B17BE-79C2-4610-B75A-D03182FD40FB">SDO_GEOR_AGGR.append</a>. For detailed descriptions, see <a href="image-processing-virtual-mosaic.html#GUID-EB60166B-6A52-4974-AF16-139CD6480EBC" title="This chapter describes advanced image processing capabilities, including GCP georeferencing, reprojection, rectification, orthorectification, warping, image scaling, stretching, filtering, masking, segmentation, NDVI computation, Tasseled Cap Transformation, image appending, bands merging, and large-scale advanced image mosaicking."> Image Processing and Virtual Mosaic</a>, <a href="SDO_GEOR-reference.html#GUID-587A19B6-40FF-4F1C-AC13-556891070C30" title="The SDO_GEOR package contains subprograms (functions and procedures) for creating, modifying, and retrieving information about GeoRaster objects. This chapter presents reference information, with one or more examples, for each subprogram."> SDO_GEOR Package Reference</a>, and <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-92406947-E079-487D-B0D0-3342ECC23E34" title="The SDO_GEOR_AGGR package contains subprograms (functions and procedures) for performing advanced large-scale mosaicking, appending, and virtual mosaic operations on GeoRaster objects. This chapter presents reference information, with one or more examples, for each subprogram."> SDO_GEOR_AGGR Package Reference</a>. 
                  </p>
                  <p>For raster cell value-based algebraic operations and cartographic modeling and analysis, GeoRaster supports a raster algebra language (PL/SQL and Algebraic Expressions) and related raster operations, including conditional queries (<a href="sdo-geor-ra-ref.html#GUID-67FDA0FA-D055-4821-964F-600660861A72">SDO_GEOR_RA.findCells</a>), cell value-based updates or edits (<a href="sdo-geor-ra-ref.html#GUID-7F1A50AC-9595-4AC3-83E3-D7233C9FAF2E">SDO_GEOR_RA.rasterUpdate</a>), logical and mathematical operations (<a href="sdo-geor-ra-ref.html#GUID-BB7A762E-E615-43AD-9D74-5E917D29F333">SDO_GEOR_RA.rasterMathOp</a>), and image and raster segmentation (<a href="sdo-geor-ra-ref.html#GUID-D9DA6608-7D97-4428-B1B2-002C371846E9">SDO_GEOR_RA.classify</a>). The <a href="SDO_GEOR-reference.html#GUID-96B2E47F-17E2-491D-9FF6-AC7BEFB434D7">SDO_GEOR.generateStatistics</a> function supports polygon-based statistics and histogram generation. The following on-the-fly functions support interactive statistical analysis of a GeoRaster object or its layers: <a href="SDO_GEOR-reference.html#GUID-FD88A636-A97B-456E-A07A-DE2D6AE54545">SDO_GEOR.generateStatisticsMax</a>, <a href="SDO_GEOR-reference.html#GUID-CE118FEB-6F5D-4B42-9D95-2989355D7222">SDO_GEOR.generateStatisticsMean</a>, <a href="SDO_GEOR-reference.html#GUID-5726F33E-CDE7-4793-9973-B0F779E629E8">SDO_GEOR.generateStatisticsMedian</a>, <a href="SDO_GEOR-reference.html#GUID-963EB183-C710-471B-A1DA-9665D93FE2DC">SDO_GEOR.generateStatisticsMin</a>, <a href="SDO_GEOR-reference.html#GUID-D36B7F54-FEF4-4111-AF3F-99A193BEC0D9">SDO_GEOR.generateStatisticsMode</a>, and <a href="SDO_GEOR-reference.html#GUID-453A78AC-CCDB-4E87-9A67-7C2C113B1C57">SDO_GEOR.generateStatisticsSTD</a>. For detailed descriptions, see <a href="raster-algebra-and-analytics.html#GUID-C75744C9-FA04-4391-96F2-59EF2EA212FF" title="This chapter describes the raster algebra language (PL/SQL and algebraic expressions) and related raster operations, including conditional queries, cell value-based updates or edits, mathematical operations, classify, on-the-fly statistical analysis, logical operations, and their applications in cartographic modeling.">Raster Algebra and Analytics</a> and <a href="sdo-geor-ra-ref.html#GUID-7E8EC42B-D663-49EF-B6D8-158A0EC10333" title="The SDO_GEOR_RA package contains subprograms (functions and procedures) for raster algebra and analytic operations related to GeoRaster. This chapter presents reference information, with one or more examples, for each subprogram."> SDO_GEOR_RA Package Reference</a>.
                  </p>
                  <p>See also the GeoRaster PL/SQL demo files, described in <a href="georaster-overview-and-concepts.html#GUID-0B5D0180-E897-4F30-9E65-65D827024A95" title="GeoRaster includes several PL/SQL and Java sample code files that show common operations.">GeoRaster PL/SQL and Java Demo Files</a>, for examples and explanatory comments.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1245"></a><div class="props_rev_3"><a id="GUID-AA00D7EE-B6ED-4A42-9475-F353CB5989AC" name="GUID-AA00D7EE-B6ED-4A42-9475-F353CB5989AC"></a><h3 id="GEORS-GUID-AA00D7EE-B6ED-4A42-9475-F353CB5989AC" class="sect3"><span class="enumeration_section">4.9 </span>Monitoring and Reporting GeoRaster Operation Progress
               </h3>
               <div>
                  <div class="section">
                     <p>GeoRaster lets you monitor and report the execution progress of many operations (listed in <a href="georaster-overview-and-concepts.html#GUID-B57F4783-7F39-4AC2-AB95-02984E3C44E9" title="For some resource-intensive operations, GeoRaster enables you to monitor and report their execution progress.">Reporting Operation Progress in GeoRaster</a>). The following are the basic steps for reporting the progress of an operation: 
                     </p>
                     <ol>
                        <li>
                           <p>Use the <a href="SDO_GEOR_UTL-reference.html#GUID-E35FA2E9-24FD-455B-B53F-B42DDDD3D71C">SDO_GEOR_UTL.createReportTable</a> procedure to create the report table under the appropriate user's schema. (This must be called once before you can monitor any operations.)
                           </p><pre class="oac_no_warn" dir="ltr">EXECUTE SDO_GEOR_UTL.createReportTable;
</pre></li>
                        <li>
                           <p>In the user session where the operations are to be executed and monitored, perform the following actions:</p>
                           <ol type="a">
                              <li>
                                 <p>Use <a href="SDO_GEOR_UTL-reference.html#GUID-15481B20-58FD-47D8-A97D-65F8F1FE287D">SDO_GEOR_UTL.enableReport</a> to enable the monitoring. (You must call this procedure in order to be able to get the status report later.)
                                 </p><pre class="oac_no_warn" dir="ltr">EXECUTE SDO_GEOR_UTL.enableReport;
</pre></li>
                              <li>
                                 <p>Optionally, use <a href="SDO_GEOR_UTL-reference.html#GUID-C0CB06F5-4A64-436E-99D3-C9F48C759585">SDO_GEOR_UTL.setClientID</a> to set the client ID. The client ID is used to identify the user session that executes the operation. If this procedure is not called, the client ID defaults to the SQL session ID. For example:
                                 </p><pre class="oac_no_warn" dir="ltr">EXECUTE SDO_GEOR_UTL.setClientID(100);
</pre></li>
                              <li>
                                 <p>Optionally, use <a href="SDO_GEOR_UTL-reference.html#GUID-1E056015-616E-4D1D-8524-248A6E60CEE9">SDO_GEOR_UTL.setSeqID</a> to set the sequence ID. The sequence ID is used to identify the repeated operations in the same SQL session. If this procedure is not called, the sequence ID defaults to 0. For example:
                                 </p><pre class="oac_no_warn" dir="ltr">EXECUTE SDO_GEOR_UTL.setSeqID(1);
</pre></li>
                              <li>
                                 <p>Execute the operation to be monitored. For example:</p><pre class="oac_no_warn" dir="ltr">-- Generate pyramid for georid=6. The progress of this generatePyramid call 
-- can be monitored by step 3.
DECLARE
  gr sdo_georaster;
BEGIN
   SELECT georaster INTO gr 
    FROM georaster_table WHERE georid = 6 FOR UPDATE;
  sdo_geor.generatePyramid(gr, 'rLevel=5, resampling=NN');
  UPDATE georaster_table SET georaster = gr WHERE georid = 6;
   COMMIT;
END;
/
</pre></li>
                              <li>
                                 <p>Optionally, repeat steps c and d for each additional operation to be monitored. For example:</p><pre class="oac_no_warn" dir="ltr">EXECUTE SDO_GEOR_UTL.setSeqID(2);
-- Generate pyramid for georid=7. The progress of this generatePyramid call
-- can be monitored by step 3.
DECLARE
  gr sdo_georaster;
BEGIN
   SELECT georaster INTO gr 
    FROM georaster_table WHERE georid = 7 FOR UPDATE;
  sdo_geor.generatePyramid(gr, 'rLevel=5, resampling=NN');
  UPDATE georaster_table SET georaster = gr WHERE georid = 7;
   COMMIT;
END;
/
</pre></li>
                              <li>
                                 <p>Optionally, use <a href="SDO_GEOR_UTL-reference.html#GUID-7102EF4A-0279-4079-83FB-1B8EFE8C3A12">SDO_GEOR_UTL.disableReport</a> to disable the monitoring. If this procedure is not called, the monitoring is automatically stopped when the user session ends. 
                                 </p><pre class="oac_no_warn" dir="ltr">EXECUTE SDO_GEOR_UTL.disableReport;
</pre></li>
                           </ol>
                        </li>
                        <li>
                           <p>From another session under the same user, retrieve the execution status report.</p>
                           <p>To get the progress of a specific operation identified by client ID and sequence ID, use the <a href="SDO_GEOR_UTL-reference.html#GUID-34284A54-1792-4845-8F27-078AAE159413">SDO_GEOR_UTL.getProgress</a> function. This function returns the progress as a number between 0 and 1 reflecting the percentage of completion. For example, the following query shows that the operation if 55% complete:
                           </p><pre class="oac_no_warn" dir="ltr">SELECT sdo_geor_utl.getProgress(100, 2) progress FROM DUAL;
 
PROGRESS
--------
    0.55
 
1 row selected.
</pre><p>To get the status report of a specific operation identified by client ID and sequence ID, use the <a href="SDO_GEOR_UTL-reference.html#GUID-7AC9801F-D891-4A9B-9BD9-87D273C7DC6F">SDO_GEOR_UTL.getStatusReport</a> function. This function returns an array of strings describing the progress and other information about the operation. For example:
                           </p><pre class="oac_no_warn" dir="ltr">-- Check the status of the generatePyramid on georid=6
SELECT sdo_geor_utl.getStatusReport(100, 1) FROM DUAL;
SDO_GEOR_UTL.GETSTATUSREPORT(100,1)
-----------------------------------------------------------------------------
SDO_STRING2_ARRAY('31-OCT-11 02.20.04.854558 PM', 'GeneratePyramid', 'RDT:RDT_1', 'RID:6', '100% complete', 'operation completed')
 
1 row selected.

-- Check the status of the generatePyramid on georid=7
SELECT sdo_geor_utl.getStatusReport(100, 2) FROM DUAL;
 
SDO_GEOR_UTL.GETSTATUSREPORT(100,2)
-----------------------------------------------------------------------------
SDO_STRING2_ARRAY('31-OCT-11 02.20.08.854558 PM', 'GeneratePyramid', 'RDT:RDT_1', 'RID:7', '55% complete', 'operation completed')
 
1 row selected.
</pre><p>To get the status of all the monitored operations, enter the following statement:</p><pre class="oac_no_warn" dir="ltr">SELECT * from the (select sdo_geor_utl.getAllStatusReport() FROM DUAL); 
COLUMN_VALUE
------------------------------------------------------------------------------
SDO_STRING2_ARRAY('Client:100', 'Sequence:1', '31-OCT-11 02.20.04.854558 PM', 'GeneratePyramid', 'RDT:RDT_1', 'RID:6', '100% complete', 'operation completed')
SDO_STRING2_ARRAY('Client:100', 'Sequence:2', '31-OCT-11 02.20.08.854558 PM', 'GeneratePyramid', 'RDT:RDT_1', 'RID:7', '55% complete', NULL)
 
2 rows selected.
</pre></li>
                     </ol>
                     <p>If you need to clear or drop the report table, use the <a href="SDO_GEOR_UTL-reference.html#GUID-DC1098B1-94FF-4150-9BBF-13E30CE34F15">SDO_GEOR_UTL.clearReportTable</a> or <a href="SDO_GEOR_UTL-reference.html#GUID-E4389281-1803-4FB7-A61C-42D0CD4105FC">SDO_GEOR_UTL.dropReportTable</a> procedure, respectively:
                     </p><pre class="oac_no_warn" dir="ltr">EXECUTE SDO_GEOR_UTL.clearReportTable;
-- or:
EXECUTE SDO_GEOR_UTL.dropReportTable;</pre></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1005"></a><div class="props_rev_3"><a id="GUID-900D8B54-15B7-4044-AF7F-7BC6854535FE" name="GUID-900D8B54-15B7-4044-AF7F-7BC6854535FE"></a><h3 id="GEORS-GUID-900D8B54-15B7-4044-AF7F-7BC6854535FE" class="sect3"><span class="enumeration_section">4.10 </span>Compressing and Decompressing GeoRaster Objects
               </h3>
               <div>
                  <p>You can reduce the storage space requirements for GeoRaster objects by compressing them using JPEG-F, DEFLATE, or JPEG 2000 compression. You can decompress any compressed GeoRaster object, although this is not required for any GeoRaster operations, because any GeoRaster operation that can be performed on an uncompressed (decompressed) GeoRaster object can be performed on a compressed GeoRaster object.</p>
                  <p>For JPEG-F and DEFLATE, to compress or decompress a GeoRaster object, use the <code class="codeph">compression</code> keyword in the <code class="codeph">storageParam</code> parameter with the <a href="SDO_GEOR-reference.html#GUID-9C8E8AE6-4C33-4813-B94A-A69C6206E8C4">SDO_GEOR.changeFormatCopy</a> procedure, or with several other procedures that load and process a GeoRaster object to create another GeoRaster object, including <a href="SDO_GEOR-reference.html#GUID-07B69D26-239F-4C52-A2D2-E776B2BABF8B">SDO_GEOR.importFrom</a>, <a href="SDO_GEOR-reference.html#GUID-17F61F94-A06C-41F4-A064-9243C8904F31">SDO_GEOR.mosaic</a>, <a href="SDO_GEOR-reference.html#GUID-3F7A39BD-67FB-40B7-9143-32FA5DFD9628">SDO_GEOR.scaleCopy</a>, <a href="SDO_GEOR-reference.html#GUID-827C49FA-3759-4EC3-8ED5-A9A4E623EEEB">SDO_GEOR.subset</a>, raster algebra (SDO_GEOR_RA) procedures, and <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-85F23FB6-7F4B-40C4-B023-25DE37FA53BF">SDO_GEOR_AGGR.mosaicSubset</a>. (For JPEG-F and DEFLATE compression, there are no separate procedures for compressing and decompressing a GeoRaster object.)
                  </p>
                  <p>For JPEG 2000, use the <a href="SDO_GEOR-reference.html#GUID-B9F2CE15-3808-46E7-B1E5-A666B3E76BEE">SDO_GEOR.compressJP2</a> and <a href="SDO_GEOR-reference.html#GUID-6B411E83-F1F7-4EB3-9A65-99F95F52EF97">SDO_GEOR.decompressJP2</a> procedures to compress and decompress a GeoRastrer object, respectively. Most other procedures and functions (except for <a href="SDO_GEOR-reference.html#GUID-7F2859CD-4A33-4711-A926-5CFA405C7551">SDO_GEOR.changeCellValue</a>, <a href="SDO_GEOR-reference.html#GUID-FAC58FA1-3707-498F-BC69-7D36C17BDFA1">SDO_GEOR.reproject</a>, <a href="SDO_GEOR-reference.html#GUID-3F7A39BD-67FB-40B7-9143-32FA5DFD9628">sdo_geor.scaleScopy</a>, and <a href="SDO_GEOR-reference.html#GUID-17F61F94-A06C-41F4-A064-9243C8904F31">sdo_geor.mosaic</a>) can internally decompress the JP2 compressed GeoRaster object while performing the operation.
                  </p>
                  <p>For more information about GeoRaster compression and decompression, see <a href="georaster-overview-and-concepts.html#GUID-9BEA34A1-E05E-4E70-B09D-97A0EF1027B8" title="GeoRaster provides the following types of native compression to reduce storage space requirements for GeoRaster objects: JPEG (JPEG-F), JPEG 2000, and DEFLATE.">Compression and Decompression</a>, including information about support for third-party compression solutions in <a href="georaster-overview-and-concepts.html#GUID-D2F21C14-DC30-49A9-A5AD-6220412F9A81">Third-Party Plug-ins for Compression</a>.
                  </p>
                  <p>In addition, when JPEG-F or DEFLATE compression is used with GeoRaster objects, some special usage considerations apply:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If a large GeoRaster object is to be compressed and will have full pyramids built on it, it is faster to generate pyramids on the uncompressed GeoRaster object first, then apply compression.</p>
                     </li>
                     <li>
                        <p>For large scale mosaicking, it is faster to mosaic without applying compression first, then generate pyramids, then apply compression.</p>
                     </li>
                     <li>
                        <p>In some operations, GeoRaster uses temporary tablespaces to compress and decompress data, so adding temporary tablespaces for GeoRaster users is essential for performance (see <a href="georaster-database-creation-management.html#GUID-2162EF15-706C-43D2-B2BF-AAD219D8CB88">Adding Temporary Tablespaces for GeoRaster Users</a>).
                        </p>
                     </li>
                  </ul>
                  <p>Parallel compression and decompression for JPEG and DEFLATE are supported with the <a href="SDO_GEOR-reference.html#GUID-9C8E8AE6-4C33-4813-B94A-A69C6206E8C4">SDO_GEOR.changeFormatCopy</a> procedure, if reformatting is not needed, by using the <code class="codeph">parallel</code> keyword in the <code class="codeph">storageParam</code> parameter. You can also call the <a href="SDO_GEOR_AGGR-referencer-ref.html#GUID-85F23FB6-7F4B-40C4-B023-25DE37FA53BF">SDO_GEOR_AGGR.mosaicSubset</a> procedure, which provides better performance if you want to change the raster format while doing parallelized compression or decompression. Parallel compression and decompression significantly improve performance, which is especially useful for large images. See <a href="image-processing-virtual-mosaic.html#GUID-8BA68795-65F7-40A6-AD9C-8E774B527176__CHDEDHCE">Example 6-23</a> in <a href="image-processing-virtual-mosaic.html#GUID-8BA68795-65F7-40A6-AD9C-8E774B527176">Parallel Compression, Copying, and Subsetting</a></p>
                  <p>If you want to store compressed GeoRaster objects, make sure you create a temporary tablespace for the users. For more information, see <a href="georaster-database-creation-management.html#GUID-2162EF15-706C-43D2-B2BF-AAD219D8CB88">Adding Temporary Tablespaces for GeoRaster Users</a>.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1246"></a><div class="props_rev_3"><a id="GUID-3FE51533-061E-4A2F-BB3E-49A723FE3553" name="GUID-3FE51533-061E-4A2F-BB3E-49A723FE3553"></a><h3 id="GEORS-GUID-3FE51533-061E-4A2F-BB3E-49A723FE3553" class="sect3"><span class="enumeration_section">4.11 </span>Deleting GeoRaster Objects, and Performing Actions on GeoRaster Tables and RDTs
               </h3>
               <div>
                  <p>GeoRaster automatically maintains the GeoRaster metadata and the relationship between GeoRaster tables and raster data tables (RDTs). Therefore, for most operations you can use the relevant traditional SQL statement.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="bold">To delete a GeoRaster object</span>, delete the row containing the object using the DELETE statement (for example, <code class="codeph">DELETE FROM geor_table WHERE ...;</code>).
                        </p>
                        <p>After a GeoRaster object is deleted from a GeoRaster table, all related raster data stored in the RDT is deleted automatically. Never insert or delete any rows directly in a raster data table.</p>
                     </li>
                     <li>
                        <p><span class="bold">To drop a GeoRaster table</span>, use the DROP statement (for example, <code class="codeph">DROP geor_table;</code>).
                        </p>
                        <p>After a GeoRaster table is dropped, all raster data associated with GeoRaster objects in the deleted GeoRaster table is deleted automatically.</p>
                     </li>
                     <li>
                        <p><span class="bold">To rename a GeoRaster table</span>, use the RENAME statement (for example, <code class="codeph">RENAME geor_table1 TO geor_table2;</code>).
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">To add a GeoRaster column to a table</span>, use the ALTER TABLE statement.
                        </p>
                        <p>However, if you use the ALTER TABLE statement to add one or more GeoRaster columns, you must call the <a href="SDO_GEOR_UTL-reference.html#GUID-CCA772B5-AA1E-4A53-B64C-67D8F6052CF2">SDO_GEOR_UTL.createDMLTrigger</a> procedure to create the DML trigger on each added GeoRaster column. For example:
                        </p><pre class="pre codeblock"><code>ALTER TABLE geor_table ADD (image SDO_GEORASTER);  
CALL sdo_geor_utl.createdmltrigger('GEOR_TABLE','IMAGE');)
</code></pre></li>
                     <li>
                        <p><span class="bold">To drop a GeoRaster column in a table</span>, use the ALTER TABLE statement (for example, <code class="codeph">ALTER TABLE geor_table DROP COLUMN image;</code>).
                        </p>
                        <p>Caution: Dropping a GeoRaster column will delete all GeoRaster objects in that column.</p>
                     </li>
                     <li>
                        <p><span class="bold">To drop an RDT</span>, you must first delete all GeoRaster objects that reference the RDT, after which you can use the DROP statement on the RDT.
                        </p>
                        <p>If you do not delete all GeoRaster objects that reference the RDT before attempting to drop the RDT, an exception is raised.</p>
                     </li>
                     <li>
                        <p><span class="bold">To rename an RDT</span>, use the <a href="SDO_GEOR_UTL-reference.html#GUID-9B5168A6-2624-4E80-B8C8-DC4815B94E36">SDO_GEOR_UTL.renameRDT</a> procedure.
                        </p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-CA53EDD9-AC59-479F-8280-82EAF85A2141" name="GUID-CA53EDD9-AC59-479F-8280-82EAF85A2141"></a><h3 id="GEORS-GUID-CA53EDD9-AC59-479F-8280-82EAF85A2141" class="sect3"><span class="enumeration_section">4.12 </span>Performing Cross-Schema Operations
               </h3>
               <div>
                  <p>All GeoRaster operations can work on GeoRaster objects defined in schemas other than the current connection schema. In other words, GeoRaster fully supports cross-schema access, update, and processing. </p>
                  <p>For more information, see <a href="georaster-overview-and-concepts.html#GUID-19C1371A-74D8-409C-89C8-D52FF41F405F">Cross-Schema Support with GeoRaster</a>.
                  </p>
                  <div class="example" id="GUID-CA53EDD9-AC59-479F-8280-82EAF85A2141__GUID-1F52A77A-C5E6-4B25-B74E-A3FADE5B6A06">
                     <p class="titleinexample">Example 4-2 Cross-Schema Copy Operation</p>
                     <p>In the following example, USER2 makes a copy of an image from USER1 and stores it in the USER2 schema. Assume that USER1 owns the GEORASTER_TABLE table and that USER2 owns the G_TABLE table.</p><pre class="pre codeblock"><code>--connect to user1 and grant permissons to user2
--assume user1 stores the image in georaster_table and the image’s RDT table is rdt_1 
conn user1/pswd1
 grant select on georaster_table to user2;
grant select on rdt_1 to user2;

--connect to user2 and make a copy of a georaster from user1
conn user2/pswd2
SQL&gt; DECLARE
   gr1 sdo_georaster;
   gr2 sdo_georaster;
BEGIN
   --select the image from georaster_table in user1
   select georaster into gr1 from user1.georaster_table where georid = 100;
   -- the copy is to be stored in g_table in user2, assuming the georaster object is already initiated
   select geor into gr2 from g_table where id = 1 for update;
   sdo_geor.changeFormatCopy(gr1, 'blocking=OPTIMALPADDING blocksize=(512,512,3) interleaving=BIP', gr2);
   update g_table set geor=gr2 where id=1;
   commit;
END;
/ 
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-CA53EDD9-AC59-479F-8280-82EAF85A2141__GUID-F4C522CC-09B6-45D0-B18C-3055B68CFC09">
                     <p class="titleinexample">Example 4-3 Cross-Schema Raster Algebra and Copy Operation</p>
                     <p>In the following example, USER2 runs a raster algebra operation on an image in the USER1 schema and stores the result in USER1. Assume that USER1 owns both the GEORASTER_TABLE and G_TABLE tables. The existing image is in GEORASTER_TABLE and the image’s raster data table is RDT_1. The resulting image is stored in G_TABLE and its raster data table is RDT_2.</p><pre class="pre codeblock"><code>--connect to user1 and grant permissons to user2
conn user1/pswd1
grant select on georaster_table to user2;
grant select on rdt_1 to user2;
grant select, update, insert, delete on g_table to user2;
grant select, update, insert, delete on rdt_2 to user2;

--connect to user2 and run a raster algebra operation on an image in user1 
conn user2/pswd2
DECLARE
   gr1 sdo_georaster;
   gr2 sdo_georaster;
BEGIN
   --select the image from georaster_table in user1
   select georaster into gr1 from user1.georaster_table where georid = 100;
   -- the result is to be stored in g_table in user1, assuming the georaster object is already initiated
   select geor into gr2 from user1.g_table where id = 1 for update;
   sdo_geor_ra.rasterMathOp(gr1,sdo_string2_array('{0}','{1}','{2}'), 'blocking=OPTIMALPADDING blocksize=(512,512,3) interleaving=BIP',gr2);
   update user1.g_table set geor=gr2 where id=1;
   commit;
END;
/
</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-EF5B66A9-DD46-4178-96F6-B699D4AF3808" name="GUID-EF5B66A9-DD46-4178-96F6-B699D4AF3808"></a><h3 id="GEORS-GUID-EF5B66A9-DD46-4178-96F6-B699D4AF3808" class="sect3"><span class="enumeration_section">4.13 </span>Managing Memory to Improve Performance
               </h3>
               <div>
                  <p id="GUID-EF5B66A9-DD46-4178-96F6-B699D4AF3808__GEORASTERHASITSOWNBUFFERSYSTEMTOREA-DD25A4AE">GeoRaster has its own buffer system&nbsp;to read and write raster (LOB) data. This system is separate from the Oracle Database buffer system. The following table lists parameters that can be used to configure the GeoRaster buffer system, which is used for all I/O operations on GeoRaster objects.</p>
                  <div class="tblformal" id="GUID-EF5B66A9-DD46-4178-96F6-B699D4AF3808__GUID-57380349-638D-47C9-980D-03CDBFEB9623">
                     <p class="titleintable">Table 4-1 GeoRaster Buffering Parameters</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="GeoRaster Buffering Parameters" summary="This 3 column table lists parameters for managing memory used for GeoRaster buffering.  Column 1 is the parameter name. Column 2 describes the parameter. Column 3 gives the default value." frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d19314e1731">Parameter Name</th>
                              <th align="left" valign="bottom" width="20%" id="d19314e1733">Description</th>
                              <th align="left" valign="bottom" width="20%" id="d19314e1735">Default Value</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d19314e1739" headers="d19314e1731 ">MemMaxSize</td>
                              <td align="left" valign="top" width="20%" headers="d19314e1739 d19314e1733 ">Upper limit size of the memory that can be used for GeoRaster buffering for each GeoRaster object.</td>
                              <td align="left" valign="top" width="20%" headers="d19314e1739 d19314e1735 ">17 MB</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d19314e1746" headers="d19314e1731 ">MemReadBlockSize</td>
                              <td align="left" valign="top" width="20%" headers="d19314e1746 d19314e1733 ">Internal data block size for read-only operations for caching raster data.</td>
                              <td align="left" valign="top" width="20%" headers="d19314e1746 d19314e1735 ">32 KB</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d19314e1753" headers="d19314e1731 ">MemWriteBlockSize</td>
                              <td align="left" valign="top" width="20%" headers="d19314e1753 d19314e1733 ">Internal data block size for read/write operations for caching raster data.</td>
                              <td align="left" valign="top" width="20%" headers="d19314e1753 d19314e1735 ">64 KB</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>You can get and set the values of these parameters using the following PL/SQL subprograms:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="SDO_GEOR_UTL-reference.html#GUID-75EFC6D7-A1F9-4FC1-A31D-91E82521B8DD">SDO_GEOR_UTL.getMaxMemSize</a></p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR_UTL-reference.html#GUID-C24BCE97-C7D9-4720-B169-190CD66405F8">SDO_GEOR_UTL.setMaxMemSize</a></p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR_UTL-reference.html#GUID-0E714A7B-2225-4561-95BC-0AE5AD5AC20C">SDO_GEOR_UTL.getReadBlockMemSize</a></p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR_UTL-reference.html#GUID-32CABCD8-4AF1-4A43-B4FA-F664C939215F">SDO_GEOR_UTL.setReadBlockMemSize</a></p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR_UTL-reference.html#GUID-736EBE83-DFC0-45B5-B31D-AD3F2DED89A6">SDO_GEOR_UTL.getWriteBlockMemSize</a></p>
                     </li>
                     <li>
                        <p><a href="SDO_GEOR_UTL-reference.html#GUID-DCAF3CC8-8A5F-4E76-AA33-9A5CAE083B6F">SDO_GEOR_UTL.setWriteBlockMemSize</a></p>
                     </li>
                  </ul>
                  <p>Because the parameters are set using PL/SQL, their values are defined for the duration of the database session. For any subsequent sessions, if you want to use any nondefault values for any of the parameters, you must set them using the appropriate procedures.</p>
                  <p>In general, using large values for the parameters improves performance for GeoRaster I/O operations. The following are some specific considerations and guidelines.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Allocating more memory (increasing <code class="codeph">MemMaxSize</code>) reduces disk access; and ideally, allocating big enough memory to&nbsp;hold an entire GeoRaster object will dramatically improve performance. However, Oracle Database allows multiple users and concurrent access, and so you should aim for balanced memory allocation in such an environment.
                        </p>
                     </li>
                     <li>Increasing the read block size (increasing <code class="codeph">MemReadBlockSize</code>) reduces the number of OCI LOB read operations, thus improving performance. However, due to different interleaving between source and target GeoRaster objects in an operation, if the <code class="codeph">MemReadBlockSize</code> value cannot hold the entire GeoRaster object, the read block size might be too large and cause frequent read block page-in and page-out operations, thus degrading performance.
                     </li>
                     <li>Almost all GeoRaster operations are write-driven, so that a larger write block size (increasing <code class="codeph">MemWriteBlockSize</code>) will reduce number of OCI LOB write operations and thus improve performance.
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1009"></a><a id="GEORS1008"></a><div class="props_rev_3"><a id="GUID-7AB60C10-E48E-4281-A03A-DA38FFA9F121" name="GUID-7AB60C10-E48E-4281-A03A-DA38FFA9F121"></a><h3 id="GEORS-GUID-7AB60C10-E48E-4281-A03A-DA38FFA9F121" class="sect3"><span class="enumeration_section">4.14 </span>Updating GeoRaster Objects Before Committing
               </h3>
               <div>
                  <p>Before you commit a database transaction that inserts, updates, reformats, compresses, decompresses, or deletes GeoRaster cell data or metadata, you should use the SQL UPDATE statement to update the GeoRaster object. If you do not update the GeoRaster object after changing cell data, one or more of the following can result: an invalid GeoRaster object, dangling raster data, and inconsistent metadata. If you do not update the GeoRaster object after changing GeoRaster metadata, the metadata changes will not take effect.</p>
                  <p>If you decide to roll back the transaction instead of committing it, an UPDATE statement is not needed.</p>
                  <p>In <a href="georaster-data-manipulation.html#GUID-7AB60C10-E48E-4281-A03A-DA38FFA9F121__CIHIIFDE">Example 4-4</a>, the UPDATE statement is required after the call to the <a href="SDO_GEOR-reference.html#GUID-9C8E8AE6-4C33-4813-B94A-A69C6206E8C4">SDO_GEOR.changeFormatCopy</a> procedure and before the COMMIT statement.
                  </p>
                  <div class="example" id="GUID-7AB60C10-E48E-4281-A03A-DA38FFA9F121__CIHIIFDE">
                     <p class="titleinexample">Example 4-4 Updating a GeoRaster Object Before Committing</p><pre class="oac_no_warn" dir="ltr">DECLARE
    gr1 sdo_georaster;
    gr2 sdo_georaster;
BEGIN
    SELECT georaster INTO gr2 from georaster_table WHERE georid=11 FOR UPDATE;
    SELECT georaster INTO gr1 from georaster_table WHERE georid=1;
    sdo_geor.changeFormatCopy(gr1, 'blocksize=(2048,2048)', gr2);
    UPDATE georaster_table SET georaster=gr2 WHERE georid=11;
    COMMIT;
END;
/</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-0603D2D3-AD36-4F30-970D-038309F55A17" name="GUID-0603D2D3-AD36-4F30-970D-038309F55A17"></a><h3 id="GEORS-GUID-0603D2D3-AD36-4F30-970D-038309F55A17" class="sect3"><span class="enumeration_section">4.15 </span>Updating GeoRaster Objects in a Loop
               </h3>
               <div>
                  <p>When multiple GeoRaster objects are to be updated, a cursor is generally used. However, if the GeoRaster operation in the loop is parallel enabled or the COMMIT statement is executed after each UPDATE statement, the SQL query for the cursor cannot have the FOR UPDATE clause because the commit within the loop will invalidate the cursor with that clause. </p>
                  <div class="example" id="GUID-0603D2D3-AD36-4F30-970D-038309F55A17__GUID-7A275412-C48B-4258-B9A0-4D923591D941">
                     <p class="titleinexample">Example 4-5 Updating GeoRaster Objects in a Loop With Parallel Processing Enabled</p>
                     <p>In the following example, pyramids were generated on all the GeoRaster objects in the table. An explicit commit is executed after each update, and parallel processing is enabled (<code class="codeph">parallel=4</code>) for the <a href="SDO_GEOR-reference.html#GUID-896CB187-FAC1-4A2C-9921-B98AC4E92F3B">SDO_GEOR.generatePyramid</a> procedure. The query of the GeoRaster object with FOR UPDATE clause is executed within the loop, not in the cursor query statement.
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
    gr1 sdo_georaster;
BEGIN
    FOR rec in (SELECT georid FROM georaster_table ORDER BY georid) LOOP
      SELECT georaster INTO gr1 FROM georaster_table WHERE georid=rec.georid <span class="bold">FOR UPDATE</span>;
      sdo_geor.generatePyramid(gr1, 'rlevel=5, resampling=bilinear', null, '<span class="bold">parallel=4</span>');
      UPDATE georaster_table SET georaster=gr1 WHERE georid=rec.georid;
      <span class="bold">COMMIT</span>;
    END LOOP;
 END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-0603D2D3-AD36-4F30-970D-038309F55A17__GUID-E34B25BD-D9AB-4EBA-940E-A2BAB7F0EE6E">
                     <p class="titleinexample">Example 4-6 Updating GeoRaster Objects in a Loop Without Parallel Processing Enabled</p>
                     <p>If the GeoRaster operation in the loop is not parallel enabled (as is the case in this example), instead of executing a COMMIT after each update, the COMMIT statement can be executed <span class="italic">outside</span> the cursor loop, to avoid invalidating the cursor with FOR UPDATE clause. Also note that the example adds NODATA to all the GeoRaster objects in the table.
                     </p><pre class="oac_no_warn" dir="ltr">BEGIN
FOR rec in (SELECT georid, georaster FROM georaster_table <span class="bold">FOR UPDATE</span>)
    LOOP
      sdo_geor.addNODATA(rec.georaster, 0, 0);
      UPDATE georaster_table SET georaster=rec.georaster 
        WHERE georid=rec.georid;
END LOOP;
<span class="bold">COMMIT</span>;
 END;
/
</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="GEORS1010"></a><div class="props_rev_3"><a id="GUID-A77AAC5B-B0EE-4F8A-9569-79A14D88658B" name="GUID-A77AAC5B-B0EE-4F8A-9569-79A14D88658B"></a><h3 id="GEORS-GUID-A77AAC5B-B0EE-4F8A-9569-79A14D88658B" class="sect3"><span class="enumeration_section">4.16 </span>Using Template-Related Subprograms to Develop GeoRaster Applications
               </h3>
               <div>
                  <p>The <a href="SDO_GEOR-reference.html#GUID-5C7E6DDA-B9C1-4A67-9C1B-5FA35D2FB7C1">SDO_GEOR.createTemplate</a> and <a href="SDO_GEOR-reference.html#GUID-D16DF6A5-7526-4574-8ECE-5D9D08CD6207">SDO_GEOR.getRasterBlockLocator</a> subprograms enable you to develop GeoRaster applications, such as ETL tools and image processing systems that work with GeoRaster objects, by reading and writing GeoRaster metadata and binary raster data without dealing directly with the Oracle XMLType, the GeoRaster XML schema, and Oracle BLOBs.
                  </p>
                  <p>After you create a new GeoRaster object (explained in <a href="georaster-database-creation-management.html#GUID-A6E26D1A-490F-4D47-B86C-3E4AD707457D">Creating New GeoRaster Objects</a>), you can use the <a href="SDO_GEOR-reference.html#GUID-5C7E6DDA-B9C1-4A67-9C1B-5FA35D2FB7C1">SDO_GEOR.createTemplate</a> function to populate the metadata of the GeoRaster object with basic information, such as raster type, dimension sizes, ultCoordinates, cell depth, interleaving type, blocking and block size, pyramid resampling method and reducing level, and compression method and quality. This function can optionally populate the raster data table with the correct number of rows and row data consisting of raster blocks containing empty BLOBs.
                  </p>
                  <p>The XML metadata generated by the <a href="SDO_GEOR-reference.html#GUID-5C7E6DDA-B9C1-4A67-9C1B-5FA35D2FB7C1">SDO_GEOR.createTemplate</a> function conforms to the GeoRaster metadata schema. You can then use other GeoRaster subprogams to query or update the metadata (see <a href="georaster-data-manipulation.html#GUID-DB762BC3-88BA-4716-9F0C-A4DC4AEC624F">Querying and Updating GeoRaster Metadata</a>).
                  </p>
                  <p>You can use the <a href="SDO_GEOR-reference.html#GUID-D16DF6A5-7526-4574-8ECE-5D9D08CD6207">SDO_GEOR.getRasterBlockLocator</a> procedure to get the raster block locator by specifying the pyramid level and block number. If you have the raster block locator, you can then use the OCI or Java JDBC LOB interfaces to read and write the binary raster data. (The <a href="SDO_GEOR-reference.html#GUID-D16DF6A5-7526-4574-8ECE-5D9D08CD6207">SDO_GEOR.getRasterBlockLocator</a> procedure does not itself read or process LOB data.) To use this approach, you must understand the physical storage of the raster data (explained in <a href="georaster-overview-and-concepts.html#GUID-DB21CC32-06DC-4E18-A4FB-B15C389C1F72" title="GeoRaster optimizes the physical storage of metadata and data.">GeoRaster Physical Storage</a>), and you must compress and decompress the data as necessary before reading from or writing to the BLOB.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="georaster-data-manipulation.html#GUID-C56DB84D-5F94-432A-A9BB-E31CF4D1B7AA" title="This chapter describes how to perform several important GeoRaster data query and manipulation operations.">GeoRaster Data Query and Manipulation</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>