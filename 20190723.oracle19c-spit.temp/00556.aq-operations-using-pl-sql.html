<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="These topics describes the Oracle Database Advanced Queuing (AQ) PL/SQL operational interface.">
      <meta name="description" content="These topics describes the Oracle Database Advanced Queuing (AQ) PL/SQL operational interface.">
      <title>Oracle Database Advanced Queuing Operations Using PL/SQL</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Advanced Queuing User's Guide ">
      <meta property="og:description" content="These topics describes the Oracle Database Advanced Queuing (AQ) PL/SQL operational interface.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Advanced Queuing User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-database-advanced-queuing.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T10:53:09-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96511-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="aq-messaging-gateway-views.html" title="Previous" type="text/html">
      <link rel="next" href="jms-introduction.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OracleÂ® Database Advanced Queuing">
    <meta name="dcterms.isVersionOf" content="ADQUE">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="aq-messaging-gateway-views.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="jms-introduction.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Advanced Queuing User's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Oracle Database Advanced Queuing Operations Using PL/SQL</li>
            </ol>
            <a id="GUID-B302CBDB-0B75-4BF6-B705-5DC3EA26E605" name="GUID-B302CBDB-0B75-4BF6-B705-5DC3EA26E605"></a><a id="ADQUE1000"></a>
            
            <h2 id="ADQUE-GUID-B302CBDB-0B75-4BF6-B705-5DC3EA26E605" class="sect2"><span class="enumeration_chapter">10 </span> Oracle Database Advanced Queuing Operations Using PL/SQL
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>These topics describes the Oracle Database Advanced Queuing (AQ) PL/SQL operational interface.</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-5A2D60AC-21B1-4F6E-BA1E-78071CA98FD4" title="For secure queues, you must specify the sender_id in the messages_properties parameter.">Using Secure Queues</a></p>
                  </li>
                  <li>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35" title="This procedure adds a message to the specified queue.">Enqueuing Messages</a></p>
                  </li>
                  <li>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-92FCE63B-7713-443A-84A3-9F543F0A8819" title="Use the ENQUEUE_ARRAY function to enqueue an array of payloads using a corresponding array of message properties.">Enqueuing an Array of Messages</a></p>
                  </li>
                  <li>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-B5606574-8C70-41AE-A362-A753033C3A70" title="This procedure specifies which queue or queues to monitor.">Listening to One or More Queues</a></p>
                  </li>
                  <li>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54" title="This procedure dequeues a message from the specified queue.">Dequeuing Messages</a></p>
                  </li>
                  <li>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-0B018200-824D-458D-98E7-7445AF8B628F" title="Use the DEQUEUE_ARRAY function to dequeue an array of payloads and a corresponding array of message properties.">Dequeuing an Array of Messages</a></p>
                  </li>
                  <li>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-DBBE096A-EEA0-4E1E-AC3F-6E1B492D1FB5" title="This procedure registers an e-mail address, user-defined PL/SQL procedure, or HTTP URL for message notification.">Registering for Notification</a></p>
                  </li>
                  <li>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-4C80C7E8-DAD2-49CA-9294-895581A64378" title="This procedure posts to a list of anonymous subscriptions, allowing all clients who are registered for the subscriptions to get notifications of persistent messages.">Posting for Subscriber Notification</a></p>
                  </li>
                  <li>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-E4F131CA-964F-4DF7-86EE-FB37078DD157" title="This procedure creates an entry for an Oracle Database Advanced Queuing agent in the LDAP server.">Adding an Agent to the LDAP Server</a></p>
                  </li>
                  <li>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-E6B7E2DC-9FD6-4EA8-8A92-D9929B9EA1B7" title="This procedure removes the entry for an Oracle Database Advanced Queuing agent from the LDAP server.">Removing an Agent from the LDAP Server</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-B302CBDB-0B75-4BF6-B705-5DC3EA26E605__GUID-28DFCBA4-B8D5-4261-91C3-8FA46FFA1784">
                  <p class="notep1">See Also:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="aq-program-interfaces.html#GUID-9A4C8FD4-235D-4F90-B757-3E36B2E5CF76" title="These topics describe the various language options and elements you must work with and issues to consider in preparing your Oracle Database Advanced Queuing (AQ) application environment.">  Oracle Database Advanced Queuing: Programmatic Interfaces</a> for a list of available functions in each programmatic interface
                        </p>
                     </li>
                     <li>
                        <p>"DBMS_AQ" in <a href="../arpls/DBMS_AQ.html#ARPLS004" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information on the PL/SQL interface
                        </p>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adque&amp;id=JAJMS" target="_blank"><span class="italic">Oracle Database Advanced Queuing Java API Reference</span></a> for more information on the Java interface
                        </p>
                     </li>
                     <li>
                        <p>"More OCI Relational Functions" in <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adque&amp;id=LNOCI160" target="_blank"><span class="italic">Oracle Call Interface Programmer's Guide</span></a></p>
                     </li>
                     <li>
                        <p>"OCI Programming Advanced Topics" in <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adque&amp;id=LNOCI090" target="_blank"><span class="italic">Oracle Call Interface Programmer's Guide</span></a> for more information on the <a href="glossary.html#GUID-4C11A79C-E65E-4B48-8A30-E628E322B025"><span class="xrefglossterm">Oracle Call Interface</span></a> (OCI)
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="ADQUE2812"></a><div class="props_rev_3"><a id="GUID-5A2D60AC-21B1-4F6E-BA1E-78071CA98FD4" name="GUID-5A2D60AC-21B1-4F6E-BA1E-78071CA98FD4"></a><h3 id="ADQUE-GUID-5A2D60AC-21B1-4F6E-BA1E-78071CA98FD4" class="sect3"><span class="enumeration_section">10.1 </span>Using Secure Queues
               </h3>
               <div>
                  <p>For secure queues, you must specify the <code class="codeph">sender_id</code> in the <code class="codeph">messages_properties</code> parameter. 
                  </p>
                  <p>See "MESSAGE_PROPERTIES_T Type" in <a href="../arpls/advanced-queuing-AQ-types.html#ARPLS71690" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about <code class="codeph">sender_id</code>.
                  </p>
                  <p>When you use secure queues, the following are required:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>You must have created a valid Oracle Database Advanced Queuing agent using <code class="codeph">DBMS_AQADM.CREATE_AQ_AGENT</code>.
                        </p>
                     </li>
                     <li>
                        <p>You must map <code class="codeph">sender_id</code> to a database user with enqueue privileges on the secure queue. Use <code class="codeph">DBMS_AQADM.ENABLE_DB_ACCESS</code> to do this.
                        </p>
                        <div class="infoboxnotealso" id="GUID-5A2D60AC-21B1-4F6E-BA1E-78071CA98FD4__GUID-D2FAC091-B405-4A6E-AEF0-2B80819A8CF1">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="aq-administrative-interface.html#GUID-ECF60C92-C8D6-4027-BE63-63C3D92872BD" title="DBMS_AQADM.CREATE_AQ_AGENT registers an agent for Oracle Database Advanced Queuing Internet access using HTTP protocols.">Creating an Oracle Database Advanced Queuing Agent</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="aq-administrative-interface.html#GUID-8CD0B0E9-37F8-4B70-95BD-75DE22F92586" title="DBMS_AQADM.ENABLE_DB_ACCESS grants an Oracle Database Advanced Queuing Internet agent the privileges of a specific database user. The agent should have been previously created using the CREATE_AQ_AGENT procedure.">Enabling Database Access</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
               </div>
            </div><a id="ADQUE2814"></a><a id="ADQUE2815"></a><a id="ADQUE2818"></a><a id="ADQUE2821"></a><a id="ADQUE2823"></a><a id="ADQUE2826"></a><a id="ADQUE2828"></a><a id="ADQUE2816"></a><a id="ADQUE2817"></a><a id="ADQUE2819"></a><a id="ADQUE2820"></a><a id="ADQUE2822"></a><a id="ADQUE2824"></a><a id="ADQUE2825"></a><a id="ADQUE2827"></a><a id="ADQUE2829"></a><a id="ADQUE2830"></a><a id="ADQUE2813"></a><div class="props_rev_3"><a id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35" name="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35"></a><h3 id="ADQUE-GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35" class="sect3"><span class="enumeration_section">10.2 </span>Enqueuing Messages
               </h3>
               <div>
                  <p>This procedure adds a message to the specified queue.</p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQ.ENQUEUE(
   queue_name          IN      VARCHAR2,
   enqueue_options     IN      enqueue_options_t,
   message_properties  IN      message_properties_t,
   payload             IN      "<span class="italic">type_name</span>",
   msgid               OUT     RAW);
</pre><p>It is not possible to update the <a href="glossary.html#GUID-2028AECF-DB3E-40E2-99B6-A35674C08038"><span class="xrefglossterm">message</span></a> payload after a message has been enqueued. If you want to change the message payload, then you must dequeue the message and enqueue a new message.
                     </p>
                     <p>To store a payload of type <code class="codeph">RAW</code>, Oracle Database Advanced Queuing creates a <a href="glossary.html#GUID-45894F1F-4871-4A00-9171-2743821BAD3A"><span class="xrefglossterm">queue table</span></a> with <code class="codeph">LOB</code> column as the payload repository. The maximum size of the payload is determined by which programmatic interface you use to access Oracle Database Advanced Queuing. For PL/SQL, Java and precompilers the limit is 32K; for the OCI the limit is 4G.
                     </p>
                     <p>If a message is enqueued to a multiconsumer queue with no <a href="glossary.html#GUID-F50CE039-717A-4D4C-B4D9-62EB3191885A"><span class="xrefglossterm">recipient</span></a> and the <a href="glossary.html#GUID-583DEF67-C9BC-4B83-B8DC-2375A5BE08BB"><span class="xrefglossterm">queue</span></a> has no subscribers (or rule-based subscribers that match this message), then Oracle error ORA 24033 is raised. This is a warning that the message will be discarded because there are no recipients or subscribers to whom it can be delivered.
                     </p>
                     <p>If several messages are enqueued in the same second, then they all have the same <code class="codeph">enq_time</code>. In this case the order in which messages are dequeued depends on <code class="codeph">step_no</code>, a variable that is monotonically increasing for each message that has the same <code class="codeph">enq_time</code>. There is no situation when both <code class="codeph">enq_time</code> and <code class="codeph">step_no</code> are the same for two messages enqueued in the same session.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGBIHI">
                     <p class="subhead2" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-76732F12-5ED0-4BFB-8C7C-C41774B30189">Enqueue Options</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>The <code class="codeph">enqueue_options</code> parameter specifies the options available for the enqueue operation. It has the following attributes:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a id="d61372e491" class="indexterm-anchor"></a><a id="d61372e495" class="indexterm-anchor"></a><code class="codeph">visibility</code></p>
                           <p>The <code class="codeph">visibility</code> attribute specifies the transactional behavior of the enqueue request. <code class="codeph">ON_COMMIT</code> (the default) makes the enqueue is part of the current transaction. <code class="codeph">IMMEDIATE</code> makes the enqueue operation an autonomous transaction which commits at the end of the operation. 
                           </p>
                           <p>Do not use the <code class="codeph">IMMEDIATE</code> option when you want to use <a href="glossary.html#GUID-E0E22C6A-42AE-41CF-A021-5CB63BABB48E"><span class="xrefglossterm">LOB</span></a> locators. LOB locators are valid only for the duration of the transaction. Your locator will not be valid, because the <code class="codeph">immediate</code> option automatically commits the transaction.
                           </p>
                           <p>You must set the <code class="codeph">visibility</code> attribute to <code class="codeph">IMMEDIATE</code> to use buffered messaging.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e534" class="indexterm-anchor"></a><code class="codeph">relative_msgid</code></p>
                           <p>The <code class="codeph">relative_msgid</code> attribute specifies the message identifier of the message referenced in the sequence deviation operation. This parameter is ignored unless <code class="codeph">sequence_deviation</code> is specified with the <code class="codeph">BEFORE</code> attribute.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e553" class="indexterm-anchor"></a><code class="codeph">sequence_deviation</code></p>
                           <p>The <code class="codeph">sequence_deviation</code> attribute specifies when the message should be dequeued, relative to other messages already in the queue. <code class="codeph">BEFORE</code> puts the message ahead of the message specified by <code class="codeph">relative_msgid</code>. <code class="codeph">TOP</code> puts the message ahead of any other messages.
                           </p>
                           <p>Specifying <code class="codeph">sequence_deviation</code> for a message introduces some restrictions for the delay and priority values that can be specified for this message. The delay of this message must be less than or equal to the delay of the message before which this message is to be enqueued. The priority of this message must be greater than or equal to the priority of the message before which this message is to be enqueued.
                           </p>
                           <div class="infoboxnote" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-392936A6-CAC3-4107-8ADD-DCD2DA03A3E7">
                              <p class="notep1">Note:</p>
                              <p>The <code class="codeph">sequence_deviation</code> attribute has no effect in releases prior to Oracle Database Advanced Queuing 10<span class="italic">g</span> Release 1 (10.1) if <code class="codeph">message_grouping</code> is set to <code class="codeph">TRANSACTIONAL</code>.
                              </p>
                              <p>The sequence deviation feature is deprecated in Oracle Database Advanced Queuing 10<span class="italic">g</span> Release 2 (10.2).
                              </p>
                           </div>
                        </li>
                        <li>
                           <p><code class="codeph">transformation</code></p>
                           <p>The <code class="codeph">transformation</code> attribute specifies a transformation that will be applied before enqueuing the message. The return type of the transformation function must match the type of the queue. 
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e609" class="indexterm-anchor"></a><code class="codeph">delivery_mode</code></p>
                           <p>If the <code class="codeph">delivery_mode</code> attribute is the default <code class="codeph">PERSISTENT</code>, then the message is enqueued as a persistent message. If it is set to <code class="codeph">BUFFERED</code>, then the message is enqueued as an buffered message. Null values are not allowed.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDEHJBH">
                     <p class="subhead2" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-BE7741DD-0DA3-4539-B78A-88875F18922E">Message Properties</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>The <code class="codeph">message_properties</code> parameter contains the information that Oracle Database Advanced Queuing uses to manage individual messages. It has the following attributes:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a id="d61372e638" class="indexterm-anchor"></a><code class="codeph">priority</code></p>
                           <p>The <code class="codeph">priority</code> attribute specifies the priority of the message. It can be any number, including negative numbers. A smaller number indicates higher priority. 
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e651" class="indexterm-anchor"></a><code class="codeph">delay</code></p>
                           <p>The <code class="codeph">delay</code> attribute specifies the number of seconds during which a message is in the <code class="codeph">WAITING</code> state. After this number of seconds, the message is in the <code class="codeph">READY</code> state and available for dequeuing. If you specify <code class="codeph">NO_DELAY</code>, then the message is available for immediate dequeuing. Dequeuing by <code class="codeph">msgid</code> overrides the <code class="codeph">delay</code> specification. 
                           </p>
                           <div class="infoboxnote" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-CED76F26-467F-41C8-A970-CF3312DE1EF6">
                              <p class="notep1">Note:</p>
                              <p>Delay is not supported with buffered messaging.</p>
                           </div>
                        </li>
                        <li>
                           <p><a id="d61372e683" class="indexterm-anchor"></a><code class="codeph">expiration</code></p>
                           <p>The <code class="codeph">expiration</code> attribute specifies the number of seconds during which the message is available for dequeuing, starting from when the message reaches the <code class="codeph">READY</code> state. If the message is not dequeued before it expires, then it is moved to the exception queue in the <code class="codeph">EXPIRED</code> state. If you specify <code class="codeph">NEVER</code>, then the message does not expire.
                           </p>
                           <div class="infoboxnote" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-6A23C691-6D72-479E-BA72-D8A16990074D">
                              <p class="notep1">Note:</p>
                              <p>Message delay and expiration are enforced by the queue monitor (<code class="codeph">QMN</code>) background processes. You must start the QMN processes for the database if you intend to use the delay and expiration features of Oracle Database Advanced Queuing.
                              </p>
                           </div>
                        </li>
                        <li>
                           <p><a id="d61372e711" class="indexterm-anchor"></a><a id="d61372e715" class="indexterm-anchor"></a><code class="codeph">correlation</code></p>
                           <p>The <code class="codeph">correlation</code> attribute is an identifier supplied by the producer of the message at enqueue time.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e728" class="indexterm-anchor"></a><code class="codeph">attempts</code></p>
                           <p>The <code class="codeph">attemps</code> attribute specifies the number of attempts that have been made to dequeue the message. This parameter cannot be set at enqueue time.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e741" class="indexterm-anchor"></a><code class="codeph">recipient_list</code></p>
                           <p>The <code class="codeph">recipient_list</code> parameter is valid only for queues that allow multiple consumers. The default recipients are the queue subscribers. 
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e754" class="indexterm-anchor"></a><code class="codeph">exception_queue</code></p>
                           <p>The <code class="codeph">exception_queue</code> attribute specifies the name of the queue into which the message is moved if it cannot be processed successfully. If the exception queue specified does not exist at the time of the move, then the message is moved to the default exception queue associated with the queue table, and a warning is logged in the alert log. 
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e767" class="indexterm-anchor"></a><code class="codeph">delivery_mode</code></p>
                           <p>Any value for <code class="codeph">delivery_mode</code> specified in message properties at enqueue time is ignored. The value specified in enqueue options is used to set the delivery mode of the message. If the delivery mode in enqueue options is left unspecified, then it defaults to persistent.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e780" class="indexterm-anchor"></a><code class="codeph">enqueue_time</code></p>
                           <p>The <code class="codeph">enqueue_time</code> attribute specifies the time the message was enqueued. This value is determined by the system and cannot be set by the user at enqueue time.
                           </p>
                           <div class="infoboxnote" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-646FD683-98E1-4FE4-9934-674E5317A11A">
                              <p class="notep1">Note:</p>
                              <p>Because information about seasonal changes in the system clock (switching between standard time and daylight-saving time, for example) is stored with each queue table, seasonal changes are automatically reflected in <code class="codeph">enqueue_time</code>. If the system clock is changed for some other reason, then you must restart the database for Oracle Database Advanced Queuing to pick up the changed time.
                              </p>
                           </div>
                        </li>
                        <li>
                           <p><a id="d61372e799" class="indexterm-anchor"></a><code class="codeph">state</code></p>
                           <p>The <code class="codeph">state</code> attribute specifies the state of the message at the time of the dequeue. This parameter cannot be set at enqueue time. 
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e812" class="indexterm-anchor"></a><code class="codeph">sender_id</code></p>
                           <p>The <code class="codeph">sender_id</code> attribute is an identifier of type <code class="codeph">aq$_agent</code> specified at enqueue time by the message producer.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e829" class="indexterm-anchor"></a><code class="codeph">original_msgid</code></p>
                           <p>The original_msgid attribute is used by Oracle Database AQ for propagating messages.</p>
                        </li>
                        <li>
                           <p><a id="d61372e839" class="indexterm-anchor"></a><code class="codeph">transaction_group</code></p>
                           <p>The <code class="codeph">transaction_group</code> attribute specifies the transaction group for the message. This attribute is set only by <code class="codeph">DBMS_AQ.DEQUEUE_ARRAY</code>. This attribute cannot be used to set the transaction group of a message through <code class="codeph">DBMS_AQ.ENQUEUE</code> or <code class="codeph">DBMS_AQ.ENQUEUE_ARRAY</code>.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e861" class="indexterm-anchor"></a><code class="codeph">user_property</code></p>
                           <p>The <code class="codeph">user_property</code> attribute is optional. It is used to store additional information about the payload.
                           </p>
                        </li>
                     </ul>
                     <p>The examples in the following topics use the same users, message types, queue tables, and queues as do the examples in <a href="aq-administrative-interface.html#GUID-31CF7723-6AB8-455A-8841-8683D936DD3E" title="These topics describe the Oracle Database Advanced Queuing (AQ) administrative interface."> Oracle Database Advanced Queuing Administrative Interface</a>. If you have not already created these structures in your test environment, then you must run the following examples:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41__CHDECGGJ">Example 8-1</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41__CHDJIFCF">Example 8-2</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41__CHDCBGCF">Example 8-3</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41__CHDBEADD">Example 8-5</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41__CHDEAEID">Example 8-7</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41__CHDFEDEC">Example 8-8</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-E140B4B5-DB4C-4DFC-8F67-C032516D0324__CHDEFAFG">Example 8-23</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-E140B4B5-DB4C-4DFC-8F67-C032516D0324__CHDHEAID">Example 8-25</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-E140B4B5-DB4C-4DFC-8F67-C032516D0324__CHDHEACA">Example 8-26</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-E140B4B5-DB4C-4DFC-8F67-C032516D0324__CHDGCFHI">Example 8-27</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-E140B4B5-DB4C-4DFC-8F67-C032516D0324__CHDIAEEH">Example 8-28</a></p>
                        </li>
                        <li>
                           <p><a href="aq-administrative-interface.html#GUID-264A3C43-93B3-43B5-820F-C25F686E97BD__CHDCIADC">Example 8-36</a></p>
                        </li>
                     </ul>
                     <p>For <a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41__CHDECGGJ">Example 8-1</a>, you must connect as a user with administrative privileges. For the other examples in the preceding list, you can connect as user <code class="codeph">test_adm</code>. After you have created the queues, you must start them as shown in <span class="q">"<a href="aq-administrative-interface.html#GUID-8370927B-0D5E-4E75-A2A5-7309BC13219C" title="DBMS_AQADM.START_QUEUE enables the specified non-sharded queue for enqueuing or dequeuing.">Starting a Queue</a>"</span>. Except as noted otherwise, you can connect as ordinary queue user <code class="codeph">'test'</code> to run all examples.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-547D3A7A-CD28-41CF-9ABE-E4C33179EF4A">Enqueuing a LOB Type Message</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGJCIG">Example 10-3</a> creates procedure <code class="codeph">blobenqueue()</code> using the <code class="codeph">test.lob_type</code> message payload object type created in <a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41__CHDECGGJ">Example 8-1</a>. On enqueue, the LOB attribute is set to <code class="codeph">EMPTY_BLOB</code>. After the enqueue completes, but before the transaction is committed, the LOB attribute is selected from the <code class="codeph">user_data</code> column of the <code class="codeph">test.lob_qtab</code> queue table. The LOB data is written to the queue using the <code class="codeph">LOB</code> interfaces (which are available through both OCI and PL/SQL). The actual enqueue operation is shown in 
                     </p>
                     <p>On dequeue, the message payload will contain the LOB locator. You can use this LOB locator after the dequeue, but before the transaction is committed, to read the LOB data. This is shown in <a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDGIIIC">Example 10-14</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-54A30117-6D9C-4C38-8C05-DB438DF05CD3">Enqueuing Multiple Messages to a Single-Consumer Queue</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGIJGG">Example 10-5</a> enqueues six messages to <code class="codeph">test.obj_queue</code>. These messages are dequeued in <a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDIACIJ">Example 10-17</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-D341EC8C-B504-4FA3-AAAC-D15A19F1FD81">Enqueuing Multiple Messages to a Multiconsumer Queue</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDBGAFA">Example 10-6</a> requires that you connect as user <code class="codeph">'test_adm</code>' to add subscribers <code class="codeph">RED</code> and <code class="codeph">GREEN</code> to queue <code class="codeph">test.multiconsumer_queue</code>. The subscribers are required for <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDHGEFG">Example 10-7</a>.
                     </p>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDHGEFG">Example 10-7</a> enqueues multiple messages from sender 001. MESSAGE 1 is intended for all queue subscribers. MESSAGE 2 is intended for RED and BLUE. These messages are dequeued in <a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDIACIJ">Example 10-17</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-55E07B91-FFEE-4148-862C-6D502F4CA3B0">Enqueuing Grouped Messages</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDFBDDD">Example 10-8</a> enqueues three groups of messages, with three messages in each group. These messages are dequeued in <a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDGAIBA">Example 10-16</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-361520D8-6C61-4AF3-8A8A-414E1493335B">Enqueuing a Message with Delay and Expiration</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>In <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDIIGAG">Example 10-9</a>, an application wants a message to be dequeued no earlier than a week from now, but no later than three weeks from now. Because expiration is calculated from the earliest dequeue time, this requires setting the expiration time for two weeks.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__I1005829">
                     <p class="titleinexample">Example 10-1 Enqueuing a Message, Specifying Queue Name and Payload</p><pre class="oac_no_warn" dir="ltr">DECLARE
   enqueue_options     DBMS_AQ.enqueue_options_t;
   message_properties  DBMS_AQ.message_properties_t;
   message_handle      RAW(16);
   message             test.message_typ;
BEGIN
   message := test.message_typ(001, 'TEST MESSAGE', 'First message to obj_queue');
   DBMS_AQ.ENQUEUE(
      queue_name              =&gt; 'test.obj_queue',
      enqueue_options         =&gt; enqueue_options,
      message_properties      =&gt; message_properties,
      payload                 =&gt; message,
      msgid                   =&gt; message_handle);
   COMMIT;
END;
/</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__I1005850">
                     <p class="titleinexample">Example 10-2 Enqueuing a Message, Specifying Priority</p><pre class="oac_no_warn" dir="ltr">DECLARE 
   enqueue_options       DBMS_AQ.enqueue_options_t; 
   message_properties    DBMS_AQ.message_properties_t; 
   message_handle        RAW(16); 
   message               test.order_typ; 
BEGIN 
   message := test.order_typ(002, 'PRIORITY MESSAGE', 'priority 30'); 
   message_properties.priority := 30; 
   DBMS_AQ.ENQUEUE(
      queue_name              =&gt; 'test.priority_queue', 
      enqueue_options         =&gt; enqueue_options, 
      message_properties      =&gt; message_properties, 
      payload                 =&gt; message, 
      msgid                   =&gt; message_handle); 
   COMMIT; 
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGJCIG">
                     <p class="titleinexample">Example 10-3 Creating an Enqueue Procedure for LOB Type Messages</p><pre class="oac_no_warn" dir="ltr">
CREATE OR REPLACE PROCEDURE blobenqueue(msgno IN NUMBER) AS
   enq_userdata          test.lob_typ; 
   enq_msgid             RAW(16); 
   enqueue_options       DBMS_AQ.enqueue_options_t; 
   message_properties    DBMS_AQ.message_properties_t; 
   lob_loc               BLOB; 
   buffer                RAW(4096); 
BEGIN 
   buffer       := HEXTORAW(RPAD('FF', 4096, 'FF')); 
   enq_userdata := test.lob_typ(msgno, 'Large Lob data', EMPTY_BLOB(), msgno); 
   DBMS_AQ.ENQUEUE(
      queue_name          =&gt; 'test.lob_queue',
      enqueue_options     =&gt; enqueue_options,
      message_properties  =&gt; message_properties,
      payload             =&gt; enq_userdata, 
      msgid               =&gt; enq_msgid); 
   SELECT t.user_data.data INTO lob_loc 
      FROM lob_qtab t 
      WHERE t.msgid = enq_msgid; 
   DBMS_LOB.WRITE(lob_loc, 2000, 1, buffer ); 
   COMMIT; 
END;
/ </pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGECGJ">
                     <p class="titleinexample">Example 10-4 Enqueuing a LOB Type Message</p><pre class="oac_no_warn" dir="ltr">BEGIN 
   FOR i IN 1..5 LOOP 
      blobenqueue(i); 
   END LOOP; 
END;
/</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGIJGG">
                     <p class="titleinexample">Example 10-5 Enqueuing Multiple Messages</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
DECLARE
   enqueue_options     DBMS_AQ.enqueue_options_t;
   message_properties  DBMS_AQ.message_properties_t;
   message_handle      RAW(16);
   message             test.message_typ;
BEGIN
   message := test.message_typ(001, 'ORANGE', 'ORANGE enqueued first.');
   DBMS_AQ.ENQUEUE(
         queue_name           =&gt; 'test.obj_queue', 
         enqueue_options      =&gt; enqueue_options,
         message_properties   =&gt; message_properties,
         payload              =&gt; message,
         msgid                =&gt; message_handle);
   message := test.message_typ(001, 'ORANGE', 'ORANGE also enqueued second.');
   DBMS_AQ.ENQUEUE(
         queue_name           =&gt; 'test.obj_queue', 
         enqueue_options      =&gt; enqueue_options,
         message_properties   =&gt; message_properties,
         payload              =&gt; message,
         msgid                =&gt; message_handle);
   message := test.message_typ(001, 'YELLOW', 'YELLOW enqueued third.');
   DBMS_AQ.ENQUEUE(
         queue_name           =&gt; 'test.obj_queue', 
         enqueue_options      =&gt; enqueue_options,
         message_properties   =&gt; message_properties,
         payload              =&gt; message,
         msgid                =&gt; message_handle);
   message := test.message_typ(001, 'VIOLET', 'VIOLET enqueued fourth.');
   DBMS_AQ.ENQUEUE(
         queue_name           =&gt; 'test.obj_queue', 
         enqueue_options      =&gt; enqueue_options,
         message_properties   =&gt; message_properties,
         payload              =&gt; message,
         msgid                =&gt; message_handle);
   message := test.message_typ(001, 'PURPLE', 'PURPLE enqueued fifth.');
   DBMS_AQ.ENQUEUE(
         queue_name           =&gt; 'test.obj_queue', 
         enqueue_options      =&gt; enqueue_options,
         message_properties   =&gt; message_properties,
         payload              =&gt; message,
         msgid                =&gt; message_handle);
   message := test.message_typ(001, 'PINK', 'PINK enqueued sixth.');
   DBMS_AQ.ENQUEUE(
         queue_name           =&gt; 'test.obj_queue', 
         enqueue_options      =&gt; enqueue_options,
         message_properties   =&gt; message_properties,
         payload              =&gt; message,
         msgid                =&gt; message_handle);
   COMMIT;
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDBGAFA">
                     <p class="titleinexample">Example 10-6 Adding Subscribers RED and GREEN</p><pre class="oac_no_warn" dir="ltr">DECLARE
   subscriber         sys.aq$_agent;
BEGIN
   subscriber     :=  sys.aq$_agent('RED', NULL, NULL);
   DBMS_AQADM.ADD_SUBSCRIBER(
      queue_name  =&gt;  'test.multiconsumer_queue',
      subscriber  =&gt;  subscriber);

   subscriber     :=  sys.aq$_agent('GREEN', NULL, NULL);
   DBMS_AQADM.ADD_SUBSCRIBER(
      queue_name  =&gt;  'test.multiconsumer_queue',
      subscriber  =&gt;  subscriber); 
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDHGEFG">
                     <p class="titleinexample">Example 10-7 Enqueuing Multiple Messages to a Multiconsumer Queue</p><pre class="oac_no_warn" dir="ltr">DECLARE
   enqueue_options     DBMS_AQ.enqueue_options_t;
   message_properties  DBMS_AQ.message_properties_t;
   recipients          DBMS_AQ.aq$_recipient_list_t;
   message_handle      RAW(16);
   message             test.message_typ;
BEGIN
   message := test.message_typ(001, 'MESSAGE 1','For queue subscribers');
   DBMS_AQ.ENQUEUE(
      queue_name          =&gt; 'test.multiconsumer_queue',
      enqueue_options     =&gt; enqueue_options,
      message_properties  =&gt; message_properties,
      payload             =&gt; message,
      msgid               =&gt; message_handle);

   message := test.message_typ(001, 'MESSAGE 2', 'For two recipients');
   recipients(1) := sys.aq$_agent('RED', NULL, NULL);
   recipients(2) := sys.aq$_agent('BLUE', NULL, NULL);
   message_properties.recipient_list := recipients;
   DBMS_AQ.ENQUEUE(
      queue_name          =&gt; 'test.multiconsumer_queue',
      enqueue_options     =&gt; enqueue_options,
      message_properties  =&gt; message_properties,
      payload             =&gt; message,
      msgid               =&gt; message_handle);
   COMMIT;
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDFBDDD">
                     <p class="titleinexample">Example 10-8 Enqueuing Grouped Messages</p><pre class="oac_no_warn" dir="ltr">DECLARE
   enqueue_options     DBMS_AQ.enqueue_options_t;
   message_properties  DBMS_AQ.message_properties_t;
   message_handle      RAW(16);
   message             test.message_typ;
BEGIN
  FOR groupno in 1..3 LOOP
    FOR msgno in 1..3 LOOP
      message := test.message_typ(
               001,
               'GROUP ' || groupno, 
               'Message ' || msgno || ' in group ' || groupno);
      DBMS_AQ.ENQUEUE(
         queue_name             =&gt; 'test.group_queue',
         enqueue_options        =&gt; enqueue_options,
         message_properties     =&gt; message_properties,
         payload                =&gt; message,
         msgid                  =&gt; message_handle);
    END LOOP;
    COMMIT; 
  END LOOP;
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDIIGAG">
                     <p class="titleinexample">Example 10-9 Enqueuing a Message, Specifying Delay and Expiration</p><pre class="oac_no_warn" dir="ltr">DECLARE
   enqueue_options     DBMS_AQ.enqueue_options_t;
   message_properties  DBMS_AQ.message_properties_t;
   message_handle      RAW(16);
   message             test.message_typ;
BEGIN
   message := test.message_typ(001, 'DELAYED', 'Message is delayed one week.');
   message_properties.delay      := 7*24*60*60;
   message_properties.expiration := 2*7*24*60*60;
   DBMS_AQ.ENQUEUE(
      queue_name           =&gt; 'test.obj_queue',
      enqueue_options      =&gt; enqueue_options,
      message_properties   =&gt; message_properties,
      payload              =&gt; message,
      msgid                =&gt; message_handle);
   COMMIT;
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__GUID-8E44D782-7D0F-4A57-82F1-4410AE9A27F1">
                     <p class="titleinexample">Example 10-10 Enqueuing a Message, Specifying a Transformation</p><pre class="oac_no_warn" dir="ltr">DECLARE
   enqueue_options     DBMS_AQ.enqueue_options_t;
   message_properties  DBMS_AQ.message_properties_t;
   message_handle      RAW(16);
   message             test.message_typ;
BEGIN
   message := test.message_typ(001, 'NORMAL MESSAGE', 'enqueued to obj_queue');
   enqueue_options.transformation := 'message_order_transform';
   DBMS_AQ.ENQUEUE(
      queue_name              =&gt; 'test.priority_queue', 
      enqueue_options         =&gt; enqueue_options,
      message_properties      =&gt; message_properties,
      payload                 =&gt; message,
      msgid                   =&gt; message_handle);
   COMMIT;
END;
/</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADQUE2832"></a><a id="ADQUE2831"></a><div class="props_rev_3"><a id="GUID-92FCE63B-7713-443A-84A3-9F543F0A8819" name="GUID-92FCE63B-7713-443A-84A3-9F543F0A8819"></a><h3 id="ADQUE-GUID-92FCE63B-7713-443A-84A3-9F543F0A8819" class="sect3"><span class="enumeration_section">10.3 </span>Enqueuing an Array of Messages
               </h3>
               <div>
                  <p>Use the <code class="codeph">ENQUEUE_ARRAY</code> function to enqueue an array of payloads using a corresponding array of message properties. 
                  </p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQ.ENQUEUE_ARRAY(
   queue_name                IN   VARCHAR2,
   enqueue_options           IN   enqueue_options_t,
   array_size                IN   PLS_INTEGER,
   message_properties_array  IN   message_properties_array_t,
   payload_array             IN   VARRAY,
   msid_array                OUT  msgid_array_t)
RETURN PLS_INTEGER;
</pre><p>The output is an array of message identifiers of the enqueued messages. The function returns the number of messages successfully enqueued.</p>
                     <p>Array enqueuing is not supported for buffered messages, but you can still use <code class="codeph">DBMS_AQ.ENQUEUE_ARRAY()</code> to enqueue buffered messages by setting <code class="codeph">array_size</code> to <code class="codeph">1</code>.
                     </p>
                     <p><a id="d61372e1196" class="indexterm-anchor"></a>The <code class="codeph">message_properties_array</code> parameter is an array of message properties. Each element in the payload array must have a corresponding element in this record. All messages in an array have the same delivery mode.
                     </p>
                     <p>The payload structure can be a VARRAY or nested table. The message IDs are returned into an array of RAW(16) entries of type <code class="codeph">DBMS_AQ.msgid_array_t</code>.
                     </p>
                     <p>As with array operations in the relational world, it is not possible to provide a single optimum array size that will be correct in all circumstances. Application developers must experiment with different array sizes to determine the optimal value for their particular applications. </p>
                     <div class="p">
                        <div class="infoboxnotealso" id="GUID-92FCE63B-7713-443A-84A3-9F543F0A8819__GUID-C7F9D646-5989-437A-90E9-724FA0FD0D0C">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGBIHI">Enqueue Options</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDEHJBH">Message Properties</a>"</span></p>
                                 <p></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-92FCE63B-7713-443A-84A3-9F543F0A8819__CHDHAFJA">
                     <p class="titleinexample">Example 10-11 Enqueuing an Array of Messages</p><pre class="oac_no_warn" dir="ltr">DECLARE
  enqueue_options       DBMS_AQ.enqueue_options_t;
  msg_prop_array        DBMS_AQ.message_properties_array_t;
  msg_prop              DBMS_AQ.message_properties_t;
  payload_array         test.msg_table;
  msgid_array           DBMS_AQ.msgid_array_t;
  retval                PLS_INTEGER;
BEGIN
  payload_array  := msg_table(
      message_typ(001, 'MESSAGE  1', 'array enqueued to obj_queue'), 
      message_typ(001, 'MESSAGE  2', 'array enqueued to obj_queue'));
  msg_prop_array := DBMS_AQ.message_properties_array_t(msg_prop, msg_prop);
 
  retval := DBMS_AQ.ENQUEUE_ARRAY( 
                 queue_name               =&gt; 'test.obj_queue',
                 enqueue_options          =&gt; enqueue_options,
                 array_size               =&gt; 2,
                 message_properties_array =&gt; msg_prop_array,
                 payload_array            =&gt; payload_array,
                 msgid_array              =&gt; msgid_array);
  COMMIT;
END;/</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADQUE2834"></a><a id="ADQUE2833"></a><div class="props_rev_3"><a id="GUID-B5606574-8C70-41AE-A362-A753033C3A70" name="GUID-B5606574-8C70-41AE-A362-A753033C3A70"></a><h3 id="ADQUE-GUID-B5606574-8C70-41AE-A362-A753033C3A70" class="sect3"><span class="enumeration_section">10.4 </span>Listening to One or More Queues
               </h3>
               <div>
                  <p>This procedure specifies which queue or queues to monitor.</p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQ.LISTEN(
   agent_list             IN    aq$_agent_list_t,
   wait                   IN    BINARY_INTEGER DEFAULT FOREVER, 
   listen_delivery_mode   IN    PLS_INTEGER DEFAULT PERSISTENT,
   agent                  OUT   sys.aq$_agent
   message_delivery_mode  OUT   PLS_INTEGER);

TYPE aq$_agent_list_t IS TABLE of aq$_agent INDEXED BY BINARY_INTEGER;
</pre><p>This call takes a list of agents as an argument. Each agent is identified by a unique combination of name, address, and protocol.</p>
                     <p>You specify the queue to be monitored in the address field of each agent listed. Agents must have dequeue privileges on each monitored queue. You must specify the name of the agent when monitoring multiconsumer queues; but you must not specify an agent name for single-consumer queues. Only local queues are supported as addresses. Protocol is reserved for future use.</p>
                     <div class="infoboxnote" id="GUID-B5606574-8C70-41AE-A362-A753033C3A70__GUID-C30E8565-C2A5-4CAA-88D8-2CB98D12F85E">
                        <p class="notep1">Note:</p>
                        <p>Listening to multiconsumer queues is not supported in the Java <a href="glossary.html#GUID-2003BA71-5534-477C-990D-5ABE432A5907"><span class="xrefglossterm">API</span></a>.
                        </p>
                     </div>
                     <p><a id="d61372e1335" class="indexterm-anchor"></a><a id="d61372e1337" class="indexterm-anchor"></a><a id="d61372e1339" class="indexterm-anchor"></a><a id="d61372e1341" class="indexterm-anchor"></a><a id="d61372e1345" class="indexterm-anchor"></a><a id="d61372e1349" class="indexterm-anchor"></a>The <code class="codeph">listen_delivery_mode</code> parameter specifies what types of message interest the agent. If it is the default 	<code class="codeph">PERSISTENT</code>, then the agent is informed about persistent messages only. If it is set to <code class="codeph">BUFFERED</code>, then the agent is informed about buffered messages only. If it is set to <code class="codeph">PERSISTENT_OR_BUFFERED</code>, then the agent is informed about both types. 
                     </p>
                     <p>This is a blocking call that returns the agent and message type when there is a message ready for consumption for an agent in the list. If there are messages for more than one agent, then only the first agent listed is returned. If there are no messages found when the wait time expires, then an error is raised.</p>
                     <p>A successful return from the <code class="codeph">listen</code> call is only an indication that there is a message for one of the listed agents in one of the specified queues. The interested agent must still dequeue the relevant message.
                     </p>
                     <div class="infoboxnote" id="GUID-B5606574-8C70-41AE-A362-A753033C3A70__GUID-5B5EB749-0D97-42BD-BA20-88A7A6C8159B">
                        <p class="notep1">Note:</p>
                        <p>You cannot call <code class="codeph">LISTEN</code> on <a href="glossary.html#GUID-A91ACE79-576B-49F6-BE03-D4A792B9B468"><span class="xrefglossterm">nonpersistent</span></a> queues.
                        </p>
                     </div>
                     <p>Even though both <code class="codeph">test.obj_queue</code> and <code class="codeph">test.priority_queue</code> contain messages (enqueued in <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__I1005829">Example 10-1</a> and <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__I1005850">Example 10-2</a> respectively) <a href="aq-operations-using-pl-sql.html#GUID-B5606574-8C70-41AE-A362-A753033C3A70__I1006167">Example 10-12</a> returns only:
                     </p><pre class="oac_no_warn" dir="ltr">Message in Queue: "TEST"."OBJ_QUEUE"
</pre><p>If the order of agents in <code class="codeph">test_agent_list</code> is reversed, so <code class="codeph">test.priority_queue</code> appears before <code class="codeph">test.obj_queue</code>, then the example returns:
                     </p><pre class="oac_no_warn" dir="ltr">Message in Queue: "TEST"."PRIORITY_QUEUE"
</pre><div class="p">
                        <div class="infoboxnotealso" id="GUID-B5606574-8C70-41AE-A362-A753033C3A70__GUID-838E4211-ABD3-4179-AF08-A4210592F6CD">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="aq-basic-components.html#GUID-2C5557D9-E11B-4AB9-94E0-F923C85D6E0A" title="This component identifies a producer or consumer of a message.">AQ Agent Type</a>"</span></p>
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-B5606574-8C70-41AE-A362-A753033C3A70__I1006167">
                     <p class="titleinexample">Example 10-12 Listening to a Single-Consumer Queue with Zero Timeout</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
DECLARE
   agent            sys.aq$_agent;
   test_agent_list  DBMS_AQ.aq$_agent_list_t;
BEGIN
   test_agent_list(1) := sys.aq$_agent(NULL, 'test.obj_queue',  NULL);
   test_agent_list(2) := sys.aq$_agent(NULL, 'test.priority_queue', NULL);
   DBMS_AQ.LISTEN(
      agent_list   =&gt;   test_agent_list, 
      wait         =&gt;   0, 
      agent        =&gt;   agent);
   DBMS_OUTPUT.PUT_LINE('Message in Queue: ' ||  agent.address);
END;
/
</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADQUE2836"></a><a id="ADQUE2838"></a><a id="ADQUE2841"></a><a id="ADQUE2843"></a><a id="ADQUE2845"></a><a id="ADQUE2837"></a><a id="ADQUE2839"></a><a id="ADQUE2840"></a><a id="ADQUE2842"></a><a id="ADQUE2844"></a><a id="ADQUE2846"></a><a id="ADQUE2847"></a><a id="ADQUE2835"></a><div class="props_rev_3"><a id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54" name="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54"></a><h3 id="ADQUE-GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54" class="sect3"><span class="enumeration_section">10.5 </span>Dequeuing Messages
               </h3>
               <div>
                  <p>This procedure dequeues a message from the specified queue.</p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQ.DEQUEUE(
   queue_name          IN      VARCHAR2,
   dequeue_options     IN      dequeue_options_t,
   message_properties  OUT     message_properties_t,
   payload             OUT     "<span class="italic">type_name</span>",
   msgid               OUT     RAW);
</pre><p>You can choose to dequeue only persistent messages, only buffered messages, or both. See <code class="codeph">delivery_mode</code> in the following list of dequeue options.
                     </p>
                     <div class="infoboxnotealso" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__GUID-1829FDEA-E6AF-4073-92A1-F448F7A7DBA5">
                        <p class="notep1">See Also:</p>
                        <p><span class="q">"<a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDEHJBH">Message Properties</a>"</span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDBBGGE">
                     <p class="subhead2" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__GUID-C982B34C-340F-4111-A84C-5EB96605498E">Dequeue Options</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>The <code class="codeph">dequeue_options</code> parameter specifies the options available for the dequeue operation. It has the following attributes:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a id="d61372e1550" class="indexterm-anchor"></a><code class="codeph">consumer_name</code></p>
                           <p>A consumer can dequeue a message from a queue by supplying the name that was used in the <code class="codeph">AQ$_AGENT</code> type of the <code class="codeph">DBMS_AQADM</code>.<code class="codeph">ADD_SUBSCRIBER</code> procedure or the recipient list of the message properties. If a value is specified, then only those messages matching <code class="codeph">consumer_name</code> are accessed. If a queue is not set up for multiple consumers, then this field must be set to NULL (the default).
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e1572" class="indexterm-anchor"></a><code class="codeph">dequeue_mode</code></p>
                           <p>The <code class="codeph">dequeue_mode</code> attribute specifies the locking behavior associated with the dequeue. If <code class="codeph">BROWSE</code> is specified, then the message is dequeued without acquiring any lock. If <code class="codeph">LOCKED</code> is specified, then the message is dequeued with a write lock that lasts for the duration of the transaction. If <code class="codeph">REMOVE</code> is specified, then the message is dequeued and deleted (the default). The message can be retained in the queue table based on the retention properties. If <code class="codeph">REMOVE_NO_DATA</code> is specified, then the message is marked as updated or deleted.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e1597" class="indexterm-anchor"></a><code class="codeph">navigation</code></p>
                           <p>The <code class="codeph">navigation</code> attribute specifies the position of the dequeued message. If <code class="codeph">FIRST_MESSAGE</code> is specified, then the first available message matching the search criteria is dequeued. If <code class="codeph">NEXT_MESSAGE</code> is specified, then the next available message matching the search criteria is dequeued (the default). If the previous message belongs to a message group, then the next available message matching the search criteria in the message group is dequeued. 
                           </p>
                           <p>If <code class="codeph">NEXT_TRANSACTION</code> is specified, then any messages in the current transaction group are skipped and the first message of the next transaction group is dequeued. This setting can only be used if message grouping is enabled for the queue.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e1621" class="indexterm-anchor"></a><a id="d61372e1625" class="indexterm-anchor"></a><code class="codeph">visibility</code></p>
                           <p>The <code class="codeph">visibility</code> attribute specifies when the new message is dequeued. If <code class="codeph">ON_COMMIT</code> is specified, then the dequeue is part of the current transaction (the default). If <code class="codeph">IMMEDIATE</code> is specified, then the dequeue operation is an autonomous transaction that commits at the end of the operation. The <code class="codeph">visibility</code> attribute is ignored in <code class="codeph">BROWSE</code> dequeue mode. 
                           </p>
                           <p>Visibility must always be <code class="codeph">IMMEDIATE</code> when dequeuing messages with delivery mode <code class="codeph">DBMS_AQ.BUFFERED</code> or <code class="codeph">DBMS_AQ.PERSISTENT_OR_BUFFERED</code>.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e1661" class="indexterm-anchor"></a><code class="codeph">wait</code></p>
                           <p>The <code class="codeph">wait</code> attribute specifies the wait time if there is currently no message available matching the search criteria. If a number is specified, then the operation waits that number of seconds. If <code class="codeph">FOREVER</code> is specified, then the operation waits forever (the default). If <code class="codeph">NO_WAIT</code> is specified, then the operation does not wait.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e1680" class="indexterm-anchor"></a><code class="codeph">msgid</code></p>
                           <p>The <code class="codeph">msgid</code> attribute specifies the message identifier of the dequeued message. Only messages in the <code class="codeph">READY</code> state are dequeued unless <code class="codeph">msgid</code> is specified.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e1699" class="indexterm-anchor"></a><a id="d61372e1703" class="indexterm-anchor"></a><code class="codeph">correlation</code></p>
                           <p>The correlation attribute specifies the correlation identifier of the dequeued message. The correlation identifier cannot be changed between successive dequeue calls without specifying the <code class="codeph">FIRST_MESSAGE</code> navigation option. 
                           </p>
                           <p>Correlation identifiers are application-defined identifiers that are not interpreted by Oracle Database Advanced Queuing. You can use special pattern matching characters, such as the percent sign and the underscore. If more than one message satisfies the pattern, then the order of dequeuing is indeterminate, and the sort order of the queue is not honored.</p>
                           <div class="infoboxnote" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__GUID-375C4287-02E6-4B0D-B46D-1F948E0097A2">
                              <p class="notep1">Note:</p>
                              <p>Although dequeue options <code class="codeph">correlation</code> and <code class="codeph">deq_condition</code> are both supported for buffered messages, it is not possible to create indexes to optimize these queries.
                              </p>
                           </div>
                        </li>
                        <li>
                           <p><a id="d61372e1727" class="indexterm-anchor"></a><code class="codeph">deq_condition</code></p>
                           <p>The <code class="codeph">deq_condition</code> attribute is a Boolean expression similar to the WHERE clause of a SQL query. This Boolean expression can include conditions on message properties, user data properties (object payloads only), and PL/SQL or SQL functions. 
                           </p>
                           <p>To specify dequeue conditions on a message payload (object payload), use attributes of the object type in clauses. You must prefix each attribute with <code class="codeph">tab.user_data</code> as a qualifier to indicate the specific column of the queue table that stores the payload. 
                           </p>
                           <p>The <code class="codeph">deq_condition</code> attribute cannot exceed 4000 characters. If more than one message satisfies the dequeue condition, then the order of dequeuing is indeterminate, and the sort order of the queue is not honored.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e1750" class="indexterm-anchor"></a><code class="codeph">transformation</code></p>
                           <p>The <code class="codeph">transformation</code> attribute specifies a transformation that will be applied after the message is dequeued but before returning the message to the caller.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e1763" class="indexterm-anchor"></a><code class="codeph">delivery_mode</code></p>
                           <p>The <code class="codeph">delivery_mode</code> attribute specifies what types of messages to dequeue. If it is set to <code class="codeph">DBMS_AQ.PERSISTENT</code>, then only persistent messages are dequeued. If it is set to <code class="codeph">DBMS_AQ.BUFFERED</code>, then only buffered messages are dequeued. 
                           </p>
                           <p>If it is the default <code class="codeph">DBMS_AQ.PERSISTENT_OR_BUFFERED</code>, then both persistent and buffered messages are dequeued. The <code class="codeph">delivery_mode</code> attribute in the message properties of the dequeued message indicates whether the dequeued message was buffered or persistent.
                           </p>
                        </li>
                     </ul>
                     <p>The dequeue order is determined by the values specified at the time the queue table is created unless overridden by the message identifier and correlation identifier in dequeue options.</p>
                     <p>The database consistent read mechanism is applicable for queue operations. For example, a <code class="codeph">BROWSE</code> call may not see a message that is enqueued after the beginning of the browsing transaction. 
                     </p>
                     <p>In a <a href="glossary.html#GUID-F4FC927D-BBFE-451D-9CCA-96C7387A39B0"><span class="xrefglossterm">commit-time queue</span></a>, messages are not visible to <code class="codeph">BROWSE</code> or <code class="codeph">DEQUEUE</code> calls until a deterministic order can be established among them based on an <a href="glossary.html#GUID-30A3A407-F784-4083-9041-D548D9E1C6C5"><span class="xrefglossterm">approximate CSCN</span></a>.
                     </p>
                     <p>If the <code class="codeph">navigation</code> attribute of the <code class="codeph">dequeue_conditions</code> parameter is <code class="codeph">NEXT</code>_<code class="codeph">MESSAGE</code> (the default), then subsequent dequeues retrieve messages from the queue based on the snapshot obtained in the first dequeue. A message enqueued after the first dequeue command, therefore, will be processed only after processing all remaining messages in the queue. This is not a problem if all the messages have already been enqueued or if the queue does not have priority-based ordering. But if an application must process the highest-priority message in the queue, then it must use the <code class="codeph">FIRST_MESSAGE</code> navigation option. 
                     </p>
                     <div class="infoboxnote" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__GUID-8E7AAAEC-9DCE-4CCC-905B-8942EFE5EC15">
                        <p class="notep1">Note:</p>
                        <p>It can also be more efficient to use the <code class="codeph">FIRST_MESSAGE</code> navigation option when there are messages being concurrently enqueued. If the <code class="codeph">FIRST_MESSAGE</code> option is not specified, then Oracle Database Advanced Queuing continually generates the snapshot as of the first dequeue command, leading to poor performance. If the <code class="codeph">FIRST_MESSAGE</code> option is specified, then Oracle Database Advanced Queuing uses a new snapshot for every dequeue command. 
                        </p>
                     </div>
                     <p>Messages enqueued in the same transaction into a queue that has been enabled for message grouping form a group. If only one message is enqueued in the transaction, then this effectively forms a group of one message. There is no upper limit to the number of messages that can be grouped in a single transaction. </p>
                     <p>In queues that have not been enabled for message grouping, a dequeue in <code class="codeph">LOCKED</code> or <code class="codeph">REMOVE</code> mode locks only a single message. By contrast, a dequeue operation that seeks to dequeue a message that is part of a group locks the entire group. This is useful when all the messages in a group must be processed as a unit. 
                     </p>
                     <p>When all the messages in a group have been dequeued, the dequeue returns an error indicating that all messages in the group have been processed. The application can then use <code class="codeph">NEXT_TRANSACTION</code> to start dequeuing messages from the next available group. In the event that no groups are available, the dequeue times out after the period specified in the <code class="codeph">wait</code> attribute of <code class="codeph">dequeue_options</code>. 
                     </p>
                     <p>Typically, you expect the consumer of messages to access messages using the dequeue interface. You can view processed messages or messages still to be processed by browsing by message ID or by using <code class="codeph">SELECT</code> commands.
                     </p>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__I1007064">Example 10-13</a> returns the message enqueued in <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__I1005829">Example 10-1</a>. It returns:
                     </p><pre class="oac_no_warn" dir="ltr">From Sender No.1
Subject: TEST MESSAGE
Text: First message to obj_queue
</pre><div class="infoboxnotealso" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__GUID-8152627B-1C44-45C5-9318-9F2CAC878BA8">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCEDDG">Dequeue Modes</a>"</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__GUID-9176C3FC-41D5-4ECE-AC76-45D87ABB2A95">Dequeuing LOB Type Messages</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDGIIIC">Example 10-14</a> creates procedure <code class="codeph">blobdequeue()</code> to dequeue the LOB type messages enqueued in <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGECGJ">Example 10-4</a>. The actual dequeue is shown in <a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDDJJDC">Example 10-15</a>. It returns:
                     </p><pre class="oac_no_warn" dir="ltr">Amount of data read: 2000
Amount of data read: 2000
Amount of data read: 2000
Amount of data read: 2000
Amount of data read: 2000</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__GUID-20130382-02AC-4E0A-81DD-38C8BFDB7315">Dequeuing Grouped Messages</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You can dequeue the grouped messages enqueued in <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDFBDDD">Example 10-8</a> by running <a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDGAIBA">Example 10-16</a>. It returns:
                     </p><pre class="oac_no_warn" dir="ltr">GROUP 1: Message 1 in group 1
GROUP 1: Message 2 in group 1
GROUP 1: Message 3 in group 1
Finished GROUP 1
GROUP 2: Message 1 in group 2
GROUP 2: Message 2 in group 2
GROUP 2: Message 3 in group 2
Finished GROUP 2
GROUP 3: Message 1 in group 3
GROUP 3: Message 2 in group 3
GROUP 3: Message 3 in group 3
Finished GROUP 3
No more messages</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__GUID-383818A3-E888-4864-A6C3-D89FD80DA1CC">Dequeuing from a Multiconsumer Queue</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You can dequeue the messages enqueued for <code class="codeph">RED</code> in <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDHGEFG">Example 10-7</a> by running <a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDIACIJ">Example 10-17</a>. If you change <code class="codeph">RED</code> to <code class="codeph">GREEN</code> and then to <code class="codeph">BLUE</code>, you can use it to dequeue their messages as well. The output of the example will be different in each case.
                     </p>
                     <p><code class="codeph">RED</code> is a subscriber to the multiconsumer queue and is also a specified recipient of MESSAGE 2, so it gets both messages:
                     </p><pre class="oac_no_warn" dir="ltr">Message: MESSAGE 1 .. For queue subscribers
Message: MESSAGE 2 .. For two recipients
No more messages for RED
</pre><p><code class="codeph">GREEN</code> is only a subscriber, so it gets only those messages in the queue for which no recipients have been specified (in this case, MESSAGE 1):
                     </p><pre class="oac_no_warn" dir="ltr">Message: MESSAGE 1 .. For queue subscribers
No more messages for GREEN
</pre><p><code class="codeph">BLUE</code>, while not a subscriber to the queue, is nevertheless specified to receive MESSAGE 2.
                     </p><pre class="oac_no_warn" dir="ltr">Message: MESSAGE 2 .. For two recipients
No more messages for BLUE</pre><p><a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDBJBDB">Example 10-18</a> browses messages enqueued in <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGIJGG">Example 10-5</a> until it finds PINK, which it removes. The example returns:
                     </p><pre class="oac_no_warn" dir="ltr">Browsed Message Text: ORANGE enqueued first.
Browsed Message Text: ORANGE also enqueued second.
Browsed Message Text: YELLOW enqueued third.
Browsed Message Text: VIOLET enqueued fourth.
Browsed Message Text: PURPLE enqueued fifth.
Browsed Message Text: PINK enqueued sixth.
Removed Message Text: PINK enqueued sixth.</pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__GUID-5AC58A5D-35D0-4D5C-9650-EDB98872FEBF">Dequeue Modes</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDDCJFF">Example 10-19</a> previews in locked mode the messages enqueued in <a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35__CHDGIJGG">Example 10-5</a> until it finds PURPLE, which it removes. The example returns:
                     </p><pre class="oac_no_warn" dir="ltr">Locked Message Text: ORANGE enqueued first.
Locked Message Text: ORANGE also enqueued second.
Locked Message Text: YELLOW enqueued third.
Locked Message Text: VIOLET enqueued fourth.
Locked Message Text: PURPLE enqueued fifth.
Removed Message Text: PURPLE enqueued fifth.</pre></div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__I1007064">
                     <p class="titleinexample">Example 10-13 Dequeuing Object Type Messages</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
DECLARE
dequeue_options     DBMS_AQ.dequeue_options_t;
message_properties  DBMS_AQ.message_properties_t;
message_handle      RAW(16);
message             test.message_typ;
BEGIN
   dequeue_options.navigation := DBMS_AQ.FIRST_MESSAGE;
   DBMS_AQ.DEQUEUE(
      queue_name          =&gt;     'test.obj_queue',
      dequeue_options     =&gt;     dequeue_options,
      message_properties  =&gt;     message_properties,
      payload             =&gt;     message,
      msgid               =&gt;     message_handle);
   DBMS_OUTPUT.PUT_LINE('From Sender No.'|| message.sender_id);
   DBMS_OUTPUT.PUT_LINE('Subject: '||message.subject);
   DBMS_OUTPUT.PUT_LINE('Text: '||message.text);
   COMMIT;
END;
/</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDGIIIC">
                     <p class="titleinexample">Example 10-14 Creating a Dequeue Procedure for LOB Type Messages</p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PROCEDURE blobdequeue(msgno IN NUMBER) AS
   dequeue_options     DBMS_AQ.dequeue_options_t; 
   message_properties  DBMS_AQ.message_properties_t; 
   msgid               RAW(16); 
   payload             test.lob_typ; 
   lob_loc             BLOB; 
   amount              BINARY_INTEGER; 
   buffer              RAW(4096); 
BEGIN 
   DBMS_AQ.DEQUEUE(
      queue_name          =&gt;  'test.lob_queue',
      dequeue_options     =&gt;   dequeue_options, 
      message_properties  =&gt;   message_properties, 
      payload             =&gt;   payload,
      msgid               =&gt;   msgid); 
   lob_loc                :=   payload.data;
   amount                 :=   2000; 
   DBMS_LOB.READ(lob_loc, amount, 1, buffer);
   DBMS_OUTPUT.PUT_LINE('Amount of data read: '|| amount); 
   COMMIT;
END;
/</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDDJJDC">
                     <p class="titleinexample">Example 10-15 Dequeuing LOB Type Messages</p><pre class="oac_no_warn" dir="ltr">BEGIN 
   FOR i IN 1..5 LOOP 
     blobdequeue(i); 
   END LOOP; 
END;
/</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDGAIBA">
                     <p class="titleinexample">Example 10-16 Dequeuing Grouped Messages</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
DECLARE
   dequeue_options       DBMS_AQ.dequeue_options_t;
   message_properties    DBMS_AQ.message_properties_t;
   message_handle        RAW(16);
   message               test.message_typ;
   no_messages           exception;
   end_of_group          exception;
   PRAGMA EXCEPTION_INIT (no_messages, -25228);
   PRAGMA EXCEPTION_INIT (end_of_group, -25235);
BEGIN
   dequeue_options.wait       := DBMS_AQ.NO_WAIT;
   dequeue_options.navigation := DBMS_AQ.FIRST_MESSAGE;
   LOOP
     BEGIN
     DBMS_AQ.DEQUEUE(
        queue_name         =&gt; 'test.group_queue',
        dequeue_options    =&gt; dequeue_options,
        message_properties =&gt; message_properties,
        payload            =&gt; message,
        msgid              =&gt; message_handle);
     DBMS_OUTPUT.PUT_LINE(message.subject || ': ' || message.text );
     dequeue_options.navigation := DBMS_AQ.NEXT_MESSAGE;
     EXCEPTION
       WHEN end_of_group THEN
         DBMS_OUTPUT.PUT_LINE ('Finished ' || message.subject);
         COMMIT;
         dequeue_options.navigation := DBMS_AQ.NEXT_TRANSACTION;
     END;
   END LOOP;
   EXCEPTION
     WHEN no_messages THEN
       DBMS_OUTPUT.PUT_LINE ('No more messages');
END;
/</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDIACIJ">
                     <p class="titleinexample">Example 10-17 Dequeuing Messages for RED from a Multiconsumer Queue</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
DECLARE
  dequeue_options       DBMS_AQ.dequeue_options_t;
  message_properties    DBMS_AQ.message_properties_t;
  message_handle        RAW(16);
  message               test.message_typ;
  no_messages           exception;
  PRAGMA EXCEPTION_INIT (no_messages, -25228);
BEGIN
  dequeue_options.wait          := DBMS_AQ.NO_WAIT;
  dequeue_options.consumer_name := 'RED';
  dequeue_options.navigation    := DBMS_AQ.FIRST_MESSAGE;
  LOOP
   BEGIN
    DBMS_AQ.DEQUEUE(
      queue_name         =&gt; 'test.multiconsumer_queue',
      dequeue_options    =&gt; dequeue_options,
      message_properties =&gt; message_properties,
      payload            =&gt; message,
      msgid              =&gt; message_handle);
    DBMS_OUTPUT.PUT_LINE('Message: '|| message.subject ||' .. '|| message.text );
    dequeue_options.navigation := DBMS_AQ.NEXT_MESSAGE;
   END;
  END LOOP;
  EXCEPTION
    WHEN no_messages THEN
    DBMS_OUTPUT.PUT_LINE ('No more messages for RED');
  COMMIT;
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDBJBDB">
                     <p class="titleinexample">Example 10-18 Dequeue in Browse Mode and Remove Specified Message </p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
DECLARE
   dequeue_options     DBMS_AQ.dequeue_options_t;
   message_properties  DBMS_AQ.message_properties_t;
   message_handle      RAW(16);
   message             test.message_typ;
BEGIN
   dequeue_options.dequeue_mode := DBMS_AQ.BROWSE;
   LOOP
      DBMS_AQ.DEQUEUE(
        queue_name              =&gt; 'test.obj_queue',
        dequeue_options         =&gt; dequeue_options,
        message_properties      =&gt; message_properties,
        payload                 =&gt; message,
        msgid                   =&gt; message_handle);
      DBMS_OUTPUT.PUT_LINE ('Browsed Message Text: ' || message.text);
      EXIT WHEN message.subject = 'PINK';
   END LOOP;
   dequeue_options.dequeue_mode := DBMS_AQ.REMOVE;
   dequeue_options.msgid        := message_handle;
   DBMS_AQ.DEQUEUE(
           queue_name           =&gt; 'test.obj_queue',
           dequeue_options      =&gt; dequeue_options,
           message_properties   =&gt; message_properties,
           payload              =&gt; message,
           msgid                =&gt; message_handle);
   DBMS_OUTPUT.PUT_LINE('Removed Message Text: ' || message.text);
   COMMIT;
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDDCJFF">
                     <p class="titleinexample">Example 10-19 Dequeue in Locked Mode and Remove Specified Message</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
DECLARE
   dequeue_options     DBMS_AQ.dequeue_options_t;
   message_properties  DBMS_AQ.message_properties_t;
   message_handle      RAW(16);
   message             test.message_typ;
BEGIN
   dequeue_options.dequeue_mode := DBMS_AQ.LOCKED;
   LOOP
      DBMS_AQ.dequeue(
        queue_name         =&gt; 'test.obj_queue',
        dequeue_options    =&gt; dequeue_options,
        message_properties =&gt; message_properties,
        payload            =&gt; message,
        msgid              =&gt; message_handle);
      DBMS_OUTPUT.PUT_LINE('Locked Message Text: ' || message.text);
      EXIT WHEN message.subject = 'PURPLE';
   END LOOP;
   dequeue_options.dequeue_mode := DBMS_AQ.REMOVE;
   dequeue_options.msgid        := message_handle;
   DBMS_AQ.DEQUEUE(
     queue_name           =&gt; 'test.obj_queue',
     dequeue_options      =&gt; dequeue_options,
     message_properties   =&gt; message_properties,
     payload              =&gt; message,
     msgid                =&gt; message_handle);
   DBMS_OUTPUT.PUT_LINE('Removed Message Text: ' || message.text);
   COMMIT;
END;
/
</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADQUE2849"></a><a id="ADQUE2848"></a><div class="props_rev_3"><a id="GUID-0B018200-824D-458D-98E7-7445AF8B628F" name="GUID-0B018200-824D-458D-98E7-7445AF8B628F"></a><h3 id="ADQUE-GUID-0B018200-824D-458D-98E7-7445AF8B628F" class="sect3"><span class="enumeration_section">10.6 </span>Dequeuing an Array of Messages
               </h3>
               <div>
                  <p>Use the <code class="codeph">DEQUEUE_ARRAY</code> function to dequeue an array of payloads and a corresponding array of message properties. 
                  </p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQ.DEQUEUE_ARRAY(
   queue_name                IN      VARCHAR2,
   dequeue_options           IN      dequeue_options_t,
   array_size                IN      PLS_INTEGER, 
   message_properties_array  OUT     message_properties_array_t,
   payload_array             OUT     VARRAY,
   msgid_array               OUT     msgid_array_t)
RETURN PLS_INTEGER;
</pre><p>The output is an array of payloads, message IDs, and message properties of the dequeued messages. The function returns the number of messages successfully dequeued.</p>
                     <p><a id="d61372e2102" class="indexterm-anchor"></a>Array dequeuing is not supported for buffered messages, but you can still use <code class="codeph">DBMS_AQ.DEQUEUE_ARRAY()</code> to dequeue buffered messages by setting <code class="codeph">array_size</code> to <code class="codeph">1</code>.
                     </p>
                     <p>The payload structure can be a <code class="codeph">VARRAY</code> or nested table. The message identifiers are returned into an array of <code class="codeph">RAW(16)</code> entries of type <code class="codeph">DBMS_AQ.msgid_array_t</code>. The message properties are returned into an array of type <code class="codeph">DBMS_AQ.message_properties_array_t</code>.
                     </p>
                     <p>As with array operations in the relational world, it is not possible to provide a single optimum array size that will be correct in all circumstances. Application developers must experiment with different array sizes to determine the optimal value for their particular applications. </p>
                     <p>All dequeue options available with <code class="codeph">DBMS_AQ.DEQUEUE</code> are also available with <code class="codeph">DBMS_AQ.DEQUEUE_ARRAY</code>. You can choose to dequeue only persistent messages, only buffered messages, or both. In addition, the <code class="codeph">navigation</code> attribute of <code class="codeph">dequeue_options</code> offers two options specific to <code class="codeph">DBMS_AQ.DEQUEUE_ARRAY</code>.
                     </p>
                     <p>When dequeuing messages, you might want to dequeue all the messages for a transaction group with a single call. You might also want to dequeue messages that span multiple transaction groups. You can specify either of these methods by using one of the following navigation methods:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">NEXT_MESSAGE_ONE_GROUP</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">FIRST_MESSAGE_ONE_GROUP</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">NEXT_MESSAGE_MULTI_GROUP</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">FIRST_MESSAGE_MULTI_GROUP</code> 
                           </p>
                        </li>
                     </ul>
                     <p>Navigation method <code class="codeph">NEXT_MESSAGE_ONE_GROUP</code> dequeues messages that match the search criteria from the next available transaction group into an array. Navigation method <code class="codeph">FIRST_MESSAGE_ONE_GROUP</code> resets the position to the beginning of the queue and dequeues all the messages in a single transaction group that are available and match the search criteria.
                     </p>
                     <p>The number of messages dequeued is determined by an array size limit. If the number of messages in the transaction group exceeds <code class="codeph">array_size</code>, then multiple calls to <code class="codeph">DEQUEUE_ARRAY</code> must be made to dequeue all the messages for the transaction group.
                     </p>
                     <p>Navigation methods <code class="codeph">NEXT_MESSAGE_MULTI_GROUP</code> and <code class="codeph">FIRST_MESSAGE_MULTI_GROUP</code> work like their <code class="codeph">ONE_GROUP</code> counterparts, but they are not limited to a single transaction group. Each message that is dequeued into the array has an associated set of message properties. Message property <code class="codeph">transaction_group</code> determines which messages belong to the same transaction group.
                     </p>
                     <p><a href="aq-operations-using-pl-sql.html#GUID-0B018200-824D-458D-98E7-7445AF8B628F__BCFEACBF">Example 10-20</a> dequeues the messages enqueued in <a href="aq-operations-using-pl-sql.html#GUID-92FCE63B-7713-443A-84A3-9F543F0A8819__CHDHAFJA">Example 10-11</a>. It returns:
                     </p><pre class="oac_no_warn" dir="ltr">Number of messages dequeued: 2</pre><div class="infoboxnotealso" id="GUID-0B018200-824D-458D-98E7-7445AF8B628F__GUID-F361158F-D049-488D-AF9F-B24E0E89A854">
                        <p class="notep1">See Also:</p>
                        <p><span class="q">"<a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54" title="This procedure dequeues a message from the specified queue.">Dequeuing Messages</a>"</span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-0B018200-824D-458D-98E7-7445AF8B628F__BCFEACBF">
                     <p class="titleinexample">Example 10-20 Dequeuing an Array of Messages</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
DECLARE
  dequeue_options       DBMS_AQ.dequeue_options_t;
  msg_prop_array        DBMS_AQ.message_properties_array_t := 
                        DBMS_AQ.message_properties_array_t();
  payload_array         test.msg_table;
  msgid_array           DBMS_AQ.msgid_array_t;
  retval                PLS_INTEGER;
BEGIN
  retval := DBMS_AQ.DEQUEUE_ARRAY( 
              queue_name               =&gt; 'test.obj_queue',
              dequeue_options          =&gt; dequeue_options,
              array_size               =&gt; 2,
              message_properties_array =&gt; msg_prop_array,
              payload_array            =&gt; payload_array,
              msgid_array              =&gt; msgid_array);
  DBMS_OUTPUT.PUT_LINE('Number of messages dequeued: ' || retval);
END;/
 </pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADQUE2851"></a><a id="ADQUE2850"></a><div class="props_rev_3"><a id="GUID-DBBE096A-EEA0-4E1E-AC3F-6E1B492D1FB5" name="GUID-DBBE096A-EEA0-4E1E-AC3F-6E1B492D1FB5"></a><h3 id="ADQUE-GUID-DBBE096A-EEA0-4E1E-AC3F-6E1B492D1FB5" class="sect3"><span class="enumeration_section">10.7 </span>Registering for Notification
               </h3>
               <div>
                  <p>This procedure registers an e-mail address, user-defined PL/SQL procedure, or HTTP URL for message notification. </p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQ.REGISTER(
   reg_list     IN SYS.AQ$_REG_INFO_LIST,
   reg_count    IN NUMBER);
</pre><div class="infoboxnote" id="GUID-DBBE096A-EEA0-4E1E-AC3F-6E1B492D1FB5__GUID-6B6EAB4C-AB32-4C3C-A4AC-7C396FB3DDED">
                        <p class="notep1">Note:</p>
                        <p>Starting from 12<span class="italic">c</span> Release 2 (12.2.), the maximum length of user-generated queue names is 122 bytes. See <span class="q">"<a href="aq-administrative-interface.html#GUID-E140B4B5-DB4C-4DFC-8F67-C032516D0324" title="DBMS_AQADM.CREATE_QUEUE creates a non-sharded queue.">Creating a Queue</a>"</span>.
                        </p>
                     </div>
                     <p><a id="d61372e2326" class="indexterm-anchor"></a>The <code class="codeph">reg_list</code> parameter is a list of <code class="codeph">SYS.AQ$_REG_INFO</code> objects. You can specify notification quality of service with the <code class="codeph">qosflags</code> attribute of <code class="codeph">SYS.AQ$_REG_INFO</code>. 
                     </p>
                     <p><a id="d61372e2344" class="indexterm-anchor"></a>The <code class="codeph">reg_count</code> parameter specifies the number of entries in the <code class="codeph">reg_list</code>. Each subscription requires its own <code class="codeph">reg_list</code> entry. Interest in several subscriptions can be registered at one time. 
                     </p>
                     <p>When PL/SQL notification is received, the Oracle Database Advanced Queuing message properties descriptor that the callback is invoked with specifies the <code class="codeph">delivery_mode</code> of the message notified as <code class="codeph">DBMS_AQ.PERSISTENT</code> or <code class="codeph">DBMS_AQ.BUFFERED</code>.
                     </p>
                     <p>If you register for e-mail notifications, then you must set the host name and port name for the SMTP server that will be used by the database to send e-mail notifications. If required, you should set the send-from e-mail address, which is set by the database as the <code class="codeph">sent from</code> field. You need a Java-enabled database to use this feature.
                     </p>
                     <p>If you register for HTTP notifications, then you might want to set the host name and port number for the proxy server and a list of no-proxy domains that will be used by the database to post HTTP notifications.</p>
                     <p>An internal queue called <code class="codeph">SYS.AQ_SRVNTFN_TABLE_Q</code> stores the notifications to be processed by the job queue processes. If notification fails, then Oracle Database Advanced Queuing retries the failed notification up to <code class="codeph">MAX_RETRIES</code> attempts. 
                     </p>
                     <div class="infoboxnote" id="GUID-DBBE096A-EEA0-4E1E-AC3F-6E1B492D1FB5__GUID-AC99BBC6-B0E9-4AAC-882D-D5FBCF031214">
                        <p class="notep1">Note:</p>
                        <p>You can change the <code class="codeph">MAX_RETRIES</code> and <code class="codeph">RETRY_DELAY</code> properties of <code class="codeph">SYS.AQ_SRVNTFN_TABLE_Q</code>. The new settings are applied across all notifications.
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-DBBE096A-EEA0-4E1E-AC3F-6E1B492D1FB5__GUID-4648DC70-9119-4219-9335-AB242EBBBE0A">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="aq-basic-components.html#GUID-94CBE09C-EE8C-4874-A30D-CCBE1F8D862E" title="This component identifies a producer or a consumer of a message.">AQ Registration Information Type</a>"</span> for more information on <code class="codeph">SYS.AQ$_REG_INFO</code> objects
                              </p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="aq-basic-components.html#GUID-5B9C62D6-ED8A-4E35-9889-16F5166D4144" title="This component specifies the Oracle Database Advanced Queuing descriptor received by AQ PL/SQL callbacks upon notification.">AQ Notification Descriptor Type</a>"</span> for more information on the message properties descriptor
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-DBBE096A-EEA0-4E1E-AC3F-6E1B492D1FB5__GUID-67FA4C4E-5B24-46EB-90DC-32E056D08BF1">
                     <p class="titleinexample">Example 10-21 Registering for Notifications</p><pre class="oac_no_warn" dir="ltr">DECLARE
  reginfo             sys.aq$_reg_info;
  reg_list            sys.aq$_reg_info_list;
BEGIN
  reginfo := sys.aq$_reg_info(
                      'test.obj_queue',
                      DBMS_AQ.NAMESPACE_ANONYMOUS,
                      'http://www.company.com:8080', 
                      HEXTORAW('FF'));
  reg_list  := sys.aq$_reg_info_list(reginfo);
  DBMS_AQ.REGISTER(
    reg_list     =&gt; reg_list, 
    reg_count    =&gt; 1);
  COMMIT;
END;
/
</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADQUE2852"></a><div class="props_rev_3"><a id="GUID-3FD95C26-D2FF-49CF-BBCF-A6E40468D55E" name="GUID-3FD95C26-D2FF-49CF-BBCF-A6E40468D55E"></a><h3 id="ADQUE-GUID-3FD95C26-D2FF-49CF-BBCF-A6E40468D55E" class="sect3"><span class="enumeration_section">10.8 </span>Unregistering for Notification
               </h3>
               <div>
                  <p>This procedure unregisters an e-mail address, user-defined PL/SQL procedure, or HTTP URL for message notification. </p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQ.UNREGISTER(
   reg_list     IN SYS.AQ$_REG_INFO_LIST,
   reg_count    IN NUMBER);
</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2854"></a><a id="ADQUE2853"></a><div class="props_rev_3"><a id="GUID-4C80C7E8-DAD2-49CA-9294-895581A64378" name="GUID-4C80C7E8-DAD2-49CA-9294-895581A64378"></a><h3 id="ADQUE-GUID-4C80C7E8-DAD2-49CA-9294-895581A64378" class="sect3"><span class="enumeration_section">10.9 </span>Posting for Subscriber Notification
               </h3>
               <div>
                  <p>This procedure posts to a list of anonymous subscriptions, allowing all clients who are registered for the subscriptions to get notifications of persistent messages. </p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQ.POST(
  post_list       IN  SYS.AQ$_POST_INFO_LIST,
  post_count      IN  NUMBER);
</pre><p>This feature is not supported with buffered messages.</p>
                     <p>The <code class="codeph">count</code> parameter specifies the number of entries in the <code class="codeph">post_list</code>. Each posted subscription must have its own entry in the <code class="codeph">post_list</code>. Several subscriptions can be posted to at one time. 
                     </p>
                     <p>The <code class="codeph">post_list</code> parameter specifies the list of anonymous subscriptions to which you want to post. It has three attributes:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a id="d61372e2592" class="indexterm-anchor"></a><code class="codeph">name</code></p>
                           <p>The <code class="codeph">name</code> attribute specifies the name of the anonymous subscription to which you want to post.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e2605" class="indexterm-anchor"></a><code class="codeph">namespace</code></p>
                           <p>The <code class="codeph">namespace</code> attribute specifies the namespace of the subscription. To receive notifications from other applications through <code class="codeph">DBMS_AQ.POST</code> the namespace must be <code class="codeph">DBMS_AQ.NAMESPACE_ANONYMOUS</code>.
                           </p>
                        </li>
                        <li>
                           <p><a id="d61372e2624" class="indexterm-anchor"></a><code class="codeph">payload</code></p>
                           <p>The <code class="codeph">payload</code> attribute specifies the payload to be posted to the anonymous subscription. It is possible for no payload to be associated with this call. 
                           </p>
                        </li>
                     </ul>
                     <p>This call provides a best-effort guarantee. A notification goes to registered clients at most once. This call is primarily used for lightweight notification. If an application needs more rigid guarantees, then it can enqueue to a queue. </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-4C80C7E8-DAD2-49CA-9294-895581A64378__GUID-94657F22-8CCB-44FB-9686-716FBFE77755">
                     <p class="titleinexample">Example 10-22 Posting Object-Type Messages</p><pre class="oac_no_warn" dir="ltr">DECLARE
  postinfo            sys.aq$_post_info;
  post_list           sys.aq$_post_info_list;
BEGIN
  postinfo  := sys.aq$_post_info('test.obj_queue',0,HEXTORAW('FF')); 
  post_list := sys.aq$_post_info_list(postinfo);
  DBMS_AQ.POST(
    post_list       =&gt; post_list,
    post_count      =&gt; 1);
  COMMIT;
END;
/</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADQUE2855"></a><div class="props_rev_3"><a id="GUID-E4F131CA-964F-4DF7-86EE-FB37078DD157" name="GUID-E4F131CA-964F-4DF7-86EE-FB37078DD157"></a><h3 id="ADQUE-GUID-E4F131CA-964F-4DF7-86EE-FB37078DD157" class="sect3"><span class="enumeration_section">10.10 </span>Adding an Agent to the LDAP Server
               </h3>
               <div>
                  <p>This procedure creates an entry for an Oracle Database Advanced Queuing agent in the LDAP server.</p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQ.BIND_AGENT(
   agent        IN SYS.AQ$_AGENT,
   certificate  IN VARCHAR2 default NULL);
</pre><p>The <code class="codeph">agent</code> parameter specifies the Oracle Database Advanced Queuing Agent that is to be registered in <a href="glossary.html#GUID-6BF3485C-E98F-4344-A7DE-64950BCCE160"><span class="xrefglossterm">Lightweight Directory Access Protocol</span></a> (LDAP) server. 
                     </p>
                     <p><a id="d61372e2718" class="indexterm-anchor"></a>The <code class="codeph">certificate</code> parameter specifies the location (LDAP distinguished name) of the <code class="codeph">OrganizationalPerson</code> entry in LDAP whose digital certificate (attribute <code class="codeph">usercertificate</code>) is to be used for this agent. For example, "<code class="codeph">cn=OE, cn=ACME, cn=com</code>" is a distinguished name for a <code class="codeph">OrganizationalPerson</code> <code class="codeph">OE</code> whose certificate will be used with the specified agent. If the agent does not have a digital certificate, then this parameter is defaulted to null.
                     </p>
                     <div class="infoboxnotealso" id="GUID-E4F131CA-964F-4DF7-86EE-FB37078DD157__GUID-31833F55-0391-4079-9C42-9B56505965F8">
                        <p class="notep1">See Also:</p>
                        <p><span class="q">"<a href="aq-basic-components.html#GUID-2C5557D9-E11B-4AB9-94E0-F923C85D6E0A" title="This component identifies a producer or consumer of a message.">AQ Agent Type</a>"</span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2856"></a><div class="props_rev_3"><a id="GUID-E6B7E2DC-9FD6-4EA8-8A92-D9929B9EA1B7" name="GUID-E6B7E2DC-9FD6-4EA8-8A92-D9929B9EA1B7"></a><h3 id="ADQUE-GUID-E6B7E2DC-9FD6-4EA8-8A92-D9929B9EA1B7" class="sect3"><span class="enumeration_section">10.11 </span>Removing an Agent from the LDAP Server
               </h3>
               <div>
                  <p>This procedure removes the entry for an Oracle Database Advanced Queuing agent from the LDAP server.</p>
                  <div class="section"><pre class="oac_no_warn" dir="ltr">DBMS_AQ.UNBIND_AGENT(
   agent    IN SYS.AQ$_AGENT);
</pre></div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>