<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="An Oracle Flex Cluster scales Oracle Clusterware to large numbers of nodes.">
      <meta name="description" content="An Oracle Flex Cluster scales Oracle Clusterware to large numbers of nodes.">
      <title>Oracle Flex Clusters</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Clusterware Administration and Deployment Guide">
      <meta property="og:description" content="An Oracle Flex Cluster scales Oracle Clusterware to large numbers of nodes.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Clusterware Administration and Deployment Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="clusterware-administration-and-deployment-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-04-24T07:05:38-07:00">
      <meta name="dcterms.title" content="Clusterware Administration and Deployment Guide">
      <meta name="dcterms.dateCopyrighted" content="2007, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E95727-05">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="policy-based-cluster-and-capacity-management.html" title="Previous" type="text/html">
      <link rel="next" href="rapid-home-provisioning.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CWADD">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="policy-based-cluster-and-capacity-management.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="rapid-home-provisioning.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Clusterware Administration and Deployment Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle Flex Clusters</li>
            </ol>
            <a id="GUID-DF441DD8-B3B4-48C2-96B5-3DD59EAAC8EF" name="GUID-DF441DD8-B3B4-48C2-96B5-3DD59EAAC8EF"></a><a id="CWADD92560"></a>
            
            <h2 id="CWADD-GUID-DF441DD8-B3B4-48C2-96B5-3DD59EAAC8EF" class="sect2"><span class="enumeration_chapter">4 </span>Oracle Flex Clusters
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>An Oracle Flex Cluster scales Oracle Clusterware to large numbers of nodes.</p>
               <p>This chapter includes the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="oracle-flex-clusters.html#GUID-E1014B42-E671-4314-A2B0-D7B03EA4285F" title="Oracle Grid Infrastructure installed in an Oracle Flex Cluster configuration is a scalable, dynamic, robust network of nodes.">Overview of Oracle Flex Clusters</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-flex-clusters.html#GUID-EECBD421-5ADF-4D5B-8E67-3D3747426A79" title="Use CRSCTL to manage Oracle Flex Clusters after successful installation of Oracle Grid Infrastructure for either a small or large cluster.">Managing Oracle Flex Clusters</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-flex-clusters.html#GUID-7E5B7D48-E472-4398-88C1-F0A58E532908" title="You can extend an Oracle RAC cluster across two, or more, geographically separate sites, each equipped with its own storage. In the event that one of the sites fails, the other site acts as an active standby.">Oracle Extended Clusters</a></p>
                  </li>
               </ul>
            </div><a id="CWADD92401"></a><div class="props_rev_3"><a id="GUID-E1014B42-E671-4314-A2B0-D7B03EA4285F" name="GUID-E1014B42-E671-4314-A2B0-D7B03EA4285F"></a><h3 id="CWADD-GUID-E1014B42-E671-4314-A2B0-D7B03EA4285F" class="sect3">Overview of Oracle Flex Clusters</h3>
               <div>
                  <p>Oracle Grid Infrastructure installed in an Oracle Flex Cluster configuration is a scalable, dynamic, robust network of nodes.</p>
                  <p>Oracle Flex Clusters provide a platform for a variety of applications, including Oracle Real Application Clusters (Oracle RAC) databases with large numbers of nodes. Oracle Flex Clusters also provide a platform for other service deployments that require coordination and automation for high availability.</p>
                  <p>All nodes in an Oracle Flex Cluster belong to a single Oracle Grid Infrastructure cluster. This architecture centralizes policy decisions for deployment of resources based on application needs, to account for various service levels, loads, failure responses, and recovery.</p>
                  <p>Oracle Flex Clusters contain <a href="glossary.html#GUID-8AD68754-1C50-408B-82A9-61D132FC09F9"><span class="xrefglossterm">Hub Node</span></a>s and any number of other supported nodes. The number of Hub Nodes in an Oracle Flex Cluster can be as many as 64. The number of other nodes can be many more. Hub Nodes can host different types of applications.
                  </p>
                  <p>Hub Nodes are similar to Oracle Grid Infrastructure nodes in an Oracle Clusterware standard Cluster configuration: they are tightly connected, and have direct access to shared storage. Use Hub Nodes to host read-write database instances.</p>
                  <p>Other supported nodes in an Oracle Flex Cluster are different from standard Oracle Grid Infrastructure nodes, in that they do not require direct access to shared storage, but instead request data through Hub Nodes. Use other nodes to host read-only database instances.</p>
                  <div class="infoboxnote" id="GUID-E1014B42-E671-4314-A2B0-D7B03EA4285F__GUID-0E715559-9269-4C5E-8DC8-0CD588F6A70E">
                     <p class="notep1">Note:</p>Read-write and read-only database instances of the same primary database can coexist in an Oracle Flex Cluster.
                  </div>
                  <p>Hub Nodes can run in an Oracle Flex Cluster configuration without having any other nodes as cluster member nodes, but other nodes must be members of a cluster that includes at least one Hub Node.</p>
                  <div class="infoboxnote" id="GUID-E1014B42-E671-4314-A2B0-D7B03EA4285F__GUID-74670CF2-2019-4FC8-896D-49A42D9E0B05">
                     <p class="notep1">Note:</p>
                     <p>If you upgrade an Oracle Flex Cluster, then Oracle recommends that you upgrade the Hub Nodes first, and that you also have any upgraded Hub Nodes up and running as part of the upgrade process.</p>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-E1014B42-E671-4314-A2B0-D7B03EA4285F__GUID-1AA80422-CEEE-4D5E-9DA7-727308A00192">Reader Nodes</p>
                     <p>You can use other nodes to host Oracle RAC database instances that run in read-only mode, which become <a href="glossary.html#GUID-FC76BEE4-8B4D-4C9C-92D5-84C2E6B8A193"><span class="xrefglossterm">reader node</span></a>s. You can optimize these nodes for parallel query operations by provisioning nodes with a large amount of memory so that data is cached in the hosting node.
                     </p>
                     <p>A hosting node sends periodic heartbeat messages to its associated Hub Node, which is different from the heartbeat messages that occur between Hub Nodes. During planned shutdown of the Hub Nodes, a hosting node attempts to connect to another Hub Node, unless the hosting node is connected to only one Hub Node. If the Hub Node is evicted, then the hosting node is also evicted from the cluster.</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CWADD92409"></a><div class="props_rev_3"><a id="GUID-EECBD421-5ADF-4D5B-8E67-3D3747426A79" name="GUID-EECBD421-5ADF-4D5B-8E67-3D3747426A79"></a><h3 id="CWADD-GUID-EECBD421-5ADF-4D5B-8E67-3D3747426A79" class="sect3">Managing Oracle Flex Clusters</h3>
               <div>
                  <p>Use CRSCTL to manage Oracle Flex Clusters after successful installation of Oracle Grid Infrastructure for either a small or large cluster.</p>
                  <p>This section includes the following topics:<a id="d24401e434" class="indexterm-anchor"></a></p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="oracle-flex-clusters.html#GUID-525DD457-E46C-4718-BB19-50780E540017" title="You can change the mode of an existing Oracle Clusterware standard Cluster to be an Oracle Flex Cluster.">Changing the Cluster Mode</a></p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span></a></li>
                        <li><a href="oracle-clusterware-control-crsctl-utility-reference.html#GUID-1A6774CF-FD5F-463E-817F-34E4466443C7" title="CRSCTL is an interface between you and Oracle Clusterware, parsing and calling Oracle Clusterware APIs for Oracle Clusterware objects.Information about using the CRSCTL command-line interface.Use these commands in either the Oracle RAC or the Oracle Restart environments.Checks the status of Cluster Synchronization Services.Checks the status of the Event Manager.Retrieves the host name of the local server.Registers a resource to be managed by Oracle Clusterware.Removes resources from the Oracle Clusterware configuration.Predicts the effects of adding a resource without making changes to the system.Predicts the consequences of a resource failing.Simulates relocating a resource without making changes to the system.Predicts the effects of modifying a resource without making changes to the system.Predicts the effects of starting a resource without making changes to the system.Predicts the effect of stopping a resource without making changes to the system.Displays the user and group permissions for the specified resource.Modifies the attributes of a particular resource in Oracle Clusterware.Relocates resources to another server in the cluster.Restarts idle resources in the cluster, instead of having to run two commands to stop and start the resource.Sets permissions for a particular resource.Starts idle resources on a particular server in the cluster.Obtains the status and configuration information of any number of particular resources.Stops running resources.Creates a resource group based on a resource group type.Initiates a check operation on all member resources of the specified groups.Deletes one or more resource groups from Oracle Clusterware.Predicts the effects of adding a resource group without making changes to the system.Predicts the consequences of a resource failing.Predicts the effect of relocating a resource group without making changes to the system.Predicts the effects of starting a resource group without making changes to the system.Predicts the effect of stopping a resource group without making changes to the system.Exports the complete information and attributes of a resource groups and its member resources to a script file.Modifies a resource group to add attributes or update the values of existing attributes.Relocates online resource groups from a source server to a target server.Restarts resource groups on the server where they currently reside.Starts one or more resource groups on specific or preconfigured servers or server pools.Displays the state of resource groups.Stops one or more resource groups on optionally specified preconfigured servers or server pools.Registers a new resource group type in Oracle Clusterware.Deletes one or more resource group types from Oracle Clusterware.Modifies a resource group type to add attributes or update the values of existing attributes.Returns the tracing settings for a specific module.Sets the tracing parameters for a specific module.Creates a resource type in Oracle Clusterware.Removes resource types from the Oracle Clusterware configuration.Obtains permissions for a particular resource type.Modifies an existing resource type.Sets permissions for resources of a particular resource type.Obtains the configuration information of one or more particular resource types.Creates and adds users to a wallet.Removes wallets or users from a wallet.Modifies the password for a specific user in a specific wallet.Queries low-privileged users from a wallet.You can use the following commands only in an Oracle RAC environment.Performs a specific action on specific resource.Adds a server category.Deletes a server category.Modifies an existing server category.Obtains information about a server category.Checks the status of the Oracle Clusterware stack from any node in the cluster.Starts the Oracle Clusterware stack when run on any node in the cluster.Stops the Oracle Clusterware stack on all servers in the cluster or specific servers when you run the command on any node in the cluster.Obtains cluster class information.Displays the cluster configuration information.Adds a cipher suite to or removes a cipher suite from a list of disabled cipher suites used to secure inter-node communication.Determines whether the cluster is an extended cluster.Obtains the value of Hub Nodes in an Oracle Flex Cluster.Sets the maximum number of Hub Nodes for an Oracle Flex Cluster.Ascertains whether the cluster is configured for Oracle Flex Clusters or obtains the current status.Changes a standard cluster to an Oracle Flex Cluster.Displays the current cluster name.Use the crsctl add cluster site command to add a site to an extended cluster.Use the crsctl delete cluster site command to delete a specific site from an extended cluster.Modifies the configuration of a site in an extended cluster.Displays site information in an extended cluster.Lists available cipher suites used by transport layer security for securing inter-node communication.Use the crsctl get cluster type command to determine whether the cluster is an Oracle Flex Cluster or an application cluster.Sets the type of the cluster.The crsctl get cpu equivalency command obtains the value of the CPU_EQUIVALENCY server configuration attribute.The crsctl set cpu equivalency command sets a value for the CPU_EQUIVALENCY server configuration attribute.Checks the status of Oracle High Availability Services and the Oracle Clusterware stack on the local server.Displays Oracle High Availability Services automatic startup configuration.Prevents the automatic startup of Oracle High Availability Services when the server boots.Enables automatic startup of Oracle High Availability Services when the server boots.Starts Oracle High Availability Services on the local server.Stops Oracle High Availability Services on the local server.Displays the active version and the configured patch level of the Oracle Clusterware software running in the cluster.Adds a user to the list of cluster administrators.Removes a user from the list of Oracle Clusterware administrators.Displays the list of users with Oracle Clusterware administrative privileges.Obtains the values of the Oracle Clusterware automatic resource start criteria.Sets the Oracle Clusterware automatic resource start criteria.Displays the patch level which is updated in the Grid home patch repository while patching a node.Displays the version of the Oracle Clusterware software stored in the binaries on the local node.Use the crsctl query crs site command to determine to which site a specific host or disk belongs.Displays the configured patch level of the installed Oracle Clusterware.Displays the latest version of the software that has been successfully started on the specified node.Obtains the value of a specific Cluster Synchronization Services parameter.Pins many specific nodes.Sets the value of a Cluster Synchronization Services parameter.Unpins many servers.Unsets the value of a Cluster Synchronization Services parameter and restores it to its default value.Retrieves the address stored in the Oracle Local Registry of the local Intelligent Platform Management Interface (IPMI) device.Stores the address of the local Intelligent Platform Management Interface (IPMI) device in the Oracle Local Registry.Stores the login credentials of an Intelligent Platform Management Interface (IPMI) administrator in the Oracle Local Registry.Determines whether Oracle Clusterware on the local server has been configured to use IPMI for failure isolation.Clears all previously stored IPMI configuration (login credentials and IP address) from the Oracle Local Registry.Determines the presence of the Intelligent Platform Management Interface (IPMI) driver on the local system.Lists the problems for which automatic restart of Cluster Synchronization Services is disabled.Stops the automatic restart of Cluster Synchronization Services when a specific problem occurs.Removes a voting file from the Oracle Clusterware configuration.Displays the voting files used by Cluster Synchronization Services, the status of the voting files, and the location of the disks, whether they are stored in Oracle ASM or elsewhere.Checks the status of the Cluster Time Synchronization services.Sends DHCP discover packets on the network at the specified port. If DHCP servers are present on the network, then they respond to the discovery message and the command succeeds.Displays the client ID that the Oracle Clusterware agent uses to obtain the IP addresses from the DHCP server for configured cluster resources. The VIP type is required.Sends a DHCP lease release request to a specific client ID, and sends release packets on the network to a specific port.Sends DHCP request packets on the network to the specified port.Replaces the existing discovery string used to locate voting files.Obtains a list of addresses returned by DNS lookup of the name with the specified DNS server.Starts a given IP name or IP address on a specified interface with a specified subnet mask.Checks if a given IP address is up on the network.Stops a given IP name or IP address on a specified interface with a specified subnet mask.Lists the components of the modules that you can debug.Creates the configuration deployment file for a new member cluster.Deletes a member cluster configuration.Displays the configuration for a member cluster.Removes a node from the cluster.Obtains the name of the local node.Obtains the configured node role of nodes in the cluster.Adds a configuration policy to the policy set.Deletes a configuration policy from the policy set.Predicts the effects of activating a specific policy without making changes to the system.Modifies an existing configuration policy.Obtains the status and definition of a configuration policy.Creates a single policy set, in the form of a text file, that reflects the server pool configuration.Modifies an existing policy set.Obtains the current policies in the policy set, including the access control list, which governs who can modify the set, the last activated policy, and the configuration which is now in effect, which is known as the Current policy.Initiates the check action inside the application-specific agent of a particular resource.Relocates resources to another server in the cluster.Checks the current setting value of the RESOURCE_USE_ENABLED server configuration parameter.Sets the value of the RESOURCE_USE_ENABLED server configuration parameter for the server on which you run this command.Transitions Oracle Clusterware and Oracle ASM into rolling patch mode.Transitions Oracle Clusterware and Oracle ASM out of rolling patch mode.Transitions Oracle Clusterware and Oracle ASM into rolling upgrade mode.Simulates the addition of a server without making changes to the system.Predicts the effects of deleting a server without making changes to the system.Predicts the effects of relocating a server to a different server pool without making changes to the system. Modifies the configuration of a particular server.Relocates a server to a different server pool.Obtains the status and configuration information of one or more particular servers.Obtains the current configured value for the CSS_CRITICAL server attributeSets the configuration value for the CSS_CRITICAL server attribute.Checks the current setting value of the SERVER_LABEL server attribute.Sets the configuration value of the SERVER_LABEL server configuration attribute for the server on which you run this command.Adds a server pool that is for hosting non-database resources (such as application servers) to Oracle Clusterware.Removes a server pool from the Oracle Clusterware configuration.Predicts the effects of adding a server pool without making changes to the system.Simulates the deletion of a server pool without making changes to the system.Use the crsctl eval modify serverpool command to predict the effects of modifying a server pool without making changes to the system. This command may be useful to cluster administrators.Retrieves permissions for a particular server pool.Modifies an existing server pool.Sets permissions for a particular server pool.Retrieves the status and configuration information of one or more particular server pools.Verifies that a daemon can listen on a specified address and port.Starts a test DNS server that will listen on a specified IP address and port.Queries the test DNS server running on a specified address and local host name.Stops a test DNS server.Moves or replaces the existing voting files.You can only use these commands in the Oracle Restart environment.Checks the status of ohasd.Displays the automatic startup configuration of the Oracle High Availability Services stack on the server.Disables automatic startup of the Oracle High Availability Services stack when the server boots up.Enables automatic startup of the Oracle High Availability Services stack when the server boots up.Displays the release version of the Oracle Clusterware software that is stored in the binaries on the local node.Displays the software version on the local node.Starts Oracle High Availability Services on the local server.Stops Oracle High Availability Services on the local server.You can use crsctl set log commands as the root user to enable dynamic debugging for Cluster Ready Services (CRS), Cluster Synchronization Services (CSS), and the Event Manager (EVM), and the clusterware subcomponents.Setting log levels for Oracle Clusterware.You can enable debugging for Oracle Clusterware modules and their components, and for resources, by setting environment variables or by running the crsctl set log command.">Oracle Clusterware Control (CRSCTL) Utility Reference</a></li>
                     </ul>
                  </div>
               </div><a id="CWADD92410"></a><div class="props_rev_3"><a id="GUID-525DD457-E46C-4718-BB19-50780E540017" name="GUID-525DD457-E46C-4718-BB19-50780E540017"></a><h4 id="CWADD-GUID-525DD457-E46C-4718-BB19-50780E540017" class="sect4">Changing the Cluster Mode</h4>
                  <div>
                     <p>You can change the mode of an existing Oracle Clusterware standard Cluster to be an Oracle Flex Cluster.</p>
                     <div class="p">
                        <div class="infoboxnote" id="GUID-525DD457-E46C-4718-BB19-50780E540017__GUID-F3C82316-CC74-460B-B4AF-613600BF7A0C">
                           <p class="notep1">Note:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Changing the cluster mode requires cluster downtime.</p>
                              </li>
                              <li>
                                 <p>Oracle does not support changing an Oracle Flex Cluster to an Oracle Clusterware standard Cluster.</p>
                              </li>
                              <li>
                                 <p>Oracle Flex Cluster requires Grid Naming Service (GNS).</p>
                              </li>
                              <li>
                                 <p>Zone delegation is not required.</p>
                              </li>
                           </ul>
                        </div><a id="d24401e652" class="indexterm-anchor"></a><a id="d24401e656" class="indexterm-anchor"></a><a id="d24401e658" class="indexterm-anchor"></a></div>
                  </div><a id="CWADD92411"></a><div class="props_rev_3"><a id="GUID-838B90FA-50FD-445E-A8EB-7BD45F494A22" name="GUID-838B90FA-50FD-445E-A8EB-7BD45F494A22"></a><h5 id="CWADD-GUID-838B90FA-50FD-445E-A8EB-7BD45F494A22" class="sect5">Changing an Oracle Clusterware Standard Cluster to an Oracle Flex Cluster</h5>
                     <div>
                        <p>Use CRSCTL to change an existing Oracle Clusterware standard Cluster to an Oracle Flex Cluster. </p>
                        <div class="section">
                           <p>Perform the following steps:</p>
                           <ol>
                              <li>
                                 <p>Run the following command to determine the current mode of the cluster:</p><pre class="pre codeblock"><code>$ crsctl get cluster mode status</code></pre></li>
                              <li>
                                 <p>Run the following command to ensure that the Grid Naming Service (GNS) is configured with a fixed VIP:</p><pre class="pre codeblock"><code>$ srvctl config gns</code></pre><p>This procedure cannot succeed unless GNS is configured with a fixed VIP. If there is no GNS, then, as <code class="codeph">root</code>, create one, as follows:
                                 </p><pre class="pre codeblock"><code># srvctl add gns -vip <span class="variable" translate="no">vip_name</span> | <span class="variable" translate="no">ip_address</span></code></pre><p>Run the following command as <code class="codeph">root</code> to start GNS:
                                 </p><pre class="pre codeblock"><code># srvctl start gns</code></pre></li>
                              <li>
                                 <p>Use the Oracle Automatic Storage Management Configuration Assistant (ASMCA) to enable Oracle Flex ASM in the cluster before you change the cluster mode.</p>
                              </li>
                              <li>
                                 <p>Run the following command as <code class="codeph">root</code> to change the mode of the cluster to be an Oracle Flex Cluster:
                                 </p><pre class="pre codeblock"><code># crsctl set cluster mode flex</code></pre></li>
                              <li>
                                 <p>Stop Oracle Clusterware by running the following command as <code class="codeph">root</code> on each node in the cluster:
                                 </p><pre class="pre codeblock"><code># crsctl stop crs</code></pre></li>
                              <li>
                                 <p>Start Oracle Clusterware by running the following command as <code class="codeph">root</code> on each node in the cluster:
                                 </p><pre class="pre codeblock"><code># crsctl start crs -wait</code></pre><div class="infoboxnote" id="GUID-838B90FA-50FD-445E-A8EB-7BD45F494A22__GUID-EE82E814-FD99-4749-9265-823A4764C996">
                                    <p class="notep1">Note:</p>
                                    <p>Use the <code class="codeph">-wait</code> option to display progress and status messages.
                                    </p>
                                 </div>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../ostmg/manage-flex-asm.html#OSTMG-GUID-DE759521-9CF3-45D9-9123-7159C9ED4D30" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-7E5B7D48-E472-4398-88C1-F0A58E532908" name="GUID-7E5B7D48-E472-4398-88C1-F0A58E532908"></a><h3 id="CWADD-GUID-7E5B7D48-E472-4398-88C1-F0A58E532908" class="sect3">Oracle Extended Clusters</h3>
               <div>
                  <p>You can extend an Oracle RAC cluster across two, or more, geographically separate sites, each equipped with its own storage. In the event that one of the sites fails, the other site acts as an active standby.</p>
                  <p>Both Oracle ASM and the Oracle Database stack, in general, are designed to use enterprise-class shared storage in a data center. Fibre Channel technology, however, enables you to distribute compute and storage resources across two or more data centers, and connect them through ethernet cables and Fibre Channel, for compute and storage needs, respectively.</p>
                  <p>While you can configure Oracle Extended Clusters when you install Oracle Grid Infrastructure, you can also do so post installation using the <code class="codeph">ConvertToExtended</code> script. You manage your Oracle Extended Cluster using CRSCTL.
                  </p>
               </div>
               <div class="sect3"><a id="GUID-D4B24433-6E47-450D-AE7B-76B8E5D95B1D" name="GUID-D4B24433-6E47-450D-AE7B-76B8E5D95B1D"></a><h4 id="CWADD-GUID-D4B24433-6E47-450D-AE7B-76B8E5D95B1D" class="sect4">Configuring Oracle Extended Clusters</h4>
                  <div>
                     <p>This procedure is only supported for clusters that have been installed with or upgraded to Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2), or later, which are typically configured with one site (default site).
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-D4B24433-6E47-450D-AE7B-76B8E5D95B1D__GUID-4F6E549E-04F4-4569-BD54-47EFC3B56C8D">
                           <p class="notep1">Note:</p>This procedure requires that all nodes in the cluster be accessible. There will also be a cluster outage during which time database access is disrupted.
                        </div>You can configure an Oracle Extended Cluster with one or many disk groups and with multiple failure groups. Using the <code class="codeph">ConvertToExtended</code> script you can create multiple data sites and associate a node with each data site. All Oracle Flex ASM storage remains associated with the default cluster site because there is no mechanism to convert an existing disk group to an extended disk group. After you convert your cluster to an Oracle Extended Cluster, the voting file membership remains flat, and not hierarchical.
                     </div>
                     <!-- class="section" -->
                     <div class="section">You must also add an extended disk group, and migrate the voting files to the extended disk group to take advantage of a site-specific hierarchical voting file algorithm.</div>
                     <!-- class="section" -->
                     <div class="p">Use CRSCTL to query the cluster, as follows, to determine its extended status:<pre class="pre codeblock"><code><span class="bold">$ crsctl get cluster extended</span>
CRS-6579: The cluster is 'NOT EXTENDED'</code></pre><pre class="pre codeblock"><code><span class="bold">$ crsctl query cluster site &#x2013;all</span>
Site 'crsclus' identified by '7b7b3bef4c1f5ff9ff8765bceb45433a' in state 'ENABLED',
 and contains nodes 'node1,node2,node3,node4', and disks ''.</code></pre><p>The preceding example identifies a cluster called <code class="codeph">crsclus</code> that has four nodes—<code class="codeph">node1</code>, <code class="codeph">node2</code>, <code class="codeph">node3</code>, and <code class="codeph">node4</code>—and a disk group—<code class="codeph">datadg</code>. The cluster has one site configured.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="p">Shut down the Oracle Clusterware stack to prevent some Oracle Flex ASM instances, <code class="codeph">cssd</code>, and <code class="codeph">crsd</code> from considering the cluster mode is not extended, and other components to consider that it is extended. The advantage to keeping the Grid Plug and Play daemon (<code class="codeph">gpnpd</code>) online is that the profile gets updated on the remote nodes. When you next start the Oracle Clusterware stack, the cluster mode will be extended.<pre class="pre codeblock"><code># crsctl stop cluster -all</code></pre></div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>On the first node in the cluster, run the following command:</span><div><pre class="pre codeblock"><code>$ rootcrs.sh -converttoextended -firstnode -sites <span class="variable" translate="no">site_list</span> -site <span class="variable" translate="no">site_name</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Run <code class="codeph">crsctl check css</code> to ensure that Cluster Synchronization Servcies (CSS) is not running on any remote nodes.</span></li>
                        <li class="stepexpand"><span>Generate the site names and the site GUIDs, using the following command:</span><div><pre class="pre codeblock"><code>$ crsctl query cluster site &#x2013;all</code></pre><div class="p">The preceding command displays output similar to the following:<pre class="pre codeblock"><code>Site 'SiteA' identified by GUID '7b7b3bef4c1f5ff9ff8765bceb45433a' in state
  'ONLINE' contains nodes 'node1,node2,node3', and disks 'disk1, disk2, disk3'.
Site 'SiteB' identified by GUID '23453bef4c1f5ff9ff8765bceb45433a' in state
  'QUARANTINED' contains nodes 'node4, node5, node6', and disks 'disk4, disk5, disk6'.
Site 'SiteQ' identified by GUID '98763bef4c1f5ff9ff8765bceb45433a' in state
  'ONLINE' contains no nodes and disk 'disk7'.
Site 'SiteD' identified by GUID '4abcd453c6bc6fc1ffd3a58849d5ba41' in state
  'ONLINE' contains nodes 'cuj1234' and no disk</code></pre></div>
                              <p>Update the checkpoint with this information, and copy it to the rest of the nodes in the cluster.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Update the Grid Plug and Play profile and set <code class="codeph">ext_mode</code> to TRUE using the following commands:</span><div><pre class="pre codeblock"><code>$ cd <span class="variable" translate="no">$Grid_home</span>/gpnp/<span class="variable" translate="no">host_name</span>/profiles/peer

$ gpnptool getpval -p=profile.xml -prf_sq -o=temp_file // run_gpnptool_getpval()
$ gpnptool edit -p=profile.xml -asm_ext="" prf_sq=seq+1 -o=profile_ext.xml</code></pre><div class="infoboxnote" id="GUID-D4B24433-6E47-450D-AE7B-76B8E5D95B1D__GUID-E1D682BC-130A-4712-ADFF-FAE9E5691E31">
                                 <p class="notep1">Note:</p>The value of <code class="codeph">prf_sq</code> must be greater than what is in the current profile for the <code class="codeph">ProfileSequence</code> key.
                              </div><pre class="pre codeblock"><code>$ gpnptool sign -p=profile_ext.xml -o=profile_ext_sign.xml
$ mv profile_ext_sign.xml profile.xml
$ gpnptool put -p=profile.xml</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Add sites to the local configuration, as follows:</span><div><pre class="pre codeblock"><code>$ crsctl add crs site <span class="variable" translate="no">site_name</span> -guid <span class="variable" translate="no">site_guid</span> -local</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Add sites to the global configuration, as follows (this requires that OCR be running):</span><div><pre class="pre codeblock"><code>$ crsctl add crs site <span class="variable" translate="no">site_name</span> -guid <span class="variable" translate="no">site_guid</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Update the to-site mapping in the local configuration for this node, as follows:</span><div><pre class="pre codeblock"><code>$ crsctl modify cluster site <span class="variable" translate="no">site_name</span> &#x2013;n <span class="variable" translate="no">local_host</span> -local</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Update the node-to-site mapping, as follows:</span><div><pre class="pre codeblock"><code>$ crsctl modify cluster site <span class="variable" translate="no">site_name</span> &#x2013;n <span class="variable" translate="no">host1, host2, ...</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Stop and then start the Oracle High Availability Services stack, as follows:</span><div><pre class="pre codeblock"><code># crsctl stop crs
# crsctl start crs</code></pre></div>
                        </li>
                     </ol>
                     <div class="section">Do the following on the rest of the nodes in the cluster:
                        <ol>
                           <li>
                              <p>Extend the cluster to the specific node, as follows:</p><pre class="pre codeblock"><code>$ rootcrs.sh -converttoextended -site <span class="variable" translate="no">site_name</span></code></pre></li>
                           <li>
                              <p>Ensure that CSS is not running on any remote nodes.</p>
                           </li>
                           <li>
                              <p>Look up new sites and the site GUIDs using the previous checkpoint information.</p>
                           </li>
                           <li>
                              <p>Add sites to the local configuration, as follows:</p><pre class="pre codeblock"><code>$ crsctl add crs site <span class="variable" translate="no">site_name</span> -guid <span class="variable" translate="no">site_guid</span> -local</code></pre></li>
                           <li>
                              <p>Update the to-site mapping in the local configuration for this node, as follows:</p><pre class="pre codeblock"><code>$ crsctl modify cluster site <span class="variable" translate="no">site_name</span> &#x2013;n <span class="variable" translate="no">local_host</span> -local</code></pre></li>
                           <li>
                              <p>Stop and then start the Oracle High Availability Services stack, as follows:</p><pre class="pre codeblock"><code># crsctl stop crs
# crsctl start crs</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">After you finish configuring the Oracle Extended Cluster, run the following command to verify the configuration:<pre class="pre codeblock"><code><span class="bold">$ crsctl get cluster extended</span>
CRS-XXXX: The cluster is 'EXTENDED'

<span class="bold">$ crsctl query cluster site &#x2013;all</span>
Site 'crsclus' identified by '7b7b3bef4c1f5ff9ff8765bceb45433a' is 'ONLINE', and 
contains nodes '', and disks ''.
Site 'ny' identified by '888b3bef4c1f5ff9ff8765bceb45433a' is 'ONLINE', and \
contains nodes 'node1,node2', and disks ''.
Site 'nj' identified by '999b3bef4c1f5ff9ff8765bceb45433a' is 'ONLINE', and \
contains nodes 'node3,node4', and disks ''.</code></pre><p>The output in the preceding command examples is similar to what CRSCTL displays when you run the commands.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>