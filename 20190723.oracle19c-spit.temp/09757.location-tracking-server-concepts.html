<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The Oracle Spatial and Graph location tracking server enables you to define regions, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">
      <meta name="description" content="The Oracle Spatial and Graph location tracking server enables you to define regions, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">
      <title>Location Tracking Server</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Developer's Guide ">
      <meta property="og:description" content="The Oracle Spatial and Graph location tracking server enables you to define regions, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="spatial-and-graph-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-10T14:11:51-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E94799-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="lrs-linear-referencing-system-concepts.html" title="Previous" type="text/html">
      <link rel="next" href="spatial-analysis-mining.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Spatial and Graph Developer's Guide">
    <meta name="dcterms.isVersionOf" content="SPATL">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="lrs-linear-referencing-system-concepts.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="spatial-analysis-mining.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="spatial-concepts-usage.html" property="item" typeof="WebPage"><span property="name">  Conceptual and Usage Information </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Location Tracking Server</li>
            </ol>
            <a id="GUID-44411566-DA36-4C87-8412-5CEEE6A70518" name="GUID-44411566-DA36-4C87-8412-5CEEE6A70518"></a>
            
            <h2 id="SPATL-GUID-44411566-DA36-4C87-8412-5CEEE6A70518" class="sect2"><span class="enumeration_chapter">8 </span>Location Tracking Server
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The Oracle Spatial and Graph location tracking server enables you to define regions, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.</p>
               <p><a id="d66206e49" class="indexterm-anchor"></a>For reference information about location tracking PL/SQL subprograms, see <a href="SDO_TRKR-reference.html#GUID-EDDAAD84-8633-4E5F-8770-CB323CCD61E0" title="The MDSYS.SDO_TRKR package contains subprograms for using the location tracking server.">SDO_TRKR Package (Location Tracking)</a>.
               </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="location-tracking-server-concepts.html#GUID-3C072452-0300-4B91-9C30-B34FE0069F2D">About the Location Tracking Server</a><br>As location becomes an increasingly important aspect of our lives, and as  location-sensing devices become ubiquitous, there is an increasing demand for applications to be able to monitor subscriber location data continuously. The monitoring of the location data may translate into alerts being generated in the system. 
                  </li>
                  <li class="ulchildlink"><a href="location-tracking-server-concepts.html#GUID-B753991F-E9DD-4F7F-8579-755094480C2C">Location Tracking Set</a><br>The location tracking server tracks a set of moving objects against a known set of regions and generates notifications as required. In this framework, the set of objects and regions is referred to as a <span class="bold">tracking set</span>.
                  </li>
                  <li class="ulchildlink"><a href="location-tracking-server-concepts.html#GUID-7A488F8D-E8F9-4E60-B4BC-B0E82A8BF858">Data Types for the Location Tracking Server</a><br>The PL/SQL subprograms associated with location tracking have parameters of data types that are specific to the location tracking server.
                  </li>
                  <li class="ulchildlink"><a href="location-tracking-server-concepts.html#GUID-209F22A6-F656-4560-82C2-1FEB6AD399E8">Data Structures for the Location Tracking Server</a><br>The location tracking server requires the user to specify a tracking set name when the server is created. Based on this name, additional data structures are created.
                  </li>
                  <li class="ulchildlink"><a href="location-tracking-server-concepts.html#GUID-B2B8CA71-2754-4A47-B130-5504471FE2F9">Workflow for the Location Tracking Server</a><br>The typical location tracking workflow involves several operations, some required and others optional.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="spatial-concepts-usage.html#GUID-EEEED709-34A1-46EA-9AF3-869FD06E3076">Conceptual and Usage Information</a></p>
                  </div>
               </div>
            </div>
            
            <div class="props_rev_3"><a id="GUID-3C072452-0300-4B91-9C30-B34FE0069F2D" name="GUID-3C072452-0300-4B91-9C30-B34FE0069F2D"></a><h3 id="SPATL-GUID-3C072452-0300-4B91-9C30-B34FE0069F2D" class="sect3"><span class="enumeration_section">8.1 </span>About the Location Tracking Server
               </h3>
               <div>
                  <p>As location becomes an increasingly important aspect of our lives, and as  location-sensing devices become ubiquitous, there is an increasing demand for applications to be able to monitor subscriber location data continuously. The monitoring of the location data may translate into alerts being generated in the system. </p>
                  <p>For example, a trucking company may want to monitor its network of 10,000 trucks as they move along their specified routes towards their destinations. They may want to track the movement of trucks within a specified range of the route and expect notifications to be generated to detect undesirable deviations the vehicles from their desired routes. Proactive location-based services (LBSs) generalize such applications that track locations of subscribers inside or outside a specified region for various purposes, such as location-based advertising and notifications about friends nearby.</p>
                  <p>The Oracle Spatial and Graph location tracking server provides:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>A simple framework for setting up a <span class="italic">location tracking network</span> within the database through a PL/SQL interface
                        </p>
                     </li>
                     <li>
                        <p>An API for continuous location monitoring of objects within a tracking network</p>
                     </li>
                     <li>
                        <p>A queuing mechanism for incoming location updates and tracking requests and for outgoing relevant notifications, using Oracle Advanced Queuing</p>
                     </li>
                     <li>
                        <p>Efficient, continuous location monitoring for thousands of relevant objects within the database</p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="location-tracking-server-concepts.html#GUID-44411566-DA36-4C87-8412-5CEEE6A70518" title="The Oracle Spatial and Graph location tracking server enables you to define regions, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">Location Tracking Server</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-B753991F-E9DD-4F7F-8579-755094480C2C" name="GUID-B753991F-E9DD-4F7F-8579-755094480C2C"></a><h3 id="SPATL-GUID-B753991F-E9DD-4F7F-8579-755094480C2C" class="sect3"><span class="enumeration_section">8.2 </span>Location Tracking Set
               </h3>
               <div>
                  <p>The location tracking server tracks a set of moving objects against a known set of regions and generates notifications as required. In this framework, the set of objects and regions is referred to as a <span class="bold">tracking set</span>.
                  </p>
                  <p>In the database these are managed in a table with two columns:</p><pre class="oac_no_warn" dir="ltr">region_id  NUMBER, 
geometry   SDO_GEOMETRY
</pre><p> REGION_ID is the primary key for this table, and GEOMETRY is the geometry of the tracking region.</p>
                  <p>Several additional structures are created when you create a tracking set. You can create any number of tracking sets, and each tracking set can have thousands of regions. When a region is no longer of interest for tracking purposes, it should be deleted from the tracking regions table.</p>
                  <p>A set of objects to be tracked also needs to be created. Each object must specify an ID for the object and a region ID to specify the region in which this object is tracked. That is, each object can be tracked against one or more tracking regions. An object is created by inserting a tracker message, <code class="codeph">TRACKER_MSG</code>, into a tracking queue.
                  </p>
                  <p>A tracker message object specifies the&nbsp;<code class="codeph">object_id</code>,&nbsp;<code class="codeph">region_id</code>, and <code class="codeph">operation</code>. The <code class="codeph">operation</code> parameter has one of the following string values.
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">I</code>: A notification message is issued every time an object, defined by <code class="codeph">object_id</code>, moves while <span class="bold">inside</span> the region, defined by<code class="codeph"> region_id</code> 
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">O</code>: A  notification message is issued every time an object, defined by <code class="codeph">object_id</code>, moves while <span class="bold">outside</span> the region, defined by <code class="codeph"> region_id</code>. 
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">T</code>: A  notification message is issued only when the object, defined by <code class="codeph">object_id</code>,  <span class="bold">transitions</span> from inside to outside or from outside to inside the region defined by <code class="codeph"> region_id</code>. 
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">D</code>: <span class="bold">Disables</span> the tracking of an object defined by <code class="codeph">object_id</code> in the region defined by <code class="codeph"> region_id</code>. To enable tracking of this object again, another tracking message must be sent.
                        </p>
                     </li>
                  </ul>
                  <p>After the objects are created and tracking regions configured, new location messages for the objects can be sent. As objects move in space, their locations change. Every time a new location message is sent, it is inserted into the location message queue, to be processed by the location tracking server. Location messages are processed and notification messages are generated as required. Applications can monitor the notification queue and process the notification messages whenever new notifications are generated.</p>
                  <p>The following additional grants are required for a user to run the location tracking server.</p><pre class="pre codeblock"><code>GRANT aq_administrator_role, create job, manage scheduler to &lt;USER&gt;; grant execute on dbms_aq to &lt;USER&gt;; 
GRANT execute on dbms_aqadm to &lt;USER&gt;;
GRANT execute on dbms_lock to  &lt;USER&gt;;
GRANT execute on dbms_aqin to  &lt;USER&gt;;
GRANT execute on dbms_aqjms to &lt;USER&gt;; 
</code></pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="location-tracking-server-concepts.html#GUID-44411566-DA36-4C87-8412-5CEEE6A70518" title="The Oracle Spatial and Graph location tracking server enables you to define regions, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">Location Tracking Server</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-7A488F8D-E8F9-4E60-B4BC-B0E82A8BF858" name="GUID-7A488F8D-E8F9-4E60-B4BC-B0E82A8BF858"></a><h3 id="SPATL-GUID-7A488F8D-E8F9-4E60-B4BC-B0E82A8BF858" class="sect3"><span class="enumeration_section">8.3 </span>Data Types for the Location Tracking Server
               </h3>
               <div>
                  <p>The PL/SQL subprograms associated with location tracking have parameters of data types that are specific to the location tracking server.</p>
                  <p>These subprograms are documented in the <a href="SDO_TRKR-reference.html#GUID-EDDAAD84-8633-4E5F-8770-CB323CCD61E0" title="The MDSYS.SDO_TRKR package contains subprograms for using the location tracking server.">SDO_TRKR Package (Location Tracking)</a>. The specific data types have the following definitions:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>LOCATION_MSG</p><pre class="oac_no_warn" dir="ltr">(object_id INTEGER, 
 time      TIMESTAMP, 
 x         NUMBER, 
 y         NUMBER) 
</pre></li>
                     <li>
                        <p>LOCATION_MSG_ARR</p><pre class="oac_no_warn" dir="ltr">VARRAY(1000) of location_msg</pre></li>
                     <li>
                        <p>LOCATION_MSG_PKD</p><pre class="oac_no_warn" dir="ltr">object(arr location_msg_arr)</pre></li>
                     <li>
                        <p>NOTIFICATION_MSG</p><pre class="oac_no_warn" dir="ltr">(object_id INTEGER, 
 region_id INTEGER, 
 time      TIMESTAMP,
 x         NUMBER,
 y         NUMBER,
 state     VARCHAR2(8))
</pre></li>
                     <li>
                        <p>PROC_MSG</p><pre class="oac_no_warn" dir="ltr">(object_id  INTEGER, 
 time       TIMESTAMP, 
 x          NUMBER, 
 y          NUMBER, 
 region_id  INTEGER,
 alert_when VARCHAR2(2)) 
</pre></li>
                     <li>
                        <p>PROC_MSG_ARR</p><pre class="oac_no_warn" dir="ltr">VARRAY(1000) of proc_msg</pre></li>
                     <li>
                        <p>PROC_MSG_PKD</p><pre class="oac_no_warn" dir="ltr">object(arr proc_msg_arr)</pre></li>
                     <li>
                        <p>TRACKER_MSG</p><pre class="oac_no_warn" dir="ltr">(object_id INTEGER,
 region_id INTEGER,
 operation VARCHAR2(2)) 
</pre></li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="location-tracking-server-concepts.html#GUID-44411566-DA36-4C87-8412-5CEEE6A70518" title="The Oracle Spatial and Graph location tracking server enables you to define regions, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">Location Tracking Server</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-209F22A6-F656-4560-82C2-1FEB6AD399E8" name="GUID-209F22A6-F656-4560-82C2-1FEB6AD399E8"></a><h3 id="SPATL-GUID-209F22A6-F656-4560-82C2-1FEB6AD399E8" class="sect3"><span class="enumeration_section">8.4 </span>Data  Structures for the Location Tracking Server
               </h3>
               <div>
                  <p>The location tracking server requires the user to specify a tracking set name when the server is created. Based on this name, additional data structures are created.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="bold"><span class="italic">&lt;TS_NAME&gt;</span>_TRACKING_REGIONS</span> (region_id NUMBER, geometry  MDSYS.SDO_GEOMETRY) is a table containing the tracking region polygons defined in the tracking set &lt;TS_NAME&gt;. Users must insert the polygons into this table after the server is created. All of the polygons must be geodetic (using SRID 8307) and two dimensional. The table has a primary key defined on the REGION_ID column. 
                        </p>
                     </li>
                     <li>
                        <p><span class="bold"><span class="italic">&lt;TS_NAME&gt;</span>_TRACKER</span> (object_id NUMBER, region_id NUMBER, queue_no NUMBER,  alert_when VARCHAR2(2)) is a table whose entries map the relationship between an object and a region in which the object is tracked. The table has a primary key defined on the OBJECT_ID and REGION_ID columns. This table is managed using the TRACKER_MSG type; users should not update this table directly.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold"><span class="italic">&lt;TS_NAME&gt;</span>_TRACKER_QUEUES</span>(num_loc_queues NUMBER, num_trkr_queues NUMBER) is a table that holds queue information needed by the server. The server populates and maintains this table; users should never modify this table.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold"><span class="italic">&lt;TS_NAME&gt;</span>_TRACKER_LOG</span> (message_level VARCHAR2(1), message VARCHAR2(512), ts TIMESTAMP WITH TIMEZONE) is a table containing log messages generated by the server. Message leve l‘I’ indicates an informational message, and message level ‘E’ indicates an error message. This table is not dropped when the tracking set is dropped. However, if a tracking set of the same name is then created, this table is truncated and reused by the new tracking set.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold"><span class="italic">&lt;TS_NAME&gt;</span>_NOTIFICATIONS</span> (object_id NUMBER, region_id NUMBER, time TIMESTAMP, x NUMBER, y NUMBER, state VARCHAR2(8)) is an auxiliary table provided to users to store messages from the notifications queue. The layout of columns in this table match that of the NOTIFICATION_MSG type. The X and Y columns are the coordinate that prompted the notification for object_id in region_id at the time. The STATE column shows if the point INSIDE or OUTSIDE the region. For tracking types INSIDE and OUTSIDE this value never changes. For tracking type TRANSITION this column is the state of the object at the time it generated the notification.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold"><span class="italic">&lt;TS_NAME&gt;</span>_TRAJECTORY</span> is an auxiliary table not currently used by the location tracking server.
                        </p>
                     </li>
                  </ul>
                  <p>In addition to these tables, the location tracking server also creates a set of Advanced Queuing (AQ) objects for managing the location, tracking and notification messages. All of the queues have a prefix of <span class="italic">&lt;TS_NAME&gt;</span>, for example. <span class="italic">&lt;TS_NAME&gt;</span>_TRACKER_Q_1 and <span class="italic">&lt;TS_NAME&gt;</span>_LOCATION_Q_1.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="location-tracking-server-concepts.html#GUID-44411566-DA36-4C87-8412-5CEEE6A70518" title="The Oracle Spatial and Graph location tracking server enables you to define regions, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">Location Tracking Server</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-B2B8CA71-2754-4A47-B130-5504471FE2F9" name="GUID-B2B8CA71-2754-4A47-B130-5504471FE2F9"></a><h3 id="SPATL-GUID-B2B8CA71-2754-4A47-B130-5504471FE2F9" class="sect3"><span class="enumeration_section">8.5 </span>Workflow for the Location Tracking Server
               </h3>
               <div>
                  <p>The typical location tracking workflow involves several operations, some required and others optional.</p>
                  <p>The typical  workflow contains several steps:</p>
                  <ol>
                     <li>
                        <p>Create a tracking set.</p>
                     </li>
                     <li>
                        <p>Optionally, show the tracking set tables that were created.</p>
                     </li>
                     <li>
                        <p>Start the tracking set.</p>
                     </li>
                     <li>
                        <p>Optionally, show the queues used by the tracking set.</p>
                     </li>
                     <li>
                        <p>Optionally, show the Scheduler jobs used by the tracking set.</p>
                     </li>
                     <li>
                        <p>Insert polygons for various regions.</p>
                     </li>
                     <li>
                        <p>Create object-region pairs to be tracked.</p>
                     </li>
                     <li>
                        <p>Optionally, show the object-region pairs in the tracking set.</p>
                     </li>
                     <li>
                        <p>Send location messages.</p>
                     </li>
                     <li>
                        <p>Optionally, show the location messages that have been sent.</p>
                     </li>
                     <li>
                        <p>Dequeue the notification messages into the notifications table.</p>
                     </li>
                     <li>
                        <p>Optionally, disable the tracking server's object-region pairs.</p>
                     </li>
                     <li>
                        <p>Stop the tracking set.</p>
                     </li>
                     <li>
                        <p>Drop the tracking set.</p>
                     </li>
                  </ol>
                  <p>The following is a simple example of the location tracking server workflow.</p>
                  <div class="example" id="GUID-B2B8CA71-2754-4A47-B130-5504471FE2F9__GUID-C8F15372-AADD-4000-A777-1661738B1897">
                     <p class="titleinexample">Example 8-1 Location Tracking Server Workflow</p><pre class="pre codeblock"><code>-- Create a tracking set named sample with one tracker/process
-- queue pair and one location queue.
EXEC sdo_trkr.create_tracking_set('sample', 1, 1);

-- Optional: Show the tracking sets tables that were created
SELECT table_name 
FROM user_tables 
WHERE table_name LIKE ‘SAMPLE%’
ORDER BY table_name;

TABLE_NAME
----------------------
SAMPLE_LOCATION_QT_1    - AQ queue table for location queue
SAMPLE_NOTIFICATIONS    - Auxiliary table to store notification messages
SAMPLE_NOTIFICATION_QT  - AQ queue table for the notification queue 	
SAMPLE_PROC_QT_1        - AQ queue table for the process queue
SAMPLE_TRACKER          - Table, will contain object-region tracking pairs
SAMPLE_TRACKER_LOG      - Table, contains log messages from the server 
SAMPLE_TRACKER_QT_1     - AQ queue table for the tracker queue
SAMPLE_TRACKER_QUEUES   - Table, contains tracking sets queue metadata
SAMPLE_TRACKING_REGIONS - Table, will contain the regions geometry
SAMPLE_TRAJECTORY       - Table, currently unused

-- Start the tracking set
EXEC sdo_trkr.start_tracking_set(‘sample’);

-- Optional: Show the queues used by the tracking set
SELECT name
FROM user_queues
WHERE name LIKE 'SAMPLE%'
ORDER BY name;

NAME
---------------------
SAMPLE_LOCATION_Q_1
SAMPLE_NOTIFICATION_Q
SAMPLE_PROC_Q_1
SAMPLE_TRACKER_Q_1

-- Optional: Show the scheduler jobs used by the tracking set
SELECT job_name, state 
FROM user_scheduler_jobs 
WHERE job_name LIKE 'SAMPLE%'
ORDER BY job_name;

JOB_NAME	    STATE
--------------------------
SAMPLE_LOC_JOB_1   RUNNING
SAMPLE_TRKR_JOB_1  RUNNING


-- Insert a polygon for region 1. This polygon must be geodetic (using SRID 8307) 
-- and two dimensional. The region may also be a multi-polygon.
INSERT INTO SAMPLE_TRACKING_REGIONS VALUES (1,
  MDSYS.SDO_GEOMETRY(2003, 8307, null,
    sdo_elem_info_array(1, 1003, 1),
    sdo_ordinate_array(0,0, 5,0, 5,5, 0,5, 0,0)));
-- Create two objects, object 1 and 2 that are tracked in region 1.
-- Object 1 sends notification messages when it is inside region 1. 
-- Object 2 sends notification messages when it is outside region 1.
EXEC sdo_trkr.send_tracking_msg(
  'SAMPLE', mdsys.tracker_msg(1, 1, 'I'));
EXEC sdo_trkr.send_tracking_msg(
  'SAMPLE', mdsys.tracker_msg(2, 1, 'O'));
-- Optional: Show the object-region pairs used in the tracking set
SELECT object_id, region_id, alert_when  FROM sample_tracker;

OBJECT_ID  REGION_ID  ALERT_WHEN
---------- ---------- -----------
     1	         1        I
     2	         1        O

-- Send 2 location messages. Both object 1 and 2 move to (1, 1)
EXEC sdo_trkr.send_location_msgs('SAMPLE',
  mdsys.location_msg_arr(
    mdsys.location_msg(1, '01-AUG-16 01.01.46.000000 PM', 1, 1),
    mdsys.location_msg(2, '01-AUG-16 01.02.46.000000 PM', 8, 8)));

-- Optional: Show that 2 notification message were generated
SELECT a.name, b.ready
FROM user_queues a, v$aq b 
WHERE a.name='SAMPLE_NOTIFICATION_Q' AND a.qid=b.qid
ORDER BY a.name;

NAME                   READY
---------------------- ------
SAMPLE_NOTIFICATION_Q    2

-- Dequeue the notification messages into the notifications table
DECLARE
  message       mdsys.notification_msg;
BEGIN
  LOOP   
    sdo_trkr.get_notification_msg(
      tracking_set_name =&gt; 'SAMPLE', 
      message =&gt; message, 
      deq_wait =&gt;2);	-- wait at most 2 seconds for a message

    IF (message IS NULL) THEN
      EXIT;
    END IF;

    INSERT INTO sample_notifications (
                  object_id, region_id, time, x, y, state) 
      (SELECT message.object_id, message.region_id, 
              message.time, message.x, message.y, message.state);
  END LOOP;
END;
-- Query the object id, region id, (x, y) coordinate and the objects
-- relationship to the region sorted by the time that was sent with
-- the objects location message.
SELECT object_id, region_id, x, y, state 
FROM sample_notifications 
ORDER BY time; 
OBJECT_ID  REGION_ID	X   Y   STATE
---------- ---------- --- --- -------
  1	      1	        1   1   INSIDE
  2	      1	        8   8   OUTSIDE
-- Optional: Disable the tracking server's object-region pairs
EXEC sdo_trkr.send_tracking_msg('SAMPLE', 
  mdsys.tracker_msg(1, 1, 'D'));
EXEC sdo_trkr.send_tracking_msg('SAMPLE', 
  mdsys.tracker_msg(2, 1, 'D'));
-- Stop the tracking set. This stops the tracking sets
-- queues and its scheduler jobs. Running stop_tracking_set 
-- does not delete the tables and queues used by the tracking
-- server so start_tracking_set can be rerun and all of the 
-- object and region data is still available.
-- This must be done before dropping a tracking set
EXEC sdo_trkr.stop_tracking_set('sample');

-- Drop the tracking set. This completely deletes the tracking
-- sets queues and tables. Once completed all traces of the tracking
-- set are removed except for the log table which is left intact for
-- debugging purposes. If another tracking set of the same name is
-- created the log table is truncated.
EXEC sdo_trkr.drop_tracking_set('sample');
</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="location-tracking-server-concepts.html#GUID-44411566-DA36-4C87-8412-5CEEE6A70518" title="The Oracle Spatial and Graph location tracking server enables you to define regions, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">Location Tracking Server</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>