<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Storage of Objects</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Object-Relational Developer's Guide ">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Object-Relational Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="object-relational-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T02:05:10-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96436-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="advanced-topics-for-oracle-objects.html" title="Previous" type="text/html">
      <link rel="next" href="creating-indexes-on-typeids-or-attributes.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Object-Relational Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADOBJ">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="advanced-topics-for-oracle-objects.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="creating-indexes-on-typeids-or-attributes.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Object-Relational Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="advanced-topics-for-oracle-objects.html" property="item" typeof="WebPage"><span property="name"> Advanced Topics for Oracle Objects </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Storage of Objects</li>
            </ol>
            <a id="GUID-F4FCDD3D-31A2-413C-9BB9-D7AB01328BA6" name="GUID-F4FCDD3D-31A2-413C-9BB9-D7AB01328BA6"></a><a id="ADOBJ00601"></a>
            
            <h2 id="ADOBJ-GUID-F4FCDD3D-31A2-413C-9BB9-D7AB01328BA6" class="sect2"><span class="enumeration_section">8.1 </span>Storage of Objects
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle database automatically maps the complex structure of object types into simple table structure for storage.</p>
               <p>Topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="storage-of-objects.html#GUID-E0AEDE3D-8853-4B5C-BF98-7E8F46808A21">Leaf-Level Attributes</a></p>
                  </li>
                  <li>
                     <p><a href="storage-of-objects.html#GUID-CD8D8B75-1BAF-49A4-A544-739E2E6513A8">How Row Objects Are Split Across Columns</a></p>
                  </li>
                  <li>
                     <p><a href="storage-of-objects.html#GUID-1AA0B39D-A5CC-4373-8448-CC335EF85754">Hidden Columns for Tables with Column Objects</a></p>
                  </li>
                  <li>
                     <p><a href="storage-of-objects.html#GUID-349CF29A-7F51-4142-9724-90D5F9CDFD6D">Hidden Columns for Substitutable Columns and Object Tables</a></p>
                  </li>
                  <li>
                     <p><a href="storage-of-objects.html#GUID-24976157-9ADE-43C6-AE1B-E36F4B89859C">Storage of REFs</a></p>
                  </li>
                  <li>
                     <p><a href="storage-of-objects.html#GUID-8FED2189-0699-4F17-9D55-80A372788490">Internal Layout of Nested Tables</a></p>
                  </li>
                  <li>
                     <p><a href="storage-of-objects.html#GUID-4E234EA1-844C-4AC1-842A-78308DC1298E">Internal Layout of VARRAYs</a></p>
                  </li>
               </ul>
            </div><a id="ADOBJ7388"></a><div class="props_rev_3"><a id="GUID-E0AEDE3D-8853-4B5C-BF98-7E8F46808A21" name="GUID-E0AEDE3D-8853-4B5C-BF98-7E8F46808A21"></a><h3 id="ADOBJ-GUID-E0AEDE3D-8853-4B5C-BF98-7E8F46808A21" class="sect3"><span class="enumeration_section">8.1.1 </span>Leaf-Level Attributes
               </h3>
               <div>
                  <p>An object type is like a tree structure, where the branches represent the attributes. Attributes that are objects sprout subbranches with their own attributes.</p>
                  <p>Ultimately, each branch ends at an attribute that is a built-in type; such as <code class="codeph">NUMBER</code>, <code class="codeph">VARCHAR2</code>, or <code class="codeph">REF</code>, or a collection type, such as <code class="codeph">VARRAY</code> or nested table. Each of these leaf-level attributes of the original object type is stored in a table column.
                  </p>
                  <p>Leaf-level attributes that are not collection types are called the <a href="glossary.html#GUID-2AC9D4C9-267C-4CC0-B7ED-D1F58CCAC94E"><span class="xrefglossterm">leaf-level scalar attribute</span></a>s of the object type.
                  </p>
                  <p>The following topics relate to the discussion of object tables and relational tables in <span class="q">"<a href="key-features-object-relational-model.html#GUID-762DBDCA-70C3-4F33-AD03-D51E6151ECC8">How Objects are Stored in Tables </a>"</span>.
                  </p>
               </div>
            </div><a id="ADOBJ7389"></a><div class="props_rev_3"><a id="GUID-CD8D8B75-1BAF-49A4-A544-739E2E6513A8" name="GUID-CD8D8B75-1BAF-49A4-A544-739E2E6513A8"></a><h3 id="ADOBJ-GUID-CD8D8B75-1BAF-49A4-A544-739E2E6513A8" class="sect3"><span class="enumeration_section">8.1.2 </span>How Row Objects Are Split Across Columns
               </h3>
               <div>
                  <p>In an <a href="glossary.html#GUID-C007CD3D-0B4E-4225-886A-FB5632A06707"><span class="xrefglossterm">object table</span></a>, Oracle database stores the data for every leaf-level scalar or <code class="codeph">REF</code> attribute in a separate column. 
                  </p>
                  <div class="infoboxnote" id="GUID-CD8D8B75-1BAF-49A4-A544-739E2E6513A8__GUID-AC1013DA-BDF4-429A-80AB-2A19D98F8319">
                     <p class="notep1">Note:</p>
                     <p>Each <code class="codeph">VARRAY</code> is also stored in a column, unless it is too large. Oracle database stores leaf-level attributes of nested table types in separate tables associated with the object table. You must declare these tables as part of the object table declaration.
                     </p>
                  </div>
                  <p>When you retrieve or change attributes of <a href="glossary.html#GUID-5F88FB08-465A-4974-8A06-4548984982FB"><span class="xrefglossterm">row object</span></a>s in an object table, the database performs the corresponding operations on the columns of the table. Accessing the value of the <a href="glossary.html#GUID-5F88FB08-465A-4974-8A06-4548984982FB"><span class="xrefglossterm">row object</span></a> itself invokes the default constructor for the type, using the columns of the object table as arguments and produces a copy of the object.
                  </p>
                  <p>The database stores the system-generated object identifier in a hidden column. The database uses the object identifier to construct <code class="codeph">REF</code>s to the object.
                  </p>
                  <div class="infoboxnotealso" id="GUID-CD8D8B75-1BAF-49A4-A544-739E2E6513A8__GUID-5170493E-6D80-4092-8596-E6BE7B72BBD0">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="storage-of-objects.html#GUID-4E234EA1-844C-4AC1-842A-78308DC1298E">Internal Layout of VARRAYs</a>"</span></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="storage-of-objects.html#GUID-8FED2189-0699-4F17-9D55-80A372788490">Internal Layout of Nested Tables</a>"</span></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADOBJ7390"></a><div class="props_rev_3"><a id="GUID-1AA0B39D-A5CC-4373-8448-CC335EF85754" name="GUID-1AA0B39D-A5CC-4373-8448-CC335EF85754"></a><h3 id="ADOBJ-GUID-1AA0B39D-A5CC-4373-8448-CC335EF85754" class="sect3"><span class="enumeration_section">8.1.3 </span>Hidden Columns for Tables with Column Objects
               </h3>
               <div>
                  <p>When a table (relational table) is defined with a column of an object type, the database adds hidden columns to the table for the leaf-level attributes of the object type. </p>
                  <p>Each object-type column also has a corresponding hidden column to store the NULL information for the column objects (that is, the atomic nulls of the top-level and the nested objects).</p>
               </div>
            </div><a id="ADOBJ7392"></a><a id="ADOBJ7391"></a><div class="props_rev_3"><a id="GUID-349CF29A-7F51-4142-9724-90D5F9CDFD6D" name="GUID-349CF29A-7F51-4142-9724-90D5F9CDFD6D"></a><h3 id="ADOBJ-GUID-349CF29A-7F51-4142-9724-90D5F9CDFD6D" class="sect3"><span class="enumeration_section">8.1.4 </span>Hidden Columns for Substitutable Columns and Object Tables
               </h3>
               <div>
                  <p>A substitutable column or object table has a hidden column not only for each attribute of the object type of the column but also for each attribute added in any subtype of the object type.</p>
                  <p>Hidden columns store the values of those attributes for any subtype instances inserted in the substitutable column.</p>
                  <p>Besides the type-discriminant column and the null-image column, the following are associated with a substitutable column of <code class="codeph">person_typ</code>, created by <a href="storage-of-objects.html#GUID-349CF29A-7F51-4142-9724-90D5F9CDFD6D__CJGBCCID">Example 8-1</a></p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>A hidden column for each of the attributes of <code class="codeph">person_typ</code>: <code class="codeph">idno</code>, <code class="codeph">name</code>, and <code class="codeph">phone</code></p>
                     </li>
                     <li>
                        <p>Hidden columns for attributes of the subtypes of <code class="codeph">person_typ</code></p>
                     </li>
                  </ul>
                  <p>Thus, the following might be associated with a substitutable column of <code class="codeph">person_typ</code>: the attributes <code class="codeph">dept_id</code> and <code class="codeph">major</code> (for <code class="codeph">student_typ</code>) and <code class="codeph">number_hours</code> (for <code class="codeph">part_time_student_typ</code>).
                  </p>
                  <p>When you create a subtype, the database automatically adds hidden columns for new attributes in the subtype to tables containing a substitutable column of any of the ancestor types of the new subtype. These retrofit the tables to store data of the new type. If, for some reason, the columns cannot be added, creation of the subtype is rolled back. </p>
                  <p>When you drop a subtype using <code class="codeph">DROP TYPE</code> with the <code class="codeph">VALIDATE</code> option, the database automatically drops hidden columns for attributes unique to the subtype that do not contain data. Errors are raised if these columns contain data.
                  </p>
                  <p><a href="storage-of-objects.html#GUID-349CF29A-7F51-4142-9724-90D5F9CDFD6D__CJGBCCID">Example 8-1</a> creates types needed for related examples.
                  </p>
                  <div class="example" id="GUID-349CF29A-7F51-4142-9724-90D5F9CDFD6D__CJGBCCID">
                     <p class="titleinexample">Example 8-1 Creating Types and Inserting in Tables</p><pre class="oac_no_warn" dir="ltr">-- drop any of these objects created for Ex.7-10
CREATE TYPE person_typ AS OBJECT (
  idno           NUMBER,
  name           VARCHAR2(30),
  phone          VARCHAR2(20),
  MAP MEMBER FUNCTION get_idno RETURN NUMBER )
  NOT FINAL;
/
CREATE TYPE BODY person_typ AS
  MAP MEMBER FUNCTION get_idno RETURN NUMBER IS
  BEGIN
    RETURN idno;
  END;
END;
/
CREATE TYPE student_typ UNDER person_typ (
    dept_id NUMBER,
    major VARCHAR2(30))
NOT FINAL;
/
CREATE TYPE part_time_student_typ UNDER student_typ (
  number_hours NUMBER);
/
CREATE TYPE employee_typ UNDER person_typ (
    emp_id NUMBER, 
    mgr VARCHAR2(30));
/
CREATE TABLE person_obj_table OF person_typ;  // an object table
INSERT INTO person_obj_table 
  VALUES (person_typ(12, 'Bob Jones', '650-555-0130'));
INSERT INTO person_obj_table 
  VALUES (student_typ(51, 'Joe Lane', '1-650-555-0140', 12, 'HISTORY'));
INSERT INTO person_obj_table 
  VALUES (part_time_student_typ(52, 'Kim Patel', '1-650-555-0135', 14,
          'PHYSICS', 20));
</pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <p>Substitutable columns are associated with hidden type-discriminant columns. The hidden columns contains an identifier, called a typeid, that identifies the most specific type of each object in the substitutable columns. Typically, a typeid (<code class="codeph">RAW</code>) is one byte, though it can be as big as four bytes for a large hierarchy. 
                     </p>
                     <p>You can find the typeid of a specified object instance using the function <code class="codeph">SYS_TYPEID</code>. 
                     </p>
                     <p><a href="storage-of-objects.html#GUID-D01B6B39-C64E-4955-B022-D6D8FD6B91B9__CHDICDCE">Example 8-2</a> retrieves typeids of object instances stored in the substitutable object table created in <a href="storage-of-objects.html#GUID-349CF29A-7F51-4142-9724-90D5F9CDFD6D__CJGBCCID">Example 8-1</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADOBJ7654"></a><div class="props_rev_3"><a id="GUID-D01B6B39-C64E-4955-B022-D6D8FD6B91B9" name="GUID-D01B6B39-C64E-4955-B022-D6D8FD6B91B9"></a><h3 id="ADOBJ-GUID-D01B6B39-C64E-4955-B022-D6D8FD6B91B9" class="sect3"><span class="enumeration_section">8.1.5 </span>Querying for Typeids of Objects Stored in Tables
               </h3>
               <div>
                  <div class="section">
                     <p>You can retrieve typeids of object instances stored in a substitutable object table. See <a href="storage-of-objects.html#GUID-D01B6B39-C64E-4955-B022-D6D8FD6B91B9__CHDICDCE">Example 8-2</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-D01B6B39-C64E-4955-B022-D6D8FD6B91B9__CHDICDCE">
                     <p class="titleinexample">Example 8-2 Querying for Typeids of Objects Stored in the Table</p><pre class="oac_no_warn" dir="ltr">-- Requires Ex. 8-1
SELECT name, <span class="bold">SYS_TYPEID</span>(VALUE(p)) typeid 
  FROM person_obj_table p;
</pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <p>Output:</p><pre class="pre codeblock"><code>NAME                           TYPEID
------------------------------ ---------------------------
Bob Jones                      01
Joe Lane                       02
Kim Patel                      03</code></pre><p>The catalog views <code class="codeph">USER_TYPES</code>, <code class="codeph">DBA_TYPES,</code> and <code class="codeph">ALL_TYPES</code> contain a <code class="codeph">TYPEID</code> column (not hidden) that gives the typeid value for each type. You can join on this column to get the type names corresponding to the typeids in a type-discriminant column. 
                     </p>
                     <div class="infoboxnotealso" id="GUID-D01B6B39-C64E-4955-B022-D6D8FD6B91B9__GUID-FA868184-E0EA-4E6F-864A-04AA53CB5459">
                        <p class="notep1">See Also:</p>
                        <p><span class="q">"<a href="functions-and-operators-useful-with-objects.html#GUID-05C7D6E4-F294-4632-B0B6-F7574DB5CDFE">SYS_TYPEID</a>"</span> for more information about <code class="codeph">SYS_TYPEID</code>, typeids, and type-discriminant columns.
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADOBJ7393"></a><div class="props_rev_3"><a id="GUID-24976157-9ADE-43C6-AE1B-E36F4B89859C" name="GUID-24976157-9ADE-43C6-AE1B-E36F4B89859C"></a><h3 id="ADOBJ-GUID-24976157-9ADE-43C6-AE1B-E36F4B89859C" class="sect3"><span class="enumeration_section">8.1.6 </span>Storage of REFs
               </h3>
               <div>
                  <p>When the database constructs a <code class="codeph">REF</code> to a row object, the constructed <code class="codeph">REF</code> is made up of the object identifier (OID), some metadata of the object table, and, optionally, the <code class="codeph">ROWID</code>. 
                  </p>
                  <p>The size of a <code class="codeph">REF</code> in a column of <code class="codeph">REF</code> type depends on the storage requirements associated with the column, as follows:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If the column is declared as a <code class="codeph">REF</code> <code class="codeph">WITH</code> <code class="codeph">ROWID</code>, the database stores the <code class="codeph">ROWID</code> in the <code class="codeph">REF</code> column. The <code class="codeph">ROWID</code> hint is ignored for object references in constrained <code class="codeph">REF</code> columns. 
                        </p>
                     </li>
                     <li>
                        <p>If a column is declared as a <code class="codeph">REF</code> with a <code class="codeph">SCOPE</code> clause, the column decreases due to the omission of the object table metadata and the <code class="codeph">ROWID</code>. A scoped <code class="codeph">REF</code> is 16 bytes long.
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="ADOBJ7394"></a><div class="props_rev_3"><a id="GUID-8FED2189-0699-4F17-9D55-80A372788490" name="GUID-8FED2189-0699-4F17-9D55-80A372788490"></a><h3 id="ADOBJ-GUID-8FED2189-0699-4F17-9D55-80A372788490" class="sect3"><span class="enumeration_section">8.1.7 </span>Internal Layout of Nested Tables
               </h3>
               <div>
                  <p>The rows of a nested table are stored in a separate storage table. Each nested table column has a single associated storage table. The storage table holds all the elements for all of the nested tables in that column. The storage table has a hidden <code class="codeph">NESTED_TABLE_ID</code> column with a system-generated value that lets Oracle database map the nested table elements back to the appropriate row. 
                  </p>
                  <p>You can speed up queries that retrieve entire collections by making the storage table index-organized. Include the <code class="codeph">ORGANIZATION&nbsp;INDEX</code> clause inside the <code class="codeph">STORE&nbsp;AS</code> clause.
                  </p>
                  <p>A nested table type can contain objects or scalars:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If the elements are objects, the storage table is like an object table: the top-level attributes of the object type become the columns of the storage table. However, you cannot construct <code class="codeph">REF</code>s to objects in a nested table because a nested table row has no object identifier column.
                        </p>
                     </li>
                     <li>
                        <p>If the elements are scalars, the storage table contains a single column called <code class="codeph">COLUMN_VALUE</code> that contains the scalar values.
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-8FED2189-0699-4F17-9D55-80A372788490__GUID-06F7880A-AB19-403E-9851-89DD96F34C4C">
                     <p class="notep1">See Also:</p>
                     <p>See <span class="q">"<a href="design-considerations-for-collections.html#GUID-474BD701-F7A2-435B-AE93-00B5B3AD974B">Nested Table Storage</a>"</span>.
                     </p>
                  </div>
               </div>
            </div><a id="ADOBJ7395"></a><div class="props_rev_3"><a id="GUID-4E234EA1-844C-4AC1-842A-78308DC1298E" name="GUID-4E234EA1-844C-4AC1-842A-78308DC1298E"></a><h3 id="ADOBJ-GUID-4E234EA1-844C-4AC1-842A-78308DC1298E" class="sect3"><span class="enumeration_section">8.1.8 </span>Internal Layout of VARRAYs
               </h3>
               <div>
                  <p>All the elements of a <code class="codeph">VARRAY</code> are stored in a single column. Depending upon the size of the array, it may be stored inline or in a <code class="codeph">BLOB</code>. 
                  </p>
                  <div class="infoboxnotealso" id="GUID-4E234EA1-844C-4AC1-842A-78308DC1298E__GUID-624DF323-4AD8-4D01-8963-37CA86E8DAE8">
                     <p class="notep1">See Also:</p>
                     <p>See <a href="design-considerations-for-collections.html#GUID-92C119FE-CB10-485F-B3E9-C6DE56594650">Storage Considerations for Varrays</a> for details.
                     </p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>