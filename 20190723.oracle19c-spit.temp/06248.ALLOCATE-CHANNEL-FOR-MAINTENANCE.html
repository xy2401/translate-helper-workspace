<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>ALLOCATE CHANNEL FOR MAINTENANCE</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Backup and Recovery Reference">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Backup and Recovery Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-backup-and-recovery-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T19:31:58-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96242-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="ALLOCATE-CHANNEL.html" title="Previous" type="text/html">
      <link rel="next" href="BACKUP.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery Reference">
    <meta name="dcterms.isVersionOf" content="RCMRF">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="ALLOCATE-CHANNEL.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="BACKUP.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Backup and Recovery Reference</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="rman-commands-at-sign-to-quit.html" property="item" typeof="WebPage"><span property="name"> RMAN Commands: @ (at sign) to QUIT</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">ALLOCATE CHANNEL FOR MAINTENANCE</li>
            </ol>
            <a id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824" name="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824"></a><a id="RCMRF89998"></a><a id="RCMRF89999"></a><a id="RCMRF90000"></a><a id="RCMRF90001"></a><a id="RCMRF90002"></a><a id="RCMRF103"></a>
            
            <h2 id="RCMRF-GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824" class="sect2"><span class="enumeration_section">2.5 </span>ALLOCATE CHANNEL FOR MAINTENANCE
            </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-F7BA6E80-B2E1-40DF-A9C8-ABC0A1D8E7A0">Purpose</p>
                  <p>Use the <code class="codeph">ALLOCATE CHANNEL FOR MAINTENANCE</code> command to manually allocate a channel in preparation for issuing a <code class="codeph"><a href="CHANGE.html#GUID-961151C6-EEFF-4347-AF1E-93EFDD5F5BF2">CHANGE</a></code>, <code class="codeph"><a href="DELETE.html#GUID-FB4EAC69-4978-42F7-8B09-77C6736188B3">DELETE</a></code>, or <code class="codeph"><a href="CROSSCHECK.html#GUID-07E07E7E-9A29-4901-9739-FFC472029A7D">CROSSCHECK</a></code> command. You can use the <code class="codeph"><a href="RELEASE-CHANNEL.html#GUID-E5B046B9-FE5E-46B4-ABDB-455DB433AECD">RELEASE CHANNEL</a></code> command to unallocate the channel.
                  </p>
                  <div class="infoboxnote" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-6E2C43B2-4DDE-42ED-B242-E120552FDE07">
                     <p class="notep1">Note:</p>
                     <p>If you <code class="codeph"><a href="CONFIGURE.html#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code> at least one channel for each device type in your configuration, then you do not need to use <code class="codeph">ALLOCATE CHANNEL FOR MAINTENANCE</code>. Oracle recommends that you use configured channels instead of maintenance channels. You can use configured channels for all RMAN I/O to the specified device, not just the maintenance tasks supported by maintenance channels. The configured channels persist across RMAN sessions.
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-313B4CC3-D28A-4362-A7F9-D1827F35D227">Prerequisites</p>
                  <p>Execute this command only at the RMAN prompt, not within a <code class="codeph">RUN</code> block. The target instance must be started. You cannot allocate a maintenance channel to a shared session.<a id="d11611e143" class="indexterm-anchor"></a><a id="d11611e145" class="indexterm-anchor"></a><a id="d11611e149" class="indexterm-anchor"></a></p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-4058161B-568C-439C-8122-3776392A507A">Usage Notes</p>
                  <p>As a rule, allocate one maintenance channel for each device. Manually allocated channels and automatic channels are never mixed. In general, allocate multiple maintenance channels for a single job only in these situations:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a id="d11611e161" class="indexterm-anchor"></a><a id="d11611e165" class="indexterm-anchor"></a><a id="d11611e169" class="indexterm-anchor"></a><a id="d11611e173" class="indexterm-anchor"></a><a id="d11611e177" class="indexterm-anchor"></a>To enable cross-checking or deletion of all backup pieces both on disk and tape, with a single command (see <a href="ALLOCATE-CHANNEL-FOR-MAINTENANCE.html#GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__CHDGBFJH">Example 2-11</a>)
                        </p>
                     </li>
                     <li>
                        <p>To make cross-checking and deleting work correctly in an Oracle Real Application Clusters (Oracle RAC) configuration in which each backup piece exists only on one node (see <a href="ALLOCATE-CHANNEL-FOR-MAINTENANCE.html#GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__CHDCJABF">Example 2-12</a>)
                        </p>
                     </li>
                  </ul>
                  <p>RMAN uses the following convention for naming of maintenance channels: <code class="codeph">ORA_MAINT_</code><span class="italic"><code class="codeph">devicetype</code></span><code class="codeph">_</code><span class="italic"><code class="codeph">n</code></span>, where <span class="italic"><code class="codeph">devicetype</code></span> refers to <code class="codeph">DISK</code> or <code class="codeph">sbt</code> and <span class="italic"><code class="codeph">n</code></span> refers to the channel number. For example, RMAN uses these names for two manually allocated disk channels:
                  </p><pre class="oac_no_warn" dir="ltr">ORA_MAINT_DISK_1
ORA_MAINT_DISK_2</pre><div class="infoboxnotealso" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-CD45A8C3-B469-482D-A2D9-F3C778BF51CF">
                     <p class="notep1">See Also:</p>
                     <p> <a href="../bradv/maintaining-rman-backups.html#BRADV-GUID-E1D38362-4C8E-4F16-AEBF-6A6429D7BB3A" target="_blank"><span><cite>Oracle Database Backup and Recovery Userâ€™s Guide</cite></span></a>to learn how to cross-check and delete on multiple channels
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-E6D12C02-2E2C-43AC-A022-55D006ACB788">Syntax</p>
                  <p><span class="bold"><span class="italic">allocateForMaint::=</span></span></p>
                  <div class="figure" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-FB343E34-42EF-4A08-B68E-B150B1FC9587"><img src="img/allocateformaint.gif" alt="Description of allocateformaint.eps follows" title="Description of allocateformaint.eps follows" longdesc="img_text/allocateformaint.html"><br><a href="img_text/allocateformaint.html">Description of the illustration allocateformaint.eps</a></div>
                  <!-- class="figure" -->
                  <p>(<span class="italic"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC__BABDEJAC">deviceSpecifier::=</a></span>, <span class="italic"><a href="allocOperandList.html#GUID-8B6C1DAB-F27A-4DA8-BECC-5DA04F5907DA__BABFFJCH">allocOperandList::=</a></span>)
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-F2B24F17-31AC-4E2F-B59A-F46ACF4032B3">Semantics</p>
                  <p id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__CHDHDJFB"><span class="bold"><span class="italic">allocateForMaint</span></span></p>
                  <div class="tblformalwide" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-387C7C8D-8803-4B66-870E-7164A9AE20D5">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" summary="Describes ALLOCATE CHANNEL FOR MAINTENANCE command parameters" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="27%" id="d11611e263">Syntax Element</th>
                              <th align="left" valign="bottom" width="73%" id="d11611e266">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d11611e271" headers="d11611e263 "><code class="codeph">DEVICE&nbsp;TYPE</code> <span class="italic"><code class="codeph"><span class="codeinlineitalic"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></span></code></span></td>
                              <td align="left" valign="top" width="73%" headers="d11611e271 d11611e266 ">
                                 <p>Specifies the type of storage for a backup. Query the <a id="d11611e284" class="indexterm-anchor"></a><code class="codeph">V$BACKUP_DEVICE</code> view for information about available device types and names.
                                 </p>
                                 <p><span class="bold">See Also:</span> <span class="italic"><code class="codeph"><span class="codeinlineitalic"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></span></code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="27%" id="d11611e300" headers="d11611e263 ">
                                 <p><code class="codeph">&nbsp;&nbsp;&nbsp;</code><span class="italic"><code class="codeph"><span class="codeinlineitalic"><a href="allocOperandList.html#GUID-8B6C1DAB-F27A-4DA8-BECC-5DA04F5907DA">allocOperandList</a></span></code></span></p>
                              </td>
                              <td align="left" valign="top" width="73%" headers="d11611e300 d11611e266 ">
                                 <p>Specifies control options for the allocated channel. The channel parameters for sequential I/O devices are platform-specific. </p>
                                 <p><span class="bold">See Also:</span> <span class="italic"><code class="codeph"><span class="codeinlineitalic"><a href="allocOperandList.html#GUID-8B6C1DAB-F27A-4DA8-BECC-5DA04F5907DA">allocOperandList</a></span></code></span></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-0708B0B0-F8C5-4E40-86EC-D3DDB0BF332D">Examples</p>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__GUID-D1B36944-C494-4E5B-B5AC-71BFF56A5048">
                  <p class="titleinexample">Example 2-10 Deleting Backup Sets</p>
                  <p>Assume that you want to recycle a set of tapes by deleting all RMAN backups. In this example, only a disk channel is configured by default. The example manually allocates an SBT channel, deletes all backups from tape, and then releases the channel.</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; ALLOCATE CHANNEL FOR MAINTENANCE DEVICE TYPE sbt;
 
allocated channel: ORA_MAINT_SBT_TAPE_1
channel ORA_MAINT_SBT_TAPE_1: SID=135 device type=SBT_TAPE
channel ORA_MAINT_SBT_TAPE_1: Oracle Secure Backup
 
RMAN&gt; DELETE NOPROMPT BACKUP;
 
List of Backup Pieces
BP Key  BS Key  Pc# Cp# Status      Device Type Piece Name
------- ------- --- --- ----------- ----------- ----------
9957    9954    1   1   AVAILABLE   SBT_TAPE    8oic41ad_1_1
9974    9972    1   1   AVAILABLE   SBT_TAPE    c-28014364-20130308-17
10024   10021   1   1   AVAILABLE   SBT_TAPE    8qic41c3_1_1
10045   10042   1   1   AVAILABLE   SBT_TAPE    c-28014364-20130308-18
10446   10443   1   1   AVAILABLE   SBT_TAPE    8uic47fg_1_1
10487   10482   1   1   AVAILABLE   SBT_TAPE    90ic47ih_1_1
10488   10483   1   1   AVAILABLE   SBT_TAPE    91ic47j1_1_1
10524   10514   1   1   AVAILABLE   SBT_TAPE    92ic47q4_1_1
10540   10538   1   1   AVAILABLE   SBT_TAPE    c-28014364-20130308-1a
deleted backup piece
backup piece handle=8oic41ad_1_1 RECID=198 STAMP=616695118
deleted backup piece
backup piece handle=c-28014364-20130308-17 RECID=199 STAMP=616695145
deleted backup piece
backup piece handle=8qic41c3_1_1 RECID=200 STAMP=616695171
deleted backup piece
backup piece handle=c-28014364-20130308-18 RECID=201 STAMP=616695188
deleted backup piece
backup piece handle=8uic47fg_1_1 RECID=204 STAMP=616701424
deleted backup piece
backup piece handle=90ic47ih_1_1 RECID=205 STAMP=616701521
deleted backup piece
backup piece handle=91ic47j1_1_1 RECID=206 STAMP=616701538
deleted backup piece
backup piece handle=92ic47q4_1_1 RECID=207 STAMP=616701764
deleted backup piece
backup piece handle=c-28014364-20130308-1a RECID=208 STAMP=616701783
Deleted 11 objects
 
RMAN&gt; RELEASE CHANNEL;
 
released channel: ORA_MAINT_SBT_TAPE_1</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__CHDGBFJH">
                  <p class="titleinexample">Example 2-11 Cross-Checking Backups on Multiple Devices</p>
                  <p>Assume that you want to cross-check backups of archived redo log files on disk and tape. Assume also that you have the default device type configured to disk, and also have an SBT channel configured, but you want to use different channel settings for both disk and tape. In this case, you can manually allocate maintenance channels with the desired settings.</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; SHOW DEFAULT DEVICE TYPE;
 
RMAN configuration parameters for database with db_unique_name PROD are:
CONFIGURE DEFAULT DEVICE TYPE TO DISK;
 
RMAN&gt; SHOW CHANNEL;
 
RMAN configuration parameters for database with db_unique_name PROD are:
CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS  'SBT_LIBRARY=/usr/local/oracle/backup/lib/libobk.so, ENV=(OB_DEVICE_1=stape1)';
 
RMAN&gt; ALLOCATE CHANNEL FOR MAINTENANCE DEVICE TYPE sbt PARMS 'SBT_LIBRARY=/usr/local/oracle/backup/lib/libobk.so, ENV=(OB_DEVICE_1=stape2)';
 
allocated channel: ORA_MAINT_SBT_TAPE_1
channel ORA_MAINT_SBT_TAPE_1: SID=135 device type=SBT_TAPE
channel ORA_MAINT_SBT_TAPE_1: Oracle Secure Backup
 
RMAN&gt; ALLOCATE CHANNEL FOR MAINTENANCE DEVICE TYPE DISK FORMAT "/disk2/%U";
 
allocated channel: ORA_MAINT_DISK_2
channel ORA_MAINT_DISK_2: SID=101 device type=DISK
 
Finished Control File and SPFILE Autobackup at 09-MAR-13
 
RMAN&gt; CROSSCHECK BACKUP OF ARCHIVELOG ALL;
 
crosschecked backup piece: found to be 'AVAILABLE'
backup piece handle=/disk2/95ic69jc_1_1 RECID=210 STAMP=616769132
crosschecked backup piece: found to be 'EXPIRED'
backup piece handle=/disk2/96ic69jf_1_1 RECID=211 STAMP=616769135
Crosschecked 2 objects
 
crosschecked backup piece: found to be 'AVAILABLE'
backup piece handle=/disk2/96ic69jf_1_1 RECID=211 STAMP=616769135
Crosschecked 1 objects
 
 
RMAN&gt; RELEASE CHANNEL;
 
released channel: ORA_MAINT_SBT_TAPE_1
released channel: ORA_MAINT_DISK_2</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-6F9887A0-1D48-4332-8E59-6FA2EFE67824__CHDCJABF">
                  <p class="titleinexample">Example 2-12 Cross-Checking in an Oracle Real Application Clusters (Oracle RAC) Configuration</p>
                  <p><a id="d11611e344" class="indexterm-anchor"></a><a id="d11611e348" class="indexterm-anchor"></a>All nodes in an Oracle RAC configuration should have the same access to all backups on all storage devices, but this is not a requirement. Assume that you want to cross-check backups on two nodes of an Oracle RAC configuration, where each node has access to a subset of disk backups. It is assumed that all backups are accessible by at least a two nodes used in the cross-check. Any backup not accessible from at least one node is marked <code class="codeph">EXPIRED</code> after the cross-check.
                  </p>
                  <p>The following example illustrates channel connections to Oracle RAC instances <code class="codeph">inst1</code> and <code class="codeph">inst2</code>. For both channel connections, RMAN uses the same user name and password that were entered for the target database connection.
                  </p><pre class="oac_no_warn" dir="ltr">ALLOCATE CHANNEL FOR MAINTENANCE DEVICE TYPE DISK 
  CONNECT '@inst1';
ALLOCATE CHANNEL FOR MAINTENANCE DEVICE TYPE DISK 
  CONNECT '@inst2';
CROSSCHECK BACKUP;</pre></div>
               <!-- class="example" -->
            </div>
         </div>
      </article>
   </body>
</html>