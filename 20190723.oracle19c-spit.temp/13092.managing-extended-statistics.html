<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="DBMS_STATS enables you to collect extended statistics, which are statistics that can improve cardinality estimates when multiple predicates exist on different columns of a table, or when predicates use expressions.">
      <meta name="description" content="DBMS_STATS enables you to collect extended statistics, which are statistics that can improve cardinality estimates when multiple predicates exist on different columns of a table, or when predicates use expressions.">
      <title>Managing Extended Statistics</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Tuning Guide">
      <meta property="og:description" content="DBMS_STATS enables you to collect extended statistics, which are statistics that can improve cardinality estimates when multiple predicates exist on different columns of a table, or when predicates use expressions.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Tuning Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-tuning-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-31T14:57:08-08:00">
      <meta name="dcterms.title" content="SQL Tuning Guide">
      <meta name="dcterms.dateCopyrighted" content="2013, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96095-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="gathering-optimizer-statistics.html" title="Previous" type="text/html">
      <link rel="next" href="controlling-the-use-of-optimizer-statistics.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGSQL">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="gathering-optimizer-statistics.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="controlling-the-use-of-optimizer-statistics.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Tuning Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="optimizer-statistics.html" property="item" typeof="WebPage"><span property="name">Optimizer Statistics</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Managing Extended Statistics</li>
            </ol>
            <a id="GUID-BD0F0B71-DD8B-44A0-888E-495830FC09A4" name="GUID-BD0F0B71-DD8B-44A0-888E-495830FC09A4"></a>
            
            <h2 id="TGSQL-GUID-BD0F0B71-DD8B-44A0-888E-495830FC09A4" class="sect2"><span class="enumeration_chapter">14 </span>Managing Extended Statistics
            </h2>
         </header>
         <div class="ind">
            <div>
               <p><code class="codeph">DBMS_STATS</code> enables you to collect <strong class="term">extended statistics</strong>, which are statistics that can improve cardinality estimates when multiple predicates exist on different columns of a table, or when predicates use expressions. 
               </p>
               <p>An <strong class="term">extension</strong> is either a column group or an expression. Column group statistics can improve cardinality estimates when multiple columns from the same table occur together in a SQL statement. Expression statistics improves optimizer estimates when predicates use expressions, for example, built-in or user-defined functions.
               </p>
               <div class="infoboxnote" id="GUID-BD0F0B71-DD8B-44A0-888E-495830FC09A4__GUID-14612EBF-A23B-4449-98C4-5C39511756BD">
                  <p class="notep1">Note:</p>
                  <p>You cannot create extended statistics on virtual columns.</p>
               </div>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782">Managing Column Group Statistics</a><br>A <strong class="term">column group</strong> is a set of columns that is treated as a unit.
                  </li>
                  <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-FC50E35E-AF6A-4ECD-919D-8E020011DAB6">Managing Expression Statistics</a><br>The type of extended statistics known as <strong class="term">expression statistics</strong> improve optimizer estimates when a <code class="codeph">WHERE</code> clause has predicates that use expressions.
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-BD0F0B71-DD8B-44A0-888E-495830FC09A4__GUID-03123176-F6AC-4529-AF33-8E206EC1A4CF">
                  <p class="notep1">See Also:</p>
                  <p><a href="../sqlrf/CREATE-TABLE.html#SQLRF54467" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for a list of restrictions on virtual columns
                  </p>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="optimizer-statistics.html#GUID-0A2F3D52-A135-43E1-9CAB-55BFE068A297" title="The accuracy of an execution plan depends on the quality of the optimizer statistics.">Optimizer Statistics</a></p>
                  </div>
               </div>
            </div>
            <a id="TGSQL462"></a><div class="props_rev_3"><a id="GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782" name="GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782"></a><h3 id="TGSQL-GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782" class="sect3"><span class="enumeration_section">14.1 </span>Managing Column Group Statistics
               </h3>
               <div>
                  <p>A <strong class="term">column group</strong> is a set of columns that is treated as a unit.
                  </p>
                  <p>Essentially, a column group is a virtual column. By gathering statistics on a column group, the optimizer can more accurately determine the cardinality estimate when a query groups these columns together.</p>
                  <p>The following sections provide an overview of <a href="glossary.html#GUID-FB763B43-B5C7-47D0-8B0D-47CED4922501"><span class="xrefglossterm">column group statistics</span></a>, and explain how to manage them manually:
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-858E0BDA-06C6-471F-B9E8-888C3AD29673">About Statistics on Column Groups</a><br>Individual column statistics are useful for determining the selectivity of a single predicate in a <code class="codeph">WHERE</code> clause. 
                     </li>
                     <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-E1F39134-24F1-4EF7-B614-82F9428CA762">Detecting Useful Column Groups for a Specific Workload</a><br>You can use <code class="codeph">DBMS_STATS.SEED_COL_USAGE</code> and <code class="codeph">REPORT_COL_USAGE</code> to determine which column groups are required for a table based on a specified workload. 
                     </li>
                     <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-783A8687-EDB3-437E-AE99-3F12369BA10A">Creating Column Groups Detected During Workload Monitoring</a><br>You can use the <code class="codeph">DBMS_STATS.CREATE_EXTENDED_STATS</code> function to create column groups that were detected previously by executing <code class="codeph">DBMS_STATS.SEED_COL_USAGE</code>.
                     </li>
                     <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-D070C3B3-C356-4630-8EB3-766A790866F3">Creating and Gathering Statistics on Column Groups Manually</a><br>In some cases, you may know the column group that you want to create.
                     </li>
                     <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-532D06C9-C6A2-4018-B496-AD87003B682E">Displaying Column Group Information</a><br>To obtain the name of a column group, use the <code class="codeph">DBMS_STATS.SHOW_EXTENDED_STATS_NAME</code> function or a database view. 
                     </li>
                     <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-DBBB6C91-4450-457D-A612-71E835D6159C">Dropping a Column Group</a><br>Use the <code class="codeph">DBMS_STATS.DROP_EXTENDED_STATS</code> function to delete a column group from a table.
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782__GUID-D18E04D2-1CD3-45AA-A480-13C2AEBE0DA0">
                     <p class="notep1">See Also:</p>
                     <p><a href="../arpls/DBMS_STATS.html#ARPLS059" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS</code> package
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-BD0F0B71-DD8B-44A0-888E-495830FC09A4" title="DBMS_STATS enables you to collect extended statistics, which are statistics that can improve cardinality estimates when multiple predicates exist on different columns of a table, or when predicates use expressions.">Managing Extended Statistics</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL464"></a><a id="TGSQL463"></a><div class="props_rev_3"><a id="GUID-858E0BDA-06C6-471F-B9E8-888C3AD29673" name="GUID-858E0BDA-06C6-471F-B9E8-888C3AD29673"></a><h4 id="TGSQL-GUID-858E0BDA-06C6-471F-B9E8-888C3AD29673" class="sect4"><span class="enumeration_section">14.1.1 </span>About Statistics on Column Groups
                  </h4>
                  <div>
                     <p>Individual column statistics are useful for determining the selectivity of a single predicate in a <code class="codeph">WHERE</code> clause. 
                     </p>
                     <p>When the <code class="codeph">WHERE</code> clause includes multiple predicates on different columns from the same table, individual column statistics do not show the relationship between the columns. This is the problem solved by a column group.
                     </p>
                     <p>The optimizer calculates the selectivity of the predicates independently, and then combines them. However, if a correlation between the individual columns exists, then the optimizer cannot take it into account when determining a cardinality estimate, which it creates by multiplying the selectivity of each table predicate by the number of rows.</p>
                     <p>The following graphic contrasts two ways of gathering statistics on the <code class="codeph">cust_state_province</code> and <code class="codeph">country_id</code> columns of the <code class="codeph">sh.customers</code> table. The diagram shows <code class="codeph">DBMS_STATS</code> collecting statistics on each column individually and on the group. The column group has a system-generated name.
                     </p>
                     <div class="figure" id="GUID-858E0BDA-06C6-471F-B9E8-888C3AD29673__CHDCHFGJ">
                        <p class="titleinfigure">Figure 14-1 Column Group Statistics</p><img src="img/tgsql_vm_016.png" alt="Description of Figure 14-1 follows" title="Description of Figure 14-1 follows" longdesc="img_text/tgsql_vm_016.html"><br><a href="img_text/tgsql_vm_016.html">Description of "Figure 14-1 Column Group Statistics"</a></div>
                     <!-- class="figure" -->
                     <div class="infoboxnote" id="GUID-858E0BDA-06C6-471F-B9E8-888C3AD29673__GUID-8EF05E98-5277-48C5-AE05-1B4A6706E01C">
                        <p class="notep1">Note:</p>
                        <p>The optimizer uses column group statistics for equality predicates, inlist predicates, and for estimating the <code class="codeph">GROUP BY</code> cardinality.
                        </p>
                     </div>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-F2E85913-120F-4F6A-99AD-D4B221344E7E">Why Column Group Statistics Are Needed: Example</a><br>This example demonstrates how column group statistics enable the optimizer to give a more accurate cardinality estimate.
                        </li>
                        <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-676C7562-09BE-4760-9F62-BB6F18EDB036">Automatic and Manual Column Group Statistics</a><br>Oracle Database can create column group statistics either automatically or manually.
                        </li>
                        <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-0A7D5A85-7813-4803-9BAC-3110B2CFB9E1">User Interface for Column Group Statistics</a><br>Several <code class="codeph">DBMS_STATS</code> program units have preferences that are relevant for column groups.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782" title="A column group is a set of columns that is treated as a unit.">Managing Column Group Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="TGSQL465"></a><div class="props_rev_3"><a id="GUID-F2E85913-120F-4F6A-99AD-D4B221344E7E" name="GUID-F2E85913-120F-4F6A-99AD-D4B221344E7E"></a><h5 id="TGSQL-GUID-F2E85913-120F-4F6A-99AD-D4B221344E7E" class="sect5"><span class="enumeration_section">14.1.1.1 </span>Why Column Group Statistics Are Needed: Example
                     </h5>
                     <div>
                        <p>This example demonstrates how column group statistics enable the optimizer to give a more accurate cardinality estimate.</p>
                        <p>The following query of the <code class="codeph">DBA_TAB_COL_STATISTICS</code> table shows information about statistics that have been gathered on the columns <code class="codeph">cust_state_province</code> and <code class="codeph">country_id</code> from the <code class="codeph">sh.customers</code> table: 
                        </p><pre class="pre codeblock"><code>COL COLUMN_NAME FORMAT a20
COL NDV FORMAT 999

SELECT COLUMN_NAME, NUM_DISTINCT AS "NDV", HISTOGRAM
FROM   DBA_TAB_COL_STATISTICS
WHERE  OWNER = 'SH'
AND    TABLE_NAME = 'CUSTOMERS'
AND    COLUMN_NAME IN ('CUST_STATE_PROVINCE', 'COUNTRY_ID');
</code></pre><p>Sample output is as follows:</p><pre class="pre codeblock"><code>COLUMN_NAME                 NDV HISTOGRAM
-------------------- ---------- ---------------
CUST_STATE_PROVINCE         145 FREQUENCY
COUNTRY_ID                   19 FREQUENCY
</code></pre><p>As shown in the following query, 3341 customers reside in California:</p><pre class="pre codeblock"><code>SELECT COUNT(*)
FROM   sh.customers 
WHERE  cust_state_province = 'CA';

 COUNT(*)
----------
    3341
</code></pre><p>Consider an explain plan for a query of customers in the state <code class="codeph">CA</code> and in the country with ID <code class="codeph">52790</code> (USA):
                        </p><pre class="pre codeblock"><code>EXPLAIN PLAN FOR
  SELECT *
  FROM   sh.customers
  WHERE  cust_state_province = 'CA'
  AND    country_id=52790;
 
Explained.
 
sys@PROD&gt; SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY);
 
PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------
Plan hash value: 1683234692
 
-------------------------------------------------------------------------------
| Id  | Operation         | Name      | Rows  | Bytes | Cost (%CPU)| Time     |
-------------------------------------------------------------------------------
|   0 | SELECT STATEMENT  |           |   128 | 24192 |   442   (7)| 00:00:06 |
|*  1 |  TABLE ACCESS FULL| CUSTOMERS |   <span class="bold">128</span> | 24192 |   442   (7)| 00:00:06 |
-------------------------------------------------------------------------------
 
Predicate Information (identified by operation id):
---------------------------------------------------
 
PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------
 
   1 - filter("CUST_STATE_PROVINCE"='CA' AND "COUNTRY_ID"=52790)
 
13 rows selected.
</code></pre><p>Based on the single-column statistics for the <code class="codeph">country_id</code> and <code class="codeph">cust_state_province</code> columns, the optimizer estimates that the query of California customers in the USA will return 128 rows. In fact, 3341 customers reside in California, but the optimizer does not know that the state of California is in the country of the USA, and so greatly underestimates cardinality by assuming that both predicates reduce the number of returned rows.
                        </p>
                        <p>You can make the optimizer aware of the real-world relationship between values in <code class="codeph">country_id</code> and <code class="codeph">cust_state_province</code> by gathering column group statistics. These statistics enable the optimizer to give a more accurate cardinality estimate.
                        </p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-F2E85913-120F-4F6A-99AD-D4B221344E7E__GUID-B098CCF2-C74B-4AD8-9BD3-CBE14C736748">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="managing-extended-statistics.html#GUID-E1F39134-24F1-4EF7-B614-82F9428CA762" title="You can use DBMS_STATS.SEED_COL_USAGE and REPORT_COL_USAGE to determine which column groups are required for a table based on a specified workload.">Detecting Useful Column Groups for a Specific Workload</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="managing-extended-statistics.html#GUID-783A8687-EDB3-437E-AE99-3F12369BA10A" title="You can use the DBMS_STATS.CREATE_EXTENDED_STATS function to create column groups that were detected previously by executing DBMS_STATS.SEED_COL_USAGE.">Creating Column Groups Detected During Workload Monitoring</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="managing-extended-statistics.html#GUID-D070C3B3-C356-4630-8EB3-766A790866F3" title="In some cases, you may know the column group that you want to create.">Creating and Gathering Statistics on Column Groups Manually</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-858E0BDA-06C6-471F-B9E8-888C3AD29673" title="Individual column statistics are useful for determining the selectivity of a single predicate in a WHERE clause.">About Statistics on Column Groups</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-676C7562-09BE-4760-9F62-BB6F18EDB036" name="GUID-676C7562-09BE-4760-9F62-BB6F18EDB036"></a><h5 id="TGSQL-GUID-676C7562-09BE-4760-9F62-BB6F18EDB036" class="sect5"><span class="enumeration_section">14.1.1.2 </span>Automatic and Manual Column Group Statistics
                     </h5>
                     <div>
                        <p>Oracle Database can create column group statistics either automatically or manually.</p>
                        <p>The optimizer can use SQL plan directives to generate a more optimal plan. If the <code class="codeph">DBMS_STATS</code> preference <code class="codeph">AUTO_STAT_EXTENSIONS</code> is set to <code class="codeph">ON</code> (by default it is <code class="codeph">OFF</code>), then a <a href="glossary.html#GUID-7E4B447A-5109-43A9-B581-CF9A03504766"><span class="xrefglossterm">SQL plan directive</span></a> can automatically trigger the creation of column group statistics based on usage of predicates in the workload. You can set <code class="codeph">AUTO_STAT_EXTENSIONS</code> with the <code class="codeph">SET_TABLE_PREFS</code>, <code class="codeph">SET_GLOBAL_PREFS</code>, or <code class="codeph">SET_SCHEMA_PREFS</code> procedures.
                        </p>
                        <p>When you want to manage column group statistics manually, then use <code class="codeph">DBMS_STATS</code> as follows:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Detect column groups</p>
                           </li>
                           <li>
                              <p>Create previously detected column groups</p>
                           </li>
                           <li>
                              <p>Create column groups manually and gather column group statistics</p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-676C7562-09BE-4760-9F62-BB6F18EDB036__GUID-D18E04D2-1CD3-45AA-A480-13C2AEBE0DA0">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="managing-extended-statistics.html#GUID-E1F39134-24F1-4EF7-B614-82F9428CA762" title="You can use DBMS_STATS.SEED_COL_USAGE and REPORT_COL_USAGE to determine which column groups are required for a table based on a specified workload.">Detecting Useful Column Groups for a Specific Workload</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="managing-extended-statistics.html#GUID-783A8687-EDB3-437E-AE99-3F12369BA10A" title="You can use the DBMS_STATS.CREATE_EXTENDED_STATS function to create column groups that were detected previously by executing DBMS_STATS.SEED_COL_USAGE.">Creating Column Groups Detected During Workload Monitoring</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="managing-extended-statistics.html#GUID-D070C3B3-C356-4630-8EB3-766A790866F3" title="In some cases, you may know the column group that you want to create.">Creating and Gathering Statistics on Column Groups Manually</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_STATS.html#ARPLS68491" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS</code> procedures for setting optimizer statistics
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-858E0BDA-06C6-471F-B9E8-888C3AD29673" title="Individual column statistics are useful for determining the selectivity of a single predicate in a WHERE clause.">About Statistics on Column Groups</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL94635"></a><a id="TGSQL466"></a><div class="props_rev_3"><a id="GUID-0A7D5A85-7813-4803-9BAC-3110B2CFB9E1" name="GUID-0A7D5A85-7813-4803-9BAC-3110B2CFB9E1"></a><h5 id="TGSQL-GUID-0A7D5A85-7813-4803-9BAC-3110B2CFB9E1" class="sect5"><span class="enumeration_section">14.1.1.3 </span>User Interface for Column Group Statistics
                     </h5>
                     <div>
                        <p>Several <code class="codeph">DBMS_STATS</code> program units have preferences that are relevant for column groups.
                        </p>
                        <div class="tblformal" id="GUID-0A7D5A85-7813-4803-9BAC-3110B2CFB9E1__CHDFAJCH">
                           <p class="titleintable">Table 14-1 DBMS_STATS APIs Relevant for Column Groups</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_STATS APIs Relevant for Column Groups" summary="This 2 column table lists DBMS_STATS Multicolumn Program Units. Column 1 lists the unit. Column 2 describes the unit. " width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="34%" id="d83685e1141">Program Unit or Preference</th>
                                    <th align="left" valign="bottom" width="66%" id="d83685e1144">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="34%" id="d83685e1149" headers="d83685e1141 "><code class="codeph">SEED_COL_USAGE</code> Procedure
                                    </td>
                                    <td align="left" valign="top" width="66%" headers="d83685e1149 d83685e1144 ">
                                       <p>Iterates over the SQL statements in the specified workload, compiles them, and then seeds column usage information for the columns that appear in these statements.</p>
                                       <p>To determine the appropriate column groups, the database must observe a representative workload. You do not need to run the queries themselves during the monitoring period. Instead, you can run <code class="codeph">EXPLAIN PLAN</code> for some longer-running queries in your workload to ensure that the database is recording column group information for these queries.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="34%" id="d83685e1162" headers="d83685e1141 "><code class="codeph">REPORT_COL_USAGE</code> Function
                                    </td>
                                    <td align="left" valign="top" width="66%" headers="d83685e1162 d83685e1144 ">
                                       <p>Generates a report that lists the columns that were seen in filter predicates, join predicates, and <code class="codeph">GROUP BY</code> clauses in the workload.
                                       </p>
                                       <p>You can use this function to review column usage information recorded for a specific table.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="34%" id="d83685e1175" headers="d83685e1141 "><code class="codeph">CREATE_EXTENDED_STATS</code> Function
                                    </td>
                                    <td align="left" valign="top" width="66%" headers="d83685e1175 d83685e1144 ">
                                       <p>Creates extensions, which are either column groups or expressions. The database gathers statistics for the extension when either a user-generated or automatic statistics gathering job gathers statistics for the table.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="34%" id="d83685e1183" headers="d83685e1141 "><code class="codeph">AUTO_STAT_EXTENSIONS</code> Preference
                                    </td>
                                    <td align="left" valign="top" width="66%" headers="d83685e1183 d83685e1144 ">Controls the automatic creation of extensions, including column groups, when optimizer statistics are gathered. Set this preference using <code class="codeph">SET_TABLE_PREFS</code>, <code class="codeph">SET_SCHEMA_PREFS</code>, or <code class="codeph">SET_GLOBAL_PREFS</code>.
                                       <p>When <code class="codeph">AUTO_STAT_EXTENSIONS</code> is set to <code class="codeph">OFF</code> (default), the database does not create column group statistics automatically. To create extensions, you must execute the <code class="codeph">CREATE_EXTENDED_STATS</code> function or specify extended statistics explicitly in the <code class="codeph">METHOD_OPT</code> parameter in the <code class="codeph">DBMS_STATS</code> API.
                                       </p>
                                       <p>When set to <code class="codeph">ON</code>, a SQL plan directive can trigger the creation of column group statistics automatically based on usage of columns in the predicates in the workload.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-0A7D5A85-7813-4803-9BAC-3110B2CFB9E1__GUID-58DEC0BB-9DF1-4909-B08E-3E677077DD24">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="controlling-the-use-of-optimizer-statistics.html#GUID-D73DB2F4-46C1-4C5B-94DD-DE1F1DD5BBCC" title="This topic explains how to set artificial statistics for a table using DBMS_STATS.SET_TABLE_STATS. The basic steps are the same for SET_INDEX_STATS and SET_SYSTEM_STATS.">Setting Artificial Optimizer Statistics for a Table</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_STATS.html#ARPLS059" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> to learn about the <code class="codeph">DBMS_STATS</code> package
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-858E0BDA-06C6-471F-B9E8-888C3AD29673" title="Individual column statistics are useful for determining the selectivity of a single predicate in a WHERE clause.">About Statistics on Column Groups</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL470"></a><a id="TGSQL468"></a><div class="props_rev_3"><a id="GUID-E1F39134-24F1-4EF7-B614-82F9428CA762" name="GUID-E1F39134-24F1-4EF7-B614-82F9428CA762"></a><h4 id="TGSQL-GUID-E1F39134-24F1-4EF7-B614-82F9428CA762" class="sect4"><span class="enumeration_section">14.1.2 </span>Detecting Useful Column Groups for a Specific Workload
                  </h4>
                  <div>
                     <p>You can use <code class="codeph">DBMS_STATS.SEED_COL_USAGE</code> and <code class="codeph">REPORT_COL_USAGE</code> to determine which column groups are required for a table based on a specified workload. 
                     </p>
                     <div class="section">
                        <p>This technique is useful when you do not know which extended statistics to create. This technique does not work for expression statistics.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E1F39134-24F1-4EF7-B614-82F9428CA762__GUID-A13746FC-5BC8-47DC-981C-CE8391A06F60">Assumptions</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Cardinality estimates have been incorrect for queries of the <code class="codeph">sh.customers_test</code> table (created from the <code class="codeph">customers</code> table) that use predicates referencing the columns <code class="codeph">country_id</code> and <code class="codeph">cust_state_province</code>.
                              </p>
                           </li>
                           <li>
                              <p>You want the database to monitor your workload for 5 minutes (300 seconds).</p>
                           </li>
                           <li>
                              <p>You want the database to determine which column groups are needed automatically.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E1F39134-24F1-4EF7-B614-82F9428CA762__GUID-445DEB78-E578-4B19-88BD-10A5AA31A8B0">To detect column groups:</p>
                        <ol>
                           <li>
                              <p>Start SQL*Plus or SQL Developer, and log in to the database as user <code class="codeph">sh</code>.
                              </p>
                           </li>
                           <li>
                              <p>Create the <code class="codeph">customers_test</code> table and gather statistics for it:
                              </p><pre class="pre codeblock"><code>DROP TABLE customers_test;
CREATE TABLE customers_test AS SELECT * FROM customer;
EXEC DBMS_STATS.GATHER_TABLE_STATS(user, 'customers_test');
</code></pre></li>
                           <li>
                              <p>Enable workload monitoring.</p>
                              <p>In a different SQL*Plus session, connect as <code class="codeph">SYS</code> and run the following PL/SQL program to enable monitoring for 300 seconds:
                              </p><pre class="pre codeblock"><code>BEGIN
  DBMS_STATS.SEED_COL_USAGE(null,null,300);
END;
/
</code></pre></li>
                           <li>
                              <p>As user <code class="codeph">sh</code>, run explain plans for two queries in the workload.
                              </p>
                              <p>The following examples show the explain plans for two queries on the <code class="codeph">customers_test</code> table:
                              </p><pre class="pre codeblock"><code>EXPLAIN PLAN FOR
  SELECT *
  FROM   customers_test
  WHERE  cust_city = 'Los Angeles'
  AND    cust_state_province = 'CA'
  AND    country_id = 52790;
 
SELECT PLAN_TABLE_OUTPUT 
FROM   TABLE(DBMS_XPLAN.DISPLAY('plan_table', null,'basic rows'));
 
EXPLAIN PLAN FOR
  SELECT   country_id, cust_state_province, count(cust_city)
  FROM     customers_test
  GROUP BY country_id, cust_state_province;
 
SELECT PLAN_TABLE_OUTPUT 
FROM   TABLE(DBMS_XPLAN.DISPLAY('plan_table', null,'basic rows'));
</code></pre><p>Sample output appears below:</p><pre class="pre codeblock"><code>PLAN_TABLE_OUTPUT
---------------------------------------------------------------------------
Plan hash value: 4115398853
 
----------------------------------------------------
| Id  | Operation         | Name           | Rows  |
----------------------------------------------------
|   0 | SELECT STATEMENT  |                |     1 |
|   1 |  TABLE ACCESS FULL| CUSTOMERS_TEST |     <span class="bold">1</span> |
----------------------------------------------------
 
8 rows selected.
 
PLAN_TABLE_OUTPUT
---------------------------------------------------------------------------
Plan hash value: 3050654408
 
-----------------------------------------------------
| Id  | Operation          | Name           | Rows  |
-----------------------------------------------------
|   0 | SELECT STATEMENT   |                |  1949 |
|   1 |  HASH GROUP BY     |                |  <span class="bold">1949</span> |
|   2 |   TABLE ACCESS FULL| CUSTOMERS_TEST | 55500 |
-----------------------------------------------------
 
9 rows selected.
</code></pre><p>The first plan shows a cardinality of 1 row for a query that returns 932 rows. The second plan shows a cardinality of 1949 rows for a query that returns 145 rows.</p>
                           </li>
                           <li>
                              <p>Optionally, review the column usage information recorded for the table. </p>
                              <p>Call the <code class="codeph">DBMS_STATS.REPORT_COL_USAGE</code> function to generate a report:
                              </p><pre class="pre codeblock"><code>SET LONG 100000
SET LINES 120
SET PAGES 0
SELECT DBMS_STATS.REPORT_COL_USAGE(user, 'customers_test')
FROM   DUAL;
</code></pre><p>The report appears below:</p><pre class="pre codeblock"><code>LEGEND:
.......
 
EQ         : Used in single table EQuality predicate
RANGE      : Used in single table RANGE predicate
LIKE       : Used in single table LIKE predicate
NULL       : Used in single table is (not) NULL predicate
EQ_JOIN    : Used in EQuality JOIN predicate
NONEQ_JOIN : Used in NON EQuality JOIN predicate
FILTER     : Used in single table FILTER predicate
JOIN       : Used in JOIN predicate
GROUP_BY   : Used in GROUP BY expression
...........................................................................
 
###########################################################################
 
COLUMN USAGE REPORT FOR SH.CUSTOMERS_TEST
.........................................
 
1. COUNTRY_ID                          : <span class="bold">EQ</span>
2. CUST_CITY                           : <span class="bold">EQ</span>
3. CUST_STATE_PROVINCE                 : <span class="bold">EQ</span>
4. (CUST_CITY, CUST_STATE_PROVINCE,
    COUNTRY_ID)                        : <span class="bold">FILTER</span>
5. (CUST_STATE_PROVINCE, COUNTRY_ID)   : <span class="bold">GROUP_BY</span>
###########################################################################
</code></pre><p>In the preceding report, the first three columns were used in equality predicates in the first monitored query:</p><pre class="pre codeblock"><code>...
WHERE  cust_city = 'Los Angeles'
AND    cust_state_province = 'CA'
AND    country_id = 52790;
</code></pre><p>All three columns appeared in the same <code class="codeph">WHERE</code> clause, so the report shows them as a group filter. In the second query, two columns appeared in the <code class="codeph">GROUP BY</code> clause, so the report labels them as <code class="codeph">GROUP_BY</code>. The sets of columns in the <code class="codeph">FILTER</code> and <code class="codeph">GROUP_BY</code> report are candidates for column groups.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-E1F39134-24F1-4EF7-B614-82F9428CA762__GUID-708EFEB2-5A8A-4378-89AC-3794CF44E8C8">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE" title="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">Managing SQL Tuning Sets</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_STATS.html#ARPLS059" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS</code> package
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782" title="A column group is a set of columns that is treated as a unit.">Managing Column Group Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL94637"></a><a id="TGSQL94636"></a><div class="props_rev_3"><a id="GUID-783A8687-EDB3-437E-AE99-3F12369BA10A" name="GUID-783A8687-EDB3-437E-AE99-3F12369BA10A"></a><h4 id="TGSQL-GUID-783A8687-EDB3-437E-AE99-3F12369BA10A" class="sect4"><span class="enumeration_section">14.1.3 </span>Creating Column Groups Detected During Workload Monitoring
                  </h4>
                  <div>
                     <p>You can use the <code class="codeph">DBMS_STATS.CREATE_EXTENDED_STATS</code> function to create column groups that were detected previously by executing <code class="codeph">DBMS_STATS.SEED_COL_USAGE</code>.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-783A8687-EDB3-437E-AE99-3F12369BA10A__GUID-8F0EBD76-1BC9-4019-B705-C1AA55BADA76">Assumptions</p>
                        <p>This tutorial assumes that you have performed the steps in <span class="q">"<a href="managing-extended-statistics.html#GUID-E1F39134-24F1-4EF7-B614-82F9428CA762" title="You can use DBMS_STATS.SEED_COL_USAGE and REPORT_COL_USAGE to determine which column groups are required for a table based on a specified workload.">Detecting Useful Column Groups for a Specific Workload</a>"</span>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-783A8687-EDB3-437E-AE99-3F12369BA10A__GUID-31204D5C-98E7-4590-9A33-C69B32A3B4D7">To create column groups:</p>
                        <ol>
                           <li>
                              <p>Create column groups for the <code class="codeph">customers_test</code> table based on the usage information captured during the monitoring window. 
                              </p>
                              <p>For example, run the following query:</p><pre class="pre codeblock"><code>SELECT DBMS_STATS.CREATE_EXTENDED_STATS(user, 'customers_test') FROM DUAL;
</code></pre><p>Sample output appears below:</p><pre class="pre codeblock"><code>###########################################################################
EXTENSIONS FOR SH.CUSTOMERS_TEST
................................
1. (CUST_CITY, CUST_STATE_PROVINCE,
    COUNTRY_ID)                     :SYS_STUMZ$C3AIHLPBROI#SKA58H_N <span class="bold">created</span>
2. (CUST_STATE_PROVINCE, COUNTRY_ID):SYS_STU#S#WF25Z#QAHIHE#MOFFMM_ <span class="bold">created</span>
###########################################################################
</code></pre><p>The database created two column groups for <code class="codeph">customers_test</code>: one column group for the filter predicate and one group for the <code class="codeph">GROUP BY</code> operation.
                              </p>
                           </li>
                           <li>
                              <p>Regather table statistics.</p>
                              <p>Run <code class="codeph">GATHER_TABLE_STATS</code> to regather the statistics for <code class="codeph">customers_test</code>:
                              </p><pre class="pre codeblock"><code>EXEC DBMS_STATS.GATHER_TABLE_STATS(user,'customers_test');
</code></pre></li>
                           <li>
                              <p>As user <code class="codeph">sh</code>, run explain plans for two queries in the workload.
                              </p>
                              <p>Check the <code class="codeph">USER_TAB_COL_STATISTICS</code> view to determine which additional statistics were created by the database:
                              </p><pre class="pre codeblock"><code>SELECT COLUMN_NAME, NUM_DISTINCT, HISTOGRAM
FROM   USER_TAB_COL_STATISTICS
WHERE  TABLE_NAME = 'CUSTOMERS_TEST'
ORDER BY 1;
</code></pre><p>Partial sample output appears below:</p><pre class="pre codeblock"><code>CUST_CITY                               620 HEIGHT BALANCED
...
SYS_STU#S#WF25Z#QAHIHE#MOFFMM_          145 NONE
SYS_STUMZ$C3AIHLPBROI#SKA58H_N          620 HEIGHT BALANCED
</code></pre><p>This example shows the two column group names returned from the <code class="codeph">DBMS_STATS.CREATE_EXTENDED_STATS</code> function. The column group created on <code class="codeph">CUST_CITY</code>, <code class="codeph">CUST_STATE_PROVINCE</code>, and <code class="codeph">COUNTRY_ID</code> has a height-balanced histogram.
                              </p>
                           </li>
                           <li>
                              <p>Explain the plans again.</p>
                              <p>The following examples show the explain plans for two queries on the <code class="codeph">customers_test</code> table:
                              </p><pre class="pre codeblock"><code>EXPLAIN PLAN FOR
  SELECT *
  FROM   customers_test
  WHERE  cust_city = 'Los Angeles'
  AND    cust_state_province = 'CA'
  AND    country_id = 52790;
 
SELECT PLAN_TABLE_OUTPUT 
FROM   TABLE(DBMS_XPLAN.DISPLAY('plan_table', null,'basic rows'));
 
EXPLAIN PLAN FOR
  SELECT   country_id, cust_state_province, count(cust_city)
  FROM     customers_test
  GROUP BY country_id, cust_state_province;
 
SELECT PLAN_TABLE_OUTPUT 
FROM   TABLE(DBMS_XPLAN.DISPLAY('plan_table', null,'basic rows'));
</code></pre><p>The new plans show more accurate cardinality estimates:</p><pre class="pre codeblock"><code>----------------------------------------------------
| Id  | Operation         | Name           | Rows  |
----------------------------------------------------
|   0 | SELECT STATEMENT  |                |  1093 |
|   1 |  TABLE ACCESS FULL| CUSTOMERS_TEST |  <span class="bold">1093</span> |
----------------------------------------------------
 
8 rows selected.
 
Plan hash value: 3050654408
 
-----------------------------------------------------
| Id  | Operation          | Name           | Rows  |
-----------------------------------------------------
|   0 | SELECT STATEMENT   |                |   145 |
|   1 |  HASH GROUP BY     |                |   <span class="bold">145</span> |
|   2 |   TABLE ACCESS FULL| CUSTOMERS_TEST | 55500 |
-----------------------------------------------------
9 rows selected.</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-783A8687-EDB3-437E-AE99-3F12369BA10A__GUID-D04A8D31-BDF4-4D9F-93AF-42230ABF8F11">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_STATS.html#ARPLS059" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS</code> package
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782" title="A column group is a set of columns that is treated as a unit.">Managing Column Group Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL472"></a><a id="TGSQL471"></a><div class="props_rev_3"><a id="GUID-D070C3B3-C356-4630-8EB3-766A790866F3" name="GUID-D070C3B3-C356-4630-8EB3-766A790866F3"></a><h4 id="TGSQL-GUID-D070C3B3-C356-4630-8EB3-766A790866F3" class="sect4"><span class="enumeration_section">14.1.4 </span>Creating and Gathering Statistics on Column Groups Manually
                  </h4>
                  <div>
                     <p>In some cases, you may know the column group that you want to create.</p>
                     <div class="section">
                        <p>The <code class="codeph">METHOD_OPT</code> argument of the <code class="codeph">DBMS_STATS.GATHER_TABLE_STATS</code> function can create and gather statistics on a column group automatically. You can create a new column group by specifying the group of columns using <code class="codeph">FOR COLUMNS</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D070C3B3-C356-4630-8EB3-766A790866F3__GUID-7B8E6BC9-5689-4A3A-982E-2FBD15441200">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You want to create a column group for the <code class="codeph">cust_state_province</code> and <code class="codeph">country_id</code> columns in the <code class="codeph">customers</code> table in <code class="codeph">sh</code> schema.
                              </p>
                           </li>
                           <li>
                              <p>You want to gather statistics (including histograms) on the entire table and the new column group.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D070C3B3-C356-4630-8EB3-766A790866F3__GUID-803FB40E-E8E1-4963-9009-AD1C01ED196C">To create a column group and gather statistics for this group:</p>
                        <ol>
                           <li>
                              <p>In SQL*Plus, log in to the database as the <code class="codeph">sh</code> user.
                              </p>
                           </li>
                           <li>
                              <p>Create the column group and gather statistics.</p>
                              <p>For example, execute the following PL/SQL program:</p><pre class="pre codeblock"><code>BEGIN
  DBMS_STATS.GATHER_TABLE_STATS( 'sh','customers',
  METHOD_OPT =&gt; 'FOR ALL COLUMNS SIZE SKEWONLY ' ||
                'FOR COLUMNS SIZE SKEWONLY (cust_state_province,country_id)' );
END;
/</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-D070C3B3-C356-4630-8EB3-766A790866F3__GUID-F8294B58-5F0B-4A25-897B-548FA3AA2D4B">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_STATS.html#ARPLS-GUID-CA6A56B9-0540-45E9-B1D7-D78769B7714C" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS.GATHER_TABLE_STATS</code> procedure
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782" title="A column group is a set of columns that is treated as a unit.">Managing Column Group Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL475"></a><a id="TGSQL474"></a><div class="props_rev_3"><a id="GUID-532D06C9-C6A2-4018-B496-AD87003B682E" name="GUID-532D06C9-C6A2-4018-B496-AD87003B682E"></a><h4 id="TGSQL-GUID-532D06C9-C6A2-4018-B496-AD87003B682E" class="sect4"><span class="enumeration_section">14.1.5 </span>Displaying Column Group Information
                  </h4>
                  <div>
                     <p>To obtain the name of a column group, use the <code class="codeph">DBMS_STATS.SHOW_EXTENDED_STATS_NAME</code> function or a database view. 
                     </p>
                     <div class="section">
                        <p>You can also use views to obtain information such as the number of distinct values, and whether the column group has a histogram.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-532D06C9-C6A2-4018-B496-AD87003B682E__GUID-BE857DE7-02A3-4CE4-8AC0-64CFE687498C">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You created a column group for the <code class="codeph">cust_state_province</code> and <code class="codeph">country_id</code> columns in the <code class="codeph">customers</code> table in <code class="codeph">sh</code> schema.
                              </p>
                           </li>
                           <li>
                              <p>You want to determine the column group name, the number of distinct values, and whether a histogram has been created for a column group.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-532D06C9-C6A2-4018-B496-AD87003B682E__GUID-C4572426-CF48-4D32-9FCC-0B5116765301">To monitor a column group:</p>
                        <ol>
                           <li>
                              <p>Start SQL*Plus and connect to the database as the <code class="codeph">sh</code> user.
                              </p>
                           </li>
                           <li>
                              <p>To determine the column group name, do one of the following.</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Execute the <code class="codeph">SHOW_EXTENDED_STATS_NAME</code> function.
                                    </p>
                                    <p>For example, run the following PL/SQL program:</p><pre class="pre codeblock"><code>SELECT SYS.DBMS_STATS.SHOW_EXTENDED_STATS_NAME( 'sh','customers',
       '(cust_state_province,country_id)' ) col_group_name 
FROM   DUAL;
</code></pre><p>The output is similar to the following:</p><pre class="pre codeblock"><code>COL_GROUP_NAME
----------------
SYS_STU#S#WF25Z#QAHIHE#MOFFMM_
</code></pre></li>
                                 <li>
                                    <p>Query the <code class="codeph">USER_STAT_EXTENSIONS</code> view.
                                    </p>
                                    <p>For example, run the following query:</p><pre class="pre codeblock"><code>SELECT EXTENSION_NAME, EXTENSION 
FROM   USER_STAT_EXTENSIONS 
WHERE  TABLE_NAME='CUSTOMERS';

EXTENSION_NAME                     EXTENSION
-----------------------------------------------------------------------
SYS_STU#S#WF25Z#QAHIHE#MOFFMM_     ("CUST_STATE_PROVINCE","COUNTRY_ID")
</code></pre></li>
                              </ul>
                           </li>
                           <li>
                              <p>Query the number of distinct values and find whether a histogram has been created for a column group.</p>
                              <p>For example, run the following query:</p><pre class="pre codeblock"><code>SELECT e.EXTENSION col_group, t.NUM_DISTINCT, t.HISTOGRAM
FROM   USER_STAT_EXTENSIONS e, USER_TAB_COL_STATISTICS t
WHERE  e.EXTENSION_NAME=t.COLUMN_NAME
AND    e.TABLE_NAME=t.TABLE_NAME
AND    t.TABLE_NAME='CUSTOMERS';

COL_GROUP                             NUM_DISTINCT        HISTOGRAM
-------------------------------------------------------------------
("COUNTRY_ID","CUST_STATE_PROVINCE")  145                 FREQUENCY</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-532D06C9-C6A2-4018-B496-AD87003B682E__GUID-6EE3159D-9BF9-4E3C-A52B-F740D19883B2">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_STATS.html#ARPLS059" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS.SHOW_EXTENDED_STATS_NAME</code> function
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782" title="A column group is a set of columns that is treated as a unit.">Managing Column Group Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL477"></a><a id="TGSQL476"></a><div class="props_rev_3"><a id="GUID-DBBB6C91-4450-457D-A612-71E835D6159C" name="GUID-DBBB6C91-4450-457D-A612-71E835D6159C"></a><h4 id="TGSQL-GUID-DBBB6C91-4450-457D-A612-71E835D6159C" class="sect4"><span class="enumeration_section">14.1.6 </span>Dropping a Column Group
                  </h4>
                  <div>
                     <p>Use the <code class="codeph">DBMS_STATS.DROP_EXTENDED_STATS</code> function to delete a column group from a table.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-DBBB6C91-4450-457D-A612-71E835D6159C__GUID-4D2C2D47-494A-4066-A09F-606973527801">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You created a column group for the <code class="codeph">cust_state_province</code> and <code class="codeph">country_id</code> columns in the <code class="codeph">customers</code> table in <code class="codeph">sh</code> schema.
                              </p>
                           </li>
                           <li>
                              <p>You want to drop the column group.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DBBB6C91-4450-457D-A612-71E835D6159C__GUID-1F2D03E6-2F9C-4323-B889-63F10E8CCB05">To drop a column group:</p>
                        <ol>
                           <li>
                              <p>Start SQL*Plus and connect to the database as the <code class="codeph">sh</code> user.
                              </p>
                           </li>
                           <li>
                              <p>Drop the column group.</p>
                              <p>For example, the following PL/SQL program deletes a column group from the <code class="codeph">customers</code> table:
                              </p><pre class="pre codeblock"><code>BEGIN
  DBMS_STATS.DROP_EXTENDED_STATS( 'sh', 'customers', 
                                  '(cust_state_province, country_id)' );
END;
/</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-DBBB6C91-4450-457D-A612-71E835D6159C__GUID-BA03AA34-31A9-4AA5-8422-22F8DB596127">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_STATS.html#ARPLS059" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> to learn about the <code class="codeph">DBMS_STATS.DROP_EXTENDED_STATS</code> function
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-CE34B506-94B6-4346-8AB6-6B17BC52B782" title="A column group is a set of columns that is treated as a unit.">Managing Column Group Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-FC50E35E-AF6A-4ECD-919D-8E020011DAB6" name="GUID-FC50E35E-AF6A-4ECD-919D-8E020011DAB6"></a><h3 id="TGSQL-GUID-FC50E35E-AF6A-4ECD-919D-8E020011DAB6" class="sect3"><span class="enumeration_section">14.2 </span>Managing Expression Statistics
               </h3>
               <div>
                  <p>The type of extended statistics known as <strong class="term">expression statistics</strong> improve optimizer estimates when a <code class="codeph">WHERE</code> clause has predicates that use expressions.
                  </p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-A3B906A6-BB2B-400D-96F0-73E970758096">About Expression Statistics</a><br>For an <strong class="term">expression</strong> in the form <code class="codeph">(<span class="codeinlineitalic">function</span>(<span class="codeinlineitalic">col</span>)=<span class="codeinlineitalic">constant</span>)</code> applied to a <code class="codeph">WHERE</code> clause column, the optimizer does not know how this function affects predicate cardinality unless a function-based index exists. However, you can gather expression statistics on the expression<code class="codeph">(<span class="codeinlineitalic">function</span>(<span class="codeinlineitalic">col</span>)</code> itself.
                     </li>
                     <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-69CE9581-1865-4E08-A471-910148B96458">Creating Expression Statistics</a><br>You can use <code class="codeph">DBMS_STATS</code> to create statistics for a user-specified expression. 
                     </li>
                     <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-D016F91D-39A5-4290-AFB6-7271B4D31621">Displaying Expression Statistics</a><br>To obtain information about expression statistics, use the database view <code class="codeph">DBA_STAT_EXTENSIONS</code> and the <code class="codeph">DBMS_STATS.SHOW_EXTENDED_STATS_NAME</code> function.
                     </li>
                     <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-C23883A8-DA95-482E-9954-EF4B5EBCA7B7">Dropping Expression Statistics</a><br>To delete a column group from a table, use the <code class="codeph">DBMS_STATS.DROP_EXTENDED_STATS</code> function.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-BD0F0B71-DD8B-44A0-888E-495830FC09A4" title="DBMS_STATS enables you to collect extended statistics, which are statistics that can improve cardinality estimates when multiple predicates exist on different columns of a table, or when predicates use expressions.">Managing Extended Statistics</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL480"></a><a id="TGSQL479"></a><div class="props_rev_3"><a id="GUID-A3B906A6-BB2B-400D-96F0-73E970758096" name="GUID-A3B906A6-BB2B-400D-96F0-73E970758096"></a><h4 id="TGSQL-GUID-A3B906A6-BB2B-400D-96F0-73E970758096" class="sect4"><span class="enumeration_section">14.2.1 </span>About Expression Statistics
                  </h4>
                  <div>
                     <p>For an <strong class="term">expression</strong> in the form <code class="codeph">(<span class="codeinlineitalic">function</span>(<span class="codeinlineitalic">col</span>)=<span class="codeinlineitalic">constant</span>)</code> applied to a <code class="codeph">WHERE</code> clause column, the optimizer does not know how this function affects predicate cardinality unless a function-based index exists. However, you can gather expression statistics on the expression<code class="codeph">(<span class="codeinlineitalic">function</span>(<span class="codeinlineitalic">col</span>)</code> itself.
                     </p>
                     <p>The following graphic shows the optimizer using statistics to generate a plan for a query that uses a function. The top shows the optimizer checking statistics for the column. The bottom shows the optimizer checking statistics corresponding to the expression used in the query. The expression statistics yield more accurate estimates.</p>
                     <div class="figure" id="GUID-A3B906A6-BB2B-400D-96F0-73E970758096__CHDBFFCH">
                        <p class="titleinfigure">Figure 14-2 Expression Statistics</p><img src="img/tgsql_vm_068.png" alt="Description of Figure 14-2 follows" title="Description of Figure 14-2 follows" longdesc="img_text/tgsql_vm_068.html"><br><a href="img_text/tgsql_vm_068.html">Description of "Figure 14-2 Expression Statistics"</a></div>
                     <!-- class="figure" -->
                     <p>As shown in <a href="managing-extended-statistics.html#GUID-A3B906A6-BB2B-400D-96F0-73E970758096__CHDBFFCH">Figure 14-2</a>, when expression statistics are not available, the optimizer can produce suboptimal plans.
                     </p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-extended-statistics.html#GUID-E2105B53-38E4-452C-A9D0-B3D44CCBFBE9">When Expression Statistics Are Useful: Example</a><br></li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-A3B906A6-BB2B-400D-96F0-73E970758096__GUID-491A27ED-7127-455D-AE9F-C23A35470B7D">
                        <p class="notep1">See Also:</p>
                        <p><a href="../sqlrf/About-SQL-Functions.html#SQLRF51173" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> to learn about SQL functions
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-FC50E35E-AF6A-4ECD-919D-8E020011DAB6" title="The type of extended statistics known as expression statistics improve optimizer estimates when a WHERE clause has predicates that use expressions.">Managing Expression Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="TGSQL481"></a><div class="props_rev_3"><a id="GUID-E2105B53-38E4-452C-A9D0-B3D44CCBFBE9" name="GUID-E2105B53-38E4-452C-A9D0-B3D44CCBFBE9"></a><h5 id="TGSQL-GUID-E2105B53-38E4-452C-A9D0-B3D44CCBFBE9" class="sect5"><span class="enumeration_section">14.2.1.1 </span>When Expression Statistics Are Useful: Example
                     </h5>
                     <div>
                        <p>The following query of the <code class="codeph">sh.customers</code> table shows that 3341 customers are in the state of California:
                        </p><pre class="pre codeblock"><code>sys@PROD&gt; SELECT COUNT(*) FROM sh.customers WHERE cust_state_province='CA';
 
  COUNT(*)
----------
      3341
</code></pre><p>Consider the plan for the same query with the <code class="codeph">LOWER()</code> function applied:
                        </p><pre class="pre codeblock"><code>sys@PROD&gt; EXPLAIN PLAN FOR
  2  SELECT * FROM sh.customers WHERE LOWER(cust_state_province)='ca';
Explained.

sys@PROD&gt; select * from table(dbms_xplan.display);

PLAN_TABLE_OUTPUT
-------------------------------------------------------------------------------
Plan hash value: 2008213504

-------------------------------------------------------------------------------
| Id  | Operation         | Name      | Rows  | Bytes | Cost (%CPU)| Time     |
-------------------------------------------------------------------------------
|   0 | SELECT STATEMENT  |           |   555 |   108K|   406   (1)| 00:00:05 |
|*  1 |  TABLE ACCESS FULL| CUSTOMERS |   555 |   108K|   406   (1)| 00:00:05 |
-------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   1 - filter(LOWER("CUST_STATE_PROVINCE")='ca')
</code></pre><p>Because no expression statistics exist for <code class="codeph">LOWER(cust_state_province)='ca'</code>, the optimizer estimate is significantly off. You can use <code class="codeph">DBMS_STATS</code> procedures to correct these estimates.
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-A3B906A6-BB2B-400D-96F0-73E970758096" title="For an expression in the form (function(col)=constant) applied to a WHERE clause column, the optimizer does not know how this function affects predicate cardinality unless a function-based index exists. However, you can gather expression statistics on the expression(function(col) itself.">About Expression Statistics</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL484"></a><a id="TGSQL483"></a><div class="props_rev_3"><a id="GUID-69CE9581-1865-4E08-A471-910148B96458" name="GUID-69CE9581-1865-4E08-A471-910148B96458"></a><h4 id="TGSQL-GUID-69CE9581-1865-4E08-A471-910148B96458" class="sect4"><span class="enumeration_section">14.2.2 </span>Creating Expression Statistics
                  </h4>
                  <div>
                     <p>You can use <code class="codeph">DBMS_STATS</code> to create statistics for a user-specified expression. 
                     </p>
                     <div class="section">
                        <p>You can use either of the following program units:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">GATHER_TABLE_STATS</code> procedure
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">CREATE_EXTENDED_STATISTICS</code> function followed by the <code class="codeph">GATHER_TABLE_STATS</code> procedure
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-69CE9581-1865-4E08-A471-910148B96458__GUID-FA035832-CD12-4753-A15A-7CCF6F85CD2D">Assumptions</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Selectivity estimates are inaccurate for queries of <code class="codeph">sh.customers</code> that use the <code class="codeph">UPPER(cust_state_province)</code> function.
                              </p>
                           </li>
                           <li>
                              <p>You want to gather statistics on the <code class="codeph">UPPER(cust_state_province)</code> expression.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-69CE9581-1865-4E08-A471-910148B96458__GUID-C5D51972-CD9B-4FFD-AA97-AC0D6A3843B2">To create expression statistics:</p>
                        <ol>
                           <li>
                              <p>Start SQL*Plus and connect to the database as the <code class="codeph">sh</code> user.
                              </p>
                           </li>
                           <li>
                              <p>Gather table statistics.</p>
                              <p>For example, run the following command, specifying the function in the <code class="codeph">method_opt</code> argument:
                              </p><pre class="pre codeblock"><code>BEGIN
  DBMS_STATS.GATHER_TABLE_STATS( 
    'sh'
,   'customers'
,   method_opt =&gt; 'FOR ALL COLUMNS SIZE SKEWONLY ' || 
                  'FOR COLUMNS (LOWER(cust_state_province)) SIZE SKEWONLY' 
);
END;</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-69CE9581-1865-4E08-A471-910148B96458__GUID-673611C4-D07D-4627-AEC2-97273A4BC46E">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_STATS.html#ARPLS-GUID-CA6A56B9-0540-45E9-B1D7-D78769B7714C" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS.GATHER_TABLE_STATS</code> procedure
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-FC50E35E-AF6A-4ECD-919D-8E020011DAB6" title="The type of extended statistics known as expression statistics improve optimizer estimates when a WHERE clause has predicates that use expressions.">Managing Expression Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL486"></a><a id="TGSQL485"></a><div class="props_rev_3"><a id="GUID-D016F91D-39A5-4290-AFB6-7271B4D31621" name="GUID-D016F91D-39A5-4290-AFB6-7271B4D31621"></a><h4 id="TGSQL-GUID-D016F91D-39A5-4290-AFB6-7271B4D31621" class="sect4"><span class="enumeration_section">14.2.3 </span>Displaying Expression Statistics
                  </h4>
                  <div>
                     <p>To obtain information about expression statistics, use the database view <code class="codeph">DBA_STAT_EXTENSIONS</code> and the <code class="codeph">DBMS_STATS.SHOW_EXTENDED_STATS_NAME</code> function.
                     </p>
                     <div class="section">
                        <p>You can also use views to obtain information such as the number of distinct values, and whether the column group has a histogram.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D016F91D-39A5-4290-AFB6-7271B4D31621__GUID-8551EE0E-BD3F-4665-8537-5D8F2FDFE774">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You created extended statistics for the <code class="codeph">LOWER(cust_state_province)</code> expression.
                              </p>
                           </li>
                           <li>
                              <p>You want to determine the column group name, the number of distinct values, and whether a histogram has been created for a column group.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D016F91D-39A5-4290-AFB6-7271B4D31621__GUID-A266AD52-AF26-4909-9A18-E9BAF75D391E">To monitor expression statistics:</p>
                        <ol>
                           <li>
                              <p>Start SQL*Plus and connect to the database as the <code class="codeph">sh</code> user.
                              </p>
                           </li>
                           <li>
                              <p>Query the name and definition of the statistics extension.</p>
                              <p>For example, run the following query:</p><pre class="pre codeblock"><code>COL EXTENSION_NAME FORMAT a30
COL EXTENSION FORMAT a35

SELECT EXTENSION_NAME, EXTENSION
FROM   USER_STAT_EXTENSIONS
WHERE  TABLE_NAME='CUSTOMERS';
</code></pre><p>Sample output appears as follows:</p><pre class="pre codeblock"><code>EXTENSION_NAME                 EXTENSION
------------------------------ ------------------------------
SYS_STUBPHJSBRKOIK9O2YV3W8HOUE (LOWER("CUST_STATE_PROVINCE"))
</code></pre></li>
                           <li>
                              <p>Query the number of distinct values and find whether a histogram has been created for the expression.</p>
                              <p>For example, run the following query:</p><pre class="pre codeblock"><code>SELECT e.EXTENSION expression, t.NUM_DISTINCT, t.HISTOGRAM
FROM   USER_STAT_EXTENSIONS e, USER_TAB_COL_STATISTICS t
WHERE  e.EXTENSION_NAME=t.COLUMN_NAME
AND    e.TABLE_NAME=t.TABLE_NAME
AND    t.TABLE_NAME='CUSTOMERS';

EXPRESSION                            NUM_DISTINCT        HISTOGRAM
-------------------------------------------------------------------
(LOWER("CUST_STATE_PROVINCE"))        145                 FREQUENCY</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-D016F91D-39A5-4290-AFB6-7271B4D31621__GUID-EAB1380A-7CBF-4B37-B970-4E3DF0D50A5C">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../arpls/DBMS_STATS.html#ARPLS-GUID-45029036-3FFC-4B7E-BFDC-A624D42C0988" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS.SHOW_EXTENDED_STATS_NAME</code> procedure
                              </p>
                           </li>
                           <li>
                              <p><a href="../refrn/DBA_STAT_EXTENSIONS.html#REFRN-GUID-1677F9C2-1EC4-4FA5-876D-2F6B5EAB6CC6" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">DBA_STAT_EXTENSIONS</code> view
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-FC50E35E-AF6A-4ECD-919D-8E020011DAB6" title="The type of extended statistics known as expression statistics improve optimizer estimates when a WHERE clause has predicates that use expressions.">Managing Expression Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL488"></a><a id="TGSQL487"></a><div class="props_rev_3"><a id="GUID-C23883A8-DA95-482E-9954-EF4B5EBCA7B7" name="GUID-C23883A8-DA95-482E-9954-EF4B5EBCA7B7"></a><h4 id="TGSQL-GUID-C23883A8-DA95-482E-9954-EF4B5EBCA7B7" class="sect4"><span class="enumeration_section">14.2.4 </span>Dropping Expression Statistics
                  </h4>
                  <div>
                     <p>To delete a column group from a table, use the <code class="codeph">DBMS_STATS.DROP_EXTENDED_STATS</code> function.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C23883A8-DA95-482E-9954-EF4B5EBCA7B7__GUID-7753C45D-E7F2-4790-9F35-718A9E9E51B7">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You created extended statistics for the <code class="codeph">LOWER(cust_state_province)</code> expression.
                              </p>
                           </li>
                           <li>
                              <p>You want to drop the expression statistics.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C23883A8-DA95-482E-9954-EF4B5EBCA7B7__GUID-3291D629-F966-424B-95B7-14772FF7E1EB">To drop expression statistics:</p>
                        <ol>
                           <li>
                              <p>Start SQL*Plus and connect to the database as the <code class="codeph">sh</code> user.
                              </p>
                           </li>
                           <li>
                              <p>Drop the column group.</p>
                              <p>For example, the following PL/SQL program deletes a column group from the <code class="codeph">customers</code> table:
                              </p><pre class="pre codeblock"><code>BEGIN
  DBMS_STATS.DROP_EXTENDED_STATS(
    'sh'
,   'customers'
,   '(LOWER(cust_state_province))'
);
END;
/</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-C23883A8-DA95-482E-9954-EF4B5EBCA7B7__GUID-DCCF27AB-3C95-43AF-AAC7-DB58838AE445">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_STATS.html#ARPLS-GUID-64714B2B-E5CE-4C10-9F1E-25A9F254F6B1" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS.DROP_EXTENDED_STATS</code> procedure
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-extended-statistics.html#GUID-FC50E35E-AF6A-4ECD-919D-8E020011DAB6" title="The type of extended statistics known as expression statistics improve optimizer estimates when a WHERE clause has predicates that use expressions.">Managing Expression Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>