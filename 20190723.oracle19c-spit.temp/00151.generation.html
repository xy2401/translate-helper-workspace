<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented.">
      <meta name="description" content="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented.">
      <title>Generation of JSON Data with SQL/JSON Functions</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="JSON Developer's Guide">
      <meta property="og:description" content="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="JSON Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="json-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-22T10:58:31-08:00">
      <meta name="dcterms.title" content="JSON Developer's Guide">
      <meta name="dcterms.dateCopyrighted" content="2015, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96227-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="generation-of-json-data.html" title="Previous" type="text/html">
      <link rel="next" href="pl-sql-object-types-for-json.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADJSN">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="generation-of-json-data.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="pl-sql-object-types-for-json.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JSON Developer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="generation-of-json-data.html" property="item" typeof="WebPage"><span property="name">Generation of JSON Data</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Generation of JSON Data with SQL/JSON Functions</li>
            </ol>
            <a id="GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" name="GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A"></a>
            
            <h2 id="ADJSN-GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" class="sect2"><span class="enumeration_chapter">21 </span>Generation of JSON Data with SQL/JSON Functions
            </h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='generation'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
            </noscript>
            <div>
               <p>SQL/JSON functions <code class="codeph">json_object</code>, <code class="codeph">json_array</code>, <code class="codeph">json_objectagg</code>, and <code class="codeph">json_arrayagg</code> are presented.
               </p>
               <div class="section"></div>
               <!-- class="section" -->
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C">Overview of SQL/JSON Generation Functions</a><br>You can use SQL/JSON functions <code class="codeph">json_object</code>,       <code class="codeph">json_array</code>, <code class="codeph">json_objectagg</code>, and       <code class="codeph">json_arrayagg</code> to construct JSON data from non-JSON data in the database. The     JSON data is returned as a SQL value.
                  </li>
                  <li class="ulchildlink"><a href="generation.html#GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B">Handling of Input Values For SQL/JSON Generation Functions</a><br>The SQL/JSON generation functions take SQL values as input and render         them as JSON values inside the SQL value that is returned. How the input values are rendered         as JSON depends on their SQL data type. 
                  </li>
                  <li class="ulchildlink"><a href="generation.html#GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA">SQL/JSON Function JSON_OBJECT</a><br>SQL/JSON function <code class="codeph">json_object</code> constructs JSON objects       from relational (SQL) data. 
                  </li>
                  <li class="ulchildlink"><a href="generation.html#GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1">SQL/JSON Function JSON_ARRAY</a><br>SQL/JSON function <code class="codeph">json_array</code> constructs a JSON array from     the results of evaluating its argument SQL expressions. 
                  </li>
                  <li class="ulchildlink"><a href="generation.html#GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37">SQL/JSON Function JSON_OBJECTAGG</a><br>SQL/JSON function <code class="codeph">json_objectagg</code> constructs a JSON object   by aggregating information from multiple rows of a grouped SQL query as the object members. 
                  </li>
                  <li class="ulchildlink"><a href="generation.html#GUID-B0FA4582-762D-4C32-8A0C-265142BD347B">SQL/JSON Function JSON_ARRAYAGG</a><br>SQL/JSON function <code class="codeph">json_arrayagg</code> constructs a JSON array by   aggregating information from multiple rows of a grouped SQL query as the array elements. The order   of array elements reflects the query result order, by default, but you can use the <code class="codeph">ORDER    BY</code> clause to impose array element order.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="generation-of-json-data.html#GUID-D5DD4CFA-0675-4074-9D5B-F1AAE42DA719" title="You can use SQL to generate JSON data from other kinds of database data programmatically, using SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg.">Generation of JSON Data</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" name="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C"></a><h3 id="ADJSN-GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" class="sect3"><span class="enumeration_section">21.1 </span>Overview of SQL/JSON Generation
    Functions
               </h3>
               <div>
                  <p>You can use SQL/JSON functions <code class="codeph">json_object</code>,
      <code class="codeph">json_array</code>, <code class="codeph">json_objectagg</code>, and
      <code class="codeph">json_arrayagg</code> to construct JSON data from non-JSON data in the database. The
    JSON data is returned as a SQL value.
                  </p>
                  <p>These generation functions make it easy to construct JSON data directly from a
      SQL query. They allow non-JSON data to be represented as JSON objects and JSON arrays. You can
      generate complex, hierarchical JSON documents by nesting calls to these functions. Nested
      subqueries can generate JSON collections that represent one-to-many relationships.<a id="fn_1" name="fn_1" href="#fn_1" onclick="footdisplay(1, "The behavior of the SQL/JSON generation functions for JSON data is similar to that of the SQL/XML generation functions for XML data.")"><sup>Foot&nbsp;1</sup></a></p>
                  <div class="section" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__THESQLJSONGENERATIONFUNCTIONSARETHE-0BEE1127">
                     <p class="subhead2" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__THESQLJSONGENERATIONFUNCTIONSARETHE-0BEE0EDE">The Best Way to Construct JSON Data from
        Non-JSON Data</p>
                     <p>Alternatives to using the SQL/JSON generation functions
        are generally error prone or inefficient.</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Using <span class="italic">string concatenation</span> to generate JSON
            documents is error prone. In particular, there are a number of complex rules that must
            be respected concerning when and how to escape special characters, such as double
            quotation marks (<code class="codeph">"</code>). It is easy to overlook or misunderstand these
            rules, which can result in generating incorrect JSON data.
                           </p>
                        </li>
                        <li>
                           <p>Reading non-JSON result sets from the database and using
              <span class="italic">client-side application code</span> to generate JSON data is typically quite
            inefficient, particularly due to network overhead. When representing one-to-many
            relationships as JSON data, multiple <code class="codeph">SELECT</code> operations are often
            required, to collect all of the non-JSON data needed. If the documents to be generated
            represent multiple levels of one-to-many relationships then this technique can be quite
            costly.
                           </p>
                        </li>
                     </ul>
                     <p>The SQL/JSON generation functions do not suffer from such problems; they
        are designed for the job of constructing JSON data from non-JSON database data.</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>They always construct well-formed JSON documents.</p>
                        </li>
                        <li>
                           <p>By using SQL subqueries with these functions, you can
            generate an entire set of JSON documents using a single SQL statement, which allows the
            generation operation to be optimized.</p>
                        </li>
                        <li>
                           <p>Because only the generated documents are returned to a
            client, network overhead is minimized: there is at most one round trip per document
            generated.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__THESQLJSONGENERATIONFUNCTIONS-0BEDE84E">
                     <p class="subhead2" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__THESQLJSONGENERATIONFUNCTIONS-0BEDE5D6">The SQL/JSON Generation
        Functions</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Functions <code class="codeph"><span class="bold">json_object</span></code> and
                <code class="codeph"><span class="bold">json_array</span></code> construct a JSON object or array, respectively.
            In the simplest case, <code class="codeph">json_object</code> takes SQL name&#x2013;value pairs as
            arguments, and <code class="codeph">json_array</code> takes SQL values as arguments.
          
                           </p>
                        </li>
                        <li>
                           <p>Functions <code class="codeph"><span class="bold">json_objectagg</span></code>, and
                <code class="codeph"><span class="bold">json_arrayagg</span></code> are <span class="italic">aggregate</span> SQL functions. They
            transform information that is contained in the rows of a grouped SQL query into JSON
            objects and arrays, respectively. Evaluation of the arguments determines the number of
            object members and array elements, respectively; that is, the size of the result
            reflects the current queried data.
                           </p>
                           <p>For <code class="codeph">json_objectagg</code>
            and <code class="codeph">json_arrayagg</code>, the order of object members and array elements,
            respectively, is unspecified. For <code class="codeph">json_arrayagg</code>, you can use an
              <code class="codeph">ORDER BY</code> clause within the <code class="codeph">json_arrayagg</code> invocation
            to control the array element order.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__RESULTRETURNEDBYSQLJSONGENERATIONFU-02201A2A">
                     <p class="subhead2" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__GUID-49C0E367-25FE-455A-B57A-64FCFD36046B">Result Returned by SQL/JSON Generation
        Functions</p>
                     <p>By default, the generated JSON data is returned from a generation function as a SQL <code class="codeph">VARCHAR2</code> value. You can use the optional <code class="codeph">RETURNING</code> clause to specify a <code class="codeph">VARCHAR2</code> size or to specify a <code class="codeph">CLOB</code> or <code class="codeph">BLOB</code> return value instead. When <code class="codeph">BLOB</code> is the return type, the character set is AL32UTF8.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__HANDLINGOFINPUTVALUESFORSQLJSONGENE-E12FED19">
                     <p class="subhead2" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__HANDLINGOFINPUTVALUESFORSQLJSONGENE-E12FF10F">Handling of Input Values For SQL/JSON
        Generation Functions</p>
                     <p>The SQL/JSON generation functions take SQL
        values as input and render them as JSON values inside the SQL value that is returned. How
        the input values are rendered as JSON depends on their SQL data type.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__OPTIONALBEHAVIORFORSQLJSONGENERATIO-022017DB">
                     <p class="subhead2" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__GUID-ED4BFB13-FEB3-4097-B384-39867E4E5076">Optional Behavior For SQL/JSON Generation
        Functions</p>
                     <p>You can optionally specify a SQL
        <code class="codeph">NULL</code>-handling clause, a <code class="codeph">RETURNING</code> clause, and keyword
          <code class="codeph">STRICT</code>.
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">NULL</code>-handling clause — Determines how a SQL
              <code class="codeph">NULL</code> value resulting from input evaluation is
            handled.
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph"><span class="bold">NULL ON NULL</span></code> — An input SQL
                  <code class="codeph">NULL</code> value is converted to JSON <code class="codeph">null</code> for output.
                This is the default behavior for <code class="codeph">json_object</code> and
                  <code class="codeph">json_objectagg</code>.
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph"><span class="bold">ABSENT ON NULL</span></code> — An input SQL
                  <code class="codeph">NULL</code> value results in no corresponding output. This is the
                default behavior for <code class="codeph">json_array</code> and
                <code class="codeph">json_arrayagg</code>.
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p><code class="codeph"><span class="bold">RETURNING</span></code> clause — The SQL data type
            used for the function return value. The default is
          <code class="codeph">VARCHAR2(4000)</code>.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph"><span class="bold">STRICT</span></code> keyword — If present, the
            returned JSON data is checked, to be sure it is well-formed. If <code class="codeph">STRICT</code>
            is present and the returned data is not well-formed then an error is raised.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B" title="The SQL/JSON generation functions take SQL values as input and render them as JSON values inside the SQL value that is returned. How the input values are rendered as JSON depends on their SQL data type.">Handling of Input Values For SQL/JSON Generation Functions</a></li>
                        <li><a href="json-path-expressions.html#GUID-20DC09A8-98DF-4473-8077-913D490A969C" title="International Standards Organization (ISO) standard 8601 describes an internationally accepted way to represent dates and times. Oracle Database supports many of the ISO 8601 date and time formats.">ISO 8601 Date and Time Support</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C__GUID-21BC57D6-FD27-4CF8-8551-6A8F566A9B2E">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../sqlrf/JSON_ARRAY.html#SQLRF-GUID-46CDB3AF-5795-455B-85A8-764528CEC43B" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function
                <code class="codeph">json_array</code></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/JSON_ARRAYAGG.html#SQLRF-GUID-6D56077D-78DE-4CC0-9498-225DDC42E054" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function
                <code class="codeph">json_arrayagg</code></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/JSON_OBJECT.html#SQLRF-GUID-1EF347AE-7FDA-4B41-AFE0-DD5A49E8B370" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function
                <code class="codeph">json_object</code></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/JSON_OBJECTAGG.html#SQLRF-GUID-09422D4A-936C-4D38-9991-C64101283D98" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function
                <code class="codeph">json_objectagg</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented.">Generation of JSON Data with SQL/JSON Functions</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B" name="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B"></a><h3 id="ADJSN-GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B" class="sect3"><span class="enumeration_section">21.2 </span>Handling of Input Values For
        SQL/JSON Generation Functions
               </h3>
               <div>
                  <p>The SQL/JSON generation functions take SQL values as input and render
        them as JSON values inside the SQL value that is returned. How the input values are rendered
        as JSON depends on their SQL data type. </p>
                  <p>By default, a SQL <code class="codeph">NUMBER</code> value is rendered in the output as
            a JSON number, a SQL <code class="codeph">VARCHAR2</code> value is rendered as a JSON string, and
            so on. For example, by default the <code class="codeph">VARCHAR2</code> value <code class="codeph">'{}'</code>
            is rendered as the JSON string <code class="codeph">"{}"</code>.
                  </p>
                  <p>In some cases you know or expect that an input value in fact already
            represents JSON data, and you want to communicate this to the generation function so
            that the value is kept as is. For example, if the input is <code class="codeph">'{}'</code> then
            you might want it interpreted (rendered) as an empty JSON <span class="italic">object</span>,
                <code class="codeph">{}</code>, not as a JSON <span class="italic">string</span>, <code class="codeph">"{}"</code>.
                  </p>
                  <p>You can do this by adding keywords <code class="codeph"><span class="bold">FORMAT JSON</span></code> after
            an input expression to declare that the value that results from it is to be considered
            as already representing JSON data. Equivalently, you can apply SQL function
                    <code class="codeph"><span class="bold">treat</span></code> with keywords <code class="codeph"><span class="bold">AS JSON</span></code> to a
            generation-function input value — the effect is the same as using <code class="codeph">FORMAT
                JSON</code>.
                  </p>
                  <p>In many cases Oracle can determine automatically that an input value is in
            fact JSON data, in which case the input is treated as if it were followed by an explicit
                <code class="codeph">FORMAT JSON</code> declaration. This is the case, for instance, if the
            value expression is itself an invocation of a SQL/JSON generation function or function
                <code class="codeph">json_query</code>.
                  </p>
                  <p>If you do <span class="italic">not</span> specify <code class="codeph">FORMAT JSON</code> for a given input
            value, and if Oracle <span class="italic">cannot</span> determine that the value is JSON data, then it is
            assumed to be ordinary (non-JSON) SQL data. In that case it is serialized as follows
            (any other SQL value raises an error):
                  </p>
                  <ul style="list-style-type: disc;" id="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B__UL_WKM_CZJ_1GB">
                     <li>
                        <p>An instance of a user-defined SQL object type is
                    rendered as a JSON object whose field names are taken from the object attribute
                    names and whose field values are taken from the object attribute values (to
                    which JSON generation is applied recursively).</p>
                     </li>
                     <li>
                        <p>An instance of a SQL collection type is rendered as a
                    JSON array whose element values are taken from the collection element values (to
                    which JSON generation is applied recursively).</p>
                     </li>
                     <li>
                        <p>A <code class="codeph">VARCHAR2</code>, <code class="codeph">CLOB</code>, or
                        <code class="codeph">NVARCHAR</code> value is wrapped in double quotation marks
                            (<code class="codeph"><span class="bold">"</span></code>), and characters are escaped when necessary
                    to conform to the JSON standard.
                        </p>
                     </li>
                     <li>
                        <p>A numeric value (<code class="codeph">NUMBER</code>,
                        <code class="codeph">BINARY_DOUBLE</code>, or <code class="codeph">BINARY_FLOAT</code>) is
                    rendered as a JSON number. (It is not quoted.)
                        </p>
                        <p>The numeric values of
                    positive and negative infinity, and values that are the undefined result of a
                    numeric operation ("not a number" or <code class="codeph">NaN</code>), cannot be expressed
                    as JSON numbers. They are instead rendered as JSON strings:
                        <code class="codeph"><span class="bold">"Inf"</span></code>, <code class="codeph"><span class="bold">"-Inf"</span></code>, and
                            <code class="codeph"><span class="bold">"Nan"</span></code>, respectively.
                        </p>
                     </li>
                     <li>
                        <p>A <code class="codeph">RAW</code> or <code class="codeph">BLOB</code> value is
                    rendered as a hexadecimal JSON string (with double quotation marks,
                            <code class="codeph"><span class="bold">"</span></code>).
                        </p>
                     </li>
                     <li>
                        <p>A time-related value (<code class="codeph">DATE</code>,
                        <code class="codeph">TIMESTAMP</code>, <code class="codeph">TIMESTAMP WITH TIME ZONE</code>,
                        <code class="codeph">TIMESTAMP WITH LOCAL TIME ZONE</code>, <code class="codeph">INTERVAL YEAR TO
                        MONTH</code>, or <code class="codeph">INTERVAL DAY TO SECOND</code>) is rendered in a
                    supported ISO 8601 format, and the result is enclosed in double quotation marks
                            (<code class="codeph"><span class="bold">"</span></code>).
                        </p>
                     </li>
                     <li>
                        <p>A <code class="codeph">BOOLEAN</code> PL/SQL value is rendered as
                    JSON <code class="codeph">true</code> or <code class="codeph">false</code>. (It is not
                quoted.)
                        </p>
                     </li>
                     <li>
                        <p>A <code class="codeph">NULL</code> value is rendered as JSON
                        <code class="codeph">null</code>, regardless of the <code class="codeph">NULL</code> data type.
                    (It is not quoted.)
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B__GUID-D8225538-5B9B-407D-BD77-3275B36FEBA5">
                     <p class="notep1">Note:</p>
                     <p>For data types
                    <code class="codeph">CLOB</code> and <code class="codeph">BLOB</code>, an empty instance is
                distinguished from <code class="codeph">NULL</code> and is rendered as an empty JSON string
                        (<code class="codeph"><span class="bold">""</span></code>). But for data types <code class="codeph">VARCHAR2</code>,
                    <code class="codeph">NVARCHAR2</code>, and <code class="codeph">RAW</code>, Oracle SQL treats an empty
                (zero-length) value as <code class="codeph">NULL</code>, so do <span class="italic">not</span> expect such a value
                to be rendered as a JSON string. 
                     </p>
                  </div>
                  <p>The format of an input argument can affect the format of the data that is
            returned by the function. In particular, if an input is declared or automatically
            determined to be of format JSON then it is treated as JSON data when computing the
            return value. <a href="generation.html#GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B__DECLARINGANINPUTVALUETOBEJSON-04C5C58E">Example 21-1</a> illustrates this — it explicitly uses <code class="codeph">FORMAT JSON</code> to
            interpret the SQL string <code class="codeph">"true"</code> as the JSON Boolean value
                <code class="codeph">true</code>.
                  </p>
                  <div class="example" id="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B__DECLARINGANINPUTVALUETOBEJSON-04C5C58E">
                     <p class="titleinexample">Example 21-1 Declaring an Input Value To Be
                JSON</p>
                     <p>This example specifies <code class="codeph">FORMAT JSON</code> for
                SQL string values <code class="codeph">'true'</code> and <code class="codeph">'false'</code>, in order
                that the JSON Boolean values <code class="codeph">true</code> and <code class="codeph">false</code> are
                used. Without specifying <code class="codeph">FORMAT JSON</code>, the values of field
                    <code class="codeph">hasCommission</code> would be the JSON <span class="italic">string</span> values
                    <code class="codeph">"true"</code> and <code class="codeph">"false"</code>, not the JSON
                    <span class="italic">Boolean</span> values <code class="codeph">true</code> and
            <code class="codeph">false</code>.
                     </p><pre class="pre codeblock"><code>SELECT json_object('name'          VALUE first_name || ' ' || last_name,
                   'hasCommission' VALUE
                     CASE WHEN commission_pct IS NULL THEN 'false' ELSE 'true'
                     END <span class="bold">FORMAT JSON</span>)
  FROM employees WHERE first_name LIKE 'W%';

JSON_OBJECT('NAME'ISFIRST_NAME||''||LAST_NAME,'
-----------------------------------------------
{"name":"William Gietz","hasCommission":<span class="bold">false</span>}
{"name":"William Smith","hasCommission":<span class="bold">true</span>}
{"name":"Winston Taylor","hasCommission":<span class="bold">false</span>}
</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" title="You can use SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg to construct JSON data from non-JSON data in the database. The JSON data is returned as a SQL value.">Overview of SQL/JSON Generation Functions</a></li>
                        <li><a href="generation.html#GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA" title="SQL/JSON function json_object constructs JSON objects from relational (SQL) data.">SQL/JSON Function JSON_OBJECT</a></li>
                        <li><a href="generation.html#GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1" title="SQL/JSON function json_array constructs a JSON array from the results of evaluating its argument SQL expressions.">SQL/JSON Function JSON_ARRAY</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B__GUID-1F74EF1D-D404-4D0E-BF87-FD5AA6768CAC">
                     <p class="notep1">See Also:</p>
                     <p><a href="../sqlrf/Data-Types.html#SQLRF-GUID-7B72E154-677A-4342-A1EA-C74C1EA928E6" target="_blank">https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=SQLRF-GUID-7B72E154-677A-4342-A1EA-C74C1EA928E6#GUID-7B72E154-677A-4342-A1EA-C74C1EA928E6</a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented.">Generation of JSON Data with SQL/JSON Functions</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA" name="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA"></a><h3 id="ADJSN-GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA" class="sect3"><span class="enumeration_section">21.3 </span>SQL/JSON Function
      JSON_OBJECT
               </h3>
               <div>
                  <p>SQL/JSON function <code class="codeph">json_object</code> constructs JSON objects
      from relational (SQL) data. 
                  </p>
                  <p>It accepts any number of arguments, each of which can be any of the
         following:</p>
                  <ul style="list-style-type: disc;" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__UL_W13_5TS_1GB">
                     <li>
                        <p>An explicit field name&#x2013;value pair. Example: <code class="codeph">answer
                  : 42</code>.
                        </p>
                     </li>
                     <li>
                        <p>A table name or alias, or a view name, followed by a dot and an asterisk wildcard (<code class="codeph"><span class="bold">.*</span></code>). Example: <code class="codeph">t1.*</code>. (The name or alias can also be prefixed by a database schema name, as in <code class="codeph">myschema.t1.*</code>.)
                        </p>
                     </li>
                     <li>
                        <p>A relational column name, possibly preceded by a table
               name or alias, or a view name followed by a dot (<code class="codeph"><span class="bold">.</span></code>). Example:
                  <code class="codeph">t1.address</code>.
                        </p>
                     </li>
                  </ul>
                  <p>Alternatively, it accepts a <span class="italic">single</span> argument that is an asterisk
         wildcard (<code class="codeph"><span class="bold">*</span></code>) or a single instance of a user-defined SQL
         object-type.
                  </p>
                  <p>Another way of describing the use of asterisk wildcards is to say that it
         follows what is allowed for wildcards in a SQL <code class="codeph">SELECT</code> list.
                  </p>
                  <p>A <span class="italic">name&#x2013;value</span> pair argument specifies an object member for the generated
         JSON object (except when the value expression evaluates to SQL <code class="codeph">NULL</code> and
         the <code class="codeph">ABSENT ON NULL</code> clause applies). The name and value are SQL
         expressions. The <span class="italic">name</span> expression must evaluate to a SQL <span class="italic">string</span>. The
            <span class="italic">value</span> expression must evaluate to a SQL value that can be rendered as a JSON
         value. The name and value expressions are separated by keyword
            <code class="codeph"><span class="bold">VALUE</span></code> or a colon (<code class="codeph"><span class="bold">:</span></code>).
                  </p>
                  <div class="infoboxnote" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-30362697-259A-415C-AD22-A9C059AB6AE3">
                     <p class="notep1">Note:</p>
                     <p>Some client drivers might
            try to scan query text and identify bind variables before sending the query to the
            database. In some such cases a colon as name&#x2013;value separator in
               <code class="codeph">json_object</code> might be misinterpreted as introducing a bind variable.
            You can use keyword <code class="codeph">VALUE</code> as the separator to avoid this problem
               (<code class="codeph">'Name' VALUE Diderot</code>), or you can simply enclose the value part of
            the pair in parentheses: <code class="codeph">'Name':(Diderot)</code>.
                     </p>
                  </div>
                  <p>If you use a <span class="italic">column name</span> as an argument then, for a given row of data,
         the object member specified by the column-name argument has the column name as its field
         name and the column value as the field value. Regardless of whether it is quoted, the
         column name you provide is interpreted <span class="italic">case-sensitively</span>. For example, if you use
            <code class="codeph">Email</code> as a column-name argument then the data in column
            <code class="codeph">EMAIL</code> is used to produce object members with field name
            <code class="codeph">Email</code>.
                  </p>
                  <p>You can use an asterisk (<code class="codeph"><span class="bold">*</span></code>) <span class="italic">wildcard</span> as a
         shortcut to explicitly specifying <span class="italic">all</span> of the columns of a given table or view to
         produce object members. The resulting object field names are the <span class="italic">uppercase</span> column
         names. You can use a wildcard with a table, a view, or a table alias.
                  </p>
                  <p>Instead of passing SQL expressions that are used to define individual JSON
         object members, you can pass a single instance of a user-defined SQL object type. This
         produces a JSON object whose field names are taken from the object attribute names and
         whose field values are taken from the object attribute values (to which JSON generation is
         applied recursively).</p>
                  <div class="example" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-D46A2775-B3A9-4153-A016-2D3D67B8D745">
                     <p class="titleinexample">Example 21-2 Using Name&#x2013;Value Pairs with JSON_OBJECT
            </p>
                     <p>This example constructs a JSON object for each employee of table
               <code class="codeph">hr.employees</code> (from standard database schema <code class="codeph">HR</code>)
            whose salary is greater than 15000. 
                     </p>
                     <p>It passes explicit name&#x2013;value
            pairs to specify the JSON object members. The JSON object includes, as the value of its
            field <code class="codeph">contactInfo</code>, an object with fields <code class="codeph">mail</code> and
               <code class="codeph">phone</code>.
                     </p>
                     <p>Because the return value of
               <code class="codeph">json_object</code> is JSON data, <code class="codeph">FORMAT JSON</code> is deduced
            for the input format of field <code class="codeph">contactInfo</code> — the explicit <code class="codeph">FORMAT
               JSON</code> here is not needed.
         
                     </p><pre class="pre codeblock"><code>SELECT <span class="bold">json_object</span>('id'          : employee_id,
                   'name'        : first_name || ' ' || last_name,
                   'hireDate'    : hire_date,
                   'pay'         : salary,
                   'contactInfo' : <span class="bold">json_object</span>('mail'  : email,
                                               'phone' : phone_number)
                   FORMAT JSON) 
  FROM hr.employees
  WHERE salary &gt; 15000;

-- The query returns rows such as this (pretty-printed here for clarity):

{"id"          : 101,
 "name"        : "Neena Kochhar",
 "hireDate"    : "21-SEP-05",
 "pay"         : 17000,
 "contactInfo" : {"mail"  : "NKOCHHAR",
                  "phone" : "515.123.4568"}}</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-0CD0015D-98BB-4311-AB57-1631CA78888E">
                     <p class="titleinexample">Example 21-3 Using Column Names with
            JSON_OBJECT</p>
                     <p>This example constructs a JSON object for the
            employee whose <code class="codeph">employee_id</code> is <code class="codeph">101</code>. The fields produced
            are named after the columns, but
         case-sensitively.
                     </p><pre class="pre codeblock"><code>SELECT <span class="bold">json_object</span>(last_name,
                   hire_date,
                   salary,
                   'contactInfo' : <span class="bold">json_object</span>(email, phone_number)
                   FORMAT JSON) 
  FROM hr.employees
  WHERE employee_id = 101;

-- The query returns rows such as this (pretty-printed here for clarity):

{"last_name"   : "Neena Kochhar",
 "hire-date"   : "21-SEP-05",
 "salary"      : 17000,
 "contactInfo" : {"email"        : "NKOCHHAR",
                  "phone_number" : "515.123.4568"}}</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-C401997F-825D-4A9E-B24A-0519CC270C8D">
                     <p class="titleinexample">Example 21-4 Using a Wildcard (*) with
            JSON_OBJECT</p>
                     <p>This example constructs a JSON object for
            each employee whose salary is greater than 15000. Each column of table employees is used
            to construct one object member, whose field name is the (uppercase) column name. Note
            that a SQL <code class="codeph">NULL</code> value results in a JSON field value of
               <code class="codeph">null</code>.
                     </p><pre class="pre codeblock"><code>SELECT <span class="bold">json_object</span>(<span class="bold">*</span>)
  FROM hr.employees
  WHERE salary &gt; 15000;

-- The query returns rows such as this (pretty-printed here for clarity):

JSON_OBJECT(*)
--------------
{"EMPLOYEE_ID":100,
 "FIRST_NAME":"Steven",
 "LAST_NAME":"King",
 "EMAIL":"SKING",
 "PHONE_NUMBER":"515.123.4567",
 "HIRE_DATE":"2003-06-17T00:00:00",
 "JOB_ID":"AD_PRES",
 "SALARY":24000,
 "COMMISSION_PCT":null,
 "MANAGER_ID":null,
 "DEPARTMENT_ID":90}

{"EMPLOYEE_ID":101,
 "FIRST_NAME":"Neena",
 "LAST_NAME":"Kochhar",
 "EMAIL":"NKOCHHAR",
 "PHONE_NUMBER":"515.123.4568",
 "HIRE_DATE":"2005-09-21T00:00:00",
 "JOB_ID":"AD_VP",
 "SALARY":17000,
 "COMMISSION_PCT":null,
 "MANAGER_ID":100,
 "DEPARTMENT_ID":90}

{"EMPLOYEE_ID":102,
 "FIRST_NAME":"Lex",
 "LAST_NAME":"De Haan",
 "EMAIL":"LDEHAAN",
 "PHONE_NUMBER":"515.123.4569",
 "HIRE_DATE":"2001-01-13T00:00:00",
 "JOB_ID":"AD_VP",
 "SALARY":17000,
 "COMMISSION_PCT":null,
 "MANAGER_ID":100,
 "DEPARTMENT_ID":90}</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-BE6CB437-2C5B-4D9B-9E91-0EBA4B0E97F3">
                     <p class="titleinexample">Example 21-5 Using JSON_OBJECT With ABSENT ON
            NULL</p>
                     <p>This example queries table <code class="codeph">hr.locations</code> from
            standard database schema <code class="codeph">HR</code> to create JSON objects with fields
               <code class="codeph">city</code> and <code class="codeph">province</code>.
                     </p>
                     <p>The default
               <code class="codeph">NULL</code>-handling behavior for <code class="codeph">json_object</code> is
               <code class="codeph">NULL ON NULL</code>. 
                     </p>
                     <p>In order to prevent the creation
            of a field with a <code class="codeph">null</code> JSON value, this example uses <code class="codeph">ABSENT ON
               NULL</code>. The <code class="codeph">NULL</code> SQL value for column
               <code class="codeph">state_province</code> when column <code class="codeph">city</code> has value
               <code class="codeph">'Singapore'</code> means that no <code class="codeph">province</code> field is created
            for that
         location.
                     </p><pre class="pre codeblock"><code>SELECT JSON_OBJECT('city'     VALUE city,
                   'province' : state_province <span class="bold">ABSENT ON NULL</span>) 
  FROM hr.locations
  WHERE city LIKE 'S%';

JSON_OBJECT('CITY'ISCITY,'PROVINCE'ISSTATE_PROVINCEABSENTONNULL)
----------------------------------------------------------------
{"city":"Southlake",<span class="italic">"province"</span>:"Texas"}
{"city":"South San Francisco",<span class="italic">"province"</span>:"California"}
{"city":"South Brunswick",<span class="italic">"province"</span>:"New Jersey"}
{"city":"Seattle",<span class="italic">"province"</span>:"Washington"}
{"city":"Sydney",<span class="italic">"province"</span>:"New South Wales"}
<span class="bold">{"city":"Singapore"}</span>
{"city":"Stretford",<span class="italic">"province"</span>:"Manchester"}
{"city":"Sao Paulo",<span class="italic">"province"</span>:"Sao Paulo"}
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-F476C9BD-3A5E-45AA-92A0-0806881CAE04">
                     <p class="titleinexample">Example 21-6 Using a User-Defined Object-Type Instance
            with
            JSON_OBJECT</p>
                     <p>This example creates table
               <code class="codeph">po_ship</code> with column <code class="codeph">shipping</code> of object type
               <code class="codeph">shipping_t</code>. (It uses SQL/JSON function <code class="codeph">json_value</code>
            to construct the <code class="codeph">shipping_t</code> instances from JSON data — see <a href="function-JSON_VALUE.html#GUID-622170D8-7BAD-4F5F-86BF-C328451FC3BE__GUID-F8C5F1BC-B369-4E4D-8EBC-BCE8EE7BEE3E">Example 16-3</a>.)
                     </p>
                     <p>It then uses <code class="codeph">json_object</code> to
            generate JSON objects from the SQL object-type instances in column
               <code class="codeph">po_ship.shipping</code>.
                     </p>
                     <p>(The query output is shown
            pretty-printed here, for
         clarity.)</p><pre class="pre codeblock"><code>CREATE TABLE <span class="bold">po_ship</span>
  AS SELECT json_value(po_document, '$.ShippingInstructions'
                       RETURNING <span class="bold">shipping_t</span>)
  <span class="bold">shipping</span>
  FROM j_purchaseorder;

DESCRIBE po_ship;

Name      Null?   Type
--------- ------- ----------
<span class="bold">SHIPPING</span>          <span class="bold">SHIPPING_T</span>

SELECT <span class="bold">json_object</span>(<span class="bold">shipping</span>) from po_ship;

JSON_OBJECT(SHIPPING)
---------------------
{"NAME":"Alexis Bull",
 "ADDRESS":{"STREET":"200 Sporting Green",
            "CITY":"South San Francisco"}}
{"NAME":"Sarah Bell",
 "ADDRESS":{"STREET":"200 Sporting Green",
            "CITY":"South San Francisco"}}</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" title="You can use SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg to construct JSON data from non-JSON data in the database. The JSON data is returned as a SQL value.">Overview of SQL/JSON Generation Functions</a></li>
                        <li><a href="generation.html#GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B" title="The SQL/JSON generation functions take SQL values as input and render them as JSON values inside the SQL value that is returned. How the input values are rendered as JSON depends on their SQL data type.">Handling of Input Values For SQL/JSON Generation Functions</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA__GUID-4232E956-EC4B-45E1-A24B-F9BF9BB4AD46">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../sqlrf/SELECT.html#SQLRF-GUID-CFA006CA-6FF1-4972-821E-6996142A51C6" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a>
                     for information about the <code class="codeph">select_list</code> syntax
                           </p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/JSON_OBJECT.html#SQLRF-GUID-1EF347AE-7FDA-4B41-AFE0-DD5A49E8B370" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON
                     function <code class="codeph">json_object</code></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/Database-Object-Names-and-Qualifiers.html#SQLRF-GUID-3C59E44A-5140-4BCA-B9E1-3039C8050C49" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for SQL identifier
                  syntax
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented.">Generation of JSON Data with SQL/JSON Functions</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1" name="GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1"></a><h3 id="ADJSN-GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1" class="sect3"><span class="enumeration_section">21.4 </span>SQL/JSON Function
    JSON_ARRAY
               </h3>
               <div>
                  <p>SQL/JSON function <code class="codeph">json_array</code> constructs a JSON array from
    the results of evaluating its argument SQL expressions. 
                  </p>
                  <p>In the simplest case, the evaluated arguments you provide to
        <code class="codeph">json_array</code> are SQL values that are converted to JSON values as the JSON
      array elements. The resulting array has an element for each argument you provide (except when
      an argument expression evaluates to SQL <code class="codeph">NULL</code> and the <code class="codeph">ABSENT ON
        NULL</code> clause applies). Array element order is the same as the argument order.
                  </p>
                  <p>There are several kinds of SQL values that you can use as an argument to
        <code class="codeph">json_array</code>, including scalar, collection instance, and user-defined
      object-type instance.
                  </p>
                  <div class="example" id="GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1__GUID-6035C6C4-1952-4A61-865A-1031F76C5131">
                     <p class="titleinexample">Example 21-7 Using JSON_ARRAY to Construct a JSON
        Array</p>
                     <p>This example constructs a JSON object for each employee job in
        database table <code class="codeph">hr.jobs</code> (from standard database schema <code class="codeph">HR</code>).
        The fields of the objects are the job title and salary range. The salary range (field
          <code class="codeph">salaryRange</code>) is an array of two numeric values, the minimum and maximum
        salaries for the job. These values are taken from SQL columns <code class="codeph">min_salary</code>
        and
      <code class="codeph">max_salary</code>.
                     </p><pre class="pre codeblock"><code>SELECT json_object('title'       VALUE job_title, 
                   'salaryRange' VALUE <span class="bold">json_array</span>(min_salary, max_salary))
  FROM jobs;

JSON_OBJECT('TITLE'ISJOB_TITLE,'SALARYRANGE'ISJSON_ARRAY(MIN_SALARY,MAX_SALARY))
--------------------------------------------------------------------------------
{"title":"President","salaryRange":[20080,40000]}
{"title":"Administration Vice President","salaryRange":[15000,30000]}
{"title":"Administration Assistant","salaryRange":[3000,6000]}
{"title":"Finance Manager","salaryRange":[8200,16000]}
{"title":"Accountant","salaryRange":[4200,9000]}
{"title":"Accounting Manager","salaryRange":[8200,16000]}
{"title":"Public Accountant","salaryRange":[4200,9000]}
{"title":"Sales Manager","salaryRange":[10000,20080]}
{"title":"Sales Representative","salaryRange":[6000,12008]}
{"title":"Purchasing Manager","salaryRange":[8000,15000]}
{"title":"Purchasing Clerk","salaryRange":[2500,5500]}
{"title":"Stock Manager","salaryRange":[5500,8500]}
{"title":"Stock Clerk","salaryRange":[2008,5000]}
{"title":"Shipping Clerk","salaryRange":[2500,5500]}
{"title":"Programmer","salaryRange":[4000,10000]}
{"title":"Marketing Manager","salaryRange":[9000,15000]}
{"title":"Marketing Representative","salaryRange":[4000,9000]}
{"title":"Human Resources Representative","salaryRange":[4000,9000]}
{"title":"Public Relations Representative","salaryRange":[4500,10500]}
</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" title="You can use SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg to construct JSON data from non-JSON data in the database. The JSON data is returned as a SQL value.">Overview of SQL/JSON Generation Functions</a></li>
                        <li><a href="generation.html#GUID-2916ECA4-D033-4232-8CFE-CF9801F5AF2B" title="The SQL/JSON generation functions take SQL values as input and render them as JSON values inside the SQL value that is returned. How the input values are rendered as JSON depends on their SQL data type.">Handling of Input Values For SQL/JSON Generation Functions</a></li>
                        <li><a href="generation.html#GUID-1084A518-A44A-4654-A796-C1DD4D8EC2AA" title="SQL/JSON function json_object constructs JSON objects from relational (SQL) data.">SQL/JSON Function JSON_OBJECT</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-F942D202-E4BB-4ED8-997E-AEBD6D8ED8C1__GUID-5A9973C7-8BEA-43D7-BF48-104499131741">
                     <p class="notep1">See Also:</p>
                     <p><a href="../sqlrf/JSON_ARRAY.html#SQLRF-GUID-46CDB3AF-5795-455B-85A8-764528CEC43B" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function
            <code class="codeph">json_array</code></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented.">Generation of JSON Data with SQL/JSON Functions</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37" name="GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37"></a><h3 id="ADJSN-GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37" class="sect3"><span class="enumeration_section">21.5 </span>SQL/JSON Function JSON_OBJECTAGG
               </h3>
               <div>
                  <p>SQL/JSON function <code class="codeph">json_objectagg</code> constructs a JSON object
  by aggregating information from multiple rows of a grouped SQL query as the object members. 
                  </p>
                  <p>Unlike the case for SQL/JSON function <code class="codeph">json_object</code>, where the
   number of members in the resulting object directly reflects the number of arguments, for
    <code class="codeph">json_objectagg</code> the size of the resulting object reflects the current queried
   data. It can thus vary, depending on the data that is queried.
                  </p>
                  <div class="example" id="GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37__GUID-470D6D38-3CF7-4E7B-A5A5-C30FACF1C4F4">
                     <p class="titleinexample">Example 21-8 Using JSON_OBJECTAGG to Construct a JSON
    Object</p>
                     <p>This example constructs a single JSON object from table
     <code class="codeph">hr.departments</code> (from standard database schema <code class="codeph">HR</code>) using field
    names taken from column <code class="codeph">department_name</code> and field values taken from column
     <code class="codeph">department_id</code>.
   
                     </p><pre class="pre codeblock"><code>SELECT <span class="bold">json_objectagg</span>(department_name VALUE department_id) FROM departments;

-- The returned object is pretty-printed here for clarity.
-- The order of the object members is arbitrary.

JSON_OBJECTAGG(DEPARTMENT_NAMEISDEPARTMENT_ID)
----------------------------------------------
{"Administration":        10,
 "Marketing":             20,
 "Purchasing":            30,
 "Human Resources":       40,
 "Shipping":              50,
 "IT":                    60,
 "Public Relations":      70,
 "Sales":                 80,
 "Executive":             90,
 "Finance":              100,
 "Accounting":           110,
 "Treasury":             120,
 "Corporate Tax":        130,
 "Control And Credit":   140,
 "Shareholder Services": 150,
 "Benefits":             160,
 "Manufacturing":        170,
 "Construction":         180,
 "Contracting":          190,
 "Operations":           200,
 "IT Support":           210,
 "NOC":                  220,
 "IT Helpdesk":          230,
 "Government Sales":     240,
 "Retail Sales":         250,
 "Recruiting":           260,
 "Payroll":              270}
</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" title="You can use SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg to construct JSON data from non-JSON data in the database. The JSON data is returned as a SQL value.">Overview of SQL/JSON Generation Functions</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-E4DDB4E8-A4B9-4EA9-BC26-1879AA661D37__GUID-D06A8DC7-444C-470F-A4D6-46DA0DDF1CDF">
                     <p class="notep1">See Also:</p>
                     <p><a href="../sqlrf/JSON_OBJECTAGG.html#SQLRF-GUID-09422D4A-936C-4D38-9991-C64101283D98" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a>
     for information about SQL/JSON function <code class="codeph">json_objectagg</code></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented.">Generation of JSON Data with SQL/JSON Functions</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-B0FA4582-762D-4C32-8A0C-265142BD347B" name="GUID-B0FA4582-762D-4C32-8A0C-265142BD347B"></a><h3 id="ADJSN-GUID-B0FA4582-762D-4C32-8A0C-265142BD347B" class="sect3"><span class="enumeration_section">21.6 </span>SQL/JSON Function JSON_ARRAYAGG
               </h3>
               <div>
                  <p>SQL/JSON function <code class="codeph">json_arrayagg</code> constructs a JSON array by
  aggregating information from multiple rows of a grouped SQL query as the array elements. The order
  of array elements reflects the query result order, by default, but you can use the <code class="codeph">ORDER
   BY</code> clause to impose array element order.
                  </p>
                  <p>Unlike the case for SQL/JSON function <code class="codeph">json_array</code>, where the
   number of elements in the resulting array directly reflects the number of arguments, for
    <code class="codeph">json_arrayagg</code> the size of the resulting array reflects the current queried
   data. It can thus vary, depending on the data that is queried.
                  </p>
                  <div class="example" id="GUID-B0FA4582-762D-4C32-8A0C-265142BD347B__GUID-E9251967-C6EB-4025-8A92-FC7262C6D490">
                     <p class="titleinexample">Example 21-9 Using JSON_ARRAYAGG to Construct a JSON
    Array</p>
                     <p>This example constructs a JSON object for each employee of table
     <code class="codeph">hr.employees</code> (from standard database schema <code class="codeph">HR</code>) who is a
    manager in charge of at least six employees. The objects have fields for the manager id number,
    manager name, number of employees reporting to the manager, and id numbers of those employees.
    
                     </p>
                     <p>The order of the employee id numbers in the array is determined by the
     <code class="codeph">ORDER BY</code> clause for <code class="codeph">json_arrayagg</code>. The default direction for
     <code class="codeph">ORDER BY</code> is <code class="codeph">ASC</code> (ascending). The array elements, which are
    numeric, are in ascending numerical
   order.
                     </p><pre class="pre codeblock"><code>SELECT json_object('id'         VALUE mgr.employee_id, 
                   'manager'    VALUE (mgr.first_name || ' '|| mgr.last_name),
                   'numReports' VALUE count(rpt.employee_id),
                   'reports'    VALUE <span class="bold">json_arrayagg</span>(rpt.employee_id
                                                    <span class="bold">ORDER BY</span> rpt.employee_id))
  FROM  employees mgr, employees rpt
  WHERE mgr.employee_id = rpt.manager_id
  <span class="bold">GROUP BY</span> mgr.employee_id, mgr.last_name, mgr.first_name
  HAVING count(rpt.employee_id) &gt; 6;

-- The returned object is pretty-printed here for clarity.

JSON_OBJECT('ID'ISMGR.EMPLOYEE_ID,'MANAGER'VALUE(MGR.FIRST_NAME||''||MGR.LAST_NAME)
-----------------------------------------------------------------------------------
{"id":         100,
 "manager":    "Steven King",
 "numReports": 14,
 "reports":    <span class="bold">[101,102,114,120,121,122,123,124,145,146,147,148,149,201]</span>}

{"id":         120,
 "manager":    "Matthew Weiss",
 "numReports": 8,
 "reports":    <span class="bold">[125,126,127,128,180,181,182,183]</span>}

{"id":         121,
 "manager":    "Adam Fripp",
 "numReports": 8,
 "reports":    <span class="bold">[129,130,131,132,184,185,186,187]</span>}

{"id":         122,
 "manager":    "Payam Kaufling",
 "numReports": 8,
 "reports":    <span class="bold">[133,134,135,136,188,189,190,191]</span>}

{"id":         123,
 "manager":    "Shanta Vollman",
 "numReports": 8,
 "reports":    <span class="bold">[137,138,139,140,192,193,194,195]</span>}

{"id":         124,
 "manager":    "Kevin Mourgos",
 "numReports": 8,
 "reports":    <span class="bold">[141,142,143,144,196,197,198,199]</span>}
</code></pre></div>
                  <!-- class="example" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="generation.html#GUID-C0F8F837-EE36-4EDD-9261-6E8A9245906C" title="You can use SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg to construct JSON data from non-JSON data in the database. The JSON data is returned as a SQL value.">Overview of SQL/JSON Generation Functions</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-B0FA4582-762D-4C32-8A0C-265142BD347B__GUID-F6D14467-FFB8-4CC2-A3CB-711024B92EFF">
                     <p class="notep1">See Also:</p>
                     <p><a href="../sqlrf/JSON_ARRAYAGG.html#SQLRF-GUID-6D56077D-78DE-4CC0-9498-225DDC42E054" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function
      <code class="codeph">json_arrayagg</code></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="generation.html#GUID-6C3441E8-4F02-4E95-969C-BBCA6BDBBD9A" title="SQL/JSON functions json_object, json_array, json_objectagg, and json_arrayagg are presented.">Generation of JSON Data with SQL/JSON Functions</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <hr><br><p style="text-decoration:underline">Footnote Legend</p>Footnote&nbsp;1: The behavior of the SQL/JSON generation functions for JSON data is similar to
        that of the SQL/XML generation functions for XML data.<br></div>
      </article>
   </body>
</html>