<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Advanced Queuing (AQ) is a robust and feature-rich message queuing system integrated with Oracle Database. These topics discuss Oracle Database Advanced Queuing (AQ) and the requirements for complex information handling in an integrated environment.">
      <meta name="description" content="Advanced Queuing (AQ) is a robust and feature-rich message queuing system integrated with Oracle Database. These topics discuss Oracle Database Advanced Queuing (AQ) and the requirements for complex information handling in an integrated environment.">
      <title>Introduction to Oracle Database Advanced Queuing</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Advanced Queuing User's Guide ">
      <meta property="og:description" content="Advanced Queuing (AQ) is a robust and feature-rich message queuing system integrated with Oracle Database. These topics discuss Oracle Database Advanced Queuing (AQ) and the requirements for complex information handling in an integrated environment.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Advanced Queuing User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-database-advanced-queuing.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T10:53:09-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96511-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="rel-changes.html" title="Previous" type="text/html">
      <link rel="next" href="aq-basic-components.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OracleÂ® Database Advanced Queuing">
    <meta name="dcterms.isVersionOf" content="ADQUE">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rel-changes.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="aq-basic-components.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Advanced Queuing User's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Introduction to Oracle Database Advanced Queuing</li>
            </ol>
            <a id="GUID-95868022-ECDA-4685-9D0A-52ED7663C84B" name="GUID-95868022-ECDA-4685-9D0A-52ED7663C84B"></a><a id="ADQUE0100"></a>
            
            <h2 id="ADQUE-GUID-95868022-ECDA-4685-9D0A-52ED7663C84B" class="sect2"><span class="enumeration_chapter">1 </span> Introduction to Oracle Database Advanced Queuing
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Advanced Queuing (AQ) is a robust and feature-rich message queuing system integrated with Oracle Database. These topics discuss Oracle Database Advanced Queuing (AQ) and the requirements for complex information handling in an integrated environment. </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="aq-introduction.html#GUID-9714FE10-9721-4C78-93C6-0A3C4D9F5CBD" title="Advanced Queuing stores user messages in abstract storage units called queues. When Web-based business applications communicate with each other, producer applications enqueue messages and consumer applications dequeue messages.">What Is Queuing?</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7" title="Oracle Database Advanced Queuing provides database-integrated message queuing functionality. This functionality leverages the functions of Oracle Database so that messages can be stored persistently, propagated between queues on different computers and databases, and transmitted using Oracle Net Services and HTTP(S).">Oracle Database Advanced Queuing Leverages Oracle Database</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D" title="Oracle Database Advanced Queuing provides the message management and communication needed for application integration. In an integrated environment, messages travel between the Oracle Database server, applications, and users.">Oracle Database Advanced Queuing in Integrated Application Environments</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27" title="Buffered messaging combines the rich functionality that this product has always offered with a much faster queuing implementation. Buffered messaging is ideal for applications that do not require the reliability and transaction support of Oracle Database Advanced Queuing persistent messaging.">Buffered Messaging</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271" title="Asynchronous notification allows clients to receive notifications of messages of interest.">Asynchronous Notifications</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A" title="This topic describes the enqueue features Enqueuing an Array of Messages, Correlation Identifiers, Priority and Ordering of Messages in Enqueuing, Message Grouping, Sender Identification, and Time Specification and Scheduling.">Enqueue Features</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A" title="This topic discusses the dequeue features Concurrent Dequeues, Dequeue Methods, Dequeue Modes, Dequeue an Array of Messages, Message States, Navigation of Messages in Dequeuing, Waiting for Messages, Retries with Delays, Optional Transaction Protection, and Exception Queues.">Dequeue Features</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-329A6279-925C-435B-A6F1-76835EF20C40" title="Messages can be propagated from one queue to another, allowing applications to communicate with each other without being connected to the same database or to the same queue. The destination queue can be located in the same database or in a remote database.">Propagation Features</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9" title="Applications often use data in different formats. A transformation defines a mapping from one Oracle data type to another.">Message Format Transformation</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F" title="This topic describes the AQ features Queue Monitor Coordinator, Integration with Oracle Internet Directory, Integration with Oracle Enterprise Manager, Retention and Message History, Cleaning Up Message Queues, Tracking and Event Journals, Non-repudiation, and Internet Integration.">Other Oracle Database Advanced Queuing Features</a></p>
                  </li>
                  <li>
                     <p><a href="aq-introduction.html#GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327" title="You can access Oracle Database Advanced Queuing functionality through the interfaces listed in this topic.">Interfaces to Oracle Database Advanced Queuing</a></p>
                  </li>
               </ul>
            </div><a id="ADQUE2418"></a><div class="props_rev_3"><a id="GUID-9714FE10-9721-4C78-93C6-0A3C4D9F5CBD" name="GUID-9714FE10-9721-4C78-93C6-0A3C4D9F5CBD"></a><h3 id="ADQUE-GUID-9714FE10-9721-4C78-93C6-0A3C4D9F5CBD" class="sect3"><span class="enumeration_section">1.1 </span>What Is Queuing?
               </h3>
               <div>
                  <p>Advanced Queuing stores user messages in abstract storage units called queues. When Web-based business applications communicate with each other, producer applications enqueue messages and consumer applications dequeue messages. </p>
                  <p>At the most basic level of queuing, one producer enqueues one or more messages into one queue. Each <a href="glossary.html#GUID-2028AECF-DB3E-40E2-99B6-A35674C08038"><span class="xrefglossterm">message</span></a> is dequeued and processed once by one of the consumers. A message stays in the <a href="glossary.html#GUID-583DEF67-C9BC-4B83-B8DC-2375A5BE08BB"><span class="xrefglossterm">queue</span></a> until a consumer dequeues it or the message expires. A <a href="glossary.html#GUID-B9E1FDFC-EDA0-4D9C-8D65-FE429EF9043C"><span class="xrefglossterm">producer</span></a> can stipulate a delay before the message is available to be consumed, and a time after which the message expires. Likewise, a <a href="glossary.html#GUID-B9071BDE-395F-4686-B2D2-A1B83F986BCC"><span class="xrefglossterm">consumer</span></a> can wait when trying to <a href="glossary.html#GUID-BC8D60E8-953A-4C6C-8163-F7AE187B768B"><span class="xrefglossterm">dequeue</span></a> a message if no message were available. An agent program or application could act as both a producer and a consumer.
                  </p>
                  <p>Producers can <a href="glossary.html#GUID-B21E60F7-4BFA-42A2-9A8F-B781C2A55ED9"><span class="xrefglossterm">enqueue</span></a> messages in any sequence. Messages are not necessarily dequeued in the order in which they are enqueued. Messages can be enqueued without being dequeued.
                  </p>
                  <p>At a slightly higher level of complexity, many producers enqueue messages into a queue, all of which are processed by one consumer. Or many producers enqueue messages, each message being processed by a different consumer depending on type and correlation identifier.</p>
                  <p>Enqueued messages are said to be propagated when they are reproduced on another queue, which can be in the same database or in a remote database.</p>
                  <p>Applications often use data in different formats. A <a href="glossary.html#GUID-A668A987-B1D3-4330-97FD-0589DB780225"><span class="xrefglossterm">transformation</span></a> defines a mapping from one data type to another. The transformation is represented by a SQL function that takes the source data type as input and returns an object of the target data type. You can arrange transformations to occur when a message is enqueued, when it is dequeued, or when it is propagated to a remote <a href="glossary.html#GUID-3E2C69B7-A56C-4F86-8997-5A708E1F14F3"><span class="xrefglossterm">subscriber</span></a>.
                  </p>
               </div>
            </div><a id="ADQUE2420"></a><a id="ADQUE2421"></a><a id="ADQUE2422"></a><a id="ADQUE2423"></a><a id="ADQUE2424"></a><a id="ADQUE2425"></a><a id="ADQUE2426"></a><a id="ADQUE2427"></a><a id="ADQUE2428"></a><a id="ADQUE2429"></a><a id="ADQUE2430"></a><a id="ADQUE2419"></a><div class="props_rev_3"><a id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7" name="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7"></a><h3 id="ADQUE-GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7" class="sect3"><span class="enumeration_section">1.2 </span>Oracle Database Advanced Queuing Leverages Oracle Database
               </h3>
               <div>
                  <p>Oracle Database Advanced Queuing provides database-integrated message queuing functionality. This functionality leverages the functions of Oracle Database so that messages can be stored persistently, propagated between queues on different computers and databases, and transmitted using Oracle Net Services and HTTP(S).</p>
                  <p>Because Oracle Database Advanced Queuing is implemented in database tables, all operational benefits of high availability, scalability, and reliability are also applicable to queue data. Standard database features such as recovery, restart, and security are supported by Oracle Database Advanced Queuing. You can use database development and management tools such as Oracle Enterprise Manager to monitor queues. Like other database tables, queue tables can be imported and exported. Similarly, advanced queues are supported by Oracle Data Guard for high availability, which can be critical to preserve your messages when using a stateless middle tier. By being in the database, enqueues and dequeues can be incorporated in database transactions without requiring distributed transactions. For example, Oracle XA.</p>
                  <p>Messages can be queried using standard SQL. This means that you can use SQL to access the message properties, the message history, and the payload. With SQL access you can also audit and track messages. All available SQL technology, such as indexes, can be used to optimize access to messages.</p>
                  <div class="infoboxnote" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-E3412EE6-692A-44A8-BB07-5C88EAD1773A">
                     <p class="notep1">Note:</p>
                     <p>Oracle Database Advanced Queuing does not support <a href="glossary.html#GUID-940A74C4-9569-478E-B320-E968214F47F6"><span class="xrefglossterm">data manipulation language</span></a> (DML) operations on a queue table, or associated <a href="glossary.html#GUID-3F72FEC8-8EA0-4762-8383-D99020876B61"><span class="xrefglossterm">index-organized table</span></a> (IOT), or associated system-partitioned tables used by sharded queues, if any. The only supported means of modifying queue tables is through the supplied APIs. Queue tables and IOTs can become inconsistent and therefore effectively ruined, if DML operations are performed on them.
                     </p>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-30254C01-4271-4F44-92AB-C2889D93DF1C">System-Level Access Control</p>
                     <p>Oracle Database Advanced Queuing supports system-level access control for all queuing operations, allowing an application developer or DBA to designate users as queue administrators. A queue administrator can invoke Oracle Database Advanced Queuing administrative and operational interfaces on any queue in the database. This simplifies administrative work because all administrative scripts for the queues in a database can be managed under one schema.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-3835CF26-FF93-4400-BEF6-3D13519D18B4">Queue-Level Access Control</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Database Advanced Queuing supports queue-level access control for enqueue and dequeue operations. This feature allows the application developer to protect queues created in one schema from applications running in other schemas. The application developer can grant only minimal access privileges to applications that run outside the queue schema.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-E32ED8AB-53B2-45C2-A101-5E144A3E4197">Performance</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Requests for service must be separated from the supply of services to increase efficiency and enable complex scheduling. Oracle Database Advanced Queuing exhibits high performance as measured by:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Number of messages enqueued and dequeued each second</p>
                        </li>
                        <li>
                           <p>Time to evaluate a complex query on a message warehouse</p>
                        </li>
                        <li>
                           <p>Time to recover and restart the messaging process after a failure</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-3C6AA811-1837-4DEA-9630-EA7C86E99324">Scalability</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Queuing systems must be scalable. Oracle Database Advanced Queuing exhibits high performance when the number of programs using the application increases, when the number of messages increases, and when the size of the message warehouse increases.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-652D5C8E-94DE-4C00-9D0A-E6BF0803670E">Persistence for Security</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Messages that constitute requests for service must be stored persistently and processed exactly once for deferred execution to work correctly in the presence of network, computer, and application failures. Oracle Database Advanced Queuing can meet requirements in the following situations:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Applications do not have the resources to handle multiple unprocessed messages arriving simultaneously from external clients or from programs internal to the application.</p>
                        </li>
                        <li>
                           <p>Communication links between databases are not available all the time or are reserved for other purposes. If the system falls short in its capacity to deal with these messages immediately, then the application must be able to store the messages until they can be processed. </p>
                        </li>
                        <li>
                           <p>External clients or internal programs are not ready to receive messages that have been processed. </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-4C245CEB-43FD-4CE4-AE12-A5EB084BC559">Persistence for Scheduling</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Queuing systems must deal with priorities, and those priorities can change:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Messages arriving later can be of higher priority than messages arriving earlier.</p>
                        </li>
                        <li>
                           <p>Messages may wait for later messages before actions are taken.</p>
                        </li>
                        <li>
                           <p>The same message may be accessed by different processes.</p>
                        </li>
                        <li>
                           <p>Messages in a specific queue can become more important, and so must be processed with less delay or interference from messages in other queues.</p>
                        </li>
                        <li>
                           <p>Messages sent to some destinations can have a higher priority than others.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-5BE7FFD4-799E-4EC0-B0C7-11064A3AD813">Persistence for Accessing and Analyzing Metadata</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Queuing systems must preserve message metadata, which can be as important as the payload data. For example, the time that a message is received or dispatched can be crucial for business and legal reasons. With the persistence features of Oracle Database Advanced Queuing, you can analyze periods of greatest demand or evaluate the lag between receiving and completing an order. </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__CHDEADFG">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-2A6F4368-F605-4D63-9059-A56884F75FED">Object Type Support</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Database Advanced Queuing supports enqueue, dequeue, and propagation operations where the queue type is an abstract datatype, <a href="glossary.html#GUID-4F65D487-125E-466A-8127-6EB40749DCA3"><span class="xrefglossterm">ADT</span></a>. It also supports enqueue and dequeue operations if the types are inherited types of a base ADT. Propagation between two queues where the types are inherited from a base ADT is not supported.
                     </p>
                     <p>Oracle Database Advanced Queuing also supports <code class="codeph">ANYDATA</code> queues, which enable applications to enqueue different message types in a single queue.  Oracle Database Advanced Queuing supports the <code class="codeph">LONG VARCHAR</code> data type from 12c Release 1 (12.1) onwards.
                     </p>
                     <p>If you plan to enqueue, propagate, or dequeue user-defined type messages, then each type used in these messages must exist at every database where the message can be enqueued in a queue. Some environments use directed networks to route messages through intermediate databases before they reach their destination. In such environments, the type must exist at each intermediate database, even if the messages of this type are never enqueued or dequeued at a particular intermediate database.</p>
                     <p>In addition, the following requirements must be met for such types:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Type name must be the same at each database.</p>
                        </li>
                        <li>
                           <p>Type must be in the same schema at each database.</p>
                        </li>
                        <li>
                           <p>Shape of the type must match exactly at each database.</p>
                        </li>
                        <li>
                           <p>Type cannot use inheritance or type evolution at any database.</p>
                        </li>
                        <li>
                           <p>Type cannot contain varrays, nested tables, LOBs, rowids, or urowids.</p>
                        </li>
                     </ul>
                     <p>The object identifier need not match at each database.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-9AB4E206-A63A-45A7-9807-DD69AA2ABA9F">Structured and XMLType Payloads</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You can use object types to structure and manage message payloads. Relational database systems in general have a richer typing system than messaging systems. Because Oracle Database is an object-relational database system, it supports traditional relational and user-defined types. Many powerful features are enabled because of having strongly typed content, such as content whose format is defined by an external type system. These include:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Content-based routing</p>
                           <p>Oracle Database Advanced Queuing can examine the content and automatically route the message to another queue based on the content.</p>
                        </li>
                        <li>
                           <p>Content-based subscription</p>
                           <p>A publish and subscribe system is built on top of a messaging system so that you can create subscriptions based on content.</p>
                        </li>
                        <li>
                           <p>Querying</p>
                           <p>The ability to run queries on the content of the message enables message warehousing.</p>
                        </li>
                     </ul>
                     <p>You can create queues that use the new opaque type, <code class="codeph">XMLType.</code> These queues can be used to transmit and store messages that are XML documents. Using <code class="codeph">XMLType</code>, you can do the following:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Store any type of message in a queue</p>
                        </li>
                        <li>
                           <p>Store <code class="codeph">m</code>ore than one type of payload in a queue
                           </p>
                        </li>
                        <li>
                           <p>Query XMLType columns using the operator <code class="codeph">ExistsNode()</code></p>
                        </li>
                        <li>
                           <p>Specify the operators in subscriber rules or dequeue conditions</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-31355B27-5940-4951-856C-197899FFF80F">Integration with Oracle Internet Directory</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You can register system events, user events, and notifications on queues with Oracle Internet Directory. System events are database startup, database shutdown, and system error events. User events include user log on and user log off, DDL statements (create, drop, alter), and <a href="glossary.html#GUID-86C2F323-8484-41FB-8E51-BF0462F041DF"><span class="xrefglossterm">DML</span></a> statement triggers. Notifications on queues include OCI notifications, PL/SQL notifications, and e-mail notifications.
                     </p>
                     <p>You can also create aliases for Oracle Database Advanced Queuing agents in Oracle Internet Directory. These aliases can be specified while performing Oracle Database Advanced Queuing enqueue, dequeue, and notification operations. This is useful when you do not want to expose an internal agent name.</p>
                     <div class="infoboxnote" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-E4032675-35E0-40CE-B978-72ACED2D9C55">
                        <p class="notep1">Note:</p>Sharded Queues does not support OCI and thick drivers in 12<span class="italic">c</span> Release 2 (12.2.0.1). 
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__CHDIJAIJ">
                     <p class="subhead2" id="GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__GUID-D1C8B756-197F-4A55-A0A9-5BD02670FE4B">Support for Oracle Real Application Clusters(Oracle RAC)</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Real Application Clusters can be used to improve Oracle Database Advanced Queuing performance by allowing different queues to be managed by different instances. You do this by specifying different instance affinities (preferences) for the queue tables that store the queues. This allows queue operations (enqueue and dequeue) on different queues to occur in parallel. Sharded queues are recommended for applications with enqueuers or dequeuers on multiple Oracle RAC instances. Refer to <a href="aq-performance-scalability.html#GUID-1B18AD7E-2F02-4208-A059-6B4531586C75">Sharded Queues and Oracle Real Application Clusters (Oracle RAC)</a> for more information.
                     </p>
                     <p><a id="d6697e572" class="indexterm-anchor"></a>If compatibility is set to Oracle8<span class="italic">i</span> release 8.1.5 or higher, then an application can specify the instance affinity for a queue table. When Oracle Database Advanced Queuing is used with Oracle RAC and multiple instances, this information is used to partition the queue tables between instances for queue-monitor scheduling and, also for propagation. The queue table is monitored by the queue monitors of the instance specified by the user. If the owner of the queue table is terminated, then the secondary instance or some available instance takes over the ownership for the queue table. 
                     </p>
                     <p>If an instance affinity is not specified, then the queue tables are arbitrarily partitioned among the available instances. This can result in pinging between the application accessing the queue table and the queue monitor monitoring it. Specifying the instance affinity prevents this, but does not prevent the application from accessing the queue table and its queues from other instances. </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2432"></a><a id="ADQUE2431"></a><div class="props_rev_3"><a id="GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D" name="GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D"></a><h3 id="ADQUE-GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D" class="sect3"><span class="enumeration_section">1.3 </span>Oracle Database Advanced Queuing in Integrated Application Environments
               </h3>
               <div>
                  <div><span>Oracle Database Advanced Queuing provides the message management and communication needed for application integration. In an integrated environment, messages travel between the Oracle Database server, applications, and users.</span>This is shown in <a href="aq-introduction.html#GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D__I1008337">Figure 1-1</a>.
                  </div>
                  <p></p>
                  <div class="figure" id="GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D__I1008337">
                     <p class="titleinfigure">Figure 1-1  Integrated Application Environment Using Oracle Database Advanced Queuing</p><img src="img/adque437.gif" width="584" alt="Description of Figure 1-1 follows" title="Description of Figure 1-1 follows" longdesc="img_text/adque437.html"><br><a href="img_text/adque437.html">Description of "Figure 1-1  Integrated Application Environment Using Oracle Database Advanced Queuing"</a></div>
                  <!-- class="figure" -->
                  <p><a id="d6697e649" class="indexterm-anchor"></a><a id="d6697e653" class="indexterm-anchor"></a>Messages are exchanged between a client and the Oracle Database server or between two Oracle Database servers using Oracle Net Services. Oracle Net Services also propagates messages from one Oracle Database queue to another. Or, as shown in <a href="aq-introduction.html#GUID-CFCB0EAA-952D-4149-8E6F-3A39809D5D3D__I1008337">Figure 1-1</a>, you can perform Oracle Database Advanced Queuing operations over the Internet using HTTP(S). In this case, the client, a user or Internet application, produces structured XML messages. During <a href="glossary.html#GUID-DE5B852F-823C-4DC8-B6BB-4825D688A00A"><span class="xrefglossterm">propagation</span></a> over the Internet, Oracle Database servers communicate using structured XML also.
                  </p>
                  <p><a id="d6697e665" class="indexterm-anchor"></a><a id="d6697e669" class="indexterm-anchor"></a>Application integration also involves the integration of heterogeneous messaging systems. Oracle Database Advanced Queuing seamlessly integrates with existing non-Oracle Database messaging systems like IBM WebSphere MQ through Messaging Gateway, thus allowing existing WebSphere MQ-based applications to be integrated into an Oracle Database Advanced Queuing environment.
                  </p>
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="aq-introduction.html#GUID-2B4C7691-0C91-4447-ADEA-6F65C2B9EED2" title="Oracle Database Advanced Queuing provides an asynchronous alternative to the synchronous manner in which Client/Server applications usually run.">Oracle Database Advanced Queuing Client/Server Communication</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-5B6B013D-A646-4895-B929-970CBFB8C46D" title="Oracle Database Advanced Queuing provides for queue subscribers and message recipients to allow multiple consumers to dequeue the same message.">Multiconsumer Dequeuing of the Same Message</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06" title="Oracle Database Advanced Queuing allows us to implement a workflow, also known as a chained application transaction.">Oracle Database Advanced Queuing Implementation of Workflows</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-4237239B-1603-4F10-9B41-4D527994FDFA" title="A point-to-point message is aimed at a specific target. Senders and receivers decide on a common queue in which to exchange messages. Each message is consumed by only one receiver.">Oracle Database Advanced Queuing Implementation of Publish/Subscribe</a></p>
                     </li>
                  </ul>
               </div><a id="ADQUE2434"></a><a id="ADQUE2433"></a><div class="props_rev_3"><a id="GUID-2B4C7691-0C91-4447-ADEA-6F65C2B9EED2" name="GUID-2B4C7691-0C91-4447-ADEA-6F65C2B9EED2"></a><h4 id="ADQUE-GUID-2B4C7691-0C91-4447-ADEA-6F65C2B9EED2" class="sect4"><span class="enumeration_section">1.3.1 </span>Oracle Database Advanced Queuing Client/Server Communication
                  </h4>
                  <div>
                     <div><span>Oracle Database Advanced Queuing provides an asynchronous alternative to the synchronous manner in which Client/Server applications usually run. </span>This figure exemplifies Client/Server Communication Using Oracle Database Advanced Queuing.
                     </div>
                     <p> In this example Application B (a server) provides service to Application A (a client) using a request/response queue.</p>
                     <div class="figure" id="GUID-2B4C7691-0C91-4447-ADEA-6F65C2B9EED2__CHDIAHBF">
                        <p class="titleinfigure">Figure 1-2 Client/Server Communication Using Oracle Database Advanced Queuing</p><img src="img/adque035.gif" width="240" alt="Description of Figure 1-2 follows" title="Description of Figure 1-2 follows" longdesc="img_text/adque035.html"><br><a href="img_text/adque035.html">Description of "Figure 1-2 Client/Server Communication Using Oracle Database Advanced Queuing"</a></div>
                     <!-- class="figure" -->
                     <p>Application A enqueues a request into the request queue. In a different transaction, Application B dequeues and processes the request. Application B enqueues the result in the response queue, and in yet another transaction, Application A dequeues it.</p>
                     <p>The client need not wait to establish a connection with the server, and the server dequeues the message at its own pace. When the server is finished processing the message, there is no need for the client to be waiting to receive the result. A process of double-deferral frees both client and server.</p>
                  </div>
               </div><a id="ADQUE2436"></a><a id="ADQUE2437"></a><a id="ADQUE2438"></a><a id="ADQUE2439"></a><a id="ADQUE2435"></a><div class="props_rev_3"><a id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D" name="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D"></a><h4 id="ADQUE-GUID-5B6B013D-A646-4895-B929-970CBFB8C46D" class="sect4"><span class="enumeration_section">1.3.2 </span>Multiconsumer Dequeuing of the Same Message
                  </h4>
                  <div>
                     <div>A message can only be enqueued into one queue at a time. If a producer had to insert the same message into several queues in order to reach different consumers, then this would require management of a very large number of queues.  <span>Oracle Database Advanced Queuing provides for queue subscribers and message recipients to allow multiple consumers to dequeue the same message.</span></div>
                     <p>To allow for <a href="glossary.html#GUID-3E2C69B7-A56C-4F86-8997-5A708E1F14F3"><span class="xrefglossterm">subscriber</span></a> and <a href="glossary.html#GUID-F50CE039-717A-4D4C-B4D9-62EB3191885A"><span class="xrefglossterm">recipient</span></a> lists, the queue must reside in a <a href="glossary.html#GUID-45894F1F-4871-4A00-9171-2743821BAD3A"><span class="xrefglossterm">queue table</span></a> that is created with the multiple consumer option. Each message remains in the queue until it is consumed by all its intended consumers.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__GUID-3F0F17A2-3434-4383-9395-5E458E4315B9">Queue Subscribers</p>
                        <p>Multiple consumers, which can be either applications or other queues, can be associated with a queue as subscribers. This causes all messages enqueued in the queue to be made available to be consumed by each of the queue subscribers. The subscribers to the queue can be changed dynamically without any change to the messages or message producers.</p>
                        <p>You cannot add subscriptions to single-consumer queues or exception queues. A consumer that is added as a subscriber to a queue is only able to dequeue messages that are enqueued after the subscriber is added. No two subscribers can have the same values for name, address, and protocol. At least one of these attributes must be different for two subscribers.</p>
                        <p><a id="d6697e876" class="indexterm-anchor"></a>It cannot be known which subscriber will dequeue which message first, second, and so on, because there is no priority among subscribers. More formally, the order of dequeuing by subscribers is indeterminate.
                        </p>
                        <p>Subscribers can also be rule-based. Similar in syntax to the <code class="codeph">WHERE</code> clause of a SQL query, rules are expressed in terms of attributes that represent message properties or message content. These subscriber rules are evaluated against incoming messages, and those rules that match are used to determine message recipients. 
                        </p>
                        <p>In <a href="aq-introduction.html#GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__CHDEIABI">Figure 1-3</a>, Application B and Application C each need messages produced by Application A, so a multiconsumer queue is specially configured with Application B and Application C as queue subscribers. Each receives every message placed in the queue.
                        </p>
                        <div class="figure" id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__CHDEIABI">
                           <p class="titleinfigure">Figure 1-3 Communication Using a Multiconsumer Queue</p><img src="img/adque037.gif" width="320" alt="Description of Figure 1-3 follows" title="Description of Figure 1-3 follows" longdesc="img_text/adque037.html"><br><a href="img_text/adque037.html">Description of "Figure 1-3 Communication Using a Multiconsumer Queue"</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__GUID-F225DE48-60FD-4CC5-80AD-301A1FE74A35">Message Recipients</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>A message producer can submit a list of recipients at the time a message is enqueued into a non-sharded queue. This allows for a unique set of recipients for each message in the queue. The recipient list associated with the message overrides the subscriber list associated with the queue, if there is one. The recipients need not be in the subscriber list. However, recipients can be selected from among the subscribers.</p>
                        <p>A recipient can be specified only by its name, in which case the recipient must dequeue the message from the queue in which the message was enqueued. It can be specified by its name and an address with a protocol value of 0. The address should be the name of another queue in the same database or another installation of Oracle Database (identified by the database link), in which case the message is propagated to the specified queue and can be dequeued by a consumer with the specified name. If the recipient's name is NULL, then the message is propagated to the specified queue in the address and can be dequeued by the subscribers of the queue specified in the address. If the protocol field is nonzero, then the name and address are not interpreted by the system and the message can be dequeued by a special consumer. </p>
                        <p>Subscribing to a queue is like subscribing to a magazine: each subscriber can dequeue all the messages placed into a specific queue, just as each magazine subscriber has access to all its articles. Being a recipient, however, is like getting a letter: each recipient is a designated target of a particular message. </p>
                        <p><a href="aq-introduction.html#GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__CHDBDGHJ">Figure 1-4</a> shows how Oracle Database Advanced Queuing can accommodate both kinds of consumers. Application A enqueues messages. Application B and Application C are subscribers. But messages can also be explicitly directed toward recipients like Application D, which may or may not be subscribers to the queue. The list of such recipients for a given message is specified in the enqueue call for that message. It overrides the list of subscribers for that queue.
                        </p>
                        <div class="figure" id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__CHDBDGHJ">
                           <p class="titleinfigure">Figure 1-4 Explicit and Implicit Recipients of Messages</p><img src="img/adque039.gif" width="336" alt="Description of Figure 1-4 follows" title="Description of Figure 1-4 follows" longdesc="img_text/adque039.html"><br><a href="img_text/adque039.html">Description of "Figure 1-4 Explicit and Implicit Recipients of Messages"</a></div>
                        <!-- class="figure" -->
                        <div class="infoboxnote" id="GUID-5B6B013D-A646-4895-B929-970CBFB8C46D__GUID-57130F36-ED95-407D-997B-E50511B84621">
                           <p class="notep1">Note:</p>
                           <p>Multiple producers can simultaneously enqueue messages aimed at different targeted recipients.</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADQUE2441"></a><a id="ADQUE2440"></a><div class="props_rev_3"><a id="GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06" name="GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06"></a><h4 id="ADQUE-GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06" class="sect4"><span class="enumeration_section">1.3.3 </span>Oracle Database Advanced Queuing Implementation of Workflows
                  </h4>
                  <div>
                     <div><span>Oracle Database Advanced Queuing allows us to implement a workflow, also known as a chained application transaction.</span>The figure exemplifies how a workflow is implemented using Oracle Database Advanced Queuing.
                     </div>
                     <ol>
                        <li>
                           <p>Application A begins a <a href="glossary.html#GUID-F361FADC-D1DD-49BE-8C73-37C4A241F0C8"><span class="xrefglossterm">workflow</span></a> by enqueuing Message 1.
                           </p>
                        </li>
                        <li>
                           <p>Application B dequeues it, performs whatever activity is required, and enqueues Message 2.</p>
                        </li>
                        <li>
                           <p>Application C dequeues Message 2 and generates Message 3.</p>
                        </li>
                        <li>
                           <p>Application D, the final step in the workflow, dequeues it.</p>
                        </li>
                     </ol>
                     <div class="figure" id="GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06__CHDHEIBE">
                        <p class="titleinfigure">Figure 1-5 Implementing a Workflow using Oracle Database Advanced Queuing</p><img src="img/adque040.gif" width="408" alt="Description of Figure 1-5 follows" title="Description of Figure 1-5 follows" longdesc="img_text/adque040.html"><br><a href="img_text/adque040.html">Description of "Figure 1-5 Implementing a Workflow using Oracle Database Advanced Queuing"</a></div>
                     <!-- class="figure" -->
                     <div class="infoboxnote" id="GUID-EADF9494-1C2A-4346-81B5-39FE4AC6BC06__GUID-E411A314-C6AB-41A5-89AD-B3BB93F78101">
                        <p class="notep1">Note:</p>
                        <p>The contents of the messages 1, 2 and 3 can be the same or different. Even when they are different, messages can contain parts of the contents of previous messages.</p>
                     </div>
                     <p>The queues are used to buffer the flow of information between different processing stages of the business process. By specifying delay interval and expiration time for a message, a window of execution can be provided for each of the applications.</p>
                     <p>From a workflow perspective, knowledge of the volume and timing of message flows is a business asset quite apart from the value of the payload data. Oracle Database Advanced Queuing helps you gain this knowledge by supporting the optional retention of messages for analysis of historical patterns and prediction of future trends.</p>
                  </div>
               </div><a id="ADQUE2443"></a><a id="ADQUE2444"></a><a id="ADQUE2445"></a><a id="ADQUE2442"></a><div class="props_rev_3"><a id="GUID-4237239B-1603-4F10-9B41-4D527994FDFA" name="GUID-4237239B-1603-4F10-9B41-4D527994FDFA"></a><h4 id="ADQUE-GUID-4237239B-1603-4F10-9B41-4D527994FDFA" class="sect4"><span class="enumeration_section">1.3.4 </span>Oracle Database Advanced Queuing Implementation of Publish/Subscribe
                  </h4>
                  <div>
                     <p>A point-to-point message is aimed at a specific target. Senders and receivers decide on a common queue in which to exchange messages. Each message is consumed by only one receiver.</p>
                     <p><a href="aq-introduction.html#GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDEABII">Figure 1-6</a> shows that each application has its own message queue, known as a single-consumer queue.
                     </p>
                     <div class="figure" id="GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDEABII">
                        <p class="titleinfigure">Figure 1-6 Point-to-Point Messaging</p><img src="img/adque250.gif" width="496" alt="Description of Figure 1-6 follows" title="Description of Figure 1-6 follows" longdesc="img_text/adque250.html"><br><a href="img_text/adque250.html">Description of "Figure 1-6 Point-to-Point Messaging"</a></div>
                     <!-- class="figure" -->
                     <p>A <a href="glossary.html#GUID-C1099A1A-C20D-4C9C-AD73-BBF6BC8939B5"><span class="xrefglossterm">publish/subscribe</span></a> message can be consumed by multiple receivers, as shown in <a href="aq-introduction.html#GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDICBHA">Figure 1-7</a>. Publish/subscribe messaging has a wide dissemination mode called <a href="glossary.html#GUID-1D647CEA-1D00-4F25-BE39-4269938CD96F"><span class="xrefglossterm">broadcast</span></a> and a more narrowly aimed mode called <a href="glossary.html#GUID-1EE8EF1B-B684-4A0E-B64E-21749F7AF1AA"><span class="xrefglossterm">multicast</span></a>. 
                     </p>
                     <p><a id="d6697e1082" class="indexterm-anchor"></a><a id="d6697e1086" class="indexterm-anchor"></a>Broadcasting is like a radio station not knowing exactly who the audience is for a given program. The dequeuers are subscribers to multiconsumer queues. In contrast, multicast is like a magazine publisher who knows who the subscribers are. Multicast is also referred to as point-to-multipoint, because a single publisher sends messages to multiple receivers, called recipients, who may or may not be subscribers to the queues that serve as exchange mechanisms.
                     </p>
                     <div class="figure" id="GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDICBHA">
                        <p class="titleinfigure">Figure 1-7 Publish/Subscribe Mode</p><img src="img/adque249.gif" width="496" alt="Description of Figure 1-7 follows" title="Description of Figure 1-7 follows" longdesc="img_text/adque249.html"><br><a href="img_text/adque249.html">Description of "Figure 1-7 Publish/Subscribe Mode"</a></div>
                     <!-- class="figure" -->
                     <p>Publish/subscribe describes a situation in which a publisher application enqueues messages to a queue anonymously (no recipients specified). The messages are then delivered to subscriber applications based on <a href="glossary.html#GUID-99CB47E5-833C-41C3-965F-5115B1F1203E"><span class="xrefglossterm">rules</span></a> specified by each application. The rules can be defined on message properties, message data content, or both. 
                     </p>
                     <p><a id="d6697e1103" class="indexterm-anchor"></a>You can implement a publish/subscribe model of communication using Oracle Database Advanced Queuing as follows: 
                     </p>
                     <ol>
                        <li>
                           <p>Set up one or more queues to hold messages. These queues should represent an area or subject of interest. For example, a queue can be used to represent billed orders. </p>
                        </li>
                        <li>
                           <p>Set up a set of rule-based subscribers. Each subscriber can specify a rule which represents a specification for the messages that the subscriber wishes to receive. A null rule indicates that the subscriber wishes to receive all messages. </p>
                        </li>
                        <li>
                           <p>Publisher applications publish messages to the queue by invoking an enqueue call. </p>
                        </li>
                        <li>
                           <p>Subscriber applications can receive messages with a dequeue call. This retrieves messages that match the subscription criteria.</p>
                        </li>
                        <li>
                           <p><a id="d6697e1123" class="indexterm-anchor"></a>Subscriber applications can also use a listen call to monitor multiple queues for subscriptions on different queues. This is a more scalable solution in cases where a subscriber application has subscribed to many queues and wishes to receive messages that arrive in any of the queues.
                           </p>
                        </li>
                        <li>
                           <p>Subscriber applications can also use the Oracle Call Interface (OCI) notification mechanism. This allows a push mode of message delivery. The subscriber application registers the queues (and subscriptions specified as subscribing agent) from which to receive messages. This registers a callback to be invoked when messages matching the subscriptions arrive.</p>
                        </li>
                     </ol>
                     <p><a href="aq-introduction.html#GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDJEHDI">Figure 1-8</a> illustrates the use of Oracle Database Advanced Queuing for implementing a publish/subscribe relationship between publisher Application A and subscriber Applications B, C, and D:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Application B subscribes with rule "priority = 1".</p>
                        </li>
                        <li>
                           <p>Application C subscribes with rule "priority &gt; 1".</p>
                        </li>
                        <li>
                           <p>Application D subscribes with rule "priority = 3".</p>
                        </li>
                     </ul>
                     <div class="figure" id="GUID-4237239B-1603-4F10-9B41-4D527994FDFA__CHDJEHDI">
                        <p class="titleinfigure">Figure 1-8 Implementing Publish/Subscribe using Oracle Database Advanced Queuing</p><img src="img/adque041.gif" width="336" alt="Description of Figure 1-8 follows" title="Description of Figure 1-8 follows" longdesc="img_text/adque041.html"><br><a href="img_text/adque041.html">Description of "Figure 1-8 Implementing Publish/Subscribe using Oracle Database Advanced Queuing"</a></div>
                     <!-- class="figure" -->
                     <p>If Application A enqueues three messages with priorities 1, 2, and 3 respectively, then the messages will be delivered as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Application B receives a single message (priority 1).</p>
                        </li>
                        <li>
                           <p>Application C receives two messages (priority 2, 3).</p>
                        </li>
                        <li>
                           <p>Application D receives a single message (priority 3).</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADQUE2446"></a><a id="ADQUE2447"></a><a id="ADQUE2448"></a><a id="ADQUE2449"></a><a id="ADQUE2450"></a><a id="ADQUE2451"></a><a id="ADQUE2452"></a><a id="ADQUE0102"></a><div class="props_rev_3"><a id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27" name="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27"></a><h3 id="ADQUE-GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27" class="sect3"><span class="enumeration_section">1.4 </span>Buffered Messaging
               </h3>
               <div>
                  <p>Buffered messaging combines the rich functionality that this product has always offered with a much faster queuing implementation. Buffered messaging is ideal for applications that do not require the reliability and transaction support of Oracle Database Advanced Queuing persistent messaging.</p>
                  <p>Buffered messaging is faster than persistent messaging, because its messages reside in shared memory. They are usually written to disk only when the total memory consumption of buffered messages approaches the available shared memory limit.</p>
                  <div class="infoboxnote" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-C05D4671-027A-4856-8C19-C66410963739">
                     <p class="notep1">Note:</p>
                     <p>The portion of a queue that stores buffered messages in memory is sometimes referred to as a buffered queue.</p>
                  </div>
                  <p>Message retention is not supported for buffered messaging.</p>
                  <p>When using buffered messaging, Oracle recommends that you do one of the following: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a id="d6697e1302" class="indexterm-anchor"></a>Set parameter <code class="codeph">streams_pool_size</code> 
                        </p>
                        <p>This parameter controls the size of shared memory available to Oracle Database Advanced Queuing. If unspecified, up to 10% of the shared pool size may be allocated for the Oracle Database Advanced Queuing pool from the database cache.</p>
                        <p>Refer to <a href="aq-performance-scalability.html#GUID-AE1B40DA-FCEE-4EBB-8B83-96477C47DD49__MANUALLYTUNINGSHARDEDQUEUESSHARDEDQ-0508F585">manually tuning sharded queues</a> for more information about setting the message cache for buffered messaging with sharded queues.
                        </p>
                     </li>
                     <li>
                        <p>Turn on SGA autotuning</p>
                        <p>Oracle will automatically allocate the appropriate amount of memory from the SGA for Oracle Database Advanced Queuing, based on Oracle Database Advanced Queuing usage and, also usage of other components that use the SGA. Examples of such other components are buffer cache and library cache. If <code class="codeph">streams_pool_size</code> is specified, it is used as the lower bound.
                        </p>
                     </li>
                  </ul>
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFICID">Enqueuing Buffered Messages</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDIJDFH">Dequeuing Buffered Messages</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDHFACF">Propagating Buffered Messages</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDDBCFA">Flow Control</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFJCAC">Buffered Messaging with Oracle Real Application Clusters (Oracle RAC)</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDHGAGE">Buffered Messaging Restrictions</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFCFBF">Error Handling</a></p>
                     </li>
                  </ul>
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFICID">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-2DD11F01-5523-47B3-9C3A-2195065A3521">Enqueuing Buffered Messages</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Buffered and persistent messages use the same single-consumer or multiconsumer queues and the same administrative and operational interfaces. They are distinguished from each other by a delivery mode parameter, set by the application when enqueuing the message to an Oracle Database Advanced Queuing queue.</p>
                     <p>Recipient lists are supported for buffered messaging enqueue. </p>
                     <p>Buffered messaging is supported in all queue tables created with compatibility 8.1 or higher. Transaction grouping queues and array enqueues are not supported for buffered messages in this release. You can still use the array enqueue procedure to enqueue buffered messages, but the array size must be set to one.</p>
                     <p><a id="d6697e1368" class="indexterm-anchor"></a>Buffered messages can be queried using the <code class="codeph">AQ$</code><span class="italic"><code class="codeph">Queue_Table_Name</code></span> view. They appear with states <code class="codeph">IN-MEMORY</code> or <code class="codeph">SPILLED</code>.
                     </p>
                     <p><a id="d6697e1386" class="indexterm-anchor"></a><a id="d6697e1390" class="indexterm-anchor"></a>The queue type for buffered messaging can be <code class="codeph">ADT</code>, <code class="codeph">XML</code>, <code class="codeph">ANYDATA</code>, or <code class="codeph">RAW</code>. For <code class="codeph">ADT</code> types with <code class="codeph">LOB</code> attributes, only buffered messages with null <code class="codeph">LOB</code> attributes can be enqueued.
                     </p>
                     <p><a id="d6697e1418" class="indexterm-anchor"></a><a id="d6697e1424" class="indexterm-anchor"></a>All ordering schemes available for persistent messages are also available for buffered messages, but only within each message class. Ordering among persistent and buffered messages enqueued in the same session is not currently supported. 
                     </p>
                     <p><a id="d6697e1430" class="indexterm-anchor"></a><a id="d6697e1434" class="indexterm-anchor"></a>Both enqueue and dequeue buffered messaging operations must be with <code class="codeph">IMMEDIATE</code> visibility mode. Thus they cannot be part of another transaction. You cannot specify delay when enqueuing buffered messages.
                     </p>
                     <div class="infoboxnotealso" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-8D4141DE-90B3-4A93-85BF-D03088F41035">
                        <p class="notep1">See Also:</p>
                        <div class="p">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="aq-operations-using-pl-sql.html#GUID-1CEA86B9-4FDF-445F-93C1-67E21C033D35" title="This procedure adds a message to the specified queue.">Enqueuing Messages</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="aq-messaging-gateway-views.html#GUID-78CC1D99-D2DD-4B80-BC38-4BBF39E05EFA" title="The AQ$<Queue_Table_Name&gt; view describes the queue table in which message data is stored.">AQ$&lt;Queue_Table_Name&gt;: Messages in Queue Table</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDIAGFG">Priority and Ordering of Messages in Enqueuing</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDIJDFH">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-55430D8B-B4D7-41DB-9B49-81AF455D80DA">Dequeuing Buffered Messages</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Rule-based subscriptions are supported with buffered messaging. The procedure for adding subscribers is enhanced to allow an application to express interest in persistent messages only, buffered messages only, or both.</p>
                     <p>For non-sharded queues, array dequeue is not supported for buffered messaging, but you can still use the array dequeue procedure by setting array size to one message.</p>
                     <p><a id="d6697e1481" class="indexterm-anchor"></a><a id="d6697e1487" class="indexterm-anchor"></a>Dequeuing applications can choose to dequeue persistent messages only, buffered messages only, or both types. Visibility must be set to <code class="codeph">IMMEDIATE</code> for dequeuing buffered messages. All of the following dequeue options are supported:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Dequeue modes <code class="codeph">BROWSE</code>, <code class="codeph">LOCK</code>, <code class="codeph">REMOVE</code>, and <code class="codeph">REMOVE_NO_DATA</code></p>
                        </li>
                        <li>
                           <p>Navigation modes <code class="codeph">FIRST_MESSAGE</code> and <code class="codeph">NEXT_MESSAGE</code></p>
                        </li>
                        <li>
                           <p>Correlation identifier</p>
                        </li>
                        <li>
                           <p>Dequeue condition</p>
                        </li>
                        <li>
                           <p>Message identifier</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-20E502B5-1F97-46DE-8E56-68940910E8FC">
                        <p class="notep1">See Also:</p>
                        <div class="p">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="aq-administrative-interface.html#GUID-5FB46C6A-BB22-4CDE-B7D6-E242DC8808D8" title="DBMS_AQADM.ADD_SUBSCRIBER adds a default subscriber to a queue.">Adding a Subscriber</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="aq-operations-using-pl-sql.html#GUID-5F84DA85-7D5B-4EEC-9785-80877F3FCA54__CHDBBGGE">Dequeue Options</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDHFACF">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-744382CF-0E3C-47ED-ACB4-C2DE5416BD0F">Propagating Buffered Messages</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Propagation of buffered messages is supported. A single propagation schedule serves both persistent and buffered messages. The <code class="codeph">DBA_QUEUE_SCHEDULES</code> view displays statistics and error information.
                     </p>
                     <p>Oracle Database AQ deletes buffered messages once they are propagated to the remote sites. If the receiving site fails before these messages are consumed, then these messages will be lost. The source site will not be able to re-send them. Duplicate delivery of messages is also possible. </p>
                     <div class="infoboxnotealso" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-2050BD3D-332F-4E59-BD6E-0DB47EB610A2">
                        <p class="notep1">See Also:</p>
                        <div class="p">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="aq-messaging-gateway-views.html#GUID-536EE7B0-B37E-48D2-9336-119742F34468" title="The DBA_QUEUE_SCHEDULES view describes all the current schedules in the database for propagating messages.">DBA_QUEUE_SCHEDULES: All Propagation Schedules</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFJCAC">Buffered Messaging with Oracle Real Application Clusters (Oracle RAC)</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDDBCFA">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-75AA8BA0-740E-4945-82FE-BC7BABA04F27">Flow Control</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Database Advanced Queuing implements a flow control system that prevents applications from flooding the shared memory with messages. If the number of outstanding messages per sender exceeds a system-defined threshold, the enqueue call will block and timeout with an error message. A message sender is identified by <span class="italic">sender_id.name</span> in the enqueue options. A sender blocked due to flow control on a queue does not affect other message senders. The resolution is to dequeue messages, thereby resolving flow control, after which new messages can be enqueued.
                     </p>
                     <p>Flow control threshold varies with memory pressure and could come down to the system-defined limit if streams pool usage becomes significant. Message senders will block on event <code class="codeph">Streams AQ: enqueue blocked due to flow control</code> and time out with error <code class="codeph">ORA-25307</code> if flow control is not resolved. Applications are expected to handle this error, and re-enqueue the failed message.
                     </p>
                     <p>Even with flow control, slow consumers of a multiconsumer queue can cause the number of messages stored in memory to grow without limit. Provided there is at least one subscriber who is keeping pace, older messages are spilled to disk and removed from the pool to free up memory. This ensures that the cost of disk access is paid by the slower consumers, and faster subscribers can proceed unhindered.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFJCAC">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-917D4532-EF7B-40EB-A0AE-E4500A8DDDB3">Buffered Messaging with Oracle Real Application Clusters (Oracle RAC)</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Sharded and non-sharded queues handle buffered messaging with Oracle RAC differently. </p>
                     <p>Sharded queues perform cross-instance communication but avoid simultaneous writes to the same block across Oracle RAC instances. Typically, dequeues occur on a shard that is local to a messageâs enqueuing instance, but in certain situations, Oracle will efficiently forward messages across instances for dequeuing on another instance. For example, if a sharded queue has a single enqueuing session on one Oracle RAC instance and a single dequeuing session on another instance, then sharded queues will forward messages between the Oracle RAC instances. The forwarding of messages is done asynchronously to the enqueuing transaction to  improve performance. Dequeuers may get an ORA-25228 if they are connected to an instance  whose shards have no messages.</p>
                     <p>For non-sharded queues, an application can enqueue and dequeue buffered messages from any Oracle RAC instance as long as it uses password-based authentication to connect to the database. The structures required for buffered messaging are implemented on one Oracle RAC instance. The instance where the buffered messaging structures are implemented is the <code class="codeph">OWNER_INSTANCE</code> of the queue table containing the queue. Enqueue and dequeue requests received at other instances are forwarded to the <code class="codeph">OWNER_INSTANCE</code> over the interconnect. The <code class="codeph">REMOTE_LISTENER</code> parameter in <code class="codeph">listener.ora</code> must also be set to enable forwarding of buffered messaging requests to correct instance. Internally, buffered queues on Oracle RAC may use <code class="codeph">dblinks</code> between instances. Definer's rights packages that enqueue or dequeue into buffered queues on Oracle RAC must grant <code class="codeph">INHERIT REMOTE PRIVILEGES</code> to users of the package.
                     </p>
                     <p><a id="d6697e1627" class="indexterm-anchor"></a>A service name is associated with each queue in Oracle RAC and displayed in the <code class="codeph">DBA_QUEUES</code> and <code class="codeph">USER_QUEUES</code> views. This service name always points to the instance with the most efficient access for buffered messaging, minimizing pinging between instances. OCI clients can use the service name for buffered messaging operations.
                     </p>
                     <p><a id="d6697e1639" class="indexterm-anchor"></a><a id="d6697e1645" class="indexterm-anchor"></a>Oracle recommends that you specify instance affinity when using buffered messaging with queue-to-queue propagation. This results in transparent failover when propagating messages to a destination Oracle RAC system. You do not need to re-point your database links if the primary AQ Oracle RAC instance fails.
                     </p>
                     <div class="infoboxnotealso" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-E84392EC-8955-428D-8CFA-9D660EC51625">
                        <p class="notep1">See Also:</p>
                        <div class="p">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="aq-messaging-gateway-views.html#GUID-2947DA74-D002-4559-962E-84A33DD9DA45" title="This view describes queue tables accessible to the current user.">ALL_QUEUE_TABLES: Queue Tables Accessible to the Current User</a>"</span> for more information on <code class="codeph">OWNER_INSTANCE</code></p>
                              </li>
                              <li>
                                 <p>"REMOTE_LISTENER" in <a href="../refrn/REMOTE_LISTENER.html#REFRN10183" target="_blank"><span class="italic">Oracle Database Reference</span></a> for more information on setting the <code class="codeph">REMOTE_LISTENER</code> parameter
                                 </p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="aq-messaging-gateway-views.html#GUID-CBC9895E-04E3-4FFA-9006-849910547742" title="The DBA_QUEUES view specifies operational characteristics for every queue in a database.">DBA_QUEUES: All Queues in Database</a>"</span> or <span class="q">"<a href="aq-messaging-gateway-views.html#GUID-225DB096-8267-41EE-92DF-3747AD7C0362" title="The USER_QUEUES view is the same as DBA_QUEUES with the exception that it only shows queues in the user's schema.">USER_QUEUES: Queues In User Schema</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="aq-introduction.html#GUID-344EBAAB-BF98-4E99-8D27-0A56409050E7__CHDIJAIJ">Support for Oracle Real Application Clusters(Oracle RAC)</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDHGAGE">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-59D63259-17BD-4006-9CDB-B196D56E27C7">Buffered Messaging Restrictions</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>The following Oracle Database Advanced Queuing features are only supported for buffered messaging on sharded queues:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Message delay</p>
                        </li>
                        <li>
                           <p>Array enqueue</p>
                        </li>
                        <li>
                           <p>Array dequeue</p>
                        </li>
                        <li>
                           <p>PL/SQL Notification</p>
                        </li>
                     </ul>
                     <p>The following Oracle Database Advanced Queuing features are not currently supported for buffered messaging:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Message retention</p>
                        </li>
                        <li>
                           <p>Transaction grouping</p>
                        </li>
                        <li>
                           <p>Message export and import</p>
                        </li>
                        <li>
                           <p>Messaging Gateway</p>
                        </li>
                        <li>
                           <p>OCI notification</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFCFBF">
                     <p class="subhead2" id="GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__GUID-CF2825DE-D7B4-4A0F-A96D-72B583B250F6">Error Handling</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Retry count and retry delay are not supported for buffered messages. Message expiration is supported. When a buffered message has been in the queue beyond its expiration period, it is moved into the exception queue as a persistent message. </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2453"></a><a id="ADQUE2454"></a><a id="ADQUE2455"></a><a id="ADQUE2456"></a><a id="ADQUE2457"></a><a id="ADQUE2458"></a><a id="ADQUE2459"></a><a id="ADQUE0101"></a><div class="props_rev_3"><a id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271" name="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271"></a><h3 id="ADQUE-GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271" class="sect3"><span class="enumeration_section">1.5 </span>Asynchronous Notifications
               </h3>
               <div>
                  <p>Asynchronous notification allows clients to receive notifications of messages of interest.</p>
                  <p>The client can use these notifications to monitor multiple subscriptions. The client need not be connected to the database to receive notifications regarding its subscriptions. Asynchronous notification is supported for buffered messages. The delivery mode of the message is available in the message descriptor of the notification descriptor.</p>
                  <p>The client specifies a callback function which is run for each message. Asynchronous notification cannot be used to invoke an executable, but it is possible for the callback function to invoke a stored procedure.</p>
                  <p>Clients can receive notifications procedurally using PL/SQL, Java Message Service (JMS), or OCI callback functions, or clients can receive notifications through e-mail or HTTP post. Clients can also specify the presentation for notifications as either <code class="codeph">RAW</code> or <code class="codeph">XML</code>.
                  </p>
                  <div class="infoboxnote" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-0252006A-4D5D-4F7D-BB6B-8177ECDEE851">
                     <p class="notep1">Note:</p>
                     <p>Sharded queues only support PL/SQL notification.</p>
                  </div>
                  <p>For JMS queues, the dequeue is accomplished as part of the notification; explicit dequeue is not required. For RAW queues, clients can specify payload delivery; but they still must dequeue the message in <code class="codeph">REMOVE_NO_DATA</code> mode. For all other persistent queues, the notification contains only the message properties; clients explicitly dequeue to receive the message. 
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-33D1B431-729C-43A3-BD17-712F08426AAB">Payload Delivery for RAW Queues</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>For RAW queues, Oracle Database Advanced Queuing clients can now specify that the message payload be delivered along with its notification. </p>
                     <div class="infoboxnotealso" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-D4F1A3EC-8843-44DA-B956-FB12E06E0330">
                        <p class="notep1">See Also:</p>
                        <p><span class="q">"<a href="aq-basic-components.html#GUID-94CBE09C-EE8C-4874-A30D-CCBE1F8D862E" title="This component identifies a producer or a consumer of a message.">AQ Registration Information Type</a>"</span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-80311020-37A6-4B2F-B372-A4F9F35AF5B1">Reliable Notification</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Clients can specify persistent message notification. If an Oracle RAC instance fails, its notifications are delivered by another Oracle RAC node. If a standalone instance fails, its notifications are delivered when the instance restarts.</p>
                     <div class="infoboxnote" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-D9526A19-850A-4807-B2F3-8909239BD41F">
                        <p class="notep1">Note:</p>
                        <p>Notification reliability refers only to server failures. If Oracle Database Advanced Queuing cannot deliver client notifications for any other reason, then the notifications are purged along with the client registration.</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-C9F17A4F-5BCB-4350-AE05-29BB4A87D463">Designated Port Notification</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>For non-sharded queues, Oracle Database Advanced Queuing clients can use the OCI subscription handle attribute <code class="codeph">OCI_ATTR_SUBSCR_PORTNO</code> to designate the port at which notifications are delivered. This is especially useful for clients on a computer behind a firewall. The port for the listener thread can be designated before the first registration, using an attribute in the environment handle. The thread is started the first time an <code class="codeph">OCISubscriptionRegister</code> is called. If the client attempts to start another thread on a different port using a different environment handle, then Oracle Database Advanced Queuing returns an error.
                     </p>
                     <div class="infoboxnote" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-389FE6E5-F156-41F2-8D3C-F9A25F2E86BD">
                        <p class="notep1">Note:</p>
                        <p>Designated port notification and IP address notification apply only to OCI clients.</p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-28FEECC8-5057-4485-B066-59C3C7F8D76F">
                        <p class="notep1">See Also:</p>
                        <p>"Publish-Subscribe Registration Functions in OCI" in <a href="../lnoci/session-and-connection-pooling.html#LNOCI090" target="_blank"><span class="italic">Oracle Call Interface Programmer's Guide</span></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-166B7371-05F6-4A91-A77C-F0969741F908">IPv6 Compliance and Designated IP Support</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>For non-sharded queues, Oracle Database AQ supports IPv6 and Oracle Database AQ clients can use the OCI subscription handle attribute <code class="codeph">OCI_ATTR_SUBSCR_IPADDR</code> to designate the IP address at which notifications are delivered. This is especially useful for clients on a computer that has multiple network interface cards or IP addresses. The IP address for the listener thread can be designated before the first registration using an attribute in the environment handle. The thread is started the first time an <code class="codeph">OCISubscriptionRegister</code> is called. If the client attempts to start another thread on a different IP address using a different environment handle, Oracle Database AQ returns an error. If no IP address is specified, Oracle Database AQ will deliver notifications on all IP addresses of the computer the client is on.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-26A115DA-546F-4B25-B1EA-F86D357E6F34">Registration Timeout</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>In earlier releases of Oracle Database Advanced Queuing, registrations for notification persisted until explicitly removed by the client or purged in case of extended client failure. From Oracle Database Advanced Queuing 10<span class="italic">g</span> Release 2 (10.2) onwards, clients can register for a specified time, after which the registration is automatically purged. 
                     </p>
                     <p>When the registration is purged, Oracle Database Advanced Queuing sends a notification to the client, so the client can invoke its callback and take any necessary action. </p>
                     <div class="infoboxnotealso" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-F11D5899-3929-46F2-96BC-AD485EB3261F">
                        <p class="notep1">See Also:</p>
                        <p><span class="q">"<a href="aq-basic-components.html#GUID-94CBE09C-EE8C-4874-A30D-CCBE1F8D862E" title="This component identifies a producer or a consumer of a message.">AQ Registration Information Type</a>"</span> for information on the <code class="codeph">timeout</code> parameter
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-DDC7403F-6FD0-4267-96B2-669122A0C067">Purge on Notification</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Clients can also register to receive only the first notification, after which the registration is automatically purged.</p>
                     <p>An example where purge on notification is useful is a client waiting for enqueues to start. In this case, only the first notification is useful; subsequent notifications provide no additional information. Previously, this client would be required to unregister once enqueuing started; now the registration can be configured to go away automatically.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-45A1093C-23DB-4FAF-97C1-1397596A53C0">Buffered Message Notification</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Clients can register for notification of buffered messages. The registration requests apply to both buffered and persistent messages. The message properties delivered with the PL/SQL or OCI notification specify whether the message is buffered or persistent.</p>
                     <div class="infoboxnotealso" id="GUID-537FBC2D-0A4E-4ED7-9484-EECE0C66E271__GUID-4E363589-CD4D-430D-83E6-2C96DF39C42D">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="aq-operations-using-pl-sql.html#GUID-DBBE096A-EEA0-4E1E-AC3F-6E1B492D1FB5" title="This procedure registers an e-mail address, user-defined PL/SQL procedure, or HTTP URL for message notification.">Registering for Notification</a>"</span> for more information on PL/SQL notification
                              </p>
                           </li>
                           <li>
                              <p>Appendix&nbsp;C, "OCI Examples", which appears only in the HTML version of this guide, for an example of OCI notification</p>
                           </li>
                        </ul>
                     </div>
                     <p>Reliable notification is not supported.</p>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADQUE2460"></a><div class="props_rev_3"><a id="GUID-B5FC0BA8-C1F0-444F-A7BE-13797C65E57C" name="GUID-B5FC0BA8-C1F0-444F-A7BE-13797C65E57C"></a><h4 id="ADQUE-GUID-B5FC0BA8-C1F0-444F-A7BE-13797C65E57C" class="sect4"><span class="enumeration_section">1.5.1 </span>Views on Registration
                  </h4>
                  <div>
                     <p>The dictionary views <code class="codeph">DBA_SUBSCR_REGISTRATIONS</code> and <code class="codeph">USER_SUBSCR_REGISTRATIONS</code> display the various registrations in the system.
                     </p>
                     <p> The diagnostic view <code class="codeph">GV$SUBSCR_REGISTRATION_STATS</code> may be used to monitor notification statistics and performance.
                     </p>
                  </div>
               </div><a id="ADQUE2461"></a><div class="props_rev_3"><a id="GUID-7A2AFB2D-E9F3-4769-8374-27D93CE7E0DF" name="GUID-7A2AFB2D-E9F3-4769-8374-27D93CE7E0DF"></a><h4 id="ADQUE-GUID-7A2AFB2D-E9F3-4769-8374-27D93CE7E0DF" class="sect4"><span class="enumeration_section">1.5.2 </span>Event-Based Notification
                  </h4>
                  <div>
                     <p>Event-based notifications are processed by a set of coordinator (<code class="codeph">EMNC</code>) and subordinate processes.
                     </p>
                     <p> The event notification load is distributed among these processes. These processes work on the system notifications in parallel, offering a capability to process a larger volume of notifications, a faster response time and lower shared memory use for staging notifications. </p>
                  </div>
               </div><a id="ADQUE2462"></a><div class="props_rev_3"><a id="GUID-4F8204C1-E161-43B0-9CA2-C0A571C133A1" name="GUID-4F8204C1-E161-43B0-9CA2-C0A571C133A1"></a><h4 id="ADQUE-GUID-4F8204C1-E161-43B0-9CA2-C0A571C133A1" class="sect4"><span class="enumeration_section">1.5.3 </span>Notification Grouping by Time
                  </h4>
                  <div>
                     <p>Notification applications may register to receive a single notification for all events that occur within a specified time interval. Notification Clients may specify a start time for the notifications. Additionally, they must specify a time as the grouping class and the time interval as the grouping value.</p>
                     <p>A repeat count may be used to limit the number of notifications delivered. Clients can receive two types of grouping events, Summary or Last. A summary notification is a list of Message Identifiers of all the messages for the subscription. If last was specified as a grouping type, notification would have information about the last message in the notification interval. A count of the number of messages in the interval is also sent. The registration interfaces in PLSQL and OCI allow for specification of the <code class="codeph">START_TIME</code>, <code class="codeph">REPEAT_COUNT</code>, <code class="codeph">GROUPING CLASS</code>, <code class="codeph">GROUPING VALUE</code>, <code class="codeph">GROUPING TYPE</code> in the <code class="codeph">AQ$_REGISTRATION_INFO</code> and the OCI subscription Handle. 
                     </p>
                     <p>The notification descriptor received by the client initiated AQ notification provides information about the group of message identifiers and the number of notifications in the group. </p>
                     <div class="infoboxnotealso" id="GUID-4F8204C1-E161-43B0-9CA2-C0A571C133A1__GUID-3767C5FD-A82D-4A90-9156-C570301C0A99">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../arpls/advanced-queuing-AQ-types.html#ARPLS301" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a></p>
                           </li>
                           <li>
                              <p><a href="../lnoci/performance-topics.html#LNOCI092" target="_blank"><span class="italic">Oracle Call Interface Programmer's Guide</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="ADQUE2464"></a><a id="ADQUE2465"></a><a id="ADQUE2466"></a><a id="ADQUE2467"></a><a id="ADQUE2468"></a><a id="ADQUE2469"></a><a id="ADQUE2463"></a><div class="props_rev_3"><a id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A" name="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A"></a><h3 id="ADQUE-GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A" class="sect3"><span class="enumeration_section">1.6 </span>Enqueue Features
               </h3>
               <div>
                  <p>This topic describes the enqueue features Enqueuing an Array of Messages, Correlation Identifiers, Priority and Ordering of Messages in Enqueuing, Message Grouping, Sender Identification, and Time Specification and Scheduling.</p>
                  <p>The following features apply to enqueuing messages:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDDIFAC">Enqueue an Array of Messages</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDHBIBH">Correlation Identifiers</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDIAGFG">Priority and Ordering of Messages in Enqueuing</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDFEHHB">Message Grouping</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDCHGII">Sender Identification</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDFFCIA">Time Specification and Scheduling</a></p>
                     </li>
                  </ul>
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDDIFAC">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-D8729C56-43E6-4E85-A010-C081F3CE9C86">Enqueue an Array of Messages</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>When enqueuing messages into a queue, you can operate on an array of messages simultaneously, instead of one message at a time. This can improve the performance of enqueue operations. When enqueuing an array of messages into a queue, each message shares the same enqueue options, but each message can have different message properties. You can perform array enqueue operations using PL/SQL or OCI.</p>
                     <p>Array enqueuing is not supported for buffered messages in this release.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDHBIBH">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-0666E55F-80BA-4064-B84B-E9E8E14B2924">Correlation Identifiers</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You can assign an identifier to each message, thus providing a means to retrieve specific messages at a later time.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDIAGFG">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-D392B8F0-14E1-4FD6-AE46-2422F780C563">Priority and Ordering of Messages in Enqueuing</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You can specify the priority of an enqueued message and its exact position in the queue. This means that users can specify the order in which messages are consumed in three ways:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>A priority can be assigned to each message.</p>
                        </li>
                        <li>
                           <p>A sort order specifies which properties are used to order all messages in a queue. This is set when the queue table is created and cannot be changed. You can choose to sort messages by priority, enqueue time, or commit time.</p>
                           <div class="infoboxnotealso" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-0ECD94E1-67AA-42D6-93A1-9E85BAA7BEE2">
                              <p class="notep1">See Also:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="q">"<a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41" title="DBMS_AQADM.CREATE_QUEUE_TABLE creates a non-sharded queue table for messages of a predefined type.">Creating a Queue Table</a>"</span> for more information on sort order
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p>A sequence deviation positions a message in relation to other messages.</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-BCE3B9E6-B37B-4534-81D9-FC4793FDD2A6">
                        <p class="notep1">Note:</p>
                        <p>The sequence deviation feature is deprecated in 10<span class="italic">g</span> Release 2 (10.2).
                        </p>
                     </div>
                     <p>If several consumers act on the same queue, then each consumer gets the first message that is available for immediate consumption. A message that is in the process of being consumed by another consumer is skipped.</p>
                     <p>Priority ordering of messages is achieved by specifying priority, enqueue time as the sort order. If priority ordering is chosen, then each message is assigned a priority at enqueue time by the enqueuing agent. At dequeue time, the messages are dequeued in the order of the priorities assigned. If two messages have the same priority, then the order in which they are dequeued is determined by the enqueue time. A first-in, first-out (FIFO) priority queue can also be created by specifying enqueue time, priority as the sort order of the messages. </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDFEHHB">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-E048BBBD-508D-4ADD-9091-7BE91F37A556">Message Grouping</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Messages belonging to one queue can be grouped to form a set that can only be consumed by one user at a time. This requires that the queue be created in a queue table that is enabled for message grouping. All messages belonging to a group must be created in the same transaction, and all messages created in one transaction belong to the same group. </p>
                     <p>This feature allows users to segment complex messages into simple messages. For example, messages directed to a queue containing invoices can be constructed as a group of messages starting with a header message, followed by messages representing details, followed by a trailer message.</p>
                     <p>Message grouping is also useful if the message payload contains complex large objects such as images and video that can be segmented into smaller objects.</p>
                     <p>Group message properties priority, delay, and expiration are determined solely by the message properties specified for the first message in a group, irrespective of which properties are specified for subsequent messages in the group. </p>
                     <p>The message grouping property is preserved across propagation. However, the destination queue where messages are propagated must also be enabled for transactional grouping. There are also some restrictions you must keep in mind if the message grouping property is to be preserved while dequeuing messages from a queue enabled for transactional grouping.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDCHGII">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-73E6EC91-DA2A-4E5D-9470-26659E246BEF">Sender Identification</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Applications can mark the messages they send with a custom identification. Oracle Database Advanced Queuing also automatically identifies the queue from which a message was dequeued. This allows applications to track the pathway of a propagated message or a string message within the same database. </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__CHDFFCIA">
                     <p class="subhead2" id="GUID-83F68756-B358-45ED-8C21-1DE6E87DCF7A__GUID-99606B68-B9D2-4EB7-865D-7483992394E2">Time Specification and Scheduling</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Messages can be enqueued with an expiration that specifies the interval of time the message is available for dequeuing. The default for expiration is never. When a message expires, it is moved to an exception queue. Expiration processing requires that the queue monitor be running.</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2471"></a><a id="ADQUE2472"></a><a id="ADQUE2473"></a><a id="ADQUE2474"></a><a id="ADQUE2475"></a><a id="ADQUE2476"></a><a id="ADQUE2477"></a><a id="ADQUE2478"></a><a id="ADQUE2479"></a><a id="ADQUE0104"></a><a id="ADQUE2470"></a><div class="props_rev_3"><a id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A" name="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A"></a><h3 id="ADQUE-GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A" class="sect3"><span class="enumeration_section">1.7 </span>Dequeue Features
               </h3>
               <div>
                  <p>This topic discusses the dequeue features Concurrent Dequeues, Dequeue Methods, Dequeue Modes, Dequeue an Array of Messages, Message States, Navigation of Messages in Dequeuing, Waiting for Messages, Retries with Delays, Optional Transaction Protection, and Exception Queues.</p>
                  <p>The following features apply to dequeuing messages:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIJCEE">Concurrent Dequeues</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCEJDG">Dequeue Methods</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCEDDG">Dequeue Modes</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIBGDA">Dequeue an Array of Messages</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIECFG">Message States</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDEDCCI">Navigation of Messages in Dequeuing</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCBGHJ">Waiting for Messages</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDFCFEA">Retries with Delays</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDBAEED">Optional Transaction Protection</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDICJFH">Exception Queues</a></p>
                     </li>
                  </ul>
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIJCEE">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-B8DF7262-16C2-4BEA-B164-6DB0FD498F9D">Concurrent Dequeues</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>When there are multiple processes dequeuing from a single-consumer queue or dequeuing for a single consumer on the multiconsumer queue, different processes skip the messages that are being worked on by a concurrent process. This allows multiple processes to work concurrently on different messages for the same consumer.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCEJDG">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-AE44B0AA-19C7-4ACD-B460-6EC7AA8E5FCD">Dequeue Methods</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>A message can be dequeued using one of the following dequeue methods:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Specifying a correlation identifier</p>
                           <p><a id="d6697e2755" class="indexterm-anchor"></a><a id="d6697e2761" class="indexterm-anchor"></a>A correlation identifier is a user-defined message property. Multiple messages with the same correlation identifier can be present in a queue, which means that the ordering (enqueue order) between messages might not be preserved on dequeue calls. 
                           </p>
                        </li>
                        <li>
                           <p>Specifying a message identifier</p>
                           <p><a id="d6697e2770" class="indexterm-anchor"></a><a id="d6697e2776" class="indexterm-anchor"></a>A message identifier is a system-assigned value (of <code class="codeph">RAW</code> datatype). Only one message with a given message identifier can be present in the queue. 
                           </p>
                        </li>
                        <li>
                           <p>Specifying a dequeue condition</p>
                           <p>A dequeue condition is expressed in terms of message properties or message content and is similar in syntax to the <code class="codeph">WHERE</code> clause of a SQL query. Messages in the queue are evaluated against the condition, and messages that satisfy the given condition are returned. When a dequeue condition is used, the order of the messages dequeued is indeterminate, and the sort order of the queue is not honored.
                           </p>
                        </li>
                        <li>
                           <p>Default dequeue</p>
                           <p>A default dequeue retrieves the first available message.</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-EEA0AE50-F950-4AB8-ACED-AE8C056F1A3D">
                        <p class="notep1">Note:</p>
                        <p>Dequeuing with correlation identifier, message identifier, or dequeue condition does not preserve the message grouping property.</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCEDDG">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-A82EB285-9726-41C7-B40D-88503FBF4BF7">Dequeue Modes</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>A dequeue request can browse a message, remove it, or remove it with no data. If a message is browsed, then it remains available for further processing. If a message is removed or removed with no data, then it is no longer available for dequeue requests. Depending on the queue properties, a removed message can be retained in the queue table. A message is retained in the queue table after it has been consumed only if a retention time is specified for its queue. </p>
                     <p>The browse mode has three risks. First, there is no guarantee that the message can be dequeued again after it is browsed, because a dequeue call from a concurrent user might have removed the message. To prevent a viewed message from being dequeued by a concurrent user, you should view the message in the locked mode. </p>
                     <p>Second, your dequeue position in browse mode is automatically changed to the beginning of the queue if a nonzero wait time is specified and the navigating position reaches the end of the queue. If you repeat a dequeue call in the browse mode with the <code class="codeph">NEXT_MESSAGE</code> navigation option and a nonzero wait time, then you can end up dequeuing the same message over and over again. Oracle recommends that you use a nonzero wait time for the first dequeue call on a queue in a session, and then use a zero wait time with the <code class="codeph">NEXT_MESSAGE</code> navigation option for subsequent dequeue calls. If a dequeue call gets an "end of queue" error message, then the dequeue position can be explicitly set by the dequeue call to the beginning of the queue using the <code class="codeph">FIRST_MESSAGE</code> navigation option, following which the messages in the queue can be browsed again.
                     </p>
                     <p>Third, if the sort order of the queue is <code class="codeph">ENQ_TIME</code>, <code class="codeph">PRIORITY</code>, or a combination of these two, then results may not be repeatable from one browse to the next. If you must have consistent browse results, then you should use a <a href="glossary.html#GUID-F4FC927D-BBFE-451D-9CCA-96C7387A39B0"><span class="xrefglossterm">commit-time queue</span></a>.
                     </p>
                     <div class="infoboxnotealso" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-F2ADD023-19FA-407C-96DF-D7551C169F37">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="aq-administrative-interface.html#GUID-7A35067E-0A52-4EC2-B0F8-3540E8554E41" title="DBMS_AQADM.CREATE_QUEUE_TABLE creates a non-sharded queue table for messages of a predefined type.">Creating a Queue Table</a>"</span></p>
                           </li>
                        </ul>
                     </div>
                     <p>When a message is dequeued using <code class="codeph">REMOVE_NODATA</code> mode, the payload of the message is not retrieved. This mode can be useful when the user has already examined the message payload, possibly by means of a previous <code class="codeph">BROWSE</code> dequeue. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIBGDA">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-435C0408-69E1-4E42-BF22-266CA2EE875D">Dequeue an Array of Messages</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>When dequeuing messages from a queue, you can operate on an array of messages simultaneously, instead of one message at a time. This can improve the performance of dequeue operations. If you are dequeuing from a transactional queue, you can dequeue all the messages for a transaction with a single call, which makes application programming easier.</p>
                     <p>When dequeuing an array of messages from a queue, each message shares the same dequeue options, but each message can have different message properties. You can perform array enqueue and array dequeue operations using PL/SQL or OCI.</p>
                     <p>Array dequeuing is not supported for buffered messages in this release.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDIECFG">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-B9D7FAAD-95CB-4508-B5E1-DF068222C565">Message States</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Multiple processes or operating system threads can use the same consumer name to dequeue concurrently from a queue. In that case Oracle Database Advanced Queuing provides the first unlocked message that is at the head of the queue and is intended for the consumer. Unless the message identifier of a specific message is specified during dequeue, consumers can dequeue messages that are in the <code class="codeph">READY</code> state. 
                     </p>
                     <p>A message is considered <code class="codeph">PROCESSED</code> only when all intended consumers have successfully dequeued the message. A message is considered <code class="codeph">EXPIRED</code> if one or more consumers did not dequeue the message before the <code class="codeph">EXPIRATION</code> time. When a message has expired, it is moved to an exception queue. 
                     </p>
                     <p>Expired messages from multiconsumer queues cannot be dequeued by the intended recipients of the message. However, they can be dequeued in the <code class="codeph">REMOVE</code> mode exactly once by specifying a <code class="codeph">NULL</code> consumer name in the dequeue options. 
                     </p>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-0A009B61-AD6E-4243-9EED-6ABFFAA8CBA2">
                        <p class="notep1">Note:</p>
                        <p>If the multiconsumer exception queue was created in a queue table with the <code class="codeph">compatible</code> parameter set to <code class="codeph">8.0</code>, then expired messages can be dequeued only by specifying a message identifier. 
                        </p>
                        <p>Queues created in a queue table with <code class="codeph">compatible</code> set to <code class="codeph">8.0</code> (referred to in this guide as 8.0-style queues) are deprecated in Oracle Database Advanced Queuing 10<span class="italic">g</span> Release 2 (10.2). Oracle recommends that any new queues you create be 8.1-style or newer and that you migrate existing 8.0-style queues at your earliest convenience.
                        </p>
                     </div>
                     <p>Beginning with Oracle Database Advanced Queuing release 8.1.6, only the queue monitor removes messages from multiconsumer queues. This allows dequeuers to complete the dequeue operation by not locking the message in the queue table. Because the queue monitor removes messages that have been processed by all consumers from multiconsumer queues approximately once every minute, users can see a delay between when the messages have been completely processed and when they are physically removed from the queue.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDEDCCI">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-086355B6-2B94-40D9-80D2-09F19CAB2A5E">Navigation of Messages in Dequeuing</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You have several options for selecting a message from a queue. You can select the first message with the <code class="codeph">FIRST_MESSAGE</code> navigation option. Alternatively, once you have selected a message and established its position in the queue, you can then retrieve the next message with the <code class="codeph">NEXT_MESSAGE</code> navigation option. 
                     </p>
                     <p>The <code class="codeph">FIRST_MESSAGE</code> navigation option performs a <code class="codeph">SELECT</code> on the queue. The <code class="codeph">NEXT_MESSAGE</code> navigation option fetches from the results of the <code class="codeph">SELECT</code> run in the <code class="codeph">FIRST_MESSAGE</code> navigation. Thus performance is optimized because subsequent dequeues need not run the entire <code class="codeph">SELECT</code> again. 
                     </p>
                     <p>If the queue is enabled for transactional grouping, then the navigation options work in a slightly different way. If <code class="codeph">FIRST_MESSAGE</code> is requested, then the dequeue position is still reset to the beginning of the queue. But if <code class="codeph">NEXT_MESSAGE</code> is requested, then the position is set to the next message in the same <span class="italic">transaction</span>. Transactional grouping also offers a <code class="codeph">NEXT_TRANSACTION</code> option. It sets the dequeue position to the first message of the next transaction.
                     </p>
                     <p><a id="d6697e2961" class="indexterm-anchor"></a><a id="d6697e2965" class="indexterm-anchor"></a>Transaction grouping has no effect if you dequeue by specifying a correlation identifier or message identifier, or if you dequeue some of the messages of a transaction and then commit.
                     </p>
                     <p>If you reach the end of the queue while using the <code class="codeph">NEXT_MESSAGE</code> or <code class="codeph">NEXT_TRANSACTION</code> option, and you have specified a nonzero wait time, then the navigating position is automatically changed to the beginning of the queue. If a zero wait time is specified, then you can get an exception when the end of the queue is reached.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDCBGHJ">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-3DE663E5-F464-499E-AF23-5FE11D30637F">Waiting for Messages</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Database Advanced Queuing allows applications to block on one or more queues waiting for the arrival of either a newly enqueued message or a message that becomes ready. You can use the <code class="codeph">DEQUEUE</code> operation to wait for the arrival of a message in a single queue or the <code class="codeph">LISTEN</code> operation to wait for the arrival of a message in more than one queue. 
                     </p>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-CE074C3B-E9DA-4A04-BAF6-D00BE92380E8">
                        <p class="notep1">Note:</p>
                        <p>Applications can also perform a blocking dequeue on exception queues to wait for arrival of <code class="codeph">EXPIRED</code> messages.
                        </p>
                     </div>
                     <p>When the blocking <code class="codeph">DEQUEUE</code> call returns, it returns the message properties and the message payload. When the blocking <code class="codeph">LISTEN</code> call returns, it discloses only the name of the queue where a message has arrived. A subsequent <code class="codeph">DEQUEUE</code> operation is needed to dequeue the message.
                     </p>
                     <p>When there are messages for multiple agents in the agent list, <code class="codeph">LISTEN</code> returns with the first agent for whom there is a message. To prevent one agent from starving other agents for messages, the application can change the order of the agents in the agent list. 
                     </p>
                     <p>Applications can optionally specify a timeout of zero or more seconds to indicate the time that Oracle Database Advanced Queuing must wait for the arrival of a message. The default is to wait forever until a message arrives in the queue. This removes the burden of continually polling for messages from the application, and it saves CPU and network resources because the application remains blocked until a new message is enqueued or becomes <code class="codeph">READY</code> after its <code class="codeph">DELAY</code> time. 
                     </p>
                     <p>An application that is blocked on a dequeue is either awakened directly by the enqueuer if the new message has no <code class="codeph">DELAY</code> or is awakened by the queue monitor process when the <code class="codeph">DELAY</code> or <code class="codeph">EXPIRATION</code> time has passed. If an application is waiting for the arrival of a message in a remote queue, then the Oracle Database Advanced Queuing propagator wakes up the blocked dequeuer after a message has been propagated.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDFCFEA">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-C87C4418-8812-4CB0-9EC8-1EE2CAA3D6A9">Retries with Delays</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>If the transaction dequeuing a message from a queue fails, then it is regarded as an unsuccessful attempt to consume the message. Oracle Database Advanced Queuing records the number of failed attempts to consume the message in the message history. Applications can query the <code class="codeph">RETRY_COUNT</code> column of the queue table view to find out the number of unsuccessful attempts on a message. In addition, Oracle Database Advanced Queuing allows the application to specify, at the queue level, the maximum number of retries for messages in the queue. The default value for maximum retries is 5. If the number of failed attempts to remove a message exceeds this number, then the message is moved to the exception queue and is no longer available to applications. 
                     </p>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-BAD0C00F-9BE3-4B94-803D-70F1DFDA7216">
                        <p class="notep1">Note:</p>
                        <p>If a dequeue transaction fails because the server process dies (including <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">KILL</code> <code class="codeph">SESSION</code>) or <code class="codeph">SHUTDOWN</code> <code class="codeph">ABORT</code> on the instance, then <code class="codeph">RETRY_COUNT</code> is not incremented.
                        </p>
                     </div>
                     <p>A bad condition can cause the transaction receiving a message to end. Oracle Database Advanced Queuing allows users to hide the bad message for a specified retry delay interval, during which it is in the WAITING state. After the retry delay, the failed message is again available for dequeue. The Oracle Database Advanced Queuing time manager enforces the retry delay property. The default value for retry delay is 0. </p>
                     <p><a id="d6697e3068" class="indexterm-anchor"></a>If multiple sessions are dequeuing messages from a queue simultaneously, then <code class="codeph">RETRY_COUNT</code> information might not always be updated correctly. If session one dequeues a message and rolls back the transaction, then Oracle Database AQ notes that the <code class="codeph">RETRY_COUNT</code> information for this message must be updated. However <code class="codeph">RETRY_COUNT</code> cannot be incremented until session one completes the rollback. If session two attempts to dequeue the same message after session one has completed the rollback but before it has incremented <code class="codeph">RETRY_COUNT</code>, then the dequeue by session two succeeds. When session one attempts to increment <code class="codeph">RETRY_COUNT</code>, it finds that the message is locked by session two and <code class="codeph">RETRY_COUNT</code> is not incremented. A trace file is then generated in the <code class="codeph">USER_DUMP_DESTINATION</code> for the instance with the following message:
                     </p><pre class="oac_no_warn" dir="ltr">Error on rollback: ORA-25263: no message in queue <span class="italic">schema.qname</span> with message ID ...
</pre><div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-3E394308-99E0-4F6C-A44A-04D0DFF91470">
                        <p class="notep1">Note:</p>
                        <p>Maximum retries and retry delay are not available with 8.0-style multiconsumer queues.</p>
                        <p>Queues created in a queue table with <code class="codeph">compatible</code> set to <code class="codeph">8.0</code> (referred to in this guide as 8.0-style queues) are deprecated in Oracle Database Advanced Queuing 10<span class="italic">g</span> Release 2 (10.2). Oracle recommends that any new queues you create be 8.1-style or newer and that you migrate existing 8.0-style queues at your earliest convenience.
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDBAEED">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-202BEAC7-FAD6-4E44-8C1D-51F0F6624F24">Optional Transaction Protection</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Enqueue and dequeue requests are usually part of a transaction that contains the requests, thereby providing the wanted <a href="glossary.html#GUID-4956C594-EE49-498B-A9DD-7371518B4EBA"><span class="xrefglossterm">transactional</span></a> action. You can, however, specify that a specific request is a transaction by itself, making the result of that request immediately visible to other transactions. This means that messages can be made visible to the external world when the enqueue or dequeue statement is applied or after the transaction is committed.
                     </p>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-838D7EF6-8D21-43D5-BA1A-68C234C750D2">
                        <p class="notep1">Note:</p>
                        <p>Transaction protection is not supported for buffered messaging.</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__CHDICJFH">
                     <p class="subhead2" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-7016AE91-28BB-4BD2-80E4-BA4E91159DF0">Exception Queues</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>An exception queue is a repository for expired or unserviceable messages. Applications cannot directly enqueue into exception queues. Also, a multiconsumer exception queue cannot have subscribers associated with it. However, an application that intends to handle these expired or unserviceable messages can dequeue them exactly once from the exception queue using remove mode. The consumer name specified while dequeuing should be null. Messages can also be dequeued from the exception queue by specifying the message identifier.</p>
                     <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-9666108C-71F8-4EB3-AFB7-E513BF125942">
                        <p class="notep1">Note:</p>
                        <p>Expired or unserviceable buffered messages are moved to an exception queue as persistent messages.</p>
                        <p>Messages intended for single-consumer queues, or for 8.0-style multiconsumer queues, can only be dequeued by their message identifiers once the messages have been moved to an exception queue. </p>
                        <p>Queues created in a queue table with <code class="codeph">compatible</code> set to <code class="codeph">8.0</code> (referred to in this guide as 8.0-style queues) are deprecated in Oracle Database Advanced Queuing 10<span class="italic">g</span> Release 2 (10.2). Oracle recommends that any new queues you create be 8.1-style or newer and that you migrate existing 8.0-style queues at your earliest convenience.
                        </p>
                     </div>
                     <p>After a message has been moved to an exception queue, there is no way to identify which queue the message resided in before moving to the exception queue. If this information is important, then the application must save this information in the message itself.</p>
                     <p>The exception queue is a message property that can be specified during enqueue time. If an exception queue is not specified, then a default exception queue is used. The default exception queue is automatically created when the queue table is created. </p>
                     <p>A message is moved to an exception queue under the following conditions:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>It was not dequeued within the specified expiration interval. </p>
                           <p>For a message intended for multiple recipients, the message is moved to the exception queue if one or more of the intended recipients was not able to dequeue the message within the specified expiration interval. The default expiration interval is never, meaning the messages does not expire.</p>
                        </li>
                        <li>
                           <p>The message was dequeued successfully, but the application that dequeued it rolled back the transaction because of an error that arose while processing the message. If the message has been dequeued but rolled back more than the number of times specified by the retry limit, then the message is moved to the exception queue. </p>
                           <p>For a message intended for multiple recipients, a separate retry count is kept for each recipient. The message is moved to the exception queue only when retry counts for all recipients of the message have exceeded the specified retry limit. </p>
                           <p>The default retry limit is five for single-consumer queues and 8.1-style multiconsumer queues. No retry limit is supported for 8.0-style multiconsumer queues, which are deprecated in Oracle Database Advanced Queuing 10<span class="italic">g</span> Release 2 (10.2). 
                           </p>
                           <div class="infoboxnote" id="GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A__GUID-6736B024-8977-4333-91FA-8616DE777B2F">
                              <p class="notep1">Note:</p>
                              <p>If a dequeue transaction fails because the server process dies (including <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">KILL</code> <code class="codeph">SESSION</code>) or <code class="codeph">SHUTDOWN</code> <code class="codeph">ABORT</code> on the instance, then <code class="codeph">RETRY_COUNT</code> is not incremented.
                              </p>
                           </div>
                        </li>
                        <li>
                           <p>The statement processed by the client contains a dequeue that succeeded but the statement itself was undone later due to an exception. </p>
                           <p>If the dequeue procedure succeeds but the PL/SQL procedure raises an exception, then Oracle Database Advanced Queuing increments the retry count of the message returned by the dequeue procedure.</p>
                        </li>
                        <li>
                           <p>The client program successfully dequeued a message but terminated before committing the transaction. </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2481"></a><a id="ADQUE2482"></a><a id="ADQUE2483"></a><a id="ADQUE2484"></a><a id="ADQUE2485"></a><a id="ADQUE2486"></a><a id="ADQUE2487"></a><a id="ADQUE2488"></a><a id="ADQUE2489"></a><a id="ADQUE2490"></a><a id="ADQUE2491"></a><a id="ADQUE2492"></a><a id="ADQUE2480"></a><div class="props_rev_3"><a id="GUID-329A6279-925C-435B-A6F1-76835EF20C40" name="GUID-329A6279-925C-435B-A6F1-76835EF20C40"></a><h3 id="ADQUE-GUID-329A6279-925C-435B-A6F1-76835EF20C40" class="sect3"><span class="enumeration_section">1.8 </span>Propagation Features
               </h3>
               <div>
                  <p>Messages can be propagated from one queue to another, allowing applications to communicate with each other without being connected to the same database or to the same queue. The destination queue can be located in the same database or in a remote database.</p>
                  <p>Propagation enables you to fan out messages to a large number of recipients without requiring them all to dequeue messages from a single queue. You can also use propagation to combine messages from different queues into a single queue. This is known as compositing or funneling messages.</p>
                  <div class="infoboxnote" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-4A6BE513-8096-4DE9-8A00-4CF1C12237DA">
                     <p class="notep1">Note:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You can propagate messages from a multi-consumer queue to a single-consumer queue. Propagation from a single-consumer queue to a multi-consumer queue is not possible.</p>
                        </li>
                        <li>
                           <p>For non-sharded queues, you can propagate messages from a multi-consumer queue to a single-consumer non-sharded queue. Propagation from a single-consumer queue to a multi-consumer non-sharrded queue is not possible.</p>
                           <p></p>
                        </li>
                        <li>
                           <p>For sharded queues, you can propagate between single-consumuer and multi-consumer sharded queues.</p>
                        </li>
                        <li>
                           <p>You cannot propagate between sharded and non-sharded queues.</p>
                        </li>
                     </ul>
                  </div>
                  <p>A message is marked as processed in the source queue immediately after the message has been propagated, even if the consumer has not dequeued the message at the remote queue. Similarly, when a propagated message expires at the remote queue, the message is moved to the exception queue of the remote queue, and not to the exception queue of the local queue. Oracle Database Advanced Queuing does not currently propagate the exceptions to the source queue. </p>
                  <p>To enable propagation, one or more subscribers are defined for the queue from which messages are to be propagated and a schedule is defined for each destination where messages are to be propagated from the queue. </p>
                  <p>Oracle Database Advanced Queuing automatically checks if the type of the remote queue is structurally equivalent to the type of the local queue within the context of the character sets in which they are created. Messages enqueued in the source queue are then propagated and automatically available for dequeuing at the destination queue or queues.</p>
                  <p>When messages arrive at the destination queues, sessions based on the source queue schema name are used for enqueuing the newly arrived messages into the destination queues. This means that you must grant schemas of the source queues enqueue privileges to the destination queues. </p>
                  <p>Propagation runs as an Oracle Scheduler job. A background process, the <code class="codeph">JOB_QUEUE_PROCESS</code> will run the job. Propagation scheduling may be a dedicated process, running continuously and without end, or it may be event driven, in which case it runs only if there is a message to be propagated.
                  </p>
                  <p>Oracle Database Advanced Queuing offers two kinds of propagation:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Queue-to-dblink propagation</p>
                     </li>
                     <li>
                        <p>Queue-to-queue propagation</p>
                     </li>
                  </ul>
                  <p><a id="d6697e3466" class="indexterm-anchor"></a>Queue-to-dblink propagation delivers messages or events from the source queue to all subscribing queues at the destination database identified by the dblink. 
                  </p>
                  <p>A single propagation schedule is used to propagate messages to all subscribing queues. Hence any changes made to this schedule will affect message delivery to all the subscribing queues.</p>
                  <p><a id="d6697e3477" class="indexterm-anchor"></a>Queue-to-queue propagation delivers messages or events from the source queue to a specific destination queue identified on the dblink. This allows the user to have fine-grained control on the propagation schedule for message delivery. 
                  </p>
                  <p>This new propagation mode also supports transparent failover when propagating to a destination Oracle RAC system. With queue-to-queue propagation, you are no longer required to re-point a database link if the owner instance of the queue fails on Oracle RAC.</p>
                  <p>Oracle Database Advanced Queuing provides detailed statistics about the messages propagated and the schedule itself. This information can be used to tune propagation schedules for best performance.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-423BF50A-A164-437A-BA76-1A89ABB70565">Remote Consumers</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Consumers of a message in multiconsumer queues can be local or remote. Local consumers dequeue messages from the same queues into which the producer enqueued the messages. Local consumers have a name but no address or protocol in their agent descriptions.</p>
                     <p>Remote consumers dequeue from queues that are different from the queues where the messages were enqueued. Remote consumers fall into three categories: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The address refers to a queue in the same database. </p>
                           <p>In this case the consumer dequeues the message from a different queue in the same database. These addresses are of the form <code class="codeph">[schema]</code>.<code class="codeph">queue_name</code>. If the schema is not specified, then the schema of the current user is used.
                           </p>
                        </li>
                        <li>
                           <p>The address refers to a queue in a different database.</p>
                           <p>In this case the database must be reachable using database links and the protocol must be either <code class="codeph">NULL</code> or 0. These addresses are of the form <code class="codeph">[schema]</code>.<code class="codeph">queue_name@dblink</code>. If the schema is not specified, then the schema of the current user is used. If the database link does not have a domain name specified, then the default domain as specified by the <code class="codeph">DB_DOMAIN</code> <code class="codeph">init</code>.<code class="codeph">ora</code> parameter is used.
                           </p>
                        </li>
                        <li>
                           <p>The address refers to a destination that can be reached by a third party protocol.</p>
                           <p>You must refer to the documentation of the third party software to determine how to specify the address and the protocol database link and schedule propagation.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-7EDAACA7-A291-4069-9AD8-8C3313C64368">Propagation to Remote Subscribers</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Database Advanced Queuing validates the database link specified in a propagation schedule when the schedule runs, but not when the schedule is created. It is possible, therefore, to create a queue-to-dblink or queue-to-queue propagation before creating its associated database link. Also, the propagation schedule is not disabled if you remove the database link. </p>
                     <p>Oracle Database AQ offers two kinds of propagation: </p>
                     <p>A) <span class="bold">Queue-to-dblink propagation</span> - specified by providing a (source) queue and (destination) databaselink. Messages from the source queue for any queues at the destination specified by the dblink will be handled by this propagation.
                     </p>
                     <p>In this scenario, we cannot have multiple propagations from a source queue, with dblinks connecting to the same database. Thus(q1, dblink1) and (q1, dblink2) cannot coexist if both dblinks connect to the same database. However (q1, dblink1) and (q2, dblink1) OR (q1, dblink1) and (q2, dblink2) can coexist as source queues are different. </p>
                     <p>B) <span class="bold">Queue-to-queue propagation</span> - specified by providing a (source) queue, (destination) dblink and (destination) queue. Messages from the source queue for the indicated queue at the destination dblink will be handled by this propagation. Here, either (q1, dblink1, dq1), (q1, dblink1, dq2) OR (q1, dblink1, dq1), (q1, dblink2, dq2)   succeeds. This strategy works because the destination queues are different even though source queue is the same and dblink connects to the same database.
                     </p>
                     <p>In this scenario, we cannot have multiple propagations between a source queue, destination queue, even if using different dblinks: (q1, dblink1, q2) and (q1, dblink2, q2) cannot coexist, if dblink1 and dblink2 are pointing to the same database. </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-3A0D37F1-7397-4BE3-B66C-4A29DD4CE175">Priority and Ordering of Messages in Propagation</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>The delay, expiration, and priority parameters apply identically to both local and remote consumers in both queue-to-dblink and queue-to-queue propagation. Oracle Database Advanced Queuing accounts for any delay in propagation by adjusting the delay and expiration parameters accordingly. For example, if expiration is set to one hour, and the message is propagated after 15 minutes, then the expiration at the remote queue is set to 45 minutes.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-2813B90B-1FD8-4096-B2B0-5509F3A3D85A">Inboxes and Outboxes</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a href="aq-introduction.html#GUID-329A6279-925C-435B-A6F1-76835EF20C40__CHDHCDCH">Figure 1-9</a> illustrates applications on different databases communicating using Oracle Database Advanced Queuing. Each application has an inbox for handling incoming messages and an outbox for handling outgoing messages. Whenever an application enqueues a message, it goes into its outbox regardless of the message destination. Similarly, an application dequeues messages from its inbox no matter where the message originates.
                     </p>
                     <div class="figure" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__CHDHCDCH">
                        <p class="titleinfigure">Figure 1-9 Message Propagation in Oracle Database Advanced Queuing</p><img src="img/adque042.gif" width="400" alt="Description of Figure 1-9 follows" title="Description of Figure 1-9 follows" longdesc="img_text/adque042.html"><br><a href="img_text/adque042.html">Description of "Figure 1-9 Message Propagation in Oracle Database Advanced Queuing"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-93E4E1BB-813B-438F-8120-C4E1EC2EF5CF">Propagation Scheduling</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a id="d6697e3583" class="indexterm-anchor"></a><a id="d6697e3589" class="indexterm-anchor"></a>A queue-to-dblink propagation schedule is defined for a pair of source and destination database links. A queue-to-queue propagation schedule is defined for a pair of source and destination queues. If a queue has messages to be propagated to several queues, then a schedule must be defined for each of the destination queues. With queue-to-dblink propagation, all schedules for a particular remote database have the same frequency. With queue-to-queue propagation, the frequency of each schedule can be adjusted independently of the others
                     </p>
                     <p>A schedule indicates the time frame during which messages can be propagated from the source queue. This time frame can depend on several factors such as network traffic, load at the source database, and load at the destination database. If the duration is unspecified, then the time frame is an infinite single window. If a window must be repeated periodically, then a finite duration is specified along with a <code class="codeph">NEXT_TIME</code> function that defines the periodic interval between successive windows.
                     </p>
                     <p>When a schedule is created, a job is automatically submitted to the job queue facility to handle propagation. </p>
                     <p><a id="d6697e3604" class="indexterm-anchor"></a>The propagation schedules defined for a queue can be changed or dropped at any time during the life of the queue. You can also temporarily disable a schedule instead of dropping it. All administrative calls can be made irrespective of whether the schedule is active or not. If a schedule is active, then it takes a few seconds for the calls to be processed. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-0C75E443-0AA6-4863-B8E2-AFA659407B06">Propagation of Messages with LOBs</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Large Objects can be propagated using Oracle Database Advanced Queuing using two methods: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Propagation from <code class="codeph">RAW</code> queues 
                           </p>
                           <p>In <code class="codeph">RAW</code> queues the message payload is stored    as a BLOB. This allows users to store up to 32KB of data when using the PL/SQL interface and as much data as can be contiguously allocated by the client when using OCI. This method is supported by all releases after 8.0.4 inclusive.
                           </p>
                        </li>
                        <li>
                           <p>Propagation from object queues with LOB attributes </p>
                           <p>The user can populate the <code class="codeph">LOB</code> and read from the <code class="codeph">LOB</code> using Oracle Database <code class="codeph">LOB</code> handling routines. The <code class="codeph">LOB</code> attributes can be <code class="codeph">BLOB</code>s or <code class="codeph">CLOB</code>s (not NCLOBs). If the attribute is a <code class="codeph">CLOB</code>, then Oracle Database Advanced Queuing automatically performs any necessary character set conversion between the source queue and the destination queue. This method is supported by all releases from 8.1.3 inclusive.
                           </p>
                           <div class="infoboxnote" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-3A71A99E-90A0-4B2D-BF25-6143B4DD25D8">
                              <p class="notep1">Note:</p>
                              <p>Payloads containing LOBs require users to grant explicit <code class="codeph">Select</code>, <code class="codeph">Insert</code> and <code class="codeph">Update</code> privileges on the queue table for doing enqueues and dequeues.
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-B10BBFC7-EEDA-411E-8B41-39E35BA6E97C">
                              <p class="notep1">See Also:</p>
                              <p><a href="../adlob/index.html" target="_blank"><span class="italic">Oracle Database SecureFiles and Large Objects Developer's Guide</span></a></p>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-600FE086-5209-4D40-B23C-850FF60BD6D9">Propagation Statistics</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Detailed runtime information about propagation is gathered and stored in the <code class="codeph">DBA_QUEUE_SCHEDULES</code> view for each propagation schedule. This information can be used by queue designers and administrators to fix problems or tune performance. Similarly, errors reported by the view can be used to diagnose and fix problems. The view also describes additional information such as the session ID of the session handling the propagation and the process name of the job queue process handling the propagation. 
                     </p>
                     <p>For each schedule, detailed propagation statistics are maintained:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Total number of messages propagated in a schedule</p>
                        </li>
                        <li>
                           <p>Total number of bytes propagated in a schedule</p>
                        </li>
                        <li>
                           <p>Maximum number of messages propagated in a window</p>
                        </li>
                        <li>
                           <p>Maximum number of bytes propagated in a window</p>
                        </li>
                        <li>
                           <p>Average number of messages propagated in a window</p>
                        </li>
                        <li>
                           <p>Average size of propagated messages </p>
                        </li>
                        <li>
                           <p>Average time to propagated a message</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-8F5E84CA-8880-4812-8D26-82F23494F34D">Propagation Error Handling</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Propagation has built-in support for handling failures and reporting errors. For example, if the specified database link is invalid, if the remote database is unavailable, or if the remote queue is not enabled for enqueuing, then the appropriate error message is reported. Propagation uses a linear backoff scheme for retrying propagation from a schedule that encountered a failure. </p>
                     <p>If a schedule continuously encounters failures, then the first retry happens after 30 seconds, the second after 60 seconds, the third after 120 seconds and so forth. If the retry time is beyond the expiration time of the current window, then the next retry is attempted at the start time of the next window. A maximum of 16 retry attempts is made, after which the schedule is automatically disabled. </p>
                     <div class="infoboxnote" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-E088C1F5-92CC-4BA9-8A07-AF3C21DF9F62">
                        <p class="notep1">Note:</p>
                        <p>Once a retry attempt slips to the next propagation window, it will always do so; the exponential backoff scheme no longer governs retry scheduling. If the date function specified in the <code class="codeph">next_time</code> parameter of <code class="codeph">DBMS_AQADM.SCHEDULE_PROPAGATION</code> results in a short interval between windows, then the number of unsuccessful retry attempts can quickly reach 16, disabling the schedule.
                        </p>
                     </div>
                     <p>When a schedule is disabled automatically due to failures, the relevant information is written into the alert log. A check for scheduling failures indicates: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>How many successive failures were encountered</p>
                        </li>
                        <li>
                           <p>The error message indicating the cause for the failure </p>
                        </li>
                        <li>
                           <p>The time at which the last failure was encountered</p>
                        </li>
                     </ul>
                     <p>By examining this information, a queue administrator can fix the failure and enable the schedule. If propagation is successful during a retry, then the number of failures is reset to 0. </p>
                     <p>In some situations that indicate application errors in queue-to-dblink propagations, Oracle Database Advanced Queuing marks messages as <code class="codeph">UNDELIVERABLE</code> and logs a message in <code class="codeph">alert.log</code>. Examples of such errors are when the remote queue does not exist or when there is a type mismatch between the source queue and the remote queue. The trace files in the <code class="codeph">background_dump_dest</code> directory can provide additional information about the error.
                     </p>
                     <p><a id="d6697e3750" class="indexterm-anchor"></a>When a new job queue process starts, it clears the mismatched type errors so the types can be reverified. If you have capped the number of job queue processes and propagation remains busy, then you might not want to wait for the job queue process to terminate and restart. Queue types can be reverified at any time using <code class="codeph">DBMS_AQADM.VERIFY_QUEUE_TYPES</code>. 
                     </p>
                     <div class="infoboxnote" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-CC5B8025-7EDA-4847-AF58-C93642304CF7">
                        <p class="notep1">Note:</p>
                        <p>When a type mismatch is detected in queue-to-queue propagation, propagation stops and throws an error. In such situations you must query the <code class="codeph">DBA_SCHEDULES</code> view to determine the last error that occurred during propagation to a particular destination. The message is not marked as <code class="codeph">UNDELIVERABLE</code>.
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-00DD78E1-795F-43C5-B3EB-DDBD78B04ADC">Propagation with Oracle Real Application Clusters</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Propagation has support built-in for Oracle Real Application Clusters. It is transparent to the user and the queue administrator. The job that handles propagation is submitted to the same instance as the owner of the queue table where the queue resides. </p>
                     <p>If there is a failure at an instance and the queue table that stores the source queue is migrated to a different instance, then the propagation job is also migrated to the new instance. This minimizes pinging between instances and thus offers better performance. </p>
                     <p><a id="d6697e3776" class="indexterm-anchor"></a><a id="d6697e3782" class="indexterm-anchor"></a>The destination can be identified by a database link or by destination queue name. Specifying the destination database results in queue-to-dblink propagation. If you propagate messages to several queues in another database, then all queue-to-dblink propagations to that database have the same frequency. Specifying the destination queue name results in queue-to-queue propagation. If you propagate messages to several queues in another database, then queue-to-queue propagation enables you to adjust the frequency of each schedule independently of the others. You can even enable or disable individual propagations.
                     </p>
                     <p>This new queue-to-queue propagation mode also supports transparent failover when propagating to a destination Oracle RAC system. With queue-to-queue propagation, you are no longer required to re-point a database link if the owner instance of the queue fails on Oracle RAC.</p>
                     <div class="infoboxnotealso" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-88B65EF4-2E9C-4683-AD9A-329C6642A8B2">
                        <p class="notep1">See Also:</p>
                        <p><span class="q">"<a href="aq-administrative-interface.html#GUID-3B8E1DFE-0A6A-4CF2-8069-8DAECB5359A2" title="DBMS_AQADM.SCHEDULE_PROPAGATION schedules propagation of messages.">Scheduling a Queue Propagation</a>"</span> for more information on queue-to-queue propagation
                        </p>
                     </div>
                     <p>Propagation has been designed to handle any number of concurrent schedules. The number of job queue processes is limited to a maximum of 1000, and some of these can be used to handle jobs unrelated to propagation. Hence, propagation has built-in support for multitasking and load balancing. </p>
                     <p>The propagation algorithms are designed such that multiple schedules can be handled by a single job queue process. The propagation load on a job queue process can be skewed based on the arrival rate of messages in the different source queues. </p>
                     <p>If one process is overburdened with several active schedules while another is less loaded with many passive schedules, then propagation automatically redistributes the schedules so they are loaded uniformly. </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-574E1439-F5EE-49A6-BE7F-88813147F834">Third-Party Support</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>If the protocol number for a recipient is in the range 128 - 255, then the address of the recipient is not interpreted by Oracle Database Advanced Queuing and the message is not propagated by the Oracle Database Advanced Queuing system. Instead, a third-party propagator can dequeue the message by specifying a reserved consumer name in the dequeue operation. The reserved consumer names are of the form <code class="codeph">AQ$_P</code><span class="italic"><code class="codeph">protocol_number</code></span>. For example, the consumer name <code class="codeph">AQ$_P128</code> can be used to dequeue messages for recipients with protocol number 128. The list of recipients for a message with the specific protocol number is returned in the <code class="codeph">recipient_list</code> message property on dequeue. 
                     </p>
                     <p>Another way for Oracle Database Advanced Queuing to propagate messages to and from third-party messaging systems is through Messaging Gateway. Messaging Gateway dequeues messages from an Oracle Database Advanced Queuing queue and guarantees delivery to supported third-party messaging systems. Messaging Gateway can also dequeue messages from these systems and enqueue them to an Oracle Database Advanced Queuing queue.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-329A6279-925C-435B-A6F1-76835EF20C40__GUID-91C7E07E-DF8F-4E9D-93C0-D65B29B65700">Propagation Using HTTP</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>In Oracle Database 10<span class="italic">g</span> you can set up Oracle Database Advanced Queuing propagation over HTTP and HTTPS (HTTP over SSL). HTTP propagation uses the Internet access infrastructure and requires that the Oracle Database Advanced Queuing servlet that connects to the destination database be deployed. The database link must be created with the connect string indicating the Web server address and port and indicating HTTP as the protocol. The source database must be created for running Java and XML. Otherwise, the setup for HTTP propagation is more or less the same as Oracle Net Services propagation. 
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2494"></a><a id="ADQUE2495"></a><a id="ADQUE2493"></a><div class="props_rev_3"><a id="GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9" name="GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9"></a><h3 id="ADQUE-GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9" class="sect3"><span class="enumeration_section">1.9 </span>Message Format Transformation
               </h3>
               <div>
                  <p>Applications often use data in different formats. A transformation defines a mapping from one Oracle data type to another. </p>
                  <p>The <a href="glossary.html#GUID-A668A987-B1D3-4330-97FD-0589DB780225"><span class="xrefglossterm">transformation</span></a> is represented by a SQL function that takes the source data type as input and returns an object of the target data type. Only one-to-one message transformations are supported. 
                  </p>
                  <p>To transform a message during enqueue, specify a mapping in the enqueue options. To transform a message during dequeue, specify a mapping either in the dequeue options or when you add a subscriber. A dequeue mapping overrides a subscriber mapping. To transform a message during propagation, specify a mapping when you add a subscriber.</p>
                  <p>You can create transformations by creating a single PL/SQL function or by creating an expression for each target type attribute. The PL/SQL function returns an object of the target type or the constructor of the target type. This representation is preferable for simple transformations or those not easily broken down into independent transformations for each attribute. </p>
                  <p>Creating a separate expression specified for each attribute of the target type simplifies transformation mapping creation and management for individual attributes of the destination type. It is useful when the destination type has many attributes.</p>
                  <p>As <a href="aq-introduction.html#GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9__i1008572">Figure 1-10</a> shows, queuing, routing, and transformation are essential building blocks to an integrated application architecture. The figure shows how data from the Out queue of a CRM application is routed and transformed in the integration hub and then propagated to the In queue of the Web application. The transformation engine maps the message from the format of the Out queue to the format of the In queue.
                  </p>
                  <div class="figure" id="GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9__i1008572">
                     <p class="titleinfigure">Figure 1-10 Transformations in Application Integration</p><img src="img/adque448.gif" width="600" alt="Description of Figure 1-10 follows" title="Description of Figure 1-10 follows" longdesc="img_text/adque448.html"><br><a href="img_text/adque448.html">Description of "Figure 1-10 Transformations in Application Integration"</a></div>
                  <!-- class="figure" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-8BBB3111-EFC4-44CE-8A73-76EC5D479EF9__GUID-E88328B3-1CB9-482C-AE3D-270FB79FCF1A">XML Data Transformation</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You can transform XML data using the<code class="codeph"> extract()</code> method supported on <code class="codeph">XMLType</code> to return an object of <code class="codeph">XMLType</code> after applying the supplied <code class="codeph">XPath</code> expression. You can also create a PL/SQL function that transforms the <code class="codeph">XMLType</code> object by applying an XSLT transformation to it, using the package <code class="codeph">XSLPROCESSOR</code>.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2497"></a><a id="ADQUE2498"></a><a id="ADQUE2499"></a><a id="ADQUE2500"></a><a id="ADQUE2501"></a><a id="ADQUE2502"></a><a id="ADQUE2503"></a><a id="ADQUE2504"></a><a id="ADQUE2505"></a><a id="ADQUE2496"></a><div class="props_rev_3"><a id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F" name="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F"></a><h3 id="ADQUE-GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F" class="sect3"><span class="enumeration_section">1.10 </span>Other Oracle Database Advanced Queuing Features
               </h3>
               <div>
                  <p>This topic describes the AQ features Queue Monitor Coordinator, Integration with Oracle Internet Directory, Integration with Oracle Enterprise Manager, Retention and Message History, Cleaning Up Message Queues, Tracking and Event Journals, Non-repudiation, and Internet Integration.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDHCDAH">Queue Monitor Coordinator</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDCAFEJ">Integration with Oracle Internet Directory</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDIHIHF">Integration with Oracle Enterprise Manager</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDJHHHI">Retention and Message History</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDHCGIB">Cleaning Up Message Queues</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDIGIDI">Tracking and Event Journals</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDBGIGB">Non-repudiation</a></p>
                     </li>
                     <li>
                        <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDDEDHD">Internet Integration</a></p>
                     </li>
                  </ul>
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDHCDAH">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-609E4ED4-CF2A-43EC-967B-0EC30522A330">Queue Monitor Coordinator</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Before 10<span class="italic">g</span> Release 1 (10.1), the Oracle Database Advanced Queuing time manager process was called queue monitor (<code class="codeph">QMNn</code>), a background process controlled by setting the dynamic <code class="codeph">init.ora</code> parameter <code class="codeph">AQ_TM_PROCESSES</code>. Beginning with 10<span class="italic">g</span> Release 1 (10.1), time management and many other background processes are automatically controlled by a coordinator-slave architecture called Queue Monitor Coordinator (<code class="codeph">QMNC</code>). <code class="codeph">QMNC</code> dynamically spawns slaves named <code class="codeph">qXXX depending</code> on the system load. The slaves provide mechanisms for:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Message delay</p>
                        </li>
                        <li>
                           <p>Message expiration</p>
                        </li>
                        <li>
                           <p>Retry delay</p>
                        </li>
                        <li>
                           <p>Garbage collection for the queue table </p>
                        </li>
                        <li>
                           <p>Memory management tasks for buffered messages</p>
                        </li>
                     </ul>
                     <p>Because the number of processes is determined automatically and tuned constantly, you are saved the trouble of setting it with <code class="codeph">AQ_TM_PROCESSES</code>.
                     </p>
                     <p>Although it is no longer necessary to set <code class="codeph">init.ora</code> parameter <code class="codeph">AQ_TM_PROCESSES</code>, it is still supported. If you do set it (up to a maximum of 40), then QMNC still autotunes the number of processes. But you are guaranteed at least the set number of processes for persistent queues. Processes for a <a href="glossary.html#GUID-4FE49D89-66C7-46AB-8628-23A241EB1DA4"><span class="xrefglossterm">buffered queue</span></a> however, are not affected by this parameter.
                     </p>
                     <div class="infoboxnote" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-39F372A1-0460-40B7-8EBE-7FBF2D29A55A">
                        <p class="notep1">Note:</p>
                        <p>If you want to disable the Queue Monitor Coordinator, then you must set <code class="codeph">AQ_TM_PROCESSES = 0</code> in your <code class="codeph">pfile</code> or <code class="codeph">spfile</code>. Oracle strongly recommends that you do NOT set <code class="codeph">AQ_TM_PROCESSES = 0</code>. 
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDCAFEJ">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-616E3BC6-B48B-4F92-8A4C-379B1138A88C">Integration with Oracle Internet Directory</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Internet Directory is a native LDAPv3 directory service built on Oracle Database that centralizes a wide variety of information, including e-mail addresses, telephone numbers, passwords, security certificates, and configuration data for many types of networked devices. You can look up enterprise-wide queuing informationâqueues, subscriptions, and eventsâfrom one location, the Oracle Internet Directory. Refer to the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adque&amp;id=OIDAG002" target="_blank"><span class="italic">Oracle Fusion Middleware Administrator's Guide for Oracle Internet Directory </span></a>for more information. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDIHIHF">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-3C97A709-6DD3-4E99-B45C-D4DF5C36B745">Integration with Oracle Enterprise Manager</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You can use Oracle Enterprise Manager to:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Create and manage queues, queue tables, propagation schedules, and transformations</p>
                        </li>
                        <li>
                           <p>Monitor your Oracle Database Advanced Queuing environment using its topology at the database and queue levels, and by viewing queue errors and queue and session statistics</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDJHHHI">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-DD8103BE-69AC-4110-BA33-5CDD3E26BA78">Retention and Message History</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>The systems administrator specifies the retention duration to retain messages after consumption. Oracle Database Advanced Queuing stores information about the history of each message, preserving the queue and message properties of delay, expiration, and retention for messages destined for local or remote receivers. The information contains the enqueue and dequeue times and the identification of the transaction that executed each request. This allows users to keep a history of relevant messages. The history can be used for tracking, data warehouse, data mining operations, and, also specific auditing functions.</p>
                     <p>Message retention is not supported for buffered messaging.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDHCGIB">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-42D65A2C-A72F-4696-995D-D310C2E71D71">Cleaning Up Message Queues</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>The Oracle Database Advanced Queuing retention feature can be used to automatically clean up messages after the user-specified duration after consumption.</p>
                     <p>If messages are accidentally inserted into a queue for the wrong subscriber, you can dequeue them with the subscriber name or by message identifier. This consumes the messages, which are cleaned up after their retention time expires.</p>
                     <p>To clean up messages for a particular subscriber, you can remove the subscriber and add the subscriber again. Removing the subscriber removes all the messages for that subscriber.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDIGIDI">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-6C3AB684-A797-4E60-87EC-BA23420D7024">Tracking and Event Journals</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Retained messages can be related to each other to form sequences. These sequences represent event journals, which are often constructed by applications. Oracle Database Advanced Queuing is designed to let applications create event journals automatically.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDBGIGB">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-3FCB4D52-6057-4FCE-8505-6AD90CEA959D">Non-repudiation</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle Database Advanced Queuing maintains the entire history of information about a message along with the message itself. This information serves as proof of sending and receiving of messages and can be used for non-repudiation of the sender and non-repudiation of the receiver.</p>
                     <p>The following information is kept at enqueue for non-repudiation of the enqueuer:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Oracle Database Advanced Queuing agent doing the enqueue</p>
                        </li>
                        <li>
                           <p>Database user doing the enqueue</p>
                        </li>
                        <li>
                           <p>Enqueue time</p>
                        </li>
                        <li>
                           <p>Transaction ID of the transaction doing enqueue</p>
                        </li>
                     </ul>
                     <p>The following information is kept at dequeue for non-repudiation of the dequeuer:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Oracle Database Advanced Queuing agent doing dequeue</p>
                        </li>
                        <li>
                           <p>Database user doing dequeue</p>
                        </li>
                        <li>
                           <p>Dequeue time</p>
                        </li>
                        <li>
                           <p>Transaction ID of the transaction doing dequeue</p>
                        </li>
                     </ul>
                     <p>After propagation, the <code class="codeph">ORIGINAL_MSGID</code> field in the destination queue of the propagation corresponds to the message ID of the source message. This field can be used to correlate the propagated messages. This is useful for non-repudiation of the dequeuer of propagated messages.
                     </p>
                     <p> Stronger non-repudiation can be achieved by enqueuing the digital signature of the sender at the time of enqueue with the message and by storing the digital signature of the dequeuer at the time of dequeue.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__CHDDEDHD">
                     <p class="subhead2" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-790D5F6A-69A5-4420-9911-BB870DD3E810">Internet Integration</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You can access Oracle Database Advanced Queuing over the Internet by using <a href="glossary.html#GUID-E7071131-B116-41B7-B9D8-F54E36AE982F"><span class="xrefglossterm">Simple Object Access Protocol</span></a> (SOAP). <a href="glossary.html#GUID-DDF7D235-94BE-4294-A4DC-811C06EF06F3"><span class="xrefglossterm">Internet Data Access Presentation</span></a> (IDAP) is the SOAP specification for Oracle Database Advanced Queuing operations. IDAP defines the XML message structure for the body of the SOAP request. 
                     </p>
                     <p>An IDAP message encapsulates the Oracle Database Advanced Queuing request and response in XML. IDAP is used to perform Oracle Database Advanced Queuing operations such as enqueue, dequeue, send notifications, register for notifications, and propagation over the Internet standard transportsâHTTP(s) and e-mail. In addition, IDAP encapsulates transactions, security, transformation, and the character set ID for requests.</p>
                     <p>You can create an alias to an Oracle Database Advanced Queuing agent in Oracle Internet Directory and then use the alias in IDAP documents sent over the Internet to perform Oracle Database Advanced Queuing operations. Using aliases prevents exposing the internal name of the Oracle Database Advanced Queuing agent.</p>
                     <p><a href="aq-introduction.html#GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__I1009521">Figure 1-11</a> shows the architecture for performing Oracle Database Advanced Queuing operations over HTTP. The major components are:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Oracle Database Advanced Queuing client program</p>
                        </li>
                        <li>
                           <p>Web server/servlet runner hosting the Oracle Database Advanced Queuing <a href="glossary.html#GUID-06CAA1CB-595D-492E-9543-7F003B45839A"><span class="xrefglossterm">servlet</span></a></p>
                        </li>
                        <li>
                           <p>Oracle Database server</p>
                        </li>
                     </ul>
                     <p>The Oracle Database Advanced Queuing client program sends XML messages (conforming to IDAP) to the Oracle Database Advanced Queuing servlet, which understands the XML message and performs Oracle Database Advanced Queuing operations. Any HTTP client, a Web browser for example, can be used. The Web server/servlet runner hosting the Oracle Database Advanced Queuing servlet, Apache/Jserv or Tomcat for example, interprets the incoming XML messages. The Oracle Database Advanced Queuing servlet connects to the Oracle Database server and performs operations on user queues.</p>
                     <div class="infoboxnote" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__GUID-077DB237-918F-4E19-9C2F-0A4F27CAD4EB">
                        <p class="notep1">Note:</p>
                        <p>This feature is certified to work with Apache, along with the Tomcat or Jserv servlet execution engines. However, the code does not prevent the servlet from working with other Web server and servlet execution engines that support Java Servlet 2.0 or higher interfaces.</p>
                     </div>
                     <div class="figure" id="GUID-BBC35EB4-306F-4700-9EEF-3FEAE309CD8F__I1009521">
                        <p class="titleinfigure">Figure 1-11 Architecture for Performing Oracle Database Advanced Queuing Operations Using HTTP</p><img src="img/adque430.gif" width="464" alt="Description of Figure 1-11 follows" title="Description of Figure 1-11 follows" longdesc="img_text/adque430.html"><br><a href="img_text/adque430.html">Description of "Figure 1-11 Architecture for Performing Oracle Database Advanced Queuing Operations Using HTTP"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2506"></a><div class="props_rev_3"><a id="GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327" name="GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327"></a><h3 id="ADQUE-GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327" class="sect3"><span class="enumeration_section">1.11 </span>Interfaces to Oracle Database Advanced Queuing
               </h3>
               <div>
                  <p>You can access Oracle Database Advanced Queuing functionality through the interfaces listed in this topic.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>PL/SQL using <code class="codeph">DBMS_AQ</code>, <code class="codeph">DBMS_AQADM</code>, and <code class="codeph">DBMS_AQELM</code> 
                        </p>
                     </li>
                     <li>
                        <p>Java Message Service (JMS) using the <code class="codeph">oracle.jms</code> Java package
                        </p>
                     </li>
                     <li>
                        <p>Internet access using HTTP(S)</p>
                        <div class="infoboxnote" id="GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327__GUID-C6BC4EEE-0595-4D06-B66F-CC6B2C8BA846">
                           <p class="notep1">Note:</p>
                           <p>The <code class="codeph">oracle.AQ</code> Java package was deprecated in Oracle Database Advanced Queuing 10<span class="italic">g</span> Release 1 (10.1). Oracle recommends that you migrate existing Java AQ applications to Oracle JMS and use Oracle JMS to design your future Java AQ applications.
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-AA3B4276-F202-45BD-9177-B68FF6B0F327__GUID-76F99657-0AD5-4EBE-ADB3-93C9AA4356E1">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../arpls/index.html" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>