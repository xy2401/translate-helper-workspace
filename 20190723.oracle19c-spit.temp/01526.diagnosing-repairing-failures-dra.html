<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Diagnosing and Repairing Failures with Data Recovery Advisor</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Backup and Recovery User's Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Backup and Recovery User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96241-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="rman-data-repair-concepts.html" title="Previous" type="text/html">
      <link rel="next" href="validating-database-files-backups.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User's Guide">
    <meta name="dcterms.isVersionOf" content="BRADV">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rman-data-repair-concepts.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="validating-database-files-backups.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Backup and Recovery User's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-diagnosing-responding-failures.html" property="item" typeof="WebPage"><span property="name"> Diagnosing and Responding to Failures </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Diagnosing and Repairing Failures with Data Recovery Advisor</li>
            </ol>
            <a id="GUID-8C219B50-1F7F-4F7A-95EE-5F029AE7EB2A" name="GUID-8C219B50-1F7F-4F7A-95EE-5F029AE7EB2A"></a><a id="BRADV246"></a>
            
            <h2 id="BRADV-GUID-8C219B50-1F7F-4F7A-95EE-5F029AE7EB2A" class="sect2"><span class="enumeration_chapter">15 </span>Diagnosing and Repairing Failures with Data Recovery Advisor
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter explains how to use the Data Recovery Advisor tool in RMAN to diagnose and repair database failures. This chapter contains the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="diagnosing-repairing-failures-dra.html#GUID-636EA9BE-2DFB-4FA0-959E-B1290C774ABD" title="The Data Recovery Advisor is a tool that helps reduce database recovery time by determining the best automated repair option for database failures.">Overview of Data Recovery Advisor</a></p>
                  </li>
                  <li>
                     <p><a href="diagnosing-repairing-failures-dra.html#GUID-05C2861A-4EC0-4F0C-8860-42AC2BC4CC17" title="If you suspect or know that one or more database failures have occurred, then use LIST FAILURE to obtain information about them.">Listing Failures</a></p>
                  </li>
                  <li>
                     <p><a href="diagnosing-repairing-failures-dra.html#GUID-D9D58DB7-05ED-4A21-9D1A-94D57D600271" title="The database invokes data integrity checks reactively when a user transaction is trying to access corrupted data. In some cases, latent failures can go undetected.">Checking for Block Corruptions by Validating the Database</a></p>
                  </li>
                  <li>
                     <p><a href="diagnosing-repairing-failures-dra.html#GUID-13944F9E-545E-480A-A47B-CE0A73FED3C7" title="Use the ADVISE FAILURE command to display repair options after running LIST FAILURE in an RMAN session. This command prints a summary of the failures and implicitly closes all open failures that are repaired.">Determining Repair Options</a></p>
                  </li>
                  <li>
                     <p><a href="diagnosing-repairing-failures-dra.html#GUID-31DF1037-325F-4FED-8A37-23216EFF9526" title="You can use Data Recovery Advisor to repair failures automatically.">Repairing Failures</a></p>
                  </li>
                  <li>
                     <p><a href="diagnosing-repairing-failures-dra.html#GUID-9F467E37-DC05-494A-890E-439330493056" title="In some situations, you may want to use the CHANGE FAILURE command to alter the status or priority of a failure.">Changing Failure Status and Priority</a></p>
                  </li>
               </ul>
            </div><a id="BRADV89714"></a><div class="props_rev_3"><a id="GUID-636EA9BE-2DFB-4FA0-959E-B1290C774ABD" name="GUID-636EA9BE-2DFB-4FA0-959E-B1290C774ABD"></a><h3 id="BRADV-GUID-636EA9BE-2DFB-4FA0-959E-B1290C774ABD" class="sect3"><span class="enumeration_section">15.1 </span>Overview of Data Recovery Advisor
               </h3>
               <p>The Data Recovery Advisor is a tool that helps reduce database recovery time by determining the best automated repair option for database failures.</p><a id="BRADV89715"></a><div class="props_rev_3"><a id="GUID-FC7012E1-0834-4220-873A-B7409B9AB7A7" name="GUID-FC7012E1-0834-4220-873A-B7409B9AB7A7"></a><h4 id="BRADV-GUID-FC7012E1-0834-4220-873A-B7409B9AB7A7" class="sect4"><span class="enumeration_section">15.1.1 </span>Purpose of Data Recovery Advisor
                  </h4>
                  <div>
                     <p>Data Recovery Advisor is an Oracle Database tool that automatically diagnoses data failures, determines and presents appropriate repair options, and executes repairs at the user's request.</p>
                     <p>In this context, a data failure is a corruption or loss of persistent data on disk. By providing a centralized tool for automated data repair, Data Recovery Advisor improves the manageability and reliability of an Oracle database and thus helps reduce the <a href="glossary.html#GUID-A3EA33D7-BB93-4179-9BFF-5C0CFBFD26D1"><span class="xrefglossterm">MTTR</span></a>.
                     </p>
                     <p>Diagnosing a data failure and devising an optimal strategy for repair requires a high degree of training and experience. Data Recovery Advisor provides the following advantages over traditional repair techniques:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Data Recovery Advisor can potentially detect, analyze, and repair data failures <span class="italic">before</span> a database process discovers the corruption and signals an error. Early warnings help limit damage caused by corruption. 
                           </p>
                        </li>
                        <li>
                           <p>Manually assessing symptoms of data failures and correlating them into a problem statement can be complex, error-prone, and time-consuming. Data Recovery Advisor automatically diagnoses failures, assesses their impact, and reports these findings to the user.</p>
                        </li>
                        <li>
                           <p>Traditionally, users must manually determine repair options along with the repair impact. If multiple failures are present, then users must determine the right sequence of repair execution and try to consolidate repairs. In contrast, Data Recovery Advisor automatically determines the best repair options and runs checks to ensure that these options are feasible in your environment.</p>
                        </li>
                        <li>
                           <p>Execution of a data repair can be complex and error-prone. If you choose an automated repair option, then Data Recovery Advisor executes the repair and verifies its success.</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV89716"></a><div class="props_rev_3"><a id="GUID-665CCC0F-102C-442E-A6AD-89619784294D" name="GUID-665CCC0F-102C-442E-A6AD-89619784294D"></a><h4 id="BRADV-GUID-665CCC0F-102C-442E-A6AD-89619784294D" class="sect4"><span class="enumeration_section">15.1.2 </span>Basic Concepts of Data Recovery Advisor
                  </h4>
                  <div>
                     <p>You must familiarize yourself with a few concepts before using the Data Recovery Advisor.</p>
                     <div class="infoboxnotealso" id="GUID-665CCC0F-102C-442E-A6AD-89619784294D__GUID-0A2F0204-CC37-4B50-BA6A-F07F41122143">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="diagnosing-repairing-failures-dra.html#GUID-8F059E94-7CCB-4087-AEB5-1EF85DB857E4" title="Data Recovery Advisor has both a command-line and GUI interface. The GUI interface is available in Oracle Enterprise Manager Cloud Control.">User Interfaces to Data Recovery Advisor</a></p>
                           </li>
                           <li>
                              <p><a href="diagnosing-repairing-failures-dra.html#GUID-58AB169E-7015-4551-BEF1-6E2F39B0E844" title="A checker is a diagnostic operation or procedure registered with the Health Monitor to assess the health of the database or its components.">About Data Integrity Checks</a></p>
                           </li>
                           <li>
                              <p><a href="diagnosing-repairing-failures-dra.html#GUID-8990058E-4CF3-4165-92DF-F75706D8F310" title="A failure is a persistent data corruption that is detected by a data integrity check.">About Failures</a></p>
                           </li>
                           <li>
                              <p><a href="diagnosing-repairing-failures-dra.html#GUID-04826048-906A-46DD-A9B1-128DEDFA492C" title="The ADVISE FAILURE command can present both manual and automatic repair options. Data Recovery Advisor categorizes manual actions as either mandatory or optional.">About Manual Actions and Automatic Repair Options</a></p>
                           </li>
                           <li>
                              <p><a href="diagnosing-repairing-failures-dra.html#GUID-1B27227C-84B1-41E1-98EC-53A89A337FF5" title="Data Recovery Advisor is supported only on some database configurations.">About Supported Database Configurations for Data Recovery Advisor</a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV89717"></a><div class="props_rev_3"><a id="GUID-8F059E94-7CCB-4087-AEB5-1EF85DB857E4" name="GUID-8F059E94-7CCB-4087-AEB5-1EF85DB857E4"></a><h5 id="BRADV-GUID-8F059E94-7CCB-4087-AEB5-1EF85DB857E4" class="sect5"><span class="enumeration_section">15.1.2.1 </span>User Interfaces to Data Recovery Advisor
                     </h5>
                     <div>
                        <p>Data Recovery Advisor has both a command-line and GUI interface. The GUI interface is available in Oracle Enterprise Manager Cloud Control.</p>
                        <p>In the RMAN command-line interface, the Data Recovery Advisor commands are <code class="codeph">LIST FAILURE</code>, <code class="codeph">ADVISE FAILURE</code>, <code class="codeph">REPAIR FAILURE</code>, and <code class="codeph">CHANGE FAILURE</code>.
                        </p>
                        <p>A <a href="glossary.html#GUID-046A9407-B78B-4BBA-BE2F-55D74EF4F2D8"><span class="xrefglossterm">failure</span></a> is detected either automatically by the database or through a manual check such as the <code class="codeph">VALIDATE</code> command. You can use the <code class="codeph">LIST FAILURE</code> command to view problem statements for failures and the effect of these failures on database operations. Each failure is uniquely identified by a failure number. In the same RMAN session, you can then use the <code class="codeph">ADVISE FAILURE</code> command to view repair options, which typically include both automated and manual options.
                        </p>
                        <p>After executing <code class="codeph">ADVISE FAILURE</code>, you can either repair failures manually or run the <code class="codeph">REPAIR FAILURE</code> command to repair the failures automatically. A <a href="glossary.html#GUID-021686F4-9813-468B-A83E-9E7773FD4D4C"><span class="xrefglossterm">repair</span></a> is an action that fixes one or more failures. Examples of repairs include <a href="glossary.html#GUID-923A509A-1C36-4EA4-91C8-6E4F372722C0"><span class="xrefglossterm">block media recovery</span></a>, <a href="glossary.html#GUID-01B3A956-DA97-4B47-9600-FA5549B7E868"><span class="xrefglossterm">data file media recovery</span></a>, and <a href="glossary.html#GUID-DD883C9B-0441-48D3-9DDC-755597782971"><span class="xrefglossterm">Oracle Flashback Database</span></a>. When you choose an automated <a href="glossary.html#GUID-76EA30CA-A51E-44C9-AB25-E1D89AF711B2"><span class="xrefglossterm">repair option</span></a>, Data Recovery Advisor verifies the repair success and closes the relevant repaired failures.
                        </p>
                     </div>
                  </div><a id="BRADV89718"></a><div class="props_rev_3"><a id="GUID-58AB169E-7015-4551-BEF1-6E2F39B0E844" name="GUID-58AB169E-7015-4551-BEF1-6E2F39B0E844"></a><h5 id="BRADV-GUID-58AB169E-7015-4551-BEF1-6E2F39B0E844" class="sect5"><span class="enumeration_section">15.1.2.2 </span>About Data Integrity Checks
                     </h5>
                     <div>
                        <p>A checker is a diagnostic operation or procedure registered with the Health Monitor to assess the health of the database or its components. </p>
                        <div class="section">
                           <p>The health assessment is known as a <a href="glossary.html#GUID-AECF0DB7-EEF4-4676-9978-42F0B5F9F9DE"><span class="xrefglossterm">data integrity check</span></a> and can be invoked reactively or proactively.
                           </p>
                           <p>Failures are normally detected reactively. A database operation involving corrupted data results in an error, which automatically invokes a data integrity check that searches the database for failures related to the error. If failures are diagnosed, then they are recorded in the <a href="glossary.html#GUID-BDCE90D1-13B7-4D2C-A761-1583A238A247"><span class="xrefglossterm">Automatic Diagnostic Repository (ADR)</span></a>, which is a directory structure stored outside of the database. You can use Data Recovery Advisor to generate repair advice and repair failures only after failures have been detected by the database and stored in ADR.
                           </p>
                           <p>You can also invoke a data integrity check proactively. You can execute the check through the Health Monitor, which detects and stores failures in the same way as when the checks are invoked reactively. You can also check for block corruption with the <code class="codeph">VALIDATE</code> and <code class="codeph">BACKUP VALIDATE</code> commands, as explained in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-D9D58DB7-05ED-4A21-9D1A-94D57D600271" title="The database invokes data integrity checks reactively when a user transaction is trying to access corrupted data. In some cases, latent failures can go undetected.">Checking for Block Corruptions by Validating the Database</a>"</span>.
                           </p>
                           <div class="infoboxnotealso" id="GUID-58AB169E-7015-4551-BEF1-6E2F39B0E844__GUID-24E0C6C3-F867-4DD8-BF23-042DB54CC6B1">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=ADMIN11269" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> to learn how to use the <a id="d71715e686" class="indexterm-anchor"></a>Health Monitor
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89719"></a><div class="props_rev_3"><a id="GUID-8990058E-4CF3-4165-92DF-F75706D8F310" name="GUID-8990058E-4CF3-4165-92DF-F75706D8F310"></a><h5 id="BRADV-GUID-8990058E-4CF3-4165-92DF-F75706D8F310" class="sect5"><span class="enumeration_section">15.1.2.3 </span>About Failures
                     </h5>
                     <div>
                        <p>A failure is a persistent data corruption that is detected by a data integrity check.</p>
                        <p>A failure can manifest itself as observable symptoms such as error messages and alerts, but a failure is different from a symptom because it represents a diagnosed <a href="glossary.html#GUID-3D711236-2A12-4726-AF42-A04D030732B0"><span class="xrefglossterm">problem</span></a>. After a problem is diagnosed by the database as a failure, you can obtain information about the failure and potentially repair it with Data Recovery Advisor.
                        </p>
                        <p>Because failure information is not stored in the database itself, the database does not need to be open or mounted for you to access it. You can view failures when the database is started in <code class="codeph">NOMOUNT</code> mode. Thus, the availability of the control file and <a href="glossary.html#GUID-CBFA8015-2DFF-42B1-A818-D6C5B92C608F"><span class="xrefglossterm">recovery catalog</span></a> does not affect the ability to view detected failures, although it may affect the feasibility of some repairs.
                        </p>
                        <p>Data Recovery Advisor can diagnose failures such as the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Components such as data files and control files that are not accessible because they do not exist, do not have the correct access permissions, have been taken offline, and so on</p>
                           </li>
                           <li>
                              <p>Physical corruptions such as block checksum failures and invalid block header field values</p>
                           </li>
                           <li>
                              <p>Inconsistencies such as a data file that is older than other database files</p>
                           </li>
                           <li>
                              <p>I/O failures such as hardware errors, operating system driver failures, and exceeding operating system resource limits (for example, the number of open files)</p>
                           </li>
                        </ul>
                        <p>The Data Recovery Advisor may detect or handle some logical corruptions. In general, corruptions of this type require help from Oracle Support Services.</p>
                        <div class="infoboxnotealso" id="GUID-8990058E-4CF3-4165-92DF-F75706D8F310__GUID-537072FB-8032-446E-A44C-12630E41306E">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="diagnosing-repairing-failures-dra.html#GUID-C9E7EC3F-5250-45C2-9A4E-3DDE01CA5F20" title="Every failure has a failure status: OPEN or CLOSED.">About the Failure Status</a></p>
                              </li>
                              <li>
                                 <p><a href="diagnosing-repairing-failures-dra.html#GUID-D5E24BF1-3CDF-41EE-8B17-F3067DDEDBD2" title="Every failure has a failure priority: CRITICAL, HIGH, or LOW. Data Recovery Advisor only assigns CRITICAL or HIGH priority to diagnosed failures.">About Failure Priority</a></p>
                              </li>
                              <li>
                                 <p><a href="diagnosing-repairing-failures-dra.html#GUID-B28DCBBE-ACFA-4199-A5F0-71767CC30B2F" title="For clarity, Data Recovery Advisor groups related failures together.">About Failure Grouping</a></p>
                              </li>
                           </ul>
                        </div>
                     </div><a id="BRADV89720"></a><div class="props_rev_3"><a id="GUID-C9E7EC3F-5250-45C2-9A4E-3DDE01CA5F20" name="GUID-C9E7EC3F-5250-45C2-9A4E-3DDE01CA5F20"></a><h6 id="BRADV-GUID-C9E7EC3F-5250-45C2-9A4E-3DDE01CA5F20" class="sect6"><span class="enumeration_section">15.1.2.3.1 </span>About the Failure Status
                        </h6>
                        <div>
                           <p>Every failure has a failure status: <code class="codeph">OPEN</code> or <code class="codeph">CLOSED</code>. 
                           </p>
                           <p>The status of a failure is <code class="codeph">OPEN</code> until the appropriate repair action is invoked. The status changes to <code class="codeph">CLOSED</code> after the failure is repaired.
                           </p>
                           <p>Every time you execute <code class="codeph">LIST FAILURE</code> , Data Recovery Advisor revalidates all open failures and closes failures that no longer exist. Thus, if you fixed some failures as part of a separate procedure, or if the failures were transient problems that disappeared by themselves, running <code class="codeph">LIST FAILURE</code> automatically closes them. 
                           </p>
                           <p>You can use <code class="codeph">CHANGE FAILURE</code> to change the status of an open failure to <code class="codeph">CLOSED</code> if you have fixed it manually. However, it makes sense to use <code class="codeph">CHANGE FAILURE ... CLOSED</code> only if for some reason the failure was not closed automatically. If a failure still exists when you use <code class="codeph">CHANGE</code> to close it manually, then Data Recover Advisor re-creates it with a different failure ID when the appropriate data integrity check is executed.
                           </p>
                        </div>
                     </div><a id="BRADV89721"></a><div class="props_rev_3"><a id="GUID-D5E24BF1-3CDF-41EE-8B17-F3067DDEDBD2" name="GUID-D5E24BF1-3CDF-41EE-8B17-F3067DDEDBD2"></a><h6 id="BRADV-GUID-D5E24BF1-3CDF-41EE-8B17-F3067DDEDBD2" class="sect6"><span class="enumeration_section">15.1.2.3.2 </span>About Failure Priority
                        </h6>
                        <div>
                           <p>Every failure has a failure priority: <code class="codeph">CRITICAL</code>, <code class="codeph">HIGH</code>, or <code class="codeph">LOW</code>. Data Recovery Advisor only assigns <code class="codeph">CRITICAL</code> or <code class="codeph">HIGH</code> priority to diagnosed failures.
                           </p>
                           <p>Failures with <code class="codeph">CRITICAL</code> priority require immediate attention because they make the whole database unavailable. For example, a disk containing a current control file may fail. Failures with <code class="codeph">HIGH</code> priority make a database partly unavailable or unrecoverable and usually have to be repaired quickly. Examples include block corruptions and missing archived redo logs.
                           </p>
                           <p>If a failure was assigned a <code class="codeph">HIGH</code> priority, but the failure has little impact on database availability and recoverability, then you can downgrade the priority to <code class="codeph">LOW</code>. A <code class="codeph">LOW</code> priority indicates that a failure can be ignored until more important failures are fixed. 
                           </p>
                           <p>By default <code class="codeph">LIST FAILURE</code> displays only failures with <code class="codeph">CRITICAL</code> and <code class="codeph">HIGH</code> priority. You can use the <code class="codeph">CHANGE</code> command to change the status for <code class="codeph">LOW</code> and <code class="codeph">HIGH</code> failures, but you cannot change the status of <code class="codeph">CRITICAL</code> failures. The main reason for changing a priority to <code class="codeph">LOW</code> is to reduce the <code class="codeph">LIST FAILURE</code> output. If a failure cannot be revalidated at this time (for example, because of another failure), then <code class="codeph">LIST FAILURE</code> shows the failure as open.
                           </p>
                        </div>
                     </div><a id="BRADV99975"></a><div class="props_rev_3"><a id="GUID-B28DCBBE-ACFA-4199-A5F0-71767CC30B2F" name="GUID-B28DCBBE-ACFA-4199-A5F0-71767CC30B2F"></a><h6 id="BRADV-GUID-B28DCBBE-ACFA-4199-A5F0-71767CC30B2F" class="sect6"><span class="enumeration_section">15.1.2.3.3 </span>About Failure Grouping
                        </h6>
                        <div>
                           <p>For clarity, Data Recovery Advisor groups related failures together. </p>
                           <p>For example, if 20 different blocks in a file are corrupted, then these failures are grouped under a single parent failure. By default, Data Recovery Advisor lists information about the group of failures, although you can specify the <code class="codeph">DETAIL</code> option to list information about the individual subfailures.
                           </p>
                           <p>A subfailure has the same format as a failure. You can get advice on a subfailure and repair it separately or in combination with any other failure.</p>
                        </div>
                     </div>
                  </div><a id="BRADV89722"></a><div class="props_rev_3"><a id="GUID-04826048-906A-46DD-A9B1-128DEDFA492C" name="GUID-04826048-906A-46DD-A9B1-128DEDFA492C"></a><h5 id="BRADV-GUID-04826048-906A-46DD-A9B1-128DEDFA492C" class="sect5"><span class="enumeration_section">15.1.2.4 </span>About Manual Actions and Automatic Repair Options
                     </h5>
                     <div>
                        <p>The <code class="codeph">ADVISE FAILURE</code> command can present both manual and automatic repair options. Data Recovery Advisor categorizes manual actions as either mandatory or optional.
                        </p>
                        <p>In some cases, the only possible actions are manual. Suppose that no backups exist for a lost control file. In this case, the manual action is to execute the <code class="codeph">CREATE CONTROLFILE</code> statement. Data Recovery Advisor presents this manual action as mandatory because no automatic repair is available. In contrast, suppose that RMAN backups exist for a missing data file. In this case, the <code class="codeph">REPAIR FAILURE</code> command can perform the repair automatically by restoring and recovering the data file. An optional manual action is to restore the data file if it was unintentionally renamed or moved. Data Recovery Advisor suggests optional manual actions if they might prevent a more extreme form of repair such as data file restore and recovery.
                        </p>
                        <p>In contrast to manual actions, automated repairs can be performed by Data Recovery Advisor. The <code class="codeph">ADVISE FAILURE</code> command presents an option ID for each automated repair option and summarizes the action. 
                        </p>
                        <p>Data Recovery Advisor performs feasibility checks before recommending an automated repair. For example, Data Recovery Advisor checks that all backups and archived redo logs needed for media recovery are present and consistent. Data Recovery Advisor may need specific backups and archived redo logs. If the files needed for recovery are not available, then recovery is not possible. </p>
                        <div class="infoboxnote" id="GUID-04826048-906A-46DD-A9B1-128DEDFA492C__GUID-05CEAAA3-A26E-4971-8E13-36726D263988">
                           <p class="notep1">Note:</p>
                           <p>For performance reasons, Data Recovery Advisor does not exhaustively check every byte in every file. Thus, a feasible repair may still fail because of a corrupted backup or archived redo log file.</p>
                        </div>
                     </div><a id="BRADV99976"></a><div class="props_rev_3"><a id="GUID-025E4E97-B061-4CF9-AB12-665C9AB1D92B" name="GUID-025E4E97-B061-4CF9-AB12-665C9AB1D92B"></a><h6 id="BRADV-GUID-025E4E97-B061-4CF9-AB12-665C9AB1D92B" class="sect6"><span class="enumeration_section">15.1.2.4.1 </span>About Consolidated Repairs
                        </h6>
                        <div>
                           <p>When possible, Data Recovery Advisor consolidates repairs to fix multiple failures into a single repair. A consolidated repair may contain multiple steps.</p>
                           <p>Sometimes a consolidated repair is not possible, as when one failure prevents the creation of repairs for other failures. For example, the feasibility of a data file repair cannot be determined when the control file is missing. In such cases, Data Recovery Advisor generates a repair option for failures that can be repaired and prints a message stating that some selected failures cannot be repaired at this time. After executing the proposed repair, you can repeat the <code class="codeph">LIST</code>, <code class="codeph">ADVISE</code>, and <code class="codeph">REPAIR</code> sequence to repair remaining failures.
                           </p>
                        </div>
                     </div><a id="BRADV328"></a><a id="BRADV89723"></a><div class="props_rev_3"><a id="GUID-E16E2906-B3D4-439C-8F77-8CB52D02A9BE" name="GUID-E16E2906-B3D4-439C-8F77-8CB52D02A9BE"></a><h6 id="BRADV-GUID-E16E2906-B3D4-439C-8F77-8CB52D02A9BE" class="sect6"><span class="enumeration_section">15.1.2.4.2 </span>About Repair Scripts
                        </h6>
                        <div>
                           <p>Whenever Data Recovery Advisor generates an automated repair option, it creates a script that explains which commands RMAN intends to use to repair the failure. Data Recovery Advisor prints the location of this script, which is a text file residing on the operating system. </p>
                           <p><a href="diagnosing-repairing-failures-dra.html#GUID-E16E2906-B3D4-439C-8F77-8CB52D02A9BE__CHDHJBFE">Example 15-1</a> shows a sample repair script, which shows how Data Recovery Advisor plans to repair the loss of data file <code class="codeph">27</code>.
                           </p>
                           <div class="example" id="GUID-E16E2906-B3D4-439C-8F77-8CB52D02A9BE__CHDHJBFE">
                              <p class="titleinexample">Example 15-1 Sample Repair Script</p><pre class="pre codeblock"><code># restore and recover data file
ALTER DATABASE DATAFILE 27 OFFLINE;
restore datafile 27;
recover datafile 27;
ALTER DATABASE DATAFILE 27 ONLINE;
</code></pre><p>If you do not want Data Recovery Advisor to automatically repair the failure, then you can copy the script, edit it, and execute it manually.</p>
                           </div>
                           <!-- class="example" -->
                        </div>
                     </div>
                  </div><a id="BRADV89724"></a><div class="props_rev_3"><a id="GUID-1B27227C-84B1-41E1-98EC-53A89A337FF5" name="GUID-1B27227C-84B1-41E1-98EC-53A89A337FF5"></a><h5 id="BRADV-GUID-1B27227C-84B1-41E1-98EC-53A89A337FF5" class="sect5"><span class="enumeration_section">15.1.2.5 </span>About Supported Database Configurations for Data Recovery Advisor
                     </h5>
                     <p>Data Recovery Advisor is supported only on some database configurations.</p><a id="BRADV795"></a><div class="props_rev_3"><a id="GUID-FF08A639-24B2-46C6-BA39-2C0875D6F99E" name="GUID-FF08A639-24B2-46C6-BA39-2C0875D6F99E"></a><h6 id="BRADV-GUID-FF08A639-24B2-46C6-BA39-2C0875D6F99E" class="sect6"><span class="enumeration_section">15.1.2.5.1 </span>About Data Recovery Advisor and Oracle Real Application Clusters
                        </h6>
                        <div>
                           <p>Data Recovery Advisor only supports single-instance databases. Oracle Real Application Clusters (Oracle RAC) databases are not supported.</p>
                           <p>If a data failure occurs that brings down all Oracle RAC instances, then you can mount the database in single-instance mode and use Data Recovery Advisor to detect and repair control file, <code class="codeph">SYSTEM</code> data file, and data dictionary failures. You can also invoke data recovery checks proactively to test other database components for data failures. This approach does not detect data failures that are local to other cluster instances, for example, an inaccessible data file.
                           </p>
                        </div>
                     </div><a id="BRADV796"></a><div class="props_rev_3"><a id="GUID-A5587038-2082-4502-ADD3-647CBCF39684" name="GUID-A5587038-2082-4502-ADD3-647CBCF39684"></a><h6 id="BRADV-GUID-A5587038-2082-4502-ADD3-647CBCF39684" class="sect6"><span class="enumeration_section">15.1.2.5.2 </span>About Data Recovery Advisor and Oracle Data Guard
                        </h6>
                        <div>
                           <p>There are some limitations with Data Recovery Advisor in an Oracle Data Guard environment.</p>
                           <p>In a Data Guard environment, Data Recovery Advisor cannot do the following:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Use files transferred from a <a href="glossary.html#GUID-009B3F56-8C1E-4CF6-AF0F-A9D2C2E4B9C2"><span class="xrefglossterm">physical standby database</span></a> to repair failures on a primary database
                                 </p>
                              </li>
                              <li>
                                 <p>Diagnose and repair failures on a standby database</p>
                              </li>
                           </ul>
                           <p>However, if the primary database is unavailable, then Data Recovery Advisor may recommend a failover to a standby database. After the failover you can repair the old primary database. If you are using Enterprise Manager Cloud Control in a Data Guard configuration, then you can initiate a failover through the Data Recovery Advisor recommendations page.</p>
                           <div class="infoboxnotealso" id="GUID-A5587038-2082-4502-ADD3-647CBCF39684__GUID-7DF1DF1A-8DD0-461A-A01D-ECB616246828">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SBYDB04700" target="_blank"><span><cite>Oracle Data Guard Concepts and Administration</cite></span></a> to learn how to use RMAN in a Data Guard configuration
                              </p>
                           </div>
                        </div>
                     </div><a id="BRADV797"></a><div class="props_rev_3"><a id="GUID-E6AE8C65-B5DC-4BA4-A2EA-BDB168C0169A" name="GUID-E6AE8C65-B5DC-4BA4-A2EA-BDB168C0169A"></a><h6 id="BRADV-GUID-E6AE8C65-B5DC-4BA4-A2EA-BDB168C0169A" class="sect6"><span class="enumeration_section">15.1.2.5.3 </span>About Data Recovery Advisor and CDBs
                        </h6>
                        <p>Data Recovery Advisor can only be used to diagnose and repair data corruptions in non-CDBs and the root of a multitenant container database (CDB). Data Recovery Advisor is not supported for pluggable databases (PDBs).</p>
                     </div>
                  </div>
               </div><a id="BRADV89725"></a><div class="props_rev_3"><a id="GUID-C83E6265-9D82-4636-B041-B10D9C66C1F7" name="GUID-C83E6265-9D82-4636-B041-B10D9C66C1F7"></a><h4 id="BRADV-GUID-C83E6265-9D82-4636-B041-B10D9C66C1F7" class="sect4"><span class="enumeration_section">15.1.3 </span>Basic Steps of Diagnosing and Repairing Failures
                  </h4>
                  <div>
                     <p>The Data Recovery Advisor workflow begins when you either suspect or discover a failure. You can discover failures in many ways, including error messages, alerts, trace files, and failed data integrity checks.</p>
                     <div class="section">
                        <p>As explained in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-58AB169E-7015-4551-BEF1-6E2F39B0E844" title="A checker is a diagnostic operation or procedure registered with the Health Monitor to assess the health of the database or its components.">About Data Integrity Checks</a>"</span>, the database can automatically diagnose failures when errors occur.
                        </p>
                        <p>To respond to failures, start an RMAN session and perform all of the following steps in the same session and in the order they are listed:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>List failures by running the <code class="codeph">LIST FAILURE</code> command.</span><div>
                              <p>This task is explained in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-05C2861A-4EC0-4F0C-8860-42AC2BC4CC17" title="If you suspect or know that one or more database failures have occurred, then use LIST FAILURE to obtain information about them.">Listing Failures</a>"</span>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>If you suspect that failures exist that have not been automatically diagnosed by the database, then run <code class="codeph">VALIDATE DATABASE</code> to check for corrupt blocks and missing files.</span><div>
                              <p>If <code class="codeph">VALIDATE</code> detects a problem, then RMAN triggers execution of a failure assessment. If a failure is detected, then RMAN logs it into the Automated Diagnostic Repository, where is can be accessed by Data Recovery Advisor.
                              </p>
                              <p>This task is explained in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-D9D58DB7-05ED-4A21-9D1A-94D57D600271" title="The database invokes data integrity checks reactively when a user transaction is trying to access corrupted data. In some cases, latent failures can go undetected.">Checking for Block Corruptions by Validating the Database</a>"</span>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Determine repair options by running the <code class="codeph">ADVISE FAILURE</code> command.</span><div>
                              <p>This task is explained in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-13944F9E-545E-480A-A47B-CE0A73FED3C7" title="Use the ADVISE FAILURE command to display repair options after running LIST FAILURE in an RMAN session. This command prints a summary of the failures and implicitly closes all open failures that are repaired.">Determining Repair Options</a>"</span>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Choose a repair option. You can repair the failures manually or run the <code class="codeph">REPAIR FAILURE</code> command to fix them automatically.</span><div>
                              <p>This task is explained in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-31DF1037-325F-4FED-8A37-23216EFF9526" title="You can use Data Recovery Advisor to repair failures automatically.">Repairing Failures</a>"</span>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Return to the first step to confirm that all failures were repaired or determine which failures remain.</span></li>
                     </ol>
                     <div class="section">
                        <p>Performing the steps for diagnosing and repairing failures in an order that is different from the one listed in this section may result in errors.</p>
                        <p>If appropriate, you can use <code class="codeph">CHANGE FAILURE</code> command at any time in the Data Recovery Advisor workflow to change the priority of a failure from <code class="codeph">LOW</code> to <code class="codeph">HIGH</code> or <code class="codeph">HIGH</code> to <code class="codeph">LOW</code>, or close a failure that has been fixed manually. This task is explained in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-9F467E37-DC05-494A-890E-439330493056" title="In some situations, you may want to use the CHANGE FAILURE command to alter the status or priority of a failure.">Changing Failure Status and Priority</a>"</span>.
                        </p>
                        <div class="infoboxnotealso" id="GUID-C83E6265-9D82-4636-B041-B10D9C66C1F7__GUID-6169906B-75DC-453D-A83C-D666A5E3E16D">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF90269" target="_blank"><span><cite>Oracle Data Guard Concepts and Administration</cite></span></a> for a complete example on recovering a database using the Data Recovery Advisor
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV743"></a><div class="props_rev_3"><a id="GUID-E932D9A9-5505-43BC-AC56-774BBD5A9DCE" name="GUID-E932D9A9-5505-43BC-AC56-774BBD5A9DCE"></a><h4 id="BRADV-GUID-E932D9A9-5505-43BC-AC56-774BBD5A9DCE" class="sect4"><span class="enumeration_section">15.1.4 </span>Diagnosing and Repairing Failures in CDBs
                  </h4>
                  <div>
                     <p>You can use the Data Recovery Advisor to automatically diagnose data failures, determine appropriate repair options, and execute repairs in a CDB. </p>
                     <div class="section">
                        <p>The steps used for a CDB are similar to the ones that you would use for a <a href="glossary.html#GUID-62A96A52-3B97-455A-A443-75B999DCAC94"><span class="xrefglossterm">non-CDB</span></a>. The only difference is that, for a CDB, you connect to the root and then use the steps described in this chapter to perform repair actions.
                        </p>
                        <p>You cannot diagnose data failures and execute repairs for individual <a href="glossary.html#GUID-993BFB3F-3305-481C-999D-26132095DEC9"><span class="xrefglossterm">PDB</span></a>s in a CDB.
                        </p>
                        <div class="infoboxnotealso" id="GUID-E932D9A9-5505-43BC-AC56-774BBD5A9DCE__GUID-2A24D345-D8EB-4113-A989-6190305B749F">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="starting-interacting-with-rman-client.html#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" title="You can connect the RMAN client to multitenant container databases (CDBs) and pluggable databases (PDBs).">Making RMAN Connections to a CDB</a>"</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV89726"></a><div class="props_rev_3"><a id="GUID-05C2861A-4EC0-4F0C-8860-42AC2BC4CC17" name="GUID-05C2861A-4EC0-4F0C-8860-42AC2BC4CC17"></a><h3 id="BRADV-GUID-05C2861A-4EC0-4F0C-8860-42AC2BC4CC17" class="sect3"><span class="enumeration_section">15.2 </span>Listing Failures
               </h3>
               <div>
                  <p>If you suspect or know that one or more database failures have occurred, then use <code class="codeph">LIST FAILURE</code> to obtain information about them.
                  </p>
                  <p>You can list all or a subset of failures and restrict output in various ways. Failures are uniquely identified by failure numbers. These numbers are not consecutive, so gaps between failure numbers have no significance.</p>
                  <p>The <code class="codeph">LIST FAILURE</code> command does not execute data integrity checks to diagnose new failures; rather, it lists the results of previously executed assessments. Thus, repeatedly executing <code class="codeph">LIST FAILURE</code> reveals new failures only if the database automatically diagnosed them in response to errors that occurred in between command executions. However, executing <code class="codeph">LIST FAILURE</code> causes Data Recovery Advisor to revalidate all existing failures. If a user fixed failures manually, or if transient failures disappeared, then Data Recovery Advisor removes these failures from the <code class="codeph">LIST FAILURE</code> output. If a failure cannot be revalidated at this moment (for example, because of another failure), <code class="codeph">LIST FAILURE</code> shows the failure as open.
                  </p>
                  <div class="infoboxnotealso" id="GUID-05C2861A-4EC0-4F0C-8860-42AC2BC4CC17__GUID-C40CFA38-B64B-41D6-983C-79A7DBCEB506">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="diagnosing-repairing-failures-dra.html#GUID-1D2A9D25-C112-4F11-BCE1-7163A37E9750" title="The easiest way to determine problems that your database is encountering is to use the LIST FAILURE command.">Listing All Failures</a></p>
                        </li>
                        <li>
                           <p><a href="diagnosing-repairing-failures-dra.html#GUID-D94EC4F3-02C8-4C0B-A09B-CC871E394947" title="Besides providing more verbose output, LIST FAILURE also enables you to restrict output.">Listing a Subset of Failures</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV329"></a><a id="BRADV89727"></a><div class="props_rev_3"><a id="GUID-1D2A9D25-C112-4F11-BCE1-7163A37E9750" name="GUID-1D2A9D25-C112-4F11-BCE1-7163A37E9750"></a><h4 id="BRADV-GUID-1D2A9D25-C112-4F11-BCE1-7163A37E9750" class="sect4"><span class="enumeration_section">15.2.1 </span>Listing All Failures
                  </h4>
                  <div>
                     <p>The easiest way to determine problems that your database is encountering is to use the <code class="codeph">LIST FAILURE</code> command. 
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-1D2A9D25-C112-4F11-BCE1-7163A37E9750__GUID-BA926F65-8ACD-4DC2-8B37-D279D8B8168B">To list all failures:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Start RMAN and connect to a target database. The target database instance must be started.</span></li>
                        <li class="stepexpand"><span>Execute the <code class="codeph">LIST FAILURE</code> command.</span><div>
                              <p>The following example reports all failures known to Data Recovery Advisor (the output has been reformatted to fit on the page).</p><pre class="pre codeblock"><code>RMAN&gt; LIST FAILURE;

List of Database Failures
=========================
 
Failure ID Priority Status    Time Detected Summary
---------- -------- --------- ------------- -------
142        HIGH     OPEN      23-APR-13     One or more non-system datafiles are missing
101        HIGH     OPEN      23-APR-13     Datafile 1: '/disk1/oradata/prod/system01.dbf' contains one or more corrupt blocks
</code></pre><p>In this example, RMAN reports two different failures: a group of missing data files and a data file with corrupt blocks. The output indicates the unique identifier for each failure (142 and 101), the priority, status, and detection time.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Optionally, execute <code class="codeph">LIST FAILURE ... DETAIL</code> to list failures individually.</span><div>
                              <p>Data Recovery Advisor consolidates failures when possible. 	Specify the <code class="codeph">DETAIL</code> option to list failures individually. For example, if multiple block corruptions exist in a file, then specifying the <code class="codeph">DETAIL</code> option lists each of the block corruptions. The following example lists detailed information about failure 101.
                              </p><pre class="pre codeblock"><code>RMAN&gt; LIST FAILURE 101 DETAIL;

List of Database Failures
=========================
 
Failure ID Priority Status    Time Detected Summary
---------- -------- --------- ------------- -------
101        HIGH     OPEN      23-APR-13     Datafile 1: '/disk1/oradata/prod/system01.dbf' contains one or more corrupt blocks
  List of child failures for parent failure ID 101
  Failure ID Priority Status    Time Detected Summary
  ---------- -------- --------- ------------- -------
  104        HIGH     OPEN      23-APR-13     Block 56416 in datafile 1: '/disk1/oradata/prod/system01.dbf' is media corrupt
    Impact: Object BLKTEST owned by SYS might be unavailable</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Proceed to determine how to repair the failures displayed by the <code class="codeph">LIST FAILURE</code> command as described in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-13944F9E-545E-480A-A47B-CE0A73FED3C7" title="Use the ADVISE FAILURE command to display repair options after running LIST FAILURE in an RMAN session. This command prints a summary of the failures and implicitly closes all open failures that are repaired.">Determining Repair Options</a>"</span>.</span></li>
                     </ol>
                  </div>
               </div><a id="BRADV330"></a><a id="BRADV89728"></a><div class="props_rev_3"><a id="GUID-D94EC4F3-02C8-4C0B-A09B-CC871E394947" name="GUID-D94EC4F3-02C8-4C0B-A09B-CC871E394947"></a><h4 id="BRADV-GUID-D94EC4F3-02C8-4C0B-A09B-CC871E394947" class="sect4"><span class="enumeration_section">15.2.2 </span>Listing a Subset of Failures
                  </h4>
                  <div>
                     <p>Besides providing more verbose output, <code class="codeph">LIST FAILURE</code> also enables you to restrict output.
                     </p>
                     <div class="section">
                        <p>For example, you can execute <code class="codeph">LIST FAILURE</code> with the <code class="codeph">CRITICAL</code>, <code class="codeph">HIGH</code>, <code class="codeph">LOW</code>, or <code class="codeph">CLOSED</code> options to list only failures with a particular status or priority. You can also exclude specified failures from the output by specifying <code class="codeph">EXCLUDE FAILURE</code>. 
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D94EC4F3-02C8-4C0B-A09B-CC871E394947__GUID-6E1693DF-5DC7-4E68-8BF3-2292074E0B92">To list a subset of failures:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Start RMAN and connect to a target database. The target database instance must be started.</span></li>
                        <li class="stepexpand"><span>Execute <code class="codeph">LIST FAILURE</code> with the desired options. </span><div>
                              <p>The following examples illustrate some <code class="codeph">LIST FAILURE</code> commands:
                              </p><pre class="pre codeblock"><code>LIST FAILURE LOW;
LIST FAILURE CLOSED;
LIST FAILURE EXCLUDE FAILURE 234234;</code></pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-D94EC4F3-02C8-4C0B-A09B-CC871E394947__GUID-91857CC9-1ADD-4A88-88A8-993C4290F8F7">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF132" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> to learn about the <code class="codeph">LIST FAILURE</code> command
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV331"></a><a id="BRADV89729"></a><div class="props_rev_3"><a id="GUID-D9D58DB7-05ED-4A21-9D1A-94D57D600271" name="GUID-D9D58DB7-05ED-4A21-9D1A-94D57D600271"></a><h3 id="BRADV-GUID-D9D58DB7-05ED-4A21-9D1A-94D57D600271" class="sect3"><span class="enumeration_section">15.3 </span>Checking for Block Corruptions by Validating the Database
               </h3>
               <div>
                  <p>The database invokes data integrity checks reactively when a user transaction is trying to access corrupted data. In some cases, latent failures can go undetected. </p>
                  <div class="section">
                     <p>For example, when a data block corruption error occurs, the database reactively execute a data integrity check that validates the block on which the error occurred and other blocks in its immediate vicinity. However, blocks outside of the vicinity may be corrupted. Also, corrupted blocks that are never read by the database are never detected by a reactive data integrity check.</p>
                     <p>One effective way to execute a data integrity check proactively is to run the <code class="codeph">VALIDATE</code> or <code class="codeph">BACKUP VALIDATE</code> commands in RMAN. These commands can check data files and control files for physical and logical corruption. If RMAN discovers block corruptions, then it logs them into the Automatic Diagnostic Repository and creates one or more failures. You can then use Data Recovery Advisor to list information about the failures and repair them.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-D9D58DB7-05ED-4A21-9D1A-94D57D600271__GUID-E45CCCCA-70D8-48C1-81B2-5827BD9E9E13">To validate the database:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Start RMAN and connect to a target database. The target database must be mounted.</span></li>
                     <li class="stepexpand"><span>Validate the desired database files.</span><div>
                           <p>The following example uses <code class="codeph">VALIDATE DATABASE</code> to check for physical and logical corruption in the whole database (partial sample output included). Because <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-05C2861A-4EC0-4F0C-8860-42AC2BC4CC17" title="If you suspect or know that one or more database failures have occurred, then use LIST FAILURE to obtain information about them.">Listing Failures</a>"</span> indicates that some data files are missing, the <code class="codeph">SKIP INACCESSIBLE</code> clause is specified. The output shows that the <code class="codeph">system01.dbf</code> database file has one newly corrupt block (Blocks Failing) and no blocks previously marked corrupt by the database (Marked Corrupt).
                           </p><pre class="pre codeblock"><code>RMAN&gt; VALIDATE CHECK LOGICAL SKIP INACCESSIBLE DATABASE;
 
Starting validate at 23-APR-13
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=103 device type=DISK
could not access datafile 28
skipping inaccessible file 28
RMAN-06060: WARNING: skipping datafile compromises tablespace USERS recoverability
RMAN-06060: WARNING: skipping datafile compromises tablespace USERS recoverability
channel ORA_DISK_1: starting validation of datafile
channel ORA_DISK_1: specifying datafile(s) for validation
input datafile file number=00001 name=/disk1/oradata/prod/system01.dbf
input datafile file number=00002 name=/disk1/oradata/prod/sysaux01.dbf
input datafile file number=00022 name=/disk1/oradata/prod/undotbs01.dbf
input datafile file number=00023 name=/disk1/oradata/prod/cwmlite01.dbf
input datafile file number=00024 name=/disk1/oradata/prod/drsys01.dbf
input datafile file number=00025 name=/disk1/oradata/prod/example01.dbf
input datafile file number=00026 name=/disk1/oradata/prod/indx01.dbf
input datafile file number=00027 name=/disk1/oradata/prod/tools01.dbf
channel ORA_DISK_1: validation complete, elapsed time: 00:00:25
List of Datafiles
=================
File Status Marked Corrupt Empty Blocks Blocks Examined High SCN
---- ------ -------------- ------------ --------------- ----------
1    FAILED 0              3536         57600           637711
  File Name: /disk1/oradata/prod/system01.dbf
  Block Type Blocks Failing Blocks Processed
  ---------- -------------- ----------------
  Data       1              41876
  Index      0              7721
  Other      0              4467
.
.
. 
File Status Marked Corrupt Empty Blocks Blocks Examined High SCN
---- ------ -------------- ------------ --------------- ----------
27   OK     0              1272         1280            400914
  File Name: /disk1/oradata/prod/tools01.dbf
  Block Type Blocks Failing Blocks Processed
  ---------- -------------- ----------------
  Data       0              0
  Index      0              0
  Other      0              8

validate found one or more corrupt blocks
See trace file /disk1/oracle/log/diag/rdbms/prod/prod/trace/prod_ora_2596.trc
 for details
channel ORA_DISK_1: starting validation of datafile
channel ORA_DISK_1: specifying datafile(s) for validation
including current control file for validation
including current SPFILE in backup set
channel ORA_DISK_1: validation complete, elapsed time: 00:00:01
List of Control File and SPFILE
===============================
File Type    Status Blocks Failing Blocks Examined
------------ ------ -------------- ---------------
SPFILE       OK     0              2
Control File OK     0              512
Finished validate at 23-APR-13</code></pre></div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-D9D58DB7-05ED-4A21-9D1A-94D57D600271__GUID-07C2152E-8660-4648-B637-35E43750F453">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="diagnosing-repairing-failures-dra.html#GUID-58AB169E-7015-4551-BEF1-6E2F39B0E844" title="A checker is a diagnostic operation or procedure registered with the Health Monitor to assess the health of the database or its components.">About Data Integrity Checks</a></p>
                           </li>
                           <li>
                              <p><a href="validating-database-files-backups.html#GUID-CC967929-9610-410D-B881-66E71353D84C" title="Validation enables you to check the integrity of your backups.The main purpose of RMAN validation is to check for corrupt blocks and missing files. You can also use RMAN to determine whether backups can be restored.The database prevents operations that result in unusable backup files or corrupted restored data files. A corrupt block is a block that has been changed so that it differs from what Oracle Database expects to find.In a physical corruption, which is also called a media corruption, the database does not recognize the block at all: the checksum is invalid, the block contains all zeros, or the header and footer of the block do not match. You can use the SET MAXCORRUPT command to set the total number of unmarked corruptions permitted in a file for RMAN backups. The default is zero, meaning that RMAN does not tolerate unmarked corrupt blocks of any kind.Oracle Database supports different techniques for detecting, repairing, and monitoring block corruption.You can use the VALIDATE command to manually check for physical and logical corruptions in database files. You can also use the BACKUP VALIDATE command to perform validation.You can run RESTORE...VALIDATE to test whether RMAN can restore a specific file or set of files from a backup. RMAN chooses which backups to use.RMAN enables you to validate multitenant container databases (CDBs) and pluggable databases (PDBs) using the VALIDATE command. The steps to validate a CDB are similar to the ones used to validate a non-CDB. There are multiple methods to validate PDBs.">Validating Database Files and Backups</a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF162" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> to learn about the <code class="codeph">VALIDATE</code> command
                              </p>
                           </li>
                           <li>
                              <p><a href="../admin/diagnosing-and-resolving-problems.html#ADMIN11007" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> to learn about how Oracle Database manages diagnostic data
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV89730"></a><div class="props_rev_3"><a id="GUID-13944F9E-545E-480A-A47B-CE0A73FED3C7" name="GUID-13944F9E-545E-480A-A47B-CE0A73FED3C7"></a><h3 id="BRADV-GUID-13944F9E-545E-480A-A47B-CE0A73FED3C7" class="sect3"><span class="enumeration_section">15.4 </span>Determining Repair Options
               </h3>
               <div>
                  <p>Use the <code class="codeph">ADVISE FAILURE</code> command to display repair options after running <code class="codeph">LIST FAILURE</code> in an RMAN session. This command prints a summary of the failures and implicitly closes all open failures that are repaired.
                  </p>
                  <p>Where appropriate, the <code class="codeph">ADVISE FAILURE</code> command presents a list of manual and automated repair options. Manual options, which are categorized as either mandatory or optional, appear first. In some cases, an optional manual fix can avoid more extreme actions such as restoring and recovering data files. As a rule, use the repair technique that has the least effect on the database and the least possibility for error.
                  </p>
                  <div class="infoboxnotealso" id="GUID-13944F9E-545E-480A-A47B-CE0A73FED3C7__GUID-33698374-CF88-429A-88EA-1EA1AAB92F15">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="diagnosing-repairing-failures-dra.html#GUID-916107F7-7DB8-4E4D-8787-D50A30BD7CB6" title="If one or more failures exist, then you typically use LIST FAILURE to show information about the failures and then ADVISE FAILURE in the same RMAN session to obtain a report of your repair options.">Determining Repair Options for All Failures</a></p>
                        </li>
                        <li>
                           <p><a href="diagnosing-repairing-failures-dra.html#GUID-C9CDEE7B-EDA6-4E74-AB78-300A60B6CA3C" title="You can also request repair options for specific failures. You can specify failures by status (CRITICAL, HIGH, or LOW) or by failure number. You can also use EXCLUDE FAILURE to exclude one or more failures from the report.">Determining Repair Options for a Subset of Failures</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV332"></a><a id="BRADV89731"></a><div class="props_rev_3"><a id="GUID-916107F7-7DB8-4E4D-8787-D50A30BD7CB6" name="GUID-916107F7-7DB8-4E4D-8787-D50A30BD7CB6"></a><h4 id="BRADV-GUID-916107F7-7DB8-4E4D-8787-D50A30BD7CB6" class="sect4"><span class="enumeration_section">15.4.1 </span>Determining Repair Options for All Failures
                  </h4>
                  <div>
                     <p>If one or more failures exist, then you typically use <code class="codeph">LIST FAILURE</code> to show information about the failures and then <code class="codeph">ADVISE FAILURE</code> in the same RMAN session to obtain a report of your repair options.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-916107F7-7DB8-4E4D-8787-D50A30BD7CB6__GUID-2EADA743-E70E-4085-AFBF-AFC71DBA398D">To determine repair options for all failures:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>List failures as described in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-1D2A9D25-C112-4F11-BCE1-7163A37E9750" title="The easiest way to determine problems that your database is encountering is to use the LIST FAILURE command.">Listing All Failures</a>"</span>.</span></li>
                        <li class="stepexpand"><span>In the same RMAN session, execute <code class="codeph">ADVISE FAILURE</code>.</span><div>
                              <p>The following example requests repair options for all failures known to Data Recovery Advisor and includes sample output (reformatted to fit the page).</p><pre class="pre codeblock"><code>RMAN&gt; ADVISE FAILURE;
 
List of Database Failures
=========================
 
Failure ID Priority Status    Time Detected Summary
---------- -------- --------- ------------- -------
142        HIGH     OPEN      23-APR-13     One or more non-system datafiles 
                                            are missing
101        HIGH     OPEN      23-APR-13     Datafile 1: '/disk1/oradata/prod/system01.dbf' contains one or more corrupt blocks
 
analyzing automatic repair options; this may take some time
using channel ORA_DISK_1
analyzing automatic repair options complete
 
Mandatory Manual Actions
========================
no manual actions available
 
Optional Manual Actions
=======================
1. If file /disk1/oradata/prod/users01.dbf was unintentionally renamed or moved, restore it
 
Automated Repair Options
========================
Option Repair Description
------ ------------------
1      Restore and recover datafile 28; Perform block media recovery of 
       block 56416 in file 1
  Strategy: The repair includes complete media recovery with no data loss
  Repair script: /disk1/oracle/log/diag/rdbms/prod/prod/hm/reco_660500184.hm</code></pre><p>In the preceding example, <code class="codeph">ADVISE FAILURE</code> reports two failures: a missing data file and a data file with corrupt blocks. The command does not list mandatory manual actions, but it suggests making sure that the missing data file was not accidentally renamed or removed. The automated repair option involves <a href="glossary.html#GUID-923A509A-1C36-4EA4-91C8-6E4F372722C0"><span class="xrefglossterm">block media recovery</span></a> and restoring and recovering the missing data file. <code class="codeph">ADVISE FAILURE</code> lists the location of the repair script.
                              </p>
                              <p>The following variation of the same example shows the output when the RMAN backups or archived redo logs needed for the automated repair are not available. The command <code class="codeph">ADVISE FAILURE</code> now shows mandatory manual actions.
                              </p><pre class="pre codeblock"><code>RMAN&gt; ADVISE FAILURE;
 
List of Database Failures
=========================
 
Failure ID Priority Status    Time Detected Summary
---------- -------- --------- ------------- -------
142        HIGH     OPEN      23-APR-13     One or more non-system datafiles 
                                            are missing
101        HIGH     OPEN      23-APR-13     Datafile 1:
 '/disk1/oradata/prod/system01.dbf' contains one or more corrupt blocks
 
analyzing automatic repair options; this may take some time
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=103 device type=DISK
analyzing automatic repair options complete
 
Mandatory Manual Actions
========================
1. If file /disk1/oradata/prod/users01.dbf was unintentionally renamed or
 moved, restore it
2. Contact Oracle Support Services if the preceding recommendations cannot be
 used, or if they do not fix the failures selected for repair
 
Optional Manual Actions
=======================
no manual actions available
 
Automated Repair Options
========================
Option Repair Description
------ ------------------
1      Perform block media recovery of block 56416 in file 1
  Strategy: The repair includes complete media recovery with no data loss
  Repair script: /disk1/oracle/log/diag/rdbms/prod/prod/hm/reco_1863891774.hm
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Proceed to <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-31DF1037-325F-4FED-8A37-23216EFF9526" title="You can use Data Recovery Advisor to repair failures automatically.">Repairing Failures</a>"</span> to determine how to repair the failures shown in the <code class="codeph">LIST FAILURE</code> output.</span></li>
                     </ol>
                  </div>
               </div><a id="BRADV333"></a><a id="BRADV89732"></a><div class="props_rev_3"><a id="GUID-C9CDEE7B-EDA6-4E74-AB78-300A60B6CA3C" name="GUID-C9CDEE7B-EDA6-4E74-AB78-300A60B6CA3C"></a><h4 id="BRADV-GUID-C9CDEE7B-EDA6-4E74-AB78-300A60B6CA3C" class="sect4"><span class="enumeration_section">15.4.2 </span>Determining Repair Options for a Subset of Failures
                  </h4>
                  <div>
                     <p>You can also request repair options for specific failures. You can specify failures by status (<code class="codeph">CRITICAL</code>, <code class="codeph">HIGH</code>, or <code class="codeph">LOW</code>) or by failure number. You can also use <code class="codeph">EXCLUDE FAILURE</code> to exclude one or more failures from the report.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C9CDEE7B-EDA6-4E74-AB78-300A60B6CA3C__GUID-E6CBCEB7-A3AE-4A6F-B18B-8CAF2A3FA01F">To determine repair options for a subset of failures:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>List failures as described in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-1D2A9D25-C112-4F11-BCE1-7163A37E9750" title="The easiest way to determine problems that your database is encountering is to use the LIST FAILURE command.">Listing All Failures</a>"</span>.</span></li>
                        <li class="stepexpand"><span>In the same RMAN session, execute <code class="codeph">ADVISE FAILURE</code> with the desired options.</span><div>
                              <p>The following example requests repair options for failure 101 only.</p><pre class="pre codeblock"><code>RMAN&gt; ADVISE FAILURE 101;
 
List of Database Failures
=========================
 
Failure ID Priority Status    Time Detected Summary
---------- -------- --------- ------------- -------
101        HIGH     OPEN      23-APR-13     Datafile 1: '/disk1/oradata/prod/system01.dbf' contains one or more corrupt blocks
 
analyzing automatic repair options; this may take some time
using channel ORA_DISK_1
analyzing automatic repair options complete
 
Mandatory Manual Actions
========================
no manual actions available
 
Optional Manual Actions
=======================
no manual actions available
 
Automated Repair Options
========================
Option Repair Description
------ ------------------
1      Perform block media recovery of block 56416 in file 1
  Strategy: The repair includes complete media recovery with no data loss
  Repair script: /disk1/oracle/log/diag/rdbms/prod/prod/hm/reco_708819503.htm</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Proceed to <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-31DF1037-325F-4FED-8A37-23216EFF9526" title="You can use Data Recovery Advisor to repair failures automatically.">Repairing Failures</a>"</span> to determine how to repair the failures displayed by the <code class="codeph">LIST FAILURE</code> command.</span></li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-C9CDEE7B-EDA6-4E74-AB78-300A60B6CA3C__GUID-D7853B49-0AB8-4C7B-88D0-20F558F817AB">
                           <p class="notep1">See Also:</p>
                           <p><a href="../rcmrf/ADVISE-FAILURE.html#RCMRF166" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> to learn about the <code class="codeph">ADVISE FAILURE</code> command
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV89733"></a><div class="props_rev_3"><a id="GUID-31DF1037-325F-4FED-8A37-23216EFF9526" name="GUID-31DF1037-325F-4FED-8A37-23216EFF9526"></a><h3 id="BRADV-GUID-31DF1037-325F-4FED-8A37-23216EFF9526" class="sect3"><span class="enumeration_section">15.5 </span>Repairing Failures
               </h3>
               <div>
                  <p>You can use Data Recovery Advisor to repair failures automatically.</p>
                  <p>This section contains the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="diagnosing-repairing-failures-dra.html#GUID-CABB41D1-393B-4A6C-A3B9-F66D49895942" title="If ADVISE FAILURE suggests manual repairs, then try these first. If manual repairs are not possible, or if they do not repair all failures, then you can use REPAIR FAILURE to automatically fix failures suggested in the most recent ADVISE FAILURE command in your current RMAN session.">About Repairing Failures</a></p>
                     </li>
                     <li>
                        <p><a href="diagnosing-repairing-failures-dra.html#GUID-3DCF4326-2B62-43B0-BAFA-B9F5F6AF484F" title="By default the script is displayed to standard output. You can use the SPOOL command to write the script to an editable file.">Repairing a Failure</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV89734"></a><div class="props_rev_3"><a id="GUID-CABB41D1-393B-4A6C-A3B9-F66D49895942" name="GUID-CABB41D1-393B-4A6C-A3B9-F66D49895942"></a><h4 id="BRADV-GUID-CABB41D1-393B-4A6C-A3B9-F66D49895942" class="sect4"><span class="enumeration_section">15.5.1 </span>About Repairing Failures
                  </h4>
                  <div>
                     <p>If <code class="codeph">ADVISE FAILURE</code> suggests manual repairs, then try these first. If manual repairs are not possible, or if they do not repair all failures, then you can use <code class="codeph">REPAIR FAILURE</code> to automatically fix failures suggested in the most recent <code class="codeph">ADVISE FAILURE</code> command in your current RMAN session.
                     </p>
                     <p>By default, <code class="codeph">REPAIR FAILURE</code> prompts for confirmation before it begins executing. You can suppress the confirmation prompt by specifying the <code class="codeph">NOPROMPT</code> option. After it starts executing, the command indicates the current phase of repair. Depending on the circumstances, RMAN may prompt for a response. After executing a repair, RMAN reevaluates all existing failures on the chance that they may have been fixed during this repair.
                     </p>
                     <p>While repairing a failure, wherever possible, RMAN takes a file online, restores and recovers it, and then brings it back online again. You can repair failures for a selected database, tablespace, or data file.</p>
                     <p>Before performing a repair, it is typically advisable to preview it by specifying the <code class="codeph">PREVIEW</code> option. RMAN does not make any repairs and generates a script with all repair actions and comments. If you do not specify a particular repair option, then RMAN uses the first repair option of the most recent <code class="codeph">ADVISE FAILURE</code> command in the current session. By default the repair script is displayed to standard output. You can use the <code class="codeph">SPOOL</code> command to write the script to an editable file.
                     </p>
                     <div class="infoboxnotealso" id="GUID-CABB41D1-393B-4A6C-A3B9-F66D49895942__GUID-92C3373A-2F0A-4220-A7E8-53C605E73B19">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../rcmrf/REPAIR-FAILURE.html#RCMRF199" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> to learn about the <code class="codeph">REPAIR FAILURE</code> command
                              </p>
                           </li>
                           <li>
                              <p><a href="../rcmrf/SPOOL.html#RCMRF156" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> to learn about the <code class="codeph">SPOOL</code> command
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="BRADV334"></a><a id="BRADV89735"></a><div class="props_rev_3"><a id="GUID-3DCF4326-2B62-43B0-BAFA-B9F5F6AF484F" name="GUID-3DCF4326-2B62-43B0-BAFA-B9F5F6AF484F"></a><h4 id="BRADV-GUID-3DCF4326-2B62-43B0-BAFA-B9F5F6AF484F" class="sect4"><span class="enumeration_section">15.5.2 </span>Repairing a Failure
                  </h4>
                  <div>
                     <p>By default the script is displayed to standard output. You can use the <code class="codeph">SPOOL</code> command to write the script to an editable file.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-3DCF4326-2B62-43B0-BAFA-B9F5F6AF484F__GUID-CB2ADE72-BDB9-46BB-9838-FE82E9B1F324">To repair a failure:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>List failures as described in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-1D2A9D25-C112-4F11-BCE1-7163A37E9750" title="The easiest way to determine problems that your database is encountering is to use the LIST FAILURE command.">Listing All Failures</a>"</span>.</span></li>
                        <li class="stepexpand"><span>Display repair options as described in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-13944F9E-545E-480A-A47B-CE0A73FED3C7" title="Use the ADVISE FAILURE command to display repair options after running LIST FAILURE in an RMAN session. This command prints a summary of the failures and implicitly closes all open failures that are repaired.">Determining Repair Options</a>"</span>.</span></li>
                        <li class="stepexpand"><span>Optionally, execute <code class="codeph">REPAIR FAILURE PREVIEW</code>.</span><div>
                              <p>The following example previews the first repair options displayed by the previous <code class="codeph">ADVISE FAILURE</code> command in the RMAN session.
                              </p><pre class="pre codeblock"><code>RMAN&gt; REPAIR FAILURE PREVIEW;
 
Strategy: The repair includes complete media recovery with no data loss
Repair script: /disk1/oracle/log/diag/rdbms/prod/prod/hm/reco_475549922.hm
contents of repair script:
   # restore and recover datafile
   sql 'alter database datafile 28 offline';
   restore datafile 28;
   recover datafile 28;
   sql 'alter database datafile 28 online';
   # block media recovery
   recover datafile 1 block 56416;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Execute <code class="codeph">REPAIR FAILURE</code>.</span><div>
                              <p>The following repair restores and recovers one data file and performs block media recovery on one corrupt block. RMAN prompts for confirmation that it should perform the repair. The user-entered text is in bold.</p><pre class="pre codeblock"><code>RMAN&gt; REPAIR FAILURE;
 
Strategy: The repair includes complete media recovery with no data loss
Repair script: /disk1/oracle/log/diag/rdbms/prod/prod/hm/reco_475549922.hm
contents of repair script:
   # restore and recover data file
   sql 'alter database datafile 28 offline';
   restore datafile 28;
   recover datafile 28;
   sql 'alter database datafile 28 online';
   # block media recovery
   recover datafile 1 block 56416;
 
Do you really want to execute the above repair (enter YES or NO)? <span class="bold">YES</span>
executing repair script
 
sql statement: alter database datafile 28 offline
 
Starting restore at 23-APR-13
using channel ORA_DISK_1
 
channel ORA_DISK_1: starting datafile backup set restore
channel ORA_DISK_1: specifying datafile(s) to restore from backup set
channel ORA_DISK_1: restoring datafile 00028 to /disk1/oradata/prod/users01.dbf
channel ORA_DISK_1: reading from backup piece /disk2/PROD/backupset/2013_04_18/o1_mf_nnndf_TAG20130418T182042_32fjzd3z_.bkp
channel ORA_DISK_1: piece handle=/disk2/PROD/backupset/2013_04_18/o1_mf_nnndf_TAG20130418T182042_32fjzd3z_.bkp tag=TAG20130418T182042
channel ORA_DISK_1: restored backup piece 1
channel ORA_DISK_1: restore complete, elapsed time: 00:00:03
Finished restore at 23-APR-13
 
Starting recover at 23-APR-13
using channel ORA_DISK_1
 
starting media recovery
media recovery complete, elapsed time: 00:00:01
 
Finished recover at 23-APR-13
 
sql statement: alter database datafile 28 online
 
Starting recover at 23-APR-13
using channel ORA_DISK_1
searching flashback logs for block images until SCN 429690
finished flashback log search, restored 1 blocks
 
starting media recovery
media recovery complete, elapsed time: 00:00:03
 
Finished recover at 23-APR-13
repair failure complete
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Optionally, execute <code class="codeph">LIST FAILURE</code> to confirm</span></li>
                     </ol>
                  </div>
               </div>
            </div><a id="BRADV335"></a><a id="BRADV89736"></a><div class="props_rev_3"><a id="GUID-9F467E37-DC05-494A-890E-439330493056" name="GUID-9F467E37-DC05-494A-890E-439330493056"></a><h3 id="BRADV-GUID-9F467E37-DC05-494A-890E-439330493056" class="sect3"><span class="enumeration_section">15.6 </span>Changing Failure Status and Priority
               </h3>
               <div>
                  <p>In some situations, you may want to use the <code class="codeph">CHANGE FAILURE</code> command to alter the status or priority of a failure. 
                  </p>
                  <div class="section">
                     <p>For example, if a block corruption has <code class="codeph">HIGH</code> priority, you may want to change it to <code class="codeph">LOW</code> temporarily if the block is in a little-used tablespace. 
                     </p>
                     <p>If you repair a failure by a means other than the <code class="codeph">REPAIR FAILURE</code> command, then Data Recovery Advisor closes it implicitly the next time you execute <code class="codeph">LIST FAILURE</code>. For this reason, you do not normally need to execute the <code class="codeph">CHANGE FAILURE ... CLOSED</code> command. You need to use this command only if the automatic failure revalidation fails, but you believe the failure no longer exists. If you use <code class="codeph">CHANGE FAILURE</code> to close a failure that still exists, then Data Recovery Advisor re-creates it with a different failure ID when the appropriate data integrity check is executed.
                     </p>
                     <p>Typically, you specify the failures to change by failure number. You can also change failures in bulk by specifying <code class="codeph">ALL</code>, <code class="codeph">CRITICAL</code>, <code class="codeph">HIGH</code>, or <code class="codeph">LOW</code>. You can change a failure to <code class="codeph">CLOSED</code> or to <code class="codeph">PRIORITY HIGH</code> or <code class="codeph">PRIORITY LOW</code>. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9F467E37-DC05-494A-890E-439330493056__GUID-41C1C8A2-D517-4D4E-A93B-65FD67C56F4C">To change the status or priority of a failure:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>List failures as described in <span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-1D2A9D25-C112-4F11-BCE1-7163A37E9750" title="The easiest way to determine problems that your database is encountering is to use the LIST FAILURE command.">Listing All Failures</a>"</span>.</span><div>
                           <p>The following example lists one failure involving corrupt data blocks.</p><pre class="pre codeblock"><code>RMAN&gt; LIST FAILURE;
 
List of Database Failures
=========================
 
Failure ID Priority Status    Time Detected Summary
---------- -------- --------- ------------- -------
142        HIGH     OPEN      23-APR-13     One or more non-system datafiles 
                                            are missing
101        HIGH     OPEN      23-APR-13     Datafile 25: '/disk1/oradata/prod/example01.dbf' contains one or more corrupt blocks
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Execute <code class="codeph">CHANGE FAILURE</code> with the desired options.</span><div>
                           <p>The following example changes the priority of a block corruption failure from <code class="codeph">HIGH</code> to <code class="codeph">LOW</code>.
                           </p><pre class="pre codeblock"><code>RMAN&gt; CHANGE FAILURE 101 PRIORITY LOW;
 
List of Database Failures
=========================
 
Failure ID Priority Status    Time Detected Summary
---------- -------- --------- ------------- -------
101        HIGH     OPEN      23-APR-13     Datafile 25: '/disk1/oradata/prod/example01.dbf' contains one or more corrupt blocks
 
Do you really want to change the above failures (enter YES or NO)? <span class="bold">YES</span>
changed 1 failures to LOW priority
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Optionally, execute <code class="codeph">LIST FAILURE ALL</code> to view the change.</span><div>
                           <p>If you execute <code class="codeph">LIST FAILURE</code> without <code class="codeph">ALL</code>, then the command lists failures with <code class="codeph">LOW</code> priority only if no <code class="codeph">CRITICAL</code> or <code class="codeph">HIGH</code> priority failures exist.
                           </p><pre class="pre codeblock"><code>RMAN&gt; LIST FAILURE ALL;
 
List of Database Failures
=========================
 
Failure ID Priority Status    Time Detected Summary
---------- -------- --------- ------------- -------
142        HIGH     OPEN      23-APR-13     One or more non-system datafiles 
                                            are missing
101        LOW      OPEN      23-APR-13     Datafile 25: '/disk1/oradata/prod/example01.dbf' contains one or more corrupt blocks</code></pre></div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-9F467E37-DC05-494A-890E-439330493056__GUID-0019CB88-CB52-469C-A996-79B1B9246479">
                        <p class="notep1">See Also:</p>
                        <p><a href="../rcmrf/CHANGE.html#RCMRF110" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> to learn about the <code class="codeph">CHANGE</code> command
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>