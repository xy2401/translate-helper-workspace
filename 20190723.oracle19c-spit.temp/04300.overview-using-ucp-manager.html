<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Overview of Using the UCP Manager</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Universal Connection Pool Developer's Guide ">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Universal Connection Pool Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="universal-connection-pool-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-13T06:57:38-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96473-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-ucp-manager.html" title="Previous" type="text/html">
      <link rel="next" href="jmx-based-management.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Universal Connection Pool Developer's Guide">
    <meta name="dcterms.isVersionOf" content="JJUCP">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-ucp-manager.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="jmx-based-management.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Universal Connection Pool Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="using-ucp-manager.html" property="item" typeof="WebPage"><span property="name">Using the Connection Pool Manager</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Overview of Using the UCP Manager</li>
            </ol>
            <a id="GUID-8932E6BA-EF64-442D-9E43-4FC6B7046E11" name="GUID-8932E6BA-EF64-442D-9E43-4FC6B7046E11"></a><a id="JJUCP8181"></a>
            
            <h2 id="JJUCP-GUID-8932E6BA-EF64-442D-9E43-4FC6B7046E11" class="sect2"><span class="enumeration_section">7.1 </span>Overview of Using the UCP Manager
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The Universal Connection Pool (UCP) manager creates and maintains UCP instances. A pool instance is registered with the pool manager every time a new pool is created. This section covers the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="overview-using-ucp-manager.html#GUID-C34A192A-13AB-4BCA-B84C-FD53FC61885A">About Connection Pool Manager</a></p>
                  </li>
                  <li>
                     <p><a href="overview-using-ucp-manager.html#GUID-3757F854-3800-49FA-936E-2AC4C91CD5F1">Creating a Connection Pool Manager for UCP</a></p>
                  </li>
                  <li>
                     <p><a href="overview-using-ucp-manager.html#GUID-2652F7EE-B799-4B5F-9CC0-9C0BC291C8E4">Life Cycle States of a Connection</a></p>
                  </li>
                  <li>
                     <p><a href="overview-using-ucp-manager.html#GUID-366FBBD8-B19D-442C-AD11-979FCB418833">Maintenance of Universal Connection Pool</a></p>
                  </li>
               </ul>
            </div><a id="JJUCP8182"></a><div class="props_rev_3"><a id="GUID-C34A192A-13AB-4BCA-B84C-FD53FC61885A" name="GUID-C34A192A-13AB-4BCA-B84C-FD53FC61885A"></a><h3 id="JJUCP-GUID-C34A192A-13AB-4BCA-B84C-FD53FC61885A" class="sect3"><span class="enumeration_section">7.1.1 </span>About Connection Pool Manager
               </h3>
               <div>
                  <p><a id="d6328e90" class="indexterm-anchor"></a><a id="d6328e94" class="indexterm-anchor"></a><a id="d6328e98" class="indexterm-anchor"></a><a id="d6328e100" class="indexterm-anchor"></a>Applications use a connection pool manager to explicitly create and manage UCP JDBC connection pools. Applications use the manager because it offers full life cycle control, such as creating, starting, stopping, and destroying a connection pool. Applications also use the manager to perform routine maintenance on the connection pool, such as refreshing, recycling, and purging connections in a pool. Lastly, applications use the connection pool manager because it offers a centralized integration point for administrative tools and consoles.
                  </p>
               </div>
            </div><a id="JJUCP8183"></a><div class="props_rev_3"><a id="GUID-3757F854-3800-49FA-936E-2AC4C91CD5F1" name="GUID-3757F854-3800-49FA-936E-2AC4C91CD5F1"></a><h3 id="JJUCP-GUID-3757F854-3800-49FA-936E-2AC4C91CD5F1" class="sect3"><span class="enumeration_section">7.1.2 </span>Creating a Connection Pool Manager for UCP
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d6328e141" class="indexterm-anchor"></a><a id="d6328e145" class="indexterm-anchor"></a><a id="d6328e147" class="indexterm-anchor"></a><a id="d6328e149" class="indexterm-anchor"></a>A connection pool manager is an instance of the <code class="codeph">UniversalConnectionPoolManager</code> interface, which is located in the <code class="codeph">oracle.ucp.admin</code> package. The manager is a Singleton instance that is used to manage multiple connection pools per JVM. The interface includes methods for interacting with a connection pool manager. UCP includes an implementation that is used to get a connection pool manager instance. The following example demonstrates creating a connection pool manager instance using the implementation:
                     </p><pre class="oac_no_warn" dir="ltr">UniversalConnectionPoolManager mgr = UniversalConnectionPoolManagerImpl.
getUniversalConnectionPoolManager();
</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="JJUCP8185"></a><a id="JJUCP8184"></a><div class="props_rev_3"><a id="GUID-2652F7EE-B799-4B5F-9CC0-9C0BC291C8E4" name="GUID-2652F7EE-B799-4B5F-9CC0-9C0BC291C8E4"></a><h3 id="JJUCP-GUID-2652F7EE-B799-4B5F-9CC0-9C0BC291C8E4" class="sect3"><span class="enumeration_section">7.1.3 </span>Life Cycle States of a Connection
               </h3>
               <div>
                  <p><a id="d6328e200" class="indexterm-anchor"></a><a id="d6328e204" class="indexterm-anchor"></a>Applications use the connection pool manager to explicitly control the life cycle of connection pools. The manager is used to create, start, stop, and destroy connection pools. Life cycle methods are included as part of the <code class="codeph">UniversalConnectionPoolManager</code> interface.
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-2652F7EE-B799-4B5F-9CC0-9C0BC291C8E4__GUID-419E1DB7-5B14-470A-83F2-B83F1440CEBF">Understanding Life Cycle States</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><a id="d6328e215" class="indexterm-anchor"></a>The life cycle states of a connection pool affects what manager operations can be performed on a connection pool. Applications that explicitly control the life cycle of a pool must ensure that the manager's operations are used only when the pool is in an appropriate state. Life cycle constraints are discussed throughout this section.
                     </p>
                     <p>The following list describes the life cycle states of a pool:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Starting : Indicates that the connection pool's start method has been called and it is in the process of starting up.</p>
                        </li>
                        <li>
                           <p>Running : Indicates that the connection pool has been started and is ready to give out connections.</p>
                        </li>
                        <li>
                           <p>Stopping : Indicates that the connection pool is in the process of stopping.</p>
                        </li>
                        <li>
                           <p>Stopped : Indicates that the connection pool is stopped.</p>
                        </li>
                        <li>
                           <p>Failed : Indicates that the connection pool has encountered failures during starting, stopping, or execution.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="JJUCP8186"></a><div class="props_rev_3"><a id="GUID-02E7806B-F72F-43B6-A2BE-9EB0C558FFBA" name="GUID-02E7806B-F72F-43B6-A2BE-9EB0C558FFBA"></a><h4 id="JJUCP-GUID-02E7806B-F72F-43B6-A2BE-9EB0C558FFBA" class="sect4"><span class="enumeration_section">7.1.3.1 </span>Creating a Connection Pool
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d6328e272" class="indexterm-anchor"></a><a id="d6328e276" class="indexterm-anchor"></a><a id="d6328e280" class="indexterm-anchor"></a>The <code class="codeph">CreateConnectionPool</code> method of the Connection Manager creates and registers a connection pool. The manager uses a connection pool adapter to create the pool and relies on a pool-enabled data source to configure the pool properties. An application must not implicitly start a connection pool before using the <code class="codeph">createConnectionPool</code> method to explicitly create the same pool.
                        </p>
                        <p>The following example demonstrates creating a connection pool instance using the manager:</p><pre class="oac_no_warn" dir="ltr">UniversalConnectionPoolManager mgr = UniversalConnectionPoolManagerImpl.
getUniversalConnectionPoolManager();

PoolDataSource  pds = PoolDataSourceFactory.getPoolDataSource();
pds.setConnectionPoolName("mgr_pool");
pds.setConnectionFactoryClassName("oracle.jdbc.pool.OracleDataSource");
pds.setURL("jdbc:oracle:thin:@//localhost:1521/XE");
pds.setUser("<span class="italic">&lt;user&gt;</span>");
pds.setPassword("<span class="italic">&lt;password&gt;</span>");

mgr.createConnectionPool((UniversalConnectionPoolAdapter)pds);
</pre><p>An application does not have to use the manager to create a pool in order for the pool to be managed. A pool that is implicitly created (that is, automatically created when using a pool-enabled data source) and configured with a pool name, is automatically registered and managed by the pool manager. Oracle recommends implicit pool creation.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-02E7806B-F72F-43B6-A2BE-9EB0C558FFBA__GUID-D0F4A090-1C08-4315-9F6F-2FEEE78782BA">Pool Naming Convention</p>
                        <p>A connection pool name must be defined as part of the configuration. The pool name provides a way to refer to specific pools when interacting with the manager. A connection pool name must be unique and cannot be used by more than one connection pool. The manager throws a <code class="codeph">pool already exists</code> exception if a connection pool already exists with the same name.
                        </p>
                        <p><span class="bold">Compatibility with JBoss</span></p>
                        <p>JBoss users can use the JBoss-specific <span class="keyword">silent reload</span> functionality by setting the <code class="codeph">oracle.ucp.destroyOnReload</code> JVM system property to <code class="codeph">true</code>. When the <code class="codeph">oracle.ucp.destroyOnReload</code> property is set to <code class="codeph">true</code>, then the JBoss-specific behavior automatically destroys an old pool instance prior to creating a new one with the same name. If this system property is not set or set to <code class="codeph">false</code>, then UCP throws a <code class="codeph">pool already exists</code> exception.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-217A044B-F58E-46C9-B72A-EADB44A03816" name="GUID-217A044B-F58E-46C9-B72A-EADB44A03816"></a><h4 id="JJUCP-GUID-217A044B-F58E-46C9-B72A-EADB44A03816" class="sect4"><span class="enumeration_section">7.1.3.2 </span>Starting a Connection Pool
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d6328e375" class="indexterm-anchor"></a><a id="d6328e379" class="indexterm-anchor"></a><a id="d6328e381" class="indexterm-anchor"></a><a id="d6328e385" class="indexterm-anchor"></a>The manager's <code class="codeph">startConnectionPool</code> method starts a connection pool using the pool name as a parameter to determine which pool to start. The pool name is defined as a pool property on a pool-enabled data source.
                        </p>
                        <p>The following example demonstrates starting a connection pool:</p><pre class="oac_no_warn" dir="ltr">mgr.startConnectionPool("mgr_pool");
</pre><p>An application must always create a connection pool using the manager's <code class="codeph">createConnectionPool</code> method prior to starting the pool. In addition, a life cycle state exception occurs if an application attempts to start a pool that has been previously started or if the pool is in a state other than stopped or failed.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-3359C60C-385F-4FCE-B9E8-814C12180DCF" name="GUID-3359C60C-385F-4FCE-B9E8-814C12180DCF"></a><h4 id="JJUCP-GUID-3359C60C-385F-4FCE-B9E8-814C12180DCF" class="sect4"><span class="enumeration_section">7.1.3.3 </span>Stopping a Connection Pool
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d6328e436" class="indexterm-anchor"></a><a id="d6328e440" class="indexterm-anchor"></a><a id="d6328e442" class="indexterm-anchor"></a><a id="d6328e446" class="indexterm-anchor"></a>The manager's <code class="codeph">stopConnectionPool</code> method stops a connection pool using the pool name as a parameter to determine which pool to stop. The pool name is defined as a pool property on the pool-enabled data source. Stopping a connection pool closes all available and borrowed connections.
                        </p>
                        <p>The following example demonstrates stopping a connection pool:</p><pre class="oac_no_warn" dir="ltr">mgr.stopConnectionPool("mgr_pool");
</pre><p>An application can use the manager to stop a connection pool that was started implicitly or explicitly. An error occurs if an application attempts to stop a pool that does not exist or if the pool is in a state other than started or starting.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJUCP8189"></a><div class="props_rev_3"><a id="GUID-3C734CAE-3DF8-4AC7-ADAA-925EF9BFF38D" name="GUID-3C734CAE-3DF8-4AC7-ADAA-925EF9BFF38D"></a><h4 id="JJUCP-GUID-3C734CAE-3DF8-4AC7-ADAA-925EF9BFF38D" class="sect4"><span class="enumeration_section">7.1.3.4 </span>Destroying a Connection Pool
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d6328e494" class="indexterm-anchor"></a><a id="d6328e498" class="indexterm-anchor"></a><a id="d6328e500" class="indexterm-anchor"></a><a id="d6328e504" class="indexterm-anchor"></a>The manager's <code class="codeph">destroyConnectionPool</code> method stops a connection pool and removes it from the connection pool manager. A pool name is used as a parameter to determine which pool to destroy. The pool name is defined as a pool property on the pool-enabled data source.
                        </p>
                        <p>The following example demonstrates destroying a connection pool:</p><pre class="oac_no_warn" dir="ltr">mgr.destroyConnectionPool("mgr_pool");
</pre><p>An application cannot start a connection pool that has been destroyed and must explicitly create and start a new connection pool.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="JJUCP8190"></a><div class="props_rev_3"><a id="GUID-366FBBD8-B19D-442C-AD11-979FCB418833" name="GUID-366FBBD8-B19D-442C-AD11-979FCB418833"></a><h3 id="JJUCP-GUID-366FBBD8-B19D-442C-AD11-979FCB418833" class="sect3"><span class="enumeration_section">7.1.4 </span>Maintenance of Universal Connection Pool
               </h3>
               <div>
                  <p><a id="d6328e551" class="indexterm-anchor"></a>Applications use the connection pool manager to perform maintenance on a connection pool. Maintenance includes refreshing, recycling, and purging a connection pool. The maintenance methods are included as part of the <code class="codeph">UniversalConnectionPoolManager</code> interface.
                  </p>
                  <p>Maintenance is typically performed to remove and replace invalid connections and ensures a high availability of valid connections. Invalid connections typically cannot be used to connect to a database but are still maintained by the pool. These connections waste system resources and directly affect a pool's maximum connection limit. Ultimately, too many invalid connections negatively affects an applications performance.</p>
                  <div class="infoboxnote" id="GUID-366FBBD8-B19D-442C-AD11-979FCB418833__GUID-7D8745E3-FC92-476D-B7B9-94FDB4838BEA">
                     <p class="notep1">Note:</p>
                     <p>Applications can check whether or not a connection is valid when borrowing the connection from the pool. If an application consistently has a high number of invalid connections, additional testing should be performed to determine the cause.</p>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="validating-ucp-connections.html#GUID-A7C850D6-4026-4629-BCFA-9181C29EFBF9">Overview of Validating Connections in UCP</a></li>
                     </ul>
                  </div>
               </div>
               <a id="JJUCP8191"></a><div class="props_rev_3"><a id="GUID-FD2FAA44-2C64-43CA-95BB-6A24188048DF" name="GUID-FD2FAA44-2C64-43CA-95BB-6A24188048DF"></a><h4 id="JJUCP-GUID-FD2FAA44-2C64-43CA-95BB-6A24188048DF" class="sect4"><span class="enumeration_section">7.1.4.1 </span>Refreshing a Connection Pool
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d6328e609" class="indexterm-anchor"></a><a id="d6328e613" class="indexterm-anchor"></a><a id="d6328e615" class="indexterm-anchor"></a><a id="d6328e619" class="indexterm-anchor"></a>Refreshing a connection pool replaces every connection in the pool with a new connection. Any connections that are currently borrowed are marked for removal and refreshed after the connection is returned to the pool. The manager's <code class="codeph">refreshConnectionPool</code> method refreshes a connection pool using the pool name as a parameter to determine which pool to refresh. The pool name is defined as a pool property on the pool-enabled data source.
                        </p>
                        <p>The following example demonstrates refreshing a connection pool:</p><pre class="oac_no_warn" dir="ltr">mgr.refreshConnectionPool("mgr_pool");
</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-5710C8FA-C0FB-4C1E-B8B2-45FD244342A6" name="GUID-5710C8FA-C0FB-4C1E-B8B2-45FD244342A6"></a><h4 id="JJUCP-GUID-5710C8FA-C0FB-4C1E-B8B2-45FD244342A6" class="sect4"><span class="enumeration_section">7.1.4.2 </span>Recycling a Connection Pool
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d6328e665" class="indexterm-anchor"></a><a id="d6328e669" class="indexterm-anchor"></a><a id="d6328e671" class="indexterm-anchor"></a><a id="d6328e675" class="indexterm-anchor"></a>Recycling a connection pool replaces only invalid connection in the pool with a new connection and does not replace borrowed connections. The manager's <code class="codeph">recycleConnectionPool</code> method recycles a connection pool using the pool name as a parameter to determine which pool to recycle. The pool name is defined as a pool property on the pool-enabled data source.
                        </p>
                        <p>The <code class="codeph">setSQLForValidateConnection</code> property must be set when using non-Oracle drivers. UCP uses this property to determine whether or not a connection is valid before recycling the connection.
                        </p>
                        <p>The following example demonstrates recycling a connection pool:</p><pre class="oac_no_warn" dir="ltr">mgr.recycleConnectionPool("mgr_pool");
</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="validating-ucp-connections.html#GUID-A7C850D6-4026-4629-BCFA-9181C29EFBF9">Overview of Validating Connections in UCP</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="JJUCP8193"></a><div class="props_rev_3"><a id="GUID-D557F1BD-95E6-4C57-80B3-4B3A28AC2530" name="GUID-D557F1BD-95E6-4C57-80B3-4B3A28AC2530"></a><h4 id="JJUCP-GUID-D557F1BD-95E6-4C57-80B3-4B3A28AC2530" class="sect4"><span class="enumeration_section">7.1.4.3 </span>Purging a Connection Pool
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d6328e735" class="indexterm-anchor"></a><a id="d6328e739" class="indexterm-anchor"></a><a id="d6328e741" class="indexterm-anchor"></a><a id="d6328e745" class="indexterm-anchor"></a>Purging a connection pool removes every connection (available and borrowed) from the connection pool and leaves the connection pool empty. Subsequent requests for a connection result in a new connection being created. The manager's <code class="codeph">purgeConnectionPool</code> method purges a connection pool using the pool name as a parameter to determine which pool to purge. The pool name is defined as a pool property on the pool-enabled data source.
                        </p>
                        <p>The following example demonstrates purging a connection pool:</p><pre class="oac_no_warn" dir="ltr">mgr.purgeConnectionPool("mgr_pool");
</pre><div class="infoboxnote" id="GUID-D557F1BD-95E6-4C57-80B3-4B3A28AC2530__GUID-C8BD1940-89C4-4497-A5C9-8AB8CDD6AB4B">
                           <p class="notep1">Note:</p>
                           <p>Connection pool properties, such as <code class="codeph">minPoolSize</code> and <code class="codeph">initialPoolSize</code>, may not be enforced after a connection pool is purged.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>