<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>LAST_VALUE</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Language Reference ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Language Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-language-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T15:36:36-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96310-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="LAST_DAY.html" title="Previous" type="text/html">
      <link rel="next" href="LEAD.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Language Reference">
    <meta name="dcterms.isVersionOf" content="SQLRF">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="LAST_DAY.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="LEAD.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Language Reference </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="Functions.html" property="item" typeof="WebPage"><span property="name">Functions</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">LAST_VALUE </li>
            </ol>
            <a id="GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79" name="GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79"></a><a id="SQLRF51471"></a><a id="SQLRF51472"></a><a id="SQLRF51473"></a><a id="SQLRF00655"></a>
            
            <h2 id="SQLRF-GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79" class="sect2">LAST_VALUE </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79__GUID-E2BA8FB9-F394-46DE-A5B0-5FDA8CBECAFE">Syntax</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="figure" id="GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79__GUID-0E570F74-AE2F-475A-BDDD-86D9F511378B"><img src="img/last_value.gif" alt="Description of last_value.eps follows" title="Description of last_value.eps follows" longdesc="img_text/last_value.html"><br><a href="img_text/last_value.html">Description of the illustration last_value.eps</a></div>
                  <!-- class="figure" -->
                  <div class="infoboxnotealso" id="GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79__GUID-4A15F5D6-A37A-44F9-AFA6-D885A4E3141E">
                     <p class="notep1">See Also:</p>
                     <p><span class="q">"<a href="Analytic-Functions.html#GUID-527832F7-63C0-4445-8C16-307FA5084056">Analytic Functions</a>"</span> for information on syntax, semantics, and restrictions, including valid forms of <span class="italic"><code class="codeph">expr</code></span></p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79__GUID-8D0611A4-6988-45E7-8DD4-D889E6C5BCC0">Purpose</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p><code class="codeph">LAST_VALUE</code> is an analytic function that is useful for data densification. It returns the last value in an ordered set of values. 
                  </p>
                  <div class="infoboxnote" id="GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79__GUID-5A7A0627-DE97-4D03-B43C-B379A92E4EEC">
                     <p class="notep1">Note:</p>
                     <p>The two forms of this syntax have the same behavior. The top branch is the ANSI format, which Oracle recommends for ANSI compatibility.</p>
                  </div>
                  <p>{<code class="codeph">RESPECT</code> | <code class="codeph">IGNORE</code>} <code class="codeph">NULLS</code> determines whether null values of <span class="italic"><code class="codeph">expr</code></span> are included in or eliminated from the calculation. The default is <code class="codeph">RESPECT</code> <code class="codeph">NULLS</code>. If the last value in the set is null, then the function returns <code class="codeph">NULL</code> unless you specify <code class="codeph">IGNORE</code> <code class="codeph">NULLS</code>. If you specify <code class="codeph">IGNORE NULLS</code>, then <code class="codeph">LAST_VALUE</code> returns the last non-null value in the set, or <code class="codeph">NULL</code> if all values are null. Refer to <span class="q">"<a href="SELECT.html#GUID-CFA006CA-6FF1-4972-821E-6996142A51C6__I2177515">Using Partitioned Outer Joins: Examples</a>"</span> for an example of data densification.
                  </p>
                  <p>You cannot nest analytic functions by using <code class="codeph">LAST_VALUE</code> or any other analytic function for <span class="italic"><code class="codeph">expr</code></span>. However, you can use other built-in function expressions for <span class="italic"><code class="codeph">expr</code></span>. Refer to <span class="q">"<a href="About-SQL-Expressions.html#GUID-68789A5C-B142-496F-ADEE-837F75F95B2B">About SQL Expressions</a>"</span> for information on valid forms of <span class="italic"><code class="codeph">expr</code></span>.
                  </p>
                  <p>If you omit the <span class="italic"><code class="codeph">windowing_clause</code></span> of the <span class="italic"><code class="codeph">analytic_clause</code></span>, it defaults to <code class="codeph">RANGE</code> <code class="codeph">BETWEEN</code> <code class="codeph">UNBOUNDED</code> <code class="codeph">PRECEDING</code> <code class="codeph">AND</code> <code class="codeph">CURRENT</code> <code class="codeph">ROW</code>. This default sometimes returns an unexpected value, because the last value in the window is at the bottom of the window, which is not fixed. It keeps changing as the current row changes. For expected results, specify the <span class="italic"><code class="codeph">windowing_clause</code></span> as <code class="codeph">RANGE</code> <code class="codeph">BETWEEN</code> <code class="codeph">UNBOUNDED</code> <code class="codeph">PRECEDING</code> <code class="codeph">AND</code> <code class="codeph">UNBOUNDED</code> <code class="codeph">FOLLOWING</code>. Alternatively, you can specify the <span class="italic"><code class="codeph">windowing_clause</code></span> as <code class="codeph">RANGE</code> <code class="codeph">BETWEEN</code> <code class="codeph">CURRENT</code> <code class="codeph">ROW</code> <code class="codeph">AND</code> <code class="codeph">UNBOUNDED</code> <code class="codeph">FOLLOWING</code>.
                  </p>
                  <div class="infoboxnotealso" id="GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79__GUID-D7B61352-F021-4267-A8A1-20545C698D70">
                     <p class="notep1">See Also:</p>
                     <p>Appendix C in <a href="../nlspg/appendix-C-collation-derivation-and-determination-rules-for-SQL-operations.html#NLSPG-GUID-AFCE41ED-775B-4A00-AF38-C436776AE0C5" target="_blank"><span class="italic">Oracle Database Globalization Support Guide</span></a> for the collation derivation rules, which define the collation assigned to the return value of this function when it is a character value
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79__GUID-C7AAE6F7-30F7-4A78-AC57-7FEDB4C8D174">Examples</p>
                  <p>The following example returns, for each row, the hire date of the employee earning the lowest salary:</p><pre class="oac_no_warn" dir="ltr">SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED
               FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 13-JAN-01
        101 Kochhar                        17000 21-SEP-05 13-JAN-01
        102 De Haan                        17000 13-JAN-01 13-JAN-01</pre><p>This example illustrates the nondeterministic nature of the <code class="codeph">LAST_VALUE</code> function. Kochhar and De Haan have the same salary, so they are in adjacent rows. Kochhar appears first because the rows in the subquery are ordered by <code class="codeph">hire_date</code>. However, if the rows are ordered by hire_<code class="codeph">date</code> in descending order, as in the next example, then the function returns a different value:
                  </p><pre class="oac_no_warn" dir="ltr">SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED
               FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date <span class="bold">DESC</span>);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 21-SEP-05
        102 De Haan                        17000 13-JAN-01 21-SEP-05
        101 Kochhar                        17000 21-SEP-05 21-SEP-05</pre><p>The following two examples show how to make the <code class="codeph">LAST_VALUE</code> function deterministic by ordering on a unique key. By ordering within the function by both salary and the unique key <code class="codeph">employee_id</code>, you can ensure the same result regardless of the ordering in the subquery.
                  </p><pre class="oac_no_warn" dir="ltr">SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC, <span class="bold">employee_id</span> ROWS BETWEEN UNBOUNDED PRECEDING
               AND UNBOUNDED FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 13-JAN-01
        101 Kochhar                        17000 21-SEP-05 13-JAN-01
        102 De Haan                        17000 13-JAN-01 13-JAN-01


SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC, <span class="bold">employee_id</span> ROWS BETWEEN UNBOUNDED PRECEDING
               AND UNBOUNDED FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date <span class="bold">DESC</span>);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 13-JAN-01
        101 Kochhar                        17000 21-SEP-05 13-JAN-01
        102 De Haan                        17000 13-JAN-01 13-JAN-01</pre><p>The following two examples show that the <code class="codeph">LAST_VALUE</code> function is deterministic when you use a logical offset (<code class="codeph">RANGE</code> instead of <code class="codeph">ROWS</code>). When duplicates are found for the <code class="codeph">ORDER</code> <code class="codeph">BY</code> expression, the <code class="codeph">LAST_VALUE</code> is the highest value of <span class="italic"><code class="codeph">expr</code></span>:
                  </p><pre class="oac_no_warn" dir="ltr">SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC <span class="bold">RANGE</span> BETWEEN UNBOUNDED PRECEDING AND
               UNBOUNDED FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 21-SEP-05
        102 De Haan                        17000 13-JAN-01 21-SEP-05
        101 Kochhar                        17000 21-SEP-05 21-SEP-05


SELECT employee_id, last_name, salary, hire_date,
       LAST_VALUE(hire_date)
         OVER (ORDER BY salary DESC <span class="bold">RANGE</span> BETWEEN UNBOUNDED PRECEDING AND
               UNBOUNDED FOLLOWING) AS lv
  FROM (SELECT * FROM employees
          WHERE department_id = 90
          ORDER BY hire_date <span class="bold">DESC</span>);

EMPLOYEE_ID LAST_NAME                     SALARY HIRE_DATE LV
----------- ------------------------- ---------- --------- ---------
        100 King                           24000 17-JUN-03 21-SEP-05
        102 De Haan                        17000 13-JAN-01 21-SEP-05
        101 Kochhar                        17000 21-SEP-05 21-SEP-05</pre></div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>