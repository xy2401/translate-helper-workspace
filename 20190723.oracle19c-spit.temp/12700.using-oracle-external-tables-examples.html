<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Examples using external tables.">
      <meta name="description" content="Examples using external tables.">
      <title>External Tables Examples</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Utilities ">
      <meta property="og:description" content="Examples using external tables.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Utilities">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-utilities.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-04-23T19:07:17-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96081-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="oracle_hdfs-oracle_hive-access-drivers.html" title="Previous" type="text/html">
      <link rel="next" href="other-oracle-utilities.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Utilities">
    <meta name="dcterms.isVersionOf" content="SUTIL">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle_hdfs-oracle_hive-access-drivers.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="other-oracle-utilities.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Utilities </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-external-tables.html" property="item" typeof="WebPage"><span property="name"> External Tables</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">External Tables Examples</li>
            </ol>
            <a id="GUID-03CE63AD-F046-4805-A560-E4CFD7FA8503" name="GUID-03CE63AD-F046-4805-A560-E4CFD7FA8503"></a>
            
            <h2 id="SUTIL-GUID-03CE63AD-F046-4805-A560-E4CFD7FA8503" class="sect2"><span class="enumeration_chapter">18 </span>External Tables Examples
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Examples using external tables.</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-oracle-external-tables-examples.html#GUID-35F897D9-BBD9-4B5F-BE7C-01FE514CFEBE">Using the ORACLE_LOADER Access Driver to Create Partitioned External Tables</a><br>This topic describes using the <code class="codeph">ORACLE_LOADER</code> access driver to create partitioned external tables.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-external-tables-examples.html#GUID-576BF53F-B1F3-4EC4-AE53-006A951163AA">Using the ORACLE_LOADER Access Driver to Create Partitioned Hybrid Tables</a><br>This topic describes using the <code class="codeph">ORACLE_LOADER</code> access driver to create partitioned hybrid tables.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-external-tables-examples.html#GUID-9C61CD54-F59D-4F9F-984A-981DD984EAA7">Using the ORACLE_DATAPUMP Access Driver to Create Partitioned External Tables</a><br>The example in this section shows how to create a subpartitioned external table.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-external-tables-examples.html#GUID-86BD0507-EB88-4705-9321-E86E60021DD6">Using the ORACLE_HDFS Access Driver to Create Partitioned External Tables</a><br>The example provided in this section shows how to create a partitioned external table using the <code class="codeph">ORACLE_HDFS</code> access driver.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-external-tables-examples.html#GUID-74478A87-C89A-47E1-A8BF-DA556A3C2115">Using the ORACLE_HIVE Access Driver to Create Partitioned External Tables</a><br>To create a partitioned external table for an <code class="codeph">ORACLE_HIVE</code> table, you need a partitioned Hive external table.&nbsp;
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-external-tables-examples.html#GUID-9D3ED2AE-192D-435A-833E-97899778929E">Loading LOBs From External Tables</a><br>External tables are particularly useful for loading large numbers of records from a single file, so that each record appears in its own row in the table. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-external-tables-examples.html#GUID-53C71354-FDC0-4CD7-BBF1-2B7327A1A245">Loading CSV Files From External Tables</a><br>This topic provides examples of how to load CSV files from external tables under various conditions. 
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="oracle-external-tables.html#GUID-038ED956-A6EE-4C6D-B7C9-0D406B8088B6">External Tables</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-35F897D9-BBD9-4B5F-BE7C-01FE514CFEBE" name="GUID-35F897D9-BBD9-4B5F-BE7C-01FE514CFEBE"></a><h3 id="SUTIL-GUID-35F897D9-BBD9-4B5F-BE7C-01FE514CFEBE" class="sect3"><span class="enumeration_section">18.1 </span>Using the ORACLE_LOADER Access Driver to Create Partitioned External Tables
               </h3>
               <div>
                  <p>This topic describes using the <code class="codeph">ORACLE_LOADER</code> access driver to create partitioned external tables.
                  </p>
                  <div class="example" id="GUID-35F897D9-BBD9-4B5F-BE7C-01FE514CFEBE__GUID-8454231E-8CBB-4085-ACE5-C46724A0CCE6">
                     <p class="titleinexample">Example 18-1 Using ORACLE_LOADER to Create a Partitioned External Table</p>
                     <p>This example assumes there are four data files with the following content:</p><pre class="pre codeblock"><code>p1a.dat:
1, AAAAA Plumbing,01372,
28, Sparkly Laundry,78907,
13, Andi's Doughnuts,54570,

p1b.dat:
51, DIY Supplies,61614,
87, Fast Frames,22201,
89, Friendly Pharmacy,89901,

p2.dat:
121, Pleasant Pets,33893,
130, Bailey the Bookmonger,99915,
105, Le Bistrot du Chat Noir,94114,

p3.dat:
210, The Electric Eel Diner,07101,
222, Everyt'ing General Store,80118,
231, Big Rocket Market,01754,</code></pre><p>There are three fields in the data file: <code class="codeph">CUSTOMER_NUMBER</code>, <code class="codeph">CUSTOMER_NAME</code> and <code class="codeph">POSTAL_CODE</code>.&nbsp; The external table uses range partitioning on <code class="codeph">CUSTOMER_NUMBER</code> to create three partitions.
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Partition 1 is for <code class="codeph">customer_number</code> less than 100
                           </p>
                        </li>
                        <li>
                           <p>Partition 2 is for <code class="codeph">customer_number</code> less than 200
                           </p>
                        </li>
                        <li>
                           <p>Partition 3 is for <code class="codeph">customer_number</code> less than 300 
                           </p>
                        </li>
                     </ul>
                     <p>Note that the first partition has two data files while the other partitions only have one.&nbsp;The following is the output from SQLPlus for creating the file.</p><pre class="pre codeblock"><code>SQL&gt; create table customer_list_xt
  2    (CUSTOMER_NUMBER number, CUSTOMER_NAME VARCHAR2(50), POSTAL_CODE CHAR(5))
  3  organization external
  4    (type oracle_loader default directory def_dir1)
  5  partition by range(CUSTOMER_NUMBER)
  6  (
  7    partition p1 values less than (100) location('p1a.dat', 'p1b.dat'),
  8    partition p2 values less than (200) location('p2.dat'),
  9    partition p3 values less than (300) location('p3.dat')
 10  );

Table created.
SQL&gt; </code></pre><p>The following is the output from <code class="codeph">SELECT *</code> for the entire table: 
                     </p><pre class="pre codeblock"><code>SQL&gt; select customer_number, customer_name, postal_code
  2    from customer_list_xt
  3    order by customer_number;

CUSTOMER_NUMBER CUSTOMER_NAME                                      POSTA
--------------- -------------------------------------------------- -----
              1  AAAAA Plumbing                                    01372
             13  Andi's Doughnuts                                  54570
             28  Sparkly Laundry                                   78907
             51  DIY Supplies                                      61614
             87  Fast Frames                                       22201
             89  Friendly Pharmacy                                 89901
            105  Le Bistrot du Chat Noir                           94114
            121  Pleasant Pets                                     33893
            130  Bailey the Bookmonger                             99915
            210  The Electric Eel Diner                            07101
            222  Everyt'ing General Store                          80118
            231  Big Rocket Market                                 01754

12 rows selected.

SQL&gt; </code></pre><p>The following query should only read records from the first partition:</p><pre class="pre codeblock"><code>SQL&gt; select customer_number, customer_name, postal_code
  2    from customer_list_xt
  3    where customer_number &lt; 20
  4    order by customer_number;

CUSTOMER_NUMBER CUSTOMER_NAME                                      POSTA
--------------- -------------------------------------------------- -----
              1  AAAAA Plumbing                                    01372
             13  Andi's Doughnuts                                  54570

2 rows selected.

SQL&gt; </code></pre><p>The following query specifies the partition to read as part of the <code class="codeph">SELECT</code> statement.
                     </p><pre class="pre codeblock"><code>SQL&gt; select customer_number, customer_name, postal_code
  2    from customer_list_xt partition (p1)
  3    order by customer_number;

CUSTOMER_NUMBER CUSTOMER_NAME                                      POSTA
--------------- -------------------------------------------------- -----
              1  AAAAA Plumbing                                    01372
             13  Andi's Doughnuts                                  54570
             28  Sparkly Laundry                                   78907
             51  DIY Supplies                                      61614
             87  Fast Frames                                       22201
             89  Friendly Pharmacy                                 89901

6 rows selected.

SQL&gt; </code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-external-tables-examples.html#GUID-03CE63AD-F046-4805-A560-E4CFD7FA8503" title="Examples using external tables.">External Tables Examples</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-576BF53F-B1F3-4EC4-AE53-006A951163AA" name="GUID-576BF53F-B1F3-4EC4-AE53-006A951163AA"></a><h3 id="SUTIL-GUID-576BF53F-B1F3-4EC4-AE53-006A951163AA" class="sect3"><span class="enumeration_section">18.2 </span>Using the ORACLE_LOADER Access Driver to Create Partitioned Hybrid Tables
               </h3>
               <div>
                  <p>This topic describes using the <code class="codeph">ORACLE_LOADER</code> access driver to create partitioned hybrid tables.
                  </p>
                  <div class="section">
                     <p>Hybrid Partitioned Tables is a feature that extends Oracle Partitioning by allowing some partitions to reside in database segments and some partitions in external files or sources. This significantly enhances functionality of partitioning for Big Data SQL where large portions of a table can reside in external partitions.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-576BF53F-B1F3-4EC4-AE53-006A951163AA__GUID-91E1C38E-962C-4CB9-ACE3-324914C166D5">
                     <p class="titleinexample">Example 18-2 Example</p>
                     <p>Here is an example of a statement for creating a partitioned hybrid l table:</p><pre class="pre codeblock"><code>CREATE TABLE hybrid_pt (time_id date, customer number)
  TABLESPACE TS1
  EXTERNAL PARTITION ATTRIBUTES (TYPE ORACLE_LOADER 
                                 DEFAULT DIRECTORY data_dir0
                                 ACCESS PARAMETERS(FIELDS TERMINATED BY ',')
                                 REJECT LIMIT UNLIMITED) 
PARTITION by range (time_id)
(
 PARTITION century_18 VALUES LESS THAN ('01-01-1800')
    EXTERNAL,                                                 &lt;-- empty external partition
  PARTITION century_19 VALUES LESS THAN ('01-01-1900')
    EXTERNAL DEFAULT DIRECTORY data_dir1 LOCATION (‘century19_data.txt'),
  PARTITION century_20 VALUES LESS THAN ('01-01-2000') 
    EXTERNAL LOCATION (‘century20_data.txt'),
  PARTITION year_2000 VALUES LESS THAN ('01-01-2001') TABLESPACE TS2,
  PARTITION pmax VALUES LESS THAN (MAXVALUE)
);
</code></pre><p>In this example, the table contains both internal and external partitions.  The default tablespace for internal partitions in the table is <code class="codeph">TS1</code>. An <code class="codeph">EXTERNAL PARTITION ATTRIBUTES</code> clause is added for specifying parameters that apply, at the table level, to the external partitions in the table. The clause is mandatory for hybrid partitioned tables. In this case, external partitions are accessed through the <code class="codeph">ORACLE_LOADER</code> access driver, and the parameters required by the access driver are specified in the clause. At the partition level, an <code class="codeph">EXTERNAL</code> clause is specified in each external partition, along with any external parameters applied to the partition. 
                     </p>
                     <p>In this example, <code class="codeph">century_18</code>, <code class="codeph">century_19</code>, and <code class="codeph">century_20</code> are external partitions. <code class="codeph">century_18</code>  is an empty partition since it does not contain a location. The default directory for partition <code class="codeph">century_19</code> is<code class="codeph">data_dir1</code>, overriding the table level default directory. The partition has a location <code class="codeph">data_dir1:century19_data.txt</code>. Partition<code class="codeph">century_20</code> has location <code class="codeph">data_dir0:century20_data.txt</code>, since the table level default directory is applied to a location when a default directory is not specified in a partition. Partitions <code class="codeph">year_2000</code> and <code class="codeph">pmax</code> are internal partitions. Partition <code class="codeph">year_2000</code>has a <code class="codeph">tablespace TS2</code>. When a partition has no<code class="codeph">EXTERNAL</code> clause or external parameters specified in it, it is assumed to be an internal partition by default.  
                     </p>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-external-tables-examples.html#GUID-03CE63AD-F046-4805-A560-E4CFD7FA8503" title="Examples using external tables.">External Tables Examples</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-9C61CD54-F59D-4F9F-984A-981DD984EAA7" name="GUID-9C61CD54-F59D-4F9F-984A-981DD984EAA7"></a><h3 id="SUTIL-GUID-9C61CD54-F59D-4F9F-984A-981DD984EAA7" class="sect3"><span class="enumeration_section">18.3 </span>Using the ORACLE_DATAPUMP Access Driver to Create Partitioned External Tables
               </h3>
               <div>
                  <p>The example in this section shows how to create a subpartitioned external table.</p>
                  <p>It also shows how to use a virtual column to partition the table.</p>
                  <div class="example" id="GUID-9C61CD54-F59D-4F9F-984A-981DD984EAA7__GUID-211C0AFA-57A4-4F6C-A53E-B2EC777EF686">
                     <p class="titleinexample">Example 18-3 Using the ORACLE_DATAPUMP Access Driver to Create Partitioned External Tables</p>
                     <p> In this example, the dump files used are the same as those created in the previous example using the <code class="codeph">ORACLE_LOADER</code> access driver. However, in this example, in addition to partitioning the data using <code class="codeph">customer_number</code>, the data is subpartitioned using <code class="codeph">postal_code</code>.&nbsp; For every partition, there is a subpartition where the<code class="codeph"> postal_code</code> is less than 50000 and another subpartition for all other values of <code class="codeph">postal_code</code>.&nbsp; With three partitions, each containing two subpartitions, a total of six files is required.&nbsp;To create the files, use the SQL <code class="codeph">CREATE TABLE AS SELECT</code> statement to select the correct rows for the partition and then write those rows into the file for the <code class="codeph">ORACLE_DATAPUMP</code> driver.
                     </p>
                     <p>The following statement creates a file with data for the first subpartition (<code class="codeph">postal_code</code> less than 50000) of partition <code class="codeph">p1</code> (<code class="codeph">customer_number</code> less than 100).
                     </p><pre class="pre codeblock"><code>SQL&gt; create table customer_list_dp_p1_sp1_xt
  2  organization external
  3    (type oracle_datapump default directory def_dir1 location('p1_sp1.dmp'))
  4  as
  5    select customer_number, customer_name, postal_code
  6      from customer_list_xt partition (p1)
  7      where to_number(postal_code) &lt; 50000;

Table created.

SQL&gt; </code></pre><p>This statement creates a file with data for the second subpartition (all other values for postal_code) of partition <code class="codeph">p1</code> (customer_number less than 100).
                     </p><pre class="pre codeblock"><code>SQL&gt; create table customer_list_dp_p1_sp2_xt
  2  organization external
  3    (type oracle_datapump default directory def_dir1 location('p1_sp2.dmp'))
  4  as
  5    select customer_number, customer_name, postal_code
  6      from customer_list_xt partition (p1)
  7      where to_number(postal_code) &gt;= 50000;

Table created. </code></pre><p>The files for other partitions are created in a similar fashion, as follows:</p><pre class="pre codeblock"><code>SQL&gt; create table customer_list_dp_p2_sp1_xt
  2  organization external
  3    (type oracle_datapump default directory def_dir1 location('p2_sp1.dmp'))
  4  as
  5    select customer_number, customer_name, postal_code
  6      from customer_list_xt partition (p2)
  7      where to_number(postal_code) &lt; 50000;

Table created.

SQL&gt;
SQL&gt; create table customer_list_dp_p2_sp2_xt
  2  organization external
  3    (type oracle_datapump default directory def_dir1 location('p2_sp2.dmp'))
  4  as
  5    select customer_number, customer_name, postal_code
  6      from customer_list_xt partition (p2)
  7      where to_number(postal_code) &gt;= 50000;

Table created.

SQL&gt;
SQL&gt; create table customer_list_dp_p3_sp1_xt
  2  organization external
  3    (type oracle_datapump default directory def_dir1 location('p3_sp1.dmp'))
  4  as
  5    select customer_number, customer_name, postal_code
  6      from customer_list_xt partition (p3)
  7      where to_number(postal_code) &lt; 50000;

Table created.

SQL&gt;
SQL&gt; create table customer_list_dp_p3_sp2_xt
  2  organization external
  3    (type oracle_datapump default directory def_dir1 location('p3_sp2.dmp'))
  4  as
  5    select customer_number, customer_name, postal_code
  6      from customer_list_xt partition (p3)
  7      where to_number(postal_code) &gt;= 50000;

Table created.

SQL&gt;
</code></pre><p>You can select from each of these external tables to verify that it has the data you intended to write out.&nbsp; After you have executed the SQL<code class="codeph"> CREATE TABLE AS SELECT</code> statement, you can drop these external tables.
                     </p>
                     <p>To use a virtual column to partition the table, create the partitioned <code class="codeph">ORACLE_DATAPUMP</code> table.&nbsp; Again, the table is partitioned on the <code class="codeph">customer_number</code> column and subpartitioned on the <code class="codeph">postal_code</code> column. The <code class="codeph">postal_code</code> column is a character field that contains numbers, but this example partitions it based on the numeric value, not a character string.&nbsp; In order to do this, create a virtual column, <code class="codeph">postal_code_num,</code> whose value is the <code class="codeph">postal_code</code> field converted to a <code class="codeph">NUMBER</code> data type.&nbsp; The <code class="codeph">SUBPARTITION</code> clause uses the virtual column to determine the subpartition for the row.
                     </p><pre class="pre codeblock"><code>SQL&gt; create table customer_list_dp_xt
  2  (customer_number    number,
  3   CUSTOMER_NAME      VARCHAR2(50),
  4   postal_code        CHAR(5),
  5   postal_code_NUM    as (to_number(postal_code)))
  6  organization external
  7    (type oracle_datapump default directory def_dir1)
  8  partition by range(customer_number)
  9  subpartition by range(postal_code_NUM)
 10  (
 11    partition p1 values less than (100)
 12     (subpartition p1_sp1 values less than (50000) location('p1_sp1.dmp'),
 13      subpartition p1_sp2 values less than (MAXVALUE) location('p1_sp2.dmp')),
 14    partition p2 values less than (200)
 15     (subpartition p2_sp1 values less than (50000) location('p2_sp1.dmp'),
 16      subpartition p2_sp2 values less than (MAXVALUE) location('p2_sp2.dmp')),
 17    partition p3 values less than (300)
 18     (subpartition p3_sp1 values less than (50000) location('p3_sp1.dmp'),
 19      subpartition p3_sp2 values less than (MAXVALUE) location('p3_sp2.dmp'))
 20  );

Table created.

SQL&gt; </code></pre><p>If you select all rows, then the data returned is the same as was returned in the previous example using the <code class="codeph">ORACLE_LOADER</code> access driver.
                     </p><pre class="pre codeblock"><code>SQL&gt; select customer_number, customer_name, postal_code
  2    from customer_list_dp_xt
  3    order by customer_number;

customer_number CUSTOMER_NAME                                      POSTA
--------------- -------------------------------------------------- -----
              1  AAAAA Plumbing                                    01372
             13  Andi's Doughnuts                                  54570
             28  Sparkly Laundry                                   78907
             51  DIY Supplies                                      61614
             87  Fast Frames                                       22201
             89  Friendly Pharmacy                                 89901
            105  Le Bistrot du Chat Noir                           94114
            121  Pleasant Pets                                     33893
            130  Bailey the Bookmonger                             99915
            210  The Electric Eel Diner                            07101
            222  Everyt'ing General Store                          80118
            231  Big Rocket Market                                 01754

12 rows selected.

SQL&gt; </code></pre><p>The <code class="codeph">WHERE</code> clause can limit the rows read to a subpartition. The following query should only read the first subpartition of the first partition.
                     </p><pre class="pre codeblock"><code>SQL&gt; select customer_number, customer_name, postal_code
  2    from customer_list_dp_xt
  3    where customer_number &lt; 20 and postal_code_NUM &lt; 39998
  4    order by customer_number;

customer_number CUSTOMER_NAME                                      POSTA
--------------- -------------------------------------------------- -----
              1  AAAAA Plumbing                                    01372

1 row selected.

SQL&gt; </code></pre><p>You could also specify a specific subpartition in the query, as follows:</p><pre class="pre codeblock"><code>SQL&gt; select customer_number, customer_name, postal_code
  2    from customer_list_dp_xt subpartition (p2_sp2) order by customer_number;

customer_number CUSTOMER_NAME                                      POSTA
--------------- -------------------------------------------------- -----
            105  Le Bistrot du Chat Noir                           94114
            130  Bailey the Bookmonger                             99915

2 rows selected.

SQL&gt; </code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-external-tables-examples.html#GUID-03CE63AD-F046-4805-A560-E4CFD7FA8503" title="Examples using external tables.">External Tables Examples</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-86BD0507-EB88-4705-9321-E86E60021DD6" name="GUID-86BD0507-EB88-4705-9321-E86E60021DD6"></a><h3 id="SUTIL-GUID-86BD0507-EB88-4705-9321-E86E60021DD6" class="sect3"><span class="enumeration_section">18.4 </span>Using the ORACLE_HDFS Access Driver to Create Partitioned External Tables
               </h3>
               <div>
                  <p>The example provided in this section shows how to create a partitioned external table using the <code class="codeph">ORACLE_HDFS</code> access driver.
                  </p>
                  <div class="example" id="GUID-86BD0507-EB88-4705-9321-E86E60021DD6__GUID-24FA0C40-104A-44AD-97C1-243D86E2BCA6">
                     <p class="titleinexample">Example 18-4 Using the ORACLE_HDFS Access Driver to Create Partitioned External Tables</p>
                     <p>In this example there are four data files stored in HDFS directory path <code class="codeph">"hdfs_pet/"</code>.&nbsp;
                     </p><pre class="pre codeblock"><code>p1a.dat
1, AAAAA Plumbing,01372,
28, Sparkly Laundry,07101,
13, Andi'''s Doughnuts,01372,

p1b.dat
51, DIY Supplies,07101,
87, Fast Frames,01754,
89, Friendly Pharmacy,01372,

p2.dat
121, Pleasant Pets,01754,
130, Bailey the Bookmonger,01754,
105, Le Bistrot du Chat Noir,01754,

p3.dat
210, The Electric Eel Diner,07101,
222, Everyt'ing General Store,01372,
231, Big Rocket Market,01754,
</code></pre><p>For the purposes of this example, the data files are written to the HDFS directory using the following:</p><pre class="pre codeblock"><code>hadoop dfs -mkdir hdfs_pet
hadoop dfs -put p1a.dat hdfs_pet/p1a.dat
hadoop dfs -put p1b.dat hdfs_pet/p1b.dat
hadoop dfs -put p2.dat hdfs_pet/p2.dat
hadoop dfs -put p3.dat hdfs_pet/p3.dat
</code></pre><p>The following is the<code class="codeph"> CREATE TABLE</code> command to create the partitioned external table:
                     </p><pre class="pre codeblock"><code>create table customer_list_hdfs
  (CUSTOMER_NUMBER number, CUSTOMER_NAME VARCHAR2(50), POSTAL_CODE CHAR(5))
organization external
  (type oracle_hdfs
   default directory def_dir1
   access parameters
   (com.oracle.bigdata.cluster   = hadoop_cl_1
    com.oracle.bigdata.rowformat = delimited fields terminated by ','))
partition by range(CUSTOMER_NUMBER)
(
  partition p1 values less than (100) location('hdfs_pet/p1a.dat', 'hdfs_pet/p1b.dat'),
  partition p2 values less than (200) location('hdfs_pet/p2.dat'),
  partition p3 values less than (300) location('hdfs_pet/p3.dat')
); </code></pre><p>The following query shows a <code class="codeph">SELECT</code> operation from the external table:
                     </p><pre class="pre codeblock"><code>SQL&gt; select * from customer_list_hdfs order by customer_number;

CUSTOMER_NUMBER CUSTOMER_NAME                                      POSTA
--------------- -------------------------------------------------- -----
              1  AAAAA Plumbing                                    01372
             13  Andi's Doughnuts                                  01372
             28  Sparkly Laundry                                   07101
             51  DIY Supplies                                      07101
             87  Fast Frames                                       01754
             89  Friendly Pharmacy                                 01372
            105  Le Bistrot du Chat Noir                           01754
            121  Pleasant Pets                                     01754
            130  Bailey the Bookmonger                             01754
            210  The Electric Eel Diner                            07101
            222  Everyt'ing General Store                          01372
            231  Big Rocket Market                                 01754

12 rows selected.

SQL&gt; </code></pre><p>You can also execute queries with a <code class="codeph">WHERE</code> clause that excludes partitions that cannot match the conditions in the <code class="codeph">WHERE</code> clause from being read, as follows:
                     </p><pre class="pre codeblock"><code>SQL&gt; select customer_number, customer_name, postal_code
  2    from customer_list_hdfs
  3    where customer_number &lt; 20
  4    order by customer_number;

CUSTOMER_NUMBER CUSTOMER_NAME                                      POSTA
--------------- -------------------------------------------------- -----
              1  AAAAA Plumbing                                    01372
             13  Andi's Doughnuts                                  01372

2 rows selected.

SQL&gt; </code></pre><p>You could also specify the partition you want to read as part of the <code class="codeph">FROM</code> clause, as shown in the following: 
                     </p><pre class="pre codeblock"><code>SQL&gt; select customer_number, customer_name, postal_code
  2    from customer_list_hdfs partition (p3)
  3    order by customer_number;

CUSTOMER_NUMBER CUSTOMER_NAME                                      POSTA
--------------- -------------------------------------------------- -----
            210  The Electric Eel Diner                            07101
            222  Everyt'ing General Store                          01372
            231  Big Rocket Market                                 01754

3 rows selected.

SQL&gt; </code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-external-tables-examples.html#GUID-03CE63AD-F046-4805-A560-E4CFD7FA8503" title="Examples using external tables.">External Tables Examples</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-74478A87-C89A-47E1-A8BF-DA556A3C2115" name="GUID-74478A87-C89A-47E1-A8BF-DA556A3C2115"></a><h3 id="SUTIL-GUID-74478A87-C89A-47E1-A8BF-DA556A3C2115" class="sect3"><span class="enumeration_section">18.5 </span>Using the ORACLE_HIVE Access Driver to Create Partitioned External Tables
               </h3>
               <div>
                  <p>To create a partitioned external table for an <code class="codeph">ORACLE_HIVE</code> table, you need a partitioned Hive external table.&nbsp;
                  </p>
                  <p>Then you need to use the PL/SQL procedure <code class="codeph">DBMS_HADOOP.CREATE_EXTDDL_FOR_HIVE()</code>. Additionally, this example creates the partitioned Hive table from the HDFS files used in the previous example. Before the partitioned Hive table can be created, you must create an HDFS directory in which to store the data.
                  </p>
                  <div class="example" id="GUID-74478A87-C89A-47E1-A8BF-DA556A3C2115__GUID-E076E76E-EEEA-43DE-AD7B-CE53F94909D1">
                     <p class="titleinexample">Example 18-5 Using the ORACLE_HIVE Access Driver to Create Partitioned External Tables</p>
                     <p>This examples creates the Hive table using the data files from the previous example showing how to use <code class="codeph">ORACLE_HDFS</code> to create partitioned external tables.. The following commands are all performed inside of the Hive CLI so they use Hive syntax.
                     </p>
                     <p>First, use Hive to create a Hive external table on top of the HDFS data files, as follows:</p><pre class="pre codeblock"><code>create external table customer_list_no_part ( customer_number int,
                                              customer_name   string,
                                              postal_code string)
 row format delimited fields terminated by ','
 stored as textfile
 location '/user/doc/hdfs_pet'</code></pre><p>Then execute the following commands to tell Hive to create the partitions dynamically:</p><pre class="pre codeblock"><code>set hive.exec.dynamic.partition=true
set hive.exec.dynamic.partition.mode=nonstrict
</code></pre><p>Create the partitioned Hive table:</p><pre class="pre codeblock"><code>create table customer_list( CUSTOMER_NUMBER int,
                            CUSTOMER_NAME   string)
 partitioned by (postal_code string)
 row format delimited
 fields terminated by '\t'
 location '/user/doc/doc_pet'</code></pre><p>Populate the hive table with data from table <code class="codeph">customer_list_no_part</code>.&nbsp; This should create the files for each partition with the correct rows.
                     </p><pre class="pre codeblock"><code>insert overwrite table customer_list partition (postal_code) select * from customer_list_no_part</code></pre><p>The Hive <code class="codeph">customer_list</code> table is populated with the rows. as shown in the following query:
                     </p><pre class="pre codeblock"><code>select * from customer_list order by customer_number
1     AAAAA Plumbing    01372
13     Andi's Doughnuts    01372
28     Sparkly Laundry    07101
51     DIY Supplies    07101
87     Fast Frames    01754
89     Friendly Pharmacy    01372
105     Le Bistrot du Chat Noir    01754
121     Pleasant Pets    01754
130     Bailey the Bookmonger    01754
210     The Electric Eel Diner    07101
222     Everyt'ing General Store    01372
231     Big Rocket Market    01754
</code></pre><p>Now you can go back to SQL*Plus to create the partitioned external table inside the Oracle database. First, use PL/SQL function <code class="codeph">DBMS_HADOOP.CREATE_EXTDDL_FOR_HIVE()</code> to create the external table. The arguments are as follows:
                     </p>
                     <ol>
                        <li>
                           <p>the name of the Hadoop cluster</p>
                        </li>
                        <li>
                           <p>the name of the Hive user that owns the table</p>
                        </li>
                        <li>
                           <p>the name of the partitioned Hive table</p>
                        </li>
                        <li>
                           <p>a boolean value indicating whether you want the partition columns in the Hive table to be included as columns in the external table</p>
                        </li>
                        <li>
                           <p>the name of the partitioned <code class="codeph">ORACLE_HIVE</code> table that is created
                           </p>
                        </li>
                        <li>
                           <p>a boolean value indicating whether the <code class="codeph">CREATE</code> DDL is executed
                           </p>
                        </li>
                        <li>
                           <p>a <code class="codeph">CLOB</code> contains the <code class="codeph">CREATE</code> DDL string
                           </p>
                        </li>
                     </ol>
                     <p>This example gets the <code class="codeph">CLOB</code> for the <code class="codeph">CREATE</code> DDL string and uses the <code class="codeph">DBMS_OUTPUT.PUT_LINE()</code> procedure to write it.&nbsp; Setting <code class="codeph">SERVEROUTPUT ON</code> tells SQL*Plus to display the data from the <code class="codeph">DBMS_OUTPUT.PUT_LINE()</code> procedure.&nbsp; Setting <code class="codeph">LINESIZE</code> to 132 makes sure there are no line breaks at odd places when displaying the data from the <code class="codeph">DBMS_OUTPUT.PUT_LINE()</code> procedure.
                     </p><pre class="pre codeblock"><code>SQL&gt; SET LINESIZE 132
SQL&gt; SET SERVEROUTPUT ON
SQL&gt;
SQL&gt; DECLARE
  2    DDLtxt clob;
  3  BEGIN
  4    dbms_hadoop.create_extddl_for_hive
  5     ('hadoop_cl_1', 'default', 'customer_list',
  6      TRUE, 'CUSTOMER_LIST_HIVE', TRUE, DDLtxt);
  7    dbms_output.put_line('DDL Text is :  ' || DDLtxt);
  8  END;
  9  /
External table successfully created.
DDL Text is :  CREATE TABLE "DOC"."CUSTOMER_LIST_HIVE" (customer_number NUMBER, customer_name VARCHAR2(4000), postal_code
VARCHAR2(4000))  ORGANIZATION EXTERNAL
 (TYPE ORACLE_HIVE
 DEFAULT DIRECTORY DEFAULT_DIR
 ACCESS PARAMETERS
(
com.oracle.bigdata.cluster=hadoop_cl_1
com.oracle.bigdata.tablename=default.customer_list)
) REJECT LIMIT UNLIMITED
PARTITION BY
LIST (postal_code)
(
PARTITION "P_293620257" VALUES ('01372'),
PARTITION "P_292175793" VALUES ('01754'),
PARTITION "P_717839126"
VALUES ('07101')
)
</code></pre><p>Because Hive does not specify a maximum character count for <code class="codeph">STRING</code> columns, the column definition for the external table is <code class="codeph">VARCHAR2(4000)</code>.&nbsp; If you want a smaller length for some columns, you can call the <code class="codeph">DBMS_HADOOP.CREATE_EXTDDL_FOR_HIVE()</code> procedure and specify that you do not want to execute the <code class="codeph">CREATE</code> DDL.&nbsp; Then, you can edit the <code class="codeph">CREATE</code> statement returned in the <code class="codeph">CLOB</code> to set the length of the <code class="codeph">VARCHAR2</code> columns to a more appropriate value.
                     </p>
                     <p>Also, note that the numbers in the partition name can vary.</p>
                     <p>Now that the table is created, executing a <code class="codeph">SELECT *</code> statement returns all of the rows.&nbsp; Note that the <code class="codeph">SET LINESIZE</code> executed above means that SQL*Plus uses 132 character for <code class="codeph">customer_name</code> and <code class="codeph">postal_code</code>.
                     </p><pre class="pre codeblock"><code>SQL&gt; select * from customer_list_hive order by customer_number;

CUSTOMER_NUMBER
---------------
CUSTOMER_NAME
------------------------------------------------------------------------------------------------------------------------------POSTAL_CODE
------------------------------------------------------------------------------------------------------------------------------              1
 AAAAA Plumbing
01372

             13
 Andi's Doughnuts
01372

             28
 Sparkly Laundry
07101

             51
 DIY Supplies
07101

             87
 Fast Frames
01754

             89
 Friendly Pharmacy
01372

            105
 Le Bistrot du Chat Noir
01754

            121
 Pleasant Pets
01754

            130
 Bailey the Bookmonger
01754

            210
 The Electric Eel Diner
07101

            222
 Everyt'ing General Store
01372

            231
 Big Rocket Market
01754


12 rows selected.

SQL&gt;
</code></pre><p>SQL execution uses the partition information to prune partitions that do not match the criteria in the <code class="codeph">WHERE</code> clause.
                     </p><pre class="pre codeblock"><code>SQL&gt; select customer_number, customer_name, postal_code
  2    from customer_list_hive
  3    where postal_code = '01754'
  4    order by customer_number;

CUSTOMER_NUMBER
---------------
CUSTOMER_NAME
------------------------------------------------------------------------------------------------------------------------------POSTAL_CODE
------------------------------------------------------------------------------------------------------------------------------             87
 Fast Frames
01754

            105
 Le Bistrot du Chat Noir
01754

            121
 Pleasant Pets
01754

            130
 Bailey the Bookmonger
01754

            231
 Big Rocket Market
01754


5 rows selected.

SQL&gt; </code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-external-tables-examples.html#GUID-03CE63AD-F046-4805-A560-E4CFD7FA8503" title="Examples using external tables.">External Tables Examples</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-9D3ED2AE-192D-435A-833E-97899778929E" name="GUID-9D3ED2AE-192D-435A-833E-97899778929E"></a><h3 id="SUTIL-GUID-9D3ED2AE-192D-435A-833E-97899778929E" class="sect3"><span class="enumeration_section">18.6 </span>Loading LOBs From External Tables
               </h3>
               <div>
                  <p>External tables are particularly useful for loading large numbers of records from a single file, so that each record appears in its own row in the table. </p>
                  <p>The following example shows how to perform such a load.</p>
                  <div class="example" id="GUID-9D3ED2AE-192D-435A-833E-97899778929E__GUID-EF085643-5699-4DAE-BCF2-2E8F3F5FEA3F">
                     <p class="titleinexample">Example 18-6 Loading LOBs From External Tables</p>
                     <p>Suppose you define an external table, <code class="codeph">my_ext_table</code>, as follows:
                     </p><pre class="pre codeblock"><code>CREATE TABLE my_ext_table ( id NUMBER, author VARCHAR2(30), created DATE, text CLOB )
ORGANIZATION EXTERNAL (
  TYPE ORACLE_LOADER
  DEFAULT DIRECTORY MY_DIRECTORY
  ACCESS PARAMETERS (
    RECORDS DELIMITED BY 0x'0A'
    FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
      ( id         CHAR(10),
        author     CHAR(30),
        created    DATE "YYYY-MM-DD",
        text       CHAR(131071)
      )
    )
    LOCATION (
      MY_DIRECTORY:'external.dmp'
    )
);</code></pre><p>The contents of the <code class="codeph">external.dmp</code> file are as follows:
                     </p><pre class="pre codeblock"><code>1,Roger,2015-08-08,The quick brown fox jumps over the lazy dog
2,John,2012-01-01,"The angry aligator, acting alone, ate the antelope"</code></pre><p>The second line in the dump file requires quotation marks around the full text string; otherwise the field would be terminated at the comma. </p>
                     <div class="infoboxnote" id="GUID-9D3ED2AE-192D-435A-833E-97899778929E__GUID-84640F47-FADD-4A35-9E3F-897EC97E8DED">
                        <p class="notep1">Note:</p>Although not a problem in the dump file being used in this example, if something in the full text string contained quotation marks, then you would enclose it in another set of quotation marks, as follows for the word <code class="codeph">alone</code>: <pre class="pre codeblock"><code>2,John,2012-01-01,"The angry aligator, acting ""alone"", ate the antelope"</code></pre></div>
                     <p>If the full text might contain the record delimiter character (0x'0A', or newline), you can specify a separate file for each document. External tables do not support filler fields, so instead you must use a<code class="codeph"> COLUMN TRANSFORMS</code> clause to specify that the <code class="codeph">fname</code> field contains the name of the external file:
                     </p><pre class="pre codeblock"><code>DROP TABLE my_ext_table2;

CREATE TABLE my_ext_table2 ( id NUMBER, author VARCHAR2(30), created DATE, text CLOB )
ORGANIZATION EXTERNAL (
  TYPE ORACLE_LOADER
  DEFAULT DIRECTORY MY_DIRECTORY
  ACCESS PARAMETERS (
    RECORDS DELIMITED BY 0x'0A'
    FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
      ( id         CHAR(10),
        author     CHAR(30),
        created    DATE "YYYY-MM-DD",
        fname      char(100)
      )
    COLUMN TRANSFORMS (text FROM LOBFILE(fname) FROM (MY_DIRECTORY) )
    )
    LOCATION (
      'loader.txt'
    )
);

</code></pre><div class="infoboxnote" id="GUID-9D3ED2AE-192D-435A-833E-97899778929E__GUID-291A6B42-90F6-40D4-84CD-3ECE64ED9724">
                        <p class="notep1">Note:</p>The <code class="codeph">FROM (MY_DIRECTORY)</code> clause is not actually necessary since it has already been specified as the default directory. However it is being shown here for example purposes because if the <code class="codeph">loader.txt</code> file and the individual CLOB files were in different locations, it would be needed.
                     </div>
                     <p>Once the data is in an external table, you can either leave it there and perform normal table operations (DML and most DDL) on the external table,&nbsp; or you can use the external table as a staging table to get the data into a normal table. To create a new normal (non-external) table, you could use the following SQL statement:</p><pre class="pre codeblock"><code>CREATE TABLE <span class="variable" translate="no">normaltable</span> AS SELECT * FROM <span class="variable" translate="no">externaltable</span>;</code></pre><p>You can similarly use the following SQL statement to insert data into the new normal table:</p><pre class="pre codeblock"><code>INSERT INTO <span class="variable" translate="no">normaltable</span> AS SELECT * FROM <span class="variable" translate="no">externaltable</span>;</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-external-tables-examples.html#GUID-03CE63AD-F046-4805-A560-E4CFD7FA8503" title="Examples using external tables.">External Tables Examples</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-53C71354-FDC0-4CD7-BBF1-2B7327A1A245" name="GUID-53C71354-FDC0-4CD7-BBF1-2B7327A1A245"></a><h3 id="SUTIL-GUID-53C71354-FDC0-4CD7-BBF1-2B7327A1A245" class="sect3"><span class="enumeration_section">18.7 </span>Loading CSV Files From External Tables
               </h3>
               <div>
                  <p>This topic provides examples of how to load CSV files from external tables under various conditions. </p>
                  <p>Some of the examples build on previous examples.</p>
                  <div class="example" id="GUID-53C71354-FDC0-4CD7-BBF1-2B7327A1A245__GUID-FDD5DCDC-60AA-4AF0-8ED6-79520875DB44">
                     <p class="titleinexample">Example 18-7 Loading Data From CSV Files With No Access Parameters</p>
                     <p>This example requires the following conditions:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The order of the columns in the table must match the order of fields in the data file.</p>
                        </li>
                        <li>
                           <p>The records in the data file must be terminated by newline.</p>
                        </li>
                        <li>
                           <p>The field in the records in the data file must be separated by commas (if field values are enclosed in quotation marks, then the quotation marks are <span class="italic">not</span> removed from the field).
                           </p>
                        </li>
                        <li>
                           <p>There cannot be any newline characters in the middle of a field.</p>
                        </li>
                     </ul>
                     <p>The data for the external table is as follows:</p><pre class="pre codeblock"><code>events_all.csv
Winter Games,10-JAN-2010,10,
Hockey Tournament,18-MAR-2009,3,
Baseball Expo,28-APR-2009,2,
International Football Meeting,2-MAY-2009,14,
Track and Field Finale,12-MAY-2010,3,
Mid-summer Swim Meet,5-JUL-2010,4,
Rugby Kickoff,28-SEP-2009,6,</code></pre><p>The definition of the external table is as follows:</p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE EVENTS_XT_1
  2  (EVENT       varchar2(30),
  3   START_DATE  date,
  4   LENGTH      number)
  5  ORGANIZATION EXTERNAL
  6  (default directory def_dir1 location ('events_all.csv'));

Table created.
</code></pre><p>The following shows a <code class="codeph">SELECT</code> operation on the external table <code class="codeph">EVENTS_XT_1</code>:
                     </p><pre class="pre codeblock"><code>SQL&gt; select START_DATE, EVENT, LENGTH
  2    from EVENTS_XT_1
  3    order by START_DATE;

START_DAT EVENT                              LENGTH
--------- ------------------------------ ----------
18-MAR-09 Hockey Tournament                       3
28-APR-09 Baseball Expo                           2
02-MAY-09 International Football Meeting         14
28-SEP-09 Rugby Kickoff                           6
10-JAN-10 Winter Games                           10
12-MAY-10 Track and Field Finale                  3
05-JUL-10 Mid-summer Swim Meet                    4

7 rows selected.

SQL&gt; </code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-53C71354-FDC0-4CD7-BBF1-2B7327A1A245__GUID-DBA430E9-A20E-4975-AA6C-728C66FB3F3C">
                     <p class="titleinexample">Example 18-8 Default Date Mask For the Session Does Not Match the Format of Data Fields in the Data File</p>
                     <p>This example is the same as the previous example, except that the default date mask for the session does not match the format of date fields in the data file.&nbsp; In the example below, the session format for dates is<code class="codeph">&nbsp;DD-Mon-YYYY</code> whereas the format of dates in the data file is <code class="codeph">MM/DD/YYYY</code>. If the external table definition does not have a date mask, then the <code class="codeph">ORACLE_LOADER</code> access driver uses the session date mask to attempt to convert the character data in the data file to a date data type.&nbsp;ou specify an access parameter for the date mask to use for all fields in the data file that are used to load date columns in the external table.
                     </p>
                     <p>The following is the contents of the data file for the external table:</p><pre class="pre codeblock"><code>events_all_date_fmt.csv
Winter Games,1/10/2010,10
Hockey Tournament,3/18/2009,3
Baseball Expo,4/28/2009,2
International Football Meeting,5/2/2009,14
Track and Field Finale,5/12/2009,3
Mid-summer Swim Meet,7/5/2010,4
Rugby Kickoff,9/28/2009,6</code></pre><p>The definition of the external table is as follows:</p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE EVENTS_XT_2
  2  (EVENT       varchar2(30),
  3   START_DATE  date,
  4   LENGTH      number)
  5  ORGANIZATION EXTERNAL
  6  (default directory def_dir1
  7   access parameters (fields date_format date mask "mm/dd/yyyy")
  8   location ('events_all_date_fmt.csv'));

Table created.

SQL&gt; </code></pre><p>The following shows a <code class="codeph">SELECT</code> operation on the external table <code class="codeph">EVENTS_XT_2:</code></p><pre class="pre codeblock"><code>SQL&gt; select START_DATE, EVENT, LENGTH
  2    from EVENTS_XT_2
  3    order by START_DATE;

START_DAT EVENT                              LENGTH
--------- ------------------------------ ----------
18-MAR-09 Hockey Tournament                       3
28-APR-09 Baseball Expo                           2
02-MAY-09 International Football Meeting         14
12-MAY-09 Track and Field Finale                  3
28-SEP-09 Rugby Kickoff                           6
10-JAN-10 Winter Games                           10
05-JUL-10 Mid-summer Swim Meet                    4

7 rows selected.
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-53C71354-FDC0-4CD7-BBF1-2B7327A1A245__GUID-ED72440A-2724-44D9-B945-2344A5CACC73">
                     <p class="titleinexample">Example 18-9 Data is Split Across Two Data Files</p>
                     <p>This example is that same as the first example in this section except for the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The data is split across two data files.</p>
                        </li>
                        <li>
                           <p>Each data file has a row containing the names of the fields.</p>
                        </li>
                        <li>
                           <p>Some fields in the data file are enclosed by quotation marks.</p>
                        </li>
                     </ul>
                     <p>The <code class="codeph">FIELD NAMES ALL FILES</code> tells the access driver that the first row in each file contains a row with names of the fields in the file. The access driver matches the names of the fields to the names of the columns in the table. This means the order of the fields in the file can be different than the order of the columns in the table. If a field name in the first row is not enclosed in quotation marks, then the access driver uppercases the name before trying to find the matching column name in the table. If the field name is enclosed in quotation marks, then it does not change the case of the names before looking for a matching name. 
                     </p>
                     <p>Because the fields are enclosed in quotation marks, the access parameter requires the <code class="codeph">CSV WITHOUT EMBEDDED RECORD TERMINATORS</code> clause.&nbsp; This clause states the following:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Fields in the data file are separated by commas.</p>
                        </li>
                        <li>
                           <p>If the fields are enclosed in double quotation marks, then the access driver removes them from the field value.</p>
                        </li>
                        <li>
                           <p>There are no new lines embedded in the field values (this option allows the access driver to skip some checks that can slow the performance of <code class="codeph">SELECT</code> operations on the external table).
                           </p>
                        </li>
                     </ul>
                     <p>The two data files are as follows:</p><pre class="pre codeblock"><code>events_1.csv

"EVENT","START DATE","LENGTH",
"Winter Games", "10-JAN-2010", "10"
"Hockey Tournament", "18-MAR-2009", "3"
"Baseball Expo", "28-APR-2009", "2"
"International Football Meeting", "2-MAY-2009", "14"</code></pre><pre class="pre codeblock"><code>events_2.csv

Event,Start date,Length,
Track and Field Finale, 12-MAY-2009, 3
Mid-summer Swim Meet, 5-JUL-2010, 4
Rugby Kickoff, 28-SEP-2009, 6</code></pre><p>The external table definition is as follows:</p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE EVENTS_XT_3
  2  ("START DATE"  date,
  3   EVENT         varchar2(30),
  4   LENGTH        number)
  5  ORGANIZATION EXTERNAL
  6  (default directory def_dir1
  7   access parameters (records field names all files
  8                      fields csv without embedded record terminators)
  9   location ('events_1.csv', 'events_2.csv'));

Table created.
</code></pre><p>The following shows the result of a <code class="codeph">SELECT</code> operation on the <code class="codeph">EVENTS_XT_3</code> external table:
                     </p><pre class="pre codeblock"><code>SQL&gt; select "START DATE", EVENT, LENGTH
  2    from EVENTS_XT_3
  3    order by "START DATE";

START DAT EVENT                              LENGTH
--------- ------------------------------ ----------
18-MAR-09 Hockey Tournament                       3
28-APR-09 Baseball Expo                           2
02-MAY-09 International Football Meeting         14
12-MAY-09 Track and Field Finale                  3
28-SEP-09 Rugby Kickoff                           6
10-JAN-10 Winter Games                           10
05-JUL-10 Mid-summer Swim Meet                    4

7 rows selected.

</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-53C71354-FDC0-4CD7-BBF1-2B7327A1A245__GUID-AB2AA9EF-5D96-43B8-AABC-C18EAD4AB87A">
                     <p class="titleinexample">Example 18-10 Data Is Split Across Two Files and Only the First File Has a Row of Field Names</p>
                     <p>This example is the same as example 3 except that only the 1st file has a row of field names.&nbsp; The first row of the second file has real data.&nbsp; The RECORDS clause changes to "field names first file". </p>
                     <p>The two data files are as follows:</p><pre class="pre codeblock"><code>events_1.csv (same as for example 3)

"EVENT","START DATE","LENGTH",
"Winter Games", "10-JAN-2010", "10"
"Hockey Tournament", "18-MAR-2009", "3"
"Baseball Expo", "28-APR-2009", "2"
"International Football Meeting", "2-MAY-2009", "14"</code></pre><pre class="pre codeblock"><code>events_2_no_header_row.csv

Track and Field Finale, 12-MAY-2009, 3
Mid-summer Swim Meet, 5-JUL-2010, 4
Rugby Kickoff, 28-SEP-2009, 6
</code></pre><p>The external table definition is as follows:</p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE EVENTS_XT_4
  2  ("START DATE"  date,
  3   EVENT         varchar2(30),
  4   LENGTH        number)
  5  ORGANIZATION EXTERNAL
  6  (default directory def_dir1
  7   access parameters (records field names first file
  8                      fields csv without embedded record terminators)
  9   location ('events_1.csv', 'events_2_no_header_row.csv'));

Table created.
</code></pre><p>The following shows a <code class="codeph">SELECT</code> operation on the <code class="codeph">EVENTS_XT_4</code> external table:
                     </p><pre class="pre codeblock"><code>SQL&gt; select "START DATE", EVENT, LENGTH
  2    from EVENTS_XT_4
  3    order by "START DATE";

START DAT EVENT                              LENGTH
--------- ------------------------------ ----------
18-MAR-09 Hockey Tournament                       3
28-APR-09 Baseball Expo                           2
02-MAY-09 International Football Meeting         14
12-MAY-09 Track and Field Finale                  3
28-SEP-09 Rugby Kickoff                           6
10-JAN-10 Winter Games                           10
05-JUL-10 Mid-summer Swim Meet                    4

7 rows selected.
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-53C71354-FDC0-4CD7-BBF1-2B7327A1A245__GUID-9A1B16E1-8996-4B67-ABAE-926CEF463F3F">
                     <p class="titleinexample">Example 18-11 The Order of the Fields in the File Match the Order of the Columns in the Table</p>
                     <p>This example has the following conditions:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The order of the fields in the file match the order of the columns in the table.</p>
                        </li>
                        <li>
                           <p>Fields are separated by newlines and are optionally enclosed in double quotation marks.</p>
                        </li>
                        <li>
                           <p>There are fields that have embedded newlines in their value and those fields are enclosed in double quotation marks.</p>
                        </li>
                     </ul>
                     <p>The contents of the data files are as follows:</p><pre class="pre codeblock"><code>event_contacts_1.csv

Winter Games, 10-JAN-2010, Ana Davis,
Hockey Tournament, 18-MAR-2009, "Daniel Dube
Michel Gagnon",
Baseball Expo, 28-APR-2009, "Robert Brown"
Internation Football Meeting, 2-MAY-2009,"Pete Perez
Randall Barnes
Melissa Gray",
</code></pre><pre class="pre codeblock"><code>event_contacts_2.csv

Track and Field Finale, 12-MAY-2009, John Taylor,
Mid-summer Swim Meet, 5-JUL-2010, "Louise Stewart
Cindy Sanders"
Rugby Kickoff, 28-SEP-2009, "Don Nguyen
Ray Lavoie"</code></pre><p>The table definition is as follows. The <code class="codeph">CSV WITH EMBEDDED RECORD TERMINATORS</code> clause tells the access driver how to handle fields enclosed by double quotation marks that also have embedded new lines.
                     </p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE EVENTS_CONTACTS_1
  2  (EVENT       varchar2(30),
  3   START_DATE  date,
  4   CONTACT     varchar2(120))
  5  ORGANIZATION EXTERNAL
  6  (default directory def_dir1
  7   access parameters (fields CSV with embedded record terminators)
  8   location ('event_contacts_1.csv', 'event_contacts_2.csv'));

Table created.
</code></pre><p>The following shows the result of a <code class="codeph">SELECT</code> operation on the <code class="codeph">EVENT_CONTACTS_1</code> external table:
                     </p><pre class="pre codeblock"><code>SQL&gt; column contact format a30 
SQL&gt; select START_DATE, EVENT, CONTACT
  2    from EVENTS_CONTACTS_1
  3    order by START_DATE;

START_DAT EVENT                          CONTACT
--------- ------------------------------ ------------------------------
18-MAR-09 Hockey Tournament              Daniel Dube
                                         Michel Gagnon

28-APR-09 Baseball Expo                  Robert Brown
02-MAY-09 Internation Football Meeting   Pete Perez
                                         Randall Barnes
                                         Melissa Gray

12-MAY-09 Track and Field Finale         John Taylor
28-SEP-09 Rugby Kickoff                  Don Nguyen
                                         Ray Lavoie

10-JAN-10 Winter Games                   Ana Davis
05-JUL-10 Mid-summer Swim Meet           Louise Stewart
                                         Cindy Sanders

7 rows selected.
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-53C71354-FDC0-4CD7-BBF1-2B7327A1A245__GUID-D5C0DA21-39D9-45C4-90C1-265E821763BD">
                     <p class="titleinexample">Example 18-12 Not All Fields in the Data File Use Default Settings for the Access Parameters</p>
                     <p>This example shows what to do when most field in the data file use default settings for the access parameters but a few do not.&nbsp; Instead of listing the setting for all fields, this example shows how you can set attributes for just the fields that are different from the default.&nbsp;The differences are as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>there are two date fields, one of which uses the session format, but <code class="codeph">registration_deadline</code>&nbsp; uses a different format
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">registration_deadline</code> also uses a value of <code class="codeph">NONE</code> to indicate a null value.
                           </p>
                        </li>
                     </ul>
                     <p>The content of the data file is as follows:</p><pre class="pre codeblock"><code>events_reg.csv

Winter Games,10-JAN-2010,10,12/1/2009,
Hockey Tournament,18-MAR-2009,3,3/11/2009,
Baseball Expo,28-APR-2009,2,NONE
International Football Meeting,2-MAY-2009,14,3/1/2009
Track and Field Finale,12-MAY-2010,3,5/10/010
Mid-summer Swim Meet,5-JUL-2010,4,6/20/2010
Rugby Kickoff,28-SEP-2009,6,NONE  </code></pre><p>The table definition is as follows. The <code class="codeph">ALL FIELDS OVERRIDE</code> clause allows you to specify information for that field while using defaults for the remaining fields. The remaining fields have a data type of <code class="codeph">CHAR(255)</code> and the field data is terminated by a comma with a trimming option of <code class="codeph">LDRTRIM</code>.
                     </p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE EVENT_REGISTRATION_1
  2  (EVENT                 varchar2(30),
  3   START_DATE            date,
  4   LENGTH                number,
  5   REGISTRATION_DEADLINE date)
  6  ORGANIZATION EXTERNAL
  7  (default directory def_dir1
  8   access parameters
  9  (fields all fields override
 10     (REGISTRATION_DEADLINE CHAR (10) DATE_FORMAT DATE MASK "mm/dd/yyyy"
 11                           NULLIF REGISTRATION_DEADLINE = 'NONE'))
 12   location ('events_reg.csv'));

Table created.
</code></pre><p>The following shows the result of a <code class="codeph">SELECT</code> operation on the <code class="codeph">EVENT_REGISTRATION_1</code> external table:
                     </p><pre class="pre codeblock"><code>SQL&gt; select START_DATE, EVENT, LENGTH, REGISTRATION_DEADLINE
  2    from EVENT_REGISTRATION_1
  3    order by START_DATE;

START_DAT EVENT                              LENGTH REGISTRAT
--------- ------------------------------ ---------- ---------
18-MAR-09 Hockey Tournament                       3 11-MAR-09
28-APR-09 Baseball Expo                           2
02-MAY-09 International Football Meeting         14 01-MAR-09
28-SEP-09 Rugby Kickoff                           6
10-JAN-10 Winter Games                           10 01-DEC-09
12-MAY-10 Track and Field Finale                  3 10-MAY-10
05-JUL-10 Mid-summer Swim Meet                    4 20-JUN-10

7 rows selected.

</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-external-tables-examples.html#GUID-03CE63AD-F046-4805-A560-E4CFD7FA8503" title="Examples using external tables.">External Tables Examples</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>