<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="You can create command rules or use the default command rules to protect DDL and DML statements.">
      <meta name="description" content="You can create command rules or use the default command rules to protect DDL and DML statements.">
      <title>Configuring Command Rules</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Administrator's Guide ">
      <meta property="og:description" content="You can create command rules or use the default command rules to protect DDL and DML statements.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Administrator's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-vault-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-28T15:24:22-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96302-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="configuring-rule-sets.html" title="Previous" type="text/html">
      <link rel="next" href="configuring-factors.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Vault Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="DVADM">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="configuring-rule-sets.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="configuring-factors.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Administrator's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Configuring Command Rules </li>
            </ol>
            <a id="GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" name="GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB"></a><a id="DVADM005"></a>
            
            <h2 id="DVADM-GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" class="sect2"><span class="enumeration_chapter">6 </span>Configuring Command Rules 
            </h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='configuring-command-rules'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
            </noscript>
            <div>
               <p>You can create command rules or use the default command rules to protect DDL and DML statements.</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-E0184EE3-EBBB-4680-B629-9BFD6161ADAF">What Are Command Rules?</a><br>A command rule applies Oracle Database Vault protections with an Oracle Database SQL statement, such as <code class="codeph">ALTER SESSION</code>.
                  </li>
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-D0AC52BD-9878-4FAF-9EE4-81AAB85F4376">Default Command Rules</a><br>Oracle Database Vault provides default command rules, based on commonly used SQL statements.
                  </li>
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-2E806432-DD80-463E-A802-2BBB36EEED40">SQL Statements That Can Be Protected by Command Rules</a><br>You can protect a large number of SQL statements by using command rules. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-BAF4C198-A92B-48D1-BEF5-0AF345165C7C">Creating a Command Rule</a><br>You can create a command rule in Oracle Database Vault Administrator.
                  </li>
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-7A7E40AB-6C1A-49D5-B4FA-16E075866077">Modifying the Enablement Status of a Command Rule</a><br>You can enable or disable a command rule in Oracle Database Vault Administrator.
                  </li>
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-F41B0357-59FA-4EA5-A7D0-16AF93B58105">Deleting a Command Rule</a><br>Before you delete a command rule, you can locate the various references to it by querying the command rule-related Oracle Database Vault views. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-725071B1-17AF-43FD-936E-3586FF15FF33">How Command Rules Work</a><br>Command rules follow a set of steps to check their associated components.
                  </li>
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-946EE4C3-1555-43E0-84F6-C74F8B80EF74">Tutorial: Using a Command Rule to Control Table Creations by a User</a><br>In this tutorial, you create a simple local command rule to control whether users can create tables in the <code class="codeph">SCOTT</code> schema.
                  </li>
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-9D6645BC-F4F7-44CC-95F9-D7DA85771477">Guidelines for Designing Command Rules</a><br>Oracle provides guidelines for designing command rules.
                  </li>
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-C324D4D9-B66B-4A6F-8159-120C3E322426">How Command Rules Affect Performance</a><br>The performance of a command rule depends on the complexity of the rules in the rule set associated with the command rule. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-C1CE7C50-84E0-4E08-B60B-89D13769B66E">Command Rule Related Reports and Data Dictionary View</a><br>Oracle Database Vault provides reports and a data dictionary view that are useful for analyzing command rules.
                  </li>
               </ul>
            </div>
            <a id="DVADM70205"></a><div class="props_rev_3"><a id="GUID-E0184EE3-EBBB-4680-B629-9BFD6161ADAF" name="GUID-E0184EE3-EBBB-4680-B629-9BFD6161ADAF"></a><h3 id="DVADM-GUID-E0184EE3-EBBB-4680-B629-9BFD6161ADAF" class="sect3">What Are Command Rules?</h3>
               <div>
                  <p>A command rule applies Oracle Database Vault protections with an Oracle Database SQL statement, such as <code class="codeph">ALTER SESSION</code>.
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-FCBE368D-5F3A-4362-B81E-1B2E80BADEDD">About Command Rules</a><br>A command rule protects Oracle Database SQL statements that affect one or more database objects. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84">Command Rules in a Multitenant Environment</a><br>In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.
                     </li>
                     <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-4170DDDD-C26C-4B78-AF7E-1F8A4E8324B7">Types of Command Rules</a><br>In addition to command rules for many SQL statements, you can create command rules specifically for the <code class="codeph">CONNECT</code>, <code class="codeph">ALTER SYSTEM</code>, and <code class="codeph">ALTER SESSION</code> SQL statements.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
               <a id="DVADM71322"></a><div class="props_rev_3"><a id="GUID-FCBE368D-5F3A-4362-B81E-1B2E80BADEDD" name="GUID-FCBE368D-5F3A-4362-B81E-1B2E80BADEDD"></a><h4 id="DVADM-GUID-FCBE368D-5F3A-4362-B81E-1B2E80BADEDD" class="sect4">About Command Rules</h4>
                  <div>
                     <p>A command rule protects Oracle Database SQL statements that affect one or more database objects. </p>
                     <p>These statements can include <code class="codeph">SELECT</code>, <code class="codeph">ALTER SYSTEM</code>, database definition language (DDL), and data manipulation language (DML) statements.
                     </p>
                     <p>To customize and enforce the command rule, you associate it with a rule set, which is a collection of one or more rules. The command rule is enforced at run time. Command rules affect anyone who tries to use the SQL statements it protects, regardless of the realm in which the object exists. </p>
                     <p>You can use command rules to protect a wide range of SQL statements, in addition to
            basic Oracle Database DDL and DML statements. For example, you can protect statements
            that are used with Oracle Flashback Technology.</p>
                     <p>A command rule has the following attributes, in addition to associating a command rule to a command: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>SQL statement the command rule protects</p>
                        </li>
                        <li>
                           <p>Owner of the object the command rule affects</p>
                        </li>
                        <li>
                           <p>Database object the command rule affects</p>
                        </li>
                        <li>
                           <p>Whether the command rule is enabled</p>
                        </li>
                        <li>
                           <p>An associated rule set</p>
                        </li>
                     </ul>
                     <p>Command rules can be categorized as follows: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">Command rules that have a system-wide scope.</span> With this type, in most cases, you can only create one command rule for each database instance.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Command rules that are schema specific.</span> An example of a schema-specific command rule is a command rule for the <code class="codeph">DROP TABLE</code> statement. You can create only one CONNECT command rule for each schema.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Command rules that are object specific.</span> An example is creating a command rule for the <code class="codeph">DROP TABLE</code> statement with a specific table included in the command rule definition. 
                           </p>
                        </li>
                     </ul>
                     <p>When a user executes a statement affected by a command rule, Oracle Database Vault checks the realm authorization first. If it finds no realm violation and if the associated command rules are enabled, then Database Vault evaluates the associated rule sets. If all the rule sets evaluate to <code class="codeph">TRUE</code>, then the statement is authorized for further processing. If any of the rule sets evaluate to <code class="codeph">FALSE</code>, then the statement is not allowed to be executed and a command rule violation is raised. 
                     </p>
                     <p>You can define a command rule that uses factors for the <code class="codeph">CONNECT</code>
            event to permit or deny sessions after the usual steps&#x2013;user authentication process,
            factor initialization, and Oracle Label Security integration&#x2013;are complete. For example,
            you can configure a command rule that allows DDL statements such as <code class="codeph">CREATE
                TABLE</code>, <code class="codeph">DROP TABLE</code>, and <code class="codeph">ALTER TABLE</code> in the
                <code class="codeph">BIZAPP</code> schema to be authorized after business hours, but not during
            business hours.
                     </p>
                     <p>You can run reports on the command rules that you create in Oracle Database Vault. </p>
                     <p>You cannot create command rules that block <code class="codeph">SYS</code> from executing
                <code class="codeph">SYS</code>-owned procedures.
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="oracle-database-vault-command-rule-apis.html#GUID-3E699451-4226-4C5D-A538-9103F536DAE9" title="The DBMS_MACADM PL/SQL package provides procedures for configuring command rules. .">Oracle Database Vault Command Rule APIs</a></li>
                           <li><a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a></li>
                           <li><a href="configuring-command-rules.html#GUID-2E806432-DD80-463E-A802-2BBB36EEED40" title="You can protect a large number of SQL statements by using command rules.">SQL Statements That Can Be Protected by Command Rules</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-E0184EE3-EBBB-4680-B629-9BFD6161ADAF" title="A command rule applies Oracle Database Vault protections with an Oracle Database SQL statement, such as ALTER SESSION.">What Are Command Rules?</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DVADM71323"></a><div class="props_rev_3"><a id="GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" name="GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84"></a><h4 id="DVADM-GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" class="sect4">Command Rules in a Multitenant Environment</h4>
                  <div>
                     <p>In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.</p>
                     <p>Common command rules can be associated only with common realms, rule sets, and rules. Local command rules can be associated only with local realm, rule sets, and rules.</p>
                     <p>To apply these command rules to the entire multitenant environment, you must execute the command rule procedures from the CDB root or application root as a common user who has been granted the <code class="codeph">DVADM</code> or <code class="codeph">DVOWNER</code> role. A common command rule that is created in the CDB root will be applied to all PDBs in that CDB environment. A common command rule that is created in the application root will only be applied to the PDBs that are associated with this application root. To propagate the command rule to the PDBs that are associated with the CDB root or application root, you must synchronize the PDB. For example, to synchronize an application root called <code class="codeph">saas_sales_app</code> to its application PDBs:
                     </p><pre class="oac_no_warn" dir="ltr">ALTER PLUGGABLE DATABASE APPLICATION saas_sales_app SYNC;</pre><p>To synchronize a common command rule in the CDB root to a PDB:</p><pre class="oac_no_warn" dir="ltr">ALTER PLUGGABLE DATABASE APPLICATION APP$CDB$SYSTEM SYNC;</pre><p>You can check a userâ€™s roles by querying the <code class="codeph">USER_ROLE_PRIVS</code> data dictionary view. To find information about command rules, query the <code class="codeph">DBA_DV_COMMAND_RULE</code> data dictionary view.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-E0184EE3-EBBB-4680-B629-9BFD6161ADAF" title="A command rule applies Oracle Database Vault protections with an Oracle Database SQL statement, such as ALTER SESSION.">What Are Command Rules?</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-4170DDDD-C26C-4B78-AF7E-1F8A4E8324B7" name="GUID-4170DDDD-C26C-4B78-AF7E-1F8A4E8324B7"></a><h4 id="DVADM-GUID-4170DDDD-C26C-4B78-AF7E-1F8A4E8324B7" class="sect4">Types of Command Rules</h4>
                  <div>
                     <p>In addition to command rules for many SQL statements, you can create command rules specifically for the <code class="codeph">CONNECT</code>, <code class="codeph">ALTER SYSTEM</code>, and <code class="codeph">ALTER SESSION</code> SQL statements.
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-6904ABAF-EB19-402B-BE4E-87C06FDA0F8C">CONNECT Command Rule</a><br>The <code class="codeph">DBMS_MACADM.CREATE_CONNECT_CMD_RULE</code> procedure creates a user-specific CONNECT command rule. 
                        </li>
                        <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-1880A901-0657-4BEA-B748-2B0A1D8CC017">ALTER SESSION and ALTER SYSTEM Command Rules</a><br>You can create different kinds of <code class="codeph">ALTER SESSION</code> and <code class="codeph">ALTER SYSTEM</code> command rules that provide fine-grained control for these SQL statements. 
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-E0184EE3-EBBB-4680-B629-9BFD6161ADAF" title="A command rule applies Oracle Database Vault protections with an Oracle Database SQL statement, such as ALTER SESSION.">What Are Command Rules?</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-6904ABAF-EB19-402B-BE4E-87C06FDA0F8C" name="GUID-6904ABAF-EB19-402B-BE4E-87C06FDA0F8C"></a><h5 id="DVADM-GUID-6904ABAF-EB19-402B-BE4E-87C06FDA0F8C" class="sect5">CONNECT Command Rule</h5>
                     <div>
                        <p>The <code class="codeph">DBMS_MACADM.CREATE_CONNECT_CMD_RULE</code> procedure creates a user-specific CONNECT command rule. 
                        </p>
                        <p>This type of command rule specifies a user, an associated rule set, an enablement status, and for a multitenant environment, where to execute the CONNECT command rule. You can enable or disable the CONNECT command rule, or you can set it to use simulation mode.  In simulation mode, violations to the command rule are logged in a designated log table with sufficient information to describe the error, such as the user name or SQL statement used.</p>
                        <p>In a multitenant environment, you can create the CONNECT command rule in either the application root or in a specific PDB. The associated rule set must be consistent with the CONNECT command rule: if the CONNECT command rule is in the application root, then the rule set and rules must also be in the application root. You run the CONNECT command rule procedures from the CDB root as a common user. If the CONNECT command rule is local to a pluggable database (PDB), then you must run the CONNECT command rule creation command in that PDB, and the rule set and rules must be local.</p>
                        <p>The following example shows a CONNECT command rule definition that creates a local, enabled CONNECT command rule for the <code class="codeph">HR</code> user. The rule set that is associated with this command rule is local to the current PDB. 
                        </p><pre class="oac_no_warn" dir="ltr">BEGIN
DBMS_MACADM.CREATE_CONNECT_COMMAND_RULE(
 rule_set_name   =&gt; 'Enabled', 
 user_name       =&gt; 'HR', 
 enabled         =&gt; DBMS_MACUTL.G_YES,
 scope           =&gt; DBMS_MACUTL.G_SCOPE_LOCAL);
END; 
/</pre></div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="oracle-database-vault-command-rule-apis.html#GUID-740E60B7-6CCC-45A6-A0EA-C1328274C33E" title="The CREATE_COMMAND_RULE procedure creates a command rule and associates it with a rule set.">CREATE_COMMAND_RULE Procedure</a></li>
                              <li><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.">Using Simulation Mode for Logging Realm and Command Rule Activities</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-4170DDDD-C26C-4B78-AF7E-1F8A4E8324B7" title="In addition to command rules for many SQL statements, you can create command rules specifically for the CONNECT, ALTER SYSTEM, and ALTER SESSION SQL statements.">Types of Command Rules</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-1880A901-0657-4BEA-B748-2B0A1D8CC017" name="GUID-1880A901-0657-4BEA-B748-2B0A1D8CC017"></a><h5 id="DVADM-GUID-1880A901-0657-4BEA-B748-2B0A1D8CC017" class="sect5">ALTER SESSION and ALTER SYSTEM Command Rules</h5>
                     <div>
                        <p>You can create different kinds of <code class="codeph">ALTER SESSION</code> and <code class="codeph">ALTER SYSTEM</code> command rules that provide fine-grained control for these SQL statements. 
                        </p>
                        <p>The procedures to create these types of command rules are as follows: </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">DBMS_MACADM.CREATE_COMMAND_RULE</code> creates ALTER SESSION and ALTER SYSTEM command rules that use clauses from the corresponding SQL statement, such as <code class="codeph">ADVISE</code>, <code class="codeph">CLOSE DATABASE LINK</code>, <code class="codeph">COMMIT IN PROCEDURE</code>, and <code class="codeph">SET</code> for <code class="codeph">ALTER SESSION</code>, or <code class="codeph">ARCHIVE_LOG</code>, <code class="codeph">CHECK DATAFILES</code>, <code class="codeph">CHECKPOINT</code>, and <code class="codeph">SET</code> for <code class="codeph">ALTER SYSTEM</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBMS_MACADM.CREATE_SESSION_EVENT</code> creates a command rule that is specific to the <code class="codeph">ALTER SESSION SET EVENTS</code> SQL statement
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBMS_MACADM_CREATE_SYSTEM_EVENT</code> creates a command rule that is specific to the <code class="codeph">ALTER SYSTEM SET EVENTS</code> SQL statement.
                              </p>
                           </li>
                        </ul>
                        <p>To create these command rules, you use the appropriate Database Vault procedure to specify the clause and if applicable, the parameter of the clause, in the creation statement. If the ALTER SESSION or ALTER SYSTEM command rule use the <code class="codeph">SET EVENTS</code> setting, then you can use special parameters to specify events, components, and actions.
                        </p>
                        <p>For example, for an ALTER SYSTEM command rule, you could specify the <code class="codeph">SECURITY</code> clause and its <code class="codeph">RESTRICTED SESSION</code> parameter from the <code class="codeph">ALTER SYSTEM</code> SQL statement. To specify whether <code class="codeph">RESTRICTED SESSION</code> is <code class="codeph">TRUE</code> or <code class="codeph">FALSE</code>, you must create a Database Vault rule and rule set, which can test for the validity of this sequence number. 
                        </p>
                        <p>To understand how this concept works, first create the following rule and rule set, which are designed to check if the <code class="codeph">RESTRICTED SESSION</code> parameter is set to <code class="codeph">TRUE</code>:
                        </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_MACADM.CREATE_RULE('RESTRICTED SESSION TRUE', 'UPPER(PARAMETER_VALUE) = ''TRUE''');

BEGIN
 DBMS_MACADM.CREATE_RULE_SET(
  rule_set_name    =&gt; 'Check RESTRICTED SESSION for TRUE',
  description      =&gt; 'Checks if restricted session is true',
  enabled          =&gt; DBMS_MACUTL.G_YES,
  eval_options     =&gt; DBMS_MACUTL.G_RULESET_EVAL_ALL,
  audit_options    =&gt; DBMS_MACUTL.G_RULESET_AUDIT_FAIL + DBMS_MACUTL.G_RULESET_AUDIT_SUCCESS,
  fail_options     =&gt; DBMS_MACUTL.G_RULESET_FAIL_SILENT,
  fail_message     =&gt; 'RESTRICTED SESSION is not TRUE',
  fail_code        =&gt; 20461,
  handler_options  =&gt; DBMS_MACUTL.G_RULESET_HANDLER_FAIL,
  handler          =&gt; '',
  is_static        =&gt; false);
END;
/
EXEC DBMS_MACADM.ADD_RULE_TO_RULE_SET(Check RESTRICTED SESSION for TRUE', 'RESTRICTED SESSION TRUE');</pre><p>With the rule and rule set in place, you are ready to create an ALTER SYSTEM command rule that will check if the <code class="codeph">RESTRICTED SESSION</code> parameter: 
                        </p><pre class="oac_no_warn" dir="ltr">BEGIN
DBMS_MACADM.CREATE_COMMAND_RULE(
 command         =&gt; 'ALTER SYSTEM', 
 rule_set_name   =&gt; 'Check RESTRICTED SESSION for TRUE', 
 object_owner    =&gt; '%', 
 object_name     =&gt; '%', 
 enabled         =&gt; DBMS_MACUTL.G_YES,
 clause_name     =&gt; 'SECURITY',
 parameter_name  =&gt; 'RESTRICTED SESSION',
 scope           =&gt; DBMS_MACUTL.G_SCOPE_LOCAL);
END; 
/
</pre><p>In this example:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">rule_set_name</code> checks whether <code class="codeph">RESTRICTED SESSION</code> is set to <code class="codeph">TRUE</code> or <code class="codeph">FALSE</code>. In a multienant environment, you must create the rule set and rule in the same location as the command rule: either in the application root or locally in a PDB.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">object_owner</code> and <code class="codeph">object_name</code> must always be set to <code class="codeph">%</code> for this kind of <code class="codeph">ALTER SESSION</code> or <code class="codeph">ALTER SYSTEM</code> command rule.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">enabled</code> enables you to enable or disable the command rule, or to use simulation mode to log violations to the command rule to a designated log table. The log data describes the error, such as the user name or SQL statement used.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">clause_name</code> specifies the <code class="codeph">SECURITY</code> clause of the <code class="codeph">ALTER SYSTEM</code> SQL statement
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">parameter_name</code> specifies the <code class="codeph">RESTRICTED SESSION</code> parameter from the <code class="codeph">SECURITY</code> clause
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">scope</code> sets the command rule to be local to the current PDB. The associated rule set and rule must also be local to the current PDB. If you want to create the command rule in the application root, then as a common user, you would set <code class="codeph">scope</code> to <code class="codeph">DBMS_MACUTL.G_SCOPE_COMMON</code> and run the procedure (and its accompanying rule set and rule creation procedures) from the application root. 
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-1880A901-0657-4BEA-B748-2B0A1D8CC017__GUID-E7CDA36F-DA35-4A46-A165-84DC776ADCE2">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="oracle-database-vault-command-rule-apis.html#GUID-740E60B7-6CCC-45A6-A0EA-C1328274C33E" title="The CREATE_COMMAND_RULE procedure creates a command rule and associates it with a rule set.">CREATE_COMMAND_RULE Procedure</a> about the <code class="codeph">DBMS_MACADM.CREATE_COMMAND_RULE</code> procedure
                                 </p>
                              </li>
                              <li>
                                 <p><a href="oracle-database-vault-command-rule-apis.html#GUID-99D54F57-AA3C-4F7D-96D1-220055980A67" title="The CREATE_SESSION_EVENT_CMD_RULE procedure creates a command rule that you can associate with session events, based on the ALTER SESSION statement.">CREATE_SESSION_EVENT_CMD_RULE Procedure</a> about the <code class="codeph">DVS.DBMS_MACADM.CREATE_SESSION_EVENT_CMD_RULE</code> procedure
                                 </p>
                              </li>
                              <li>
                                 <p><a href="oracle-database-vault-command-rule-apis.html#GUID-80F2B260-A0CB-42BF-9858-E6D62F2BA2D4" title="The CREATE_SYSTEM_EVENT_CMD_RULE procedure creates a command rule that you can associate with system events, based on the ALTER SYSTEM statement.">CREATE_SYSTEM_EVENT_CMD_RULE Procedure</a> for more information about the <code class="codeph">DBMS_MACADM.CREATE_SYSTEM_EVENT_CMD_RULE</code> procedure
                                 </p>
                              </li>
                              <li>
                                 <p><a href="oracle-database-vault-data-dictionary-views.html#GUID-9A852E4D-D107-4FDD-8262-B6BB5852F88C" title="The DBA_DV_COMMAND_RULE data dictionary view lists the SQL statements that are protected by command rules.">DBA_DV_COMMAND_RULE View</a> for information about the <code class="codeph">DBA_DV_COMMAND_RULE</code> data dictionary view
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../sqlrf/ALTER-SESSION.html#SQLRF00901" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about the <code class="codeph">ALTER SESSION</code> SQL statement
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../sqlrf/ALTER-SYSTEM.html#SQLRF00902" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about the <code class="codeph">ALTER SYSTEM</code> SQL statement
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-4170DDDD-C26C-4B78-AF7E-1F8A4E8324B7" title="In addition to command rules for many SQL statements, you can create command rules specifically for the CONNECT, ALTER SYSTEM, and ALTER SESSION SQL statements.">Types of Command Rules</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="DVADM70207"></a><a id="DVADM70206"></a><div class="props_rev_3"><a id="GUID-D0AC52BD-9878-4FAF-9EE4-81AAB85F4376" name="GUID-D0AC52BD-9878-4FAF-9EE4-81AAB85F4376"></a><h3 id="DVADM-GUID-D0AC52BD-9878-4FAF-9EE4-81AAB85F4376" class="sect3">Default Command Rules</h3>
               <div>
                  <p>Oracle Database Vault provides default command rules, based on commonly used SQL statements.</p>
                  <div class="section">
                     <p><a href="configuring-command-rules.html#GUID-D0AC52BD-9878-4FAF-9EE4-81AAB85F4376__BABCAGEI" title="Listing of default command rules">Table 6-1</a> lists the default Database Vault command rules. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-D0AC52BD-9878-4FAF-9EE4-81AAB85F4376__BABCAGEI">
                     <p class="titleintable">Table 6-1 Default Command Rules</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Default Command Rules" summary="Listing of default command rules" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="28%" id="d26291e1405">SQL Statement</th>
                              <th align="left" valign="bottom" width="72%" id="d26291e1408">Rule Set Name</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d26291e1413" headers="d26291e1405 ">
                                 <p><code class="codeph">CREATE USER</code></p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d26291e1413 d26291e1408 ">
                                 <p>Can Maintain Accounts/Profiles</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d26291e1421" headers="d26291e1405 ">
                                 <p><code class="codeph">ALTER USER</code></p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d26291e1421 d26291e1408 ">
                                 <p>Can Maintain Own Account</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d26291e1429" headers="d26291e1405 ">
                                 <p><code class="codeph">DROP USER</code></p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d26291e1429 d26291e1408 ">
                                 <p>Can Maintain Accounts/Profiles</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d26291e1437" headers="d26291e1405 ">
                                 <p><code class="codeph">CREATE PROFILE</code></p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d26291e1437 d26291e1408 ">
                                 <p>Can Maintain Accounts/Profiles</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d26291e1445" headers="d26291e1405 ">
                                 <p><code class="codeph">ALTER PROFILE</code></p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d26291e1445 d26291e1408 ">
                                 <p>Can Maintain Accounts/Profiles</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d26291e1453" headers="d26291e1405 ">
                                 <p><code class="codeph">DROP PROFILE</code></p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d26291e1453 d26291e1408 ">
                                 <p>Can Maintain Accounts/Profiles</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d26291e1461" headers="d26291e1405 ">
                                 <p><code class="codeph">ALTER SYSTEM</code></p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d26291e1461 d26291e1408 ">
                                 <p>Allow Fine Grained Control of System Parameters</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="28%" id="d26291e1469" headers="d26291e1405 ">
                                 <p><code class="codeph">CHANGE PASSWORD</code></p>
                              </td>
                              <td align="left" valign="top" width="72%" headers="d26291e1469 d26291e1408 ">
                                 <p>Can Maintain Own Account<a id="fn_1" name="fn_1" href="#fn_1" onclick="footdisplay(1, "The actual SQL statement that the Can Maintain Own Account rule refers to is PASSWORD.")"><sup>Foot&nbsp;1</sup></a></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1 </sup></p><p>The actual SQL statement that the Can Maintain Own Account rule refers to is <code class="codeph">PASSWORD</code>.
                     </p>
                  <p></p>
                  <div class="section">
                     <p>The following set of command rules helps you to achieve separation of duty for user management: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">ALTER PROFILE</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">ALTER USER</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">CREATE PROFILE</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">CREATE USER</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DROP PROFILE</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DROP USER</code></p>
                        </li>
                     </ul>
                     <p>To grant a user the ability to use these commands, you can grant the user the role that the rule set checks. For example, the <code class="codeph">CREATE USER</code> command rule ensures that a user who tries to run a <code class="codeph">CREATE USER</code> statement has the <code class="codeph">DV_ACCTMGR</code> role. 
                     </p>
                     <div class="infoboxnote" id="GUID-D0AC52BD-9878-4FAF-9EE4-81AAB85F4376__GUID-BE661D2E-6304-4624-9F1A-2FD8D309AED7">
                        <p class="notep1">Note:</p>
                        <p>To find information about the default command rules, query the <code class="codeph">DBA_DV_COMMAND_RULE</code> data dictionary view.
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DVADM70208"></a><div class="props_rev_3"><a id="GUID-2E806432-DD80-463E-A802-2BBB36EEED40" name="GUID-2E806432-DD80-463E-A802-2BBB36EEED40"></a><h3 id="DVADM-GUID-2E806432-DD80-463E-A802-2BBB36EEED40" class="sect3">SQL Statements That Can Be Protected by Command Rules</h3>
               <div>
                  <p>You can protect a large number of SQL statements by using command rules. </p>
                  <div class="section">
                     <p>The SQL statements that you can protect are as follows:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformalwide" id="GUID-2E806432-DD80-463E-A802-2BBB36EEED40__GUID-87820CBC-2B45-49AB-BB90-2863D7D81FDA">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" summary="List of statements that can be protected by command rules, listed from top to bottom, then left to right" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="32%" id="d26291e1630">SQL Statements A-A </th>
                              <th align="left" valign="bottom" width="34%" id="d26291e1632">SQL Statements A-D</th>
                              <th align="left" valign="bottom" width="34%" id="d26291e1634">SQL Statements C-U</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1638" headers="d26291e1630 ">
                                 <p><code class="codeph">ALTER CLUSTER</code></p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1638 d26291e1632 ">
                                 
                                 <p><code class="codeph">ASSOCIATE STATISTICS</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1638 d26291e1634 ">
                                 <p><code class="codeph">CREATE TABLE</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1655" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER DIMENSION</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1655 d26291e1632 ">
                                 
                                 <p><code class="codeph">AUDIT</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1655 d26291e1634 ">
                                 <p><code class="codeph">CREATE TABLESPACE</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1675" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER FLASHBACK ARCHIVE</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1675 d26291e1632 ">
                                 <p><code class="codeph">AUDIT POLICY</code> (to audit unified audit policies)
                                 </p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1675 d26291e1634 ">
                                 <p><code class="codeph">CREATE TRIGGER</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1692" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER FUNCTION</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1692 d26291e1632 ">
                                 <p><code class="codeph">CHANGE PASSWORD</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1692 d26291e1634 ">
                                 <p><code class="codeph">CREATE TYPE</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1709" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER INDEX</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1709 d26291e1632 ">
                                 <p><code class="codeph">COMMENT</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1709 d26291e1634 ">
                                 <p><code class="codeph">CREATE TYPE BODY</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1727" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER INDEXTYPE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1727 d26291e1632 ">
                                 <p><code class="codeph">CONNECT</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1727 d26291e1634 ">
                                 <p><code class="codeph">CREATE VIEW</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1745" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER JAVA</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1745 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE AUDIT POLICY</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1745 d26291e1634 ">
                                 <p><code class="codeph">DELETE</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1764" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER LIBRARY</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1764 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE EDITION</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1764 d26291e1634 ">
                                 <p><code class="codeph">DISASSOCIATE STATISTICS</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1783" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER OPERATOR</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1783 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE FLASHBACK ARCHIVE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1783 d26291e1634 ">
                                 <p><code class="codeph">DROP CLUSTER</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1803" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER OUTLINE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1803 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE USER</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1803 d26291e1634 ">
                                 <p><code class="codeph">DROP CONTEXT</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1822" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER MATERIALIZED VIEW</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1822 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE CLUSTER</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1822 d26291e1634 ">
                                 <p><code class="codeph">DROP DATABASE LINK</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1842" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER MATERIALIZED VIEW LOG</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1842 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE CONTEXT</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1842 d26291e1634 ">
                                 <p><code class="codeph">DROP EDITION</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1861" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER PACKAGE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1861 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE DATABASE LINK</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1861 d26291e1634 ">
                                 <p><code class="codeph">DROP DIMENSION</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1879" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER PACKAGE BODY</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1879 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE DIMENSION</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1879 d26291e1634 ">
                                 <p><code class="codeph">DROP DIRECTORY</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1899" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER PLUGGABLE DATABASE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1899 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE DIRECTORY</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1899 d26291e1634 ">
                                 <p><code class="codeph">DROP FLASHBACK ARCHIVE </code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1919" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER PROCEDURE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1919 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE FUNCTION</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1919 d26291e1634 ">
                                 <p><code class="codeph">DROP FUNCTION</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1939" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER PROFILE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1939 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE INDEX</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1939 d26291e1634 ">
                                 <p><code class="codeph">FLASHBACK TABLE</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1959" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER RESOURCE COST</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1959 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE INDEXTYPE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1959 d26291e1634 ">
                                 <p><code class="codeph">EXECUTE</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1978" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER ROLE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1978 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE JAVA</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1978 d26291e1634 ">
                                 <p><code class="codeph">GRANT</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e1998" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER ROLLBACK SEGMENT</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1998 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE LIBRARY</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e1998 d26291e1634 ">
                                 <p><code class="codeph">INSERT</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2018" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER SEQUENCE</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2018 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE OPERATOR</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2018 d26291e1634 ">
                                 <p><code class="codeph">NOAUDIT</code> 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2037" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER SESSION</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2037 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE OUTLINE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2037 d26291e1634 ">
                                 
                                 <p><code class="codeph">NOAUDIT POLICY</code> (for unified audit
                                policies only) 
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2059" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER SYNONYM</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2059 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE PACKAGE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2059 d26291e1634 ">
                                 
                                 <p><code class="codeph">PURGE DBA_RECYCLEBIN</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2080" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER SYSTEM</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2080 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE PACKAGE BODY</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2080 d26291e1634 ">
                                 
                                 <p><code class="codeph">PURGE INDEX</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2102" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER TABLE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2102 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE PLUGGABLE DATABASE</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2102 d26291e1634 ">
                                 
                                 <p><code class="codeph">RENAME</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2123" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER TABLESPACE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2123 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE PROCEDURE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2123 d26291e1634 ">
                                 
                                 <p><code class="codeph">PURGE RECYCLEBIN</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2145" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER TRIGGER</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2145 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE PROFILE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2145 d26291e1634 ">
                                 
                                 <p><code class="codeph">PURGE TABLE</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2167" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER TYPE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2167 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE ROLE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2167 d26291e1634 ">
                                 
                                 <p><code class="codeph">PURGE TABLESPACE</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2189" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER TYPE BODY</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2189 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE ROLLBACK SEGMENT</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2189 d26291e1634 ">
                                 
                                 <p><code class="codeph">REVOKE</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2210" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER USER</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2210 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE SCHEMA</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2210 d26291e1634 ">
                                 
                                 <p><code class="codeph">SELECT</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2232" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ALTER VIEW</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2232 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE SEQUENCE</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2232 d26291e1634 ">
                                 
                                 <p><code class="codeph">TRUNCATE CLUSTER</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2253" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ANALYZE CLUSTER</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2253 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE MATERIALIZED VIEW</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2253 d26291e1634 ">
                                 
                                 <p><code class="codeph">TRUNCATE TABLE</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2274" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ANALYZE INDEX</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2274 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE MATERIALIZED VIEW LOG</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2274 d26291e1634 ">
                                 
                                 <p><code class="codeph">UPDATE</code>
                                    
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d26291e2297" headers="d26291e1630 ">
                                 
                                 <p><code class="codeph">ANALYZE TABLE</code>
                                    
                                 </p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2297 d26291e1632 ">
                                 
                                 <p><code class="codeph">CREATE SYNONYM</code></p>
                                 
                              </td>
                              <td align="left" valign="top" width="34%" headers="d26291e2297 d26291e1634 ">
                                 
                                 <p> -</p>
                                 
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-2E806432-DD80-463E-A802-2BBB36EEED40__GUID-98D338A7-B6EE-4DA2-AFBB-C12D56A29014">
                     <p class="notep1">See Also:</p>
                     <p><a href="configuring-command-rules.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" title="In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.">Command Rules in a Multitenant Environment</a> for information about using <code class="codeph">CREATE PLUGGABLE DATABASE</code>, <code class="codeph">ALTER PLUGGABLE DATABASE</code>, and <code class="codeph">DROP PLUGGABLE DATABASE</code> in a multitenant container database (CDB)
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-BAF4C198-A92B-48D1-BEF5-0AF345165C7C" name="GUID-BAF4C198-A92B-48D1-BEF5-0AF345165C7C"></a><h3 id="DVADM-GUID-BAF4C198-A92B-48D1-BEF5-0AF345165C7C" class="sect3">Creating a Command Rule</h3>
               <div>
                  <p>You can create a command rule in Oracle Database Vault Administrator.</p>
                  <ol>
                     <li class="stepexpand"><span>Log in to Oracle Database Vault Administrator from Cloud Control as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege. <a href="getting-started-with-oracle-database-vault.html#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for managing Oracle Database Vault.">Logging in to Oracle Database Vault from Oracle Enterprise Cloud Control</a> explains how to log in.</span></li>
                     <li class="stepexpand"><span>In the Administration page, under Database Vault Components, click <span class="bold">Command Rules</span>.</span></li>
                     <li class="stepexpand"><span>In the Command Rules page: </span><div>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>To create a new command rule, click <span class="bold">Create</span> to display the Create Command Rule page. 
                                 </p><br><img src="img/create_command_rule122.png" alt="Description of create_command_rule122.png follows" title="Description of create_command_rule122.png follows" longdesc="img_text/create_command_rule122.html"><br><a href="img_text/create_command_rule122.html">Description of the illustration create_command_rule122.png</a><br></li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>In the Create Command Rule page, enter the following settings:</span><div>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="bold">Command:</span> Select the SQL statement or operation for which you want to create a command rule. This attribute is mandatory. 
                                 </p>
                                 
                                 <p>If you plan to create a command rule for a unified audit
                                policy object, then ensure that you specify <code class="codeph">AUDIT
                                    POLICY</code> or <code class="codeph">NOAUDIT POLICY</code>, not
                                    <code class="codeph">AUDIT</code> or <code class="codeph">NOAUDIT</code>, as the
                                command. 
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Status:</span> Select either <span class="bold">Enabled</span>, <span class="bold">Disabled</span>, or <span class="bold">Simulation</span>, which will apply to the command rule during run time. This attribute is mandatory. 
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Applicable Object Owner:</span> From the list, select the owner of the object the command rule affects. You can use wildcard character <code class="codeph">%</code> to select all owners. (However, you cannot use wildcard characters with text, such as <code class="codeph">EM%</code> to select all owners whose names begin in <code class="codeph">EM</code>.) This attribute is mandatory for all SQL statements that operate on objects within a specific schema. See <a href="configuring-command-rules.html#GUID-2E806432-DD80-463E-A802-2BBB36EEED40" title="You can protect a large number of SQL statements by using command rules.">SQL Statements That Can Be Protected by Command Rules</a> for a list of supported SQL statements. 
                                 </p>
                                 <p>Note that the <code class="codeph">SELECT</code>, <code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, <code class="codeph">DELETE</code>, and <code class="codeph">EXECUTE</code> statements are not allowed for a selection of all (%) or the <code class="codeph">SYS</code> and <code class="codeph">DVSYS</code> schemas.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Applicable Object Name:</span> Enter the name of the database object that the
                                command rule affects, or specify % to select all database objects,
                                which can include tables, procedures, views, unified audit policies,
                                and so on. This attribute is mandatory, if you selected an object
                                owner from the Object Owner list.
                                 </p>
                                 <p>You can run Oracle Database Vault reports on objects that the command rule affects. See the <a href="configuring-command-rules.html#GUID-C1CE7C50-84E0-4E08-B60B-89D13769B66E" title="Oracle Database Vault provides reports and a data dictionary view that are useful for analyzing command rules.">Command Rule Related Reports and Data Dictionary View</a> for more information. 
                                 </p>
                              </li>
                              <li>
                                 <p><span class="bold">Rule Set:</span> From the list, select the rule set that you want to associate with the command rule. This attribute is mandatory.
                                 </p>
                                 <p>If the rule set evaluates to true, then the SQL statement succeeds. If it evaluates to false, the statement fails, and then Oracle Database Vault raises a command rule violation. (You can track rule violations by using the Command Rule Configuration Issues Report, discussed in <a href="oracle-database-vault-reports.html#GUID-1B6D02DE-3FB2-4ADB-9916-4491B37FDECD" title="Oracle Database Vault provides reports that track activities, such as the Database Vault configuration settings.">Oracle Database Vault Reports</a>.) Any auditing and custom event handling associated with the rule set occurs as a part of the command rule processing. 
                                 </p>
                                 <p>See <a href="configuring-rule-sets.html#GUID-41914FF0-20E0-4878-8124-C6C976C19104" title="Rule sets group one or more rules together; the rules determine whether a user can perform an action on an object.">Configuring Rule Sets</a>, for more information about rule sets. 
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Click <span class="bold">OK</span>. </span></li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="dba-operations-in-an-oracle-database-vault-environment.html#GUID-199489A3-6050-4A5C-8144-B85E62E92D58" title="You can propagate Database Vault configurations (such as a realm configuration) to other Database Vault-protected databases.">Propagating Oracle Database Vault Configurations to Other Databases</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-7A7E40AB-6C1A-49D5-B4FA-16E075866077" name="GUID-7A7E40AB-6C1A-49D5-B4FA-16E075866077"></a><h3 id="DVADM-GUID-7A7E40AB-6C1A-49D5-B4FA-16E075866077" class="sect3">Modifying the Enablement Status of a Command Rule</h3>
               <div>
                  <p>You can enable or disable a command rule in Oracle Database Vault Administrator.</p>
                  <ol>
                     <li><span>Log in to Oracle Database Vault Administrator from Cloud Control as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege. <a href="getting-started-with-oracle-database-vault.html#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for managing Oracle Database Vault.">Logging in to Oracle Database Vault from Oracle Enterprise Cloud Control</a> explains how to log in.</span></li>
                     <li><span>In the Administration page, under Database Vault Components, click <span class="bold">Command Rules</span>.</span></li>
                     <li><span>In the Command Rules page, select the command rule that you want to enable or disable, and then select <span class="bold">Edit</span>.</span></li>
                     <li><span>In the Edit Command Rule page, select the status that you want from the <span class="bold">Status</span> menu:</span><ul>
                           <li><span class="bold">Enabled</span></li>
                           <li><span class="bold">Disabled</span></li>
                           <li><span class="bold">Simulation</span></li>
                        </ul>
                     </li>
                     <li><span>Click <span class="bold">OK</span>. </span></li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DVADM70213"></a><div class="props_rev_3"><a id="GUID-F41B0357-59FA-4EA5-A7D0-16AF93B58105" name="GUID-F41B0357-59FA-4EA5-A7D0-16AF93B58105"></a><h3 id="DVADM-GUID-F41B0357-59FA-4EA5-A7D0-16AF93B58105" class="sect3">Deleting a Command Rule</h3>
               <div>
                  <p>Before you delete a command rule, you can locate the various references to it by querying the command rule-related Oracle Database Vault views. </p>
                  <ol>
                     <li><span>Log in to Oracle Database Vault Administrator from Cloud Control as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege. <a href="getting-started-with-oracle-database-vault.html#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for managing Oracle Database Vault.">Logging in to Oracle Database Vault from Oracle Enterprise Cloud Control</a> explains how to log in.</span></li>
                     <li><span>In the Oracle Database Vault Administration page, select <span class="bold">Command Rules</span>. </span></li>
                     <li><span>In the Command Rules page, select the command rule that you want to remove. </span></li>
                     <li><span>Click <span class="bold">Delete</span>. </span></li>
                     <li><span>In the Confirmation window, click <span class="bold">Yes</span>. </span></li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="oracle-database-vault-data-dictionary-views.html#GUID-C0CEF4FC-DB4C-4AD5-9671-C0861A647183" title="You can find information about the Oracle Database Vault configuration settings by querying the Database Vault-specific data dictionary views.">Oracle Database Vault Data Dictionary Views</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="DVADM70214"></a><div class="props_rev_3"><a id="GUID-725071B1-17AF-43FD-936E-3586FF15FF33" name="GUID-725071B1-17AF-43FD-936E-3586FF15FF33"></a><h3 id="DVADM-GUID-725071B1-17AF-43FD-936E-3586FF15FF33" class="sect3">How Command Rules Work</h3>
               <div>
                  <p>Command rules follow a set of steps to check their associated components.</p>
                  <p><a href="configuring-realms.html#GUID-E3560CA1-7680-4B7B-A916-E138661952AA" title="When an appropriately privileged database account issues a SQL statement that affects an object within a realm, a special set of activities occur.">How Realms Work</a> describes what happens when a database account issues a <code class="codeph">SELECT</code>, DDL, or DML statement that affects objects within a realm. 
                  </p>
                  <p>The following actions take place when <code class="codeph">SELECT</code>, DDL, or DML statement is issued: 
                  </p>
                  <ol>
                     <li>
                        <p>Oracle Database Vault queries all the command rules that need to be applied.</p>
                        <p>For <code class="codeph">SELECT</code>, DDL, and DML statements, multiple command rules may apply because the object owner and object name support wildcard notation.
                        </p>
                        <p>You can associate rule sets with both command rules and realm authorizations. Oracle Database Vault evaluates the realm authorization rule set first, and then it evaluates the rule sets that apply to the command type being evaluated.</p>
                     </li>
                     <li>
                        <p>For each command rule that applies, Oracle Database Vault evaluates its associated rule set. </p>
                     </li>
                     <li>
                        <p>If the associated rule set of any of the applicable command rules returns false or errors, Oracle Database Vault prevents the command from executing. Otherwise, the command is authorized for further processing. The configuration of the rule set with respect to auditing and event handlers dictates the auditing or custom processing that occurs.</p>
                        <p>Command rules override object privileges. That is, even the owner of an object cannot access the object if the object is protected by a command rule. You can disable either a command rule or the rule set of a command. If you disable a command rule, then the command rule does not perform the check it is designed to handle. If you disable a rule set, then the rule set always evaluates to <code class="codeph">TRUE</code>. However, if you want to disable a command rule for a particular command, then you should disable the command rule because the rule set may be associated with other command rules or realm authorizations.
                        </p>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DVADM70215"></a><div class="props_rev_3"><a id="GUID-946EE4C3-1555-43E0-84F6-C74F8B80EF74" name="GUID-946EE4C3-1555-43E0-84F6-C74F8B80EF74"></a><h3 id="DVADM-GUID-946EE4C3-1555-43E0-84F6-C74F8B80EF74" class="sect3">Tutorial: Using a Command Rule to Control Table Creations by a User</h3>
               <div>
                  <p>In this tutorial, you create a simple local command rule to control whether users can create tables in the <code class="codeph">SCOTT</code> schema.
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-C0334767-0B1F-4172-9076-527B42D68F78">Step 1: Create a Table</a><br>First, user <code class="codeph">SCOTT</code> must create a table.
                     </li>
                     <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-547E874F-B4A5-4F23-B090-B11FF42F3B7A">Step 2: Create a Command Rule</a><br>After the table has been created in the <code class="codeph">SCOTT</code> schema, you can create a command rule.
                     </li>
                     <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-13831052-DD9E-4895-8EF8-26E353B4DCE2">Step 3: Test the Command Rule</a><br>Next, you are ready to test the CREATE TABLE local command rule. 
                     </li>
                     <li class="ulchildlink"><a href="configuring-command-rules.html#GUID-68B15658-8316-4569-9DA3-D2BDB9408C5E">Step 4: Remove the Components for this Tutorial</a><br>You can remove the components that you created for this tutorial if you no longer need them. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
               <a id="DVADM70216"></a><div class="props_rev_3"><a id="GUID-C0334767-0B1F-4172-9076-527B42D68F78" name="GUID-C0334767-0B1F-4172-9076-527B42D68F78"></a><h4 id="DVADM-GUID-C0334767-0B1F-4172-9076-527B42D68F78" class="sect4">Step 1: Create a Table</h4>
                  <div>
                     <p>First, user <code class="codeph">SCOTT</code> must create a table.
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Log into the database instance as user <code class="codeph">SCOTT</code>. </span><div><pre class="oac_no_warn" dir="ltr">sqlplus scott
Enter password: <span class="italic">password</span>
</pre><p>In a multitenant environment, you must log in to the appropriate PDB. For example:</p><pre class="oac_no_warn" dir="ltr">sqlplus scott@hrpdb
Enter password: <span class="italic">password</span>
</pre><p>To find the available pluggable databases (PDBs), query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command. 
                              </p>
                              <p>If the <code class="codeph">SCOTT</code> account is locked and expired, then log in as the Database Vault Account Manager and unlock <code class="codeph">SCOTT</code> and create a new password. For example:
                              </p><pre class="oac_no_warn" dir="ltr">sqlplus bea_dvacctmgr <span class="italic">--Or, sqlplus bea_dvacctmgr@hrpdb</span>
Enter password: <span class="italic">password</span>

ALTER USER SCOTT ACCOUNT UNLOCK IDENTIFIED BY <span class="italic">password</span>;
</pre><p>Follow the guidelines in <a href="../dbseg/configuring-authentication.html#DBSEG33223" target="_blank"><span><cite>Oracle Database Security Guide</cite></span></a> to replace <span class="italic"><code class="codeph">password</code></span> with a password that is secure. 
                              </p><pre class="oac_no_warn" dir="ltr">CONNECT SCOTT <span class="italic">--Or, sqlplus SCOTT@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>As user <code class="codeph">SCOTT</code>, create a table. </span><div><pre class="oac_no_warn" dir="ltr">CREATE TABLE t1 (num NUMBER);
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Now drop the table. </span><div><pre class="oac_no_warn" dir="ltr">DROP TABLE t1;
</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>At this stage, user <code class="codeph">SCOTT</code> can create and drop tables. Do not exit SQL*Plus yet, and remain connected as <code class="codeph">SCOTT</code>. You must use it later on when <code class="codeph">SCOTT</code> tries to create another table. 
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-946EE4C3-1555-43E0-84F6-C74F8B80EF74" title="In this tutorial, you create a simple local command rule to control whether users can create tables in the SCOTT schema.">Tutorial: Using a Command Rule to Control Table Creations by a User</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70217"></a><div class="props_rev_3"><a id="GUID-547E874F-B4A5-4F23-B090-B11FF42F3B7A" name="GUID-547E874F-B4A5-4F23-B090-B11FF42F3B7A"></a><h4 id="DVADM-GUID-547E874F-B4A5-4F23-B090-B11FF42F3B7A" class="sect4">Step 2: Create a Command Rule</h4>
                  <div>
                     <p>After the table has been created in the <code class="codeph">SCOTT</code> schema, you can create a command rule.
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Log in to Oracle Database Vault Administrator from Cloud Control as a user who has been granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role and the <code class="codeph">SELECT ANY DICTIONARY</code> privilege. <a href="getting-started-with-oracle-database-vault.html#GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" title="Oracle Enterprise Manager Cloud Control (Cloud Control) provides pages for managing Oracle Database Vault.">Logging in to Oracle Database Vault from Oracle Enterprise Cloud Control</a> explains how to log in.</span></li>
                        <li class="stepexpand"><span>In the Oracle Database Vault Administrator Administration page, click <span class="bold">Command Rules</span>.</span><div>
                              <p>The Command Rules page appears. </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Click <span class="bold">Create</span>.</span><div>
                              <p>The Create Command Rule page appears. </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Enter the following settings: </span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">Command:</span> Select <span class="bold">CREATE TABLE</span></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Status:</span> Set to <span class="bold">Enabled</span> so that the command rule is active. 
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Applicable Object Owner:</span> Select <span class="bold">SCOTT</span>. 
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Applicable Object Name:</span> Set to <span class="bold">%</span> so that it applies to all objects in the <code class="codeph">SCOTT</code> schema. 
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Rule Set:</span> Select <span class="bold">Disabled</span> so that no one can create tables in the <code class="codeph">SCOTT</code> schema. 
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Click <span class="bold">OK</span>.</span><div>
                              <p>Do not exit Database Vault Administrator </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>Command rules take effect immediately. Right away, user <code class="codeph">SCOTT</code> is prevented from creating tables, even though he is still in the same user session he was in a moment ago, before you created the CREATE TABLE command rule. 
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-946EE4C3-1555-43E0-84F6-C74F8B80EF74" title="In this tutorial, you create a simple local command rule to control whether users can create tables in the SCOTT schema.">Tutorial: Using a Command Rule to Control Table Creations by a User</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70218"></a><div class="props_rev_3"><a id="GUID-13831052-DD9E-4895-8EF8-26E353B4DCE2" name="GUID-13831052-DD9E-4895-8EF8-26E353B4DCE2"></a><h4 id="DVADM-GUID-13831052-DD9E-4895-8EF8-26E353B4DCE2" class="sect4">Step 3: Test the Command Rule</h4>
                  <div>
                     <p>Next, you are ready to test the CREATE TABLE local command rule. </p>
                     <div class="section">
                        <ol>
                           <li>
                              <p>In SQL*Plus, ensure that you are logged on as user <code class="codeph">SCOTT</code>. 
                              </p><pre class="oac_no_warn" dir="ltr">CONNECT SCOTT <span class="italic">--Or, CONNECT SCOTT@hrpdb</span>
Enter password: <span class="italic">password</span>
</pre></li>
                           <li>
                              <p>Try to create a table. </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE t1 (num NUMBER);
</pre><p>The following output should appear:</p><pre class="oac_no_warn" dir="ltr">ORA-47400: Command Rule violation for create table on SCOTT.T1
</pre><p>As you can see, <code class="codeph">SCOTT</code> is no longer allowed to create tables, even in his own schema. 
                              </p>
                           </li>
                           <li>
                              <p>In Oracle Database Vault Administrator, do the following: </p>
                              <ol type="a">
                                 <li>
                                    <p>In the Command Rules page, select the CREATE TABLE command rule and then click <span class="bold">Edit</span>. 
                                    </p>
                                 </li>
                                 <li>
                                    <p>In the Edit Command Rule page, select <span class="bold">Enabled</span> from the <span class="bold">Rule Set</span> list. 
                                    </p>
                                 </li>
                                 <li>
                                    <p>Click <span class="bold">OK</span>. 
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>In SQL*Plus, as user <code class="codeph">SCOTT</code>, try creating the table again. 
                              </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE t1 (num NUMBER);

Table created.
</pre></li>
                        </ol>
                        <p>Now that the <code class="codeph">CREATE TABLE</code> command rule is set to Enabled, user <code class="codeph">SCOTT</code> is once again permitted to create tables. (Do not exit SQL*Plus.)
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-946EE4C3-1555-43E0-84F6-C74F8B80EF74" title="In this tutorial, you create a simple local command rule to control whether users can create tables in the SCOTT schema.">Tutorial: Using a Command Rule to Control Table Creations by a User</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DVADM70219"></a><div class="props_rev_3"><a id="GUID-68B15658-8316-4569-9DA3-D2BDB9408C5E" name="GUID-68B15658-8316-4569-9DA3-D2BDB9408C5E"></a><h4 id="DVADM-GUID-68B15658-8316-4569-9DA3-D2BDB9408C5E" class="sect4">Step 4: Remove the Components for this Tutorial</h4>
                  <div>
                     <p>You can remove the components that you created for this tutorial if you no longer need them. </p>
                     <div class="section">
                        <ol>
                           <li>
                              <p>In Oracle Database Vault Administrator, remove the CREATE TABLE command rule as follows: </p>
                              <ol type="a">
                                 <li>
                                    <p>Return to the Command Rules page. </p>
                                 </li>
                                 <li>
                                    <p>Select the CREATE TABLE local command rule and then click <span class="bold">Delete</span>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>In the Confirmation window, click <span class="bold">Yes</span>. 
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>Log into the database instance as user <code class="codeph">SCOTT</code> and remove the <code class="codeph">t1</code> table. 
                              </p><pre class="oac_no_warn" dir="ltr">DROP TABLE t1;
</pre></li>
                           <li>
                              <p>If you no longer need the <code class="codeph">SCOTT</code> account to be available, then connect as the Database Vault Account Manager and enter the following <code class="codeph">ALTER USER</code> statement: 
                              </p><pre class="oac_no_warn" dir="ltr">CONNECT bea_dvacctmgr <span class="italic">--Or, CONNECT bea_dvacctmgr@hrpdb</span>
Enter password: <span class="italic">password</span>

ALTER USER SCOTT ACCOUNT LOCK PASSWORD EXPIRE;</pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-946EE4C3-1555-43E0-84F6-C74F8B80EF74" title="In this tutorial, you create a simple local command rule to control whether users can create tables in the SCOTT schema.">Tutorial: Using a Command Rule to Control Table Creations by a User</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DVADM70220"></a><div class="props_rev_3"><a id="GUID-9D6645BC-F4F7-44CC-95F9-D7DA85771477" name="GUID-9D6645BC-F4F7-44CC-95F9-D7DA85771477"></a><h3 id="DVADM-GUID-9D6645BC-F4F7-44CC-95F9-D7DA85771477" class="sect3">Guidelines for Designing Command Rules</h3>
               <div>
                  <p>Oracle provides guidelines for designing command rules.</p>
                  <ul style="list-style-type: disc;">
                     <li></li>
                     <li>
                        <p>Create finer-grained command rules, because they are far easier to maintain. </p>
                        <p>For example, if you want to prevent <code class="codeph">SELECT</code> statements from occurring on specific schema objects, then design multiple command rules to stop the <code class="codeph">SELECT</code> statements on those specific schema objects, rather than creating a general command rule to prevent <code class="codeph">SELECT</code> statements in the schema level.
                        </p>
                     </li>
                     <li>
                        <p>When designing rules for the <code class="codeph">CONNECT</code> event, be careful to include logic that does not inadvertently lock out any required user connections. If any account has been locked out accidentally, ask a user who has been granted the <code class="codeph">DV_ADMIN</code> or <code class="codeph">DV_OWNER</code> role to log in and correct the rule that is causing the lock-out problem. The CONNECT command rule does not apply to users with the <code class="codeph">DV_OWNER</code> and <code class="codeph">DV_ADMIN</code> roles. This prevents improperly configured CONNECT command rules from causing a complete lock-out.
                        </p>
                        <p>If the account has been locked out, you can disable Oracle Database Vault, correct the rule that is causing the lock-out problem, and then reenable Oracle Database Vault. Even when Oracle Database Vault is disabled, you still can use Database Vault Administrator and the Database Vault PL/SQL packages. See <a href="disabling-and-enabling-oracle-database-vault.html#GUID-89689CF6-63E9-45BC-AF12-10CD42A2DFC6" title="Periodically you must disable and then re-enable Oracle Database Vault, for activities such as installing Oracle Database optional products or features.">Disabling and Enabling Oracle&nbsp;Database&nbsp;Vault</a>, for instructions on disabling and reenabling Database Vault.
                        </p>
                     </li>
                     <li>
                        <p>Sometimes you must temporarily relax an enabled command rule for an administrative task. Rather than disabling the command rule, have the Security Manager (the account with the <code class="codeph">DV_ADMIN</code> or <code class="codeph">DV_OWNER</code> role) log in, set the rule set to <span class="bold">Enabled</span>, turn on <span class="bold">Auditing on Success or Failure</span> for the default rule set named Enabled, and then set the command rule back to its original rule set when the task is complete. (Be aware that in a unified auditing environment, this setting does not work. Instead, you must create a unified audit policy. <a href="../dbseg/configuring-audit-policies.html#DBSEG419" target="_blank"><span><cite>Oracle Database Security Guide</cite></span></a> describes how to create unified audit policies for Database Vault.)
                        </p>
                     </li>
                     <li>
                        <p>When designing command rules, be careful to consider automated processes such as backup where these procedures may be inadvertently disabled. You can account for these tasks by creating rules that allow the command when a series of Oracle Database Vault factors is known to be true (for example, the program being used), and the account being used or the computer or network on which the client program is running. </p>
                     </li>
                     <li>
                        <p>You can test the development phase of a command rule by using simulation mode, which enables the command rule but writes detailed information about it to a log file.</p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls.">Using Simulation Mode for Logging Realm and Command Rule Activities</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="DVADM70221"></a><div class="props_rev_3"><a id="GUID-C324D4D9-B66B-4A6F-8159-120C3E322426" name="GUID-C324D4D9-B66B-4A6F-8159-120C3E322426"></a><h3 id="DVADM-GUID-C324D4D9-B66B-4A6F-8159-120C3E322426" class="sect3">How Command Rules Affect Performance</h3>
               <div>
                  <p>The performance of a command rule depends on the complexity of the rules in the rule set associated with the command rule. </p>
                  <p>For example, suppose a rule set invokes a PL/SQL function that takes 5 seconds to run. In this case, a command rule that uses that rule set would take 5 seconds to grant access for the command statement to run. </p>
                  <p>You can check the system performance by running tools such as Oracle Enterprise Manager (including Oracle Enterprise Manager Cloud Control, which is installed by default with Oracle Database), Automatic Workload Repository (AWR), and <code class="codeph">TKPROF</code>.
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-C324D4D9-B66B-4A6F-8159-120C3E322426__GUID-6C8AD774-B309-4603-B7C4-C6D321E3E209">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../tgdba/performance-tuning-overview.html#TGDBA025" target="_blank"><span><cite>Oracle Database Performance Tuning Guide</cite></span></a> to learn how to monitor database performance
                           </p>
                        </li>
                        <li>
                           <p><a href="../tgsql/performing-application-tracing.html#TGSQL809" target="_blank"><span><cite>Oracle Database SQL Tuning Guide</cite></span></a> to monitor the performance of individual SQL and PL/SQL statements
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DVADM70223"></a><a id="DVADM70222"></a><div class="props_rev_3"><a id="GUID-C1CE7C50-84E0-4E08-B60B-89D13769B66E" name="GUID-C1CE7C50-84E0-4E08-B60B-89D13769B66E"></a><h3 id="DVADM-GUID-C1CE7C50-84E0-4E08-B60B-89D13769B66E" class="sect3">Command Rule Related Reports and Data Dictionary View</h3>
               <div>
                  <p>Oracle Database Vault provides reports and a data dictionary view that are useful for analyzing command rules.</p>
                  <div class="section">
                     <p><a href="configuring-command-rules.html#GUID-C1CE7C50-84E0-4E08-B60B-89D13769B66E__BABGAIFJ" title="command rules reports">Table 6-2</a> lists the Oracle Database Vault report. See <a href="oracle-database-vault-reports.html#GUID-1B6D02DE-3FB2-4ADB-9916-4491B37FDECD" title="Oracle Database Vault provides reports that track activities, such as the Database Vault configuration settings.">Oracle Database Vault Reports</a>, for information about how to run these reports. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-C1CE7C50-84E0-4E08-B60B-89D13769B66E__BABGAIFJ">
                     <p class="titleintable">Table 6-2 Reports Related to Command Rules</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Reports Related to Command Rules" summary="command rules reports" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="49%" id="d26291e4306">Report</th>
                              <th align="left" valign="bottom" width="51%" id="d26291e4309">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="49%" id="d26291e4314" headers="d26291e4306 ">
                                 <p><a href="oracle-database-vault-reports.html#GUID-10BA31F8-F572-41E7-B22D-4654A5A3EE9C" title="The Command Rule Audit Report shows audit records generated by command rule processing operations.">Command Rule Audit Report</a></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d26291e4314 d26291e4309 ">
                                 <p>Lists audit records generated by command rule processing operations </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="49%" id="d26291e4325" headers="d26291e4306 ">
                                 <p><a href="oracle-database-vault-reports.html#GUID-DB10DAF0-4E4C-4A11-A9B8-A227DC82D8AA" title="The Command Rule Configuration Issues Report displays command rules that have configuration issues.">Command Rule Configuration Issues Report</a></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d26291e4325 d26291e4309 ">
                                 <p>Tracks rule violations, in addition to other configuration issues the command rule may have</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="49%" id="d26291e4336" headers="d26291e4306 ">
                                 <p><a href="oracle-database-vault-reports.html#GUID-69468D28-8100-44D2-B14B-423A64C0F9FB" title="The object privilege reports track privileges affected by PUBLIC, direct object privileges, and object dependencies.">Object Privilege Reports</a></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d26291e4336 d26291e4309 ">
                                 <p>Lists object privileges that the command rule affects</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="49%" id="d26291e4350" headers="d26291e4306 ">
                                 <p><a href="oracle-database-vault-reports.html#GUID-DA265416-AD9D-4A8B-8BAA-37370F658121" title="The sensitive objects reports track activities such as grants on the EXECUTE privilege on SYS schema objects and access to sensitive objects.">Sensitive Objects Reports</a></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d26291e4350 d26291e4309 ">
                                 <p>Lists objects that the command rule affects</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="49%" id="d26291e4367" headers="d26291e4306 ">
                                 <p><a href="oracle-database-vault-reports.html#GUID-162BB69D-9C1F-4FB8-959E-1B8C21FE6FF9" title="The Rule Set Configuration Issues Report displays Oracle Database Vault rule set configuration issues.">Rule Set Configuration Issues Report</a></p>
                              </td>
                              <td align="left" valign="top" width="51%" headers="d26291e4367 d26291e4309 ">
                                 <p>Lists rules sets that have no rules defined or enabled, which may affect the command rules that use them</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>You can use the <code class="codeph">DBA_DV_COMMAND_RULE</code> data dictionary view to find the SQL statements that are protected by command rules. See <a href="oracle-database-vault-data-dictionary-views.html#GUID-9A852E4D-D107-4FDD-8262-B6BB5852F88C" title="The DBA_DV_COMMAND_RULE data dictionary view lists the SQL statements that are protected by command rules.">DBA_DV_COMMAND_RULE View</a> for more information.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-command-rules.html#GUID-8B7EABE6-66F7-4142-A32A-697CD185BCAB" title="You can create command rules or use the default command rules to protect DDL and DML statements.">Configuring Command Rules</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>