<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Administering Oracle Database on Linux</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database Administrator's Reference">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database Administrator's Reference for Linux and UNIX System-Based Operating Systems">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="administrators-reference-linux-and-unix-system-based-operating-systems.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-07T05:04:28-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2006, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96356-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="tuning-oracle-database.html" title="Previous" type="text/html">
      <link rel="next" href="administering-oracle-database-on-oracle-solaris.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Administrator's Reference for Linux and UNIX System-Based Operating Systems">
    <meta name="dcterms.isVersionOf" content="UNXAR">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="tuning-oracle-database.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="administering-oracle-database-on-oracle-solaris.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database Administrator's Reference</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Administering Oracle Database on Linux</li>
            </ol>
            <a id="GUID-340D998F-832C-4797-9C3B-5B55534DBA2B" name="GUID-340D998F-832C-4797-9C3B-5B55534DBA2B"></a><a id="UNXAR011"></a>
            
            <h2 id="UNXAR-GUID-340D998F-832C-4797-9C3B-5B55534DBA2B" class="sect2"><span class="enumeration_chapter">A </span> Administering Oracle Database on Linux
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This appendix contains information about administering Oracle Database on Linux.</p>
               <p>It contains the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="administering-oracle-database-on-linux.html#GUID-DD84F46F-4EBD-4D4C-A2C3-22EF994699CF">Supporting Asynchronous Input-Output</a></p>
                  </li>
                  <li>
                     <p><a href="administering-oracle-database-on-linux.html#GUID-A46C0E76-770E-4C0B-B522-B004C756D0F1">Asynchronous Input-Output Support</a></p>
                  </li>
                  <li>
                     <p><a href="administering-oracle-database-on-linux.html#GUID-D64FDD08-56F3-46C5-8845-66D5BB62E694">Enabling Direct Input-Output Support</a></p>
                  </li>
                  <li>
                     <p><a href="administering-oracle-database-on-linux.html#GUID-3A268E58-0D3F-4C82-B8DA-99298292327A">Enabling Simultaneous Multithreading</a></p>
                  </li>
                  <li>
                     <p><a href="administering-oracle-database-on-linux.html#GUID-5FBCEDFE-6548-44B5-9A96-9F89D7FEC5AF">Allocating Shared Resources</a></p>
                  </li>
                  <li>
                     <p><a href="administering-oracle-database-on-linux.html#GUID-00ABFA51-266B-422A-A730-A30FF37AAF09" title="Cgroups, or control groups, improve database performance by associating a dedicated set of CPUs to a database instance. Each database instance can only use the resources in its cgroup.">About Creating cgroups on Linux Systems</a></p>
                  </li>
                  <li>
                     <p><a href="administering-oracle-database-on-linux.html#GUID-CC72CEDC-58AA-4065-AC7D-FD4735E14416" title="Review this information if your operating system has HugePages enabled.Oracle recommends that you disable Transparent HugePages before you start installation.">Overview of HugePages</a></p>
                  </li>
               </ul>
               <div class="infoboxnote" id="GUID-340D998F-832C-4797-9C3B-5B55534DBA2B__GUID-DE0BDEB5-CFA8-4B5C-80AB-112C5A590120">
                  <p class="notep1">Note:</p>
                  <p>Starting with Oracle Database 11<span class="italic">g</span> Release 2 (11.2), Linux x86-64 and IBM: Linux on System z media does not contain Linux x86 binaries.
                  </p>
               </div>
            </div><a id="UNXAR334"></a><div class="props_rev_3"><a id="GUID-DD84F46F-4EBD-4D4C-A2C3-22EF994699CF" name="GUID-DD84F46F-4EBD-4D4C-A2C3-22EF994699CF"></a><h3 id="UNXAR-GUID-DD84F46F-4EBD-4D4C-A2C3-22EF994699CF" class="sect3"><span class="enumeration_section">A.1 </span>Supporting Asynchronous Input-Output
               </h3>
               <div>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-DD84F46F-4EBD-4D4C-A2C3-22EF994699CF__GUID-3062A27B-1DAE-4BAD-9E6C-8A9F84448F48">
                        <p class="notep1">Note:</p>
                        <p>On Linux, Automatic Storage Management uses asynchronous Input-Output by default. Asynchronous Input-Output is not supported for database files stored on Network File Systems.</p>
                     </div>
                     <p>Oracle Database supports kernel asynchronous Input-Output. Asynchronous Input-Output is enabled by default on raw volumes. Automatic Storage Management uses asynchronous Input-Output by default.</p>
                     <p>By default, the <code class="codeph">DISK_ASYNCH_IO</code> initialization parameter in the parameter file is set to TRUE. To enable asynchronous Input-Output on file system files:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Ensure that all Oracle Database files are located on file systems that support asynchronous Input-Output.</span></li>
                     <li class="stepexpand"><span>Set the <code class="codeph">FILESYSTEMIO_OPTIONS</code> initialization parameter in the parameter file to <code class="codeph">ASYNCH</code> or <code class="codeph">SETALL</code>.</span><div>
                           <div class="infoboxnote" id="GUID-DD84F46F-4EBD-4D4C-A2C3-22EF994699CF__GUID-252BBFA6-0E23-4D72-B293-278678BE1A01">
                              <p class="notep1">Note:</p>
                              <p>If the file system files are managed through ODM library interface or Direct NFS Client, asynchronous Input-Output is enabled by default. There is no need to set <code class="codeph">FILESYSTEMIO_OPTIONS</code> to enable asynchronous Input-Output in these environments.
                              </p>
                           </div>
                        </div>
                     </li>
                  </ol>
               </div>
            </div><a id="UNXAR335"></a><div class="props_rev_3"><a id="GUID-A46C0E76-770E-4C0B-B522-B004C756D0F1" name="GUID-A46C0E76-770E-4C0B-B522-B004C756D0F1"></a><h3 id="UNXAR-GUID-A46C0E76-770E-4C0B-B522-B004C756D0F1" class="sect3"><span class="enumeration_section">A.2 </span>Asynchronous Input-Output Support
               </h3>
               <div>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-A46C0E76-770E-4C0B-B522-B004C756D0F1__GUID-CA85F418-7CDF-45FB-ADA0-6C48401A86BB">
                        <p class="notep1">Note:</p>
                        <p>On Linux, Automatic Storage Management uses asynchronous Input-Output by default. Asynchronous Input-Output is not supported for database files stored on Network File Systems.</p>
                     </div>
                     <p>Oracle Database supports kernel asynchronous Input-Output. This feature is disabled by default. </p>
                     <p>By default, the <code class="codeph">DISK_ASYNCH_IO</code> initialization parameter in the parameter file is set to TRUE<span> to enable asynchronous I/O on raw devices</span>. To enable asynchronous Input-Output on file system files:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li><span>Ensure that all Oracle Database files are located on file systems that support asynchronous Input-Output.</span></li>
                     <li><span>Set the <code class="codeph">FILESYSTEMIO_OPTIONS</code> initialization parameter in the parameter file to <code class="codeph">ASYNCH</code> to enable asynchronous Input-Output. If you want to enable both asynchronous Input-Output and direct Input-Output, set the <code class="codeph">FILESYSTEMIO_OPTIONS</code> initialization parameter in the parameter file to <code class="codeph">SETALL.</code> </span></li>
                  </ol>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
            </div><a id="UNXAR336"></a><div class="props_rev_3"><a id="GUID-D64FDD08-56F3-46C5-8845-66D5BB62E694" name="GUID-D64FDD08-56F3-46C5-8845-66D5BB62E694"></a><h3 id="UNXAR-GUID-D64FDD08-56F3-46C5-8845-66D5BB62E694" class="sect3"><span class="enumeration_section">A.3 </span>Enabling Direct Input-Output Support
               </h3>
               <div>
                  <div class="section">
                     <p>Direct Input-Output support is available and supported on Linux. </p>
                     <p>To enable direct Input-Output support:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Set the <code class="codeph">FILESYSTEMIO_OPTIONS</code> initialization parameter to <code class="codeph">DIRECTIO</code>.
                           </p>
                        </li>
                        <li>
                           <p>Set the <code class="codeph">FILESYSTEMIO_OPTIONS</code> initialization parameter in the parameter file to <code class="codeph">SETALL</code>, which will enable both asynchronous Input-Output and direct Input-Output.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="UNXAR339"></a><div class="props_rev_3"><a id="GUID-3A268E58-0D3F-4C82-B8DA-99298292327A" name="GUID-3A268E58-0D3F-4C82-B8DA-99298292327A"></a><h3 id="UNXAR-GUID-3A268E58-0D3F-4C82-B8DA-99298292327A" class="sect3"><span class="enumeration_section">A.4 </span>Enabling Simultaneous Multithreading
               </h3>
               <div>
                  <p>If Simultaneous Multithreading is enabled, then the <code class="codeph">v$osstat</code> view reports two additional rows corresponding to the online logical (<code class="codeph">NUM_LCPUS</code>) and virtual CPUs (<code class="codeph">NUM_VCPUS</code>).
                  </p>
               </div>
            </div><a id="UNXAR340"></a><div class="props_rev_3"><a id="GUID-5FBCEDFE-6548-44B5-9A96-9F89D7FEC5AF" name="GUID-5FBCEDFE-6548-44B5-9A96-9F89D7FEC5AF"></a><h3 id="UNXAR-GUID-5FBCEDFE-6548-44B5-9A96-9F89D7FEC5AF" class="sect3"><span class="enumeration_section">A.5 </span>Allocating Shared Resources
               </h3>
               <div>
                  <div class="section">
                     <p>To use the <code class="codeph">MEMORY_TARGET</code> or <code class="codeph">MEMORY_MAX_TARGET</code> feature, the following kernel parameters must be modified.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">/dev/shm</code> mount point should be equal in size or larger than the value of <code class="codeph">SGA_MAX_SIZE</code>, if set, or should be set to be at least <code class="codeph">MEMORY_TARGET</code> or <code class="codeph">MEMORY_MAX_TARGET</code>, whichever is larger. For example, with <code class="codeph">MEMORY_MAX_TARGET=4GB</code> only set, to create a 4 GB system on the <code class="codeph">/dev/shm</code> mount point:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Run the following command as the <code class="codeph">root</code> user:
                                 </p><pre class="oac_no_warn" dir="ltr"># mount -t tmpfs shmfs -o size=4g /dev/shm
</pre></li>
                              <li>
                                 <p>Ensure that the in-memory file system is mounted when the system restarts, add an entry in the <code class="codeph">/etc/fstab</code> file similar to the following:
                                 </p><pre class="oac_no_warn" dir="ltr">  tmpfs /dev/shm tmpfs size=4g 0
</pre></li>
                           </ul>
                        </li>
                        <li>
                           <p>The number of file descriptors for each Oracle instance are increased by 512*<code class="codeph">PROCESSES</code>. Therefore, the maximum number of file descriptors should be at least this value, plus some more for the operating system requirements. For example, if the <code class="codeph">cat /proc/sys/fs/file-max</code> command returns <span>32768</span> and <code class="codeph">PROCESSES</code> are 100, you can set it to 6815744 or higher as <code class="codeph">root</code>, to have 51200 available for Oracle. Use one of the following options to set the value for the <code class="codeph">file-max</code> descriptor.
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Run the following command:</p><pre class="oac_no_warn" dir="ltr">echo 6815744 &gt; /proc/sys/fs/file-max
</pre><p>OR</p>
                              </li>
                              <li>
                                 <p>Modify the following entry in the <code class="codeph">/etc/sysctl.conf</code> file and restart the system as <code class="codeph">root</code>.
                                 </p><pre class="oac_no_warn" dir="ltr">fs.file-max = 6815744
</pre></li>
                           </ul>
                        </li>
                        <li>
                           <p>Per-process number of file descriptors must be at least 512. For example, as <code class="codeph">root</code> run the following command.
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>On bash and sh:</p><pre class="oac_no_warn" dir="ltr"># ulimit -n
</pre></li>
                              <li>
                                 <p>On csh:</p><pre class="oac_no_warn" dir="ltr"># limit descriptors</pre></li>
                           </ul>
                           <p>If the preceding command returns 200, then run the following command to set the value for the per processor file descriptors limit, for example to 1000:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>On bash and sh:</p><pre class="oac_no_warn" dir="ltr"># sudo sh
# ulimit -n 1000
</pre></li>
                              <li>
                                 <p>On csh:</p><pre class="oac_no_warn" dir="ltr"># sudo sh
# limit descriptors 1000
</pre></li>
                           </ul>
                        </li>
                        <li>
                           <p><code class="codeph">MEMORY_TARGET</code> and <code class="codeph">MEMORY_MAX_TARGET</code> cannot be used when <code class="codeph">LOCK_SGA</code> is enabled. <code class="codeph">MEMORY_TARGET</code> and <code class="codeph">MEMORY_MAX_TARGET</code> also cannot be used with huge pages on Linux.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-00ABFA51-266B-422A-A730-A30FF37AAF09" name="GUID-00ABFA51-266B-422A-A730-A30FF37AAF09"></a><h3 id="UNXAR-GUID-00ABFA51-266B-422A-A730-A30FF37AAF09" class="sect3"><span class="enumeration_section">A.6 </span>About Creating Cgroups on Linux Systems
               </h3>
               <div>
                  <p>Cgroups, or control groups, improve database performance by associating a dedicated set of CPUs to a database instance. Each database instance can only use the resources in its cgroup.</p>
                  <p>When consolidating on a large server, you may want to restrict the database to a specific subset of the CPU and memory. This feature makes it easy to enable CPU and memory restrictions for an Oracle Database instance.</p>
                  <p>Use the <code class="codeph">setup_processor_group.sh</code> script to create cgroups. Download this script from note 1585184.1 on the My Oracle Support website:
                  </p>
                  <p><a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1585184.1" target="_blank">https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1585184.1</a></p>
               </div>
            </div><a id="UNXAR400"></a><div class="props_rev_3"><a id="GUID-CC72CEDC-58AA-4065-AC7D-FD4735E14416" name="GUID-CC72CEDC-58AA-4065-AC7D-FD4735E14416"></a><h3 id="UNXAR-GUID-CC72CEDC-58AA-4065-AC7D-FD4735E14416" class="sect3"><span class="enumeration_section">A.7 </span>Overview of HugePages
               </h3>
               <div>
                  <p>HugePages is a feature integrated into the Linux kernel 2.6. Enabling HugePages makes it possible for the operating system to support memory pages greater than the default (usually 4 KB). Using very large page sizes can improve system performance by reducing the amount of system resources required to access page table entries. HugePages is useful for both 32-bit and 64-bit configurations. HugePage sizes vary from 2 MB to 256 MB, depending on the kernel version and the hardware architecture. For Oracle Databases, using HugePages reduces the operating system maintenance of page states, and increases Translation Lookaside Buffer (TLB) hit ratio. </p>
                  <div class="infoboxnote" id="GUID-CC72CEDC-58AA-4065-AC7D-FD4735E14416__GUID-2DB721A0-2095-4EC1-A255-5475EC591852">
                     <p class="notep1">Note:</p>
                     <p>Transparent Hugepages is currently not an alternative to manually configure HugePages.</p>
                  </div>
                  <p>This section includes the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="administering-oracle-database-on-linux.html#GUID-C042125D-9BE1-48D0-8C70-74251A0AF60C" title="Review this information if your operating system has HugePages enabled.">Reviewing HugePages Memory Allocation</a></p>
                     </li>
                     <li>
                        <p><a href="administering-oracle-database-on-linux.html#GUID-76C03D99-6025-41F2-8BE3-F6DCDB1DCEE0">Using HugePages on Linux</a></p>
                     </li>
                     <li>
                        <p><a href="administering-oracle-database-on-linux.html#GUID-ECABF30C-136B-4D12-A371-6AC8980BB46E">Tuning SGA With HugePages</a></p>
                     </li>
                     <li>
                        <p><a href="administering-oracle-database-on-linux.html#GUID-19BFCC60-BA4C-4750-85EB-7432282A9556">Configuring HugePages on Linux</a></p>
                     </li>
                     <li>
                        <p><a href="administering-oracle-database-on-linux.html#GUID-95CAEFDE-489B-453A-B5D5-4461DABBEEAD">Restrictions for HugePages Configurations</a></p>
                     </li>
                     <li>
                        <p><a href="administering-oracle-database-on-linux.html#GUID-02E9147D-D565-4AF8-B12A-8E6E9F74BEEA" title="Oracle recommends that you disable Transparent HugePages before you start installation.">Disabling Transparent HugePages</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-C042125D-9BE1-48D0-8C70-74251A0AF60C" name="GUID-C042125D-9BE1-48D0-8C70-74251A0AF60C"></a><h4 id="UNXAR-GUID-C042125D-9BE1-48D0-8C70-74251A0AF60C" class="sect4"><span class="enumeration_section">A.7.1 </span>Reviewing HugePages Memory Allocation
                  </h4>
                  <div>
                     <p>Review this information if your operating system has HugePages enabled.</p>
                     <p>On Linux platform installations, Oracle recommends that you use HugePages to obtain the best performance for Oracle Databases. When you upgrade Oracle Grid Infrastructure and Oracle Databases on servers that have HugePages enabled, Oracle recommends that you review your HugePages memory allocation requirements. </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C042125D-9BE1-48D0-8C70-74251A0AF60C__GUID-F4F6A32B-F349-4C63-A36E-3D2B7C0DF3A2">GIMR and HugePages Memory</p>
                        <p>Oracle Grid Infrastructure installations include the Grid Infrastructure Management Repository (GIMR). When HugePages is configured on cluster member nodes, the GIMR system global area (SGA) is installed into HugePages memory. The GIMR SGA occupies up to 1 GB of HugePages memory. Oracle Grid Infrastructure starts up before Oracle Databases installed on the cluster.  </p>
                        <p> If your cluster member node operating system memory allocations to HugePages are insufficient for the size of the SGAs for all of the Oracle Database instances on the cluster, then you may find that one or more of your Oracle Database SGAs are mapped to regular pages, instead of Huge Pages, which reduces expected performance. To avoid this issue, when you plan your upgrade, ensure that the memory you reserve for HugePages is large enough to accommodate your memory requirements.</p>
                        <p>Allocate memory to HugePages large enough for all databases planned to run SGA on the cluster, and to accommodate the SGA for the Grid Infrastructure Management Repository. </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="UNXAR330"></a><div class="props_rev_3"><a id="GUID-76C03D99-6025-41F2-8BE3-F6DCDB1DCEE0" name="GUID-76C03D99-6025-41F2-8BE3-F6DCDB1DCEE0"></a><h4 id="UNXAR-GUID-76C03D99-6025-41F2-8BE3-F6DCDB1DCEE0" class="sect4"><span class="enumeration_section">A.7.2 </span>Using HugePages on Linux
                  </h4>
                  <div>
                     <p>To enable Oracle Database to use large pages (sometimes called HugePages) on Linux, set the value of the <code class="codeph">vm.nr_hugepages</code> kernel parameter to specify the number of large pages that you want to reserve. You must specify adequate large pages to hold the entire SGA for the database instance. To determine the required parameter value, divide the SGA size for the instance by the size of a large page, then round up the result to the nearest integer.
                     </p>
                     <p>To determine the default large page size, run the following command:</p><pre class="oac_no_warn" dir="ltr"># grep Hugepagesize /proc/meminfo
</pre><p>For example, if <code class="codeph">/proc/meminfo</code> lists the large page size as 2 MB, and the total SGA size for the instance is 1.6 GB, then set the value for the <code class="codeph">vm.nr_hugepages</code> kernel parameter to 820 (1.6 GB / 2 MB = 819.2).
                     </p>
                  </div>
               </div><a id="UNXAR401"></a><div class="props_rev_3"><a id="GUID-ECABF30C-136B-4D12-A371-6AC8980BB46E" name="GUID-ECABF30C-136B-4D12-A371-6AC8980BB46E"></a><h4 id="UNXAR-GUID-ECABF30C-136B-4D12-A371-6AC8980BB46E" class="sect4"><span class="enumeration_section">A.7.3 </span>Tuning SGA With HugePages
                  </h4>
                  <div>
                     <p>Without HugePages, the operating system keeps each 4 KB of memory as a page. When it allocates pages to the database System Global Area (SGA), the operating system kernel must continually update its page table with the page lifecycle (dirty, free, mapped to a process, and so on) for each 4 KB page allocated to the SGA.</p>
                     <p>With HugePages, the operating system page table (virtual memory to physical memory mapping) is smaller, because each page table entry is pointing to pages from 2 MB to 256 MB. </p>
                     <p>Also, the kernel has fewer pages whose lifecycle must be monitored. For example, if you use HugePages with 64-bit hardware, and you want to map 256 MB of memory, you may need one page table entry (PTE). If you do not use HugePages, and you want to map 256 MB of memory, then you must have 256 MB * 1024 KB/4 KB = 65536 PTEs. </p>
                     <p>HugePages provides the following advantages:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Increased performance through increased TLB hits</p>
                        </li>
                        <li>
                           <p>Pages are locked in memory and never swapped out, which provides RAM for shared memory structures such as SGA</p>
                        </li>
                        <li>
                           <p>Contiguous pages are preallocated and cannot be used for anything else but for System V shared memory (for example, SGA)</p>
                        </li>
                        <li>
                           <p>Less bookkeeping work for the kernel for that part of virtual memory because of larger page sizes</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="UNXAR402"></a><div class="props_rev_3"><a id="GUID-19BFCC60-BA4C-4750-85EB-7432282A9556" name="GUID-19BFCC60-BA4C-4750-85EB-7432282A9556"></a><h4 id="UNXAR-GUID-19BFCC60-BA4C-4750-85EB-7432282A9556" class="sect4"><span class="enumeration_section">A.7.4 </span>Configuring HugePages on Linux
                  </h4>
                  <div>
                     <div class="section">
                        <p>Complete the following steps to configure HugePages on the computer:</p>
                        <ol>
                           <li>
                              <p>Run the following command to determine if the kernel supports HugePages:</p><pre class="oac_no_warn" dir="ltr">$ grep Huge /proc/meminfo
</pre></li>
                           <li>
                              <p>Some Linux systems do not support HugePages by default. For such systems, build the Linux kernel using the <code class="codeph">CONFIG_HUGETLBFS</code> and <code class="codeph">CONFIG_HUGETLB_PAGE </code>configuration options. <code class="codeph">CONFIG_HUGETLBFS</code> is located under File Systems and <code class="codeph">CONFIG_HUGETLB_PAGE</code> is selected when you select <code class="codeph">CONFIG_HUGETLBFS</code>.
                              </p>
                           </li>
                           <li>
                              <p>Edit the <code class="codeph">memlock</code> setting in the <code class="codeph">/etc/security/limits.conf</code> file. The <code class="codeph">memlock</code> setting is specified in KB, and the maximum locked memory limit should be set to at least 90 percent of the current RAM when HugePages memory is enabled and at least 3145728 KB (3 GB) when HugePages memory is disabled. For example, if you have 64 GB RAM installed, then add the following entries to increase the maximum locked-in-memory address space:
                              </p><pre class="oac_no_warn" dir="ltr">*   soft   memlock    60397977
*   hard   memlock    60397977
</pre><p>You can also set the <code class="codeph">memlock</code> value higher than your SGA requirements.
                              </p>
                           </li>
                           <li>
                              <p>Log in as <code class="codeph">oracle</code> user again and run the <code class="codeph">ulimit -l</code> command to verify the new <code class="codeph">memlock </code>setting:
                              </p><pre class="oac_no_warn" dir="ltr">$ ulimit -l
60397977
</pre></li>
                           <li>
                              <p>Run the following command to display the value of <code class="codeph">Hugepagesize</code> variable: 
                              </p><pre class="oac_no_warn" dir="ltr">$ grep Hugepagesize /proc/meminfo
</pre></li>
                           <li>
                              <p>Complete the following procedure to create a script that computes recommended values for <code class="codeph">hugepages</code> configuration for the current shared memory segments:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>Create a text file named <code class="codeph">hugepages_settings.sh</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Add the following content in the file:</p><pre class="oac_no_warn" dir="ltr">#!/bin/bash
#
# hugepages_settings.sh
#
# Linux bash script to compute values for the
# recommended HugePages/HugeTLB configuration
#
# Note: This script does calculation for all shared memory
# segments available when the script is run, no matter it
# is an Oracle RDBMS shared memory segment or not.
# Check for the kernel version
KERN=`uname -r | awk -F. '{ printf("%d.%d\n",$1,$2); }'`
# Find out the HugePage size
HPG_SZ=`grep Hugepagesize /proc/meminfo | awk {'print $2'}`
# Start from 1 pages to be on the safe side and guarantee 1 free HugePage
NUM_PG=1
# Cumulative number of pages required to handle the running shared memory segments
for SEG_BYTES in `ipcs -m | awk {'print $5'} | grep "[0-9][0-9]*"`
do
   MIN_PG=`echo "$SEG_BYTES/($HPG_SZ*1024)" | bc -q`
   if [ $MIN_PG -gt 0 ]; then
      NUM_PG=`echo "$NUM_PG+$MIN_PG+1" | bc -q`
   fi
done
# Finish with results
case $KERN in
   '2.4') HUGETLB_POOL=`echo "$NUM_PG*$HPG_SZ/1024" | bc -q`;
          echo "Recommended setting: vm.hugetlb_pool = $HUGETLB_POOL" ;;
   '2.6'|'3.8') echo "Recommended setting: vm.nr_hugepages = $NUM_PG" ;;
    *) echo "Unrecognized kernel version $KERN. Exiting." ;;
esac
# End
</pre></li>
                                 <li>
                                    <p>Run the following command to change the permission of the file:</p><pre class="oac_no_warn" dir="ltr">$ chmod +x hugepages_settings.sh
</pre></li>
                              </ol>
                           </li>
                           <li id="GUID-19BFCC60-BA4C-4750-85EB-7432282A9556__CACJDEDA">
                              <p>Run the <code class="codeph">hugepages_settings.sh </code>script to compute the values for <code class="codeph">hugepages</code> configuration:
                              </p><pre class="oac_no_warn" dir="ltr">$ ./hugepages_settings.sh
</pre><div class="infoboxnote" id="GUID-19BFCC60-BA4C-4750-85EB-7432282A9556__GUID-3002140C-16FA-4FDB-80E1-4FA16945C4E2">
                                 <p class="notep1">Note:</p>
                                 <p>Before running this script, ensure that all the applications that use <code class="codeph">hugepages</code> run.
                                 </p>
                              </div>
                           </li>
                           <li>
                              <p>Set the following kernel parameter, where <span class="italic">value</span> is the HugePages value that you determined in step <a href="administering-oracle-database-on-linux.html#GUID-19BFCC60-BA4C-4750-85EB-7432282A9556__CACJDEDA">7</a>:
                              </p><pre class="oac_no_warn" dir="ltr"># sysctl -w vm.nr_hugepages=<span class="italic">value</span>
</pre></li>
                           <li>
                              <p>To ensure that HugePages is allocated after system restarts, add the following entry to the <code class="codeph">/etc/sysctl.conf</code> file, where <span class="italic">value</span> is the HugePages value that you determined in step <a href="administering-oracle-database-on-linux.html#GUID-19BFCC60-BA4C-4750-85EB-7432282A9556__CACJDEDA">7</a>:
                              </p><pre class="oac_no_warn" dir="ltr">vm.nr_hugepages=<span class="italic">value</span>
</pre></li>
                           <li>
                              <p>Run the following command to check the available <code class="codeph">hugepages</code>:
                              </p><pre class="oac_no_warn" dir="ltr">$ grep Huge /proc/meminfo
</pre></li>
                           <li>
                              <p>Restart the instance.</p>
                           </li>
                           <li>
                              <p>Run the following command to check the available <code class="codeph">hugepages</code> (1 or 2 pages free):
                              </p><pre class="oac_no_warn" dir="ltr">$ grep Huge /proc/meminfo</pre><div class="infoboxnote" id="GUID-19BFCC60-BA4C-4750-85EB-7432282A9556__GUID-6DBCB1EC-3A2C-4840-98F4-B86F30815D87">
                                 <p class="notep1">Note:</p>
                                 <p>If you cannot set your HugePages allocation using <code class="codeph">nr_hugepages</code>, then your available memory may be fragmented. Restart your server for the Hugepages allocation to take effect. 
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="UNXAR403"></a><div class="props_rev_3"><a id="GUID-95CAEFDE-489B-453A-B5D5-4461DABBEEAD" name="GUID-95CAEFDE-489B-453A-B5D5-4461DABBEEAD"></a><h4 id="UNXAR-GUID-95CAEFDE-489B-453A-B5D5-4461DABBEEAD" class="sect4"><span class="enumeration_section">A.7.5 </span>Restrictions for HugePages Configurations
                  </h4>
                  <div>
                     <div class="section">
                        <p>HugePages has the following limitations:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You must unset both the <code class="codeph">MEMORY_TARGET</code> and <code class="codeph">MEMORY_MAX_TARGET</code> initialization parameters. For example, to unset the parameters for the database instance, use the command <code class="codeph">ALTER SYSTEM RESET</code>.
                              </p>
                           </li>
                           <li>
                              <p>Automatic Memory Management (AMM) and HugePages are not compatible. When you use AMM, the entire SGA memory is allocated by creating files under <code class="codeph">/dev/shm</code>. When Oracle Database allocates SGA with AMM, HugePages are not reserved. To use HugePages on Oracle Database 19c, You must disable AMM. 
                              </p>
                           </li>
                           <li>
                              <p>If you are using VLM in a 32-bit environment, then you cannot use HugePages for the Database Buffer cache. You can use HugePages for other parts of the SGA, such as <code class="codeph">shared_pool</code>, <code class="codeph">large_pool</code>, and so on. Memory allocation for VLM (buffer cache) is done using shared memory file systems (<code class="codeph">ramfs/tmpfs/shmfs</code>). Memory file systems do not reserve or use HugePages.
                              </p>
                           </li>
                           <li>
                              <p>HugePages are not subject to allocation or release after system startup, unless a system administrator changes the HugePages configuration, either by modifying the number of pages available, or by modifying the pool size. If the space required is not reserved in memory during system startup, then HugePages allocation fails.</p>
                           </li>
                           <li>
                              <p>Ensure that HugePages is configured properly as the system may run out of memory if excess HugePages is not used by the application.</p>
                           </li>
                           <li>
                              <p>If there is insufficient HugePages when an instance starts and the initialization parameter <code class="codeph">use_large_pages</code> is set to <code class="codeph">only</code>, then the database fails to start and an alert log message provides the necessary information on Hugepages.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-02E9147D-D565-4AF8-B12A-8E6E9F74BEEA" name="GUID-02E9147D-D565-4AF8-B12A-8E6E9F74BEEA"></a><h4 id="UNXAR-GUID-02E9147D-D565-4AF8-B12A-8E6E9F74BEEA" class="sect4"><span class="enumeration_section">A.7.6 </span>Disabling Transparent HugePages
                  </h4>
                  <div>
                     <p>Oracle recommends that you disable Transparent HugePages before you start installation.</p>
                     <div class="section" id="GUID-02E9147D-D565-4AF8-B12A-8E6E9F74BEEA__GUID-BD757063-779C-4411-9A30-B475FFC39EBD">
                        <p>Transparent HugePages memory differs from standard HugePages memory because the kernel <code class="codeph">khugepaged</code> thread allocates memory dynamically during runtime. Standard HugePages memory is pre-allocated at startup, and does not change during runtime. 
                        </p>
                        <div class="infoboxnote" id="GUID-02E9147D-D565-4AF8-B12A-8E6E9F74BEEA__GUID-9010427C-CB6F-4769-B82E-94E826D3FB8A">
                           <p class="notep1">Note:</p>Although Transparent HugePages is disabled on UEK2 and later UEK kernels, Transparent HugePages may be enabled by default on your Linux system.
                        </div>
                        <p>Transparent HugePages memory is enabled by default with Red Hat Enterprise Linux 6, Red Hat Enterprise Linux 7, SUSE 11, Oracle Linux 6, and Oracle Linux 7 with earlier releases of Oracle Linux with the Unbreakable Enterprise Kernel 2 (UEK2) kernels.</p>
                        <p>Transparent HugePages can cause memory allocation delays during runtime. To avoid performance issues, Oracle recommends that you disable Transparent HugePages on all Oracle Database servers. Oracle recommends that you instead use standard HugePages for enhanced performance.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>To check if Transparent HugePages is enabled, run one of the following commands as the root user:</p>
                        <p>Red Hat Enterprise Linux kernels:</p><pre class="pre codeblock"><code># cat /sys/kernel/mm/redhat_transparent_hugepage/enabled</code></pre><p>Other kernels:</p><pre class="pre codeblock"><code># cat /sys/kernel/mm/transparent_hugepage/enabled</code></pre><p>The following is a sample output that shows Transparent HugePages are being used as the [always] flag is enabled.</p><pre class="pre codeblock"><code>[always] never </code></pre><div class="infoboxnote" id="GUID-02E9147D-D565-4AF8-B12A-8E6E9F74BEEA__GUID-BA4B2D75-86E0-4052-8760-108D7BEA2E4B">
                           <p class="notep1">Note:</p>
                           <p>If Transparent HugePages is removed from the kernel, then neither <code>/sys/kernel/mm/transparent_hugepage</code> nor <code>/sys/kernel/mm/redhat_transparent_hugepage files</code> exist. 
                           </p>
                        </div>
                        <p>To disable Transparent HugePages:</p>
                        <ol>
                           <li>
                              <p>For Oracle Linux 6 or earlier releases, add the following entry to the kernel boot line in the <code class="codeph">/etc/grub.conf</code> file:
                              </p><pre class="pre codeblock"><code>transparent_hugepage=never</code></pre><div class="p">For example:<pre class="pre codeblock"><code>title Oracle Linux Server (2.6.32-300.25.1.el6uek.x86_64)
      root (hd0,0)
      kernel /vmlinuz-2.6.32-300.25.1.el6uek.x86_64 ro root=LABEL=/ transparent_hugepage=never
      initrd /initramfs-2.6.32-300.25.1.el6uek.x86_64.img</code></pre></div>
                              <p>The file name may vary for Oracle Linux 7 or later operating systems. Check your operating system documentation for the exact file name and the steps to disable Transparent HugePages.</p>
                              <p>For example, for Oracle Linux 7.3, the procedure to disable Transparent HugePages involves editing the <code class="codeph">/etc/default/grub</code> file and then running the command <code class="codeph">grub2-mkconfig</code>.
                              </p>
                           </li>
                           <li>
                              <p>Restart the system to make the changes permanent.</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>