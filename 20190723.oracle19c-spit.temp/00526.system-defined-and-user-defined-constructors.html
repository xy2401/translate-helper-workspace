<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>System-Defined and User-Defined Constructors</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Object-Relational Developer's Guide ">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Object-Relational Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="object-relational-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T02:05:10-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96436-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="storing-XMLTypes-and-LOBs-in-an-ANYDATA-column.html" title="Previous" type="text/html">
      <link rel="next" href="transient-and-generic-types.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Object-Relational Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADOBJ">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="storing-XMLTypes-and-LOBs-in-an-ANYDATA-column.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="transient-and-generic-types.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Object-Relational Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="advanced-topics-for-oracle-objects.html" property="item" typeof="WebPage"><span property="name"> Advanced Topics for Oracle Objects </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">System-Defined and User-Defined Constructors</li>
            </ol>
            <a id="GUID-0D6FA836-9ACB-4CC3-9355-298E49DA73E1" name="GUID-0D6FA836-9ACB-4CC3-9355-298E49DA73E1"></a><a id="ADOBJ7662"></a>
            
            <h2 id="ADOBJ-GUID-0D6FA836-9ACB-4CC3-9355-298E49DA73E1" class="sect2"><span class="enumeration_section">8.5 </span>System-Defined and User-Defined Constructors
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>There are various aspects to system-defined constructors, also known as attribute-value constructors, and user-defined constructors.</p>
               <p>Topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="system-defined-and-user-defined-constructors.html#GUID-E61389B3-30EF-4BBB-8A89-03C7929C198F">The Attribute-Value Constructor</a></p>
                  </li>
                  <li>
                     <p><a href="system-defined-and-user-defined-constructors.html#GUID-2FECD610-E8F5-4E89-A59B-3DA6377C2ABA">Constructors and Type Evolution</a></p>
                  </li>
                  <li>
                     <p><a href="system-defined-and-user-defined-constructors.html#GUID-2F58F811-5AF3-400D-9503-AB3387E3C9F6">Advantages of User-Defined Constructors</a></p>
                  </li>
                  <li>
                     <p><a href="system-defined-and-user-defined-constructors.html#GUID-AACBEBFC-4E97-43D2-BE9B-2142C7DF3BD8">Defining and Implementing User-Defined Constructors</a></p>
                  </li>
                  <li>
                     <p><a href="system-defined-and-user-defined-constructors.html#GUID-50C1ADD6-F597-4C6F-BC08-F5DC193F2257">Overloaded and Hidden Constructors</a></p>
                  </li>
                  <li>
                     <p><a href="system-defined-and-user-defined-constructors.html#GUID-0CAF3720-D67B-4B21-B697-198482711C81">Calling User-Defined Constructors</a></p>
                  </li>
                  <li>
                     <p><a href="system-defined-and-user-defined-constructors.html#GUID-908F6C88-EAD3-452E-9D38-924FD3B1AEDA">Constructors for SQLJ Object Types</a></p>
                  </li>
               </ul>
            </div><a id="ADOBJ7415"></a><a id="ADOBJ7414"></a><div class="props_rev_3"><a id="GUID-E61389B3-30EF-4BBB-8A89-03C7929C198F" name="GUID-E61389B3-30EF-4BBB-8A89-03C7929C198F"></a><h3 id="ADOBJ-GUID-E61389B3-30EF-4BBB-8A89-03C7929C198F" class="sect3"><span class="enumeration_section">8.5.1 </span>The Attribute-Value Constructor
               </h3>
               <div>
                  <p>The system-defined constructor, also known as the attribute-value constructor, requires you to pass the constructor a value for each attribute of the type. The constructor then sets the attributes of the new object instance to those values, as shown in <a href="system-defined-and-user-defined-constructors.html#GUID-E61389B3-30EF-4BBB-8A89-03C7929C198F__CACFHAIG">Example 8-6</a>.
                  </p>
                  <p>The keyword <code class="codeph">NEW</code> preceding a call to a constructor is optional but recommended.
                  </p>
                  <div class="example" id="GUID-E61389B3-30EF-4BBB-8A89-03C7929C198F__CACFHAIG">
                     <p class="titleinexample">Example 8-6 Setting the attribute-value with the Constructor</p><pre class="oac_no_warn" dir="ltr">CREATE TYPE shape AS OBJECT (
    name VARCHAR2(30),
    area NUMBER);
/
CREATE TABLE building_blocks of shape;

-- attribute-value constructor: Sets instance attributes to the specified values
INSERT INTO building_blocks
  VALUES (
    <span class="bold">NEW shape</span>('my_shape', 4));</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADOBJ7416"></a><div class="props_rev_3"><a id="GUID-2FECD610-E8F5-4E89-A59B-3DA6377C2ABA" name="GUID-2FECD610-E8F5-4E89-A59B-3DA6377C2ABA"></a><h3 id="ADOBJ-GUID-2FECD610-E8F5-4E89-A59B-3DA6377C2ABA" class="sect3"><span class="enumeration_section">8.5.2 </span>Constructors and Type Evolution
               </h3>
               <div>
                  <p>The attribute-value constructor saves you the trouble of defining your own constructors for a type. However, you must supply a value for every attribute declared in the type or the constructor call fails to compile.</p>
                  <p>This requirement can create a problem if you evolve the type later on, especially because the attribute-value constructor is implicit and not visible in the code, unlike a user-defined constructor. When you change the attributes of a type, the attribute-value constructor of the type changes, too. If you add an attribute, the updated attribute-value constructor expects a value for the new attribute; otherwise, any attribute-value constructor calls in your existing code fail.</p>
                  <div class="infoboxnotealso" id="GUID-2FECD610-E8F5-4E89-A59B-3DA6377C2ABA__GUID-35A748AA-1DB6-4839-B412-A9E46B81D0E9">
                     <p class="notep1">See Also:</p>
                     <p><span class="q">"<a href="type-evolution.html#GUID-AD083363-701A-4CE4-8795-C55D7EBCCB47">Type Evolution</a>"</span></p>
                  </div>
               </div>
            </div><a id="ADOBJ7417"></a><div class="props_rev_3"><a id="GUID-2F58F811-5AF3-400D-9503-AB3387E3C9F6" name="GUID-2F58F811-5AF3-400D-9503-AB3387E3C9F6"></a><h3 id="ADOBJ-GUID-2F58F811-5AF3-400D-9503-AB3387E3C9F6" class="sect3"><span class="enumeration_section">8.5.3 </span>Advantages of User-Defined Constructors
               </h3>
               <div>
                  <p>User-defined constructors do not need to explicitly set a value for every attribute of a type, unlike attribute-value constructors. </p>
                  <p>A user-defined constructor can have any number of arguments, of any type, and these do not need to map directly to type attributes. When you define a constructor, you can initialize the attributes to any appropriate values. For any attributes which you do not supply values, the system initialized to <code class="codeph">NULL</code>. 
                  </p>
                  <p>If you evolve a type—for example, by adding an attribute—calls to user-defined constructors for the type do not need to be changed. User-defined constructors are not automatically modified when the type evolves, so their signatures remain the same. You may, however, need to change the definition of the constructor if you do not want the new attribute to be initialized to <code class="codeph">NULL</code>.
                  </p>
               </div>
            </div><a id="ADOBJ7419"></a><a id="ADOBJ7418"></a><div class="props_rev_3"><a id="GUID-AACBEBFC-4E97-43D2-BE9B-2142C7DF3BD8" name="GUID-AACBEBFC-4E97-43D2-BE9B-2142C7DF3BD8"></a><h3 id="ADOBJ-GUID-AACBEBFC-4E97-43D2-BE9B-2142C7DF3BD8" class="sect3"><span class="enumeration_section">8.5.4 </span>Defining and Implementing User-Defined Constructors
               </h3>
               <div>
                  <div class="section">
                     <p>You define user-defined constructors in the type body, like an ordinary method. You introduce the declaration and the definition with the phrase <code class="codeph">CONSTRUCTOR FUNCTION</code> and end with the clause <code class="codeph">RETURN SELF AS RESULT</code>.   
                     </p>
                     <p>A constructor for a type must have the same name as the type. <a href="system-defined-and-user-defined-constructors.html#GUID-AACBEBFC-4E97-43D2-BE9B-2142C7DF3BD8__i1011567">Example 8-7</a> defines two constructor functions for the <code class="codeph">shape</code> type. As the example shows, you can overload user-defined constructors by defining multiple versions with different signatures.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-AACBEBFC-4E97-43D2-BE9B-2142C7DF3BD8__i1011567">
                     <p class="titleinexample">Example 8-7 Defining and Implementing User-Defined Constructors</p><pre class="oac_no_warn" dir="ltr">CREATE TYPE shape AS OBJECT (
    name VARCHAR2(30),
    area NUMBER,
    <span class="bold">CONSTRUCTOR FUNCTION</span> shape(SELF IN OUT NOCOPY shape, name VARCHAR2)
                               <span class="bold">RETURN SELF AS RESULT</span>,
    CONSTRUCTOR FUNCTION shape(SELF IN OUT NOCOPY shape, name VARCHAR2, 
                               area NUMBER) RETURN SELF AS RESULT
) NOT FINAL;
/

CREATE <span class="bold">TYPE BODY</span> shape AS
    CONSTRUCTOR FUNCTION shape(SELF IN OUT NOCOPY shape, name VARCHAR2) 
                               RETURN SELF AS RESULT IS
    BEGIN
        SELF.name := name;
        SELF.area := 0;
        <span class="bold">RETURN;</span>
    END;
    CONSTRUCTOR FUNCTION shape(<span class="bold">SELF IN OUT</span> NOCOPY shape, name VARCHAR2, 
                                area NUMBER) RETURN SELF AS RESULT IS
    BEGIN
        SELF.name := name;
        SELF.area := area;
        RETURN;
    END;
END;
/
</pre><p>A user-defined constructor has an implicit first parameter <code class="codeph">SELF</code>. Specifying this parameter in the declaration of a user-defined constructor is optional. If you do specify it, you must declare its mode to be <code class="codeph">IN OUT</code>.
                     </p>
                     <p>The required clause <code class="codeph">RETURN SELF AS RESULT</code> ensures that the most specific type of the instance being returned is the same as the most specific type of the <code class="codeph">SELF</code> argument. In the case of constructors, this is the type for which the constructor is defined. For example, if the most specific type of the <code class="codeph">SELF</code> argument on a call to the <code class="codeph">shape</code> constructor is <code class="codeph">shape</code>, then this clause ensures that the <code class="codeph">shape</code> constructor returns an instance of <code class="codeph">shape</code> (not an instance of a subtype of <code class="codeph">shape</code>).
                     </p>
                     <p>When a constructor function is called, the system initializes the attributes of the <code class="codeph">SELF</code> argument to <code class="codeph">NULL</code>. Names of attributes subsequently initialized in the function body may be qualified with <code class="codeph">SELF</code>, such as <code class="codeph">SELF.name</code> in <a href="system-defined-and-user-defined-constructors.html#GUID-AACBEBFC-4E97-43D2-BE9B-2142C7DF3BD8__i1011567">Example 8-7</a>, to distinguish them from the names of the arguments of the constructor function, if these are the same. If the argument names are different, this qualification is not necessary. 
                     </p>
                     <p>The function body must include an explicit <code class="codeph">return;</code> as shown. The <span class="keyword">return</span> keyword must not be followed by a <code class="codeph">return</code> expression. The system automatically returns the newly constructed <code class="codeph">SELF</code> instance.
                     </p>
                     <p>A user-defined constructor may be implemented in PL/SQL, C, or Java. </p>
                  </div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADOBJ7420"></a><div class="props_rev_3"><a id="GUID-50C1ADD6-F597-4C6F-BC08-F5DC193F2257" name="GUID-50C1ADD6-F597-4C6F-BC08-F5DC193F2257"></a><h3 id="ADOBJ-GUID-50C1ADD6-F597-4C6F-BC08-F5DC193F2257" class="sect3"><span class="enumeration_section">8.5.5 </span>Overloaded and Hidden Constructors
               </h3>
               <div>
                  <p>You can overload user-defined constructors, like other type methods. </p>
                  <p>User-defined constructors are not inherited, so a user-defined constructor defined in a supertype cannot be hidden in a subtype. However, a user-defined constructor does hide, and thus supersede, the attribute-value constructor for its type if the signature of the user-defined constructor exactly matches the signature of the attribute-value constructor. </p>
                  <p>For the signatures to match, the names and types of the parameters (after the implicit <code class="codeph">SELF</code> parameter) of the user-defined constructor must be the same as the names and types of the attributes of the type. The mode of the parameters (after the implicit <code class="codeph">SELF</code> parameter) of the user-defined constructor must be <code class="codeph">IN</code>. 
                  </p>
                  <p>If an attribute-value constructor is not hidden by a user-defined constructor that has the same name and signature, the attribute-value constructor can still be called. </p>
                  <p>Note that, if you evolve a type—for example, by adding an attribute—the signature of the attribute-value constructor of the type changes accordingly. This can cause a formerly hidden attribute-value constructor to become usable again.</p>
               </div>
            </div><a id="ADOBJ7422"></a><a id="ADOBJ7421"></a><div class="props_rev_3"><a id="GUID-0CAF3720-D67B-4B21-B697-198482711C81" name="GUID-0CAF3720-D67B-4B21-B697-198482711C81"></a><h3 id="ADOBJ-GUID-0CAF3720-D67B-4B21-B697-198482711C81" class="sect3"><span class="enumeration_section">8.5.6 </span>Calling User-Defined Constructors
               </h3>
               <div>
                  <div class="section">
                     <p>You call a user-defined constructor like any other function and you can use it anywhere you can use an ordinary function.</p>
                     <p>The <code class="codeph">SELF</code> argument is passed in implicitly and may not be passed in explicitly. In other words, usages like the following are not allowed:
                     </p>
                     <p><code class="codeph">NEW constructor(instance, argument_list)</code></p>
                     <p>A user-defined constructor cannot occur in the <code class="codeph">DEFAULT</code> clause of a <code class="codeph">CREATE</code> or <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> statement, but an attribute-value constructor can. The arguments to the attribute-value constructor must not contain references to PL/SQL functions or to other columns, including the pseudocolumns <code class="codeph">LEVEL</code>, <code class="codeph">PRIOR</code>, and <code class="codeph">ROWNUM</code>, or to date constants that are not fully specified. The same is true for check constraint expressions: an attribute-value constructor can be used as part of check constraint expressions while creating or altering a table, but a user-defined constructor cannot.
                     </p>
                     <p>Parentheses are required in SQL even for constructor calls that have no arguments. In PL/SQL, parentheses are optional when invoking a zero-argument constructor. They do, however, make it more obvious that the constructor call is a function call. The following PL/SQL example omits parentheses in the constructor call to create a new shape:</p>
                     <p><code class="codeph">shape s := NEW my_schema.shape;</code></p>
                     <p>The <code class="codeph">NEW</code> keyword and the schema name are optional. 
                     </p>
                     <p><a href="system-defined-and-user-defined-constructors.html#GUID-0CAF3720-D67B-4B21-B697-198482711C81__CACEBJGE">Example 8-8</a> creates a subtype under the type created in <a href="system-defined-and-user-defined-constructors.html#GUID-AACBEBFC-4E97-43D2-BE9B-2142C7DF3BD8__i1011567">Example 8-7</a> and shows examples for calling the user-defined constructors.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-0CAF3720-D67B-4B21-B697-198482711C81__CACEBJGE">
                     <p class="titleinexample">Example 8-8 Calling User-Defined Constructors</p><pre class="oac_no_warn" dir="ltr">-- Requires Ex. 8-8
CREATE TYPE rectangle <span class="bold">UNDER shape</span> (
    len NUMBER,
    wth NUMBER,
    CONSTRUCTOR FUNCTION rectangle(SELF IN OUT NOCOPY rectangle,
        name VARCHAR2, len NUMBER, wth NUMBER) RETURN SELF as RESULT,
    CONSTRUCTOR FUNCTION rectangle(SELF IN OUT NOCOPY rectangle,
        name VARCHAR2, side NUMBER) RETURN SELF as RESULT);
/
SHOW ERRORS
CREATE TYPE BODY rectangle IS 
    CONSTRUCTOR FUNCTION rectangle(SELF IN OUT NOCOPY rectangle,
        name VARCHAR2, len NUMBER, wth NUMBER) RETURN  SELF AS RESULT IS
    BEGIN 
        SELF.name := name;
        SELF.area := len*wth;
        SELF.len := len;
        SELF.wth := wth;
        RETURN ;
    END;
    CONSTRUCTOR FUNCTION rectangle(SELF IN OUT NOCOPY rectangle,
        name VARCHAR2, side NUMBER) RETURN  SELF AS RESULT IS
    BEGIN 
        SELF.name := name;
        SELF.area := side * side;
        SELF.len := side;
        SELF.wth := side;
        RETURN ;
    END;
END;
/

CREATE TABLE shape_table OF shape;
INSERT INTO shape_table VALUES(shape('shape1')); 
INSERT INTO shape_table VALUES(shape('shape2', 20)); 
INSERT INTO shape_table VALUES(rectangle('rectangle', 2, 5)); 
INSERT INTO shape_table VALUES(rectangle('quadrangle', 12, 3));
INSERT INTO shape_table VALUES(rectangle('square', 12));
</pre><p>The following query selects the rows in the <code class="codeph">shape_table</code>:
                     </p><pre class="oac_no_warn" dir="ltr">SELECT VALUE(s) FROM shape_table s;</pre><pre class="pre codeblock"><code>VALUE(S)(NAME, AREA)
---------------------------------------------
SHAPE('shape1', 0)
SHAPE('shape2', 20)
RECTANGLE('rectangle', 10, 2, 5)
RECTANGLE('quadrangle', 36, 12, 3)
RECTANGLE('square', 144, 12, 12)</code></pre><p>The following PL/SQL code calls the constructor:</p>
                     <p><code class="codeph">s shape := NEW shape('void');</code></p>
                  </div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADOBJ7424"></a><a id="ADOBJ7423"></a><div class="props_rev_3"><a id="GUID-908F6C88-EAD3-452E-9D38-924FD3B1AEDA" name="GUID-908F6C88-EAD3-452E-9D38-924FD3B1AEDA"></a><h3 id="ADOBJ-GUID-908F6C88-EAD3-452E-9D38-924FD3B1AEDA" class="sect3"><span class="enumeration_section">8.5.7 </span>Constructors for SQLJ Object Types
               </h3>
               <div>
                  <p>A SQLJ object type is a SQL object type mapped to a Java class. A SQLJ object type has an attribute-value constructor. It can also have user-defined constructors that are mapped to constructors in the referenced Java class. </p>
                  <div class="example" id="GUID-908F6C88-EAD3-452E-9D38-924FD3B1AEDA__GUID-3B620D2A-5B61-40C5-9F22-6A606E61A9ED">
                     <p class="titleinexample">Example 8-9 Creating a SQLJ Object</p><pre class="oac_no_warn" dir="ltr">CREATE TYPE address AS OBJECT 
   EXTERNAL NAME 'university.address' LANGUAGE JAVA
   USING SQLData(
     street   VARCHAR2(100) EXTERNAL NAME 'street',
     city     VARCHAR2(50)  EXTERNAL NAME 'city',
     state    VARCHAR2(50)  EXTERNAL NAME 'state',
     zipcode  NUMBER        EXTERNAL NAME 'zipcode',
    <span class="bold">CONSTRUCTOR FUNCTION</span> address (SELF IN OUT NOCOPY address, street VARCHAR2,
                                  city VARCHAR2, state VARCHAR2, zipcode NUMBER)
      <span class="bold">RETURN SELF AS RESULT AS LANGUAGE JAVA</span>
      NAME  'university.address (java.lang.String, java.lang.String,
                      java.lang.String, int) return address');
/</pre><p>A SQLJ type of a serialized representation can have only a user-defined constructor. The internal representation of an object of SQLJ type is opaque to SQL, so an attribute-value constructor is not possible for a SQLJ type.</p>
                  </div>
                  <!-- class="example" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>