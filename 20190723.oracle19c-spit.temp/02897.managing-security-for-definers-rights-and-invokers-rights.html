<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">
      <meta name="description" content="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">
      <title>Managing Security for Definer's Rights and&nbsp;Invoker's Rights</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Security Guide ">
      <meta property="og:description" content="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Security Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-security-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-28T14:57:12-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96299-04">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="integrating_mads_with_oracle_database.html" title="Previous" type="text/html">
      <link rel="next" href="managing-fine-grained-access-in-pl-sql-packages-and-types.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Security Guide">
    <meta name="dcterms.isVersionOf" content="DBSEG">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="integrating_mads_with_oracle_database.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="managing-fine-grained-access-in-pl-sql-packages-and-types.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Security Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part_1.html" property="item" typeof="WebPage"><span property="name">Managing User Authentication and&nbsp;Authorization</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Managing Security for Definer's Rights and&nbsp;Invoker's Rights</li>
            </ol>
            <a id="GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3" name="GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3"></a><a id="DBSEG658"></a>
            
            <h2 id="DBSEG-GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3" class="sect2"><span class="enumeration_chapter">7 </span>Managing Security for Definer's Rights and&nbsp;Invoker's Rights
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures. </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-18B223A9-223B-4625-AADE-4E47A56A5E9D">About Definer's Rights and Invoker's Rights</a><br>Definer's rights and invoker's rights are used to control access to the privileges necessary to run a user-created procedure, or program unit. 
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-5ECAD7B4-BF99-4A36-B770-2132A43ED5A5">How Procedure Privileges Affect Definer's Rights</a><br>The owner of a procedure, called the <span class="italic">definer</span>, must have the necessary object privileges for objects that the procedure references. 
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-74D3BC6B-1371-4AA8-B7E7-ECB84394B9D4">How Procedure Privileges Affect Invoker's Rights</a><br>An invoker’s rights procedure executes with all of the invoker's privileges. 
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-547A6A16-51AA-4FD9-BDB9-0D8A79B8CF24">When You Should Create Invoker's Rights Procedures</a><br>Oracle recommends that you create invoker's rights procedures in certain situations.
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a><br>The <code class="codeph">INHERIT PRIVILEGES</code> and <code class="codeph">INHERIT ANY PRIVILEGES</code> privileges regulate the privileges used when invoker's rights procedures are run. 
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-2897C310-D0B5-4AB0-8237-384196C4EC81">Definer's Rights and Invoker's Rights in Views</a><br>The <code class="codeph">BEQEATH</code> clause in the <code class="codeph">CREATE VIEW</code> SQL statement can control definer's rights and invoker's rights in user-created views. 
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-45E77E8E-587F-42AF-A163-D814264341E2">Using Code Based Access Control for Definer's Rights and Invoker's Rights</a><br>Code based access control, used to attach database roles to PL/SQL functions, procedures, or packages, works well with invoker's rights and definer's procedures.
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B354724F-BD35-47C7-A699-93C2B6389555">Controlling Definer's Rights Privileges for Database Links</a><br>You can control privilege grants for definer’s rights procedures if your applications use database links and definer’s rights procedures.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="part_1.html" title="Part I describes how to manage user authentication and authorization.">Managing User Authentication and&nbsp;Authorization</a></p>
                  </div>
               </div>
            </div>
            <a id="DBSEG659"></a><div class="props_rev_3"><a id="GUID-18B223A9-223B-4625-AADE-4E47A56A5E9D" name="GUID-18B223A9-223B-4625-AADE-4E47A56A5E9D"></a><h3 id="DBSEG-GUID-18B223A9-223B-4625-AADE-4E47A56A5E9D" class="sect3">About Definer's Rights and Invoker's Rights</h3>
               <div>
                  <p>Definer's rights and invoker's rights are used to control access to the privileges necessary to run a user-created procedure, or program unit. </p>
                  <p>In a <a href="glossary.html#GUID-87141F4A-F49D-4C0E-8229-B9943FFC7FA4"><span class="xrefglossterm">definer's rights procedure</span></a>, the procedure executes with the privileges of the owner. The privileges are bound to the schema in which they were created. An <a href="glossary.html#GUID-68637D3F-FA77-453D-962B-172202ACC23C"><span class="xrefglossterm">invoker's rights procedure</span></a> executes with the privileges of the current user, that is, the user who invokes the procedure. 
                  </p>
                  <p>For example, suppose user <code class="codeph">bixby</code> creates a procedure that is designed to modify table <code class="codeph">cust_records</code> and then he grants the <code class="codeph">EXECUTE</code> privilege on this procedure to user <code class="codeph">rlayton</code>. If <code class="codeph">bixby</code> had created the procedure with definer's rights, then the procedure would look for table <code class="codeph">cust_records</code> in <code class="codeph">bixby</code>'s schema. Had the procedure been created with invoker's rights, then when <code class="codeph">rlayton</code> runs it, the procedure would look for table <code class="codeph">cust_records</code> in <code class="codeph">rlayton</code>'s schema.
                  </p>
                  <p>By default, all procedures are considered definer's rights. You can designate a procedure to be an invoker's rights procedure by using the <code class="codeph">AUTHID CURRENT_USER</code> clause when you create or modify it, or you can use the <code class="codeph">AUTHID DEFINER</code> clause to make it a definer's rights procedure. 
                  </p>
                  <p>You can create privilege analysis policies to capture privilege use of definer’s rights and invoker’s rights procedures. </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="performing-privilege-analysis-find-privilege-use.html#GUID-44CB644B-7B59-4B3B-B375-9F9B96F60186" title="Privilege analysis dynamically analyzes the privileges and roles that users use and do not use.">Performing Privilege Analysis to&nbsp;Find&nbsp;Privilege&nbsp;Use</a></li>
                        <li><a href="../lnpls/plsql-subprograms.html#LNPLS-GUID-41D23DE7-3C07-41CF-962B-F92B696594B5" target="_blank"><span><cite><span><cite>Oracle Database PL/SQL Language Reference</cite></span></cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3" title="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">Managing Security for Definer's Rights and&nbsp;Invoker's Rights</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="DBSEG99925"></a><div class="props_rev_3"><a id="GUID-5ECAD7B4-BF99-4A36-B770-2132A43ED5A5" name="GUID-5ECAD7B4-BF99-4A36-B770-2132A43ED5A5"></a><h3 id="DBSEG-GUID-5ECAD7B4-BF99-4A36-B770-2132A43ED5A5" class="sect3">How Procedure Privileges Affect Definer's Rights</h3>
               <div>
                  <p>The owner of a procedure, called the <span class="italic">definer</span>, must have the necessary object privileges for objects that the procedure references. 
                  </p>
                  <p>If the procedure owner grants to another user the right to use the procedure, then the privileges of the procedure owner (on the objects the procedure references) apply to the grantee's exercise of the procedure. The privileges of the procedure's definer must be granted directly to the procedure owner, not granted through roles. These are called definer's rights. </p>
                  <p>The user of a procedure who is not its owner is called the <span class="italic">invoker</span>. Additional privileges on referenced objects are required for an <a href="glossary.html#GUID-68637D3F-FA77-453D-962B-172202ACC23C"><span class="xrefglossterm">invoker's rights procedure</span></a>, but not for a <a href="glossary.html#GUID-87141F4A-F49D-4C0E-8229-B9943FFC7FA4"><span class="xrefglossterm">definer's rights procedure</span></a>.
                  </p>
                  <p>A user of a definer's rights procedure requires only the privilege to execute the procedure and no privileges on the underlying objects that the procedure accesses. This is because a definer's rights procedure operates under the security domain of the user who owns the procedure, regardless of who is executing it. The owner of the procedure must have all the necessary object privileges for referenced objects. Fewer privileges need to be granted to users of a definer's rights procedure. This results in stronger control of database access. </p>
                  <p>You can use definer's rights procedures to control access to private database objects and add a level of database security. By writing a definer's rights procedure and granting only the <code class="codeph">EXECUTE</code> privilege to a user, this user can be forced to access the referenced objects only through the procedure. 
                  </p>
                  <p>At run time, Oracle Database checks whether the privileges of the owner of a definer's rights procedure allow access to that procedure's referenced objects, before the procedure is executed. If a necessary privilege on a referenced object was revoked from the owner of a definer's rights procedure, then no user, including the owner, can run the procedure. </p>
                  <p>An example of when you may want to use a definer's rights procedure is as follows: Suppose that you must create an API whose procedures have unrestricted access to its tables, but you want to prevent ordinary users from selecting table data directly, and from changing it with <code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, and <code class="codeph">DELETE</code> statements. To accomplish this, in a separate, low-privileged schema, create the tables and the procedures that comprise the API. By default, each procedure is a definer's rights unit, so you do not need to specify <code class="codeph">AUTHID DEFINER</code> when you create it. Then grant the <code class="codeph">EXECUTE</code> privilege to the users who must use this API, but do not grant any privileges that allow data access. This solution gives you complete control over your API behavior and how users have access to its underlying objects. 
                  </p>
                  <p>Oracle recommends that you create your definer's rights procedures, and views that access these procedures, in their own schema. Grant this schema very low privileges, or no privileges at all. This way, when other users run these procedures or views, they will not have access to any unnecessarily high privileges from this schema. </p>
                  <div class="infoboxnote" id="GUID-5ECAD7B4-BF99-4A36-B770-2132A43ED5A5__GUID-C29D430B-6314-4ECF-865F-D7B59EFE91F9">
                     <p class="notep1">Note:</p>
                     <p>Trigger processing follows the same patterns as definer's rights procedures. The user runs a SQL statement, which that user is privileged to run. As a result of the SQL statement, a trigger is fired. The statements within the triggered action temporarily execute under the security domain of the user that owns the trigger. For overview information about triggers, <a href="../cncpt/server-side-programming.html#CNCPT118" target="_blank"><span><cite>Oracle Database Concepts</cite></span></a>.
                     </p>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="configuring-privilege-and-role-authorization.html#GUID-5C57B842-AF82-4462-88E9-5E9E8FD59874" title="Role behavior in a PL/SQL block is determined by the type of block and by definer's rights or invoker's rights.">How Roles Work in PL/SQL Blocks</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3" title="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">Managing Security for Definer's Rights and&nbsp;Invoker's Rights</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="DBSEG99926"></a><div class="props_rev_3"><a id="GUID-74D3BC6B-1371-4AA8-B7E7-ECB84394B9D4" name="GUID-74D3BC6B-1371-4AA8-B7E7-ECB84394B9D4"></a><h3 id="DBSEG-GUID-74D3BC6B-1371-4AA8-B7E7-ECB84394B9D4" class="sect3">How Procedure Privileges Affect Invoker's Rights</h3>
               <div>
                  <p>An invoker’s rights procedure executes with all of the invoker's privileges. </p>
                  <p>Oracle Database enables the privileges that were granted to the invoker through any of the invoker's enabled roles to take effect, unless a definer's rights procedure calls the <a href="glossary.html#GUID-68637D3F-FA77-453D-962B-172202ACC23C"><span class="xrefglossterm">invoker's rights procedure</span></a> directly or indirectly. A user of an invoker's rights procedure must have privileges (granted to the user either directly or through a role) on objects that the procedure accesses through external references that are resolved in the schema of the invoker. When the invoker runs an invoker's rights procedure, this user temporarily has <span class="italic">all</span> of the privileges of the invoker. 
                  </p>
                  <p>The invoker must have privileges at run time to access program references embedded in DML statements or dynamic SQL statements, because they are effectively recompiled at run time.</p>
                  <p>For all other external references, such as direct PL/SQL function calls, Oracle Database checks the privileges of the owner at compile time, but does not perform a run-time check. Therefore, the user of an invoker's rights procedure does not need privileges on external references outside DML or dynamic SQL statements. Alternatively, the developer of an invoker's rights procedure must only grant privileges on the procedure itself, not on all objects directly referenced by the invoker's rights procedure. </p>
                  <p>You can create a software bundle that consists of multiple program units, some with definer's rights and others with invoker's rights, and restrict the program entry points <span class="italic">(controlled step-in)</span>. A user who has the privilege to run an entry-point procedure can also execute internal program units indirectly, but cannot directly call the internal programs. For very precise control over query processing, you can create a PL/SQL package specification with explicit cursors.
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" title="The INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES privileges regulate the privileges used when invoker's rights procedures are run.">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3" title="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">Managing Security for Definer's Rights and&nbsp;Invoker's Rights</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="DBSEG1038"></a><div class="props_rev_3"><a id="GUID-547A6A16-51AA-4FD9-BDB9-0D8A79B8CF24" name="GUID-547A6A16-51AA-4FD9-BDB9-0D8A79B8CF24"></a><h3 id="DBSEG-GUID-547A6A16-51AA-4FD9-BDB9-0D8A79B8CF24" class="sect3">When You Should Create Invoker's Rights Procedures</h3>
               <div>
                  <p>Oracle recommends that you create invoker's rights procedures in certain situations.</p>
                  <p>These situations are as follows:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="bold">When creating a PL/SQL procedure in a high-privileged schema.</span> When lower-privileged users invoke the procedure, then it can do no more than those users are allowed to do. In other words, the invoker's rights procedure runs with the privileges of the invoking user.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">When the PL/SQL procedure contains no SQL and is available to other users.</span> The <code class="codeph">DBMS_OUTPUT</code> PL/SQL package is an example of a PL/SQL subprogram that contains no SQL and is available to all users. The reason you should use an invoker's rights procedure in this situation is because the unit issues no SQL statements at run time, so the run-time system does not need to check their privileges. Specifying <code class="codeph">AUTHID</code> <code class="codeph">CURRENT_USER</code> makes invocations of the procedure more efficient, because when an invoker's right procedure is pushed onto, or comes from, the call stack, the values of <code class="codeph">CURRENT_USER</code> and <code class="codeph">CURRENT_SCHEMA</code>, and the currently enabled roles do not change. 
                        </p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-547A6A16-51AA-4FD9-BDB9-0D8A79B8CF24__GUID-8587C1C6-1685-45FD-AFA6-4618863F2126">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" title="The DBMS_RLS PL/SQL package can configure Oracle Virtual Private Database (VPD) policies.">Configuration of Oracle Virtual Private Database Policies</a></p>
                        </li>
                        <li>
                           <p><a href="configuring-privilege-and-role-authorization.html#GUID-32479D5D-74E8-49C0-B11D-D33D3774FC06" title="System privileges that use the ANY keyword enable you to set privileges for an entire category of objects in the database.">About ANY Privileges and the PUBLIC Role</a></p>
                        </li>
                        <li>
                           <p><a href="../lnpls/plsql-subprograms.html#LNPLS00809" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about how Oracle Database handles name resolution and privilege checking at runtime using invoker's and definer's rights
                           </p>
                        </li>
                        <li>
                           <p><a href="../lnpls/plsql-subprograms.html#LNPLS00809" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information about the differences between invoker's rights and definer's rights units
                           </p>
                        </li>
                        <li>
                           <p><a href="../lnpls/CREATE-PACKAGE-statement.html#LNPLS01371" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about defining explicit cursors in the <code class="codeph">CREATE PACKAGE</code> statement
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3" title="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">Managing Security for Definer's Rights and&nbsp;Invoker's Rights</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DBSEG653"></a><div class="props_rev_3"><a id="GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" name="GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F"></a><h3 id="DBSEG-GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" class="sect3">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</h3>
               <div>
                  <p>The <code class="codeph">INHERIT PRIVILEGES</code> and <code class="codeph">INHERIT ANY PRIVILEGES</code> privileges regulate the privileges used when invoker's rights procedures are run. 
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-0B9271DA-4151-4915-AB1A-FB1A262E287E">How the Privileges of a Schema Affect the Use of Invoker's Rights Procedures</a><br>An invoker’s rights procedure is useful in situations where a lower-privileged user must execute a procedure owned by a higher-privileged user.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-174CF65A-209E-4A50-93ED-648C0EB38E90">How the INHERIT [ANY] PRIVILEGES Privileges Control Privilege Access</a><br>Use the <code class="codeph">INHERIT PRIVILEGES</code> and <code class="codeph">INHERIT ANY PRIVILEGES</code> privileges to secure invoker’s rights procedures.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B2D69EFA-7BB0-46A1-8750-7787323B0870">Grants of the INHERIT PRIVILEGES Privilege to Other Users</a><br>By default, all users are granted <code class="codeph">INHERIT PRIVILEGES</code> <code class="codeph">ON USER</code> <span class="italic"><code class="codeph">newuser</code></span> <code class="codeph">TO PUBLIC</code>.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4F8D794B-E54C-4B68-AF94-770700805EAC">Example: Granting INHERIT PRIVILEGES on an Invoking User</a><br>The <code class="codeph">GRANT</code> statement can grant the <code class="codeph">INHERIT PRIVILEGES</code> privilege on an invoking user to a procedure owner.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4773E302-0995-4EDD-9B8A-79629448F662">Example: Revoking INHERIT PRIVILEGES</a><br>The <code class="codeph">REVOKE</code> statement can revoke the <code class="codeph">INHERIT PRIVILEGES</code> privilege from a user.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4950AE44-1C25-4DCA-8F8E-93373081DEFE">Grants of the INHERIT ANY PRIVILEGES Privilege to Other Users</a><br>By default, user <code class="codeph">SYS</code> has the <code class="codeph">INHERIT ANY PRIVILEGES</code> system privilege and can grant this privilege to other database users or roles. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-7534ABF6-CA9B-4F91-8EC2-5FFDECC576CE">Example: Granting INHERIT ANY PRIVILEGES to a Trusted Procedure Owner</a><br>The <code class="codeph">GRANT</code> statement can grant the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege to trusted procedure owners. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-575EE41D-1F31-412E-9AD1-707DF544B9F1">Managing INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES</a><br>By default, <code class="codeph">PUBLIC</code> has the <code class="codeph">INHERIT PRIVILEGE</code> privilege on new and upgraded user accounts; the <code class="codeph">SYS</code> user has the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3" title="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">Managing Security for Definer's Rights and&nbsp;Invoker's Rights</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG660"></a><div class="props_rev_3"><a id="GUID-0B9271DA-4151-4915-AB1A-FB1A262E287E" name="GUID-0B9271DA-4151-4915-AB1A-FB1A262E287E"></a><h4 id="DBSEG-GUID-0B9271DA-4151-4915-AB1A-FB1A262E287E" class="sect4">How the Privileges of a Schema Affect the Use of Invoker's Rights Procedures</h4>
                  <div>
                     <p>An invoker’s rights procedure is useful in situations where a lower-privileged user must execute a procedure owned by a higher-privileged user.</p>
                     <p>When a user runs an invoker's rights procedure (or any PL/SQL program unit that has been created with the <code class="codeph">AUTHID CURRENT_USER</code> clause), the procedure temporarily inherits all of the privileges of the invoking user while the procedure runs. 
                     </p>
                     <p>During that time, the procedure owner has, through the procedure, access to this invoking user's privileges. Consider the following scenario: </p>
                     <ol>
                        <li>
                           <p>User <code class="codeph">ebrown</code> creates the <code class="codeph">check_syntax</code> <a href="glossary.html#GUID-68637D3F-FA77-453D-962B-172202ACC23C"><span class="xrefglossterm">invoker's rights procedure</span></a> and then grants user <code class="codeph">jward</code> the <code class="codeph">EXECUTE</code> privilege on it.
                           </p>
                        </li>
                        <li>
                           <p>User <code class="codeph">ebrown</code>, who is a junior programmer, has only the minimum set of privileges necessary for his job. The <code class="codeph">check_syntax</code> procedure resides in <code class="codeph">ebrown</code>'s schema.
                           </p>
                        </li>
                        <li>
                           <p>User <code class="codeph">jward</code>, who is a manager, has a far more powerful set of privileges than user <code class="codeph">ebrown</code>. 
                           </p>
                        </li>
                        <li>
                           <p>When user <code class="codeph">jward</code> runs the <code class="codeph">check_syntax</code> invoker's rights procedure, the procedure inherits user <code class="codeph">jward</code>'s higher privileges while it runs. 
                           </p>
                        </li>
                        <li>
                           <p>Because user <code class="codeph">ebrown</code> owns the <code class="codeph">check_syntax</code> procedure, he has access to user <code class="codeph">jward</code>'s privileges whenever <code class="codeph">jward</code> runs the <code class="codeph">check_syntax</code> procedure.
                           </p>
                        </li>
                     </ol>
                     <p>The danger in this type of situation—in which the lower privileged <code class="codeph">ebrown</code>'s procedure has access to <code class="codeph">jward</code>'s higher privileges whenever <code class="codeph">jward</code> runs the procedure—lies in the risk that the procedure owner can misuse the higher privileges of the invoking user. For example, user <code class="codeph">ebrown</code> could make use of <code class="codeph">jward</code>'s higher privileges by rewriting the <code class="codeph">check_syntax</code> procedure to give <code class="codeph">ebrown</code> a raise or delete <code class="codeph">ebrown</code>'s bad performance appraisal record. Or, <code class="codeph">ebrown</code> originally could have created the procedure as a definer's rights procedure, granted its <code class="codeph">EXECUTE</code> privilege to <code class="codeph">jward</code>, and then later on change it to a potentially malicious invoker's rights procedure without letting <code class="codeph">jward</code> know. These types of risks increase when random users, such as application users, have access to a database that uses invoker's rights procedures. 
                     </p>
                     <p>When user <code class="codeph">jward</code> runs <code class="codeph">ebrown</code>'s invoker's rights procedure, there is an element of trust involved. He must be assured that <code class="codeph">ebrown</code> will not use the <code class="codeph">check_syntax</code> procedure in a malicious way when it accesses <code class="codeph">jward</code>'s privileges. The <code class="codeph">INHERIT PRIVILEGES</code> and <code class="codeph">INHERIT ANY PRIVILEGES</code> privileges can help user <code class="codeph">jward</code> control whether user <code class="codeph">ebrown</code>'s procedure can have access to his (<code class="codeph">jward</code>'s) privileges. Any user can grant or revoke the <code class="codeph">INHERIT PRIVILEGES</code> privilege on themselves to the user whose invoker's rights procedures they want to run. <code class="codeph">SYS</code> users manage the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" title="The INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES privileges regulate the privileges used when invoker's rights procedures are run.">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG661"></a><div class="props_rev_3"><a id="GUID-174CF65A-209E-4A50-93ED-648C0EB38E90" name="GUID-174CF65A-209E-4A50-93ED-648C0EB38E90"></a><h4 id="DBSEG-GUID-174CF65A-209E-4A50-93ED-648C0EB38E90" class="sect4">How the INHERIT [ANY] PRIVILEGES Privileges Control Privilege Access</h4>
                  <div>
                     <p>Use the <code class="codeph">INHERIT PRIVILEGES</code> and <code class="codeph">INHERIT ANY PRIVILEGES</code> privileges to secure invoker’s rights procedures.
                     </p>
                     <p>The <code class="codeph">INHERIT PRIVILEGES</code> and <code class="codeph">INHERIT ANY PRIVILEGES</code> privileges regulate the privileges used when a user runs an invoker's rights procedure or queries a <code class="codeph">BEQUEATH CURRENT_USER</code> view that references an invoker's rights procedure. 
                     </p>
                     <p>When a user runs an invoker's rights procedure, Oracle Database checks it to ensure that the procedure owner has either the <code class="codeph">INHERIT PRIVILEGES</code> privilege on the invoking user, or if the owner has been granted the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege. If the privilege check fails, then Oracle Database returns an <code class="codeph">ORA-06598: insufficient INHERIT PRIVILEGES privilege</code> error. 
                     </p>
                     <p>The benefit of these two privileges is that they give invoking users control over who can access their privileges when they run an invoker's rights procedure or query a <code class="codeph">BEQUEATH CURRENT_USER</code> view. 
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" title="The INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES privileges regulate the privileges used when invoker's rights procedures are run.">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG662"></a><div class="props_rev_3"><a id="GUID-B2D69EFA-7BB0-46A1-8750-7787323B0870" name="GUID-B2D69EFA-7BB0-46A1-8750-7787323B0870"></a><h4 id="DBSEG-GUID-B2D69EFA-7BB0-46A1-8750-7787323B0870" class="sect4">Grants of the INHERIT PRIVILEGES Privilege to Other Users</h4>
                  <div>
                     <p>By default, all users are granted <code class="codeph">INHERIT PRIVILEGES</code> <code class="codeph">ON USER</code> <span class="italic"><code class="codeph">newuser</code></span> <code class="codeph">TO PUBLIC</code>.
                     </p>
                     <p>This grant takes place when the user accounts are created or when accounts that were created earlier are upgraded to the current release. </p>
                     <p>The invoking user can revoke the <code class="codeph">INHERIT PRIVILEGE</code> privilege from other users on himself and then grant it only to users that he trusts. 
                     </p>
                     <p>The syntax for the <code class="codeph">INHERIT PRIVILEGES</code> privilege grant is as follows: 
                     </p><pre class="oac_no_warn" dir="ltr">GRANT INHERIT PRIVILEGES ON USER <span class="italic">invoking_user</span> TO <span class="italic">procedure_owner</span>;
</pre><p>In this specification:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="italic"><code class="codeph">invoking_user</code></span> is the user who runs the invoker's rights procedure. This user must be a database user account.
                           </p>
                        </li>
                        <li>
                           <p><span class="italic"><code class="codeph">procedure_owner</code></span> is the user who owns the invoker's rights procedure. This value must be a database user account. As an alternative to granting the <code class="codeph">INHERIT PRIVILEGES</code> privilege to the procedure's owner, you can grant the privilege to a role that is in turn granted to the procedure. 
                           </p>
                        </li>
                     </ul>
                     <p>The following users or roles must have the <code class="codeph">INHERIT PRIVILEGES</code> privilege granted to them by users who will run their invoker's rights procedures:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Users or roles who own the invoker's rights procedures</p>
                        </li>
                        <li>
                           <p>Users or roles who own <code class="codeph">BEQUEATH CURRENT_USER</code> views 
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" title="The INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES privileges regulate the privileges used when invoker's rights procedures are run.">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG663"></a><div class="props_rev_3"><a id="GUID-4F8D794B-E54C-4B68-AF94-770700805EAC" name="GUID-4F8D794B-E54C-4B68-AF94-770700805EAC"></a><h4 id="DBSEG-GUID-4F8D794B-E54C-4B68-AF94-770700805EAC" class="sect4">Example: Granting INHERIT PRIVILEGES on an Invoking User</h4>
                  <div>
                     <p>The <code class="codeph">GRANT</code> statement can grant the <code class="codeph">INHERIT PRIVILEGES</code> privilege on an invoking user to a procedure owner.
                     </p>
                     <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4F8D794B-E54C-4B68-AF94-770700805EAC__CACDCCHG">Example 7-1</a> shows how the invoking user <code class="codeph">jward</code> can grant user <code class="codeph">ebrown</code> the <code class="codeph">INHERIT PRIVILEGES</code> privilege.
                     </p>
                     <div class="example" id="GUID-4F8D794B-E54C-4B68-AF94-770700805EAC__CACDCCHG">
                        <p class="titleinexample">Example 7-1 Granting INHERIT PRIVILEGES on an Invoking User to a Procedure Owner</p><pre class="oac_no_warn" dir="ltr">GRANT INHERIT PRIVILEGES ON USER jward TO ebrown;
</pre><p>The statement enables any invoker's rights procedure that <code class="codeph">ebrown</code> writes, or will write in the future, to access <code class="codeph">jward</code>'s privileges when <code class="codeph">jward</code> runs it. 
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" title="The INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES privileges regulate the privileges used when invoker's rights procedures are run.">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG664"></a><div class="props_rev_3"><a id="GUID-4773E302-0995-4EDD-9B8A-79629448F662" name="GUID-4773E302-0995-4EDD-9B8A-79629448F662"></a><h4 id="DBSEG-GUID-4773E302-0995-4EDD-9B8A-79629448F662" class="sect4">Example: Revoking INHERIT PRIVILEGES</h4>
                  <div>
                     <p>The <code class="codeph">REVOKE</code> statement can revoke the <code class="codeph">INHERIT PRIVILEGES</code> privilege from a user.
                     </p>
                     <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4773E302-0995-4EDD-9B8A-79629448F662__CACJEACI">Example 7-2</a> shows how user <code class="codeph">jward</code> can revoke the use of his privileges from <code class="codeph">ebrown</code>.
                     </p>
                     <div class="example" id="GUID-4773E302-0995-4EDD-9B8A-79629448F662__CACJEACI">
                        <p class="titleinexample">Example 7-2 Revoking INHERIT PRIVILEGES</p><pre class="oac_no_warn" dir="ltr">REVOKE INHERIT PRIVILEGES ON USER jward FROM ebrown;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" title="The INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES privileges regulate the privileges used when invoker's rights procedures are run.">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG665"></a><div class="props_rev_3"><a id="GUID-4950AE44-1C25-4DCA-8F8E-93373081DEFE" name="GUID-4950AE44-1C25-4DCA-8F8E-93373081DEFE"></a><h4 id="DBSEG-GUID-4950AE44-1C25-4DCA-8F8E-93373081DEFE" class="sect4">Grants of the INHERIT ANY PRIVILEGES Privilege to Other Users</h4>
                  <div>
                     <p>By default, user <code class="codeph">SYS</code> has the <code class="codeph">INHERIT ANY PRIVILEGES</code> system privilege and can grant this privilege to other database users or roles. 
                     </p>
                     <p>As with all <code class="codeph">ANY</code> privileges, only grant this privilege to trusted users or roles. Once a user or role has been granted the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege, then this user's invoker's rights procedures have access to the privileges of the invoking user. You can find the users who have been granted the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege by querying the <code class="codeph">DBA_SYS_PRIVS</code> data dictionary view. 
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" title="The INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES privileges regulate the privileges used when invoker's rights procedures are run.">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG666"></a><div class="props_rev_3"><a id="GUID-7534ABF6-CA9B-4F91-8EC2-5FFDECC576CE" name="GUID-7534ABF6-CA9B-4F91-8EC2-5FFDECC576CE"></a><h4 id="DBSEG-GUID-7534ABF6-CA9B-4F91-8EC2-5FFDECC576CE" class="sect4">Example: Granting INHERIT ANY PRIVILEGES to a Trusted Procedure Owner</h4>
                  <div>
                     <p>The <code class="codeph">GRANT</code> statement can grant the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege to trusted procedure owners. 
                     </p>
                     <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-7534ABF6-CA9B-4F91-8EC2-5FFDECC576CE__CACBBIJC">Example 7-3</a> shows how to grant the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege to user <code class="codeph">ebrown</code>. 
                     </p>
                     <div class="example" id="GUID-7534ABF6-CA9B-4F91-8EC2-5FFDECC576CE__CACBBIJC">
                        <p class="titleinexample">Example 7-3 Granting INHERIT ANY PRIVILEGES to a Trusted Procedure Owner</p><pre class="oac_no_warn" dir="ltr">GRANT INHERIT ANY PRIVILEGES TO ebrown;
</pre><p>Be careful about revoking the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege from powerful users. For example, suppose user <code class="codeph">SYSTEM</code> has created a set of invoker's rights procedures. If you revoke <code class="codeph">INHERIT ANY PRIVILEGES</code> from <code class="codeph">SYSTEM</code>, then other users cannot run his procedures, unless they have specifically granted him the <code class="codeph">INHERIT PRIVILEGE</code> privilege. 
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" title="The INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES privileges regulate the privileges used when invoker's rights procedures are run.">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG667"></a><div class="props_rev_3"><a id="GUID-575EE41D-1F31-412E-9AD1-707DF544B9F1" name="GUID-575EE41D-1F31-412E-9AD1-707DF544B9F1"></a><h4 id="DBSEG-GUID-575EE41D-1F31-412E-9AD1-707DF544B9F1" class="sect4">Managing INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES</h4>
                  <div>
                     <p>By default, <code class="codeph">PUBLIC</code> has the <code class="codeph">INHERIT PRIVILEGE</code> privilege on new and upgraded user accounts; the <code class="codeph">SYS</code> user has the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege. 
                     </p>
                     <div class="section">
                        <p>Oracle by default configures a set of grants of <code class="codeph">INHERIT PRIVILEGES</code> that are designed to help protect against misuse of the privileges of various Oracle-defined users. 
                        </p>
                        <p>You can choose to revoke the default grant of <code class="codeph">INHERIT PRIVILEGES ON USER </code><span class="italic"><code class="codeph">user_name</code></span> <code class="codeph">TO PUBLIC</code> for a customer-defined user and grant more specific grants of <code class="codeph">INHERIT PRIVILEGES</code> as appropriate for that particular user. To find the users who have been granted the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege, query the <code class="codeph">DBA_SYS_PRIVS</code> data dictionary view.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Revoke the <code class="codeph">INHERIT PRIVILEGES</code> privilege from <code class="codeph">PUBLIC</code>. </span><div>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">REVOKE INHERIT PRIVILEGES ON <span class="italic">invoking_user</span> FROM PUBLIC;
</pre><p>Be aware that this time, any users who run invoker's rights procedures cannot do so, due to run-time errors from failed <code class="codeph">INHERIT PRIVILEGES</code> checks.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Selectively grant the <code class="codeph">INHERIT PRIVILEGES</code> privilege to trusted users or roles. </span></li>
                        <li class="stepexpand"><span>Similarly, selectively grant the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege only to trusted users or roles. </span></li>
                     </ol>
                     <div class="section">
                        <p>You can create an audit policy to audit the granting and revoking of these two privileges, but you cannot audit run-time errors that result from failed <code class="codeph">INHERIT PRIVILEGES</code> privilege checks.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-575EE41D-1F31-412E-9AD1-707DF544B9F1__GUID-1C1D5CD9-D7F4-42D0-9F05-F5EEABC78AA5">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../lnpls/dynamic-sql.html#LNPLS01109" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about SQL injection attacks
                              </p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/GRANT.html#SQLRF01603" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information about the <code class="codeph">GRANT</code> statement and default privileges
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" title="The INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES privileges regulate the privileges used when invoker's rights procedures are run.">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DBSEG586"></a><div class="props_rev_3"><a id="GUID-2897C310-D0B5-4AB0-8237-384196C4EC81" name="GUID-2897C310-D0B5-4AB0-8237-384196C4EC81"></a><h3 id="DBSEG-GUID-2897C310-D0B5-4AB0-8237-384196C4EC81" class="sect3">Definer's Rights and Invoker's Rights in Views</h3>
               <div>
                  <p>The <code class="codeph">BEQEATH</code> clause in the <code class="codeph">CREATE VIEW</code> SQL statement can control definer's rights and invoker's rights in user-created views. 
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-0AF4F672-7252-4C90-BC95-AD9337511A09">About Controlling Definer's Rights and Invoker's Rights in Views</a><br>You can configure user-defined views to accommodate invoker's rights functions that are referenced in the view. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-EF5300C7-E153-4316-805E-0A87FF2EA676">Using the BEQUEATH Clause in the CREATE VIEW Statement</a><br>The <code class="codeph">BEQUEATH</code> controls how an invoker’s right function can be executed using the rights of the invoking user.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-E8238F8F-046F-411C-A0D4-BA3581A6907A">Finding the User Name or User ID of the Invoking User</a><br>PL/SQL functions can be used to find the invoking user, based on whether invoker’s rights or definer’s rights are being used.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-6B0BD428-F194-4344-B9EE-02466181EDCB">Finding BEQUEATH DEFINER and BEQUEATH_CURRENT_USER Views</a><br>You can find out if a view is a <code class="codeph">BEQUEATH DEFINER</code> or <code class="codeph">BEQUEATH CURRENT_USER</code> view.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3" title="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">Managing Security for Definer's Rights and&nbsp;Invoker's Rights</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG558"></a><div class="props_rev_3"><a id="GUID-0AF4F672-7252-4C90-BC95-AD9337511A09" name="GUID-0AF4F672-7252-4C90-BC95-AD9337511A09"></a><h4 id="DBSEG-GUID-0AF4F672-7252-4C90-BC95-AD9337511A09" class="sect4">About Controlling Definer's Rights and Invoker's Rights in Views</h4>
                  <div>
                     <p>You can configure user-defined views to accommodate invoker's rights functions that are referenced in the view. </p>
                     <p>When a user invokes an identity- or privilege-sensitive SQL function or an invoker's rights PL/SQL or Java function, then current schema, current user, and currently enabled roles within the operation's execution can be inherited from the querying user's environment, rather than being set to the owner of the view. </p>
                     <p>This configuration does not turn the view itself into an invoker's rights object. Name resolution within the view is still handled using the view owner's schema, and privilege checking for the view is done using the view owner's privileges. However, at runtime, the function referenced by view runs under the invoking user's privileges rather than those of the view owner's. </p>
                     <p>The benefit of this feature is that it enables functions such as <code class="codeph">SYS_CONTEXT</code> and <code class="codeph">USERENV</code>, which must return information accurate for the invoking user, to return consistent results when these functions are referenced in a view. 
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-2897C310-D0B5-4AB0-8237-384196C4EC81" title="The BEQEATH clause in the CREATE VIEW SQL statement can control definer's rights and invoker's rights in user-created views.">Definer's Rights and Invoker's Rights in Views</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG668"></a><div class="props_rev_3"><a id="GUID-EF5300C7-E153-4316-805E-0A87FF2EA676" name="GUID-EF5300C7-E153-4316-805E-0A87FF2EA676"></a><h4 id="DBSEG-GUID-EF5300C7-E153-4316-805E-0A87FF2EA676" class="sect4">Using the BEQUEATH Clause in the CREATE VIEW Statement</h4>
                  <div>
                     <p>The <code class="codeph">BEQUEATH</code> controls how an invoker’s right function can be executed using the rights of the invoking user.
                     </p>
                     <div class="section">
                        <p>To enable an invoker's rights function to be executed using the rights of the user issuing SQL that references the view, in the <code class="codeph">CREATE VIEW</code> statement, you can set the <code class="codeph">BEQUEATH</code> clause to <code class="codeph">CURRENT_USER</code>. 
                        </p>
                        <p>If you plan to issue a SQL query or DML statement against the view, then the view owner must be granted the <code class="codeph">INHERIT</code> <code class="codeph">PRIVILEGES</code> privilege on the invoking user or the view owner must have the <code class="codeph">INHERIT ANY PRIVILEGES</code> privilege. If not, then when a <code class="codeph">SELECT</code> query or DML statement involves a <code class="codeph">BEQUEATH</code> <code class="codeph">CURRENT_USER</code> view, the run-time system will raise error <code class="codeph">ORA-06598: insufficient INHERIT PRIVILEGES privilege</code>.
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Use the use <code class="codeph">BEQUEATH CURRENT_USER</code> clause to set the view's function to be executed using invoker's rights. 
                              </p>
                           </li>
                        </ul>
                        <p>For example: </p><pre class="oac_no_warn" dir="ltr">CREATE VIEW MY_OBJECTS_VIEW BEQUEATH CURRENT_USER AS
 SELECT GET_OBJS_FUNCTION;
</pre><p>If you want the function within the view to be executed using the view owner's rights, then you should either omit the <code class="codeph">BEQUEATH</code> clause or set it to <code class="codeph">DEFINER</code>. 
                        </p>
                        <p>For example: </p><pre class="oac_no_warn" dir="ltr">CREATE VIEW my_objects_view BEQUEATH DEFINER AS
 SELECT OBJECT_NAME FROM USER_OBJECTS;</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-EF5300C7-E153-4316-805E-0A87FF2EA676__GUID-3458CCE5-41A5-46CF-94FA-410038C5FF6F">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-4DEF8C03-0DCA-4B72-9EEC-F1141E076A2F" title="The INHERIT PRIVILEGES and INHERIT ANY PRIVILEGES privileges regulate the privileges used when invoker's rights procedures are run.">Controlling Invoker's Rights Privileges for Procedure Calls and View Access</a> for more information about how the <code class="codeph">INHERIT PRIVILEGE</code> privilege works
                              </p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/GRANT.html#SQLRF01603" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for additional information about granting the <code class="codeph">INHERIT</code> <code class="codeph">PRIVILEGES</code> and <code class="codeph">INHERIT</code> <code class="codeph">ANY</code> <code class="codeph">PRIVILEGES</code> privileges
                              </p>
                           </li>
                           <li>
                              <p><a href="../dbfsg/configuring-data-security.html#DBFSG433" target="_blank"><span><cite>Oracle Database Real Application Security Administrator's and Developer's Guide</cite></span></a> for information about how to use <code class="codeph">BEQUEATH CURRENT_USER</code> views with Oracle Database Real Application Security applications
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-2897C310-D0B5-4AB0-8237-384196C4EC81" title="The BEQEATH clause in the CREATE VIEW SQL statement can control definer's rights and invoker's rights in user-created views.">Definer's Rights and Invoker's Rights in Views</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG836"></a><div class="props_rev_3"><a id="GUID-E8238F8F-046F-411C-A0D4-BA3581A6907A" name="GUID-E8238F8F-046F-411C-A0D4-BA3581A6907A"></a><h4 id="DBSEG-GUID-E8238F8F-046F-411C-A0D4-BA3581A6907A" class="sect4">Finding the User Name or User ID of the Invoking User</h4>
                  <div>
                     <p>PL/SQL functions can be used to find the invoking user, based on whether invoker’s rights or definer’s rights are being used.</p>
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Use the <code class="codeph">ORA_INVOKING_USER</code> or <code class="codeph">ORA_INVOKING_USERID</code> function to find the invoking user based on whether invoker's rights or definer's rights:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">ORA_INVOKING_USER</code>: Use this function to return the name of the user who is invoking the current statement or view. This function treats the intervening views as specified by their <code class="codeph">BEQUEATH</code> clauses. If the invoking user is an Oracle Database Real Application Security-defined user, then this function returns <code class="codeph">XS$NULL</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">ORA_INVOKING_USERID</code>: Use this function to return the identifier (ID) of the user who is invoking the current statement or view. This function treats the intervening views as specified by their <code class="codeph">BEQUEATH</code> clauses. If the invoking user is an Oracle Database Real Application Security-defined user, then this function returns an ID that is common to all Real Application Security sessions but is different from the ID of any database user.
                                    </p>
                                    <p>For example:   </p><pre class="oac_no_warn" dir="ltr">CONNECT HR
Enter password: <span class="italic">password</span>

SELECT ORA_INVOKING_USER FROM DUAL;

ORA_INVOKING_USER
--------------------
HR</pre></li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-E8238F8F-046F-411C-A0D4-BA3581A6907A__GUID-26B4D7B8-C366-41DB-B9AF-4BB23B283A8D">
                        <p class="notep1">See Also:</p>
                        <p><a href="../dbfsg/configuring-data-security.html#DBFSG436" target="_blank"><span><cite>Oracle Database Real Application Security Administrator's and Developer's Guide</cite></span></a> for information about similar functions that are used for Oracle Database Real Application Security applications
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-2897C310-D0B5-4AB0-8237-384196C4EC81" title="The BEQEATH clause in the CREATE VIEW SQL statement can control definer's rights and invoker's rights in user-created views.">Definer's Rights and Invoker's Rights in Views</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG795"></a><div class="props_rev_3"><a id="GUID-6B0BD428-F194-4344-B9EE-02466181EDCB" name="GUID-6B0BD428-F194-4344-B9EE-02466181EDCB"></a><h4 id="DBSEG-GUID-6B0BD428-F194-4344-B9EE-02466181EDCB" class="sect4">Finding BEQUEATH DEFINER and BEQUEATH_CURRENT_USER Views</h4>
                  <div>
                     <p>You can find out if a view is a <code class="codeph">BEQUEATH DEFINER</code> or <code class="codeph">BEQUEATH CURRENT_USER</code> view.
                     </p>
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To find if a view is <code class="codeph">BEQUEATH DEFINER</code> or <code class="codeph">BEQUEATH CURRENT_USER</code> view, query the <code class="codeph">BEQUEATH</code> column of a <code class="codeph">*_VIEWS</code> or <code class="codeph">*_VIEWS_AE</code> static data dictionary view for that view.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-6B0BD428-F194-4344-B9EE-02466181EDCB__GUID-F88AA33D-70EA-47E5-9406-E745C6527A75">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../refrn/ALL_VIEWS.html#REFRN20305" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> for more information about <code class="codeph">*_VIEWS</code> static data dictionary views
                              </p>
                           </li>
                           <li>
                              <p><a href="../refrn/ALL_VIEWS_AE.html#REFRN20696" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> for more information about <code class="codeph">*_VIEWS_AE</code> static data dictionary views
                              </p>
                           </li>
                        </ul>
                        <p>For example: </p><pre class="oac_no_warn" dir="ltr">SELECT BEQUEATH FROM USER_VIEWS WHERE VIEW_NAME = 'MY_OBJECTS';

BEQUEATH
------------
CURRENT_USER</pre></div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-2897C310-D0B5-4AB0-8237-384196C4EC81" title="The BEQEATH clause in the CREATE VIEW SQL statement can control definer's rights and invoker's rights in user-created views.">Definer's Rights and Invoker's Rights in Views</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DBSEG977"></a><div class="props_rev_3"><a id="GUID-45E77E8E-587F-42AF-A163-D814264341E2" name="GUID-45E77E8E-587F-42AF-A163-D814264341E2"></a><h3 id="DBSEG-GUID-45E77E8E-587F-42AF-A163-D814264341E2" class="sect3">Using Code Based Access Control for Definer's Rights and Invoker's Rights</h3>
               <div>
                  <p>Code based access control, used to attach database roles to PL/SQL functions, procedures, or packages, works well with invoker's rights and definer's procedures.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-7AA2D9C4-DB10-4BF1-AD4C-F48547F7AA82">About Using Code Based Access Control for Applications</a><br>You can use code based access control (CBAC) to better manage definer’s rights program units.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D7E76448-152C-4207-9D48-FE562E0D911C">Who Can Grant Code Based Access Control Roles to a Program Unit?</a><br>Code based access control roles can be granted to a program unit if a set of conditions are met. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-C00B198C-5770-4D89-958C-DB2ECE8FADC6">How Code Based Access Control Works with Invoker's Rights Program Units</a><br>Code based access control can run a program unit in an invoking user's context and with roles associated with this context.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D93C6165-9E9A-4E5F-987E-35DC46812C20">How Code Based Access Control Works with Definer's Rights Program Units</a><br>Code based access control can be used to secure definer’s rights. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-CD18ADC1-2068-4250-881A-10836818A390">Grants of Database Roles to Users for Their CBAC Grants</a><br>The <code class="codeph">DELEGATE</code> option in the <code class="codeph">GRANT</code> statement can limit privilege grants to roles by users responsible for CBAC grants.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-7C59ADD4-BF48-4A16-A2AD-272F710EE48B">Grants and Revokes of Database Roles to a Program Unit</a><br>The <code class="codeph">GRANT</code> and <code class="codeph">REVOKE</code> statements can grant database roles to or revoke database roles from a program unit.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D">Tutorial: Controlling Access to Sensitive Data Using Code Based Access Control</a><br>This tutorial demonstrates how to control access to sensitive data in the <code class="codeph">HR</code> schema by using code based access control. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3" title="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">Managing Security for Definer's Rights and&nbsp;Invoker's Rights</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG978"></a><div class="props_rev_3"><a id="GUID-7AA2D9C4-DB10-4BF1-AD4C-F48547F7AA82" name="GUID-7AA2D9C4-DB10-4BF1-AD4C-F48547F7AA82"></a><h4 id="DBSEG-GUID-7AA2D9C4-DB10-4BF1-AD4C-F48547F7AA82" class="sect4">About Using Code Based Access Control for Applications</h4>
                  <div>
                     <p>You can use code based access control (CBAC) to better manage definer’s rights program units.</p>
                     <p>Applications must often run program units in the caller's environment, while requiring elevated privileges. PL/SQL programs traditionally make use of definer's rights to temporarily elevate the privileges of the program. </p>
                     <p>However, definer's rights based program units run in the context of the definer or the owner of the program unit, as opposed to the invoker's context. Also, using definer's rights based programs often leads to the program unit getting more privileges than required.</p>
                     <p>Code based access control (CBAC) provides the solution by enabling you to attach database roles to a PL/SQL function, procedure, or package. These database roles are enabled at run time, enabling the program unit to execute with the required privileges in the calling user's environment. </p>
                     <p>You can create privilege analysis policies that capture the use of CBAC roles. </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="performing-privilege-analysis-find-privilege-use.html#GUID-44CB644B-7B59-4B3B-B375-9F9B96F60186" title="Privilege analysis dynamically analyzes the privileges and roles that users use and do not use.">Performing Privilege Analysis to&nbsp;Find&nbsp;Privilege&nbsp;Use</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-45E77E8E-587F-42AF-A163-D814264341E2" title="Code based access control, used to attach database roles to PL/SQL functions, procedures, or packages, works well with invoker's rights and definer's procedures.">Using Code Based Access Control for Definer's Rights and Invoker's Rights</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG1039"></a><div class="props_rev_3"><a id="GUID-D7E76448-152C-4207-9D48-FE562E0D911C" name="GUID-D7E76448-152C-4207-9D48-FE562E0D911C"></a><h4 id="DBSEG-GUID-D7E76448-152C-4207-9D48-FE562E0D911C" class="sect4">Who Can Grant Code Based Access Control Roles to a Program Unit?</h4>
                  <div>
                     <p>Code based access control roles can be granted to a program unit if a set of conditions are met. </p>
                     <p>These conditions are as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The grantor is user <code class="codeph">SYS</code> or owns the program unit.
                           </p>
                        </li>
                        <li>
                           <p>If the grantor owns the program unit, then the grantor must have the <code class="codeph">GRANT ANY ROLE</code> system privilege, or have the <code class="codeph">ADMIN</code> or <code class="codeph">DELEGATE</code> option for the roles that they want to grant to program units. 
                           </p>
                        </li>
                        <li>
                           <p>The roles to be granted are directly granted roles to the owner.</p>
                        </li>
                        <li>
                           <p>The roles to be granted are standard database roles.</p>
                        </li>
                     </ul>
                     <p>If these three conditions are not met, then error <code class="codeph">ORA-28702: Program unit string is not owned by the grantor</code> is raised if the first condition is not met, and error <code class="codeph">ORA-1924: role 'string' not granted or does not exist</code> is raised if the second and third conditions are not met.
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-CD18ADC1-2068-4250-881A-10836818A390" title="The DELEGATE option in the GRANT statement can limit privilege grants to roles by users responsible for CBAC grants.">Grants of Database Roles to Users for Their CBAC Grants</a></li>
                           <li><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-7C59ADD4-BF48-4A16-A2AD-272F710EE48B" title="The GRANT and REVOKE statements can grant database roles to or revoke database roles from a program unit.">Grants and Revokes of Database Roles to a Program Unit</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-45E77E8E-587F-42AF-A163-D814264341E2" title="Code based access control, used to attach database roles to PL/SQL functions, procedures, or packages, works well with invoker's rights and definer's procedures.">Using Code Based Access Control for Definer's Rights and Invoker's Rights</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DBSEG980"></a><a id="DBSEG981"></a><a id="DBSEG979"></a><div class="props_rev_3"><a id="GUID-C00B198C-5770-4D89-958C-DB2ECE8FADC6" name="GUID-C00B198C-5770-4D89-958C-DB2ECE8FADC6"></a><h4 id="DBSEG-GUID-C00B198C-5770-4D89-958C-DB2ECE8FADC6" class="sect4">How Code Based Access Control Works with Invoker's Rights Program Units</h4>
                  <div>
                     <p>Code based access control can run a program unit in an invoking user's context and with roles associated with this context.</p>
                     <p>Consider a scenario where there are two application users, <code class="codeph">1</code> and <code class="codeph">2</code>. Application user <code class="codeph">2</code> creates the invoker's right program unit, grants database role <code class="codeph">2</code> to the invoker's rights unit, and then grants execute privileges on the invoker's rights unit to application user <code class="codeph">1</code>.
                     </p>
                     <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-C00B198C-5770-4D89-958C-DB2ECE8FADC6__CHDHEHGG">Figure 7-1</a> shows the database roles <code class="codeph">1</code> and <code class="codeph">2</code> granted to application users <code class="codeph">1</code> and <code class="codeph">2</code>, and an invoker's right program unit.
                     </p>
                     <div class="figure" id="GUID-C00B198C-5770-4D89-958C-DB2ECE8FADC6__CHDHEHGG">
                        <p class="titleinfigure">Figure 7-1 Roles Granted to Application Users and Invoker's Right Program Unit</p><img src="img/dbseg_vm_005.png" alt="Description of Figure 7-1 follows" title="Description of Figure 7-1 follows" longdesc="img_text/dbseg_vm_005.html"><br><a href="img_text/dbseg_vm_005.html">Description of "Figure 7-1 Roles Granted to Application Users and Invoker's Right Program Unit"</a></div>
                     <!-- class="figure" -->
                     <p>The grants are as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Application user <code class="codeph">1</code> is directly granted database roles <code class="codeph">1</code> and <code class="codeph">4</code>.
                           </p>
                        </li>
                        <li>
                           <p>Application user <code class="codeph">2</code> is directly granted database role <code class="codeph">2</code>, which includes application roles <code class="codeph">3</code> and <code class="codeph">4</code>.
                           </p>
                        </li>
                        <li>
                           <p>The invoker's right program unit is granted database role <code class="codeph">2</code>.
                           </p>
                        </li>
                     </ul>
                     <p>When application user <code class="codeph">1</code> logs in and executes the invoker's rights program unit, then the invoker's rights unit executes with the combined database roles of user <code class="codeph">1</code> and the database roles attached to the invoker's rights unit.
                     </p>
                     <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-C00B198C-5770-4D89-958C-DB2ECE8FADC6__CHDDICAG">Figure 7-2</a> shows the security context in which the invoker's rights unit is executed. When application user <code class="codeph">1</code> first logs on, application user <code class="codeph">1</code> has the database <code class="codeph">PUBLIC</code> role (by default), and the database roles <code class="codeph">1</code> and <code class="codeph">4</code>, which have been granted to it. Application user <code class="codeph">1</code> next executes the invoker's rights program unit created by application user <code class="codeph">2</code>. 
                     </p>
                     <p>The invoker's rights unit executes in application user <code class="codeph">1</code>'s context, and has the additional database role <code class="codeph">2</code> attached to it. Database roles <code class="codeph">3</code> and <code class="codeph">4</code> are included, as they are a part of database role <code class="codeph">2</code>. After the invoker's rights unit exits, then application user <code class="codeph">1</code> only has the application roles that have been granted to it, <code class="codeph">PUBLIC</code>, role <code class="codeph">1</code>, and role <code class="codeph">4</code>.
                     </p>
                     <div class="figure" id="GUID-C00B198C-5770-4D89-958C-DB2ECE8FADC6__CHDDICAG">
                        <p class="titleinfigure">Figure 7-2 Security Context in Which Invoker's Right Program Unit IR Is Executed</p><img src="img/dbseg_vm_007.png" alt="Description of Figure 7-2 follows" title="Description of Figure 7-2 follows" longdesc="img_text/dbseg_vm_007.html"><br><a href="img_text/dbseg_vm_007.html">Description of "Figure 7-2 Security Context in Which Invoker's Right Program Unit IR Is Executed"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-45E77E8E-587F-42AF-A163-D814264341E2" title="Code based access control, used to attach database roles to PL/SQL functions, procedures, or packages, works well with invoker's rights and definer's procedures.">Using Code Based Access Control for Definer's Rights and Invoker's Rights</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG982"></a><a id="DBSEG983"></a><a id="DBSEG671"></a><div class="props_rev_3"><a id="GUID-D93C6165-9E9A-4E5F-987E-35DC46812C20" name="GUID-D93C6165-9E9A-4E5F-987E-35DC46812C20"></a><h4 id="DBSEG-GUID-D93C6165-9E9A-4E5F-987E-35DC46812C20" class="sect4">How Code Based Access Control Works with Definer's Rights Program Units</h4>
                  <div>
                     <p>Code based access control can be used to secure definer’s rights. </p>
                     <p>Code based access control works with definer's rights program units to enable the program unit to run using the defining user's rights, with the privileges of a combined set of database roles that are associated with this user.</p>
                     <p>Consider a scenario where application user <code class="codeph">2</code> creates a definer's rights program unit, grants role <code class="codeph">2</code> to the definer's rights program unit, and then grants the <code class="codeph">EXECUTE</code> privilege on the definer's rights program unit to application user <code class="codeph">1</code>.
                     </p>
                     <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D93C6165-9E9A-4E5F-987E-35DC46812C20__CHDEFJDG">Figure 7-3</a> shows the database roles granted to application users <code class="codeph">1</code> and <code class="codeph">2</code>, and a definer's rights program unit.
                     </p>
                     <div class="figure" id="GUID-D93C6165-9E9A-4E5F-987E-35DC46812C20__CHDEFJDG">
                        <p class="titleinfigure">Figure 7-3 Roles Granted to Application Users and Definer's Rights Program Unit</p><img src="img/dbseg_vm_006.png" alt="Description of Figure 7-3 follows" title="Description of Figure 7-3 follows" longdesc="img_text/dbseg_vm_006.html"><br><a href="img_text/dbseg_vm_006.html">Description of "Figure 7-3 Roles Granted to Application Users and Definer's Rights Program Unit"</a></div>
                     <!-- class="figure" -->
                     <p>The grants are as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Application user <code class="codeph">1</code> is directly granted database roles <code class="codeph">1</code> and <code class="codeph">4</code>.
                           </p>
                        </li>
                        <li>
                           <p>Application user <code class="codeph">2</code> is directly granted database role<code class="codeph">2</code>, which includes database roles <code class="codeph">3</code> and <code class="codeph">4</code>.
                           </p>
                        </li>
                        <li>
                           <p>The definer's right program unit is granted database role <code class="codeph">2</code>.
                           </p>
                        </li>
                     </ul>
                     <p>When application user <code class="codeph">1</code> logs in and executes definer's right program unit, then the definer's rights unit executes with the combined database roles of application user <code class="codeph">2</code> and the database roles attached to the definer's rights unit (roles <code class="codeph">2</code>, <code class="codeph">3</code>, and <code class="codeph">4</code>).
                     </p>
                     <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D93C6165-9E9A-4E5F-987E-35DC46812C20__CHDGCDHC">Figure 7-4</a> shows the security context in which the definer's right program unit is executed. When application user <code class="codeph">1</code> first logs on, application user <code class="codeph">1</code> has the database <code class="codeph">PUBLIC</code> role (by default), and the database roles <code class="codeph">1</code> and<code class="codeph">4</code>, which have been granted to it. Application user <code class="codeph">1</code> next executes the definer's rights program unit created by application user <code class="codeph">2</code>. 
                     </p>
                     <p>The definer's rights program unit executes in application user <code class="codeph">2</code>'s context, and has the additional database role <code class="codeph">2</code> attached to it. Database roles <code class="codeph">3</code> and <code class="codeph">4</code> are included, as they are a part of database role <code class="codeph">2</code>. After the definer's rights unit exits, application user <code class="codeph">1</code> only has the database roles that have been granted to it (<code class="codeph">PUBLIC</code>, role <code class="codeph">1</code>, and role <code class="codeph">4</code>).
                     </p>
                     <div class="figure" id="GUID-D93C6165-9E9A-4E5F-987E-35DC46812C20__CHDGCDHC">
                        <p class="titleinfigure">Figure 7-4 Security Context in Which Definer's Right Program Unit DR Is Executed</p><img src="img/dbseg_vm_008.png" alt="Description of Figure 7-4 follows" title="Description of Figure 7-4 follows" longdesc="img_text/dbseg_vm_008.html"><br><a href="img_text/dbseg_vm_008.html">Description of "Figure 7-4 Security Context in Which Definer's Right Program Unit DR Is Executed"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-45E77E8E-587F-42AF-A163-D814264341E2" title="Code based access control, used to attach database roles to PL/SQL functions, procedures, or packages, works well with invoker's rights and definer's procedures.">Using Code Based Access Control for Definer's Rights and Invoker's Rights</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG676"></a><div class="props_rev_3"><a id="GUID-CD18ADC1-2068-4250-881A-10836818A390" name="GUID-CD18ADC1-2068-4250-881A-10836818A390"></a><h4 id="DBSEG-GUID-CD18ADC1-2068-4250-881A-10836818A390" class="sect4">Grants of Database Roles to Users for Their CBAC Grants</h4>
                  <div>
                     <p>The <code class="codeph">DELEGATE</code> option in the <code class="codeph">GRANT</code> statement can limit privilege grants to roles by users responsible for CBAC grants.
                     </p>
                     <p>When you grant a database role to a user who is responsible for CBAC grants, you can include the <code class="codeph">DELEGATE</code> option in the <code class="codeph">GRANT</code> statement to prevent giving the grantee additional privileges on the roles. 
                     </p>
                     <p>The <code class="codeph">DELEGATE</code> option enables the roles to be granted to program units, but it does not permit the granting of the role to other principals or the administration of the role itself. You also can use the <code class="codeph">ADMIN</code> option for the grants, which does permit the granting of the role to other principals. Both the <code class="codeph">ADMIN</code> and <code class="codeph">DELEGATE</code> options are compatible; that is, you can grant both to a user, though you must do this in separate <code class="codeph">GRANT</code> statements for each option. To find if a user has been granted a role with these options, query the <code class="codeph">DELEGATE_OPTION</code> column or the <code class="codeph">ADMIN_OPTION</code> column of either the <code class="codeph">USER_ROLE_PRIVS</code> or <code class="codeph">DBA_ROLE_PRIVS</code> for the user. 
                     </p>
                     <p>The syntax for using the <code class="codeph">DELEGATE</code> and <code class="codeph">ADMIN</code> option is as follows: 
                     </p><pre class="oac_no_warn" dir="ltr">GRANT <span class="italic">role_list</span> to <span class="italic">user_list</span> WITH DELEGATE OPTION;

GRANT <span class="italic">role_list</span> to <span class="italic">user_list</span> WITH ADMIN OPTION;
</pre><p>For example:</p><pre class="oac_no_warn" dir="ltr">GRANT cb_role1 to usr1 WITH DELEGATE OPTION;

GRANT cb_role1 to usr1 WITH ADMIN OPTION;

GRANT cb_role1, cb_role2 to usr1, usr2 with DELEGATE OPTION;

GRANT cb_role1, cb_role2 to usr1, usr2 with ADMIN OPTION;
</pre><p>In a multitenant environment, you can use the <code class="codeph">DELEGATE</code> option for common grants such as granting common roles to common users, just as you can with the <code class="codeph">ADMIN</code> option.
                     </p>
                     <p>For example: </p><pre class="oac_no_warn" dir="ltr">GRANT c##cb_role1 to c##usr1 WITH DELEGATE OPTION CONTAINER = ALL;
</pre><p>Be aware that CBAC grants themselves can only take place locally in a PDB.</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-CD18ADC1-2068-4250-881A-10836818A390__GUID-1F8D528E-8C11-4FB8-B17E-D883F047F9E6">
                        <p class="notep1">See Also:</p>
                        <p><a href="../sqlrf/GRANT.html#SQLRF55020" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for more information about the <code class="codeph">ADMIN</code> option
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-45E77E8E-587F-42AF-A163-D814264341E2" title="Code based access control, used to attach database roles to PL/SQL functions, procedures, or packages, works well with invoker's rights and definer's procedures.">Using Code Based Access Control for Definer's Rights and Invoker's Rights</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG984"></a><div class="props_rev_3"><a id="GUID-7C59ADD4-BF48-4A16-A2AD-272F710EE48B" name="GUID-7C59ADD4-BF48-4A16-A2AD-272F710EE48B"></a><h4 id="DBSEG-GUID-7C59ADD4-BF48-4A16-A2AD-272F710EE48B" class="sect4">Grants and Revokes of Database Roles to a Program Unit</h4>
                  <div>
                     <p>The <code class="codeph">GRANT</code> and <code class="codeph">REVOKE</code> statements can grant database roles to or revoke database roles from a program unit.
                     </p>
                     <p>The following syntax to grants or revokes database roles for a PL/SQL function, procedure, or package:</p><pre class="oac_no_warn" dir="ltr">GRANT <span class="italic">role_list</span> TO <span class="italic">code_list</span> 
REVOKE {<span class="italic">role_list</span> | ALL} FROM <span class="italic">code_list</span>
 </pre><p>In this specification:</p><pre class="oac_no_warn" dir="ltr">role_list ::=  <span class="italic">code-based_role_name</span>[, <span class="italic">role_list</span>]
code_list ::=  {
      {FUNCTION  [<span class="italic">schema</span>.]<span class="italic">function_name</span>}
   |  {PROCEDURE [<span class="italic">schema</span>.]<span class="italic">procedure_name</span>}
   |  {PACKAGE   [<span class="italic">schema</span>.]<span class="italic">package_name</span>}
                 }[, <span class="italic">code_list</span>]
</pre><p>For example:</p><pre class="oac_no_warn" dir="ltr">GRANT cb_role1 TO FUNCTION func1, PACKAGE pack1;

GRANT cb_role2, cb_role3 TO FUNCTION HR.func2, PACKAGE SYS.pack2;

REVOKE cb_role1 FROM FUNCTION func1, PACKAGE pack1;

REVOKE ALL FROM FUNCTION HR.func2, PACKAGE SYS.pack2;</pre></div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D7E76448-152C-4207-9D48-FE562E0D911C" title="Code based access control roles can be granted to a program unit if a set of conditions are met.">Who Can Grant Code Based Access Control Roles to a Program Unit?</a></li>
                           <li><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-CD18ADC1-2068-4250-881A-10836818A390" title="The DELEGATE option in the GRANT statement can limit privilege grants to roles by users responsible for CBAC grants.">Grants of Database Roles to Users for Their CBAC Grants</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-45E77E8E-587F-42AF-A163-D814264341E2" title="Code based access control, used to attach database roles to PL/SQL functions, procedures, or packages, works well with invoker's rights and definer's procedures.">Using Code Based Access Control for Definer's Rights and Invoker's Rights</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DBSEG678"></a><div class="props_rev_3"><a id="GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D" name="GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D"></a><h4 id="DBSEG-GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D" class="sect4">Tutorial: Controlling Access to Sensitive Data Using Code Based Access Control</h4>
                  <div>
                     <p>This tutorial demonstrates how to control access to sensitive data in the <code class="codeph">HR</code> schema by using code based access control. 
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-CCB52926-DA6F-4063-8881-F4F180225837">About This Tutorial</a><br>In this tutorial, you will create a user who must have access to specific employee information for his department. 
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-9C8DA467-25DF-4093-A004-E08E704821A1">Step 1: Create the User and Grant HR the CREATE ROLE Privilege</a><br>To begin, you must create the <code class="codeph">"Finance"</code> user account and then grant this the <code class="codeph">HR</code> user the <code class="codeph">CREATE ROLE</code> privilege.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-214608A1-D504-4E9C-81EF-BDBCB7631CD9">Step 2: Create the print_employees Invoker's Rights Procedure</a><br>The <code class="codeph">print_employees</code> invoker's rights procedure shows employee information in the current user's department. 
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-5B846F6A-87A3-482F-B3D8-E95D04DCF939">Step 3: Create the hr_clerk Role and Grant Privileges for It</a><br>Next, you are ready to create the <code class="codeph">hr_clerk</code> role, which must have the <code class="codeph">EXECUTE</code> privilege on the <code class="codeph">print_employees</code> procedure.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-7316DA6F-4746-43ED-81A6-DBB176227BD7">Step 4: Test the Code Based Access Control HR.print_employees Procedure</a><br>At this stage, you are ready to test the code based access control <code class="codeph">HR.print_employees</code> procedure.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-770D86DD-5B8C-4A11-B4CB-2488C8F0E64B">Step 5: Create the view_emp_role Role and Grant Privileges for It</a><br>Next, user <code class="codeph">HR</code> must create the <code class="codeph">view_emp_role</code> role and then grant privileges to it.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B124BA6A-E0C2-4C7E-9B0D-8FD7BD4810E2">Step 6: Test the HR.print_employees Procedure Again</a><br>With the appropriate privileges in place, user <code class="codeph">"Finance"</code> can try the <code class="codeph">HR.print_employees</code> procedure again.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-AC53C480-FB4E-44D5-A08C-091ECD614417">Step 7: Remove the Components of This Tutorial</a><br>If you no longer need the components of this tutorial, then you can remove them.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-45E77E8E-587F-42AF-A163-D814264341E2" title="Code based access control, used to attach database roles to PL/SQL functions, procedures, or packages, works well with invoker's rights and definer's procedures.">Using Code Based Access Control for Definer's Rights and Invoker's Rights</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG679"></a><div class="props_rev_3"><a id="GUID-CCB52926-DA6F-4063-8881-F4F180225837" name="GUID-CCB52926-DA6F-4063-8881-F4F180225837"></a><h5 id="DBSEG-GUID-CCB52926-DA6F-4063-8881-F4F180225837" class="sect5">About This Tutorial</h5>
                     <div>
                        <p>In this tutorial, you will create a user who must have access to specific employee information for his department. </p>
                        <p></p>
                        <p>However, the table <code class="codeph">HR.EMPLOYEES</code> contains sensitive information such as employee salaries, which must not be accessible to the user. You will implement access control using code based access control. The employee data will be shown to the user through an invoker's rights procedure. Instead of granting the <code class="codeph">SELECT</code> privilege directly to the user, you will grant the <code class="codeph">SELECT</code> privilege to the invoker's rights procedure through a database role. In the procedure, you will hide the sensitive information, such as salaries. Because the procedure is an invoker's rights procedure, you know the caller's context inside the procedure. In this case, the caller's context is for the Finance department. The user is named <code class="codeph">"Finance"</code>, so that only data for employees who work in the Finance department is accessible to the user.
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D" title="This tutorial demonstrates how to control access to sensitive data in the HR schema by using code based access control.">Tutorial: Controlling Access to Sensitive Data Using Code Based Access Control</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG680"></a><div class="props_rev_3"><a id="GUID-9C8DA467-25DF-4093-A004-E08E704821A1" name="GUID-9C8DA467-25DF-4093-A004-E08E704821A1"></a><h5 id="DBSEG-GUID-9C8DA467-25DF-4093-A004-E08E704821A1" class="sect5">Step 1: Create the User and Grant HR the CREATE ROLE Privilege</h5>
                     <div>
                        <p>To begin, you must create the <code class="codeph">"Finance"</code> user account and then grant this the <code class="codeph">HR</code> user the <code class="codeph">CREATE ROLE</code> privilege.
                        </p>
                        <ol>
                           <li class="stepexpand"><span>Log into the database instance as an administrator who has privileges to create user accounts and roles.</span><div>
                                 <p>For example: </p><pre class="oac_no_warn" dir="ltr">sqlplus sec_admin
Enter password: <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create the <code class="codeph">"Finance"</code> user account.</span><div><pre class="oac_no_warn" dir="ltr">GRANT CONNECT TO "Finance" IDENTIFIED BY <span class="italic">password</span>;
</pre><p>Ensure that you enter <code class="codeph">"Finance"</code> in the case shown, enclosed by double quotation marks. Follow the guidelines in <a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle provides a set of minimum requirements for passwords.">Minimum Requirements for Passwords</a> to replace <span class="italic"><code class="codeph">password</code></span> with a password that is secure.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Grant the <code class="codeph">CREATE ROLE</code> privilege to user <code class="codeph">HR</code>.</span><div><pre class="oac_no_warn" dir="ltr">GRANT CREATE ROLE TO HR;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D" title="This tutorial demonstrates how to control access to sensitive data in the HR schema by using code based access control.">Tutorial: Controlling Access to Sensitive Data Using Code Based Access Control</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG681"></a><div class="props_rev_3"><a id="GUID-214608A1-D504-4E9C-81EF-BDBCB7631CD9" name="GUID-214608A1-D504-4E9C-81EF-BDBCB7631CD9"></a><h5 id="DBSEG-GUID-214608A1-D504-4E9C-81EF-BDBCB7631CD9" class="sect5">Step 2: Create the print_employees Invoker's Rights Procedure</h5>
                     <div>
                        <p>The <code class="codeph">print_employees</code> invoker's rights procedure shows employee information in the current user's department. 
                        </p>
                        <div class="section">You must create this procedure as an invoker's rights procedure because you must know who the caller is when inside the procedure.</div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Connect as user <code class="codeph">HR</code>.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT HR
Enter password: <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create the <code class="codeph">print_employees</code> procedure as follows.</span><div><pre class="pre codeblock"><code>create or replace procedure print_employees
authid current_user
as 
begin
  dbms_output.put_line(rpad('ID', 10) ||
                       rpad('First Name', 15)  ||
                       rpad('Last Name', 15)   ||
                       rpad('Email', 15)       ||
                       rpad('Phone Number', 20));
  for rec in (select e.employee_id, e.first_name, e.last_name, 
                     e.email, e.phone_number
                from hr.employees e, hr.departments d 
               where e.department_id = d.department_id
                 and d.department_name = 
                     sys_context('userenv', 'current_user'))
  loop
    dbms_output.put_line(rpad(rec.employee_ID, 10)  ||
                         rpad(rec.first_name, 15)   || 
                         rpad(rec.last_name, 15)    ||
                         rpad(rec.email, 15)        ||
                         rpad(rec.phone_number, 20));
  end loop;
end;
/</code></pre><p>In this example:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><code class="codeph">dbms_output.put_line</code> prints the table header.
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">for rec in (select ...</code> finds the employee information for the caller's department, which for this tutorial is the Finance department for user <code class="codeph">"Finance"</code>. Had you created a user named <code class="codeph">"Marketing"</code> (which is also listed in the <code class="codeph">DEPARTMENT_NAME</code> column of the <code class="codeph">HR.EMPLOYEES</code> table), then the procedure could capture information for Marketing employees.
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">loop</code> and <code class="codeph">dbms_output.put_line</code> populate the output with the employee data from the Finance department. 
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D" title="This tutorial demonstrates how to control access to sensitive data in the HR schema by using code based access control.">Tutorial: Controlling Access to Sensitive Data Using Code Based Access Control</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG682"></a><div class="props_rev_3"><a id="GUID-5B846F6A-87A3-482F-B3D8-E95D04DCF939" name="GUID-5B846F6A-87A3-482F-B3D8-E95D04DCF939"></a><h5 id="DBSEG-GUID-5B846F6A-87A3-482F-B3D8-E95D04DCF939" class="sect5">Step 3: Create the hr_clerk Role and Grant Privileges for It</h5>
                     <div>
                        <p>Next, you are ready to create the <code class="codeph">hr_clerk</code> role, which must have the <code class="codeph">EXECUTE</code> privilege on the <code class="codeph">print_employees</code> procedure.
                        </p>
                        <div class="section">After you create this role, you must grant it to <code class="codeph">"Finance"</code>.
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create the <code class="codeph">hr_clerk</code> role. </span><div><pre class="oac_no_warn" dir="ltr">CREATE ROLE hr_clerk;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Grant the <code class="codeph">EXECUTE</code> privilege on the print_employees procedure to the <code class="codeph">hr_clerk</code> role.</span><div><pre class="oac_no_warn" dir="ltr">GRANT EXECUTE ON print_employees TO hr_clerk;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Grant the <code class="codeph">hr_clerk</code> role to <code class="codeph">"Finance"</code>.</span><div><pre class="oac_no_warn" dir="ltr">GRANT hr_clerk TO "Finance";</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D" title="This tutorial demonstrates how to control access to sensitive data in the HR schema by using code based access control.">Tutorial: Controlling Access to Sensitive Data Using Code Based Access Control</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG683"></a><div class="props_rev_3"><a id="GUID-7316DA6F-4746-43ED-81A6-DBB176227BD7" name="GUID-7316DA6F-4746-43ED-81A6-DBB176227BD7"></a><h5 id="DBSEG-GUID-7316DA6F-4746-43ED-81A6-DBB176227BD7" class="sect5">Step 4: Test the Code Based Access Control HR.print_employees Procedure</h5>
                     <div>
                        <p>At this stage, you are ready to test the code based access control <code class="codeph">HR.print_employees</code> procedure.
                        </p>
                        <div class="section">To test the code based access control <code class="codeph">HR.print_employees</code> procedure, user <code class="codeph">"Finance"</code> must query the <code class="codeph">HR.EMPLOYEES</code> table and try to run the <code class="codeph">HR.print_employees</code> procedure.
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Connect to the database instance as user <code class="codeph">"Finance"</code>. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT "Finance"
Enter password: <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Try to directly query the <code class="codeph">HR.EMPLOYEES</code> table. </span><div><pre class="oac_no_warn" dir="ltr">SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, SALARY FROM HR.EMPLOYEES;
</pre><p>The query fails because user <code class="codeph">Finance</code> does not have the <code class="codeph">SELECT</code> privilege for <code class="codeph">HR.EMPLOYEES</code>. 
                                 </p><pre class="oac_no_warn" dir="ltr">ERROR at line 1:
ORA-00942: table or view does not exist
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Execute the <code class="codeph">HR.print_employees</code> procedure. </span><div><pre class="oac_no_warn" dir="ltr">EXEC HR.print_employees;
</pre><p>The query fails because user <code class="codeph">"Finance"</code> does not have the appropriate privileges.
                                 </p><pre class="oac_no_warn" dir="ltr">ERROR at line 1:
ORA-00942: table or view does not exist
ORA-06512: at "HR.PRINT_EMPLOYEES", line 13ORA-06512: at line 1</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D" title="This tutorial demonstrates how to control access to sensitive data in the HR schema by using code based access control.">Tutorial: Controlling Access to Sensitive Data Using Code Based Access Control</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG684"></a><div class="props_rev_3"><a id="GUID-770D86DD-5B8C-4A11-B4CB-2488C8F0E64B" name="GUID-770D86DD-5B8C-4A11-B4CB-2488C8F0E64B"></a><h5 id="DBSEG-GUID-770D86DD-5B8C-4A11-B4CB-2488C8F0E64B" class="sect5">Step 5: Create the view_emp_role Role and Grant Privileges for It</h5>
                     <div>
                        <p>Next, user <code class="codeph">HR</code> must create the <code class="codeph">view_emp_role</code> role and then grant privileges to it.
                        </p>
                        <div class="section">User <code class="codeph">HR</code> grants the <code class="codeph">SELECT</code> privilege  <code class="codeph">HR.EMPLOYEES</code> and <code class="codeph">HR.DEPARTMENTS</code> to the <code class="codeph">view_emp_role</code> role, and then grants <code class="codeph">SELECT</code> on <code class="codeph">HR.EMPLOYEES</code> and <code class="codeph">HR.DEPARTMENTS</code> to the <code class="codeph">view_emp_role</code> role.
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Connect as user <code class="codeph">HR</code>. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT HR
Enter password: <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create the <code class="codeph">view_emp_role</code> role.</span><div><pre class="oac_no_warn" dir="ltr">CREATE ROLE view_emp_role;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Grant the <code class="codeph">SELECT</code> privilege on <code class="codeph">HR.EMPLOYEES</code> and <code class="codeph">HR.DEPARTMENTS</code> to the <code class="codeph">view_emp_role</code> role.</span><div><pre class="oac_no_warn" dir="ltr">GRANT SELECT ON HR.EMPLOYEES TO view_emp_role;
GRANT SELECT ON HR.DEPARTMENTS TO view_emp_role;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Grant the <code class="codeph">view_emp_role</code> role to the <code class="codeph">HR.print_employees</code> invoker's rights procedure.</span><div><pre class="oac_no_warn" dir="ltr">GRANT view_emp_role TO PROCEDURE HR.print_employees;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D" title="This tutorial demonstrates how to control access to sensitive data in the HR schema by using code based access control.">Tutorial: Controlling Access to Sensitive Data Using Code Based Access Control</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG685"></a><div class="props_rev_3"><a id="GUID-B124BA6A-E0C2-4C7E-9B0D-8FD7BD4810E2" name="GUID-B124BA6A-E0C2-4C7E-9B0D-8FD7BD4810E2"></a><h5 id="DBSEG-GUID-B124BA6A-E0C2-4C7E-9B0D-8FD7BD4810E2" class="sect5">Step 6: Test the HR.print_employees Procedure Again</h5>
                     <div>
                        <p>With the appropriate privileges in place, user <code class="codeph">"Finance"</code> can try the <code class="codeph">HR.print_employees</code> procedure again.
                        </p>
                        <ol>
                           <li class="stepexpand"><span>Connect as user <code class="codeph">"Finance"</code>.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT "Finance"
Enter password: <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Set the server output to display. </span><div><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Try to directly query the <code class="codeph">HR.EMPLOYEES</code> table. </span><div><pre class="oac_no_warn" dir="ltr">SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, SALARY FROM HR.EMPLOYEES;
</pre><p>The query fails. </p><pre class="oac_no_warn" dir="ltr">ERROR at line 1:
ORA-00942: table or view does not exist
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Execute the <code class="codeph">HR.print_employees</code> procedure to show the employee information.</span><div><pre class="oac_no_warn" dir="ltr">EXEC HR.print_employees;
</pre><p>The call succeeds. </p><pre class="oac_no_warn" dir="ltr">ID        First Name     Last Name      Email          Phone Number
108       Nancy          Greenberg      NGREENBE       515.124.4569
109       Daniel         Faviet         DFAVIET        515.124.4169
110       John           Chen           JCHEN          515.124.4269
111       Ismael         Sciarra        ISCIARRA       515.124.4369
112       Jose Manuel    Urman          JMURMAN        515.124.4469
113       Luis           Popp           LPOPP          515.124.4567

PL/SQL procedure successfully completed.</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D" title="This tutorial demonstrates how to control access to sensitive data in the HR schema by using code based access control.">Tutorial: Controlling Access to Sensitive Data Using Code Based Access Control</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG947"></a><div class="props_rev_3"><a id="GUID-AC53C480-FB4E-44D5-A08C-091ECD614417" name="GUID-AC53C480-FB4E-44D5-A08C-091ECD614417"></a><h5 id="DBSEG-GUID-AC53C480-FB4E-44D5-A08C-091ECD614417" class="sect5">Step 7: Remove the Components of This Tutorial</h5>
                     <div>
                        <p>If you no longer need the components of this tutorial, then you can remove them.</p>
                        <ol>
                           <li class="stepexpand"><span>Connect as a user with administrative privileges.</span><div>
                                 <p>For example: </p><pre class="oac_no_warn" dir="ltr">CONNECT sec_admin
Enter password: <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Drop the user <code class="codeph">"Finance"</code>. </span><div><pre class="oac_no_warn" dir="ltr">DROP USER "Finance";
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Drop the <code class="codeph">hr_clerk</code> role. </span><div><pre class="oac_no_warn" dir="ltr">DROP ROLE hr_clerk;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Connect as user <code class="codeph">HR</code>. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT HR
Enter password: <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Drop the view_emp_role role and the <code class="codeph">HR.print_employees</code> procedure. </span><div><pre class="oac_no_warn" dir="ltr">DROP ROLE view_emp_role;
DROP PROCEDURE print_employees;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Connect as the administrative user.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sec_admin
Enter password: <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Revoke the <code class="codeph">CREATE ROLE</code> privilege from <code class="codeph">HR</code>. </span><div><pre class="oac_no_warn" dir="ltr">REVOKE CREATE ROLE FROM HR;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-1CBA23D1-FC6B-4544-A281-7D85071FF89D" title="This tutorial demonstrates how to control access to sensitive data in the HR schema by using code based access control.">Tutorial: Controlling Access to Sensitive Data Using Code Based Access Control</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-B354724F-BD35-47C7-A699-93C2B6389555" name="GUID-B354724F-BD35-47C7-A699-93C2B6389555"></a><h3 id="DBSEG-GUID-B354724F-BD35-47C7-A699-93C2B6389555" class="sect3">Controlling Definer's Rights Privileges for Database Links</h3>
               <div>
                  <p>You can control privilege grants for definer’s rights procedures if your applications use database links and definer’s rights procedures.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-ABDCBD05-6B09-4A4D-8B2D-0DE70A165050">About Controlling Definer's Rights Privileges for Database Links</a><br>When a definer’s rights procedure connects to a database link, operations on the database link should use the procedure owner’s credentials. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-F5B2E3CA-0D55-470C-8A08-A1547ADD8B40">Grants of the INHERIT REMOTE PRIVILEGES Privilege to Other Users</a><br>The <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege enables the current user to have explicit privileges over the connected user in the database.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-647FDF5D-1037-4182-8B47-5F0EE3544C41">Example: Granting INHERIT REMOTE PRIVILEGES on a Connected User</a><br>You can grant the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege on a connected user to the current user. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-8F17EFE1-6F10-4FB1-BE7D-EF1D4CFE0044">Grants of the INHERIT ANY REMOTE PRIVILEGES Privilege to Other Users</a><br>The <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privilege enables the grantee user to open a <code class="codeph"><span class="codeinlineitalic">connected_user</span></code> database link as any user. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-AE54CF0B-B3B3-4067-B0B2-53D2F6FAF4EF">Revokes of the INHERIT [ANY] REMOTE PRIVILEGES Privilege</a><br>The methods for revoking the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> and <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privileges differ. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-9B46EE01-E7D5-41C6-947D-AB090430CFFE">Example: Revoking the INHERIT REMOTE PRIVILEGES Privilege</a><br>The <code class="codeph">REVOKE</code> SQL statement can revoke the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-77A565F9-65D6-404D-A5CE-CD2D4E5F5FA4">Example: Revoking the INHERIT REMOTE PRIVILEGES Privilege from PUBLIC</a><br>The <code class="codeph">REVOKE</code> SQL statement can revoke the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> from <code class="codeph">PUBLIC</code>, as well as from individual procedure owners. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D395C9FA-D9C5-4044-BC85-E09BF191BD23">Tutorial: Using a Database Link in a Definer's Rights Procedure</a><br>This tutorial demonstrates how the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege works in a definer's rights procedure that uses a database link. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-EF625176-A3AA-47F5-BAEE-248DBAAF22A3" title="Invoker’s rights and definer’s rights have several security advantages when used to control access to privileges to run user-created procedures.">Managing Security for Definer's Rights and&nbsp;Invoker's Rights</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-ABDCBD05-6B09-4A4D-8B2D-0DE70A165050" name="GUID-ABDCBD05-6B09-4A4D-8B2D-0DE70A165050"></a><h4 id="DBSEG-GUID-ABDCBD05-6B09-4A4D-8B2D-0DE70A165050" class="sect4">About Controlling Definer's Rights Privileges for Database Links</h4>
                  <div>
                     <p>When a definer’s rights procedure connects to a database link, operations on the database link should use the procedure owner’s credentials. </p>
                     <p>The <code class="codeph">INHERIT REMOTE PRIVILEGES</code> and <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privileges apply when a connected user database link is used with a definer’s rights procedure. These privileges allow the use of the credentials of the logged-in user for connected user database link operations with definer rights procedures.
                     </p>
                     <p>You can perform a grant of the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> and <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privileges so the users who invoke the definer’s rights procedure can use a connected user database link within a definer’s rights block. A definer’s rights procedure executes with the privileges of the procedure owner. However, a connected user database link operation must have the credentials of the logged in user. Hence, the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> and <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privileges are required to be granted to enable the database link operations within the definer’s rights block.
                     </p>
                     <p>Be aware that during an upgrade, the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> and <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privileges are not granted by default to any existing users. 
                     </p>
                     <p>The <code class="codeph">INHERIT REMOTE PRIVILEGES</code> and <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privileges apply only to situations in which users are trying to connect to user database links in a definer’s rights procedure. In addition, these privileges apply to both privately created and publicly created database links. By default, database links are created as private links. In addition, by default, <code class="codeph">INHERIT REMOTE PRIVILEGES</code> is not granted to <code class="codeph">PUBLIC</code>.
                     </p>
                     <p>The ways that you can perform grants of these privileges are as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">GRANT INHERIT REMOTE PRIVILEGES ON USER <span class="codeinlineitalic">dbuser_1</span> TO <span class="codeinlineitalic">dbuser_2</span></code>: In this scenario, <code class="codeph">dbuser_1</code> can explicitly grant the <code class="codeph">INHERIT REMOTE PRIVILEGE</code> privilege to <code class="codeph">dbuser_2</code> and use a definer’s rights procedure that user <code class="codeph">dbuser_2</code> owns. 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">GRANT INHERIT REMOTE PRIVILEGES ON USER <span class="codeinlineitalic">dbuser_1</span> TO PUBLIC</code>. In this scenario, <code class="codeph">dbuser_1</code> grants the <code class="codeph">INHERIT REMOTE PRIVILEGE</code> privilege to public. This grant enables <code class="codeph">dbuser_1</code> to use the definer’s rights procedures that any other user owns. 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">GRANT INHERIT ANY REMOTE PRIVILEGES TO <span class="codeinlineitalic">dbuser_2</span></code>: In this scenario, any user can use the definer’s rights procedures that <code class="codeph">dbuser_2</code> owns. 
                           </p>
                        </li>
                     </ul>
                     <p>If the user does not have the <code class="codeph">INHERIT REMOTE PRIVILEGE</code> privilege and tries to execute the definer’s rights privilege, then the <code class="codeph">ORA-25433: User  does not have INHERIT REMOTE PRIVILEGES</code> error appears.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B354724F-BD35-47C7-A699-93C2B6389555" title="You can control privilege grants for definer’s rights procedures if your applications use database links and definer’s rights procedures.">Controlling Definer's Rights Privileges for Database Links</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-F5B2E3CA-0D55-470C-8A08-A1547ADD8B40" name="GUID-F5B2E3CA-0D55-470C-8A08-A1547ADD8B40"></a><h4 id="DBSEG-GUID-F5B2E3CA-0D55-470C-8A08-A1547ADD8B40" class="sect4">Grants of the INHERIT REMOTE PRIVILEGES Privilege to Other Users</h4>
                  <div>
                     <p>The <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege enables the current user to have explicit privileges over the connected user in the database.
                     </p>
                     <p>The syntax for granting the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege is as follows: 
                     </p><pre class="oac_no_warn" dir="ltr">GRANT INHERIT REMOTE PRIVILEGES ON USER <span class="italic">connected_user</span> TO <span class="italic">current_user</span>:</pre><p>In this specification:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph"><span class="codeinlineitalic">connected_user</span></code> is the user who runs the definer's rights procedure.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph"><span class="codeinlineitalic">current_user</span></code> is the user who owns the definer's right procedure. This value must be a database user account. As an alternative to granting the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege to the procedure's owner, you can grant the privilege to a role that is in turn granted to the procedure.
                           </p>
                        </li>
                     </ul>
                     <p>Users or roles who own the definer's rights procedures must have the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege granted to them by users who will run their definer's rights procedures. 
                     </p>
                     <p>Any user can grant or revoke the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege on themselves to the user whose definer's rights procedures they want to run.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B354724F-BD35-47C7-A699-93C2B6389555" title="You can control privilege grants for definer’s rights procedures if your applications use database links and definer’s rights procedures.">Controlling Definer's Rights Privileges for Database Links</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-647FDF5D-1037-4182-8B47-5F0EE3544C41" name="GUID-647FDF5D-1037-4182-8B47-5F0EE3544C41"></a><h4 id="DBSEG-GUID-647FDF5D-1037-4182-8B47-5F0EE3544C41" class="sect4">Example: Granting INHERIT REMOTE PRIVILEGES on a Connected User</h4>
                  <div>
                     <p>You can grant the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege on a connected user to the current user. 
                     </p>
                     <p>In this example, the connected user, <code class="codeph">jward</code>, must have remote privileges on the current user, <code class="codeph">ebrown</code>. This enables <code class="codeph">jward</code> to execute the definer's right procedure that <code class="codeph">ebrown</code> created.
                     </p>
                     <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-647FDF5D-1037-4182-8B47-5F0EE3544C41__GRANTINGINHERITREMOTEPRIVILEGESONAC-FB84E1C6">Example 7-4</a> shows how an administrator (or user <code class="codeph">jward</code>) can grant the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> on user <code class="codeph">jward</code> to user <code class="codeph">ebrown</code>. This privilege grant enables any definer's rights procedure that <code class="codeph">ebrown</code> writes, or will write in the future, to access <code class="codeph">ebrown</code>'s privileges when the procedure is run.
                     </p>
                     <div class="example" id="GUID-647FDF5D-1037-4182-8B47-5F0EE3544C41__GRANTINGINHERITREMOTEPRIVILEGESONAC-FB84E1C6">
                        <p class="titleinexample">Example 7-4 Granting INHERIT REMOTE PRIVILEGES on a Connected User to the Current User</p><pre class="oac_no_warn" dir="ltr">GRANT INHERIT REMOTE PRIVILEGES on user jward to ebrown;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B354724F-BD35-47C7-A699-93C2B6389555" title="You can control privilege grants for definer’s rights procedures if your applications use database links and definer’s rights procedures.">Controlling Definer's Rights Privileges for Database Links</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-8F17EFE1-6F10-4FB1-BE7D-EF1D4CFE0044" name="GUID-8F17EFE1-6F10-4FB1-BE7D-EF1D4CFE0044"></a><h4 id="DBSEG-GUID-8F17EFE1-6F10-4FB1-BE7D-EF1D4CFE0044" class="sect4">Grants of the INHERIT ANY REMOTE PRIVILEGES Privilege to Other Users</h4>
                  <div>
                     <p>The <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privilege enables the grantee user to open a <code class="codeph"><span class="codeinlineitalic">connected_user</span></code> database link as any user. 
                     </p>
                     <p>As with all <code class="codeph">ANY</code> privileges, <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> is a powerful privilege that must only be granted to trusted users. By default, user <code class="codeph">SYS</code> has the <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> system privilege <code class="codeph">WITH GRANT OPTION</code>. To find users who have been granted the <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privilege, query the <code class="codeph">DBA_SYS_PRIVS</code> data dictionary view.
                     </p>
                     <p>For better security in a multitenant environment, Oracle recommends that you protect the <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privilege with a PDB lockdown profile. A PDB lockdown profile prevents local pluggable database (PDB) users from opening a connected user database link as a common user, irrespective of the kind of <code class="codeph">INHERIT REMOTE PRIVILEGE</code> the PDB user has. If the PDB is protected by a PDB lockdown profile, then grants such as <code class="codeph">GRANT INHERIT REMOTE PRIVILEGES</code> and <code class="codeph">GRANT INHERIT ANY REMOTE</code> privileges succeed but the effects of these grants do not apply as long as the PDB lockdown continues. 
                     </p>
                     <p>The syntax for granting the <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privilege is as follows:
                     </p><pre class="oac_no_warn" dir="ltr">GRANT INHERIT ANY REMOTE PRIVILEGES TO <span class="italic">current_user</span>;</pre><p>In this specification, <code class="codeph"><span class="codeinlineitalic">current_user</span></code> is the user who owns the define’s right procedure.
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="configuring-privilege-and-role-authorization.html#GUID-AB5E62DB-7E2A-4B5A-BA96-A2BD2DF15275" title="You can use PDB lockdown profiles in a multitenant environment to restrict sets of user operations in pluggable databases (PDBs).">Restricting Operations on PDBs Using PDB Lockdown Profiles</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B354724F-BD35-47C7-A699-93C2B6389555" title="You can control privilege grants for definer’s rights procedures if your applications use database links and definer’s rights procedures.">Controlling Definer's Rights Privileges for Database Links</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-AE54CF0B-B3B3-4067-B0B2-53D2F6FAF4EF" name="GUID-AE54CF0B-B3B3-4067-B0B2-53D2F6FAF4EF"></a><h4 id="DBSEG-GUID-AE54CF0B-B3B3-4067-B0B2-53D2F6FAF4EF" class="sect4">Revokes of the INHERIT [ANY] REMOTE PRIVILEGES Privilege</h4>
                  <div>
                     <p>The methods for revoking the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> and <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privileges differ. 
                     </p>
                     <p>The <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege can be revoked by a user from another user. The <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privilege must be revoked by a user with administrative privileges.
                     </p>
                     <p>The revocation syntax is as follows</p><pre class="oac_no_warn" dir="ltr">REVOKE INHERIT REMOTE PRIVILEGES ON USER <span class="italic">connected_user</span> FROM <span class="italic">current_user</span>;</pre><p>In this specification:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph"><span class="codeinlineitalic">connected_user</span></code> is the user who runs the definer's rights procedure.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph"><span class="codeinlineitalic">current_user</span></code> is the user who owns the definer’s rights procedure.
                           </p>
                        </li>
                     </ul>
                     <p>If you want to revoke the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> or <code class="codeph">INHERIT ANY REMOTE PRIVILEGES</code> privilege from a user, use the standard revocation syntax, as follows: 
                     </p><pre class="oac_no_warn" dir="ltr">REVOKE INHERIT REMOTE PRIVILEGES FROM <span class="italic">connected_user</span>;
REVOKE INHERIT ANY REMOTE PRIVILEGES FROM <span class="italic">current_user</span>;</pre></div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-AE54CF0B-B3B3-4067-B0B2-53D2F6FAF4EF__GUID-DE36BA66-012E-44AD-84EB-F22BF589BD52">
                        <p class="notep1">See Also:</p><a href="../sqlrf/REVOKE.html#SQLRF01609" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for more information about the <code class="codeph">REVOKE</code> SQL statement
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B354724F-BD35-47C7-A699-93C2B6389555" title="You can control privilege grants for definer’s rights procedures if your applications use database links and definer’s rights procedures.">Controlling Definer's Rights Privileges for Database Links</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-9B46EE01-E7D5-41C6-947D-AB090430CFFE" name="GUID-9B46EE01-E7D5-41C6-947D-AB090430CFFE"></a><h4 id="DBSEG-GUID-9B46EE01-E7D5-41C6-947D-AB090430CFFE" class="sect4">Example: Revoking the INHERIT REMOTE PRIVILEGES Privilege</h4>
                  <div>
                     <p>The <code class="codeph">REVOKE</code> SQL statement can revoke the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege.
                     </p>
                     <p>After you revoke the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege, if user <code class="codeph">jward</code> executes a definer's rights procedure that <code class="codeph">jward</code> owns, then any operation on a connected user database link inside the definer’s rights procedure fails because <code class="codeph">jward</code> has explicitly denied <code class="codeph">ebrown</code> the privilege to open a connected user database link using <code class="codeph">jward</code>’credentials. 
                     </p>
                     <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-9B46EE01-E7D5-41C6-947D-AB090430CFFE__EXAMPLETITLE-FB8B3449">Example 7-5</a> shows how to revoke the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> procedure on the connecting user, <code class="codeph">jward</code>, from the procedure owner, <code class="codeph">ebrown</code>.
                     </p>
                     <div class="example" id="GUID-9B46EE01-E7D5-41C6-947D-AB090430CFFE__EXAMPLETITLE-FB8B3449">
                        <p class="titleinexample">Example 7-5 Revoking the INHERIT REMOTE PRIVILEGES Privilege</p><pre class="oac_no_warn" dir="ltr">REVOKE INHERIT REMOTE PRIVILEGES ON USER jward FROM ebrown;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B354724F-BD35-47C7-A699-93C2B6389555" title="You can control privilege grants for definer’s rights procedures if your applications use database links and definer’s rights procedures.">Controlling Definer's Rights Privileges for Database Links</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-77A565F9-65D6-404D-A5CE-CD2D4E5F5FA4" name="GUID-77A565F9-65D6-404D-A5CE-CD2D4E5F5FA4"></a><h4 id="DBSEG-GUID-77A565F9-65D6-404D-A5CE-CD2D4E5F5FA4" class="sect4">Example: Revoking the INHERIT REMOTE PRIVILEGES Privilege from PUBLIC</h4>
                  <div>
                     <p>The <code class="codeph">REVOKE</code> SQL statement can revoke the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> from <code class="codeph">PUBLIC</code>, as well as from individual procedure owners. 
                     </p>
                     <p><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-77A565F9-65D6-404D-A5CE-CD2D4E5F5FA4__REVOKINGTHEINHERITREMOTEPRIVILEGESP-FB8C18FC">Example 7-6</a> shows how to revoke this privilege from <code class="codeph">PUBLIC</code>.
                     </p>
                     <div class="example" id="GUID-77A565F9-65D6-404D-A5CE-CD2D4E5F5FA4__REVOKINGTHEINHERITREMOTEPRIVILEGESP-FB8C18FC">
                        <p class="titleinexample">Example 7-6 Revoking the INHERIT REMOTE PRIVILEGES Privilege from PUBLIC</p><pre class="oac_no_warn" dir="ltr">REVOKE INHERIT REMOTE PRIVILEGES FROM PUBLIC;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B354724F-BD35-47C7-A699-93C2B6389555" title="You can control privilege grants for definer’s rights procedures if your applications use database links and definer’s rights procedures.">Controlling Definer's Rights Privileges for Database Links</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-D395C9FA-D9C5-4044-BC85-E09BF191BD23" name="GUID-D395C9FA-D9C5-4044-BC85-E09BF191BD23"></a><h4 id="DBSEG-GUID-D395C9FA-D9C5-4044-BC85-E09BF191BD23" class="sect4">Tutorial: Using a Database Link in a Definer's Rights Procedure</h4>
                  <div>
                     <p>This tutorial demonstrates how the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege works in a definer's rights procedure that uses a database link. 
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-8E3C97BB-69E5-4845-AEC4-4F5933AD1962">About This Tutorial</a><br>In this tutorial,  you test the privilege grant and revoke of the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege. 
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-0760779E-07C5-4800-8364-4A4571E9A87F">Step 1: Create User Accounts</a><br>You must create a user who creates a definer's rights procedure that has a database link, and a second user who executes this procedure.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-986124C5-BCDC-4A27-893A-D443AFC2417A">Step 2: As User dbuser2, Create a Table to Store User IDs</a><br>The user IDs in this table are the IDs that the database link uses.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-5C6C0986-4532-4FE7-8AC7-9F47C927DCC3">Step 3: As User dbuser1, Create a Database Link and Definer's Rights Procedure</a><br>User <code class="codeph">dbuser1</code> is ready to create a database link and then a definer's rights procedure that references the database link.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-9A2A58FB-2BC0-412F-9099-8F0084FABCF1">Step 4: Test the Definer's Rights Procedure</a><br>User <code class="codeph">dbuser2</code> must grant <code class="codeph">INHERIT REMOTE PRIVILEGES</code> to <code class="codeph">dbuser1</code> before the definer’s rights procedure can be tested.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-562B2E94-D52A-47B0-9588-4E9E1BEDEA51">Step 5: Remove the Components of This Tutorial</a><br>If you no longer need the components of this tutorial, then you can remove them.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-B354724F-BD35-47C7-A699-93C2B6389555" title="You can control privilege grants for definer’s rights procedures if your applications use database links and definer’s rights procedures.">Controlling Definer's Rights Privileges for Database Links</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-8E3C97BB-69E5-4845-AEC4-4F5933AD1962" name="GUID-8E3C97BB-69E5-4845-AEC4-4F5933AD1962"></a><h5 id="DBSEG-GUID-8E3C97BB-69E5-4845-AEC4-4F5933AD1962" class="sect5">About This Tutorial</h5>
                     <div>
                        <p>In this tutorial,  you test the privilege grant and revoke of the <code class="codeph">INHERIT REMOTE PRIVILEGES</code> privilege. 
                        </p>
                        <p>To accomplish this, you must create two users, one who creates a definer’s rights procedure that refers to a database link, and a second user to execute this definer’s rights procedure. Both users create identical look-up tables in their schemas. The definer’s rights procedure must enable the second user to query the lookup table that belongs to the definer’s rights users.</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D395C9FA-D9C5-4044-BC85-E09BF191BD23" title="This tutorial demonstrates how the INHERIT REMOTE PRIVILEGES privilege works in a definer's rights procedure that uses a database link.">Tutorial: Using a Database Link in a Definer's Rights Procedure</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-0760779E-07C5-4800-8364-4A4571E9A87F" name="GUID-0760779E-07C5-4800-8364-4A4571E9A87F"></a><h5 id="DBSEG-GUID-0760779E-07C5-4800-8364-4A4571E9A87F" class="sect5">Step 1: Create User Accounts</h5>
                     <div>
                        <p>You must create a user who creates a definer's rights procedure that has a database link, and a second user who executes this procedure.</p>
                        <div class="section"></div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Connect as a user who has privileges to create users and perform privilege grants. </span><div>
                                 <p>For example:</p><pre class="oac_no_warn" dir="ltr">sqlplus sec_admin
Enter password: <span class="italic">password</span></pre></div>
                           </li>
                           <li class="stepexpand"><span>Create the user accounts as follows: </span><div><pre class="oac_no_warn" dir="ltr">GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO dbuser1 IDENTIFIED BY <span class="italic">password</span>;
GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO dbuser2 IDENTIFIED BY <span class="italic">password</span>;</pre></div>
                              <div>Follow the guidelines in <a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle provides a set of minimum requirements for passwords.">Minimum Requirements for Passwords</a> to replace <span class="italic"><code class="codeph">password</code></span> with a password that is secure.
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D395C9FA-D9C5-4044-BC85-E09BF191BD23" title="This tutorial demonstrates how the INHERIT REMOTE PRIVILEGES privilege works in a definer's rights procedure that uses a database link.">Tutorial: Using a Database Link in a Definer's Rights Procedure</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-986124C5-BCDC-4A27-893A-D443AFC2417A" name="GUID-986124C5-BCDC-4A27-893A-D443AFC2417A"></a><h5 id="DBSEG-GUID-986124C5-BCDC-4A27-893A-D443AFC2417A" class="sect5">Step 2: As User dbuser2, Create a Table to Store User IDs</h5>
                     <div>
                        <p>The user IDs in this table are the IDs that the database link uses.</p>
                        <div class="section"></div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Connect as user <code class="codeph">dbuser2</code> to instance <code class="codeph">inst1</code>.</span><div><pre class="oac_no_warn" dir="ltr">connect dbuser2@inst1
Enter password: <span class="italic">password</span></pre></div>
                           </li>
                           <li class="stepexpand"><span>Create the following table:</span><div><pre class="oac_no_warn" dir="ltr">CREATE TABLE dbusertab(ID NUMBER(2));</pre></div>
                           </li>
                           <li class="stepexpand"><span>Populate this table with the ID value <code class="codeph">10</code>. </span><div><pre class="oac_no_warn" dir="ltr">INSERT INTO dbusertab VALUES(10);</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D395C9FA-D9C5-4044-BC85-E09BF191BD23" title="This tutorial demonstrates how the INHERIT REMOTE PRIVILEGES privilege works in a definer's rights procedure that uses a database link.">Tutorial: Using a Database Link in a Definer's Rights Procedure</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-5C6C0986-4532-4FE7-8AC7-9F47C927DCC3" name="GUID-5C6C0986-4532-4FE7-8AC7-9F47C927DCC3"></a><h5 id="DBSEG-GUID-5C6C0986-4532-4FE7-8AC7-9F47C927DCC3" class="sect5">Step 3: As User dbuser1, Create a Database Link and Definer's Rights Procedure</h5>
                     <div>
                        <p>User <code class="codeph">dbuser1</code> is ready to create a database link and then a definer's rights procedure that references the database link.
                        </p>
                        <div class="section"></div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Connect as user <code class="codeph">dbuser1</code> to instance <code class="codeph">inst1</code>.</span><div><pre class="oac_no_warn" dir="ltr">connect dbuser1@inst1
Enter password: <span class="italic">password</span></pre></div>
                           </li>
                           <li class="stepexpand"><span>Create a database link, which will be used in the definer's rights procedure.</span><div><pre class="oac_no_warn" dir="ltr">CREATE DATABASE LINK dblink USING 'inst1';</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create a <code class="codeph">dbusertab</code> table and then populate it with the ID <code class="codeph">20</code>. </span><div><pre class="oac_no_warn" dir="ltr">CREATE TABLE DBUSERTAB(ID NUMBER(2));
INSERT INTO dbusertab VALUES(20);</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create a  definer's rights procedure that contains a reference to the database lnk </span><div><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PROCEDURE test_remote_db_link
AS
v_id varchar(50);
BEGIN   
    SELECT ID INTO v_id FROM dbusertab@dblink;
    DBMS_OUTPUT.PUT_LINE('v_id : ' || v_id);
END ;
/</pre></div>
                           </li>
                           <li class="stepexpand"><span>Test the definer’s rights procedure.</span><div><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
EXEC test_remote_db_link; </pre></div>
                              <div>
                                 <p>The output should be as follows, indicating that user <code class="codeph">dbuser1</code> has executed the procedure on his own version of the table <code class="codeph">dbusertab</code>:
                                 </p><pre class="oac_no_warn" dir="ltr">v_id : 20
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Grant the user <code class="codeph">dbuser2</code> the <code class="codeph">EXECUTE</code> privilege on the <code class="codeph">test_remote_db_link</code> procedure.</span><div><pre class="oac_no_warn" dir="ltr">GRANT EXECUTE ON test_remote_db_link TO dbuser2;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D395C9FA-D9C5-4044-BC85-E09BF191BD23" title="This tutorial demonstrates how the INHERIT REMOTE PRIVILEGES privilege works in a definer's rights procedure that uses a database link.">Tutorial: Using a Database Link in a Definer's Rights Procedure</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-9A2A58FB-2BC0-412F-9099-8F0084FABCF1" name="GUID-9A2A58FB-2BC0-412F-9099-8F0084FABCF1"></a><h5 id="DBSEG-GUID-9A2A58FB-2BC0-412F-9099-8F0084FABCF1" class="sect5">Step 4: Test the Definer's Rights Procedure</h5>
                     <div>
                        <p>User <code class="codeph">dbuser2</code> must grant <code class="codeph">INHERIT REMOTE PRIVILEGES</code> to <code class="codeph">dbuser1</code> before the definer’s rights procedure can be tested.
                        </p>
                        <div class="section"></div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Connect as user <code class="codeph">dbuser2</code> to instance <code class="codeph">inst1</code>.</span><div><pre class="oac_no_warn" dir="ltr">connect dbuser2@inst1
Enter password: <span class="italic">password</span></pre></div>
                           </li>
                           <li class="stepexpand"><span>Grant the <code class="codeph">INHERIT REMOTE PRIVILEGE</code> privilege on user <code class="codeph">dbuser2</code> to <code class="codeph">dbuser1</code>.</span><div><pre class="oac_no_warn" dir="ltr">GRANT INHERIT REMOTE PRIVILEGES ON user dbuser2 TO dbuser1;</pre></div>
                           </li>
                           <li class="stepexpand"><span>Relog back in, because the grant does not take effect until you start a new session.</span><div><pre class="oac_no_warn" dir="ltr">connect dbuser2@inst1
Enter password: <span class="italic">password</span></pre></div>
                           </li>
                           <li class="stepexpand"><span>Execute the <code class="codeph">test_remote_db_link</code> definer’s rights procedure: </span><div><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
EXEC dbuser1.test_remote_db_link;  </pre></div>
                              <div>The output shows the following, which indicates that user <code class="codeph">dbuser1</code> is able to use the database link to connect to the schema of <code class="codeph">dbuser2</code> and access the values in the <code class="codeph">dbusertab</code> table in <code class="codeph">dbuser2</code>’s schema. <pre class="oac_no_warn" dir="ltr">v_id : 10
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Revoke the <code class="codeph">INHERIT REMOTE PRIVILEGE</code> privilege on <code class="codeph">dbuser2</code> from <code class="codeph">dbuser1</code>.</span><div><pre class="oac_no_warn" dir="ltr">REVOKE INHERIT REMOTE PRIVILEGES ON USER dbuser2 FROM dbuser1;</pre></div>
                           </li>
                           <li class="stepexpand"><span>Try executing the <code class="codeph">test_remote_db_link</code> definer’s rights procedure again. </span><div><pre class="oac_no_warn" dir="ltr">EXEC dbuser1.test_remote_db_link;</pre></div>
                              <div>
                                 <p>The <code class="codeph">ORA-25433: User DBUSER1 does not have INHERIT REMOTE PRIVILEGES on connected user DBUSER2</code> error should appear.
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D395C9FA-D9C5-4044-BC85-E09BF191BD23" title="This tutorial demonstrates how the INHERIT REMOTE PRIVILEGES privilege works in a definer's rights procedure that uses a database link.">Tutorial: Using a Database Link in a Definer's Rights Procedure</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-562B2E94-D52A-47B0-9588-4E9E1BEDEA51" name="GUID-562B2E94-D52A-47B0-9588-4E9E1BEDEA51"></a><h5 id="DBSEG-GUID-562B2E94-D52A-47B0-9588-4E9E1BEDEA51" class="sect5">Step 5: Remove the Components of This Tutorial</h5>
                     <div>
                        <p>If you no longer need the components of this tutorial, then you can remove them.</p>
                        <div class="section"></div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Connect as a user who has privileges to drop user accounts and database links</span><div>
                                 <p>For example:</p><pre class="oac_no_warn" dir="ltr">connect sec_admin
Enter password: <span class="italic">password</span></pre></div>
                           </li>
                           <li class="stepexpand"><span>Drop the user accounts.</span><div><pre class="oac_no_warn" dir="ltr">DROP USER dbuser1 CASCADE;
DROP USER dbuser2 CASCADE;</pre></div>
                           </li>
                           <li class="stepexpand"><span>Drop the <code class="codeph">dblink</code> database link.</span><div><pre class="oac_no_warn" dir="ltr">DROP PUBLIC DATABASE LINK dblink;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-definers-rights-and-invokers-rights.html#GUID-D395C9FA-D9C5-4044-BC85-E09BF191BD23" title="This tutorial demonstrates how the INHERIT REMOTE PRIVILEGES privilege works in a definer's rights procedure that uses a database link.">Tutorial: Using a Database Link in a Definer's Rights Procedure</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>