<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="You can maintain your index for an error or indexing failure.">
      <meta name="description" content="You can maintain your index for an error or indexing failure.">
      <title>Maintaining Oracle Text Indexes</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Application Developer's Guide ">
      <meta property="og:description" content="You can maintain your index for an error or indexing failure.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Application Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="text-application-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-07T01:45:16-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96275-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="creating-oracle-text-indexes.html" title="Previous" type="text/html">
      <link rel="next" href="querying-with-oracle-text.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Text Application Developer's Guide">
    <meta name="dcterms.isVersionOf" content="CCAPP">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="creating-oracle-text-indexes.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="querying-with-oracle-text.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Application Developer's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Maintaining Oracle Text Indexes</li>
            </ol>
            <a id="GUID-B230E266-1065-40F1-84BA-ADEE715EE2C6" name="GUID-B230E266-1065-40F1-84BA-ADEE715EE2C6"></a>
            
            <h2 id="CCAPP-GUID-B230E266-1065-40F1-84BA-ADEE715EE2C6" class="sect2"><span class="enumeration_chapter">5 </span>Maintaining Oracle Text Indexes
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>You can maintain your index for an error or indexing failure.</p>
               <p>This chapter contains the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-9C9B8E82-EF57-452F-B8FF-3BF728B56DEF">Viewing Index Errors</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-6C7E2AC5-6933-4C89-A63C-19D45D63BB46">Dropping an Index</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-8BC1BF13-762C-4A03-8BB9-F3198909EFF0">Resuming Failed Index</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-BA511205-6725-4DE1-A990-EE936ABF7A22">Re-creating an Index</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-10365262-8B48-40AA-B1F3-DE3268EA9B39">Rebuilding an Index</a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-2F50B8D4-106C-4BC7-BBAE-CC4E9B890B62">Dropping a Preference </a></p>
                  </li>
                  <li>
                     <p><a href="maintaining-oracle-text-indexes.html#GUID-4313B6A6-510F-41E8-9B5C-3559F42742D4">Managing DML Operations for a CONTEXT Index</a></p>
                  </li>
               </ul>
            </div><a id="CCAPP9117"></a><div class="props_rev_3"><a id="GUID-9C9B8E82-EF57-452F-B8FF-3BF728B56DEF" name="GUID-9C9B8E82-EF57-452F-B8FF-3BF728B56DEF"></a><h3 id="CCAPP-GUID-9C9B8E82-EF57-452F-B8FF-3BF728B56DEF" class="sect3"><span class="enumeration_section">5.1 </span>Viewing Index Errors
               </h3>
               <div>
                  <p>Sometimes an indexing operation might fail or it might not complete successfully. When the system encounters an error during row indexing, it logs the error in an Oracle Text view. </p>
                  <p>You can view errors on your indexes with <a id="d14631e182" class="indexterm-anchor"></a><code class="codeph">CTX_USER_INDEX_ERRORS.</code> View errors on all indexes as <code class="codeph">CTXSYS</code> with <a id="d14631e190" class="indexterm-anchor"></a><code class="codeph">CTX_INDEX_ERRORS.</code></p>
                  <p>For example, to view the most recent errors on your indexes, enter the following statement:</p><pre class="oac_no_warn" dir="ltr">SELECT err_timestamp, err_text 
  FROM ctx_user_index_errors 
  ORDER BY err_timestamp DESC;
</pre><p>To clear the view of errors, enter:</p><pre class="oac_no_warn" dir="ltr">DELETE FROM ctx_user_index_errors;
</pre><p>This view is cleared automatically when you create a new index.</p>
                  <div class="infoboxnotealso" id="GUID-9C9B8E82-EF57-452F-B8FF-3BF728B56DEF__GUID-8BC3304A-73CF-4AC1-BD54-4DBC48192EF3">
                     <p class="notep1">See Also:</p>
                     <p><a href="../ccref/oracle-text-views.html#CCREF1800" target="_blank"><span class="italic">Oracle Text Reference</span></a> to learn more about index error views
                     </p>
                  </div>
               </div>
            </div><a id="CCAPP9118"></a><div class="props_rev_3"><a id="GUID-6C7E2AC5-6933-4C89-A63C-19D45D63BB46" name="GUID-6C7E2AC5-6933-4C89-A63C-19D45D63BB46"></a><h3 id="CCAPP-GUID-6C7E2AC5-6933-4C89-A63C-19D45D63BB46" class="sect3"><span class="enumeration_section">5.2 </span>Dropping an Index
               </h3>
               <div>
                  <p>You must drop an existing index before you can re-create it with the <code class="codeph">CREATE</code> <code class="codeph">INDEX</code> statement.
                  </p>
                  <p>Drop an index by using the <code class="codeph">DROP</code> <code class="codeph">INDEX</code> statement in SQL. 
                  </p>
                  <p>If you try to create an index with an invalid <code class="codeph">PARAMETERS</code> string, then you still need to drop it before you can re-create it.
                  </p>
                  <p>For example, to <a id="d14631e305" class="indexterm-anchor"></a>drop an index called <code class="codeph">newsindex,</code> enter the following SQL statement:
                  </p><pre class="oac_no_warn" dir="ltr">DROP INDEX newsindex; 
</pre><p>If Oracle Text cannot determine the state of the index (for example, because of an indexing malfunction), you cannot drop the index. Instead use:</p><pre class="oac_no_warn" dir="ltr">DROP INDEX newsindex FORCE;</pre><div class="infoboxnotealso" id="GUID-6C7E2AC5-6933-4C89-A63C-19D45D63BB46__GUID-3E0225BA-8315-4E6A-8D70-F1541E89470B">
                     <p class="notep1">See Also:</p>
                     <p><a href="../ccref/oracle-text-SQL-statements-and-operators.html#CCREF0109" target="_blank"><span class="italic">Oracle Text Reference</span></a> to learn more about the <code class="codeph">DROP</code> <code class="codeph">INDEX</code> statement
                     </p>
                  </div>
               </div>
            </div><a id="CCAPP9119"></a><div class="props_rev_3"><a id="GUID-8BC1BF13-762C-4A03-8BB9-F3198909EFF0" name="GUID-8BC1BF13-762C-4A03-8BB9-F3198909EFF0"></a><h3 id="CCAPP-GUID-8BC1BF13-762C-4A03-8BB9-F3198909EFF0" class="sect3"><span class="enumeration_section">5.3 </span>Resuming a Failed Index
               </h3>
               <div>
                  <p>You can sometimes resume a failed index by using the <code class="codeph">ALTER</code> <code class="codeph">INDEX</code> statement. You typically resume a failed index after you have investigated and corrected the index failure. You cannot resume all index failures.
                  </p>
                  <p>Index optimization commits at regular intervals. Therefore, if an optimization operation fails, then all optimization work up to the commit point was already saved.</p>
                  <div class="infoboxnotealso" id="GUID-8BC1BF13-762C-4A03-8BB9-F3198909EFF0__GUID-69447AA6-198A-4930-8B9A-61BA4581C8B7">
                     <p class="notep1">See Also:</p>
                     <p><a href="../ccref/oracle-text-SQL-statements-and-operators.html#CCREF0101" target="_blank"><span class="italic">Oracle Text Reference</span></a> to learn more about the <code class="codeph">ALTER</code> <code class="codeph">INDEX</code> statement syntax
                     </p>
                  </div>
                  <p>The following statement resumes the indexing operation on <code class="codeph">newsindex</code> with 10 megabytes of memory:
                  </p><pre class="oac_no_warn" dir="ltr">ALTER INDEX newsindex REBUILD PARAMETERS('resume memory 10M');</pre></div>
            </div><a id="CCAPP9460"></a><div class="props_rev_3"><a id="GUID-BA511205-6725-4DE1-A990-EE936ABF7A22" name="GUID-BA511205-6725-4DE1-A990-EE936ABF7A22"></a><h3 id="CCAPP-GUID-BA511205-6725-4DE1-A990-EE936ABF7A22" class="sect3"><span class="enumeration_section">5.4 </span>Re-creating an Index
               </h3>
               <div>
                  <p>This section describes the procedures for <a id="d14631e498" class="indexterm-anchor"></a>re-creating an index. During the re-creation process, you can query the index normally. 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="maintaining-oracle-text-indexes.html#GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976">Re-creating a Global Index</a></p>
                     </li>
                     <li>
                        <p><a href="maintaining-oracle-text-indexes.html#GUID-63760C07-72B7-4BD9-B203-0C8019F505D5">Re-creating a Local Partitioned Index</a></p>
                     </li>
                  </ul>
               </div><a id="CCAPP9461"></a><div class="props_rev_3"><a id="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976" name="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976"></a><h4 id="CCAPP-GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976" class="sect4"><span class="enumeration_section">5.4.1 </span>Re-creating a Global Index
                  </h4>
                  <div>
                     <p> <a id="d14631e584" class="indexterm-anchor"></a>Oracle Text provides <a id="d14631e587" class="indexterm-anchor"></a><code class="codeph">RECREATE_INDEX_ONLINE</code> to <a id="d14631e592" class="indexterm-anchor"></a>re-create a <code class="codeph">CONTEXT</code> index with new preferences, while preserving inserts, updates, and deletes on the base table. You can use <a id="d14631e600" class="indexterm-anchor"></a><code class="codeph">RECREATE_INDEX_ONLINE</code> in a single-step procedure to re-create a <code class="codeph">CONTEXT</code> index online for global indexes. Because the new index is created alongside the existing index, this operation requires storage that is roughly equal to the size of the existing index. Also, because the <code class="codeph">RECREATE_INDEX_ONLINE</code> operation is performed online, you can perform inserts, updates, and deletes on the base table during the operation. All insert, update, and delete operations that occur during the re-creation process are logged into an online pending queue.
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>After the re-creation operation is complete, new information may not be immediately reflected. As with creating an index online, you should synchronize the index after the re-creation operation is complete to bring it fully up-to-date.</p>
                        </li>
                        <li>
                           <p><a id="d14631e620" class="indexterm-anchor"></a>Synchronizations issued against the index during the re-creation operation are processed against the existing data. Synchronizations are blocked when queries return errors.
                           </p>
                        </li>
                        <li>
                           <p>Optimize commands issued against the index during the re-creation operation return immediately without error and without processing.</p>
                        </li>
                        <li>
                           <p>During <code class="codeph">RECREATE_INDEX_ONLINE,</code> you can query the index normally most of the time. Queries return results based on the existing index and policy until after the final swap. Also, if you issue insert, update, and delete operations and synchronize them, then you will be able to see the new rows when you query the existing index.
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976__GUID-AB2A54AF-B5A9-41B7-BA14-C75838DC754C">
                        <p class="notep1">Note:</p>
                        <p>Transactional queries are not supported with <code class="codeph">RECREATE_INDEX_ONLINE.</code></p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976__GUID-D0E22C87-11B1-441F-B342-BC8959AF5B93">Re-creating a Global Index with Time Limit for Synch</p>
                        <p>You can control index re-creation to set a <a id="d14631e642" class="indexterm-anchor"></a>time limit for <code class="codeph">SYNC_INDEX</code> during nonbusiness hours and incrementally re-create the index. Use the <a href="../ccref/CTX_DDL-package.html#CCREF2106" target="_blank"><code class="codeph">CREATE_SHADOW_INDEX</code></a> procedure with <code class="codeph">POPULATE_PENDING</code> and maxtime.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976__GUID-EDFA232A-1809-4F26-80F5-8C12C7F0AA3D">Re-creating a Global Index with Scheduled Swap</p>
                        <p>With <a id="d14631e663" class="indexterm-anchor"></a><code class="codeph">CTX_DDL.EXCHANGE_SHADOW_INDEX,</code> you can perform index re-creation during nonbusiness hours when query failures and DML blocking can be tolerated.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-03DAC3D9-55FB-41CC-96FC-C477D7747976__GUID-8499D1D9-1E0E-4CD8-85FB-AD41B96922D6">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../ccref/CTX_DDL-package.html#CCREF2111" target="_blank"><span class="italic">Oracle Text Reference</span></a> to learn more about the <code class="codeph">RECREATE_INDEX_ONLINE</code> procedure
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../ccref/CTX_DDL-package.html#CCREF2106" target="_blank"><span class="italic">Oracle Text Reference</span></a> for information and examples for <code class="codeph">CREATE_SHADOW_INDEX</code></p>
                              </li>
                              <li>
                                 <p><a href="../ccref/CTX_DDL-package.html#CCREF2109" target="_blank"><span class="italic">Oracle Text Reference</span></a> for information and examples for <code class="codeph">CTX_DDL.EXCHANGE_SHADOW_INDEX</code></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="CCAPP9681"></a><div class="props_rev_3"><a id="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5" name="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5"></a><h4 id="CCAPP-GUID-63760C07-72B7-4BD9-B203-0C8019F505D5" class="sect4"><span class="enumeration_section">5.4.2 </span>Re-creating a Local Partitioned Index
                  </h4>
                  <div>
                     <p>If the index is locally partitioned, you cannot re-create the index in one step. You must first create a shadow policy, and then run the <a id="d14631e773" class="indexterm-anchor"></a><a id="d14631e775" class="indexterm-anchor"></a><code class="codeph">RECREATE_INDEX_ONLINE</code> procedure for every partition. You can specify <code class="codeph">SWAP</code> or <code class="codeph">NOSWAP,</code> which indicates whether re-creating the index for the partition swaps the index partition data and index partition metadata.
                     </p>
                     <p>You can also use this procedure to update the metadata (for example, the storage preference) of each partition when you specify <a id="d14631e790" class="indexterm-anchor"></a><a id="d14631e792" class="indexterm-anchor"></a><code class="codeph">NOPOPULATE</code> in the parameter string. This keyword is useful for incremental building of a shadow index through time-limited synchronization. If you specify <code class="codeph">NOPOPULATE,</code> then <code class="codeph">NOSWAP</code> is silently enforced. 
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>When all partitions use <code class="codeph">NOSWAP,</code> the storage requirement is approximately equal to the size of the existing index. During re-creation of the index partition, because no swapping is performed, queries on the partition are processed normally. Queries spanning multiple partitions return consistent results across partitions until the swapping stage is reached.
                           </p>
                        </li>
                        <li>
                           <p>When the partitions are rebuilt with <code class="codeph">SWAP,</code> the storage requirement for the operation is equal to the size of the existing index partition. Because index partition data and metadata are swapped after re-creation, queries spanning multiple partitions do not return consistent results from partition to partition, but they will always be correct with respect to each index partition.
                           </p>
                        </li>
                        <li>
                           <p>If you specify <code class="codeph">SWAP,</code> then insert, update, and delete operations and synchronization on the partition are blocked during the swap process.
                           </p>
                        </li>
                     </ul>
                     <div class="section">
                        <p class="subhead3" id="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5__GUID-81C68E74-2712-48CB-B4DC-9FA244E1DFFA">Re-creating a Local Index with All-at-Once Swap</p>
                        <p>You can re-create a local partitioned index online to create or change preferences. The swapping of the index and partition metadata occurs at the end of the process. Queries spanning multiple partitions return consistent results across partitions when the re-creation is in process, except at the end when <a id="d14631e829" class="indexterm-anchor"></a><a href="../ccref/CTX_DDL-package.html#CCREF2109" target="_blank"><code class="codeph">EXCHANGE_SHADOW_INDEX</code></a> is running.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5__GUID-B2C0264B-03BA-4637-A9D0-93D6FE5CCEDA">Scheduling Local Index Re-creation with All-at-Once Swap</p>
                        <p>With <code class="codeph">RECREATE_INDEX_ONLINE</code> of the <code class="codeph">CTX.DDL</code> package, you can incrementally re-create a local partitioned index, where partitions are all swapped at the end.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5__GUID-1EA87299-08E3-48F2-BCE8-84A33DE2CB6B">Re-creating a Local Index with Per-Partition Swap</p>
                        <p>Instead of swapping all partitions at once, you can re-create the index online with new preferences, and each partition is swapped as it is completed. Queries across all partitions may return inconsistent results during this process. This procedure uses <code class="codeph">CREATE_SHADOW_INDEX</code> with <code class="codeph">RECREATE_INDEX_ONLINE.</code></p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-63760C07-72B7-4BD9-B203-0C8019F505D5__GUID-C184AC61-531A-4131-BD61-946328FB54E2">
                           <p class="notep1">See Also:</p>
                           <p><a href="../ccref/oracle-text-SQL-statements-and-operators.html#CCREF0101" target="_blank"><span class="italic">Oracle Text Reference</span></a> for complete information about <code class="codeph">RECREATE_INDEX_ONLINE</code></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="CCAPP9122"></a><a id="CCAPP9121"></a><div class="props_rev_3"><a id="GUID-10365262-8B48-40AA-B1F3-DE3268EA9B39" name="GUID-10365262-8B48-40AA-B1F3-DE3268EA9B39"></a><h3 id="CCAPP-GUID-10365262-8B48-40AA-B1F3-DE3268EA9B39" class="sect3"><span class="enumeration_section">5.5 </span>Rebuilding an Index
               </h3>
               <div>
                  <p><a id="d14631e944" class="indexterm-anchor"></a>You can rebuild a valid index by using <code class="codeph">ALTER</code> <code class="codeph">INDEX.</code> Rebuilding an index does not allow most index settings to be changed. You might rebuild an index when you want to index with a new preference. Generally, there is no advantage in rebuilding an index over dropping it and re-creating it with the <code class="codeph">CREATE</code> <code class="codeph">INDEX</code> statement.
                  </p>
                  <div class="infoboxnotealso" id="GUID-10365262-8B48-40AA-B1F3-DE3268EA9B39__GUID-D4CB7773-D233-43A9-8BA1-0BCFA7C5A77A">
                     <p class="notep1">See Also:</p>
                     <p><span class="q">"<a href="maintaining-oracle-text-indexes.html#GUID-BA511205-6725-4DE1-A990-EE936ABF7A22">Re-creating an Index</a>"</span> for information about changing index settings
                     </p>
                  </div>
                  <div class="section">
                     <p>The following statement rebuilds the index and replaces the lexer preference with <code class="codeph">my_lexer:</code></p><pre class="oac_no_warn" dir="ltr">ALTER INDEX newsindex REBUILD PARAMETERS('replace lexer my_lexer');</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="CCAPP9124"></a><a id="CCAPP9123"></a><div class="props_rev_3"><a id="GUID-2F50B8D4-106C-4BC7-BBAE-CC4E9B890B62" name="GUID-2F50B8D4-106C-4BC7-BBAE-CC4E9B890B62"></a><h3 id="CCAPP-GUID-2F50B8D4-106C-4BC7-BBAE-CC4E9B890B62" class="sect3"><span class="enumeration_section">5.6 </span>Dropping a Preference 
               </h3>
               <div>
                  <p>You might drop a custom index preference when you no longer need it for indexing.</p>
                  <p>You drop index preferences with the <code class="codeph">CTX_DDL.DROP_PREFERENCE</code> procedure. 
                  </p>
                  <p>Dropping a preference does not affect the index that is created from the preference.</p>
                  <div class="infoboxnotealso" id="GUID-2F50B8D4-106C-4BC7-BBAE-CC4E9B890B62__GUID-0950BC2A-4C5F-4EFC-AF85-14E2A7E0F152">
                     <p class="notep1">See Also:</p>
                     <p><a href="../ccref/CTX_DDL-package.html#CCREF0632" target="_blank"><span class="italic">Oracle Text Reference</span></a> to learn more about the syntax for the <code class="codeph">CTX_DDL.DROP_PREFERENCE</code> procedure
                     </p>
                  </div>
                  <div class="section">
                     <p>The following code drops the <code class="codeph">my_lexer</code> preference:
                     </p><pre class="oac_no_warn" dir="ltr">begin
ctx_ddl.drop_preference('my_lexer');
end;</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="CCAPP9125"></a><div class="props_rev_3"><a id="GUID-4313B6A6-510F-41E8-9B5C-3559F42742D4" name="GUID-4313B6A6-510F-41E8-9B5C-3559F42742D4"></a><h3 id="CCAPP-GUID-4313B6A6-510F-41E8-9B5C-3559F42742D4" class="sect3"><span class="enumeration_section">5.7 </span>Managing DML Operations for a CONTEXT Index
               </h3>
               <div>
                  <p>DML operations refer to when documents are inserted, updated, or deleted from the base table. This section describes how you can view, synchronize, and optimize the Oracle Text <code class="codeph">CONTEXT</code> index for DML operations. This section contains the following topics:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="maintaining-oracle-text-indexes.html#GUID-A1C5E924-C0C2-4D86-B794-B0B6E7C6C8D2">Viewing Pending DML</a></p>
                     </li>
                     <li>
                        <p><a href="maintaining-oracle-text-indexes.html#GUID-99981916-B970-4AF0-AB50-0CFE78067F7E">Synchronizing the Index</a></p>
                     </li>
                     <li>
                        <p><a href="maintaining-oracle-text-indexes.html#GUID-9960D8E4-0AE8-48B0-82D5-B203695463DE">Optimizing the Index</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-4313B6A6-510F-41E8-9B5C-3559F42742D4__GUID-B7FD574E-3670-4F4F-B345-87FE06B5FB30">
                     <p class="notep1">Note:</p>
                     <p><code class="codeph">CTXCAT</code> indexes are <a id="d14631e1157" class="indexterm-anchor"></a>transactional and are updated immediately when the base table changes. The manual synchronization as described in this section is not necessary for a <code class="codeph">CTXCAT</code> index.
                     </p>
                  </div>
               </div><a id="CCAPP9126"></a><div class="props_rev_3"><a id="GUID-A1C5E924-C0C2-4D86-B794-B0B6E7C6C8D2" name="GUID-A1C5E924-C0C2-4D86-B794-B0B6E7C6C8D2"></a><h4 id="CCAPP-GUID-A1C5E924-C0C2-4D86-B794-B0B6E7C6C8D2" class="sect4"><span class="enumeration_section">5.7.1 </span>Viewing Pending DML Operations
                  </h4>
                  <div>
                     <p>When you insert or update documents in the base table, their <a id="d14631e1237" class="indexterm-anchor"></a>rowids are held in a DML queue until you synchronize the index. You can view this queue in the <code class="codeph">CTX_USER_PENDING</code> view.
                     </p>
                     <p>For example, to view pending DML operations on your indexes, enter the following statement:</p><pre class="oac_no_warn" dir="ltr">SELECT pnd_index_name, pnd_rowid, to_char(
        pnd_timestamp, 'dd-mon-yyyy hh24:mi:ss'
        ) timestamp FROM ctx_user_pending;
</pre><p>This statement gives output in the following form:</p><pre class="oac_no_warn" dir="ltr">PND_INDEX_NAME                 PND_ROWID          TIMESTAMP
------------------------------ ------------------ --------------------
MYINDEX                        AAADXnAABAAAS3SAAC 06-oct-1999 15:56:50</pre><div class="infoboxnotealso" id="GUID-A1C5E924-C0C2-4D86-B794-B0B6E7C6C8D2__GUID-DF4C9116-9C6E-4E97-9444-897249093276">
                        <p class="notep1">See Also:</p>
                        <p><a href="../ccref/oracle-text-views.html#CCREF1800" target="_blank"><span class="italic">Oracle Text Reference</span></a> to learn more about the <code class="codeph">CTX_USER_PENDING</code> view
                        </p>
                     </div>
                  </div>
               </div><a id="CCAPP9127"></a><div class="props_rev_3"><a id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E" name="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E"></a><h4 id="CCAPP-GUID-99981916-B970-4AF0-AB50-0CFE78067F7E" class="sect4"><span class="enumeration_section">5.7.2 </span>Synchronizing the Index
                  </h4>
                  <div>
                     <p>When you synchronize the index, you process all pending updates and inserts to the base table. You can do this in PL/SQL with the <a id="d14631e1337" class="indexterm-anchor"></a><code class="codeph">CTX_DDL.SYNC_INDEX</code> procedure. You can also control the duration and locking behavior for index synchronization with the <code class="codeph">CTX_DDL.SYNC_INDEX</code> procedure.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E__GUID-553902D4-11DA-441B-8D98-FCC81CC1C6AB">Synchronizing the Index with SYNC_INDEX</p>
                        <p>The following example synchronizes the index with 2 megabytes of memory:</p><pre class="oac_no_warn" dir="ltr">begin</pre><pre class="oac_no_warn" dir="ltr">ctx_ddl.sync_index('myindex', '2M');</pre><pre class="oac_no_warn" dir="ltr">end;</pre><p>Starting with Oracle Database 12<span class="italic">c</span> Release 2 (12.2.0.1), you automatically merge rows from <code class="codeph">STAGE_ITAB</code> back to the <code class="codeph">$I</code> table by using <code class="codeph">SYNC_INDEX.</code> This merging of rows happens when the number of rows in <code class="codeph">STAGE_ITAB ($G)</code> exceeds the <code class="codeph">STAGE_ITAB_MAX_ROWS</code> parameter (1 million by default). Therefore, you do not have to run merge optimization explicitly or schedule an auto optimize job.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E__GUID-0A3D5140-DC75-4326-A9ED-4EA807ECE55D">Maxtime Parameter for SYNC_INDEX</p>
                        <p><a id="d14631e1381" class="indexterm-anchor"></a>The <code class="codeph">SYNC_INDEX</code> procedure includes a <code class="codeph">maxtime</code> parameter that, like <code class="codeph">OPTIMIZE_INDEX,</code> indicates a suggested time limit in minutes for the operation. The <code class="codeph">SYNC_INDEX</code> procedure processes as many documents in the queue as possible within the given time limit.
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a id="d14631e1399" class="indexterm-anchor"></a><code class="codeph">NULL maxtime</code> is equivalent to <a id="d14631e1404" class="indexterm-anchor"></a><code class="codeph">CTX_DDL.MAXTIME_UNLIMITED.</code></p>
                           </li>
                           <li>
                              <p>The time limit is approximate. The actual time may be less than, or greater than, what you specify.</p>
                           </li>
                           <li>
                              <p>The <code class="codeph">ALTER</code> <code class="codeph">INDEX</code>... <code class="codeph">sync</code> command has no changes because it is deprecated.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">maxtime</code> parameter is ignored when <code class="codeph">SYNC_INDEX</code> is invoked without an index name.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">maxtime</code> parameter cannot be communicated for automatic synchronizations (for example, <code class="codeph">sync</code> <code class="codeph">on</code> <code class="codeph">commit</code> or <code class="codeph">sync</code> <code class="codeph">every</code>).
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E__GUID-F9B50CBB-4891-42D0-9E49-38CC96CEAAF9">Locking Parameter for SYNC_INDEX</p>
                        <p><a id="d14631e1458" class="indexterm-anchor"></a>The locking parameter of <code class="codeph">SYNC_INDEX</code> enables you to configure how the synchronization works when another synchronization is already running on the index.
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The locking parameter is ignored when <code class="codeph">SYNC_INDEX</code> is invoked without an index name.
                              </p>
                           </li>
                           <li>
                              <p>The locking parameter cannot be communicated for automatic synchronizations (that is, <code class="codeph">sync</code> <code class="codeph">on</code> <code class="codeph">commit</code> or <code class="codeph">sync</code> <code class="codeph">every</code>).
                              </p>
                           </li>
                           <li>
                              <p>When the locking mode is <code class="codeph">LOCK_WAIT,</code> the mode waits forever and ignores the maxtime setting if it cannot get a lock.
                              </p>
                           </li>
                        </ul>
                        <p>The options are as follows:</p>
                        <div class="tblformal" id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E__THISTABLEDESCRIBESLOCKINGBEHAVIORFO-3F3BCF70">
                           <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="This table describes locking behavior for SYNC_INDEX." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="48%" id="d14631e1505">Option</th>
                                    <th align="left" valign="bottom" width="52%" id="d14631e1508">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="48%" id="d14631e1513" headers="d14631e1505 ">
                                       <p><code class="codeph">CTX_DDL.LOCK_WAIT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="52%" headers="d14631e1513 d14631e1508 ">
                                       <p>If another <code class="codeph">SYNC_INDEX</code> is running, wait until the running synchronization is complete, and then begin the new synchronization.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="48%" id="d14631e1524" headers="d14631e1505 ">
                                       <p><code class="codeph">CTX_DDL.LOCK_NOWAIT</code></p>
                                    </td>
                                    <td align="left" valign="top" width="52%" headers="d14631e1524 d14631e1508 ">
                                       <p>If another <code class="codeph">SYNC_INDEX</code> is running, immediately return without error.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="48%" id="d14631e1535" headers="d14631e1505 ">
                                       <p><code class="codeph">CTX_DDL.LOCK_NOWAIT_ERROR</code></p>
                                    </td>
                                    <td align="left" valign="top" width="52%" headers="d14631e1535 d14631e1508 ">
                                       <p>If another <code class="codeph">SYNC_INDEX</code> is running, immediately generate an error (DRG-51313: timeout while waiting for inserts, updates, or deletes or optimize lock).
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-99981916-B970-4AF0-AB50-0CFE78067F7E__GUID-998843A8-BA9F-4785-A765-5BE47244812F">
                           <p class="notep1">See Also:</p>
                           <p><a href="../ccref/CTX_DDL-package.html#CCREF0652" target="_blank"><span class="italic">Oracle Text Reference</span></a> to learn more about the <code class="codeph">CTX_DDL.SYNC_INDEX</code> statement syntax
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="CCAPP9128"></a><div class="props_rev_3"><a id="GUID-9960D8E4-0AE8-48B0-82D5-B203695463DE" name="GUID-9960D8E4-0AE8-48B0-82D5-B203695463DE"></a><h4 id="CCAPP-GUID-9960D8E4-0AE8-48B0-82D5-B203695463DE" class="sect4"><span class="enumeration_section">5.7.3 </span>Optimizing the Index
                  </h4>
                  <div>
                     <p>The <code class="codeph">CONTEXT</code> index is an inverted index where each word contains the list of documents that contain that word. For example, after a single initial indexing operation, the word DOG might have the following entry:
                     </p><pre class="oac_no_warn" dir="ltr">DOG DOC1 DOC3 DOC5</pre><p>Frequent index synchronization ultimately causes fragmentation of your <code class="codeph">CONTEXT</code> index. Index fragmentation can adversely affect query response time. Therefore, to reduce fragmentation and index size and to ensure optimal query performance, allow time to optimize your <code class="codeph">CONTEXT</code> index.
                     </p>
                     <p>To schedule an auto optimize job, you must explicitly set <code class="codeph">STAGE_ITAB_MAX_ROWS</code> to <code class="codeph">0</code> to disable the automatic merging that now happens with <code class="codeph">SYNC_INDEX.</code></p>
                     <p>To optimize an index, Oracle recommends that you use <code class="codeph">CTX_DDL.OPTIMIZE_INDEX.</code> To understand index optimization, you must understand the structure of the index and what happens when it is synchronized. This section contains the following topics:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="maintaining-oracle-text-indexes.html#GUID-10809D0D-D0F4-42E4-9876-FD1C25C9994B">Index Fragmentation</a></p>
                        </li>
                        <li>
                           <p><a href="maintaining-oracle-text-indexes.html#GUID-30862B68-353D-4F6F-81D2-CFBC182DAF56">Document Invalidation and Garbage Collection</a></p>
                        </li>
                        <li>
                           <p><a href="maintaining-oracle-text-indexes.html#GUID-8EB38F1A-E696-462D-8CBC-7A2B1BA031E7">Single Token Optimization</a></p>
                        </li>
                        <li>
                           <p><a href="maintaining-oracle-text-indexes.html#GUID-61C45205-0D97-47BB-9128-0AA2CECCE56A">Viewing Index Fragmentation and Garbage Data</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-9960D8E4-0AE8-48B0-82D5-B203695463DE__GUID-0C604983-5C48-40C9-9522-0C92DD8B7144">
                        <p class="notep1">See Also:</p>
                        <p><a href="../ccref/CTX_DDL-package.html#CCREF0638" target="_blank"><span class="italic">Oracle Text Reference</span></a> for the <code class="codeph">CTX_DDL.OPTIMIZE_INDEX</code> statement syntax and examples
                        </p>
                     </div>
                  </div><a id="CCAPP9130"></a><div class="props_rev_3"><a id="GUID-10809D0D-D0F4-42E4-9876-FD1C25C9994B" name="GUID-10809D0D-D0F4-42E4-9876-FD1C25C9994B"></a><h5 id="CCAPP-GUID-10809D0D-D0F4-42E4-9876-FD1C25C9994B" class="sect5"><span class="enumeration_section">5.7.3.1 </span>Index Fragmentation
                     </h5>
                     <div>
                        <p>When you add new documents to the base table, the index is synchronized by adding new rows. For example, if you add the DOC 7 document with the word <span class="italic">dog</span> and synchronize the index, you now have:
                        </p><pre class="oac_no_warn" dir="ltr">DOG DOC1 DOC3 DOC5
DOG DOC7
</pre><p>Subsequent inserts, updates, or deletes also create new rows, as follows:</p><pre class="oac_no_warn" dir="ltr">DOG DOC1 DOC3 DOC5
DOG DOC7
DOG DOC9
DOG DOC11
</pre><p>Index fragmentation occurs when you add new documents and synchronize the index. In particular, background inserts, updates, or deletes, which synchronize the index frequently, generally produce more fragmentation than batch mode synchronization.</p>
                        <p>When you perform batch processing less frequently, you reduce fragmentation because you produce longer document lists with a reduced number of rows in the index.</p>
                        <p>You can reduce <a id="d14631e1789" class="indexterm-anchor"></a>index fragmentation by optimizing the index in either <a id="d14631e1794" class="indexterm-anchor"></a><code class="codeph">FULL</code> or <a id="d14631e1799" class="indexterm-anchor"></a><code class="codeph">FAST</code> mode with <code class="codeph">CTX_DDL.OPTIMIZE_INDEX.</code></p>
                     </div>
                  </div><a id="CCAPP9131"></a><div class="props_rev_3"><a id="GUID-30862B68-353D-4F6F-81D2-CFBC182DAF56" name="GUID-30862B68-353D-4F6F-81D2-CFBC182DAF56"></a><h5 id="CCAPP-GUID-30862B68-353D-4F6F-81D2-CFBC182DAF56" class="sect5"><span class="enumeration_section">5.7.3.2 </span>Document Invalidation and Garbage Collection
                     </h5>
                     <div>
                        <p>When you remove documents from the base table, Oracle Text marks the document as removed but does not immediately alter the index.</p>
                        <p>Because the old information takes up space and can cause extra overhead at query time, you must remove the old information from the index by optimizing it in <code class="codeph">FULL</code> mode. This process is called <span class="bold">garbage collection.</span> Optimizing in <code class="codeph">FULL</code> mode for garbage collection is necessary when you perform frequent updates or deletes to the base table.
                        </p>
                     </div>
                  </div><a id="CCAPP9132"></a><div class="props_rev_3"><a id="GUID-8EB38F1A-E696-462D-8CBC-7A2B1BA031E7" name="GUID-8EB38F1A-E696-462D-8CBC-7A2B1BA031E7"></a><h5 id="CCAPP-GUID-8EB38F1A-E696-462D-8CBC-7A2B1BA031E7" class="sect5"><span class="enumeration_section">5.7.3.3 </span>Single Token Optimization
                     </h5>
                     <div>
                        <p>In addition to optimizing the entire index, you can optimize single tokens. You can use token mode to optimize index tokens that are frequently searched, without spending time on optimizing tokens that are rarely referenced. </p>
                        <p>For example, you can specify that only the token <span class="italic">DOG</span> be optimized in the index, if you know that this token is updated and queried frequently.
                        </p>
                        <p>An optimized token can improve query response time for the token.</p>
                        <p>To optimize an index in token mode, use <code class="codeph">CTX_DDL.OPTIMIZE_INDEX.</code></p>
                     </div>
                  </div><a id="CCAPP9133"></a><div class="props_rev_3"><a id="GUID-61C45205-0D97-47BB-9128-0AA2CECCE56A" name="GUID-61C45205-0D97-47BB-9128-0AA2CECCE56A"></a><h5 id="CCAPP-GUID-61C45205-0D97-47BB-9128-0AA2CECCE56A" class="sect5"><span class="enumeration_section">5.7.3.4 </span>Viewing Index Fragmentation and Garbage Data
                     </h5>
                     <div>
                        <p>With the <code class="codeph">CTX_REPORT.INDEX_STATS</code> procedure, you can create a statistical report on your index. The report includes information on optimal row fragmentation, a list of most fragmented tokens, and the amount of garbage data in your index. Although this report might take a long time to run for large indexes, it can help you decide whether to optimize your index.
                        </p>
                        <div class="infoboxnotealso" id="GUID-61C45205-0D97-47BB-9128-0AA2CECCE56A__GUID-5ABC20F0-ED7D-4E91-8496-D3237B271DB3">
                           <p class="notep1">See Also:</p>
                           <p><a href="../ccref/CTX_REPORT-package.html#CCREF1100" target="_blank"><span class="italic">Oracle Text Reference</span></a> to learn more about using the <code class="codeph">CTX_REPORT.INDEX_STATS</code> procedure
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>