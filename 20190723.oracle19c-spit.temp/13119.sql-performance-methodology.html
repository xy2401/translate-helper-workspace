<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter describes the recommended methodology for SQL tuning.">
      <meta name="description" content="This chapter describes the recommended methodology for SQL tuning.">
      <title>SQL Performance Methodology</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Tuning Guide">
      <meta property="og:description" content="This chapter describes the recommended methodology for SQL tuning.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Tuning Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-tuning-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-31T14:57:08-08:00">
      <meta name="dcterms.title" content="SQL Tuning Guide">
      <meta name="dcterms.dateCopyrighted" content="2013, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96095-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="introduction-to-sql-tuning.html" title="Previous" type="text/html">
      <link rel="next" href="query-optimizer-fundamentals.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGSQL">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="introduction-to-sql-tuning.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="query-optimizer-fundamentals.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Tuning Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="sql-performance-fundamentals.html" property="item" typeof="WebPage"><span property="name">SQL Performance Fundamentals</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">SQL Performance Methodology</li>
            </ol>
            <a id="GUID-C8B23C09-35B5-4F0E-90B2-272805EC4062" name="GUID-C8B23C09-35B5-4F0E-90B2-272805EC4062"></a><a id="TGSQL133"></a>
            
            <h2 id="TGSQL-GUID-C8B23C09-35B5-4F0E-90B2-272805EC4062" class="sect2"><span class="enumeration_chapter">2 </span>SQL Performance Methodology
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter describes the recommended methodology for SQL tuning.</p>
               <div class="infoboxnote" id="GUID-C8B23C09-35B5-4F0E-90B2-272805EC4062__GUID-EE324800-3A3E-4363-ADF3-AFDB13038C7C">
                  <p class="notep1">Note:</p>
                  <p>This book assumes that you have learned the Oracle Database performance methodology described in <a href="../tdppt/oracle-database-performance-method.html#GUID-6203E485-FA06-4EE3-9003-4449FBDE214B" target="_blank"><span><cite>Oracle Database 2 Day + Performance Tuning Guide</cite></span></a>.
                  </p>
               </div>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="sql-performance-methodology.html#GUID-A72B875B-0FAF-40A0-A9A2-7E62DEA36F50">Guidelines for Designing Your Application</a><br>The key to obtaining good SQL performance is to design your application with performance in mind.
                  </li>
                  <li class="ulchildlink"><a href="sql-performance-methodology.html#GUID-C382C528-CDD3-4DC8-92EA-19140C3FFB25">Guidelines for Deploying Your Application</a><br>To achieve optimal performance, deploy your application with the same care that you put into designing it.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="sql-performance-fundamentals.html#GUID-DD9CAA74-3E0B-48C9-8770-AADB614BC992" title="SQL tuning is improving SQL statement performance to meet specific, measurable, and achievable goals.">SQL Performance Fundamentals</a></p>
                  </div>
               </div>
            </div>
            <a id="TGSQL138"></a><div class="props_rev_3"><a id="GUID-A72B875B-0FAF-40A0-A9A2-7E62DEA36F50" name="GUID-A72B875B-0FAF-40A0-A9A2-7E62DEA36F50"></a><h3 id="TGSQL-GUID-A72B875B-0FAF-40A0-A9A2-7E62DEA36F50" class="sect3"><span class="enumeration_section">2.1 </span>Guidelines for Designing Your Application
               </h3>
               <div>
                  <p>The key to obtaining good SQL performance is to design your application with performance in mind.</p>
                  <div class="section">
                     <p>This section contains the following topics:</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="sql-performance-methodology.html#GUID-EB210ACB-4A2D-4AEA-AACE-CFD44E61CBEE">Guideline for Data Modeling</a><br>Data modeling is important to successful application design. 
                     </li>
                     <li class="ulchildlink"><a href="sql-performance-methodology.html#GUID-2B424C80-25B4-4B16-BE9D-92B74428F083">Guideline for Writing Efficient Applications</a><br>During the design and architecture phase of system development, ensure that the application developers understand SQL execution efficiency. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="sql-performance-methodology.html#GUID-C8B23C09-35B5-4F0E-90B2-272805EC4062" title="This chapter describes the recommended methodology for SQL tuning.">SQL Performance Methodology</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL139"></a><div class="props_rev_3"><a id="GUID-EB210ACB-4A2D-4AEA-AACE-CFD44E61CBEE" name="GUID-EB210ACB-4A2D-4AEA-AACE-CFD44E61CBEE"></a><h4 id="TGSQL-GUID-EB210ACB-4A2D-4AEA-AACE-CFD44E61CBEE" class="sect4"><span class="enumeration_section">2.1.1 </span>Guideline for Data Modeling
                  </h4>
                  <div>
                     <p>Data modeling is important to successful application design. </p>
                     <div class="section">
                        <p>You must perform data modeling in a way that represents the business practices. Heated debates may occur about the correct data model. The important thing is to apply greatest modeling efforts to those entities affected by the most frequent business transactions. </p>
                        <p>In the modeling phase, there is a great temptation to spend too much time modeling the non-core data elements, which results in increased development lead times. Use of modeling tools can then rapidly generate schema definitions and can be useful when a fast prototype is required.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-performance-methodology.html#GUID-A72B875B-0FAF-40A0-A9A2-7E62DEA36F50" title="The key to obtaining good SQL performance is to design your application with performance in mind.">Guidelines for Designing Your Application</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL145"></a><div class="props_rev_3"><a id="GUID-2B424C80-25B4-4B16-BE9D-92B74428F083" name="GUID-2B424C80-25B4-4B16-BE9D-92B74428F083"></a><h4 id="TGSQL-GUID-2B424C80-25B4-4B16-BE9D-92B74428F083" class="sect4"><span class="enumeration_section">2.1.2 </span>Guideline for Writing Efficient Applications
                  </h4>
                  <div>
                     <p>During the design and architecture phase of system development, ensure that the application developers understand SQL execution efficiency. </p>
                     <div class="section">
                        <p>To achieve this goal, the development environment must support the following characteristics:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Good database connection management</p>
                              <p>Connecting to the database is an expensive operation that is not scalable. Therefore, a best practice is to minimize the number of concurrent connections to the database. A simple system, where a user connects at application initialization, is ideal. However, in a web-based or multitiered application in which application servers multiplex database connections to users, this approach can be difficult. With these types of applications, design them to pool database connections, and not reestablish connections for each user request.</p>
                           </li>
                           <li>
                              <p>Good cursor usage and management</p>
                              <p>Maintaining user connections is equally important to minimizing the parsing activity on the system. Parsing is the process of interpreting a SQL statement and creating an execution plan for it. This process has many phases, including syntax checking, security checking, execution plan generation, and loading shared structures into the shared pool. There are two types of parse operations:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Hard parsing</p>
                                    <p>A SQL statement is submitted for the first time, and no match is found in the shared pool. Hard parses are the most resource-intensive and unscalable, because they perform all the operations involved in a parse.</p>
                                 </li>
                                 <li>
                                    <p>Soft parsing</p>
                                    <p>A SQL statement is submitted for the first time, and a match is found in the shared pool. The match can be the result of previous execution by another user. The SQL statement is shared, which is optimal for performance. However, soft parses are not ideal, because they still require syntax and security checking, which consume system resources.</p>
                                 </li>
                              </ul>
                              <p>Because parsing should be minimized as much as possible, application developers should design their applications to parse SQL statements once and execute them many times. This is done through cursors. Experienced SQL programmers should be familiar with the concept of opening and re-executing cursors.</p>
                           </li>
                           <li>
                              <p>Effective use of bind variables</p>
                              <p>Application developers must also ensure that SQL statements are shared within the shared pool. To achieve this goal, use bind variables to represent the parts of the query that change from execution to execution. If this is not done, then the SQL statement is likely to be parsed once and never re-used by other users. To ensure that SQL is shared, use bind variables and do not use string literals with SQL statements. For example:</p>
                              <p>Statement with string literals:</p><pre class="pre codeblock"><code>SELECT * 
FROM   employees 
WHERE  last_name LIKE 'KING';
</code></pre><p>Statement with bind variables:</p><pre class="pre codeblock"><code>SELECT * 
FROM   employees 
WHERE  last_name LIKE :1;
</code></pre><p>The following example shows the results of some tests on a simple OLTP application:</p><pre class="pre codeblock"><code>Test                         #Users Supported
No Parsing all statements           270 
Soft Parsing all statements         150
Hard Parsing all statements          60
Re-Connecting for each Transaction   30
</code></pre><p>These tests were performed on a four-CPU computer. The differences increase as the number of CPUs on the system increase.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-performance-methodology.html#GUID-A72B875B-0FAF-40A0-A9A2-7E62DEA36F50" title="The key to obtaining good SQL performance is to design your application with performance in mind.">Guidelines for Designing Your Application</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL151"></a><div class="props_rev_3"><a id="GUID-C382C528-CDD3-4DC8-92EA-19140C3FFB25" name="GUID-C382C528-CDD3-4DC8-92EA-19140C3FFB25"></a><h3 id="TGSQL-GUID-C382C528-CDD3-4DC8-92EA-19140C3FFB25" class="sect3"><span class="enumeration_section">2.2 </span>Guidelines for Deploying Your Application
               </h3>
               <div>
                  <p>To achieve optimal performance, deploy your application with the same care that you put into designing it.</p>
                  <div class="section">
                     <p>This section contains the following topics:</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="sql-performance-methodology.html#GUID-F9275845-56B1-422D-9196-65715AEC0CF3">Guideline for Deploying in a Test Environment</a><br>The testing process mainly consists of functional and stability testing. At some point in the process, you must perform performance testing.
                     </li>
                     <li class="ulchildlink"><a href="sql-performance-methodology.html#GUID-DBAC094F-DFB1-4324-9A03-3C3482417120">Guidelines for Application Rollout</a><br>When new applications are rolled out, two strategies are commonly adopted: the Big Bang approach, in which all users migrate to the new system at once, and the trickle approach, in which users slowly migrate from existing systems to the new one.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="sql-performance-methodology.html#GUID-C8B23C09-35B5-4F0E-90B2-272805EC4062" title="This chapter describes the recommended methodology for SQL tuning.">SQL Performance Methodology</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL152"></a><div class="props_rev_3"><a id="GUID-F9275845-56B1-422D-9196-65715AEC0CF3" name="GUID-F9275845-56B1-422D-9196-65715AEC0CF3"></a><h4 id="TGSQL-GUID-F9275845-56B1-422D-9196-65715AEC0CF3" class="sect4"><span class="enumeration_section">2.2.1 </span>Guideline for Deploying in a Test Environment
                  </h4>
                  <div>
                     <p>The testing process mainly consists of functional and stability testing. At some point in the process, you must perform performance testing.</p>
                     <div class="section">
                        <p>The following list describes simple rules for performance testing an application. If correctly documented, then this list provides important information for the production application and the capacity planning process after the application has gone live.</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Use the Automatic Database Diagnostic Monitor (ADDM) and SQL Tuning Advisor for design validation.</p>
                           </li>
                           <li>
                              <p>Test with realistic data volumes and distributions.</p>
                              <p>All testing must be done with fully populated tables. The test database should contain data representative of the production system in terms of data volume and cardinality between tables. All the production indexes should be built and the schema statistics should be populated correctly.</p>
                           </li>
                           <li>
                              <p>Use the correct optimizer mode.</p>
                              <p>Perform all testing with the optimizer mode that you plan to use in production.</p>
                           </li>
                           <li>
                              <p>Test a single user performance.</p>
                              <p>Test a single user on an idle or lightly-used database for acceptable performance. If a single user cannot achieve acceptable performance under ideal conditions, then multiple users cannot achieve acceptable performance under real conditions.</p>
                           </li>
                           <li>
                              <p>Obtain and document plans for all SQL statements.</p>
                              <p>Obtain an execution plan for each SQL statement. Use this process to verify that the optimizer is obtaining an optimal execution plan, and that the relative cost of the SQL statement is understood in terms of CPU time and physical I/Os. This process assists in identifying the heavy use transactions that require the most tuning and performance work in the future.</p>
                           </li>
                           <li>
                              <p>Attempt multiuser testing.</p>
                              <p>This process is difficult to perform accurately, because user workload and profiles might not be fully quantified. However, transactions performing DML statements should be tested to ensure that there are no locking conflicts or serialization problems.</p>
                           </li>
                           <li>
                              <p>Test with the correct hardware configuration.</p>
                              <p>Test with a configuration as close to the production system as possible. Using a realistic system is particularly important for network latencies, I/O subsystem bandwidth, and processor type and speed. Failing to use this approach may result in an incorrect analysis of potential performance problems.</p>
                           </li>
                           <li>
                              <p>Measure steady state performance.</p>
                              <p>When benchmarking, it is important to measure the performance under steady state conditions. Each benchmark run should have a ramp-up phase, where users are connected to the application and gradually start performing work on the application. This process allows for frequently cached data to be initialized into the cache and single execution operations—such as parsing—to be completed before the steady state condition. Likewise, after a benchmark run, a ramp-down period is useful so that the system frees resources, and users cease work and disconnect.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-performance-methodology.html#GUID-C382C528-CDD3-4DC8-92EA-19140C3FFB25" title="To achieve optimal performance, deploy your application with the same care that you put into designing it.">Guidelines for Deploying Your Application</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL155"></a><div class="props_rev_3"><a id="GUID-DBAC094F-DFB1-4324-9A03-3C3482417120" name="GUID-DBAC094F-DFB1-4324-9A03-3C3482417120"></a><h4 id="TGSQL-GUID-DBAC094F-DFB1-4324-9A03-3C3482417120" class="sect4"><span class="enumeration_section">2.2.2 </span>Guidelines for Application Rollout
                  </h4>
                  <div>
                     <p>When new applications are rolled out, two strategies are commonly adopted: the Big Bang approach, in which all users migrate to the new system at once, and the trickle approach, in which users slowly migrate from existing systems to the new one.</p>
                     <div class="section">
                        <p>Both approaches have merits and disadvantages. The Big Bang approach relies on reliable testing of the application at the required scale, but has the advantage of minimal data conversion and synchronization with the old system, because it is simply switched off. The Trickle approach allows debugging of scalability issues as the workload increases, but might mean that data must be migrated to and from legacy systems as the transition takes place.</p>
                        <p>It is difficult to recommend one approach over the other, because each technique has associated risks that could lead to system outages as the transition takes place. Certainly, the Trickle approach allows profiling of real users as they are introduced to the new application, and allows the system to be reconfigured while only affecting the migrated users. This approach affects the work of the early adopters, but limits the load on support services. Thus, unscheduled outages only affect a small percentage of the user population.</p>
                        <p>The decision on how to roll out a new application is specific to each business. Any adopted approach has its own unique pressures and stresses. The more testing and knowledge that you derive from the testing process, the more you realize what is best for the rollout.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sql-performance-methodology.html#GUID-C382C528-CDD3-4DC8-92EA-19140C3FFB25" title="To achieve optimal performance, deploy your application with the same care that you put into designing it.">Guidelines for Deploying Your Application</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>