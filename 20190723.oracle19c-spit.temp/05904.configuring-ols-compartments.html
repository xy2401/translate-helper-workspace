<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This tutorial demonstrates how to create Oracle Label Security compartments.">
      <meta name="description" content="This tutorial demonstrates how to create Oracle Label Security compartments.">
      <title>Tutorial: Configuring Compartments in Oracle Label Security</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Administrator's Guide">
      <meta property="og:description" content="This tutorial demonstrates how to create Oracle Label Security compartments.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Administrator's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="label-security-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-11T09:39:52-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2006, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96303-05">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="configuring-ols-levels.html" title="Previous" type="text/html">
      <link rel="next" href="configuring-ols-groups.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Label Security Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="OLSAG">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="configuring-ols-levels.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="configuring-ols-groups.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Administrator's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-label-security-tutorials.html" property="item" typeof="WebPage"><span property="name">Oracle Label Security Tutorials</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Tutorial: Configuring Compartments in Oracle Label Security</li>
            </ol>
            <a id="GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" name="GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD"></a>
            
            <h2 id="OLSAG-GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" class="sect2"><span class="enumeration_chapter">9 </span>Tutorial: Configuring Compartments in Oracle Label Security
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This tutorial demonstrates how to create Oracle Label Security compartments.</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="configuring-ols-compartments.html#GUID-5A72FF71-0AA5-4FB1-B2DE-E192BC88A6DE">About This Tutorial</a><br>In this tutorial, you will use the <code class="codeph">HR</code> schema to learn how to use Oracle Label Security compartments.
                  </li>
                  <li class="ulchildlink"><a href="configuring-ols-compartments.html#GUID-D3314573-7F9F-4F9C-910D-4D393285C433">Step 1: Create an Account for Lily Leagull</a><br>Lily Leagull will initially have the same privileges as Susan Mavris and Ida Neau.
                  </li>
                  <li class="ulchildlink"><a href="configuring-ols-compartments.html#GUID-B8DBFC5E-C6CD-4548-9970-A6EE941B8238">Step 2: Authorize Lily Leagull for the HIGHLY_SENSITIVE Level</a><br>After the <code class="codeph">lleagull</code> account has been created, you can authorize it to use the <code class="codeph">HIGHLY_SENSITIVE</code> level.
                  </li>
                  <li class="ulchildlink"><a href="configuring-ols-compartments.html#GUID-1A99D62E-AF1B-45D3-8DB5-1DA7B325B7B1">Step 3: Create Two Compartments for the Oracle Label Security Policy</a><br>All three users (Susan Mavris, Ida Neau, and Lily Leagull) will use compartments to access their data. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-ols-compartments.html#GUID-F2005DF2-E7A5-4F21-A0BA-6B155EAE904C">Step 4: Create the Data Labels for the Compartments</a><br>You will create three data labels for the compartments.
                  </li>
                  <li class="ulchildlink"><a href="configuring-ols-compartments.html#GUID-BC5CED85-B35A-492A-BBBE-4D2FCF906CC6">Step 5: Assign the Labels to the Users</a><br>Assigning the labels to the users will designate the rows to which these users will have access. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-ols-compartments.html#GUID-653303D6-8E6D-4039-8E76-1F665C7117FB">Step 6: Add the Policy Labels to the HR.EMPLOYEES Table Data</a><br>The <code class="codeph">HR</code> user will add the policy labels to the <code class="codeph">HR.EMPLOYEES</code> table data in the <code class="codeph">EMPLOYEE_ID</code> column. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-ols-compartments.html#GUID-C77ABFE3-017C-4F06-BF71-B4702CDAC2C4">Step 7: Test the Oracle Label Security Policy</a><br>To test the policy, each user will try to query the <code class="codeph">HR.EMPLOYEES</code> table. 
                  </li>
                  <li class="ulchildlink"><a href="configuring-ols-compartments.html#GUID-850AAB19-D669-4141-9CDF-44D43B4E9D18">Step 8: Optionally, Remove the Oracle Label Security Policy Components</a><br>You can remove the Oracle Label Security policy, <code class="codeph">HR_ROLE</code> role, and users Ida Neau, Susan Mavris, and Lily Leagull. 
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="oracle-label-security-tutorials.html" title="Part III provides tutorials on how to create Oracle Label Security policies.">Oracle Label Security Tutorials</a></p>
                  </div>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-5A72FF71-0AA5-4FB1-B2DE-E192BC88A6DE" name="GUID-5A72FF71-0AA5-4FB1-B2DE-E192BC88A6DE"></a><h3 id="OLSAG-GUID-5A72FF71-0AA5-4FB1-B2DE-E192BC88A6DE" class="sect3">About This Tutorial</h3>
               <div>
                  <p>In this tutorial, you will use the <code class="codeph">HR</code> schema to learn how to use Oracle Label Security compartments.
                  </p>
                  <p>This tutorial builds on the previous tutorial, which demonstrates how to create Oracle Label Security levels to control the access that two users, Susan Mavris and Ida Neau, have to the records in the <code class="codeph">HR.EMPLOYEES</code> schema. For this tutorial, a third user, Lily Leagull, is an attorney with the company's legal department. Two former employees are suing the company, and she must have access to their records. She must not have access to any other records. The access to the former users is set by the <code class="codeph">HIGHLY_SENSITIVE</code> level, which you created in the previous tutorial. Access to the records of the two suing former employees will be possible through the use of a compartment within the <code class="codeph">HIGHLY_SENSITIVE</code> data set, called <code class="codeph">LEGAL</code>. 
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="configuring-ols-levels.html#GUID-6FDDF617-FB75-4707-91DD-0FEF079AD638" title="This tutorial demonstrates how to create Oracle Label Security levels.">Tutorial: Configuring Levels in Oracle Label Security</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-ols-compartments.html#GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" title="This tutorial demonstrates how to create Oracle Label Security compartments.">Tutorial: Configuring Compartments in Oracle Label Security</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-D3314573-7F9F-4F9C-910D-4D393285C433" name="GUID-D3314573-7F9F-4F9C-910D-4D393285C433"></a><h3 id="OLSAG-GUID-D3314573-7F9F-4F9C-910D-4D393285C433" class="sect3">Step 1: Create an Account for Lily Leagull</h3>
               <div>
                  <p>Lily Leagull will initially have the same privileges as Susan Mavris and Ida Neau.</p>
                  <ol>
                     <li class="stepexpand"><span>Log in to SQL*Plus as a user who has privileges to create user accounts and grant them roles. </span><div>For example:<pre class="oac_no_warn" dir="ltr">sqlplus sec_admin
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Create the account for Lily Leagull and grant her the <code class="codeph">HR_ROLE</code> role as follows:</span><div><pre class="oac_no_warn" dir="ltr">GRANT CONNECT, HR_ROLE TO LLEAGULL IDENTIFIED BY <span class="italic">password</span>;</pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-ols-compartments.html#GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" title="This tutorial demonstrates how to create Oracle Label Security compartments.">Tutorial: Configuring Compartments in Oracle Label Security</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-B8DBFC5E-C6CD-4548-9970-A6EE941B8238" name="GUID-B8DBFC5E-C6CD-4548-9970-A6EE941B8238"></a><h3 id="OLSAG-GUID-B8DBFC5E-C6CD-4548-9970-A6EE941B8238" class="sect3">Step 2: Authorize Lily Leagull for the HIGHLY_SENSITIVE Level</h3>
               <div>
                  <p>After the <code class="codeph">lleagull</code> account has been created, you can authorize it to use the <code class="codeph">HIGHLY_SENSITIVE</code> level.
                  </p>
                  <ol>
                     <li class="stepexpand"><span>Connect as a user who can create and manage Oracle Label Security policies.</span><div>For example:<pre class="oac_no_warn" dir="ltr">sqlplus psmith_ols
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Authorize <code class="codeph">lleagull</code> to use the <code class="codeph">HIGHLY_SENSITIVE</code> level.</span><div>The short name for <code class="codeph">HIGHLY_SENSITIVE</code> is <code class="codeph">HS</code>.
                        </div>
                        <div><pre class="oac_no_warn" dir="ltr">BEGIN
   SA_USER_ADMIN.SET_LEVELS (
      policy_name  =&gt; 'HR_OLS_POL',
      user_name    =&gt; 'LLEAGULL', 
      max_level    =&gt; 'HS',
      min_level    =&gt; 'S');
END;
/</pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-ols-compartments.html#GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" title="This tutorial demonstrates how to create Oracle Label Security compartments.">Tutorial: Configuring Compartments in Oracle Label Security</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-1A99D62E-AF1B-45D3-8DB5-1DA7B325B7B1" name="GUID-1A99D62E-AF1B-45D3-8DB5-1DA7B325B7B1"></a><h3 id="OLSAG-GUID-1A99D62E-AF1B-45D3-8DB5-1DA7B325B7B1" class="sect3">Step 3: Create Two Compartments for the Oracle Label Security Policy</h3>
               <div>
                  <p>All three users (Susan Mavris, Ida Neau, and Lily Leagull) will use compartments to access their data. </p>
                  <div class="section">The two HR employees, Susan Mavris and Ida Neau, will use the <code class="codeph">HR</code> compartment. The Legal department employee, Lily Leagull, will use the <code class="codeph">LEGAL</code> (<code class="codeph">LEG</code>) compartment. 
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>If necessary, connect as a user who can create and manage Oracle Label Security policies.</span><div>For example:<pre class="oac_no_warn" dir="ltr">sqlplus psmith_ols
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Create the compartments as follows:</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
  SA_COMPONENTS.CREATE_COMPARTMENT (
    policy_name      =&gt; 'HR_OLS_POL',
    long_name        =&gt; 'HR',
    short_name       =&gt; 'HR',
    comp_num         =&gt;  1000);

  SA_COMPONENTS.CREATE_COMPARTMENT (
    policy_name      =&gt; 'HR_OLS_POL',
    long_name        =&gt; 'LEGAL',
    short_name       =&gt; 'LEG',
    comp_num         =&gt;  2000);
END;
/
</pre><p>In this specification, the <code class="codeph">comp_num</code> does not denote hierarchy as the <code class="codeph">level_num</code> setting does with levels. It is only used to help identify the compartment. 
                           </p>
                        </div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-ols-compartments.html#GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" title="This tutorial demonstrates how to create Oracle Label Security compartments.">Tutorial: Configuring Compartments in Oracle Label Security</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-F2005DF2-E7A5-4F21-A0BA-6B155EAE904C" name="GUID-F2005DF2-E7A5-4F21-A0BA-6B155EAE904C"></a><h3 id="OLSAG-GUID-F2005DF2-E7A5-4F21-A0BA-6B155EAE904C" class="sect3">Step 4: Create the Data Labels for the Compartments</h3>
               <div>
                  <p>You will create three data labels for the compartments.</p>
                  <div class="section">In this procedure, the data labels will designate the rows that users Susan Mavris, Ida Neau, and Lily Leagull will see in the <code class="codeph">HR.EMPLOYEES</code> table. 
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>If necessary, connect as a user who can create and manage Oracle Label Security policies.</span><div>For example:<pre class="oac_no_warn" dir="ltr">sqlplus psmith_ols
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Create the data labels as follows:</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
   SA_LABEL_ADMIN.CREATE_LABEL (
      policy_name  =&gt; 'HR_OLS_POL',
      label_tag    =&gt; 1100,
      label_value  =&gt; 'S:HR:', <span class="italic">-- SENSITIVE level for the HR compartment</span>
      data_label   =&gt; TRUE);

   SA_LABEL_ADMIN.CREATE_LABEL (
      policy_name  =&gt; 'HR_OLS_POL',
      label_tag    =&gt; 1200,
      label_value  =&gt; 'HS:HR:', <span class="italic">-- HIGHLY_SENSITIVE level for the HR compartment</span>
      data_label   =&gt; TRUE);

   SA_LABEL_ADMIN.CREATE_LABEL (
      policy_name  =&gt; 'HR_OLS_POL',
      label_tag    =&gt; 1300,
      label_value  =&gt; 'HS:LEG:', <span class="italic">--HIGHLY_SENSITIVE level for the LEG compartment</span>
      data_label   =&gt; TRUE);

END;
/</pre><p>In this specification:</p>
                           <ul style="list-style-type: disc;" id="GUID-F2005DF2-E7A5-4F21-A0BA-6B155EAE904C__UL_FGF_ZSR_4GB">
                              <li><code class="codeph">label_value</code> <code class="codeph">S:HR</code> will be assigned to the records of all current employees. 
                              </li>
                              <li><code class="codeph">label_value</code> <code class="codeph">HS:HR</code> will be assigned to the records all current and former employees. 
                              </li>
                              <li><code class="codeph">label_value</code> <code class="codeph">HS:LEG</code> will be assigned to the records of former employees who are suing the company. 
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-ols-compartments.html#GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" title="This tutorial demonstrates how to create Oracle Label Security compartments.">Tutorial: Configuring Compartments in Oracle Label Security</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-BC5CED85-B35A-492A-BBBE-4D2FCF906CC6" name="GUID-BC5CED85-B35A-492A-BBBE-4D2FCF906CC6"></a><h3 id="OLSAG-GUID-BC5CED85-B35A-492A-BBBE-4D2FCF906CC6" class="sect3">Step 5: Assign the Labels to the Users</h3>
               <div>
                  <p>Assigning the labels to the users will designate the rows to which these users will have access. </p>
                  <ol>
                     <li class="stepexpand"><span>If necessary, connect as a user who can create and manage Oracle Label Security policies.</span><div>For example:<pre class="oac_no_warn" dir="ltr">sqlplus psmith_ols
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Assign the labels to the users as follows:</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
   SA_USER_ADMIN.SET_USER_LABELS (
      policy_name    =&gt; 'HR_OLS_POL',
      user_name      =&gt; 'ineau', 
      max_read_label =&gt; 'S:HR:');

   SA_USER_ADMIN.SET_USER_LABELS (
      policy_name    =&gt; 'HR_OLS_POL',
      user_name      =&gt; 'smavris', 
      max_read_label =&gt; 'HS:HR,LEG:');

   SA_USER_ADMIN.SET_USER_LABELS (
      policy_name    =&gt; 'HR_OLS_POL',
      user_name      =&gt; 'lleagull', 
      max_read_label =&gt; 'HS:LEG:');
END;
/</pre><p>In this specification:</p>
                           <ul style="list-style-type: disc;" id="GUID-BC5CED85-B35A-492A-BBBE-4D2FCF906CC6__UL_HJZ_JMJ_SGB">
                              <li>User <code class="codeph">ineau</code> (Ida Neau), who is authorized for the <code class="codeph">HR</code> compartment, will continue to have access to all current employees, but not the former or suing employees.
                              </li>
                              <li>User <code class="codeph">smavris</code> (Susan Mavris), who is authorized for both the <code class="codeph">HR</code> and <code class="codeph">LEG</code> compartments, will continue to have access to all current and former employees, and former employees who are suing the company. 
                              </li>
                              <li>User <code class="codeph">lleagul</code> (Lily Leagul), who is authorized for the <code class="codeph">LEG</code> compartment, will have access only to former employees who are suing the company.
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-ols-compartments.html#GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" title="This tutorial demonstrates how to create Oracle Label Security compartments.">Tutorial: Configuring Compartments in Oracle Label Security</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-653303D6-8E6D-4039-8E76-1F665C7117FB" name="GUID-653303D6-8E6D-4039-8E76-1F665C7117FB"></a><h3 id="OLSAG-GUID-653303D6-8E6D-4039-8E76-1F665C7117FB" class="sect3">Step 6: Add the Policy Labels to the HR.EMPLOYEES Table Data</h3>
               <div>
                  <p>The <code class="codeph">HR</code> user will add the policy labels to the <code class="codeph">HR.EMPLOYEES</code> table data in the <code class="codeph">EMPLOYEE_ID</code> column. 
                  </p>
                  <ol>
                     <li class="stepexpand"><span>Connect as the <code class="codeph">HR</code> user.</span><div><pre class="oac_no_warn" dir="ltr">connect hr
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Perform the following <code class="codeph">UPDATE</code> statement to apply the <code class="codeph">SENSITIVE</code> level and the <code class="codeph">HR</code> compartment to the employee IDs of users who are still currently employed with the company.</span><div>This <code class="codeph">UPDATE</code> statement controls the access that Ida Neau will have to the <code class="codeph">HR.EMPLOYEES</code> table because she is authorized for the <code class="codeph">SENSITIVE</code> level and the <code class="codeph">HR</code> compartment. 
                        </div>
                        <div><pre class="oac_no_warn" dir="ltr">UPDATE employees
SET    ols_col = CHAR_TO_LABEL('HR_OLS_POL','S:HR')
WHERE  UPPER(employee_id) NOT IN (200, 101, 102, 176, 201, 122, 114);</pre></div>
                     </li>
                     <li class="stepexpand"><span>Perform the following <code class="codeph">UPDATE</code> statement to apply the <code class="codeph">HIGHLY_SENSITIVE</code> level and <code class="codeph">HR</code> compartment to the employee IDs of current and former employees.</span><div>This <code class="codeph">UPDATE</code> statement controls the access that Susan Mavris will have to the <code class="codeph">HR.EMPLOYEES</code> table because she is authorized for the <code class="codeph">SENSITIVE</code> level and the <code class="codeph">HR</code> and <code class="codeph">LEG</code> compartments. 
                        </div>
                        <div><pre class="oac_no_warn" dir="ltr">UPDATE employees
SET    ols_col = CHAR_TO_LABEL('HR_OLS_POL','HS:HR,LEG')
WHERE  UPPER(employee_id) IN (200, 101, 102, 176, 201, 122, 114);</pre></div>
                     </li>
                     <li class="stepexpand"><span>Perform the following <code class="codeph">UPDATE</code> statement to apply the <code class="codeph">HIGHLY_SENSITIVE</code> level and <code class="codeph">LEG</code> compartment to the employee IDs of former employees who are suing the company.</span><div>This <code class="codeph">UPDATE</code> statement controls the access that Lily Leagull will have to the <code class="codeph">HR.EMPLOYEES</code> table because she is authorized for the <code class="codeph">HIGHLY_SENSITIVE</code> level and the <code class="codeph">LEG</code> compartment. 
                        </div>
                        <div><pre class="oac_no_warn" dir="ltr">UPDATE employees
SET    ols_col = CHAR_TO_LABEL('HR_OLS_POL','HS:LEG')
WHERE  UPPER(employee_id) IN (200, 101);</pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-ols-compartments.html#GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" title="This tutorial demonstrates how to create Oracle Label Security compartments.">Tutorial: Configuring Compartments in Oracle Label Security</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-C77ABFE3-017C-4F06-BF71-B4702CDAC2C4" name="GUID-C77ABFE3-017C-4F06-BF71-B4702CDAC2C4"></a><h3 id="OLSAG-GUID-C77ABFE3-017C-4F06-BF71-B4702CDAC2C4" class="sect3">Step 7: Test the Oracle Label Security Policy</h3>
               <div>
                  <p>To test the policy, each user will try to query the <code class="codeph">HR.EMPLOYEES</code> table. 
                  </p>
                  <ol>
                     <li class="stepexpand"><span>Connect as user Ida Neau.</span><div><pre class="oac_no_warn" dir="ltr">connect ineau
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Set column widths for the table output. </span><div><pre class="oac_no_warn" dir="ltr">column first_name format a25
column last_name format a25
column ols_label format a10</pre></div>
                     </li>
                     <li class="stepexpand"><span>Execute the following query:</span><div><pre class="oac_no_warn" dir="ltr">SELECT FIRST_NAME, LAST_NAME, EMPLOYEE_ID, 
LABEL_TO_CHAR(OLS_COL) OLS_LABEL 
FROM HR.EMPLOYEES 
ORDER BY OLS_COL;</pre><p>The output should be similar to the following:</p><pre class="oac_no_warn" dir="ltr">FIRST_NAME                LAST_NAME                 EMPLOYEE_ID OLS_LABEL
------------------------- ------------------------- ----------- ----------
Steven                    King                              100 S:HR
Alexander                 Hunold                            103 S:HR
Bruce                     Ernst                             104 S:HR
David                     Austin                            105 S:HR
Valli                     Pataballa                         106 S:HR
Diana                     Lorentz                           107 S:HR
Nancy                     Greenberg                         108 S:HR
Daniel                    Faviet                            109 S:HR
John                      Chen                              110 S:HR
Ismael                    Sciarra                           111 S:HR
...

100 rows selected
</pre><p>Because Ida Neau was assigned the <code class="codeph">SENSITIVE</code> (<code class="codeph">S</code>) label and the <code class="codeph">HR</code> compartment, the output in the column <code class="codeph">OLS_LABEL</code> is <code class="codeph">S:HR</code>. 100 rows are returned.
                           </p>
                           <p>Note that the Oracle Label Security policy restriction applies to any <code class="codeph">SELECT</code> query the user makes. For example, if Ida Neau performs a <code class="codeph">SELECT COUNT(*) FROM HR.EMPLOYEES;</code> query, then it would return 100 rows, not the full 107.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Connect as user Susan Mavris. </span><div><pre class="oac_no_warn" dir="ltr">connect smavris
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Execute the same query that Ida Neau executed. </span><div><pre class="oac_no_warn" dir="ltr">SELECT FIRST_NAME, LAST_NAME, EMPLOYEE_ID, 
LABEL_TO_CHAR(OLS_COL) OLS_LABEL 
FROM HR.EMPLOYEES 
ORDER BY OLS_COL;</pre><p>The output should be similar to the following:</p><pre class="oac_no_warn" dir="ltr">FIRST_NAME                LAST_NAME                 EMPLOYEE_ID OLS_LABEL
------------------------- ------------------------- ----------- ----------
Steven                    King                              100 S:HR
Alexander                 Hunold                            103 S:HR
Bruce                     Ernst                             104 S:HR
David                     Austin                            105 S:HR
Valli                     Pataballa                         106 S:HR
...
Jennifer                  Whalen                            200 HS:LEG
Neena                     Kochhar                           101 HS:LEG
Michael                   Hartstein                         201 HS:HR,LEG
Jonathon                  Taylor                            176 HS:HR,LEG
Den                       Raphaely                          114 HS:HR,LEG
Lex                       De Haan                           102 HS:HR,LEG
Payam                     Kaufling                          122 HS:HR,LEG

107 rows selected</pre><p>Because Susan Mavris was assigned the <code class="codeph">HIGHLY_SENSITIVE</code> (<code class="codeph">HS</code>) level with the <code class="codeph">HR</code> and <code class="codeph">LEG</code> compartments, the output in the column <code class="codeph">OLS_LABEL</code> is as follows:
                           </p>
                           <ul style="list-style-type: disc;" id="GUID-C77ABFE3-017C-4F06-BF71-B4702CDAC2C4__UL_SZF_GPJ_SGB">
                              <li><code class="codeph">S:HR</code> to capture all current employees
                              </li>
                              <li><code class="codeph">HS:HR, LEG</code> to capture all former employees
                              </li>
                              <li><code class="codeph">HS:LEG</code> to capture former employees who are suing.
                              </li>
                           </ul>
                           <p> 107 rows are returned.</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Connect as user Lily Leagull. </span><div><pre class="oac_no_warn" dir="ltr">connect lleagull
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Execute the same query that Susan Mavris executed. </span><div><pre class="oac_no_warn" dir="ltr">SELECT FIRST_NAME, LAST_NAME, EMPLOYEE_ID, 
LABEL_TO_CHAR(OLS_COL) OLS_LABEL 
FROM HR.EMPLOYEES 
ORDER BY OLS_COL;</pre><p>The output should be similar to the following:</p><pre class="oac_no_warn" dir="ltr">FIRST_NAME                LAST_NAME                 EMPLOYEE_ID OLS_LABEL
------------------------- ------------------------- ----------- ----------
Jennifer                  Whalen                            200 HS:LEG
Neena                     Kochhar                           101 HS:LEG

107 rows selected</pre><p>Because Lily Leagull was assigned the <code class="codeph">HS</code> level with the <code class="codeph">LEG</code> compartment, only former users who are suing are returned for her query.
                           </p>
                        </div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-ols-compartments.html#GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" title="This tutorial demonstrates how to create Oracle Label Security compartments.">Tutorial: Configuring Compartments in Oracle Label Security</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-850AAB19-D669-4141-9CDF-44D43B4E9D18" name="GUID-850AAB19-D669-4141-9CDF-44D43B4E9D18"></a><h3 id="OLSAG-GUID-850AAB19-D669-4141-9CDF-44D43B4E9D18" class="sect3">Step 8: Optionally, Remove the Oracle Label Security Policy Components</h3>
               <div>
                  <p>You can remove the Oracle Label Security policy, <code class="codeph">HR_ROLE</code> role, and users Ida Neau, Susan Mavris, and Lily Leagull. 
                  </p>
                  <ol>
                     <li class="stepexpand"><span>Connect as a user who can create and manage Oracle Label Security policies.</span><div>For example:<pre class="oac_no_warn" dir="ltr">sqlplus psmith_ols
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Drop the Oracle Label Security policy. </span><div>This procedure also removes the levels, compartments, and from the <code class="codeph">HR.EMPLOYEES</code> table, the <code class="codeph">OLS_COL</code> column.
                        </div>
                        <div><pre class="oac_no_warn" dir="ltr">BEGIN
  SA_SYSDBA.DROP_POLICY ( 
    policy_name  =&gt; 'HR_OLS_POL',
    drop_column  =&gt; TRUE);
END;
/</pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect as user who has privileges to drop roles and user accounts. </span><div>For example:<pre class="oac_no_warn" dir="ltr">connect sec_admin
Enter password: <span class="italic">password</span></pre></div>
                     </li>
                     <li class="stepexpand"><span>Drop the <code class="codeph">HR_ROLE</code> role. </span><div><pre class="oac_no_warn" dir="ltr">DROP ROLE HR_ROLE;</pre></div>
                     </li>
                     <li class="stepexpand"><span>Drop the <code class="codeph">ineau</code>, <code class="codeph">smavris</code>, and <code class="codeph">lleagull</code> accounts. </span><div><pre class="oac_no_warn" dir="ltr">DROP USER INEAU;
DROP USER SMAVRIS;
DROP USER LLEAGULL;</pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="configuring-ols-compartments.html#GUID-714BF1A7-9275-457A-BCF8-C2F2C3D353BD" title="This tutorial demonstrates how to create Oracle Label Security compartments.">Tutorial: Configuring Compartments in Oracle Label Security</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>