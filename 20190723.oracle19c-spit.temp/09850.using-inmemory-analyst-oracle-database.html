<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">
      <meta name="description" content="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">
      <title>Using the In-Memory Analyst (PGX)</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Property Graph Developer’s Guide">
      <meta property="og:description" content="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Property Graph Developer’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="spatial-and-graph-property-graph-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-10T15:23:57-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2016, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E94800-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-property-graphs-oracle-database.html" title="Previous" type="text/html">
      <link rel="next" href="sql-based-property-graph-query-analytics.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Spatial and Graph Property Graph Developer's Guide">
    <meta name="dcterms.isVersionOf" content="SPGDG">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-property-graphs-oracle-database.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="sql-based-property-graph-query-analytics.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Property Graph Developer’s Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Using the In-Memory Analyst (PGX)</li>
            </ol>
            <a id="GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" name="GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C"></a><a id="BDSPA264"></a>
            
            <h2 id="SPGDG-GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" class="sect2"><span class="enumeration_chapter">3 </span>Using the In-Memory Analyst (PGX)
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.</p>
               <p>This chapter provides examples using the in-memory analyst (also referred to as Property Graph In-Memory Analytics, and often abbreviated as PGX in the Javadoc, command line, path descriptions, error messages, and examples). It contains the following major topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-254F911A-2750-4CF7-A895-E0B9E027B18C">Reading a Graph into Memory</a><br>This topic provides an example of reading graph interactively into memory using the shell interface. 
                  </li>
                  <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-06D546D0-FF3A-45E2-B30E-A78B52871DFF">Reading Custom Graph Data</a><br>You can read your own custom graph data.
                  </li>
                  <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-8E32C3CB-4546-49C0-8262-1C8FF92FD0F7">Storing Graph Data on Disk</a><br>After reading a graph into memory using either Java or the Shell, you can store it on disk in different formats. You can then use the stored graph data as input to the in-memory analyst at a later time.
                  </li>
                  <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-71FC3DB6-62F1-42E6-B711-A32958FC53D4">Executing Built-in Algorithms</a><br>The in-memory analyst contains a set of built-in algorithms that are available as Java APIs.
                  </li>
                  <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-D3134FE8-E17D-40F0-A32D-4CA40B60F361">Creating Subgraphs</a><br>You can create subgraphs based on a graph that has been loaded into memory. You can use filter expressions or create bipartite subgraphs based on a vertex (node) collection that specifies the left set of the bipartite graph.
                  </li>
                  <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-D2C0F3CF-2B00-4712-9375-E40985C26C7C">Using Automatic Delta Refresh to Handle Database Changes</a><br>You can automatically refresh (auto-refresh) graphs periodically to keep the in-memory graph synchronized with changes to the underlying property graph in the database.
                  </li>
                  <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-1732BD3C-F120-449B-9FED-90E638A6097A">Deploying to Apache Tomcat</a><br>You can deploy the in-memory analyst to Apache Tomcat or Oracle WebLogic. This example shows how to deploy In-Memory Analytics as a web application with Apache Tomcat.
                  </li>
                  <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-BFE7B780-7841-4DAC-88E9-84C45D160DE9">Deploying to Oracle WebLogic Server</a><br>You can deploy the in-memory analysts to Apache Tomcat or Oracle WebLogic Server. This example shows how to deploy the in-memory analyst as a web application with Oracle WebLogic Server.
                  </li>
                  <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-ABA81274-29A0-4D9A-BA1A-A241C0539BF5">Connecting to the In-Memory Analyst Server</a><br>After the property graph in-memory analyst is installed in a computer running Oracle Database -- or on a client system without Oracle Database server software as a web application on Apache Tomcat or Oracle WebLogic Server -- you can connect to the in-memory analyst server.
                  </li>
                  <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-3AB6A64B-7E50-493F-A896-6812243D7841">Managing Property Graph Snapshots</a><br>Oracle Spatial and Graph Property Graph lets you manage property graph snapshots.
                  </li>
               </ul>
            </div>
            
            <div class="props_rev_3"><a id="GUID-254F911A-2750-4CF7-A895-E0B9E027B18C" name="GUID-254F911A-2750-4CF7-A895-E0B9E027B18C"></a><h3 id="SPGDG-GUID-254F911A-2750-4CF7-A895-E0B9E027B18C" class="sect3"><span class="enumeration_section">3.1 </span>Reading a Graph into Memory
               </h3>
               <div>
                  <p>This topic provides an example of reading graph interactively into memory using the shell interface. </p>
                  <p>These are the major steps:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-9660AEF0-DD32-4882-87BE-749C0C7FE102">Connecting to an In-Memory Analyst Server Instance</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-7E6E3198-28DC-484E-9AE1-0339799AD4B7">Using the Shell Help</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-BE3E5A99-896A-458D-BF2F-270CC82EA43D">Providing Graph Metadata in a Configuration File</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-4D385F44-4DE9-4223-BEE5-06E1479FAE06">Reading Graph Data into Memory</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" title="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">Using the In-Memory Analyst (PGX)</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-9660AEF0-DD32-4882-87BE-749C0C7FE102" name="GUID-9660AEF0-DD32-4882-87BE-749C0C7FE102"></a><h4 id="SPGDG-GUID-9660AEF0-DD32-4882-87BE-749C0C7FE102" class="sect4"><span class="enumeration_section">3.1.1 </span>Connecting to an In-Memory Analyst Server Instance
                  </h4>
                  <div>
                     <div class="section">
                        <p>To start the in-memory analyst shell:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Open a terminal session on the system where property graph support is installed.</span></li>
                        <li class="stepexpand"><span>Either start a local (embedded)  in-memory analyst  instance or connect to a remote  in-memory analyst  instance</span><ul>
                              <li>Java example of starting a local (embedded) instance:<pre class="pre codeblock"><code>import java.util.Map;
import java.util.HashMap;
import oracle.pgx.api.*;
import oracle.pgx.config.PgxConfig.Field;
 
String url = Pgx.EMBEDDED_URL; // local JVM
ServerInstance instance = Pgx.getInstance(url);
instance.startEngine(); // will use default configuration
PgxSession session = instance.createSession("test");</code></pre></li>
                              <li>Java example of connecting to a remote instance:<pre class="pre codeblock"><code>import java.util.Map;
import java.util.HashMap;
import oracle.pgx.api.*;
import oracle.pgx.config.PgxConfig.Field;
 
String url = "http://my-server.com:8080/pgx" // replace with base URL of your setup
ServerInstance instance = Pgx.getInstance(url);
PgxSession session = instance.createSession("test");</code></pre></li>
                           </ul>
                        </li>
                        <li class="stepexpand"><span>In the shell, enter the following commands, but select only one of the commands to start or connect to the desired type of instance:</span><div><pre class="pre codeblock"><code>export PGX_HOME=$ORACLE_HOME/md/property_graph/pgx
cd $PGX_HOME
./bin/pgx --help
./bin/pgx --version
 
# start embedded shell
./bin/pgx
 
# start remote shell
./bin/pgx --base_url http://my-server.com:8080/pgx</code></pre><p>For the embedded shell, the output should be similar to the following:</p><pre class="pre codeblock"><code>10:43:46,666 [main] INFO Ctrl$2 - &gt;&gt;&gt; PGX engine running.
pgx&gt;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Optionally, show the predefined variables:</span><div><pre class="pre codeblock"><code>pgx&gt; instance
==&gt; PGX Server Instance running on embedded mode
pgx&gt; session
==&gt; PGX session pgxShell registered at PGX Server Instance running on embedded mode
pgx&gt; analyst
==&gt; Analyst for PGX session pgxShell registered at PGX Server Instance running on embedded mode
pgx&gt;</code></pre><p>Examples in some other topics assume that the instance and session variables have been set as shown here.</p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>If the  in-memory analyst software is installed correctly, you will see an engine-running log message and the  in-memory analyst shell prompt (<code class="codeph">pgx&gt;</code>):
                        </p>
                        <p>The variables <code class="codeph">instance</code>, <code class="codeph">session</code>, and <code class="codeph">analyst</code> are ready to use.
                        </p>
                        <p>In the preceding example in this topic, the shell started a local instance because the <code class="codeph">pgx</code> command did not specify a remote URL.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-254F911A-2750-4CF7-A895-E0B9E027B18C" title="This topic provides an example of reading graph interactively into memory using the shell interface.">Reading a Graph into Memory</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-7E6E3198-28DC-484E-9AE1-0339799AD4B7" name="GUID-7E6E3198-28DC-484E-9AE1-0339799AD4B7"></a><h4 id="SPGDG-GUID-7E6E3198-28DC-484E-9AE1-0339799AD4B7" class="sect4"><span class="enumeration_section">3.1.2 </span>Using the Shell Help
                  </h4>
                  <div>
                     <p>The in-memory analyst shell provides a help system, which you access using the <code class="codeph">:help</code> command.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-254F911A-2750-4CF7-A895-E0B9E027B18C" title="This topic provides an example of reading graph interactively into memory using the shell interface.">Reading a Graph into Memory</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-BE3E5A99-896A-458D-BF2F-270CC82EA43D" name="GUID-BE3E5A99-896A-458D-BF2F-270CC82EA43D"></a><h4 id="SPGDG-GUID-BE3E5A99-896A-458D-BF2F-270CC82EA43D" class="sect4"><span class="enumeration_section">3.1.3 </span>Providing Graph Metadata in a Configuration File
                  </h4>
                  <div>
                     <p>This topic presents an example of providing graph metadata in a configuration file. Follow these steps oo create a directory and some example files.</p>
                     <ol>
                        <li>
                           <p>Create a directory to hold the example files that you will create. For example:</p><pre class="oac_no_warn" dir="ltr">mkdir -p ${ORACLE_HOME}/md/property_graph/examples/pgx/graphs/</pre></li>
                        <li>
                           <p>In that directory, create a text file named <code class="codeph">sample.adj.json</code> with the following content for the graph configuration file. This configuration file describes how the in-memory analyst reads the graph.
                           </p><pre class="oac_no_warn" dir="ltr">{
  "uri": "sample.adj", 
  "format": "adj_list",
  "node_props": [{ 
    "name": "prop", 
    "type": "integer" 
  }],
  "edge_props": [{ 
    "name": "cost", 
    "type": "double" 
  }],
  "separator": " "
}</pre></li>
                        <li>
                           <p>In the same directory, create a text file named <code class="codeph">sample.adj</code> with the following content for the graph data:
                           </p><pre class="oac_no_warn" dir="ltr">128 10 1908 27.03 99 8.51 
99 2 333 338.0
1908 889
333 6 128 51.09</pre></li>
                     </ol>
                     <p>In the configuration file, the <code class="codeph">uri</code> field provides the location of the graph data. This path resolves relative to the parent directory of the configuration file. When the in-memory analyst loads the graph, it searches for a file named <code class="codeph">sample.adj</code> containing the graph data.
                     </p>
                     <p>The other fields in the configuration file indicate that the graph data is provided in adjacency list format, and consists of one node property of type <code class="codeph">integer</code> and one edge property of type <code class="codeph">double</code>. 
                     </p>
                     <p>The following figure shows a property graph created from the data:</p>
                     <div class="figure" id="GUID-BE3E5A99-896A-458D-BF2F-270CC82EA43D__BABFEEHB">
                        <p class="titleinfigure">Figure 3-1 Property Graph Rendered by sample.adj Data</p><img src="img/pgx-sample-graph-2.png" alt="Description of Figure 3-1 follows" title="Description of Figure 3-1 follows" longdesc="img_text/pgx-sample-graph-2.html"><br><a href="img_text/pgx-sample-graph-2.html">Description of "Figure 3-1 Property Graph Rendered by sample.adj Data"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-254F911A-2750-4CF7-A895-E0B9E027B18C" title="This topic provides an example of reading graph interactively into memory using the shell interface.">Reading a Graph into Memory</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-4D385F44-4DE9-4223-BEE5-06E1479FAE06" name="GUID-4D385F44-4DE9-4223-BEE5-06E1479FAE06"></a><h4 id="SPGDG-GUID-4D385F44-4DE9-4223-BEE5-06E1479FAE06" class="sect4"><span class="enumeration_section">3.1.4 </span>Reading Graph Data into Memory
                  </h4>
                  <div>
                     <p>To read a graph into memory, you must pass the following information:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The path to the graph configuration file that specifies the graph metadata</p>
                        </li>
                        <li>
                           <p>A unique alphanumeric name that you can use to reference the graph</p>
                           <p>An error results if you previously loaded a different graph with the same name.</p>
                        </li>
                     </ul>
                     <p><span class="bold">Example: Using the Shell to Read a Graph</span></p><pre class="oac_no_warn" dir="ltr">pgx&gt; graph = session.readGraphWithProperties("&lt;ORACLE_HOME&gt;/md/property_graph/examples/pgx/graphs/sample.adj.json", "sample");
==&gt; PGX Graph named sample bound to PGX session pgxShell ...
pgx&gt; graph.getNumVertices()
==&gt; 4
</pre><p><span class="bold">Example: Using Java to Read a Graph</span></p><pre class="oac_no_warn" dir="ltr">import oracle.pgx.api.*;
 
PgxGraph graph = session.readGraphWithProperties("&lt;ORACLE_HOME&gt;/md/property_graph/examples/pgx/graphs/sample.adj.json");
</pre><p>The following topics contain additional examples of reading a property graph into memory:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-B8619BEA-4827-4175-9A0A-427C3020927C">Read a Graph Stored in Oracle Database into Memory</a><br></li>
                        <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-55CDDB76-EC55-4169-82AD-ED6E9116A4AD">Read a Graph Stored in the Local File System into Memory</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-254F911A-2750-4CF7-A895-E0B9E027B18C" title="This topic provides an example of reading graph interactively into memory using the shell interface.">Reading a Graph into Memory</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-B8619BEA-4827-4175-9A0A-427C3020927C" name="GUID-B8619BEA-4827-4175-9A0A-427C3020927C"></a><h5 id="SPGDG-GUID-B8619BEA-4827-4175-9A0A-427C3020927C" class="sect5"><span class="enumeration_section">3.1.4.1 </span>Read a Graph Stored in Oracle Database into Memory
                     </h5>
                     <div>
                        <p>To read a property graph stored in Oracle Database, you can create a JSON based configuration file as follows. Note that the hosts, store name, graph name, and other information must be customized for your own setup.</p><pre class="oac_no_warn" dir="ltr">% cat /tmp/my_graph_oracle.json
{"loading":{"load_edge_label":false},
"vertex_props":[
{"default":"default_name","name":"name","type":"string"}
],
"password":"&lt;YOUR_PASSWORD&gt;",
"db_engine":"RDBMS",
"max_num_connections":8,
"username":"scott",
"error_handling":{},"format":"pg","jdbc_url":"jdbc:oracle:thin:@127.0.0.1:1521:&lt;SID&gt;",
"name":"connections",
"edge_props":[
{"default":"1000000","name":"cost","type":"double"}
]
}
</pre><p>Then, read the configuration file into memory. The following example snippet reads the file into memory, generates an undirected graph (named <code class="codeph">U</code>) from the original data, and counts the number of triangles.
                        </p><pre class="oac_no_warn" dir="ltr">pgx&gt; g = session.readGraphWithProperties("/tmp/my_graph_oracle.json", "connections")
pgx&gt; analyst.countTriangles(g, false)
==&gt; 8</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-4D385F44-4DE9-4223-BEE5-06E1479FAE06">Reading Graph Data into Memory</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="props_rev_3"><a id="GUID-55CDDB76-EC55-4169-82AD-ED6E9116A4AD" name="GUID-55CDDB76-EC55-4169-82AD-ED6E9116A4AD"></a><h5 id="SPGDG-GUID-55CDDB76-EC55-4169-82AD-ED6E9116A4AD" class="sect5"><span class="enumeration_section">3.1.4.2 </span>Read a Graph Stored in the Local File System into Memory
                     </h5>
                     <div>
                        <p>The following command uses the configuration file from <a href="using-inmemory-analyst-oracle-database.html#GUID-BE3E5A99-896A-458D-BF2F-270CC82EA43D">Providing Graph Metadata in a Configuration File</a> and the name <code class="codeph">my-graph</code>:
                        </p><pre class="oac_no_warn" dir="ltr">pgx&gt; g = session.readGraphWithProperties&lt;ORACLE_HOME&gt;/md/property_graph/examples/pgx/graphs/sample.adj.json", "my-graph")</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-4D385F44-4DE9-4223-BEE5-06E1479FAE06">Reading Graph Data into Memory</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-06D546D0-FF3A-45E2-B30E-A78B52871DFF" name="GUID-06D546D0-FF3A-45E2-B30E-A78B52871DFF"></a><h3 id="SPGDG-GUID-06D546D0-FF3A-45E2-B30E-A78B52871DFF" class="sect3"><span class="enumeration_section">3.2 </span>Reading Custom Graph Data
               </h3>
               <div>
                  <p>You can read your own custom graph data.</p>
                  <p>This example creates a graph, alters it, and shows how to read it properly. This graph uses the adjacency list format, but the in-memory analyst supports several graph formats.</p>
                  <p>The main steps are:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-262F412D-51A7-4EB3-8842-76C6892B63A4">Creating a Simple Graph File</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-8282B436-9946-4CCE-A42E-5C91CE0F2FAE">Adding a Vertex Property</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-808D6ABB-9048-41E1-A4C1-E232A9B6664A">Using Strings as Vertex Identifiers</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-DA144BD7-6133-498F-BFED-BED9F84182BD">Adding an Edge Property</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" title="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">Using the In-Memory Analyst (PGX)</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-262F412D-51A7-4EB3-8842-76C6892B63A4" name="GUID-262F412D-51A7-4EB3-8842-76C6892B63A4"></a><h4 id="SPGDG-GUID-262F412D-51A7-4EB3-8842-76C6892B63A4" class="sect4"><span class="enumeration_section">3.2.1 </span>Creating a Simple Graph File
                  </h4>
                  <div>
                     <p>This example creates a small, simple graph in adjacency list format with no vertex or edge properties. Each line contains the vertex (node) ID, followed by the vertex IDs to which its outgoing edges point:</p><pre class="oac_no_warn" dir="ltr">1 2
2 3 4
3 4
4 2
</pre><p>In this list, a single space separates the individual tokens. The in-memory analyst supports other separators, which you can specify in the graph configuration file.</p>
                     <p>The following figure shows the data rendered as a property graph with 4 vertices and 5 edges. (There are two edges between vertex 2 and vertex 4, each pointing in a direction opposite form the other.)</p>
                     <div class="figure" id="GUID-262F412D-51A7-4EB3-8842-76C6892B63A4__BABCGCGG">
                        <p class="titleinfigure">Figure 3-2 Simple Custom Property Graph</p><img src="img/pgx_custom_graph.png" alt="Description of Figure 3-2 follows" title="Description of Figure 3-2 follows" longdesc="img_text/pgx_custom_graph.html"><br><a href="img_text/pgx_custom_graph.html">Description of "Figure 3-2 Simple Custom Property Graph"</a></div>
                     <!-- class="figure" -->
                     <p>Reading a graph into the in-memory analyst requires a graph configuration. You can provide the graph configuration using either of these methods:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Write the configuration settings in JSON format into a file</p>
                        </li>
                        <li>
                           <p>Using a Java <code class="codeph">GraphConfigBuilder</code> object.
                           </p>
                        </li>
                     </ul>
                     <p>The following examples show both methods.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-262F412D-51A7-4EB3-8842-76C6892B63A4__GUID-D3762C48-11F5-4AFA-82A7-0C880893779B">JSON Configuration</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">{
    "uri": "graph.adj",
    "format":"adj_list",
    "separator":" "
}</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-262F412D-51A7-4EB3-8842-76C6892B63A4__GUID-130100E4-C99A-427F-AE5C-A17E0210650A">Java Configuration</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">import oracle.pgx.config.FileGraphConfig;
import oracle.pgx.config.Format;
import oracle.pgx.config.GraphConfigBuilder;
FileGraphConfig config = GraphConfigBuilder 
   .forFileFormat(Format.ADJ_LIST) 
   .setUri("graph.adj") 
   .setSeparator(" ") 
   .build();
</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-06D546D0-FF3A-45E2-B30E-A78B52871DFF" title="You can read your own custom graph data.">Reading Custom Graph Data</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-8282B436-9946-4CCE-A42E-5C91CE0F2FAE" name="GUID-8282B436-9946-4CCE-A42E-5C91CE0F2FAE"></a><h4 id="SPGDG-GUID-8282B436-9946-4CCE-A42E-5C91CE0F2FAE" class="sect4"><span class="enumeration_section">3.2.2 </span>Adding a Vertex Property
                  </h4>
                  <div>
                     <p>The graph in <a href="using-inmemory-analyst-oracle-database.html#GUID-262F412D-51A7-4EB3-8842-76C6892B63A4">Creating a Simple Graph File</a> consists of vertices and edges, without vertex or edge properties. Vertex properties are positioned directly after the source vertex ID in each line. The graph data would look like this if you added a <code class="codeph">double</code> vertex (node) property with values 0.1, 2.0, 0.3, and 4.56789 to the graph:
                     </p><pre class="oac_no_warn" dir="ltr">1 0.1 2
2 2.0 3 4
3 0.3 4
4 4.56789 2
</pre><div class="infoboxnote" id="GUID-8282B436-9946-4CCE-A42E-5C91CE0F2FAE__GUID-E1749BB1-E9E1-4713-AD9C-2BFE62D488F4">
                        <p class="notep1">Note:</p>
                        <p>The in-memory analyst supports only homogeneous graphs, in which all vertices have the same number and type of properties.</p>
                     </div>
                     <p>For the in-memory analyst to read the modified data file, you must add a vertex (node) property in the configuration file or the builder code. The following examples provide a descriptive name for the property and set the type to <code class="codeph">double</code>.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-8282B436-9946-4CCE-A42E-5C91CE0F2FAE__GUID-FCBD55DD-3057-44AE-AD2B-86B7D375D737">JSON Configuration</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">{
    "uri": "graph.adj",
    "format":"adj_list",
    "separator":" ",
    "node_props":[{
        "name":"double-prop",
        "type":"double"
    }]
}</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8282B436-9946-4CCE-A42E-5C91CE0F2FAE__GUID-9B820741-1B78-4132-B564-3F7A4EE5D1EA">Java Configuration</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">import oracle.pgx.common.types.PropertyType;
import oracle.pgx.config.FileGraphConfig;
import oracle.pgx.config.Format;
import oracle.pgx.config.GraphConfigBuilder;

FileGraphConfig config = GraphConfigBuilder.forFileFormat(Format.ADJ_LIST) 
    .setUri("graph.adj") 
    .setSeparator(" ") 
    .addNodeProperty("double-prop", PropertyType.DOUBLE) 
    .build();</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-06D546D0-FF3A-45E2-B30E-A78B52871DFF" title="You can read your own custom graph data.">Reading Custom Graph Data</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-808D6ABB-9048-41E1-A4C1-E232A9B6664A" name="GUID-808D6ABB-9048-41E1-A4C1-E232A9B6664A"></a><h4 id="SPGDG-GUID-808D6ABB-9048-41E1-A4C1-E232A9B6664A" class="sect4"><span class="enumeration_section">3.2.3 </span>Using Strings as Vertex Identifiers
                  </h4>
                  <div>
                     <p>The previous examples used <code class="codeph">integer</code> vertex (node) IDs. The default in In-Memory Analytics is <code class="codeph">integer</code> vertex IDs, but you can define a graph to use <code class="codeph">string</code> vertex IDs instead.
                     </p>
                     <p>This data file uses "node 1", "node 2", and so forth instead of just the digit:</p><pre class="oac_no_warn" dir="ltr">"node 1" 0.1 "node 2"
"node 2" 2.0 "node 3" "node 4"
"node 3" 0.3 "node 4"
"node 4" 4.56789 "node 2"
</pre><p>Again, you must modify the graph configuration to match the data file:</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-808D6ABB-9048-41E1-A4C1-E232A9B6664A__GUID-5FC09CF5-883C-4975-90D6-6D7C15789A13">JSON Configuration</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">{
    "uri": "graph.adj",
    "format":"adj_list",
    "separator":" ",
    "node_props":[{
        "name":"double-prop",
        "type":"double"
    }],
    "node_id_type":"string"
}</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-808D6ABB-9048-41E1-A4C1-E232A9B6664A__GUID-4D60EAC8-5743-41EE-9667-C67BA1C68251">Java Configuration</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">import oracle.pgx.common.types.IdType;
import oracle.pgx.common.types.PropertyType;
import oracle.pgx.config.FileGraphConfig;
import oracle.pgx.config.Format;
import oracle.pgx.config.GraphConfigBuilder;

FileGraphConfig config = GraphConfigBuilder.forFileFormat(Format.ADJ_LIST) 
    .setUri("graph.adj") 
    .setSeparator(" ") 
    .addNodeProperty("double-prop", PropertyType.DOUBLE) 
    .setNodeIdType(IdType.STRING) 
    .build();
</pre><div class="infoboxnote" id="GUID-808D6ABB-9048-41E1-A4C1-E232A9B6664A__GUID-4A343CCB-E55C-4F84-8B5E-CDEF540C55F4">
                           <p class="notep1">Note:</p>
                           <p><code class="codeph">string</code> vertex IDs consume much more memory than <code class="codeph">integer</code> vertex IDs.
                           </p>
                           <p>Any single or double quotes inside the string must be escaped with a backslash (\).</p>
                           <p>Newlines (\n) inside strings are not supported.</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-06D546D0-FF3A-45E2-B30E-A78B52871DFF" title="You can read your own custom graph data.">Reading Custom Graph Data</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-DA144BD7-6133-498F-BFED-BED9F84182BD" name="GUID-DA144BD7-6133-498F-BFED-BED9F84182BD"></a><h4 id="SPGDG-GUID-DA144BD7-6133-498F-BFED-BED9F84182BD" class="sect4"><span class="enumeration_section">3.2.4 </span>Adding an Edge Property
                  </h4>
                  <div>
                     <p>This example adds an edge property of type <code class="codeph">string</code> to the graph. The edge properties are positioned after the destination vertex (node) ID.
                     </p><pre class="oac_no_warn" dir="ltr">"node1" 0.1 "node2" "edge_prop_1_2"
"node2" 2.0 "node3" "edge_prop_2_3" "node4" "edge_prop_2_4"
"node3" 0.3 "node4" "edge_prop_3_4"
"node4" 4.56789 "node2" "edge_prop_4_2"
</pre><p>The graph configuration must match the data file:</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-DA144BD7-6133-498F-BFED-BED9F84182BD__GUID-07B4B201-6355-451A-A8DE-A975AB98D8F8">JSON Configuration</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">{
    "uri": "graph.adj",
    "format":"adj_list",
    "separator":" ",
    "node_props":[{
        "name":"double-prop",
        "type":"double"
    }],
    "node_id_type":"string",
     "edge_props":[{
        "name":"edge-prop",
        "type":"string"
    }]
}
</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DA144BD7-6133-498F-BFED-BED9F84182BD__GUID-50FAFBD4-5CC8-40CC-B3A3-7A5A09611166">Java Configuration</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">import oracle.pgx.common.types.IdType;
import oracle.pgx.common.types.PropertyType;
import oracle.pgx.config.FileGraphConfig;
import oracle.pgx.config.Format;
import oracle.pgx.config.GraphConfigBuilder;

FileGraphConfig config = GraphConfigBuilder.forFileFormat(Format.ADJ_LIST) 
    .setUri("graph.adj") 
    .setSeparator(" ") 
    .addNodeProperty("double-prop", PropertyType.DOUBLE) 
    .setNodeIdType(IdType.STRING) 
    .addEdgeProperty("edge-prop", PropertyType.STRING) 
    .build();</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-06D546D0-FF3A-45E2-B30E-A78B52871DFF" title="You can read your own custom graph data.">Reading Custom Graph Data</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-8E32C3CB-4546-49C0-8262-1C8FF92FD0F7" name="GUID-8E32C3CB-4546-49C0-8262-1C8FF92FD0F7"></a><h3 id="SPGDG-GUID-8E32C3CB-4546-49C0-8262-1C8FF92FD0F7" class="sect3"><span class="enumeration_section">3.3 </span>Storing Graph Data on Disk
               </h3>
               <div>
                  <p>After reading a graph into memory using either Java or the Shell, you can store it on disk in different formats. You can then use the stored graph data as input to the in-memory analyst at a later time.</p>
                  <p>Storing graphs over HTTP/REST is currently not supported.</p>
                  <p>The options include:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-D9143A2A-BA3B-4390-A485-65E3ADBF00E3">Storing the Results of Analysis in a Vertex Property</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-6397CA9F-F60B-46E8-BE24-E23B702E187C">Storing a Graph in Edge-List Format on Disk</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" title="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">Using the In-Memory Analyst (PGX)</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-D9143A2A-BA3B-4390-A485-65E3ADBF00E3" name="GUID-D9143A2A-BA3B-4390-A485-65E3ADBF00E3"></a><h4 id="SPGDG-GUID-D9143A2A-BA3B-4390-A485-65E3ADBF00E3" class="sect4"><span class="enumeration_section">3.3.1 </span>Storing the Results of Analysis in a Vertex Property
                  </h4>
                  <div>
                     <p>This example reads a graph into memory and analyzes it using the Pagerank algorithm. This analysis creates a new vertex property to store the PageRank values.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-D9143A2A-BA3B-4390-A485-65E3ADBF00E3__GUID-57C7FA78-52AF-4655-A217-0EB1FEA29F8C">Using the Shell to Run PageRank</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">pgx&gt; g = session.readGraphWithProperties("&lt;ORACLE_HOME&gt;/md/property_graph/examples/pgx/graphs/sample.adj.json", "my-graph")
==&gt; ...
pgx&gt; rank = analyst.pagerank(g, 0.001, 0.85, 100)
</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D9143A2A-BA3B-4390-A485-65E3ADBF00E3__GUID-6F036C98-BE65-42EA-8D14-5DEDEBD67090">Using Java to Run PageRank</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">PgxGraph g = session.readGraphWithProperties("&lt;ORACLE_HOME&gt;/md /property_graph/examples/pgx/graphs/sample.adj.json", "my-graph");
VertexProperty&lt;Integer, Double&gt; rank = session.createAnalyst().pagerank(g, 0.001, 0.85, 100);
</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-8E32C3CB-4546-49C0-8262-1C8FF92FD0F7" title="After reading a graph into memory using either Java or the Shell, you can store it on disk in different formats. You can then use the stored graph data as input to the in-memory analyst at a later time.">Storing Graph Data on Disk</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-6397CA9F-F60B-46E8-BE24-E23B702E187C" name="GUID-6397CA9F-F60B-46E8-BE24-E23B702E187C"></a><h4 id="SPGDG-GUID-6397CA9F-F60B-46E8-BE24-E23B702E187C" class="sect4"><span class="enumeration_section">3.3.2 </span>Storing a Graph in Edge-List Format on Disk
                  </h4>
                  <div>
                     <p>This example stores the graph, the result of the Pagerank analysis, and all original edge properties as a file in edge-list format on disk. </p>
                     <p>To store a graph, you must specify:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The graph format</p>
                        </li>
                        <li>
                           <p>A path where the file will be stored</p>
                        </li>
                        <li>
                           <p>The properties to be stored. Specify VertexProperty.<code class="codeph">ALL</code> or EdgeProperty.<code class="codeph">ALL</code>&nbsp;to store all properties, or VertexProperty.<code class="codeph">NONE</code> or EdgePropery.<code class="codeph">NONE</code>&nbsp;to store no properties. To specify individual properties, pass in the VertexProperty or EdgeProperty objects you want to store.
                           </p>
                        </li>
                        <li>
                           <p>A flag that indicates whether to overwrite an existing file with the same name</p>
                        </li>
                     </ul>
                     <p>The following examples store the graph data in <code class="codeph">/tmp/sample_pagerank.elist</code>, with the <code class="codeph">/tmp/sample_pagerank.elist.json</code> configuration file. The return value is the graph configuration for the stored file. You can use it to read the graph again. 
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-6397CA9F-F60B-46E8-BE24-E23B702E187C__GUID-1FFDBB1E-C795-4B3C-BF64-57F06579A26D">Using the Shell to Store a Graph</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">pgx&gt; config = g.store(Format.EDGE_LIST, "/tmp/sample_pagerank.elist", [rank], EdgeProperty.ALL, false)
==&gt; {"uri":"/tmp/sample_pagerank.elist","edge_props":[{"type":"double","name":"cost"}],"vertex_id_type":"integer","loading":{},"format":"edge_list","attributes":{},"vertex_props":[{"type":"double","name":"pagerank"}],"error_handling":{}}</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6397CA9F-F60B-46E8-BE24-E23B702E187C__GUID-C8B377C0-410A-449A-A944-D215CB4C63E7">Using Java to Store a Graph</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">import oracle.pgx.api.*;
import oracle.pgx.config.*;
 
FileGraphConfig config = g.store(Format.EDGE_LIST, "/tmp/sample_pagerank.elist", Collections.singletonList(rank), EdgeProperty.ALL, false);</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-8E32C3CB-4546-49C0-8262-1C8FF92FD0F7" title="After reading a graph into memory using either Java or the Shell, you can store it on disk in different formats. You can then use the stored graph data as input to the in-memory analyst at a later time.">Storing Graph Data on Disk</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-71FC3DB6-62F1-42E6-B711-A32958FC53D4" name="GUID-71FC3DB6-62F1-42E6-B711-A32958FC53D4"></a><h3 id="SPGDG-GUID-71FC3DB6-62F1-42E6-B711-A32958FC53D4" class="sect3"><span class="enumeration_section">3.4 </span>Executing Built-in Algorithms
               </h3>
               <div>
                  <p>The in-memory analyst contains a set of built-in algorithms that are available as Java APIs.</p>
                  <p>This topic describes the use of the in-memory analyst using Triangle Counting and Pagerank analytics as examples.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-0EB00328-1272-4F00-ADCB-8F88CB1B334D">About the In-Memory Analyst</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-7314197C-DFBC-4F64-A383-D32441D7E821">Running the Triangle Counting Algorithm</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-8E5C3E18-A0B7-43FF-AE69-688F900311BC">Running the Pagerank Algorithm</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" title="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">Using the In-Memory Analyst (PGX)</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-0EB00328-1272-4F00-ADCB-8F88CB1B334D" name="GUID-0EB00328-1272-4F00-ADCB-8F88CB1B334D"></a><h4 id="SPGDG-GUID-0EB00328-1272-4F00-ADCB-8F88CB1B334D" class="sect4"><span class="enumeration_section">3.4.1 </span>About the In-Memory Analyst
                  </h4>
                  <div>
                     <p>The  in-memory analyst contains a set of built-in algorithms that are available as Java APIs. The details of the APIs are documented in the Javadoc that is included in the product documentation library. Specifically, see the <code class="codeph">BuiltinAlgorithms</code> interface Method Summary for a list of the supported in-memory analyst methods.
                     </p>
                     <p>For example, this is the Pagerank procedure signature:</p><pre class="oac_no_warn" dir="ltr">/**
   * Classic pagerank algorithm. Time complexity: O(E * K) with E = number of edges, K is a given constant (max
   * iterations)
   *
   * @param graph
   *          graph
   * @param e
   *          maximum error for terminating the iteration
   * @param d
   *          damping factor
   * @param max
   *          maximum number of iterations
   * @return Vertex Property holding the result as a double
   */
  public &lt;ID extends Comparable&lt;ID&gt;&gt; VertexProperty&lt;ID, Double&gt; pagerank(PgxGraph graph, double e, double d, int max);
</pre><pre class="oac_no_warn" dir="ltr"></pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-71FC3DB6-62F1-42E6-B711-A32958FC53D4" title="The in-memory analyst contains a set of built-in algorithms that are available as Java APIs.">Executing Built-in Algorithms</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-7314197C-DFBC-4F64-A383-D32441D7E821" name="GUID-7314197C-DFBC-4F64-A383-D32441D7E821"></a><h4 id="SPGDG-GUID-7314197C-DFBC-4F64-A383-D32441D7E821" class="sect4"><span class="enumeration_section">3.4.2 </span>Running the Triangle Counting Algorithm
                  </h4>
                  <div>
                     <p>For triangle counting, the <code class="codeph">sortByDegree</code> boolean parameter of <code class="codeph">countTriangles()</code> allows you to control whether the graph should first be sorted by degree (<code class="codeph">true</code>) or not (<code class="codeph">false</code>). If <code class="codeph">true</code>, more memory will be used, but the algorithm will run faster; however, if your graph is very large, you might want to turn this optimization off to avoid running out of memory.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-7314197C-DFBC-4F64-A383-D32441D7E821__GUID-A8DB3A08-7313-4FAF-9CE1-B1234634A183">Using the Shell to Run Triangle Counting</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">pgx&gt; analyst.countTriangles(graph, true)
==&gt; 1</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7314197C-DFBC-4F64-A383-D32441D7E821__GUID-BA146FD9-5200-4C0A-8355-0F4202C8ABA5">Using Java to Run Triangle Counting</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">import oracle.pgx.api.*;
 
Analyst analyst = session.createAnalyst();
long triangles = analyst.countTriangles(graph, true);</pre><p>The algorithm finds one triangle in the sample graph.</p>
                        <div class="infobox-tip" id="GUID-7314197C-DFBC-4F64-A383-D32441D7E821__GUID-09303ED3-A1D3-4655-AF28-69EC7B641678">
                           <p class="notep1">Tip:</p>
                           <p>When using the in-memory analyst shell, you can increase the amount of log output during execution by changing the logging level. See information about the <code class="codeph">:loglevel</code> command with <code class="codeph">:h :loglevel</code>.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-71FC3DB6-62F1-42E6-B711-A32958FC53D4" title="The in-memory analyst contains a set of built-in algorithms that are available as Java APIs.">Executing Built-in Algorithms</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-8E5C3E18-A0B7-43FF-AE69-688F900311BC" name="GUID-8E5C3E18-A0B7-43FF-AE69-688F900311BC"></a><h4 id="SPGDG-GUID-8E5C3E18-A0B7-43FF-AE69-688F900311BC" class="sect4"><span class="enumeration_section">3.4.3 </span>Running the Pagerank Algorithm
                  </h4>
                  <div>
                     <p>Pagerank computes a rank value between <code class="codeph">0</code> and <code class="codeph">1</code> for each vertex (node) in the graph and stores the values in a <code class="codeph">double</code> property. The algorithm therefore creates a <span class="italic">vertex property</span> of type <code class="codeph">double</code> for the output.
                     </p>
                     <p>In the in-memory analyst, there are two types of vertex and edge properties: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">Persistent Properties</span>: Properties that are loaded with the graph from a data source are fixed, in-memory copies of the data on disk, and are therefore persistent. Persistent properties are read-only, immutable and shared between sessions. 
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Transient Properties</span>: Values can only be written to transient properties, which are session private. You can create transient properties by calling <code class="codeph">createVertexProperty</code> and <code class="codeph">createEdgeProperty</code> on <code class="codeph">PgxGraph</code> objects.
                           </p>
                        </li>
                     </ul>
                     <p>This example obtains the top three vertices with the highest Pagerank values. It uses a transient vertex property of type <code class="codeph">double</code> to hold the computed Pagerank values. The Pagerank algorithm uses the following default values for the input parameters: error (tolerance = 0.001, damping factor = 0.85, and maximum number of iterations = 100.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-8E5C3E18-A0B7-43FF-AE69-688F900311BC__GUID-F7288B95-E43F-4C09-AD01-8DC923760DBA">Using the Shell to Run Pagerank</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">pgx&gt; rank = analyst.pagerank(graph, 0.001, 0.85, 100);
==&gt; ...
pgx&gt; rank.getTopKValues(3)
==&gt; 128=0.1402019732468347
==&gt; 333=0.12002296283541904
==&gt; 99=0.09708583862990475
</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8E5C3E18-A0B7-43FF-AE69-688F900311BC__GUID-538F4205-62DA-4872-8048-EDD984636A32">Using Java to Run Pagerank</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">import java.util.Map.Entry;
import oracle.pgx.api.*;
 
Analyst analyst = session.createAnalyst();
VertexProperty&lt;Integer, Double&gt; rank = analyst.pagerank(graph, 0.001, 0.85, 100);
for (Entry&lt;Integer, Double&gt; entry : rank.getTopKValues(3)) {
 System.out.println(entry.getKey() + "=" + entry.getValue());
}</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-71FC3DB6-62F1-42E6-B711-A32958FC53D4" title="The in-memory analyst contains a set of built-in algorithms that are available as Java APIs.">Executing Built-in Algorithms</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-D3134FE8-E17D-40F0-A32D-4CA40B60F361" name="GUID-D3134FE8-E17D-40F0-A32D-4CA40B60F361"></a><h3 id="SPGDG-GUID-D3134FE8-E17D-40F0-A32D-4CA40B60F361" class="sect3"><span class="enumeration_section">3.5 </span>Creating Subgraphs
               </h3>
               <div>
                  <p>You can create subgraphs based on a graph that has been loaded into memory. You can use filter expressions or create bipartite subgraphs based on a vertex (node) collection that specifies the left set of the bipartite graph.</p>
                  <p>For information about reading a graph into memory, see <a href="using-inmemory-analyst-oracle-database.html#GUID-4D385F44-4DE9-4223-BEE5-06E1479FAE06">Reading Graph Data into Memory</a>.
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-4A25C497-319F-4760-988B-8CD45EA109D3">About Filter Expressions</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-01A8BB3D-6410-40CD-98E0-0621FCC30BC5">Using a Simple Filter to Create a Subgraph</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-90AE8A8F-EDFD-4847-96E4-35C5F26984B1">Using a Complex Filter to Create a Subgraph</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-E3B9CF35-09D6-43B7-86E2-7D4A3B01FBC6">Using a Vertex Set to Create a Bipartite Subgraph</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" title="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">Using the In-Memory Analyst (PGX)</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-4A25C497-319F-4760-988B-8CD45EA109D3" name="GUID-4A25C497-319F-4760-988B-8CD45EA109D3"></a><h4 id="SPGDG-GUID-4A25C497-319F-4760-988B-8CD45EA109D3" class="sect4"><span class="enumeration_section">3.5.1 </span>About Filter Expressions
                  </h4>
                  <div>
                     <p>Filter expressions are expressions that are evaluated for each edge. The expression can define predicates that an edge must fulfil to be contained in the result, in this case a subgraph.</p>
                     <p>Consider the graph in <a href="using-inmemory-analyst-oracle-database.html#GUID-BE3E5A99-896A-458D-BF2F-270CC82EA43D">Providing Graph Metadata in a Configuration File</a>, which consists of four vertices (nodes) and four edges. For an edge to match the filter expression <code class="codeph">src.prop == 10</code>, the source vertex <code class="codeph">prop</code> property must equal 10. Two edges match that filter expression, as shown in the following figure.
                     </p>
                     <div class="figure" id="GUID-4A25C497-319F-4760-988B-8CD45EA109D3__EDGESMATCHINGSRC.PROP10-1138F71B">
                        <p class="titleinfigure">Figure 3-3  Edges Matching src.prop == 10</p><img src="img/pgx_sub_highlight1.png" alt="Description of Figure 3-3 follows" title="Description of Figure 3-3 follows" longdesc="img_text/pgx_sub_highlight1.html"><br><a href="img_text/pgx_sub_highlight1.html">Description of "Figure 3-3  Edges Matching src.prop == 10"</a></div>
                     <!-- class="figure" -->
                     <p>The following figure shows the graph that results when the filter is applied. The filter excludes the edges associated with vertex 333, and the vertex itself.</p>
                     <div class="figure" id="GUID-4A25C497-319F-4760-988B-8CD45EA109D3__GRAPHCREATEDBYTHESIMPLEFILTER-11390B0B">
                        <p class="titleinfigure">Figure 3-4 Graph Created by the Simple Filter</p><img src="img/pgx_subgraph1.png" alt="Description of Figure 3-4 follows" title="Description of Figure 3-4 follows" longdesc="img_text/pgx_subgraph1.html"><br><a href="img_text/pgx_subgraph1.html">Description of "Figure 3-4 Graph Created by the Simple Filter"</a></div>
                     <!-- class="figure" -->
                     <p>Using filter expressions to select a single vertex or a set of vertices is difficult. For example, selecting only the vertex with the property value <code class="codeph">10</code> is impossible, because the only way to match the vertex is to match an edge where <code class="codeph">10</code> is either the source or destination property value. However, when you match an edge you automatically include the source vertex, destination vertex, and the edge itself in the result.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-D3134FE8-E17D-40F0-A32D-4CA40B60F361" title="You can create subgraphs based on a graph that has been loaded into memory. You can use filter expressions or create bipartite subgraphs based on a vertex (node) collection that specifies the left set of the bipartite graph.">Creating Subgraphs</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-01A8BB3D-6410-40CD-98E0-0621FCC30BC5" name="GUID-01A8BB3D-6410-40CD-98E0-0621FCC30BC5"></a><h4 id="SPGDG-GUID-01A8BB3D-6410-40CD-98E0-0621FCC30BC5" class="sect4"><span class="enumeration_section">3.5.2 </span>Using a Simple Filter to Create a Subgraph
                  </h4>
                  <div>
                     <p>The following examples create the subgraph described in <a href="using-inmemory-analyst-oracle-database.html#GUID-4A25C497-319F-4760-988B-8CD45EA109D3">About Filter Expressions</a>.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-01A8BB3D-6410-40CD-98E0-0621FCC30BC5__GUID-B985D9C6-1FC0-4CF6-B411-EC956E663EB5">Using the Shell to Create a Subgraph</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">subgraph = graph.filter(new VertexFilter("vertex.prop == 10"))</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-01A8BB3D-6410-40CD-98E0-0621FCC30BC5__GUID-615A8ECA-FC32-4440-992C-94C9002BF255">Using Java to Create a Subgraph</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">import oracle.pgx.api.*;
import oracle.pgx.api.filter.*;

PgxGraph graph = session.readGraphWithProperties(...);
PgxGraph subgraph = graph.filter(new VertexFilter("vertex.prop == 10"));
</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-D3134FE8-E17D-40F0-A32D-4CA40B60F361" title="You can create subgraphs based on a graph that has been loaded into memory. You can use filter expressions or create bipartite subgraphs based on a vertex (node) collection that specifies the left set of the bipartite graph.">Creating Subgraphs</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-90AE8A8F-EDFD-4847-96E4-35C5F26984B1" name="GUID-90AE8A8F-EDFD-4847-96E4-35C5F26984B1"></a><h4 id="SPGDG-GUID-90AE8A8F-EDFD-4847-96E4-35C5F26984B1" class="sect4"><span class="enumeration_section">3.5.3 </span>Using a Complex Filter to Create a Subgraph
                  </h4>
                  <div>
                     <p>This example uses a slightly more complex filter. It uses the <code class="codeph">outDegree</code> function, which calculates the number of outgoing edges for an identifier (source <code class="codeph">src</code> or destination <code class="codeph">dst</code>). The following filter expression matches all edges with a  <code class="codeph">cost</code> property value greater than 50 and a destination vertex (node) with an <code class="codeph">outDegree</code> greater than 1.
                     </p><pre class="oac_no_warn" dir="ltr">dst.outDegree() &gt; 1 &amp;&amp; edge.cost &gt; 50
</pre><p>One edge in the sample graph matches this filter expression, as shown in the following figure.</p>
                     <div class="figure" id="GUID-90AE8A8F-EDFD-4847-96E4-35C5F26984B1__EDGESMATCHINGTHEOUTDEGREEFILTER-113934AF">
                        <p class="titleinfigure">Figure 3-5 Edges Matching the outDegree Filter</p><img src="img/pgx_sub_highlight2.png" alt="Description of Figure 3-5 follows" title="Description of Figure 3-5 follows" longdesc="img_text/pgx_sub_highlight2.html"><br><a href="img_text/pgx_sub_highlight2.html">Description of "Figure 3-5 Edges Matching the outDegree Filter"</a></div>
                     <!-- class="figure" -->
                     <p>The following figure shows the graph that results when the filter is applied. The filter excludes the edges associated with vertixes 99 and 1908, and so excludes those vertices also.</p>
                     <div class="figure" id="GUID-90AE8A8F-EDFD-4847-96E4-35C5F26984B1__GRAPHCREATEDBYTHEOUTDEGREEFILTER-11394310">
                        <p class="titleinfigure">Figure 3-6 Graph Created by the outDegree Filter</p><img src="img/pgx_subgraph2.png" alt="Description of Figure 3-6 follows" title="Description of Figure 3-6 follows" longdesc="img_text/pgx_subgraph2.html"><br><a href="img_text/pgx_subgraph2.html">Description of "Figure 3-6 Graph Created by the outDegree Filter"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-D3134FE8-E17D-40F0-A32D-4CA40B60F361" title="You can create subgraphs based on a graph that has been loaded into memory. You can use filter expressions or create bipartite subgraphs based on a vertex (node) collection that specifies the left set of the bipartite graph.">Creating Subgraphs</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-E3B9CF35-09D6-43B7-86E2-7D4A3B01FBC6" name="GUID-E3B9CF35-09D6-43B7-86E2-7D4A3B01FBC6"></a><h4 id="SPGDG-GUID-E3B9CF35-09D6-43B7-86E2-7D4A3B01FBC6" class="sect4"><span class="enumeration_section">3.5.4 </span>Using a Vertex Set to Create a Bipartite Subgraph
                  </h4>
                  <div>
                     <p>You can create a bipartite subgraph by specifying a set of vertices (nodes), which are used as the left side. A bipartite subgraph has edges only between the left set of vertices and the right set of vertices. There are no edges within those sets, such as between two nodes on the left side. In the in-memory analyst, vertices that are isolated because all incoming and outgoing edges were deleted are not part of the bipartite subgraph.</p>
                     <p>The following figure shows a bipartite subgraph. No properties are shown.</p>
                     <div class="figure" id="GUID-E3B9CF35-09D6-43B7-86E2-7D4A3B01FBC6__FIG-123-11396058"><img src="img/pgx_bipartite_graph.png" alt="Description of pgx_bipartite_graph.png follows" title="Description of pgx_bipartite_graph.png follows" longdesc="img_text/pgx_bipartite_graph.html"><br><a href="img_text/pgx_bipartite_graph.html">Description of the illustration pgx_bipartite_graph.png</a></div>
                     <!-- class="figure" -->
                     <p>The following examples create a bipartite subgraph from the simple graph created in <a href="using-inmemory-analyst-oracle-database.html#GUID-BE3E5A99-896A-458D-BF2F-270CC82EA43D">Providing Graph Metadata in a Configuration File</a>. They create a vertex collection and fill it with the vertices for the left side.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-E3B9CF35-09D6-43B7-86E2-7D4A3B01FBC6__GUID-2F2257D8-79BA-48A1-8438-B499DEBACD88">Using the Shell to Create a Bipartite Subgraph</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">pgx&gt; s = graph.createVertexSet()
==&gt; ...
pgx&gt; s.addAll([graph.getVertex(333), graph.getVertex(99)])
==&gt; ...
pgx&gt; s.size()
==&gt; 2
pgx&gt; bGraph = graph.bipartiteSubGraphFromLeftSet(s)
==&gt; PGX Bipartite Graph named sample-sub-graph-4</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E3B9CF35-09D6-43B7-86E2-7D4A3B01FBC6__GUID-B425C7D2-29DE-4B7B-9BC1-E1EEFF2EB633">Using Java to Create a Bipartite Subgraph</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">
import oracle.pgx.api.*;
 
VertexSet&lt;Integer&gt; s = graph.createVertexSet();
s.addAll(graph.getVertex(333), graph.getVertex(99));
BipartiteGraph bGraph = graph.bipartiteSubGraphFromLeftSet(s);</pre><p>When you create a subgraph, the in-memory analyst automatically creates a Boolean vertex (node) property that indicates whether the vertex is on the left side. You can specify a unique name for the property.</p>
                        <p>The resulting bipartite subgraph looks like this:</p>
                        <div class="figure" id="GUID-E3B9CF35-09D6-43B7-86E2-7D4A3B01FBC6__FIG-1284-11396D53"><img src="img/pgx_bipartite_subgraph.png" alt="Description of pgx_bipartite_subgraph.png follows" title="Description of pgx_bipartite_subgraph.png follows" longdesc="img_text/pgx_bipartite_subgraph.html"><br><a href="img_text/pgx_bipartite_subgraph.html">Description of the illustration pgx_bipartite_subgraph.png</a></div>
                        <!-- class="figure" -->
                        <p>Vertex 1908 is excluded from the bipartite subgraph. The only edge that connected that vertex extended from 128 to 1908. The edge was removed, because it violated the bipartite properties of the subgraph. Vertex 1908 had no other edges, and so was removed also.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-D3134FE8-E17D-40F0-A32D-4CA40B60F361" title="You can create subgraphs based on a graph that has been loaded into memory. You can use filter expressions or create bipartite subgraphs based on a vertex (node) collection that specifies the left set of the bipartite graph.">Creating Subgraphs</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-D2C0F3CF-2B00-4712-9375-E40985C26C7C" name="GUID-D2C0F3CF-2B00-4712-9375-E40985C26C7C"></a><h3 id="SPGDG-GUID-D2C0F3CF-2B00-4712-9375-E40985C26C7C" class="sect3"><span class="enumeration_section">3.6 </span>Using Automatic Delta Refresh to Handle Database Changes
               </h3>
               <div>
                  <p>You can automatically refresh (auto-refresh) graphs periodically to keep the in-memory graph synchronized with changes to the underlying property graph in the database.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-1DF8FA80-DB74-4268-9AAA-86177542F3AC">Configuring the In-Memory Server for Auto-Refresh</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-1A2AEB12-DD53-4CBA-9558-14CDA5DFC768">Configuring Basic Auto-Refresh</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-7FCED2D4-B678-488B-A0D4-6E87871172D2">Reading the Graph Using the In-Memory Analyst or a Java Application</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-578DB065-E3A7-4834-A48E-EFC09C795284">Checking Out a Specific Snapshot of the Graph</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-0815347C-919C-4478-A96A-246ACED61A66">Advanced Auto-Refresh Configuration</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" title="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">Using the In-Memory Analyst (PGX)</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-1DF8FA80-DB74-4268-9AAA-86177542F3AC" name="GUID-1DF8FA80-DB74-4268-9AAA-86177542F3AC"></a><h4 id="SPGDG-GUID-1DF8FA80-DB74-4268-9AAA-86177542F3AC" class="sect4"><span class="enumeration_section">3.6.1 </span>Configuring the In-Memory Server for Auto-Refresh
                  </h4>
                  <div>
                     <p>Because  auto-refresh can create many snapshots and therefore may lead to a high memory usage, by default the option to enable auto-refresh for graphs is available only to administrators.</p>
                     <p>To allow all users to auto-refresh graphs, you must include the following line into the in-memory analyst configuration file (located in <code class="codeph">$ORACLE_HOME/md/property_graph/pgx/conf/pgx.conf</code>):
                     </p><pre class="pre codeblock"><code>{
  "allow_user_auto_refresh": true
}
</code></pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-D2C0F3CF-2B00-4712-9375-E40985C26C7C" title="You can automatically refresh (auto-refresh) graphs periodically to keep the in-memory graph synchronized with changes to the underlying property graph in the database.">Using Automatic Delta Refresh to Handle Database Changes</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-1A2AEB12-DD53-4CBA-9558-14CDA5DFC768" name="GUID-1A2AEB12-DD53-4CBA-9558-14CDA5DFC768"></a><h4 id="SPGDG-GUID-1A2AEB12-DD53-4CBA-9558-14CDA5DFC768" class="sect4"><span class="enumeration_section">3.6.2 </span>Configuring Basic Auto-Refresh
                  </h4>
                  <div>
                     <p>Auto-refresh is configured in the loading section of the graph configuration. The example in this topic sets up auto-refresh to check for updates every minute, and to create a new snapshot when the data source has changed.</p>
                     <p>The following block (JSON format) enables the auto-refresh feature in the configuration file of the sample graph:</p><pre class="pre codeblock"><code>{
  "format": "pg",
  "jdbc_url": "jdbc:oracle:thin:@mydatabaseserver:1521/dbName",
  "username": "scott",
  "password": "&lt;password&gt;",
  "name": "my_graph",
  "vertex_props": [{
    "name": "prop",
    "type": "integer"
  }],
  "edge_props": [{
    "name": "cost",
    "type": "double"
  }],
  "separator": " ",
  "loading": {
    "auto_refresh": true,
    "update_interval_sec": 60
  },
}
</code></pre><p>Notice the additional&nbsp;<code class="codeph">loading</code>&nbsp;section containing the auto-refresh settings. You can also use the Java APIs to construct the same graph configuration programmatically:
                     </p><pre class="pre codeblock"><code>GraphConfig config = GraphConfigBuilder.forPropertyGraphRdbms()
  .setJdbcUrl("jdbc:oracle:thin:@mydatabaseserver:1521/dbName")
  .setUsername("scott")
  .setPassword("&lt;password&gt;")
  .setName("my_graph")
  .addVertexProperty("prop", PropertyType.INTEGER)
  .addEdgeProperty("cost", PropertyType.DOUBLE)
  .setAutoRefresh(true)
  .setUpdateIntervalSec(60)
  .build();
</code></pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-D2C0F3CF-2B00-4712-9375-E40985C26C7C" title="You can automatically refresh (auto-refresh) graphs periodically to keep the in-memory graph synchronized with changes to the underlying property graph in the database.">Using Automatic Delta Refresh to Handle Database Changes</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-7FCED2D4-B678-488B-A0D4-6E87871172D2" name="GUID-7FCED2D4-B678-488B-A0D4-6E87871172D2"></a><h4 id="SPGDG-GUID-7FCED2D4-B678-488B-A0D4-6E87871172D2" class="sect4"><span class="enumeration_section">3.6.3 </span>Reading the Graph Using the In-Memory Analyst or a Java Application
                  </h4>
                  <div>
                     <p>After creating the graph configuration, you can load the graph into the in-memory analyst using the regular APIs.</p><pre class="pre codeblock"><code>pgx&gt; G = session.readGraphWithProperties("graphs/my-config.pg.json")</code></pre><p>After the graph is loaded, a background task is started automatically, and it periodically checks the data source for updates.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-D2C0F3CF-2B00-4712-9375-E40985C26C7C" title="You can automatically refresh (auto-refresh) graphs periodically to keep the in-memory graph synchronized with changes to the underlying property graph in the database.">Using Automatic Delta Refresh to Handle Database Changes</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-578DB065-E3A7-4834-A48E-EFC09C795284" name="GUID-578DB065-E3A7-4834-A48E-EFC09C795284"></a><h4 id="SPGDG-GUID-578DB065-E3A7-4834-A48E-EFC09C795284" class="sect4"><span class="enumeration_section">3.6.4 </span>Checking Out a Specific Snapshot of the Graph
                  </h4>
                  <div>
                     <p>The database is queried every minute for updates. If the graph has changed in the database after the time interval passed, the graph is reloaded and a new snapshot is created in-memory automatically.</p>
                     <p>You can "check out" (move a pointer to a different version of) the available in-memory snapshots of the graph using the&nbsp;<code class="codeph">getAvailableSnapshots()</code>&nbsp;method of&nbsp;<code class="codeph">PgxSession</code>. Example output is as follows:
                     </p><pre class="pre codeblock"><code>pgx&gt; session.getAvailableSnapshots(G)
==&gt; GraphMetaData [getNumVertices()=4, getNumEdges()=4, memoryMb=0, dataSourceVersion=1453315103000, creationRequestTimestamp=1453315122669 (2016-01-20 10:38:42.669), creationTimestamp=1453315122685 (2016-01-20 10:38:42.685), vertexIdType=integer, edgeIdType=long]
==&gt; GraphMetaData [getNumVertices()=5, getNumEdges()=5, memoryMb=3, dataSourceVersion=1452083654000, creationRequestTimestamp=1453314938744 (2016-01-20 10:35:38.744), creationTimestamp=1453314938833 (2016-01-20 10:35:38.833), vertexIdType=integer, edgeIdType=long]
</code></pre><p>The preceding example output contains two entries, one for the originally loaded graph with 4 vertices and 4 edges, and one for the graph created by auto-refresh with 5 vertices and 5 edges.</p>
                     <p>To check out out a specific snapshot of the graph, use the&nbsp;setSnapshot()&nbsp;methods of&nbsp;PgxSession&nbsp;and give it the&nbsp;creationTimestamp&nbsp;of the snapshot you want to load.</p>
                     <p>For example, if&nbsp;G&nbsp;is pointing to the newer graph with 5 vertices and 5 edges, but you want to analyze the older version of the graph, you need to set the snapshot to&nbsp;1453315122685. In the in-memory analyst shell:</p><pre class="pre codeblock"><code>pgx&gt; G.getNumVertices()
==&gt; 5
pgx&gt; G.getNumEdges()
==&gt; 5

pgx&gt; session.setSnapshot( G, 1453315122685 )
==&gt; null

pgx&gt; G.getNumVertices()
==&gt; 4
pgx&gt; G.getNumEdges()
==&gt; 4
</code></pre><p>You can also load a specific snapshot of a graph directly using the&nbsp;<code class="codeph">readGraphAsOf()</code>&nbsp;method of&nbsp;<code class="codeph">PgxSession</code>. This is a shortcut for loading a graph with&nbsp;<code class="codeph">readGraphWithProperty()</code>&nbsp;followed by a&nbsp;<code class="codeph">setSnapshot()</code>. For example:
                     </p><pre class="pre codeblock"><code>pgx&gt; G = session.readGraphAsOf( config, 1453315122685 )</code></pre><p>If you do not know or care about what snapshots are currently available in-memory, you can also specify a time span of how “old” a snapshot is acceptable by specifying a maximum allowed age. For example, to specify a maximum snapshot age of 60 minutes, you can use the following:</p><pre class="pre codeblock"><code>pgx&gt; G = session.readGraphWithProperties( config, 60l, TimeUnit.MINUTES )</code></pre><p>If there are one or more snapshots in memory younger (newer) than the specified maximum age, the youngest (newest) of those snapshots will be returned. If all the available snapshots are older than the specified maximum age, or if there is no snapshot available at all, then a new snapshot will be created automatically.</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-D2C0F3CF-2B00-4712-9375-E40985C26C7C" title="You can automatically refresh (auto-refresh) graphs periodically to keep the in-memory graph synchronized with changes to the underlying property graph in the database.">Using Automatic Delta Refresh to Handle Database Changes</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-0815347C-919C-4478-A96A-246ACED61A66" name="GUID-0815347C-919C-4478-A96A-246ACED61A66"></a><h4 id="SPGDG-GUID-0815347C-919C-4478-A96A-246ACED61A66" class="sect4"><span class="enumeration_section">3.6.5 </span>Advanced Auto-Refresh Configuration
                  </h4>
                  <div>
                     <p>You can specify advanced options for auto-refresh configuration.</p>
                     <p>Internally, the in-memory analyst fetches the changes since the last check from the database and creates a new snapshot by applying the delta (changes) to the previous snapshot. There are two timers: one for fetching and caching the deltas from the database, the other for actually applying the deltas and creating a new snapshot.</p>
                     <p>Additionally, you can specify a threshold for the number of cached deltas. If the number of cached changes grows above this threshold, a new snapshot is created automatically. The number of cached changes is a simple sum of the number of vertex changes plus the number of edge changes.</p>
                     <p>The deltas are fetched periodically and cached on the in-memory analyst server for two reasons:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>To speed up the actual snapshot creation process</p>
                        </li>
                        <li>
                           <p>To account for the case that the database can "forget" changes after a while</p>
                        </li>
                     </ul>
                     <p>You can specify both a threshold and an update timer, which means that both conditions will be checked before new snapshot is created. At least one of these parameters (threshold or update timer) must be specified to prevent the delta cache from becoming too large. The interval at which the source is queried for changes must not be omitted.</p>
                     <p>The following parameters show a configuration where the data source is queried for new deltas every 5 minutes. New snapshots are created every 20 minutes or if the cached deltas reach a size of 1000 changes.</p><pre class="pre codeblock"><code>{
  "format": "pg",
  "jdbc_url": "jdbc:oracle:thin:@mydatabaseserver:1521/dbName",
  "username": "scott",
  "password": "&lt;your_password&gt;",
  "name": "my_graph",

  "loading": {
    "auto_refresh": true,
    "fetch_interval_sec": 300,
    "update_interval_sec": 1200,
    "update_threshold": 1000,
    "create_edge_id_index": true,
    "create_edge_id_mapping": true
  }
}
</code></pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-D2C0F3CF-2B00-4712-9375-E40985C26C7C" title="You can automatically refresh (auto-refresh) graphs periodically to keep the in-memory graph synchronized with changes to the underlying property graph in the database.">Using Automatic Delta Refresh to Handle Database Changes</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-1732BD3C-F120-449B-9FED-90E638A6097A" name="GUID-1732BD3C-F120-449B-9FED-90E638A6097A"></a><h3 id="SPGDG-GUID-1732BD3C-F120-449B-9FED-90E638A6097A" class="sect3"><span class="enumeration_section">3.7 </span>Deploying to Apache Tomcat
               </h3>
               <div>
                  <p>You can deploy the in-memory analyst to Apache Tomcat or Oracle WebLogic. This example shows how to deploy In-Memory Analytics as a web application with Apache Tomcat.</p>
                  <div class="section">
                     <p>The in-memory analyst ships with <code class="codeph">BASIC Auth</code> enabled, which requires a security realm. Tomcat supports many different types of realms. This example configures the simplest one, <code class="codeph">MemoryRealm</code>. See the Tomcat Realm Configuration How-to for information about the other types.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Copy the in-memory analyst WAR file into the Tomcat <code class="codeph">webapps</code> directory. For example:</span><div><pre class="oac_no_warn" dir="ltr">cp $PGX_HOME/server/pgx-webapp-&lt;VERSION&gt;.war $CATALINA_HOME/webapps/pgx.war
</pre><div class="p">Where <code class="codeph">PGX_HOME</code> should be defined as:<pre class="oac_no_warn" dir="ltr">export PGX_HOME=$ORACLE_HOME/md/property_graph/pgx</pre></div>
                           <p>Do <span class="bold">not</span> copy a file named <code class="codeph">pgx-webapp-&lt;VERSION&gt;<span class="bold">-wls</span>.war</code>, which is specific to WebLogic Server.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Open <code class="codeph">$CATALINA_HOME/conf/server.xml</code> in an editor and add the following realm class declaration under the <code class="codeph">&lt;Engine&gt;</code> element:</span><div><pre class="oac_no_warn" dir="ltr">&lt;Realm className="org.apache.catalina.realm.MemoryRealm" /&gt;
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Open <code class="codeph">CATALINA_HOME/conf/tomcat-users.xml</code> in an editor and define a user for the  <code class="codeph">USER</code> role. Replace <code class="codeph">scott</code> and <code class="codeph">&lt;password&gt;</code> in this example with an appropriate user name and password:</span><div><pre class="oac_no_warn" dir="ltr">&lt;role rolename="USER" /&gt;
&lt;user username="scott" password="&lt;password&gt;" roles="USER" /&gt;
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Ensure that port 8080 is not already in use.</span></li>
                     <li class="stepexpand"><span>Start Tomcat:</span><div><pre class="oac_no_warn" dir="ltr">cd $CATALINA_HOME
./bin/startup.sh
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Verify that Tomcat is working:</span><div><pre class="oac_no_warn" dir="ltr">cd $PGX_HOME
./bin/pgx --base_url http://scott:&lt;password&gt;@localhost:8080/pgx
</pre></div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-1732BD3C-F120-449B-9FED-90E638A6097A__GUID-E09BE13B-838C-47AB-9C66-F1542857E5F4">
                        <p class="notep1">Note:</p>
                        <p>Oracle recommends <code class="codeph">BASIC Auth</code> only for testing. Use stronger authentication mechanisms for all other types of deployments.
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-B3CBF04E-4A80-401E-9101-26833BF881AF">About the Authentication Mechanism</a><br></li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="http://tomcat.apache.org/" target="_blank">The Tomcat documentation (select desired version)</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" title="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">Using the In-Memory Analyst (PGX)</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-B3CBF04E-4A80-401E-9101-26833BF881AF" name="GUID-B3CBF04E-4A80-401E-9101-26833BF881AF"></a><h4 id="SPGDG-GUID-B3CBF04E-4A80-401E-9101-26833BF881AF" class="sect4"><span class="enumeration_section">3.7.1 </span>About the Authentication Mechanism
                  </h4>
                  <div>
                     <p>The in-memory analyst web deployment uses <code class="codeph">BASIC Auth</code> by default. You should change to a more secure authentication mechanism for a production deployment. 
                     </p>
                     <p>To change the authentication mechanism, modify the <code class="codeph">security-constraint</code> element of the <code class="codeph">web.xml</code> deployment descriptor in the web application archive (WAR) file.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-1732BD3C-F120-449B-9FED-90E638A6097A" title="You can deploy the in-memory analyst to Apache Tomcat or Oracle WebLogic. This example shows how to deploy In-Memory Analytics as a web application with Apache Tomcat.">Deploying to Apache Tomcat</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-BFE7B780-7841-4DAC-88E9-84C45D160DE9" name="GUID-BFE7B780-7841-4DAC-88E9-84C45D160DE9"></a><h3 id="SPGDG-GUID-BFE7B780-7841-4DAC-88E9-84C45D160DE9" class="sect3"><span class="enumeration_section">3.8 </span>Deploying to Oracle WebLogic Server
               </h3>
               <div>
                  <p>You can deploy the in-memory analysts to Apache Tomcat or Oracle WebLogic Server. This example shows how to deploy the in-memory analyst as a web application with Oracle WebLogic Server.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-E0C8D78D-B4D4-4F27-88B5-80D392A7928A">Installing Oracle WebLogic Server</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-F5F8D8AE-B5CE-4383-B349-B8926D5932D5">Deploying the In-Memory Analyst</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-AAC79296-F768-4997-A57F-EF62E50FB71C">Verifying That the Server Works</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#unique_270712142">About the Authentication Mechanism</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" title="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">Using the In-Memory Analyst (PGX)</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-E0C8D78D-B4D4-4F27-88B5-80D392A7928A" name="GUID-E0C8D78D-B4D4-4F27-88B5-80D392A7928A"></a><h4 id="SPGDG-GUID-E0C8D78D-B4D4-4F27-88B5-80D392A7928A" class="sect4"><span class="enumeration_section">3.8.1 </span>Installing Oracle WebLogic Server
                  </h4>
                  <div>
                     <p>To download and install the latest version of Oracle WebLogic Server, see</p>
                     <p><a href="http://www.oracle.com/technetwork/middleware/weblogic/documentation/index.html" target="_blank"><code class="codeph">http://www.oracle.com/technetwork/middleware/weblogic/documentation/index.html</code></a></p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-BFE7B780-7841-4DAC-88E9-84C45D160DE9" title="You can deploy the in-memory analysts to Apache Tomcat or Oracle WebLogic Server. This example shows how to deploy the in-memory analyst as a web application with Oracle WebLogic Server.">Deploying to Oracle WebLogic Server</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-F5F8D8AE-B5CE-4383-B349-B8926D5932D5" name="GUID-F5F8D8AE-B5CE-4383-B349-B8926D5932D5"></a><h4 id="SPGDG-GUID-F5F8D8AE-B5CE-4383-B349-B8926D5932D5" class="sect4"><span class="enumeration_section">3.8.2 </span>Deploying the In-Memory Analyst
                  </h4>
                  <div>
                     <p>To deploy the in-memory analyst to Oracle WebLogic, use commands like the following. Substitute your administrative credentials and WAR file for the values shown in this example:</p><pre class="oac_no_warn" dir="ltr">. $MW_HOME/user_projects/domains/mydomain/bin/setDomainEnv.sh
. $MW_HOME/wlserver/server/bin/setWLSEnv.sh
java weblogic.Deployer -adminurl http://localhost:7001 -username username -password password -deploy -source $PGX_HOME/server/pgx-webapp-&lt;version&gt;-wls.war</pre><div class="p">Where <code class="codeph">PGX_HOME</code> should be defined as:<pre class="oac_no_warn" dir="ltr">export PGX_HOME=$ORACLE_HOME/md/property_graph/pgx</pre></div>
                     <p>If the script runs successfully, you will see a message like this one:</p><pre class="oac_no_warn" dir="ltr">Target state: deploy completed on Server myserver</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-BFE7B780-7841-4DAC-88E9-84C45D160DE9" title="You can deploy the in-memory analysts to Apache Tomcat or Oracle WebLogic Server. This example shows how to deploy the in-memory analyst as a web application with Oracle WebLogic Server.">Deploying to Oracle WebLogic Server</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-AAC79296-F768-4997-A57F-EF62E50FB71C" name="GUID-AAC79296-F768-4997-A57F-EF62E50FB71C"></a><h4 id="SPGDG-GUID-AAC79296-F768-4997-A57F-EF62E50FB71C" class="sect4"><span class="enumeration_section">3.8.3 </span>Verifying That the Server Works
                  </h4>
                  <div>
                     <p>Verify that you can connect to the server by entering a command in the following format:</p><pre class="oac_no_warn" dir="ltr">$PGX_HOME/bin/pgx --base_url http://scott:<span class="italic">&lt;password&gt;</span>@localhost:7001/pgx
</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-BFE7B780-7841-4DAC-88E9-84C45D160DE9" title="You can deploy the in-memory analysts to Apache Tomcat or Oracle WebLogic Server. This example shows how to deploy the in-memory analyst as a web application with Oracle WebLogic Server.">Deploying to Oracle WebLogic Server</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="unique_270712142" name="unique_270712142"></a><h4 id="SPGDG-unique_270712142" class="sect4"><span class="enumeration_section">3.8.4 </span>About the Authentication Mechanism
                  </h4>
                  <div>
                     <p>The in-memory analyst web deployment uses <code class="codeph">BASIC Auth</code> by default. You should change to a more secure authentication mechanism for a production deployment. 
                     </p>
                     <p>To change the authentication mechanism, modify the <code class="codeph">security-constraint</code> element of the <code class="codeph">web.xml</code> deployment descriptor in the web application archive (WAR) file.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-BFE7B780-7841-4DAC-88E9-84C45D160DE9" title="You can deploy the in-memory analysts to Apache Tomcat or Oracle WebLogic Server. This example shows how to deploy the in-memory analyst as a web application with Oracle WebLogic Server.">Deploying to Oracle WebLogic Server</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-ABA81274-29A0-4D9A-BA1A-A241C0539BF5" name="GUID-ABA81274-29A0-4D9A-BA1A-A241C0539BF5"></a><h3 id="SPGDG-GUID-ABA81274-29A0-4D9A-BA1A-A241C0539BF5" class="sect3"><span class="enumeration_section">3.9 </span>Connecting to the In-Memory Analyst Server
               </h3>
               <div>
                  <p>After the property graph in-memory analyst is installed in a computer running Oracle Database -- or on a client system without Oracle Database server software as a web application on Apache Tomcat or Oracle WebLogic Server -- you can connect to the in-memory analyst server.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-11783F8D-6375-493B-B29A-5BA6E4B21A6A">Connecting with the In-Memory Analyst Shell</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-CAB8198A-B9DB-4781-8FAB-44CE35B6B6CB">Connecting with Java</a><br></li>
                     <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4">Connecting with the PGX REST API</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" title="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">Using the In-Memory Analyst (PGX)</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-11783F8D-6375-493B-B29A-5BA6E4B21A6A" name="GUID-11783F8D-6375-493B-B29A-5BA6E4B21A6A"></a><h4 id="SPGDG-GUID-11783F8D-6375-493B-B29A-5BA6E4B21A6A" class="sect4"><span class="enumeration_section">3.9.1 </span>Connecting with the In-Memory Analyst Shell
                  </h4>
                  <div>
                     <p>The simplest way to connect to an in-memory analyst instance is to specify the base URL of the server. The following base URL can connect the SCOTT user to the local instance listening on port 8080:</p>
                     <p><code class="codeph">http://scott:&lt;password&gt;@localhost:8080/pgx</code></p>
                     <p>To start the in-memory analyst shell with this base URL, you use the <code class="codeph">--base_url</code> command line argument 
                     </p><pre class="oac_no_warn" dir="ltr">cd $PGX_HOME
./bin/pgx --base_url http://scott:&lt;password&gt;@localhost:8080/pgx
</pre><p>You can connect to a remote instance the same way. However, the in-memory analyst currently does not provide remote support for the Control API. </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-inmemory-analyst-oracle-database.html#GUID-44ABBB96-31EE-4831-B37E-BD7001A06C04">About Logging HTTP Requests</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-ABA81274-29A0-4D9A-BA1A-A241C0539BF5" title="After the property graph in-memory analyst is installed in a computer running Oracle Database -- or on a client system without Oracle Database server software as a web application on Apache Tomcat or Oracle WebLogic Server -- you can connect to the in-memory analyst server.">Connecting to the In-Memory Analyst Server</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-44ABBB96-31EE-4831-B37E-BD7001A06C04" name="GUID-44ABBB96-31EE-4831-B37E-BD7001A06C04"></a><h5 id="SPGDG-GUID-44ABBB96-31EE-4831-B37E-BD7001A06C04" class="sect5"><span class="enumeration_section">3.9.1.1 </span>About Logging HTTP Requests
                     </h5>
                     <div>
                        <p>The  in-memory analyst shell suppresses all debugging messages by default. To see which HTTP requests are executed, set the log level for <code class="codeph">oracle.pgx</code> to <code class="codeph">DEBUG</code>, as shown in this example:
                        </p><pre class="oac_no_warn" dir="ltr">pgx&gt; <span class="bold">:loglevel oracle.pgx DEBUG</span>
===&gt; log level of oracle.pgx logger set to DEBUG
pgx&gt; <span class="bold">session.readGraphWithProperties("sample_http.adj.json", "sample")</span>
10:24:25,056 [main] DEBUG RemoteUtils - Requesting POST http://scott:&lt;password&gt;@localhost:8080/pgx/core/session/session-shell-6nqg5dd/graph HTTP/1.1 with payload {"graphName":"sample","graphConfig":{"uri":"http://path.to.some.server/pgx/sample.adj","separator":" ","edge_props":[{"type":"double","name":"cost"}],"node_props":[{"type":"integer","name":"prop"}],"format":"adj_list"}}
10:24:25,088 [main] DEBUG RemoteUtils - received HTTP status 201
10:24:25,089 [main] DEBUG RemoteUtils - {"futureId":"87d54bed-bdf9-4601-98b7-ef632ce31463"}
10:24:25,091 [pool-1-thread-3] DEBUG PgxRemoteFuture$1 - Requesting GET http://scott:&lt;password&gt;@localhost:8080/pgx/future/session/session-shell-6nqg5dd/result/87d54bed-bdf9-4601-98b7-ef632ce31463 HTTP/1.1
10:24:25,300 [pool-1-thread-3] DEBUG RemoteUtils - received HTTP status 200
10:24:25,301 [pool-1-thread-3] DEBUG RemoteUtils - {"stats":{"loadingTimeMillis":0,"estimatedMemoryMegabytes":0,"numEdges":4,"numNodes":4},"graphName":"sample","nodeProperties":{"prop":"integer"},"edgeProperties":{"cost":"double"}}
</pre><p>This example requires that the graph URI points to a file that the  in-memory analyst server can access using HTTP or HDFS. </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-11783F8D-6375-493B-B29A-5BA6E4B21A6A">Connecting with the In-Memory Analyst Shell</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-CAB8198A-B9DB-4781-8FAB-44CE35B6B6CB" name="GUID-CAB8198A-B9DB-4781-8FAB-44CE35B6B6CB"></a><h4 id="SPGDG-GUID-CAB8198A-B9DB-4781-8FAB-44CE35B6B6CB" class="sect4"><span class="enumeration_section">3.9.2 </span>Connecting with Java
                  </h4>
                  <div>
                     <p>You can specify the base URL when you initialize the in-memory analyst using Java. An example is as follows. A URL to an in-memory analyst server is provided to the <code class="codeph">getInMemAnalyst</code> API call.
                     </p><pre class="oac_no_warn" dir="ltr">import oracle.pg.rdbms.*;
import oracle.pgx.api.*;
 
PgRdbmsGraphConfigcfg = GraphConfigBuilder.forPropertyGraphRdbms().setJdbcUrl("jdbc:oracle:thin:@127.0.0.1:1521:orcl") 
   .setUsername("scott").setPassword("&lt;password&gt;")  .setName("mygraph") 
   .setMaxNumConnections(2) .setLoadEdgeLabel(false) 
   .addVertexProperty("name", PropertyType.STRING, "default_name")  
   .addEdgeProperty("weight", PropertyType.DOUBLE, "1000000")  
   .build();OraclePropertyGraph opg = OraclePropertyGraph.getInstance(cfg);
ServerInstance remoteInstance = Pgx.getInstance("http://scott:&lt;password&gt;@hostname:port/pgx");
PgxSession session = remoteInstance.createSession("my-session");
 
PgxGraph graph = session.readGraphWithProperties(opg.getConfig());
</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-ABA81274-29A0-4D9A-BA1A-A241C0539BF5" title="After the property graph in-memory analyst is installed in a computer running Oracle Database -- or on a client system without Oracle Database server software as a web application on Apache Tomcat or Oracle WebLogic Server -- you can connect to the in-memory analyst server.">Connecting to the In-Memory Analyst Server</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4" name="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4"></a><h4 id="SPGDG-GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4" class="sect4"><span class="enumeration_section">3.9.3 </span>Connecting with the PGX REST API
                  </h4>
                  <div>
                     <p>You can connect to an in-memory analyst instance using the REST API PGX endpoints. This enables you to interact with the in-memory analyst in a language other than Java to implement your own client.</p>
                     <p>The examples in this topic assume that:</p>
                     <ul style="list-style-type: disc;" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__UL_JJP_GKG_5FB">
                        <li>Linux with curl is installed. <a href="https://curl.haxx.se/download.html" target="_blank">curl</a> is a simple command-line utility to interact with REST endpoints.)
                        </li>
                        <li>The PGX server is up and running on <code class="codeph">http://localhost:7007</code>.
                        </li>
                        <li>The PGX server has authentication/authorization disabled; that is,<code class="codeph"> $ORACLE_HOME/md/property_graph/pgx/conf/server.conf</code> contains  <code class="codeph">"enable_tls": false</code>. (This is a non-default setting and <span class="bold">not recommended</span> for production).
                        </li>
                        <li>PGX allows reading graphs from the local file system; that is, <code class="codeph">$ORACLE_HOME/md/property_graph/pgx/conf/pgx.conf</code> contains <code class="codeph">"allow_local_filesystem": true</code>. (This is a non-default setting and <span class="bold">not recommended</span> for production).
                        </li>
                     </ul>
                     <p>For the Swagger specification, you can see a full list of supported endpoints in JSON by opening <code class="codeph">http://localhost:7007/swagger.json</code> in your browser.
                     </p>
                     <ul style="list-style-type: disc;" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__UL_FTZ_ZBH_5FB">
                        <li><a href="using-inmemory-analyst-oracle-database.html#GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_OHY_L3H_5FB">Step 1: Obtain a CSRF token</a></li>
                        <li><a href="using-inmemory-analyst-oracle-database.html#GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_EKZ_M3H_5FB">Step 2: Create a session</a></li>
                        <li><a href="using-inmemory-analyst-oracle-database.html#GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_VLM_N3H_5FB">Step 3: Read a graph</a></li>
                        <li><a href="using-inmemory-analyst-oracle-database.html#GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_NBH_43H_5FB">Step 4: Create a property</a></li>
                        <li><a href="using-inmemory-analyst-oracle-database.html#GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_L4R_43H_5FB">Step 5: Run the PageRank algorithm on the loaded graph</a></li>
                        <li><a href="using-inmemory-analyst-oracle-database.html#GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_RCJ_P3H_5FB">Step 6: Execute a PGQL query</a></li>
                     </ul>
                     <div class="section" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_OHY_L3H_5FB">
                        <p class="subhead3" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__GUID-7F6AE87A-25FB-4DCB-9C33-42231FD2D6DA">Step 1: Obtain a CSRF token</p>
                        <p>Request a CSRF token:</p><pre class="pre codeblock"><code>curl -v http://localhost:7007/token</code></pre><p>The response will look like this:</p><pre class="oac_no_warn" dir="ltr">*   Trying 127.0.0.1...
* Connected to localhost (127.0.0.1) port 7007 (#0)
&gt; GET /token HTTP/1.1
&gt; Host: localhost:7007
&gt; User-Agent: curl/7.47.0
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 201
&lt; SET-COOKIE: _csrf_token=9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0;Version=1; HttpOnly
&lt; Content-Length: 0
</pre><p>As you can see in the response, this will set a cookie <code class="codeph">_csrf_token</code> to a token value. <code class="codeph">9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0</code> is used as an example token for the following requests. For any write requests, PGX server requires the same token to be present in both cookie and payload.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_EKZ_M3H_5FB">
                        <p class="subhead3" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__GUID-A68D27B7-E5F6-4028-81EA-035189297375">Step 2: Create a session</p>
                        <p>To create a new session, send a JSON payload:</p><pre class="pre codeblock"><code>curl -v --cookie '_csrf_token=9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0' -H 'content-type: application/json' -X POST http://localhost:7007/core/v1/sessions -d '{"source":"my-application", "idleTimeout":0, "taskTimeout":0, "timeUnitName":"MILLISECONDS", "_csrf_token":"9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0"}'</code></pre><p>Replace <code class="codeph">my-application</code> with a value describing the application that you are running. This value can be used by server administrators to map sessions to their applications. Setting idle and task timeouts to <code class="codeph">0</code> means the server will determine when the session and submitted tasks time out. You must provide the same CSRF token in both the cookie header and the JSON payload.
                        </p>
                        <p>The response will look similar to the following:</p><pre class="oac_no_warn" dir="ltr">*   Trying 127.0.0.1...
* Connected to localhost (127.0.0.1) port 7007 (#0)
&gt; POST /core/v1/sessions HTTP/1.1
&gt; Host: localhost:7007
&gt; User-Agent: curl/7.47.0
&gt; Accept: */*
&gt; Cookie: _csrf_token=9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0
&gt; content-type: application/json
&gt; Content-Length: 159
&gt; 
* upload completely sent off: 159 out of 159 bytes
&lt; HTTP/1.1 201
&lt; SET-COOKIE: SID=abae2811-6dd2-48b0-93a8-8436e078907d;Version=1; HttpOnly
&lt; Content-Length: 0
</pre><p>The response sets a cookie to the session ID value that was created for us. Session ID <code class="codeph">abae2811-6dd2-48b0-93a8-8436e078907d</code> is used as an example for subsequent requests.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_VLM_N3H_5FB">
                        <p class="subhead3" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__GUID-31795076-C434-4A59-97FE-DAAE8D91DAE4">Step 3: Read a graph</p>
                        <div class="infoboxnote" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__GUID-963FEB0D-7EF0-432F-8E5C-87646E07E20C">
                           <p class="notep1">Note:</p>
                           <p>if you want to analyze a pre-loaded graph or a graph that is already published by another session, you can skip this step. All you need to access pre-loaded or published graphs is the name of the graph.</p>
                        </div>
                        <p>To read a graph, send the graph configuration as JSON to the server as shown in the following example (replace <code class="codeph">&lt;graph-config&gt;</code> with the JSON representation of an actual PGX graph config).
                        </p><pre class="pre codeblock"><code>curl -v -X POST --cookie '_csrf_token=9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0;SID=abae2811-6dd2-48b0-93a8-8436e078907d'  http://localhost:7007/core/v1/loadGraph -H 'content-type: application/json'  -d  '{"graphConfig":&lt;graph-config&gt;,"graphName":null,"csrf_token":"9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0"}'</code></pre><p>Here an example of a graph config that reads a property graph from the Oracle database:</p><pre class="pre codeblock"><code>{
  "format": "pg",
  "db_engine": "RDBMS",
  "jdbc_url":"jdbc:oracle:thin:@127.0.0.1:1521:orcl122",
  "username":"scott",
  "password":"tiger",
  "max_num_connections": 8,
  "name": "connections",
  "vertex_props": [
    {"name":"name", "type":"string"},
    {"name":"role", "type":"string"},
    {"name":"occupation", "type":"string"},
    {"name":"country", "type":"string"},
    {"name":"political party", "type":"string"},
    {"name":"religion", "type":"string"}
  ],
  "edge_props": [
    {"name":"weight", "type":"double", "default":"1"}
  ],
  "edge_label": true,
  "loading": {
    "load_edge_label": true
  }
}</code></pre><p>Passing <code class="codeph">"graphName": null</code> tells the server to generate a name.
                        </p>
                        <p>The server will reply something like the following:</p><pre class="oac_no_warn" dir="ltr">* upload completely sent off: 315 out of 315 bytes
&lt; HTTP/1.1 202
&lt; Location: http://localhost:7007/core/v1/futures/8a46ef65-01a9-4bd0-87d3-ffe9dfd2ce3c/status
&lt; Content-Type: application/json;charset=utf-8
&lt; Content-Length: 51
&lt; Date: Mon, 05 Nov 2018 17:22:22 GMT
&lt;
* Connection #0 to host localhost left intact
{"futureId":"8a46ef65-01a9-4bd0-87d3-ffe9dfd2ce3c"}</pre><p><span class="bold">About Asynchronous Requests</span></p>
                        <p>Most of the PGX REST endpoints are asynchronous. Instead of keeping the connection open until the result is ready, PGX server submits as task and immediately returns a future ID with status code 200, which then can be used by the client to periodically request the status of the task or request the result value once done.</p>
                        <p>From the preceding response, you can request the future status like this:</p><pre class="pre codeblock"><code>curl -v --cookie 'SID=abae2811-6dd2-48b0-93a8-8436e078907d'  http://localhost:7007/core/v1/futures/8a46ef65-01a9-4bd0-87d3-ffe9dfd2ce3c/status</code></pre><p>Which will return something like:</p><pre class="oac_no_warn" dir="ltr">&lt; HTTP/1.1 200
&lt; Content-Type: application/json;charset=utf-8
&lt; Content-Length: 730
&lt; Date: Mon, 05 Nov 2018 17:35:19 GMT
&lt; 
* Connection #0 to host localhost left intact
{"id":"eb17f75b-e4c1-4a66-81a0-4ff0f8b4cb92","links":[{"href":"http://localhost:7007/core/v1/futures/eb17f75b-e4c1-4a66-81a0-4ff0f8b4cb92/status","rel":"self","method":"GET","interaction":["async-polling"]},{"href":"http://localhost:7007/core/v1/futures/eb17f75b-e4c1-4a66-81a0-4ff0f8b4cb92","rel":"abort","method":"DELETE","interaction":["async-polling"]},{"href":"http://localhost:7007/core/v1/futures/eb17f75b-e4c1-4a66-81a0-4ff0f8b4cb92/status","rel":"canonical","method":"GET","interaction":["async-polling"]},{"href":"http://localhost:7007/core/v1/futures/eb17f75b-e4c1-4a66-81a0-4ff0f8b4cb92/value","rel":"related","method":"GET","interaction":["async-polling"]}],"progress":"succeeded","completed":true,"intervalToPoll":1}
</pre><p>Besides the status (<code class="codeph">succeeded</code> in this case), this output also includes links to cancel the task (<code class="codeph">DELETE</code>) and to retrieve the result of the task once completed (<code class="codeph">GET &lt;future-id&gt;/value</code>):
                        </p><pre class="pre codeblock"><code>curl -X GET --cookie 'SID=abae2811-6dd2-48b0-93a8-8436e078907d' http://localhost:7007/core/v1/futures/cdc15a38-3422-42a1-baf4-343c140cf95d/value</code></pre><p>Which will return details about the loaded graph, including the name that was generated by the server (<code class="codeph">sample</code>):
                        </p><pre class="oac_no_warn" dir="ltr">{"id":"sample","links":[{"href":"http://localhost:7007/core/v1/graphs/sample","rel":"self","method":"GET","interaction":["async-polling"]},{"href":"http://localhost:7007/core/v1/graphs/sample","rel":"canonical","method":"GET","interaction":["async-polling"]}],"nodeProperties":{"prop1":{"id":"prop1","links":[{"href":"http://localhost:7007/core/v1/graphs/sample/properties/prop1","rel":"self","method":"GET","interaction":["async-polling"]},{"href":"http://localhost:7007/core/v1/graphs/sample/properties/prop1","rel":"canonical","method":"GET","interaction":["async-polling"]}],"dimension":0,"name":"prop1","entityType":"vertex","type":"integer","transient":false}},"vertexLabels":null,"edgeLabel":null,"metaData":{"id":null,"links":null,"numVertices":4,"numEdges":4,"memoryMb":0,"dataSourceVersion":"1536029578000","config":{"format":"adj_list","separator":" ","edge_props":[{"type":"double","name":"cost"}],"error_handling":{},"vertex_props":[{"type":"integer","name":"prop1"}],"vertex_uris":["PATH_TO_FILE"],"vertex_id_type":"integer","loading":{}},"creationRequestTimestamp":1541242100335,"creationTimestamp":1541242100774,"vertexIdType":"integer","edgeIdType":"long","directed":true},"graphName":"sample","edgeProperties":{"cost":{"id":"cost","links":[{"href":"http://localhost:7007/core/v1/graphs/sample/properties/cost","rel":"self","method":"GET","interaction":["async-polling"]},{"href":"http://localhost:7007/core/v1/graphs/sample/properties/cost","rel":"canonical","method":"GET","interaction":["async-polling"]}],"dimension":0,"name":"cost","entityType":"edge","type":"double","transient":false}},"ageMs":0,"transient":false}</pre><p>For simplicity, the remaining steps omit the additional requests to request the status or value of asynchronous tasks.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_NBH_43H_5FB">
                        <p class="subhead3" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__GUID-7277972F-6679-467E-804C-45FC08EE617A">Step 4: Create a property</p>
                        <p>Before you can run the PageRank algorithm on the loaded graph, you must create a vertex property of type DOUBLE on the graph, which can hold the computed ranking values:</p><pre class="pre codeblock"><code>curl -v -X POST --cookie '_csrf_token=9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0;SID=abae2811-6dd2-48b0-93a8-8436e078907d'  http://localhost:7007/core/v1/graphs/sample/properties -H 'content-type: application/json'  -d '{"entityType":"vertex","type":"double","name":"pagerank", "hardName":false,"dimension":0,"_csrf_token":"9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0"}'</code></pre><p>Requesting the result of the returned future will return something like:</p><pre class="oac_no_warn" dir="ltr">{"id":"pagerank","links":[{"href":"http://localhost:7007/core/v1/graphs/sample/properties/pagerank","rel":"self","method":"GET","interaction":["async-polling"]},{"href":"http://localhost:7007/core/v1/graphs/sample/properties/pagerank","rel":"canonical","method":"GET","interaction":["async-polling"]}],"dimension":0,"name":"pagerank","entityType":"vertex","type":"double","transient":true}</pre></div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_L4R_43H_5FB">
                        <p class="subhead3" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__GUID-BEF23B8A-0658-43AA-8EC0-4E5ECBB0D172">Step 5: Run the PageRank algorithm on the loaded graph</p>
                        <p>The following example shows how to run an algorithm (PageRank in this case). The algorithm ID is part of the URL, and the parameters to be passed into the algorithm are part of the JSON payload:</p><pre class="pre codeblock"><code>curl -v -X POST --cookie '_csrf_token=9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0;SID=abae2811-6dd2-48b0-93a8-8436e078907d' http://localhost:7007/core/v1/analyses/pgx_builtin_k1a_pagerank/run -H  'content-type: application/json' -d  '{"args":[{"type":"GRAPH","value":"sample"},{"type":"DOUBLE_IN","value":0.001},{"type":"DOUBLE_IN","value":0.85},{"type":"INT_IN","value":100},{"type":"BOOL_IN","value":true},{"type":"NODE_PROPERTY","value":"pagerank"}],"expectedReturnType":"void","workloadCharacteristics":["PARALLELISM.PARALLEL"],"_csrf_token":"9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0"}'</code></pre><p>Once the future is completed, the result will look something like this:</p><pre class="oac_no_warn" dir="ltr">{"success":true,"canceled":false,"exception":null,"returnValue":null,"executionTimeMs":50}</pre></div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__SECTION_RCJ_P3H_5FB">
                        <p class="subhead3" id="GUID-93FB57BD-C898-45BF-BAF7-581C33591BB4__GUID-BA79C3BD-01AB-4266-B65C-9E13B316B307">Step 6: Execute a PGQL query</p>
                        <p>To query the results of the PageRank algorithm, you can run a PGQL query as shown in the following example:</p><pre class="pre codeblock"><code>curl -v -X POST --cookie '_csrf_token=9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0;SID=abae2811-6dd2-48b0-93a8-8436e078907d' http://localhost:7007/core/v1/pgql/run -H 'content-type: application/json'  -d '{"pgqlQuery":"SELECT x.pagerank MATCH (x) WHERE x.pagerank &gt; 0","semantic":"HOMOMORPHISM", "schemaStrictnessMode":true, "graphName" : "sample", "_csrf_token":"9bf51c8f-1c75-455e-9b57-ec3ca1c63cc0"}'</code></pre><p>The result is a set of links you can use to interact with the result set of the query:</p><pre class="oac_no_warn" dir="ltr">{"id":"pgql_1","links":[{"href":"http://localhost:7007/core/v1/pgqlProxies/pgql_1","rel":"self","method":"GET","interaction":["sync"]},{"href":"http://localhost:7007/core/v1/pgqlResultProxies/pgql_1/elements","rel":"related","method":"GET","interaction":["sync"]},{"href":"http://localhost:7007/core/v1/pgqlResultProxies/pgql_1/results","rel":"related","method":"GET","interaction":["sync"]},{"href":"http://localhost:7007/core/v1/pgqlProxies/pgql_1","rel":"canonical","method":"GET","interaction":["async-polling"]}],"exists":true,"graphName":"sample","resultSetId":"pgql_1","numResults":4}</pre><p>To request the first 2048 elements of the result set, send:</p><pre class="pre codeblock"><code>curl -X GET  --cookie 'SID=abae2811-6dd2-48b0-93a8-8436e078907d' http://localhost:7007/core/v1/pgqlProxies/pgql_1/results?size=2048</code></pre><p>The response looks something like this:</p><pre class="oac_no_warn" dir="ltr">{"id":"/pgx/core/v1/pgqlProxies/pgql_1/results","links":[{"href":"http://localhost:7007/core/v1/pgqlProxies/pgql_1/results","rel":"self","method":"GET","interaction":["sync"]},{"href":"http://localhost:7007/core/v1/pgqlProxies/pgql_1/results","rel":"canonical","method":"GET","interaction":["async-polling"]}],"count":4,"totalItems":4,"items":[[0.3081206521195582],[0.21367103988538017],[0.21367103988538017],[0.2645372681096815]],"hasMore":false,"offset":0,"limit":4,"showTotalResults":true}</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-ABA81274-29A0-4D9A-BA1A-A241C0539BF5" title="After the property graph in-memory analyst is installed in a computer running Oracle Database -- or on a client system without Oracle Database server software as a web application on Apache Tomcat or Oracle WebLogic Server -- you can connect to the in-memory analyst server.">Connecting to the In-Memory Analyst Server</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-3AB6A64B-7E50-493F-A896-6812243D7841" name="GUID-3AB6A64B-7E50-493F-A896-6812243D7841"></a><h3 id="SPGDG-GUID-3AB6A64B-7E50-493F-A896-6812243D7841" class="sect3"><span class="enumeration_section">3.10 </span>Managing Property Graph Snapshots
               </h3>
               <div>
                  <p>Oracle Spatial and Graph Property Graph lets you manage property graph snapshots.</p>
                  <p>You can persist different versions of a property graph as binary snapshots in the database. The binary snapshots represent a subgraph of graph data computed at runtime that may be needed for a future use. The snapshots can be read back later as input for the in-memory analytics, or as an output stream that can be used by the parallel property graph data loader.</p>
                  <div class="infoboxnote" id="GUID-3AB6A64B-7E50-493F-A896-6812243D7841__GUID-ECF65B7C-2829-4D09-BFF0-EAA57278BF92">
                     <p class="notep1">Note:</p>
                     <p>Managing property graph snapshots is intended for advanced users.</p>
                  </div>
                  <p>You can <span class="bold">store</span> binary snapshots in the &lt;graph_name&gt;SS$ table of the property graph using the Java API <code class="codeph">OraclePropertyGraphUtils.storeBinaryInMemoryGraphSnapshot</code>. This operation requires a connection to the Oracle database holding the property graph instance, the name of the graph and its owner, the ID of the snapshot, and an input stream from which the binary snapshot can be read. You can also specify the time stamp of the snapshot and the degree of parallelism to be used when storing the snapshot in the table.
                  </p>
                  <p>You can <span class="bold">read</span> a stored binary snapshot using <code class="codeph">oraclePropertyGraphUtils.readBinaryInMemGraphSnapshot</code>. This operation requires a connection to the Oracle database holding the property graph instance, the name of the graph and its owner, the ID of the snapshot to read, and an output stream where the binary file snapshot will be written into. You can also specify the degree of parallelism to be used when reading the snapshot binary-file from the table.
                  </p>
                  <p>The following code snippet creates a property graph from the data file in Oracle Flat-file format, adds a new vertex, and exports the graph into an output stream using GraphML format. This output stream represents a binary file snapshot, and it is stored in the property graph snapshot table. Finally, this example reads back the file from the snapshot table and creates a second graph from its contents.</p><pre class="pre codeblock"><code>String szOPVFile = "../../data/connections.opv"; 
String szOPEFile = "../../data/connections.ope"; 
OraclePropertyGraph opg = OraclePropertyGraph.getInstance(args, szGraphName); 
opgdl = OraclePropertyGraphDataLoader.getInstance(); 
opgdl.loadData(opg, szOPVFile, szOPEFile, 2 /* dop */, 1000, true, 
               "PDML=T,PDDL=T,NO_DUP=T,"); 

// Add a new vertex
Vertex v = opg.addVertex(Long.valueOf("1000"));
v.setProperty("name", "Alice");
opg.commit();

System.out.pritnln("Graph " + szGraphName + " total vertices: " + 
                   opg.countVertices(dop));
System.out.pritnln("Graph " + szGraphName + " total edges: " + 
                   opg.countEdges(dop));


// Get a snapshot of the current graph as a file in graphML format. 
OutputStream os = new ByteArrayOutputStream();
OraclePropertyGraphUtils.exportGraphML(opg, 
                                       os /* output stream */, 
                                       System.out /* stream to show progress */);

// Save the snapshot into the SS$ table
InputStream is = new ByteArrayInputStream(os.toByteArray());
OraclePropertyGraphUtils.storeBinaryInMemGraphSnapshot(szGraphName, 
                                                     szGraphOwner /* owner of the 
                                                                   property graph */,
                                                     conn /* database connection */, 
                                                     is,
                                                     (long) 1 /* snapshot ID */,
                                                     1 /* dop */);
os.close();
is.close();

// Read the snapshot back from the SS$ table
OutputStream snapshotOS = new ByteArrayOutputStream();
OraclePropertyGraphUtils.readBinaryInMemGraphSnapshot(szGraphName, 
                                                    szGraphOwner /* owner of the 
                                                                   property graph */,
                                                    conn /* database connection */, 
                                                    new OutputStream[] {snapshotOS},
                                                    (long) 1 /* snapshot ID */,
                                                    1 /* dop */);

InputStream snapshotIS = new ByteArrayInputStream(snapshotOS.toByteArray());
String szGraphNameSnapshot = szGraphName + "_snap";
OraclePropertyGraph opg = OraclePropertyGraph.getInstance(args,szGraphNameSnapshot); 

OraclePropertyGraphUtils.importGraphML(opg, 
                                       snapshotIS /* input stream */, 
                                       System.out /* stream to show progress */);

snapshotOS.close();
snapshotIS.close();


System.out.pritnln("Graph " + szGraphNameSnapshot + " total vertices: " + 
                   opg.countVertices(dop));
System.out.pritnln("Graph " + szGraphNameSnapshot + " total edges: " + 
                   opg.countEdges(dop));
</code></pre><p>The preceding example will produce output similar as the following:</p><pre class="oac_no_warn" dir="ltr">Graph test total vertices: 79
Graph test total edges: 164
Graph test_snap total vertices: 79
Graph test_snap total edges: 164
</pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-inmemory-analyst-oracle-database.html#GUID-C80502F2-67B0-42B3-B80F-6DA297EA655C" title="The in-memory analyst feature of Oracle Spatial and Graph supports a set of analytical functions.">Using the In-Memory Analyst (PGX)</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>