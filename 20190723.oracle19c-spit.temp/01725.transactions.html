<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter defines a transaction and describes how the database processes transactions.">
      <meta name="description" content="This chapter defines a transaction and describes how the database processes transactions.">
      <title>Transactions</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database Concepts">
      <meta property="og:description" content="This chapter defines a transaction and describes how the database processes transactions.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database Concepts">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-concepts.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T07:47:16-08:00">
      <meta name="dcterms.title" content="Database Concepts">
      <meta name="dcterms.dateCopyrighted" content="1993, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96138-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="data-concurrency-and-consistency.html" title="Previous" type="text/html">
      <link rel="next" href="oracle-database-storage-structures.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CNCPT">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="data-concurrency-and-consistency.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="oracle-database-storage-structures.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database Concepts</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-transaction-management.html" property="item" typeof="WebPage"><span property="name">Oracle Transaction Management</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Transactions </li>
            </ol>
            <a id="GUID-B97790CB-DF82-442D-B9D5-50CCE6BF9FBD" name="GUID-B97790CB-DF82-442D-B9D5-50CCE6BF9FBD"></a>
            
            <h2 id="CNCPT-GUID-B97790CB-DF82-442D-B9D5-50CCE6BF9FBD" class="sect2"><span class="enumeration_chapter">10 </span>Transactions 
            </h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='transactions'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
            </noscript>
            <div>
               <p>This chapter defines a transaction and describes how the database processes transactions.</p>
               <p>This chapter contains the following sections:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="transactions.html#GUID-31319EA7-994C-4D25-8814-0214ABD3CBDA" title="A transaction is a logical, atomic unit of work that contains one or more SQL statements.">Introduction to Transactions</a></p>
                  </li>
                  <li>
                     <p><a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361" title="Transaction control is the management of changes made by DML statements and the grouping of DML statements into transactions.">Overview of Transaction Control</a></p>
                  </li>
                  <li>
                     <p><a href="transactions.html#GUID-47BCD081-8FFF-4D13-A0B1-F531521BC6C3" title="Transaction Guard is an API that applications can use to provide transaction idempotence, which is the ability of the database to preserve a guaranteed commit outcome that indicates whether a transaction committed and completed. Oracle Database provides the API for JDBC thin, OCI, OCCI, and ODP.Net.">Overview of Transaction Guard</a></p>
                  </li>
                  <li>
                     <p><a href="transactions.html#GUID-0B463F72-73C9-4EB6-B98D-5EC828CDB1E7" title="Application Continuity attempts to mask outages from applications by replaying incomplete application requests after unplanned and planned outages. In this context, a request is a unit of work from the application.">Overview of Application Continuity</a></p>
                  </li>
                  <li>
                     <p><a href="transactions.html#GUID-C0C61571-5175-400D-AEFC-FDBFE4F87188" title="An autonomous transaction is an independent transaction that can be called from another transaction, which is the main transaction. You can suspend the calling transaction, perform SQL operations and commit or undo them in the autonomous transaction, and then resume the calling transaction.">Overview of Autonomous Transactions</a></p>
                  </li>
                  <li>
                     <p><a href="transactions.html#GUID-47231512-4A3E-4E59-86BD-332E1FB88A88" title="A distributed transaction is a transaction that includes one or more statements that update data on two or more distinct nodes of a distributed database, using a schema object called a database link.">Overview of Distributed Transactions</a></p>
                  </li>
               </ul>
            </div><a id="CNCPT117"></a><div class="props_rev_3"><a id="GUID-31319EA7-994C-4D25-8814-0214ABD3CBDA" name="GUID-31319EA7-994C-4D25-8814-0214ABD3CBDA"></a><h3 id="CNCPT-GUID-31319EA7-994C-4D25-8814-0214ABD3CBDA" class="sect3">Introduction to Transactions	</h3>
               <div>
                  <p>A <span class="bold">transaction</span> is a logical, atomic unit of work that contains one or more SQL statements. 
                  </p>
                  <p>A transaction groups SQL statements so that they are either all committed, which means they are applied to the database, or all rolled back, which means they are undone from the database. Oracle Database assigns every transaction a unique identifier called a <a href="glossary.html#GUID-71C31D71-F2E8-4FB9-9010-062C1C407CEF"><span class="xrefglossterm">transaction ID</span></a>.
                  </p>
                  <p>All Oracle transactions obey the basic properties of a database transaction, known as <a href="glossary.html#GUID-2684886B-AB0E-4F65-9B24-688511AED791"><span class="xrefglossterm">ACID properties</span></a>. ACID is an acronym for the following:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Atomicity</p>
                        <p>All tasks of a transaction are performed or none of them are. There are no partial transactions. For example, if a transaction starts updating 100 rows, but the system fails after 20 updates, then the database rolls back the changes to these 20 rows.</p>
                     </li>
                     <li>
                        <p>Consistency</p>
                        <p>The transaction takes the database from one consistent state to another consistent state. For example, in a banking transaction that debits a savings account and credits a checking account, a failure must not cause the database to credit only one account, which would lead to inconsistent data.</p>
                     </li>
                     <li>
                        <p>Isolation</p>
                        <p>The effect of a transaction is not visible to other transactions until the transaction is committed. For example, one user updating the <code class="codeph">hr.employees</code> table does not see the uncommitted changes to <code class="codeph">employees</code> made concurrently by another user. Thus, it appears to users as if transactions are executing serially.
                        </p>
                     </li>
                     <li>
                        <p>Durability</p>
                        <p>Changes made by committed transactions are permanent. After a transaction completes, the database ensures through its recovery mechanisms that changes from the transaction are not lost.</p>
                     </li>
                  </ul>
                  <p>The use of transactions is one of the most important ways that a database management system differs from a file system.</p>
               </div><a id="CNCPT88951"></a><a id="CNCPT037"></a><div class="props_rev_3"><a id="GUID-A049FE81-8B67-4386-B599-9CDD7E6B6C59" name="GUID-A049FE81-8B67-4386-B599-9CDD7E6B6C59"></a><h4 id="CNCPT-GUID-A049FE81-8B67-4386-B599-9CDD7E6B6C59" class="sect4">Sample Transaction: Account Debit and Credit</h4>
                  <div>
                     <p>To illustrate the concept of a transaction, consider a banking database. </p>
                     <p>When a customer transfers money from a savings account to a checking account, the transaction must consist of three separate operations:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Decrement the savings account</p>
                        </li>
                        <li>
                           <p>Increment the checking account</p>
                        </li>
                        <li>
                           <p>Record the transaction in the transaction journal</p>
                        </li>
                     </ul>
                     <p>Oracle Database must allow for two situations. If all three SQL statements maintain the accounts in proper balance, then the effects of the transaction can be applied to the database. However, if a problem such as insufficient funds, invalid account number, or a hardware failure prevents one or two of the statements in the transaction from completing, then the database must roll back the entire transaction so that the balance of all accounts is correct.</p>
                     <p>The following graphic illustrates a banking transaction. The first statement subtracts $500 from savings account 3209. The second statement adds $500 to checking account 3208. The third statement inserts a record of the transfer into the journal table. The final statement commits the transaction.</p>
                     <div class="figure" id="GUID-A049FE81-8B67-4386-B599-9CDD7E6B6C59__I974">
                        <p class="titleinfigure">Figure 10-1 A Banking Transaction</p><img src="img/cncpt025.gif" alt="Description of Figure 10-1 follows" title="Description of Figure 10-1 follows" longdesc="img_text/cncpt025.html"><br><a href="img_text/cncpt025.html">Description of "Figure 10-1 A Banking Transaction"</a></div>
                     <!-- class="figure" -->
                  </div>
               </div><a id="CNCPT038"></a><div class="props_rev_3"><a id="GUID-7690181F-8293-47B9-ADC1-905BD9C3AF57" name="GUID-7690181F-8293-47B9-ADC1-905BD9C3AF57"></a><h4 id="CNCPT-GUID-7690181F-8293-47B9-ADC1-905BD9C3AF57" class="sect4">Structure of a Transaction</h4>
                  <div>
                     <p>A database transaction consists of one or more statements.</p>
                     <p>Specifically, a transaction consists of one of the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>One or more data manipulation language (DML) statements that together constitute an atomic change to the database</p>
                        </li>
                        <li>
                           <p>One data definition language (DDL) statement</p>
                        </li>
                     </ul>
                     <p>A transaction has a beginning and an end.</p>
                     <div class="infoboxnotealso" id="GUID-7690181F-8293-47B9-ADC1-905BD9C3AF57__GUID-FA8AAADC-7384-4FF1-9D20-FDD1F0662E7E">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="sql.html#GUID-662EE4B0-7D5E-43F5-806D-A2AE404D77BF" title="All operations performed on the information in an Oracle database are run using SQL statements. A SQL statement is a computer program or instruction that consists of identifiers, parameters, variables, names, data types, and SQL reserved words.">Overview of SQL Statements</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/Types-of-SQL-Statements.html#SQLRF-GUID-E1749EF5-2264-44DF-99EF-AEBEB943BED6" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for an account of the types of SQL statements
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="CNCPT88952"></a><div class="props_rev_3"><a id="GUID-E3FB3DC3-3317-4589-BADD-D89A3547F87D" name="GUID-E3FB3DC3-3317-4589-BADD-D89A3547F87D"></a><h5 id="CNCPT-GUID-E3FB3DC3-3317-4589-BADD-D89A3547F87D" class="sect5">Beginning of a Transaction</h5>
                     <div>
                        <p>A transaction begins when the first executable SQL statement is encountered.</p>
                        <p>An <a href="glossary.html#GUID-2F2F02A4-2405-4A0A-ABAF-91DB48DD4B82"><span class="xrefglossterm">executable SQL statement</span></a> is a SQL statement that generates calls to a <a href="glossary.html#GUID-CFB1A30E-76B6-44EA-839E-9E63C8DA31AC"><span class="xrefglossterm">database instance</span></a>, including DML and DDL statements and the <code class="codeph">SET TRANSACTION</code> statement.
                        </p>
                        <p>When a transaction begins, Oracle Database assigns the transaction to an available <a href="glossary.html#GUID-297B963A-989C-4720-B061-A2352FF72892"><span class="xrefglossterm">undo data</span></a> segment to record the undo entries for the new transaction. A transaction ID is not allocated until an undo segment and <a href="glossary.html#GUID-BFF71130-2760-4C64-8829-7772C803FBE7"><span class="xrefglossterm">transaction table</span></a> slot are allocated, which occurs during the first DML statement. A transaction ID is unique to a transaction and represents the undo segment number, slot, and sequence number.
                        </p>
                        <p>The following example execute an <code class="codeph">UPDATE</code> statement to begin a transaction and queries <code class="codeph">V$TRANSACTION</code> for details about the transaction:
                        </p><pre class="pre codeblock"><code>SQL&gt; UPDATE hr.employees SET salary=salary; 

107 rows updated.
 
SQL&gt; SELECT XID AS "txn id", XIDUSN AS "undo seg", XIDSLOT AS "slot", 
  2  XIDSQN AS "seq", STATUS AS "txn status"
  3  FROM V$TRANSACTION;
 
txn id             undo seg       slot        seq txn status
---------------- ---------- ---------- ---------- ----------------
0600060037000000          6          6         55 ACTIVE</code></pre><div class="infoboxnotealso" id="GUID-E3FB3DC3-3317-4589-BADD-D89A3547F87D__GUID-A3625BA5-F209-4844-88DE-84C49CDBCFCF">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="logical-storage-structures.html#GUID-6E206D3A-E0E7-4B23-9C41-516FB35BC3FE" title="Oracle Database maintains records of the actions of transactions, collectively known as undo data.">Undo Segments</a>"</span></p>
                        </div>
                     </div>
                  </div><a id="CNCPT88953"></a><div class="props_rev_3"><a id="GUID-510DF997-BA9C-4431-95EF-A0622881EC9C" name="GUID-510DF997-BA9C-4431-95EF-A0622881EC9C"></a><h5 id="CNCPT-GUID-510DF997-BA9C-4431-95EF-A0622881EC9C" class="sect5">End of a Transaction</h5>
                     <div>
                        <p>A transaction can end under different circumstances.</p>
                        <p>A transaction ends when any of the following actions occurs: </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A user issues a <code class="codeph">COMMIT</code> or <code class="codeph">ROLLBACK</code> statement <span class="italic">without</span> a <code class="codeph">SAVEPOINT</code> clause.
                              </p>
                              <p>In a <a href="glossary.html#GUID-0680EB2C-ADF4-431A-A259-FB2227E5AA93"><span class="xrefglossterm">commit</span></a>, a user explicitly or implicitly requested that the changes in the transaction be made permanent. Changes made by the transaction are permanent and visible to other users only after a transaction commits.
                              </p>
                           </li>
                           <li>
                              <p>A user runs a DDL command such as <code class="codeph">CREATE</code>, <code class="codeph">DROP</code>, <code class="codeph">RENAME</code>, or <code class="codeph">ALTER</code>. 
                              </p>
                              <p>The database issues an implicit <code class="codeph">COMMIT</code> statement before and after every DDL statement. If the current transaction contains DML statements, then Oracle Database first commits the transaction and then runs and commits the DDL statement as a new, single-statement transaction.
                              </p>
                           </li>
                           <li>
                              <p>A user exits normally from most Oracle Database utilities and tools, causing the current transaction to be implicitly committed. The commit behavior when a user disconnects is application-dependent and configurable.</p>
                              <div class="infoboxnote" id="GUID-510DF997-BA9C-4431-95EF-A0622881EC9C__GUID-FE2BC2EA-ECED-4B0E-BAD7-B60F09830E6B">
                                 <p class="notep1">Note:</p>
                                 <p>Applications should always explicitly commit or undo transactions before program termination.</p>
                              </div>
                           </li>
                           <li>
                              <p>A client process terminates abnormally, causing the transaction to be implicitly rolled back using metadata stored in the transaction table and the undo segment.</p>
                           </li>
                        </ul>
                        <p>After one transaction ends, the next executable SQL statement automatically starts the following transaction. The following example executes an <code class="codeph">UPDATE</code> to start a transaction, ends the transaction with a <code class="codeph">ROLLBACK</code> statement, and then executes an <code class="codeph">UPDATE</code> to start a new transaction (note that the transaction IDs are different):
                        </p><pre class="pre codeblock"><code>SQL&gt; UPDATE hr.employees SET salary=salary; 
107 rows updated.
 
SQL&gt; SELECT XID, STATUS FROM V$TRANSACTION;
 
XID              STATUS
---------------- ----------------
0800090033000000 ACTIVE
 
SQL&gt; ROLLBACK;
 
Rollback complete.
 
SQL&gt; SELECT XID FROM V$TRANSACTION;
 
no rows selected
 
SQL&gt; UPDATE hr.employees SET last_name=last_name;
 
107 rows updated.
 
SQL&gt; SELECT XID, STATUS FROM V$TRANSACTION;
 
XID              STATUS
---------------- ----------------
0900050033000000 ACTIVE</code></pre><div class="infoboxnotealso" id="GUID-510DF997-BA9C-4431-95EF-A0622881EC9C__GUID-53EDFBB7-6436-4DB3-9CA6-617DFB9BA4F3">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="transactions.html#GUID-A049FE81-8B67-4386-B599-9CDD7E6B6C59" title="To illustrate the concept of a transaction, consider a banking database.">Sample Transaction: Account Debit and Credit</a>"</span> for an example of a transaction that ends with a commit.
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../sqlrf/COMMIT.html#SQLRF01110" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> to learn about <code class="codeph">COMMIT</code></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1115"></a><div class="props_rev_3"><a id="GUID-5A632477-AC9E-4BC7-BB06-26B64837BF90" name="GUID-5A632477-AC9E-4BC7-BB06-26B64837BF90"></a><h4 id="CNCPT-GUID-5A632477-AC9E-4BC7-BB06-26B64837BF90" class="sect4">Statement-Level Atomicity</h4>
                  <div>
                     <p>Oracle Database supports <strong class="term">statement-level atomicity</strong>, which means that a SQL statement is an atomic unit of work and either completely succeeds or completely fails.
                     </p>
                     <p>A successful statement is different from a committed transaction. A single SQL statement executes successfully if the database parses and runs it without error as an atomic unit, as when all rows are changed in a multirow update.</p>
                     <p>If a SQL statement causes an error during execution, then it is not successful and so all effects of the statement are rolled back. This operation is a <a href="glossary.html#GUID-187EACC0-1FDD-498A-BEAD-892AC03B50D0"><span class="xrefglossterm">statement-level rollback</span></a>. This operation has the following characteristics:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>A SQL statement that does not succeed causes the loss only of work it would have performed itself.</p>
                           <p>The unsuccessful statement does not cause the loss of any work that preceded it in the current transaction. For example, if the execution of the second <code class="codeph">UPDATE</code> statement in <span class="q">"<a href="transactions.html#GUID-A049FE81-8B67-4386-B599-9CDD7E6B6C59" title="To illustrate the concept of a transaction, consider a banking database.">Sample Transaction: Account Debit and Credit</a>"</span> causes an error and is rolled back, then the work performed by the first <code class="codeph">UPDATE</code> statement is not rolled back. The first <code class="codeph">UPDATE</code> statement can be committed or rolled back explicitly by the user.
                           </p>
                        </li>
                        <li>
                           <p>The effect of the rollback is as if the statement had never been run. </p>
                           <p>Any side effects of an atomic statement, for example, triggers invoked upon execution of the statement, are considered part of the atomic statement. Either all work generated as part of the atomic statement succeeds or none does.</p>
                        </li>
                     </ul>
                     <p>An example of an error causing a statement-level rollback is an attempt to insert a duplicate <a href="glossary.html#GUID-8640EFA5-276C-4812-A078-1F21F55F4200"><span class="xrefglossterm">primary key</span></a>. Single SQL statements involved in a <a href="glossary.html#GUID-E33D1853-7F99-4FDD-9CC7-D6308E943D61"><span class="xrefglossterm">deadlock</span></a>, which is competition for the same data, can also cause a statement-level rollback. However, errors discovered during SQL statement parsing, such as a syntax error, have not yet been run and so do not cause a statement-level rollback.
                     </p>
                     <div class="infoboxnotealso" id="GUID-5A632477-AC9E-4BC7-BB06-26B64837BF90__GUID-601E894B-FB32-4487-8EAF-8D2714D16083">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="sql.html#GUID-B3F2B5B8-B679-4A7C-B1E8-286F36319FCB" title="The first stage of SQL processing is SQL parsing. This stage involves separating the pieces of a SQL statement into a data structure that can be processed by other routines.">SQL Parsing</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="data-concurrency-and-consistency.html#GUID-C1971E9B-849A-4634-9575-4F8FAD697750" title="A deadlock is a situation in which two or more users are waiting for data locked by each other. Deadlocks prevent some transactions from continuing to work.">Locks and Deadlocks</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="server-side-programming.html#GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63" title="A database trigger is a compiled stored program unit, written in either PL/SQL or Java, that Oracle Database invokes ("fires") automatically in certain situations.">Overview of Triggers</a>"</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT039"></a><div class="props_rev_3"><a id="GUID-A2615547-94D2-4346-B156-64C534C5E9E4" name="GUID-A2615547-94D2-4346-B156-64C534C5E9E4"></a><h4 id="CNCPT-GUID-A2615547-94D2-4346-B156-64C534C5E9E4" class="sect4">System Change Numbers (SCNs)</h4>
                  <div>
                     <p>A <strong class="term">system change number (SCN)</strong> is a logical, internal time stamp used by Oracle Database.
                     </p>
                     <p>SCNs order events that occur within the database, which is necessary to satisfy the ACID properties of a transaction. Oracle Database uses SCNs to mark the SCN before which all changes are known to be on disk so that recovery avoids applying unnecessary redo. The database also uses SCNs to mark the point at which no redo exists for a set of data so that recovery can stop.</p>
                     <p>SCNs occur in a monotonically increasing sequence. Oracle Database can use an SCN like a clock because an observed SCN indicates a logical point in time, and repeated observations return equal or greater values. If one event has a lower SCN than another event, then it occurred at an earlier time in the database. Several events may share the same SCN, which means that they occurred at the same time in the database.</p>
                     <p>Every transaction has an SCN. For example, if a transaction updates a row, then the database records the SCN at which this update occurred. Other modifications in this transaction have the same SCN. When a transaction commits, the database records an SCN for this commit.</p>
                     <p>Oracle Database increments SCNs in the <a href="glossary.html#GUID-78C0E867-233A-4857-B9FE-A3852A9B7BDF"><span class="xrefglossterm">system global area (SGA)</span></a>. When a transaction modifies data, the database writes a new SCN to the undo data segment assigned to the transaction. The log writer process then writes the commit record of the transaction immediately to the <a href="glossary.html#GUID-2A8BC112-AB70-4B06-9F85-FE975861CEE0"><span class="xrefglossterm">online redo log</span></a>. The commit record has the unique SCN of the transaction. Oracle Database also uses SCNs as part of its <a href="glossary.html#GUID-FFDBC27D-CE99-49C7-8BB9-C8C2D8D52801"><span class="xrefglossterm">instance recovery</span></a> and <a href="glossary.html#GUID-938A3E7D-CC65-496C-9DB3-3CFC45AFA8DD"><span class="xrefglossterm">media recovery</span></a> mechanisms. 
                     </p>
                     <div class="infoboxnotealso" id="GUID-A2615547-94D2-4346-B156-64C534C5E9E4__GUID-F2FF6329-8DAD-4392-845D-8A832BFD50E8">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="oracle-database-instance.html#GUID-728C6BE1-5687-4DC5-B570-D2042C88F935" title="Instance recovery is the process of applying records in the online redo log to data files to reconstruct changes made after the most recent checkpoint.">Overview of Instance Recovery</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="concepts-for-database-administrators.html#GUID-DCE361D9-B486-43B4-B4FD-5722A93203F0" title="Backup and recovery is the set of concepts, procedures, and strategies involved in protecting the database against data loss caused by media failure or users errors. In general, the purpose of a backup and recovery strategy is to protect the database against data loss and reconstruct lost data.">Backup and Recovery</a>"</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT88954"></a><a id="CNCPT1118"></a><div class="props_rev_3"><a id="GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361" name="GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361"></a><h3 id="CNCPT-GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361" class="sect3">Overview of Transaction Control</h3>
               <div>
                  <p><span class="bold">Transaction control</span> is the management of changes made by DML statements and the grouping of DML statements into transactions. 
                  </p>
                  <p>In general, application designers are concerned with transaction control so that work is accomplished in logical units and data is kept consistent.</p>
                  <p>Transaction control involves using the following statements, as described in <span class="q">"<a href="sql.html#GUID-73F24816-881A-4849-B8A7-EA9B446A24A7" title="Transaction control statements manage the changes made by DML statements and group DML statements into transactions.">Transaction Control Statements</a>"</span>:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The <code class="codeph">COMMIT</code> statement ends the current transaction and makes all changes performed in the transaction permanent. <code class="codeph">COMMIT</code> also erases all savepoints in the transaction and releases transaction locks.
                        </p>
                     </li>
                     <li>
                        <p>The <code class="codeph">ROLLBACK</code> statement reverses the work done in the current transaction; it causes all data changes since the last <code class="codeph">COMMIT</code> or <code class="codeph">ROLLBACK</code> to be discarded. The <code class="codeph">ROLLBACK TO SAVEPOINT</code> statement undoes the changes since the last savepoint but does not end the entire transaction.
                        </p>
                     </li>
                     <li>
                        <p>The <code class="codeph">SAVEPOINT</code> statement identifies a point in a transaction to which you can later roll back.
                        </p>
                     </li>
                  </ul>
                  <p>The session in <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a> illustrates the basic concepts of transaction control.
                  </p>
                  <div class="tblformalwide" id="GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA">
                     <p class="titleintable">Table 10-1 Transaction Control</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="Transaction Control" summary="This table shows a session that illustrates the basic concepts of transaction control. " width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="5%" id="d53698e2712">T</th>
                              <th align="left" valign="bottom" width="45%" id="d53698e2715">Session</th>
                              <th align="left" valign="bottom" width="50%" id="d53698e2718">Explanation</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2723" headers="d53698e2712 ">
                                 <p>t0</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2723 d53698e2715 "><pre class="pre codeblock"><code>COMMIT;</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2723 d53698e2718 ">
                                 <p>This statement ends any existing transaction in the session.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2733" headers="d53698e2712 ">
                                 <p>t1</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2733 d53698e2715 "><pre class="pre codeblock"><code>SET TRANSACTION NAME 'sal_update';</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2733 d53698e2718 ">
                                 <p>This statement begins a transaction and names it <code class="codeph">sal_update</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2746" headers="d53698e2712 ">
                                 <p>t2</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2746 d53698e2715 "><pre class="pre codeblock"><code>UPDATE employees
    SET salary = 7000 
    WHERE last_name = 'Banda';</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2746 d53698e2718 ">
                                 <p>This statement updates the salary for Banda to 7000.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2756" headers="d53698e2712 ">
                                 <p>t3</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2756 d53698e2715 "><pre class="pre codeblock"><code>SAVEPOINT after_banda_sal;</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2756 d53698e2718 ">
                                 <p>This statement creates a savepoint named <code class="codeph">after_banda_sal</code>, enabling changes in this transaction to be rolled back to this point.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2769" headers="d53698e2712 ">
                                 <p>t4</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2769 d53698e2715 "><pre class="pre codeblock"><code>UPDATE employees
    SET salary = 12000 
    WHERE last_name = 'Greene';</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2769 d53698e2718 ">
                                 <p>This statement updates the salary for Greene to 12000.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2779" headers="d53698e2712 ">
                                 <p>t5</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2779 d53698e2715 "><pre class="pre codeblock"><code>SAVEPOINT after_greene_sal;</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2779 d53698e2718 ">
                                 <p>This statement creates a savepoint named <code class="codeph">after_greene_sal</code>, enabling changes in this transaction to be rolled back to this point.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2792" headers="d53698e2712 ">
                                 <p>t6</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2792 d53698e2715 "><pre class="pre codeblock"><code>ROLLBACK TO SAVEPOINT
    after_banda_sal;</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2792 d53698e2718 ">
                                 <p>This statement rolls back the transaction to t3, undoing the update to Greene's salary at t4. The <code class="codeph">sal_update</code> transaction has <span class="italic">not</span> ended.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2808" headers="d53698e2712 ">
                                 <p>t7</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2808 d53698e2715 "><pre class="pre codeblock"><code>UPDATE employees
    SET salary = 11000 
    WHERE last_name = 'Greene';</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2808 d53698e2718 ">
                                 <p>This statement updates the salary for Greene to 11000 in transaction <code class="codeph">sal_update</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2821" headers="d53698e2712 ">
                                 <p>t8</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2821 d53698e2715 "><pre class="pre codeblock"><code>ROLLBACK;</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2821 d53698e2718 ">
                                 <p>This statement rolls back all changes in transaction <code class="codeph">sal_update</code>, ending the transaction.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2834" headers="d53698e2712 ">
                                 <p>t9</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2834 d53698e2715 "><pre class="pre codeblock"><code>SET TRANSACTION NAME 'sal_update2';</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2834 d53698e2718 ">
                                 <p>This statement begins a new transaction in the session and names it <code class="codeph">sal_update2</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2847" headers="d53698e2712 ">
                                 <p>t10</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2847 d53698e2715 "><pre class="pre codeblock"><code>UPDATE employees
    SET salary = 7050 
    WHERE last_name = 'Banda';</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2847 d53698e2718 ">
                                 <p>This statement updates the salary for Banda to 7050.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2858" headers="d53698e2712 ">
                                 <p>t11</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2858 d53698e2715 "><pre class="pre codeblock"><code>UPDATE employees
    SET salary = 10950 
    WHERE last_name = 'Greene';</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2858 d53698e2718 ">
                                 <p>This statement updates the salary for Greene to 10950.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="5%" id="d53698e2868" headers="d53698e2712 ">
                                 <p>t12</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d53698e2868 d53698e2715 "><pre class="pre codeblock"><code>COMMIT;</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d53698e2868 d53698e2718 ">
                                 <p>This statement commits all changes made in transaction <code class="codeph">sal_update2</code>, ending the transaction. The commit guarantees that the changes are saved in the online redo log files.
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="infoboxnotealso" id="GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__GUID-047002A0-E2E5-44C1-8C97-7CCC9D5EBED0">
                     <p class="notep1">See Also:</p>
                     <p><a href="../sqlrf/Types-of-SQL-Statements.html#SQLRF30043" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> to learn about transaction control statements
                     </p>
                  </div>
               </div><a id="CNCPT1122"></a><div class="props_rev_3"><a id="GUID-0B3F11E3-5C3E-4BB4-9E13-E1EC07D3FD2B" name="GUID-0B3F11E3-5C3E-4BB4-9E13-E1EC07D3FD2B"></a><h4 id="CNCPT-GUID-0B3F11E3-5C3E-4BB4-9E13-E1EC07D3FD2B" class="sect4">Transaction Names</h4>
                  <div>
                     <p>A transaction name is an optional, user-specified tag that serves as a reminder of the work that the transaction is performing. You name a transaction with the <code class="codeph">SET TRANSACTION</code> <code class="codeph">...</code> <code class="codeph">NAME</code> statement, which if used must be first statement of the transaction.
                     </p>
                     <p> In <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a>, the first transaction was named <code class="codeph">sal_update</code> and the second was named <code class="codeph">sal_update2</code>.
                     </p>
                     <p>Transaction names provide the following advantages:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>It is easier to monitor long-running transactions and to resolve in-doubt distributed transactions.</p>
                        </li>
                        <li>
                           <p>You can view transaction names along with transaction IDs in applications. For example, a database administrator can view transaction names in Oracle Enterprise Manager (Enterprise Manager) when monitoring system activity.</p>
                        </li>
                        <li>
                           <p>The database writes transaction names to the transaction auditing redo record, so you can use LogMiner to search for a specific transaction in the redo log.</p>
                        </li>
                        <li>
                           <p>You can use transaction names to find a specific transaction in data dictionary views such as <code class="codeph">V$TRANSACTION</code>.
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-0B3F11E3-5C3E-4BB4-9E13-E1EC07D3FD2B__GUID-C5CD08B4-812B-40B4-89BB-25DFF035C285">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="concepts-for-database-administrators.html#GUID-BE08A8FA-501A-418E-AD32-3E42AE762026" title="Oracle Enterprise Manager (Enterprise Manager) is a web-based system management tool that provides management of Oracle databases, Exadata database machine, Fusion Middleware, Oracle applications, servers, storage, and non-Oracle hardware and software.">Oracle Enterprise Manager</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../refrn/V-TRANSACTION.html#REFRN30291" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about <code class="codeph">V$TRANSACTION</code></p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/SET-TRANSACTION.html#SQLRF01705" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> to learn about <code class="codeph">SET TRANSACTION</code></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT88955"></a><div class="props_rev_3"><a id="GUID-E34DAE8D-6632-4B41-948C-13AD8312410D" name="GUID-E34DAE8D-6632-4B41-948C-13AD8312410D"></a><h4 id="CNCPT-GUID-E34DAE8D-6632-4B41-948C-13AD8312410D" class="sect4">Active Transactions</h4>
                  <div>
                     <p>An <strong class="term">active transaction</strong> is one that has started but not yet committed or rolled back.
                     </p>
                     <p>In <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a>, the first statement to modify data in the <code class="codeph">sal_update</code> transaction is the update to Banda's salary. From the successful execution of this update until the <code class="codeph">ROLLBACK</code> statement ends the transaction, the <code class="codeph">sal_update</code> transaction is active.
                     </p>
                     <p>Data changes made by a transaction are temporary until the transaction is committed or rolled back. Before the transaction ends, the state of the data is as shown in the following table.</p>
                     <div class="tblformal" id="GUID-E34DAE8D-6632-4B41-948C-13AD8312410D__GUID-113A87B4-B7A1-4AED-B896-3304A37CD29F">
                        <p class="titleintable">Table 10-2 State of the Data Before the Transaction Ends</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="State of the Data Before the Transaction Ends" summary="This table describes the state of the data before a transaction ends" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d53698e3553">State</th>
                                 <th align="left" valign="bottom" id="d53698e3555">Description</th>
                                 <th align="left" valign="bottom" id="d53698e3557">To Learn More</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53698e3561" headers="d53698e3553 ">
                                    <p>Oracle Database has generated undo information in the SGA.</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53698e3561 d53698e3555 ">
                                    <p>The undo data contains the old data values changed by the SQL statements of the transaction.</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53698e3561 d53698e3557 ">
                                    <p><span class="q">"<a href="data-concurrency-and-consistency.html#GUID-432C4EDC-F7F2-467C-B85F-4E82D3D58A2F" title="The database provides a consistent result set for every query, guaranteeing data consistency, with no action by the user.">Read Consistency in the Read Committed Isolation Level</a>"</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53698e3576" headers="d53698e3553 ">
                                    <p>Oracle Database has generated redo in the online redo log buffer of the SGA. </p>
                                 </td>
                                 <td align="left" valign="top" headers="d53698e3576 d53698e3555 ">
                                    <p>The redo log record contains the change to the data block and the change to the undo block.</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53698e3576 d53698e3557 ">
                                    <p><span class="q">"<a href="memory-architecture.html#GUID-C2AD1BF6-A5AE-42E9-9677-0AA08126864B" title="The redo log buffer is a circular buffer in the SGA that stores redo entries describing changes made to the database.">Redo Log Buffer</a>"</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53698e3594" headers="d53698e3553 ">
                                    <p>Changes have been made to the database buffers of the SGA.</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53698e3594 d53698e3555 ">
                                    <p>The data changes for a committed transaction, stored in the database buffers of the SGA, are not necessarily written immediately to the data files by the <a href="glossary.html#GUID-C27AAA54-E60B-49BC-AB04-7B3848EBAFD6"><span class="xrefglossterm">database writer (DBW)</span></a>. The disk write can happen before or after the commit.
                                    </p>
                                 </td>
                                 <td align="left" valign="top" headers="d53698e3594 d53698e3557 ">
                                    <p><span class="q">"<a href="memory-architecture.html#GUID-4FF66585-E469-4631-9225-29D75594CD14" title="The database buffer cache, also called the buffer cache, is the memory area that stores copies of data blocks read from data files.">Database Buffer Cache</a>"</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53698e3618" headers="d53698e3553 ">
                                    <p>The rows affected by the data change are locked.</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53698e3618 d53698e3555 ">
                                    <p>Other users cannot change the data in the affected rows, nor can they see the uncommitted changes.</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53698e3618 d53698e3557 ">
                                    <p><span class="q">"<a href="data-concurrency-and-consistency.html#GUID-1D60EFCC-03F4-4A04-B099-1B4DE5D02C47" title="The database maintains several different types of locks, depending on the operation that acquired the lock.">Summary of Locking Behavior</a>"</span></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="CNCPT1121"></a><div class="props_rev_3"><a id="GUID-55081904-2D79-430B-9E37-D4127F0BBF7D" name="GUID-55081904-2D79-430B-9E37-D4127F0BBF7D"></a><h4 id="CNCPT-GUID-55081904-2D79-430B-9E37-D4127F0BBF7D" class="sect4">Savepoints</h4>
                  <div>
                     <p>A <span class="bold">savepoint</span> is a user-declared intermediate marker within the context of a transaction. 
                     </p>
                     <p>Internally, the savepoint marker resolves to an SCN. Savepoints divide a long transaction into smaller parts.</p>
                     <p>If you use savepoints in a long transaction, then you have the option later of rolling back work performed before the current point in the transaction but after a declared savepoint within the transaction. Thus, if you make an error, you do not need to resubmit every statement. <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a> creates savepoint <code class="codeph">after_banda_sal</code> so that the update to the Greene salary can be rolled back to this savepoint.
                     </p>
                  </div><a id="CNCPT88956"></a><div class="props_rev_3"><a id="GUID-D0B75614-4720-4586-9ABF-99E894FA68BD" name="GUID-D0B75614-4720-4586-9ABF-99E894FA68BD"></a><h5 id="CNCPT-GUID-D0B75614-4720-4586-9ABF-99E894FA68BD" class="sect5">Rollback to Savepoint</h5>
                     <div>
                        <p>A rollback to a savepoint in an uncommitted transaction means undoing any changes made after the specified savepoint, but it does not mean a rollback of the transaction itself. </p>
                        <p>When a transaction is rolled back to a savepoint, as when the <code class="codeph">ROLLBACK TO SAVEPOINT after_banda_sal</code> is run in <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a>, the following occurs:
                        </p>
                        <ol>
                           <li>
                              <p>Oracle Database rolls back only the statements run after the savepoint.</p>
                              <p>In <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a>, the <code class="codeph">ROLLBACK TO SAVEPOINT</code> causes the <code class="codeph">UPDATE</code> for Greene to be rolled back, but not the <code class="codeph">UPDATE</code> for Banda.
                              </p>
                           </li>
                           <li>
                              <p>Oracle Database preserves the savepoint specified in the <code class="codeph">ROLLBACK TO SAVEPOINT</code> statement, but all subsequent savepoints are lost.
                              </p>
                              <p>In <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a>, the <code class="codeph">ROLLBACK TO SAVEPOINT</code> causes the <code class="codeph">after_greene_sal</code> savepoint to be lost.
                              </p>
                           </li>
                           <li>
                              <p>Oracle Database releases all table and row locks acquired after the specified savepoint but retains all data locks acquired before the savepoint.</p>
                           </li>
                        </ol>
                        <p>The transaction remains active and can be continued.</p>
                        <div class="infoboxnotealso" id="GUID-D0B75614-4720-4586-9ABF-99E894FA68BD__GUID-9F3FEA8F-4C01-43B4-BE0C-5B854CBFDA13">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../sqlrf/ROLLBACK.html#SQLRF01610" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> to learn about the <code class="codeph">ROLLBACK</code> and <code class="codeph">SAVEPOINT</code> statements
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../lnpls/static-sql.html#LNPLS00608" target="_blank"><span><cite>Oracle Database PL/SQL Language Reference</cite></span></a> to learn about transaction processing and control
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT88958"></a><a id="CNCPT88957"></a><div class="props_rev_3"><a id="GUID-07517D95-D5F9-4851-B737-B076336CED13" name="GUID-07517D95-D5F9-4851-B737-B076336CED13"></a><h5 id="CNCPT-GUID-07517D95-D5F9-4851-B737-B076336CED13" class="sect5">Enqueued Transactions</h5>
                     <div>
                        <p>Depending on the scenario, transactions waiting for previously locked resources may still be blocked after a rollback to savepoint. </p>
                        <p>When a transaction is blocked by another transaction it enqueues on the blocking transaction itself, so that the entire blocking transaction must commit or roll back for the blocked transaction to continue.</p>
                        <p>In the scenario shown in the following table, session 1 rolls back to a savepoint created before it executed a DML statement. However, session 2 is still blocked because it is waiting for the session 1 transaction to complete.</p>
                        <div class="tblformalwide" id="GUID-07517D95-D5F9-4851-B737-B076336CED13__CHDGIIFB">
                           <p class="titleintable">Table 10-3 Rollback to Savepoint Example</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="Rollback to Savepoint Example" summary="This table shows an extended example showing a rollback to savepoint." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="5%" id="d53698e4573">T</th>
                                    <th align="left" valign="bottom" width="24%" id="d53698e4576">Session 1</th>
                                    <th align="left" valign="bottom" width="24%" id="d53698e4579">Session 2</th>
                                    <th align="left" valign="bottom" width="24%" id="d53698e4582">Session 3</th>
                                    <th align="left" valign="bottom" width="22%" id="d53698e4585">Explanation</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="5%" id="d53698e4590" headers="d53698e4573 ">
                                       <p>t0</p>
                                    </td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4590 d53698e4576 "><pre class="oac_no_warn" dir="ltr">UPDATE employees 
  SET salary=7000 
  WHERE last_name= 
  'Banda';</pre></td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4590 d53698e4579 ">&nbsp;</td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4590 d53698e4582 ">&nbsp;</td>
                                    <td align="left" valign="top" width="22%" headers="d53698e4590 d53698e4585 ">
                                       <p>Session 1 begins a transaction. The session places an exclusive lock on the <code class="codeph">Banda</code> row (TX) and a subexclusive table lock (SX) on the table.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="5%" id="d53698e4605" headers="d53698e4573 ">
                                       <p>t1</p>
                                    </td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4605 d53698e4576 "><pre class="oac_no_warn" dir="ltr">SAVEPOINT 
 after_banda_sal;</pre></td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4605 d53698e4579 ">&nbsp;</td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4605 d53698e4582 ">&nbsp;</td>
                                    <td align="left" valign="top" width="22%" headers="d53698e4605 d53698e4585 ">
                                       <p>Session 1 creates a savepoint named <code class="codeph">after_banda_sal</code>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="5%" id="d53698e4620" headers="d53698e4573 ">
                                       <p>t2</p>
                                    </td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4620 d53698e4576 "><pre class="oac_no_warn" dir="ltr">UPDATE employees 
 SET salary=12000 
 WHERE last_name=  
 'Greene';</pre></td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4620 d53698e4579 ">&nbsp;</td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4620 d53698e4582 ">&nbsp;</td>
                                    <td align="left" valign="top" width="22%" headers="d53698e4620 d53698e4585 ">
                                       <p>Session 1 locks the <code class="codeph">Greene</code> row.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="5%" id="d53698e4635" headers="d53698e4573 ">
                                       <p>t3</p>
                                    </td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4635 d53698e4576 ">&nbsp;</td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4635 d53698e4579 "><pre class="oac_no_warn" dir="ltr">UPDATE employees 
 SET salary=14000 
 WHERE last_name=
 'Greene';</pre></td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4635 d53698e4582 ">&nbsp;</td>
                                    <td align="left" valign="top" width="22%" headers="d53698e4635 d53698e4585 ">
                                       <p>Session 2 attempts to update the <code class="codeph">Greene</code> row, but fails to acquire a lock because session 1 has a lock on this row. No transaction has begun in session 2.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="5%" id="d53698e4650" headers="d53698e4573 ">
                                       <p>t4</p>
                                    </td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4650 d53698e4576 "><pre class="oac_no_warn" dir="ltr">ROLLBACK
 TO SAVEPOINT 
 after_banda_sal;</pre></td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4650 d53698e4579 ">&nbsp;</td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4650 d53698e4582 ">&nbsp;</td>
                                    <td align="left" valign="top" width="22%" headers="d53698e4650 d53698e4585 ">
                                       <p>Session 1 rolls back the update to the salary for <code class="codeph">Greene</code>, which releases the row lock for <code class="codeph">Greene</code>. The table lock acquired at t0 is not released.
                                       </p>
                                       <p>At this point, session 2 is <span class="italic">still</span> blocked by session 1 because session 2 enqueues on the session 1 <span class="italic">transaction</span>, which has not yet completed.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="5%" id="d53698e4676" headers="d53698e4573 ">
                                       <p>t5</p>
                                    </td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4676 d53698e4576 ">&nbsp;</td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4676 d53698e4579 ">&nbsp;</td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4676 d53698e4582 "><pre class="oac_no_warn" dir="ltr">UPDATE employees 
 SET salary=11000
 WHERE last_name=
 'Greene';</pre></td>
                                    <td align="left" valign="top" width="22%" headers="d53698e4676 d53698e4585 ">
                                       <p>The <code class="codeph">Greene</code> row is currently unlocked, so session 3 acquires a lock for an update to the <code class="codeph">Greene</code> row. This statement begins a transaction in session 3.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="5%" id="d53698e4694" headers="d53698e4573 ">
                                       <p>t6</p>
                                    </td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4694 d53698e4576 "><pre class="oac_no_warn" dir="ltr">COMMIT;</pre></td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4694 d53698e4579 ">&nbsp;</td>
                                    <td align="left" valign="top" width="24%" headers="d53698e4694 d53698e4582 ">&nbsp;</td>
                                    <td align="left" valign="top" width="22%" headers="d53698e4694 d53698e4585 ">
                                       <p>Session 1 commits, ending its transaction. Session 2 is now enqueued for its update to the <code class="codeph">Greene</code> row behind the transaction in session 3.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnotealso" id="GUID-07517D95-D5F9-4851-B737-B076336CED13__GUID-4082A562-5884-4A65-BDD6-49719B340308">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="data-concurrency-and-consistency.html#GUID-DB33AD91-8A4E-44CE-A6B2-654909143E5F" title="Oracle Database automatically releases a lock when some event occurs so that the transaction no longer requires the resource.">Lock Duration</a>"</span> to learn more about when Oracle Database releases locks
                           </p>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1120"></a><div class="props_rev_3"><a id="GUID-C289D507-93F1-412E-8AAC-C9B758212CEC" name="GUID-C289D507-93F1-412E-8AAC-C9B758212CEC"></a><h4 id="CNCPT-GUID-C289D507-93F1-412E-8AAC-C9B758212CEC" class="sect4">Rollback of Transactions</h4>
                  <div>
                     <p>A rollback of an uncommitted transaction undoes any changes to data that have been performed by SQL statements within the transaction. </p>
                     <p>After a transaction has been rolled back, the effects of the work done in the transaction no longer exist. In rolling back an entire transaction, without referencing any savepoints, Oracle Database performs the following actions:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Undoes all changes made by all the SQL statements in the transaction by using the corresponding undo segments</p>
                           <p>The transaction table entry for every active transaction contains a pointer to all the undo data (in reverse order of application) for the transaction. The database reads the data from the undo segment, reverses the operation, and then marks the undo entry as applied. Thus, if a transaction inserts a row, then a rollback deletes it. If a transaction updates a row, then a rollback reverses the update. If a transaction deletes a row, then a rollback reinserts it. In <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a>, the <code class="codeph">ROLLBACK</code> reverses the updates to the salaries of Greene and Banda.
                           </p>
                        </li>
                        <li>
                           <p>Releases all the locks of data held by the transaction</p>
                        </li>
                        <li>
                           <p>Erases all savepoints in the transaction</p>
                           <p>In <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a>, the <code class="codeph">ROLLBACK</code> deletes the savepoint <code class="codeph">after_banda_sal</code>. The <code class="codeph">after_greene_sal</code> savepoint was removed by the <code class="codeph">ROLLBACK TO SAVEPOINT</code> statement.
                           </p>
                        </li>
                        <li>
                           <p>Ends the transaction</p>
                           <p>In <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a>, the <code class="codeph">ROLLBACK</code> leaves the database in the same state as it was after the initial <code class="codeph">COMMIT</code> was executed.
                           </p>
                        </li>
                     </ul>
                     <p>The duration of a rollback is a function of the amount of data modified.</p>
                     <div class="infoboxnotealso" id="GUID-C289D507-93F1-412E-8AAC-C9B758212CEC__GUID-62DA8A3D-986C-4F05-BBDF-72E42830532E">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="logical-storage-structures.html#GUID-6E206D3A-E0E7-4B23-9C41-516FB35BC3FE" title="Oracle Database maintains records of the actions of transactions, collectively known as undo data.">Undo Segments</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/ROLLBACK.html#GUID-94551F0C-A47F-43DE-BC68-9B1C1ED38C93" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> to learn about the <code class="codeph">ROLLBACK</code> command
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT1119"></a><div class="props_rev_3"><a id="GUID-C3FE1082-94AA-4BE8-98F2-480205D99DCA" name="GUID-C3FE1082-94AA-4BE8-98F2-480205D99DCA"></a><h4 id="CNCPT-GUID-C3FE1082-94AA-4BE8-98F2-480205D99DCA" class="sect4">Commits of Transactions</h4>
                  <div>
                     <p>A commit ends the current transaction and makes permanent all changes performed in the transaction.</p>
                     <p>In <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a>, a second transaction begins with <code class="codeph">sal_update2</code> and ends with an explicit <code class="codeph">COMMIT</code> statement. The changes that resulted from the two <code class="codeph">UPDATE</code> statements are now made permanent.
                     </p>
                     <p>When a transaction commits, the following actions occur: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The database generates an SCN for the <code class="codeph">COMMIT</code>. 
                           </p>
                           <p>The internal transaction table for the associated <a href="glossary.html#GUID-78A7FBF2-2EB5-4BD6-AECC-D61A5AEF1158"><span class="xrefglossterm">undo tablespace</span></a> records that the transaction has committed. The corresponding unique SCN of the transaction is assigned and recorded in the transaction table.
                           </p>
                        </li>
                        <li>
                           <p>The <a href="glossary.html#GUID-E96BC851-0B78-4250-8EAB-26EBDF4FE5A6"><span class="xrefglossterm">log writer process (LGWR)</span></a> process writes remaining redo log entries in the redo log buffers to the online redo log and writes the transaction SCN to the online redo log. <span class="italic">This atomic event constitutes the commit of the transaction.</span></p>
                        </li>
                        <li>
                           <p>Oracle Database releases locks held on rows and tables.</p>
                           <p>Users who were enqueued waiting on locks held by the uncommitted transaction are allowed to proceed with their work.</p>
                        </li>
                        <li>
                           <p>Oracle Database deletes savepoints.</p>
                           <p>In <a href="transactions.html#GUID-5BB15405-8A03-47DE-8A20-63E1B83E1361__CHDCIJGA" title="This table shows a session that illustrates the basic concepts of transaction control.">Table 10-1</a>, no savepoints existed in the <code class="codeph">sal_update</code> transaction so no savepoints were erased.
                           </p>
                        </li>
                        <li>
                           <p>Oracle Database performs a <a href="glossary.html#GUID-5E20E19B-FC72-40E3-A129-306B52DC9607"><span class="xrefglossterm">commit cleanout</span></a>.
                           </p>
                           <p>If modified blocks containing data from the committed transaction are still in the SGA, and if no other session is modifying them, then the database removes lock-related transaction information (the ITL entry) from the blocks. </p>
                           <p>Ideally, the <code class="codeph">COMMIT</code> cleans the blocks so that a subsequent <code class="codeph">SELECT</code> does not have to perform this task. If no ITL entry exists for a specific row, then it is not locked. If an ITL entry exists for a specific row, then it is possibly locked, so a session must check the undo segment header to determine whether this interested transaction has committed. If the interested transaction has committed, then the session cleans out the block, which generates redo. However, if the <code class="codeph">COMMIT</code> cleaned out the ITL previously, then the check and cleanout are unnecessary.
                           </p>
                           <div class="infoboxnote" id="GUID-C3FE1082-94AA-4BE8-98F2-480205D99DCA__GUID-26D30903-DFCE-48DD-BA67-9895B3BFB233">
                              <p class="notep1">Note:</p>
                              <p>Because a block cleanout generates redo, a query may generate redo and thus cause blocks to be written during the next <a href="glossary.html#GUID-95DBDA37-4C57-444F-B660-D52B4A99D919"><span class="xrefglossterm">checkpoint</span></a>. 
                              </p>
                           </div>
                        </li>
                        <li>
                           <p>Oracle Database marks the transaction complete.</p>
                        </li>
                     </ul>
                     <p>After a transaction commits, users can view the changes.</p>
                     <p>Typically, a commit is a fast operation, regardless of the transaction size. The speed of a commit does not increase with the size of the data modified in the transaction. The lengthiest part of the commit is the physical disk I/O performed by LGWR. However, the amount of time spent by LGWR is reduced because it has been incrementally writing the contents of the redo log buffer in the background.</p>
                     <p>The default behavior is for LGWR to write redo to the online redo log synchronously and for transactions to wait for the buffered redo to be on disk before returning a commit to the user. However, for lower transaction commit latency, application developers can specify that redo be written asynchronously so that transactions need not wait for the redo to be on disk and can return from the <code class="codeph">COMMIT</code> call immediately.
                     </p>
                     <div class="infoboxnotealso" id="GUID-C3FE1082-94AA-4BE8-98F2-480205D99DCA__GUID-5FA0B3EF-8402-42EF-9FDB-676602149DDF">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="data-concurrency-and-consistency.html#GUID-8DA9A191-4CA3-4B1A-995F-4B17471C2738" title="In the serializable isolation level, a transaction sees only changes committed at the time the transaction—not the query—began and changes made by the transaction itself.">Serializable Isolation Level</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="data-concurrency-and-consistency.html#GUID-AD960556-7F7B-4242-8B91-6DA22AABA27D" title="In general, multiuser databases use some form of data locking to solve the problems associated with data concurrency, consistency, and integrity.">Locking Mechanisms</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="process-architecture.html#GUID-D8AE1B78-69D5-4F0F-8BE3-C91AA2514F2D" title="Background processes are additional processes used by a multiprocess Oracle database. The background processes perform maintenance tasks required to operate the database and to maximize performance for multiple users.">Overview of Background Processes</a>"</span> for more information about LGWR
                              </p>
                           </li>
                           <li>
                              <p><a href="../lnpls/static-sql.html#LNPLS592" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information on asynchronous commit
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT89217"></a><div class="props_rev_3"><a id="GUID-47BCD081-8FFF-4D13-A0B1-F531521BC6C3" name="GUID-47BCD081-8FFF-4D13-A0B1-F531521BC6C3"></a><h3 id="CNCPT-GUID-47BCD081-8FFF-4D13-A0B1-F531521BC6C3" class="sect3">Overview of Transaction Guard</h3>
               <div>
                  <p><strong class="term">Transaction Guard</strong> is an API that applications can use to provide <strong class="term">transaction idempotence</strong>, which is the ability of the database to preserve a guaranteed commit outcome that indicates whether a transaction committed and completed. Oracle Database provides the API for JDBC thin, OCI, OCCI, and ODP.Net.
                  </p>
                  <p>A <a href="glossary.html#GUID-2F7DE61F-BD7C-4A89-91E6-CE0D193E8294"><span class="xrefglossterm">recoverable error</span></a> is caused by an external system failure, independent of the application session logic that is executing. Recoverable errors occur following planned and unplanned outages of foreground processes, networks, nodes, storage, and databases. If an outage breaks the connection between a client application and the database, then the application receives a disconnection error message. The transaction that was running when the connection broke is called an <a href="glossary.html#GUID-4A49C543-CD3B-4F01-BF01-21F15CEABEE1"><span class="xrefglossterm">in-flight transaction</span></a>.
                  </p>
                  <p>To decide whether to resubmit the transaction or to return the result (committed or uncommitted) to the client, the application must determine the outcome of the in-flight transaction. Before <span>Oracle Database 12c</span>, commit messages returned to the client were not persistent. Checking a transaction was no guarantee that it would not commit after being checked, permitting duplicate transactions and other forms of logical corruption. For example, a user might refresh a web browser when purchasing a book online and be charged twice for the same book.
                  </p>
                  <div class="infoboxnotealso" id="GUID-47BCD081-8FFF-4D13-A0B1-F531521BC6C3__GUID-43A398FD-1438-4ADC-90BF-9293420ADFFC">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="transactions.html#GUID-31319EA7-994C-4D25-8814-0214ABD3CBDA" title="A transaction is a logical, atomic unit of work that contains one or more SQL statements.">Introduction to Transactions</a>"</span></p>
                        </li>
                        <li>
                           <p><a href="../adfns/transaction-guard.html#ADFNS1062" target="_blank"><span><cite>Oracle Database Development Guide</cite></span></a> to learn about Transaction Guard
                           </p>
                        </li>
                        <li>
                           <p><a href="../racad/ensuring-application-continuity.html#RACAD8423" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> to learn how to configure services for Transaction Guard
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="CNCPT89319"></a><div class="props_rev_3"><a id="GUID-DDABC6A2-4CFC-4934-8294-BC44772BC5BC" name="GUID-DDABC6A2-4CFC-4934-8294-BC44772BC5BC"></a><h4 id="CNCPT-GUID-DDABC6A2-4CFC-4934-8294-BC44772BC5BC" class="sect4">Benefits of Transaction Guard</h4>
                  <div>
                     <p>Starting in <span>Oracle Database 12c</span>, Transaction Guard provides applications with a tool for determining the status of an in-flight transaction following a recoverable outage.
                     </p>
                     <p>Using Transaction Guard, an application can ensure that a transaction executes no more than once. For example, if an online bookstore application determines that the previously submitted commit failed, then the application can safely resubmit.</p>
                     <p>Transaction Guard provides a tool for at-most-once execution to avoid the application executing duplicate submissions. Transaction Guard provides a known outcome for every transaction.</p>
                     <p>Transaction Guard is a core Oracle Database capability. Application Continuity uses Transaction Guard when masking outages from end users. Without Transaction Guard, an application retrying after an error may cause duplicate transactions to be committed.</p>
                     <div class="infoboxnotealso" id="GUID-DDABC6A2-4CFC-4934-8294-BC44772BC5BC__GUID-38F71CC2-49CD-4EF0-B459-2755C76B2724">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="transactions.html#GUID-0B463F72-73C9-4EB6-B98D-5EC828CDB1E7" title="Application Continuity attempts to mask outages from applications by replaying incomplete application requests after unplanned and planned outages. In this context, a request is a unit of work from the application.">Overview of Application Continuity</a>"</span> to learn about Application Continuity, which works with Transaction Guard to help developers achieve high application availability
                              </p>
                           </li>
                           <li>
                              <p><a href="../adfns/high-availability.html#ADFNS924" target="_blank"><span><cite>Oracle Database Development Guide</cite></span></a> to learn about Transaction Guard, including the types of supported and included transactions
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT89320"></a><div class="props_rev_3"><a id="GUID-BB758CA1-B046-463E-969F-69C3E87E5DAF" name="GUID-BB758CA1-B046-463E-969F-69C3E87E5DAF"></a><h4 id="CNCPT-GUID-BB758CA1-B046-463E-969F-69C3E87E5DAF" class="sect4">How Transaction Guard Works</h4>
                  <div>
                     <p>This section explains the problem of lost commit messages and how Transaction Guard uses logical transaction IDs to solve the problem.</p>
                  </div><a id="CNCPT89219"></a><a id="CNCPT89218"></a><div class="props_rev_3"><a id="GUID-E567DC50-32EC-440E-9352-18E8AD79340B" name="GUID-E567DC50-32EC-440E-9352-18E8AD79340B"></a><h5 id="CNCPT-GUID-E567DC50-32EC-440E-9352-18E8AD79340B" class="sect5">Lost Commit Messages</h5>
                     <div>
                        <p>When designing for idempotence, developers must address the problem of communication failures after submission of commit statements. Commit messages do not persist in the database and so cannot be retrieved after a failure.</p>
                        <p>The following graphic is a high-level representation of an interaction between a client application and a database.</p>
                        <div class="figure" id="GUID-E567DC50-32EC-440E-9352-18E8AD79340B__CIHEHJGB">
                           <p class="titleinfigure">Figure 10-2 Lost Commit Message</p><img src="img/cncpt356.png" alt="Description of Figure 10-2 follows" title="Description of Figure 10-2 follows" longdesc="img_text/cncpt356.html"><br><a href="img_text/cncpt356.html">Description of "Figure 10-2 Lost Commit Message"</a></div>
                        <!-- class="figure" -->
                        <p>In the standard commit case, the database commits a transaction and returns a success message to the client. In <a href="transactions.html#GUID-E567DC50-32EC-440E-9352-18E8AD79340B__CIHEHJGB">Figure 10-2</a>, the client submits a commit statement and receives a message stating that communication failed. This type of failure can occur for several reasons, including a database instance failure or network outage. In this scenario, the client does not know the state of the transaction.
                        </p>
                        <p>Following a communication failure, the database may still be running the submission and be unaware that the client disconnected. Checking the transaction state does not guarantee that an active transaction will not commit after being checked. If the client resends the commit because of this out-of-date information, then the database may repeat the transaction, resulting in logical corruption.</p>
                     </div>
                  </div><a id="CNCPT89220"></a><div class="props_rev_3"><a id="GUID-10F207C2-C59A-4707-A9A0-BDA3B19DE8D3" name="GUID-10F207C2-C59A-4707-A9A0-BDA3B19DE8D3"></a><h5 id="CNCPT-GUID-10F207C2-C59A-4707-A9A0-BDA3B19DE8D3" class="sect5">Logical Transaction ID</h5>
                     <div>
                        <p>Oracle Database solves the communication failure by using a globally unique identifier called a <span class="bold">logical transaction ID</span>. 
                        </p>
                        <p>This ID contains the logical session number allocated when a session first connects, and a running commit number that is updated each time the session commits or rolls back.<a id="fn_1" name="fn_1" href="#fn_1" onclick="footdisplay(1, "For Oracle Real Application Clusters (Oracle RAC), the logical transaction ID includes the database instance number as a prefix.")"><sup>Foot&nbsp;1</sup></a> From the application perspective, the logical transaction ID uniquely identifies the last database transaction submitted on the session that failed.
                        </p>
                        <p>For each round trip from the client in which one or more transactions are committed, the database stores a logical transaction ID. This ID can provide transaction idempotence for interactions between the application and the database for each round trip that commits data.</p>
                        <p>The at-most-once protocol enables access to the commit outcome by requiring the database to do the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Maintain the logical transaction ID for the retention period agreed for retry</p>
                           </li>
                           <li>
                              <p>Persist the logical transaction ID on commit</p>
                           </li>
                        </ul>
                        <p>While a transaction is running, both the database and client hold the logical transaction ID. The database gives the client a logical transaction ID at authentication, when borrowing from a connection pool, and at each round trip from the client driver that executes one or more commit operations.</p>
                        <p>Before the application can determine the outcome of the last transaction following a recoverable error, the application obtains the logical transaction ID held at the client using Java, OCI, OCCI, or ODP.Net APIs. The application then invokes the PL/SQL procedure <code class="codeph">DBMS_APP_CONT.GET_LTXID_OUTCOME</code> with the logical transaction ID to determine the outcome of the last submission: committed (<code class="codeph">true</code> or <code class="codeph">false</code>) and user call completed (<code class="codeph">true</code> or <code class="codeph">false</code>).
                        </p>
                        <p>When using Transaction Guard, the application can replay transactions when the error is recoverable and the last transaction on the session has not committed. The application can continue when the last transaction has committed and the user call has completed. The application can use Transaction Guard to return the known outcome to the client so that the client can decide the next action to take.</p>
                        <div class="infoboxnotealso" id="GUID-10F207C2-C59A-4707-A9A0-BDA3B19DE8D3__GUID-6116E843-6CE2-47FA-B081-0B0C4CCC5707">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../adfns/transaction-guard.html#ADFNS324" target="_blank"><span><cite>Oracle Database Development Guide</cite></span></a> to learn about logical transaction IDs
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_APP_CONT.html#ARPLS73456" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about the <code class="codeph">DBMS_APP_CONT.GET_LTXID_OUTCOME</code> procedure
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT89221"></a><a id="CNCPT89321"></a><div class="props_rev_3"><a id="GUID-6AEE7250-D39B-4DB7-BF71-E2C1841BF598" name="GUID-6AEE7250-D39B-4DB7-BF71-E2C1841BF598"></a><h4 id="CNCPT-GUID-6AEE7250-D39B-4DB7-BF71-E2C1841BF598" class="sect4">Transaction Guard: Example</h4>
                  <div>
                     <p>In this scenario, the commit message is lost because of a recoverable error.</p>
                     <p>Transaction Guard uses the logical transaction ID to preserve the outcome of the <code class="codeph">COMMIT</code> statement, ensuring that there is a known outcome for the transaction.
                     </p>
                     <div class="figure" id="GUID-6AEE7250-D39B-4DB7-BF71-E2C1841BF598__CIHGGHBA">
                        <p class="titleinfigure">Figure 10-3 Check of Logical Transaction Status</p><img src="img/cncpt365.png" alt="Description of Figure 10-3 follows" title="Description of Figure 10-3 follows" longdesc="img_text/cncpt365.html"><br><a href="img_text/cncpt365.html">Description of "Figure 10-3 Check of Logical Transaction Status"</a></div>
                     <!-- class="figure" -->
                     <p>In <a href="transactions.html#GUID-6AEE7250-D39B-4DB7-BF71-E2C1841BF598__CIHGGHBA">Figure 10-3</a>, the database informs the application whether the transaction committed and whether the last user call completed. The application can then return the result to the end user. The possibilities are:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>If the transaction committed and the user call completed, then the application can return the result to the end user and continue.</p>
                        </li>
                        <li>
                           <p>If the transaction committed but the user call did not complete, then the application can return the result to the end user with warnings. Examples include a lost out bind or lost number of rows processed. Some applications depend on the extra information, whereas others do not.</p>
                        </li>
                        <li>
                           <p>If the user call was not committed, then the application can return this information to the end user, or safely resubmit. The protocol is guaranteed. When the commit status returns false, the last submission is blocked from committing.</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-6AEE7250-D39B-4DB7-BF71-E2C1841BF598__GUID-C73C378A-C218-4717-9792-9EC257CE4A23">
                        <p class="notep1">See Also:</p>
                        <p><a href="../adfns/transaction-guard.html#ADFNS8000" target="_blank"><span><cite>Oracle Database Development Guide</cite></span></a> to learn how to use Transaction Guard
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT89322"></a><div class="props_rev_3"><a id="GUID-0B463F72-73C9-4EB6-B98D-5EC828CDB1E7" name="GUID-0B463F72-73C9-4EB6-B98D-5EC828CDB1E7"></a><h3 id="CNCPT-GUID-0B463F72-73C9-4EB6-B98D-5EC828CDB1E7" class="sect3">Overview of Application Continuity</h3>
               <div>
                  <p><span class="bold">Application Continuity</span> attempts to mask outages from applications by replaying incomplete application requests after unplanned and planned outages. In this context, a request is a unit of work from the application. 
                  </p>
                  <p>Typically, a request corresponds to the DML statements and other database calls of a single web request on a single database connection. In general, a request is demarcated by the calls made between check-out and check-in of a database connection from a connection pool.</p>
                  <p>This section contains the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="transactions.html#GUID-0B2F6AD0-92ED-431D-BEB6-10DFC3715FCC" title="A basic problem for developers is how to mask a lost database session from end users.">Benefits of Application Continuity</a></p>
                     </li>
                     <li>
                        <p><a href="transactions.html#GUID-2E973242-2B39-42FC-AA16-CD97B460B6D2" title="The key components of Application Continuity are runtime, reconnection, and replay.">Application Continuity Architecture</a></p>
                     </li>
                  </ul>
               </div><a id="CNCPT89323"></a><div class="props_rev_3"><a id="GUID-0B2F6AD0-92ED-431D-BEB6-10DFC3715FCC" name="GUID-0B2F6AD0-92ED-431D-BEB6-10DFC3715FCC"></a><h4 id="CNCPT-GUID-0B2F6AD0-92ED-431D-BEB6-10DFC3715FCC" class="sect4">Benefits of Application Continuity</h4>
                  <div>
                     <p>A basic problem for developers is how to mask a lost database session from end users. </p>
                     <p>Application Continuity attempts to solve the lost session problem by restoring the database session when any component disrupts the conversation between database and client. The restored database session includes all states, cursors, variables, and the most recent transaction when one exists.</p>
                  </div>
                  <div class="props_rev_3"><a id="GUID-C9064A61-CB65-463B-89D6-66AB18F55845" name="GUID-C9064A61-CB65-463B-89D6-66AB18F55845"></a><h5 id="CNCPT-GUID-C9064A61-CB65-463B-89D6-66AB18F55845" class="sect5">Use Case for Application Continuity</h5>
                     <div>
                        <p>In a typical case, a client has submitted a request to the database, which has built up both transactional and nontransactional states. </p>
                        <p>The state at the client remains current, potentially with entered data, returned data, and cached data and variables. However, the database session state, which the application needs to operate within, is lost.</p>
                        <p>If the client request has initiated one or more transactions, then the application is faced with the following possibilities:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If a commit <span class="italic">has</span> been issued, then the commit message returned to the client is not durable. The client does not know whether the request committed, and where in the nontransactional processing state it reached.
                              </p>
                           </li>
                           <li>
                              <p>If a commit has <span class="italic">not</span> been issued, or if it was issued but did not execute, then the in-flight transaction is rolled back and must be resubmitted using a session in the correct state.
                              </p>
                           </li>
                        </ul>
                        <p>If the replay is successful, then database user service for planned and unplanned outages is not interrupted. If the database detects changes in the data seen and potentially acted on by the application, then the replay is rejected. Replay is not attempted when the time allowed for starting replay is exceeded, the application uses a restricted call, or the application has explicitly disabled replay using the <code class="codeph">disableReplay</code> method.
                        </p>
                        <div class="infoboxnotealso" id="GUID-C9064A61-CB65-463B-89D6-66AB18F55845__GUID-33A601A4-B4A2-4AA6-98D3-761603DB514E">
                           <p class="notep1">See Also:</p>
                           <p><a href="../racad/ensuring-application-continuity.html#GUID-70D9CDC4-0C86-432B-A04E-1618AF5C35A4" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> to learn more about how Application Continuity works for database sessions
                           </p>
                        </div>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-9D9947D6-99E9-4862-84A4-1D8676695BC6" name="GUID-9D9947D6-99E9-4862-84A4-1D8676695BC6"></a><h5 id="CNCPT-GUID-9D9947D6-99E9-4862-84A4-1D8676695BC6" class="sect5">Application Continuity for Planned Maintenance</h5>
                     <div>
                        <p>Application Continuity for planned outages enables applications to continue operations for database sessions that can be reliably drained or migrated.</p>
                        <p>Scheduled maintenance need not disrupt application work. Application Continuity gives active work time to drain from its current location to a new location currently unaffected by maintenance. At the end of the drain interval, sessions may remain on the database instance where maintenance is planned. Instead of forcibly disconnecting these sessions, Application Continuity can fail over these sessions to a surviving site, and resubmit any in-flight transactions.</p>
                        <p> With Application Continuity enabled the database can do the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Report no errors for either incoming or existing work during maintenance</p>
                           </li>
                           <li>
                              <p>Redirect active database sessions to other functional services</p>
                           </li>
                           <li>
                              <p>Rebalance database sessions, as needed, during and after the maintenance</p>
                           </li>
                        </ul>
                        <p>Control the drain behavior during planned maintenance using the <code class="codeph">drain_timeout</code> and <code class="codeph">stop_option</code> service attributes of the SRVCTL utility, Global Data Services Control Utility (GDSCTL), and Oracle Data Guard Broker. The <code class="codeph">DBMS_SERVICE</code> package provides the underlying infrastructure.
                        </p>
                        <div class="infoboxnotealso" id="GUID-9D9947D6-99E9-4862-84A4-1D8676695BC6__GUID-33A601A4-B4A2-4AA6-98D3-761603DB514E">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../racad/ensuring-application-continuity.html#GUID-BD699AEB-9F85-42A8-8687-5A979918938D" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> to learn more Application Continuity
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../arpls/index.html" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about <code class="codeph">DBMS_SERVICE</code></p>
                              </li>
                              <li>
                                 <p><a href="../racad/server-control-utility-reference.html#RACAD-GUID-C2D37BAB-DA98-49B4-A777-F2B3AA8D2E7A" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> for the SRVCTL command reference
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../gsmug/global-data-services-config.html#GSMUG-GUID-77AC1ABB-9401-4ECB-B31D-60C46D405595" target="_blank"><span><cite>Oracle Database Global Data Services Concepts and Administration Guide</cite></span></a> for the GDSCTL command reference
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT89325"></a><a id="CNCPT89324"></a><div class="props_rev_3"><a id="GUID-2E973242-2B39-42FC-AA16-CD97B460B6D2" name="GUID-2E973242-2B39-42FC-AA16-CD97B460B6D2"></a><h4 id="CNCPT-GUID-2E973242-2B39-42FC-AA16-CD97B460B6D2" class="sect4">Application Continuity Architecture</h4>
                  <div>
                     <p>The key components of Application Continuity are runtime, reconnection, and replay.</p>
                     <p>The phases are as follows:</p>
                     <ol>
                        <li>
                           <p>Normal runtime</p>
                           <p>In this phase, Application Continuity performs the following tasks:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Identifies database requests</p>
                              </li>
                              <li>
                                 <p>Decides whether local and database calls are replayable</p>
                              </li>
                              <li>
                                 <p>Builds proxy objects to enable replay, if necessary, and to manage queues</p>
                              </li>
                              <li>
                                 <p>Holds original calls and validation of these calls until the end of the database request or replay is disabled</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>Reconnection</p>
                           <p>This phase is triggered by a recoverable error. Application Continuity performs the following tasks:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Ensures that replay is enabled for the database requests</p>
                              </li>
                              <li>
                                 <p>Manages timeouts</p>
                              </li>
                              <li>
                                 <p>Obtains a new connection to the database, and then validates that this is a valid database target</p>
                              </li>
                              <li>
                                 <p>Uses Transaction Guard to determine whether the last transaction committed successfully (committed transactions are not resubmitted)</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>Replay</p>
                           <p>Application Continuity performs the following tasks:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Replays calls that are held in the queue</p>
                              </li>
                              <li>
                                 <p>Disables replay if user-visible changes in results appear during the replay</p>
                              </li>
                              <li>
                                 <p>Does not allow a commit, but does allow the last recall (which encountered the error) to commit</p>
                              </li>
                           </ul>
                        </li>
                     </ol>
                     <p>Following a successful replay, the request continues from the point of failure.</p>
                     <div class="infoboxnotealso" id="GUID-2E973242-2B39-42FC-AA16-CD97B460B6D2__GUID-FEF124B5-3D23-4397-B025-393E3F4127A5">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="transactions.html#GUID-47BCD081-8FFF-4D13-A0B1-F531521BC6C3" title="Transaction Guard is an API that applications can use to provide transaction idempotence, which is the ability of the database to preserve a guaranteed commit outcome that indicates whether a transaction committed and completed. Oracle Database provides the API for JDBC thin, OCI, OCCI, and ODP.Net.">Overview of Transaction Guard</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../racad/ensuring-application-continuity.html#GUID-91427DA2-2C5F-46E9-93D4-B5FF6427A69B" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> to learn more about Application Continuity
                              </p>
                           </li>
                           <li>
                              <p><a href="../jjdbc/application-continuity.html#JJDBC29059" target="_blank"><span class="italic">Oracle Database JDBC Developer's Guide</span></a> and <a href="../jajdb/index.html" target="_blank"><span class="italic">Oracle Database JDBC Java API Reference</span></a> to learn more about JDBC and Application Continuity
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT88959"></a><a id="CNCPT417"></a><div class="props_rev_3"><a id="GUID-C0C61571-5175-400D-AEFC-FDBFE4F87188" name="GUID-C0C61571-5175-400D-AEFC-FDBFE4F87188"></a><h3 id="CNCPT-GUID-C0C61571-5175-400D-AEFC-FDBFE4F87188" class="sect3">Overview of Autonomous Transactions</h3>
               <div>
                  <p>An <span class="bold">autonomous transaction</span> is an independent transaction that can be called from another transaction, which is the main transaction. You can suspend the calling transaction, perform SQL operations and commit or undo them in the autonomous transaction, and then resume the calling transaction.
                  </p>
                  <p>Autonomous transactions are useful for actions that must be performed independently, regardless of whether the calling transaction commits or rolls back. For example, in a stock purchase transaction, you want to commit customer data regardless of whether the overall stock purchase goes through. Additionally, you want to log error messages to a debug table even if the overall transaction rolls back.</p>
                  <p>Autonomous transactions have the following characteristics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The autonomous transaction does not see uncommitted changes made by the main transaction and does not share locks or resources with the main transaction.</p>
                     </li>
                     <li>
                        <p>Changes in an autonomous transaction are visible to other transactions upon commit of the autonomous transactions. Thus, users can access the updated information without having to wait for the main transaction to commit.</p>
                     </li>
                     <li>
                        <p>Autonomous transactions can start other autonomous transactions. There are no limits, other than resource limits, on how many levels of autonomous transactions can be called.</p>
                     </li>
                  </ul>
                  <p>In PL/SQL, an autonomous transaction executes within an <span class="italic">autonomous scope</span>, which is a routine marked with the pragma <code class="codeph">AUTONOMOUS_TRANSACTION</code>. In this context, routines include top-level anonymous PL/SQL blocks and PL/SQL subprograms and triggers. A <a href="glossary.html#GUID-0ED5CC20-407D-42A1-AF92-8816691861DE"><span class="xrefglossterm">pragma</span></a> is a directive that instructs the compiler to perform a compilation option. The pragma <code class="codeph">AUTONOMOUS_TRANSACTION</code> instructs the database that this procedure, when executed, is to be executed as a new autonomous transaction that is independent of its parent transaction.
                  </p>
                  <p>The following graphic shows how control flows from the main routine (MT) to an autonomous routine and back again. The main routine is <code class="codeph">proc1</code> and the autonomous routine is <code class="codeph">proc2</code>. The autonomous routine can commit multiple transactions (AT1 and AT2) before control returns to the main routine.
                  </p>
                  <div class="figure" id="GUID-C0C61571-5175-400D-AEFC-FDBFE4F87188__CHDDGDCJ">
                     <p class="titleinfigure">Figure 10-4 Transaction Control Flow</p><img src="img/cncpt288.gif" alt="Description of Figure 10-4 follows" title="Description of Figure 10-4 follows" longdesc="img_text/cncpt288.html"><br><a href="img_text/cncpt288.html">Description of "Figure 10-4 Transaction Control Flow"</a></div>
                  <!-- class="figure" -->
                  <p>When you enter the executable section of an autonomous routine, the main routine suspends. When you exit the autonomous routine, the main routine resumes.</p>
                  <p>In <a href="transactions.html#GUID-C0C61571-5175-400D-AEFC-FDBFE4F87188__CHDDGDCJ">Figure 10-4</a>, the <code class="codeph">COMMIT</code> inside <code class="codeph">proc1</code> makes permanent not only its own work but any outstanding work performed in its session. However, a <code class="codeph">COMMIT</code> in <code class="codeph">proc2</code> makes permanent only the work performed in the <code class="codeph">proc2</code> transaction. Thus, the <code class="codeph">COMMIT</code> statements in transactions AT1 and AT2 have no effect on the MT transaction.
                  </p>
                  <div class="infoboxnotealso" id="GUID-C0C61571-5175-400D-AEFC-FDBFE4F87188__GUID-63C487E4-2F98-469C-AB0F-032499AB7EC3">
                     <p class="notep1">See Also:</p>
                     <p><a href="../adfns/sql-processing-for-application-developers.html#ADFNS00205" target="_blank"><span><cite>Oracle Database Development Guide</cite></span></a> and <a href="../lnpls/static-sql.html#LNPLS00609" target="_blank"><span><cite>Oracle Database PL/SQL Language Reference</cite></span></a> to learn how to use autonomous transactions
                     </p>
                  </div>
               </div>
            </div><a id="CNCPT1125"></a><div class="props_rev_3"><a id="GUID-47231512-4A3E-4E59-86BD-332E1FB88A88" name="GUID-47231512-4A3E-4E59-86BD-332E1FB88A88"></a><h3 id="CNCPT-GUID-47231512-4A3E-4E59-86BD-332E1FB88A88" class="sect3">Overview of Distributed Transactions</h3>
               <div>
                  <p>A <strong class="term">distributed transaction</strong> is a transaction that includes one or more statements that update data on two or more distinct nodes of a distributed database, using a schema object called a database link.
                  </p>
                  <p>A <a href="glossary.html#GUID-DB7296DF-74E0-45E1-9BC2-5052DD543214"><span class="xrefglossterm">distributed database</span></a> is a set of databases in a distributed system that can appear to applications as a single data source. A <a href="glossary.html#GUID-1C8C6E07-BE1F-4BC9-93C3-CF6D1D15DC42"><span class="xrefglossterm">database link</span></a> describes how one database instance can log in to another database instance.
                  </p>
                  <p>Unlike a transaction on a local database, a distributed transaction alters data on multiple databases. Consequently, distributed transaction processing is more complicated because the database must coordinate the committing or rolling back of the changes in a transaction as an atomic unit. The entire transaction must commit or roll back. Oracle Database must coordinate transaction control over a network and maintain data consistency, even if a network or system failure occurs.</p>
                  <div class="infoboxnotealso" id="GUID-47231512-4A3E-4E59-86BD-332E1FB88A88__GUID-150122D2-6DFE-469A-88F4-FEAC2131BC02">
                     <p class="notep1">See Also:</p>
                     <p><a href="../admin/distributed-transactions-concepts.html#ADMIN031" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> to learn how to manage distributed transactions
                     </p>
                  </div>
               </div><a id="CNCPT041"></a><div class="props_rev_3"><a id="GUID-0F0E4F21-1522-449C-9532-DD26AB9EECA1" name="GUID-0F0E4F21-1522-449C-9532-DD26AB9EECA1"></a><h4 id="CNCPT-GUID-0F0E4F21-1522-449C-9532-DD26AB9EECA1" class="sect4">Two-Phase Commit</h4>
                  <div>
                     <p>The <strong class="term">two-phase commit mechanism</strong> guarantees that <span class="italic">all</span> databases participating in a distributed transaction either all commit or all undo the statements in the transaction. The mechanism also protects implicit DML performed by integrity constraints, remote procedure calls, and triggers.
                     </p>
                     <p>In a two-phase commit among multiple databases, one database coordinates the distributed transaction. The initiating node is called the <span class="italic">global coordinator</span>. The coordinator asks the other databases if they are prepared to commit. If any database responds with a no, then the entire transaction is rolled back. If all databases vote yes, then the coordinator broadcasts a message to make the commit permanent on each of the databases.
                     </p>
                     <p>The two-phase commit mechanism is transparent to users who issue distributed transactions. In fact, users need not even know the transaction is distributed. A <code class="codeph">COMMIT</code> statement denoting the end of a transaction automatically triggers the two-phase commit mechanism. No coding or complex statement syntax is required to include distributed transactions within the body of a database application.
                     </p>
                     <div class="infoboxnotealso" id="GUID-0F0E4F21-1522-449C-9532-DD26AB9EECA1__GUID-10839962-C13A-48BA-88DC-484BCE26E684">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../admin/distributed-transactions-concepts.html#ADMIN12222" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> to learn about the two-phase commit mechanism
                              </p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/COMMIT.html#GUID-6CD5C9A7-54B9-4FA2-BA3C-D6B4492B9EE2" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT042"></a><div class="props_rev_3"><a id="GUID-20FEB719-8BB3-49C3-834E-E0FF156BB681" name="GUID-20FEB719-8BB3-49C3-834E-E0FF156BB681"></a><h4 id="CNCPT-GUID-20FEB719-8BB3-49C3-834E-E0FF156BB681" class="sect4">In-Doubt Transactions</h4>
                  <div>
                     <p>An <span class="bold">in-doubt distributed transaction</span> occurs when a two-phase commit was interrupted by any type of system or network failure.
                     </p>
                     <p>For example, two databases report to the coordinating database that they were prepared to commit, but the coordinating database instance fails immediately after receiving the messages. The two databases who are prepared to commit are now left hanging while they await notification of the outcome.</p>
                     <p>The recoverer (<code class="codeph">RECO</code>) background process automatically resolves the outcome of in-doubt distributed transactions. After the failure is repaired and communication is reestablished, the <code class="codeph">RECO</code> process of each local Oracle database automatically commits or rolls back any in-doubt distributed transactions consistently on all involved nodes.
                     </p>
                     <p>In the event of a long-term failure, Oracle Database enables each local administrator to manually commit or undo any distributed transactions that are in doubt because of the failure. This option enables the local database administrator to free any locked resources that are held indefinitely because of the long-term failure.</p>
                     <p>If a database must be recovered to a past time, then database recovery facilities enable database administrators at other sites to return their databases to the earlier point in time. This operation ensures that the global database remains consistent.</p>
                     <div class="infoboxnotealso" id="GUID-20FEB719-8BB3-49C3-834E-E0FF156BB681__GUID-8AD9A053-0233-458E-B9DD-5DA4F472EA20">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="process-architecture.html#GUID-9FF900D1-7DB8-4D41-8D34-8E99AF650CEC" title="In a distributed database, the recoverer process (RECO) automatically resolves failures in distributed transactions.">Recoverer Process (RECO)</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../admin/managing-distributed-transactions.html#ADMIN12252" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> to learn how to manage in-doubt transactions
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
            <hr><br><p style="text-decoration:underline">Footnote Legend</p>Footnote&nbsp;1: 
            <p>For Oracle Real Application Clusters (Oracle RAC), the logical transaction ID includes the database instance number as a prefix.</p><br></div>
      </article>
   </body>
</html>