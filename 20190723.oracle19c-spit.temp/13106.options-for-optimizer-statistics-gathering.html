<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter explains what optimizer statistics collection is and how to set statistics preferences.">
      <meta name="description" content="This chapter explains what optimizer statistics collection is and how to set statistics preferences.">
      <title>Configuring Options for Optimizer Statistics Gathering</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Tuning Guide">
      <meta property="og:description" content="This chapter explains what optimizer statistics collection is and how to set statistics preferences.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Tuning Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-tuning-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-31T14:57:08-08:00">
      <meta name="dcterms.title" content="SQL Tuning Guide">
      <meta name="dcterms.dateCopyrighted" content="2013, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96095-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="histograms.html" title="Previous" type="text/html">
      <link rel="next" href="gathering-optimizer-statistics.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGSQL">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="histograms.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="gathering-optimizer-statistics.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Tuning Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="optimizer-statistics.html" property="item" typeof="WebPage"><span property="name">Optimizer Statistics</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Configuring Options for Optimizer Statistics Gathering</li>
            </ol>
            <a id="GUID-2044960C-025B-44FC-9522-63F426C74386" name="GUID-2044960C-025B-44FC-9522-63F426C74386"></a>
            
            <h2 id="TGSQL-GUID-2044960C-025B-44FC-9522-63F426C74386" class="sect2"><span class="enumeration_chapter">12 </span>Configuring Options for Optimizer Statistics Gathering
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter explains what optimizer statistics collection is and how to set statistics preferences.</p>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-3B795407-2E23-4612-B243-52701799F0B0">About Optimizer Statistics Collection</a><br>In Oracle Database, <strong class="term">optimizer statistics collection</strong> is the gathering of optimizer statistics for database objects, including fixed objects. 
                  </li>
                  <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-4FDDBCB2-1DA1-4697-9F07-5AB7DE01D682">Setting Optimizer Statistics Preferences</a><br>This topic explains how to set optimizer statistics defaults using <code class="codeph">DBMS_STATS.SET_*_PREFS</code> procedures.
                  </li>
                  <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-F1C666DC-5450-4F92-83AA-607327DB5FD8">Configuring Options for Dynamic Statistics</a><br><strong class="term">Dynamic statistics</strong> are an optimization technique in which the database uses recursive SQL to scan a small random sample of the blocks in a table.
                  </li>
                  <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E">Managing SQL Plan Directives</a><br>A <span class="bold">SQL plan directive</span> is additional information and instructions that the optimizer can use to generate a more optimal plan. 
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="optimizer-statistics.html#GUID-0A2F3D52-A135-43E1-9CAB-55BFE068A297" title="The accuracy of an execution plan depends on the quality of the optimizer statistics.">Optimizer Statistics</a></p>
                  </div>
               </div>
            </div>
            <a id="TGSQL390"></a><div class="props_rev_3"><a id="GUID-3B795407-2E23-4612-B243-52701799F0B0" name="GUID-3B795407-2E23-4612-B243-52701799F0B0"></a><h3 id="TGSQL-GUID-3B795407-2E23-4612-B243-52701799F0B0" class="sect3"><span class="enumeration_section">12.1 </span>About Optimizer Statistics Collection
               </h3>
               <div>
                  <p>In Oracle Database, <strong class="term">optimizer statistics collection</strong> is the gathering of optimizer statistics for database objects, including fixed objects. 
                  </p>
                  <p>The database can collect optimizer statistics automatically. You can also collect them manually using the <code class="codeph">DBMS_STATS</code> package.
                  </p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-212B6999-D190-4B00-BE30-D7830B3D8499">Purpose of Optimizer Statistics Collection</a><br>The contents of tables and associated indexes change frequently, which can lead the optimizer to choose suboptimal execution plan for queries. To avoid potential performance issues, statistics must be kept current.
                     </li>
                     <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-F3E7DF77-30DF-4639-98A3-788ACF3032F7">User Interfaces for Optimizer Statistics Management</a><br>You can manage optimizer statistics either through Oracle Enterprise Manager Cloud Control (Cloud Control) or using PL/SQL on the command line.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-2044960C-025B-44FC-9522-63F426C74386" title="This chapter explains what optimizer statistics collection is and how to set statistics preferences.">Configuring Options for Optimizer Statistics Gathering</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL94582"></a><div class="props_rev_3"><a id="GUID-212B6999-D190-4B00-BE30-D7830B3D8499" name="GUID-212B6999-D190-4B00-BE30-D7830B3D8499"></a><h4 id="TGSQL-GUID-212B6999-D190-4B00-BE30-D7830B3D8499" class="sect4"><span class="enumeration_section">12.1.1 </span>Purpose of Optimizer Statistics Collection
                  </h4>
                  <div>
                     <p>The contents of tables and associated indexes change frequently, which can lead the optimizer to choose suboptimal execution plan for queries. To avoid potential performance issues, statistics must be kept current.</p>
                     <p>To minimize DBA involvement, Oracle Database automatically gathers optimizer statistics at various times. Some automatic options are configurable, such enabling AutoTask to run <code class="codeph">DBMS_STATS</code>.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-3B795407-2E23-4612-B243-52701799F0B0" title="In Oracle Database, optimizer statistics collection is the gathering of optimizer statistics for database objects, including fixed objects.">About Optimizer Statistics Collection</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL391"></a><div class="props_rev_3"><a id="GUID-F3E7DF77-30DF-4639-98A3-788ACF3032F7" name="GUID-F3E7DF77-30DF-4639-98A3-788ACF3032F7"></a><h4 id="TGSQL-GUID-F3E7DF77-30DF-4639-98A3-788ACF3032F7" class="sect4"><span class="enumeration_section">12.1.2 </span>User Interfaces for Optimizer Statistics Management
                  </h4>
                  <div>
                     <p>You can manage optimizer statistics either through Oracle Enterprise Manager Cloud Control (Cloud Control) or using PL/SQL on the command line.</p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-7D050AB3-B3E6-4318-B9AC-B0D751131CD3">Graphical Interface for Optimizer Statistics Management</a><br>The Manage Optimizer Statistics page in Cloud Control is a GUI that enables you to manage optimizer statistics.
                        </li>
                        <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-476BA982-0543-4B4D-84C7-8123D6174E1F">Command-Line Interface for Optimizer Statistics Management</a><br>The <code class="codeph">DBMS_STATS</code> package performs most optimizer statistics tasks. 
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-3B795407-2E23-4612-B243-52701799F0B0" title="In Oracle Database, optimizer statistics collection is the gathering of optimizer statistics for database objects, including fixed objects.">About Optimizer Statistics Collection</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="TGSQL392"></a><div class="props_rev_3"><a id="GUID-7D050AB3-B3E6-4318-B9AC-B0D751131CD3" name="GUID-7D050AB3-B3E6-4318-B9AC-B0D751131CD3"></a><h5 id="TGSQL-GUID-7D050AB3-B3E6-4318-B9AC-B0D751131CD3" class="sect5"><span class="enumeration_section">12.1.2.1 </span>Graphical Interface for Optimizer Statistics Management
                     </h5>
                     <div>
                        <p>The Manage Optimizer Statistics page in Cloud Control is a GUI that enables you to manage optimizer statistics.</p>
                        <p>This section contains the following topics:</p>
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-15511441-3164-4233-A0F8-54A8DF44AC6D">Accessing the Database Home Page in Cloud Control</a><br>Oracle Enterprise Manager Cloud Control enables you to manage multiple databases within a single GUI-based framework.
                           </li>
                           <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-360B47CD-4CE0-4336-8637-FD90A16F2830">Accessing the Optimizer Statistics Console</a><br>You can perform most necessary tasks relating to optimizer statistics through pages linked to by the Optimizer Statistics Console page.
                           </li>
                        </ul>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-F3E7DF77-30DF-4639-98A3-788ACF3032F7" title="You can manage optimizer statistics either through Oracle Enterprise Manager Cloud Control (Cloud Control) or using PL/SQL on the command line.">User Interfaces for Optimizer Statistics Management</a></p>
                           </div>
                        </div>
                     </div>
                     <a id="TGSQL94917"></a><div class="props_rev_3"><a id="GUID-15511441-3164-4233-A0F8-54A8DF44AC6D" name="GUID-15511441-3164-4233-A0F8-54A8DF44AC6D"></a><h6 id="TGSQL-GUID-15511441-3164-4233-A0F8-54A8DF44AC6D" class="sect6"><span class="enumeration_section">12.1.2.1.1 </span>Accessing the Database Home Page in Cloud Control
                        </h6>
                        <div>
                           <p>Oracle Enterprise Manager Cloud Control enables you to manage multiple databases within a single GUI-based framework.</p>
                           <div class="section">
                              <p class="subhead3" id="GUID-15511441-3164-4233-A0F8-54A8DF44AC6D__GUID-8CABBC92-0224-4D55-9803-A6AE521AFC7D">To access a database home page using Cloud Control:</p>
                              <ol>
                                 <li>
                                    <p>Log in to Cloud Control with the appropriate credentials.</p>
                                 </li>
                                 <li>
                                    <p>Under the <span class="bold">Targets</span> menu, select <span class="bold">Databases</span>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>In the list of database targets, select the target for the Oracle Database instance that you want to administer.</p>
                                 </li>
                                 <li>
                                    <p>If prompted for database credentials, then enter the minimum credentials necessary for the tasks you intend to perform.</p>
                                 </li>
                              </ol>
                           </div>
                           <!-- class="section" -->
                        </div>
                        <div>
                           <div class="infoboxnotealso" id="GUID-15511441-3164-4233-A0F8-54A8DF44AC6D__GUID-2A854074-E945-4F93-8CE8-069D7B990D92">
                              <p class="notep1">See Also:</p>
                              <p>Cloud Control online help</p>
                           </div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-7D050AB3-B3E6-4318-B9AC-B0D751131CD3" title="The Manage Optimizer Statistics page in Cloud Control is a GUI that enables you to manage optimizer statistics.">Graphical Interface for Optimizer Statistics Management</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="TGSQL393"></a><div class="props_rev_3"><a id="GUID-360B47CD-4CE0-4336-8637-FD90A16F2830" name="GUID-360B47CD-4CE0-4336-8637-FD90A16F2830"></a><h6 id="TGSQL-GUID-360B47CD-4CE0-4336-8637-FD90A16F2830" class="sect6"><span class="enumeration_section">12.1.2.1.2 </span>Accessing the Optimizer Statistics Console
                        </h6>
                        <div>
                           <p>You can perform most necessary tasks relating to optimizer statistics through pages linked to by the Optimizer Statistics Console page.</p>
                           <div class="section">
                              <p class="subhead3" id="GUID-360B47CD-4CE0-4336-8637-FD90A16F2830__GUID-E7F664E9-767A-4B71-8A5C-A845B1EDD1D5">To manage optimizer statistics using Cloud Control:</p>
                              <ol>
                                 <li id="GUID-360B47CD-4CE0-4336-8637-FD90A16F2830__d5e1470">
                                    <p>In Cloud Control, access the <span>Database Home</span> page.
                                    </p>
                                 </li>
                                 <li id="GUID-360B47CD-4CE0-4336-8637-FD90A16F2830__d5e1476">
                                    <p>From the <span class="bold">Performance</span> menu, select <span class="bold">SQL</span>, then <span class="bold">Optimizer Statistics</span>.
                                    </p>
                                    <p>The Optimizer Statistics Console appears.</p>
                                 </li>
                              </ol>
                           </div>
                           <!-- class="section" -->
                        </div>
                        <div>
                           <div class="infoboxnotealso" id="GUID-360B47CD-4CE0-4336-8637-FD90A16F2830__GUID-7422A963-293D-431A-9B81-735C0F0630F7">
                              <p class="notep1">See Also:</p>
                              <p>Online Help for Oracle Enterprise Manager Cloud Control</p>
                           </div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-7D050AB3-B3E6-4318-B9AC-B0D751131CD3" title="The Manage Optimizer Statistics page in Cloud Control is a GUI that enables you to manage optimizer statistics.">Graphical Interface for Optimizer Statistics Management</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div>
                  </div><a id="TGSQL394"></a><div class="props_rev_3"><a id="GUID-476BA982-0543-4B4D-84C7-8123D6174E1F" name="GUID-476BA982-0543-4B4D-84C7-8123D6174E1F"></a><h5 id="TGSQL-GUID-476BA982-0543-4B4D-84C7-8123D6174E1F" class="sect5"><span class="enumeration_section">12.1.2.2 </span>Command-Line Interface for Optimizer Statistics Management
                     </h5>
                     <div>
                        <p>The <code class="codeph">DBMS_STATS</code> package performs most optimizer statistics tasks. 
                        </p>
                        <p>To enable and disable automatic statistics gathering, use the <code class="codeph">DBMS_AUTO_TASK_ADMIN</code> PL/SQL package.
                        </p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-476BA982-0543-4B4D-84C7-8123D6174E1F__GUID-DF378729-C6B6-4695-AD36-A4BB99DD530E">
                           <p class="notep1">See Also:</p>
                           <p><a href="../arpls/DBMS_AUTO_TASK_ADMIN.html#ARPLS-GUID-8CD58D39-436B-4642-BAEB-00C651DE8A8F" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn how to use <code class="codeph">DBMS_STATS</code> and <code class="codeph">DBMS_AUTO_TASK_ADMIN</code></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-F3E7DF77-30DF-4639-98A3-788ACF3032F7" title="You can manage optimizer statistics either through Oracle Enterprise Manager Cloud Control (Cloud Control) or using PL/SQL on the command line.">User Interfaces for Optimizer Statistics Management</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="TGSQL398"></a><div class="props_rev_3"><a id="GUID-4FDDBCB2-1DA1-4697-9F07-5AB7DE01D682" name="GUID-4FDDBCB2-1DA1-4697-9F07-5AB7DE01D682"></a><h3 id="TGSQL-GUID-4FDDBCB2-1DA1-4697-9F07-5AB7DE01D682" class="sect3"><span class="enumeration_section">12.2 </span>Setting Optimizer Statistics Preferences
               </h3>
               <div>
                  <p>This topic explains how to set optimizer statistics defaults using <code class="codeph">DBMS_STATS.SET_*_PREFS</code> procedures.
                  </p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-E798E1F6-FC85-456E-8F38-99534BE74492">About Optimizer Statistics Preferences</a><br>The <strong class="term">optimizer statistics preferences</strong> set the default values of the parameters used by automatic statistics collection and the <code class="codeph">DBMS_STATS</code> statistics gathering procedures.
                     </li>
                     <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-777704A7-3751-4720-957E-6C916FD36917">Setting Global Optimizer Statistics Preferences Using Cloud Control</a><br>A global preference applies to any object in the database that does <span class="italic">not</span> have an existing table preference. You can set optimizer statistics preferences at the global level using Cloud Control. 
                     </li>
                     <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-99A31FC1-56F1-4F30-8D0E-156602D4983C">Setting Object-Level Optimizer Statistics Preferences Using Cloud Control</a><br>You can set optimizer statistics preferences at the database, schema, and table level using Cloud Control.
                     </li>
                     <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-C644102E-0E5B-4CC8-96B6-F3F34200BE34">Setting Optimizer Statistics Preferences from the Command Line</a><br>If you do not use Cloud Control to set optimizer statistics preferences, then you can invoke the <code class="codeph">DBMS_STATS</code> procedures from the command line.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-2044960C-025B-44FC-9522-63F426C74386" title="This chapter explains what optimizer statistics collection is and how to set statistics preferences.">Configuring Options for Optimizer Statistics Gathering</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL399"></a><div class="props_rev_3"><a id="GUID-E798E1F6-FC85-456E-8F38-99534BE74492" name="GUID-E798E1F6-FC85-456E-8F38-99534BE74492"></a><h4 id="TGSQL-GUID-E798E1F6-FC85-456E-8F38-99534BE74492" class="sect4"><span class="enumeration_section">12.2.1 </span>About Optimizer Statistics Preferences
                  </h4>
                  <div>
                     <p>The <strong class="term">optimizer statistics preferences</strong> set the default values of the parameters used by automatic statistics collection and the <code class="codeph">DBMS_STATS</code> statistics gathering procedures.
                     </p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-7E1B6E90-9DB7-4BA2-97E7-D074733392DC">Purpose of Optimizer Statistics Preferences</a><br>Preferences enable you to maintain optimizer statistics automatically when some objects require settings that differ from the default. 
                        </li>
                        <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-7C1411BC-EEFF-4585-9289-EA6B442CFD1E">Examples of Statistics Preferences</a><br>Set preferences using the <code class="codeph">pname</code> parameter of the <code class="codeph">SET_<span class="codeinlineitalic">*</span>_PREFS</code> procedures.
                        </li>
                        <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-61F0ECF1-8B91-4509-B0D9-82879DB6F545">DBMS_STATS Procedures for Setting Statistics Preferences</a><br>The <code class="codeph">DBMS_STATS.SET_*_PREFS</code> procedures change the defaults of parameters used by the <code class="codeph">DBMS_STATS.GATHER_*_STATS</code> procedures. To query the current preferences, use the <code class="codeph">DBMS_STATS.GET_PREFS</code> function.
                        </li>
                        <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-E616363F-0A7B-4D4D-9384-63934DB69F7D">Statistics Preference Overrides</a><br>The <code class="codeph">preference_overrides_parameter</code> statistics preference determines whether, when gathering optimizer statistics, to override the input value of a parameter with the statistics preference. In this way, you control when the database honors a parameter value passed to the statistics gathering procedures.
                        </li>
                        <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-FEE5B9A2-413E-42E8-86BF-0C12B818A95C">Setting Statistics Preferences: Example</a><br>This example illustrates the relationship between <code class="codeph">SET_TABLE_PREFS</code>, <code class="codeph">SET_SCHEMA_STATS</code>, and <code class="codeph">SET_DATABASE_PREFS</code>.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-4FDDBCB2-1DA1-4697-9F07-5AB7DE01D682" title="This topic explains how to set optimizer statistics defaults using DBMS_STATS.SET_*_PREFS procedures.">Setting Optimizer Statistics Preferences</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-7E1B6E90-9DB7-4BA2-97E7-D074733392DC" name="GUID-7E1B6E90-9DB7-4BA2-97E7-D074733392DC"></a><h5 id="TGSQL-GUID-7E1B6E90-9DB7-4BA2-97E7-D074733392DC" class="sect5"><span class="enumeration_section">12.2.1.1 </span>Purpose of Optimizer Statistics Preferences
                     </h5>
                     <div>
                        <p>Preferences enable you to maintain optimizer statistics automatically when some objects require settings that differ from the default. </p>
                        <p>Preferences give you more granular control over how Oracle Database gathers statistics. You can set optimizer statistics preferences at the following levels:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Table</p>
                           </li>
                           <li>
                              <p>Schema</p>
                           </li>
                           <li>
                              <p>Database (all tables)</p>
                           </li>
                           <li>
                              <p>Global (tables with no preferences and any tables created in the future)</p>
                           </li>
                        </ul>
                        <p>The <code class="codeph">DBMS_STATS</code> procedures for setting preferences have names of the form <code class="codeph">SET_*_PREFS</code>. 
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-E798E1F6-FC85-456E-8F38-99534BE74492" title="The optimizer statistics preferences set the default values of the parameters used by automatic statistics collection and the DBMS_STATS statistics gathering procedures.">About Optimizer Statistics Preferences</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-7C1411BC-EEFF-4585-9289-EA6B442CFD1E" name="GUID-7C1411BC-EEFF-4585-9289-EA6B442CFD1E"></a><h5 id="TGSQL-GUID-7C1411BC-EEFF-4585-9289-EA6B442CFD1E" class="sect5"><span class="enumeration_section">12.2.1.2 </span>Examples of Statistics Preferences
                     </h5>
                     <div>
                        <p>Set preferences using the <code class="codeph">pname</code> parameter of the <code class="codeph">SET_<span class="codeinlineitalic">*</span>_PREFS</code> procedures.
                        </p>
                        <p>Preferences that you can set include, but are not limited to, the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">ESTIMATE_PERCENT</code> 
                              </p>
                              <p>This preference determines the percentage of rows to estimate.</p>
                           </li>
                           <li>
                              <p><code class="codeph">CONCURRENT</code></p>
                              <p>This preference determines whether the database gathers statistics concurrently on multiple objects, or serially, one object at a time.</p>
                           </li>
                           <li>
                              <p><code class="codeph">STALE_PERCENT</code></p>
                              <p>This preference determines the percentage of rows in a table that must change before the database deems the statistics stale and in need of regathering.</p>
                           </li>
                           <li>
                              <p><code class="codeph">AUTO_STAT_EXTENSIONS</code></p>
                              <p>When set to the non-default value of <code class="codeph">ON</code>, this preference enables a SQL plan directive to trigger the creation of column group statistics based on usage of columns in the predicates in the workload.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">INCREMENTAL</code></p>
                              <p>This preference determines whether the database maintains the global statistics of a partitioned table without performing a full table scan. Possible values are <code class="codeph">TRUE</code> and <code class="codeph">FALSE</code>.
                              </p>
                              <p>For example, by the default setting for <code class="codeph">INCREMENTAL</code> is <code class="codeph">FALSE</code>. You can set <code class="codeph">INCREMENTAL</code> to <code class="codeph">TRUE</code> for a range-partitioned table when the last few partitions are updated. Also, when performing a partition exchange operation on a nonpartitioned table, Oracle recommends that you set <code class="codeph">INCREMENTAL</code> to <code class="codeph">TRUE</code> and <code class="codeph">INCREMENTAL_LEVEL</code> to <code class="codeph">TABLE</code>. With these settings, <code class="codeph">DBMS_STATS</code> gathers table-level synopses on this table.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">INCREMENTAL_LEVEL</code></p>
                              <p>This preference controls what synopses to collect when <code class="codeph">INCREMENTAL</code> preference is set to <code class="codeph">TRUE</code>. It takes two values: <code class="codeph">TABLE</code> or <code class="codeph">PARTITION</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">APPROXIMATE_NDV_ALGORITHM</code></p>
                              <p>This preference controls which algorithm to use when calculating the number of distinct values for partitioned tables using incremental statistics.</p>
                           </li>
                           <li>
                              <p><code class="codeph">ROOT_TRIGGER_PDB</code></p>
                              <p>This preference controls whether to accept or reject the statistics gathering triggered from an application root in a CDB.</p>
                              <p>By default, when gathering statistics for a metadata-linked table in the application root, if the statistics the application PDB are stale, the database does <span class="italic">not</span> trigger statistics gathering on the application PDB. When set to <code class="codeph">TRUE</code>, <code class="codeph">ROOT_TRIGGER_PDB</code> triggers statistics gathering on the application PDB, and then derives the global statistics in the application root.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-7C1411BC-EEFF-4585-9289-EA6B442CFD1E__GUID-CD82DA7C-AD35-4AC0-9E34-06CA27E9AAD4">
                           <p class="notep1">See Also:</p>
                           <p><a href="../arpls/DBMS_STATS.html#ARPLS68491" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS</code> procedures for setting optimizer statistics preferences
                           </p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-E798E1F6-FC85-456E-8F38-99534BE74492" title="The optimizer statistics preferences set the default values of the parameters used by automatic statistics collection and the DBMS_STATS statistics gathering procedures.">About Optimizer Statistics Preferences</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL401"></a><a id="TGSQL95042"></a><div class="props_rev_3"><a id="GUID-61F0ECF1-8B91-4509-B0D9-82879DB6F545" name="GUID-61F0ECF1-8B91-4509-B0D9-82879DB6F545"></a><h5 id="TGSQL-GUID-61F0ECF1-8B91-4509-B0D9-82879DB6F545" class="sect5"><span class="enumeration_section">12.2.1.3 </span>DBMS_STATS Procedures for Setting Statistics Preferences
                     </h5>
                     <div>
                        <p>The <code class="codeph">DBMS_STATS.SET_*_PREFS</code> procedures change the defaults of parameters used by the <code class="codeph">DBMS_STATS.GATHER_*_STATS</code> procedures. To query the current preferences, use the <code class="codeph">DBMS_STATS.GET_PREFS</code> function.
                        </p>
                        <div class="section">
                           <p>When setting statistics preferences, the order of precedence is:</p>
                           <ol>
                              <li>
                                 <p>Table preference (set for a specific table, all tables in a schema, or all tables in the database)</p>
                              </li>
                              <li>
                                 <p>Global preference</p>
                              </li>
                              <li>
                                 <p>Default preference</p>
                              </li>
                           </ol>
                           <p>The following table summarizes the relevant <code class="codeph">DBMS_STATS</code> procedures.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="tblformal" id="GUID-61F0ECF1-8B91-4509-B0D9-82879DB6F545__CHDDJJJI">
                           <p class="titleintable">Table 12-1 DBMS_STATS Procedures for Setting Optimizer Statistics Preferences</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_STATS Procedures for Setting Optimizer Statistics Preferences" summary="This 2 column table shows DBMS_STATS Procedures for Setting Optimizer Statistics Preferences. Column 1 is the procedure. Column 2 is the scope. " width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="32%" id="d70063e2042">Procedure</th>
                                    <th align="left" valign="bottom" width="68%" id="d70063e2045">Scope</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d70063e2050" headers="d70063e2042 ">
                                       <p><code class="codeph">SET_TABLE_PREFS</code></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d70063e2050 d70063e2045 ">
                                       <p>Specified table only.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d70063e2058" headers="d70063e2042 ">
                                       <p><code class="codeph">SET_SCHEMA_PREFS</code></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d70063e2058 d70063e2045 ">
                                       <p>All existing tables in the specified schema.</p>
                                       <p>This procedure calls <code class="codeph">SET_TABLE_PREFS</code> for each table in the specified schema. Calling <code class="codeph">SET_SCHEMA_PREFS</code> does not affect any new tables created after it has been run. New tables use the <code class="codeph">GLOBAL_PREF</code> values for all parameters.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d70063e2077" headers="d70063e2042 ">
                                       <p><code class="codeph">SET_DATABASE_PREFS</code></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d70063e2077 d70063e2045 ">
                                       <p>All user-defined schemas in the database. You can include system-owned schemas such as <code class="codeph">SYS</code> and <code class="codeph">SYSTEM</code> by setting the <code class="codeph">ADD_SYS</code> parameter to <code class="codeph">true</code>.
                                       </p>
                                       <p>This procedure calls <code class="codeph">SET_TABLE_PREFS</code> for each table in the specified schema. Calling <code class="codeph">SET_DATABASE_PREFS</code> does not affect any new objects created after it has been run. New objects use the <code class="codeph">GLOBAL_PREF</code> values for all parameters.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d70063e2108" headers="d70063e2042 ">
                                       <p><code class="codeph">SET_GLOBAL_PREFS</code></p>
                                    </td>
                                    <td align="left" valign="top" width="68%" headers="d70063e2108 d70063e2045 ">
                                       <p>Any table that does not have an existing table preference. </p>
                                       <p>All parameters default to the global setting unless a table preference is set or the parameter is explicitly set in the <code class="codeph">DBMS_STATS.GATHER_*_STATS</code> statement. Changes made by <code class="codeph">SET_GLOBAL_PREFS</code> affect any new objects created after it runs. New objects use the <code class="codeph">SET_GLOBAL_PREFS</code> values for all parameters. 
                                       </p>
                                       <p>With <code class="codeph">SET_GLOBAL_PREFS</code>, you can set a default value for the parameter <code class="codeph">AUTOSTATS_TARGET</code>. This additional parameter controls which objects the automatic statistic gathering job running in the nightly maintenance window affects. Possible values for <code class="codeph">AUTOSTATS_TARGET</code> are <code class="codeph">ALL</code>, <code class="codeph">ORACLE</code>, and <code class="codeph">AUTO</code> (default).
                                       </p>
                                       <p>You can only set the <code class="codeph">CONCURRENT</code> preference at the global level. You cannot set the preference <code class="codeph">INCREMENTAL_LEVEL</code> using <code class="codeph">SET_GLOBAL_PREFS</code>.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-61F0ECF1-8B91-4509-B0D9-82879DB6F545__GUID-648043E0-995E-45B8-A969-819467836F11">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="gathering-optimizer-statistics.html#GUID-C5EEE744-8F37-4255-A18E-16B46B78EFA9" title="By default, each partition of a partition table is gathered sequentially.">About Concurrent Statistics Gathering</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_STATS.html#ARPLS68491" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS</code> procedures for setting optimizer statistics preferences
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-E798E1F6-FC85-456E-8F38-99534BE74492" title="The optimizer statistics preferences set the default values of the parameters used by automatic statistics collection and the DBMS_STATS statistics gathering procedures.">About Optimizer Statistics Preferences</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="props_rev_3"><a id="GUID-E616363F-0A7B-4D4D-9384-63934DB69F7D" name="GUID-E616363F-0A7B-4D4D-9384-63934DB69F7D"></a><h5 id="TGSQL-GUID-E616363F-0A7B-4D4D-9384-63934DB69F7D" class="sect5"><span class="enumeration_section">12.2.1.4 </span>Statistics Preference Overrides
                     </h5>
                     <div>
                        <p>The <code class="codeph">preference_overrides_parameter</code> statistics preference determines whether, when gathering optimizer statistics, to override the input value of a parameter with the statistics preference. In this way, you control when the database honors a parameter value passed to the statistics gathering procedures.
                        </p>
                        <div class="section">
                           <p>When <code class="codeph">preference_overrides_parameter</code> is set to <code class="codeph">FALSE</code> (default), the input values for statistics gathering procedures are honored. When set to <code class="codeph">TRUE</code>, the input values are ignored.
                           </p>
                           <p>Set the <code class="codeph">preference_overrides_parameter</code> preference using the <code class="codeph">SET_TABLE_PREFS</code>, <code class="codeph">SET_SCHEMA_PREFS</code>, or <code class="codeph">SET_GLOBAL_PREFS</code> procedures in <code class="codeph">DBMS_STATS</code>. Regardless of whether <code class="codeph">preference_overrides_parameter</code> is set, the database uses the same order of precedence for setting statistics:
                           </p>
                           <ol>
                              <li>
                                 <p>Table preference (set for a specific table, all tables in a schema, or all tables in the database)</p>
                              </li>
                              <li>
                                 <p>Global preference</p>
                              </li>
                              <li>
                                 <p>Default preference</p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-E616363F-0A7B-4D4D-9384-63934DB69F7D__GUID-5F64B53B-9688-4B3B-9634-B80CA0DFC591">
                           <p class="titleinexample">Example 12-1 Overriding Statistics Preferences at the Table Level</p>
                           <p>In this example, legacy scripts set <code class="codeph">estimate_percent</code> explicitly rather than using the recommended <code class="codeph">AUTO_SAMPLE_SIZE</code>.  Your goal is to prevent users from using these scripts to set preferences on the <code class="codeph">sh.costs</code> table.
                           </p>
                           <div class="tblformalwide" id="GUID-E616363F-0A7B-4D4D-9384-63934DB69F7D__CHDFCJBE">
                              <p class="titleintable">Table 12-2 Overriding Statistics Preferences at the Table Level</p>
                              <table cellpadding="4" cellspacing="0" class="FormalWide" title="Overriding Statistics Preferences at the Table Level" summary="This 2 column table lists preference overrides for statistic at the table level. Column 1 is the action. Column 2 describes that action." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="51%" id="d70063e2373">Action</th>
                                       <th align="left" valign="bottom" width="49%" id="d70063e2376">Description</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="51%" id="d70063e2381" headers="d70063e2373 "><pre class="pre codeblock"><code>SQL&gt; SELECT DBMS_STATS.GET_PREFS 
('estimate_percent', 'sh','costs') 
AS "STAT_PREFS" FROM DUAL;
 
STAT_PREFS
----------
DBMS_STATS.AUTO_SAMPLE_SIZE</code></pre></td>
                                       <td align="left" valign="top" width="49%" headers="d70063e2381 d70063e2376 ">
                                          <p>No preference for <code class="codeph">estimate_percent</code> is set for <code class="codeph">sh.costs</code> or at the global level, so the preference defaults to <code class="codeph">AUTO_SAMPLE_SIZE</code>.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="51%" id="d70063e2397" headers="d70063e2373 "><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_STATS.SET_TABLE_PREFS 
('sh', 'costs', 
'preference_overrides_parameter', 'true');
 
PL/SQL procedure successfully completed.</code></pre></td>
                                       <td align="left" valign="top" width="49%" headers="d70063e2397 d70063e2376 ">
                                          <p>By default, Oracle Database accepts preferences that are passed to the <code class="codeph">GATHER_*_STATS</code> procedures. To override these parameters, you use <code class="codeph">SET_TABLE_PREFS</code> to set the <code class="codeph">preference_overrides_parameter</code> preference to <code class="codeph">true</code> for the <code class="codeph">costs</code> table only.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="51%" id="d70063e2419" headers="d70063e2373 "><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_STATS.GATHER_TABLE_STATS
('sh', 'costs', estimate_percent=&gt;100);

PL/SQL procedure successfully completed.</code></pre></td>
                                       <td align="left" valign="top" width="49%" headers="d70063e2419 d70063e2376 ">
                                          <p>You attempt to set <code class="codeph">estimate_percent</code> to <code class="codeph">100</code> when gathering statistics for <code class="codeph">sh.costs</code>. However, because <code class="codeph">preference_overrides_parameter</code> is <code class="codeph">true</code> for this table, Oracle Database does not honor the <code class="codeph">estimate_percent=&gt;100</code>setting. Instead, the database gathers statistics using <code class="codeph">AUTO_SAMPLE_SIZE</code>, which is the default.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E616363F-0A7B-4D4D-9384-63934DB69F7D__GUID-0DBBA55B-55ED-46A3-9E9B-278DB5309B60">
                           <p class="titleinexample">Example 12-2 Overriding Statistics Preferences at the Global Level</p>
                           <p>In this example, you set <code class="codeph">estimate_percent</code> to <code class="codeph">5</code> at the global level, which means that this preference applies to every table in the database that does <span class="italic">not</span> have a table preference set. You then set an override on the <code class="codeph">sh.sales</code> table, which does not have a table-level preference set, to prevent users from overriding the global setting in their scripts.
                           </p>
                           <div class="tblformalwide" id="GUID-E616363F-0A7B-4D4D-9384-63934DB69F7D__OVERRIDINGSTATISTICSPREFERENCES-A50F5ED1">
                              <p class="titleintable">Table 12-3 Overriding Statistics Preferences at the Global Level</p>
                              <table cellpadding="4" cellspacing="0" class="FormalWide" title="Overriding Statistics Preferences at the Global Level" summary="This 2 column table lists preference overrides for statistic at the global level. Column 1 is the action. Column 2 describes that action." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="51%" id="d70063e2474">Action</th>
                                       <th align="left" valign="bottom" width="49%" id="d70063e2477">Description</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="51%" id="d70063e2482" headers="d70063e2474 "><pre class="pre codeblock"><code>SQL&gt; SELECT DBMS_STATS.GET_PREFS 
('estimate_percent', 'sh','sales') 
AS "STAT_PREFS" FROM DUAL;
 
STAT_PREFS
----------
DBMS_STATS.AUTO_SAMPLE_SIZE</code></pre></td>
                                       <td align="left" valign="top" width="49%" headers="d70063e2482 d70063e2477 ">
                                          <p>No preference for <code class="codeph">estimate_percent</code> is set for <code class="codeph">sh.sales</code> or at the global level, so the preference defaults to <code class="codeph">AUTO_SAMPLE_SIZE</code>.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="51%" id="d70063e2498" headers="d70063e2474 "><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_STATS.SET_GLOBAL_PREFS 
('estimate_percent', '5');

PL/SQL procedure successfully completed.</code></pre></td>
                                       <td align="left" valign="top" width="49%" headers="d70063e2498 d70063e2477 ">
                                          <p>You use the <code class="codeph">SET_GLOBAL_PREFS</code> procedure to set the <code class="codeph">estimate_percent</code> preference to <code class="codeph">5</code> for every table in the database that does not have a table preference set.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="51%" id="d70063e2514" headers="d70063e2474 "><pre class="pre codeblock"><code>SQL&gt; SELECT DBMS_STATS.GET_PREFS 
('estimate_percent', 'sh','sales') 
AS "STAT_PREFS" FROM DUAL;
 
STAT_PREFS
----------
5</code></pre></td>
                                       <td align="left" valign="top" width="49%" headers="d70063e2514 d70063e2477 ">
                                          <p> Because <code class="codeph">sh.sales</code> does not have a preference set, the global setting applies to this table. A query of the preferences for <code class="codeph">sh.sales</code> now shows that the <code class="codeph">estimate_percent</code> setting is <code class="codeph">5</code>, which is the global setting.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="51%" id="d70063e2533" headers="d70063e2474 "><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_STATS.SET_TABLE_PREFS 
('sh', 'sales', 
'preference_overrides_parameter', 'true');
 
PL/SQL procedure successfully completed.</code></pre></td>
                                       <td align="left" valign="top" width="49%" headers="d70063e2533 d70063e2477 ">
                                          <p>You use <code class="codeph">SET_TABLE_PREFS</code> to set the <code class="codeph">preference_overrides_parameter</code> preference to <code class="codeph">true</code> for the <code class="codeph">sh.sales</code> table only.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="51%" id="d70063e2552" headers="d70063e2474 "><pre class="pre codeblock"><code>SQL&gt; EXEC DBMS_STATS.GATHER_TABLE_STATS
('sh', 'sales', estimate_percent=&gt;10);

PL/SQL procedure successfully completed.</code></pre></td>
                                       <td align="left" valign="top" width="49%" headers="d70063e2552 d70063e2477 ">
                                          <p>You attempt to set <code class="codeph">estimate_percent</code> to <code class="codeph">10</code> when gathering statistics for <code class="codeph">sh.sales</code>. However, because <code class="codeph">preference_overrides_parameter</code> is <code class="codeph">true</code> for the <code class="codeph">sales</code> table, and because a global preference is defined, Oracle Database actually gathers statistics using the global setting of <code class="codeph">5</code>.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-E616363F-0A7B-4D4D-9384-63934DB69F7D__GUID-648043E0-995E-45B8-A969-819467836F11">
                           <p class="notep1">See Also:</p>
                           <p><a href="../arpls/DBMS_STATS.html#ARPLS68491" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_STATS</code> procedures for setting optimizer statistics
                           </p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-E798E1F6-FC85-456E-8F38-99534BE74492" title="The optimizer statistics preferences set the default values of the parameters used by automatic statistics collection and the DBMS_STATS statistics gathering procedures.">About Optimizer Statistics Preferences</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL95044"></a><a id="TGSQL95043"></a><div class="props_rev_3"><a id="GUID-FEE5B9A2-413E-42E8-86BF-0C12B818A95C" name="GUID-FEE5B9A2-413E-42E8-86BF-0C12B818A95C"></a><h5 id="TGSQL-GUID-FEE5B9A2-413E-42E8-86BF-0C12B818A95C" class="sect5"><span class="enumeration_section">12.2.1.5 </span>Setting Statistics Preferences: Example
                     </h5>
                     <div>
                        <p>This example illustrates the relationship between <code class="codeph">SET_TABLE_PREFS</code>, <code class="codeph">SET_SCHEMA_STATS</code>, and <code class="codeph">SET_DATABASE_PREFS</code>.
                        </p>
                        <div class="section">
                           <p></p>
                           <div class="tblformalwide" id="GUID-FEE5B9A2-413E-42E8-86BF-0C12B818A95C__CHDFCJBE">
                              <p class="titleintable">Table 12-4 Changing Preferences for Statistics Gathering Procedures</p>
                              <table cellpadding="4" cellspacing="0" class="FormalWide" title="Changing Preferences for Statistics Gathering Procedures" summary="Changing preferences for statistics" width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="50%" id="d70063e2730">Action</th>
                                       <th align="left" valign="bottom" width="50%" id="d70063e2733">Description</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d70063e2738" headers="d70063e2730 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT DBMS_STATS.GET_PREFS 
('incremental', 'sh','costs') 
AS "STAT_PREFS" FROM DUAL;
 
STAT_PREFS
----------
TRUE</pre></td>
                                       <td align="left" valign="top" width="50%" headers="d70063e2738 d70063e2733 ">
                                          <p>You query the <code class="codeph">INCREMENTAL</code> preference for <code class="codeph">costs</code> and determine that it is set to <code class="codeph">true</code>.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d70063e2754" headers="d70063e2730 "><pre class="oac_no_warn" dir="ltr">SQL&gt; EXEC DBMS_STATS.SET_TABLE_PREFS 
('sh', 'costs', 'incremental', 'false');
 
PL/SQL procedure successfully completed.</pre></td>
                                       <td align="left" valign="top" width="50%" headers="d70063e2754 d70063e2733 ">
                                          <p>You use <code class="codeph">SET_TABLE_PREFS</code> to set the <code class="codeph">INCREMENTAL</code> preference to <code class="codeph">false</code> for the <code class="codeph">costs</code> table only.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d70063e2773" headers="d70063e2730 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT DBMS_STATS.GET_PREFS 
('incremental', 'sh', 'costs') 
AS "STAT_PREFS" FROM DUAL;

STAT_PREFS 
----------
FALSE</pre></td>
                                       <td align="left" valign="top" width="50%" headers="d70063e2773 d70063e2733 ">
                                          <p>You query the <code class="codeph">INCREMENTAL</code> preference for <code class="codeph">costs</code> and confirm that it is set to <code class="codeph">false</code>.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d70063e2789" headers="d70063e2730 "><pre class="oac_no_warn" dir="ltr">SQL&gt; EXEC DBMS_STATS.SET_SCHEMA_PREFS 
('sh', 'incremental', 'true');

PL/SQL procedure successfully completed.</pre></td>
                                       <td align="left" valign="top" width="50%" headers="d70063e2789 d70063e2733 ">
                                          <p>You use <code class="codeph">SET_SCHEMA_PREFS</code> to set the <code class="codeph">INCREMENTAL</code> preference to <code class="codeph">true</code> for every table in the <code class="codeph">sh</code> schema, including <code class="codeph">costs</code>.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d70063e2811" headers="d70063e2730 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT DBMS_STATS.GET_PREFS 
('incremental', 'sh', 'costs') 
AS "STAT_PREFS" FROM DUAL;
 
STAT_PREFS
----------
TRUE</pre></td>
                                       <td align="left" valign="top" width="50%" headers="d70063e2811 d70063e2733 ">
                                          <p>You query the <code class="codeph">INCREMENTAL</code> preference for <code class="codeph">costs</code> and confirm that it is set to <code class="codeph">true</code>.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d70063e2827" headers="d70063e2730 "><pre class="oac_no_warn" dir="ltr">SQL&gt; EXEC DBMS_STATS.SET_DATABASE_PREFS 
('incremental', 'false');

PL/SQL procedure successfully completed.</pre></td>
                                       <td align="left" valign="top" width="50%" headers="d70063e2827 d70063e2733 ">
                                          <p>You use <code class="codeph">SET_DATABASE_PREFS</code> to set the <code class="codeph">INCREMENTAL</code> preference for all tables in all user-defined schemas to <code class="codeph">false</code>.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d70063e2843" headers="d70063e2730 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT DBMS_STATS.GET_PREFS 
('incremental', 'sh', 'costs') 
AS "STAT_PREFS" FROM DUAL;

STAT_PREFS
----------
FALSE</pre></td>
                                       <td align="left" valign="top" width="50%" headers="d70063e2843 d70063e2733 ">
                                          <p>You query the <code class="codeph">INCREMENTAL</code> preference for <code class="codeph">costs</code> and confirm that it is set to <code class="codeph">false</code>.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-E798E1F6-FC85-456E-8F38-99534BE74492" title="The optimizer statistics preferences set the default values of the parameters used by automatic statistics collection and the DBMS_STATS statistics gathering procedures.">About Optimizer Statistics Preferences</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL402"></a><div class="props_rev_3"><a id="GUID-777704A7-3751-4720-957E-6C916FD36917" name="GUID-777704A7-3751-4720-957E-6C916FD36917"></a><h4 id="TGSQL-GUID-777704A7-3751-4720-957E-6C916FD36917" class="sect4"><span class="enumeration_section">12.2.2 </span>Setting Global Optimizer Statistics Preferences Using Cloud Control
                  </h4>
                  <div>
                     <p>A global preference applies to any object in the database that does <span class="italic">not</span> have an existing table preference. You can set optimizer statistics preferences at the global level using Cloud Control. 
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-777704A7-3751-4720-957E-6C916FD36917__GUID-5E5A083B-2156-4CCA-89FD-FF0315A8E4D7">To set global optimizer statistics preferences using Cloud Control:</p>
                        <ol>
                           <li>
                              <p>In Cloud Control, access the <span>Database Home</span> page.
                              </p>
                           </li>
                           <li>
                              <p>From the <span class="bold">Performance</span> menu, select <span class="bold">SQL</span>, then <span class="bold">Optimizer Statistics</span>.
                              </p>
                              <p>The Optimizer Statistics Console appears.</p>
                           </li>
                           <li>
                              <p>Click <span class="bold">Global Statistics Gathering Options</span>.
                              </p>
                              <p>The Global Statistics Gathering Options page appears.</p>
                           </li>
                           <li>
                              <p>Make your desired changes, and click <span class="bold">Apply</span>.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-777704A7-3751-4720-957E-6C916FD36917__GUID-D68AC8C4-FE4D-4616-B4AE-E040037F76BC">
                        <p class="notep1">See Also:</p>
                        <p>Online Help for Oracle Enterprise Manager Cloud Control</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-4FDDBCB2-1DA1-4697-9F07-5AB7DE01D682" title="This topic explains how to set optimizer statistics defaults using DBMS_STATS.SET_*_PREFS procedures.">Setting Optimizer Statistics Preferences</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL403"></a><div class="props_rev_3"><a id="GUID-99A31FC1-56F1-4F30-8D0E-156602D4983C" name="GUID-99A31FC1-56F1-4F30-8D0E-156602D4983C"></a><h4 id="TGSQL-GUID-99A31FC1-56F1-4F30-8D0E-156602D4983C" class="sect4"><span class="enumeration_section">12.2.3 </span>Setting Object-Level Optimizer Statistics Preferences Using Cloud Control
                  </h4>
                  <div>
                     <p>You can set optimizer statistics preferences at the database, schema, and table level using Cloud Control.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-99A31FC1-56F1-4F30-8D0E-156602D4983C__GUID-283B40D6-A3F3-4AB1-97A4-74221984F6A8">To set object-level optimizer statistics preferences using Cloud Control:</p>
                        <ol>
                           <li>
                              <p>In Cloud Control, access the <span>Database Home</span> page.
                              </p>
                           </li>
                           <li>
                              <p>From the <span class="bold">Performance</span> menu, select <span class="bold">SQL</span>, then <span class="bold">Optimizer Statistics</span>.
                              </p>
                              <p>The Optimizer Statistics Console appears.</p>
                           </li>
                           <li>
                              <p>Click <span class="bold">Object Level Statistics Gathering Preferences</span>.
                              </p>
                              <p>The Object Level Statistics Gathering Preferences page appears.</p>
                           </li>
                           <li>
                              <p>To modify table preferences for a table that has preferences set at the table level, do the following (otherwise, skip to the next step):</p>
                              <ol type="a">
                                 <li>
                                    <p>Enter values in <span class="bold">Schema</span> and <span class="bold">Table Name</span>. Leave <span class="bold">Table Name</span> blank to see all tables in the schema.
                                    </p>
                                    <p>The page refreshes with the table names.</p>
                                 </li>
                                 <li>
                                    <p>Select the desired tables and click <span class="bold">Edit Preferences</span>.
                                    </p>
                                    <p>The General subpage of the Edit Preferences page appears.</p>
                                 </li>
                                 <li>
                                    <p>Change preferences as needed and click <span class="bold">Apply</span>.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>To set preferences for a table that does <span class="italic">not</span> have preferences set at the table level, do the following (otherwise, skip to the next step):
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>Click <span class="bold">Add Table Preferences</span>.
                                    </p>
                                    <p>The General subpage of the Add Table Preferences page appears.</p>
                                 </li>
                                 <li>
                                    <p>In <span class="bold">Table Name</span>, enter the schema and table name.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Change preferences as needed and click <span class="bold">OK</span>.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>To set preferences for a schema, do the following:</p>
                              <ol type="a">
                                 <li>
                                    <p>Click <span class="bold">Set Schema Tables Preferences</span>.
                                    </p>
                                    <p>The General subpage of the Edit Schema Preferences page appears.</p>
                                 </li>
                                 <li>
                                    <p>In <span class="bold">Schema</span>, enter the schema name.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Change preferences as needed and click <span class="bold">OK</span>.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-99A31FC1-56F1-4F30-8D0E-156602D4983C__GUID-958A1E85-1B05-4B32-BCEC-C39ABE33884A">
                        <p class="notep1">See Also:</p>
                        <p>Online Help for Oracle Enterprise Manager Cloud Control</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-4FDDBCB2-1DA1-4697-9F07-5AB7DE01D682" title="This topic explains how to set optimizer statistics defaults using DBMS_STATS.SET_*_PREFS procedures.">Setting Optimizer Statistics Preferences</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL405"></a><a id="TGSQL404"></a><div class="props_rev_3"><a id="GUID-C644102E-0E5B-4CC8-96B6-F3F34200BE34" name="GUID-C644102E-0E5B-4CC8-96B6-F3F34200BE34"></a><h4 id="TGSQL-GUID-C644102E-0E5B-4CC8-96B6-F3F34200BE34" class="sect4"><span class="enumeration_section">12.2.4 </span>Setting Optimizer Statistics Preferences from the Command Line
                  </h4>
                  <div>
                     <p>If you do not use Cloud Control to set optimizer statistics preferences, then you can invoke the <code class="codeph">DBMS_STATS</code> procedures from the command line.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C644102E-0E5B-4CC8-96B6-F3F34200BE34__GUID-25E7B66E-7E21-48E8-BEC9-FAAF05011D4D">Prerequisites</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>This task has the following prerequisites:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To set the global or database preferences, you must have <code class="codeph">SYSDBA</code> privileges, or both <code class="codeph">ANALYZE ANY DICTIONARY</code> and <code class="codeph">ANALYZE ANY</code> system privileges.
                              </p>
                           </li>
                           <li>
                              <p>To set schema preferences, you must connect as owner, or have <code class="codeph">SYSDBA</code> privileges, or have the <code class="codeph">ANALYZE ANY</code> system privilege.
                              </p>
                           </li>
                           <li>
                              <p>To set table preferences, you must connect as owner of the table or have the <code class="codeph">ANALYZE ANY</code> system privilege.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C644102E-0E5B-4CC8-96B6-F3F34200BE34__GUID-83ED884D-F953-44C5-8460-4F851C742401">To set optimizer statistics preferences from the command line:</p>
                        <ol>
                           <li>
                              <p id="GUID-C644102E-0E5B-4CC8-96B6-F3F34200BE34__d5e29">In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                           </li>
                           <li>
                              <p>Optionally, call the <code class="codeph">DBMS_STATS.GET_PREFS</code> procedure to see preferences set at the object level, or at the global level if a specific table is not set.
                              </p>
                              <p>For example, obtain the <code class="codeph">STALE_PERCENT</code> parameter setting for the <code class="codeph">sh.sales</code> table as follows:
                              </p><pre class="pre codeblock"><code>SELECT DBMS_STATS.GET_PREFS('STALE_PERCENT', 'SH', 'SALES') 
FROM   DUAL;
</code></pre></li>
                           <li>
                              <p>Execute the appropriate procedure from <a href="options-for-optimizer-statistics-gathering.html#GUID-61F0ECF1-8B91-4509-B0D9-82879DB6F545__CHDDJJJI" title="This 2 column table shows DBMS_STATS Procedures for Setting Optimizer Statistics Preferences. Column 1 is the procedure. Column 2 is the scope.">Table 12-1</a>, specifying the following parameters:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">ownname</code> - Set schema name (<code class="codeph">SET_TAB_PREFS</code> and <code class="codeph">SET_SCHEMA_PREFS</code> only)
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">tabname</code> - Set table name (<code class="codeph">SET_TAB_PREFS</code> only)
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">pname</code> - Set parameter name
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">pvalue</code> - Set parameter value
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">add_sys</code> - Include system tables (optional, <code class="codeph">SET_DATABASE_PREFS</code> only)
                                    </p>
                                 </li>
                              </ul>
                              <p>The following example specifies that 13% of rows in <code class="codeph">sh.sales</code> must change before the statistics on that table are considered stale:
                              </p><pre class="pre codeblock"><code>EXEC DBMS_STATS.SET_TABLE_PREFS('SH', 'SALES', 'STALE_PERCENT', '13');
</code></pre></li>
                           <li>
                              <p>Optionally, query the <code class="codeph">*_TAB_STAT_PREFS</code> view to confirm the change.
                              </p>
                              <p>For example, query <code class="codeph">DBA_TAB_STAT_PREFS</code> as follows:
                              </p><pre class="pre codeblock"><code>COL OWNER FORMAT a5
COL TABLE_NAME FORMAT a15
COL PREFERENCE_NAME FORMAT a20
COL PREFERENCE_VALUE FORMAT a30
SELECT * FROM DBA_TAB_STAT_PREFS;
</code></pre><p>Sample output appears as follows:</p><pre class="pre codeblock"><code>OWNER TABLE_NAME      PREFERENCE_NAME      PREFERENCE_VALUE
----- --------------- -------------------- ------------------------------
OE    CUSTOMERS       NO_INVALIDATE        DBMS_STATS.AUTO_INVALIDATE
SH    SALES           STALE_PERCENT        13</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-C644102E-0E5B-4CC8-96B6-F3F34200BE34__GUID-B3EB8E62-89A5-4CB7-AC14-DF0BAA1EC25F">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_STATS.html#ARPLS-GUID-CDAA4742-5398-4A64-B871-E39F38D0021F" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for descriptions of the parameter names and values for program units
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-4FDDBCB2-1DA1-4697-9F07-5AB7DE01D682" title="This topic explains how to set optimizer statistics defaults using DBMS_STATS.SET_*_PREFS procedures.">Setting Optimizer Statistics Preferences</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL450"></a><div class="props_rev_3"><a id="GUID-F1C666DC-5450-4F92-83AA-607327DB5FD8" name="GUID-F1C666DC-5450-4F92-83AA-607327DB5FD8"></a><h3 id="TGSQL-GUID-F1C666DC-5450-4F92-83AA-607327DB5FD8" class="sect3"><span class="enumeration_section">12.3 </span>Configuring Options for Dynamic Statistics
               </h3>
               <div>
                  <p><strong class="term">Dynamic statistics</strong> are an optimization technique in which the database uses recursive SQL to scan a small random sample of the blocks in a table.
                  </p>
                  <p>The sample scan estimate predicate selectivities. Using these estimates, the database determines better default statistics for unanalyzed segments, and verifies its estimates. By default, when optimizer statistics are missing, stale, or insufficient, <a href="glossary.html#GUID-453737A7-931A-49D1-AA5C-AFB14D9837FB"><span class="xrefglossterm">dynamic statistics</span></a> automatically run <a href="glossary.html#GUID-4BBB2EED-7E8C-4BAF-A3B3-B1CEF98342AC"><span class="xrefglossterm">recursive SQL</span></a> during <a href="glossary.html#GUID-6E4480E1-4274-499C-B582-2A089D2914DC"><span class="xrefglossterm">parsing</span></a> to scan a small random sample of table blocks.
                  </p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-DEE2AF8B-5F4B-4FE7-9F0E-7D188921EBCC">About Dynamic Statistics Levels</a><br>The <strong class="term">dynamic statistics level</strong> controls both when the database gathers dynamic statistics, and the size of the sample that the optimizer uses to gather the statistics.
                     </li>
                     <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-B92327C9-9B33-4E9C-8813-7E7BC86202C3">Setting Dynamic Statistics Levels Manually</a><br>Determining a database-level setting that would be beneficial to all SQL statements can be difficult. 
                     </li>
                     <li class="ulchildlink"><a href="options-for-optimizer-statistics-gathering.html#GUID-0D188B48-179D-4496-AEB8-C46016D5D0B2">Disabling Dynamic Statistics</a><br>In general, the best practice is not to incur the cost of dynamic statistics for queries whose compile times must be as fast as possible, for example, unrepeated OLTP queries.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-2044960C-025B-44FC-9522-63F426C74386" title="This chapter explains what optimizer statistics collection is and how to set statistics preferences.">Configuring Options for Optimizer Statistics Gathering</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL452"></a><a id="TGSQL451"></a><div class="props_rev_3"><a id="GUID-DEE2AF8B-5F4B-4FE7-9F0E-7D188921EBCC" name="GUID-DEE2AF8B-5F4B-4FE7-9F0E-7D188921EBCC"></a><h4 id="TGSQL-GUID-DEE2AF8B-5F4B-4FE7-9F0E-7D188921EBCC" class="sect4"><span class="enumeration_section">12.3.1 </span>About Dynamic Statistics Levels
                  </h4>
                  <div>
                     <p>The <strong class="term">dynamic statistics level</strong> controls both when the database gathers dynamic statistics, and the size of the sample that the optimizer uses to gather the statistics.
                     </p>
                     <p>Set the dynamic statistics level using either the <code class="codeph">OPTIMIZER_DYNAMIC_SAMPLING</code> initialization parameter or a statement hint.
                     </p>
                     <div class="infoboxnote" id="GUID-DEE2AF8B-5F4B-4FE7-9F0E-7D188921EBCC__GUID-0FBEED2B-6D7C-45B8-A3EE-4401CF75FFE3">
                        <p class="notep1">Note:</p>
                        <p>Dynamic statistics were called <span class="italic">dynamic sampling</span> in releases earlier than <span>Oracle Database 12c</span> Release 1 (12.1).
                        </p>
                     </div>
                     <p>The following table describes the levels for dynamic statistics. Note the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>If <code class="codeph">OPTIMIZER_DYNAMIC_STATISTICS</code> is <code class="codeph">TRUE</code>, and if dynamic statistics are not disabled, then the database may choose to use dynamic statistics when a SQL statement uses parallel execution.
                           </p>
                        </li>
                        <li>
                           <p>If <code class="codeph">OPTIMIZER_ADAPTIVE_STATISTICS</code> is <code class="codeph">TRUE</code>, then the optimizer uses dynamic statistics when relevant SQL plan directives exist. The database maintains the resulting statistics in the SQL plan directives store, making them available to other queries.
                           </p>
                        </li>
                     </ul>
                     <div class="tblformalwide" id="GUID-DEE2AF8B-5F4B-4FE7-9F0E-7D188921EBCC__CHDFEHGA">
                        <p class="titleintable">Table 12-5 Dynamic Statistics Levels</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Dynamic Statistics Levels" summary="Dynamic sampling levels" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="9%" id="d70063e3848">Level</th>
                                 <th align="left" valign="bottom" width="60%" id="d70063e3851">When the Optimizer Uses Dynamic Statistics</th>
                                 <th align="left" valign="bottom" width="32%" id="d70063e3854">Sample Size (Blocks)</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e3859" headers="d70063e3848 ">
                                    <p>0</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e3859 d70063e3851 ">
                                    <p>Do not use dynamic statistics.</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e3859 d70063e3854 ">
                                    <p>n/a</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e3869" headers="d70063e3848 ">
                                    <p>1</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e3869 d70063e3851 ">
                                    <p>Use dynamic statistics for all tables that do not have statistics, but only if the following criteria are met:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>At least one nonpartitioned table in the query does not have statistics.</p>
                                       </li>
                                       <li>
                                          <p>This table has no indexes.</p>
                                       </li>
                                       <li>
                                          <p>This table has more blocks than the number of blocks that would be used for dynamic statistics of this table.</p>
                                       </li>
                                    </ul>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e3869 d70063e3854 ">
                                    <p>32</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e3889" headers="d70063e3848 ">
                                    <p>2</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e3889 d70063e3851 ">
                                    <p>Use dynamic statistics if at least one table in the statement has no statistics. This is the default value.</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e3889 d70063e3854 ">
                                    <p>64</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e3899" headers="d70063e3848 ">
                                    <p>3</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e3899 d70063e3851 ">
                                    <p>Use dynamic statistics if any of the following conditions is true:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>At least one table in the statement has no statistics.</p>
                                       </li>
                                       <li>
                                          <p>The statement has one or more expressions used in the <code class="codeph">WHERE</code> clause predicates, for example, <code class="codeph">WHERE SUBSTR(CUSTLASTNAME,1,3)</code>.
                                          </p>
                                       </li>
                                    </ul>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e3899 d70063e3854 ">
                                    <p>64</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e3922" headers="d70063e3848 ">
                                    <p>4</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e3922 d70063e3851 ">
                                    <p>Use dynamic statistics if any of the following conditions is true:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>At least one table in the statement has no statistics.</p>
                                       </li>
                                       <li>
                                          <p>The statement has one or more expressions used in the <code class="codeph">WHERE</code> clause predicates, for example, <code class="codeph">WHERE SUBSTR(CUSTLASTNAME,1,3)</code>.
                                          </p>
                                       </li>
                                       <li>
                                          <p>The statement uses complex predicates (an <code class="codeph">OR</code> or <code class="codeph">AND</code> operator between multiple predicates on the same table).
                                          </p>
                                       </li>
                                    </ul>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e3922 d70063e3854 ">
                                    <p>64</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e3954" headers="d70063e3848 ">
                                    <p>5</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e3954 d70063e3851 ">
                                    <p>The criteria are identical to level 4, but the database uses a different sample size.</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e3954 d70063e3854 ">
                                    <p>128</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e3964" headers="d70063e3848 ">
                                    <p>6</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e3964 d70063e3851 ">
                                    <p>The criteria are identical to level 4, but the database uses a different sample size.</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e3964 d70063e3854 ">
                                    <p>256</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e3974" headers="d70063e3848 ">
                                    <p>7</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e3974 d70063e3851 ">
                                    <p>The criteria are identical to level 4, but the database uses a different sample size.</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e3974 d70063e3854 ">
                                    <p>512</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e3984" headers="d70063e3848 ">
                                    <p>8</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e3984 d70063e3851 ">
                                    <p>The criteria are identical to level 4, but the database uses a different sample size.</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e3984 d70063e3854 ">
                                    <p>1024</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e3994" headers="d70063e3848 ">
                                    <p>9</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e3994 d70063e3851 ">
                                    <p>The criteria are identical to level 4, but the database uses a different sample size.</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e3994 d70063e3854 ">
                                    <p>4086</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e4004" headers="d70063e3848 ">
                                    <p>10</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e4004 d70063e3851 ">
                                    <p>The criteria are identical to level 4, but the database uses a different sample size.</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e4004 d70063e3854 ">
                                    <p>All blocks</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d70063e4015" headers="d70063e3848 ">
                                    <p>11</p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e4015 d70063e3851 ">
                                    <p>The database uses adaptive dynamic sampling automatically when the optimizer deems it necessary.</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d70063e4015 d70063e3854 ">
                                    <p>Automatically determined</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-DEE2AF8B-5F4B-4FE7-9F0E-7D188921EBCC__GUID-A8492C7F-8BAE-4F0A-9D14-CCC88449572A">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="optimizer-statistics-concepts.html#GUID-E932F5B4-9BDB-4EE4-934C-7F1979CC62A9" title="Starting in Oracle Database 12c, the optimizer automatically decides whether dynamic statistics are useful and which sample size to use for all SQL statements.">When the Database Samples Data</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../refrn/OPTIMIZER_DYNAMIC_SAMPLING.html#REFRN10140" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">OPTIMIZER_DYNAMIC_SAMPLING</code> initialization parameter
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-F1C666DC-5450-4F92-83AA-607327DB5FD8" title="Dynamic statistics are an optimization technique in which the database uses recursive SQL to scan a small random sample of the blocks in a table.">Configuring Options for Dynamic Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL454"></a><a id="TGSQL453"></a><div class="props_rev_3"><a id="GUID-B92327C9-9B33-4E9C-8813-7E7BC86202C3" name="GUID-B92327C9-9B33-4E9C-8813-7E7BC86202C3"></a><h4 id="TGSQL-GUID-B92327C9-9B33-4E9C-8813-7E7BC86202C3" class="sect4"><span class="enumeration_section">12.3.2 </span>Setting Dynamic Statistics Levels Manually
                  </h4>
                  <div>
                     <p>Determining a database-level setting that would be beneficial to all SQL statements can be difficult. </p>
                     <div class="section">When setting the level for dynamic statistics, Oracle recommends setting the <code class="codeph">OPTIMIZER_DYNAMIC_SAMPLING</code> initialization parameter at the session level.
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B92327C9-9B33-4E9C-8813-7E7BC86202C3__GUID-C8D20E3D-053A-46BA-A2C7-D6D9B97C348B">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You want correct selectivity estimates for the following query, which has <code class="codeph">WHERE</code> clause predicates on two correlated columns:
                              </p><pre class="pre codeblock"><code>  SELECT *
  FROM   sh.customers
  WHERE  cust_city='Los Angeles'
  AND    cust_state_province='CA';
</code></pre></li>
                           <li>
                              <p>The preceding query uses serial processing.</p>
                           </li>
                           <li>
                              <p>The <code class="codeph">sh.customers</code> table contains 932 rows that meet the conditions in the query.
                              </p>
                           </li>
                           <li>
                              <p>You have gathered statistics on the <code class="codeph">sh.customers</code> table.
                              </p>
                           </li>
                           <li>
                              <p>You created an index on the <code class="codeph">cust_city</code> and <code class="codeph">cust_state_province</code> columns.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">OPTIMIZER_DYNAMIC_SAMPLING</code> initialization parameter is set to the default level of <code class="codeph">2</code>.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B92327C9-9B33-4E9C-8813-7E7BC86202C3__GUID-CDB3694B-3469-4E13-9E80-6FA3DE1B6E56">To set the dynamic statistics level manually:</p>
                        <ol>
                           <li>
                              <p id="GUID-B92327C9-9B33-4E9C-8813-7E7BC86202C3__d5e29">In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                           </li>
                           <li>
                              <p>Explain the execution plan as follows:</p><pre class="pre codeblock"><code>EXPLAIN PLAN FOR
  SELECT *
  FROM   sh.customers
  WHERE  cust_city='Los Angeles'
  AND    cust_state_province='CA';
</code></pre></li>
                           <li>
                              <p>Query the plan as follows:</p><pre class="pre codeblock"><code>SET LINESIZE 130
SET PAGESIZE 0
SELECT * 
FROM   TABLE(DBMS_XPLAN.DISPLAY);
</code></pre><p>The output appears below (the example has been reformatted to fit on the page):</p><pre class="pre codeblock"><code>-------------------------------------------------------------------------------
|Id| Operation                   | Name             |Rows|Bytes|Cost | Time   |
-------------------------------------------------------------------------------
| 0| SELECT STATEMENT            |                   | <span class="bold">53</span>| 9593|53(0)|00:00:01|
| 1|  TABLE ACCESS BY INDEX ROWID|CUSTOMERS          | <span class="bold">53</span>| 9593|53(0)|00:00:01|
|*2|   INDEX RANGE SCAN          |CUST_CITY_STATE_IND| <span class="bold">53</span>| 9593| 3(0)|00:00:01|
-------------------------------------------------------------------------------
 
Predicate Information (identified by operation id):
---------------------------------------------------
 
   2 - access("CUST_CITY"='Los Angeles' AND "CUST_STATE_PROVINCE"='CA')
</code></pre><p>The columns in the <code class="codeph">WHERE</code> clause have a real-world correlation, but the optimizer is not aware that Los Angeles is in California and assumes both predicates reduce the number of rows returned. Thus, the table contains 932 rows that meet the conditions, but the optimizer estimates 53, as shown in bold.
                              </p>
                              <p>If the database had used dynamic statistics for this plan, then the <code class="codeph">Note</code> section of the plan output would have indicated this fact. The optimizer did not use dynamic statistics because the statement executed serially, standard statistics exist, and the parameter <code class="codeph">OPTIMIZER_DYNAMIC_SAMPLING</code> is set to the default of <code class="codeph">2</code>.
                              </p>
                           </li>
                           <li>
                              <p>Set the dynamic statistics level to <code class="codeph">4</code> in the session using the following statement:
                              </p><pre class="pre codeblock"><code>ALTER SESSION SET OPTIMIZER_DYNAMIC_SAMPLING=4;
</code></pre></li>
                           <li>
                              <p>Explain the plan again:</p><pre class="pre codeblock"><code>EXPLAIN PLAN FOR
  SELECT *
  FROM   sh.customers
  WHERE  cust_city='Los Angeles'
  AND    cust_state_province='CA';
</code></pre><p>The new plan shows a more accurate estimate of the number of rows, as shown by the value 932 in bold: </p><pre class="pre codeblock"><code>PLAN_TABLE_OUTPUT
---------------------------------------------------------------------------
Plan hash value: 2008213504
 
---------------------------------------------------------------------------
| Id  | Operation         | Name      |Rows | Bytes |Cost (%CPU)|Time     |
---------------------------------------------------------------------------
|   0 | SELECT STATEMENT  |           | <span class="bold">932</span> |   271K|   406 (1)| 00:00:05 |
|*  1 |  TABLE ACCESS FULL| CUSTOMERS | <span class="bold">932</span> |   271K|   406 (1)| 00:00:05 |
---------------------------------------------------------------------------
 
Predicate Information (identified by operation id):
---------------------------------------------------
 
   1 - filter("CUST_CITY"='Los Angeles' AND "CUST_STATE_PROVINCE"='CA')
 
Note
-----
   - <span class="bold">dynamic statistics used for this statement (level=4)</span>
</code></pre><p>The note at the bottom of the plan indicates that the sampling level is <code class="codeph">4</code>. The additional dynamic statistics made the optimizer aware of the real-world relationship between the <code class="codeph">cust_city</code> and <code class="codeph">cust_state_province</code> columns, thereby enabling it to produce a more accurate estimate for the number of rows: 932 rather than 53.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B92327C9-9B33-4E9C-8813-7E7BC86202C3__GUID-7BB2F27F-3AE9-469F-9C9B-3CB2D803B4D4">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../sqlrf/Comments.html#SQLRF50913" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> to learn about setting sampling levels with the <code class="codeph">DYNAMIC_SAMPLING</code> hint
                              </p>
                           </li>
                           <li>
                              <p><a href="../refrn/OPTIMIZER_DYNAMIC_SAMPLING.html#REFRN10140" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">OPTIMIZER_DYNAMIC_SAMPLING</code> initialization parameter
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-F1C666DC-5450-4F92-83AA-607327DB5FD8" title="Dynamic statistics are an optimization technique in which the database uses recursive SQL to scan a small random sample of the blocks in a table.">Configuring Options for Dynamic Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL455"></a><div class="props_rev_3"><a id="GUID-0D188B48-179D-4496-AEB8-C46016D5D0B2" name="GUID-0D188B48-179D-4496-AEB8-C46016D5D0B2"></a><h4 id="TGSQL-GUID-0D188B48-179D-4496-AEB8-C46016D5D0B2" class="sect4"><span class="enumeration_section">12.3.3 </span>Disabling Dynamic Statistics
                  </h4>
                  <div>
                     <p>In general, the best practice is not to incur the cost of dynamic statistics for queries whose compile times must be as fast as possible, for example, unrepeated OLTP queries.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-0D188B48-179D-4496-AEB8-C46016D5D0B2__GUID-1CC6CFA2-49F5-46E1-9143-B16528309A57">To disable dynamic statistics at the session level:</p>
                        <ol>
                           <li>
                              <p>Connect SQL*Plus to the database with the appropriate privileges.</p>
                           </li>
                           <li>
                              <p>Set the dynamic statistics level to <code class="codeph">0</code>.
                              </p>
                              <p>For example, run the following statement:</p><pre class="pre codeblock"><code>ALTER SESSION SET OPTIMIZER_DYNAMIC_SAMPLING=0;</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-0D188B48-179D-4496-AEB8-C46016D5D0B2__GUID-A077E070-1D89-485F-9365-BF9B8DA33F15">
                        <p class="notep1">See Also:</p>
                        <p><a href="../refrn/OPTIMIZER_DYNAMIC_SAMPLING.html#REFRN10140" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">OPTIMIZER_DYNAMIC_SAMPLING</code> initialization parameter
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-F1C666DC-5450-4F92-83AA-607327DB5FD8" title="Dynamic statistics are an optimization technique in which the database uses recursive SQL to scan a small random sample of the blocks in a table.">Configuring Options for Dynamic Statistics</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL95103"></a><a id="TGSQL95104"></a><a id="TGSQL95105"></a><a id="TGSQL95106"></a><a id="TGSQL95102"></a><div class="props_rev_3"><a id="GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E" name="GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E"></a><h3 id="TGSQL-GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E" class="sect3"><span class="enumeration_section">12.4 </span>Managing SQL Plan Directives
               </h3>
               <div>
                  <p>A <span class="bold">SQL plan directive</span> is additional information and instructions that the optimizer can use to generate a more optimal plan. 
                  </p>
                  <div class="section">
                     <p>A directive informs the database that the optimizer is misestimate cardinalities of certain types of predicates, and alerts <code class="codeph">DBMS_STATS</code> to gather additional statistics in the future. Thus, directives have an effect on statistics gathering.
                     </p>
                     <p>The database automatically creates and manages SQL plan directives in the SGA, and then periodically writes them to the data dictionary. If the directives are not used within 53 weeks, then the database automatically purges them.</p>
                     <p>You can use <code class="codeph">DBMS_SPD</code> procedures and functions to alter, save, drop, and transport directives manually. The following table lists some of the more commonly used procedures and functions.
                     </p>
                     <div class="tblformal" id="GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E__CHDEEGEG">
                        <p class="titleintable">Table 12-6 DBMS_SPD Procedures</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_SPD Procedures" summary="This 2 column table lists DBMS_SPD restore procedures. Column 1 is the procedure. Column 2 describes that procedure. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="40%" id="d70063e4627">Procedure</th>
                                 <th align="left" valign="bottom" width="60%" id="d70063e4630">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d70063e4635" headers="d70063e4627 ">
                                    <p><code class="codeph">FLUSH_SQL_PLAN_DIRECTIVE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e4635 d70063e4630 ">
                                    <p>Forces the database to write directives from memory to persistent storage in the <code class="codeph">SYSAUX</code> tablespace.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d70063e4646" headers="d70063e4627 ">
                                    <p><code class="codeph">DROP_SQL_PLAN_DIRECTIVE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d70063e4646 d70063e4630 ">
                                    <p>Drops a SQL plan directive. If a directive that triggers dynamic sampling is creating unacceptable performance overhead, then you may want to remove it manually.</p>
                                    <p>If a SQL plan directive is dropped manually or automatically, then the database can re-create it. To prevent its re-creation, you can use <code class="codeph">DBMS_SPM.ALTER_SQL_PLAN_DIRECTIVE</code> to do the following:
                                    </p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>Disable the directive by setting <code class="codeph">ENABLED</code> to <code class="codeph">NO</code></p>
                                       </li>
                                       <li>
                                          <p>Prevent the directive from being dropped by setting <code class="codeph">AUTO_DROP</code> to <code class="codeph">NO</code></p>
                                       </li>
                                    </ul>
                                    <p>To disable SQL plan directives, set <code class="codeph">OPTIMIZER_ADAPTIVE_STATISTICS</code> to <code class="codeph">FALSE</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E__GUID-80CFA0F0-1875-42BC-8469-6535CB8F1F43">Prerequisites</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>You must have the Administer SQL Management Object privilege to execute the <code class="codeph">DBMS_SPD</code> APIs.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E__GUID-2E937CC1-1A15-4373-A6EA-69BF4BAE276A">Assumptions</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>This tutorial assumes that you want to do the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Write all directives for the <code class="codeph">sh</code> schema to persistent storage.
                           </p>
                        </li>
                        <li>
                           <p>Delete all directives for the <code class="codeph">sh</code> schema.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E__GUID-1338E18C-CA4B-4DC7-8D30-26AEDCDD56BB">To write and then delete all sh schema plan directives:</p>
                     <ol>
                        <li>
                           <p id="GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E__d5e29">In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                        </li>
                        <li>
                           <p>Force the database to write the SQL plan directives to disk.</p>
                           <p>For example, execute the following <code class="codeph">DBMS_SPD</code> program:
                           </p><pre class="pre codeblock"><code>BEGIN 
  DBMS_SPD.FLUSH_SQL_PLAN_DIRECTIVE;
END;
/
</code></pre></li>
                        <li>
                           <p>Query the data dictionary for information about existing directives in the <code class="codeph">sh</code> schema.
                           </p>
                           <p><a href="options-for-optimizer-statistics-gathering.html#GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E__CHDGCEBH">Example 12-3</a> queries the data dictionary for information about the directive.
                           </p>
                        </li>
                        <li>
                           <p>Delete the existing SQL plan directive for the <code class="codeph">sh</code> schema.
                           </p>
                           <p>The following PL/SQL program unit deletes the SQL plan directive with the ID <code class="codeph">1484026771529551585</code>:
                           </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SPD.DROP_SQL_PLAN_DIRECTIVE ( directive_id =&gt; 1484026771529551585 );
END;
/</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E__CHDGCEBH">
                     <p class="titleinexample">Example 12-3 Display Directives for sh Schema</p>
                     <p>This example shows SQL plan directives, and the results of SQL plan directive dynamic sampling queries.</p><pre class="pre codeblock"><code>SELECT TO_CHAR(d.DIRECTIVE_ID) dir_id, o.OWNER, o.OBJECT_NAME, 
       o.SUBOBJECT_NAME col_name, o.OBJECT_TYPE object, d.TYPE, 
       d.STATE, d.REASON
FROM   DBA_SQL_PLAN_DIRECTIVES d, DBA_SQL_PLAN_DIR_OBJECTS o
WHERE  d.DIRECTIVE_ID=o.DIRECTIVE_ID
AND    o.OWNER IN ('SH')
ORDER BY 1,2,3,4,5;
 
DIR_ID              OWN OBJECT_NA COL_NAME   OBJECT  TYPE     STATE      REASON
------------------- --- --------- ---------- ------- -------- ---------- ------------
1484026771529551585  SH CUSTOMERS COUNTRY_ID  COLUMN DYNAMIC_ SUPERSEDED SINGLE TABLE  
                                                     SAMPLING            CARDINALITY 
                                                                         MISESTIMATE
1484026771529551585  SH CUSTOMERS CUST_STATE_ COLUMN DYNAMIC_ SUPERSEDED SINGLE TABLE
                                  PROVINCE           SAMPLING            CARDINALITY 
                                                                         MISESTIMATE
1484026771529551585  SH CUSTOMERS              TABLE DYNAMIC_ SUPERSEDED SINGLE TABLE 
                                                     SAMPLING            CARDINALITY 
                                                                         MISESTIMATE
9781501826140511330  SH dyg4msnst5           SQL STA DYNAMIC_     USABLE VERIFY
                                             TEMENT  SAMPLING            CARDINALITY 
                                                     _RESULT             ESTIMATE
9872337207064898539  SH TIMES                  TABLE DYNAMIC_     USABLE VERIFY
                                                     SAMPLING            CARDINALITY 
                                                     _RESULT             ESTIMATE
9781501826140511330  SH 2nk1v0fdx0           SQL STA DYNAMIC_     USABLE VERIFY
                                             TEMENT  SAMPLING            CARDINALITY 
                                                     _RESULT             ESTIMATE
</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-67E635AA-F168-47D7-9DC9-CE8803464B6E__GUID-2C96D047-F9C3-4F24-8E71-C4FCEB01B494">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="optimizer-statistics-concepts.html#GUID-F8F25E31-7113-4B91-BD81-BE6082983192" title="A SQL plan directive is additional information and instructions that the optimizer can use to generate a more optimal plan.">SQL Plan Directives</a>"</span></p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_SPD.html#ARPLS73856" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for complete syntax and semantics for the <code class="codeph">DBMS_SPD</code> package.
                           </p>
                        </li>
                        <li>
                           <p><a href="../refrn/DBA_SQL_PLAN_DIRECTIVES.html#REFRN23823" target="_blank"><span class="italic">Oracle Database Reference</span></a> to learn about <code class="codeph">DBA_SQL_PLAN_DIRECTIVES</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="options-for-optimizer-statistics-gathering.html#GUID-2044960C-025B-44FC-9522-63F426C74386" title="This chapter explains what optimizer statistics collection is and how to set statistics preferences.">Configuring Options for Optimizer Statistics Gathering</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>