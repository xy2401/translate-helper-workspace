<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>PL/SQL Error Handling</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database PL/SQL Language Reference ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database PL/SQL Language Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-pl-sql-language-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-13T20:26:20-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96448-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="plsql-packages.html" title="Previous" type="text/html">
      <link rel="next" href="plsql-optimization-and-tuning.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Language Reference">
    <meta name="dcterms.isVersionOf" content="LNPLS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="plsql-packages.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="plsql-optimization-and-tuning.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database PL/SQL Language Reference </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">PL/SQL Error Handling</li>
            </ol>
            <a id="GUID-0502DC1A-F0A5-4180-A912-6A5CDC855F56" name="GUID-0502DC1A-F0A5-4180-A912-6A5CDC855F56"></a><a id="LNPLS725"></a><a id="LNPLS007"></a>
            
            <h2 id="LNPLS-GUID-0502DC1A-F0A5-4180-A912-6A5CDC855F56" class="sect2"><span class="enumeration_chapter">11 </span>PL/SQL Error Handling
            </h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='plsql-error-handling'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
            </noscript>
            <div>
               <p>This chapter explains how to handle PL/SQL compile-time warnings and PL/SQL runtime errors. The latter are called <span class="bold">exceptions</span>.
               </p>
               <div class="infoboxnote" id="GUID-0502DC1A-F0A5-4180-A912-6A5CDC855F56__GUID-A79E7544-F6B5-4F4F-B927-27B07732E32D">
                  <p class="notep1">Note:</p>
                  <p>The language of warning and error messages depends on the <code class="codeph">NLS_LANGUAGE</code> parameter. For information about this parameter, see <a href="../nlspg/setting-up-globalization-support-environment.html#NLSPG199" target="_blank"><span class="italic">Oracle Database Globalization Support Guide</span></a>.
                  </p>
               </div>
               <div class="section">
                  <p class="subhead1" id="GUID-0502DC1A-F0A5-4180-A912-6A5CDC855F56__GUID-FE21EFFC-F9F3-4484-A458-3498EDA2D0F4">Topics</p>
               </div>
               <!-- class="section" -->
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-3311B813-3185-4751-A3A6-309B93973366" title="While compiling stored PL/SQL units, the PL/SQL compiler generates warnings for conditions that are not serious enough to cause errors and prevent compilation—for example, using a deprecated PL/SQL feature.">Compile-Time Warnings</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-343E0653-9BCE-48F5-A00A-795D77B96B44">Overview of Exception Handling</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-4F0787E6-ABCA-4860-A28E-435C7FE15154">Internally Defined Exceptions</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6">Predefined Exceptions</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-8844A6D8-FE6F-4DFF-B449-59AB076316C1">User-Defined Exceptions</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-C98B60A9-3931-4F8D-BE13-205A1779596D">Redeclared Predefined Exceptions</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-66346B68-7A18-438C-951B-A60F970D98B8">Raising Exceptions Explicitly</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB">Exception Propagation</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-494984A3-37E6-41BF-9BB9-05A693CD9577">Unhandled Exceptions</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-7E0CDD98-D31C-4745-B819-B5C5E1DF90A8">Retrieving Error Code and Error Message</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-E63131E7-4AE6-4C47-8D21-5EC1F6D3AA68">Continuing Execution After Handling Exceptions</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-CF7B91D7-215F-48D7-AE83-240012CE8ED6">Retrying Transactions After Handling Exceptions</a></p>
                  </li>
                  <li>
                     <p><a href="plsql-error-handling.html#GUID-6B966875-B27C-4FDF-8334-8FB3B22ABF4A">Handling Errors in Distributed Queries</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-0502DC1A-F0A5-4180-A912-6A5CDC855F56__GUID-259299D7-DFBB-4A11-B67B-227D5CE7D490">
                  <p class="notep1">See Also:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="q">"<a href="plsql-triggers.html#GUID-FA7A16B6-F94D-4E4C-A326-F602FE9FE3E8">Exception Handling in Triggers</a>"</span></p>
                     </li>
                     <li>
                        <p><span class="q">"<a href="plsql-optimization-and-tuning.html#GUID-DAF46F06-EF3F-4B1A-A518-5238B80C69FA" title="To allow a FORALL statement to continue even if some of its DML statements fail, include the SAVE EXCEPTIONS clause. When a DML statement fails, PL/SQL does not raise an exception; instead, it saves information about the failure. After the FORALL statement completes, PL/SQL raises a single exception for the FORALL statement (ORA-24381).">Handling FORALL Exceptions After FORALL Statement Completes</a>"</span></p>
                     </li>
                  </ul>
               </div>
               <div class="infobox-tip" id="GUID-0502DC1A-F0A5-4180-A912-6A5CDC855F56__GUID-4C263734-9F93-4DBB-804A-ECCF5F973199">
                  <p class="notep1">Tip:</p>
                  <p>If you have problems creating or running PL/SQL code, check the Oracle Database trace files. The <code class="codeph">DIAGNOSTIC_DEST</code> initialization parameter specifies the current location of the trace files. You can find the value of this parameter by issuing <code class="codeph">SHOW</code> <code class="codeph">PARAMETER</code> <code class="codeph">DIAGNOSTIC_DEST</code> or query the <code class="codeph">V$DIAG_INFO</code> view. For more information about diagnostic data, see <a href="../admin/diagnosing-and-resolving-problems.html#ADMIN11007" target="_blank"><span class="italic">Oracle Database Administrator’s Guide</span></a>.
                  </p>
               </div>
            </div><a id="LNPLS858"></a><a id="LNPLS860"></a><a id="LNPLS00711"></a><div class="props_rev_3"><a id="GUID-3311B813-3185-4751-A3A6-309B93973366" name="GUID-3311B813-3185-4751-A3A6-309B93973366"></a><h3 id="LNPLS-GUID-3311B813-3185-4751-A3A6-309B93973366" class="sect3"><span class="enumeration_section">11.1 </span>Compile-Time Warnings
               </h3>
               <div>
                  <p>While compiling stored PL/SQL units, the PL/SQL compiler generates warnings for conditions that are not serious enough to cause errors and prevent compilation—for example, using a deprecated PL/SQL feature.</p>
                  <p>To see warnings (and errors) generated during compilation, either query the static data dictionary view <code class="codeph">*_ERRORS</code> or, in the SQL*Plus environment, use the command <code class="codeph">SHOW</code> <code class="codeph">ERRORS</code>.
                  </p>
                  <p>The message code of a PL/SQL warning has the form PLW-<span class="italic">nnnnn</span>. 
                  </p>
                  <div class="tblformal" id="GUID-3311B813-3185-4751-A3A6-309B93973366__BCFFJBII">
                     <p class="titleintable">Table 11-1 Compile-Time Warning Categories</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Compile-Time Warning Categories" summary="This table summarizes the categories of PL/SQL warnings." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="21%" id="d82955e359">Category</th>
                              <th align="left" valign="bottom" width="42%" id="d82955e362">Description</th>
                              <th align="left" valign="bottom" width="37%" id="d82955e365">Example</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d82955e370" headers="d82955e359 ">
                                 <p><code class="codeph">SEVERE</code></p>
                              </td>
                              <td align="left" valign="top" width="42%" headers="d82955e370 d82955e362 ">
                                 <p>Condition might cause unexpected action or wrong results.</p>
                              </td>
                              <td align="left" valign="top" width="37%" headers="d82955e370 d82955e365 ">
                                 <p>Aliasing problems with parameters</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d82955e381" headers="d82955e359 ">
                                 <p><code class="codeph">PERFORMANCE</code></p>
                              </td>
                              <td align="left" valign="top" width="42%" headers="d82955e381 d82955e362 ">
                                 <p>Condition might cause performance problems.</p>
                              </td>
                              <td align="left" valign="top" width="37%" headers="d82955e381 d82955e365 ">
                                 <p>Passing a <code class="codeph">VARCHAR2</code> value to a <code class="codeph">NUMBER</code> column in an <code class="codeph">INSERT</code> statement
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="21%" id="d82955e401" headers="d82955e359 ">
                                 <p><code class="codeph">INFORMATIONAL</code></p>
                              </td>
                              <td align="left" valign="top" width="42%" headers="d82955e401 d82955e362 ">
                                 <p>Condition does not affect performance or correctness, but you might want to change it to make the code more maintainable.</p>
                              </td>
                              <td align="left" valign="top" width="37%" headers="d82955e401 d82955e365 ">
                                 <p>Code that can never run</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>By setting the compilation parameter <code class="codeph">PLSQL_WARNINGS</code>, you can:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Enable and disable all warnings, one or more categories of warnings, or specific warnings</p>
                     </li>
                     <li>
                        <p>Treat specific warnings as errors (so that those conditions must be corrected before you can compile the PL/SQL unit)</p>
                     </li>
                  </ul>
                  <p>You can set the value of <code class="codeph">PLSQL_WARNINGS</code> for:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Your Oracle database instance</p>
                        <p>Use the <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement, described in <a href="../sqlrf/ALTER-SYSTEM.html#SQLRF00902" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a>.
                        </p>
                     </li>
                     <li>
                        <p>Your session</p>
                        <p>Use the <code class="codeph">ALTER</code> <code class="codeph">SESSION</code> statement, described in <a href="../sqlrf/ALTER-SESSION.html#SQLRF00901" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a>.
                        </p>
                     </li>
                     <li>
                        <p>A stored PL/SQL unit</p>
                        <p>Use an <code class="codeph">ALTER</code> statement from <span class="q">"<a href="sql-statements-for-stored-plsql-units.html#GUID-C918310F-F1BB-41D7-9466-B558B70DDFFE__BABEFIJF">ALTER Statements</a>"</span> with its <span class="italic"><code class="codeph">compiler_parameters_clause</code></span>.
                        </p>
                     </li>
                  </ul>
                  <p>In any of the preceding <code class="codeph">ALTER</code> statements, you set the value of <code class="codeph">PLSQL_WARNINGS</code> with this syntax:
                  </p><pre class="oac_no_warn" dir="ltr">PLSQL_WARNINGS = '<span class="italic">value_clause</span>' [, '<span class="italic">value_clause</span>' ] ...
</pre><p>For the syntax of <span class="italic"><code class="codeph">value_clause</code></span>, see <a href="../refrn/PLSQL_WARNINGS.html#REFRN10249" target="_blank"><span class="italic">Oracle Database Reference</span></a>.
                  </p>
                  <p>To display the current value of <code class="codeph">PLSQL_WARNINGS</code>, query the static data dictionary view <code class="codeph">ALL_PLSQL_OBJECT_SETTINGS</code>.
                  </p>
                  <div class="infoboxnotealso" id="GUID-3311B813-3185-4751-A3A6-309B93973366__GUID-28A20727-19D4-48A3-9D5E-2F9B4E3B3540">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../refrn/ALL_PLSQL_OBJECT_SETTINGS.html#REFRN20385" target="_blank"><span class="italic">Oracle Database Reference</span></a>  for more information about the static data dictionary view <code class="codeph">ALL_PLSQL_OBJECT_SETTINGS</code></p>
                        </li>
                        <li>
                           <p><a href="../errmg/using-messages.html#ERRMG-GUID-CA5A766D-6CBF-4235-982F-86A6F34266CC" target="_blank"><span class="italic">Oracle Database Error Messages Reference</span></a> for the message codes of all PL/SQL warnings
                           </p>
                        </li>
                        <li>
                           <p><a href="../refrn/ALL_ERRORS.html#REFRN20065" target="_blank"><span class="italic">Oracle Database Reference</span></a> for more information about the static data dictionary view <code class="codeph">*_ERRORS</code></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="overview.html#GUID-DF63BC59-22C2-4BA8-9240-F74D505D5102" title="PL/SQL units are affected by PL/SQL compilation parameters (a category of database initialization parameters). Different PL/SQL units—for example, a package specification and its body—can have different compilation parameter settings.">PL/SQL Units and Compilation Parameters</a>"</span> for more information about PL/SQL units and compiler parameters
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="example" id="GUID-3311B813-3185-4751-A3A6-309B93973366__CHDIDDFJ">
                     <p class="titleinexample">Example 11-1 Setting Value of PLSQL_WARNINGS Compilation Parameter</p>
                     <p>This example shows several <code class="codeph">ALTER</code> statements that set the value of <code class="codeph">PLSQL_WARNINGS</code>.
                     </p>
                     <p>For the session, enable all warnings—highly recommended during development:</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET PLSQL_WARNINGS='ENABLE:ALL';
</pre><p>For the session, enable <code class="codeph">PERFORMANCE</code> warnings:
                     </p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET PLSQL_WARNINGS='ENABLE:PERFORMANCE';
</pre><p>For the procedure <code class="codeph">loc_var</code>, enable <code class="codeph">PERFORMANCE</code> warnings, and reuse settings:
                     </p><pre class="oac_no_warn" dir="ltr">ALTER PROCEDURE loc_var
  COMPILE PLSQL_WARNINGS='ENABLE:PERFORMANCE'
  REUSE SETTINGS;
</pre><p>For the session, enable <code class="codeph">SEVERE</code> warnings, disable <code class="codeph">PERFORMANCE</code> warnings, and treat PLW-06002 warnings as errors:
                     </p><pre class="oac_no_warn" dir="ltr">ALTER SESSION
  SET PLSQL_WARNINGS='ENABLE:SEVERE', 'DISABLE:PERFORMANCE', 'ERROR:06002';
</pre><p>For the session, disable all warnings:</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET PLSQL_WARNINGS='DISABLE:ALL';
</pre></div>
                  <!-- class="example" -->
               </div><a id="LNPLS862"></a><a id="LNPLS861"></a><div class="props_rev_3"><a id="GUID-1E14A3FD-C1FB-466D-9700-1333293BBF7E" name="GUID-1E14A3FD-C1FB-466D-9700-1333293BBF7E"></a><h4 id="LNPLS-GUID-1E14A3FD-C1FB-466D-9700-1333293BBF7E" class="sect4"><span class="enumeration_section">11.1.1 </span>DBMS_WARNING Package
                  </h4>
                  <div>
                     <p>If you are writing PL/SQL units in a development environment that compiles them (such as SQL*Plus), you can display and set the value of <code class="codeph">PLSQL_WARNINGS</code> by invoking subprograms in the <code class="codeph">DBMS_WARNING</code> package.
                     </p>
                     <p><a href="plsql-error-handling.html#GUID-1E14A3FD-C1FB-466D-9700-1333293BBF7E__BABDGEJA">Example 11-2</a> uses an <code class="codeph">ALTER</code> <code class="codeph">SESSION</code> statement to disable all warning messages for the session and then compiles a procedure that has unreachable code. The procedure compiles without warnings. Next, the example enables all warnings for the session by invoking <code class="codeph">DBMS_WARNING.set_warning_setting_string</code> and displays the value of <code class="codeph">PLSQL_WARNINGS</code> by invoking <code class="codeph">DBMS_WARNING.get_warning_setting_string</code>. Finally, the example recompiles the procedure, and the compiler generates a warning about the unreachable code.
                     </p>
                     <div class="infoboxnote" id="GUID-1E14A3FD-C1FB-466D-9700-1333293BBF7E__GUID-3E20B002-70EC-4B9A-B59A-4CE055DB588A">
                        <p class="notep1">Note:</p>
                        <p>Unreachable code could represent a mistake or be intentionally hidden by a debug flag.</p>
                     </div>
                     <p><code class="codeph">DBMS_WARNING</code> subprograms are useful when you are compiling a complex application composed of several nested SQL*Plus scripts, where different subprograms need different <code class="codeph">PLSQL_WARNINGS</code> settings. With <code class="codeph">DBMS_WARNING</code> subprograms, you can save the current <code class="codeph">PLSQL_WARNINGS</code> setting, change the setting to compile a particular set of subprograms, and then restore the setting to its original value.
                     </p>
                     <div class="infoboxnotealso" id="GUID-1E14A3FD-C1FB-466D-9700-1333293BBF7E__GUID-17B616F9-755C-4540-A939-D87B0E6F9EE1">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_WARNING.html#ARPLS370" target="_blank"><span class="italic"> Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about the <code class="codeph">DBMS_WARNING</code> package
                        </p>
                     </div>
                     <div class="example" id="GUID-1E14A3FD-C1FB-466D-9700-1333293BBF7E__BABDGEJA">
                        <p class="titleinexample">Example 11-2 Displaying and Setting PLSQL_WARNINGS with DBMS_WARNING Subprograms</p>
                        <p>Disable all warning messages for this session:</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET PLSQL_WARNINGS='DISABLE:ALL';
</pre><p>With warnings disabled, this procedure compiles with no warnings:</p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PROCEDURE unreachable_code AUTHID DEFINER AS
  x CONSTANT BOOLEAN := TRUE;
BEGIN
  IF x THEN
    DBMS_OUTPUT.PUT_LINE('TRUE');
  ELSE
    DBMS_OUTPUT.PUT_LINE('FALSE');
  END IF;
END unreachable_code;
/</pre><p>Enable all warning messages for this session:</p><pre class="oac_no_warn" dir="ltr"><span class="bold">CALL DBMS_WARNING.set_warning_setting_string ('ENABLE:ALL', 'SESSION');</span>
</pre><p>Check warning setting:</p><pre class="oac_no_warn" dir="ltr"><span class="bold">SELECT DBMS_WARNING.get_warning_setting_string() FROM DUAL;</span>
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">DBMS_WARNING.GET_WARNING_SETTING_STRING()
-----------------------------------------
 
ENABLE:ALL
 
1 row selected.
</pre><p>Recompile procedure:</p><pre class="oac_no_warn" dir="ltr">ALTER PROCEDURE unreachable_code COMPILE;
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">SP2-0805: Procedure altered with compilation warnings
</pre><p>Show errors:</p><pre class="oac_no_warn" dir="ltr">SHOW ERRORS
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Errors for PROCEDURE UNREACHABLE_CODE:
 
LINE/COL ERROR
-------- -----------------------------------------------------------------
7/5      PLW-06002: Unreachable code
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="LNPLS726"></a><a id="LNPLS00701"></a><div class="props_rev_3"><a id="GUID-343E0653-9BCE-48F5-A00A-795D77B96B44" name="GUID-343E0653-9BCE-48F5-A00A-795D77B96B44"></a><h3 id="LNPLS-GUID-343E0653-9BCE-48F5-A00A-795D77B96B44" class="sect3"><span class="enumeration_section">11.2 </span>Overview of Exception Handling
               </h3>
               <div>
                  <p>Exceptions (PL/SQL runtime errors) can arise from design faults, coding mistakes, hardware failures, and many other sources. You cannot anticipate all possible exceptions, but you can write exception handlers that let your program to continue to operate in their presence.</p>
                  <p>Any PL/SQL block can have an exception-handling part, which can have one or more exception handlers. For example, an exception-handling part could have this syntax:</p><pre class="oac_no_warn" dir="ltr">EXCEPTION
  WHEN <span class="italic">ex_name_1</span> THEN <span class="italic">statements_1</span>                 -- Exception handler
  WHEN <span class="italic">ex_name_2</span> OR <span class="italic">ex_name_3</span> THEN <span class="italic">statements_2</span>  -- Exception handler
  WHEN OTHERS THEN <span class="italic">statements_3</span>                      -- Exception handler
END;
</pre><p>In the preceding syntax example, <span class="italic"><code class="codeph">ex_name_</code></span><code class="codeph">n</code> is the name of an exception and <span class="italic"><code class="codeph">statements_</code></span><code class="codeph">n</code> is one or more statements. (For complete syntax and semantics, see <span class="q">"<a href="exception-handler.html#GUID-3FECF29B-A240-4191-A635-92C612D00C4D" title="An exception handler processes a raised exception.">Exception Handler</a>"</span>.)
                  </p>
                  <p>When an exception is raised in the executable part of the block, the executable part stops and control transfers to the exception-handling part. If <span class="italic"><code class="codeph">ex_name_1</code></span> was raised, then <span class="italic"><code class="codeph">statements_1</code></span> run. If either <span class="italic"><code class="codeph">ex_name_2</code></span> or <span class="italic"><code class="codeph">ex_name_3</code></span> was raised, then <span class="italic"><code class="codeph">statements_2</code></span> run. If any other exception was raised, then <span class="italic"><code class="codeph">statements_3</code></span> run.
                  </p>
                  <p>After an exception handler runs, control transfers to the next statement of the enclosing block. If there is no enclosing block, then:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If the exception handler is in a subprogram, then control returns to the invoker, at the statement after the invocation.</p>
                     </li>
                     <li>
                        <p>If the exception handler is in an anonymous block, then control transfers to the host environment (for example, SQL*Plus)</p>
                     </li>
                  </ul>
                  <p>If an exception is raised in a block that has no exception handler for it, then the exception propagates. That is, the exception reproduces itself in successive enclosing blocks until a block has a handler for it or there is no enclosing block (for more information, see <span class="q">"<a href="plsql-error-handling.html#GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB">Exception Propagation</a>"</span>). If there is no handler for the exception, then PL/SQL returns an unhandled exception error to the invoker or host environment, which determines the outcome (for more information, see <span class="q">"<a href="plsql-error-handling.html#GUID-494984A3-37E6-41BF-9BB9-05A693CD9577">Unhandled Exceptions</a>"</span>).
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-343E0653-9BCE-48F5-A00A-795D77B96B44__GUID-80F067F8-7CA5-40F5-ABED-5B3CCD8DD425">Topics</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="plsql-error-handling.html#GUID-380AD917-BC6A-4444-9CDF-C9E232CDFBB8">Exception Categories</a></p>
                        </li>
                        <li>
                           <p><a href="plsql-error-handling.html#GUID-E91802C5-02CB-477F-8A58-89982BBBA5FF">Advantages of Exception Handlers</a></p>
                        </li>
                        <li>
                           <p><a href="plsql-error-handling.html#GUID-F3811176-28A0-4987-A363-C0E6F660185B">Guidelines for Avoiding and Handling Exceptions</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="LNPLS728"></a><a id="LNPLS99872"></a><div class="props_rev_3"><a id="GUID-380AD917-BC6A-4444-9CDF-C9E232CDFBB8" name="GUID-380AD917-BC6A-4444-9CDF-C9E232CDFBB8"></a><h4 id="LNPLS-GUID-380AD917-BC6A-4444-9CDF-C9E232CDFBB8" class="sect4"><span class="enumeration_section">11.2.1 </span>Exception Categories
                  </h4>
                  <div>
                     <p>The exception categories are:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">Internally defined</span></p>
                           <p>The runtime system raises internally defined exceptions implicitly (automatically). Examples of internally defined exceptions are ORA-00060 (deadlock detected while waiting for resource) and ORA-27102 (out of memory).</p>
                           <p>An internally defined exception always has an error code, but does not have a name unless PL/SQL gives it one or you give it one.</p>
                           <p>For more information, see <span class="q">"<a href="plsql-error-handling.html#GUID-4F0787E6-ABCA-4860-A28E-435C7FE15154">Internally Defined Exceptions</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Predefined</span></p>
                           <p>A predefined exception is an internally defined exception that PL/SQL has given a name. For example, ORA-06500 (PL/SQL: storage error) has the predefined name <code class="codeph">STORAGE_ERROR</code>.
                           </p>
                           <p>For more information, see <span class="q">"<a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6">Predefined Exceptions</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">User-defined</span></p>
                           <p>You can declare your own exceptions in the declarative part of any PL/SQL anonymous block, subprogram, or package. For example, you might declare an exception named <code class="codeph">insufficient_funds</code> to flag overdrawn bank accounts.
                           </p>
                           <p>You must raise user-defined exceptions explicitly.</p>
                           <p>For more information, see <span class="q">"<a href="plsql-error-handling.html#GUID-8844A6D8-FE6F-4DFF-B449-59AB076316C1">User-Defined Exceptions</a>"</span>.
                           </p>
                        </li>
                     </ul>
                     <p><a href="plsql-error-handling.html#GUID-380AD917-BC6A-4444-9CDF-C9E232CDFBB8__BABEDCFJ" title="This table summarizes the information in the preceding text. It has three rows, one for each exception category, and six columns.">Table 11-2</a> summarizes the exception categories.
                     </p>
                     <div class="tblformal" id="GUID-380AD917-BC6A-4444-9CDF-C9E232CDFBB8__BABEDCFJ">
                        <p class="titleintable">Table 11-2 Exception Categories</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Exception Categories" summary="This table summarizes the information in the preceding text. It has three rows, one for each exception category, and six columns." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="12%" id="d82955e1133">Category</th>
                                 <th align="left" valign="bottom" width="7%" id="d82955e1136">Definer</th>
                                 <th align="left" valign="bottom" width="8%" id="d82955e1139">Has Error Code</th>
                                 <th align="left" valign="bottom" width="8%" id="d82955e1142">Has Name</th>
                                 <th align="left" valign="bottom" width="8%" id="d82955e1145">Raised Implicitly</th>
                                 <th align="left" valign="bottom" width="57%" id="d82955e1148">Raised Explicitly</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="12%" id="d82955e1153" headers="d82955e1133 ">
                                    <p>Internally defined</p>
                                 </td>
                                 <td align="left" valign="top" width="7%" headers="d82955e1153 d82955e1136 ">
                                    <p>Runtime system</p>
                                 </td>
                                 <td align="left" valign="top" width="8%" headers="d82955e1153 d82955e1139 ">
                                    <p>Always</p>
                                 </td>
                                 <td align="left" valign="top" width="8%" headers="d82955e1153 d82955e1142 ">
                                    <p>Only if you assign one</p>
                                 </td>
                                 <td align="left" valign="top" width="8%" headers="d82955e1153 d82955e1145 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d82955e1153 d82955e1148 ">
                                    <p>Optionally<a id="GUID-380AD917-BC6A-4444-9CDF-C9E232CDFBB8__BABDABEJ" name="GUID-380AD917-BC6A-4444-9CDF-C9E232CDFBB8__BABDABEJ" href="#GUID-380AD917-BC6A-4444-9CDF-C9E232CDFBB8__BABDABEJ" onclick="footdisplay(1, "For details, see \"Raising Internally Defined Exception with RAISE Statement\".")"><sup>Foot&nbsp;1</sup></a></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="12%" id="d82955e1180" headers="d82955e1133 ">
                                    <p>Predefined</p>
                                 </td>
                                 <td align="left" valign="top" width="7%" headers="d82955e1180 d82955e1136 ">
                                    <p>Runtime system</p>
                                 </td>
                                 <td align="left" valign="top" width="8%" headers="d82955e1180 d82955e1139 ">
                                    <p>Always</p>
                                 </td>
                                 <td align="left" valign="top" width="8%" headers="d82955e1180 d82955e1142 ">
                                    <p>Always</p>
                                 </td>
                                 <td align="left" valign="top" width="8%" headers="d82955e1180 d82955e1145 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d82955e1180 d82955e1148 ">
                                    <p>Optionally<a id="fnsrc_d82955e1198" name="fnsrc_d82955e1198" href="#fnsrc_d82955e1198" onclick="footdisplay(1, "For details, see \"Raising Internally Defined Exception with RAISE Statement\".")"><sup>Footref&nbsp;1</sup></a></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="12%" id="d82955e1201" headers="d82955e1133 ">
                                    <p>User-defined</p>
                                 </td>
                                 <td align="left" valign="top" width="7%" headers="d82955e1201 d82955e1136 ">
                                    <p>User</p>
                                 </td>
                                 <td align="left" valign="top" width="8%" headers="d82955e1201 d82955e1139 ">
                                    <p>Only if you assign one</p>
                                 </td>
                                 <td align="left" valign="top" width="8%" headers="d82955e1201 d82955e1142 ">
                                    <p>Always</p>
                                 </td>
                                 <td align="left" valign="top" width="8%" headers="d82955e1201 d82955e1145 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d82955e1201 d82955e1148 ">
                                    <p>Always</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1 </sup></p><p>For details, see <span class="q">"<a href="plsql-error-handling.html#GUID-4A73BF41-AA57-4F64-8E4C-265029BEEF39">Raising Internally Defined Exception with RAISE Statement</a>"</span>.
                        </p>
                     <p></p>
                     <p>For a named exception, you can write a specific exception handler, instead of handling it with an <code class="codeph">OTHERS</code> exception handler. A specific exception handler is more efficient than an <code class="codeph">OTHERS</code> exception handler, because the latter must invoke a function to determine which exception it is handling. For details, see <span class="q">"<a href="plsql-error-handling.html#GUID-7E0CDD98-D31C-4745-B819-B5C5E1DF90A8">Retrieving Error Code and Error Message</a>"</span>.
                     </p>
                  </div>
               </div><a id="LNPLS828"></a><a id="LNPLS856"></a><a id="LNPLS00702"></a><div class="props_rev_3"><a id="GUID-E91802C5-02CB-477F-8A58-89982BBBA5FF" name="GUID-E91802C5-02CB-477F-8A58-89982BBBA5FF"></a><h4 id="LNPLS-GUID-E91802C5-02CB-477F-8A58-89982BBBA5FF" class="sect4"><span class="enumeration_section">11.2.2 </span>Advantages of Exception Handlers
                  </h4>
                  <div>
                     <p>Using exception handlers for error-handling makes programs easier to write and understand, and reduces the likelihood of unhandled exceptions.</p>
                     <p>Without exception handlers, you must check for every possible error, everywhere that it might occur, and then handle it. It is easy to overlook a possible error or a place where it might occur, especially if the error is not immediately detectable (for example, bad data might be undetectable until you use it in a calculation). Error-handling code is scattered throughout the program.</p>
                     <p>With exception handlers, you need not know every possible error or everywhere that it might occur. You need only include an exception-handling part in each block where errors might occur. In the exception-handling part, you can include exception handlers for both specific and unknown errors. If an error occurs anywhere in the block (including inside a sub-block), then an exception handler handles it. Error-handling code is isolated in the exception-handling parts of the blocks.</p>
                     <p>In <a href="plsql-error-handling.html#GUID-E91802C5-02CB-477F-8A58-89982BBBA5FF__BABFBHGA">Example 11-3</a>, a procedure uses a single exception handler to handle the predefined exception <code class="codeph">NO_DATA_FOUND</code>, which can occur in either of two <code class="codeph">SELECT</code> <code class="codeph">INTO</code> statements.
                     </p>
                     <p>If multiple statements use the same exception handler, and you want to know which statement failed, you can use locator variables, as in <a href="plsql-error-handling.html#GUID-E91802C5-02CB-477F-8A58-89982BBBA5FF__BCFCFBDD">Example 11-4</a>.
                     </p>
                     <p>You determine the precision of your error-handling code. You can have a single exception handler for all division-by-zero errors, bad array indexes, and so on. You can also check for errors in a single statement by putting that statement inside a block with its own exception handler.</p>
                     <div class="example" id="GUID-E91802C5-02CB-477F-8A58-89982BBBA5FF__BABFBHGA">
                        <p class="titleinexample">Example 11-3 Single Exception Handler for Multiple Exceptions</p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PROCEDURE select_item (
  t_column VARCHAR2,
  t_name   VARCHAR2
) AUTHID DEFINER
IS
  temp VARCHAR2(30);
BEGIN
  temp := t_column;  -- For error message if next SELECT fails
 
  -- Fails if table t_name does not have column t_column:
 
  SELECT COLUMN_NAME INTO temp
  FROM USER_TAB_COLS 
  WHERE TABLE_NAME = UPPER(t_name)
  AND COLUMN_NAME = UPPER(t_column);
 
  temp := t_name;  -- For error message if next SELECT fails
 
  -- Fails if there is no table named t_name:
 
  SELECT OBJECT_NAME INTO temp
  FROM USER_OBJECTS
  WHERE OBJECT_NAME = UPPER(t_name)
  AND OBJECT_TYPE = 'TABLE';
 
EXCEPTION
  <span class="bold">WHEN NO_DATA_FOUND THEN</span>
    <span class="bold">DBMS_OUTPUT.PUT_LINE ('No Data found for SELECT on ' || temp);</span>
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE ('Unexpected error');
    RAISE;
END;
/
</pre><p>Invoke procedure (there is a <code class="codeph">DEPARTMENTS</code> table, but it does not have a <code class="codeph">LAST_NAME</code> column):
                        </p><pre class="oac_no_warn" dir="ltr">BEGIN
  select_item('departments', 'last_name');
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr"><span class="bold">No Data found for SELECT on departments</span>
</pre><p>Invoke procedure (there is no <code class="codeph">EMP</code> table):
                        </p><pre class="oac_no_warn" dir="ltr">BEGIN
  select_item('emp', 'last_name');
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr"><span class="bold">No Data found for SELECT on emp</span>
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E91802C5-02CB-477F-8A58-89982BBBA5FF__BCFCFBDD">
                        <p class="titleinexample">Example 11-4 Locator Variables for Statements that Share Exception Handler</p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PROCEDURE loc_var AUTHID DEFINER IS
  stmt_no  POSITIVE;
  name_    VARCHAR2(100);
BEGIN
  <span class="bold">stmt_no := 1;</span>

  SELECT table_name INTO name_
  FROM user_tables
  WHERE table_name LIKE 'ABC%';

  <span class="bold">stmt_no := 2;</span>

  SELECT table_name INTO name_
  FROM user_tables
  WHERE table_name LIKE 'XYZ%';
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    DBMS_OUTPUT.PUT_LINE ('Table name not found in query ' || <span class="bold">stmt_no</span>);
END;
/
CALL loc_var();
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr"><span class="bold">Table name not found in query 1</span>
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="LNPLS00712"></a><div class="props_rev_3"><a id="GUID-F3811176-28A0-4987-A363-C0E6F660185B" name="GUID-F3811176-28A0-4987-A363-C0E6F660185B"></a><h4 id="LNPLS-GUID-F3811176-28A0-4987-A363-C0E6F660185B" class="sect4"><span class="enumeration_section">11.2.3 </span>Guidelines for Avoiding and Handling Exceptions
                  </h4>
                  <div>
                     <p>To make your programs as reliable and safe as possible:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Use both error-checking code and exception handlers.</p>
                           <p>Use error-checking code wherever bad input data can cause an error. Examples of bad input data are incorrect or null actual parameters and queries that return no rows or more rows than you expect. Test your code with different combinations of bad input data to see what potential errors arise.</p>
                           <p>Sometimes you can use error-checking code to avoid raising an exception, as in <a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__CHDIFEDH">Example 11-7</a>. 
                           </p>
                        </li>
                        <li>
                           <p>Add exception handlers wherever errors can occur.</p>
                           <p>Errors are especially likely during arithmetic calculations, string manipulation, and database operations. Errors can also arise from problems that are independent of your code—for example, disk storage or memory hardware failure—but your code still must take corrective action.</p>
                        </li>
                        <li>
                           <p>Design your programs to work when the database is not in the state you expect.</p>
                           <p>For example, a table you query might have columns added or deleted, or their types might have changed. You can avoid problems by declaring scalar variables with <code class="codeph">%TYPE</code> qualifiers and record variables to hold query results with <code class="codeph">%ROWTYPE</code> qualifiers.
                           </p>
                        </li>
                        <li>
                           <p>Whenever possible, write exception handlers for named exceptions instead of using <code class="codeph">OTHERS</code> exception handlers.
                           </p>
                           <p>Learn the names and causes of the predefined exceptions. If you know that your database operations might raise specific internally defined exceptions that do not have names, then give them names so that you can write exception handlers specifically for them.</p>
                        </li>
                        <li>
                           <p>Have your exception handlers output debugging information.</p>
                           <p>If you store the debugging information in a separate table, do it with an autonomous routine, so that you can commit your debugging information even if you roll back the work that the main subprogram did. For information about autonomous routines, see <span class="q">"<a href="AUTONOMOUS_TRANSACTION-pragma.html#GUID-AD33D949-081B-4CD3-A240-C29773E908C3" title="The AUTONOMOUS_TRANSACTION pragma marks a routine as autonomous; that is, independent of the main transaction.">AUTONOMOUS_TRANSACTION Pragma</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p>For each exception handler, carefully decide whether to have it commit the transaction, roll it back, or let it continue.</p>
                           <p>Regardless of the severity of the error, you want to leave the database in a consistent state and avoid storing bad data.</p>
                        </li>
                        <li>
                           <p>Avoid unhandled exceptions by including an <code class="codeph">OTHERS</code> exception handler at the top level of every PL/SQL program.
                           </p>
                           <p>Make the last statement in the <code class="codeph">OTHERS</code> exception handler either <code class="codeph">RAISE</code> or an invocation of the <code class="codeph">RAISE_APPLICATION_ERROR</code> procedure. (If you do not follow this practice, and PL/SQL warnings are enabled, then you get PLW-06009.) For information about <code class="codeph">RAISE</code> or an invocation of the <code class="codeph">RAISE_APPLICATION_ERROR</code>, see <span class="q">"<a href="plsql-error-handling.html#GUID-66346B68-7A18-438C-951B-A60F970D98B8">Raising Exceptions Explicitly</a>"</span>.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="LNPLS729"></a><a id="LNPLS99871"></a><div class="props_rev_3"><a id="GUID-4F0787E6-ABCA-4860-A28E-435C7FE15154" name="GUID-4F0787E6-ABCA-4860-A28E-435C7FE15154"></a><h3 id="LNPLS-GUID-4F0787E6-ABCA-4860-A28E-435C7FE15154" class="sect3"><span class="enumeration_section">11.3 </span>Internally Defined Exceptions
               </h3>
               <div>
                  <p><span class="bold">Internally defined exceptions</span> (ORA-<span class="italic">n</span> errors) are described in <a href="../errmg/ORA-00000.html#ERRMG-GUID-27437B7F-F0C3-4F1F-9C6E-6780706FB0F6" target="_blank"><span class="italic">Oracle Database Error Messages Reference</span></a>. The runtime system raises them implicitly (automatically).
                  </p>
                  <p>An internally defined exception does not have a name unless either PL/SQL gives it one (see <span class="q">"<a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6">Predefined Exceptions</a>"</span>) or you give it one.
                  </p>
                  <p>If you know that your database operations might raise specific internally defined exceptions that do not have names, then give them names so that you can write exception handlers specifically for them. Otherwise, you can handle them only with <code class="codeph">OTHERS</code> exception handlers.
                  </p>
                  <p>To give a name to an internally defined exception, do the following in the declarative part of the appropriate anonymous block, subprogram, or package. (To determine the appropriate block, see <span class="q">"<a href="plsql-error-handling.html#GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB">Exception Propagation</a>"</span>.)
                  </p>
                  <ol>
                     <li>
                        <p>Declare the name.</p>
                        <p>An exception name declaration has this syntax:</p><pre class="oac_no_warn" dir="ltr"><span class="italic">exception_name</span> EXCEPTION;
</pre><p>For semantic information, see <span class="q">"<a href="exception-declaration.html#GUID-AAC8C54F-775C-4E65-B531-0350CFF5B1BD" title="An exception declaration declares the name of a user-defined exception.">Exception Declaration</a>"</span>.
                        </p>
                     </li>
                     <li>
                        <p>Associate the name with the error code of the internally defined exception.</p>
                        <p>The syntax is:</p><pre class="oac_no_warn" dir="ltr">PRAGMA EXCEPTION_INIT (<span class="italic">exception_name</span>, <span class="italic">error_code</span>)
</pre><p>For semantic information, see <span class="q">"<a href="EXCEPTION_INIT-pragma.html#GUID-873A087E-A470-4798-9152-16BC673B4940" title="The EXCEPTION_INIT pragma associates a user-defined exception name with an error code.">EXCEPTION_INIT Pragma</a>"</span>.
                        </p>
                     </li>
                  </ol>
                  <div class="infoboxnote" id="GUID-4F0787E6-ABCA-4860-A28E-435C7FE15154__GUID-19CD3551-D4F4-4795-80DF-C3D23905C1A8">
                     <p class="notep1">Note:</p>
                     <p>An internally defined exception with a user-declared name is still an internally defined exception, not a user-defined exception.</p>
                  </div>
                  <p><a href="plsql-error-handling.html#GUID-4F0787E6-ABCA-4860-A28E-435C7FE15154__BABBDJAB">Example 11-5</a> gives the name <code class="codeph">deadlock_detected</code> to the internally defined exception ORA-00060 (deadlock detected while waiting for resource) and uses the name in an exception handler.
                  </p>
                  <div class="infoboxnotealso" id="GUID-4F0787E6-ABCA-4860-A28E-435C7FE15154__GUID-611ECC9F-6771-4E27-8D3C-72A6DC394792">
                     <p class="notep1">See Also:</p>
                     <p><span class="q">"<a href="plsql-error-handling.html#GUID-4A73BF41-AA57-4F64-8E4C-265029BEEF39">Raising Internally Defined Exception with RAISE Statement</a>"</span></p>
                  </div>
                  <div class="example" id="GUID-4F0787E6-ABCA-4860-A28E-435C7FE15154__BABBDJAB">
                     <p class="titleinexample">Example 11-5 Naming Internally Defined Exception</p><pre class="oac_no_warn" dir="ltr">DECLARE
  <span class="bold">deadlock_detected EXCEPTION;</span>
  <span class="bold">PRAGMA EXCEPTION_INIT(deadlock_detected, -60);</span>
BEGIN
  ...
EXCEPTION
  <span class="bold">WHEN deadlock_detected THEN</span>
    ...
END;
/</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="LNPLS730"></a><a id="LNPLS827"></a><a id="LNPLS732"></a><a id="LNPLS1906"></a><a id="LNPLS00703"></a><div class="props_rev_3"><a id="GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6" name="GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6"></a><h3 id="LNPLS-GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6" class="sect3"><span class="enumeration_section">11.4 </span>Predefined Exceptions
               </h3>
               <div>
                  <p><span class="bold">Predefined exceptions</span> are internally defined exceptions that have predefined names, which PL/SQL declares globally in the package <code class="codeph">STANDARD</code>. The runtime system raises predefined exceptions implicitly (automatically). Because predefined exceptions have names, you can write exception handlers specifically for them.
                  </p>
                  <p><a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__CIHHGGDI" title="This table gives the names and error numbers of the PL/SQL predefined exceptions.">Table 11-3</a> lists the names and error codes of the predefined exceptions.
                  </p>
                  <div class="tblformal" id="GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__CIHHGGDI">
                     <p class="titleintable">Table 11-3 PL/SQL Predefined Exceptions</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="PL/SQL Predefined Exceptions" summary="This table gives the names and error numbers of the PL/SQL predefined exceptions." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="38%" id="d82955e1948">Exception Name</th>
                              <th align="left" valign="bottom" width="62%" id="d82955e1952">Error Code</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e1957" headers="d82955e1948 ">
                                 <p><code class="codeph">ACCESS_INTO_NULL</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e1957 d82955e1952 ">
                                 <p><code class="codeph">-6530</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e1966" headers="d82955e1948 ">
                                 <p><code class="codeph">CASE_NOT_FOUND</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e1966 d82955e1952 ">
                                 <p><code class="codeph">-6592</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e1975" headers="d82955e1948 ">
                                 <p><code class="codeph">COLLECTION_IS_NULL</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e1975 d82955e1952 ">
                                 <p><code class="codeph">-6531</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e1984" headers="d82955e1948 ">
                                 <p><code class="codeph">CURSOR_ALREADY_OPEN</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e1984 d82955e1952 ">
                                 <p><code class="codeph">-6511</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e1993" headers="d82955e1948 ">
                                 <p><code class="codeph">DUP_VAL_ON_INDEX</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e1993 d82955e1952 ">
                                 <p><code class="codeph">-1</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2002" headers="d82955e1948 ">
                                 <p><code class="codeph">INVALID_CURSOR</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2002 d82955e1952 ">
                                 <p><code class="codeph">-1001</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2011" headers="d82955e1948 ">
                                 <p><code class="codeph">INVALID_NUMBER</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2011 d82955e1952 ">
                                 <p><code class="codeph">-1722</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2020" headers="d82955e1948 ">
                                 <p><code class="codeph">LOGIN_DENIED</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2020 d82955e1952 ">
                                 <p><code class="codeph">-1017</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2029" headers="d82955e1948 ">
                                 <p><code class="codeph">NO_DATA_FOUND</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2029 d82955e1952 ">
                                 <p><code class="codeph">+100</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2038" headers="d82955e1948 ">
                                 <p><code class="codeph">NO_DATA_NEEDED</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2038 d82955e1952 ">
                                 <p><code class="codeph">-6548</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2047" headers="d82955e1948 ">
                                 <p><code class="codeph">NOT_LOGGED_ON</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2047 d82955e1952 ">
                                 <p><code class="codeph">-1012</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2057" headers="d82955e1948 ">
                                 <p><code class="codeph">PROGRAM_ERROR</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2057 d82955e1952 ">
                                 <p><code class="codeph">-6501</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2066" headers="d82955e1948 ">
                                 <p><code class="codeph">ROWTYPE_MISMATCH</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2066 d82955e1952 ">
                                 <p><code class="codeph">-6504</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2075" headers="d82955e1948 ">
                                 <p><code class="codeph">SELF_IS_NULL</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2075 d82955e1952 ">
                                 <p><code class="codeph">-30625</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2084" headers="d82955e1948 ">
                                 <p><code class="codeph">STORAGE_ERROR</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2084 d82955e1952 ">
                                 <p><code class="codeph">-6500</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2093" headers="d82955e1948 ">
                                 <p><code class="codeph">SUBSCRIPT_BEYOND_COUNT</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2093 d82955e1952 ">
                                 <p><code class="codeph">-6533</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2102" headers="d82955e1948 ">
                                 <p><code class="codeph">SUBSCRIPT_OUTSIDE_LIMIT</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2102 d82955e1952 ">
                                 <p><code class="codeph">-6532</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2111" headers="d82955e1948 ">
                                 <p><code class="codeph">SYS_INVALID_ROWID</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2111 d82955e1952 ">
                                 <p><code class="codeph">-1410</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2120" headers="d82955e1948 ">
                                 <p><code class="codeph">TIMEOUT_ON_RESOURCE</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2120 d82955e1952 ">
                                 <p><code class="codeph">-51</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2129" headers="d82955e1948 ">
                                 <p><code class="codeph">TOO_MANY_ROWS</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2129 d82955e1952 ">
                                 <p><code class="codeph">-1422</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2138" headers="d82955e1948 ">
                                 <p><code class="codeph">VALUE_ERROR</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2138 d82955e1952 ">
                                 <p><code class="codeph">-6502</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="38%" id="d82955e2147" headers="d82955e1948 ">
                                 <p><code class="codeph">ZERO_DIVIDE</code></p>
                              </td>
                              <td align="left" valign="top" width="62%" headers="d82955e2147 d82955e1952 ">
                                 <p><code class="codeph">-1476</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p><a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__BABCBAEE">Example 11-6</a> calculates a price-to-earnings ratio for a company. If the company has zero earnings, the division operation raises the predefined exception <code class="codeph">ZERO_DIVIDE</code> and the executable part of the block transfers control to the exception-handling part.
                  </p>
                  <p><a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__CHDIFEDH">Example 11-7</a> uses error-checking code to avoid the exception that <a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__BABCBAEE">Example 11-6</a> handles.
                  </p>
                  <p>In <a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__CIHEFIIC">Example 11-8</a>, the procedure opens a cursor variable for either the <code class="codeph">EMPLOYEES</code> table or the <code class="codeph">DEPARTMENTS</code> table, depending on the value of the parameter <code class="codeph">discrim</code>. The anonymous block invokes the procedure to open the cursor variable for the <code class="codeph">EMPLOYEES</code> table, but fetches from the <code class="codeph">DEPARTMENTS</code> table, which raises the predefined exception <code class="codeph">ROWTYPE_MISMATCH</code>.
                  </p>
                  <div class="infoboxnotealso" id="GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__GUID-8B63A092-49BD-4A3D-BCF7-A7101357E078">
                     <p class="notep1">See Also:</p>
                     <p><span class="q">"<a href="plsql-error-handling.html#GUID-4A73BF41-AA57-4F64-8E4C-265029BEEF39">Raising Internally Defined Exception with RAISE Statement</a>"</span></p>
                  </div>
                  <div class="example" id="GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__BABCBAEE">
                     <p class="titleinexample">Example 11-6 Anonymous Block Handles ZERO_DIVIDE</p><pre class="oac_no_warn" dir="ltr">DECLARE
  stock_price   NUMBER := 9.73;
  <span class="bold">net_earnings  NUMBER := 0</span>;
  pe_ratio      NUMBER;
BEGIN
  pe_ratio := <span class="bold">stock_price / net_earnings</span>;  -- raises ZERO_DIVIDE exception
  DBMS_OUTPUT.PUT_LINE('Price/earnings ratio = ' || pe_ratio);
<span class="bold">EXCEPTION</span>
  <span class="bold">WHEN ZERO_DIVIDE</span> THEN
    DBMS_OUTPUT.PUT_LINE('Company had zero earnings.');
    pe_ratio := NULL;
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Company had zero earnings.
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__CHDIFEDH">
                     <p class="titleinexample">Example 11-7 Anonymous Block Avoids ZERO_DIVIDE</p><pre class="oac_no_warn" dir="ltr">DECLARE
  stock_price   NUMBER := 9.73;
  net_earnings  NUMBER := 0;
  pe_ratio      NUMBER;
BEGIN
  pe_ratio :=
    CASE net_earnings
      <span class="bold">WHEN 0 THEN NULL</span>
      <span class="bold">ELSE stock_price / net_earnings</span>
    END;
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__CIHEFIIC">
                     <p class="titleinexample">Example 11-8 Anonymous Block Handles ROWTYPE_MISMATCH</p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PACKAGE emp_dept_data AUTHID DEFINER AS
  TYPE cv_type IS REF CURSOR;
  
  PROCEDURE open_cv (
    cv       IN OUT cv_type,
    discrim  IN     POSITIVE
  );
  END emp_dept_data;
/
 
CREATE OR REPLACE PACKAGE BODY emp_dept_data AS
  PROCEDURE open_cv (
    cv      IN OUT cv_type,
    <span class="bold">discrim</span> IN     POSITIVE) IS
  BEGIN
    <span class="bold">IF discrim = 1 THEN</span>
    <span class="bold">OPEN cv FOR</span>
      <span class="bold">SELECT * FROM EMPLOYEES ORDER BY employee_id;</span>
    <span class="bold">ELSIF discrim = 2 THEN</span>
      <span class="bold">OPEN cv FOR</span>
        <span class="bold">SELECT * FROM DEPARTMENTS ORDER BY department_id;</span>
    <span class="bold">END IF;</span>
  END open_cv;
END emp_dept_data;
/
</pre><p>Invoke procedure <code class="codeph">open_cv</code> from anonymous block:
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
  emp_rec   EMPLOYEES%ROWTYPE;
  dept_rec  DEPARTMENTS%ROWTYPE;
  cv        Emp_dept_data.CV_TYPE;
BEGIN
  <span class="bold">emp_dept_data.open_cv(cv, 1);  -- Open cv for EMPLOYEES fetch.</span>
  <span class="bold">FETCH cv INTO dept_rec;        -- Fetch from DEPARTMENTS.</span>
  DBMS_OUTPUT.PUT(dept_rec.DEPARTMENT_ID);
  DBMS_OUTPUT.PUT_LINE('  ' || dept_rec.LOCATION_ID);
<span class="bold">EXCEPTION</span>
  <span class="bold">WHEN ROWTYPE_MISMATCH THEN</span>
     BEGIN
       DBMS_OUTPUT.PUT_LINE
         ('Row type mismatch, fetching EMPLOYEES data ...');
       FETCH cv INTO emp_rec;
       DBMS_OUTPUT.PUT(emp_rec.DEPARTMENT_ID);
       DBMS_OUTPUT.PUT_LINE('  ' || emp_rec.LAST_NAME);
     END;
END;
/</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr"><span class="bold">Row type mismatch, fetching EMPLOYEES data ...</span>
90  King</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="LNPLS00704"></a><div class="props_rev_3"><a id="GUID-8844A6D8-FE6F-4DFF-B449-59AB076316C1" name="GUID-8844A6D8-FE6F-4DFF-B449-59AB076316C1"></a><h3 id="LNPLS-GUID-8844A6D8-FE6F-4DFF-B449-59AB076316C1" class="sect3"><span class="enumeration_section">11.5 </span>User-Defined Exceptions
               </h3>
               <div>
                  <p>You can declare your own exceptions in the declarative part of any PL/SQL anonymous block, subprogram, or package.</p>
                  <p>An exception name declaration has this syntax:</p><pre class="oac_no_warn" dir="ltr"><span class="italic">exception_name</span> EXCEPTION;
</pre><p>For semantic information, see <span class="q">"<a href="exception-declaration.html#GUID-AAC8C54F-775C-4E65-B531-0350CFF5B1BD" title="An exception declaration declares the name of a user-defined exception.">Exception Declaration</a>"</span>.
                  </p>
                  <p>You must raise a user-defined exception explicitly. For details, see <span class="q">"<a href="plsql-error-handling.html#GUID-66346B68-7A18-438C-951B-A60F970D98B8">Raising Exceptions Explicitly</a>"</span>.
                  </p>
               </div>
            </div><a id="LNPLS733"></a><a id="LNPLS99870"></a><div class="props_rev_3"><a id="GUID-C98B60A9-3931-4F8D-BE13-205A1779596D" name="GUID-C98B60A9-3931-4F8D-BE13-205A1779596D"></a><h3 id="LNPLS-GUID-C98B60A9-3931-4F8D-BE13-205A1779596D" class="sect3"><span class="enumeration_section">11.6 </span>Redeclared Predefined Exceptions
               </h3>
               <div>
                  <p>Oracle recommends against redeclaring predefined exceptions—that is, declaring a user-defined exception name that is a predefined exception name. (For a list of predefined exception names, see <a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__CIHHGGDI" title="This table gives the names and error numbers of the PL/SQL predefined exceptions.">Table 11-3</a>.)
                  </p>
                  <p>If you redeclare a predefined exception, your local declaration overrides the global declaration in package <code class="codeph">STANDARD</code>. Exception handlers written for the globally declared exception become unable to handle it—unless you qualify its name with the package name <code class="codeph">STANDARD</code>.
                  </p>
                  <p><a href="plsql-error-handling.html#GUID-C98B60A9-3931-4F8D-BE13-205A1779596D__BABCGABI">Example 11-9</a> shows this.
                  </p>
                  <div class="example" id="GUID-C98B60A9-3931-4F8D-BE13-205A1779596D__BABCGABI">
                     <p class="titleinexample">Example 11-9 Redeclared Predefined Identifier</p><pre class="oac_no_warn" dir="ltr">DROP TABLE t;
CREATE TABLE t (c NUMBER);
 </pre><p>In the following block, the <code class="codeph">INSERT</code> statement implicitly raises the predefined exception <code class="codeph">INVALID_NUMBER</code>, which the exception handler handles.
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
  default_number NUMBER := 0;
BEGIN
  <span class="bold">INSERT INTO t VALUES(TO_NUMBER('100.00', '9G999'));</span>
EXCEPTION
  <span class="bold">WHEN INVALID_NUMBER THEN</span>
    <span class="bold">DBMS_OUTPUT.PUT_LINE('Substituting default value for invalid number.');</span>
    <span class="bold">INSERT INTO t VALUES(default_number);</span>
END;
/
 </pre><p>Result:</p><pre class="oac_no_warn" dir="ltr"><span class="bold">Substituting default value for invalid number.</span>
 </pre><p>The following block redeclares the predefined exception <code class="codeph">INVALID_NUMBER</code>. When the <code class="codeph">INSERT</code> statement implicitly raises the predefined exception <code class="codeph">INVALID_NUMBER</code>, the exception handler does not handle it.
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
  default_number NUMBER := 0;
  i NUMBER := 5;
  <span class="bold">invalid_number EXCEPTION;    -- redeclare predefined exception</span>
BEGIN
  <span class="bold">INSERT INTO t VALUES(TO_NUMBER('100.00', '9G999'));</span>
EXCEPTION
  WHEN INVALID_NUMBER THEN
    DBMS_OUTPUT.PUT_LINE('Substituting default value for invalid number.');
    INSERT INTO t VALUES(default_number); 
END;
/
 </pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">DECLARE
*
ERROR at line 1:
<span class="bold">ORA-01722: invalid number</span>
ORA-06512: at line 6
</pre><p>The exception handler in the preceding block handles the predefined exception <code class="codeph">INVALID_NUMBER</code> if you qualify the exception name in the exception handler:
                     </p><pre class="oac_no_warn" dir="ltr">DECLARE
  default_number NUMBER := 0;
  i NUMBER := 5;
  <span class="bold">invalid_number EXCEPTION;    -- redeclare predefined exception</span>
BEGIN
  <span class="bold">INSERT INTO t VALUES(TO_NUMBER('100.00', '9G999'));</span>
EXCEPTION
  WHEN <span class="bold">STANDARD.INVALID_NUMBER</span> THEN
    DBMS_OUTPUT.PUT_LINE('Substituting default value for invalid number.');
    INSERT INTO t VALUES(default_number); 
END;
/
 </pre><p>Result:</p><pre class="oac_no_warn" dir="ltr"><span class="bold">Substituting default value for invalid number.</span></pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="LNPLS734"></a><a id="LNPLS00705"></a><div class="props_rev_3"><a id="GUID-66346B68-7A18-438C-951B-A60F970D98B8" name="GUID-66346B68-7A18-438C-951B-A60F970D98B8"></a><h3 id="LNPLS-GUID-66346B68-7A18-438C-951B-A60F970D98B8" class="sect3"><span class="enumeration_section">11.7 </span>Raising Exceptions Explicitly
               </h3>
               <div>
                  <div class="section">
                     <p>To raise an exception explicitly, use either the <code class="codeph">RAISE</code> statement or <code class="codeph">RAISE_APPLICATION_ERROR</code> procedure.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-66346B68-7A18-438C-951B-A60F970D98B8__GUID-0F48BC66-2103-4DF5-9AF5-F63C8684026D">Topics</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="plsql-error-handling.html#GUID-5C7ADCC4-17D4-4B82-A767-3C7408BD1DF4">RAISE Statement</a></p>
                        </li>
                        <li>
                           <p><a href="plsql-error-handling.html#GUID-48F88C61-8CE9-4821-91CB-48A8F1BC09E1">RAISE_APPLICATION_ERROR Procedure</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="LNPLS735"></a><a id="LNPLS99869"></a><div class="props_rev_3"><a id="GUID-5C7ADCC4-17D4-4B82-A767-3C7408BD1DF4" name="GUID-5C7ADCC4-17D4-4B82-A767-3C7408BD1DF4"></a><h4 id="LNPLS-GUID-5C7ADCC4-17D4-4B82-A767-3C7408BD1DF4" class="sect4"><span class="enumeration_section">11.7.1 </span>RAISE Statement
                  </h4>
                  <div>
                     <p>The <code class="codeph">RAISE</code> statement explicitly raises an exception. Outside an exception handler, you must specify the exception name. Inside an exception handler, if you omit the exception name, the <code class="codeph">RAISE</code> statement reraises the current exception.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5C7ADCC4-17D4-4B82-A767-3C7408BD1DF4__GUID-91CFE08A-FA30-487E-B93F-AECEEF98BFFF">Topics</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="plsql-error-handling.html#GUID-D51E46A5-AEFD-4346-8236-06E4F15D86DB">Raising User-Defined Exception with RAISE Statement</a></p>
                           </li>
                           <li>
                              <p><a href="plsql-error-handling.html#GUID-4A73BF41-AA57-4F64-8E4C-265029BEEF39">Raising Internally Defined Exception with RAISE Statement</a></p>
                           </li>
                           <li>
                              <p><a href="plsql-error-handling.html#GUID-59C4325C-9D2A-4D24-8381-79B676A508A8">Reraising Current Exception with RAISE Statement</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="LNPLS736"></a><a id="LNPLS99866"></a><div class="props_rev_3"><a id="GUID-D51E46A5-AEFD-4346-8236-06E4F15D86DB" name="GUID-D51E46A5-AEFD-4346-8236-06E4F15D86DB"></a><h5 id="LNPLS-GUID-D51E46A5-AEFD-4346-8236-06E4F15D86DB" class="sect5"><span class="enumeration_section">11.7.1.1 </span>Raising User-Defined Exception with RAISE Statement
                     </h5>
                     <div>
                        <div class="section">
                           <p>In <a href="plsql-error-handling.html#GUID-D51E46A5-AEFD-4346-8236-06E4F15D86DB__BABBCBII">Example 11-10</a>, the procedure declares an exception named <code class="codeph">past_due</code>, raises it explicitly with the <code class="codeph">RAISE</code> statement, and handles it with an exception handler.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-D51E46A5-AEFD-4346-8236-06E4F15D86DB__BABBCBII">
                           <p class="titleinexample">Example 11-10 Declaring, Raising, and Handling User-Defined Exception</p><pre class="oac_no_warn" dir="ltr">CREATE PROCEDURE account_status (
  due_date DATE,
  today    DATE
) AUTHID DEFINER
IS
  <span class="bold">past_due  EXCEPTION;  -- declare exception</span>
BEGIN
  IF due_date &lt; today THEN
    <span class="bold">RAISE past_due;  -- explicitly raise exception</span>
  END IF;
EXCEPTION
  <span class="bold">WHEN past_due THEN  -- handle exception</span>
    DBMS_OUTPUT.PUT_LINE ('Account past due.');
END;
/
 
BEGIN
  account_status (TO_DATE('01-JUL-2010', 'DD-MON-YYYY'),
                  TO_DATE('09-JUL-2010', 'DD-MON-YYYY'));
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Account past due.</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="LNPLS838"></a><a id="LNPLS99863"></a><div class="props_rev_3"><a id="GUID-4A73BF41-AA57-4F64-8E4C-265029BEEF39" name="GUID-4A73BF41-AA57-4F64-8E4C-265029BEEF39"></a><h5 id="LNPLS-GUID-4A73BF41-AA57-4F64-8E4C-265029BEEF39" class="sect5"><span class="enumeration_section">11.7.1.2 </span>Raising Internally Defined Exception with RAISE Statement
                     </h5>
                     <div>
                        <div class="section">
                           <p>Although the runtime system raises internally defined exceptions implicitly, you can raise them explicitly with the <code class="codeph">RAISE</code> statement if they have names. <a href="plsql-error-handling.html#GUID-8C327B4A-71FA-4CFB-8BC9-4550A23734D6__CIHHGGDI" title="This table gives the names and error numbers of the PL/SQL predefined exceptions.">Table 11-3</a> lists the internally defined exceptions that have predefined names. <span class="q">"<a href="plsql-error-handling.html#GUID-4F0787E6-ABCA-4860-A28E-435C7FE15154">Internally Defined Exceptions</a>"</span> explains how to give user-declared names to internally defined exceptions.
                           </p>
                           <p>An exception handler for a named internally defined exception handles that exception whether it is raised implicitly or explicitly.</p>
                           <p>In <a href="plsql-error-handling.html#GUID-4A73BF41-AA57-4F64-8E4C-265029BEEF39__BABHAIAI">Example 11-11</a>, the procedure raises the predefined exception <code class="codeph">INVALID_NUMBER</code> either explicitly or implicitly, and the <code class="codeph">INVALID_NUMBER</code> exception handler always handles it.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-4A73BF41-AA57-4F64-8E4C-265029BEEF39__BABHAIAI">
                           <p class="titleinexample">Example 11-11 Explicitly Raising Predefined Exception</p><pre class="oac_no_warn" dir="ltr">DROP TABLE t;
CREATE TABLE t (c NUMBER);
 
CREATE PROCEDURE p (n NUMBER) AUTHID DEFINER IS
  default_number NUMBER := 0;
BEGIN
  IF n &lt; 0 THEN
    <span class="bold">RAISE INVALID_NUMBER;  -- raise explicitly</span>
  ELSE
    <span class="bold">INSERT INTO t VALUES(TO_NUMBER('100.00', '9G999'));  -- raise implicitly</span>
  END IF;
EXCEPTION
  <span class="bold">WHEN INVALID_NUMBER THEN</span>
    DBMS_OUTPUT.PUT_LINE('Substituting default value for invalid number.');
    INSERT INTO t VALUES(default_number);
END;
/
 
BEGIN
  p(-1);
END;
/
 </pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Substituting default value for invalid number.
 
BEGIN
  p(1);
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Substituting default value for invalid number.</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="LNPLS843"></a><a id="LNPLS00707"></a><div class="props_rev_3"><a id="GUID-59C4325C-9D2A-4D24-8381-79B676A508A8" name="GUID-59C4325C-9D2A-4D24-8381-79B676A508A8"></a><h5 id="LNPLS-GUID-59C4325C-9D2A-4D24-8381-79B676A508A8" class="sect5"><span class="enumeration_section">11.7.1.3 </span>Reraising Current Exception with RAISE Statement
                     </h5>
                     <div>
                        <div class="section">
                           <p>In an exception handler, you can use the <code class="codeph">RAISE</code> statement to"reraise" the exception being handled. Reraising the exception passes it to the enclosing block, which can handle it further. (If the enclosing block cannot handle the reraised exception, then the exception propagates—see <span class="q">"<a href="plsql-error-handling.html#GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB">Exception Propagation</a>"</span>.) When reraising the current exception, you need not specify an exception name.
                           </p>
                           <p>In <a href="plsql-error-handling.html#GUID-59C4325C-9D2A-4D24-8381-79B676A508A8__BABJBBHG">Example 11-12</a>, the handling of the exception starts in the inner block and finishes in the outer block. The outer block declares the exception, so the exception name exists in both blocks, and each block has an exception handler specifically for that exception. The inner block raises the exception, and its exception handler does the initial handling and then reraises the exception, passing it to the outer block for further handling.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-59C4325C-9D2A-4D24-8381-79B676A508A8__BABJBBHG">
                           <p class="titleinexample">Example 11-12 Reraising Exception</p><pre class="oac_no_warn" dir="ltr">DECLARE
  <span class="bold">salary_too_high   EXCEPTION;</span>
  current_salary    NUMBER := 20000;
  max_salary        NUMBER := 10000;
  erroneous_salary  NUMBER;
BEGIN

  BEGIN
    IF current_salary &gt; max_salary THEN
      <span class="bold">RAISE salary_too_high;   -- raise exception</span>
    END IF;
  EXCEPTION
    <span class="bold">WHEN salary_too_high THEN  -- start handling exception</span>
      erroneous_salary := current_salary;
      DBMS_OUTPUT.PUT_LINE('Salary ' || erroneous_salary ||' is out of range.');
      DBMS_OUTPUT.PUT_LINE ('Maximum salary is ' || max_salary || '.');
      <span class="bold">RAISE;  -- reraise current exception (exception name is optional)</span>
  END;

EXCEPTION
  <span class="bold">WHEN salary_too_high THEN    -- finish handling exception</span>
    current_salary := max_salary;

    DBMS_OUTPUT.PUT_LINE (
      'Revising salary from ' || erroneous_salary ||
      ' to ' || current_salary || '.'
    );
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Salary 20000 is out of range.
Maximum salary is 10000.
Revising salary from 20000 to 10000.</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="LNPLS738"></a><a id="LNPLS99960"></a><div class="props_rev_3"><a id="GUID-48F88C61-8CE9-4821-91CB-48A8F1BC09E1" name="GUID-48F88C61-8CE9-4821-91CB-48A8F1BC09E1"></a><h4 id="LNPLS-GUID-48F88C61-8CE9-4821-91CB-48A8F1BC09E1" class="sect4"><span class="enumeration_section">11.7.2 </span>RAISE_APPLICATION_ERROR Procedure
                  </h4>
                  <div>
                     <p>You can invoke the <code class="codeph">RAISE_APPLICATION_ERROR</code> procedure (defined in the <code class="codeph">DBMS_STANDARD</code> package) only from a stored subprogram or method. Typically, you invoke this procedure to raise a user-defined exception and return its error code and error message to the invoker.
                     </p>
                     <p>To invoke <code class="codeph">RAISE_APPLICATION_ERROR</code>, use this syntax:
                     </p><pre class="oac_no_warn" dir="ltr">RAISE_APPLICATION_ERROR (<span class="italic">error_code</span>, <span class="italic">message</span>[, {TRUE | FALSE}]);
</pre><p>You must have assigned <span class="italic"><code class="codeph">error_code</code></span> to the user-defined exception with the <code class="codeph">EXCEPTION_INIT</code> pragma. The syntax is:
                     </p><pre class="oac_no_warn" dir="ltr">PRAGMA EXCEPTION_INIT (<span class="italic">exception_name</span>, <span class="italic">error_code</span>)
</pre><p>The <span class="italic"><code class="codeph">error_code</code></span> is an integer in the range -20000..-20999 and the <span class="italic"><code class="codeph">message</code></span> is a character string of at most 2048 bytes.
                     </p>
                     <p>For semantic information, see <span class="q">"<a href="EXCEPTION_INIT-pragma.html#GUID-873A087E-A470-4798-9152-16BC673B4940" title="The EXCEPTION_INIT pragma associates a user-defined exception name with an error code.">EXCEPTION_INIT Pragma</a>"</span>.
                     </p>
                     <p>The <span class="italic"><code class="codeph">message</code></span> is a character string of at most 2048 bytes.
                     </p>
                     <p>If you specify <code class="codeph">TRUE</code>, PL/SQL puts <span class="italic"><code class="codeph">error_code</code></span> on top of the error stack. Otherwise, PL/SQL replaces the error stack with <span class="italic"><code class="codeph">error_code</code></span>.
                     </p>
                     <p>In <a href="plsql-error-handling.html#GUID-48F88C61-8CE9-4821-91CB-48A8F1BC09E1__BABIHIBC">Example 11-13</a>, an anonymous block declares an exception named <code class="codeph">past_due</code>, assigns the error code -20000 to it, and invokes a stored procedure. The stored procedure invokes the <code class="codeph">RAISE_APPLICATION_ERROR</code> procedure with the error code -20000 and a message, whereupon control returns to the anonymous block, which handles the exception. To retrieve the message associated with the exception, the exception handler in the anonymous block invokes the <code class="codeph">SQLERRM</code> function, described in <span class="q">"<a href="plsql-error-handling.html#GUID-7E0CDD98-D31C-4745-B819-B5C5E1DF90A8">Retrieving Error Code and Error Message</a>"</span>.
                     </p>
                     <div class="example" id="GUID-48F88C61-8CE9-4821-91CB-48A8F1BC09E1__BABIHIBC">
                        <p class="titleinexample">Example 11-13 Raising User-Defined Exception with RAISE_APPLICATION_ERROR</p><pre class="oac_no_warn" dir="ltr">CREATE PROCEDURE account_status (
  due_date DATE,
  today    DATE
) AUTHID DEFINER
IS
BEGIN
  IF due_date &lt; today THEN                   <span class="bold">-- explicitly raise exception</span>
    <span class="bold">RAISE_APPLICATION_ERROR(-20000, 'Account past due.');</span>
  END IF;
END;
/
 
DECLARE
  <span class="bold">past_due  EXCEPTION;                       -- declare exception</span>
  <span class="bold">PRAGMA EXCEPTION_INIT (past_due, -20000);  -- assign error code to exception</span>
BEGIN
  <span class="bold">account_status (TO_DATE('01-JUL-2010', 'DD-MON-YYYY'),</span>
                  <span class="bold">TO_DATE('09-JUL-2010', 'DD-MON-YYYY'));   -- invoke procedure</span>

EXCEPTION
  <span class="bold">WHEN past_due THEN                         -- handle exception</span>
    DBMS_OUTPUT.PUT_LINE(TO_CHAR(<span class="bold">SQLERRM(-20000)</span>));
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">ORA-20000: Account past due.</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="LNPLS839"></a><a id="LNPLS840"></a><a id="LNPLS841"></a><a id="LNPLS748"></a><a id="LNPLS842"></a><a id="LNPLS747"></a><a id="LNPLS00706"></a><div class="props_rev_3"><a id="GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB" name="GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB"></a><h3 id="LNPLS-GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB" class="sect3"><span class="enumeration_section">11.8 </span>Exception Propagation
               </h3>
               <div>
                  <p>If an exception is raised in a block that has no exception handler for it, then the exception <span class="bold">propagates</span>. That is, the exception reproduces itself in successive enclosing blocks until either a block has a handler for it or there is no enclosing block. If there is no handler for the exception, then PL/SQL returns an unhandled exception error to the invoker or host environment, which determines the outcome (for more information, see <span class="q">"<a href="plsql-error-handling.html#GUID-494984A3-37E6-41BF-9BB9-05A693CD9577">Unhandled Exceptions</a>"</span>).
                  </p>
                  <p>In <a href="plsql-error-handling.html#GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__i5473">Figure 11-1</a>, one block is nested inside another. The inner block raises exception A. The inner block has an exception handler for A, so A does not propagate. After the exception handler runs, control transfers to the next statement of the outer block.
                  </p>
                  <div class="figure" id="GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__i5473">
                     <p class="titleinfigure">Figure 11-1 Exception Does Not Propagate</p><img src="img/lnpls009.gif" width="393" alt="Description of Figure 11-1 follows" title="Description of Figure 11-1 follows" longdesc="img_text/lnpls009.html"><br><a href="img_text/lnpls009.html">Description of "Figure 11-1 Exception Does Not Propagate"</a></div>
                  <!-- class="figure" -->
                  <p>In <a href="plsql-error-handling.html#GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__i5479">Figure 11-2</a>, the inner block raises exception B. The inner block does not have an exception handler for exception B, so B propagates to the outer block, which does have an exception handler for it. After the exception handler runs, control transfers to the host environment.
                  </p>
                  <div class="figure" id="GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__i5479">
                     <p class="titleinfigure">Figure 11-2 Exception Propagates from Inner Block to Outer Block</p><img src="img/lnpls010.gif" width="381" alt="Description of Figure 11-2 follows" title="Description of Figure 11-2 follows" longdesc="img_text/lnpls010.html"><br><a href="img_text/lnpls010.html">Description of "Figure 11-2 Exception Propagates from Inner Block to Outer Block"</a></div>
                  <!-- class="figure" -->
                  <p>In <a href="plsql-error-handling.html#GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__i2641">Figure 11-3</a>, the inner block raises exception C. The inner block does not have an exception handler for C, so exception C propagates to the outer block. The outer block does not have an exception handler for C, so PL/SQL returns an unhandled exception error to the host environment.
                  </p>
                  <div class="figure" id="GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__i2641">
                     <p class="titleinfigure">Figure 11-3 PL/SQL Returns Unhandled Exception Error to Host Environment</p><img src="img/lnpls011.gif" width="392" alt="Description of Figure 11-3 follows" title="Description of Figure 11-3 follows" longdesc="img_text/lnpls011.html"><br><a href="img_text/lnpls011.html">Description of "Figure 11-3 PL/SQL Returns Unhandled Exception Error to Host Environment"</a></div>
                  <!-- class="figure" -->
                  <p>A user-defined exception can propagate beyond its scope (that is, beyond the block that declares it), but its name does not exist beyond its scope. Therefore, beyond its scope, a user-defined exception can be handled only with an <code class="codeph">OTHERS</code> exception handler.
                  </p>
                  <p>In <a href="plsql-error-handling.html#GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__BABIIGCJ">Example 11-14</a>, the inner block declares an exception named <code class="codeph">past_due</code>, for which it has no exception handler. When the inner block raises <code class="codeph">past_due</code>, the exception propagates to the outer block, where the name <code class="codeph">past_due</code> does not exist. The outer block handles the exception with an <code class="codeph">OTHERS</code> exception handler.
                  </p>
                  <p>If the outer block does not handle the user-defined exception, then an error occurs, as in <a href="plsql-error-handling.html#GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__BABDJCDH">Example 11-15</a>.
                  </p>
                  <div class="infoboxnote" id="GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__GUID-760DEEA6-1FA2-4CFD-B757-5C968CF7FDDD">
                     <p class="notep1">Note:</p>
                     <p>Exceptions cannot propagate across remote subprogram invocations. Therefore, a PL/SQL block cannot handle an exception raised by a remote subprogram.</p>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__GUID-905BECE5-B7A0-4172-8E13-607F08768EE5">Topics</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="plsql-error-handling.html#GUID-32A135A2-6C8B-4D2B-8946-001D66429FA3">Propagation of Exceptions Raised in Declarations</a></p>
                        </li>
                        <li>
                           <p><a href="plsql-error-handling.html#GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314">Propagation of Exceptions Raised in Exception Handlers</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__BABIIGCJ">
                     <p class="titleinexample">Example 11-14 Exception that Propagates Beyond Scope is Handled</p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PROCEDURE p AUTHID DEFINER AS
BEGIN

  DECLARE
    <span class="bold">past_due     EXCEPTION;</span>
    PRAGMA EXCEPTION_INIT (past_due, -4910);
    due_date     DATE := trunc(SYSDATE) - 1;
    todays_date  DATE := trunc(SYSDATE);
  BEGIN
    IF due_date &lt; todays_date THEN
      RAISE past_due;
    END IF;
  END;

EXCEPTION
  <span class="bold">WHEN OTHERS THEN</span>
    ROLLBACK;
    RAISE;
END;
/
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-A99B76C3-44DF-40E1-AB7A-454C6805B9BB__BABDJCDH">
                     <p class="titleinexample">Example 11-15 Exception that Propagates Beyond Scope is Not Handled</p><pre class="oac_no_warn" dir="ltr">BEGIN

  DECLARE
    <span class="bold">past_due     EXCEPTION;</span>
    due_date     DATE := trunc(SYSDATE) - 1;
    todays_date  DATE := trunc(SYSDATE);
  BEGIN
    IF due_date &lt; todays_date THEN
      RAISE past_due;
    END IF;
  END;

END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">BEGIN
*
ERROR at line 1:
<span class="bold">ORA-06510: PL/SQL: unhandled user-defined exception</span>
ORA-06512: at line 9</pre></div>
                  <!-- class="example" -->
               </div><a id="LNPLS845"></a><a id="LNPLS749"></a><a id="LNPLS844"></a><div class="props_rev_3"><a id="GUID-32A135A2-6C8B-4D2B-8946-001D66429FA3" name="GUID-32A135A2-6C8B-4D2B-8946-001D66429FA3"></a><h4 id="LNPLS-GUID-32A135A2-6C8B-4D2B-8946-001D66429FA3" class="sect4"><span class="enumeration_section">11.8.1 </span>Propagation of Exceptions Raised in Declarations
                  </h4>
                  <div>
                     <p>An exception raised in a declaration propagates immediately to the enclosing block (or to the invoker or host environment if there is no enclosing block). Therefore, the exception handler must be in an enclosing or invoking block, not in the same block as the declaration.</p>
                     <p>In <a href="plsql-error-handling.html#GUID-32A135A2-6C8B-4D2B-8946-001D66429FA3__BABBIACC">Example 11-16</a>, the <code class="codeph">VALUE_ERROR</code> exception handler is in the same block as the declaration that raises <code class="codeph">VALUE_ERROR</code>. Because the exception propagates immediately to the host environment, the exception handler does not handle it.
                     </p>
                     <p><a href="plsql-error-handling.html#GUID-32A135A2-6C8B-4D2B-8946-001D66429FA3__BABFDAJH">Example 11-17</a> is like <a href="plsql-error-handling.html#GUID-32A135A2-6C8B-4D2B-8946-001D66429FA3__BABBIACC">Example 11-16</a> except that an enclosing block handles the <code class="codeph">VALUE_ERROR</code> exception that the declaration in the inner block raises.
                     </p>
                     <div class="example" id="GUID-32A135A2-6C8B-4D2B-8946-001D66429FA3__BABBIACC">
                        <p class="titleinexample">Example 11-16 Exception Raised in Declaration is Not Handled</p><pre class="oac_no_warn" dir="ltr"><span class="bold">DECLARE</span>
  <span class="bold">credit_limit CONSTANT NUMBER(3) := 5000;  -- Maximum value is 999</span>
<span class="bold">BEGIN</span>
  NULL;
<span class="bold">EXCEPTION</span>
  <span class="bold">WHEN VALUE_ERROR THEN</span>
    DBMS_OUTPUT.PUT_LINE('Exception raised in declaration.');
<span class="bold">END;</span>
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">DECLARE
*
ERROR at line 1:
ORA-06502: PL/SQL: numeric or value error: number precision too large
ORA-06512: at line 2
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-32A135A2-6C8B-4D2B-8946-001D66429FA3__BABFDAJH">
                        <p class="titleinexample">Example 11-17 Exception Raised in Declaration is Handled by Enclosing Block</p><pre class="oac_no_warn" dir="ltr"><span class="bold">BEGIN</span>
 
  DECLARE
    <span class="bold">credit_limit CONSTANT NUMBER(3) := 5000;</span>
  BEGIN
    NULL;
  END;
 
<span class="bold">EXCEPTION</span>
  <span class="bold">WHEN VALUE_ERROR THEN</span>
    DBMS_OUTPUT.PUT_LINE('Exception raised in declaration.');
<span class="bold">END;</span>
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Exception raised in declaration.</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="LNPLS757"></a><a id="LNPLS761"></a><a id="LNPLS762"></a><a id="LNPLS763"></a><a id="LNPLS764"></a><a id="LNPLS846"></a><div class="props_rev_3"><a id="GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314" name="GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314"></a><h4 id="LNPLS-GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314" class="sect4"><span class="enumeration_section">11.8.2 </span>Propagation of Exceptions Raised in Exception Handlers
                  </h4>
                  <div>
                     <p>An <a id="d82955e3818" class="indexterm-anchor"></a><a id="d82955e3822" class="indexterm-anchor"></a>exception raised in an exception handler propagates immediately to the enclosing block (or to the invoker or host environment if there is no enclosing block). Therefore, the exception handler must be in an enclosing or invoking block.
                     </p>
                     <p>In <a href="plsql-error-handling.html#GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABHJJAF">Example 11-18</a>, when <code class="codeph">n</code> is zero, the calculation <code class="codeph">1/n</code> raises the predefined exception <code class="codeph">ZERO_DIVIDE</code>, and control transfers to the <code class="codeph">ZERO_DIVIDE</code> exception handler in the same block. When the exception handler raises <code class="codeph">ZERO_DIVIDE</code>, the exception propagates immediately to the invoker. The invoker does not handle the exception, so PL/SQL returns an unhandled exception error to the host environment.
                     </p>
                     <p><a href="plsql-error-handling.html#GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABDJDGH">Example 11-19</a> is like <a href="plsql-error-handling.html#GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABHJJAF">Example 11-18</a> except that when the procedure returns an unhandled exception error to the invoker, the invoker handles it.
                     </p>
                     <p><a href="plsql-error-handling.html#GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABHBEGA">Example 11-20</a> is like <a href="plsql-error-handling.html#GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABHJJAF">Example 11-18</a> except that an enclosing block handles the exception that the exception handler in the inner block raises.
                     </p>
                     <p>In <a href="plsql-error-handling.html#GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABEGCDH">Example 11-21</a>, the exception-handling part of the procedure has exception handlers for user-defined exception <code class="codeph">i_is_one</code> and predefined exception <code class="codeph">ZERO_DIVIDE</code>. When the <code class="codeph">i_is_one</code> exception handler raises <code class="codeph">ZERO_DIVIDE</code>, the exception propagates immediately to the invoker (therefore, the <code class="codeph">ZERO_DIVIDE</code> exception handler does not handle it). The invoker does not handle the exception, so PL/SQL returns an unhandled exception error to the host environment.
                     </p>
                     <p><a href="plsql-error-handling.html#GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABDIHFC">Example 11-22</a> is like <a href="plsql-error-handling.html#GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABEGCDH">Example 11-21</a> except that an enclosing block handles the <code class="codeph">ZERO_DIVIDE</code> exception that the <code class="codeph">i_is_one</code> exception handler raises.
                     </p>
                     <div class="example" id="GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABHJJAF">
                        <p class="titleinexample">Example 11-18 Exception Raised in Exception Handler is Not Handled</p><pre class="oac_no_warn" dir="ltr">CREATE PROCEDURE print_reciprocal (n NUMBER) AUTHID DEFINER IS
BEGIN
  DBMS_OUTPUT.PUT_LINE(<span class="bold">1/n</span>);  <span class="bold">-- handled</span>
EXCEPTION
  WHEN ZERO_DIVIDE THEN
    DBMS_OUTPUT.PUT_LINE('<span class="bold">Error:</span>');
    DBMS_OUTPUT.PUT_LINE(<span class="bold">1/n</span> || ' is undefined');  <span class="bold">-- not handled</span>
END;
/
 
BEGIN  <span class="bold">-- invoking block</span>
  print_reciprocal(0);
END;
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr"><span class="bold">Error:</span>
BEGIN
*
ERROR at line 1:
<span class="bold">ORA-01476: divisor is equal to zero</span>
ORA-06512: at "HR.PRINT_RECIPROCAL", line 7
ORA-01476: divisor is equal to zero
ORA-06512: at line 2
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABDJDGH">
                        <p class="titleinexample">Example 11-19 Exception Raised in Exception Handler is Handled by Invoker</p><pre class="oac_no_warn" dir="ltr">CREATE PROCEDURE print_reciprocal (n NUMBER) AUTHID DEFINER IS
BEGIN
  DBMS_OUTPUT.PUT_LINE(1/n);
EXCEPTION
  WHEN ZERO_DIVIDE THEN
    DBMS_OUTPUT.PUT_LINE('Error:');
    DBMS_OUTPUT.PUT_LINE(1/n || ' is undefined');
END;
/
 
BEGIN  <span class="bold">-- invoking block</span>
  print_reciprocal(0);
EXCEPTION
  <span class="bold">WHEN ZERO_DIVIDE THEN  -- handles exception raised in exception handler</span>
    DBMS_OUTPUT.PUT_LINE('1/0 is undefined.');
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Error:
1/0 is undefined.
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABHBEGA">
                        <p class="titleinexample">Example 11-20 Exception Raised in Exception Handler is Handled by Enclosing Block</p><pre class="oac_no_warn" dir="ltr">CREATE PROCEDURE print_reciprocal (n NUMBER) AUTHID DEFINER IS
<span class="bold">BEGIN</span>
 
  <span class="bold">BEGIN</span>
    DBMS_OUTPUT.PUT_LINE(1/n);
  <span class="bold">EXCEPTION</span>
    WHEN ZERO_DIVIDE THEN
      DBMS_OUTPUT.PUT_LINE('Error in inner block:');
      DBMS_OUTPUT.PUT_LINE(1/n || ' is undefined.');
  <span class="bold">END;</span>
 
<span class="bold">EXCEPTION</span>
  <span class="bold">WHEN ZERO_DIVIDE THEN  -- handles exception raised in exception handler</span>
    DBMS_OUTPUT.PUT('Error in outer block: ');
    DBMS_OUTPUT.PUT_LINE('1/0 is undefined.');
<span class="bold">END;</span>
/
 
BEGIN
  print_reciprocal(0);
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Error in inner block:
Error in outer block: 1/0 is undefined.
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABEGCDH">
                        <p class="titleinexample">Example 11-21 Exception Raised in Exception Handler is Not Handled</p><pre class="oac_no_warn" dir="ltr">CREATE PROCEDURE descending_reciprocals (n INTEGER) AUTHID DEFINER IS
  i INTEGER;
  <span class="bold">i_is_one EXCEPTION;</span>
BEGIN
  i := n;
 
  LOOP
    IF i = 1 THEN
      <span class="bold">RAISE i_is_one;</span>
    ELSE
      DBMS_OUTPUT.PUT_LINE('Reciprocal of ' || i || ' is ' || <span class="bold">1/i</span>);
    END IF;
 
    i := i - 1;
  END LOOP;
EXCEPTION
  <span class="bold">WHEN i_is_one THEN</span>
    DBMS_OUTPUT.PUT_LINE('<span class="bold">1 is its own reciprocal.</span>');
    DBMS_OUTPUT.PUT_LINE('Reciprocal of ' || TO_CHAR(i-1) ||
                         ' is ' || TO_CHAR(<span class="bold">1/(i-1)</span>));
                           
  <span class="bold">WHEN ZERO_DIVIDE THEN</span>
    DBMS_OUTPUT.PUT_LINE('Error:');
    DBMS_OUTPUT.PUT_LINE(1/n || ' is undefined');
END;
/
 
BEGIN
  descending_reciprocals(3);
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Reciprocal of 3 is .3333333333333333333333333333333333333333
Reciprocal of 2 is .5
<span class="bold">1 is its own reciprocal.</span>
BEGIN
*
ERROR at line 1:
<span class="bold">ORA-01476: divisor is equal to zero</span>
ORA-06512: at "HR.DESCENDING_RECIPROCALS", line 19
ORA-06510: PL/SQL: unhandled user-defined exception
ORA-06512: at line 2
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-1E7585F0-74BA-4D39-B168-2BE979CB8314__BABDIHFC">
                        <p class="titleinexample">Example 11-22 Exception Raised in Exception Handler is Handled by Enclosing Block</p><pre class="oac_no_warn" dir="ltr">CREATE PROCEDURE descending_reciprocals (n INTEGER) AUTHID DEFINER IS
  i INTEGER;
  i_is_one EXCEPTION;
<span class="bold">BEGIN</span>
 
  <span class="bold">BEGIN</span>
    i := n;
 
    LOOP
      IF i = 1 THEN
        RAISE i_is_one;
      ELSE
        DBMS_OUTPUT.PUT_LINE('Reciprocal of ' || i || ' is ' || 1/i);
      END IF;
 
      i := i - 1;
    END LOOP;
  <span class="bold">EXCEPTION</span>
    WHEN i_is_one THEN
      DBMS_OUTPUT.PUT_LINE('1 is its own reciprocal.');
      DBMS_OUTPUT.PUT_LINE('Reciprocal of ' || TO_CHAR(i-1) ||
                           ' is ' || TO_CHAR(1/(i-1)));
                           
    WHEN ZERO_DIVIDE THEN
      DBMS_OUTPUT.PUT_LINE('Error:');
      DBMS_OUTPUT.PUT_LINE(1/n || ' is undefined');
  <span class="bold">END;</span>
 
<span class="bold">EXCEPTION</span>
  <span class="bold">WHEN ZERO_DIVIDE THEN  -- handles exception raised in exception handler</span>
    DBMS_OUTPUT.PUT_LINE('Error:');
    DBMS_OUTPUT.PUT_LINE('1/0 is undefined');
<span class="bold">END;</span>
/
 
BEGIN
  descending_reciprocals(3);
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Reciprocal of 3 is .3333333333333333333333333333333333333333
Reciprocal of 2 is .5
1 is its own reciprocal.
Error:
1/0 is undefined</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="LNPLS850"></a><div class="props_rev_3"><a id="GUID-494984A3-37E6-41BF-9BB9-05A693CD9577" name="GUID-494984A3-37E6-41BF-9BB9-05A693CD9577"></a><h3 id="LNPLS-GUID-494984A3-37E6-41BF-9BB9-05A693CD9577" class="sect3"><span class="enumeration_section">11.9 </span>Unhandled Exceptions
               </h3>
               <div>
                  <p>If there is no handler for a raised exception, PL/SQL returns an unhandled exception error to the invoker or host environment, which determines the outcome.</p>
                  <p>If a stored subprogram exits with an unhandled exception, PL/SQL does not roll back database changes made by the subprogram.</p>
                  <p>The <code class="codeph">FORALL</code> statement runs one DML statement multiple times, with different values in the <code class="codeph">VALUES</code> and <code class="codeph">WHERE</code> clauses. If one set of values raises an unhandled exception, then PL/SQL rolls back all database changes made earlier in the <code class="codeph">FORALL</code> statement. For more information, see <span class="q">"<a href="plsql-optimization-and-tuning.html#GUID-42AF6F5C-B06D-4EB6-9C7A-630FF65DBD5D" title="To handle exceptions raised in a FORALL statement immediately, omit the SAVE EXCEPTIONS clause and write the appropriate exception handlers.">Handling FORALL Exceptions Immediately</a>"</span> and <span class="q">"<a href="plsql-optimization-and-tuning.html#GUID-DAF46F06-EF3F-4B1A-A518-5238B80C69FA" title="To allow a FORALL statement to continue even if some of its DML statements fail, include the SAVE EXCEPTIONS clause. When a DML statement fails, PL/SQL does not raise an exception; instead, it saves information about the failure. After the FORALL statement completes, PL/SQL raises a single exception for the FORALL statement (ORA-24381).">Handling FORALL Exceptions After FORALL Statement Completes</a>"</span>.
                  </p>
                  <div class="infobox-tip" id="GUID-494984A3-37E6-41BF-9BB9-05A693CD9577__GUID-5DA4F3CF-C3A5-48C8-98B3-FD405459BA24">
                     <p class="notep1">Tip:</p>
                     <p>Avoid unhandled exceptions by including an <code class="codeph">OTHERS</code> exception handler at the top level of every PL/SQL program.
                     </p>
                  </div>
               </div>
            </div><a id="LNPLS849"></a><a id="LNPLS848"></a><div class="props_rev_3"><a id="GUID-7E0CDD98-D31C-4745-B819-B5C5E1DF90A8" name="GUID-7E0CDD98-D31C-4745-B819-B5C5E1DF90A8"></a><h3 id="LNPLS-GUID-7E0CDD98-D31C-4745-B819-B5C5E1DF90A8" class="sect3"><span class="enumeration_section">11.10 </span>Retrieving Error Code and Error Message
               </h3>
               <div>
                  <div class="section">
                     <p>In an exception handler, for the exception being handled:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You can retrieve the error code with the PL/SQL function <code class="codeph">SQLCODE</code>, described in <span class="q">"<a href="SQLCODE-function.html#GUID-1FFD7902-D22D-4505-815A-C97DDBEFB4B5" title="In an exception handler, the SQLCODE function returns the numeric code of the exception being handled. (Outside an exception handler, SQLCODE returns 0.)">SQLCODE Function</a>"</span>.
                           </p>
                        </li>
                        <li>
                           <p>You can retrieve the error message with either:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The PL/SQL function <code class="codeph">SQLERRM</code>, described in <span class="q">"<a href="SQLERRM-function.html#GUID-D4468C8F-62D9-42A5-AF72-C1098C866DC5" title="The SQLERRM function returns the error message associated with an error code.">SQLERRM Function</a>"</span></p>
                                 <p>This function returns a maximum of 512 bytes, which is the maximum length of an Oracle Database error message (including the error code, nested messages, and message inserts such as table and column names).</p>
                              </li>
                              <li>
                                 <p>The package function <code class="codeph">DBMS_UTILITY</code>.<code class="codeph">FORMAT_ERROR_STACK</code>, described in <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lnpls&amp;id=ARPLS73242" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a></p>
                                 <p>This function returns the full error stack, up to 2000 bytes.</p>
                              </li>
                           </ul>
                           <p>Oracle recommends using <code class="codeph">DBMS_UTILITY</code>.<code class="codeph">FORMAT_ERROR_STACK</code>, except when using the <code class="codeph">FORALL</code> statement with its <code class="codeph">SAVE</code> <code class="codeph">EXCEPTIONS</code> clause, as in <a href="plsql-optimization-and-tuning.html#GUID-DAF46F06-EF3F-4B1A-A518-5238B80C69FA__BABGBABA">Example 12-13</a>.
                           </p>
                        </li>
                     </ul>
                     <p>A SQL statement cannot invoke <code class="codeph">SQLCODE</code> or <code class="codeph">SQLERRM</code>. To use their values in a SQL statement, assign them to local variables first, as in <a href="plsql-error-handling.html#GUID-7E0CDD98-D31C-4745-B819-B5C5E1DF90A8__CJAJBAJG">Example 11-23</a>.
                     </p>
                     <div class="infoboxnotealso" id="GUID-7E0CDD98-D31C-4745-B819-B5C5E1DF90A8__GUID-324437FD-504B-4422-87E0-C2B1869C5402">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../arpls/DBMS_UTILITY.html#ARPLS73241" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code class="codeph">DBMS_UTILITY</code>.<code class="codeph">FORMAT_ERROR_BACKTRACE</code> function, which displays the call stack at the point where an exception was raised, even if the subprogram is called from an exception handler in an outer scope
                              </p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lnpls&amp;id=ARPLS74078" target="_blank"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code class="codeph">UTL_CALL_STACK</code> package, whose subprograms provide information about currently executing subprograms, including subprogram names
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-7E0CDD98-D31C-4745-B819-B5C5E1DF90A8__CJAJBAJG">
                     <p class="titleinexample">Example 11-23 Displaying SQLCODE and SQLERRM Values</p><pre class="oac_no_warn" dir="ltr">DROP TABLE errors;
CREATE TABLE errors (
  code      NUMBER,
  message   VARCHAR2(64)
);

CREATE OR REPLACE PROCEDURE p AUTHID DEFINER AS
  name    EMPLOYEES.LAST_NAME%TYPE;
  v_code  NUMBER;
  v_errm  VARCHAR2(64);
BEGIN
  SELECT last_name INTO name
  FROM EMPLOYEES
  WHERE EMPLOYEE_ID = -1;
EXCEPTION
  WHEN OTHERS THEN
    <span class="bold">v_code := SQLCODE;</span>
    <span class="bold">v_errm := SUBSTR(SQLERRM, 1, 64);</span>
    DBMS_OUTPUT.PUT_LINE
      ('Error code ' || v_code || ': ' || v_errm);
 
    /* Invoke another procedure,
       declared with PRAGMA AUTONOMOUS_TRANSACTION,
       to insert information about errors. */
 
    <span class="bold">INSERT INTO errors (code, message)</span>
    <span class="bold">VALUES (v_code, v_errm);</span>

    RAISE;
END;
/</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="LNPLS765"></a><a id="LNPLS852"></a><a id="LNPLS851"></a><div class="props_rev_3"><a id="GUID-E63131E7-4AE6-4C47-8D21-5EC1F6D3AA68" name="GUID-E63131E7-4AE6-4C47-8D21-5EC1F6D3AA68"></a><h3 id="LNPLS-GUID-E63131E7-4AE6-4C47-8D21-5EC1F6D3AA68" class="sect3"><span class="enumeration_section">11.11 </span>Continuing Execution After Handling Exceptions
               </h3>
               <div>
                  <div class="section">
                     <p>After an exception handler runs, control transfers to the next statement of the enclosing block (or to the invoker or host environment if there is no enclosing block). The exception handler cannot transfer control back to its own block.</p>
                     <p>For example, in <a href="plsql-error-handling.html#GUID-E63131E7-4AE6-4C47-8D21-5EC1F6D3AA68__CHDGAJIF">Example 11-24</a>, after the <code class="codeph">SELECT</code> <code class="codeph">INTO</code> statement raises <code class="codeph">ZERO_DIVIDE</code> and the exception handler handles it, execution cannot continue from the <code class="codeph">INSERT</code> statement that follows the <code class="codeph">SELECT</code> <code class="codeph">INTO</code> statement.
                     </p>
                     <p>If you want execution to resume with the <code class="codeph">INSERT</code> statement that follows the <code class="codeph">SELECT</code> <code class="codeph">INTO</code> statement, then put the <code class="codeph">SELECT</code> <code class="codeph">INTO</code> statement in an inner block with its own <code class="codeph">ZERO_DIVIDE</code> exception handler, as in <a href="plsql-error-handling.html#GUID-E63131E7-4AE6-4C47-8D21-5EC1F6D3AA68__BABJCEEC">Example 11-25</a>.
                     </p>
                     <div class="infoboxnotealso" id="GUID-E63131E7-4AE6-4C47-8D21-5EC1F6D3AA68__GUID-5F0822F9-18CA-44DE-AAA3-FAFD4F5CC250">
                        <p class="notep1">See Also:</p>
                        <p><a href="plsql-optimization-and-tuning.html#GUID-DAF46F06-EF3F-4B1A-A518-5238B80C69FA__BABGBABA">Example 12-13</a>, where a bulk SQL operation continues despite exceptions
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-E63131E7-4AE6-4C47-8D21-5EC1F6D3AA68__CHDGAJIF">
                     <p class="titleinexample">Example 11-24 Exception Handler Runs and Execution Ends</p><pre class="oac_no_warn" dir="ltr">DROP TABLE employees_temp;
CREATE TABLE employees_temp AS
  SELECT employee_id, salary, commission_pct
  FROM employees;
 
DECLARE
  sal_calc NUMBER(8,2);
BEGIN
  INSERT INTO employees_temp (employee_id, salary, commission_pct)
  VALUES (301, 2500, 0);
 
  <span class="bold">SELECT (salary / commission_pct) INTO sal_calc</span>
  FROM employees_temp
  WHERE employee_id = 301;
 
  <span class="bold">INSERT INTO employees_temp VALUES (302, sal_calc/100, .1);</span>
  DBMS_OUTPUT.PUT_LINE('<span class="bold">Row inserted.</span>');
EXCEPTION
  <span class="bold">WHEN ZERO_DIVIDE THEN</span>
    DBMS_OUTPUT.PUT_LINE('<span class="bold">Division by zero.</span>');
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Division by zero.
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-E63131E7-4AE6-4C47-8D21-5EC1F6D3AA68__BABJCEEC">
                     <p class="titleinexample">Example 11-25 Exception Handler Runs and Execution Continues</p><pre class="oac_no_warn" dir="ltr">DECLARE
  sal_calc NUMBER(8,2);
BEGIN
  INSERT INTO employees_temp (employee_id, salary, commission_pct)
  VALUES (301, 2500, 0);
 
  <span class="bold">BEGIN</span>
    SELECT (salary / commission_pct) INTO sal_calc
    FROM employees_temp
    WHERE employee_id = 301;
  <span class="bold">EXCEPTION</span>
    <span class="bold">WHEN ZERO_DIVIDE THEN</span>
      DBMS_OUTPUT.PUT_LINE('<span class="bold">Substituting 2500 for undefined number.</span>');
      sal_calc := 2500;
  <span class="bold">END;</span>
 
  INSERT INTO employees_temp VALUES (302, sal_calc/100, .1);
  DBMS_OUTPUT.PUT_LINE('<span class="bold">Enclosing block: Row inserted.</span>');
EXCEPTION
  WHEN ZERO_DIVIDE THEN
    DBMS_OUTPUT.PUT_LINE('<span class="bold">Enclosing block: Division by zero.</span>');
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Substituting 2500 for undefined number.
Enclosing block: Row inserted.</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="LNPLS854"></a><a id="LNPLS853"></a><div class="props_rev_3"><a id="GUID-CF7B91D7-215F-48D7-AE83-240012CE8ED6" name="GUID-CF7B91D7-215F-48D7-AE83-240012CE8ED6"></a><h3 id="LNPLS-GUID-CF7B91D7-215F-48D7-AE83-240012CE8ED6" class="sect3"><span class="enumeration_section">11.12 </span>Retrying Transactions After Handling Exceptions
               </h3>
               <div>
                  <div class="section">
                     <p>To retry a transaction after handling an exception that it raised, use this technique:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Enclose the transaction in a sub-block that has an exception-handling part.</span></li>
                     <li class="stepexpand"><span>In the sub-block, before the transaction starts, mark a savepoint.</span></li>
                     <li class="stepexpand"><span>In the exception-handling part of the sub-block, put an exception handler that rolls back to the savepoint and then tries to correct the problem.</span></li>
                     <li class="stepexpand"><span>Put the sub-block inside a <code class="codeph">LOOP</code> statement.</span></li>
                     <li class="stepexpand"><span>In the sub-block, after the <code class="codeph">COMMIT</code> statement that ends the transaction, put an <code class="codeph">EXIT</code> statement.</span><div>
                           <p>If the transaction succeeds, the <code class="codeph">COMMIT</code> and <code class="codeph">EXIT</code> statements execute.
                           </p>
                           <p>If the transaction fails, control transfers to the exception-handling part of the sub-block, and after the exception handler runs, the loop repeats.</p>
                        </div>
                     </li>
                  </ol>
                  <div class="example" id="GUID-CF7B91D7-215F-48D7-AE83-240012CE8ED6__BABGHCEH">
                     <p class="titleinexample">Example 11-26 Retrying Transaction After Handling Exception</p><pre class="oac_no_warn" dir="ltr">DROP TABLE results;
CREATE TABLE results (
  res_name   VARCHAR(20),
  res_answer VARCHAR2(3)
);
 
<span class="bold">CREATE UNIQUE INDEX res_name_ix ON results (res_name);</span>
INSERT INTO results (res_name, res_answer) VALUES ('SMYTHE', 'YES');
INSERT INTO results (res_name, res_answer) VALUES ('JONES', 'NO');
 
DECLARE
  name    VARCHAR2(20) := 'SMYTHE';
  answer  VARCHAR2(3) := 'NO';
  suffix  NUMBER := 1;
BEGIN
  <span class="bold">FOR i IN 1..5 LOOP  -- Try transaction at most 5 times.</span>
 
    DBMS_OUTPUT.PUT('Try #' || i);
 
    <span class="bold">BEGIN  -- sub-block begins</span>
 
       <span class="bold">SAVEPOINT start_transaction;</span>
 
       <span class="bold">-- transaction begins</span>
 
       DELETE FROM results WHERE res_answer = 'NO';
 
       INSERT INTO results (res_name, res_answer) VALUES (name, answer);
 
       <span class="bold">-- Nonunique name raises DUP_VAL_ON_INDEX.</span>
 
       <span class="bold">-- If transaction succeeded:</span>
 
       COMMIT;
       DBMS_OUTPUT.PUT_LINE(' succeeded.');
       EXIT;
 
    <span class="bold">EXCEPTION</span>
      <span class="bold">WHEN DUP_VAL_ON_INDEX THEN</span>
        DBMS_OUTPUT.PUT_LINE(' failed; trying again.');
        <span class="bold">ROLLBACK TO start_transaction;</span>    -- Undo changes.
        suffix := suffix + 1;             -- Try to fix problem.
        name := name || TO_CHAR(suffix);
    <span class="bold">END;  -- sub-block ends</span>
 
  <span class="bold">END LOOP;</span>
END;
/
</pre><p>Result:</p><pre class="oac_no_warn" dir="ltr">Try #1 failed; trying again.
Try #2 succeeded.</pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <p><a href="plsql-error-handling.html#GUID-CF7B91D7-215F-48D7-AE83-240012CE8ED6__BABGHCEH">Example 11-26</a> uses the preceding technique to retry a transaction whose <code class="codeph">INSERT</code> statement raises the predefined exception <code class="codeph">DUP_VAL_ON_INDEX</code> if the value of <code class="codeph">res_name</code> is not unique.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="LNPLS1963"></a><div class="props_rev_3"><a id="GUID-6B966875-B27C-4FDF-8334-8FB3B22ABF4A" name="GUID-6B966875-B27C-4FDF-8334-8FB3B22ABF4A"></a><h3 id="LNPLS-GUID-6B966875-B27C-4FDF-8334-8FB3B22ABF4A" class="sect3"><span class="enumeration_section">11.13 </span>Handling Errors in Distributed Queries
               </h3>
               <div>
                  <div class="section">
                     <p>You can use a trigger or a stored subprogram to create a distributed query. This distributed query is decomposed by the local Oracle Database instance into a corresponding number of remote queries, which are sent to the remote nodes for execution. The remote nodes run the queries and send the results back to the local node. The local node then performs any necessary post-processing and returns the results to the user or application.</p>
                     <p>If a portion of a distributed statement fails, possibly from a constraint violation, then Oracle Database returns ORA-02055. Subsequent statements, or subprogram invocations, return ORA-02067 until a rollback or a rollback to savepoint is entered.</p>
                     <p>Design your application to check for any returned error messages that indicates that a portion of the distributed update has failed. If you detect a failure, rollback the entire transaction (or rollback to a savepoint) before allowing the application to proceed.</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>