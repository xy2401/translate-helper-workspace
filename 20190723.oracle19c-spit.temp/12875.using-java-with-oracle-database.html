<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Brief Introduction to JDBC, UCP, and Java in the Database</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="2 Day + Java Developer's Guide ">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="2 Day + Java Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="2-day-java-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T07:23:23-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2007, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96442-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="aims-and-objectives-this-book.html" title="Previous" type="text/html">
      <link rel="next" href="overview-hr-web-application.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="2 Day + Java Developer's Guide">
    <meta name="dcterms.isVersionOf" content="TDPJD">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="aims-and-objectives-this-book.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="overview-hr-web-application.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">2 Day + Java Developer's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Brief Introduction to JDBC, UCP, and Java in the Database</li>
            </ol>
            <a id="GUID-8C73108B-E0F3-4CD5-A813-909B339339BB" name="GUID-8C73108B-E0F3-4CD5-A813-909B339339BB"></a><a id="TDPJD101"></a>
            
            <h2 id="TDPJD-GUID-8C73108B-E0F3-4CD5-A813-909B339339BB" class="sect2"><span class="enumeration_chapter">2 </span>Brief Introduction to JDBC, UCP, and Java in the Database
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Database is a relational database that you can use to store, modify and use data. </p>
               <p>The <a id="d2341e26" class="indexterm-anchor"></a>Java Database Connectivity (JDBC) standard is used by Java applications to access and manipulate data in relational databases.
               </p>
               <p><a id="d2341e30" class="indexterm-anchor"></a>JDBC is an industry-standard application programming interface (API) that lets you access a RDBMS using SQL from Java. JDBC complies with the <a id="d2341e33" class="indexterm-anchor"></a>Entry Level of the JDBC escape standard. Each vendor implements the JDBC Specification with its own extensions.
               </p>
               <p>Universal Connection Pool (UCP) is a connection pool used to cache the database connection objects to reuse the connections, thus improving the performance.</p>
               <p>Java in the Database (OJVM) helps group SQL operations with Java data logic and load them into the database for in-place processing.</p>
               <div class="infoboxnotealso" id="GUID-8C73108B-E0F3-4CD5-A813-909B339339BB__GUID-9E38004F-8DB0-4A86-BCA9-A203D03D2E43">
                  <p class="notep1">See Also:</p>
                  <p><a href="http://www.oracle.com/technetwork/java/overview-141217.html" target="_blank"><code class="codeph">http://www.oracle.com/technetwork/java/overview-141217.html</code></a></p>
               </div>
               <p></p>
               <p>This chapter introduces you to the JDBC driver, Universal Connection Pool (UCP) and Java in the Database (OJVM) with Oracle Database 12<span class="italic">c</span> Release 2 (12.2)
               </p>
               <ul style="list-style-type: disc;">
                  <li>Java Database Connectivity Driver (JDBC)</li>
                  <li>
                     <p>Universal Connection Pool (UCP)</p>
                  </li>
                  <li>
                     <p>Java in the Database (OJVM)</p>
                  </li>
               </ul>
            </div>
            <div class="sect2"><a id="GUID-2ADAB75C-88C9-4956-98C3-FE0ED96444CA" name="GUID-2ADAB75C-88C9-4956-98C3-FE0ED96444CA"></a><h3 id="TDPJD-GUID-2ADAB75C-88C9-4956-98C3-FE0ED96444CA" class="sect3">Java Database Connectivity Driver (JDBC)</h3>
               <div>
                  <p>JDBC is a database access protocol that enables you to connect to a database and run SQL statement and queries on the database. JDBC drivers implement and comply with the latest JDBC specifications. Java application need to have <code class="codeph">ojdbc8.jar</code> compatible with JDK8 in their classpath.
                  </p>
                  <p>The core Java class libraries provide the JDBC APIs, <code class="codeph">java.sql</code> and <code class="codeph">javax.sql</code></p>
                  <p>The following sections describe Oracle support for the JDBC standard: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Oracle JDBC Thin Driver</p>
                     </li>
                     <li>
                        <p>Oracle JDBC Packages</p>
                     </li>
                  </ul>
                  <div class="section">
                     <p class="subhead2" id="GUID-2ADAB75C-88C9-4956-98C3-FE0ED96444CA__GUID-32623499-6C25-4160-B67A-8FFCC9FDDCEE">Oracle JDBC Thin Driver</p>
                     <p>Oracle recommends using the JDBC Thin Driver for most requirements. The JDBC Thin Driver will work on any system with a suitable Java Virtual Machine. (JVM). Some other client drivers that Oracle provides are JDBC thin driver, Oracle Call Interface (OCI) driver, Server side thin driver, and server side internal driver. </p>
                     <p>The JDBC Thin Driver is a pure Java, Type IV driver. The JDBC driver version )ojdbc8.jar) inludes support for JDK 8.</p>
                     <p>JDBC Thin Driver communicates with the server using SQL*Net to access the database.</p>
                     <div class="infoboxnotealso" id="GUID-2ADAB75C-88C9-4956-98C3-FE0ED96444CA__GUID-49DC1247-511A-42D7-BEAA-68F742FC6906">
                        <p class="notep1">See Also:</p><span><cite>Oracle Database JDBC Developerâ€™s Guide</cite></span></div>
                     <p><span class="bold">Action Item 1:</span> Change the DB_URL to point to your database. If you need help, refer to the DataSourceSample.java on Github. 
                     </p>
                     <div class="p"><pre class="pre codeblock"><code>import java.sql.Connection;
import java.sql.SQLException;
import java.sql.DatabaseMetaData;

import oracle.jdbc.pool.OracleDataSource;
import oracle.jdbc.OracleConnection;

public class DataSourceSample {  
  // The recommended format of a connection URL is the long format with the
  // connection descriptor.
  // final static String DB_URL= "jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS=(HOST=myhost)(PORT=1521)(PROTOCOL=tcp))(CONNECT_DATA=(SERVICE_NAME=myorcldbservicename)))";

  final static String DB_URL= "jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS=(HOST=localhost)(PORT=5521)(PROTOCOL=tcp))(CONNECT_DATA=(SERVICE_NAME=<span class="italic">service name</span>)))";
  final static String DB_USER = "<span class="italic">username</span>";
  final static String DB_PASSWORD = <span class="italic">password</span>;

  public static void main (String args[]) throws SQLException {

    OracleDataSource ods = new OracleDataSource();
    ods.setURL(DB_URL);    
    ods.setUser(DB_USER);
    ods.setPassword(DB_PASSWORD);

    // With AutoCloseable, the connection is closed automatically.
    try (OracleConnection connection = (OracleConnection)  
      ods.getConnection()) {
      // Get the JDBC driver name and version 
      DatabaseMetaData dbmd = connection.getMetaData();       
      System.out.println("Driver Name: " + dbmd.getDriverName());
      System.out.println("Driver Version: " + 
        dbmd.getDriverVersion());
      System.out.println("Database Username is: " + 
        connection.getUserName());
    }   
  }
}
</code></pre></div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-E59E9147-A57F-4331-95E4-8A99B5B6774D" name="GUID-E59E9147-A57F-4331-95E4-8A99B5B6774D"></a><h3 id="TDPJD-GUID-E59E9147-A57F-4331-95E4-8A99B5B6774D" class="sect3">Universal Connection Pool</h3>
               <div>
                  <p>Connection pools help improve performance by reusing connection objects and reducing the number of times that connection objects are created.</p>
                  <p>Oracle Universal Connection Pool (UCP) is a feature rich Java connection pool that provides connection pool functionalities, along with high availability, scalability and load balancing with the help of tighter integration with Oracle Database configurations.</p>
                  <p>A Java application or container must have <code class="codeph">ucp.jar</code> in their classpath, along with the <code class="codeph">ojdbc8.jar</code> (JDK8), to be able to use UCP.
                  </p>
                  <div class="infoboxnotealso" id="GUID-E59E9147-A57F-4331-95E4-8A99B5B6774D__GUID-A0292E63-4C57-4556-9418-68881BEC1345">
                     <p class="notep1">See Also:</p><span><cite>Oracle Universal Connection Pool Developerâ€™s Guide</cite></span></div>
                  <p><span class="bold">Action Item 2:</span> Change the DB_URL to point to your database.
                  </p>
                  <div class="p"><pre class="pre codeblock"><code>Import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import oracle.ucp.jdbc.PoolDataSourceFactory;
import oracle.ucp.jdbc.PoolDataSource;

public class UCPSample {
  // final static String DB_URL=   "jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS=(HOST=myhost)(PORT=1521)(PROTOCOL=tcp))(CONNECT_DATA=(SERVICE_NAME=myorcldbservicename)))";
 
  final static String DB_USER = "<span class="italic">username</span>";
  final static String DB_PASSWORD = "<span class="italic">pwd</span>";
  final static String CONN_FACTORY_CLASS_NAME = "oracle.jdbc.pool.OracleDataSource";

  /*
   * The sample demonstrates UCP as client side connection pool.
   */
  public static void main(String args[]) throws Exception {
    // Get the PoolDataSource for UCP
    PoolDataSource pds = PoolDataSourceFactory.getPoolDataSource();

    // Set the connection factory first before all other properties
    pds.setConnectionFactoryClassName(CONN_FACTORY_CLASS_NAME);
    pds.setURL(DB_URL);
    pds.setUser(DB_USER);
    pds.setPassword(DB_PASSWORD);
    pds.setConnectionPoolName("JDBC_UCP_POOL");

    // Default is 0. Set the initial number of connections to be 
    // created when UCP is started.
    pds.setInitialPoolSize(5);

    // Default is 0. Set the minimum number of connections
    // that is maintained by UCP at runtime.
    pds.setMinPoolSize(5);

    // Default is Integer.MAX_VALUE (2147483647). Set the maximum 
    // number of connections allowed on the connection pool.
    pds.setMaxPoolSize(20);

    // Default is 30secs. Set the frequency in seconds to enforce 
    // the timeout properties. Applies to    
    // inactiveConnectionTimeout(int secs),
    // AbandonedConnectionTimeout(secs)&amp; 
    //TimeToLiveConnectionTimeout(int secs).
    // Range of valid values is 0 to Integer.MAX_VALUE.
    pds.setTimeoutCheckInterval(5);

    // Default is 0. Set the maximum time, in seconds, that a
    // connection remains available in the connection pool.
    pds.setInactiveConnectionTimeout(10);

    System.out.println("Available connections before checkout: "
        + pds.getAvailableConnectionsCount());
    System.out.println("Borrowed connections before checkout: "
        + pds.getBorrowedConnectionsCount());
    // Get the database connection from UCP.
    try (Connection conn = pds.getConnection()) {
      System.out.println("Available connections after checkout: "
          + pds.getAvailableConnectionsCount());
      System.out.println("Borrowed connections after checkout: "
          + pds.getBorrowedConnectionsCount());
      // Perform a database operation
      printEmployees(conn);
    } catch (SQLException e) {
      System.out.println("UCPSample - " + "SQLException occurred : "
          + e.getMessage());
    }
    System.out.println("Available connections after checkin: "
        + pds.getAvailableConnectionsCount());
    System.out.println("Borrowed connections after checkin: "
        + pds.getBorrowedConnectionsCount());
  }
 /*
  * Displays first_name and last_name from the employees table.
  */
  public static void printEmployees(Connection connection) 
     throws SQLException {
    // Statement and ResultSet are AutoCloseable and closed 
    // automatically. 
    try (Statement statement = connection.createStatement()) {      
      try (ResultSet resultSet = statement
          .executeQuery("select first_name, last_name from 
            employees")) {
        System.out.println("FIRST_NAME" + "  " + "LAST_NAME");
        System.out.println("---------------------");
        while (resultSet.next())
          System.out.println(resultSet.getString(1) + " "
              + resultSet.getString(2) + " ");       
      }
    }   
  } 
}
</code></pre></div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-5414DE01-3133-490E-9D8F-A31B578C35E6" name="GUID-5414DE01-3133-490E-9D8F-A31B578C35E6"></a><h3 id="TDPJD-GUID-5414DE01-3133-490E-9D8F-A31B578C35E6" class="sect3">Java in the Database (OJVM)</h3>
               <div>
                  <p>Oracle Database has a Java Virtual Machine (JVM) that resides in the server. It helps Java applications running in the Oracle JVM on the server to access data present on the same system and same process.</p>
                  <p>Java in the Database is recommended for applications that are data-intensive. JVM has the ability to use the underlying Oracle RDBMS libraries directly, without the use of a network connection between the Java code and SQL data. This helps improve performance and execution. For data access, Oracle Database uses server-side internal driver when Java code runs on the server.</p>
                  <p><span class="bold">Action Item 3:</span> Connect to the database through SQLPlus and run <a href="https://github.com/oracle/oracle-db-examples/blob/master/java/ojvm/ServersideConnect.sql" target="_blank">ServersideConnect.sql</a> before invoking <a href="https://github.com/oracle/oracle-db-examples/blob/master/java/ojvm/ServersideConnect.java" target="_blank">ServersideConnect.java</a>. For more information, refer to the samples of Github.
                  </p>
                  <p><span class="bold">ServersideConnect.sql </span></p>
                  <div class="p"><pre class="pre codeblock"><code>
Rem NAME
Rem ServersideConnect.sql 
Rem
Rem DESCRIPTION
Rem SQL for invoking the method which gets a server side connection to
rem Reads the content of the Java source from ServersideConnect.java 
rem then compiles it 
connect <span class="italic">username</span>/<span class="italic">pwd</span>
CREATE OR REPLACE AND COMPILE JAVA SOURCE NAMED ServersideConnect_src AS
@ ServersideConnect.java
/
show error
rem A wrapper (a.k.a. Call Spec), to invoke Java
rem function in the database from SQL, PL/SQL, and client applications
CREATE OR REPLACE PROCEDURE ServersideConnect_proc AS 
LANGUAGE JAVA NAME 'ServersideConnect.jrun ()';
/
rem running the sample
connect <span class="italic">username</span>/<span class="italic">pwd</span>
SET SERVEROUTPUT ON SIZE 10000 
CALL dbms_java.set_output (10000);

execute ServersideConnect_proc;


InternalT2Server.java
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import oracle.jdbc.driver.OracleDriver;
import oracle.jdbc.pool.OracleDataSource;

public class ServersideConnect {

  static public void jrun() throws SQLException {
    // For testing ServersideConnect
    // test("jdbc:oracle:kprb:@");
    method1("jdbc:default:connection");
    method2();
  }  
 /*
  * Shows using the server side Type 2 driver a.k.a KPRB driver 
  */ 
 static public void method1 (String url) throws SQLException {
    Connection connection = null; 
    try {
     // Method 1: Using OracleDataSource
      OracleDataSource ods = new OracleDataSource();
      ods.setURL(url);
      connection = ods.getConnection();
      System.out.println("Method 1: Getting Default Connection "
          + "using OracleDataSource");
      // Perform database operation
      printEmployees(connection);
    }
}

static public void method2 () throws SQLException {
   Connection connection = null; 
   try {
        OracleDriver ora = new OracleDriver();
        connection = ora.defaultConnection();
        System.out.println("Method 2: Getting Default Connection "
          + "using OracleDriver");
        // Perform database operation
        printEmployees(connection);
   }
}

 /*
  * Displays employee_id and first_name from the employees table.
  */
  static public void printEmployees(Connection connection) 
     throws SQLException {
    ResultSet resultSet = null;
    Statement statement = null;
    try {
      statement = connection.createStatement();
      resultSet = statement.executeQuery("SELECT employee_id, first_name" 
         +    " FROM employees order by employee_id");
      while (resultSet.next()) {
        System.out.println("Emp no: " + resultSet.getInt(1) + " Emp name: "
            + resultSet.getString(2));
      }
    }
    catch (SQLException ea) {
      System.out.println("Error during execution: " + ea);
      ea.printStackTrace();
    }
    finally {
      if (resultSet != null) resultSet.close();
      if (statement != null) statement.close();   
    }
  }
}

</code></pre></div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>