<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Distributed LOBs</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database SecureFiles and Large Objects Developer's Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database SecureFiles and Large Objects Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="securefiles-and-large-objects-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T02:58:18-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96333-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="operations-specific-to-persistent-and-temporary-LOBs.html" title="Previous" type="text/html">
      <link rel="next" href="DDL-DML-statements-with-LOBs.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SecureFiles and Large Objects Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADLOB">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="operations-specific-to-persistent-and-temporary-LOBs.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="DDL-DML-statements-with-LOBs.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database SecureFiles and Large Objects Developer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="getting-started.html" property="item" typeof="WebPage"><span property="name">    Getting Started</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Distributed LOBs</li>
            </ol>
            <a id="GUID-7E450E86-3E4E-4714-A164-FD36B93722F6" name="GUID-7E450E86-3E4E-4714-A164-FD36B93722F6"></a>
            
            <h2 id="ADLOB-GUID-7E450E86-3E4E-4714-A164-FD36B93722F6" class="sect2"><span class="enumeration_chapter">5 </span>Distributed LOBs
            </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="distributed-LOBs.html#GUID-9A82A4FB-6AE0-4300-BD4F-88FA31DE5C91">Working with Remote LOBs</a></p>
                     </li>
                     <li>
                        <p><a href="distributed-LOBs.html#GUID-E2252E8F-7086-45C9-82A9-A0CB637F1777">SQL Semantics with LOBs in Remote Tables</a></p>
                     </li>
                     <li>
                        <p><a href="distributed-LOBs.html#GUID-3F146243-4F26-4B50-AE8E-FC292BD22130">Working with Remote LOBs in PL/SQL</a></p>
                     </li>
                     <li>
                        <p><a href="distributed-LOBs.html#GUID-F378F295-1FC9-4081-95C4-91EC740719EA">Using Remote Locators with OCILOB API</a></p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
            </div>
            <div class="sect2"><a id="GUID-9A82A4FB-6AE0-4300-BD4F-88FA31DE5C91" name="GUID-9A82A4FB-6AE0-4300-BD4F-88FA31DE5C91"></a><h3 id="ADLOB-GUID-9A82A4FB-6AE0-4300-BD4F-88FA31DE5C91" class="sect3">Working with Remote LOBs</h3>
               <div>
                  <p></p>
                  <p>You can work with LOB data in remote tables is the following ways:</p>
                  <div class="p">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Directly referencing LOB columns in remote tables (Remote LOB Columns) accessed using a database link.</p>
                        </li>
                        <li>
                           <p>Selecting remote LOB columns into a local LOB locator variable (Remote locator)</p>
                        </li>
                     </ul>
                  </div>
                  <p>Topics</p>
                  <div class="p">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="distributed-LOBs.html#GUID-E9EA88B2-C8E8-48A0-BCE3-CA0FEB24101A">Working with Remote LOB Columns</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-LOBs.html#GUID-B6956FD3-20E0-45D7-8E3D-C415324C49C4">Working with Remote Locator</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADLOB45148"></a><div class="props_rev_3"><a id="GUID-E9EA88B2-C8E8-48A0-BCE3-CA0FEB24101A" name="GUID-E9EA88B2-C8E8-48A0-BCE3-CA0FEB24101A"></a><h4 id="ADLOB-GUID-E9EA88B2-C8E8-48A0-BCE3-CA0FEB24101A" class="sect4">Working with Remote LOB Columns</h4>
                  <div>
                     <div class="section">
                        <p>Remote LOBs are supported in these ways:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="distributed-LOBs.html#GUID-DF486934-96D1-448B-99D5-9E129B9F8624">Create table as select or insert as select</a></p>
                           </li>
                           <li>
                              <p><a href="distributed-LOBs.html#GUID-BD5EB0E6-FAA0-42A0-A25B-FC8C64867A40">Functions on remote LOBs returning scalars</a></p>
                           </li>
                           <li>
                              <p><a href="distributed-LOBs.html#GUID-88626227-A3F1-460B-9192-D6644E8A051C">Data Interface for remote LOBs</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="sect4"><a id="GUID-DF486934-96D1-448B-99D5-9E129B9F8624" name="GUID-DF486934-96D1-448B-99D5-9E129B9F8624"></a><h5 id="ADLOB-GUID-DF486934-96D1-448B-99D5-9E129B9F8624" class="sect5">Create table as select or insert as select</h5>
                     <div>
                        <p></p>
                        <div class="section">
                           <p>Only standalone LOB columns are allowed in the select list for statements that are structured in the following manner:</p><pre class="pre codeblock"><code>CREATE TABLE t AS SELECT * FROM table1@remote_site;
INSERT INTO t SELECT * FROM table1@remote_site;
UPDATE t SET lobcol = (SELECT lobcol FROM table1@remote_site);
INSERT INTO table1@remote_site SELECT * FROM local_table;
UPDATE table1@remote_site SET lobcol = (SELECT lobcol FROM local_table);
DELETE FROM table1@remote_site <span class="italic">&lt;WHERE clause involving non_lob_columns&gt;</span></code></pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-BD5EB0E6-FAA0-42A0-A25B-FC8C64867A40" name="GUID-BD5EB0E6-FAA0-42A0-A25B-FC8C64867A40"></a><h5 id="ADLOB-GUID-BD5EB0E6-FAA0-42A0-A25B-FC8C64867A40" class="sect5">Functions on remote LOBs returning scalars</h5>
                     <div>
                        <p></p>
                        <div class="section">
                           <p>SQL and PL/SQL functions having a LOB parameter and returning a scalar data type are supported. Other SQL functions and <code class="codeph">DBMS_LOB</code> APIs are not supported for use with remote LOB columns. For example, the following statement is supported:
                           </p><pre class="pre codeblock"><code>CREATE TABLE tab AS SELECT DBMS_LOB.GETLENGTH@dbs2(clob_col) len FROM tab@dbs2;
CREATE TABLE tab AS SELECT LENGTH(clob_col) len FROM tab@dbs2;
</code></pre><p>However, the following statement is not supported because <code class="codeph">DBMS_LOB.SUBSTR</code> returns a LOB:
                           </p><pre class="pre codeblock"><code>CREATE TABLE tab AS SELECT DBMS_LOB.SUBSTR(clob_col) from tab@dbs2; 
</code></pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-88626227-A3F1-460B-9192-D6644E8A051C" name="GUID-88626227-A3F1-460B-9192-D6644E8A051C"></a><h5 id="ADLOB-GUID-88626227-A3F1-460B-9192-D6644E8A051C" class="sect5">Data Interface for remote LOBs</h5>
                     <div>
                        <div class="section">
                           <p>You can insert a character or binary buffer into a remote <code class="codeph">CLOB</code> or <code class="codeph">BLOB</code>, and select a remote <code class="codeph">CLOB</code> or <code class="codeph">BLOB</code> into a character or binary buffer, for example, using PL/SQL:
                           </p><pre class="pre codeblock"><code>SELECT clobcol1, type1.blobattr INTO varchar_buf1, raw_buf2 FROM table1@remote_site;
INSERT INTO table1@remotesite (clobcol1, type1.blobattr) VALUES varchar_buf1, raw_buf2;
INSERT INTO table1@remotesite (lobcol) VALUES ('test');
UPDATE table1 SET lobcol = 'xxx';
</code></pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B6956FD3-20E0-45D7-8E3D-C415324C49C4" name="GUID-B6956FD3-20E0-45D7-8E3D-C415324C49C4"></a><h4 id="ADLOB-GUID-B6956FD3-20E0-45D7-8E3D-C415324C49C4" class="sect4">Working with Remote Locator</h4>
                  <div>
                     <p>You can select a persistent LOB locator from a remote table into a local variable and this can be done in PL/SQL or in OCI. The remote columns can be of type BLOB, CLOB or NCLOB. The following SQL statement is the basis for all the examples with remote LOB locator in this chapter.</p><pre class="pre codeblock"><code>CREATE TABLE lob_tab (c1 NUMBER, c2 CLOB);</code></pre><p>In the following example, the table <code class="codeph">lob_tab</code> (with columns <code class="codeph">c2</code> of type <code class="codeph">CLOB</code> and <code class="codeph">c1</code> of type number) defined in the remote database is accessible using database link <code class="codeph">db2</code> and a local <code class="codeph">CLOB</code> variable <code class="codeph">lob_var1</code>. 
                     </p><pre class="pre codeblock"><code>SELECT c2 INTO lob_var1 FROM lob_tab@db2 WHERE c1=1;
SELECT c2 INTO lob_var1 FROM lob_tab@db2 WHERE c1=1 for update;</code></pre><p>In PL/SQL, the function <code class="codeph">dbms_lob.isremote</code> can be used to check if a particular LOB belongs to a remote table. Similarly, in <code class="codeph">OCI</code>, you can use the <code class="codeph">OCI_ATTR_LOB_REMOTE</code> attribute of <code class="codeph">OCILobLocator</code> to check if a particular LOB  belongs to a remote table. For example,
                     </p><pre class="pre codeblock"><code>IF(dbms_lob.isremote(lob_var1)) THEN
dbms_output.put_line(‘LOB locator is remote)
ENDIF; </code></pre><div class="infoboxnotealso" id="GUID-B6956FD3-20E0-45D7-8E3D-C415324C49C4__NOTE-135-3898F14F">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../arpls/DBMS_LOB.html#ARPLS-GUID-003F7DA3-EF8D-4198-8F2E-C7AFE881A2C6" target="_blank">ISREMOTE</a> Function 
                              </p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adlob&amp;id=LNOCI-GUID-E3E231A7-00B9-42F0-B47D-A38E3F131A67" target="_blank">OCI_ATTR_LOB_REMOTE</a> Attribute
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p>Topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="distributed-LOBs.html#GUID-4B19C029-34D4-47D6-9869-CBCF91FFEE2C">Using Local and Remote locators as bind with queries and DML on remote tables</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-LOBs.html#GUID-E6079225-9151-42C4-9BE7-D1CCD1BA6E82">Restrictions when using remote LOB locators</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="sect4"><a id="GUID-4B19C029-34D4-47D6-9869-CBCF91FFEE2C" name="GUID-4B19C029-34D4-47D6-9869-CBCF91FFEE2C"></a><h5 id="ADLOB-GUID-4B19C029-34D4-47D6-9869-CBCF91FFEE2C" class="sect5">Using Local and Remote locators as bind with queries and DML on remote tables</h5>
                     <div>
                        <p></p>
                        <p>For the Queries and  DMLs (<code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, <code class="codeph">DELETE</code>) with bind values, the following four cases are possible. The first case involves local tables and locators and is the standard LOB functionality. The other three cases are part of the distributed LOBs functionality and have restrictions listed at the end of this section.
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Local table with local locator as bind value.</p>
                           </li>
                           <li>
                              <p>Local table with remote locator as bind value</p>
                           </li>
                           <li>
                              <p>Remote table with local locator as bind value</p>
                           </li>
                           <li>
                              <p>Remote table with remote locator as bind value</p>
                           </li>
                        </ul>
                        <p>Queries of the following form which use remote lob locator as bind value will be supported:</p>
                        <p><code class="codeph">SELECT name FROM lob_tab@db2 WHERE length(c1)=length(:lob_v1);</code></p>
                        <p>In the above query, <code class="codeph">c1</code> is an LOB column and <code class="codeph">lob_v1</code> is a remote locator. 
                        </p>
                        <p></p>
                        <p>DMLs of the following forms using a remote LOB locator will be supported. Here, the bind values can be local or remote persistent LOB locators.</p>
                        <p><code class="codeph">UPDATE lob_tab@db2 SET c1=:lob_v1;</code></p>
                        <p><code class="codeph">INSERT into lob_tab@db2 VALUES (:1, :2);</code></p>
                        <p></p>
                        <div class="infoboxnote" id="GUID-4B19C029-34D4-47D6-9869-CBCF91FFEE2C__GUID-827389D5-5537-4D4C-A4FA-37509729C299">
                           <p class="notep1">Note:</p> DMLs with <code class="codeph">returning</code> clause are not supported on remote tables for both scalar and LOB columns.
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-E6079225-9151-42C4-9BE7-D1CCD1BA6E82" name="GUID-E6079225-9151-42C4-9BE7-D1CCD1BA6E82"></a><h5 id="ADLOB-GUID-E6079225-9151-42C4-9BE7-D1CCD1BA6E82" class="sect5">Restrictions when using remote LOB locators</h5>
                     <div>
                        <p></p>
                        <p>General restrictions while using remote LOB locators include the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You cannot select a remote temporary LOB locator into a local variable using <code class="codeph">SELECT</code> statement. For example, 
                              </p>
                              <p><code class="codeph">select substr(c2, 3, 1) from lob_tab@db2 where c1=1</code></p>
                              <p>The above query returns an error.</p>
                           </li>
                           <li>
                              <p>Remote lob functionality will not be supported for Index Organized tables (IOT). An attempt to get a locator from remote an IOT table will result in an error.</p>
                           </li>
                           <li>
                              <p>Both local database and remote database have to be of Database release 12.2 or higher version.</p>
                           </li>
                           <li>
                              <p>With distributed LOBs functionality, tables mentioned in the <code class="codeph">from</code> clause or <code class="codeph">where</code> clause should be collocated on the same database. If remote locators are used as bind variables in the <code class="codeph">where</code> clauses, they should belong to the same remote database.  You cannot have one locator from DB1 and another locator from DB2 to be used as bind variables.
                              </p>
                           </li>
                           <li>
                              <p>Collocated tables or locators use the same database link. It is possible to have 2 different DB Links pointing to the same database.  In the example below, both <code class="codeph">dblink1</code> and <code class="codeph">dblink2</code> point to the same remote database, but perhaps with different authentication method. Oracle Database does not support such operations.
                              </p>
                              <p><code class="codeph">INSERT into tab1@dblink1 SELECT * from tab2@dblink2;</code></p>
                           </li>
                           <li>
                              <p>Bind values should be the same LOB type as the&nbsp;column LOB type. For example, <code class="codeph">NCLOB</code> locators should be bound to <code class="codeph">NCLOB</code> column and <code class="codeph">CLOB</code> locators should be bound to <code class="codeph">CLOB</code> column. Implicit conversion between <code class="codeph">NCLOB</code> and <code class="codeph">CLOB</code> types is not supported in remote LOBs case.
                              </p>
                           </li>
                           <li>
                              <p>DMLs (<code class="codeph">INSERT</code>s/ <code class="codeph">UPDATE</code>s) with Array Binds  is not supported when bind involves a remote locator or  if table involved is a remote  table
                              </p>
                           </li>
                           <li>
                              <p>You cannot select a <code class="codeph">BFILE</code> column from a remote table into a local variable.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-E2252E8F-7086-45C9-82A9-A0CB637F1777" name="GUID-E2252E8F-7086-45C9-82A9-A0CB637F1777"></a><h3 id="ADLOB-GUID-E2252E8F-7086-45C9-82A9-A0CB637F1777" class="sect3">SQL Semantics with LOBs in Remote Tables</h3>
               <div>
                  <p></p>
                  <p>Topics:</p>
                  <div class="p">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="distributed-LOBs.html#GUID-B31CB736-B03F-4333-B5E2-EEF883D7D3E5">Built-in Functions for Remote LOBs and BFILEs</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-LOBs.html#GUID-8AD11782-080D-4772-BF8E-1F3AF2652551">Passing Remote Locator to Built in SQL Functions</a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B31CB736-B03F-4333-B5E2-EEF883D7D3E5" name="GUID-B31CB736-B03F-4333-B5E2-EEF883D7D3E5"></a><h4 id="ADLOB-GUID-B31CB736-B03F-4333-B5E2-EEF883D7D3E5" class="sect4"> Built-in Functions for Remote LOBs and BFILEs</h4>
                  <div>
                     <p></p>
                     <p>Any SQL built-in functions and user-defined functions that are supported on local LOBs and BFILEs are also supported on remote LOBs and BFILEs, as long as the final value returned by nested functions is not a LOB type. This includes functions for remote persistent and temporary LOBs and for BFILEs.</p>
                     <p>Built-in SQL functions which are executed on a remote site can be part of any SQL statement, like <code class="codeph">SELECT</code>, <code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, and <code class="codeph">DELETE</code>. For example:
                     </p><pre class="pre codeblock"><code>SELECT LENGTH(ad_sourcetext) FROM print_media@remote_site -- CLOB
SELECT LENGTH(ad_fltextn) FROM print_media@remote_site;   -- NCLOB
SELECT LENGTH(ad_composite) FROM print_media@remote_site; -- BLOB
SELECT product_id from print_media@remote_site WHERE LENGTH(ad_sourcetext) &gt; 3;

UPDATE print_media@remote_site SET product_id = 2 WHERE LENGTH(ad_sourcetext) &gt; 3;

SELECT TO_CHAR(foo@dbs2(...)) FROM dual@dbs2;
-- where foo@dbs2 returns a temporary LOB
</code></pre><p>The SQL functions fall under the following (not necessarily exclusive) categories:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>SQL functions that are not supported on LOBs: </p>
                           <p>These functions are relevant only for <code class="codeph">CLOB</code>s: an example is <code class="codeph">DECODE</code>.
                           </p>
                           <p>These functions <span class="bold">cannot be supported</span> on remote LOBs because they are not supported on local LOBs.
                           </p>
                        </li>
                        <li>
                           <p>Functions taking exactly one LOB argument (all other arguments are of other data types) and not returning a LOB: </p>
                           <p>These functions are relevant only for CLOBs, NCLOBs, and BLOBs: an example is <code class="codeph">LENGTH</code> and <span class="bold">it is supported</span>. For example:
                           </p><pre class="pre codeblock"><code>SELECT LENGTH(ad_composite) FROM print_media@remote_site;
SELECT LENGTH(ad_header.logo) FROM print_media@remote_site; -- LOB in object
SELECT product_id from print_media@remote_site WHERE LENGTH(ad_sourcetext) &gt; 3;
</code></pre></li>
                        <li>
                           <p>Functions that return a LOB:</p>
                           <p><span class="bold">All these functions are relevant only for CLOBs and NCLOBs. </span>These functions may return the original LOB or produce a temporary LOB. These functions can be performed on the remote site, as long as the result returned to the local site is not a LOB.
                           </p>
                           <p>Functions returning a temporary LOB are: <code class="codeph">REPLACE</code>, <code class="codeph">SUBSTR</code>, <code class="codeph">CONCAT</code>, ||, <code class="codeph">TRIM</code>, <code class="codeph">LTRIM</code>, <code class="codeph">RTRIM</code>, <code class="codeph">LOWER</code>, <code class="codeph">UPPER</code>, <code class="codeph">NLS_LOWER</code>, <code class="codeph">NLS_UPPER</code>, <code class="codeph">LPAD</code>, and <code class="codeph">RPAD</code>.
                           </p>
                           <p>Functions returning the original LOB locator are: <code class="codeph">NVL</code>, <code class="codeph">DECODE</code>, and <code class="codeph">CASE</code>. Note that even though <code class="codeph">DECODE</code> and <code class="codeph">CASE</code> are not supported currently to operate on LOBs, they could operate on other data types and return a LOB.
                           </p>
                           <p>For example, <span class="bold">the following statements are supported:</span></p><pre class="pre codeblock"><code>SELECT TO_CHAR(CONCAT(ad_sourcetext, ad_sourcetext)) FROM print_media@remote_site;
SELECT TO_CHAR(SUBSTR(ad_fltextnfs, 1, 3)) FROM print_media@remote_site;
</code></pre><p>But the <span class="bold">following statements are not supported:</span></p><pre class="pre codeblock"><code>SELECT CONCAT(ad_sourcetext, ad_sourcetext) FROM print_media@remote_site;
SELECT SUBSTR(ad_sourcetext, 1, 3) FROM print_media@remote_site;
</code></pre></li>
                        <li>
                           <p>Functions that take in more than one LOB argument:</p>
                           <p>These are: <code class="codeph">INSTR</code>, <code class="codeph">LIKE</code>, <code class="codeph">REPLACE</code>, <code class="codeph">CONCAT</code>, ||, <code class="codeph">SUBSTR</code>, <code class="codeph">TRIM</code>, <code class="codeph">LTRIM</code>, <code class="codeph">RTRIM</code>, <code class="codeph">LPAD</code>, and <code class="codeph">RPAD</code>. All these functions are relevant only for <code class="codeph">CLOB</code>s and <code class="codeph">NCLOB</code>s.
                           </p>
                           <p>These functions are supported only if all the LOB arguments are in the same <code class="codeph">dblink</code>, and the value returned is not a LOB. For example, <span class="bold">the following is supported:</span></p><pre class="pre codeblock"><code>SELECT TO_CHAR(CONCAT(ad_sourcetext, ad_sourcetext)) FROM print_media@remote_site; -- CLOB
SELECT TO_CHAR(CONCAT(ad_fltextn, ad_fltextn)) FROM print_media@remote_site; -- NCLOB
</code></pre><p><span class="bold">But the following is not supported:</span></p><pre class="pre codeblock"><code>SELECT TO_CHAR(CONCAT(a.ad_sourcetext, b.ad_sourcetext)) FROM print_media@db1 a, print_media@db2 b WHERE a.product_id = b.product_id;
</code></pre></li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-8AD11782-080D-4772-BF8E-1F3AF2652551" name="GUID-8AD11782-080D-4772-BF8E-1F3AF2652551"></a><h4 id="ADLOB-GUID-8AD11782-080D-4772-BF8E-1F3AF2652551" class="sect4">Passing Remote Locator to Built in SQL Functions</h4>
                  <div>
                     <p></p>
                     <div class="p">You can pass a remote locator to most built-in SQL functions such as <code class="codeph">LENGTH, INSTR, SUBSTR</code>, and <code class="codeph">UPPER</code>. For example,<pre class="pre codeblock"><code>Var lob1 CLOB;
BEGIN
	select c2 into lob1 from lob_tab@db2 where c1=1;
END;
/
select length(:lob1) from dual;</code></pre></div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-3F146243-4F26-4B50-AE8E-FC292BD22130" name="GUID-3F146243-4F26-4B50-AE8E-FC292BD22130"></a><h3 id="ADLOB-GUID-3F146243-4F26-4B50-AE8E-FC292BD22130" class="sect3">Working with Remote LOBs in PL/SQL</h3>
               <div>
                  <p></p>
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="distributed-LOBs.html#GUID-FC1965B0-D822-4E80-AC2F-801B7BC00986">PL/SQL Functions for Remote LOBs and BFILEs</a></p>
                     </li>
                     <li>
                        <p><a href="distributed-LOBs.html#GUID-867C48BB-BDC3-400D-BFB7-E36BBC9F2BE8">Using Remote Locators with DBMS_LOB</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-FC1965B0-D822-4E80-AC2F-801B7BC00986" name="GUID-FC1965B0-D822-4E80-AC2F-801B7BC00986"></a><h4 id="ADLOB-GUID-FC1965B0-D822-4E80-AC2F-801B7BC00986" class="sect4"> PL/SQL Functions for Remote LOBs and BFILEs</h4>
                  <div>
                     <p></p>
                     <p>Built-in and user-defined PL/SQL functions that are executed on the remote site and operate on remote LOBs and BFILEs are allowed, as long as the final value returned by nested functions is not a LOB. </p>
                     <p>The following example uses the <code class="codeph">print_media</code> table described in <span class="q">"<a href="working-with-LOBs.html#GUID-D71F0CBE-0717-41A2-BCD4-71E1DDF895D1" title="Many Oracle LOB examples use the print_media table of the Oracle Database Sample Schema PM.">Table for LOB Examples: The PM Schema print_media Table</a>"</span></p><pre class="pre codeblock"><code>SELECT product_id FROM print_media@dbs2 WHERE foo@dbs2(ad_sourcetext, 'aa') &gt; 0;
-- foo is a user-define function returning a NUMBER

DELETE FROM print_media@dbs2 WHERE DBMS_LOB.GETLENGTH@dbs2(ad_graphic) = 0;
</code></pre></div><a id="ADLOB45612"></a><div class="props_rev_3"><a id="GUID-3FF5DBCA-AC5A-4C01-8B25-802500447D78" name="GUID-3FF5DBCA-AC5A-4C01-8B25-802500447D78"></a><h5 id="ADLOB-GUID-3FF5DBCA-AC5A-4C01-8B25-802500447D78" class="sect5">Restrictions on Remote User-Defined Functions</h5>
                     <div>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The restrictions that apply to SQL functions apply here also.</p>
                              <div class="infoboxnotealso" id="GUID-3FF5DBCA-AC5A-4C01-8B25-802500447D78__GUID-5D3A6799-8F7C-4742-B067-F7E52A187F09">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="distributed-LOBs.html#GUID-B31CB736-B03F-4333-B5E2-EEF883D7D3E5">Built-in Functions for Remote LOBs and BFILEs</a></p>
                              </div>
                           </li>
                           <li>
                              <p>A function in one <code class="codeph">dblink</code> cannot operate on LOB data in another dblink.For example, the following statement is not supported:
                              </p><pre class="oac_no_warn" dir="ltr">SELECT a.product_id FROM print_media@dbs1 a, print_media@dbs2 b WHERE 
   CONTAINS@dbs1(b.ad_sourcetext, 'aa') &gt; 0;
</pre></li>
                           <li>
                              <p>One query block cannot contain tables and functions at different <code class="codeph">dblink</code>s. For example, the following statement is not supported:
                              </p><pre class="oac_no_warn" dir="ltr">SELECT a.product_id FROM print_media@dbs2 a, print_media@dbs3 b
    WHERE CONTAINS@dbs2(a.ad_sourcetext, 'aa') &gt; 0 AND
    foo@dbs3(b.ad_sourcetext) &gt; 0;
--  foo is a user-defined function in dbs3
</pre></li>
                           <li>
                              <p>There is no support for performing remote LOB operations (that is, <code class="codeph">DBMS_LOB</code>) from within PL/SQL, other than issuing SQL statements from PL/SQL.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="ADLOB45613"></a><div class="props_rev_3"><a id="GUID-99CA650D-B7A7-452F-825D-F57F314FBC00" name="GUID-99CA650D-B7A7-452F-825D-F57F314FBC00"></a><h5 id="ADLOB-GUID-99CA650D-B7A7-452F-825D-F57F314FBC00" class="sect5">Remote Functions in PL/SQL, OCI, and JDBC</h5>
                     <div>
                        <p>All the SQL statements listed in <a href="distributed-LOBs.html#GUID-3FF5DBCA-AC5A-4C01-8B25-802500447D78">Restrictions on Remote User-Defined Functions</a> work the same if they are executed from inside PL/SQL, OCI, and JDBC. No additional functionality is provided.
                        </p>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-6C566EFA-EA09-4276-9B54-A9FBFE77E399" name="GUID-6C566EFA-EA09-4276-9B54-A9FBFE77E399"></a><h4 id="ADLOB-GUID-6C566EFA-EA09-4276-9B54-A9FBFE77E399" class="sect4">Using Remote Locator in PL/SQL</h4>
                  <div>
                     <div class="p">A remote locator can be passed as a parameter to built in PL/SQL functions like <code class="codeph">LENGTH</code>, <code class="codeph">INSTR</code>, <code class="codeph">SUBSTR</code>, <code class="codeph">UPPER</code> and so on which accepts LOB as input. For example,<pre class="pre codeblock"><code>DECLARE 
substr_data varchar2(4000); 
remote_loc CLOB; 
BEGIN 
SELECT c2 into remote_loc 
FROM lob_tab@db2 WHERE c1=1; 
substr_data := substr(remote_loc, position, length) 
END;</code></pre></div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-867C48BB-BDC3-400D-BFB7-E36BBC9F2BE8" name="GUID-867C48BB-BDC3-400D-BFB7-E36BBC9F2BE8"></a><h4 id="ADLOB-GUID-867C48BB-BDC3-400D-BFB7-E36BBC9F2BE8" class="sect4">Using Remote Locators with <code class="codeph">DBMS_LOB</code></h4>
                  <div>
                     <p></p>
                     <p>All <code class="codeph">DBMS_LOB</code> APIs other than the APIs targeted for BFILEs support operations on remote LOB locators.
                     </p>
                     <p>The following example shows how to pass remote locator as input to <code class="codeph">dbms_lob</code> operations.
                     </p><pre class="pre codeblock"><code>DECLARE
  lob CLOB;
  buf VARCHAR2(120) := 'TST';
  amt NUMBER(2);
  len NUMBER(2);
BEGIN
  amt :=30;
  select c2 into lob from lob_tab@db2 where c1=3 for update;
  dbms_lob.write(lob, amt, 1, buf);
  amt :=30;
  dbms_lob.read(lob, amt, 1, buf);
  len := dbms_lob.getlength(lob);
  dbms_output.put_line(buf);
  dbms_output.put_line(amt);
  dbms_output.put_line('get length output = ' || len);
END;
/</code></pre><p>Topics:</p>
                     <div class="p">
                        <ul style="list-style-type: disc;">
                           <li><a href="distributed-LOBs.html#GUID-49373310-BD7B-4E4A-BBE6-816283A695CD">Restrictions on Using Remote Locators with DBMS_LOB</a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-49373310-BD7B-4E4A-BBE6-816283A695CD" name="GUID-49373310-BD7B-4E4A-BBE6-816283A695CD"></a><h5 id="ADLOB-GUID-49373310-BD7B-4E4A-BBE6-816283A695CD" class="sect5">Restrictions on Using Remote Locators with <code class="codeph">DBMS_LOB</code></h5>
                     <div>
                        <p></p>
                        <p>All the APIs that accepts two LOB locators must have both LOBs collocated at one database.</p>
                        <div class="infoboxnotealso" id="GUID-49373310-BD7B-4E4A-BBE6-816283A695CD__GUID-54B7E692-7508-4A22-A5A5-612FF8FD71A7">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../arpls/DBMS_LOB.html#ARPLS-GUID-A35DE03B-41A6-4E55-8CDE-77737FED9306" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to view the complete list of <code class="codeph">DBMS_LOB</code> APIs.
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-F378F295-1FC9-4081-95C4-91EC740719EA" name="GUID-F378F295-1FC9-4081-95C4-91EC740719EA"></a><h3 id="ADLOB-GUID-F378F295-1FC9-4081-95C4-91EC740719EA" class="sect3">Using Remote Locators with <code class="codeph">OCILOB</code> API
               </h3>
               <div>
                  <p>All <code class="codeph">OCILOB</code> APIs (except APIs meant for BFILEs) support operations on remote <code class="codeph">LOB</code> locators.
                  </p>
                  <div class="infoboxnote" id="GUID-F378F295-1FC9-4081-95C4-91EC740719EA__ALLTHEAPISTHATACCEPTTWOLOCATORSMUST-3B3E4F61">
                     <p class="notep1">Note:</p>All the APIs that accept two locators must obtain both the LOB locators through the same database link.
                  </div>
                  <p>The following list of <code class="codeph">OCILOB</code> functions will give an error when a remote <code class="codeph">LOB</code> locator is passed to them:
                  </p>
                  <div class="p">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">OCILobAssign</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCILobLocatorAssign</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCILobArrayRead()</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCILobArrayWrite()</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">OCILobLoadFromFile2()</code></p>
                        </li>
                     </ul>
                  </div>
                  <p>The following example shows how to pass a remote locator to <code class="codeph">OCILOB</code> API.
                  </p><pre class="pre codeblock"><code>void select_read_remote_lob()
{
  text *select_sql = (text *)"SELECT c2 lob_tab@dbs1 where c1=1";
  ub4 amtp = 10;
  ub4 nbytes = 0;
  ub4 loblen=0;
  OCILobLocator * one_lob;
  text strbuf[40];

 /* initialize single locator */
 OCIDescriptorAlloc(envhp, (dvoid **) &amp;one_lob,
                 (ub4) OCI_DTYPE_LOB,
                 (size_t) 0, (dvoid **) 0)

 OCIStmtPrepare(stmthp, errhp, select_sql, (ub4)strlen((char*)select_sql),
                 (ub4) OCI_NTV_SYNTAX, (ub4) OCI_DEFAULT);

 OCIDefineByPos(stmthp, &amp;defp, errhp, (ub4) 1,
                     (dvoid *) &amp;one_lob,
                     (sb4) -1,
                     (ub2) SQLT_CLOB,
                     (dvoid *) 0, (ub2 *) 0,
                     (ub2 *) 0, (ub4) OCI_DEFAULT));

 /* fetch the remote locator into the local variable one_lob */
 OCIStmtExecute(svchp, stmthp, errhp, 1, 0, (OCISnapshot *)0, 
                 (OCISnapshot *)0, OCI_DEFAULT);

 /* Get the length of the remote LOB */
 OCILobGetLength(svchp, errhp,
                (OCILobLocator *) one_lob, (ub4 *)&amp;loblen)

 printf("LOB length = %d\n", loblen);

 memset((void*)strbuf, (int)'\0', (size_t)40);

 / * Read the data from the remote LOB */
 OCILobRead(svchp, errhp, one_lob, &amp;amtp,
                (ub4) 1, (dvoid *) strbuf, (ub4)&amp; nbytes, (dvoid *)0,
                (OCICallbackLobRead) 0,
                (ub2) 0, (ub1) SQLCS_IMPLICIT));
 printf("LOB content = %s\n", strbuf);

}</code></pre><div class="infoboxnotealso" id="GUID-F378F295-1FC9-4081-95C4-91EC740719EA__OCIPROGRAMMERSGUIDEFORTHECOMPLETELI-3B3E42A7">
                     <p class="notep1">See Also:</p> <span class="italic">OCI Programmer’s Guide</span>, for the complete list of <code class="codeph">OCILOB</code> APIs
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>