<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>SQL Translation and Examples for Oracle Database Provider for DRDA</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="User's Guide">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="provider-drda-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T01:34:46-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2011, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96456-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="install-and-configure-oracle-database-provider-for-DRDA.html" title="Previous" type="text/html">
      <link rel="next" href="admin-and-customization-of-oracle-database-provider-for-DRDA.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Provider for DRDA User's Guide">
    <meta name="dcterms.isVersionOf" content="DRDAS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="install-and-configure-oracle-database-provider-for-DRDA.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="admin-and-customization-of-oracle-database-provider-for-DRDA.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">User's Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">SQL Translation
and Examples for Oracle Database Provider for DRDA</li>
            </ol>
            <a id="GUID-E858CFF0-58D0-41DE-9448-7248DBB9984B" name="GUID-E858CFF0-58D0-41DE-9448-7248DBB9984B"></a><a id="DRDAS196"></a>
            
            <h2 id="DRDAS-GUID-E858CFF0-58D0-41DE-9448-7248DBB9984B" class="sect2"><span class="enumeration_chapter">4 </span>SQL Translation
and Examples for Oracle Database Provider for DRDA
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>SQL Translation is a new feature in Oracle Database
12<span class="italic">c</span> Release 2 (12.2). Oracle Provider for DRDA may be used
without SQL Translation with earlier releases of Oracle Database. 
               </p>
               <p>For more information on SQL Translation, see <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/drdas&amp;id=DRDAA-GUID-5AEDF137-6E67-45D9-90CD-4F6E5B439277" target="_blank"><span class="italic">Oracle&reg; Database Migration Guide</span></a>.
               </p>
               <div class="infoboxnote" id="GUID-E858CFF0-58D0-41DE-9448-7248DBB9984B__GUID-FA9BC9BF-C619-4172-BF07-A0664428CCCE">
                  <p class="notep1">Note:</p> SQL Translation is an optional feature and recommended in cases
where SQL used within the application is more DB2&#x2013;centric syntax. 
               </div>
            </div><a id="DRDAS197"></a><div class="props_rev_3"><a id="GUID-D30391A9-4C40-4EBE-8B8A-BC62C1907EBC" name="GUID-D30391A9-4C40-4EBE-8B8A-BC62C1907EBC"></a><h3 id="DRDAS-GUID-D30391A9-4C40-4EBE-8B8A-BC62C1907EBC" class="sect3">Overview of SQL Translation Process</h3>
               <div>
                  <p>Oracle Database Release 12<span class="italic">c</span> introduces the concept of SQL Translation. This feature enables the translation of 'foreign' SQL statements, such as DB2, into a SQL syntax that may be correctly used by Oracle Database. SQL Translation itself is implemented through a SQL Translator that is most often supplied by a third party to the translation. The SQL Translator inspects the input SQL, and sometimes alters it to adhere to Oracle SQL syntax. A SQL Translation Profile, which is specified through a SQL Translator Interface Package, specifies a SQL Translator that is used.
                  </p>
                  <p>A SQL Translation Profile is a schema-level object of type <code class="codeph">SQL TRANSLATION PROFILE</code>. It references a PL/SQL package through its <code class="codeph">ATTR_TRANSLATOR</code> attribute; this package is known as the SQL Translator Interface Package. The package specifies the third-party SQL translator that performs the SQL translation when the SQL Translation Profile is active. Only one SQL Translation Profile may be enabled at a time.
                  </p>
                  <p>SQL Translation Profiles may be shared among users. Commonly, all users share the same single SQL Translation Profile for a set of packages, but that is not necessary.</p>
                  <p>Note that each DB2 package may be associated with a SQL Translation profile through the attributes kept for that package. The SQL Translator associated with the SQL Translation Profile specified for the DB2 package is used when preparing SQL statements within that DB2 package.</p>
               </div>
               <div class="props_rev_3"><a id="GUID-1F818B0F-A8E7-4F97-9858-3C84EAA2260F" name="GUID-1F818B0F-A8E7-4F97-9858-3C84EAA2260F"></a><h4 id="DRDAS-GUID-1F818B0F-A8E7-4F97-9858-3C84EAA2260F" class="sect4">Implementing SQL Translation</h4>
                  <div>
                     <div class="section">
                        <p>In order for translation to proceed, the following sequence of events must take place:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Acquisition of a SQL Translator.</span></li>
                        <li class="stepexpand"><span>Creation of a SQL Interface Package that references that translator.</span></li>
                        <li class="stepexpand"><span>Creation of a SQL Translation Profile that references the SQL Interface Package.</span><div>
                              <p>This step may be done only once in the life of an instance. However, it must be performed at least once to use SQL Translation.</p>
                              <p>In situations with multiple translators, or where different SQL Translation Profiles are necessary, this process may be repeated.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Association of DB2 packages with a SQL Translation profile.</span><div>
                              <p>This step must be completed for each package created.</p>
                              <p>Note that a package does not have to be created before it is associated with the translation profile; only the name of the package is necessary. This step does not validate that a particular package already exists.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>At execution time, the user passes SQL text to Oracle Database Provider for DRDA through the package.</span></li>
                        <li class="stepexpand"><span>When Oracle Database Provider for DRDA acquires SQL text, it checks if the package is associated with a SQL Translation Profile, and then sets that SQL Translation Profile to be in effect during the time when SQL text is parsed and executed.</span></li>
                        <li class="stepexpand"><span>After Oracle Database Provider for DRDA prepares SQL text for execution, Oracle Database uses the current SQL Translation Profile to translate the SQL statements, and then executes them.</span></li>
                     </ol>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-38D99123-4EAD-482F-BEC4-5B90FB01FA0F" name="GUID-38D99123-4EAD-482F-BEC4-5B90FB01FA0F"></a><h4 id="DRDAS-GUID-38D99123-4EAD-482F-BEC4-5B90FB01FA0F" class="sect4">Requirements for SQL Translation</h4>
                  <div>
                     <div class="section">
                        <p>Successful SQL translation may occur only in the following are true:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A SQL Translation Profile must be enabled for the session, through the following command:</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET SQL_TRANSLATION_PROFILE
</pre></li>
                           <li>
                              <p>The process must specify that incoming SQL statements are in a foreign syntax, or in a non-Oracle SQL dialect. In all cases discussed here, these dialect are variants of DB2 SQL. </p>
                           </li>
                        </ul>
                        <p>For Oracle Database Provider for DRDA product, the preceding two conditions are coupled; if a DB2 package is associated with a SQL Translation Profile, then the SQL statements are expected to be in a foreign syntax, and the SQL Translator associated with the SQL Translation Profile is called to translate any SQL in that package.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DRDAS199"></a><div class="props_rev_3"><a id="GUID-E7419395-B4C1-4844-9630-EC66DB24A2BE" name="GUID-E7419395-B4C1-4844-9630-EC66DB24A2BE"></a><h3 id="DRDAS-GUID-E7419395-B4C1-4844-9630-EC66DB24A2BE" class="sect3">Specifics of Translating DB2-Specific SQL Syntax</h3>
               <div>
                  <p>While most of the SQL constructs that a client application submits to Oracle Database Provider for DRDA may be executed directly, some DB2 SQL constructs are not recognized by Oracle. Consider the known issues that occur when translating DB2 SQL statements issued by an application that is re-configured to use an Oracle Database instance.</p>
                  <p>If a SQL Translation Profile is in place, the SQL Translator associated with the profile may be designed to alter these SQL statements so that the application performs equivalent or similar operations in Oracle SQL, and returns the expected results. </p>
               </div><a id="DRDAS200"></a><div class="props_rev_3"><a id="GUID-BE4C34EC-9EA4-4D46-9A9E-F0A100B732AC" name="GUID-BE4C34EC-9EA4-4D46-9A9E-F0A100B732AC"></a><h4 id="DRDAS-GUID-BE4C34EC-9EA4-4D46-9A9E-F0A100B732AC" class="sect4">DB2 Special Registers</h4>
                  <div>
                     <p>Oracle Database does not support the <code class="codeph">CURRENT TIME</code> special register construct, to get the current time of day. Calls to this construct, as in the following example, results in an <code class="codeph">ORA-00936</code> error.
                     </p><pre class="oac_no_warn" dir="ltr">SELECT CURRENT TIME FROM SYSIBM.SYSDUMMY1</pre></div>
               </div><a id="DRDAS201"></a><div class="props_rev_3"><a id="GUID-6B6F8B15-4CED-421F-A91A-CDC3DA11C2CA" name="GUID-6B6F8B15-4CED-421F-A91A-CDC3DA11C2CA"></a><h4 id="DRDAS-GUID-6B6F8B15-4CED-421F-A91A-CDC3DA11C2CA" class="sect4">DB2 SQL Functions and Procedures</h4>
                  <div>
                     <p>Oracle does not support some functions that are defined in DB2. For example, the <code class="codeph">CEILING</code> function does not exist in Oracle; instead, Oracle SQL syntax includes a compatible <code class="codeph">CEIL</code> function.
                     </p>
                  </div>
               </div><a id="DRDAS202"></a><div class="props_rev_3"><a id="GUID-E31E675B-1B47-4D4B-AFCC-854EFF6B8562" name="GUID-E31E675B-1B47-4D4B-AFCC-854EFF6B8562"></a><h4 id="DRDAS-GUID-E31E675B-1B47-4D4B-AFCC-854EFF6B8562" class="sect4">DB2 Named Datatypes</h4>
                  <div>
                     <p>Some elementary SQL datatypes, such as <code class="codeph">BIGINT</code>, are not defined in Oracle. When the application runs against Oracle, casting a column value or constant as a <code class="codeph">BIGINT</code> produces an error. The following example results in an <code class="codeph">ORA-00902</code> error because <code class="codeph">BIGINT</code> is not recognized as a valid Oracle datatype.
                     </p><pre class="oac_no_warn" dir="ltr">SELECT CAST(12345678912 AS BIGINT) from SYSIBM.SYSDUMMY1</pre></div>
               </div><a id="DRDAS203"></a><div class="props_rev_3"><a id="GUID-C06946A7-F80C-4977-A74B-0FFFF25F7A15" name="GUID-C06946A7-F80C-4977-A74B-0FFFF25F7A15"></a><h4 id="DRDAS-GUID-C06946A7-F80C-4977-A74B-0FFFF25F7A15" class="sect4">DB2 Syntactic Statements</h4>
                  <div>
                     <div class="section">
                        <p>An <code class="codeph">INSERT</code> statement in DB2 may contain syntactic clauses that are Oracle does not interpret. An example of such is the <span class="italic">isolation</span> clause, shown in the following code example.
                        </p><pre class="oac_no_warn" dir="ltr">INSERT INTO SCOTT.DEPT VALUES(50, "FARMING", "SPRINGFIELD") WITH CHG</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="DRDAS204"></a><div class="props_rev_3"><a id="GUID-0DAC0955-7716-4C13-9ECC-C797C12EB99E" name="GUID-0DAC0955-7716-4C13-9ECC-C797C12EB99E"></a><h3 id="DRDAS-GUID-0DAC0955-7716-4C13-9ECC-C797C12EB99E" class="sect3">SQL Translator Interface Package</h3>
               <div>
                  <p>A SQL Translation Profile is a schema-level object of type <code class="codeph">SQL TRANSLATION PROFILE</code> created through the <code class="codeph">DBMS_SQL_TRANSLATOR.CREATE_PROFILE() </code>procedure. The SQL Translator Interface Package is a PL/SQL package of a certain format; it references the third-party-supplied translator objects and is, itself, referenced by the SQL Translation Profile. So the SQL Translator Interface Package connects the SQL Translation Profile and the third-party supplied SQL translator objects.
                  </p>
               </div><a id="DRDAS205"></a><div class="props_rev_3"><a id="GUID-1DF1BB66-B646-4787-9764-CEF30117EE6A" name="GUID-1DF1BB66-B646-4787-9764-CEF30117EE6A"></a><h4 id="DRDAS-GUID-1DF1BB66-B646-4787-9764-CEF30117EE6A" class="sect4">About SQL Translator Interface Package</h4>
                  <div>
                     <p>A SQL Translation Profile references a PL/SQL wrapper package that has a fixed format, the <span class="italic"><span class="bold">SQL Translator Interface Package</span></span>. When a session sets a <code class="codeph">SQL TRANSLATION PROFILE</code>, it specifies that all SQL is translated by the third-party SQL translator associated with the SQL Translator Interface Package. The procedure <code class="codeph">translate_sql()</code> of the SQL Translator Interface Package performs the translation.
                     </p>
                     <p>Note that Oracle <span class="bold">does</span> <span class="bold">not</span> provide a SQL Translator. Instead, a SQL Translator must be obtained from third-party vendors, or developed internally. Oracle provides various administrative scripts for creating and managing a SQL Translation Profile. 
                     </p>
                  </div>
               </div><a id="DRDAS206"></a><div class="props_rev_3"><a id="GUID-E519283E-9BD8-4354-B612-72A07D7A5016" name="GUID-E519283E-9BD8-4354-B612-72A07D7A5016"></a><h4 id="DRDAS-GUID-E519283E-9BD8-4354-B612-72A07D7A5016" class="sect4">Creating a SQL Translator Interface Package</h4>
                  <div>
                     <div class="section">
                        <p><a href="SQLtranslation-and-examples.html#GUID-E519283E-9BD8-4354-B612-72A07D7A5016__BABEJIDC">Example 4-1</a> shows a simple SQL Translation Interface Package used with a SQL Translation Profile. The language and name specifications are relative to the language-type and callable-names in the third-party SQL translator. After logging into the Oracle Database with <code class="codeph">SYSDBA</code> privileges, the following package declaration must be made. The package name is the value of the <code class="codeph">TRANSLATOR_ATTR</code> attribute of the SQL Translation Profile.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-E519283E-9BD8-4354-B612-72A07D7A5016__BABEJIDC">
                        <p class="titleinexample">Example 4-1 Creating a SQL Translator Interface Package</p><pre class="oac_no_warn" dir="ltr">create or replace package SYSIBM.DBTooSQLTranslator as
&nbsp;&nbsp;procedure translate_sql(
&nbsp;&nbsp;&nbsp;&nbsp;sql_text in CLOB, 
&nbsp;&nbsp;&nbsp;translated_text out CLOB);
&nbsp;&nbsp;procedure translate_error(
&nbsp;&nbsp;&nbsp;&nbsp;error_code in BINARY_INTEGER,
&nbsp;&nbsp;&nbsp;&nbsp;translated_code out BINARY_INTEGER,
&nbsp;&nbsp;&nbsp;&nbsp;translated_sqlstate out VARCHAR2);
end;
/
create or replace package body SYSIBM.DBTooSQLTranslator as
&nbsp;&nbsp;procedure translate_sql(
&nbsp;&nbsp;&nbsp;&nbsp;sql_text in CLOB,
&nbsp;&nbsp;&nbsp;&nbsp;translated_text out CLOB ) 
&nbsp;&nbsp;&nbsp;&nbsp;as language JAVA
  name /* actually the "signature" of the third-party callable */
  /* procedure associated with translate_sql    */
   'DBTooSQLApiInterface.translateSQL(oracle.sql.CLOB, oracle.sql.CLOB[])';
 
   procedure translate_error(error_code in BINARY_INTEGER,
    translated_code out BINARY_INTEGER,
    translated_sqlstate out VARCHAR2) as
  language JAVA
  name /* actually the "signature" of the third-party callable */
  /* procedure associated with translate_error  */
 'DBTooSQLApiInterface.translateError(oracle.sql.CLOB, oracle.sql.CLOB[])';
 end;
 /
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DRDAS207"></a><div class="props_rev_3"><a id="GUID-6D192CD7-D2CD-4E1F-921E-F4E63817B3BB" name="GUID-6D192CD7-D2CD-4E1F-921E-F4E63817B3BB"></a><h4 id="DRDAS-GUID-6D192CD7-D2CD-4E1F-921E-F4E63817B3BB" class="sect4">Granting EXECUTE Access to SQL Translator Interface Package</h4>
                  <div>
                     <div class="section">
                        <p>Because the SQL Translator Interface Package is called at run-time, it must have <code class="codeph">EXECUTE</code> access enabled. <a href="SQLtranslation-and-examples.html#GUID-6D192CD7-D2CD-4E1F-921E-F4E63817B3BB__BABJIBDI">Example 4-2</a> shows how to grant this access.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-6D192CD7-D2CD-4E1F-921E-F4E63817B3BB__BABJIBDI">
                        <p class="titleinexample">Example 4-2 Granting EXECUTE access to SQL Translator Interface Package</p><pre class="oac_no_warn" dir="ltr">GRANT EXECUTE ON SYSIBM.DBTooSQLTranslator TO DRDAAS_USER_ROLE</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DRDAS208"></a><div class="props_rev_3"><a id="GUID-4C01C929-6734-46DF-A6D5-67874411E86C" name="GUID-4C01C929-6734-46DF-A6D5-67874411E86C"></a><h4 id="DRDAS-GUID-4C01C929-6734-46DF-A6D5-67874411E86C" class="sect4">Creating a SQL Translation Profile</h4>
                  <div>
                     <div class="section">
                        <p>The SQL Translation Profile may be created and administered by any user who has the <code class="codeph">CREATE SQL TRANSLATION PROFILE</code> authority and <code class="codeph">TRANSLATE ANY SQL</code> authority. The section on Granting Required Authority to Users with <code class="codeph">DRDAAS_TRANS_ADMIN</code> Role shows how to grant these two privileges to <code class="codeph">DRDAAS_TRANS_ADMIN</code>. These privileges may be granted by a user with existing <code class="codeph">SYSDBA</code> privileges.
                        </p>
                        <p>The <code class="codeph">ADMIN OPTION</code> clause enables <code class="codeph">DRDAAS_TRANS_ADMIN</code> to <code class="codeph">GRANT</code> the <code class="codeph">TRANSLATE ANY SQL</code> authority to other Oracle users. In this manner, the <code class="codeph">DRDAAS_TRANS_ADMIN</code> may allow many users with <code class="codeph">DRDAAS_USER_ROLE</code> to use the translation facility, as demonstrated in the section Granting Translation Authority to Users with <code class="codeph">DRDAAS_USER_ROLE</code>.
                        </p>
                        <p>The actual SQL Translation Profile may be managed through a script provided in Creating and Managing the SQL Translation Profile. Note that the administering id must already have the required authority to perform <code class="codeph">CREATE SQL TRANSLATION PROFILE</code>. 
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="SQLtranslation-and-examples.html#GUID-FDFD7434-6BA9-41F7-B855-E91E62A1B249">Granting Translation Authority Through Administrator Role</a></li>
                           <li><a href="SQLtranslation-and-examples.html#GUID-19E03E1E-CFF8-46F1-994F-AD9CFD934069">Granting Translation Authority Through User Role</a></li>
                           <li><a href="SQLtranslation-and-examples.html#GUID-C0F8B954-8884-492A-B910-DD5D17AE9B5C">Creating and Managing SQL Translation Profile</a></li>
                        </ul>
                     </div>
                  </div>
                  <a id="DRDAS209"></a><div class="props_rev_3"><a id="GUID-FDFD7434-6BA9-41F7-B855-E91E62A1B249" name="GUID-FDFD7434-6BA9-41F7-B855-E91E62A1B249"></a><h5 id="DRDAS-GUID-FDFD7434-6BA9-41F7-B855-E91E62A1B249" class="sect5">Granting Translation Authority Through Administrator Role</h5>
                     <div>
                        <div class="example" id="GUID-FDFD7434-6BA9-41F7-B855-E91E62A1B249__BABHCIDC">
                           <p class="titleinexample">Example 4-3 Granting Required Authority to Users with DRDAAS_TRANS_ADMIN Role</p><pre class="oac_no_warn" dir="ltr">GRANT CREATE SQL TRANSLATION PROFILE TO DRDAAS_TRANS_ADMIN;
GRANT TRANSLATE ANY SQL TO DRDAAS_TRANS_ADMIN WITH ADMIN OPTION;
</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="DRDAS210"></a><div class="props_rev_3"><a id="GUID-19E03E1E-CFF8-46F1-994F-AD9CFD934069" name="GUID-19E03E1E-CFF8-46F1-994F-AD9CFD934069"></a><h5 id="DRDAS-GUID-19E03E1E-CFF8-46F1-994F-AD9CFD934069" class="sect5">Granting Translation Authority Through User Role</h5>
                     <div>
                        <div class="example" id="GUID-19E03E1E-CFF8-46F1-994F-AD9CFD934069__BABDHGIE">
                           <p class="titleinexample">Example 4-4 Granting Translation Authority to Users with DRDAAS_USER_ROLE</p><pre class="oac_no_warn" dir="ltr">GRANT TRANSLATE ANY SQL TO DRDAAS_USER_ROLE;
</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="DRDAS211"></a><div class="props_rev_3"><a id="GUID-C0F8B954-8884-492A-B910-DD5D17AE9B5C" name="GUID-C0F8B954-8884-492A-B910-DD5D17AE9B5C"></a><h5 id="DRDAS-GUID-C0F8B954-8884-492A-B910-DD5D17AE9B5C" class="sect5">Creating and Managing SQL Translation Profile</h5>
                     <div>
                        <div class="example" id="GUID-C0F8B954-8884-492A-B910-DD5D17AE9B5C__BABEFDCF">
                           <p class="titleinexample">Example 4-5 Creating and Managing the SQL Translation Profile</p><pre class="oac_no_warn" dir="ltr">declare
&nbsp;&nbsp;PROFILE_DOES_NOT_EXIST exception;
&nbsp;&nbsp;pragma EXCEPTION_INIT(PROFILE_DOES_NOT_EXIST, -24252);
&nbsp;&nbsp;/* profile_name is the nsme of the SQL Translation Profile */
&nbsp;&nbsp;/* created here.  */
&nbsp;&nbsp;profile_name VARCHAR2(32) := 'DRDAAS_TRANS_ADMIN.MY_PROFILE';
 
&nbsp;&nbsp;/* SYSIBM is the schema in which the SQL Translator Interface */
&nbsp;&nbsp;/* package (viz., SYSIBM.DBTooSQLTranslator) is found.   */
&nbsp;&nbsp;sql_trnsltr_intfc_schema VARCHAR2(32) := 'SYSIBM';
 
&nbsp;&nbsp;/* DBTooTranslator is the unqualified package name of the SQL */
&nbsp;&nbsp;/* Translator Interface Package */
&nbsp;&nbsp;sql_trnsltr_intfc_pkgnm VARCHAR2(32) := 'DBTooSQLTranslator';
 
&nbsp;&nbsp;sql_trnsltr_intfc_pkg VARCHAR2(128);
&nbsp;&nbsp;grant_cmd VARCHAR2(256);
&nbsp;&nbsp;cursor_id NUMBER;

begin
&nbsp;&nbsp;sql_trnsltr_intfc_pkg := sql_trnsltr_intfc_schema || '.'  ||
&nbsp;&nbsp;&nbsp;&nbsp;sql_trnsltr_intfc_pkgnm;
&nbsp;&nbsp;begin
&nbsp;&nbsp;&nbsp;&nbsp;DBMS_SQL_TRANSLATOR.DROP_PROFILE(profile_name);
&nbsp;&nbsp;&nbsp;&nbsp;exception
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN PROFILE_DOES_NOT_EXIST THEN NULL; /* ignore if non-existant */
&nbsp;&nbsp;end;
&nbsp;&nbsp;/* Create SQL Translation Profile */
&nbsp;&nbsp;DBMS_SQL_TRANSLATOR.CREATE_PROFILE(profile_name);
&nbsp;&nbsp;/* Associate the SQL Translator Interface Package denoted by */
&nbsp;&nbsp;/* sql_trnsltr_intfc_pkg with this profile    */
&nbsp;&nbsp;DBMS_SQL_TRANSLATOR.SET_ATTRIBUTE(profile_name,
&nbsp;&nbsp;&nbsp;&nbsp;DBMS_SQL_TRANSLATOR.ATTR_TRANSLATOR,
&nbsp;&nbsp;&nbsp;&nbsp;sql_trnsltr_intfc_pkg);	
&nbsp;&nbsp;/* Mark this SQL Translation Profile as "registered" */
&nbsp;&nbsp;DBMS_SQL_TRANSLATOR.SET_ATTRIBUTE(profile_name,
&nbsp;&nbsp;&nbsp;&nbsp;DBMS_SQL_TRANSLATOR.ATTR_TRANSLATION_REGISTRATION,
&nbsp;&nbsp;&nbsp;&nbsp;DBMS_SQL_TRANSLATOR.ATTR_VALUE_TRUE);
&nbsp;&nbsp;/* The owner of the SQL Translator Interface Package must have */
&nbsp;&nbsp;/* full authority for the SQL TRANSLATION PROFILE    */
&nbsp;&nbsp;grant_cmd := 'GRANT ALL ON SQL TRANSLATION PROFILE ' ||
&nbsp;&nbsp;&nbsp;&nbsp;profile_name || ' TO ' || sql_trnsltr_intfc_schema;
&nbsp;&nbsp;cursor_id := DBMS_SQL.OPEN_CURSOR();
&nbsp;&nbsp;DBMS_SQL.PARSE(cursor_id, grant_cmd, DBMS_SQL.NATIVE);
&nbsp;&nbsp;DBMS_SQL.CLOSE_CURSOR(cursor_id);
&nbsp;&nbsp;/* Let all with DRDAAS_USER_ROLE have access to the SQL Translation profile.  */
&nbsp;&nbsp;grant_cmd := 'GRANT USE ON SQL TRANSLATION PROFILE ' ||
&nbsp;&nbsp;&nbsp;&nbsp;profile_name || ' TO DRDAAS_USER_ROLE';
&nbsp;&nbsp;cursor_id := DBMS_SQL.OPEN_CURSOR();
&nbsp;&nbsp;DBMS_SQL.PARSE(cursor_id, grant_cmd, DBMS_SQL.NATIVE);
&nbsp;&nbsp;DBMS_SQL.CLOSE_CURSOR(cursor_id);
end;
/</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="DRDAS212"></a><div class="props_rev_3"><a id="GUID-6CF96387-5D22-40E0-8BCE-DDB90CBB49AF" name="GUID-6CF96387-5D22-40E0-8BCE-DDB90CBB49AF"></a><h3 id="DRDAS-GUID-6CF96387-5D22-40E0-8BCE-DDB90CBB49AF" class="sect3">Using Third-Party SQL Translators</h3>
               <div>
                  <div class="section">
                     <p>To use a third-party translator, its files and objects must be installed in the directory <code class="codeph">$<span class="codeinlineitalic">ORACLE_HOME</span>/rdbms/drdaas/jlib</code>.
                     </p>
                     <p>In case of difficulties, use <code class="codeph">DBMS_JAVA.SET_OUTPUT()</code> procedure to redirect server-side error messages to <code class="codeph">DBMS_OUTPUT</code>.
                     </p>For more information on using Java in Oracle, refer <span class="italic">Oracle&reg; Database Java Developer's Guide</span>.
                  </div>
                  <!-- class="section" -->
               </div><a id="DRDAS213"></a><div class="props_rev_3"><a id="GUID-564767E6-0D4D-4B3E-A8DD-BA636ADD5750" name="GUID-564767E6-0D4D-4B3E-A8DD-BA636ADD5750"></a><h4 id="DRDAS-GUID-564767E6-0D4D-4B3E-A8DD-BA636ADD5750" class="sect4">Using a Third-Party SQL Translator, Loaded as a Single Object</h4>
                  <div>
                     <div class="section">
                        <p>If the third-party SQL translator is in Java, <a href="SQLtranslation-and-examples.html#GUID-564767E6-0D4D-4B3E-A8DD-BA636ADD5750__BABCJICI">Example 4-6</a> may be run in SQL*Plus environment by a <code class="codeph">SYSDBA</code> user. <a href="SQLtranslation-and-examples.html#GUID-564767E6-0D4D-4B3E-A8DD-BA636ADD5750__BABCJICI">Example 4-6</a> uses <code class="codeph">DBMS_JAVA.LOADJAVA()</code> procedure to load the objects into the <code class="codeph">SYSIBM</code> schema; it loads a single third-party object, <code class="codeph">DBTooSQLAPI.jar</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-564767E6-0D4D-4B3E-A8DD-BA636ADD5750__BABCJICI">
                        <p class="titleinexample">Example 4-6 Loading a Third-Party SQL Translator; Single Object</p><pre class="oac_no_warn" dir="ltr">begin
&nbsp;&nbsp;DBMS_JAVA.LOADJAVA('-definer -genmissing -schema SYSIBM ' || '
&nbsp;&nbsp;' rdbms/drdaas/jlib/DBTooSQLAPI.jar', 
&nbsp;&nbsp;'((* SYSIBM)(* PUBLIC)(* -))');
end;
/
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DRDAS214"></a><div class="props_rev_3"><a id="GUID-A93B5D9B-1F46-4337-ADAE-6BDA0845F336" name="GUID-A93B5D9B-1F46-4337-ADAE-6BDA0845F336"></a><h4 id="DRDAS-GUID-A93B5D9B-1F46-4337-ADAE-6BDA0845F336" class="sect4">Using a Third-Party SQL Translator, Loaded as Multiple Objects</h4>
                  <div>
                     <div class="section">
                        <p>If the third-party translator consists of multiple objects, each component must be specified in the <code class="codeph">LOADJAVA</code> call. <a href="SQLtranslation-and-examples.html#GUID-A93B5D9B-1F46-4337-ADAE-6BDA0845F336__BABEAFDG">Example 4-7</a> specifies two translator objects, <code class="codeph">DBTooSQLAPI.jar</code> and <code class="codeph">DBTooMainClass.class</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-A93B5D9B-1F46-4337-ADAE-6BDA0845F336__BABEAFDG">
                        <p class="titleinexample">Example 4-7 Loading a Third-Party SQL Translator; Multiple Objects</p><pre class="oac_no_warn" dir="ltr">begin
&nbsp;&nbsp;DBMS_JAVA.LOADJAVA('-definer -genmissing -schema SYSIBM ' ||
&nbsp;&nbsp;' rdbms/drdaas/jlib/DBTooMainClass.class' ||
&nbsp;&nbsp;' rdbms/drdaas/jlib/DBTooSQLAPI.jar',
&nbsp;&nbsp;'((* SYSIBM)(* PUBLIC)(* -))');
end;
/
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="DRDAS215"></a><div class="props_rev_3"><a id="GUID-A0B8D4FF-34CD-41F9-B8E7-351557E10146" name="GUID-A0B8D4FF-34CD-41F9-B8E7-351557E10146"></a><h3 id="DRDAS-GUID-A0B8D4FF-34CD-41F9-B8E7-351557E10146" class="sect3">Using a Translator Management Script</h3>
               <div>
                  <div class="section">
                     <p>Oracle Database ships a <code class="codeph">drdasqtt_translator_setup.sql</code> script, which manages translation profiles. The script must be invoked in SQL*Plus by a user with <code class="codeph">SYSDBA</code> privileges. It asks for the following inputs:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>SQL Translator Interface Package Schema, such as <code class="codeph">SYSIBM</code>.</span></li>
                     <li class="stepexpand"><span>SQL Translator Interface Package Name, such as <code class="codeph">DBTooTranslator</code>.</span></li>
                     <li class="stepexpand"><span>SQL Translation Profile Schema, such as <code class="codeph">DRDAAS_TRANS_ADMIN</code>.</span></li>
                     <li class="stepexpand"><span>SQL Translation Profile Name, such as <code class="codeph">MY_PROFILE</code>.</span></li>
                     <li class="stepexpand"><span>Language type of the third-party translator, such as Java.</span></li>
                     <li class="stepexpand"><span>The names of files or objects supplied by the third-party vendor. If more than one is supplied, enclose the list in <span class="italic"><span class="bold">four (4)</span></span> single quotes and separate the items by blank spaces, as in the following code:</span><div><pre class="oac_no_warn" dir="ltr">''''rdbms/drdaas/jlib/DBTooMainClass.class rdbms/drdaas/jlib/DBTooSQLAPI.jar''''
</pre></div>
                     </li>
                     <li class="stepexpand"><span>The signature (entry name plus argument descriptions) of the entry in the files or objects supplied by the third-party vendor that are used for translating SQL. For Java-based third-party code, the signature may be obtained through the<code class="codeph"> javap</code> program. Note that signatures that contain blank space must be enclosed within double quotes.</span></li>
                     <li class="stepexpand"><span>The signature (entry name plus argument descriptions) for the entry in the files or objects supplied by the third-party vendor that are used for translating error codes. For Java-based third-party code, the signature may be obtained through the<code class="codeph"> javap</code> program. Note that signatures that contain blank space must be enclosed within double quotes.</span></li>
                  </ol>
               </div>
            </div><a id="DRDAS217"></a><a id="DRDAS216"></a><div class="props_rev_3"><a id="GUID-78027DD7-7EFB-4F16-8CA3-AD18E733D965" name="GUID-78027DD7-7EFB-4F16-8CA3-AD18E733D965"></a><h3 id="DRDAS-GUID-78027DD7-7EFB-4F16-8CA3-AD18E733D965" class="sect3">Verifying the SQL Translator Profile</h3>
               <div>
                  <div class="section">
                     <p>The following steps verify that the SQL Translation Profile is correctly installed and fully enabled.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-78027DD7-7EFB-4F16-8CA3-AD18E733D965__GUID-49CA9D75-055A-4D34-A02F-4A71E5AAC8BD">To verify the SQL Translator Profile configuration:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Log into Oracle Database with SYSDBA privileges</span></li>
                     <li class="stepexpand"><span>Check that the translator profile is loaded into Oracle Database.</span><div><pre class="oac_no_warn" dir="ltr">SELECT * FROM ALL_SQL_TRANSLATION_PROFILES;
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Log in with an id that has <code class="codeph">DRDAAS_USER_ROLE</code> privileges.</span></li>
                     <li class="stepexpand"><span>Ensure that the role is set:</span><div><pre class="oac_no_warn" dir="ltr">SET ROLE DRDAAS_USER_ROLE;
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Set the SQL Translation Profile for of session to the value specified at the time the SQL Translation Profile was created.</span><div><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET SQL_TRANSLATION_PROFILE = DRDAAS_TRANS_ADMIN.MY_PROFILE;
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Attempt the following commands:</span><div><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET EVENTS = '10601 trace name context forever, level 32';
SELECT CAST(1234567 AS BIGINT) FROM DUAL;
ALTER SESSION SET EVENTS = '10601 trace name context off';
SELECT CAST(1234567 AS BIGINT) FROM DUAL;
</pre><p>The first <code class="codeph">SELECT</code> should succeed, while the second should fail. The <code class="codeph">ALTER SESSION SET EVENTS</code> commands specify that the following SQL is one of:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>foreign syntax (trace name context forever, level 32) </p>
                              </li>
                              <li>
                                 <p>native Oracle syntax (trace name context off) </p>
                              </li>
                           </ul>
                           <p>This works only when using SQL*Plus.</p>
                        </div>
                     </li>
                  </ol>
               </div>
            </div><a id="DRDAS218"></a><div class="props_rev_3"><a id="GUID-D0F69853-D2FE-452C-8914-FF5332BE7356" name="GUID-D0F69853-D2FE-452C-8914-FF5332BE7356"></a><h3 id="DRDAS-GUID-D0F69853-D2FE-452C-8914-FF5332BE7356" class="sect3">Altering the SQL Translation Profile</h3>
               <div>
                  <div class="section">
                     <p>At times, it becomes necessary to completely change the SQL Translation Profile, and make the <code class="codeph">SQL TRANSLATION PROFILE</code> attribute of a DB2 package reference a new SQL Translation Profile.
                     </p>
                     <p>DB2 packages usually come in sets, and the names of the DB2 packages are determined by the client. However, if the client uses ODBC to access Oracle Database Provider for DRDA, the ODBC driver determines the names of the packages.</p>
                     <p>Oracle supplies two scripts that may be used to set the SQL Translation Profile attribute for a set of packages.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>If the DataDirect ODBC driver accesses Oracle Database Provider for DRDA, use the <code class="codeph">drdasqt_set_profile_dd.sql</code> script, in the <code class="codeph">drdaas/admin</code> directory.
                           </p>
                        </li>
                        <li>
                           <p>If the IBM ODBC driver accesses Oracle Database Provider for DRDA, use the <code class="codeph">drdasqt_set_profile_ibm.sql</code> script, in the <code class="codeph">drdaas/admin</code> directory. Native client application may also use this script, but it may have to be extended.
                           </p>
                        </li>
                     </ul>
                     <p>These scripts may be copied and altered for use with other sets of DB2 packages.</p>
                     <p>Additionally, each of these scripts must be run in SQL*Plus by a user with <code class="codeph">DRDAAS_ADMIN_ROLE</code> privileges. The script prompts for the qualified name of the profile that is referenced by the various packages (such as <code class="codeph">DRDAAS_TRANS_ADMIN.MY_PROFILE</code>). It also prompts for the default Package Collection schema, which is usually <code class="codeph">NULLID</code>.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>