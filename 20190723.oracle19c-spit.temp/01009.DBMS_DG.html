<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The DBMS_DG package allows applications to notify the primary database or the fast-start failover target database in an Oracle Data Guard broker environment to initiate a fast-start failover when the application encounters a condition that warrants a failover.">
      <meta name="description" content="The DBMS_DG package allows applications to notify the primary database or the fast-start failover target database in an Oracle Data Guard broker environment to initiate a fast-start failover when the application encounters a condition that warrants a failover.">
      <title>DBMS_DG</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="PL/SQL Packages and Types Reference">
      <meta property="og:description" content="The DBMS_DG package allows applications to notify the primary database or the fast-start failover target database in an Oracle Data Guard broker environment to initiate a fast-start failover when the application encounters a condition that warrants a failover.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="PL/SQL Packages and Types Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-pl-sql-packages-and-types-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-25T11:24:34-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96430-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="DBMS_DESCRIBE.html" title="Previous" type="text/html">
      <link rel="next" href="DBMS_DIMENSION.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference">
    <meta name="dcterms.isVersionOf" content="ARPLS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="DBMS_DESCRIBE.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="DBMS_DIMENSION.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">PL/SQL Packages and Types Reference</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> DBMS_DG</li>
            </ol>
            <a id="GUID-B9D52B3F-F2AD-4800-9D07-7B969B86442A" name="GUID-B9D52B3F-F2AD-4800-9D07-7B969B86442A"></a><a id="ARPLS920"></a><a id="ARPLS920"></a>
            
            <h2 id="ARPLS-GUID-B9D52B3F-F2AD-4800-9D07-7B969B86442A" class="sect2"><span class="enumeration_chapter">58 </span> DBMS_DG
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The <code class="codeph">DBMS_DG</code> package allows applications to notify the primary database or the fast-start failover target database in an Oracle Data Guard broker environment to initiate a fast-start failover when the application encounters a condition that warrants a failover.
               </p>
               <p>This chapter contains the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="DBMS_DG.html#GUID-C786B2E4-6F04-48CD-9E07-C7863182C835" title="There are conditions detectable by applications running outside of the Oracle database that may warrant the Oracle Data Guard broker to perform a fast-start failover. Because the range of possible conditions is virtually unlimited, it is left to the applications to determine which conditions warrant a fast-start failover.">Using DBMS_DG</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_DG.html#GUID-CBA5D4CB-7D33-44E8-B86D-59C7B6967564" title="The DBMS_DG package runs with invoker's rights and requires the SYSDBA privilege.">Security Model</a></p>
                  </li>
                  <li>
                     <p><a href="DBMS_DG.html#GUID-0DEA3CDF-F93F-4F70-9D05-20CA954E7605" title="The DBMS_DG package contains one subprogram, the INITIATE_FS_FAILOVER procedure.">Summary of the DBMS_DG Subprogram</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-B9D52B3F-F2AD-4800-9D07-7B969B86442A__GUID-D25A469E-BA01-4503-9028-366FE5E0AFDD">
                  <p class="notep1">See Also:</p>
                  <p><a href="../dgbkr/using-data-guard-broker-to-manage-switchovers-failovers.html#DGBKR-GUID-995CED84-BEA1-4675-9C68-B37CB996924F" target="_blank"><span><cite>Oracle Data Guard Broker</cite></span></a></p>
               </div>
            </div><a id="ARPLS66222"></a><a id="ARPLS66222"></a><div class="props_rev_3"><a id="GUID-C786B2E4-6F04-48CD-9E07-C7863182C835" name="GUID-C786B2E4-6F04-48CD-9E07-C7863182C835"></a><h3 id="ARPLS-GUID-C786B2E4-6F04-48CD-9E07-C7863182C835" class="sect3"><span class="enumeration_section">58.1 </span>Using DBMS_DG
               </h3>
               <div>
                  <p>There are conditions detectable by applications running outside of the Oracle database that may warrant the Oracle Data Guard broker to perform a fast-start failover. Because the range of possible conditions is virtually unlimited, it is left to the applications to determine which conditions warrant a fast-start failover.</p>
                  <div class="section">
                     <p>When such conditions occur, the application calls the <code class="codeph">DBMS_DG</code>.<code class="codeph">INITIATE_FS_FAILOVER </code>procedure to alert either the primary or fast-start failover target standby database that the application wants a fast-start failover to occur immediately. The database on which the procedure was called then notifies the observer, which immediately initiates a fast-start failover as long as the standby database is in a valid fast-start failover state ("observed" and either "synchronized" or "within lag") to accept a failover.If the configuration is not in a valid fast-start failover state, the <code class="codeph">INITIATE_FS_FAILOVER</code> subprogram returns an ORA error message (it will not signal an exception) to inform the calling application that a fast-start failover could not be performed.
                     </p>
                     <div class="infoboxnote" id="GUID-C786B2E4-6F04-48CD-9E07-C7863182C835__GUID-427B4823-5C34-4E04-B415-C01FFDFD4AAE">
                        <p class="notep1">Note:</p>
                        <p>If you are working in a multitenant container database (CDB), then functions within <code class="codeph">DBMS_DG</code> are only executed at the root level. Ensure you are connected at the root level, not at the individual pluggable database (PDB) level. 
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS73145"></a><a id="ARPLS73145"></a><div class="props_rev_3"><a id="GUID-CBA5D4CB-7D33-44E8-B86D-59C7B6967564" name="GUID-CBA5D4CB-7D33-44E8-B86D-59C7B6967564"></a><h3 id="ARPLS-GUID-CBA5D4CB-7D33-44E8-B86D-59C7B6967564" class="sect3"><span class="enumeration_section">58.2 </span>DBMS_DG Security Model
               </h3>
               <div>
                  <p>The <code class="codeph">DBMS_DG</code> package runs with invoker's rights and requires the <code class="codeph">SYSDBA</code> privilege.
                  </p>
               </div>
            </div><a id="ARPLS66223"></a><a id="ARPLS66224"></a><a id="ARPLS66224"></a><a id="ARPLS66223"></a><div class="props_rev_3"><a id="GUID-0DEA3CDF-F93F-4F70-9D05-20CA954E7605" name="GUID-0DEA3CDF-F93F-4F70-9D05-20CA954E7605"></a><h3 id="ARPLS-GUID-0DEA3CDF-F93F-4F70-9D05-20CA954E7605" class="sect3"><span class="enumeration_section">58.3 </span>Summary of the DBMS_DG Subprogram
               </h3>
               <div>
                  <p>The <code class="codeph">DBMS_DG</code> package contains one subprogram, the <code class="codeph">INITIATE_FS_FAILOVER</code> procedure.
                  </p>
                  <div class="tblformal" id="GUID-0DEA3CDF-F93F-4F70-9D05-20CA954E7605__GUID-ADD07D8B-B42D-47AE-9A22-33ECB6B6C185">
                     <p class="titleintable">Table 58-1 DBMS_DG Package Subprogram</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_DG Package Subprogram" summary="Summary of the procedures in the DBMS_DG Subprogram." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d407971e444">Subprogram</th>
                              <th align="left" valign="bottom" width="69%" id="d407971e447">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d407971e452" headers="d407971e444 ">
                                 <p><a href="DBMS_DG.html#GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED" title="Use this procedure to specify a condition string that, when encountered by an application, allows the application to request that a fast-start failover be invoked.">INITIATE_FS_FAILOVER Procedure</a></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d407971e452 d407971e447 ">
                                 <p>Enables an application to notify either the primary or fast-start failover target standby database that a fast-start failover is necessary when the application encounters conditions that warrant a failover. This procedure can only be called while connected to a primary database or a fast-start failover standby database.</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="ARPLS66225"></a><a id="ARPLS66226"></a><a id="ARPLS66227"></a><a id="ARPLS66226"></a><a id="ARPLS66227"></a><a id="ARPLS66225"></a><div class="props_rev_3"><a id="GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED" name="GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED"></a><h4 id="ARPLS-GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED" class="sect4"><span class="enumeration_section">58.3.1 </span>INITIATE_FS_FAILOVER Procedure
                  </h4>
                  <div>
                     <p>Use this procedure to specify a condition string that, when encountered by an application, allows the application to request that a fast-start failover be invoked.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED__GUID-615D81CF-B62A-474E-9905-5EC2D0844ED9">Syntax</p><pre class="oac_no_warn" dir="ltr">DBMS_DG.INITIATE_FS_FAILOVER (
     condstr          IN VARCHAR2)
RETURN BINARY_INTEGER;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED__GUID-068A887F-D523-493C-AB43-7B82F048A6C7">Parameters</p>
                        <div class="tblformal" id="GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED__GUID-FDF74A29-7A04-4033-A520-94FBBD345CA8">
                           <p class="titleintable">Table 58-2 INITIATE_FS_FAILOVER Procedure Parameters</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="INITIATE_FS_FAILOVER Procedure Parameters" summary="Parameters for the DBMS_DG.INITIATE_FS_FAILOVER procedure" width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d407971e577">Parameter</th>
                                    <th align="left" valign="bottom" width="69%" id="d407971e580">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d407971e585" headers="d407971e577 ">
                                       <p>condstr</p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d407971e585 d407971e580 ">
                                       <p>Specifies the condition string for which a fast-start failover should be requested. If no condition string argument is supplied, the default string of "Application Failover Requested" will be logged in the broker log file and in the database alert log of the database on which the procedure was called.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED__GUID-22742070-222F-41E2-AA53-9A463352D76F">Usage Notes</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>This procedure returns a binary integer. </p>
                           </li>
                           <li>
                              <p>Query the <code class="codeph">V$FS_FAILOVER_STATS</code> view to see the time of the last fast-start failover and the reason it was performed.
                              </p>
                           </li>
                           <li>
                              <p>This procedure can only be called while connected to a primary database or a fast-start failover standby database.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED__GUID-C158EE8A-C7F6-4A5C-AE59-451E56171B57">Errors</p>
                        <div class="tblformal" id="GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED__GUID-D32B1CD7-259E-4BF6-BB14-364A822CC9B6">
                           <p class="titleintable">Table 58-3 INITIATE_FS_FAILOVER Procedure Errors</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="INITIATE_FS_FAILOVER Procedure Errors" summary="Errors returned by the DBMS_DG.INITIATE_FS_FAILOVER procedure." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="41%" id="d407971e620">Error</th>
                                    <th align="left" valign="bottom" width="59%" id="d407971e623">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="41%" id="d407971e628" headers="d407971e620 ">
                                       <p><code class="codeph">ORA-00000: normal, successful completion</code></p>
                                    </td>
                                    <td align="left" valign="top" width="59%" headers="d407971e628 d407971e623 ">
                                       <p>The request to initiate a fast-start failover has been posted to the observer.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="41%" id="d407971e636" headers="d407971e620 ">
                                       <p><code class="codeph">ORA-16646: fast-start failover is disabled</code></p>
                                    </td>
                                    <td align="left" valign="top" width="59%" headers="d407971e636 d407971e623 ">
                                       <p>Either a broker configuration does not exist or fast-start failover has not been enabled.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="41%" id="d407971e644" headers="d407971e620 ">
                                       <p><code class="codeph">ORA-16666: unable to initiate fast-start failover on a bystander standby database</code></p>
                                    </td>
                                    <td align="left" valign="top" width="59%" headers="d407971e644 d407971e623 ">
                                       <p><code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> was invoked on a bystander standby database. That is, it was not invoked on the primary or on the fast-start failover target standby database.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="41%" id="d407971e654" headers="d407971e620 ">
                                       <p><code class="codeph">ORA-16817: unsynchronized fast-start failover configuration</code></p>
                                    </td>
                                    <td align="left" valign="top" width="59%" headers="d407971e654 d407971e623 ">
                                       <p><code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> was invoked in a maximum available fast-start failover configuration when the configuration was not synchronized.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="41%" id="d407971e664" headers="d407971e620 ">
                                       <p><code class="codeph">ORA-16819: fast-start failover observer not started</code></p>
                                    </td>
                                    <td align="left" valign="top" width="59%" headers="d407971e664 d407971e623 ">
                                       <p><code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> was invoked but an observer had not yet been started.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="41%" id="d407971e674" headers="d407971e620 ">
                                       <p><code class="codeph">ORA-16820: fast-start failover observer is no longer observing this database</code></p>
                                    </td>
                                    <td align="left" valign="top" width="59%" headers="d407971e674 d407971e623 ">
                                       <p><code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> was invoked but the configuration detects that the observer may not be running.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="41%" id="d407971e684" headers="d407971e620 ">
                                       <p><code class="codeph">ORA-16829: lagging fast-start failover configuration</code></p>
                                    </td>
                                    <td align="left" valign="top" width="59%" headers="d407971e684 d407971e623 ">
                                       <p><code class="codeph">DBMS_DG.INITIATE_FS_FAILOVER</code> was invoked in a maximum performance fast-start failover configuration when the configuration was not in the user-specified redo lag limit.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7E393767-6595-43EB-9FEE-B138B2DEA8ED__GUID-06328762-9F0E-4AA1-9C7F-80BEBA66FB31">Example</p>
                        <p>In this example, the program attempts to initiate a fast-start failover when fast-start failover is disabled. To use this example, connect as user <code class="codeph">SYS</code> with <code class="codeph">SYDDBA</code> privileges.
                        </p><pre class="oac_no_warn" dir="ltr">set serveroutput on

declare
status integer;

begin
status := dbms_dg.initiate_fs_failover(''Failover Requested'');

dbms_output.put_line(''Fast-Start Failover is disabled: Expected status = ORA-16646'');
dbms_output.put_line(''                  Actual Status = ORA-'' || status);

end;
/
exit;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>