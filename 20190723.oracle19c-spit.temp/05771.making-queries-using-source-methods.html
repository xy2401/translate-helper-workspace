<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Making Queries Using Source Methods</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Java API Developer's Guide ">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Java API Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="olap-java-api-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-10T13:53:39-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2000, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96402-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="understanding-source-objects.html" title="Previous" type="text/html">
      <link rel="next" href="using-transaction-provider.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OLAP Java API Developer's Guide">
    <meta name="dcterms.isVersionOf" content="OLAAP">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="understanding-source-objects.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-transaction-provider.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Java API Developer's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Making Queries Using Source Methods</li>
            </ol>
            <a id="GUID-B5D5AF5D-330E-46D3-8BD7-E84B1373E6A7" name="GUID-B5D5AF5D-330E-46D3-8BD7-E84B1373E6A7"></a><a id="OLAAP291"></a>
            
            <h2 id="OLAAP-GUID-B5D5AF5D-330E-46D3-8BD7-E84B1373E6A7" class="sect2"><span class="enumeration_chapter">6 </span> Making Queries Using Source Methods
            </h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d17761e33" class="indexterm-anchor"></a>You create a query by producing a <code class="codeph">Source</code> that specifies the data that you want to retrieve and any operations that you want to perform on that data. To produce the query, you begin with the primary <code class="codeph">Source</code> objects that represent the metadata of the measures and the dimensions and their attributes that you want to query. Typically, you use the methods of the primary <code class="codeph">Source</code> objects to derive a number of other <code class="codeph">Source</code> objects, each of which specifies a part of the query, such as a selection of dimension members or an operation to perform on the data. You then join the <code class="codeph">Source</code> objects that specify the data and the operations that you want. The result is one <code class="codeph">Source</code> that represents the query. You can then retrieve the data by creating a <code class="codeph">Cursor</code> for the <code class="codeph">Source</code>.
               </p>
               <p>This chapter briefly describes the various kinds of <code class="codeph">Source</code> methods, and discusses some of them in greater detail. It also discusses how to make some typical OLAP queries using these methods and provides examples of some of them.
               </p>
               <p>This chapter includes the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="making-queries-using-source-methods.html#GUID-316AAA82-2D0E-4CE0-AC33-C1764674DC72">Describing the Basic Source Methods</a></p>
                  </li>
                  <li>
                     <p><a href="making-queries-using-source-methods.html#GUID-03C361B3-E046-4015-ACEB-AE5EF00E0DB2">Using the Basic Methods</a></p>
                  </li>
                  <li>
                     <p><a href="making-queries-using-source-methods.html#GUID-41F505FD-DF76-4973-9668-B6C77C6CEC65">Using Other Source Methods</a></p>
                  </li>
               </ul>
            </div><a id="OLAAP293"></a><a id="OLAAP292"></a><div class="props_rev_3"><a id="GUID-316AAA82-2D0E-4CE0-AC33-C1764674DC72" name="GUID-316AAA82-2D0E-4CE0-AC33-C1764674DC72"></a><h3 id="OLAAP-GUID-316AAA82-2D0E-4CE0-AC33-C1764674DC72" class="sect3"><span class="enumeration_section">6.1 </span>Describing the Basic Source Methods
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d17761e124" class="indexterm-anchor"></a><a id="d17761e128" class="indexterm-anchor"></a><a id="d17761e132" class="indexterm-anchor"></a>The <code class="codeph">Source</code> class has many methods that return a derived <code class="codeph">Source</code>. The elements of the derived <code class="codeph">Source</code> result from operations on the <span>base</span> <code class="codeph">Source</code>, which is the <code class="codeph">Source</code> whose method returns the derived <code class="codeph">Source</code>. Only a few methods perform the most basic operations of the <code class="codeph">Source</code> class.
                     </p>
                     <p><a id="d17761e161" class="indexterm-anchor"></a>Many other methods of the <code class="codeph">Source</code> class use one or more of the basic methods to perform operations such as selecting elements of the base <code class="codeph">Source</code> by value or by position, or sorting elements. Many of the examples in this chapter and in <a href="understanding-source-objects.html#GUID-871159BB-8ED1-454B-B9FA-62F36683F4B2"> Understanding Source Objects</a>, use some of these methods. Other <code class="codeph">Source</code> methods get objects that have information about the <code class="codeph">Source</code>, such as the <code class="codeph">getID</code>, <code class="codeph">getInputs</code>, and <code class="codeph">getType</code> methods, perform comparisons, such as the <code class="codeph">ge</code> and <code class="codeph">gt</code> methods, or convert the values of the <code class="codeph">Source</code> from one data type to another, such as the <code class="codeph">toDoubleSource</code> method.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-316AAA82-2D0E-4CE0-AC33-C1764674DC72__CHDDACIA">
                     <p class="titleintable">Table 6-1 The Basic Source Methods</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="The Basic Source Methods" summary="This table lists the basic Source methods and provides brief descriptions of them." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d17761e215">Method</th>
                              <th align="left" valign="bottom" width="69%" id="d17761e218">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d17761e223" headers="d17761e215 ">
                                 <p><a id="d17761e225" class="indexterm-anchor"></a><code class="codeph">alias</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d17761e223 d17761e218 ">
                                 <p>Returns a <code class="codeph">Source</code> that has the same elements as the base <code class="codeph">Source</code>, but has the base <code class="codeph">Source</code> as the type.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d17761e244" headers="d17761e215 ">
                                 <p><a id="d17761e246" class="indexterm-anchor"></a><code class="codeph">distinct</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d17761e244 d17761e218 ">
                                 <p>Returns a <code class="codeph">Source</code> that has the same elements as the base <code class="codeph">Source</code>, except that any elements that are duplicated in the base appear only once in the derived <code class="codeph">Source</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d17761e265" headers="d17761e215 ">
                                 <p><a id="d17761e267" class="indexterm-anchor"></a><code class="codeph">join</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d17761e265 d17761e218 ">
                                 <p>Returns a <code class="codeph">Source</code> that has the elements of the base <code class="codeph">Source</code> that are specified by the <code class="codeph">joined</code>, <code class="codeph">comparison</code>, and <code class="codeph">comparisonRule</code> parameters of the method call. If the <code class="codeph">visible</code> parameter is <code class="codeph">true</code>, then the joined <code class="codeph">Source</code> is an output of the resulting <code class="codeph">Source</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d17761e305" headers="d17761e215 ">
                                 <p><a id="d17761e307" class="indexterm-anchor"></a><code class="codeph">position</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d17761e305 d17761e218 ">
                                 <p>Returns a <code class="codeph">Source</code> that has the positions of the elements of the base <code class="codeph">Source</code>, and that has the base <code class="codeph">Source</code> as an input.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d17761e326" headers="d17761e215 ">
                                 <p><a id="d17761e328" class="indexterm-anchor"></a><code class="codeph">recursiveJoin</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d17761e326 d17761e218 ">
                                 <p>Similar to the <code class="codeph">join</code> method, except that this method, in the <code class="codeph">Source</code> that it returns, orders the elements of the <code class="codeph">Source</code> hierarchically by parent-child relationships.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d17761e347" headers="d17761e215 ">
                                 <p><a id="d17761e349" class="indexterm-anchor"></a><code class="codeph">value</code></p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d17761e347 d17761e218 ">
                                 <p>Returns a <code class="codeph">Source</code> that has the same elements as the base <code class="codeph">Source</code>, but that has the base <code class="codeph">Source</code> as an input.
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>The following topics describe the basic <code class="codeph">Source</code> methods and provide some examples of their use.
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="making-queries-using-source-methods.html#GUID-03C361B3-E046-4015-ACEB-AE5EF00E0DB2">Using the Basic Methods</a></p>
                        </li>
                        <li>
                           <p><a href="making-queries-using-source-methods.html#GUID-41F505FD-DF76-4973-9668-B6C77C6CEC65">Using Other Source Methods</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="OLAAP294"></a><div class="props_rev_3"><a id="GUID-03C361B3-E046-4015-ACEB-AE5EF00E0DB2" name="GUID-03C361B3-E046-4015-ACEB-AE5EF00E0DB2"></a><h3 id="OLAAP-GUID-03C361B3-E046-4015-ACEB-AE5EF00E0DB2" class="sect3"><span class="enumeration_section">6.2 </span>Using the Basic Methods
               </h3>
               <div>
                  <p><a id="d17761e419" class="indexterm-anchor"></a>The following topics provide examples of using some of the basic methods.
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-2599E060-9C27-4DE2-9673-B89A7CFDBBD1">Using the alias Method</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-33605F2C-B683-49FF-A5C9-BFDB6AD31167">Using the distinct Method</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-83221D91-C9C5-4BA7-A91F-A8F33C6A8F85">Using the join Method</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-50FB0A20-3E17-465D-BAFE-EB082C20FC68">Using the position Method</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-31E4FFCF-E724-4C10-A4EC-1DFC5B70E10A">Using the recursiveJoin Method</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-77BC1C96-64D7-4CD4-8D3A-BFC44C69EF2B">Using the value Method</a></p>
                     </li>
                  </ul>
               </div><a id="OLAAP296"></a><a id="OLAAP295"></a><div class="props_rev_3"><a id="GUID-2599E060-9C27-4DE2-9673-B89A7CFDBBD1" name="GUID-2599E060-9C27-4DE2-9673-B89A7CFDBBD1"></a><h4 id="OLAAP-GUID-2599E060-9C27-4DE2-9673-B89A7CFDBBD1" class="sect4"><span class="enumeration_section">6.2.1 </span>Using the alias Method
                  </h4>
                  <div>
                     <div class="section">
                        <p>You use the <code class="codeph">alias</code> method to control the matching of a <code class="codeph">Source</code> to an input. For example, if you want to find out if the measure values specified by a member of a dimension of the measure are greater than the measure values specified by the other members of the same dimension, then you need to match the inputs of the measure twice in the same join operation. To do so, you can derive two <code class="codeph">Source</code> objects that are aliases for the same dimension, make them inputs of two <code class="codeph">Source</code> objects that are derived from the measure, join each derived measure <code class="codeph">Source</code> to the associated aliased dimension <code class="codeph">Source</code> objects, and then compare the results.
                        </p>
                        <p><a href="making-queries-using-source-methods.html#GUID-2599E060-9C27-4DE2-9673-B89A7CFDBBD1__I1014430">Example 6-1</a> performs such an operation. It produces a <code class="codeph">Source</code> that specifies whether the number of units sold for each value of the CHANNEL_AWJ dimension is greater than the number of units sold for the other values of the CHANNEL_AWJ dimension. 
                        </p>
                        <p>The example joins <code class="codeph">units</code>, which is the <code class="codeph">Source</code> for a measure, to <code class="codeph">Source</code> objects that are selections of single values of three of the dimensions of the measure to produce <code class="codeph">unitsSel</code>. The <code class="codeph">unitsSel</code> <code class="codeph">Source</code> specifies the <code class="codeph">units</code> elements for the dimension values that are specified by the <code class="codeph">timeSel</code>, <code class="codeph">custSel</code>, and <code class="codeph">prodSel</code> objects, which are outputs of <code class="codeph">unitsSel</code>. The <code class="codeph">unitsSel</code> <code class="codeph">Source</code> has the <code class="codeph">Source</code> for CHANNEL_AWJ dimension as an input.
                        </p>
                        <p>The <code class="codeph">timeSel</code>, <code class="codeph">custSel</code>, and <code class="codeph">prodSel</code> <code class="codeph">Source</code> objects specify single values from hierarchies of the TIME_AWJ, CUSTOMER_AWJ, and PRODUCT_AWJ dimensions, respectively. The <code class="codeph">timeSel</code> value is <code class="codeph">CALENDAR_YEAR::MONTH::2001.01</code>, which identifies the month January, 2001, the <code class="codeph">custSel</code> value is <code class="codeph">SHIPMENTS::SHIP_TO::BUSN WRLD SJ</code>, which identifies the Business World San Jose customer, and the <code class="codeph">prodSel</code> value is <code class="codeph">PRODUCT_PRIMARY::ITEM::ENVY ABM</code>, which identifies the Envoy Ambassador portable PC.
                        </p>
                        <p><a id="d17761e599" class="indexterm-anchor"></a>The example next creates two aliases, <code class="codeph">chanAlias1</code> and <code class="codeph">chanAlias2</code>, for <code class="codeph">chanHier</code>, which is the <code class="codeph">Source</code> for the CHANNEL_PRIMARY hierarchy of the CHANNEL_AWJ dimension. It then produces <code class="codeph">unitsSel1</code> by joining <code class="codeph">unitsSel</code> with the <code class="codeph">Source</code> returned by <code class="codeph">chanAlias1.value()</code>. The <code class="codeph">unitsSel1</code> <code class="codeph">Source</code> has the elements and outputs of <code class="codeph">unitsSel</code> and it has <code class="codeph">chanAlias1</code> as an input. Similarly, the example produces <code class="codeph">unitsSel2</code>, which has <code class="codeph">chanAlias2</code> as an input.
                        </p>
                        <p><a id="d17761e649" class="indexterm-anchor"></a>The example uses the <code class="codeph">gt</code> method of <code class="codeph">unitsSel1</code>, which determines whether the values of <code class="codeph">unitsSel1</code> are greater than the values of <code class="codeph">unitsSel2</code>. The final join operations match <code class="codeph">chanAlias1</code> with the input of <code class="codeph">unitsSel1</code> and match <code class="codeph">chanAlias2</code> with the input of <code class="codeph">unitsSel2</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-2599E060-9C27-4DE2-9673-B89A7CFDBBD1__I1014430">
                        <p class="titleinexample">Example 6-1 Controlling Input-with-Source Matching with the alias Method</p><pre class="oac_no_warn" dir="ltr">Source unitsSel = units.join(timeSel).join(custSel).join(prodSel);
Source chanAlias1 = chanHier.alias();
Source chanAlias2 = chanHier.alias();
NumberSource unitsSel1 = (NumberSource)
                          unitsSel.join(chanAlias1.value());
NumberSource unitsSel2 = (NumberSource)
                          unitsSel.join(chanAlias2.value());
Source result = unitsSel1.gt(unitsSel2)
                         .join(chanAlias1)   // Output 2, column
                         .join(chanAlias2);  // Output 1, row;
</pre><p><a id="d17761e685" class="indexterm-anchor"></a>The <code class="codeph">result</code> <code class="codeph">Source</code> specifies the query, "Are the units sold values of <code class="codeph">unitsSel1</code> for the channel values of <code class="codeph">chanAlias1</code> greater than the units sold values of <code class="codeph">unitsSel2</code> for the channel values of <code class="codeph">chanAlias2</code>?" Because <code class="codeph">result</code> is produced by the joining of <code class="codeph">chanAlias2</code> to the <code class="codeph">Source</code> returned by <code class="codeph">unitsSel1.gt(unitsSel2).join(chanAlias1)</code>, <code class="codeph">chanAlias2</code> is the first output of <code class="codeph">result</code>, and <code class="codeph">chanAlias1</code> is the second output of <code class="codeph">result</code>.
                        </p>
                        <p>A <code class="codeph">Cursor</code> for the <code class="codeph">result</code> <code class="codeph">Source</code> has as values the <code class="codeph">boolean</code> values that answer the query. The values of the first output of the <code class="codeph">Cursor</code> are the channel values specified by <code class="codeph">chanAlias2</code> and the values of the second output are the channel values specified by <code class="codeph">chanAlias1</code>.
                        </p>
                        <p><a id="d17761e761" class="indexterm-anchor"></a>The following is a display of the values of the <code class="codeph">Cursor</code> formatted as a crosstab with headings added. The column edge values are the values from <code class="codeph">chanAlias1</code>, and the row edge values are the values from <code class="codeph">chanAlias2</code>. The values of the crosstab cells are the <code class="codeph">boolean</code> values that indicate whether the units sold value for the column channel value is greater than the units sold value for the row channel value. For example, the crosstab values in the first column indicate that the units sold value for the column channel value <code class="codeph">Total Channel</code> is not greater than the units sold value for the row <code class="codeph">Total Channel</code> value but it is greater than the units sold value for the <code class="codeph">Direct Sales</code>, <code class="codeph">Catalog</code>, and <code class="codeph">Internet</code> row values.
                        </p><pre class="oac_no_warn" dir="ltr">               ----------------- chanAlias1 ----------------
chanAlias2     TotalChannel  Catalog  Direct Sales    Internet
------------   ------------  -------  ------------  --------
TotalChannel      false       false      false       false
Catalog           true        false      false       false
Direct Sales      true        true       false       false
Internet          true        true       true        false</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP298"></a><a id="OLAAP297"></a><div class="props_rev_3"><a id="GUID-33605F2C-B683-49FF-A5C9-BFDB6AD31167" name="GUID-33605F2C-B683-49FF-A5C9-BFDB6AD31167"></a><h4 id="OLAAP-GUID-33605F2C-B683-49FF-A5C9-BFDB6AD31167" class="sect4"><span class="enumeration_section">6.2.2 </span>Using the distinct Method
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d17761e834" class="indexterm-anchor"></a>You use the <code class="codeph">distinct</code> method to produce a <code class="codeph">Source</code> that does not have any duplicated values, as shown in <a href="making-queries-using-source-methods.html#GUID-33605F2C-B683-49FF-A5C9-BFDB6AD31167__CBBECHCG">Example 6-2</a>. The example joins two selections of dimension members. Some dimension members exist in both selections. The example uses the <code class="codeph">distinct</code> method to produce a <code class="codeph">Source</code> that contains only unique dimension members, with no duplicated values.
                        </p>
                        <p><a id="d17761e854" class="indexterm-anchor"></a><a id="d17761e858" class="indexterm-anchor"></a>The example gets the <code class="codeph">MdmStandardDimension</code> object for the CUSTOMER_AWJ dimension and gets the <code class="codeph">MdmLevelHierarchy</code> object for the MARKETS hierarchy of that dimension. It gets the <code class="codeph">StringSource</code> object, <code class="codeph">mktHier</code>, for the <code class="codeph">MdmLevelHierarchy</code>. It then uses the <code class="codeph">selectValues</code> method of <code class="codeph">mktHier</code> to produce two selections of members of the hierarchy, <code class="codeph">customersToSelect</code> and <code class="codeph">moreCustomersToSelect</code>. Two of the members of <code class="codeph">customersToSelect</code> are also present in <code class="codeph">moreCustomersToSelect</code>.
                        </p>
                        <p><a id="d17761e899" class="indexterm-anchor"></a>The example uses the <code class="codeph">appendValues</code> method to combine the elements of <code class="codeph">customersToSelect</code> and <code class="codeph">moreCustomersToSelect</code> in the <code class="codeph">combinedCustomers</code> <code class="codeph">Source</code>. Finally, the example uses the <code class="codeph">distinct</code> method of <code class="codeph">combinedCustomers</code>, which returns a <code class="codeph">Source</code>, <code class="codeph">distinctCombinedCustomers</code>, that has only the distinct members of the hierarchy.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-33605F2C-B683-49FF-A5C9-BFDB6AD31167__CBBECHCG">
                        <p class="titleinexample">Example 6-2 Using the distinct Method</p><pre class="oac_no_warn" dir="ltr">MdmStandardDimension mdmCustDim =
  mdmDBSchema.findOrCreateStandardDimension("CUSTOMER_AWJ");
MdmLevelHierarchy mdmMktHier =
  mdmCustDim.findOrCreateLevelHierarchy("MARKETS");
StringSource mktHier = (StringSource)mdmMktHier.getSource();

Source customersToSelect = 
  mktHier.selectValues(new String[] {"MARKETS::SHIP_TO::KOSH ENT BOS",
                                     "MARKETS::SHIP_TO::KOSH ENT TOK",
                                     "MARKETS::SHIP_TO::KOSH ENT WAN"});
Source moreCustomersToSelect = 
  mktHier.selectValues(new String[] {"MARKETS::SHIP_TO::KOSH ENT BOS",
                                     "MARKETS::SHIP_TO::KOSH ENT TOK",
                                     "MARKETS::SHIP_TO::BUSN WRLD NY",
                                     "MARKETS::SHIP_TO::BUSN WRLD SJ"});
Source combinedCustomers =
  customersToSelect.appendValues(moreCustomersToSelect);

Source distinctCombinedCustomers = combinedCustomers.distinct();
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">combinedCustomers</code> <code class="codeph">Source</code> has the following values:
                        </p><pre class="oac_no_warn" dir="ltr">MARKETS::SHIP_TO::KOSH ENT BOS
MARKETS::SHIP_TO::KOSH ENT TOK
MARKETS::SHIP_TO::KOSH ENT WAN
MARKETS::SHIP_TO::KOSH ENT BOS
MARKETS::SHIP_TO::KOSH ENT TOK
MARKETS::SHIP_TO::BUSN WRLD NY
MARKETS::SHIP_TO::BUSN WRLD SJ
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">distinctCombinedCustomers</code> <code class="codeph">Source</code> has the following values:
                        </p><pre class="oac_no_warn" dir="ltr">MARKETS::SHIP_TO::KOSH ENT BOS
MARKETS::SHIP_TO::KOSH ENT TOK
MARKETS::SHIP_TO::KOSH ENT WAN
MARKETS::SHIP_TO::BUSN WRLD NY
MARKETS::SHIP_TO::BUSN WRLD SJ</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP300"></a><a id="OLAAP299"></a><div class="props_rev_3"><a id="GUID-83221D91-C9C5-4BA7-A91F-A8F33C6A8F85" name="GUID-83221D91-C9C5-4BA7-A91F-A8F33C6A8F85"></a><h4 id="OLAAP-GUID-83221D91-C9C5-4BA7-A91F-A8F33C6A8F85" class="sect4"><span class="enumeration_section">6.2.3 </span>Using the join Method
                  </h4>
                  <div>
                     <div class="section">
                        <p>As described in <a href="understanding-source-objects.html#GUID-871159BB-8ED1-454B-B9FA-62F36683F4B2"> Understanding Source Objects</a>, you use the <code class="codeph">join</code> method to produce a <code class="codeph">Source</code> that has the elements of the base <code class="codeph">Source</code> that are determined by the <code class="codeph">joined</code>, <code class="codeph">comparison</code>, and <code class="codeph">comparisonRule</code> parameters of the method. The <code class="codeph">visible</code> parameter determines whether the <code class="codeph">joined</code> parameter <code class="codeph">Source</code> is an output of the <code class="codeph">Source</code> produced by the join operation. You also use the <code class="codeph">join</code> method to match a <code class="codeph">Source</code> with an input of the base or <code class="codeph">joined</code> parameter <code class="codeph">Source</code>.
                        </p>
                        <p><a id="d17761e1052" class="indexterm-anchor"></a>Most of the examples in this chapter use one or more signatures of the <code class="codeph">join</code> method, as do many of the examples in <a href="understanding-source-objects.html#GUID-871159BB-8ED1-454B-B9FA-62F36683F4B2"> Understanding Source Objects</a>. <a href="making-queries-using-source-methods.html#GUID-83221D91-C9C5-4BA7-A91F-A8F33C6A8F85__CBBEBEJH">Example 6-3</a> uses the full <code class="codeph">join</code> signature and the simplest <code class="codeph">join</code> signature. In the example, the full <code class="codeph">join</code> signature demonstrates the use of <code class="codeph">COMPARISON_RULE_DESCENDING</code> as the <code class="codeph">comparisonRule</code> parameter.
                        </p>
                        <p><a href="making-queries-using-source-methods.html#GUID-83221D91-C9C5-4BA7-A91F-A8F33C6A8F85__CBBEBEJH">Example 6-3</a> uses the following <code class="codeph">Source</code> objects.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">prodSelWithShortDescr</code>, which is the <code class="codeph">Source</code> produced by joining the short description attribute of the PRODUCT_AWJ dimension with the <code class="codeph">Source</code> for the FAMILY hierarchy level of the PRODUCT_PRIMARY hierarchy of the dimension.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">salesMeasure</code>, which is the <code class="codeph">Source</code> for the SALES measure of the UNITS_CUBE_AWJ cube.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">timeSelWithShortDescr</code>, which is the <code class="codeph">Source</code> produced by joining the short description attribute of the TIME_AWJ dimension with the <code class="codeph">Source</code> for a selected member of the CALENDAR_YEAR hierarchy of the dimension.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">custSelWithShortDescr</code>, which is the <code class="codeph">Source</code> produced by joining the short description attribute of the CUSTOMER_AWJ dimension with the <code class="codeph">Source</code> for a selected member of the SHIPMENTS hierarchy of the dimension.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">chanSelWithShortDescr</code>, which is the <code class="codeph">Source</code> produced by joining the short description attribute of the CHANNEL_AWJ dimension with the <code class="codeph">Source</code> for a selected member of the CHANNEL_PRIMARY hierarchy of the dimension.
                              </p>
                           </li>
                        </ul>
                        <p>The first join operation uses the full signature of the <code class="codeph">join</code> method with <code class="codeph">prodSelWithShortDescr</code> as the base <code class="codeph">Source</code>, <code class="codeph">salesMeasure</code> as the joined <code class="codeph">Source</code>, the <code class="codeph">Source</code> for the Number data type as the comparison <code class="codeph">Source</code>, and <code class="codeph">COMPARISON_RULE_DESCENDING</code> as the comparison rule. The <code class="codeph">Source</code> returned by that join operation has the product family level members and related product short description values as base values and an output that has the sales amounts in descending order.
                        </p>
                        <p>The next three join operations join the single member selections of the other three dimensions of the measure. The <code class="codeph">result</code> <code class="codeph">Source</code> specifies the product family level members in descending order of sales amounts for the month of May, 2001 for all customers and all channels. 
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-83221D91-C9C5-4BA7-A91F-A8F33C6A8F85__CBBEBEJH">
                        <p class="titleinexample">Example 6-3 Using COMPARISON_RULE_DESCENDING</p><pre class="oac_no_warn" dir="ltr">Source result = prodSelWithShortDescr.join(salesMeasure,
<a id="d17761e1185" class="indexterm-anchor"></a>                                           salesMeasure.getDataType(),
                                           Source.COMPARISON_RULE_DESCENDING,
                                           true)
                                     .join(timeSelWithShortDescr)
                                     .join(custSelWithShortDescr)
                                     .join(chanSelWithShortDescr);
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">result</code> <code class="codeph">Source</code> has the following values, displayed as a table. The table includes only the short value descriptions of the hierarchy members and the sales amount values, and has headings and formatting added.
                        </p><pre class="oac_no_warn" dir="ltr">Total Channel
Total Customer
MAY-01

Total Sales Amounts   Product Family
-------------------   -----------------
   3,580,239.72       Desktop PCs
   2,508,560.92       Portable PCs
     891,807.30       CD/DVD
     632,376.84       Modems/Fax
     444,444.38       Memory
     312,389.39       Accessories
     291,510.88       Monitors
     222,995.92       Operating Systems
      44,479.32       Documentation</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP302"></a><a id="OLAAP301"></a><div class="props_rev_3"><a id="GUID-50FB0A20-3E17-465D-BAFE-EB082C20FC68" name="GUID-50FB0A20-3E17-465D-BAFE-EB082C20FC68"></a><h4 id="OLAAP-GUID-50FB0A20-3E17-465D-BAFE-EB082C20FC68" class="sect4"><span class="enumeration_section">6.2.4 </span>Using the position Method
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d17761e1241" class="indexterm-anchor"></a>You use the <code class="codeph">position</code> method to produce a <code class="codeph">Source</code> that has the positions of the elements of the base and has the base as an input. <a href="making-queries-using-source-methods.html#GUID-50FB0A20-3E17-465D-BAFE-EB082C20FC68__CBBHFCIH">Example 6-4</a> uses the <code class="codeph">position</code> method in producing a <code class="codeph">Source</code> that specifies the selection of the first and last members of the levels of a hierarchy of the TIME_AWJ dimension.
                        </p>
                        <p><a id="d17761e1261" class="indexterm-anchor"></a><a id="d17761e1265" class="indexterm-anchor"></a>In the example, <code class="codeph">mdmTimeDim</code> is the <code class="codeph">MdmPrimaryDimension</code> for the TIME_AWJ dimension. The example gets the level attribute and the CALENDAR_YEAR hierarchy of the dimension. It then gets <code class="codeph">Source</code> objects for the attribute and the hierarchy.
                        </p>
                        <p><a id="d17761e1280" class="indexterm-anchor"></a>Next, the example creates an array of <code class="codeph">Source</code> objects and gets a <code class="codeph">List</code> of the <code class="codeph">MdmHierarchyLevel</code> components of the hierarchy. It gets the <code class="codeph">Source</code> object for each level and adds it to the array, and then creates a list <code class="codeph">Source</code> that has the <code class="codeph">Source</code> objects for the levels as element values.
                        </p>
                        <p><a id="d17761e1305" class="indexterm-anchor"></a>The example then produces <code class="codeph">levelMembers</code>, which is a <code class="codeph">Source</code> that specifies the members of the levels of the hierarchy. Because the <code class="codeph">comparison</code> parameter of the join operation is the <code class="codeph">Source</code> produced by <code class="codeph">levelList.value()</code>, <code class="codeph">levelMembers</code> has <code class="codeph">levelList</code> as an input. Therefore, <code class="codeph">levelMembers</code> is a <code class="codeph">Source</code> that returns the members of each level, by level, when the input is matched in a join operation.
                        </p>
                        <p><a id="d17761e1339" class="indexterm-anchor"></a><a id="d17761e1343" class="indexterm-anchor"></a>The <code class="codeph">range</code> <code class="codeph">Source</code> specifies a range of elements from the second element to the next to last element of a <code class="codeph">Source</code>.
                        </p>
                        <p><a id="d17761e1358" class="indexterm-anchor"></a>The next join operation produces the <code class="codeph">firstAndLast</code> <code class="codeph">Source</code>. The base of the operation is <code class="codeph">levelMembers</code>. The <code class="codeph">joined</code> parameter is the <code class="codeph">Source</code> that results from the <code class="codeph">levelMembers.position()</code> method. The <code class="codeph">comparison</code> parameter is the <code class="codeph">range</code> <code class="codeph">Source</code> and the comparison rule is <code class="codeph">COMPARISON_RULE_REMOVE</code>. The value of the <code class="codeph">visible</code> parameter is <code class="codeph">true</code>. The <code class="codeph">firstAndLast</code> <code class="codeph">Source</code> therefore specifies only the first and last members of the levels because it removes all of the other members of the levels from the selection. The <code class="codeph">firstAndLast</code> <code class="codeph">Source</code> still has <code class="codeph">levelList</code> as an input.
                        </p>
                        <p>The final join operation matches the input of <code class="codeph">firstAndLast</code> with <code class="codeph">levelList</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-50FB0A20-3E17-465D-BAFE-EB082C20FC68__CBBHFCIH">
                        <p class="titleinexample">Example 6-4 Selecting the First and Last Time Elements</p><pre class="oac_no_warn" dir="ltr">MdmAttribute mdmTimeLevelAttr = mdmTimeDim.getLevelAttribute();
MdmLevelHierarchy mdmCalHier =
  mdmTimeDim.findOrCreateLevelHierarchy("CALENDAR_YEAR");

Source levelRel = mdmTimeLevelAttr.getSource();
StringSource calHier = (StringSource) mdmCalHier.getSource();

Source[] levelSources = new Source[3];
List levels = mdmCalHier.getHierarchyLevels();
for (int i = 0; i &lt; levelSources.length; i++)
{
  levelSources[i] = ((MdmHierarchyLevel) levels.get(i)).getSource();
}
Source levelList = dp.createListSource(levelSources);
Source levelMembers =  calHier.join(levelRel, levelList.value());
Source range = dp.createRangeSource(2, levelMembers.count().minus(1)); 
Source firstAndLast = levelMembers.join(levelMembers.position(),
                                        range,
                                        Source.COMPARISON_RULE_REMOVE,
                                        true);
 
Source result = firstAndLast.join(levelList);
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">result</code> <code class="codeph">Source</code> has the following values, displayed as a table with column headings and formatting added. The left column names the level, the middle column is the position of the member in the level, and the right column is the local value of the member. The TOTAL_TIME level has only one member.
                        </p><pre class="oac_no_warn" dir="ltr">Level       Member Position in Level  Member Value
----------  ------------------------  ------------
TOTAL_TIME               1              TOTAL
YEAR                     1              CY1998
YEAR                    10              CY2007
QUARTER                  1              CY1998.Q1
QUARTER                 40              CY2007.Q4
MONTH                    1              1998.01
MONTH                  120              2007.12</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP304"></a><a id="OLAAP303"></a><div class="props_rev_3"><a id="GUID-31E4FFCF-E724-4C10-A4EC-1DFC5B70E10A" name="GUID-31E4FFCF-E724-4C10-A4EC-1DFC5B70E10A"></a><h4 id="OLAAP-GUID-31E4FFCF-E724-4C10-A4EC-1DFC5B70E10A" class="sect4"><span class="enumeration_section">6.2.5 </span>Using the recursiveJoin Method
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d17761e1480" class="indexterm-anchor"></a>You use the <code class="codeph">recursiveJoin</code> method to produce a <code class="codeph">Source</code> that has elements that are ordered hierarchically. You use the <code class="codeph">recursiveJoin</code> method only with the <code class="codeph">Source</code> for an <code class="codeph">MdmHierarchy</code> or with a subtype of such a <code class="codeph">Source</code>. The method produces a <code class="codeph">Source</code> whose elements are ordered hierarchically by the parents and their children in the hierarchy.
                        </p>
                        <p>Like the <code class="codeph">join</code> method, you use the <code class="codeph">recursiveJoin</code> method to produce a <code class="codeph">Source</code> that has the elements of the base <code class="codeph">Source</code> that are determined by the <code class="codeph">joined</code>, <code class="codeph">comparison</code>, and <code class="codeph">comparisonRule</code> parameters of the method. The <code class="codeph">visible</code> parameter determines whether the joined <code class="codeph">Source</code> is an output of the <code class="codeph">Source</code> produced by the recursive join operation.
                        </p>
                        <p>The full <code class="codeph">recursiveJoin</code> method has other parameters that specify the parent attribute of the hierarchy, whether the result should have the parents before or after their children, and how to order the elements of the result if the result includes children but not the parent. The <code class="codeph">recursiveJoin</code> method has several signatures that are shortcuts for the full signature.
                        </p>
                        <p><a href="making-queries-using-source-methods.html#GUID-31E4FFCF-E724-4C10-A4EC-1DFC5B70E10A__CBBDDAHE">Example 6-5</a> uses a <code class="codeph">recursiveJoin</code> method that lists the parents first, restricts the parents to the base, and does not add the joined <code class="codeph">Source</code> as an output. The example first sorts the members of the PRODUCT_PRIMARY hierarchy of the PRODUCT_AWJ dimension by hierarchical levels and then by the value of the package attribute of each member.
                        </p>
                        <p><a id="d17761e1558" class="indexterm-anchor"></a>In the first <code class="codeph">recursiveJoin</code> method, the <code class="codeph">COMPARISON_RULE_ASCENDING</code> parameter specifies that the members of the <code class="codeph">prodHier</code> hierarchy be in ascending alphabetical order within each level. The <code class="codeph">prodParentAttr</code> object is the <code class="codeph">Source</code> for the parent attribute of the hierarchy.
                        </p>
                        <p>The <code class="codeph">prodPkgAttr</code> object in the second <code class="codeph">recursiveJoin</code> method is the <code class="codeph">Source</code> for the package attribute of the dimension. Only the members of the ITEM level have a related package attribute value. Because the members in the aggregate levels TOTAL_PRODUCT, CLASS, and FAMILY, do not have a related package, the package attribute value for members in those levels is <code class="codeph">null</code>, which appears as <code class="codeph">NA</code> in the results. Some of the ITEM level members do not have a related package value, so their values are <code class="codeph">NA</code>, also.
                        </p>
                        <p><a id="d17761e1600" class="indexterm-anchor"></a>The second <code class="codeph">recursiveJoin</code> method joins the package attribute values to their related hierarchy members and sorts the members hierarchically by level, and then sorts them in ascending alphabetical order in the level by the package attribute value. The <code class="codeph">COMPARISON_RULE_ASCENDING_NULLS_FIRST</code> parameter specifies that members that have a <code class="codeph">null</code> value appear before the other members in the same level. The example then joins the result of the method, <code class="codeph">sortedHierAscending</code>, to the package attribute to produce a <code class="codeph">Source</code> that has the package attribute values as element values and <code class="codeph">sortedHierAscending</code> as an output.
                        </p>
                        <p><a id="d17761e1625" class="indexterm-anchor"></a>The third <code class="codeph">recursiveJoin</code> method is the same as the second, except that the <code class="codeph">COMPARISON_RULE_DESCENDING_NULLS_FIRST</code> parameter sorts the hierarchy members in descending alphabetical order in the level by package attribute value.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-31E4FFCF-E724-4C10-A4EC-1DFC5B70E10A__CBBDDAHE">
                        <p class="titleinexample">Example 6-5 Sorting Products Hierarchically by Attribute</p><pre class="oac_no_warn" dir="ltr">Source result1 = prodHier.recursiveJoin(prodDim.value(),
                                        prodHier.getDataType(),
                                        prodParentAttr,
                                        Source.COMPARISON_RULE_ASCENDING);

Source sortedHierAscending = 
  prodHier.recursiveJoin(prodPkgAttr,
                         prodPkgAttr.getDataType(),
                         prodParentAttr,
                         Source.COMPARISON_RULE_ASCENDING_NULLS_FIRST);
Source result2 = prodPkgAttr.join(sortedHierAscending);

Source sortedHierDescending = 
  prodHier.recursiveJoin(prodPkgAttr,
<a id="d17761e1641" class="indexterm-anchor"></a>                         prodPkgAttr.getDataType(),
                         prodParentAttr,
                         Source.COMPARISON_RULE_DESCENDING_NULLS_FIRST);
Source result3 = prodPkgAttr.join(sortedHierDescending);
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">result1</code> <code class="codeph">Source</code> has the following values, displayed with a heading added. The list contains only the first seventeen values of the <code class="codeph">Cursor</code>.
                        </p><pre class="oac_no_warn" dir="ltr">Product Primary Hierarchy Value
-------------------------------------
PRODUCT_PRIMARY::TOTAL_PRODUCT::TOTAL
PRODUCT_PRIMARY::CLASS::HRD
PRODUCT_PRIMARY::FAMILY::DISK
PRODUCT_PRIMARY::ITEM::EXT CD ROM
PRODUCT_PRIMARY::ITEM::EXT DVD
PRODUCT_PRIMARY::ITEM::INT 8X DVD
PRODUCT_PRIMARY::ITEM::INT CD ROM
PRODUCT_PRIMARY::ITEM::INT CD USB
PRODUCT_PRIMARY::ITEM::INT RW DVD
PRODUCT_PRIMARY::FAMILY::DTPC
PRODUCT_PRIMARY::ITEM::SENT FIN
PRODUCT_PRIMARY::ITEM::SENT MM
PRODUCT_PRIMARY::ITEM::SENT STD
PRODUCT_PRIMARY::FAMILY::LTPC
PRODUCT_PRIMARY::ITEM::ENVY ABM
PRODUCT_PRIMARY::ITEM::ENVY EXE
PRODUCT_PRIMARY::ITEM::ENVY STD
...
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">result2</code> <code class="codeph">Source</code> has the following values, displayed as a table with headings added. The table contains only the first seventeen values of the <code class="codeph">Cursor</code>. The left column has the member values of the hierarchy and the right column has the package attribute value for the member.
                        </p>
                        <p>The ITEM level members that have a <code class="codeph">null</code> value appear first, and then the other level members appear in ascending order of package value. Since the data type of the package attribute is String, the package values are in ascending alphabetical order.
                        </p><pre class="oac_no_warn" dir="ltr">Product Primary Hierarchy Value        Package Attribute Value
-------------------------------------  -----------------------
PRODUCT_PRIMARY::TOTAL_PRODUCT::TOTAL     NA
PRODUCT_PRIMARY::CLASS::HRD               NA
PRODUCT_PRIMARY::FAMILY::DISK             NA
PRODUCT_PRIMARY::ITEM::EXT CD ROM         NA
PRODUCT_PRIMARY::ITEM::INT 8X DVD         NA
PRODUCT_PRIMARY::ITEM::INT CD USB         NA
PRODUCT_PRIMARY::ITEM::EXT DVD            Executive
PRODUCT_PRIMARY::ITEM::INT CD ROM         Laptop Value Pack
PRODUCT_PRIMARY::ITEM::INT RW DVD         Multimedia
PRODUCT_PRIMARY::FAMILY::DTPC             NA
PRODUCT_PRIMARY::ITEM::SENT FIN           NA
PRODUCT_PRIMARY::ITEM::SENT STD           NA
PRODUCT_PRIMARY::ITEM::SENT MM            Multimedia
PRODUCT_PRIMARY::FAMILY::LTPC             NA
RODUCT_PRIMARY::ITEM::ENVY ABM            NA
PRODUCT_PRIMARY::ITEM::ENVY EXE           Executive
PRODUCT_PRIMARY::ITEM::ENVY STD           Laptop Value Pack
...
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">result3</code> <code class="codeph">Source</code> has the following values, displayed as a table with headings added. This time the members are in descending order, alphabetically by package attribute value.
                        </p><pre class="oac_no_warn" dir="ltr">Product Primary Hierarchy Value        Package Attribute Value
-------------------------------------  -----------------------
PRODUCT_PRIMARY::TOTAL_PRODUCT::TOTAL     NA
PRODUCT_PRIMARY::CLASS::HRD               NA
PRODUCT_PRIMARY::FAMILY::DISK             NA
PRODUCT_PRIMARY::ITEM::EXT CD ROM         NA
PRODUCT_PRIMARY::ITEM::INT 8X DVD         NA
PRODUCT_PRIMARY::ITEM::INT CD USB         NA
PRODUCT_PRIMARY::ITEM::INT RW DVD         Multimedia
PRODUCT_PRIMARY::ITEM::INT CD ROM         Laptop Value Pack
PRODUCT_PRIMARY::ITEM::EXT DVD            Executive
PRODUCT_PRIMARY::FAMILY::DTPC             NA
PRODUCT_PRIMARY::ITEM::SENT FIN           NA
PRODUCT_PRIMARY::ITEM::SENT STD           NA
PRODUCT_PRIMARY::ITEM::SENT MM            Multimedia
PRODUCT_PRIMARY::FAMILY::LTPC             NA
PRODUCT_PRIMARY::ITEM::ENVY ABM           NA
PRODUCT_PRIMARY::ITEM::ENVY STD           Laptop Value Pack
PRODUCT_PRIMARY::ITEM::ENVY EXE           Executive
...</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP305"></a><div class="props_rev_3"><a id="GUID-77BC1C96-64D7-4CD4-8D3A-BFC44C69EF2B" name="GUID-77BC1C96-64D7-4CD4-8D3A-BFC44C69EF2B"></a><h4 id="OLAAP-GUID-77BC1C96-64D7-4CD4-8D3A-BFC44C69EF2B" class="sect4"><span class="enumeration_section">6.2.6 </span>Using the value Method
                  </h4>
                  <div>
                     <p><a id="d17761e1732" class="indexterm-anchor"></a>As described in <span class="q">"<a href="understanding-source-objects.html#GUID-F00CC751-9451-4ECE-84AE-0B0ECC724D78">Deriving a Source with an Input</a>"</span>, you use the <code class="codeph">value</code> method to create a <code class="codeph">Source</code> that has itself as an input. That relationship enables you to select a subset of elements of the <code class="codeph">Source</code>. You can also use the value method to reverse a relation.
                     </p>
                     <p>The following topics have examples of these operations.</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="making-queries-using-source-methods.html#GUID-6364436A-CFAE-44DA-89E5-C3216EBB4280">Selecting Elements of a Source</a></p>
                        </li>
                        <li>
                           <p><a href="making-queries-using-source-methods.html#GUID-E40179C1-98E7-4690-A5EF-3D59681168E6">Reversing a Relation</a></p>
                        </li>
                     </ul>
                  </div><a id="OLAAP307"></a><a id="OLAAP306"></a><div class="props_rev_3"><a id="GUID-6364436A-CFAE-44DA-89E5-C3216EBB4280" name="GUID-6364436A-CFAE-44DA-89E5-C3216EBB4280"></a><h5 id="OLAAP-GUID-6364436A-CFAE-44DA-89E5-C3216EBB4280" class="sect5"><span class="enumeration_section">6.2.6.1 </span>Selecting Elements of a Source
                     </h5>
                     <div>
                        <div class="section">
                           <p><a id="d17761e1802" class="indexterm-anchor"></a><a id="d17761e1806" class="indexterm-anchor"></a><a href="understanding-source-objects.html#GUID-D196A026-C589-401A-B312-001702278183__BABBCGED">Example 5-11</a> and <a href="making-queries-using-source-methods.html#GUID-6364436A-CFAE-44DA-89E5-C3216EBB4280__CBBIEBGB">Example 6-6</a> demonstrate the selection of a subset of the elements of a <code class="codeph">Source</code>. In <a href="making-queries-using-source-methods.html#GUID-6364436A-CFAE-44DA-89E5-C3216EBB4280__CBBIEBGB">Example 6-6</a>, <code class="codeph">shipHier</code> is a <code class="codeph">Source</code> for the SHIPMENTS hierarchy of the CUSTOMER_AWJ dimension. The <code class="codeph">selectValues</code> method of <code class="codeph">shipHier</code> produces <code class="codeph">custSel</code>, which is a selection of some of the elements of <code class="codeph">shipHier</code>. The <code class="codeph">selectValues</code> method of <code class="codeph">custSel</code> produces <code class="codeph">custSel2</code>, which is a subset of that selection. 
                           </p>
                           <p>The first <code class="codeph">join</code> method has <code class="codeph">custSel</code> as the base and as the joined <code class="codeph">Source</code>. It has <code class="codeph">custSel2</code> as the comparison <code class="codeph">Source</code>. The elements of the resulting <code class="codeph">Source</code>, <code class="codeph">result1</code>, are the Cartesian product of the base and joined <code class="codeph">Source</code> objects that are specified by the comparison <code class="codeph">Source</code>. The <code class="codeph">result1</code> <code class="codeph">Source</code> has one set of the elements of <code class="codeph">custSel</code> for each element of <code class="codeph">custSel</code> that is in the comparison <code class="codeph">Source</code>. The <code class="codeph">true</code> value of the <code class="codeph">visible</code> parameter causes the joined <code class="codeph">Source</code> to be an output of <code class="codeph">result1</code>.
                           </p>
                           <p>The second <code class="codeph">join</code> method also has <code class="codeph">custSel</code> as the base and <code class="codeph">custSel2</code> as the comparison <code class="codeph">Source</code>, but it has the <code class="codeph">Source</code> returned by the <code class="codeph">custSel.value()</code> method as the joined <code class="codeph">Source</code>. Because <code class="codeph">custSel</code> is an input of the joined <code class="codeph">Source</code>, the base <code class="codeph">Source</code> matches with that input. That input relationship causes the resulting <code class="codeph">Source</code>, <code class="codeph">result2</code>, to have only those elements of <code class="codeph">custSel</code> that are also in the comparison <code class="codeph">Source</code>.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-6364436A-CFAE-44DA-89E5-C3216EBB4280__CBBIEBGB">
                           <p class="titleinexample">Example 6-6 Selecting a Subset of the Elements of a Source</p><pre class="oac_no_warn" dir="ltr">StringSource custSel = shipHier.selectValues(new String[]
                                         {"SHIPMENTS::SHIP_TO::COMP WHSE SIN",
                                          "SHIPMENTS::SHIP_TO::COMP WHSE LON",
                                          "SHIPMENTS::SHIP_TO::COMP WHSE SJ",
                                          "SHIPMENTS::SHIP_TO::COMP WHSE ATL"});

Source custSel2 = custSel.selectValues(new String[]
                                         {"SHIPMENTS::SHIP_TO::COMP WHSE SIN",
                                          "SHIPMENTS::SHIP_TO::COMP WHSE SJ"});
 
Source result1 = custSel.join(custSel, custSel2, true);
 
Source  result2 = custSel.join(custSel.value(), custSel2, true);
</pre><p>A <code class="codeph">Cursor</code> for <code class="codeph">result1</code> has the values shown in the following table. The table has formatting and headings that are not in the <code class="codeph">Cursor</code>. The left column has the values of the elements of the output of the <code class="codeph">Cursor</code>. The right column has the base values of the <code class="codeph">Cursor</code>.
                           </p><pre class="oac_no_warn" dir="ltr">          Output Value                        result1 Value        
---------------------------------   ---------------------------------
SHIPMENTS::SHIP_TO::COMP WHSE SJ    SHIPMENTS::SHIP_TO::COMP WHSE ATL
SHIPMENTS::SHIP_TO::COMP WHSE SJ    SHIPMENTS::SHIP_TO::COMP WHSE SJ
SHIPMENTS::SHIP_TO::COMP WHSE SJ    SHIPMENTS::SHIP_TO::COMP WHSE SIN
SHIPMENTS::SHIP_TO::COMP WHSE SJ    SHIPMENTS::SHIP_TO::COMP WHSE LON
SHIPMENTS::SHIP_TO::COMP WHSE SIN   SHIPMENTS::SHIP_TO::COMP WHSE ATL
SHIPMENTS::SHIP_TO::COMP WHSE SIN   SHIPMENTS::SHIP_TO::COMP WHSE SJ
SHIPMENTS::SHIP_TO::COMP WHSE SIN   SHIPMENTS::SHIP_TO::COMP WHSE SIN
SHIPMENTS::SHIP_TO::COMP WHSE SIN   SHIPMENTS::SHIP_TO::COMP WHSE LON
</pre><p>A <code class="codeph">Cursor</code> for <code class="codeph">result2</code> has the following values, displayed as a table with headings added. The left column has the values of the elements of the output of the <code class="codeph">Cursor</code>. The right column has the base values of the <code class="codeph">Cursor</code>.
                           </p><pre class="oac_no_warn" dir="ltr">          Output Value                        result2 Value        
---------------------------------   ---------------------------------
SHIPMENTS::SHIP_TO::COMP WHSE SJ    SHIPMENTS::SHIP_TO::COMP WHSE SJ
SHIPMENTS::SHIP_TO::COMP WHSE SIN   SHIPMENTS::SHIP_TO::COMP WHSE SIN</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="OLAAP309"></a><a id="OLAAP308"></a><div class="props_rev_3"><a id="GUID-E40179C1-98E7-4690-A5EF-3D59681168E6" name="GUID-E40179C1-98E7-4690-A5EF-3D59681168E6"></a><h5 id="OLAAP-GUID-E40179C1-98E7-4690-A5EF-3D59681168E6" class="sect5"><span class="enumeration_section">6.2.6.2 </span>Reversing a Relation
                     </h5>
                     <div>
                        <div class="section">
                           <p><a id="d17761e2031" class="indexterm-anchor"></a><a id="d17761e2035" class="indexterm-anchor"></a><a id="d17761e2039" class="indexterm-anchor"></a>Another use of the <code class="codeph">value</code> method is to reverse a relation, as shown in <a href="making-queries-using-source-methods.html#GUID-E40179C1-98E7-4690-A5EF-3D59681168E6__CHDEIIIH">Example 6-7</a>. The example reverses the ancestor attribute relation of the CUSTOMER_AWJ dimension to produce a <code class="codeph">Source</code>, <code class="codeph">marketsDescendants</code>, that represents a descendants relation. The <code class="codeph">marketsDescendants</code> <code class="codeph">Source</code> has as an input the <code class="codeph">Source</code> for the MARKETS hierarchy of the dimension. When you join <code class="codeph">marketsDescendants</code> with a <code class="codeph">Source</code> that matches with that input, you get a <code class="codeph">Source</code> that specifies the descendants of the participating members of the hierarchy.
                           </p>
                           <p>Another example of reversing a relation is <a href="making-queries-using-source-methods.html#GUID-53956A82-8350-44A3-A01C-B0D69B83EFFD__CBBGEGFA">Example 6-10</a>. It uses the <code class="codeph">value</code> method in reversing the parent attribute to get the children of a parent.
                           </p>
                           <p><a href="making-queries-using-source-methods.html#GUID-E40179C1-98E7-4690-A5EF-3D59681168E6__CHDEIIIH">Example 6-7</a> first gets the <code class="codeph">MdmStandardDimension</code> object for the CUSTOMER_AWJ dimension and the <code class="codeph">MdmLevelHierarchy</code> object for the MARKETS hierarchy of that dimension. It gets the <code class="codeph">Source</code> for the hierarchy.
                           </p>
                           <p><a id="d17761e2094" class="indexterm-anchor"></a>The example next gets the ancestors attribute of the dimension and the <code class="codeph">Source</code> for it. The ancestors attribute relates each dimension member to the ancestors of that member.
                           </p>
                           <p>To produce a <code class="codeph">Source</code> that represents the descendants of each member of the dimension, the example reverses the ancestor relation by joining the <code class="codeph">Source</code> for the hierarchy, <code class="codeph">mktHier</code>, with the ancestors attribute, <code class="codeph">ancestorsAttr</code>. The join operation uses <code class="codeph">mktHier.value()</code> as the comparison <code class="codeph">Source</code>, so that the <code class="codeph">Source</code> returned by the join operation, <code class="codeph">marketsDescendants</code>, has <code class="codeph">mktHier</code> as an input. The <code class="codeph">marketsDescendants</code> <code class="codeph">Source</code> specifies, for each element of <code class="codeph">ancestorsAttr</code>, the elements of <code class="codeph">mktHier</code> that have the <code class="codeph">ancestorsAttr</code> element as their ancestor. Because it has <code class="codeph">mktHier</code> as an input, the <code class="codeph">marketsDescendants</code> <code class="codeph">Source</code> functions in the same way as an attribute that represents the descendants relationship for the hierarchy. 
                           </p>
                           <p>The example demonstrates this when it joins <code class="codeph">mktHier</code> to <code class="codeph">marketsDescendants</code> in the following line.
                           </p><pre class="oac_no_warn" dir="ltr">Source selValDescendants = marketsDescendants.join(mktHier, selVal);
</pre><p>In the join operation, the joined <code class="codeph">Source</code>, <code class="codeph">mktHier</code>, matches with the input of <code class="codeph">marketsDescendants</code>. The comparison <code class="codeph">Source</code> is <code class="codeph">selVal</code>, which specifies a single member of the hierarchy. The join operation returns <code class="codeph">selValDescendants</code>, which specifies the elements of <code class="codeph">marketsDescendants</code> that are the descendants of the <code class="codeph">selVal</code> member. The result also includes the ancestor member itself. The <code class="codeph">mktHier</code> <code class="codeph">Source</code> is not an output of <code class="codeph">selValDescendants</code> because the signature of the <code class="codeph">join</code> method used derives a <code class="codeph">Source</code> that does not have the joined <code class="codeph">Source</code> as an output.
                           </p>
                           <p><a id="d17761e2214" class="indexterm-anchor"></a>The example next uses the full signature of the <code class="codeph">join</code> method to produce <code class="codeph">selValDescendantsOnly</code>, which contains only the descendants and not the ancestor value. To remove the ancestor value, the example again uses the <code class="codeph">value</code> method, this time to return a <code class="codeph">Source</code> that is the <code class="codeph">joined</code> parameter of the join operation that returns <code class="codeph">selValDescendantsOnly</code>. The comparison <code class="codeph">Source</code> is <code class="codeph">selVal</code>, and the comparison rule is <code class="codeph">COMPARISON_RULE_REMOVE</code>.
                           </p>
                           <p><a id="d17761e2248" class="indexterm-anchor"></a>Finally, the example uses the <code class="codeph">removeValue</code> method to produce <code class="codeph">selValDescendantsOnly2</code>, which is the same as <code class="codeph">selValDescendantsOnly</code>. This simply demonstrates that the <code class="codeph">removeValue</code> method is a shortcut for the join operation that returned <code class="codeph">selValDescendantsOnly</code>.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-E40179C1-98E7-4690-A5EF-3D59681168E6__CHDEIIIH">
                           <p class="titleinexample">Example 6-7 Using the value Method to Reverse a Relation</p><pre class="oac_no_warn" dir="ltr">MdmStandardDimension mdmCustDim =
  mdmDBSchema.findOrCreateStandardDimension("CUSTOMER_AWJ");
MdmLevelHierarchy mdmMktHier =
  mdmCustDim.findOrCreateLevelHierarchy("MARKETS");
StringSource mktHier = (StringSource)mdmMktHier.getSource();
MdmAttribute mdmAncestorsAttr = mdmCustDim.getAncestorsAttribute();
Source ancestorsAttr = mdmAncestorsAttr.getSource();

// Reverse the ancestors relation to get the descendants relation.
Source marketsDescendants = mktHier.join(ancestorsAttr, mktHier.value());

Source selVal = mktHier.selectValue("MARKETS::ACCOUNT::BUSN WRLD");

// Select the descendants of the specified hierarchy member.
StringSource selValDescendants = 
  (StringSource)marketsDescendants.join(mktHier, selVal);

// Remove the ancestor value so that only the descendants remain.
Source selValDescendantsOnly =
  selValDescendants.join(selValDescendants.value(),
                         selVal, 
                         Source.COMPARISON_RULE_REMOVE),
                         false;

// Produce the same result using the removeValue method.
Source selValDescendantsOnly2 = 
  selValDescendants.removeValue("MARKETS::ACCOUNT::BUSN WRLD");
</pre><p>A <code class="codeph">Cursor</code> for <code class="codeph">selValDescendants</code> has the following values.
                           </p><pre class="oac_no_warn" dir="ltr">MARKETS::ACCOUNT::BUSN WRLD
MARKETS::SHIP_TO::BUSN WRLD HAM
MARKETS::SHIP_TO::BUSN WRLD NAN
MARKETS::SHIP_TO::BUSN WRLD NY
MARKETS::SHIP_TO::BUSN WRLD SJ
</pre><p>A <code class="codeph">Cursor</code> for <code class="codeph">selValDescendantsOnly</code> has the following values.
                           </p><pre class="oac_no_warn" dir="ltr">MARKETS::SHIP_TO::BUSN WRLD HAM
MARKETS::SHIP_TO::BUSN WRLD NAN
MARKETS::SHIP_TO::BUSN WRLD NY
MARKETS::SHIP_TO::BUSN WRLD SJ
</pre><p>A <code class="codeph">Cursor</code> for <code class="codeph">selValDescendantsOnly2</code> has the following values.
                           </p><pre class="oac_no_warn" dir="ltr">MARKETS::SHIP_TO::BUSN WRLD HAM
MARKETS::SHIP_TO::BUSN WRLD NAN
MARKETS::SHIP_TO::BUSN WRLD NY
MARKETS::SHIP_TO::BUSN WRLD SJ
</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="OLAAP310"></a><div class="props_rev_3"><a id="GUID-41F505FD-DF76-4973-9668-B6C77C6CEC65" name="GUID-41F505FD-DF76-4973-9668-B6C77C6CEC65"></a><h3 id="OLAAP-GUID-41F505FD-DF76-4973-9668-B6C77C6CEC65" class="sect3"><span class="enumeration_section">6.3 </span>Using Other Source Methods
               </h3>
               <div>
                  <p>Along with the methods that are various signatures of the basic methods, the <code class="codeph">Source</code> class has many other methods that use combinations of the basic methods. Some methods perform selections based on a single position, such as the <code class="codeph">at</code> and <code class="codeph">offset</code> methods. Others operate on a range of positions, such as the <code class="codeph">interval</code> method. Some perform comparisons, such as <code class="codeph">eq</code> and <code class="codeph">gt</code>, select one or more elements, such as <code class="codeph">selectValue</code> or <code class="codeph">removeValue</code>, or sort elements, such as <code class="codeph">sortAscending</code> or <code class="codeph">sortDescendingHierarchically</code>.
                  </p>
                  <p>The subclasses of <code class="codeph">Source</code> each have other specialized methods, also. For example, the <code class="codeph">NumberSource</code> class has many methods that perform mathematical functions such as <code class="codeph">abs</code>, <code class="codeph">div</code>, and <code class="codeph">cos</code>, and methods that perform aggregations, such as <code class="codeph">average</code> and <code class="codeph">total</code>.
                  </p>
                  <p>The following topics have examples that demonstrate the use of some of the <code class="codeph">Source</code> methods. Some of the examples are tasks that an OLAP application typically performs.
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-6039C35F-361A-430F-9015-5687F072245A">Using the extract Method</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-2DCC7EA8-B3E6-40E8-8F73-6584CD8667CA">Creating a Cube and Pivoting Edges</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-53956A82-8350-44A3-A01C-B0D69B83EFFD">Drilling Up and Down in a Hierarchy</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-DB8D90EC-7527-42B3-AC6C-79CB4976DD2D">Sorting Hierarchically by Measure Values</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-A0ADEAE2-610C-4370-833E-4E10CB5EA925">Using NumberSource Methods To Compute the Share of Units Sold</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-E1F9B138-7563-46A7-9D04-7B33991A156F">Selecting Based on Time Series Operations</a></p>
                     </li>
                     <li>
                        <p><a href="making-queries-using-source-methods.html#GUID-C3436997-90D0-4C9D-9C91-1B74FD8E0638">Selecting a Set of Elements Using Parameterized Source Objects</a></p>
                     </li>
                  </ul>
               </div><a id="OLAAP312"></a><a id="OLAAP311"></a><div class="props_rev_3"><a id="GUID-6039C35F-361A-430F-9015-5687F072245A" name="GUID-6039C35F-361A-430F-9015-5687F072245A"></a><h4 id="OLAAP-GUID-6039C35F-361A-430F-9015-5687F072245A" class="sect4"><span class="enumeration_section">6.3.1 </span>Using the extract Method
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d17761e2474" class="indexterm-anchor"></a><a id="d17761e2478" class="indexterm-anchor"></a>You use the <code class="codeph">extract</code> method to extract the values of a <code class="codeph">Source</code> that is the value of an element of another <code class="codeph">Source</code>. If the elements of a <code class="codeph">Source</code> have element values that are not <code class="codeph">Source</code> objects, then the <code class="codeph">extract</code> method operates like the <code class="codeph">value</code> method.
                        </p>
                        <p><a href="making-queries-using-source-methods.html#GUID-6039C35F-361A-430F-9015-5687F072245A__CBBBGBGC">Example 6-8</a> uses the <code class="codeph">extract</code> method to get the values of the <code class="codeph">NumberSource</code> objects that are themselves the values of the elements of the list <code class="codeph">Source</code> <code class="codeph">measDim</code>. Each of the <code class="codeph">NumberSource</code> objects represents a measure.
                        </p>
                        <p><a id="d17761e2524" class="indexterm-anchor"></a><a id="d17761e2528" class="indexterm-anchor"></a>The example selects elements from <code class="codeph">StringSource</code> objects for the hierarchies of the dimensions of the UNITS_CUBE_AWJ cube. The <code class="codeph">cost</code>, <code class="codeph">units</code>, and <code class="codeph">sales</code> objects are <code class="codeph">NumberSource</code> objects for the COST, UNITS, and SALES measures of the cube.
                        </p>
                        <p><a id="d17761e2550" class="indexterm-anchor"></a>Next, the example creates <code class="codeph">measDim</code>, which is a list <code class="codeph">Source</code> that has the three <code class="codeph">NumberSource</code> objects as element values. It then uses the <code class="codeph">extract</code> method to get the values of the <code class="codeph">NumberSource</code> objects. The resulting unnamed <code class="codeph">Source</code> has <code class="codeph">measDim</code> as an extraction input. The first join operation has <code class="codeph">measDim.extract()</code> as the base <code class="codeph">Source</code>. The input of the base <code class="codeph">Source</code> matches with <code class="codeph">measDim</code>, which is the <code class="codeph">joined</code> parameter. The example then matches the other inputs of the measures by joining the dimension selections to produce the <code class="codeph">result</code> <code class="codeph">Source</code>. 
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-6039C35F-361A-430F-9015-5687F072245A__CBBBGBGC">
                        <p class="titleinexample">Example 6-8 Using the extract Method</p><pre class="oac_no_warn" dir="ltr">Source prodSel = prodHier.selectValues(new String[]
                                        {"PRODUCT_PRIMARY::ITEM::ENVY STD",
                                         "PRODUCT_PRIMARY::ITEM::ENVY EXE",
                                         "PRODUCT_PRIMARY::ITEM::ENVY ABM"});
Source chanSel = chanHier.selectValue("CHANNEL_PRIMARY::CHANNEL::DIR");
Source timeSel = timeHier.selectValue("CALENDAR_YEAR::MONTH::2001.05");
Source custSel = custHier.selectValue("SHIPMENTS::TOTAL_CUSTOMER::TOTAL");
 
Source measDim = dp.createListSource(new Source[] {cost, units, sales});
 
Source result = measDim.extract().join(measDim)   // column
                                 .join(prodSel)   // row
                                 .join(timeSel)   // page
                                 .join(chanSel)   // page
                                 .join(custSel);  // page
</pre><p>The following crosstab displays the values of a <code class="codeph">Cursor</code> for the <code class="codeph">result</code> <code class="codeph">Source</code>, with headings and formatting added.
                        </p><pre class="oac_no_warn" dir="ltr">SHIPMENTS::TOTAL_CUSTOMER::TOTAL
CHANNEL_PRIMARY::CHANNEL::DIR
CALENDAR_YEAR::MONTH::2001.05
 
ITEM            COST      UNITS SOLD   SALES AMOUNT
--------     ----------   ----------   -------------
ENVY ABM      73,316.10       26          77,825.54
ENVY EXE     111,588.30       37         116,470.45
ENVY STD      92,692.47       39          93,429.57</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP314"></a><a id="OLAAP313"></a><div class="props_rev_3"><a id="GUID-2DCC7EA8-B3E6-40E8-8F73-6584CD8667CA" name="GUID-2DCC7EA8-B3E6-40E8-8F73-6584CD8667CA"></a><h4 id="OLAAP-GUID-2DCC7EA8-B3E6-40E8-8F73-6584CD8667CA" class="sect4"><span class="enumeration_section">6.3.2 </span>Creating a Cube and Pivoting Edges
                  </h4>
                  <div>
                     <div class="section">
                        <p>One typical OLAP operation is the creation of a cube, which is a multi-dimensional array of data. The data of the cube is specified by the elements of the column, row, and page edges of the cube. The data of the cube can be data from a measure that is specified by the members of the dimensions of the measure. The cube data can also be dimension members that are specified by some calculation of the measure data, such as products that have unit sales quantities greater than a specified amount.</p>
                        <p><a id="d17761e2657" class="indexterm-anchor"></a><a id="d17761e2661" class="indexterm-anchor"></a><a id="d17761e2665" class="indexterm-anchor"></a><a id="d17761e2669" class="indexterm-anchor"></a><a id="d17761e2673" class="indexterm-anchor"></a><a id="d17761e2677" class="indexterm-anchor"></a><a id="d17761e2681" class="indexterm-anchor"></a><a id="d17761e2685" class="indexterm-anchor"></a><a id="d17761e2689" class="indexterm-anchor"></a><a id="d17761e2691" class="indexterm-anchor"></a><a id="d17761e2693" class="indexterm-anchor"></a><a id="d17761e2698" class="indexterm-anchor"></a><a id="d17761e2702" class="indexterm-anchor"></a>Most of the examples in this topic create cubes. <a href="making-queries-using-source-methods.html#GUID-2DCC7EA8-B3E6-40E8-8F73-6584CD8667CA__CBAGDGHE">Example 6-9</a> creates a cube that has the quantity of units sold as the data of the cube. The column edge values are initially from a channel dimension hierarchy, the row edge values are from a time dimension hierarchy, and the page edge values are from hierarchies for product and customer dimensions. The product and customer member values on the page edge are represented by parameterized <code class="codeph">Source</code> objects.
                        </p>
                        <p>The example joins the selections of the hierarchy members to the short value description attributes for the dimensions so that the results include the attribute values. The example then joins the <code class="codeph">Source</code> objects derived from the hierarchies to the <code class="codeph">Source</code> for the measure to produce the <code class="codeph">cube</code> query. It commits the current <code class="codeph">Transaction</code>, and then creates a <code class="codeph">Cursor</code> for the query and displays the values.
                        </p>
                        <p>After displaying the values of the <code class="codeph">Cursor</code>, the example changes the value of the <code class="codeph">Parameter</code> for the parameterized <code class="codeph">Source</code> for the customer selection, thereby retrieving a different result set using the same <code class="codeph">Cursor</code> in the same <code class="codeph">Transaction</code>. The example resets the position of the <code class="codeph">Cursor</code>, and displays the values of the <code class="codeph">Cursor</code> again.
                        </p>
                        <p>The example then pivots the column and row edges so that the column values are time members and the row values are channel members. It commits the <code class="codeph">Transaction</code>, creates another <code class="codeph">Cursor</code> for the query, and displays the values. It then changes the value of each <code class="codeph">Parameter</code> object and displays the values of the <code class="codeph">Cursor</code> again.
                        </p>
                        <p>The <code class="codeph">dp</code> object is the <code class="codeph">DataProvider</code>. The <code class="codeph">getContext</code> method gets a <code class="codeph">Context11g</code> object that has a method that displays the values of the <code class="codeph">Cursor</code> in a crosstab format.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-2DCC7EA8-B3E6-40E8-8F73-6584CD8667CA__CBAGDGHE">
                        <p class="titleinexample">Example 6-9 Creating a Cube and Pivoting the Edges</p><pre class="oac_no_warn" dir="ltr">// Create Parameter objects with values from the hierarchies
// of the CUSTOMER_AWJ and PRODUCT_AWJ dimensions.
StringParameter custParam =
  new StringParameter(dp, "SHIPMENTS::REGION::EMEA");
StringParameter prodParam =
  new StringParameter(dp, "PRODUCT_PRIMARY::FAMILY::LTPC");
                      
// Create parameterized Source objects using the Parameter objects.
Source custParamSrc = custParam.createSource();
Source prodParamSrc = prodParam.createSource();

// Select single values from the hierarchies, using the Parameter
// objects as the comparisons in the join operations.
Source paramCustSel = custHier.join(custHier.value(), custParamSrc);
Source paramProdSel = prodHier.join(prodHier.value(), prodParamSrc);

// Select members from the other dimensions of the measure.
Source timeSel = 
  timeHier.selectValues(new String[] {"CALENDAR_YEAR::YEAR::CY1999"
                                      "CALENDAR_YEAR::YEAR::CY2000",
                                      "CALENDAR_YEAR::YEAR::CY2001"});
Source chanSel = 
  chanHier.selectValues(new String[] {"CHANNEL_PRIMARY::CHANNEL::DIR",
                                      "CHANNEL_PRIMARY::CHANNEL::CAT	",
                                      "CHANNEL_PRIMARY::CHANNEL::INT"});

// Join the hierarchy selections to the short description attributes
// for the dimensions.
Source columnEdge = chanSel.join(chanShortDescr);
Source rowEdge = timeSel.join(timeShortDescr);
Source page1 = paramProdSel.join(prodShortDescr);
Source page2 = paramCustSel.join(custShortDescr);

// Join the dimension selections to the measure.
Source cube = units.join(columnEdge)
                   .join(rowEdge)
                   .join(page2)
                   .join(page1);

// The following method commits the current Transaction.
getContext().commit();

// Create a Cursor for the query.
CursorManager cursorMngr = dp.createCursorManager(cube);
CompoundCursor cubeCursor = (CompoundCursor) cursorMngr.createCursor();

// Display the values of the Cursor as a crosstab.
getContext().displayCursorAsCrosstab(cubeCursor);

// Change the customer parameter value.
custParam.setValue("SHIPMENTS::REGION::AMER");

// Reset the Cursor position to 1 and display the values again.
cubeCursor.setPosition(1);
println();
getContext().displayCursorAsCrosstab(cubeCursor);

// Pivot the column and row edges.
columnEdge = timeSel.join(timeShortDescr);
rowEdge = chanSel.join(chanShortDescr);

// Join the dimension selections to the measure.
cube = units.join(columnEdge)
            .join(rowEdge))
            .join(page2)
            .join(page1);
 
// Commit the current Transaction.
getContext().commit();

// Create another Cursor.
cursorMngr = dp.createCursorManager(cube);
cubeCursor = (CompoundCursor) cursorMngr.createCursor();
getContext().displayCursorAsCrosstab(cubeCursor);

// Change the product parameter value.
prodParam.setValue("PRODUCT_PRIMARY::FAMILY::DTPC");

// Reset the Cursor position to 1
cubeCursor.setPosition(1);
println();
getContext().displayCursorAsCrosstab(cubeCursor);
</pre><p>The following crosstab has the values of <code class="codeph">cubeCursor</code> displayed by the first <code class="codeph">displayCursorAsCrosstab</code> method.
                        </p><pre class="oac_no_warn" dir="ltr">Portable PCs
Europe
 
        Catalog  Direct Sales  Internet
1999       1986            86         0
2000       1777           193        10
2001       1449           196       215
 </pre><p>The following crosstab has the values of <code class="codeph">cubeCursor</code> after the example changed the value of the <code class="codeph">custParam</code> <code class="codeph">Parameter</code> object.
                        </p><pre class="oac_no_warn" dir="ltr">Portable PCs
North America

        Catalog  Direct Sales  Internet
1999       6841           385        0
2000       6457           622       35
2001       5472           696      846
</pre><p>The next crosstab has the values of <code class="codeph">cubeCursor</code> after pivoting the column and row edges.
                        </p><pre class="oac_no_warn" dir="ltr">Portable PCs
North America
 
                1999    2000    2001
Catalog         6841    6457    5472
Direct Sales     385     622     696
Internet           0      35     846
</pre><p>The last crosstab has the values of <code class="codeph">cubeCursor</code> after changing the value of the <code class="codeph">prodParam</code> <code class="codeph">Parameter</code> object.
                        </p><pre class="oac_no_warn" dir="ltr">Desktop PCs
North America
 
                1999    2000    2001
Catalog        14057   13210   11337
Direct Sales     793    1224    1319
Internet           0      69    1748</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP316"></a><a id="OLAAP315"></a><div class="props_rev_3"><a id="GUID-53956A82-8350-44A3-A01C-B0D69B83EFFD" name="GUID-53956A82-8350-44A3-A01C-B0D69B83EFFD"></a><h4 id="OLAAP-GUID-53956A82-8350-44A3-A01C-B0D69B83EFFD" class="sect4"><span class="enumeration_section">6.3.3 </span>Drilling Up and Down in a Hierarchy
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d17761e2871" class="indexterm-anchor"></a><a id="d17761e2875" class="indexterm-anchor"></a><a id="d17761e2879" class="indexterm-anchor"></a><a id="d17761e2883" class="indexterm-anchor"></a><a id="d17761e2887" class="indexterm-anchor"></a><a id="d17761e2891" class="indexterm-anchor"></a>Drilling up or down in a dimension hierarchy is another typical OLAP operation. <a href="making-queries-using-source-methods.html#GUID-53956A82-8350-44A3-A01C-B0D69B83EFFD__CBBGEGFA">Example 6-10</a> demonstrates getting the members of one level of a dimension hierarchy, selecting a member, and then getting the parent, children, and ancestors of the member. The example gets the children of a parent by reversing the parent relation to produce the <code class="codeph">prodHierChildren</code> <code class="codeph">Source</code>.
                        </p>
                        <p>The example uses the following objects.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">levelSrc</code>, which is the <code class="codeph">Source</code> for the FAMILY level of the PRODUCT_PRIMARY hierarchy of the PRODUCT_AWJ dimension. 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">prodHier</code>, which is the <code class="codeph">Source</code> for the PRODUCT_PRIMARY hierarchy.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">prodHierParentAttr</code>, which is the <code class="codeph">Source</code> for the parent attribute of the hierarchy.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">prodHierAncsAttr</code>, which is the <code class="codeph">Source</code> for the ancestors attribute of the hierarchy.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">prodShortLabel</code>, which is the <code class="codeph">Source</code> for the short value description attribute of the PRODUCT_AWJ dimension.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-53956A82-8350-44A3-A01C-B0D69B83EFFD__CBBGEGFA">
                        <p class="titleinexample">Example 6-10 Drilling in a Hierarchy</p><pre class="oac_no_warn" dir="ltr">int pos = 5;
// Get the element at the specified position of the level Source.
Source levelElement = levelSrc.at(pos);

// Get ancestors of the level member.
Source levelElementAncs = prodHierAncsAttr.join(prodHier, levelElement);
// Get the parent of the level member.
Source levelElementParent = prodHierParentAttr.join(prodHier, levelElement);
// Get the children of a parent.
Source prodHierChildren = prodHier.join(prodHierParentAttr, prodHier.value());

// Select the children of the level member.
Source levelElementChildren = prodHierChildren.join(prodHier, levelElement);

// Get the short value descriptions for the members of the level.
Source levelSrcWithShortDescr = prodShortLabel.join(levelSrc);

// Get the short value descriptions for the children.
Source levelElementChildrenWithShortDescr =
  prodShortLabel.join(levelElementChildren);

// Get the short value descriptions for the parents.
Source levelElementParentWithShortDescr = 
  prodShortLabel.join(prodHier, levelElementParent, true);

// Get the short value descriptions for the ancestors.
Source levelElementAncsWithShortDescr = 
  prodShortLabel.join(prodHier, levelElementAncs, true);

// Commit the current Transaction.
getContext().commit();

// Create Cursor objects and display their values.
println("Level Source element values:");
getContext().displayResult(levelSrcWithShortDescr);
println("\nLevel Source element at position " + pos + ":");
getContext().displayResult(levelElement);
println("\nParent of the level member:");
getContext().displayResult(levelElementParentWithShortDescr);
println("\nChildren of the level member:");
getContext().displayResult(levelElementChildrenWithShortDescr);
println("\nAncestors of the level member:");
getContext().displayResult(levelElementAncsWithShortDescr);
</pre><p>The following list has the values of the <code class="codeph">Cursor</code> objects created by the <code class="codeph">displayResults</code> methods.
                        </p><pre class="oac_no_warn" dir="ltr">Level Source element values:
PRODUCT_PRIMARY::FAMILY::ACC,Accessories
PRODUCT_PRIMARY::FAMILY::DISK,CD/DVD
PRODUCT_PRIMARY::FAMILY::DOC,Documentation
PRODUCT_PRIMARY::FAMILY::DTPC,Portable PCs
PRODUCT_PRIMARY::FAMILY::LTPC,Desktop PCs
PRODUCT_PRIMARY::FAMILY::MEM,Memory
PRODUCT_PRIMARY::FAMILY::MOD,Modems/Fax
PRODUCT_PRIMARY::FAMILY::MON,Monitors
PRODUCT_PRIMARY::FAMILY::OS,Operating Systems

Level Source element at position 5:
PRODUCT_PRIMARY::FAMILY:LTPC

Parent of the level member:
PRODUCT_PRIMARY::CLASS::HRD,Hardware
 
Children of the level member:
PRODUCT_PRIMARY::ITEM::ENVY ABM,Envoy Ambassador
PRODUCT_PRIMARY::ITEM::ENVY EXE,Envoy Executive
PRODUCT_PRIMARY::ITEM::ENVY STD,Envoy Standard

Ancestors of the level member:
PRODUCT_PRIMARY::TOTAL_PRODUCT::TOTAL,Total Product
PRODUCT_PRIMARY::CLASS::HRD,Hardware
PRODUCT_PRIMARY::FAMILY::LTPC,Portable PCs</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP318"></a><a id="OLAAP317"></a><div class="props_rev_3"><a id="GUID-DB8D90EC-7527-42B3-AC6C-79CB4976DD2D" name="GUID-DB8D90EC-7527-42B3-AC6C-79CB4976DD2D"></a><h4 id="OLAAP-GUID-DB8D90EC-7527-42B3-AC6C-79CB4976DD2D" class="sect4"><span class="enumeration_section">6.3.4 </span>Sorting Hierarchically by Measure Values
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d17761e3002" class="indexterm-anchor"></a><a id="d17761e3006" class="indexterm-anchor"></a><a id="d17761e3010" class="indexterm-anchor"></a><a id="d17761e3014" class="indexterm-anchor"></a><a href="making-queries-using-source-methods.html#GUID-DB8D90EC-7527-42B3-AC6C-79CB4976DD2D__CBBJDIAC">Example 6-11</a> uses the <code class="codeph">recursiveJoin</code> method to sort the members of the PRODUCT_PRIMARY hierarchy of the PRODUCT_AWJ dimension hierarchically in ascending order of the values of the UNITS measure. The example joins the sorted products to the short value description attribute of the dimension, and then joins the result of that operation, <code class="codeph">sortedProductsShortDescr</code>, to <code class="codeph">units</code>. 
                        </p>
                        <p>The successive <code class="codeph">joinHidden</code> methods join the selections of the other dimensions of <code class="codeph">units</code> to produce the <code class="codeph">result</code> <code class="codeph">Source</code>, which has the measure data as element values and <code class="codeph">sortedProductsShortDescr</code> as an output. The example uses the <code class="codeph">joinHidden</code> methods so that the other dimension selections are not outputs of the result.
                        </p>
                        <p>The example uses the following objects.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">prodHier</code>, which is the <code class="codeph">Source</code> for the PRODUCT_PRIMARY hierarchy.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">units</code>, which is the <code class="codeph">Source</code> for the UNITS measure of product units sold. 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">prodParentAttr</code>, which is the <code class="codeph">Source</code> for the parent attribute of the PRODUCT_PRIMARY hierarchy.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">prodShortDescr</code>, which is the <code class="codeph">Source</code> for the short value description attribute of the PRODUCT_AWJ dimension.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">custSel</code>, which is a <code class="codeph">Source</code> that specifies a single member of the SHIPMENTS hierarchy of the CUSTOMER_AWJ dimension. The member is <code class="codeph">SHIPMENTS::TOTAL_CUSTOMER::TOTAL</code>, which is the total for all customers.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">chanSel</code>, which is a <code class="codeph">Source</code> that specifies a single member of the CHANNEL_PRIMARY hierarchy of the CHANNEL_AWJ dimension. The member value is <code class="codeph">CHANNEL_PRIMARY::CHANNEL::DIR</code>, which is the direct sales channel.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">timeSel</code>, which is a <code class="codeph">Source</code> that specifies a single member of the CALENDAR_YEAR hierarchy of the TIME_AWJ dimension. The member is <code class="codeph">CALENDAR_YEAR::YEAR::CY2001</code>, which is the year 2001.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-DB8D90EC-7527-42B3-AC6C-79CB4976DD2D__CBBJDIAC">
                        <p class="titleinexample">Example 6-11 Hierarchical Sorting by Measure Value</p><pre class="oac_no_warn" dir="ltr">Source sortedProduct =
  prodHier.recursiveJoin(units,
<a id="d17761e3124" class="indexterm-anchor"></a>                         units.getDataType(),
                         prodParentAttr,
                         Source.COMPARISON_RULE_ASCENDING,
                         true,  // Parents first
                         true); // Restrict parents to base
 
Source sortedProductShortDescr = prodShortDescr.join(sortedProduct);
Source result = units.join(sortedProductShortDescr)
                     .joinHidden(custSel)
                     .joinHidden(chanSel)
                     .joinHidden(timeSel);
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">result</code> <code class="codeph">Source</code> has the following values, displayed in a table with column headings and formatting added. The left column has the name of the level in the <code class="codeph">PRODUCT_PRIMARY</code> hierarchy. The next column to the right has the product identification value, and the next column has the short value description of the product. The rightmost column has the number of units of the product sold to all customers in the year 2001 through the direct sales channel.
                        </p>
                        <p>The table contains only the first nine and the last eleven values of the <code class="codeph">Cursor</code>, plus the Software/Other class value. The product values are listed hierarchically and in ascending order by units sold. The Hardware class appears before the Software/Other class because the Software/Other class has a greater number of units sold. In the Hardware class, the Portable PCs family sold the fewest units, so it appears first. In the Software/Other class, the Accessories family has the greatest number of units sold, so it appears last.
                        </p><pre class="oac_no_warn" dir="ltr">Product Level      ID                 Description           Units Sold
-------------  ------------   ----------------------------- ----------
TOTAL_PRODUCT  TOTAL          Total Product                     43,785
CLASS          HRD            Hardware                          16,543
FAMILY         LTPC           Portable PCs                       1,192
ITEM           ENVY ABM       Envoy Ambassador                     330
ITEM           ENVY EXE       Envoy Executive                      385
ITEM           ENVY STD       Envoy Standard                       477
FAMILY         MON            Monitors                           1,193
ITEM           19 SVGA        Monitor- 19" Super VGA               207
ITEM           17 SVGA        Monitor- 17"Super VGA                986
...
CLASS          SFT            Software/Other)                   27,242
...
FAMILY         ACC            Accessories                       18,949
ITEM           ENVY EXT KBD   Envoy External Keyboard              146
ITEM           EXT KBD        External 101-key keyboard            678
ITEM           MM SPKR 5      Multimedia speakers- 5" cones        717
ITEM           STD MOUSE      Standard Mouse                       868
ITEM           MM SPKR 3      Multimedia speakers- 3" cones      1,120
ITEM           144MB DISK     1.44MB External 3.5" Diskette      1,145
TEM            KBRD REST      Keyboard Wrist Rest                2,231
ITEM           LT CASE        Laptop carrying case               3,704
ITEM           DLX MOUSE      Deluxe Mouse                       3,884
ITEM           MOUSE PAD      Mouse Pad                          4,456</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP320"></a><a id="OLAAP319"></a><div class="props_rev_3"><a id="GUID-A0ADEAE2-610C-4370-833E-4E10CB5EA925" name="GUID-A0ADEAE2-610C-4370-833E-4E10CB5EA925"></a><h4 id="OLAAP-GUID-A0ADEAE2-610C-4370-833E-4E10CB5EA925" class="sect4"><span class="enumeration_section">6.3.5 </span>Using NumberSource Methods To Compute the Share of Units Sold
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d17761e3188" class="indexterm-anchor"></a><a id="d17761e3192" class="indexterm-anchor"></a><a id="d17761e3196" class="indexterm-anchor"></a><a id="d17761e3200" class="indexterm-anchor"></a><a id="d17761e3204" class="indexterm-anchor"></a><a href="making-queries-using-source-methods.html#GUID-A0ADEAE2-610C-4370-833E-4E10CB5EA925__CBBDDCAH">Example 6-12</a> uses the <code class="codeph">NumberSource</code> methods <code class="codeph">div</code> and <code class="codeph">times</code> to produce a <code class="codeph">Source</code> that specifies the share that the Desktop PC and Portable PC families have of the total quantity of product units sold for the selected time, customer, and channel values. The example first uses the <code class="codeph">selectValue</code> method of <code class="codeph">prodHier</code>, which is the <code class="codeph">Source</code> for a hierarchy of the PRODUCT_AWJ dimension, to produce <code class="codeph">totalProds</code>, which specifies a single element with the value <code class="codeph">PRODUCT_PRIMARY::TOTAL_PRODUCT::TOTAL</code>, which is the highest aggregate level of the hierarchy.
                        </p>
                        <p><a id="d17761e3240" class="indexterm-anchor"></a>The <code class="codeph">joinHidden</code> method of the <code class="codeph">NumberSource</code> <code class="codeph">units</code> produces <code class="codeph">totalUnits</code>, which specifies the UNITS measure values at the total product level, without having <code class="codeph">totalProds</code> appear as an output of <code class="codeph">totalUnits</code>. The <code class="codeph">div</code> method of <code class="codeph">units</code> then produces a <code class="codeph">Source</code> that represents each units sold value divided by the total quantity of units sold. The <code class="codeph">times</code> method then multiplies the result of that <code class="codeph">div</code> operation by 100 to produce <code class="codeph">productShare</code>, which represents the percentage, or share, that a product member has of the total quantity of units sold. The <code class="codeph">productShare</code> <code class="codeph">Source</code> has the inputs of the <code class="codeph">units</code> measure as inputs.
                        </p>
                        <p>The <code class="codeph">prodFamilies</code> object is the <code class="codeph">Source</code> for the FAMILY level of the PRODUCT_PRIMARY hierarchy. The <code class="codeph">join</code> method of <code class="codeph">productShare</code>, with <code class="codeph">prodFamilies</code> as the joined <code class="codeph">Source</code>, produces a <code class="codeph">Source</code> that specifies the share that each product family has of the total quantity of products sold.
                        </p>
                        <p>The <code class="codeph">custSel</code>, <code class="codeph">chanSel</code>, and <code class="codeph">timeSel</code> <code class="codeph">Source</code> objects are selections of single members of hierarchies of the CUSTOMER_AWJ, CHANNEL_AWJ, and TIME_AWJ dimensions. The remaining <code class="codeph">join</code> methods match those <code class="codeph">Source</code> objects to the other inputs of <code class="codeph">productShare</code>, to produce <code class="codeph">result</code>. The <code class="codeph">join(Source joined, String comparison)</code> signature of the <code class="codeph">join</code> method produces a <code class="codeph">Source</code> that does not have the joined <code class="codeph">Source</code> as an output.
                        </p>
                        <p>The <code class="codeph">result</code> <code class="codeph">Source</code> specifies the share for each product family of the total quantity of products sold to all customers through the direct sales channel in the year 2001.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-A0ADEAE2-610C-4370-833E-4E10CB5EA925__CBBDDCAH">
                        <p class="titleinexample">Example 6-12 Getting the Share of Units Sold</p><pre class="oac_no_warn" dir="ltr">Source totalProds =
  prodHier.selectValue("PRODUCT_PRIMARY::TOTAL_PRODUCT::TOTAL");
NumberSource totalUnits = (NumberSource) units.joinHidden(totalProds);
Source productShare = units.div(totalUnits).times(100);
Source result = 
  productShare.join(prodFamilies)
              .join(timeHier, "CALENDAR_YEAR::YEAR::CY2001")
              .join(chanHier, "CHANNEL_PRIMARY::CHANNEL::DIR")
              .join(custHier, "SHIPMENTS::TOTAL_CUSTOMER::TOTAL");
Source sortedResult = result.sortAscending();
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">sortedResult</code> <code class="codeph">Source</code> has the following values, displayed in a table with column headings and formatting added. The left column has the product family value and the right column has the share of the total number of units sold for the product family to all customers through the direct sales channel in the year 2001.
                        </p><pre class="oac_no_warn" dir="ltr">Product Family Member          Share of Total Units Sold
-----------------------------  -------------------------
PRODUCT_PRIMARY::FAMILY::LTPC             2.72%
PRODUCT_PRIMARY::FAMILY::MON              2.73%
PRODUCT_PRIMARY::FAMILY::MEM              3.57%
PRODUCT_PRIMARY::FAMILY::DTPC             5.13%
PRODUCT_PRIMARY::FAMILY::DOC              6.4%
PRODUCT_PRIMARY::FAMILY::DISK            11.71%
PRODUCT_PRIMARY::FAMILY::MOD             11.92%
PRODUCT_PRIMARY::FAMILY::OS              12.54%
PRODUCT_PRIMARY::FAMILY::ACC             43.28%</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP322"></a><a id="OLAAP323"></a><a id="OLAAP321"></a><div class="props_rev_3"><a id="GUID-E1F9B138-7563-46A7-9D04-7B33991A156F" name="GUID-E1F9B138-7563-46A7-9D04-7B33991A156F"></a><h4 id="OLAAP-GUID-E1F9B138-7563-46A7-9D04-7B33991A156F" class="sect4"><span class="enumeration_section">6.3.6 </span>Selecting Based on Time Series Operations
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d17761e3422" class="indexterm-anchor"></a><a id="d17761e3426" class="indexterm-anchor"></a><a id="d17761e3430" class="indexterm-anchor"></a><a id="d17761e3434" class="indexterm-anchor"></a><a id="d17761e3438" class="indexterm-anchor"></a>This topic has two examples of using methods that operate on a series of elements of the <code class="codeph">MdmLevelHierarchy</code> for the CALENDAR_YEAR hierarchy of the TIME_AWJ dimension. <a href="making-queries-using-source-methods.html#GUID-E1F9B138-7563-46A7-9D04-7B33991A156F__CBBHGDGG">Example 6-13</a> uses the <code class="codeph">lag</code> method of <code class="codeph">unitPrice</code>, which is the <code class="codeph">Source</code> for the UNIT_PRICE measure, to produce <code class="codeph">unitPriceLag4</code>, which specifies, for each element of <code class="codeph">unitPrice</code> that matches with a member of the hierarchy, the element of <code class="codeph">unitPrice</code> that matches with the hierarchy member that is four time periods earlier at the same level in the hierarchy.
                        </p>
                        <p>In the example, <code class="codeph">dp</code> is the <code class="codeph">DataProvider</code>. The <code class="codeph">createListSource</code> method creates <code class="codeph">measuresDim</code>, which has the <code class="codeph">unitPrice</code> and <code class="codeph">unitPriceLag4</code> <code class="codeph">Source</code> objects as element values. The <code class="codeph">extract</code> method of <code class="codeph">measuresDim</code> gets the values of the elements of <code class="codeph">measuresDim</code>. The <code class="codeph">Source</code> produced by the <code class="codeph">extract</code> method has <code class="codeph">measuresDim</code> as an extraction input. The first <code class="codeph">join</code> method matches a <code class="codeph">Source</code>, <code class="codeph">measuresDim</code>, to the input of the <code class="codeph">Source</code> returned by the <code class="codeph">extract</code> method. 
                        </p>
                        <p>The <code class="codeph">unitPrice</code> and <code class="codeph">unitPriceLag4</code> measures both have the <code class="codeph">Source</code> objects for the PRODUCT_AWJ and TIME_AWJ dimensions as inputs. The second <code class="codeph">join</code> method matches <code class="codeph">quarterLevel</code>, which is a <code class="codeph">Source</code> for the QUARTER level of the CALENDAR_YEAR hierarchy of the TIME_AWJ dimension, with the TIME_AWJ dimension input of the measure, and makes it an output of the resulting <code class="codeph">Source</code>.
                        </p>
                        <p><a id="d17761e3551" class="indexterm-anchor"></a>The <code class="codeph">joinHidden</code> method matches <code class="codeph">prodSel</code> with the PRODUCT_AWJ dimension input of the measure, and does not make <code class="codeph">prodSel</code> an output of the resulting <code class="codeph">Source</code>. The <code class="codeph">prodSel</code> <code class="codeph">Source</code> specifies the single hierarchy member <code class="codeph">PRODUCT_PRIMARY::FAMILY::DTPC</code>, which is Desktop PCs.
                        </p>
                        <p>The <code class="codeph">lagResult</code> <code class="codeph">Source</code> specifies the aggregate unit prices for the Desktop PC product family for each quarter and the quarter that is four quarters earlier.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-E1F9B138-7563-46A7-9D04-7B33991A156F__CBBHGDGG">
                        <p class="titleinexample">Example 6-13 Using the Lag Method</p><pre class="oac_no_warn" dir="ltr">NumberSource unitPriceLag4 = unitPrice.lag(mdmCalHier, 4);
Source measuresDim = dp.createListSource(new Source[] {unitPrice, 
                                                       unitPriceLag4});
 
Source lagResult = measuresDim.extract()
                              .join(measuresDim)
                              .join(quarterLevel)
                              .joinHidden(prodSel);
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">lagResult</code> <code class="codeph">Source</code> has the following values, displayed in a table with column headings and formatting added. The left column has the quarter, the middle column has the total of the unit prices for the members of the Desktop PC family for that quarter, and the right column has the total of the unit prices for the quarter that is four quarters earlier. The first four values in the right column are <code class="codeph">NA</code> because quarter 5, Q1-98, is the first quarter in the CALENDAR_YEAR hierarchy. The table includes only the first eight quarters.
                        </p><pre class="oac_no_warn" dir="ltr">                                                    Unit Price  
Quarter                            Unit Price  Four Quarters Before
---------------------------------  ----------  --------------------
CALENDAR_YEAR::QUARTER::CY1998.Q1    2687.54                NA
CALENDAR_YEAR::QUARTER::CY1998.Q2    2704.48                NA
CALENDAR_YEAR::QUARTER::CY1998.Q3    2673.27                NA
CALENDAR_YEAR::QUARTER::CY1998.Q4    2587.76                NA
CALENDAR_YEAR::QUARTER::CY1999.Q1    2394.79           2687.54
CALENDAR_YEAR::QUARTER::CY1999.Q2    2337.18           2704.48
CALENDAR_YEAR::QUARTER::CY1999.Q3    2348.39           2673.27
CALENDAR_YEAR::QUARTER::CY1999.Q4    2177.89           2587.76
...</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E1F9B138-7563-46A7-9D04-7B33991A156F__CBBFEDFJ">
                        <p class="titleinexample">Example 6-14 Using the movingTotal Method</p>
                        <p><a id="d17761e3611" class="indexterm-anchor"></a><a id="d17761e3615" class="indexterm-anchor"></a><a id="d17761e3619" class="indexterm-anchor"></a>This example uses the same <code class="codeph">unitPrice</code>, <code class="codeph">mdmCalHier</code>, <code class="codeph">quarterLevel</code>, and <code class="codeph">prodSel</code> objects as <a href="making-queries-using-source-methods.html#GUID-E1F9B138-7563-46A7-9D04-7B33991A156F__CBBHGDGG">Example 6-13</a>, but it uses the <code class="codeph">unitPriceMovingTotal</code> measure as the second element of <code class="codeph">measuresDim</code>. The <code class="codeph">unitPriceMovingTotal</code> <code class="codeph">Source</code> is produced by the <code class="codeph">movingTotal</code> method of <code class="codeph">unitPrice</code>. That method provides <code class="codeph">mdmCalHier</code>, which is the <code class="codeph">MdmLevelHierarchy</code> for the CALENDAR_YEAR hierarchy of the TIME_AWJ dimension, as the <code class="codeph">dimension</code> parameter and the integers <code class="codeph">0</code> and <code class="codeph">3</code> as the starting and ending offset values.
                        </p>
                        <p>The <code class="codeph">movingTotalResult</code> <code class="codeph">Source</code> specifies, for each quarter, the aggregate of the unit prices for the members of the Desktop PC family for that quarter and the total of that unit price plus the unit prices for the next three quarters. 
                        </p><pre class="oac_no_warn" dir="ltr">NumberSource unitPriceMovingTotal = 
  unitPrice.movingTotal(mdmCalHier, 0, 3);
 
Source measuresDim =  
  dp.createListSource(new Source[]{unitPrice, unitPriceMovingTotal});

Source movingTotalResult = measuresDim.extract()
                                      .join(measuresDim)
                                      .join(quarterLevel)
                                      .joinHidden(prodSel);     
</pre><p>A <code class="codeph">Cursor</code> for the <code class="codeph">movingTotalResult</code> <code class="codeph">Source</code> has the following values, displayed in a table with column headings and formatting added. The left column has the quarter, the middle column has the total of the unit prices for the members of the Desktop PC family for that quarter, and the left column has the total of the unit prices for that quarter and the next three quarters. The table includes only the first eight quarters.
                        </p><pre class="oac_no_warn" dir="ltr">                                                   Unit Price Moving Total 
Quarter                             Unit Price  Current Plus Next Three Periods
---------------------------------   ----------  -------------------------------
CALENDAR_YEAR::QUARTER::CY1998.Q1     2687.54              10653.05
CALENDAR_YEAR::QUARTER::CY1998.Q2     2704.48              10360.30
CALENDAR_YEAR::QUARTER::CY1998.Q3     2673.27               9993.00
CALENDAR_YEAR::QUARTER::CY1998.Q4     2587.76               9668.12
CALENDAR_YEAR::QUARTER::CY1999.Q1     2394.79               9258.25
CALENDAR_YEAR::QUARTER::CY1999.Q2     2337.18               8911.87
CALENDAR_YEAR::QUARTER::CY1999.Q3     2348.39               8626.48
CALENDAR_YEAR::QUARTER::CY1999.Q4     2177.89               8291.37
...</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP325"></a><a id="OLAAP324"></a><div class="props_rev_3"><a id="GUID-C3436997-90D0-4C9D-9C91-1B74FD8E0638" name="GUID-C3436997-90D0-4C9D-9C91-1B74FD8E0638"></a><h4 id="OLAAP-GUID-C3436997-90D0-4C9D-9C91-1B74FD8E0638" class="sect4"><span class="enumeration_section">6.3.7 </span>Selecting a Set of Elements Using Parameterized Source Objects
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d17761e3734" class="indexterm-anchor"></a><a id="d17761e3738" class="indexterm-anchor"></a><a id="d17761e3742" class="indexterm-anchor"></a><a id="d17761e3746" class="indexterm-anchor"></a><a id="d17761e3750" class="indexterm-anchor"></a><a id="d17761e3754" class="indexterm-anchor"></a><a id="d17761e3758" class="indexterm-anchor"></a><a href="making-queries-using-source-methods.html#GUID-C3436997-90D0-4C9D-9C91-1B74FD8E0638__CBBCFEBC">Example 6-15</a> uses <code class="codeph">NumberParameter</code> objects to create parameterized <code class="codeph">Source</code> objects. Those objects are the <code class="codeph">bottom</code> and <code class="codeph">top</code> parameters for the <code class="codeph">interval</code> method of <code class="codeph">prodHier</code>. That method returns <code class="codeph">paramProdSelInterval</code>, which is a <code class="codeph">Source</code> that specifies the set of elements of <code class="codeph">prodHier</code> from the <code class="codeph">bottom</code> to the <code class="codeph">top</code> positions of the hierarchy.
                        </p>
                        <p>The elements of the product <code class="codeph">Source</code> specify the elements of the <code class="codeph">units</code> measure that appear in the <code class="codeph">result</code> <code class="codeph">Source</code>. By changing the values of the <code class="codeph">Parameter</code> objects, you can select a different set of units sold values using the same <code class="codeph">Cursor</code> and without having to produce new <code class="codeph">Source</code> and <code class="codeph">Cursor</code> objects.
                        </p>
                        <p>The example uses the following objects.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">dp</code>, which is the <code class="codeph">DataProvider</code> for the session.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">prodHier</code>, which is the <code class="codeph">Source</code> for the PRODUCT_PRIMARY hierarchy of the PRODUCT_AWJ dimension.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">prodShortDescr</code>, which is the <code class="codeph">Source</code> for the short value description attribute of the PRODUCT_AWJ dimension.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">units</code>, which is the <code class="codeph">Source</code> for the UNITS measure of product units sold. 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">chanHier</code>, which is the <code class="codeph">Source</code> for the CHANNEL_PRIMARY hierarchy of the CHANNEL_AWJ dimension.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">calHier</code>, which is the <code class="codeph">Source</code> for the CALENDAR_YEAR hierarchy of the TIME_AWJ dimension.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">shipHier</code>, which is the <code class="codeph">Source</code> for the SHIPMENTS hierarchy of the CUSTOMER_AWJ dimension.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">Context11g</code> object that is returned by the <code class="codeph">getContext</code> method. The <code class="codeph">Context11g</code> has methods that commit the current <code class="codeph">Transaction</code>, that create a <code class="codeph">Cursor</code> for a <code class="codeph">Source</code>, that display text, and that display the values of the <code class="codeph">Cursor</code>.
                              </p>
                           </li>
                        </ul>
                        <p><a id="d17761e3912" class="indexterm-anchor"></a><a id="d17761e3916" class="indexterm-anchor"></a>The <code class="codeph">join</code> method of <code class="codeph">prodShortDescr</code> gets the short value descriptions for the elements of <code class="codeph">paramProdSelInterval</code>. The next four <code class="codeph">join</code> methods match <code class="codeph">Source</code> objects with the inputs of the <code class="codeph">units</code> measure. The example creates a <code class="codeph">Cursor</code> and displays the result set of the query. Next, the <code class="codeph">setPosition</code> method of <code class="codeph">resultCursor</code> sets the position of the <code class="codeph">Cursor</code> back to the first element.
                        </p>
                        <p>The <code class="codeph">setValue</code> methods of the <code class="codeph">NumberParameter</code> objects change the values of those objects, which changes the selection of elements of the product <code class="codeph">Source</code> that are specified by the query. The example then displays the values of the <code class="codeph">Cursor</code> again.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-C3436997-90D0-4C9D-9C91-1B74FD8E0638__CBBCFEBC">
                        <p class="titleinexample">Example 6-15 Selecting a Range With NumberParameter Objects</p><pre class="oac_no_warn" dir="ltr">NumberParameter startParam = new NumberParameter(dp, 1);
NumberParameter endParam = new NumberParameter(dp, 6);
 
NumberSource startParamSrc = (NumberSource)startParam.createSource();
NumberSource endParamSrc = (NumberSource)endParam.createSource();

Source paramProdSelInterval = 
  prodHier.interval(startParamSrc, endParamSrc);
Source paramProdSelIntervalShortDescr =
  prodShortDescr.join(paramProdSelInterval);
 
NumberSource result =
  (NumberSource)units.join(chanHier, "CHANNEL_PRIMARY::CHANNEL::INT")
                     .join(calHier, "CALENDAR_YEAR::YEAR::CY2001")
                     .join(shipHier, "SHIPMENTS::TOTAL_CUSTOMER::TOTAL")
                     .join(paramProdSelIntervalShortDescr);
 
// Commit the current transaction.
getContext().commit();
 
CursorManager  cursorMngr = dp.createCursorManager(result);
Cursor resultCursor = cursorMngr.createCursor();
 
getContext().displayCursor(resultCursor);
 
//Reset the Cursor position to 1.
resultCursor.setPosition(1);
 
// Change the value of the parameterized Source.
startParam.setValue(7);
endParam.setValue(12);

// Display the results again.
getContext().displayCursor(resultsCursor);
</pre><p>The following table displays the values of <code class="codeph">resultCursor</code>, with column headings and formatting added. The left column has the product hierarchy members, the middle column has the short value description, and the right column has the quantity of units sold.
                        </p><pre class="oac_no_warn" dir="ltr">              Product                       Description        Units Sold
-------------------------------------  ----------------------  ----------
PRODUCT_PRIMARY::TOTAL_PRODUCT::TOTAL   Total Product             55,872
PRODUCT_PRIMARY::CLASS::HRD             Hardware                  21,301
PRODUCT_PRIMARY::FAMILY::DISK           Memory                     6,634
PRODUCT_PRIMARY::ITEM::EXT CD ROM       External 48X CD-ROM          136
PRODUCT_PRIMARY::ITEM::EXT DVD          External - DVD-RW - 8X     1,526
PRODUCT_PRIMARY::ITEM::INT 8X DVD       Internal - DVD-RW - 8X     1,543
 
              Product                       Description        Units Sold
-------------------------------------  ----------------------  ----------
PRODUCT_PRIMARY::ITEM::INT CD ROM       Internal 48X CD-ROM          380
PRODUCT_PRIMARY::ITEM::INT CD USB       Internal 48X CD-ROM USB      162
PRODUCT_PRIMARY::ITEM::INT RW DVD       Internal - DVD-RW - 6X     2,887
PRODUCT_PRIMARY::FAMILY::DTPC           Desktop PCs                2,982
PRODUCT_PRIMARY::ITEM::SENT FIN         Sentinel Financial         1,015
PRODUCT_PRIMARY::ITEM::SENT MM          Sentinel Multimedia          875</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>