<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Scripts for Creating and Maintaining Oracle Database Provider for DRDA</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="User's Guide">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="provider-drda-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T01:34:46-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2011, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96456-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="SQL-statement-support.html" title="Previous" type="text/html">
      <link rel="next" href="package-binding-options.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Provider for DRDA User's Guide">
    <meta name="dcterms.isVersionOf" content="DRDAS">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="SQL-statement-support.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="package-binding-options.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">User's Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Scripts for Creating and Maintaining Oracle Database Provider for DRDA</li>
            </ol>
            <a id="GUID-9AAED23B-CC61-40DD-A050-D5EAF771B20C" name="GUID-9AAED23B-CC61-40DD-A050-D5EAF771B20C"></a><a id="DRDAS601"></a>
            
            <h2 id="DRDAS-GUID-9AAED23B-CC61-40DD-A050-D5EAF771B20C" class="sect2"><span class="enumeration_appendix">A </span>Scripts for Creating and Maintaining Oracle Database Provider for DRDA
            </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p>Oracle Database Provider for DRDA needs several scripts to establish a proper environment.</p>
               </div>
               <!-- class="section" -->
            </div><a id="DRDAS602"></a><div class="props_rev_3"><a id="GUID-C13A2414-D056-44C6-AD61-15044DDD4EFE" name="GUID-C13A2414-D056-44C6-AD61-15044DDD4EFE"></a><h3 id="DRDAS-GUID-C13A2414-D056-44C6-AD61-15044DDD4EFE" class="sect3">catdrdaas.sql</h3>
               <div>
                  <div class="section">
                     <p>The script <code class="codeph">catdrdaas.sql</code> creates Oracle Database Provider for DRDA catalog objects.
                     </p><pre class="oac_no_warn" dir="ltr">Rem catdrdaas.sql
Rem
Rem Copyright (c) 2011, Oracle and/or its affiliates. All rights reserved. 
Rem
Rem    NAME
Rem      catdrdaas.sql - CATalog Oracle Database Provider for DRDA
Rem
Rem =====================================================================
Rem Exit immediately if there are errors in the initial checks
Rem =====================================================================
 
WHENEVER SQLERROR EXIT;
 
DOC
#######################################################################
  Customer should create the SYSIBM tablespace
 
Eg:
  create tablespace SYSIBM datafile 'sysibm01.dbf'
   size 70M reuse 
   extent management local 
   segment space management auto 
   online;
 
#######################################################################
#
 
@@prvtdpsadrda.plb</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="DRDAS603"></a><div class="props_rev_3"><a id="GUID-F4644CB7-61B9-413D-B480-D725B39B901D" name="GUID-F4644CB7-61B9-413D-B480-D725B39B901D"></a><h3 id="DRDAS-GUID-F4644CB7-61B9-413D-B480-D725B39B901D" class="sect3">catnodrdaas.sql</h3>
               <div>
                  <div class="section">
                     <p>The script <code class="codeph">catnodrdaas.sql</code> removes Oracle Database Provider for DRDA catalog objects
                     </p><pre class="oac_no_warn" dir="ltr">Rem catnodrdaas.sql
Rem
Rem Copyright (c) 2011, 2013, Oracle and/or its affiliates. 
Rem All rights reserved. 
Rem
Rem    NAME
Rem      catnodrdaas.sql - CATalog NO Oracle Database Provider for DRDA
Rem
 
drop public synonym DBMS_DRDAAS;
drop public synonym DBMS_DRDAAS_ADMIN;
 
drop public synonym USER_DRDAASTRACE;
drop public synonym DBA_DRDAASTRACE;
 
drop public synonym ALL_DRDAASPACKAGE;
drop public synonym USER_DRDAASPACKAGE;
drop public synonym DBA_DRDAASPACKAGE;
 
drop public synonym USER_DRDAASPACKSTMT;
drop public synonym DBA_DRDAASPACKSTMT;
 
drop public synonym ALL_DRDAASPACKAUTH;
drop public synonym USER_DRDAASPACKAUTH;
drop public synonym DBA_DRDAASPACKAUTH;
 
drop public synonym ALL_DRDAASPACKSIDE;
drop public synonym USER_DRDAASPACKSIDE;
drop public synonym DBA_DRDAASPACKSIDE;
 
 
drop role DRDAAS_USER_ROLE;
drop role DRDAAS_ADMIN_ROLE;
 
drop user SYSIBM cascade;
 
commit;
DOC
#######################################################################
  Customer should drop the SYSIBM tablespace.
 
Eg:
  drop tablespace SYSIBM;
 
#######################################################################</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="DRDAS676"></a><div class="props_rev_3"><a id="GUID-6171D01A-3A6B-495B-9222-98DCAE943A49" name="GUID-6171D01A-3A6B-495B-9222-98DCAE943A49"></a><h3 id="DRDAS-GUID-6171D01A-3A6B-495B-9222-98DCAE943A49" class="sect3">drdapkg_db2.sql</h3>
               <div>
                  <div class="section">
                     <p></p><pre class="oac_no_warn" dir="ltr">Rem drdapkg_db2.sql
Rem
Rem Copyright (c) 2012, Oracle and/or its affiliates. All rights reserved. 
Rem
Rem    NAME
Rem      drdapkg_db2.sql  - Initialize DRDA-AS environment so that
Rem                          packages can be bound and correct datatypes
Rem                          are returned for various SQL constructs
Rem
Rem    DESCRIPTION
Rem      The DRDA-AS environment needs to be initialized so that the initial
Rem      packages (usually with an RDBCOLID of NULLID) can be bound.	
Rem      Using the DataDirect driver, those package names look like
Rem          NULLID.DDOC510A, NULLID.DDOC510B, and NULLID.DDOC510C
Rem      Using the IBM driver (libdb2.so), the package names look like
Rem          NULLID.SYSTAT and NULLID.SYSshyxx (where s is one of L or S,
Rem                    h is one of H or N, y is 1, 2, 3, or 4 and
Rem                                          xx is somwhere in 00 through FF)
Rem      Also, various columns must be TYPEMAPped -- their normal
Rem      attributes must be altered. 
Rem
Rem      The initial package bindings should be done under the id that runs 
Rem      this script. That is, if we run this script under the Oracle ID 
Rem      of xxxx, then the initial connection through an ODBC driver should be
Rem      using that same id, namely xxxx.
Rem    
Rem    NOTES
Rem      The following is relevant when using the IBM driver: libdb2.so ...
Rem        Note that the normal set of packages produced by the jdbcbinder 
Rem        process (db2jdbcbinder in DB2/LUW) defines packages with names like
Rem        SYSSTAT and SYSLNmnn and SYSLHmnn. Thus, before running the
Rem        jdbcbinder on DB2/LUW specifying the Oracle Id accepted in the prompt
Rem        for this script, one needs to inform DRDA-AS that the id has the
Rem        required privilege, namely to create ANY package in the NULLID
Rem        schema. That is part of what we are doing here.
Rem 
Rem      This script can be run ONLY by a user that has the ability to use
Rem      the DRDAAS_ADMIN_ROLE which must be GRANTed to the user; also this
Rem      role must be active either by being set as a default ROLE or
Rem      by actively doing a SET ROLE DRDAAS_ADMIN_ROLE.
 
SET ECHO ON
SET FEEDBACK 1
SET NUMWIDTH 10
SET LINESIZE 80
SET TRIMSPOOL ON
SET TAB OFF
SET PAGESIZE 100
 
SET SERVEROUTPUT ON 
 
SHOW USER
 
/* The following  will work even if DRDAAS_ADMIN_ROLE is not one of the */
/* DEFAULT Roles, but HAS been GRANTed to the user running this script. */
/* (A prerequisite of setting a DEFAULT ROLE for a user is that the user*/
/*  has been GRANTed that ROLE).                                        */
 
SET ROLE DRDAAS_ADMIN_ROLE;
 
Prompt Enter the OracleID under which the initial package BINDs will be made
Prompt Use quotes (') if needed.
Accept OracleID
Define BindID = &amp;OracleID
Prompt Enter default collection ID for package binding (usually NULLID)
Prompt Use quotes (') if needed.
Accept DefaultCollection
Define DfltCollid = &amp;DefaultCollection
 
declare 
 id_passed CONSTANT VARCHAR2(128) := '&amp;&amp;BindId';
 collid_passed CONSTANT VARCHAR2(128) := '&amp;&amp;DfltCollid';
 id_to_use VARCHAR2(128);
 collid_to_use VARCHAR2(128);
 id_len PLS_INTEGER;
 collid_len PLS_INTEGER;
 quote CONSTANT CHAR := '''';
begin
 id_len := LENGTH(id_passed);
 collid_len := LENGTH(collid_passed);
 
 IF SUBSTR(id_passed, 1, 1) = quote AND SUBSTR(id_passed, id_len, 1) = quote 
      THEN
    /* Use Id exactly as passed */
    id_to_use := SUBSTR(id_passed, 2, id_len - 2);
 ELSE
    id_to_use := UPPER(id_passed) ;
 END IF;
 IF SUBSTR(collid_passed, 1, 1) = quote AND 
    SUBSTR(collid_passed, collid_len, 1) = quote THEN
    /* Use Collection ID  exactly as passed */
    collid_to_use :=  SUBSTR(collid_passed, 2, collid_len-2) ;
 ELSE
    collid_to_use :=  UPPER(collid_passed) ;
 END IF;
 
 -- The following section is pertinent to ALL flavors of DB2
 -- =========================================================
 
  -- The id of the specified  user will have ALL privileges for ANY Package in
  -- RDBCOLID=collid_to_use
 
  DBMS_DRDAAS_ADMIN.GRANT_PRIVILEGE( DBMS_DRDAAS_ADMIN.ALL_PRIVILEGE,
                                     collid_to_use,'*', id_to_use);
 
  commit;
 
  -- If you might want the id specified to create packages in rcbcolid= SCOTT,
  -- then you need to do the following:
 
  -- DBMS_DRDAAS_ADMIN.GRANT_PRIVILEGE(DBMS_DRDAAS_ADMIN.ALL_PRIVILEGE,
  --                                   'SCOTT','*', id_to_use);
  -- commit;
 
  -- Typemaps ...
 
  -- The described "type" for "COUNT(*)" columns in any package in the 
  -- collid_to_use schema should be INTEGER
 
  -- General "COUNT(*)" case
  DBMS_DRDAAS_ADMIN.SET_TYPEMAP(collid_to_use,'*','COUNT(*)',
                               'NUMBER=INTEGER');
 
 
 
  -- ==================================================
  -- The following section is pertinent ONLY to DB2/zOS
  -- ==================================================
 
  -- To use DB2 z/OS SPUFI asgainst DRDAAS, the given oracle-id must be able to 
  -- define packages in the DSNESPCS and DSNESPRR schemas
  -- 
  -- DB2 z/OS SPUFI Packages
 
  DBMS_DRDAAS_ADMIN.GRANT_PRIVILEGE( DBMS_DRDAAS_ADMIN.ALL_PRIVILEGE, 
                                    'DSNESPCS','*', id_to_use);
  DBMS_DRDAAS_ADMIN.GRANT_PRIVILEGE( DBMS_DRDAAS_ADMIN.ALL_PRIVILEGE, 
                                    'DSNESPRR','*', id_to_use);
  commit;
 
  -- ======================================================================
  -- Specific DataDirect ODBC package discovery queries for DB2 z/OS
 
  -- When accessing the collid_to_use.DDOC510A package, the
  -- "column" MAX(SECTNO) referencing table SYSIBM.SYSPACKSTMT (which is a
  --  NUMBER in Oracle terms) should be described as a SMALLINT to the 
  -- application
 
  DBMS_DRDAAS_ADMIN.SET_TYPEMAP(collid_to_use,'DDOC510A',
                                'SYSIBM.SYSPACKSTMT:MAX(SECTNO)',
                                'NUMBER=SMALL');
 
  -- Same as above but for package collid_to_use.DDOC510B
 
  DBMS_DRDAAS_ADMIN.SET_TYPEMAP(collid_to_use,'DDOC510B',
                                'SYSIBM.SYSPACKSTMT:MAX(SECTNO)',
                                'NUMBER=SMALL');
 
 
  -- When accessing the collid_to_use.DDOC510A  package, the 
  -- "column" COUNT(DISTINCT(NAME)) referencing table SYSIBM.SYSPACKSTMT 
  -- (which is  a NUMBER in Oracle terms) should be described as a SMALLINT to
  --  the  application
 
  DBMS_DRDAAS_ADMIN.SET_TYPEMAP(collid_to_use,'DDOC510A',
                                'SYSIBM.SYSPACKSTMT:COUNT(DISTINCT(NAME))',
                                'NUMBER=INTEGER');
 
  -- Same as above but for package collid_to_use.DDOC510B
 
  DBMS_DRDAAS_ADMIN.SET_TYPEMAP(collid_to_use,'DDOC510B',
                                'SYSIBM.SYSPACKSTMT:COUNT(DISTINCT(NAME))',
                                'NUMBER=INTEGER');
  commit;
 
  -- ======================================================================
  -- Specific DataDirect JDBC package discovery queries for DB2 z/OS
 
  -- When accessing the collid_to_use.DDJC360B package, the "column"
  -- COUNT(*)-1 referencing table SYSIBM.SYSPACKSTMT (which is  a NUMBER in
  -- Oracle terms) should be described as an INTEGER to the application
 
  DBMS_DRDAAS_ADMIN.SET_TYPEMAP(collid_to_use,'DDJC360B',
                               'SYSIBM.SYSPACKSTMT:COUNT(*)-1', 
                               'NUMBER=INTEGER');
 
  -- When accessing the collid_to_use.DDJC360B package, the "column"
  -- COUNT(*)-1 referencing table SYSIBM.SYSPACKSTMT (which  might be described
  -- as NUMBER(0,-127) in Oracle terms) describe the column as an INTEGER
  -- to the application.
 
  DBMS_DRDAAS_ADMIN.SET_TYPEMAP(collid_to_use,'DDJC360B',
                                'SYSIBM.SYSPACKSTMT:COUNT(*)-1', 
                                'NUMBER(0,-127)=INTEGER');
  commit;
 
 
  -- ==================================================
  --  the following section is pertinent ONLY to DB2/luw
  -- ==================================================
 
  -- ======================================================================
  -- Specific DataDirect ODBC package discovery queries for DB2/LUW
 
  DBMS_DRDAAS_ADMIN.SET_TYPEMAP(collid_to_use,'DDOC510A',
                                'SYSIBM.SYSPLAN:MIN(TOTALSECT)',
                                'NUMBER=SMALL');
 
  DBMS_DRDAAS_ADMIN.SET_TYPEMAP(collid_to_use,'DDOC510A',
                                'SYSIBM.SYSPLAN:COUNT(*)', 
                                'NUMBER=INTEGER');
  --  DBMS_DRDAAS_ADMIN.SET_TYPEMAP(collid_to_use,'DDOC510A',
  --                                'MIN(TOTALSECT)', 'NUMBER=SMALL');
  commit;
 
  --  ==================================================
  --  The following section is pertinent ONLY to DB2/iOS
  --  ==================================================
 
  --  Currently empty!
end;
/</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="DRDAS677"></a><div class="props_rev_3"><a id="GUID-D47A692B-4DED-4A49-B846-1B8BCEE085C4" name="GUID-D47A692B-4DED-4A49-B846-1B8BCEE085C4"></a><h3 id="DRDAS-GUID-D47A692B-4DED-4A49-B846-1B8BCEE085C4" class="sect3">drdasqtt_translator_setup.sql</h3>
               <div>
                  <div class="section">
                     <p></p><pre class="oac_no_warn" dir="ltr">Rem drdasqtt_translator_setup.sql
Rem
Rem Copyright (c) 2012, Oracle and/or its affiliates. All rights reserved. 
Rem
Rem    NAME
Rem      drdasqtt_translator_setup.sql - Generalized script for setting up an
Rem                                      external SQL translator
Rem
Rem
Rem    DESCRIPTION
Rem      This script can be used to set up any external SQL translator.
Rem      Some translators, e.g., BableFish, may need extra customizations.
Rem      For BabelFish, that would include the source/target SQL text for
Rem      the fingerprint translations (to be inserted into
Rem      DBA_SQL_TRANSLATIONS).
Rem
Rem    NOTES
Rem      Should be run "/ as sysdba"
Rem
 
SET ECHO ON
SET FEEDBACK 1
SET NUMWIDTH 10
SET LINESIZE 80
SET TRIMSPOOL ON
SET TAB OFF
SET PAGESIZE 100
SET SERVEROUTPUT ON
 
show user
 
Prompt Enter schema in which the SQL Translator Interface Package will be created as well 
Prompt as into which the third-party SQL translator will be loaded (usually SYSIBM).
Accept  TRANS_PKG_SCHEMA_ Prompt 'SQL Translator Interface Package Schema:'
DEFINE TRANSLATOR_PACKAGE_SCHEMA =  &amp;TRANS_PKG_SCHEMA_
 
Prompt Enter unqualified name of the SQL Translator Interface Package
Accept  TRANS_PKG_NAME_ Prompt 'SQL Translator Interface Package Name:'
DEFINE TRANSLATOR_PACKAGE_NAME = &amp;TRANS_PKG_NAME_
 
Prompt Enter schema in which the Translation Profile will be created:
Accept  TRANS_PROFILE_SCHEMA_ Prompt 'Translation Profile Schema:'
DEFINE TRANS_PROFILE_SCHEMA = &amp;TRANS_PROFILE_SCHEMA_
 
Prompt Enter the unqualified name of the translation profile:
Accept  TRANS_PROFILE_NAME_ Prompt 'Translation Profile Name:'
DEFINE TRANS_PROFILE_NAME =  &amp;TRANS_PROFILE_NAME_
 
Prompt Enter the "language" type of the translator: C, java, etc
Accept TRANS_LANG_ Prompt 'Translator Language:'
DEFINE TRANS_LANG = &amp;TRANS_LANG_
 
Prompt Enter the names of the third-party SQL Translator objects; 
Prompt They should be available through rdbms/drdaas/jlib/..
Prompt If there is more than one object, enclose the entire set 
Prompt in four quotes, such as  ''''object_a object_b''''.
Accept  EXTERNAL_CODE_ Prompt 'SQL Translator object(s):'
DEFINE EXTERNAL_CODE  = '''&amp;EXTERNAL_CODE_'''
DEFINE EXTERNAL_CODE
 
 
Prompt Enter the signature for the entry for 'translateSQL' in one of the
Prompt  previously entered SQL Translator objects:
Accept CALLOUT_TRANSLATE_SQL_ Prompt 'Entry for translateSQL:'
DEFINE CALLOUT_TRANSLATE_SQL = '''&amp;CALLOUT_TRANSLATE_SQL_'''
 
Prompt Enter the signature for the entry for 'translateError' in one of the
Prompt previously entered SQL Translator objects
Accept CALLOUT_TRANSLATE_ERROR_ Prompt 'Callout for translateError:'
DEFINE CALLOUT_TRANSLATE_ERROR = '''&amp;CALLOUT_TRANSLATE_ERROR_'''
 
 
Rem Create the SQL Translator Interface Package ...
 
create or replace package &amp;&amp;TRANSLATOR_PACKAGE_SCHEMA..&amp;&amp;TRANSLATOR_PACKAGE_NAME as
 
  procedure translate_sql(sql_text              in  clob,
                          translated_text       out clob);
 
  procedure translate_error(error_code          in  binary_integer,
                            translated_code     out binary_integer,
                            translated_sqlstate out varchar2);
 
end;
/
show errors
 
declare 
  COMP_ERROR exception;
  pragma EXCEPTION_INIT(COMP_ERROR, -24344);
  translateSQLcode CONSTANT VARCHAR2(1024) := &amp;&amp;CALLOUT_TRANSLATE_SQL;
  translateErrorcode CONSTANT VARCHAR2(1024) := &amp;&amp;CALLOUT_TRANSLATE_ERROR;
  translateSQLToUse VARCHAR2(1024);
  translateErrorToUse VARCHAR2(1024);
  ln NUMBER;
  quote CONSTANT CHAR := '''';
  my_cursor BINARY_INTEGER;
  n BINARY_INTEGER;
  i BINARY_INTEGER;
  package_body   VARCHAR2(1024);
  /* we can't use bind variables to substitute for the "name" part of the */
  /* procedures in the package body declaration; the "name" part MUST be a*/
  /* single-quoted string!!! ARGHHH !!!                                   */
  package_body_1 VARCHAR2(400) := 
       'create or replace package ' ||
          'body &amp;&amp;TRANSLATOR_PACKAGE_SCHEMA..&amp;&amp;TRANSLATOR_PACKAGE_NAME as '  ||
            'procedure translate_sql(sql_text              in  clob, '       ||
                                  '  translated_text       out clob) as '    ||
              'language &amp;&amp;TRANS_LANG '                                       ||
              'name ''';
  package_body_2 VARCHAR2(400) := ''' ;'                                    ||
            'procedure translate_error(error_code  in  binary_integer, '     ||
                                     ' translated_code out binary_integer,'  ||
                                    ' translated_sqlstate out varchar2) as ' ||
              'language &amp;&amp;TRANS_LANG '                                       ||
              'name ''';
  package_body_end VARCHAR2(10) := '''; end;';
begin
  ln := LENGTH(translateSQLcode);
  IF SUBSTR(translateSQLCode,1,1) = quote AND
     SUBSTR(translateSQLCode,ln,1) = quote THEN
    translateSQLToUse := SUBSTR(translateSQLCode, 2, ln-2);
  ELSE
    translateSQLToUse := translateSQLCode;
  END IF;
  ln := LENGTH(translateErrorcode);
  IF SUBSTR(translateErrorCode,1,1) = quote AND
     SUBSTR(translateErrorCode,ln,1) = quote THEN
    translateErrorToUse := SUBSTR(translateErrorCode, 2, ln-2);
  ELSE
    translateErrorToUse := translateErrorCode;
  END IF;
  my_cursor := DBMS_SQL.OPEN_CURSOR;
  package_body := package_body_1 || translateSQLToUse || package_body_2 ||
                  translateErrorToUse || package_body_end;
  BEGIN
    DBMS_SQL.PARSE(my_cursor, package_body, DBMS_SQL.NATIVE);
  EXCEPTION
    when COMP_ERROR THEN DBMS_OUTPUT.PUT_LINE('SQLCODE=' || SQLCODE || ':' ||
                                              SQLERRM);
  END;
  n := DBMS_SQL.EXECUTE(my_cursor);
  DBMS_SQL.CLOSE_CURSOR(my_cursor);
end;
/
 
show errors
 
Rem Load the Java code
Rem CALL DBMS_JAVA.LOADJAVA('-definer -genmissing -schema SYSIBM
Rem rdbms/drdaas/jlib/DBTooSQLAPI.jar rdbms/drdaas/jlib/DBTooTranslator.class',
Rem '((* SYSIBM)(* PUBLIC)(* -))');
Rem DBTooSQLAPI.jar and DBTooSQLTranslator.class are fictional names

set serveroutput on
 
show user 
 
Rem Load the .class and .jar objects as specified ...
 
declare 
  extcode VARCHAR2(4096) := &amp;&amp;EXTERNAL_CODE;
  real_extcode VARCHAR2(4096);
  first_parm_first_part VARCHAR2(128) := 
                 '-definer -genmissing -schema &amp;&amp;TRANSLATOR_PACKAGE_SCHEMA ';
  first_parm VARCHAR2(4096);
  ln NUMBER;
begin
  ln := LENGTH(extcode);
  /* We might have a beginning and ending aprostrophe --*/
  /* we need to delete them                             */
  IF SUBSTR(extcode,1,1) = '''' AND SUBSTR(extcode,ln,1) = '''' THEN
     real_extcode := SUBSTR(extcode, 2, ln-2);
  ELSE
     real_extcode := extcode;
  END IF;
  first_parm := first_parm_first_part || ' ' || real_extcode;
/*DBMS_OUTPUT.PUT_LINE('First parm ' || first_parm); */
  DBMS_JAVA.LOADJAVA(first_parm ,
                     '((* &amp;&amp;TRANSLATOR_PACKAGE_SCHEMA)(* PUBLIC)(* -))');   
end;
/
 
GRANT EXECUTE ON &amp;&amp;TRANSLATOR_PACKAGE_SCHEMA..&amp;&amp;TRANSLATOR_PACKAGE_NAME  to PUBLIC;
 
GRANT CREATE SQL TRANSLATION PROFILE TO &amp;&amp;TRANS_PROFILE_SCHEMA;
GRANT TRANSLATE ANY SQL TO &amp;&amp;TRANS_PROFILE_SCHEMA WITH ADMIN OPTION;
 
CALL DBMS_SQL_TRANSLATOR.DROP_PROFILE('&amp;&amp;TRANS_PROFILE_SCHEMA..&amp;&amp;TRANS_PROFILE_NAME');
CALL DBMS_SQL_TRANSLATOR.CREATE_PROFILE('&amp;&amp;TRANS_PROFILE_SCHEMA..&amp;&amp;TRANS_PROFILE_NAME');
 
 
begin
    dbms_sql_translator.set_attribute('&amp;&amp;TRANS_PROFILE_SCHEMA..&amp;&amp;TRANS_PROFILE_NAME',  
                        dbms_sql_translator.attr_translator,
                                    '&amp;&amp;TRANSLATOR_PACKAGE_SCHEMA..&amp;&amp;TRANSLATOR_PACKAGE_NAME');
  
 dbms_sql_translator.set_attribute('&amp;&amp;TRANS_PROFILE_SCHEMA..&amp;&amp;TRANS_PROFILE_NAME',  
                        dbms_sql_translator.attr_translate_new_sql,  
                                        dbms_sql_translator.attr_value_true);
end;
/
 
GRANT ALL ON SQL TRANSLATION PROFILE &amp;&amp;TRANS_PROFILE_SCHEMA..
&nbsp;&nbsp;&nbsp;&amp;&amp;TRANS_PROFILE_NAME TO &amp;&amp;TRANSLATOR_PACKAGE_SCHEMA ;
GRANT USE ON SQL TRANSLATION PROFILE &amp;&amp;TRANS_PROFILE_SCHEMA..
&nbsp;&nbsp;&nbsp;&amp;&amp;TRANS_PROFILE_NAME TO DRDAAS_USER_ROLE;</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="DRDAS678"></a><div class="props_rev_3"><a id="GUID-EFEFE8E4-AC5C-4FF8-BA26-0BA0912EA463" name="GUID-EFEFE8E4-AC5C-4FF8-BA26-0BA0912EA463"></a><h3 id="DRDAS-GUID-EFEFE8E4-AC5C-4FF8-BA26-0BA0912EA463" class="sect3">drdasqt_set_profile_dd.sql</h3>
               <div>
                  <div class="section">
                     <p></p><pre class="oac_no_warn" dir="ltr">Rem drdasqt_set_profile_dd.sql
Rem
Rem Copyright (c) 2012, Oracle and/or its affiliates. All rights reserved. 
Rem
Rem    NAME
Rem      drdasqt_set_profile_dd.sql - Set a sqllangprofile for each of
Rem                                   the DataDirect (dd) packages.
Rem
 
SET ECHO ON
SET FEEDBACK 1
SET NUMWIDTH 10
SET LINESIZE 80
SET TRIMSPOOL ON
SET TAB OFF
SET PAGESIZE 100
 
Rem You will be prompted for the profile name.
Rem Must be run under an id that has access to the DRDAAS_ADMIN_ROLE role.
 
Rem set echo on
set serveroutput on
 
 
SET ROLE DRDAAS_ADMIN_ROLE;
 
prompt Enter the (qualified) profile name to use for DataDirect packages
Accept SQLPROFILENAME
Define PROFILE_NAMEX = &amp;SQLPROFILENAME
prompt Enter the default Package Collection (usually NULLID)
Prompt Use quotes (') if needed
Accept DefaultCollection
Define PACKAGE_COLLECTIONX = &amp;DefaultCollection
 
declare
  TYPE FIRST_CHAR  IS VARRAY(4) of CHAR(1);
  TYPE SECOND_CHAR IS VARRAY(3) of CHAR(1);
 
  first_chr  FIRST_CHAR := FIRST_CHAR();
  second_chr SECOND_CHAR := SECOND_CHAR();
  package_name VARCHAR2(128);
  profile_name CONSTANT VARCHAR2(128) := '&amp;&amp;PROFILE_NAMEX';
  package_collection_as_passed CONSTANT VARCHAR2(128) := 
                                         '&amp;&amp;PACKAGE_COLLECTIONX';
  package_collection VARCHAR2(128);
  cmd VARCHAR2(255);
  quote CONSTANT CHAR := '''';
  ln BINARY_INTEGER;
begin
 
  ln := LENGTH(package_collection_as_passed);
  IF SUBSTR(package_collection_as_passed, 1,  1) = quote AND 
     SUBSTR(package_collection_as_passed, ln, 1) = quote THEN
    /* Use package_collection exactly as passed */
     package_collection := SUBSTR(package_collection_as_passed, 2, ln - 2);
  ELSE
     package_collection := UPPER(package_collection_as_passed) ;
  END IF;
 
  first_chr.EXTEND(4);
  first_chr(1) := 'C'; first_chr(2) := 'S';
  first_chr(3) := 'U'; first_chr(4) := 'R';
  second_chr.EXTEND(3);
  second_chr(1) := 'A'; second_chr(2) := 'B'; second_chr(3) := 'C';
 
  FOR f IN 1..first_chr.COUNT
  LOOP
    FOR s IN 1..second_chr.COUNT
    LOOP
       package_name := 'DDO' || first_chr(f) || '510' || second_chr(s);
 
       cmd := 'DBMS_DRDAAS_ADMIN.SET_PROFILE(' || package_collection || ',' ||
                                                  package_name  || ',' ||
                                                  profile_name  || ')';
       DBMS_OUTPUT.PUT_LINE('Doing ' || cmd);
       DBMS_DRDAAS_ADMIN.SET_PROFILE(package_collection, package_name, 
                                      profile_name);
 
    END LOOP;
  END LOOP;
end;
/</pre></div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>