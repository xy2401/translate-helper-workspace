<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">
      <meta name="description" content="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">
      <title>Managing SQL Tuning Sets</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Tuning Guide">
      <meta property="og:description" content="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Tuning Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-tuning-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-31T14:57:08-08:00">
      <meta name="dcterms.title" content="SQL Tuning Guide">
      <meta name="dcterms.dateCopyrighted" content="2013, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96095-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="automatic-sql-tuning.html" title="Previous" type="text/html">
      <link rel="next" href="sql-tuning-advisor.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGSQL">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="automatic-sql-tuning.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="sql-tuning-advisor.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Tuning Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="automatic-sql-tuning.html" property="item" typeof="WebPage"><span property="name">Automatic SQL Tuning</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Managing SQL Tuning Sets</li>
            </ol>
            <a id="GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE" name="GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE"></a><a id="TGSQL516"></a>
            
            <h2 id="TGSQL-GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE" class="sect2"><span class="enumeration_chapter">23 </span>Managing SQL Tuning Sets
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.</p>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5">About SQL Tuning Sets</a><br>A <strong class="term">SQL tuning set (STS)</strong> is a database object that you can use as input to tuning tools.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-5F6C1400-AD6F-4BEB-A0D8-12AADA127ADD">Creating a SQL Tuning Set</a><br>Use the <code class="codeph">CREATE_SQLSET</code> procedure in <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> to create an empty STS in the database.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-4E5240CD-B021-4728-89A9-95F5B81CBC59">Loading a SQL Tuning Set</a><br>To load an STS with SQL statements, use the <code class="codeph">LOAD_SQLSET</code> procedure in the <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> package.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-B776D937-29CF-40CA-9D5B-2C427934190E">Displaying the Contents of a SQL Tuning Set</a><br>To read the contents of an STS after it has been created and populated, use the <code class="codeph">SELECT_SQLSET</code> function of <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code>, optionally using filtering criteria.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-1C2E5289-B579-4AA9-8073-5F77358A8E62">Modifying a SQL Tuning Set</a><br>Use the <code class="codeph">DELETE_SQLSET</code> procedure in <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> to delete SQL statements from an STS. 
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-E6F9F020-6257-4456-A568-8BF4CC1FFF7C">Transporting a SQL Tuning Set</a><br>You can transport an STS to any database created in Oracle Database 10<span class="italic">g</span> Release 2 (10.2) or later. This technique is useful when using SQL Performance Analyzer to tune regressions on a test database.
                  </li>
                  <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-493FA794-EF69-464D-BB6F-C8CF06686023">Dropping a SQL Tuning Set</a><br>To drop an STS from the database, use the <code class="codeph">DROP_SQLSET</code> procedure in the <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> package.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="automatic-sql-tuning.html#GUID-538A6E57-527A-46D2-97B8-F2238E0D0838" title="SQL Tuning Advisor and SQL Access Advisor are built-in tools that provide SQL tuning recommendations.">Automatic SQL Tuning</a></p>
                  </div>
               </div>
            </div>
            <a id="TGSQL517"></a><div class="props_rev_3"><a id="GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5" name="GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5"></a><h3 id="TGSQL-GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5" class="sect3"><span class="enumeration_section">23.1 </span>About SQL Tuning Sets
               </h3>
               <div>
                  <p>A <strong class="term">SQL tuning set (STS)</strong> is a database object that you can use as input to tuning tools.
                  </p>
                  <p>The database stores SQL tuning sets in a database-provided schema. An STS includes:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>A set of SQL statements</p>
                     </li>
                     <li>
                        <p>Associated execution context, such as user schema, application module name and action, list of bind values, and the environment for <a href="glossary.html#GUID-F9233BE0-9CB9-4673-A705-174924AE3B18"><span class="xrefglossterm">SQL compilation</span></a> of the cursor
                        </p>
                     </li>
                     <li>
                        <p>Associated basic execution statistics, such as elapsed time, CPU time, buffer gets, disk reads, rows processed, cursor fetches, the number of executions, the number of complete executions, optimizer cost, and the command type</p>
                     </li>
                     <li>
                        <p>Associated execution plans and row source statistics for each SQL statement (optional)</p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5__GUID-A187E5CE-55AC-4159-A5BF-98A40B3092E9">
                     <p class="notep1">Note:</p>
                     <p>Data visibility and privilege requirements may differ when using an STS with pluggable databases. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ADMIN13885" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> for a table that summarizes how manageability features work in a container database (CDB).
                     </p>
                  </div>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-FAFB39D0-13DB-4682-AAEE-6581D71D814C">Purpose of SQL Tuning Sets</a><br>An STS enables you to group SQL statements and related metadata in a single database object, which you can use to meet your tuning goals. 
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-AB246C71-0701-4FD3-B703-49A1F706B7F3">Concepts for SQL Tuning Sets</a><br>To create an STS, you must load SQL statements into an STS from a source.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-135EE7C5-2768-4BDB-B914-CDD3904AC030">User Interfaces for SQL Tuning Sets</a><br>You can use either Oracle Enterprise Manager Cloud Control (Cloud Control) or PL/SQL packages to manage SQL tuning sets. Oracle recommends Cloud Control.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-9203BA12-8EDE-4EE5-B4EC-3265824200D7">Basic Tasks for SQL Tuning Sets</a><br><code class="codeph">DBMS_SQLTUNE</code> provides the procedures necessary for creating, using, and deleting SQL tuning sets.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE" title="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">Managing SQL Tuning Sets</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL518"></a><div class="props_rev_3"><a id="GUID-FAFB39D0-13DB-4682-AAEE-6581D71D814C" name="GUID-FAFB39D0-13DB-4682-AAEE-6581D71D814C"></a><h4 id="TGSQL-GUID-FAFB39D0-13DB-4682-AAEE-6581D71D814C" class="sect4"><span class="enumeration_section">23.1.1 </span>Purpose of SQL Tuning Sets
                  </h4>
                  <div>
                     <p>An STS enables you to group SQL statements and related metadata in a single database object, which you can use to meet your tuning goals. </p>
                     <p>Specifically, SQL tuning sets achieve the following goals:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Providing input to the performance tuning advisors</p>
                           <p>You can use an STS as input to multiple database advisors, including SQL Tuning Advisor, SQL Access Advisor, and SQL Performance Analyzer. </p>
                        </li>
                        <li>
                           <p>Transporting SQL between databases</p>
                           <p>You can export SQL tuning sets from one database to another, enabling transfer of SQL workloads between databases for remote performance diagnostics and tuning. When suboptimally performing SQL statements occur on a production database, developers may not want to investigate and tune directly on the production database. The DBA can transport the problematic SQL statements to a test database where the developers can safely analyze and tune them.</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5" title="A SQL tuning set (STS) is a database object that you can use as input to tuning tools.">About SQL Tuning Sets</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL520"></a><a id="TGSQL519"></a><div class="props_rev_3"><a id="GUID-AB246C71-0701-4FD3-B703-49A1F706B7F3" name="GUID-AB246C71-0701-4FD3-B703-49A1F706B7F3"></a><h4 id="TGSQL-GUID-AB246C71-0701-4FD3-B703-49A1F706B7F3" class="sect4"><span class="enumeration_section">23.1.2 </span>Concepts for SQL Tuning Sets
                  </h4>
                  <div>
                     <p>To create an STS, you must load SQL statements into an STS from a source.</p>
                     <p>As shown in <a href="managing-sql-tuning-sets.html#GUID-AB246C71-0701-4FD3-B703-49A1F706B7F3__BEIHEGAG">Figure 23-1</a>, the source can be Automatic Workload Repository (AWR), the <a href="glossary.html#GUID-577D0DD3-FB98-4B1B-BCFB-95313BB35C01"><span class="xrefglossterm">shared SQL area</span></a>, customized SQL provided by the user, trace files, or another STS.
                     </p>
                     <div class="figure" id="GUID-AB246C71-0701-4FD3-B703-49A1F706B7F3__BEIHEGAG">
                        <p class="titleinfigure">Figure 23-1 SQL Tuning Sets</p><img src="img/tgsql_vm_065.png" alt="Description of Figure 23-1 follows" title="Description of Figure 23-1 follows" longdesc="img_text/tgsql_vm_065.html"><br><a href="img_text/tgsql_vm_065.html">Description of "Figure 23-1 SQL Tuning Sets"</a></div>
                     <!-- class="figure" -->
                     <p>SQL tuning sets can do the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Filter SQL statements using the application module name and action, or any execution statistics</p>
                        </li>
                        <li>
                           <p>Rank SQL statements based on any combination of execution statistics</p>
                        </li>
                        <li>
                           <p>Serve as input to the advisors or transport it to a different database</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-AB246C71-0701-4FD3-B703-49A1F706B7F3__GUID-B764961A-A69F-4706-ACA9-EAAA4A7F2782">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=TGDBA169" target="_blank"><span><cite>Oracle Database Performance Tuning Guide</cite></span></a> to learn about AWR
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5" title="A SQL tuning set (STS) is a database object that you can use as input to tuning tools.">About SQL Tuning Sets</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL521"></a><div class="props_rev_3"><a id="GUID-135EE7C5-2768-4BDB-B914-CDD3904AC030" name="GUID-135EE7C5-2768-4BDB-B914-CDD3904AC030"></a><h4 id="TGSQL-GUID-135EE7C5-2768-4BDB-B914-CDD3904AC030" class="sect4"><span class="enumeration_section">23.1.3 </span>User Interfaces for SQL Tuning Sets
                  </h4>
                  <div>
                     <p>You can use either Oracle Enterprise Manager Cloud Control (Cloud Control) or PL/SQL packages to manage SQL tuning sets. Oracle recommends Cloud Control.</p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-4336DBFE-6BD2-4F51-A5EB-D3F937431094">Accessing the SQL Tuning Sets Page in Cloud Control</a><br>The SQL Tuning Sets page in Cloud Control is the starting page from which you can perform most operations relating to SQL tuning sets.
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-236DF69A-6370-4A56-9BF1-384C7CB865B1">Command-Line Interface to SQL Tuning Sets</a><br>On the command line, you can use the <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> packages to manage SQL tuning sets.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5" title="A SQL tuning set (STS) is a database object that you can use as input to tuning tools.">About SQL Tuning Sets</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="TGSQL95141"></a><a id="TGSQL522"></a><div class="props_rev_3"><a id="GUID-4336DBFE-6BD2-4F51-A5EB-D3F937431094" name="GUID-4336DBFE-6BD2-4F51-A5EB-D3F937431094"></a><h5 id="TGSQL-GUID-4336DBFE-6BD2-4F51-A5EB-D3F937431094" class="sect5"><span class="enumeration_section">23.1.3.1 </span>Accessing the SQL Tuning Sets Page in Cloud Control
                     </h5>
                     <div>
                        <p>The SQL Tuning Sets page in Cloud Control is the starting page from which you can perform most operations relating to SQL tuning sets.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-4336DBFE-6BD2-4F51-A5EB-D3F937431094__GUID-44325896-8480-4E3C-889C-3129EEABDF1E">To access the SQL Tuning Sets page:</p>
                           <ol>
                              <li>
                                 <p>Log in to Cloud Control with the appropriate credentials.</p>
                              </li>
                              <li>
                                 <p>Under the <span class="bold">Targets</span> menu, select <span class="bold">Databases</span>.
                                 </p>
                              </li>
                              <li>
                                 <p>In the list of database targets, select the target for the Oracle Database instance that you want to administer.</p>
                              </li>
                              <li>
                                 <p>If prompted for database credentials, then enter the minimum credentials necessary for the tasks you intend to perform.</p>
                              </li>
                              <li>
                                 <p>From the <span class="bold">Performance</span> menu, select <span class="bold">SQL</span>, then <span class="bold">SQL Tuning Sets</span>.
                                 </p>
                                 <p>The SQL Tuning Sets page appears, as shown in <a href="managing-sql-tuning-sets.html#GUID-4336DBFE-6BD2-4F51-A5EB-D3F937431094__BEIECCAA">Figure 23-2</a>.
                                 </p>
                                 <div class="figure" id="GUID-4336DBFE-6BD2-4F51-A5EB-D3F937431094__BEIECCAA">
                                    <p class="titleinfigure">Figure 23-2 SQL Tuning Sets</p><img src="img/sts_homepage.jpg" alt="Description of Figure 23-2 follows" title="Description of Figure 23-2 follows" longdesc="img_text/sts_homepage.html"><br><a href="img_text/sts_homepage.html">Description of "Figure 23-2 SQL Tuning Sets"</a></div>
                                 <!-- class="figure" -->
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-4336DBFE-6BD2-4F51-A5EB-D3F937431094__GUID-911AC772-DC4A-4284-9BE8-8EA23C1FECD4">
                           <p class="notep1">See Also:</p>
                           <p> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=TDPPT164" target="_blank"><span><cite>Oracle Database 2 Day + Performance Tuning Guide</cite></span></a></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-135EE7C5-2768-4BDB-B914-CDD3904AC030" title="You can use either Oracle Enterprise Manager Cloud Control (Cloud Control) or PL/SQL packages to manage SQL tuning sets. Oracle recommends Cloud Control.">User Interfaces for SQL Tuning Sets</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL523"></a><div class="props_rev_3"><a id="GUID-236DF69A-6370-4A56-9BF1-384C7CB865B1" name="GUID-236DF69A-6370-4A56-9BF1-384C7CB865B1"></a><h5 id="TGSQL-GUID-236DF69A-6370-4A56-9BF1-384C7CB865B1" class="sect5"><span class="enumeration_section">23.1.3.2 </span>Command-Line Interface to SQL Tuning Sets
                     </h5>
                     <div>
                        <p>On the command line, you can use the <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> packages to manage SQL tuning sets.
                        </p>
                        <div class="section">
                           <p>You must have the <code class="codeph">ADMINISTER SQL TUNING SET</code> system privilege to manage SQL tuning sets that you own, or the <code class="codeph">ADMINISTER ANY SQL TUNING SET</code> system privilege to manage any SQL tuning sets.
                           </p>
                           <p>The traditional package for managing SQL tuning sets is <code class="codeph">DBMS_SQLTUNE</code>, which requires the Oracle Tuning Pack. Starting in <span>Oracle Database 18c</span>, you can perform the same tasks with <code class="codeph">DBMS_SQLSET</code>, which does <span class="italic">not</span> require the Oracle Tuning Pack. In most cases, the name of the subprogram in <code class="codeph">DBMS_SQLSET</code> is identical to the name of the equivalent subprogram in <code class="codeph">DBMS_SQLTUNE</code>. The following table shows only the subprograms whose names differ.
                           </p>
                           <div class="tblformal" id="GUID-236DF69A-6370-4A56-9BF1-384C7CB865B1__GUID-9F19E07F-2DA8-48FE-81D1-DC10CBDA9146">
                              <p class="titleintable">Table 23-1 Naming Differences for SQL Tuning Set Subprograms</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="Naming Differences for SQL Tuning Set Subprograms" summary="This table describes SQL tuning set subprograms whose names differ in DBMS_SQLTUNE and DBMS_SQLSET." frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="20%" id="d116968e1145">DBMS_SQLTUNE</th>
                                       <th align="left" valign="bottom" width="20%" id="d116968e1147">DBMS_SQLSET</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d116968e1151" headers="d116968e1145 "><code class="codeph">ADD_SQLSET_REFERENCE</code> 
                                       </td>
                                       <td align="left" valign="top" width="20%" headers="d116968e1151 d116968e1147 "><code class="codeph">ADD_REFERENCE</code></td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d116968e1159" headers="d116968e1145 "><code class="codeph">CAPTURE_CURSOR_CACHE_SQLSET</code></td>
                                       <td align="left" valign="top" width="20%" headers="d116968e1159 d116968e1147 "><code class="codeph">CAPTURE_CURSOR_CACHE</code></td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d116968e1166" headers="d116968e1145 "><code class="codeph">CREATE_STGTAB_SQLSET</code></td>
                                       <td align="left" valign="top" width="20%" headers="d116968e1166 d116968e1147 "><code class="codeph">CREATE_STGTAB</code></td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d116968e1173" headers="d116968e1145 "><code class="codeph">PACK_STGTAB_SQLSET</code></td>
                                       <td align="left" valign="top" width="20%" headers="d116968e1173 d116968e1147 "><code class="codeph">PACK_STGTAB</code></td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d116968e1180" headers="d116968e1145 "><code class="codeph">REMAP_STGTAB_SQLSET</code></td>
                                       <td align="left" valign="top" width="20%" headers="d116968e1180 d116968e1147 "><code class="codeph">REMAP_STGTAB</code></td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d116968e1187" headers="d116968e1145 "><code class="codeph">REVOVE_SQLSET_REFERENCE</code></td>
                                       <td align="left" valign="top" width="20%" headers="d116968e1187 d116968e1147 "><code class="codeph">REMOVE_REFERENCE</code></td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d116968e1194" headers="d116968e1145 "><code class="codeph">UNPACK_STGTAB_SQLSET</code></td>
                                       <td align="left" valign="top" width="20%" headers="d116968e1194 d116968e1147 "><code class="codeph">UNPACK_STGTAB</code></td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-236DF69A-6370-4A56-9BF1-384C7CB865B1__GUID-FC081A68-1935-4C42-98B5-B405642FA5BE">
                           <p class="notep1">See Also:</p>
                           <p><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span> to learn about <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS220" target="_blank"><code class="codeph">DBMS_SQLTUNE</code></a> and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=GUID-DFF30D13-6724-46FC-B711-91C0A59EB1E1" target="_blank"><code class="codeph">DBMS_SQLSET</code></a></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-135EE7C5-2768-4BDB-B914-CDD3904AC030" title="You can use either Oracle Enterprise Manager Cloud Control (Cloud Control) or PL/SQL packages to manage SQL tuning sets. Oracle recommends Cloud Control.">User Interfaces for SQL Tuning Sets</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL525"></a><a id="TGSQL524"></a><div class="props_rev_3"><a id="GUID-9203BA12-8EDE-4EE5-B4EC-3265824200D7" name="GUID-9203BA12-8EDE-4EE5-B4EC-3265824200D7"></a><h4 id="TGSQL-GUID-9203BA12-8EDE-4EE5-B4EC-3265824200D7" class="sect4"><span class="enumeration_section">23.1.4 </span>Basic Tasks for SQL Tuning Sets
                  </h4>
                  <div>
                     <p><code class="codeph">DBMS_SQLTUNE</code> provides the procedures necessary for creating, using, and deleting SQL tuning sets.
                     </p>
                     <div class="infoboxnote" id="GUID-9203BA12-8EDE-4EE5-B4EC-3265824200D7__GUID-615B4FFA-7D94-4AC4-BCD9-79E948B1FB65">
                        <p class="notep1">Note:</p>
                        <p>Alternatively, you can use the corresponding subprograms in <code class="codeph">DBMS_SQLSET</code>. In most cases, the subprograms have identical names.
                        </p>
                     </div>
                     <p>The following graphic shows the basic workflow.</p>
                     <div class="figure" id="GUID-9203BA12-8EDE-4EE5-B4EC-3265824200D7__BEIGEHAA">
                        <p class="titleinfigure">Figure 23-3 SQL Tuning Sets APIs</p><img src="img/tgsql_vm_025.png" alt="Description of Figure 23-3 follows" title="Description of Figure 23-3 follows" longdesc="img_text/tgsql_vm_025.html"><br><a href="img_text/tgsql_vm_025.html">Description of "Figure 23-3 SQL Tuning Sets APIs"</a></div>
                     <!-- class="figure" -->
                     <p>Typically, you perform STS operations in the following sequence:</p>
                     <ol>
                        <li>
                           <p>Create a new STS.</p>
                           <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-5F6C1400-AD6F-4BEB-A0D8-12AADA127ADD" title="Use the CREATE_SQLSET procedure in DBMS_SQLTUNE or DBMS_SQLSET to create an empty STS in the database.">Creating a SQL Tuning Set</a>"</span> describes this task.
                           </p>
                        </li>
                        <li>
                           <p>Load the STS with SQL statements and associated metadata.</p>
                           <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-4E5240CD-B021-4728-89A9-95F5B81CBC59" title="To load an STS with SQL statements, use the LOAD_SQLSET procedure in the DBMS_SQLTUNE or DBMS_SQLSET package.">Loading a SQL Tuning Set</a>"</span> describes this task.
                           </p>
                        </li>
                        <li>
                           <p>Optionally, display the contents of the STS.</p>
                           <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-B776D937-29CF-40CA-9D5B-2C427934190E" title="To read the contents of an STS after it has been created and populated, use the SELECT_SQLSET function of DBMS_SQLTUNE or DBMS_SQLSET, optionally using filtering criteria.">Displaying the Contents of a SQL Tuning Set</a>"</span> describes this task.
                           </p>
                        </li>
                        <li>
                           <p>Optionally, update or delete the contents of the STS.</p>
                           <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-1C2E5289-B579-4AA9-8073-5F77358A8E62" title="Use the DELETE_SQLSET procedure in DBMS_SQLTUNE or DBMS_SQLSET to delete SQL statements from an STS.">Modifying a SQL Tuning Set</a>"</span> describes this task.
                           </p>
                        </li>
                        <li>
                           <p>Create a tuning task with the STS as input.</p>
                        </li>
                        <li>
                           <p>Optionally, transport the STS to another database.</p>
                           <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-E6F9F020-6257-4456-A568-8BF4CC1FFF7C" title="You can transport an STS to any database created in Oracle Database 10g Release 2 (10.2) or later. This technique is useful when using SQL Performance Analyzer to tune regressions on a test database.">Transporting a SQL Tuning Set</a>"</span> describes this task.
                           </p>
                        </li>
                        <li>
                           <p>Drop the STS when finished.</p>
                           <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-493FA794-EF69-464D-BB6F-C8CF06686023" title="To drop an STS from the database, use the DROP_SQLSET procedure in the DBMS_SQLTUNE or DBMS_SQLSET package.">Dropping a SQL Tuning Set</a>"</span> describes this task.
                           </p>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-9203BA12-8EDE-4EE5-B4EC-3265824200D7__GUID-DAAB6ED9-004D-4042-A492-3A28F8B83733">
                        <p class="notep1">See Also:</p>
                        <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-236DF69A-6370-4A56-9BF1-384C7CB865B1" title="On the command line, you can use the DBMS_SQLTUNE or DBMS_SQLSET packages to manage SQL tuning sets.">Command-Line Interface to SQL Tuning Sets</a>"</span> for the names of the equivalent <code class="codeph">DBMS_SQLSET</code> subprograms
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5" title="A SQL tuning set (STS) is a database object that you can use as input to tuning tools.">About SQL Tuning Sets</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL527"></a><a id="TGSQL94880"></a><a id="TGSQL526"></a><div class="props_rev_3"><a id="GUID-5F6C1400-AD6F-4BEB-A0D8-12AADA127ADD" name="GUID-5F6C1400-AD6F-4BEB-A0D8-12AADA127ADD"></a><h3 id="TGSQL-GUID-5F6C1400-AD6F-4BEB-A0D8-12AADA127ADD" class="sect3"><span class="enumeration_section">23.2 </span>Creating a SQL Tuning Set
               </h3>
               <div>
                  <p>Use the <code class="codeph">CREATE_SQLSET</code> procedure in <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> to create an empty STS in the database.
                  </p>
                  <div class="section">
                     <p>Using the function instead of the procedure causes the database to generate a name for the STS. The following table describes some procedure parameters.</p>
                     <div class="tblformal" id="GUID-5F6C1400-AD6F-4BEB-A0D8-12AADA127ADD__BEIIHDDJ">
                        <p class="titleintable">Table 23-2 DBMS_SQLTUNE.CREATE_SQLSET Parameters</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_SQLTUNE.CREATE_SQLSET Parameters" summary="This 2 column table lists the parameters for CREATE_SQLSET task. Column 1 is the parameter. Column 2 describes that parameter. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="30%" id="d116968e1617">Parameter</th>
                                 <th align="left" valign="bottom" width="70%" id="d116968e1620">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d116968e1625" headers="d116968e1617 ">
                                    <p><code class="codeph">sqlset_name</code></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d116968e1625 d116968e1620 ">
                                    <p>Name of the STS</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d116968e1633" headers="d116968e1617 ">
                                    <p><code class="codeph">description</code></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d116968e1633 d116968e1620 ">
                                    <p>Optional description of the STS</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-5F6C1400-AD6F-4BEB-A0D8-12AADA127ADD__GUID-3C0F6202-A260-4682-A51D-394F5519ECA5">Assumptions</p>
                     <p>This tutorial assumes that </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You want to create an STS named <code class="codeph">SQLT_WKLD_STS</code>.
                           </p>
                        </li>
                        <li>
                           <p>You use <code class="codeph">DBMS_SQLTUNE</code> instead of <code class="codeph">DBMS_SQLSET</code>.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-5F6C1400-AD6F-4BEB-A0D8-12AADA127ADD__GUID-08ACD11D-5519-4710-ACE3-14DC9A4D86FC">To create an STS:</p>
                     <ol>
                        <li>
                           <p>In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                        </li>
                        <li>
                           <p>Use the <code class="codeph">DBMS_SQLTUNE.CREATE_SQLSET</code> procedure.
                           </p>
                           <p>For example, execute the following PL/SQL program:</p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.CREATE_SQLSET (
    sqlset_name  =&gt; 'SQLT_WKLD_STS' 
,   description  =&gt; 'STS to store SQL from the private SQL area' 
);
END;
</code></pre></li>
                        <li>
                           <p>Optionally, confirm that the STS was created.</p>
                           <p>The following example queries the status of all SQL tuning sets owned by the current user:</p><pre class="pre codeblock"><code>COLUMN NAME FORMAT a20
COLUMN COUNT FORMAT 99999
COLUMN DESCRIPTION FORMAT a11

SELECT NAME, STATEMENT_COUNT AS "SQLCNT", DESCRIPTION
FROM   USER_SQLSET;
</code></pre><p>Sample output appears below:</p><pre class="pre codeblock"><code>NAME                 SQLCNT DESCRIPTION
-------------------- ------ -----------
SQLT_WKLD_STS             2 SQL Cache</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-5F6C1400-AD6F-4BEB-A0D8-12AADA127ADD__GUID-BB302B38-8429-4E61-A7D1-986F7F715CC8">
                     <p class="notep1">See Also:</p>
                     <p> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS68408" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for complete reference information
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE" title="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">Managing SQL Tuning Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL529"></a><a id="TGSQL94881"></a><a id="TGSQL94882"></a><a id="TGSQL528"></a><div class="props_rev_3"><a id="GUID-4E5240CD-B021-4728-89A9-95F5B81CBC59" name="GUID-4E5240CD-B021-4728-89A9-95F5B81CBC59"></a><h3 id="TGSQL-GUID-4E5240CD-B021-4728-89A9-95F5B81CBC59" class="sect3"><span class="enumeration_section">23.3 </span>Loading a SQL Tuning Set
               </h3>
               <div>
                  <p>To load an STS with SQL statements, use the <code class="codeph">LOAD_SQLSET</code> procedure in the <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> package.
                  </p>
                  <div class="section">
                     <p>The standard sources for populating an STS are AWR, another STS, or the shared SQL area. For both the workload repository and SQL tuning sets, predefined table functions can select columns from the source to populate a new STS. </p>
                     <p>The following table describes some <code class="codeph">DBMS_SQLTUNE.LOAD_SQLSET</code> procedure parameters.
                     </p>
                     <div class="tblformal" id="GUID-4E5240CD-B021-4728-89A9-95F5B81CBC59__BEICCIII">
                        <p class="titleintable">Table 23-3 DBMS_SQLTUNE.LOAD_SQLSET Parameters</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_SQLTUNE.LOAD_SQLSET Parameters" summary="This table describes the input parameters of the LOAD_SQLSET procedure." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="30%" id="d116968e1841">Parameter</th>
                                 <th align="left" valign="bottom" width="70%" id="d116968e1844">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d116968e1849" headers="d116968e1841 ">
                                    <p><code class="codeph">populate_cursor</code></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d116968e1849 d116968e1844 ">
                                    <p>Specifies the cursor reference from which to populate the STS.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d116968e1857" headers="d116968e1841 ">
                                    <p><code class="codeph">load_option</code></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d116968e1857 d116968e1844 ">
                                    <p>Specifies how the statements are loaded into the STS. The possible values are <code class="codeph">INSERT</code> (default), <code class="codeph">UPDATE</code>, and <code class="codeph">MERGE</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>The <code class="codeph">DBMS_SQLTUNE.SELECT_CURSOR_CACHE</code> function collects SQL statements from the shared SQL area according to the specified filter. This function returns one <code class="codeph">SQLSET_ROW</code> per SQL ID or <code class="codeph">PLAN_HASH_VALUE</code> pair found in each data source.
                     </p>
                     <p>Use the <code class="codeph">DBMS_SQLTUNE.CAPTURE_CURSOR_CACHE_SQLSET</code> function (or the equivalent <code class="codeph">DBMS_SQLSET.CAPTURE_CURSOR_CACHE</code>) to repeatedly poll the shared SQL area over a specified interval. This function is more efficient than repeatedly calling the <code class="codeph">SELECT_CURSOR_CACHE</code> and <code class="codeph">LOAD_SQLSET</code> procedures. This function effectively captures the entire workload, as opposed to the AWR, which only captures the workload of high-load SQL statements, or the <code class="codeph">LOAD_SQLSET</code> procedure, which accesses the data source only once.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-4E5240CD-B021-4728-89A9-95F5B81CBC59__GUID-689D00F6-F258-4786-A1DB-CCB1C12B31A1">Prerequisites</p>
                     <p>This tutorial has the following prerequisites:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Filters provided to the <code class="codeph">SELECT_CURSOR_CACHE</code> function are evaluated as part of SQL statements run by the current user. As such, they are executed with that user's security privileges and can contain any constructs and subqueries that user can access, but no more.
                           </p>
                        </li>
                        <li>
                           <p>The current user must have privileges on the shared SQL area views.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-4E5240CD-B021-4728-89A9-95F5B81CBC59__GUID-71052334-8D31-456F-B0DC-C912C64F93C3">Assumptions</p>
                     <p>This tutorial assumes the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You want to load the SQL tuning set named <code class="codeph">SQLT_WKLD_STS</code> with statements from the shared SQL area.
                           </p>
                        </li>
                        <li>You want to use <code class="codeph">DBMS_SQLTUNE</code> rather than <code class="codeph">DBMS_SQLSET</code> to load the STS.
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-4E5240CD-B021-4728-89A9-95F5B81CBC59__GUID-B9141BC3-7D7E-4A62-A599-BD161BDBE80C">To load an STS:</p>
                     <ol>
                        <li>
                           <p>In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                        </li>
                        <li>
                           <p>Run the <code class="codeph">DBMS_SQLTUNE.LOAD_SQLSET</code> procedure.
                           </p>
                           <p>For example, execute the following PL/SQL program to populate a SQL tuning set with all cursor cache statements that belong to the <code class="codeph">sh</code> schema:
                           </p><pre class="pre codeblock"><code>DECLARE
  c_sqlarea_cursor DBMS_SQLTUNE.SQLSET_CURSOR;
BEGIN
 OPEN c_sqlarea_cursor FOR
   SELECT VALUE(p)
   FROM   TABLE( 
            DBMS_SQLTUNE.SELECT_CURSOR_CACHE(
            ' module = ''SQLT_WKLD'' AND parsing_schema_name = ''SH'' ')
          ) p;
-- load the tuning set
  DBMS_SQLTUNE.LOAD_SQLSET (  
    sqlset_name     =&gt; 'SQLT_WKLD_STS'
,   populate_cursor =&gt;  c_sqlarea_cursor 
);
END;
/</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-4E5240CD-B021-4728-89A9-95F5B81CBC59__GUID-5321E653-4620-45F3-96E4-24EE8F7FA7B2">
                     <p class="notep1">See Also:</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS68430" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for complete reference information.
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE" title="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">Managing SQL Tuning Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL531"></a><a id="TGSQL94883"></a><a id="TGSQL94884"></a><a id="TGSQL530"></a><div class="props_rev_3"><a id="GUID-B776D937-29CF-40CA-9D5B-2C427934190E" name="GUID-B776D937-29CF-40CA-9D5B-2C427934190E"></a><h3 id="TGSQL-GUID-B776D937-29CF-40CA-9D5B-2C427934190E" class="sect3"><span class="enumeration_section">23.4 </span>Displaying the Contents of a SQL Tuning Set
               </h3>
               <div>
                  <p>To read the contents of an STS after it has been created and populated, use the <code class="codeph">SELECT_SQLSET</code> function of <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code>, optionally using filtering criteria.
                  </p>
                  <div class="section">
                     <p>Select the output of <code class="codeph">SELECT_SQLSET</code> using a PL/SQL <a href="glossary.html#GUID-BCAC562D-CB30-4A8E-B9F0-CDF34C39D8B8"><span class="xrefglossterm">pipelined table function</span></a>, which accepts a collection of rows as input. You invoke the table function as the operand of the table operator in the <code class="codeph">FROM</code> list of a <code class="codeph">SELECT</code> statement. The following table describes some <code class="codeph">SELECT_SQLSET</code> function parameters.
                     </p>
                     <div class="tblformal" id="GUID-B776D937-29CF-40CA-9D5B-2C427934190E__BEICJIFI">
                        <p class="titleintable">Table 23-4 DBMS_SQLTUNE.SELECT_SQLSET Parameters</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_SQLTUNE.SELECT_SQLSET Parameters" summary="This table describes input parameters for the DBMS_SQLTUNE.SELECT_SQLSET function." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d116968e2117">Parameter</th>
                                 <th align="left" valign="bottom" width="75%" id="d116968e2120">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d116968e2125" headers="d116968e2117 ">
                                    <p><code class="codeph">basic_filter</code></p>
                                 </td>
                                 <td align="left" valign="top" width="75%" headers="d116968e2125 d116968e2120 ">
                                    <p>The SQL predicate to filter the SQL from the STS defined on attributes of the <code class="codeph">SQLSET_ROW</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d116968e2135" headers="d116968e2117 ">
                                    <p><code class="codeph">object_filter</code></p>
                                 </td>
                                 <td align="left" valign="top" width="75%" headers="d116968e2135 d116968e2120 ">
                                    <p>Specifies the objects that exist in the object list of selected SQL from the shared SQL area</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>The following table describes some attributes of the <code class="codeph">SQLSET_ROW</code> object. These attributes appears as columns when you query <code class="codeph">TABLE(DBMS_SQLTUNE.SELECT_SQLSET())</code>.
                     </p>
                     <div class="tblformal" id="GUID-B776D937-29CF-40CA-9D5B-2C427934190E__BEIDGICD">
                        <p class="titleintable">Table 23-5 SQLSET_ROW Attributes</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="SQLSET_ROW Attributes" summary="This table describes the attributes of the SQLSET_ROW object." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d116968e2160">Parameter</th>
                                 <th align="left" valign="bottom" width="75%" id="d116968e2163">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d116968e2168" headers="d116968e2160 ">
                                    <p><code class="codeph">parsing_schema_name</code></p>
                                 </td>
                                 <td align="left" valign="top" width="75%" headers="d116968e2168 d116968e2163 ">
                                    <p>Schema in which the SQL is parsed</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d116968e2176" headers="d116968e2160 ">
                                    <p><code class="codeph">elapsed_time</code></p>
                                 </td>
                                 <td align="left" valign="top" width="75%" headers="d116968e2176 d116968e2163 ">
                                    <p>Sum of the total number of seconds elapsed for this SQL statement</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d116968e2184" headers="d116968e2160 ">
                                    <p><code class="codeph">buffer_gets</code></p>
                                 </td>
                                 <td align="left" valign="top" width="75%" headers="d116968e2184 d116968e2163 ">
                                    <p>Total number of buffer gets (number of times the database accessed a block) for this SQL statement</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-B776D937-29CF-40CA-9D5B-2C427934190E__GUID-ECC73CC1-AC8C-4E86-9200-9E09A1D5909E">Assumptions</p>
                     <p>This tutorial assumes the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You want to display the contents of an STS named <code class="codeph">SQLT_WKLD_STS</code>.
                           </p>
                        </li>
                        <li>
                           <p>You are using <code class="codeph">DBMS_SQLTUNE</code> instead of <code class="codeph">DBMS_SQLSET</code>.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-B776D937-29CF-40CA-9D5B-2C427934190E__GUID-20199851-3996-472A-83D0-9A5980AA826D">To display the contents of an STS:</p>
                     <ol>
                        <li>
                           <p id="GUID-B776D937-29CF-40CA-9D5B-2C427934190E__d5e29">In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                        </li>
                        <li>
                           <p>Query the STS contents using the <code class="codeph">TABLE</code> function.
                           </p>
                           <p>For example, execute the following query:</p><pre class="pre codeblock"><code>COLUMN SQL_TEXT FORMAT a30   
COLUMN SCH FORMAT a3
COLUMN ELAPSED FORMAT 999999999

SELECT SQL_ID, PARSING_SCHEMA_NAME AS "SCH", SQL_TEXT, 
       ELAPSED_TIME AS "ELAPSED", BUFFER_GETS
FROM   TABLE( DBMS_SQLTUNE.SELECT_SQLSET( 'SQLT_WKLD_STS' ) );
</code></pre><p>Sample output appears below:</p><pre class="pre codeblock"><code>SQL_ID        SCH SQL_TEXT                          ELAPSED BUFFER_GETS
------------- --- ------------------------------ ---------- -----------
79f8shn041a1f SH  select * from sales where quan    8373148       24016
                  tity_sold &lt; 5 union select * f
                  rom sales where quantity_sold
                  &gt; 500
 
2cqsw036j5u7r SH  select promo_name, count(*) c     3557373         309
                  from promotions p, sales s whe
                  re s.promo_id = p.promo_id and
                   p.promo_category = 'internet'
                   group by p.promo_name order b
                  y c desc
 
fudq5z56g642p SH  select sum(quantity_sold) from    4787891       12118
                   sales s, products p where s.p
                  rod_id = p.prod_id and s.amoun
                  t_sold &gt; 20000 and p.prod_name
                   = 'Linen Big Shirt'
 
bzmnj0nbvmz8t SH  select * from sales where amou     442355       15281
                  nt_sold = 4
</code></pre></li>
                        <li>
                           <p>Optionally, filter the results based on user-specific criteria.</p>
                           <p>The following example displays statements with a disk reads to buffer gets ratio greater than or equal to 50%:</p><pre class="pre codeblock"><code>COLUMN SQL_TEXT FORMAT a30   
COLUMN SCH FORMAT a3
COLUMN BUF_GETS FORMAT 99999999
COLUMN DISK_READS FORMAT 99999999
COLUMN %_DISK FORMAT 9999.99
SELECT sql_id, parsing_schema_name as "SCH", sql_text, 
       buffer_gets as "B_GETS",
       disk_reads, ROUND(disk_reads/buffer_gets*100,2) "%_DISK"
FROM TABLE( DBMS_SQLTUNE.SELECT_SQLSET( 
            'SQLT_WKLD_STS',
            '(disk_reads/buffer_gets) &gt;= 0.50' ) );
</code></pre><p>Sample output appears below:</p><pre class="pre codeblock"><code>SQL_ID        SCH SQL_TEXT                       B_GETS DISK_READS %_DISK
------------- --- ------------------------------ ------ ---------- -------
79f8shn041a1f SH  select * from sales where quan  24016      17287  71.98
                  tity_sold &lt; 5 union select * f
                  rom sales where quantity_sold
                  &gt; 500
 
fudq5z56g642p SH  select sum(quantity_sold) from  12118       6355  52.44
                   sales s, products p where s.p
                  rod_id = p.prod_id and s.amoun
                  t_sold &gt; 20000 and p.prod_name
                   = 'Linen Big Shirt'</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-B776D937-29CF-40CA-9D5B-2C427934190E__GUID-29C0A065-95E6-4023-BF9A-79BA02118887">
                     <p class="notep1">See Also:</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS68458" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for complete reference information
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE" title="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">Managing SQL Tuning Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL94885"></a><a id="TGSQL532"></a><div class="props_rev_3"><a id="GUID-1C2E5289-B579-4AA9-8073-5F77358A8E62" name="GUID-1C2E5289-B579-4AA9-8073-5F77358A8E62"></a><h3 id="TGSQL-GUID-1C2E5289-B579-4AA9-8073-5F77358A8E62" class="sect3"><span class="enumeration_section">23.5 </span>Modifying a SQL Tuning Set
               </h3>
               <div>
                  <p>Use the <code class="codeph">DELETE_SQLSET</code> procedure in <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> to delete SQL statements from an STS. 
                  </p>
                  <div class="section">
                     <p>You can use the <code class="codeph">UPDATE_SQLSET</code> procedure to update the attributes of SQL statements (such as <code class="codeph">PRIORITY</code> or <code class="codeph">OTHER</code>) in an existing STS identified by STS name and SQL ID.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1C2E5289-B579-4AA9-8073-5F77358A8E62__GUID-0806E25E-93CC-41DA-B531-855AAC606903">Assumptions</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>This tutorial assumes that you want to modify <code class="codeph">SQLT_WKLD_STS</code> as follows:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You want to delete all SQL statements with fetch counts over 100.</p>
                        </li>
                        <li>
                           <p>You want to change the priority of the SQL statement with ID <code class="codeph">fudq5z56g642p</code> to <code class="codeph">1</code>. You can use priority as a ranking criteria when running SQL Tuning Advisor.
                           </p>
                        </li>
                        <li>
                           <p>You use <code class="codeph">DBMS_SQLTUNE</code> instead of <code class="codeph">DBMS_SQLSET</code>.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1C2E5289-B579-4AA9-8073-5F77358A8E62__GUID-EC53AE77-5085-4887-B4AA-F11F0D188B25">To modify the contents of an STS:</p>
                     <ol>
                        <li>
                           <p>In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                        </li>
                        <li>
                           <p>Optionally, query the STS contents using the <code class="codeph">TABLE</code> function.
                           </p>
                           <p>For example, execute the following query:</p><pre class="pre codeblock"><code>SELECT SQL_ID, ELAPSED_TIME, FETCHES, EXECUTIONS
FROM   TABLE(DBMS_SQLTUNE.SELECT_SQLSET('SQLT_WKLD_STS'));
</code></pre><p>Sample output appears below:</p><pre class="pre codeblock"><code>SQL_ID        ELAPSED_TIME    FETCHES EXECUTIONS
------------- ------------ ---------- ----------
2cqsw036j5u7r      3407459          2          1
79f8shn041a1f      9453965      61258          1
bzmnj0nbvmz8t       401869          1          1
fudq5z56g642p      5300264          1          1
</code></pre></li>
                        <li>
                           <p>Delete SQL statements based on user-specified criteria.</p>
                           <p>Use the <code class="codeph">basic_filter</code> predicate to filter the SQL from the STS defined on attributes of the <code class="codeph">SQLSET_ROW</code>. The following example deletes all statements in the STS with fetch counts over 100:
                           </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.DELETE_SQLSET (
      sqlset_name  =&gt; 'SQLT_WKLD_STS'
,     basic_filter =&gt; 'fetches &gt; 100'
);
END;
/
</code></pre></li>
                        <li>
                           <p>Set attribute values for SQL statements.</p>
                           <p>The following example sets the priority of statement <code class="codeph">2cqsw036j5u7r</code> to <code class="codeph">1</code>:
                           </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.UPDATE_SQLSET ( 
      sqlset_name     =&gt; 'SQLT_WKLD_STS'    
,     sql_id          =&gt; '2cqsw036j5u7r'    
,     attribute_name  =&gt; 'PRIORITY'         
,     attribute_value =&gt;  1
);
END;
/
</code></pre></li>
                        <li>
                           <p>Optionally, query the STS to confirm that the intended modifications were made.</p>
                           <p>For example, execute the following query:</p><pre class="pre codeblock"><code>SELECT SQL_ID, ELAPSED_TIME, FETCHES, EXECUTIONS, PRIORITY
FROM   TABLE(DBMS_SQLTUNE.SELECT_SQLSET('SQLT_WKLD_STS'));
</code></pre><p>Sample output appears below:</p><pre class="pre codeblock"><code>SQL_ID        ELAPSED_TIME    FETCHES EXECUTIONS   PRIORITY
------------- ------------ ---------- ---------- ----------
2cqsw036j5u7r      3407459          2          1          1
bzmnj0nbvmz8t       401869          1          1
fudq5z56g642p      5300264          1          1</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-1C2E5289-B579-4AA9-8073-5F77358A8E62__GUID-4AB4651D-A6FD-44E0-91BD-F5EDCFFFCBC5">
                     <p class="notep1">See Also:</p>
                     <p> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS68416" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE" title="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">Managing SQL Tuning Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL533"></a><div class="props_rev_3"><a id="GUID-E6F9F020-6257-4456-A568-8BF4CC1FFF7C" name="GUID-E6F9F020-6257-4456-A568-8BF4CC1FFF7C"></a><h3 id="TGSQL-GUID-E6F9F020-6257-4456-A568-8BF4CC1FFF7C" class="sect3"><span class="enumeration_section">23.6 </span>Transporting a SQL Tuning Set
               </h3>
               <div>
                  <p>You can transport an STS to any database created in Oracle Database 10<span class="italic">g</span> Release 2 (10.2) or later. This technique is useful when using SQL Performance Analyzer to tune regressions on a test database.
                  </p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-35D138E2-1E24-4911-921E-F73C2478EB96">About Transporting SQL Tuning Sets</a><br>Transporting SQL tuning sets between databases means copying the SQL tuning sets to and from a staging table, and then using other tools to move the staging table to the destination database. The most common tools are Oracle Data Pump or a database link.
                     </li>
                     <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-CD6EBF22-6A8B-4404-A155-A90FA16754C6">Transporting SQL Tuning Sets with DBMS_SQLTUNE</a><br>You can transport SQL tuning sets using three subprograms in the <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> package.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE" title="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">Managing SQL Tuning Sets</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL534"></a><div class="props_rev_3"><a id="GUID-35D138E2-1E24-4911-921E-F73C2478EB96" name="GUID-35D138E2-1E24-4911-921E-F73C2478EB96"></a><h4 id="TGSQL-GUID-35D138E2-1E24-4911-921E-F73C2478EB96" class="sect4"><span class="enumeration_section">23.6.1 </span>About Transporting SQL Tuning Sets
                  </h4>
                  <div>
                     <p>Transporting SQL tuning sets between databases means copying the SQL tuning sets to and from a staging table, and then using other tools to move the staging table to the destination database. The most common tools are Oracle Data Pump or a database link.</p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-6FD06FF4-825A-4A66-A08C-7E4006A7489C">Basic Steps for Transporting SQL Tuning Sets</a><br>Transporting SQL tuning sets requires exporting the STS, transporting the dump file, and then importing the dump file.
                        </li>
                        <li class="ulchildlink"><a href="managing-sql-tuning-sets.html#GUID-5952CC2C-6D3B-47CE-A5B8-516B20DB3BFA">Basic Steps for Transporting SQL Tuning Sets When the CON_DBID Values Differ</a><br>When transporting an STS, you must remap the <code class="codeph">con_dbid</code> of each SQL statement in the STS when the <code class="codeph">con_dbid</code> of the source database and the destination database are different.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-E6F9F020-6257-4456-A568-8BF4CC1FFF7C" title="You can transport an STS to any database created in Oracle Database 10g Release 2 (10.2) or later. This technique is useful when using SQL Performance Analyzer to tune regressions on a test database.">Transporting a SQL Tuning Set</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="TGSQL535"></a><a id="TGSQL95107"></a><div class="props_rev_3"><a id="GUID-6FD06FF4-825A-4A66-A08C-7E4006A7489C" name="GUID-6FD06FF4-825A-4A66-A08C-7E4006A7489C"></a><h5 id="TGSQL-GUID-6FD06FF4-825A-4A66-A08C-7E4006A7489C" class="sect5"><span class="enumeration_section">23.6.1.1 </span>Basic Steps for Transporting SQL Tuning Sets
                     </h5>
                     <div>
                        <p>Transporting SQL tuning sets requires exporting the STS, transporting the dump file, and then importing the dump file.</p>
                        <p>The following graphic shows the process using Oracle Data Pump and <code class="codeph">ftp</code>.
                        </p>
                        <div class="figure" id="GUID-6FD06FF4-825A-4A66-A08C-7E4006A7489C__BEIHAEEG">
                           <p class="titleinfigure">Figure 23-4 Transporting SQL Tuning Sets</p><img src="img/tgsql_vm_049.png" alt="Description of Figure 23-4 follows" title="Description of Figure 23-4 follows" longdesc="img_text/tgsql_vm_049.html"><br><a href="img_text/tgsql_vm_049.html">Description of "Figure 23-4 Transporting SQL Tuning Sets"</a></div>
                        <!-- class="figure" -->
                        <p>As shown in <a href="managing-sql-tuning-sets.html#GUID-6FD06FF4-825A-4A66-A08C-7E4006A7489C__BEIHAEEG">Figure 23-4</a>, the steps are as follows:
                        </p>
                        <ol>
                           <li>
                              <p>In the production database, pack the STS into a staging table using <code class="codeph">DBMS_SQLTUNE.PACK_STGTAB_SQLSET</code> or <code class="codeph">DBMS_SQLSET.PACK_STGTAB</code>.
                              </p>
                           </li>
                           <li>
                              <p>Export the STS from the staging table to a <code class="codeph">.dmp</code> file using Oracle Data Pump.
                              </p>
                           </li>
                           <li>
                              <p>Transfer the <code class="codeph">.dmp</code> file from the production host to the test host using a transfer tool such as <code class="codeph">ftp</code>.
                              </p>
                           </li>
                           <li>
                              <p>In the test database, import the STS from the <code class="codeph">.dmp</code> file to a staging table using Oracle Data Pump.
                              </p>
                           </li>
                           <li>
                              <p>Unpack the STS from the staging table using <code class="codeph">DBMS_SQLTUNE.UNPACK_STGTAB_SQLSET</code> or <code class="codeph">DBMS_SQLSET.UNPACK_STGTAB</code>.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-35D138E2-1E24-4911-921E-F73C2478EB96" title="Transporting SQL tuning sets between databases means copying the SQL tuning sets to and from a staging table, and then using other tools to move the staging table to the destination database. The most common tools are Oracle Data Pump or a database link.">About Transporting SQL Tuning Sets</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL95108"></a><div class="props_rev_3"><a id="GUID-5952CC2C-6D3B-47CE-A5B8-516B20DB3BFA" name="GUID-5952CC2C-6D3B-47CE-A5B8-516B20DB3BFA"></a><h5 id="TGSQL-GUID-5952CC2C-6D3B-47CE-A5B8-516B20DB3BFA" class="sect5"><span class="enumeration_section">23.6.1.2 </span>Basic Steps for Transporting SQL Tuning Sets When the CON_DBID Values Differ
                     </h5>
                     <div>
                        <p>When transporting an STS, you must remap the <code class="codeph">con_dbid</code> of each SQL statement in the STS when the <code class="codeph">con_dbid</code> of the source database and the destination database are different.
                        </p>
                        <p>Situations that cause the <code class="codeph">con_dbid</code> value to differ include the following:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A single-instance database whose instance has been restarted</p>
                           </li>
                           <li>
                              <p>Different instances of an Oracle RAC database</p>
                           </li>
                           <li>
                              <p>Different PDBs</p>
                           </li>
                           <li>
                              <p>A non-CDB and a CDB</p>
                           </li>
                        </ul>
                        <p>The basic steps for remapping are as follows:</p>
                        <ol>
                           <li>
                              <p>Pack the STS into a staging table using <code class="codeph">DBMS_SQLTUNE.PACK_STGTAB_SQLSET</code> or <code class="codeph">DBMS_SQLSET.PACK_STGTAB</code>.
                              </p>
                           </li>
                           <li>
                              <p>Remap each <code class="codeph">con_dbid</code> in the staging table using <code class="codeph">DBMS_SQLTUNE.REMAP_STGTAB_SQLSET</code> or <code class="codeph">DBMS_SQLSET.REMAP_STGTAB</code>.
                              </p>
                           </li>
                           <li>
                              <p>Export the STS.</p>
                           </li>
                           <li>
                              <p>Unpack the STS in the destination CDB.</p>
                           </li>
                        </ol>
                        <div class="example" id="GUID-5952CC2C-6D3B-47CE-A5B8-516B20DB3BFA__GUID-F0D849D0-1F44-42C7-A189-CD70BB61D441">
                           <p class="titleinexample">Example 23-1 Remapping a CON_DBID When Transporting an STS from a Non-CDB to a CDB</p>
                           <p>In this example, you intend to transport an STS named <code class="codeph">STS_for_transport</code> from a non-CDB to a CDB. On the source non-CDB, you have already packed the STS into source staging table <code class="codeph">src_stg_tbl</code> using the <code class="codeph">DBMS_SQLTUNE.PACK_STGTAB_SQLSET</code> procedure. The container ID of the destination CDB is <code class="codeph">12345</code>.
                           </p>
                           <p>In the source non-CDB, you execute the following commands:</p><pre class="pre codeblock"><code>VARIABLE con_dbid_src NUMBER;

EXEC SELECT UNIQUE con_dbid INTO :con_dbid_src FROM src_stg_tbl;

BEGIN
  DBMS_SQLTUNE.REMAP_STGTAB_SQLSET (
    staging_table_name   =&gt; 'src_stg_tbl'
,   staging_schema_owner =&gt; 'dba1'
,   old_sqlset_name      =&gt; 'STS_for_transport'
,   old_con_dbid         =&gt; :con_dbid_src
,   new_con_dbid         =&gt; 12345);
END;</code></pre><p>You can now export the contents of the staging table, and then continue using the normal transport procedure.</p>
                        </div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-5952CC2C-6D3B-47CE-A5B8-516B20DB3BFA__GUID-497250A0-F8BE-4CDC-B4B5-EB89B2215BB7">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS68438" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about <code class="codeph">REMAP_STGTAB_SQLSET</code></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-35D138E2-1E24-4911-921E-F73C2478EB96" title="Transporting SQL tuning sets between databases means copying the SQL tuning sets to and from a staging table, and then using other tools to move the staging table to the destination database. The most common tools are Oracle Data Pump or a database link.">About Transporting SQL Tuning Sets</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL537"></a><a id="TGSQL538"></a><a id="TGSQL536"></a><div class="props_rev_3"><a id="GUID-CD6EBF22-6A8B-4404-A155-A90FA16754C6" name="GUID-CD6EBF22-6A8B-4404-A155-A90FA16754C6"></a><h4 id="TGSQL-GUID-CD6EBF22-6A8B-4404-A155-A90FA16754C6" class="sect4"><span class="enumeration_section">23.6.2 </span>Transporting SQL Tuning Sets with DBMS_SQLTUNE
                  </h4>
                  <div>
                     <p>You can transport SQL tuning sets using three subprograms in the <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> package.
                     </p>
                     <div class="section">
                        <p>The following table describes the procedures relevant for transporting SQL tuning sets.</p>
                        <div class="tblformal" id="GUID-CD6EBF22-6A8B-4404-A155-A90FA16754C6__BEIDACDA">
                           <p class="titleintable">Table 23-6 Procedures for Transporting SQL Tuning Sets</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Procedures for Transporting SQL Tuning Sets" summary="This table describes procedures for transporting SQL tuning sets." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="32%" id="d116968e3255">DBMS_SQLTUNE Procedure</th>
                                    <th align="left" valign="bottom" width="34%" id="d116968e3258">Equivalent DBMS_SQLSET Procedure</th>
                                    <th align="left" valign="bottom" width="34%" id="d116968e3261">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d116968e3266" headers="d116968e3255 ">
                                       <p><code class="codeph">CREATE_STGTAB_SQLSET</code></p>
                                    </td>
                                    <td align="left" valign="top" width="34%" headers="d116968e3266 d116968e3258 ">
                                       <p><code class="codeph">CREATE_STGTAB</code></p>
                                    </td>
                                    <td align="left" valign="top" width="34%" headers="d116968e3266 d116968e3261 ">
                                       <p>Create a staging table to hold the exported SQL tuning sets</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d116968e3278" headers="d116968e3255 ">
                                       <p><code class="codeph">PACK_STGTAB_SQLSET</code></p>
                                    </td>
                                    <td align="left" valign="top" width="34%" headers="d116968e3278 d116968e3258 ">
                                       <p><code class="codeph">PACK_STGTAB</code></p>
                                    </td>
                                    <td align="left" valign="top" width="34%" headers="d116968e3278 d116968e3261 ">
                                       <p>Populate a staging table with SQL tuning sets</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="32%" id="d116968e3290" headers="d116968e3255 ">
                                       <p><code class="codeph">UNPACK_STGTAB_SQLSET</code></p>
                                    </td>
                                    <td align="left" valign="top" width="34%" headers="d116968e3290 d116968e3258 ">
                                       <p><code class="codeph">UNPACK_STGTAB</code></p>
                                    </td>
                                    <td align="left" valign="top" width="34%" headers="d116968e3290 d116968e3261 ">
                                       <p>Copy the SQL tuning sets from the staging table into a database</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CD6EBF22-6A8B-4404-A155-A90FA16754C6__GUID-E3FC2E60-3F24-4DB4-8533-00E14439DB06">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>An STS with regressed SQL resides in a production database created in the current release.</p>
                           </li>
                           <li>
                              <p>You run SQL Performance Analyzer trials on a remote test database created in <span>Oracle Database 11g</span> Release 2 (11.2).
                              </p>
                           </li>
                           <li>
                              <p>You want to copy the STS from the production database to the test database and tune the regressions from the SQL Performance Analyzer trials.</p>
                           </li>
                           <li>
                              <p>You want to use Oracle Database Pump to transfer the SQL tuning sets between database hosts.</p>
                           </li>
                           <li>
                              <p>You use <code class="codeph">DBMS_SQLTUNE</code> rather than <code class="codeph">DBMS_SQLSET</code>.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CD6EBF22-6A8B-4404-A155-A90FA16754C6__GUID-AFE7C8FB-2D34-4B42-BB7D-D842BA65DE4C">To transport an STS:</p>
                        <ol>
                           <li>
                              <p>In SQL*Plus or SQL Developer, log in to the database as a user with administrative privileges.</p>
                           </li>
                           <li>
                              <p>Use the <code class="codeph">CREATE_STGTAB_SQLSET</code> procedure to create a staging table to hold the exported SQL tuning sets.
                              </p>
                              <p>The following example creates <code class="codeph">my_11g_staging_table</code> in the <code class="codeph">dba1</code> schema and specifies the format of the staging table as 11.2:
                              </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.CREATE_STGTAB_SQLSET ( 
    table_name  =&gt; 'my_10g_staging_table'
,   schema_name =&gt; 'dba1'
,   db_version  =&gt; DBMS_SQLTUNE.STS_STGTAB_11_2_VERSION 
);
END;
/
</code></pre></li>
                           <li>
                              <p>Use the <code class="codeph">PACK_STGTAB_SQLSET</code> procedure to populate the staging table with SQL tuning sets.
                              </p>
                              <p>The following example populates <code class="codeph">dba1.my_11g_staging_table</code> with the STS <code class="codeph">my_sts</code> owned by <code class="codeph">hr</code>:
                              </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.PACK_STGTAB_SQLSET (      
    sqlset_name         =&gt; 'sqlt_wkld_sts'
,   sqlset_owner        =&gt; 'sh'
,   staging_table_name  =&gt; 'my_11g_staging_table'
,   staging_schema_owner =&gt; 'dba1'
,   db_version          =&gt; DBMS_SQLTUNE.STS_STGTAB_11_2_VERSION 
);
END;
/ 
</code></pre></li>
                           <li>
                              <p>If necessary, remap the container ID values for the statements in the STS as described in <span class="q">"<a href="managing-sql-tuning-sets.html#GUID-5952CC2C-6D3B-47CE-A5B8-516B20DB3BFA" title="When transporting an STS, you must remap the con_dbid of each SQL statement in the STS when the con_dbid of the source database and the destination database are different.">Basic Steps for Transporting SQL Tuning Sets When the CON_DBID Values Differ</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p>Use Oracle Data Pump to export the contents of the staging table.</p>
                              <p>For example, run the <code class="codeph">expdp</code> command at the operating system prompt:
                              </p><pre class="pre codeblock"><code>expdp dba1 DIRECTORY=dpump_dir1 DUMPFILE=sts.dmp TABLES=my_11g_staging_table
</code></pre></li>
                           <li>
                              <p>Transfer the dump file to the test database host.</p>
                           </li>
                           <li>
                              <p>Log in to the test host as an administrator, and then use Oracle Data Pump to import the contents of the staging table.</p>
                              <p>For example, run the <code class="codeph">impdp</code> command at the operating system prompt:
                              </p><pre class="pre codeblock"><code>impdp dba1 DIRECTORY=dpump_dir1 DUMPFILE=sts.dmp TABLES=my_11g_staging_table 
</code></pre></li>
                           <li>
                              <p>On the test database, execute the <code class="codeph">UNPACK_STGTAB_SQLSET</code> procedure to copy the SQL tuning sets from the staging table into the database.
                              </p>
                              <p>The following example shows how to unpack the SQL tuning sets:</p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.UNPACK_STGTAB_SQLSET (
    sqlset_name        =&gt; '%'
,   replace            =&gt; true
,   staging_table_name =&gt; 'my_11g_staging_table');
END;
/</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-CD6EBF22-6A8B-4404-A155-A90FA16754C6__GUID-21EAE563-510A-4CA3-9DC0-BA1BFE4CB085">
                        <p class="notep1">See Also:</p>
                        <p> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS68412" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about <code class="codeph">DBMS_SQLTUNE.UNPACK_STGTAB_SQLSET</code></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-E6F9F020-6257-4456-A568-8BF4CC1FFF7C" title="You can transport an STS to any database created in Oracle Database 10g Release 2 (10.2) or later. This technique is useful when using SQL Performance Analyzer to tune regressions on a test database.">Transporting a SQL Tuning Set</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL94886"></a><a id="TGSQL94887"></a><a id="TGSQL539"></a><div class="props_rev_3"><a id="GUID-493FA794-EF69-464D-BB6F-C8CF06686023" name="GUID-493FA794-EF69-464D-BB6F-C8CF06686023"></a><h3 id="TGSQL-GUID-493FA794-EF69-464D-BB6F-C8CF06686023" class="sect3"><span class="enumeration_section">23.7 </span>Dropping a SQL Tuning Set
               </h3>
               <div>
                  <p>To drop an STS from the database, use the <code class="codeph">DROP_SQLSET</code> procedure in the <code class="codeph">DBMS_SQLTUNE</code> or <code class="codeph">DBMS_SQLSET</code> package.
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-493FA794-EF69-464D-BB6F-C8CF06686023__GUID-B5D705F8-D357-40C0-8674-2AA8CB8CE949">Prerequisites</p>
                     <p>Ensure that no tuning task is currently using the STS to be dropped. If an existing tuning task is using this STS, then drop the task before dropping the STS. Otherwise, the database issues an <code class="codeph">ORA-13757</code> error.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-493FA794-EF69-464D-BB6F-C8CF06686023__GUID-67FEC71A-A25B-469A-A400-624F317A172A">Assumptions</p>
                     <p>This tutorial assumes the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You want to drop an STS named <code class="codeph">SQLT_WKLD_STS</code>.
                           </p>
                        </li>
                        <li>
                           <p>You use <code class="codeph">DBMS_SQLTUNE</code> instead of <code class="codeph">DBMS_SQLSET</code>.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-493FA794-EF69-464D-BB6F-C8CF06686023__GUID-A2DBE305-DDE7-44C3-9F1F-8B0741253FA0">To drop an STS:</p>
                     <ol>
                        <li>
                           <p>In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                        </li>
                        <li>
                           <p>Use the <code class="codeph">DBMS_SQLTUNE.DROP_SQLSET</code> procedure.
                           </p>
                           <p>For example, execute the following PL/SQL program:</p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQLTUNE.DROP_SQLSET( sqlset_name =&gt; 'SQLT_WKLD_STS' );
END;
/
</code></pre></li>
                        <li>
                           <p>Optionally, confirm that the STS was deleted.</p>
                           <p>The following example counts the number of SQL tuning sets named <code class="codeph">SQLT_WKLD_STS</code> owned by the current user (sample output included):
                           </p><pre class="pre codeblock"><code>SELECT COUNT(*) 
FROM   USER_SQLSET 
WHERE  NAME = 'SQLT_WKLD_STS';

  COUNT(*)
----------
         0</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-493FA794-EF69-464D-BB6F-C8CF06686023__GUID-0D2CC086-518D-43DD-AD9F-FC9AB2E7EAF1">
                     <p class="notep1">See Also:</p>
                     <p><a href="../arpls/DBMS_SQLTUNE.html#ARPLS68420" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the STS procedures in <code class="codeph">DBMS_SQLTUNE</code></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-sql-tuning-sets.html#GUID-91D1B886-A6D7-40B8-93D5-112B8C6E6AFE" title="You can use SQL tuning sets to group statements and related metadata into a single object, which you can use as input to SQL tuning tools.">Managing SQL Tuning Sets</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>