<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>DENSE_RANK</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Language Reference ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Language Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-language-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T15:36:36-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96310-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="DECOMPOSE.html" title="Previous" type="text/html">
      <link rel="next" href="DEPTH.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Language Reference">
    <meta name="dcterms.isVersionOf" content="SQLRF">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="DECOMPOSE.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="DEPTH.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Language Reference </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="Functions.html" property="item" typeof="WebPage"><span property="name">Functions</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">DENSE_RANK </li>
            </ol>
            <a id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE" name="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE"></a><a id="SQLRF51360"></a><a id="SQLRF51361"></a><a id="SQLRF51362"></a><a id="SQLRF51363"></a><a id="SQLRF51364"></a><a id="SQLRF51365"></a><a id="SQLRF51366"></a><a id="SQLRF00633"></a>
            
            <h2 id="SQLRF-GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE" class="sect2">DENSE_RANK </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-CC075663-05F8-4790-9825-C08A741A1F97">Aggregate Syntax</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-51F29FB2-36C1-4D57-B558-3359AE51341E"><span class="italic">dense_rank_aggregate</span>::=
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="figure" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-74E927B0-8C30-4F1C-AAC5-9F5474B8C707"><img src="img/dense_rank_aggregate.gif" alt="Description of dense_rank_aggregate.eps follows" title="Description of dense_rank_aggregate.eps follows" longdesc="img_text/dense_rank_aggregate.html"><br><a href="img_text/dense_rank_aggregate.html">Description of the illustration dense_rank_aggregate.eps</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-0C7B2010-AE1B-4EE8-9705-285C574E7727">Analytic Syntax</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-8ECBF6CB-B86B-402E-A09F-6471696F1E6D"><span class="italic">dense_rank_analytic</span>::=
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="figure" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-5B7FCBF3-C7CC-4838-B300-E68C9FA12D71"><img src="img/dense_rank_analytic.gif" alt="Description of dense_rank_analytic.eps follows" title="Description of dense_rank_analytic.eps follows" longdesc="img_text/dense_rank_analytic.html"><br><a href="img_text/dense_rank_analytic.html">Description of the illustration dense_rank_analytic.eps</a></div>
                  <!-- class="figure" -->
                  <div class="infoboxnotealso" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-B275F2D1-911A-4725-92BD-024CFF991784">
                     <p class="notep1">See Also:</p>
                     <p><a href="Analytic-Functions.html#GUID-527832F7-63C0-4445-8C16-307FA5084056">Analytic Functions</a> for information on syntax, semantics, and restrictions
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-24F66A0E-1026-42B2-91FF-10D305805513">Purpose</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p><a id="d118003e164" class="indexterm-anchor"></a><a id="d118003e166" class="indexterm-anchor"></a><code class="codeph">DENSE_RANK</code> computes the rank of a row in an ordered group of rows and returns the rank as a <code class="codeph">NUMBER</code>. The ranks are consecutive integers beginning with 1. The largest rank value is the number of unique values returned by the query. Rank values are not skipped in the event of ties. Rows with equal values for the ranking criteria receive the same rank. This function is useful for top-N and bottom-N reporting.
                  </p>
                  <p>This function accepts as arguments any numeric data type and returns <code class="codeph">NUMBER</code>.
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>As an aggregate function, <code class="codeph">DENSE_RANK</code> calculates the dense rank of a hypothetical row identified by the arguments of the function with respect to a given sort specification. The arguments of the function must all evaluate to constant expressions within each aggregate group, because they identify a single row within each group. The constant argument expressions and the expressions in the <span class="italic"><code class="codeph">order_by_clause</code></span> of the aggregate match by position. Therefore, the number of arguments must be the same and types must be compatible.
                        </p>
                     </li>
                     <li>
                        <p>As an analytic function, <code class="codeph">DENSE_RANK</code> computes the rank of each row returned from a query with respect to the other rows, based on the values of the <span class="italic"><code class="codeph">value_exprs</code></span> in the <span class="italic"><code class="codeph">order_by_clause</code></span>. 
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-4CB97BDD-D2A7-48FF-8920-006785457EE5">
                     <p class="notep1">See Also:</p>
                     <p>Appendix C in <a href="../nlspg/appendix-C-collation-derivation-and-determination-rules-for-SQL-operations.html#NLSPG-GUID-AFCE41ED-775B-4A00-AF38-C436776AE0C5" target="_blank"><span><cite>Oracle Database Globalization Support Guide</cite></span></a> for the collation determination rules, which define the collation <code class="codeph">DENSE_RANK</code> uses to compare character values for the <code class="codeph">ORDER</code> <code class="codeph">BY</code> clause
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-D0AC5B27-7F83-4775-A745-AB753F97144A">Aggregate Example</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>The following example computes the ranking of a hypothetical employee with the salary $15,500 and a commission of 5% in the sample table <code class="codeph">oe.employees</code>:
                  </p><pre class="oac_no_warn" dir="ltr">SELECT DENSE_RANK(15500, .05) WITHIN GROUP 
  (ORDER BY salary DESC, commission_pct) "Dense Rank" 
  FROM employees;

Dense Rank
----------
         3</pre></div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE__GUID-A8398AFA-59D0-4206-8A4B-318FAC3DB270">Analytic Example</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>The following statement ranks the employees in the sample <code class="codeph">hr</code> schema in department 60 based on their salaries. Identical salary values receive the same rank. However, no rank values are skipped. Compare this example with the analytic example for <a href="RANK.html#GUID-0950BD34-C994-41DA-A8F9-34B3FE53BBBA">RANK</a>.
                  </p><pre class="oac_no_warn" dir="ltr">SELECT department_id, last_name, salary,
       DENSE_RANK() OVER (PARTITION BY department_id ORDER BY salary) DENSE_RANK
  FROM employees WHERE department_id = 60
  ORDER BY DENSE_RANK, last_name;
 
DEPARTMENT_ID LAST_NAME                     SALARY DENSE_RANK
------------- ------------------------- ---------- ----------
           60 Lorentz                         4200          1
           60 Austin                          4800          2
           60 Pataballa                       4800          2
           60 Ernst                           6000          3
           60 Hunold                          9000          4</pre></div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>