<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture.">
      <meta name="description" content="To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture.">
      <title>Manual Upgrade Scenarios for Multitenant Architecture Oracle Databases</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database Upgrade Guide">
      <meta property="og:description" content="To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database Upgrade Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-upgrade-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-04-25T08:26:31-07:00">
      <meta name="dcterms.title" content="Database Upgrade Guide">
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96252-05">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="example-manual-upgrade-windows-non-cdb-11203-to-122.html" title="Previous" type="text/html">
      <link rel="next" href="improvements-data-dictionary-upgrade-and-upgrade-status-displays.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="UPGRD">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="example-manual-upgrade-windows-non-cdb-11203-to-122.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="improvements-data-dictionary-upgrade-and-upgrade-status-displays.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database Upgrade Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="upgrading-oracle-database.html" property="item" typeof="WebPage"><span property="name">Upgrading Oracle Database</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Manual Upgrade Scenarios for Multitenant Architecture Oracle Databases</li>
            </ol>
            <a id="GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD" name="GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD"></a><a id="UPGRD60130"></a>
            
            <h2 id="UPGRD-GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD" class="sect2">Manual Upgrade Scenarios for Multitenant Architecture Oracle Databases</h2>
         </header>
         <div class="ind">
            <div>
               <p>To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture. </p>
               <p>Starting with Oracle Database 12<span class="italic">c</span>, multitenant architecture enables Oracle Database deployments using multitenant container databases (CDB) that contain pluggable databases (PDBs). All Oracle Database releases earlier than Oracle Database 12<span class="italic">c</span> release 1 (12.1.0.1) use non-CDB architecture.
               </p>
               <div class="infoboxnote" id="GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD__GUID-EF4B9AAA-F549-4320-BCE2-3C550511A308">
                  <p class="notep1">Caution:</p>
                  <p>You cannot downgrade a database after you have set the compatible initialization parameter to 12.1.0.2 or later releases. A downgrade is possible for a pluggable database (PDB) only if the compatibility is set to 12.1.0.1. There can still be restrictions on downgrading. </p>
                  <p>Oracle strongly recommends that you upgrade your source and target databases to the most recent bundle patch set update (BP, PSU) before starting an upgrade, and before starting a downgrade. </p>
               </div>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-2424F203-D586-459E-9BC5-5332800A7D2F">About Oracle Multitenant Oracle Database Upgrades</a><br>You can upgrade Oracle Databases installed on multitenant architecture either in parallel, or in sequence. 
                  </li>
                  <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-553F6F33-84AD-4601-868C-2860EC6D69E9">Coordinate Upgrades of Proxy PDBs with Multitenant Upgrades</a><br>Coordinate upgrades of the CDB so that proxy PDB and PDB targets are the same version.
                  </li>
                  <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B">Manually Upgrading a Multitenant Container Oracle Database (CDB)</a><br>The procedure in this section provides steps for upgrading a CDB manually using a command-line procedure.
                  </li>
                  <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-6471F9F4-5151-4FA3-B5EC-B5AEBD99B0AA">About Upgrading PDBs Using the Parallel Upgrade Utility with Priority Lists</a><br>In Oracle Database 12.2 and later releases, you can upgrade PDBs using a priority list to upgrade a set of PDBs ahead of other PDBs, and you can modify that upgrade priority. 
                  </li>
                  <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F">About PDB Upgrades Using Priority Lists, Inclusion Lists, and Exclusion Lists</a><br>Starting in Oracle Database 12<span class="italic">c</span> release 2 (12.2), you can use inclusion and exclusion lists with priority lists to control how your PDBs are upgraded.
                  </li>
                  <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-4CA89342-971B-447C-A643-9638DE4EB121">Upgrading Multitenant Architecture In Parallel</a><br>Use this technique to upgrade multitenant architecture Oracle Database releases (Oracle Database 12c Release 1 (12.1.0.1) and later by upgrading container databases (CDBs), and then upgrading multiple pluggable databases (PDBs) in parallel.
                  </li>
                  <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8F9AAFA1-690D-4F70-8448-E66D765AF136">Upgrading Multitenant Architecture Sequentially Using Unplug-Plug</a><br>To upgrade pluggable databases (PDBs) that are in an earlier release multitenant container databases (CDBs), Oracle Database Release 12<span class="italic">c</span> (12.1.0.1) and later, you can unplug the PDBs from the earlier release CDB, and plug the PDBs into the later release CDB.
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD__GUID-714CC914-140F-491C-87E5-D1246AF5773E">
                  <p class="notep1">See Also:</p>
                  <p> <a href="../multi/introduction-to-the-multitenant-architecture.html#CNCPT89234" target="_blank"><span class="italic">Oracle Database Concepts</span></a> for an overview of multitenant architecture
                  </p>
                  <p><a href="../multi/creating-and-configuring-a-cdb.html#ADMIN13514" target="_blank"><span class="italic">Oracle Database Administrator's Guide</span></a> for complete information about creating and configuring a CDB
                  </p>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="upgrading-oracle-database.html#GUID-CC88F262-3370-4FFA-8604-EDA9F20F56D9" title="Oracle provides a comprehensive set of tools for upgrading Oracle Database with minimal downtime and for migrating your applications to the new release.">Upgrading Oracle Database</a></p>
                  </div>
               </div>
            </div>
            
            <div class="props_rev_3"><a id="GUID-2424F203-D586-459E-9BC5-5332800A7D2F" name="GUID-2424F203-D586-459E-9BC5-5332800A7D2F"></a><h3 id="UPGRD-GUID-2424F203-D586-459E-9BC5-5332800A7D2F" class="sect3">About Oracle Multitenant Oracle Database Upgrades</h3>
               <div>
                  <p>You can upgrade Oracle Databases installed on multitenant architecture either in parallel, or in sequence. </p>
                  <p>Starting with Oracle Database 12c release 1 (12.1), Oracle provided multitenant architecture, which enables the creation and administration of pluggable databases (PDBs) in a container database (CDB). You can upgrade multitenant architecture systems using either Oracle Database Upgrade Assistant (DBUA), or using the Parallel Upgrade Utility to carry out manual upgrades. </p>
                  <p>There are two techniques for upgrading Oracle Databases using the multitenant architecture:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="bold">In parallel</span>. With this technique, you carry out one upgrade operation that upgrades the CDB, and then upgrades the PDBs in parallel. 
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Sequentially</span>. With this technique, you install a new release CDB, prepare and unplug PDBs from the earlier release CDB, plug the PDBs into a later release CDB, and then complete the upgrade for each PDB.
                        </p>
                     </li>
                  </ul>
                  <p>The following sections provide a high-level summary of each upgrade technique.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-2424F203-D586-459E-9BC5-5332800A7D2F__GUID-37280374-6ED9-402F-A277-9F752E506F85">Upgrading Oracle Multitenant In Parallel</p>
                     <p>With the In Parallel technique, you first upgrade <code class="codeph">CDB$ROOT</code> using the Parallel Upgrade Utility (<code class="codeph">catctl.pl</code>), using parameters to set the degree of parallel processing and availability:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The <code class="codeph">-n</code> parameter defines how many parallel processes run the upgrade, up to 8. 
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">-M</code> parameter determines if the <code class="codeph">CDB$ROOT</code> stays in <code class="codeph">UPGRADE</code> mode through the entire upgrade, or becomes available for access after the CDB upgrade is complete. If you do not run the upgrade with the <code class="codeph">-M</code> parameter, then when the <code class="codeph">CDB$ROOT</code> upgrade is complete, PDBs then become available for access as soon as each PDB completes its upgrade. If you run the upgrade with the <code class="codeph">&#x2013;M</code> parameter, then <code class="codeph">CDB$ROOT</code> stays in <code class="codeph">UPGRADE</code> mode, and PDBs do not become available until upgrade of all PDBs is complete.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-2424F203-D586-459E-9BC5-5332800A7D2F__GUID-2F525046-63CA-4843-92A7-7D028B36DFE5">Upgrading Oracle Multitenant In Sequence</p>
                     <p>With the In Sequence technique, you install the new release multitenant architecture CDB. Next, in the earlier release multitenant architecture CDB, you issue SQL commands to run preupgrade scripts to prepare one or more PDBs to upgrade, and shut them down. You then unplug PDBs, plug them into the new release multenant architecture CDB, and complete the upgrade sequentially for each PDB. </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD" title="To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture.">Manual Upgrade Scenarios for Multitenant Architecture Oracle Databases</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-553F6F33-84AD-4601-868C-2860EC6D69E9" name="GUID-553F6F33-84AD-4601-868C-2860EC6D69E9"></a><h3 id="UPGRD-GUID-553F6F33-84AD-4601-868C-2860EC6D69E9" class="sect3">Coordinate Upgrades of Proxy PDBs with Multitenant Upgrades</h3>
               <div>
                  <p>Coordinate upgrades of the CDB so that proxy PDB and PDB targets are the same version.</p>
                  <p>During upgrades, upgrade of a Proxy PDB does not upgrade its corresponding target PDB. Upgrade of the target PDB has to be done separately.</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD" title="To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture.">Manual Upgrade Scenarios for Multitenant Architecture Oracle Databases</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD12408"></a><div class="props_rev_3"><a id="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B" name="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B"></a><h3 id="UPGRD-GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B" class="sect3">Manually Upgrading a Multitenant Container Oracle Database (CDB)</h3>
               <div>
                  <p>The procedure in this section provides steps for upgrading a CDB manually using a command-line procedure.</p>
                  <div class="section">
                     <p>You must complete the following steps before using this procedure:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Install the new release software for Oracle Database </p>
                        </li>
                        <li>
                           <p>Prepare the new Oracle home</p>
                        </li>
                        <li>
                           <p> Run the Pre-Upgrade Information Tool</p>
                        </li>
                     </ul>
                     <p>Oracle Database 12c introduced multitenant architecture, which enables Oracle Database to function as a multitenant container database (CDB) with pluggable databases. You can upgrade the CDB using DBUA, and in the process, upgrade all the pluggable databases attached to the CDB at the same time. Or, after you install the software for Oracle Database and prepare the new Oracle home, you can proceed with a manual, command-line upgrade.</p>
                     <ol>
                        <li>
                           <p>If you have not done so, run the Pre-Upgrade Information Tool. Review the Pre-Upgrade Information tool output and correct all issues noted in the output before proceeding.</p>
                        </li>
                        <li>
                           <p>Back up the source database.</p>
                        </li>
                        <li>
                           <p>If you have not done so, prepare the new Oracle home.</p>
                        </li>
                        <li>
                           <p>(Conditional) For Oracle RAC environments only, enter the following commands to set the initialization parameter value for CLUSTER_DATABASE to FALSE: </p><pre class="pre codeblock"><code>ALTER SYSTEM SET CLUSTER_DATABASE=FALSE SCOPE=SPFILE;</code></pre><p>Restart the database after changing the <span class="parmname" translate="no">CLUSTER_DATABASE</span> parameter. 
                           </p>
                        </li>
                        <li>
                           <p>Shut down the database. (The syntax is the same for a non-CDB and a CDB.)</p><pre class="pre codeblock"><code>SQL&gt; SHUTDOWN IMMEDIATE
</code></pre><div class="infoboxnote" id="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B__GUID-3DE49F19-CA51-49F7-AE3B-1D186A37A6D0">
                              <p class="notep1">Note:</p>
                              <p>To close a PDB, you can specify it from the CDB root: <code class="codeph">alter pluggable database <span class="variable" translate="no">PDBname</span> close</code>.
                              </p>
                           </div>
                        </li>
                        <li>
                           <p>If your operating system is Windows, then complete the following steps:</p>
                           <ol type="a">
                              <li>
                                 <p>Stop the <code class="codeph">OracleService <span class="variable" translate="no">SID</span></code> Oracle service of the database you are upgrading, where <code class="codeph"><span class="variable" translate="no">SID</span></code> is the instance name. For example, if your <code class="codeph"><span class="variable" translate="no">SID</span></code> is <code class="codeph">ORCL</code>, then enter the following at a command prompt:
                                 </p><pre class="pre codeblock"><code>C:\&gt; NET STOP OracleServiceORCL</code></pre></li>
                              <li>
                                 <p>Delete the Oracle service at a command prompt using <code class="codeph">ORADIM</code>. 
                                 </p>
                                 <p>If your <code class="codeph"><span class="variable" translate="no">SID</span></code> is <code class="codeph">ORCL</code>, then enter the following command, substituting your SID for <code class="codeph"><span class="variable" translate="no">SID</span></code>.
                                 </p><pre class="oac_no_warn" dir="ltr">C:\&gt; ORADIM -DELETE -<span class="variable" translate="no">SID</span> ORCL
</pre></li>
                              <li>
                                 <p>Create the service for the new release Oracle Database at a command prompt using the <code>ORADIM</code> command of the new Oracle Database release. 
                                 </p>
                                 <p>For example:</p><pre class="pre codeblock"><code>C:\&gt; ORADIM -NEW -SID <span class="variable" translate="no">SID</span> -SYSPWD <span class="variable" translate="no">PASSWORD</span> -MAXUSERS <span class="variable" translate="no">USERS</span>
     -STARTMODE AUTO -PFILE <span class="variable" translate="no">ORACLE_HOME</span>\DATABASE\INIT<span class="variable" translate="no">SID</span>.ORA
</code></pre><p>Most Oracle Database services log on to the system using the privileges of the Oracle Home User. The service runs with the privileges of this user. The <code>ORADIM</code> command prompts you for the password to this user account. You can specify other options using <code>ORADIM</code>.
                                 </p>
                                 <p>In this example, if your <code class="codeph"><span class="variable" translate="no">SID</span> value</code> is <code class="codeph">ORCL</code>, your <code class="codeph"><span class="variable" translate="no">password</span></code> (<code class="codeph">SYSPWD</code>) value is <code class="codeph">TWxy5791</code>, the maximum number of users (<code class="codeph">MAXUSERS</code>) value is 10, and the Oracle home path is <code class="codeph">C:\ORACLE\PRODUCT\19.1.0\DB</code>, then enter the following command:
                                 </p><pre class="pre codeblock"><code>C:\&gt; ORADIM -NEW -SID ORCL -SYSPWD TWxy5791 -MAXUSERS 10
-STARTMODE AUTO -PFILE C:\ORACLE\PRODUCT\19.1.0\DB\DATABASE\INITORCL.ORA
</code></pre><p><code>ORADIM</code> writes a log file to the <code>ORACLE_HOME\database</code> directory. The log file contains the name of the PDB in the multitenant database.
                                 </p>
                              </li>
                           </ol>
                        </li>
                        <li>
                           <p>If your operating system is Linux or UNIX, then perform the following checks:</p>
                           <ol type="a">
                              <li>
                                 <p>Your <code class="codeph">ORACLE_SID</code> is set correctly
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">oratab</code> file points to the Oracle home for Oracle Database 12<span class="italic">c</span></p>
                              </li>
                              <li>
                                 <p>The following environment variables point to the Oracle Database 12c directories:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><code class="codeph">ORACLE_HOME</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">PATH</code></p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Any scripts that clients use to set <code class="codeph">$ORACLE_HOME</code> environment variable must point to the new Oracle home.
                                 </p>
                              </li>
                           </ol>
                           <div class="infoboxnote" id="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B__GUID-0585BC8F-BAC1-4773-8348-ABA318F429F3">
                              <p class="notep1">Note:</p>
                              <p>If you are upgrading an Oracle Real Application Clusters database, then perform these checks on all nodes where the Oracle Real Application Clusters database has instances configured.</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B__GUID-54C029BB-B323-481B-BD77-0DCD6AD07D41">
                              <p class="notep1">See Also:</p>
                              <p>Oracle Database and Oracle Clusterware installation guides for information about setting other important environment variables on your operating system</p>
                           </div>
                        </li>
                        <li>
                           <p>Log in to the system as the owner of the Oracle home under the new Oracle Database release.</p>
                        </li>
                        <li>
                           <p>Start SQL*Plus in the new Oracle home from the path <code class="codeph"><span class="variable" translate="no">Oracle_home</span>/rdbms/admin</code> directory.
                           </p>
                           <p>For example:</p><pre class="pre codeblock"><code>$ cd $ORACLE_HOME/rdbms/admin
$ pwd
/u01/app/oracle/product/19.0.0/dbhome_1/rdbms/admin
$ sqlplus</code></pre><p>On Windows platforms, to access SQL*Plus, change directory to <code class="codeph">%ORACLE_HOME%/bin</code></p>
                        </li>
                        <li>
                           <p>Connect to the database that you want to upgrade using an account with SYSDBA privileges:</p><pre class="pre codeblock"><code>SQL&gt; CONNECT / AS SYSDBA
</code></pre></li>
                        <li>
                           <p>Start the CDB in upgrade mode: </p><pre class="pre codeblock"><code>SQL&gt; startup upgrade</code></pre></li>
                        <li id="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B__I1012182">
                           <p>Start the instance by issuing the following command in SQL*Plus:</p><pre class="pre codeblock"><code>SQL&gt; alter pluggable database all open upgrade;
</code></pre><p>If errors appear listing desupported initialization parameters, then make a note of the desupported initialization parameters and continue with the upgrade. Remove the desupported initialization parameters the next time you shut down the database.</p>
                           <div class="infoboxnote" id="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B__GUID-0C72C88B-7D9A-4308-9EEF-4F3C6C3FB1C7">
                              <p class="notep1">Note:</p>
                              <p>Starting up the database in <code class="codeph">UPGRADE</code> mode does the following:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Starts up the database with a new version of the Oracle Database instance</p>
                                 </li>
                                 <li>
                                    <p>Restricts logins to SYSDBA</p>
                                 </li>
                                 <li>
                                    <p>Disables system triggers</p>
                                 </li>
                                 <li>
                                    <p>Performs additional operations that prepare the database for upgrades</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p>Exit SQL*Plus before proceeding to the next step.</p>
                           <p>For example:</p><pre class="pre codeblock"><code>SQL&gt; EXIT</code></pre></li>
                        <li>
                           <p>To upgrade an entire CDB, run the Parallel Upgrade Utility (<code>catctl.pl</code>) from the new Oracle home. The Parallel Upgrade Utility provides parallel upgrade options that reduce downtime. You can run the command by using the command-line script <code>dbupgrade</code> from the new Oracle home.
                           </p>
                           <p>For example:</p>
                           <p>Linux:</p><pre class="pre codeblock"><code>cd $ORACLE_HOME/bin
./dbupgrade 
</code></pre><p>Windows:</p><pre class="pre codeblock"><code>cd %ORACLE_HOME%\bin
dbupgrade 
</code></pre><div class="infoboxnote" id="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B__GUID-B951FD5A-3870-4D4A-9054-BE70F095849F">
                              <p class="notep1">Note:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Use the <code class="codeph">-d</code> option to specify the directory that contains the files that you want to process. Use the <code class="codeph">-l</code> option to specify the directory that you want to use for spool log files. 
                                    </p>
                                 </li>
                                 <li>
                                    <p>If you are upgrading an entire CDB, and there are errors in <code class="codeph">CDB$ROOT</code>, then the upgrade aborts.
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p>To upgrade a subset of PDBs within a CDB, specify either an inclusion list, or an exclusion list.</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>This example for a Linux or UNIX system uses an inclusion list to upgrade <code class="codeph">PDB1</code> only:
                                 </p><pre class="pre codeblock"><code>cd $ORACLE_HOME/bin
./dbupgrade -c 'PDB1' 
</code></pre></li>
                              <li>
                                 <p>This example for a Windows system uses an exclusion list to upgrade everything in the CDB except <code class="codeph">PDB1</code>:
                                 </p><pre class="pre codeblock"><code>cd $ORACLE_HOME\bin
dbupgrade -C "PDB1" </code></pre></li>
                           </ul>
                           <div class="infoboxnote" id="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B__GUID-68D857C4-F8B5-4EAB-8347-56DC18BD5DE8">
                              <p class="notep1">Note:</p>
                              <p>You can upgrade an individual PDB by unplugging it from the earlier release CDB, and plugging it into a later release CDB. </p>
                              <p>For Windows, when you run the <code>dbupgrade</code> command with the inclusion (<code class="codeph">-c</code>) or the exclusion (<code class="codeph">-C</code>) options, you must specify the option with quotes around the CDB root name and PDB seed name.
                              </p>
                              <p>For example:</p>
                              <p>... <code class="codeph">-C "CDB$ROOT PDB$SEED"</code></p>
                           </div>
                        </li>
                        <li>
                           <p>For CDBs, log in to the CDB as SYSDBA and run the command alter pluggable database all open to make databases available for recompiling code. For example:</p><pre class="pre codeblock"><code>$ sqlplus / as sysdba

SQL&gt; alter pluggable database all open;</code></pre></li>
                        <li>
                           <p>Run <code>catcon.pl</code>. This command starts <code>utlrp.sql</code> and recompiles any remaining stored PL/SQL and Java code. 
                           </p>
                           <p>For example:</p><pre class="pre codeblock"><code>$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlrp -d '''.''' utlrp.sql
</code></pre><p>Because you run the command using <code class="codeph">-b utlrp0</code>, the log file <code class="codeph">utlrp0.log</code> is generated with the recompile results. 
                           </p>
                        </li>
                        <li>
                           <p>Run <code>postupgrade_fixups.sql</code>. 
                           </p>
                           <p>For example:</p><pre class="pre codeblock"><code>$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b postupgrade_fixups -d '''.''' postupgrade_fixups.sql</code></pre></li>
                        <li>
                           <p>Run <code>utlusts.sql</code>. This command verifies that all issues are fixed.
                           </p>
                           <p>For example, in a CDB:</p><pre class="pre codeblock"><code>$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlu122s -d '''.''' utlusts.sql
</code></pre><p>Because you run the command using <code class="codeph">-b utlu122s</code>, the log file <code class="codeph">utlu122s0.log</code> is generated with the upgrade results. You can review the <code class="codeph">upg_summary.log</code> file to review the upgrade report.
                           </p>
                           <p>To see information about the state of the database, run <code>utlusts.sql</code> as many times as you want, at any time after you complete the upgrade. If the <code>utlusts.sql</code> script returns errors, or if it shows components that are not marked as <code class="codeph">VALID</code>, or if the SQL script you run is not from the most recent release, then refer to the troubleshooting section in this guide.
                           </p>
                        </li>
                        <li>
                           <p>Ensure that the time zone data files are current by using the <code class="codeph">DBMS_DST</code> PL/SQL package to upgrade the time zone file. You can also update the time zone after the upgrade. If you update the time zone, then you must update the time zone in both <code class="codeph">CDB$ROOT</code> and the PDBs.
                           </p>
                        </li>
                        <li>
                           <p>Exit SQL*Plus.</p>
                           <p>For example:</p><pre class="pre codeblock"><code>SQL&gt; EXIT</code></pre></li>
                        <li>
                           <p>(Conditional) If you are upgrading an Oracle Real Application Clusters database, then use the following command syntax to upgrade the database configuration in Oracle Clusterware:</p><pre class="pre codeblock"><code>$ srvctl upgrade database -db <span class="variable" translate="no">db-unique-name</span> -oraclehome <span class="variable" translate="no">oraclehome</span></code></pre><p>In this example, <code class="codeph"><span class="variable" translate="no">db-unique-name</span></code> is the assigned database name (not the instance name), and <code class="codeph"><span class="variable" translate="no">oraclehome</span></code> is the Oracle home location in which the database is being upgraded. The <code>SRVCTL</code> utility supports long GNU-style options, in addition to the short CLI options used in earlier releases.
                           </p>
                        </li>
                     </ol>
                     <p>Your database is now upgraded. You are ready to complete post-upgrade procedures. </p>
                     <div class="infoboxnote" id="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B__GUID-ACC577D0-471E-4AF2-8EBC-B6FAD500DAF1">
                        <p class="notep1">Caution:</p>
                        <p>If you retain the old Oracle software, then never start the upgraded database with the old software. Only start Oracle Database using the start command in the new Oracle Database home. </p>
                        <p>Before you remove the old Oracle environment, relocate any data files in that environment to the new Oracle Database environment. </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-7E127507-D2F5-4771-A8A9-BAF6E553831B__GUID-3122BF73-6472-45A8-BF0B-1CBA9F96DDC2">
                        <p class="notep1">See Also:</p>
                        <p><span><cite>Oracle Database Administrator’s Guide</cite></span> for information about relocating data files
                        </p>
                     </div>
                     <p></p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../admin/managing-data-files-and-temp-files.html#ADMIN012" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD" title="To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture.">Manual Upgrade Scenarios for Multitenant Architecture Oracle Databases</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-6471F9F4-5151-4FA3-B5EC-B5AEBD99B0AA" name="GUID-6471F9F4-5151-4FA3-B5EC-B5AEBD99B0AA"></a><h3 id="UPGRD-GUID-6471F9F4-5151-4FA3-B5EC-B5AEBD99B0AA" class="sect3">About Upgrading PDBs Using the Parallel Upgrade Utility with Priority Lists</h3>
               <div>
                  <p>In Oracle Database 12.2 and later releases, you can upgrade PDBs using a priority list to upgrade a set of PDBs ahead of other PDBs, and you can modify that upgrade priority. </p>
                  <div class="section">
                     <p>Priority lists enable you to group and upgrade PDBs according to their priority. A priority list is a text file with comma-delimited lists defining the order of upgrade priority, and the PDBs in each numeric priority group. You run the Parallel Upgrade Utility (<code>dbupgrade</code>, <code>dbupgrade.cmd</code>, or <code>catctl.pl</code>) using the <code>-L</code> option to run the upgrade using a priority list, and to call that list as the upgrade runs. 
                     </p>
                     <p>Create the list using the following format. In this format example, the variable <span class="variable" translate="no">numeral</span> is a numeric value, and <span class="variable" translate="no">pdbx</span> is the name of a PDB. 
                     </p>
                     <p>Number, Pdb<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="variable" translate="no">numeral</span>,<span class="variable" translate="no">pdb1</span>,<span class="variable" translate="no">pdb2</span>,<span class="variable" translate="no">pdb3</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="variable" translate="no">numeral</span>,<span class="variable" translate="no">pdb4</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="variable" translate="no">numeral</span>,<span class="variable" translate="no">pdb5</span>,<span class="variable" translate="no">pdb6</span>,<span class="variable" translate="no">pdb7</span>,<span class="variable" translate="no">pdb8</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;.<br>
                        
                     </p>
                     <p>The numeral represents the priority for the PDB.</p>
                     <p> PDB priorities are as follows: </p>
                     <ol>
                        <li>
                           <p>CDB$ROOT: Priority 1. Upgrading the container database first is a mandatory priority. You cannot change the priority for the container database upgrade. CDB$ROOT is always processed first.</p>
                        </li>
                        <li>
                           <p>PDB$SEED: Priority 1. Upgrading the PDB seed database is a mandatory priority. You cannot change the priority for the PDB seed upgrade. PDB$SEED always upgraded after CDB$ROOT, and with the first batch of PDB upgrades. </p>
                        </li>
                        <li>
                           <p>Priority List 1 PDBs: Priority 1 is the highest user-selected priority. These PDBs are upgraded second after CDB$ROOT, in the batch where the PDB$SEED PDB is upgraded. </p>
                        </li>
                        <li>
                           <p>Priority List 2 PDBs: Priority 2 is the second-highest priority PDB set. These PDBs are upgraded after the Priority 1 PDBs.</p>
                        </li>
                        <li>
                           <p>Priority List 3 PDBs: Priority 3 is the third-highest priority PDB set. These PDBS are upgraded after priority 2 PDBs.</p>
                        </li>
                        <li>
                           <p>Priority List 4 PDBs: Priority 4 is the fourth-highest priority PDB set. These PDBS are upgraded after priority 3 PDBs.</p>
                        </li>
                        <li>
                           <p>Priority List 5 PDBs: Priority 5 is the fifth-highest priority PDB set. These PDBS are upgraded after priority 4 PDBs.</p>
                        </li>
                        <li>
                           <p>Priority List 6 PDBs: Priority 6 is the sixth-highest priority PDB set. These PDBS are upgraded after priority 7 PDBs.</p>
                        </li>
                     </ol>
                     <p>When you run the Parallel Upgrade Utility, the following processing rules apply:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>CDB$ROOT and PDB$SEED are always processed first, even if they are not present in the priority list. </p>
                        </li>
                        <li>
                           <p>All PDBs that are in priority lists are processed in order of priority</p>
                        </li>
                        <li>
                           <p>Any PDBs that are not listed in priority lists are processed after the PDBs named in the priority list.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-6471F9F4-5151-4FA3-B5EC-B5AEBD99B0AA__GUID-4E069162-9199-4639-A9CA-FB94FA04C7FA">
                     <p>For example:</p><pre class="pre codeblock"><code>Number,Pdb
1,sales1,region2,receivables1
2,sales2
3,dss1,region3,region2,dss2,dss3</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-6471F9F4-5151-4FA3-B5EC-B5AEBD99B0AA__GUID-8EDC63B5-62A5-49AA-849D-2C0019F8F99A">
                     <p>Use the following syntax to run the Parallel Upgrade utility using a priority list:</p><pre class="oac_no_warn" dir="ltr">dbupgrade -L <span class="variable" translate="no">priority_list_name</span></pre><p>For example, to run the Parallel Upgrade Utility on a Windows system using the Parallel Upgrade Utility batch command and a priority list named <code class="codeph">My122Upgrade</code>, enter the following command: 
                     </p><pre class="pre codeblock"><code>C:&gt;\u01\app\19.1.0\db_home1\rdbms\admin\dbupgrade -L MyUpgrade </code></pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <p>After you complete an upgrade using a priority list to set upgrade priorities, these PDB priority states are maintained in the CDB for the PDBs. The next upgrade honors the priorities set for the PDBs in the previous upgrade.</p>
                     <p>Use the following SQL command syntax to change PDB upgrade priority states, where <code class="codeph"><span class="variable" translate="no">PDBName</span></code> is the name of the PDB whose upgrade priority you want to change, and <code class="codeph"><span class="variable" translate="no">PDBPriorityNumber</span></code> is the new priority value you want to assign:
                     </p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter session set container = CDB$ROOT
SQL&gt; alter pluggable database <span class="variable" translate="no">PDBName</span> upgrade priority<span class="variable" translate="no">PDBPriorityNumber</span> </pre><p>For example:</p><pre class="pre codeblock"><code>SQL&gt; alter session set container = CDB$ROOT
SQL&gt; alter pluggable database region2 upgrade priority 2</code></pre><p>In this example, the PDB named region 2 that was set to upgrade priority 1 in the previous example is changed to upgrade priority 2.</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD" title="To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture.">Manual Upgrade Scenarios for Multitenant Architecture Oracle Databases</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F" name="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F"></a><h3 id="UPGRD-GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F" class="sect3">About PDB Upgrades Using Priority Lists, Inclusion Lists, and Exclusion Lists</h3>
               <div>
                  <p>Starting in Oracle Database 12<span class="italic">c</span> release 2 (12.2), you can use inclusion and exclusion lists with priority lists to control how your PDBs are upgraded.
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-E5584CED-D425-4FDC-916E-1059A5952CFD">Upgrade Processing and Lists</p>
                     <p>The following terms designate types of upgrade list processing:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><strong class="term">Priority lists</strong>: Comma-delimited lists that designate the upgrade priority of PDBs in the list.
                           </p>
                        </li>
                        <li>
                           <p><strong class="term">Inclusion lists</strong>: Comma-delimited lists that designate PDBs that you want to upgrade. PDBs in these lists are upgraded after the PDBs listed in priority lists.
                           </p>
                        </li>
                        <li>
                           <p><strong class="term">Exclusion lists</strong>: Comma-delimited lists that designate PDBs that you do not want to be upgraded. 
                           </p>
                        </li>
                     </ul>
                     <p>You can use inclusion lists and exclusion lists in the following ways:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>On their own, to include or exclude a set of PDBs from an upgrade</p>
                        </li>
                        <li>
                           <p>In conjunction with priority lists to provide detailed specifications for the order in which PDBs are upgraded, and which PDBs are excluded from an upgrade. </p>
                           <p>When inclusion lists are used with priority lists, the PDBs listed in inclusion lists are upgraded according to the priority value they are assigned in the priority lists. PDBs listed in inclusion lists but not listed in priority lists are upgraded after all PDBs in the priority lists are upgraded.</p>
                           <p>When exclusion lists are used with priority lists, the PDBs listed in exclusion lists are not upgraded. </p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-D5A0B39E-340E-40E7-8CA5-5B62E73DA37B">
                        <p class="notep1">Note:</p>
                        <p>Create priority lists using a plain text editor, such as <code class="codeph">vi</code> on Linux and UNIX, or Notepad on Windows. 
                        </p>
                        <p>In the examples in this topic, the <code class="codeph">cpu_count</code> value is equal to 2.
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-CE75E627-370D-4843-8BB0-9482A57A670B">Upgrade Priority using Default Processing</p>
                     <p><strong class="term">Default processing</strong> is the upgrade processing that is carried out if you do not designate how you want to upgrade PDBs in your CDBs using lists. 
                     </p>
                     <p>With default processing, CDB$ROOT is upgraded, and then PDB$SEED. Depending on the degree of parallelism you set, one or more PDBs may be updated in parallel with PDB$SEED. As upgrades complete, PDBs are upgraded as upgrade processors become available.</p>
                     <p>The examples that follow use the following multitenant configuration of CDB and PDBs:</p><pre class="pre codeblock"><code>CDB$ROOT
PDB$SEED
CDB1_PDB1
CDB1_PDB2
CDB1_PDB3
CDB1_PDB4
CDB1_PDB5</code></pre><p>In default processing, you specify no preference for which PDBs you want upgraded or excluded from upgrade. With default processing, CDB$ROOT is upgraded first, and PDB$SEED is updated in the first group of PDBs upgraded. </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-E48D5A30-827D-4ED4-9896-95EFC27F0BD1">
                     <p class="titleinexample">Example 4-29 Specifying Complete PDB Upgrade Priority</p>
                     <p>The following example of a priority list, where the priority setting for all PDBs is set by the list:</p><pre class="pre codeblock"><code>
1,CDB$ROOT
1,PDB$SEED
1,CDB1_PDB1
1,CDB1_PDB2
2,CDB1_PDB3
2,CDB1_PDB4
3,CDB1_PDB5</code></pre><p>Here is another way of writing the same list, in which you group PDBs in priority order:</p><pre class="pre codeblock"><code>1,CDB$ROOT
1,PDB$SEED
1,CDB1_PDB1,CDB1_PDB2
2,CDB1_PDB3,CDB1_PDB4
3,CDB1_PDB5</code></pre><p>In the preceding example, the PDBs listed in priority 1 are CDB1_PDB1 and CDB1_PDB2. These PDBs are upgraded before CDB1_PDB3 and CDB1_PDB4. </p>
                     <p>Here is another way of writing the same list, using container ID values (CON_ID) to set the priority order:</p><pre class="pre codeblock"><code>1,CDB$ROOT
1,PDB$SEED
1,3,4
2,5,6
3,7</code></pre><p>In the preceding example, the PDBs listed in priority 1 are CDB1_PDB1 (identified by CON_ID 3) and CDB1_PDB2 (identified by CON_ID 4). These PDBs are upgraded before CDB1_PDB3 (CON_ID 5) and CDB1_PDB4 (CON_ID 6). </p>
                     <p>When you use CON_IDs to specify priority, the first number specifies the priority of the group of PDBs. The second value or number specifies the PDBs (by CON_ID) number that are in that priority grouping. CDB$ROOT is always updated first, and PDB$SEED is always updated in the first upgrade priority group. </p>
                     <p>These examples all show a priority list upgrade with the following characteristics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Exclusion processing: None</p>
                        </li>
                        <li>
                           <p>Inclusion processing: None</p>
                        </li>
                        <li>
                           <p>Default processing: None</p>
                        </li>
                     </ul>
                     <p>The upgrade order is carried out in the following sequence:</p>
                     <ol>
                        <li>
                           <p>CDB$ROOT</p>
                        </li>
                        <li>
                           <p>PDB$SEED, CDB1_PDB1</p>
                        </li>
                        <li>
                           <p>CDB1_PDB2, CDB1_PDB3</p>
                        </li>
                        <li>
                           <p>CDB1_PDB4, CDB1_PDB5</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-AF71BFF8-667D-4E2E-B3C8-98CB92690074">
                     <p class="titleinexample">Example 4-30 Specifying a Priority Subset of PDBs, and Upgrading Other PDBs with Default Processing</p>
                     <p>The following example specifies a priority list called <code class="codeph">priority.lst</code>, which specifies a subset of PDBs for upgrade:
                     </p><pre class="pre codeblock"><code>catctl -L priority.lst catupgrd.sql
1,CDB$ROOT
1,PDB$SEED
1,CDB1_PDB1,CDB1_PDB2</code></pre><p>This example shows a priority list upgrade with the following characteristics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Exclusion processing: None</p>
                        </li>
                        <li>
                           <p>Inclusion processing: None</p>
                        </li>
                        <li>
                           <p>Default processing: CDB1_PDB3,CDB1_PDB4,CDB1_PDB5</p>
                        </li>
                     </ul>
                     <p>The upgrade order is carried out in the following sequence:</p>
                     <ol>
                        <li>
                           <p>CDB$ROOT</p>
                        </li>
                        <li>
                           <p>PDB$SEED, CDB1_PDB1</p>
                        </li>
                        <li>
                           <p>CDB1_PDB2, CDB1_PDB3</p>
                        </li>
                        <li>
                           <p>CDB1_PDB4, CDB1_PDB5</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-41C338F9-8B62-4101-99EB-645E4D65EDD6">
                     <p class="titleinexample">Example 4-31 Specifying a Priority Subset of PDBs, and Upgrading Other PDBs with an Inclusion List</p>
                     <p>The following example specifies a priority list called <code class="codeph">priority.lst</code>, which specifies a priority subset of PDBs for upgrade:
                     </p><pre class="pre codeblock"><code>catctl -L priority.lst -c 'CDB1_PDB2 CDB1_PDB4 CDB1_PDB5' catupgrd.sql</code></pre><p>This command refers to the following priority list: </p><pre class="pre codeblock"><code>1,CDB$ROOT
1,PDB$SEED
1,CDB1_PDB2,CDB1_PDB4
2.CDB1_PDB5</code></pre><p>This example shows a priority list upgrade with the following characteristics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Exclusion processing: None</p>
                        </li>
                        <li>
                           <p>Inclusion processing: CDB1_PDB2 CDB1_PDB4 CDB1_PDB5 </p>
                        </li>
                        <li>
                           <p>Default processing: None</p>
                        </li>
                     </ul>
                     <p>The upgrade order is carried out in the following sequence:</p>
                     <ol>
                        <li>
                           <p>CDB1_PDB2, CDB1_PDB4</p>
                        </li>
                        <li>
                           <p>CDB1_PDB5</p>
                        </li>
                     </ol>
                     <p>The Parallel Upgrade Utility processes only the PDBs that are in the inclusion list, and in the order of the priority list.</p>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-074EF1CA-8B41-4640-B3D3-DCC45C0E3DB7">
                     <p class="titleinexample">Example 4-32 Specifying a Priority Subset of PDBs, and Excluding CDB$ROOT with an Exclusion List</p>
                     <p>The following example runs <code>catctl</code> using a priority list called <code class="codeph">priority.lst</code>. Because this command runs with the <code class="codeph">-C</code> option, it excludes CDB$ROOT from the upgrade:
                     </p><pre class="pre codeblock"><code>catctl -L priority.lst -C 'CDB$ROOT' catupgrd.sql
</code></pre><p>This is the priority list: </p><pre class="pre codeblock"><code>1,CDB$ROOT
1,PDB$SEED
1,CDB1_PDB1,CDB1_PDB2
2,CDB1_PDB3,CDB1_PDB4
3,CDB1_PDB5</code></pre><p>The upgrades are processed using the priority list to specify upgrade priority. </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Inclusion processing: None</p>
                        </li>
                        <li>
                           <p>Exclusion processing: CDB$ROOT</p>
                        </li>
                        <li>
                           <p>Priority processing: PDB$SEED, CDB1_PDB1, CDB1_PDB2, CDB1_PDB3, CDB1_PDB4, CDB1_PDB5</p>
                        </li>
                     </ul>
                     <p>Because CDB$ROOT is excluded, the priority processing shifts. The upgrade order is carried out in the following sequence:</p>
                     <ol>
                        <li>
                           <p>PDB$SEED, CDB_PDB1</p>
                        </li>
                        <li>
                           <p>CDB_PDB2, CDB_PDB3</p>
                        </li>
                        <li>
                           <p>CDB1_PDB4, CDB1_PDB5</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-671C1BE2-8FF5-4E18-9042-B48D7A432283">
                     <p class="titleinexample">Example 4-33 Specifying an Exclusion List using CATCTL_LISTONLY</p>
                     <p>The following example specifies a priority list called <code class="codeph">priority.lst</code>, which specifies a subset of PDBs for upgrade. With the CATCTL_LISTONLY option, PDBs that are not in the priority list are excluded from the upgrade:
                     </p><pre class="pre codeblock"><code>catctl -L priority.lst -C 'CATCTL_LISTONLY' catupgrd.sql</code></pre><p>Priority list:</p><pre class="pre codeblock"><code>1,CDB$ROOT
1,PDB$SEED
1,CDB1_PDB1,CDB1_PDB2
2,CDB1_PDB3
3,CDB1_PDB5</code></pre><ul style="list-style-type: disc;">
                        <li>
                           <p>Exclusion processing: CATCTL_LISTONLY (Only process inclusion priority list)</p>
                        </li>
                        <li>
                           <p>Inclusion processing: None</p>
                        </li>
                        <li>
                           <p>Default processing: None</p>
                        </li>
                     </ul>
                     <p>The upgrade order is carried out in the following sequence:</p>
                     <ol>
                        <li>
                           <p>CDB$ROOT</p>
                        </li>
                        <li>
                           <p>PDB$SEED, CDB1_PDB1,CDB1_PDB2</p>
                        </li>
                        <li>
                           <p>CDB1_PDB3, CDB1_PDB5</p>
                        </li>
                     </ol>
                     <div class="infoboxnote" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-741A4472-8440-43EB-B3A3-D8D43D2F49C5">
                        <p class="notep1">Note:</p>
                        <p>Specifying the keyword CATCTL_LISTONLY in the exclusion list turns the priority list into an inclusion priority list. Only PDBs in the list are processed. No default processing occurs in this scenario, so in this example, CDB1_PDB4 is not processed.</p>
                     </div>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-3CF7D679-115C-40A4-8982-9D1FD6C9AB2E">
                     <p class="titleinexample">Example 4-34 Specifying a Priority List using CON_ID Values</p>
                     <p>The following example specifies a priority list called <code class="codeph">priority.lst</code>, which specifies a subset of PDBs for upgrade:
                     </p><pre class="pre codeblock"><code>catctl -L priority.lst -C 'CATCTL_LISTONLY' catupgrd.sql</code></pre><p> The upgrade order is determined by the priority list priority number. In the list called by the <code class="codeph">-L</code> parameter, <code class="codeph">priority.lst</code>, the numbers following the upgrade priority number are the CON_ID values associated with PDB names:
                     </p><pre class="pre codeblock"><code>1,3,4
2,5,CDB1_PDB4
3,7</code></pre><p>In the preceding list example, note that you can use a mix of CON_ID numbers and PDB names. </p>
                     <p>The PDBs listed in priority 3 are CDB1_PDB1 (identified by CON_ID 3) and CDB1_PDB2 (identified by CON_ID 4). These PDBs are upgraded before CDB1_PDB3 (CON_ID 5), CDB1_PDB4, which is identified by name, and CDB1_PDB5 (CON_ID 7).</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Exclusion processing: <code class="codeph">-C CATCTL_LISTONLY</code> (Only process PDBs in the inclusion priority list)
                           </p>
                        </li>
                        <li>
                           <p>Exclusion Processing: None</p>
                        </li>
                        <li>
                           <p>Inclusion processing: Specified in <code class="codeph">priority.lst</code></p>
                        </li>
                        <li>
                           <p>Default processing: CDB$ROOT, PDB$SEED</p>
                        </li>
                     </ul>
                     <p>The upgrade order is determined by the priority list, which uses the CON_ID numbers associated with the PDB.</p>
                     <ol>
                        <li>
                           <p>CDB$ROOT</p>
                        </li>
                        <li>
                           <p>PDB$SEED, CDB1_PDB1</p>
                        </li>
                        <li>
                           <p>CDB1_PDB2, CDB1_PDB3</p>
                        </li>
                        <li>
                           <p>CDB1_PDB4, CDB1_PDB5</p>
                        </li>
                     </ol>
                     <div class="infoboxnote" id="GUID-55A00056-EFB3-4F81-8E28-3B8C9553B68F__GUID-FD690F88-AB20-465D-BD6D-811255806B34">
                        <p class="notep1">Note:</p>
                        <p>This example demonstrates the use of CON_IDs to specify the PDBs, and omits CDB$ROOT and PDB$SEED from the priority list. CDB$ROOT and PDB$SEED are processed using default processing. </p>
                     </div>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD" title="To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture.">Manual Upgrade Scenarios for Multitenant Architecture Oracle Databases</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-4CA89342-971B-447C-A643-9638DE4EB121" name="GUID-4CA89342-971B-447C-A643-9638DE4EB121"></a><h3 id="UPGRD-GUID-4CA89342-971B-447C-A643-9638DE4EB121" class="sect3">Upgrading Multitenant Architecture In Parallel</h3>
               <div>
                  <p>Use this technique to upgrade multitenant architecture Oracle Database releases (Oracle Database 12c Release 1 (12.1.0.1) and later by upgrading container databases (CDBs), and then upgrading multiple pluggable databases (PDBs) in parallel.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8775B0AB-CBED-4173-9B76-4F6E34841EFB">About Upgrading Pluggable Databases (PDBs) In Parallel</a><br>Using the In-Parallel technique, you can upgrade the CDB, and then immediately upgrade PDBs using parallel SQL processors. 
                     </li>
                     <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-5C043DD3-309A-4C8A-B500-1CAFC2CAB875">Upgrading Multitenant Container Databases In Parallel</a><br>Use this technique to upgrade CDB$ROOT, PDB$SEED, and all PDBS in the CDB in one upgrade operation.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD" title="To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture.">Manual Upgrade Scenarios for Multitenant Architecture Oracle Databases</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-8775B0AB-CBED-4173-9B76-4F6E34841EFB" name="GUID-8775B0AB-CBED-4173-9B76-4F6E34841EFB"></a><h4 id="UPGRD-GUID-8775B0AB-CBED-4173-9B76-4F6E34841EFB" class="sect4">About Upgrading Pluggable Databases (PDBs) In Parallel</h4>
                  <div>
                     <p>Using the In-Parallel technique, you can upgrade the CDB, and then immediately upgrade PDBs using parallel SQL processors. </p>
                     <p>Container databases (CDBs) can contain zero, one, or more pluggable databases (PDBs). By default, the Parallel Upgrade Utility (<code>catctl.pl</code>) updates the CDB and all of its PDBs in the same upgrade window. The Parallel Upgrade Utility uses the number of computer processing units (CPUs) to determine the maximum number of PDBs that are upgraded simultaneously. The number of PDBs that are upgraded in parallel is determined by dividing the parallel SQL process count (<code class="codeph">-n</code> option) by the parallel PDB SQL process count (<code class="codeph">-N</code> option).
                     </p>
                     <div class="infoboxnote" id="GUID-8775B0AB-CBED-4173-9B76-4F6E34841EFB__GUID-52D5F0B2-2B17-4333-8BDC-5132B664B1ED">
                        <p class="notep1">Note:</p>
                        <p>You must plan your upgrade window to accommodate a common downtime for all of the database services that the PDBs on the CDB are providing.</p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-8775B0AB-CBED-4173-9B76-4F6E34841EFB__GUID-F883EE3A-D6EF-4013-86E3-37BB40975BD9">Pluggable Database Upgrade Syntax</p>
                        <p><code class="codeph">dbupgrade [-M] -n </code> [-N]
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">-M</code> Specifies if CDB$ROOT is kept in upgrade mode, or if it becomes available when it completes upgrade:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>If you run the Parallel Upgrade Utility with the <code class="codeph">-M</code> parameter, then the upgrade places CDB$ROOT and all of its PDBs in upgrade mode, which can reduce total upgrade time. However, you cannot bring up any of the PDBs until the CDB and all of its PDBs are upgraded. 
                                    </p>
                                 </li>
                                 <li>
                                    <p>If you do not run the Parallel Upgrade Utility with the <code class="codeph">-M</code> parameter, then CDB$ROOT is upgraded and restarted in normal mode, and the normal background processes are started. After a successful upgrade, only CDB$ROOT is opened in read/write mode. All the PDBs remain in MOUNT mode. As each PDB is upgraded, you can bring each PDB online while other PDBs are still being upgraded.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p><code class="codeph">-n</code> Specifies the number of in-parallel PDB upgrade processors.
                              </p>
                              <p>If you do not specify a value for <code class="codeph">-n</code>, then the default for <code class="codeph">-n</code> is the <code class="codeph">CPU_COUNT</code> value. 
                              </p>
                              <p>If you do specify a value for <code class="codeph">-n</code>, then that value is used to determine the number of parallel SQL processes. The maximum value is unlimited. The minimum value is 4. 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-N</code> Specifies the number of SQL processors to use when upgrading PDBs. The maximum value is 8. The minimum value is 1. If you do not specify a value for <code class="codeph">-N</code>, then the default value is 2.
                              </p>
                           </li>
                           <li>
                              <p>The maximum PDB upgrades running concurrently is the value of <code class="codeph">-n</code> divided by the value of <code class="codeph">-N</code>.
                              </p>
                           </li>
                        </ul>
                        <p>The following is a high-level list of actions during the In Parallel PDB upgrade technique:</p>
                        <ol>
                           <li>
                              <p>Make sure that your backup strategy is complete.</p>
                           </li>
                           <li>
                              <p>Run the Pre-Upgrade tool. Fix any issue that is reported.. The Pre-Upgrade Tool (<code class="codeph">preupgrade.jar</code>) is shipped with the new Oracle database release.
                              </p>
                           </li>
                           <li>
                              <p>Run the Parallel Upgrade Utility. In sequence, the following upgrades are carried out: </p>
                              <ol type="a">
                                 <li>
                                    <p>Cycle 1: CDB$ROOT is upgraded to the new Oracle release</p>
                                 </li>
                                 <li>
                                    <p>Cycle 2 to Cycle x: PDB$SEED and PDBs are upgraded in parallel, with the number of cycles of upgrades as determined by the parameter settings  you specify with <code class="codeph">-n</code>.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>Complete post-upgrade steps.</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-8775B0AB-CBED-4173-9B76-4F6E34841EFB__GUID-A3DC5104-9402-45CD-82F0-6277064E9EEB">
                        <p class="titleinexample">Example 4-35 Example of Multitenant Architecture Upgrade Using Defaults (No Parameters Set)</p>
                        <p>In this scenario, your <code class="codeph">CPU_COUNT</code> value is equal to 24. If you do not specify a value for in-parallel PDB processors using the <code class="codeph">-n</code> option, then the default value for in-parallel PDB processors (<code class="codeph">-n</code>) is equal to 24. If you do not specify a value for <code class="codeph">-N</code>, then the default value for the number of SQL processors (<code class="codeph">-N</code>) is 2. 
                        </p>
                        <p>Result: </p>
                        <p>12 PDBs are upgraded in parallel  (<code class="codeph">CPU_COUNT</code> divided by 2, or 24 divided by 2.) There are 2 parallel SQL processes allocated for each PDB.
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-8775B0AB-CBED-4173-9B76-4F6E34841EFB__GUID-9AA5D146-F428-40E0-858F-C3B8AF17D298">
                        <p class="titleinexample">Example 4-36 Example of Multitenant Architecture Upgrade Using 64 In Parallel PDB Upgrade Processors and 4 Parallel SQL Processes</p>
                        <p>In this scenario you set the value of in-parallel PDB upgrade processors to 64 by specifying the option <code class="codeph">-n 64</code>. You specify the value of parallel SQL processors to 4 by specifying the option <code class="codeph">-N 4</code>.
                        </p>
                        <p>Result: </p>
                        <p>16 PDBs are upgraded in parallel ( 64 divided by 4). There are 4 parallel SQL processes for each PDB. </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-8775B0AB-CBED-4173-9B76-4F6E34841EFB__GUID-4982DE61-7FBE-445F-82A7-C6D8F5245FD4">
                        <p class="titleinexample">Example 4-37 Example of Multitenant Architecture Upgrade Using 20 In Parallel PDB Upgrade Processors and 2 Parallel SQL Processes</p>
                        <p>In this scenario you se the value of in-parallel PDB upgrade processors to 20 by specifying the option <code class="codeph">-n 20</code>. You specify the value of parallel SQL processors to 2 by specifying the option <code class="codeph">-N 2</code>.
                        </p>
                        <p>Result:</p>
                        <p>10 PDBs are upgraded in parallel (20 divided by 2). There are 2 parallel SQL processes for each PDB. </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-8775B0AB-CBED-4173-9B76-4F6E34841EFB__GUID-159AA1E9-EC16-48AB-A81E-52ED7AB9D872">
                        <p class="titleinexample">Example 4-38 Example of Multitenant Architecture Upgrade Using 10 In Parallel PDB Upgrade Processors and 4 Parallel SQL Processes</p>
                        <p>In this scenario you se the value of in-parallel PDB upgrade processors to 10 by specifying the option <code class="codeph">-n 10</code>. You specify the value of parallel SQL processors to 2 by specifying the option <code class="codeph">-N 4</code>.
                        </p>
                        <p>Result:</p>
                        <p>2 PDBs are upgraded in parallel (10 divided by 4). There are 4 parallel SQL processes for each PDB. </p>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-4CA89342-971B-447C-A643-9638DE4EB121" title="Use this technique to upgrade multitenant architecture Oracle Database releases (Oracle Database 12c Release 1 (12.1.0.1) and later by upgrading container databases (CDBs), and then upgrading multiple pluggable databases (PDBs) in parallel.">Upgrading Multitenant Architecture In Parallel</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-5C043DD3-309A-4C8A-B500-1CAFC2CAB875" name="GUID-5C043DD3-309A-4C8A-B500-1CAFC2CAB875"></a><h4 id="UPGRD-GUID-5C043DD3-309A-4C8A-B500-1CAFC2CAB875" class="sect4">Upgrading Multitenant Container Databases In Parallel</h4>
                  <div>
                     <p>Use this technique to upgrade CDB$ROOT, PDB$SEED, and all PDBS in the CDB in one upgrade operation.</p>
                     <div class="section">Oracle recommends that you use this approach if you can schedule downtime, because it provides a direct procedure for upgrades and simplicity of maintenance. Using this procedure upgrades in parallel all the PDBs in the multitenant architecture container database, depending on your server’s available processors (CPUs). </div>
                     <!-- class="section" -->
                     <div class="p">
                        <div class="infoboxnote" id="GUID-5C043DD3-309A-4C8A-B500-1CAFC2CAB875__GUID-B9E56452-D917-4494-9CEA-1776AB539636">
                           <p class="notep1">Note:</p>
                           <p>When you upgrade the entire container using the In Parallel upgrade method, all the PDBs must be down. Perform the upgrade in a scheduled upgrade window so that you can bring all the PDBs down. </p>
                        </div>
                        <div class="infoboxnote" id="GUID-5C043DD3-309A-4C8A-B500-1CAFC2CAB875__GUID-7E298C0B-771D-4F81-BFB5-1659CC483F66">
                           <p class="notep1">Caution:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Always create a backup of existing databases before starting any configuration change.</p>
                              </li>
                              <li>
                                 <p>You cannot downgrade a database after you have set the compatible initialization parameter.</p>
                              </li>
                              <li>
                                 <p>Oracle strongly recommends that you upgrade your source and target databases to the most recent bundle patch or patch set update (BP or PSU) before starting an upgrade, and to the most recent release update before starting a downgrade. </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Ensure that you have a proper backup strategy in place.</span></li>
                        <li class="stepexpand"><span>Open all PDBs. </span><div>
                              <p>For example:</p><pre class="pre codeblock"><code>SQL&gt; alter pluggable database all open;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Run the Pre-Upgrade Information Tool (<code class="codeph">preupgrade.jar</code>), using the following syntax:</span><div><code class="codeph">/java -jar <span class="variable" translate="no">$New_release_Oracle_home</span>/rdbms/admin/preupgrade.jar [TERMINAL|FILE|DIR outputdir] [TEXT|XML] [-c <span class="variable" translate="no">InclusionListOfPDBs</span>] [-C <span class="variable" translate="no">ExclusionListOfPDBs</span>]</code><p>Use space-delimitation for lists. On Linux and UNIX, define the list by placing the list inside single quotes:<code class="codeph"> '</code>. On Windows systems, define the list by placing the list inside double quotes<code class="codeph"> "</code>.
                              </p>
                           </div>
                           <div>For example, run the following command to run the Pre-Upgrade Information tool on PDBs PDB1 through PDB25, where you have set up an environment variable <code class="codeph">$ORACLE_HOME_12.2</code> for your Oracle Database Oracle home in<code class="codeph"> /u01/app/ oracle/product/12.2.0/dbhome_1/</code>, and you have set up an environment variable <code class="codeph">$ORACLE_HOME_19.1</code> for your new Oracle Database Oracle home in <code>/u01/app/oracle/product/19.1.0/dbhome_1/</code>:
                              <p>Linux and UNIX:</p><pre class="pre codeblock"><code>java -jar $ORACLE_HOME_19.1/rdbms/admin/preupgrade.jar \
-c 'pdb1 pdb2 pdb3 pdb4 pdb5 pdb6 pdb7 pdb8 pdb9 pdb10 pdb11 pdb12 pdb13\
pdb14 pdb15 pdb16 pdb17 pdb18 pdb19 pdb20 pdb21 pdb22 pdb23 pdb24 pdb25'</code></pre><p>Windows:</p><pre class="pre codeblock"><code>java -jar %ORACLE_HOME_19.1%/rdbms/admin/preupgrade.jar \
-c "pdb1 pdb2 pdb3 pdb4 pdb5 pdb6 pdb7 pdb8 pdb9 pdb10 pdb11 pdb12 pdb13\
pdb14 pdb15 pdb16 pdb17 pdb18 pdb19 pdb20 pdb21 pdb22 pdb23 pdb24 pdb25"</code></pre></div>
                           <div>
                              <div class="infoboxnote" id="GUID-5C043DD3-309A-4C8A-B500-1CAFC2CAB875__GUID-3CDD4AE3-9DFE-438B-82B3-2C4700E40E3D">
                                 <p class="notep1">Note:</p>
                                 <p>You must use Java 1.5 or later to run the Pre-Upgrade Information tool. By default, the Java releases in Oracle Database releases that you can upgrade directly support the tool.</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Review any generated fixup scripts and log files.</span><div>
                              <p>By default, if ORACLE_BASE is defined, then the fixup files are placed in one of the following paths:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Linux and UNIX:</p>
                                    <p><code>$ORACLE_BASE/cfgtoollogs/<span class="variable" translate="no">db_unique_name</span>/preupgrade</code></p>
                                 </li>
                                 <li>
                                    <p>Windows</p>
                                    <p><code>%ORACLE_BASE%\cfgtoollogs\<span class="variable" translate="no">db_unique_name</span>\preupgrade</code></p>
                                 </li>
                              </ul>
                              <p>If ORACLE_BASE is not defined, then fixup files are placed in one of the following paths:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Linux and UNIX:</p>
                                    <p><code class="codeph">$ORACLE_HOME/cfgtoollogs/<span class="variable" translate="no">db_unique_name</span>/preupgrade</code></p>
                                 </li>
                                 <li>
                                    <p>Windows:</p>
                                    <p><code class="codeph">%ORACLE_HOME\cfgtoollogs\<span class="variable" translate="no">db_unique_name</span>\preupgrade</code></p>
                                 </li>
                              </ul>
                              <p>On multitenant architecture Oracle Databases, the Pre-Upgrade Information Tool also creates a consolidated <code>preupgrade_fixups.sql</code> script. You can run the consolidated fixup script by using <code>catcon.pl</code>. The consolidated fixup script runs on every container that was open at the time that you ran the <code>preupgrade.jar</code> command. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">preupgrade_fixups</code> script, or individual PDB scripts. The <code class="codeph">preupgrade_fixups</code> SQL scripts resolve some of the issues reported by the <code class="codeph">preupgrade</code> script.</span><div>
                              <p>On multitenant environment Oracle Database deployments, you can run <code class="codeph">preupgrade_fixups<span class="variable" translate="no">pdb-name</span>.sql</code> scripts on the source database, where <code class="codeph"><span class="variable" translate="no">pdb-name</span></code> is the PDB name. If you generate fixup scripts for PDBs, then the PDB name is added to the fixup filename.
                              </p>
                              <p>In addition to the individual PDB fixup scripts, you can use <code>catcon.pl</code> to run the consolidated <code>preupgrade_fixups.sql</code> script. The consolidated script runs on every container that was open at the time that you ran <code>preupgrade.jar</code>.
                              </p>
                              <div class="infoboxnote" id="GUID-5C043DD3-309A-4C8A-B500-1CAFC2CAB875__GUID-DAAD9892-D13C-4947-B51E-3E0655691C12">
                                 <p class="notep1">Note:</p>
                                 <p>Because $ is a reserved symbol on operating systems, the fixup script for PDB$SEED is <code>preupgrade_fixups_pdb_seed.sql</code>.
                                 </p>
                              </div>
                           </div>
                           <div>
                              <p>Complete any other preupgrade tasks that the Pre-Upgrade Information Tool identifies. </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>(Conditional) for Oracle RAC databases, set the cluster database initialization parameter to false: </span><div>
                              <p>For example; </p><pre class="pre codeblock"><code>ALTER SYSTEM SET cluster_database=FALSE SCOPE=spfile;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Shut down the database in the old Oracle home. </span><div>
                              <p>For example, where <code class="codeph"><span class="variable" translate="no">db_unique_name</span></code> is your database name: 
                              </p><code class="codeph">$ srvctl stop database -d <span class="variable" translate="no">db_unique_name</span></code></div>
                        </li>
                        <li class="stepexpand"><span>Copy the <code class="codeph">PFILE</code> or <code class="codeph">SPFILE</code> from the old Oracle home to the new Oracle home</span></li>
                        <li class="stepexpand"><span>Connect with SQL*Plus:</span><div><pre class="pre codeblock"><code>sqlplus / as sysdba</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Bring the CDB$ROOT instance into upgrade mode:</span><div><pre class="pre codeblock"><code>STARTUP UPGRADE</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Bring all PDBs into upgrade mode:</span><div><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE ALL OPEN UPGRADE;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Check the status of PDBs to confirm that they are ready to upgrade:</span><div><pre class="pre codeblock"><code>SHOW PDBS</code></pre></div>
                           <div>For all PDBs, ensure that the status is set to MIGRATE. </div>
                        </li>
                        <li class="stepexpand"><span>Exit from SQL*Plus, and change directory to the new Oracle home <code>$ORACLE_HOME/rdbms/admin</code>:</span><div><pre class="pre codeblock"><code>SQL&gt; EXIT
$ ORACLE_HOME/bin </code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Start the upgrade using the Parallel Upgrade Utility (<code class="codeph">catctl.pl</code>, using the shell command <code class="codeph">dbupgrade</code>), where <code class="codeph">-d</code> specifies the location of the directory:</span><div><pre class="pre codeblock"><code>dbupgrade -d $ORACLE_HOME/rdbms/admin</code></pre></div>
                           <div>
                              <p>If you do not specify any parameters, then the Parallel Upgrade Utility runs the upgrade in parallel on the number of PDBs equivalent to the number of CPUs divided by 2. On a server with 64 CPUs, 64 divided by 2 equals 32 PDBs upgraded in parallel, carried out with two SQL processors for each PDB. CDB$ROOT remains in NORMAL mode for the duration of the upgrade.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Confirm that the upgrade was successful by reviewing the <code class="codeph">upg_summary.log</code> If necessary, review other logs. </span></li>
                        <li class="stepexpand"><span>Open all PDBs, so that you can recompile the databases:</span><div><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE ALL OPEN;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Exit from SQL*Plus, and change directory to the new Oracle home path <code>$ORACLE_HOME/rdbms/admin</code>:</span><div><pre class="pre codeblock"><code>SQL&gt; EXIT
cd $ORACLE_HOME/rdbms/admin</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">catcon.pl</code> script and the <code class="codeph">postupgrade_fixups.sql</code> script that is supplied with the new release Oracle Database.</span><div>
                              <p>The following example shows the command strings for running <code>catcon.pl</code>, using the <code class="codeph">-n</code> parameter to specify one parallel processor for each PDB, using the <code class="codeph">-d</code> parameter to specify the path where the preupgrade script that you want to run is located, using the <code class="codeph">-l</code> parameter to specify the location where you want the scripts to place log files, and using the <code class="codeph">-b</code> flag to specify the log file prefixes for the <code class="codeph">postupgrade_fixups.sql</code> script:
                              </p><pre class="pre codeblock"><code>$ORACLE_HOME/perl/bin/perl $ORACLE_HOME/rdbms/admin/catcon.pl -n 1 -d \
$ORACLE_HOME/cfgtoollogs/cdbupgr/preupgrade -l /home/oracle/upgrdDBA -b \
postupgrade_fixups postupgrade_fixups.sql</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Run <code>postupgrade_fixups.sql</code>.</span><div>
                              <p>Non- CDB:</p><pre class="pre codeblock"><code>SQL&gt; @rdbms/admin/postupgrade_fixups.sql</code></pre><p>CDB:</p><pre class="pre codeblock"><code>$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b postupgradefixups -d '''.''' postupgradefixups.sql</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Run <code>utlusts.sql</code> to verify that there are no upgrade issues. </span><div>
                              <p>Non-CDB:</p><pre class="pre codeblock"><code>SQL&gt; @rdbms/admin/utlusts.sql
</code></pre><p>CDB:</p><pre class="pre codeblock"><code>$ORACLE_HOME/perl/bin/perl catcon.pl -n 1 -e -b utlu122s -d '''.''' utlusts.sql</code></pre></div>
                           <div>
                              <p>When you use <code>catcon.pl</code> to run <code>utlusts.sql</code>, the log file <code class="codeph">utlu122s0.log</code> is generated. The log file provides the upgrade results. You can also review the upgrade report, <code class="codeph">upg_summary.log</code>.
                              </p>
                              <p>To see information about the state of the database, run <code>utlusts.sql</code> as many times as you want, at any time after the upgrade is completed. If the <code>utlusts.sql</code> script returns errors, or shows components that do not have the status <code class="codeph">VALID</code>, or if the version listed for the component is not the most recent release, then perform troubleshooting. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>(Conditional) For Oracle RAC environments only, enter the following commands to set the initialization parameter value for <span class="parmname" translate="no">CLUSTER_DATABASE</span> to <code class="codeph">TRUE</code>, and to start the Oracle RAC database, where <code class="codeph"><span class="variable" translate="no">dbname</span></code> is the name of the Oracle RAC database:</span><div><pre class="pre codeblock"><code>ALTER SYSTEM SET CLUSTER_DATABASE=TRUE SCOPE=SPFILE;
srvctl start database -db <span class="variable" translate="no">db_unique_name</span></code></pre></div>
                           <div>
                              <p>Your database is now upgraded.</p>
                              <div class="infoboxnote" id="GUID-5C043DD3-309A-4C8A-B500-1CAFC2CAB875__GUID-ACC577D0-471E-4AF2-8EBC-B6FAD500DAF1">
                                 <p class="notep1">Caution:</p>
                                 <p>If you retain the old Oracle software, then never start the upgraded database with the old software. Only start Oracle Database using the start command in the new Oracle Database home. </p>
                                 <p>Before you remove the old Oracle environment, relocate any data files in that environment to the new Oracle Database environment. </p>
                              </div>
                              <div class="infoboxnotealso" id="GUID-5C043DD3-309A-4C8A-B500-1CAFC2CAB875__GUID-4FD7BF4A-F3A5-4914-9645-22387E206000">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="../admin/managing-data-files-and-temp-files.html#ADMIN012" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> for information about relocating data files
                                 </p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-4CA89342-971B-447C-A643-9638DE4EB121" title="Use this technique to upgrade multitenant architecture Oracle Database releases (Oracle Database 12c Release 1 (12.1.0.1) and later by upgrading container databases (CDBs), and then upgrading multiple pluggable databases (PDBs) in parallel.">Upgrading Multitenant Architecture In Parallel</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-8F9AAFA1-690D-4F70-8448-E66D765AF136" name="GUID-8F9AAFA1-690D-4F70-8448-E66D765AF136"></a><h3 id="UPGRD-GUID-8F9AAFA1-690D-4F70-8448-E66D765AF136" class="sect3">Upgrading Multitenant Architecture Sequentially Using Unplug-Plug</h3>
               <div>
                  <p>To upgrade pluggable databases (PDBs) that are in an earlier release multitenant container databases (CDBs), Oracle Database Release 12<span class="italic">c</span> (12.1.0.1) and later, you can unplug the PDBs from the earlier release CDB, and plug the PDBs into the later release CDB.
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-4CB1CB0C-E893-41F6-A1A5-2E2BE1A706AF">About Upgrading Pluggable Databases (PDBs) Sequentially</a><br>You can upgrade PDBs by unplugging a PDB from an earlier release CDB, plugging it into a later release CDB, and then upgrading that PDB to the later release. 
                     </li>
                     <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-F1F89935-A2F1-4C3F-8138-FF34B3F01168">Unplugging the Earlier Release PDB from the Earlier Release CDB</a><br>To prepare for upgrading the PDB, use this procedure to unplug the PDB from the earlier release CDB. 
                     </li>
                     <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-E188F65A-8AE8-494F-80BD-7060AE02769E">Plugging in the Earlier Release PDB to the Later Release CDB</a><br>To Plug the PDB from the earlier release CDB to the later release CDB, use the <code class="codeph">CREATE PLUGGABLE DATABASE</code> command. 
                     </li>
                     <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-99657846-6859-43BF-A514-0C8A7786734D">Upgrading the Earlier Release PDB to the Later Release</a><br>Open PDBs in <code class="codeph">UPGRADE</code> mode use the Parallel Upgrade Utility to carry out the upgrade of the earlier-release PDB to the release level of the CDB.
                     </li>
                     <li class="ulchildlink"><a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-466B8807-EE9F-477E-BE59-600044BA882B">Use Inclusion or Exclusion Lists for PDB Upgrades</a><br>If you want to upgrade a subset of earlier release PDBs, then use inclusion or exclusion lists to avoid reupgrading the CDB or PDBs that are at the new release level.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8231CE50-ABEC-4BA3-A4AC-D461EB791ACD" title="To prepare for manual upgrades, review the manual upgrade scenarios and procedures for Oracle Database deployed with multitenant architecture.">Manual Upgrade Scenarios for Multitenant Architecture Oracle Databases</a></p>
                     </div>
                  </div>
               </div>
               <a id="UPGRD60151"></a><div class="props_rev_3"><a id="GUID-4CB1CB0C-E893-41F6-A1A5-2E2BE1A706AF" name="GUID-4CB1CB0C-E893-41F6-A1A5-2E2BE1A706AF"></a><h4 id="UPGRD-GUID-4CB1CB0C-E893-41F6-A1A5-2E2BE1A706AF" class="sect4">About Upgrading Pluggable Databases (PDBs) Sequentially</h4>
                  <div>
                     <p>You can upgrade PDBs by unplugging a PDB from an earlier release CDB, plugging it into a later release CDB, and then upgrading that PDB to the later release. </p>
                     <p>CDBs can contain zero, one, or more pluggable databases (PDBs). After you install a new Oracle Database release, or after you upgrade the CDB (<code class="codeph">CDB$ROOT</code>), you can upgrade one or more PDB without upgrading all of the PDBs on the CDB. 
                     </p>
                     <p>You can choose the upgrade plan that meets the needs for your service delivery. For example, you can use Oracle Database Upgrade Assistant (DBUA) to upgrade a set of PDBs, or you can use a manual upgrade to upgrade PDBs individually, or with inclusion or exclusion lists. You can upgrade the CDB and all PDBs (an In Parallel manual upgrade), or you can upgrade the CDB, and then upgrade PDBs sequentially, either individually, or in sets using inclusion or exclusion lists. </p>
                     <p>The following is a high-level list of the steps required for sequential PDB upgrades:</p>
                     <ol>
                        <li>
                           <p>Unplug the earlier release PDB from the earlier release CDB.</p>
                        </li>
                        <li>
                           <p>Drop the PDB from the CDB.</p>
                        </li>
                        <li>
                           <p>Plug the earlier release PDB into the later release CDB.</p>
                        </li>
                        <li>
                           <p>Upgrade the earlier release PDB to a later release.</p>
                        </li>
                     </ol>
                     <div class="p">With Oracle Database 12<span class="italic">c</span> Release 2 (12.2) and later releases, you can provide lists to the Parallel Upgrade Utility to upgrade PDBs:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Priority lists, to set the order in which PDBs are upgraded</p>
                           </li>
                           <li>
                              <p>Inclusion lists, which enable you to designate a set of PDBs to upgrade after the PDBs listed in the priority list are upgraded</p>
                           </li>
                           <li>
                              <p>Exclusion lists, which enable you to designate a set of PDBs that are not upgraded</p>
                           </li>
                        </ul>
                     </div>
                     <div class="infoboxnote" id="GUID-4CB1CB0C-E893-41F6-A1A5-2E2BE1A706AF__GUID-A679BA33-EE92-487D-839F-6426BE4B665B">
                        <p class="notep1">Note:</p>
                        <p>A PDB cannot be recovered unless it is backed up. After upgrading using the method of creating a CDB and plugging in a PDB, be sure to back up the PDB.</p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../bradv/backing-up-database.html#BRADV428" target="_blank"><span><cite>Oracle Database Backup and Recovery User’s Guide</cite></span></a></li>
                           <li><a href="../multi/removing-a-pdb.html#ADMIN13623" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8F9AAFA1-690D-4F70-8448-E66D765AF136" title="To upgrade pluggable databases (PDBs) that are in an earlier release multitenant container databases (CDBs), Oracle Database Release 12c (12.1.0.1) and later, you can unplug the PDBs from the earlier release CDB, and plug the PDBs into the later release CDB.">Upgrading Multitenant Architecture Sequentially Using Unplug-Plug</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-F1F89935-A2F1-4C3F-8138-FF34B3F01168" name="GUID-F1F89935-A2F1-4C3F-8138-FF34B3F01168"></a><h4 id="UPGRD-GUID-F1F89935-A2F1-4C3F-8138-FF34B3F01168" class="sect4">Unplugging the Earlier Release PDB from the Earlier Release CDB</h4>
                  <div>
                     <p>To prepare for upgrading the PDB, use this procedure to unplug the PDB from the earlier release CDB. </p>
                     <ol>
                        <li>
                           <p>Run the Pre-Upgrade Information Tool on the PDB.</p>
                           <p>For example, where the PDB named <code class="codeph">salespdb</code> is running in the CDB in <code class="codeph">$ORACLE_HOME_12.2</code>: 
                           </p><pre class="pre codeblock"><code>$ORACLE_HOME_12.2/jdk/bin/java -jar 
$ORACLE_HOME_19/rdbms/admin/preupgrade.jar dir /tmp -c salespdb</code></pre></li>
                        <li>
                           <p>Run <code>preupgrade_fixups.sql</code> on your source database.
                           </p>
                           <p>For example:</p><pre class="pre codeblock"><code>CONNECT / AS SYSDBA
SQL&gt; ALTER SESSION SET CONTAINER=salespdb;

SQL&gt; @/tmp/preupgrade_fixups_salespdb.sql</code></pre></li>
                        <li>
                           <p>Follow all recommendations listed in <code class="codeph">preupgrade.log</code>.
                           </p>
                        </li>
                        <li>
                           <p>Close the PDB you want to unplug.</p>
                           <p>For example, use the following command to close the PDB <code class="codeph">salespdb</code>:
                           </p><pre class="pre codeblock"><code>SQL&gt; ALTER PLUGGABLE DATABASE salespdb CLOSE;
</code></pre></li>
                        <li>
                           <div class="p">Log back in to <code class="codeph">CDB$ROOT</code>:<pre class="pre codeblock"><code>CONNECT / AS SYSDBA
SQL&gt; ALTER SESSION SET CONTAINER=CDB$ROOT;
</code></pre></div>
                        </li>
                        <li>
                           <p>Unplug the earlier release PDB using the following SQL command syntax, where <code class="codeph"><span class="variable" translate="no">pdb</span></code> is the name of the PDB, and <code class="codeph"><span class="variable" translate="no">path</span></code> is the location of the PDB XML file:
                           </p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE <span class="variable" translate="no">pdb</span> UNPLUG INTO '<span class="variable" translate="no">path</span>/<span class="variable" translate="no">pdb</span>.xml';</code></pre><p>For example, where the pdb name is <code class="codeph">salespdb</code> and path is <code>/home/oracle/salespdb.xml</code>: 
                           </p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER PLUGGABLE DATABASE salespdb UNPLUG INTO '/home/oracle/salespdb.xml';
</pre><p>The following response displays when the command is completed: </p><pre class="pre codeblock"><code>Pluggable database altered</code></pre></li>
                        <li>
                           <p>Drop the pluggable database <code class="codeph">salespdb</code>, but keep data files.
                           </p>
                           <p>Oracle recommends that you drop <code class="codeph">salespdb</code> after this procedure to clean up leftover information in the CDB views, and to help to avoid future issues. As a best practice guideline, back up your PDB in the destination CDB first, and then issue the <code class="codeph">DROP</code> command on the source. 
                           </p>
                           <div class="infoboxnote" id="GUID-F1F89935-A2F1-4C3F-8138-FF34B3F01168__GUID-C961895F-16A0-4D2A-9DCC-B2FDF92447E1">
                              <p class="notep1">Caution:</p>
                              <p>After you drop the PDB from its original CDB, you cannot revert to it using previously taken backup, because the <code class="codeph">DROP</code> command removes backup files.
                              </p>
                           </div>
                           <p>To drop the pluggable database, enter the following command:</p><pre class="pre codeblock"><code>SQL&gt; DROP PLUGGABLE DATABASE salespdb KEEP DATAFILES; </code></pre></li>
                        <li>
                           <p>Exit. </p>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8F9AAFA1-690D-4F70-8448-E66D765AF136" title="To upgrade pluggable databases (PDBs) that are in an earlier release multitenant container databases (CDBs), Oracle Database Release 12c (12.1.0.1) and later, you can unplug the PDBs from the earlier release CDB, and plug the PDBs into the later release CDB.">Upgrading Multitenant Architecture Sequentially Using Unplug-Plug</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-E188F65A-8AE8-494F-80BD-7060AE02769E" name="GUID-E188F65A-8AE8-494F-80BD-7060AE02769E"></a><h4 id="UPGRD-GUID-E188F65A-8AE8-494F-80BD-7060AE02769E" class="sect4">Plugging in the Earlier Release PDB to the Later Release CDB</h4>
                  <div>
                     <p>To Plug the PDB from the earlier release CDB to the later release CDB, use the <code class="codeph">CREATE PLUGGABLE DATABASE</code> command. 
                     </p>
                     <p>This procedure example shows how to plug in a PDB when you are using Oracle-Managed Files. Refer to <cite>Oracle Database Administrator’s Guide</cite> for additional information about plugging in PDBs. 
                     </p>
                     <ol>
                        <li>
                           <p>Connect to the later release CDB.</p>
                        </li>
                        <li>
                           <p>Plug in the earlier release PDB using the following SQL command, where <code class="codeph"><span class="variable" translate="no">pdb</span></code> is the name of the PDB, and <code class="codeph"><span class="variable" translate="no">path</span></code> is the path where the PDB XML file is located:
                           </p>
                           <p><kbd class="userinput">CREATE PLUGGABLE DATABASE <span class="variable" translate="no">pdb</span> USING '<span class="variable" translate="no">path</span>/<span class="variable" translate="no">pdb</span>.xml';</kbd></p>
                           <p>For example:</p><pre class="pre codeblock"><code>SQL&gt; CREATE PLUGGABLE DATABASE salespdb USING '/home/oracle/salespdb.xml';
</code></pre><p>The following response displays when the command is completed:</p><pre class="pre codeblock"><code>Pluggable database created.</code></pre></li>
                     </ol>
                     <div class="infoboxnote" id="GUID-E188F65A-8AE8-494F-80BD-7060AE02769E__GUID-BDDDAFBC-3C75-4D12-9D3F-D42AEC7037BD">
                        <p class="notep1">Note:</p>
                        <p>When you plug in an earlier release PDB, the PDB is in restricted mode. You can only open the PDB for upgrade.</p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../multi/plugging-in-a-pdb.html#ADMIN13553" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8F9AAFA1-690D-4F70-8448-E66D765AF136" title="To upgrade pluggable databases (PDBs) that are in an earlier release multitenant container databases (CDBs), Oracle Database Release 12c (12.1.0.1) and later, you can unplug the PDBs from the earlier release CDB, and plug the PDBs into the later release CDB.">Upgrading Multitenant Architecture Sequentially Using Unplug-Plug</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-99657846-6859-43BF-A514-0C8A7786734D" name="GUID-99657846-6859-43BF-A514-0C8A7786734D"></a><h4 id="UPGRD-GUID-99657846-6859-43BF-A514-0C8A7786734D" class="sect4">Upgrading the Earlier Release PDB to the Later Release</h4>
                  <div>
                     <p>Open PDBs in <code class="codeph">UPGRADE</code> mode use the Parallel Upgrade Utility to carry out the upgrade of the earlier-release PDB to the release level of the CDB.
                     </p>
                     <ol>
                        <li>
                           <p>If needed, switch to the PDB that you want to upgrade. For example, enter the following command to switch to the PDB <code class="codeph">salespdb</code>:
                           </p><pre class="pre codeblock"><code>SQL&gt; ALTER SESSION SET CONTAINER=salespdb;</code></pre></li>
                        <li>
                           <p>Open the PDB in UPGRADE mode.</p><pre class="pre codeblock"><code>SQL&gt; ALTER PLUGGABLE DATABASE OPEN UPGRADE;
</code></pre></li>
                        <li>
                           <p>Upgrade the PDB using the Parallel Upgrade Utility command (<code>catctl.pl</code>, or the shell utility <code>dbupgrade</code>). 
                           </p>
                           <p>When you upgrade a PDB, you use the commands you normally use with the Parallel Upgrade Utility. However, you also add the option <code class="codeph">-c <span class="variable" translate="no">PDBname</span></code> to specify which PDB you are upgrading. Capitalize the name of your PDB as shown in the following example using the PDB named <code class="codeph">salespdb</code>:
                           </p><pre class="pre codeblock"><code>$ORACLE_HOME/perl/bin/perl $ORACLE_HOME/rdbms/admin/catctl.pl -d  \
$ORACLE_HOME/rdbms/admin -c 'salespdb' -l $ORACLE_BASE catupgrd.sql</code></pre></li>
                        <li>
                           <p>Review results. </p>
                           <p>The default file path for the logs is in the path <code><span class="variable" translate="no">Oracle_base</span>/cfgtoollogs/<span class="variable" translate="no">dbname</span>/<span class="variable" translate="no">upgradedatetime</span></code>, where <code class="codeph"><span class="variable" translate="no">Oracle_base</span></code> is the Oracle base path, <code class="codeph"><span class="variable" translate="no">dbname</span></code> is the database name, and <code class="codeph"><span class="variable" translate="no">upgradedatetime</span></code> is the date and time for the upgrade. The date and time strings are in the character string format <span class="variable" translate="no">YYYY</span><span class="variable" translate="no">MM</span><span class="variable" translate="no">DD</span><span class="variable" translate="no">HH</span><span class="variable" translate="no">MM</span><span class="variable" translate="no">SC</span>, in which <span class="variable" translate="no">YYYY</span> designates the year, <span class="variable" translate="no">MM</span> designates the month, <span class="variable" translate="no">DD</span> designates the day, <span class="variable" translate="no">HH</span> designates the hour, <span class="variable" translate="no">MM</span> designates the minute, and <span class="variable" translate="no">SC</span> designates the second.
                           </p>
                           <p>For example:</p><pre class="pre codeblock"><code>$ORACLE_BASE/cfgtoollogs/salespdb/upgrade20181015120001/upg_summary.log
</code></pre></li>
                        <li>
                           <p>Log in to SQL*Plus, and open the PDB to execute post-upgrade fixups, and to recompile the <code class="codeph">INVALID</code> objects in the database:
                           </p><pre class="pre codeblock"><code>SQL&gt; STARTUP;
SQL&gt; ALTER SESSION SET CONTAINER=salespdb;
</code></pre></li>
                        <li>
                           <p>Use the utility <code>catcon.pl</code> to run the script <code>postupgrade_fixups.sql</code>:
                           </p><pre class="pre codeblock"><code>$ORACLE_HOME/perl/bin/perl catcon.pl &#x2013;c 'salespdb' -n 1 -e -b postfixups -d '''.''' /tmp/cfgtoollogs/salespdb/preupgrade/postupgrade_fixups.sql</code></pre></li>
                        <li>
                           <p>Use the utility <code class="codeph">catcon.pl</code> to run <code>utlrp.sql</code> from the <code>$ORACLE_HOME/rdbms/admin</code> directory:
                           </p><pre class="pre codeblock"><code>$ORACLE_HOME/perl/bin/perl catcon.pl &#x2013;c 'salespdb'-n 1 -e -b comp -d '''.''' utlrp.sql</code></pre><p>The script recompiles <code class="codeph">INVALID</code> objects in the database, and places a log file in the current directory with the name <code class="codeph">comp0.log</code>.
                           </p>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8F9AAFA1-690D-4F70-8448-E66D765AF136" title="To upgrade pluggable databases (PDBs) that are in an earlier release multitenant container databases (CDBs), Oracle Database Release 12c (12.1.0.1) and later, you can unplug the PDBs from the earlier release CDB, and plug the PDBs into the later release CDB.">Upgrading Multitenant Architecture Sequentially Using Unplug-Plug</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-466B8807-EE9F-477E-BE59-600044BA882B" name="GUID-466B8807-EE9F-477E-BE59-600044BA882B"></a><h4 id="UPGRD-GUID-466B8807-EE9F-477E-BE59-600044BA882B" class="sect4">Use Inclusion or Exclusion Lists for PDB Upgrades</h4>
                  <div>
                     <p>If you want to upgrade a subset of earlier release PDBs, then use inclusion or exclusion lists to avoid reupgrading the CDB or PDBs that are at the new release level.</p>
                     <p>Oracle recommends that you record the containers that you upgrade, and use inclusion or exclusion lists to exclude these containers from successive bulk upgrades. Excluding upgraded containers from successive bulk upgrades ensures that the upgrade only runs on PDBs that require the upgrade. Avoiding reupgrades minimizes the overall upgrade time, and avoids unnecessary unavailability.</p>
                     <p>For example: If you have installed Oracle Database using a multitenant architecture deployment, then the containers <code class="codeph">CDB$ROOT</code>, <code class="codeph">PDB$SEED</code>, and any other PDBs created when the CDB was created, are part of the new release multitenant architecture. If you upgraded a CDB, and at the same time upgraded a set of PDBs to the new release, then you do not need to upgrade either the CDB containers or the upgraded PDBs again. 
                     </p>
                     <div class="p">In either case, when you plug in earlier release PDBs and then upgrade them, upgrade the PDBs with either an exclusion list, or an inclusion list:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Use an inclusion list to specify only the set of PDBs that you want to upgrade.</p>
                           </li>
                           <li>
                              <p>Use an exclusion list to exclude the CDB and PDB containers that are already upgraded.</p>
                           </li>
                        </ul>If you do not use an inclusion list or an exclusion list to limit the upgrade scope, then the Parallel Upgrade Utility (<code>catctl.pl</code>) attempts to upgrade the entire CDB, not just the PDBs that require the upgrade. During that upgrade process, your system undergoes needless downtime. The inclusion list and the exclusion list options are mutually exclusive.
                     </div>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="manual-upgrade-scenarios-multitenant-architecture-oracle-databases.html#GUID-8F9AAFA1-690D-4F70-8448-E66D765AF136" title="To upgrade pluggable databases (PDBs) that are in an earlier release multitenant container databases (CDBs), Oracle Database Release 12c (12.1.0.1) and later, you can unplug the PDBs from the earlier release CDB, and plug the PDBs into the later release CDB.">Upgrading Multitenant Architecture Sequentially Using Unplug-Plug</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>