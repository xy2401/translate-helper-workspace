<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="An explanation is given of how to use the XQuery API for Java (XQJ) to access Oracle XML DB.">
      <meta name="description" content="An explanation is given of how to use the XQuery API for Java (XQJ) to access Oracle XML DB.">
      <title>Using XQuery API for Java to Access Oracle XML DB</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content="An explanation is given of how to use the XQuery API for Java (XQJ) to access Oracle XML DB.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="xml-developers-kit-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T05:58:48-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96292-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-xquery-processor-for-Java.html" title="Previous" type="text/html">
      <link rel="next" href="using-XML-schema-processor-for-Java.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML Developers Kit Programmers Guide">
    <meta name="dcterms.isVersionOf" content="ADXDK">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-xquery-processor-for-Java.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-XML-schema-processor-for-Java.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XDK-for-Java.html" property="item" typeof="WebPage"><span property="name">Oracle XML Developer's Kit for Java</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Using XQuery API for Java to Access Oracle XML DB</li>
            </ol>
            <a id="GUID-DDFFD115-A115-4B6C-805C-350AF78281EB" name="GUID-DDFFD115-A115-4B6C-805C-350AF78281EB"></a><a id="ADXDK992"></a><a id="ADXDK136"></a>
            
            <h2 id="ADXDK-GUID-DDFFD115-A115-4B6C-805C-350AF78281EB" class="sect2"><span class="enumeration_chapter">16 </span>Using XQuery API for Java to Access Oracle XML DB
            </h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='using-xquery-API-for-Java-to-access-XML-DB'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
            </noscript>
            <div>
               <p>An explanation is given of how to use the XQuery API for Java (XQJ) to access Oracle XML DB.</p>
               <div class="section"> </div>
               <!-- class="section" -->
            </div><a id="ADXDK963"></a><div class="props_rev_3"><a id="GUID-4CCB8866-D4A3-4CB7-B08B-00C227CE6F0B" name="GUID-4CCB8866-D4A3-4CB7-B08B-00C227CE6F0B"></a><h3 id="ADXDK-GUID-4CCB8866-D4A3-4CB7-B08B-00C227CE6F0B" class="sect3">Introduction to Oracle XML DB Support for XQJ</h3>
               <div>
                  <p>XQuery API for Java (XQJ), also known as JSR-225, provides an industry-standard way for Java programs to access Extensible Markup Language (XML) data using XQuery. It lets you evaluate XQuery expressions against XML data sources and process the results as XML data.</p>
                  <p>Oracle provides two XQuery engines for evaluating XQuery expressions: one in Oracle XML DB, for use with XML data in the database, and one in Oracle XML Developer's Kit (XDK), for use with XML data outside the database. (See <a href="using-xquery-processor-for-Java.html#GUID-9E6570F0-37BB-4690-BFF6-A2052B5B57E8" title="An explanation is given of how to use the Oracle XML Developer's Kit (XDK) XQuery processor for Java.">Using the XQuery Processor for Java</a> for information about the XQuery engine for XDK).
                  </p>
                  <p>Oracle provides two different XQJ implementations for accessing these two XQuery engines. Both implementations are part of XDK, enabling you to use XDK to access XML data with a standard XQJ API whether that data resides in the database or elsewhere.</p>
                  <p>The queries executed by XQJ are written in standard World Wide Web Consortium (W3C) XQuery 1.0 language, as supported by Oracle XML DB. A typical use case for this feature is to access XML data stored in remote databases (in Oracle XML DB) from a local Java program.</p>
                  <p>General information about XQuery and XQJ is documented outside of this document.</p>
                  <div class="infoboxnotealso" id="GUID-4CCB8866-D4A3-4CB7-B08B-00C227CE6F0B__GUID-51568F89-4794-4BBA-B230-972A576E57D5">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../adxdb/intro-to-XML-DB.html#ADXDB0100" target="_blank"><span><cite>Oracle XML&nbsp;DB Developer’s Guide</cite></span></a> for more information about Oracle XML DB, including details about XQuery capabilities and support in Oracle XML DB
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">XQuery Packages</code> in <a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a> for the related API documentation
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=jcp_org_jsr225" target="_blank"><span class="italic">JSR-000225 XQuery API for Java</span></a>, which is very concrete and has understandable examples
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADXDK962"></a><div class="props_rev_3"><a id="GUID-D3053B76-1E68-4EAB-A47D-38D602772647" name="GUID-D3053B76-1E68-4EAB-A47D-38D602772647"></a><h4 id="ADXDK-GUID-D3053B76-1E68-4EAB-A47D-38D602772647" class="sect4">Prerequisites for Using XQJ to Access Oracle XML DB</h4>
                  <div>
                     <p>You need Java Runtime Environment 1.6 to use XQJ with Oracle XML DB. You also need certain Java Archive (JAR) files to be either in your <code class="codeph">CLASSPATH</code> environment variable or passed using command-line option <code class="codeph">classpath</code>.
                     </p>
                     <p>The JAR files are as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The required JAR files listed in <a href="using-xquery-processor-for-Java.html#GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA" title="XDK provides a standalone XQuery processor for use by Java applications. XQuery is the World Wide Web Consortium (W3C) standard query language for Extensible Markup Language (XML). Using XQuery to process XML within a Java application can improve developer productivity and application performance.">Introduction to the XQuery Processor for Java</a></p>
                        </li>
                        <li>
                           <p><code class="codeph">jdbc/lib/ojdbc6.jar</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rdbms/jlib/xdb6.jar</code></p>
                        </li>
                     </ul>
                     <p>The directory paths for these JAR files are relative to the <code class="codeph">ORACLE_HOME</code> directory of your database installation.
                     </p>
                  </div>
               </div>
            </div><a id="ADXDK210"></a><a id="ADXDK964"></a><a id="ADXDK209"></a><div class="props_rev_3"><a id="GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E" name="GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E"></a><h3 id="ADXDK-GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E" class="sect3">Examples: Using XQJ to Query Oracle XML DB</h3>
               <div>
                  <p>Examples here show how you can use XQJ to query and retrieve data in Oracle XML DB.</p>
                  <div class="section">
                     <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">Example 16-1</a> shows how to use XQJ to query data from a table in Oracle XML DB. It uses the <code class="codeph">WAREHOUSES</code> table in the Order Entry (OE) database sample schema. The OE sample schema contains XML documents with warehouse information in the <code class="codeph">WAREHOUSES</code> table. The <code class="codeph">WAREHOUSES</code> table contains an XMLType column <code class="codeph">warehouse_spec</code> and other columns. (See the discussion about standard database schemas in <a href="../adxdb/preface.html#ADXDB3910" target="_blank"><span><cite>Oracle XML&nbsp;DB Developer’s Guide</cite></span></a> for more information about the data used in this example.)
                     </p>
                     <p>Specifically, <a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">Example 16-1</a> shows how to perform these steps:
                     </p>
                     <ol>
                        <li>
                           <p>Get an XQJ connection to Oracle XML DB.</p>
                           <p>Every program using XQJ to connect to Oracle XML DB must first create an <code class="codeph">OXQDDataSource</code> object. Then, <code class="codeph">OXQDDataSource</code> must be initialized with the required property values before getting an XQJ connection to the Oracle XML DB instance.
                           </p>
                        </li>
                        <li>
                           <p>Prepare an XQuery expression.</p>
                        </li>
                        <li>
                           <p>Submit the XQuery expression for evaluation.</p>
                        </li>
                        <li>
                           <p>Print each item in the resulting XQuery sequence.</p>
                        </li>
                     </ol>
                     <p>In <a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">Example 16-1</a>, the XQuery expression accesses the <code class="codeph">WAREHOUSES</code> table through the use of the Universal Resource Identifier (URI) scheme <code class="codeph">oradb</code>. (See the discussion about the URI scheme <code class="codeph">oradb</code> in <a href="../adxdb/xquery-and-XML-DB.html#ADXDB5994" target="_blank"><span><cite>Oracle XML&nbsp;DB Developer’s Guide</cite></span></a> for more information about using XQuery with XML DB to query table or view data.)
                     </p>
                     <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">Example 16-1</a> also shows how to bind external variable values in XQJ. The query has an external variable <code class="codeph">$x</code>, which is used to filter the returned rows from the <code class="codeph">WAREHOUSES</code> table, by <code class="codeph">WAREHOUSE_ID</code>.
                     </p>
                     <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">Example 16-1</a> generates this output (reformatted for better readability):
                     </p><pre class="oac_no_warn" dir="ltr">&lt;Warehouse&gt;&lt;Building&gt;Owned&lt;/Building&gt;&lt;Area&gt;25000&lt;/Area&gt;&lt;Docks&gt;2&lt;/Docks&gt;
 &lt;DockType&gt;Rearload&lt;/DockType&gt;&lt;WaterAccess&gt;Y&lt;/WaterAccess&gt;
 &lt;RailAccess&gt;N&lt;/RailAccess&gt;&lt;Parking&gt;Street&lt;/Parking&gt;
 &lt;VClearance&gt;10 ft&lt;/VClearance&gt;&lt;/Warehouse&gt;

&lt;Warehouse&gt;&lt;Building&gt;Rented&lt;/Building&gt;&lt;Area&gt;50000&lt;/Area&gt;&lt;Docks&gt;1&lt;/Docks&gt;
 &lt;DockType&gt;Sideload&lt;/DockType&gt;&lt;WaterAccess&gt;Y&lt;/WaterAccess&gt;
 &lt;RailAccess&gt;N&lt;/RailAccess&gt;&lt;Parking&gt;Lot&lt;/Parking&gt;
 &lt;VClearance&gt;12 ft&lt;/VClearance&gt;&lt;/Warehouse&gt;
</pre><p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBBGDEJ">Example 16-2</a> shows how to use XQJ to retrieve data from the Oracle XML DB repository. This example assumes that two files, <code class="codeph">depts.xml</code> and <code class="codeph">emps.xml</code>, have been uploaded into the XML DB repository under the folder <code class="codeph">/public</code>. For example, you can use FTP to upload the two files into the Oracle XML DB repository. (See the discussion about using the Oracle XML DB repository in <a href="../adxdb/index.html" target="_blank"><span><cite>Oracle XML&nbsp;DB Developer’s Guide</cite></span></a> for more information about storing data in and using the Oracle XML DB Repository.)
                     </p>
                     <p>The content of <code class="codeph">depts.xml</code> is:
                     </p><pre class="oac_no_warn" dir="ltr">depts.xml:
 
&lt;?xml version="1.0"?&gt;
     &lt;depts&gt;
       &lt;dept deptno="10" dname="Administration"/&gt;
       &lt;dept deptno="20" dname="Marketing"/&gt;
       &lt;dept deptno="30" dname="Purchasing"/&gt;
     &lt;/depts&gt;
</pre><p>The content of <code class="codeph">emps.xml</code> is:
                     </p><pre class="oac_no_warn" dir="ltr">emps.xml:
 
&lt;?xml version="1.0"?&gt;
   &lt;emps&gt;
    &lt;emp empno="1" deptno="10" ename="John"  salary="21000"/&gt;
       &lt;emp empno="2" deptno="10" ename="Jack" salary="310000"/&gt;
       &lt;emp empno="3" deptno="20" ename="Jill" salary="100001"/&gt;
     &lt;/emps&gt;
</pre><p>You can use the <code class="codeph">fn:doc</code> and <code class="codeph">fn:collection</code> functions to query the data in the Oracle XML DB repository with XQuery. <a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBBGDEJ">Example 16-2</a> shows how to use the <code class="codeph">fn:doc</code> function within XQuery to access the repository. (See the discussion about querying XML data in the Oracle XML DB repository in <a href="../adxdb/query-and-update-XML.html#ADXDB5125" target="_blank"><span><cite>Oracle XML&nbsp;DB Developer’s Guide</cite></span></a> for more information about using these XQuery functions.)
                     </p>
                     <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBBGDEJ">Example 16-2</a> generates this output:
                     </p><pre class="oac_no_warn" dir="ltr">&lt;emp ename="Jack" dept="Administration"/&gt;
&lt;emp ename="Jill" dept="Marketing"/&gt;</pre></div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">
                     <p class="titleinexample">Example 16-1 Using XQJ to Query an XML DB Table with XQuery</p><pre class="oac_no_warn" dir="ltr">import oracle.xml.xquery.xqjdb.OXQDDataSource;
 
import javax.xml.xquery.XQItemType;
import javax.xml.xquery.XQResultSequence;
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.namespace.QName;
 
public class example1
{
  public static void main(String argv[])
  {
    try
    {
      // Create a new OXQDDataSource for connecting to Oracle XML DB
      OXQDDataSource oxqDS = new OXQDDataSource();
      // Set appropriate connection information for the database instance.
      // Must use the thin driver
      oxqDS.setProperty("driver", "jdbc:oracle:thin");
      oxqDS.setProperty("dbusername", "oe");
      oxqDS.setProperty("dbpassword", "oe");
      // Machine hostname
      oxqDS.setProperty("dbserver", "myserver");
      // Database instance port number
      oxqDS.setProperty("dbport", "6479");
      // Database instance port number
      oxqDS.setProperty("serviceName", "mydbinstance");
      XQConnection conn = oxqDS.getConnection();
      XQItemType  itemTypeInt = conn.createAtomicType(XQItemType.XQBASETYPE_INT);
      XQPreparedExpression expr = conn.prepareExpression("declare variable $x as
        xs:int external; for $i in fn:collection('oradb:/OE/WAREHOUSES') where
          $i/ROW/WAREHOUSE_ID &lt; $x return $i/ROW/WAREHOUSE_SPEC/Warehouse");
      expr.bindInt(new QName("x"), 3, itemTypeInt);
      XQResultSequence xqSeq = expr.executeQuery();
      while (xqSeq.next())
         System.out.println (xqSeq.getItemAsString(null));
     }
     catch (Exception e)
     {
      e.printStackTrace();
     }
  }
}
</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBBGDEJ">
                     <p class="titleinexample">Example 16-2 Using XQJ to Query the XML DB Repository with XQuery</p><pre class="oac_no_warn" dir="ltr">import oracle.xml.xquery.xqjdb.OXQDDataSource;
 
import javax.xml.xquery.XQItemType;
import javax.xml.xquery.XQResultSequence;
import javax.xml.xquery.XQConnection;
import javax.xml.xquery.XQPreparedExpression;
import javax.xml.namespace.QName;

public class example2
{
  public static void main(String argv[])
  {
    try
    {
      // Create a new OXQDDataSource for connecting to Oracle XML DB
      OXQDDataSource oxqDS = new OXQDDataSource();
      // Set appropriate connection information for the database instance.
      // Must use the thin driver
      oxqDS.setProperty("driver", "jdbc:oracle:thin");
      oxqDS.setProperty("dbusername", "oe");
      oxqDS.setProperty("dbpassword", "oe");
      // Machine hostname
      oxqDS.setProperty("dbserver", "myserver");
      // Database instance port number
      oxqDS.setProperty("dbport", "6479");
      // Database instance port number
      oxqDS.setProperty("serviceName", "mydbinstance");
      XQConnection conn = oxqDS.getConnection();
      XQPreparedExpression expr = conn.prepareExpression("for $e in
        doc(\"/public/emps.xml\")/emps/emp let $d :=
        doc(\"/public/depts.xml\")//dept[@deptno = $e/@deptno]/@dname where
        $e/@salary &gt; 100000 order by $e/@empno return 
        &lt;emp ename=\"{$e/@ename}\" dept=\"{$d}\"/&gt;");
      XQResultSequence xqSeq = expr.executeQuery();
      while (xqSeq.next())
         System.out.println (xqSeq.getItemAsString(null));
     }
     catch (Exception e)
     {
      e.printStackTrace();
     }
  }
}
</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK202"></a><a id="ADXDK201"></a><a id="ADXDK137"></a><div class="props_rev_3"><a id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A" name="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A"></a><h3 id="ADXDK-GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A" class="sect3">XQJ Support for Oracle XML DB</h3>
               <div>
                  <p>The two Oracle XQJ implementations differ in some respects. Oracle XML DB support for XQJ is described. </p>
                  <p><a href="using-xquery-processor-for-Java.html#GUID-9E6570F0-37BB-4690-BFF6-A2052B5B57E8" title="An explanation is given of how to use the Oracle XML Developer's Kit (XDK) XQuery processor for Java.">Using the XQuery Processor for Java</a> provides information about using XQJ to access the mid-tier XQuery engine.
                  </p>
                  <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBEAIA" title="This table describes the OXQDDataSource properties to be used for connection to Oracle XML DB. OXQDataSource Properties">Table 16-1</a> describes the OXQDDataSource properties to be used for connection to Oracle XML DB. To create an XQJ connection to Oracle XML DB, you must set the values for these properties. You must set either the <code class="codeph">dbname</code> or the <code class="codeph">serviceName</code> property value, and all the other OXQDDataSource property values listed in <a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBEAIA" title="This table describes the OXQDDataSource properties to be used for connection to Oracle XML DB. OXQDataSource Properties">Table 16-1</a>.
                  </p>
                  <div class="tblformalwide" id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBEAIA">
                     <p class="titleintable">Table 16-1 OXQDDataSource Properties</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="OXQDDataSource Properties" summary="This table describes the OXQDDataSource properties to be used for connection to Oracle XML DB. OXQDataSource Properties" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="13%" id="d60904e680">Property</th>
                              <th align="left" valign="bottom" width="52%" id="d60904e683">Value</th>
                              <th align="left" valign="bottom" width="18%" id="d60904e686">Get Method</th>
                              <th align="left" valign="bottom" width="18%" id="d60904e689">Set Method</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e694" headers="d60904e680 ">
                                 <p><code class="codeph">driver</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e694 d60904e683 ">
                                 <p><code class="codeph">jdbc:oracle:thin</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e694 d60904e686 ">
                                 <p><code class="codeph">getDriver</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e694 d60904e689 ">
                                 <p><code class="codeph">setDriver</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e711" headers="d60904e680 ">
                                 <p><code class="codeph">dbusername</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e711 d60904e683 ">
                                 <p>Database schema (user) name</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e711 d60904e686 ">
                                 <p><code class="codeph">getDBUserName</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e711 d60904e689 ">
                                 <p><code class="codeph">setDBUserName</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e727" headers="d60904e680 ">
                                 <p><code class="codeph">dbpassword</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e727 d60904e683 ">
                                 <p>Password for database schema</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e727 d60904e686 ">
                                 <p><code class="codeph">getDBPassword</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e727 d60904e689 ">
                                 <p><code class="codeph">setDBPassword</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e743" headers="d60904e680 ">
                                 <p><code class="codeph">dbserver</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e743 d60904e683 ">
                                 <p>Host name for the database instance</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e743 d60904e686 ">
                                 <p><code class="codeph">getDBServer</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e743 d60904e689 ">
                                 <p><code class="codeph">setDBServer</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e759" headers="d60904e680 ">
                                 <p><code class="codeph">dbport</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e759 d60904e683 ">
                                 <p>Port number of the database instance for XQJ connection</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e759 d60904e686 ">
                                 <p><code class="codeph">getDBPort</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e759 d60904e689 ">
                                 <p><code class="codeph">setDBPort</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e775" headers="d60904e680 ">
                                 <p><code class="codeph">dbname</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e775 d60904e683 ">
                                 <p>Database instance name (service id)<a id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBCCFH" name="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBCCFH" href="#GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBCCFH" onclick="footdisplay(1, "You can identify the database using either the service id or the service name.")"><sup>Foot&nbsp;1</sup></a></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e775 d60904e686 ">
                                 <p><code class="codeph">getDBName</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e775 d60904e689 ">
                                 <p><code class="codeph">setDBName</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e794" headers="d60904e680 ">
                                 <p><code class="codeph">serviceName</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e794 d60904e683 ">
                                 <p>Service name<a id="fnsrc_d60904e801" name="fnsrc_d60904e801" href="#fnsrc_d60904e801" onclick="footdisplay(1, "You can identify the database using either the service id or the service name.")"><sup>Footref&nbsp;1</sup></a></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e794 d60904e686 ">
                                 <p><code class="codeph">getServiceName</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e794 d60904e689 ">
                                 <p><code class="codeph">setServiceName</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1 </sup></p><p>You can identify the database using either the service id or the service name.</p>
                  <p></p>
                  <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBHICIJ" title="Oracle XML DB Support for XQJ">Table 16-2</a> describes the Oracle XML DB support for optional XQJ features.
                  </p>
                  <div class="infoboxnote" id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__GUID-47A8F4C2-94C1-40F6-96A7-A40E8D0A9C6D">
                     <p class="notep1">Note:</p>
                     <p>Oracle XML DB support for some XQJ features differs from their support by the mid-tier XQuery engine. In particular, the Oracle XML DB XQJ implementation does not support the use of user-defined types.</p>
                  </div>
                  <div class="tblformalwide" id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBHICIJ">
                     <p class="titleintable">Table 16-2 Oracle XML DB Support for Optional XQJ Features</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="Oracle XML DB Support for Optional XQJ Features" summary="Oracle XML DB Support for XQJ" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="55%" id="d60904e830">XQJ Feature</th>
                              <th align="left" valign="bottom" width="45%" id="d60904e833">Oracle XML DB Support</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e838" headers="d60904e830 ">
                                 <p>Class name of <code class="codeph">XQDataSource</code> implementation
                                 </p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e838 d60904e833 ">
                                 <p><code class="codeph">oracle.xml.xquery.xqjdb.OXQDDataSource</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e849" headers="d60904e830 ">
                                 <p>JDBC connections</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e849 d60904e833 ">
                                 <p>Not supported.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e856" headers="d60904e830 ">
                                 <p>Properties defined on <code class="codeph">OXQDDataSource</code> (connection information)
                                 </p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e856 d60904e833 ">
                                 <p>See <a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBEAIA" title="This table describes the OXQDDataSource properties to be used for connection to Oracle XML DB. OXQDataSource Properties">Table 16-1</a>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e871" headers="d60904e830 ">
                                 <p>Commands</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e871 d60904e833 ">
                                 <p>Not supported.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e878" headers="d60904e830 ">
                                 <p><code class="codeph">XQPreparedExpression.cancel</code> (cancelling of query execution)
                                 </p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e878 d60904e833 ">
                                 <p>Not supported.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e887" headers="d60904e830 ">
                                 <p>Serialization</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e887 d60904e833 ">
                                 <p>Only parameter <code class="codeph">method</code> with value <code class="codeph">xml</code> and parameter <code class="codeph">encoding</code> with value <code class="codeph">UTF-8</code> or <code class="codeph">UTF-16</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e909" headers="d60904e830 ">
                                 <p>Additional StAX and SAX events</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e909 d60904e833 ">
                                 <p>Not supported.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e916" headers="d60904e830 ">
                                 <p>User-defined schema types</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e916 d60904e833 ">
                                 <p>Not supported.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e923" headers="d60904e830 ">
                                 <p>Node identity, document order, and full-node context preservation when a node is bound to an external variable</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e923 d60904e833 ">
                                 <p>Not supported.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e930" headers="d60904e830 ">
                                 <p>Login timeout</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e930 d60904e833 ">
                                 <p>Not supported.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e937" headers="d60904e830 ">
                                 <p>Transactions</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e937 d60904e833 ">
                                 <p>Not supported.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e945" headers="d60904e830 ">
                                 <p>Behavior of <code class="codeph">XQItemAccessor</code> method <code class="codeph">getNodeUri()</code> when the input node is not a document node
                                 </p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e945 d60904e833 ">
                                 <p>Return <code class="codeph">NULL</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e961" headers="d60904e830 ">
                                 <p>Behavior of <code class="codeph">XQItemType</code> method <code class="codeph">getTypeName()</code> for anonymous types
                                 </p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e961 d60904e833 ">
                                 <p>Return <code class="codeph">false</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e977" headers="d60904e830 ">
                                 <p>Behavior of <code class="codeph">XQItemType</code> method <code class="codeph">getSchemaURI()</code></p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e977 d60904e833 ">
                                 <p>Return <code class="codeph">NULL</code> or the schema URI provided during type creation. Currently, the Oracle XML DB XQJ implementation does not use the schema URI to get type information, and user-defined types are not supported.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e992" headers="d60904e830 ">
                                 <p>Behavior of <code class="codeph">XQDataFactory</code> methods <code class="codeph">createItemFromDocument()</code> and <code class="codeph">bindDocument()</code> if the input is not a well-formed XML document
                                 </p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e992 d60904e833 ">
                                 <p>Raise an exception.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e1008" headers="d60904e830 ">
                                 <p>Additional error codes returned from <code class="codeph">XQQueryException</code></p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e1008 d60904e833 ">
                                 <p>Not supported.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e1017" headers="d60904e830 ">
                                 <p>Interfaces <code class="codeph">ConnectionPoolXQDataSource</code>, <code class="codeph">PooledXQConnection</code>, <code class="codeph">XQConnectionEvent</code>, <code class="codeph">XQConnectionEventListener</code></p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e1017 d60904e833 ">
                                 <p>Not supported.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e1035" headers="d60904e830 "><pre class="oac_no_warn" dir="ltr">XQDataSource.getConnection(
  java.sql.Connection)</pre></td>
                              <td align="left" valign="top" width="45%" headers="d60904e1035 d60904e833 ">
                                 <p>Not supported. (JDBC connections are not supported.)</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e1042" headers="d60904e830 "><pre class="oac_no_warn" dir="ltr">XQDataSource.getConnection(
  java.lang.String,
  java.lang.String)</pre></td>
                              <td align="left" valign="top" width="45%" headers="d60904e1042 d60904e833 ">
                                 <p>Same as <code class="codeph">getConnection()</code> with no arguments: the arguments are ignored.
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="infoboxnotealso" id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__GUID-184746E1-31CC-4633-B897-9B58DBFD6684">
                     <p class="notep1">See Also:</p>
                     <p><a href="../adxdb/xquery-and-XML-DB.html#ADXDB1700" target="_blank"><span><cite>Oracle XML&nbsp;DB Developer’s Guide</cite></span></a> for information about using the XQuery language with Oracle XML DB
                     </p>
                  </div>
               </div><a id="ADXDK207"></a><div class="props_rev_3"><a id="GUID-E2322A10-4973-40D6-B050-897FA1CC0972" name="GUID-E2322A10-4973-40D6-B050-897FA1CC0972"></a><h4 id="ADXDK-GUID-E2322A10-4973-40D6-B050-897FA1CC0972" class="sect4">Other Oracle XML DB XQJ Support Limitations</h4>
                  <div>
                     <p>The limitations of Oracle XML DB support for XQJ are described. None of them apply to mid-tier XQuery engine support for XQJ.</p>
                     <p>Oracle XML DB support for XQJ is limited in these ways:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>All Oracle XML DB XQuery support limitations apply to Oracle XML DB support for XQJ as well.</p>
                        </li>
                        <li>
                           <p>Only the XDK Document Object Model (DOM) is supported. Use of any other DOM can cause errors.</p>
                        </li>
                        <li>
                           <p>Do not expect the Oracle XML DB XQJ implementation to be interoperable with another XQJ implementation, including the XDK Java implementation of XQJ. (See the XQJ standard (JSR-225) for the meaning of "interoperable".)</p>
                        </li>
                        <li>
                           <p><code class="codeph">XQDataSource</code> methods <code class="codeph">getLogWriter</code> and <code class="codeph">setLogWriter</code> have no effect (they are ignored).
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">XQStaticContent</code> methods <code class="codeph">getBoundarySpacePolicy</code>, <code class="codeph">setBoundarySpacePolicy</code>, <code class="codeph">getDefaultCollation</code>, and <code class="codeph">setDefaultCollation</code> have no effect (they are ignored).
                           </p>
                        </li>
                        <li>
                           <p>The copy namespaces mode for <code class="codeph">XQStaticContent</code> methods <code class="codeph">setCopyNamespacesModPreserve</code> and <code class="codeph">setCopyNamespacesModeInherit</code> has no effect (it is ignored). The values used are always <code class="codeph">preserve</code> and <code class="codeph">inherit</code>, respectively.
                           </p>
                        </li>
                        <li>
                           <p>Use of <code class="codeph">XQDynamicContext</code> methods to bind <code class="codeph">DocumentFragment</code> objects is not supported.
                           </p>
                        </li>
                        <li>
                           <p>Values of type <code class="codeph">xs:duration</code> are not supported. Using an <code class="codeph">XQDynamicContext</code> method to bind <code class="codeph">xs:duration</code>, or accessing an <code class="codeph">xs:duration</code> value, raises an error.
                           </p>
                        </li>
                        <li>
                           <p>The year of a <code class="codeph">xs:date</code>, <code class="codeph">xs:dateTime</code>, <code class="codeph">xs:gYear</code>, and <code class="codeph">xs:gYearMonth</code> value must be from -4712 to 9999, inclusive. Using a year outside this range can raise an error or produce unpredictable results.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADXDK208"></a><div class="props_rev_3"><a id="GUID-1A6A963C-2C86-4592-A82A-5CFC1DCDE373" name="GUID-1A6A963C-2C86-4592-A82A-5CFC1DCDE373"></a><h3 id="ADXDK-GUID-1A6A963C-2C86-4592-A82A-5CFC1DCDE373" class="sect3">XQJ Performance Considerations for Use with Oracle XML DB</h3>
               <div>
                  <p>To fetch a sequence of items from the database, use <code class="codeph">XQResultSequence</code> method <code class="codeph">next()</code> to retrieve a single item at a time; then use an <code class="codeph">XQItemAccessor</code> method to fetch all data corresponding to that item.
                  </p>
                  <p>This provides better performance than using these whole-sequence fetch methods, which each materialize the entire sequence before returning any data.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">getSequenceAsStream()</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">getSequenceAsString(java.util.Properties props)</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">writeSequence(java.io.OutputStream os, java.util.Properties props)</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">writeSequence(java.io.Writer ow, java.util.Properties props)</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">writeSequenceToResult(javax.xml.transform.Result result)</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">writeSequenceToSAX(org.xml.sax.ContentHandler saxhdlr)</code></p>
                     </li>
                  </ul>
                  <p>For example, if you invoke <code class="codeph">getSequenceAsStream()</code>, all of the XQuery result sequence data is fetched from the database before the <code class="codeph">XMLStreamReader</code> instance that is built from it is returned to your program.
                  </p>
                  <p>Be aware also that items themselves are not streamable: the item accessor methods always materialize an entire item before outputting any part of it. </p>
                  <p>For inputting, all bind methods defined on <code class="codeph">XQDynamicContext</code> fully materialize the input data before passing it to the database. 
                  </p>
                  <p>For example, when you invoke <code class="codeph">bindDocument(javax.xml.namespace.QName varName, javax.xml.stream.XMLStreamReader value, XQItemType type)</code>, all the data that is referenced by the input <code class="codeph">XMLStreamReader</code> instance is processed before the external XQuery variable is bound to it.
                  </p>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>