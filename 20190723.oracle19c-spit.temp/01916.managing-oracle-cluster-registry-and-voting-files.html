<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Oracle Clusterware includes two important components that manage configuration and node membership: Oracle Cluster Registry (OCR), which also includes the local component Oracle Local Registry (OLR), and voting files.">
      <meta name="description" content="Oracle Clusterware includes two important components that manage configuration and node membership: Oracle Cluster Registry (OCR), which also includes the local component Oracle Local Registry (OLR), and voting files.">
      <title>Managing Oracle Cluster Registry and Voting Files</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Clusterware Administration and Deployment Guide">
      <meta property="og:description" content="Oracle Clusterware includes two important components that manage configuration and node membership: Oracle Cluster Registry (OCR), which also includes the local component Oracle Local Registry (OLR), and voting files.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Clusterware Administration and Deployment Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="clusterware-administration-and-deployment-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-04-24T07:05:38-07:00">
      <meta name="dcterms.title" content="Clusterware Administration and Deployment Guide">
      <meta name="dcterms.dateCopyrighted" content="2007, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E95727-05">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="rapid-home-provisioning.html" title="Previous" type="text/html">
      <link rel="next" href="adding-and-deleting-cluster-nodes.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CWADD">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rapid-home-provisioning.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="adding-and-deleting-cluster-nodes.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Clusterware Administration and Deployment Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Managing Oracle Cluster Registry and Voting Files</li>
            </ol>
            <a id="GUID-70E524E1-0FAD-4962-9B9F-0691EAEE7A9F" name="GUID-70E524E1-0FAD-4962-9B9F-0691EAEE7A9F"></a><a id="CWADD92368"></a>
            
            <h2 id="CWADD-GUID-70E524E1-0FAD-4962-9B9F-0691EAEE7A9F" class="sect2"><span class="enumeration_chapter">6 </span>Managing Oracle Cluster Registry and Voting Files
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Clusterware includes two important components that manage configuration and node membership: Oracle Cluster Registry (OCR), which also includes the local component Oracle Local Registry (OLR), and voting files.</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p>OCR stores Oracle Clusterware and Oracle RAC database configuration information</p>
                  </li>
                  <li>
                     <p>OLR resides on every node in the cluster and manages Oracle Clusterware configuration information for each particular node</p>
                  </li>
                  <li>
                     <p>Voting files store information about node membership. Each voting file must be accessible by all nodes in the cluster for nodes to be members of the cluster</p>
                  </li>
               </ul>
               <p></p>
               <div class="infoboxnote" id="GUID-70E524E1-0FAD-4962-9B9F-0691EAEE7A9F__GUID-966156EE-A381-46C5-A60F-9C911005ACCF">
                  <p class="notep1">Notes:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Oracle Clusterware 12<span class="italic">c</span> does not support the use of raw or block devices. To upgrade to Oracle Clusterware 12<span class="italic">c</span> from a previous Oracle Clusterware release on which you were using raw or block devices, you must migrate OCR and voting files to Oracle Automatic Storage Management (Oracle ASM) or a shared file system before you upgrade.
                        </p>
                     </li>
                     <li>
                        <p>You can store OCR and voting files on Oracle ASM or a shared file system on Standalone Clusters. </p>
                        <p>In Oracle Database 12c Release 2 (12.2), the placement of  OCR and voting disk files directly on a shared file system was desupported. Starting with Oracle Database 19c (19.3), that desupport is rescinded for Standalone Clusters. For Oracle Domain Services Clusters, you must continue to place OCR and voting disk files in disk groups managed by Oracle ASM.</p>
                     </li>
                  </ul>
               </div>
               <p>Oracle recommends that you configure multiple voting files during Oracle Clusterware installation to improve availability. If you choose to put the voting files into an Oracle ASM disk group, then Oracle ASM ensures the configuration of multiple voting files if you use a normal or high redundancy disk group. If you choose to store the voting files on a shared file system, then select the option to configure multiple voting files, in which case you will have to specify three different file systems based on different disks.</p>
               <p>If necessary, you can dynamically add or replace voting files after you complete the Oracle Clusterware installation process without stopping the cluster.</p>
               <p>This chapter includes the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-20101C89-B87C-49C9-BA63-634376EDB62E" title="Use OCRCONFIG, OCRDUMP, and OCRCHECK to manage OCR and the Oracle Local Registry (OLR).">Managing Oracle Cluster Registry and Oracle Local Registry</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81" title="If you choose to store your voting files in Oracle ASM, then Oracle ASM stores all the voting files for the cluster in the disk group you choose.Oracle Clusterware automatically backs up voting file data in OCR as part of any configuration change and automatically restores the data to any voting file you add.">Managing Voting Files</a></p>
                  </li>
               </ul>
            </div><a id="CWADD70700"></a><div class="props_rev_3"><a id="GUID-20101C89-B87C-49C9-BA63-634376EDB62E" name="GUID-20101C89-B87C-49C9-BA63-634376EDB62E"></a><h3 id="CWADD-GUID-20101C89-B87C-49C9-BA63-634376EDB62E" class="sect3">Managing Oracle Cluster Registry and Oracle Local Registry</h3>
               <div>
                  <p>Use OCRCONFIG, OCRDUMP, and OCRCHECK to manage OCR and the Oracle Local Registry (OLR).</p>
                  <p>OCR contains information about all Oracle resources in the cluster.</p>
                  <p>OLR is a registry similar to OCR located on each node in a cluster, 	but contains information specific to each node. It contains manageability information about Oracle Clusterware, including dependencies between various services. Oracle High Availability Services uses this information. OLR is located on local storage on each node in a cluster. Its default location is in the path <code class="codeph"><span class="variable" translate="no">Grid_home</span>/cdata<span class="variable" translate="no">host_name</span>.olr</code>, where <code class="codeph"><span class="variable" translate="no">Grid_home</span></code> is the Oracle Grid Infrastructure home, and <code class="codeph"><span class="variable" translate="no">host_name</span></code> is the host name of the node.
                  </p>
                  <p>Administering OCR is decribed in the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC" title="With the Oracle Clusterware storage residing in an Oracle ASM disk group, you can manage both database and clusterware storage using Oracle Enterprise Manager.">Migrating Oracle Cluster Registry to Oracle Automatic Storage Management</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034" title="Manage OCR locations using OCRCONFIG.">Adding_ Replacing_ Repairing_ and Removing Oracle Cluster Registry Locations</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60">Backing Up Oracle Cluster Registry</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-648BB199-AFB9-416A-8438-E0331C255E78" title="A procedure for OCR restoration for your platform.">Restoring Oracle Cluster Registry</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-D3B9559B-054A-4574-854E-9865FEDF5EDD" title="Use the OCRDUMP and OCRCHECK utilities to diagnose OCR problems.">Diagnosing Oracle Cluster Registry Problems</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E" title="Use this procedure to import OCR on Linux or UNIX systems.Use this procedure to import OCR on Windows systems.">Administering Oracle Cluster Registry with Export and Import Commands</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07">Oracle Local Registry</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-1D3FDBE6-03ED-49B9-A181-2463C59331DA">Upgrading and Downgrading the Oracle Cluster Registry Configuration</a></p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="oracle-cluster-registry-utility-reference.html#GUID-D881BC9C-74F0-44A5-91EC-0341C1C81ED4" title="Use the ocrconfig command to manage OCR. Using this utility you can import, export, add, delete, restore, overwrite, backup, repair, replace, move, upgrade, or downgrade OCR.">About OCRCONFIG</a></li>
                        <li><a href="oracle-cluster-registry-utility-reference.html#GUID-AAEF4603-0943-434D-8152-5A71BD6976B1">Troubleshooting Oracle Cluster Registry</a></li>
                     </ul>
                  </div>
               </div><a id="CWADD91099"></a><div class="props_rev_3"><a id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC" name="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC"></a><h4 id="CWADD-GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC" class="sect4">Migrating Oracle Cluster Registry to Oracle Automatic Storage Management</h4>
                  <div>
                     <p>With the Oracle Clusterware storage residing in an Oracle ASM disk group, you can manage both database and clusterware storage using Oracle Enterprise Manager.</p>
                     <div class="section">
                        <p>To improve Oracle Clusterware storage manageability, OCR is configured, by default, to use Oracle ASM in Oracle Database 12<span class="italic">c</span>. However, if you upgrade from a previous version of Oracle Clusterware, you can migrate OCR to reside on Oracle ASM, and take advantage of the improvements in managing Oracle Clusterware storage.
                        </p>
                        <div class="infoboxnote" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-66A5C727-16DC-4472-AB00-6E292BA62DC5">
                           <p class="notep1">Note:</p>
                           <p>If you upgrade from a previous version of Oracle Clusterware to Oracle Clusterware 12<span class="italic">c</span> and you want to store OCR in an Oracle ASM disk group, then you must set the <span class="bold">ASM Compatibility</span> compatibility attribute to <code class="codeph">11.2.0.2</code>, or later.
                           </p>
                        </div>
                        <p>To migrate OCR to Oracle ASM using OCRCONFIG:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Ensure the upgrade to Oracle Clusterware 12<span class="italic">c</span> is complete. Run the following command to verify the current running version:</span><div><pre class="pre codeblock"><code>$ crsctl query crs activeversion</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Use the Oracle ASM Configuration Assistant (ASMCA) to configure and start Oracle ASM on all nodes in the cluster.</span><div></div>
                        </li>
                        <li class="stepexpand"><span>Use ASMCA to create an Oracle ASM disk group that is at least the same size of the existing OCR and has at least normal redundancy.</span><div>
                              <div class="infoboxnote" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-F34C5E10-56DE-40B5-BBE1-C8BAA9F54E0E">
                                 <p class="notep1">Note:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>If OCR is stored in an Oracle ASM disk group with external redundancy, then Oracle recommends that you add another OCR location to another disk group to avoid the loss of OCR, if a disk fails in the disk group.</p>
                                       <p>Oracle does not support storing OCR on different storage types simultaneously, such as storing OCR on both Oracle ASM and a shared file system, except during a migration.</p>
                                    </li>
                                    <li>
                                       <p>If an Oracle ASM instance fails on any node, then OCR becomes unavailable on that particular node.</p>
                                       <p>If the CRSD process running on the node affected by the Oracle ASM instance failure is the <a href="glossary.html#GUID-20E48152-87E0-4668-B8E6-3B0CF469B544"><span class="xrefglossterm">OCR writer</span></a>, the majority of the OCR locations are stored in Oracle ASM, and you attempt I/O on OCR during the time the Oracle ASM instance is down on this node, then CRSD stops and becomes inoperable. Cluster management is now affected on this particular node.
                                       </p>
                                       <p>Under no circumstances will the failure of one Oracle ASM instance on one node affect the whole cluster.</p>
                                    </li>
                                    <li>
                                       <p>Ensure that Oracle ASM disk groups that you create are mounted on all of the nodes in the cluster.</p>
                                    </li>
                                 </ul>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>To add OCR to an Oracle ASM disk group, ensure that the <a href="glossary.html#GUID-C1F07478-A146-48E0-94E2-A93F6ED7B34A"><span class="xrefglossterm">Oracle Clusterware stack</span></a> is running and run the following command as <code class="codeph">root</code>:</span><div><pre class="pre codeblock"><code># ocrconfig -add +<span class="variable" translate="no">new_disk_group</span></code></pre><p>You can run this command more than once if you add multiple OCR locations. You can have up to five OCR locations. However, each successive run must point to a different disk group. </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>To remove storage configurations no longer in use, run the following command as <code class="codeph">root</code>:</span><div><pre class="pre codeblock"><code># ocrconfig -delete <span class="variable" translate="no">old_storage_location</span></code></pre><p>Run this command for every configured OCR.</p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>The following example shows how to migrate two OCRs to Oracle ASM using OCRCONFIG.</p><pre class="pre codeblock"><code># ocrconfig -add +<span class="variable" translate="no">new_disk_group</span>
# ocrconfig -delete /ocrdata/ocr_1
# ocrconfig -delete /ocrdata/ocr_2</code></pre><div class="infoboxnote" id="GUID-94CE3710-770D-45BB-B67B-0A2BC6DBE3AC__GUID-88CE998C-0FE6-4468-B3A3-E829ABAC7929">
                           <p class="notep1">Note:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>OCR inherits the redundancy of the disk group. If you want high redundancy for OCR, you must configure the disk group with high redundancy when you create it.</p>
                              </li>
                              <li>
                                 <p>Oracle recommends that you put the SPFILE for Oracle ASM in this newly-created OCR location.</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../ostmg/diskgroup-compatibility.html#OSTMG-GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                           <li><a href="../ostmg/manage-asm-asmca.html#OSTMG-GUID-C29F444F-C440-450B-A13B-84CC2147826F" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                           <li><a href="../ostmg/asmcmd-instance-commands.html#OSTMG-GUID-8946D285-8EAF-4466-8985-BDE95EE5B0C7" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                           <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div><a id="CWADD91101"></a><div class="props_rev_3"><a id="GUID-45585A36-F1D3-49AC-B2FB-4EE0F608C6DF" name="GUID-45585A36-F1D3-49AC-B2FB-4EE0F608C6DF"></a><h5 id="CWADD-GUID-45585A36-F1D3-49AC-B2FB-4EE0F608C6DF" class="sect5">Migrating Oracle Cluster Registry from Oracle ASM to Other Types of Storage</h5>
                     <div>
                        <div class="section">
                           <p>To <a id="d37753e788" class="indexterm-anchor"></a><a id="d37753e792" class="indexterm-anchor"></a><a id="d37753e798" class="indexterm-anchor"></a>migrate OCR from Oracle ASM to another storage type:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Ensure the upgrade to Oracle Clusterware 12<span class="italic">c</span> is complete. Run the following command to verify the current running version:</span><div><pre class="oac_no_warn" dir="ltr">$ crsctl query crs activeversion
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create a file in a shared or cluster file system with the following permissions: <code class="codeph">root</code>, <code class="codeph">oinstall</code>, <code class="codeph">640</code>.</span><div>
                                 <div class="infoboxnote" id="GUID-45585A36-F1D3-49AC-B2FB-4EE0F608C6DF__GUID-E97B52AF-AF87-49A0-8F2C-1193840235DB">
                                    <p class="notep1">Note:</p>
                                    <p>Create at least two mirrors of the primary storage location to eliminate a single point of failure for OCR. OCR supports up to five locations.</p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Ensure there is at least 500 MB of space on the mount partition.</span></li>
                           <li class="stepexpand"><span>Ensure that the file you created is visible from all nodes in the cluster.</span></li>
                           <li class="stepexpand"><span>To add the file as an OCR location, ensure that the Oracle Clusterware stack is running and run the following command as <code class="codeph">root</code>:</span><div><pre class="oac_no_warn" dir="ltr"># ocrconfig -add <span class="italic">file_location</span>
</pre><p>You can run this command more than once if you add more than one OCR location. Each successive run of this command must point to a different file location.</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Ensure that the OCR backup location is not configured on an Oracle ASM disk group.</span><div>
                                 <p>To migrate the OCR backup location to a file system, run the following command as <code class="codeph">root</code>:
                                 </p><pre class="oac_no_warn" dir="ltr"># ocrconfig &#x2013;backuploc <span class="italic">file_location</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>To remove storage configurations no longer in use, run the following command as <code class="codeph">root</code>:</span><div><pre class="oac_no_warn" dir="ltr"># ocrconfig -delete +<span class="italic">asm_disk_group</span>
</pre><p>You can run this command more than once if there is more than one OCR location configured.</p>
                              </div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>The following example shows how to migrate OCR from Oracle ASM to NAS using OCRCONFIG.</p><pre class="oac_no_warn" dir="ltr"># ocrconfig -add /nas/ocr
</pre><p>For OCRs not stored on Oracle ASM, Oracle recommends that you mirror OCR on different devices.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="CWADD90964"></a><div class="props_rev_3"><a id="GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034" name="GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034"></a><h4 id="CWADD-GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034" class="sect4">Adding, Replacing, Repairing, and Removing Oracle Cluster Registry Locations</h4>
                  <div>
                     <p>Manage OCR locations using OCRCONFIG.</p>
                     <p>The Oracle installation process for Oracle Clusterware gives you the option of automatically mirroring OCR. You can manually put the mirrored OCRs on a shared Network File System (NFS), or on any cluster file system that is certified by Oracle. Alternatively, you can place OCR on Oracle ASM and allow it to create mirrors automatically, depending on the redundancy option you select.</p>
                     <p>You can manually mirror OCR, as described in the <span class="italic">Adding an Oracle Cluster Registry Location</span> section, if you:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Upgraded to Oracle Clusterware 12<span class="italic">c</span> but did not choose to mirror OCR during the upgrade
                           </p>
                        </li>
                        <li>
                           <p>Created only one OCR location during the Oracle Clusterware installation</p>
                        </li>
                     </ul>
                     <p>Oracle recommends that you configure:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>At least three OCR locations, if OCR is configured on non-mirrored or non-redundant storage. Oracle strongly recommends that you mirror OCR if the underlying storage is not RAID. Mirroring can help prevent OCR from becoming a single point of failure.</p>
                        </li>
                        <li>
                           <p>At least two OCR locations if OCR is configured on an Oracle ASM disk group. You should configure OCR in two independent disk groups. Typically this is the work area and the recovery area.</p>
                        </li>
                        <li>
                           <p>At least two OCR locations if OCR is configured on mirrored hardware or third-party mirrored volumes.</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034__GUID-5DE55C88-31DB-4FD8-AB66-05624BAEB92C">
                        <p class="notep1">Note:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If the original OCR location does not exist, then you must create an empty (0 byte) OCR location with appropriate permissions before you run the <code class="codeph">ocrconfig -add</code> or <code class="codeph">ocrconfig -replace</code> commands.
                              </p>
                           </li>
                           <li>
                              <p>Ensure that the OCR devices that you specify in the OCR configuration exist and that these OCR devices are valid.</p>
                           </li>
                           <li>
                              <p>Ensure that the Oracle ASM disk group that you specify exists and is mounted. </p>
                           </li>
                           <li>
                              <p>The new OCR file, device, or disk group must be accessible from all of the active nodes in the cluster. </p>
                           </li>
                        </ul>
                     </div>
                     <p>In addition to mirroring OCR locations, managing OCR locations include:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C">Adding an Oracle Cluster Registry Location</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8">Removing an Oracle Cluster Registry Location</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6">Replacing an Oracle Cluster Registry Location</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-D8EB7441-378F-41A6-863A-A1706CC48680" title="It may be necessary to repair OCR if your cluster configuration changes while that node is stopped and this node is the only member in the cluster.">Repairing an Oracle Cluster Registry Configuration on a Local Node</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-32DC0B83-6EA9-4FF2-BC39-4EC54728C392">Overriding the Oracle Cluster Registry Data Loss Protection Mechanism</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-BFBBF4EC-5227-4413-98E0-93B62AA44034__GUID-8847F4A1-6D0C-4E3F-9AA3-7DB5A0D85647">
                        <p class="notep1">Note:</p>
                        <p>The operations in this section affect OCR throughout the entire cluster: the operations change the OCR configuration information in the <code class="codeph">ocr.loc</code> file on Linux and UNIX systems and the Registry keys on Windows systems. However, the <code class="codeph">ocrconfig</code> command cannot modify OCR configuration information for nodes that are shut down or for nodes on which Oracle Clusterware is not running.
                        </p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span></a></li>
                           <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div><a id="CWADD90965"></a><div class="props_rev_3"><a id="GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C" name="GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C"></a><h5 id="CWADD-GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C" class="sect5">Adding an Oracle Cluster Registry Location</h5>
                     <div>
                        <div class="section">
                           <p><a id="d37753e1251" class="indexterm-anchor"></a>Use the procedure in this section to add an OCR location. Oracle Clusterware can manage up to five redundant OCR locations.
                           </p>
                           <div class="infoboxnote" id="GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C__GUID-37BB2B35-FF05-43BE-ACEB-42ED10626323">
                              <p class="notep1">Note:</p>
                              <p>If OCR resides on a cluster file system file or a network file system, create an empty (0 byte) OCR location file before performing the procedures in this section.</p>
                           </div>
                           <p>As the <code class="codeph">root</code> user, run the following command to add an OCR location to either Oracle ASM or other storage device:
                           </p><pre class="oac_no_warn" dir="ltr"># ocrconfig -add +<span class="italic">asm_disk_group</span> | <span class="italic">file_name</span></pre><div class="infoboxnote" id="GUID-582CE178-A9C2-4685-81BC-E31F1DDBE60C__GUID-38E63004-BB3F-44D9-B5C4-BEF799EB241E">
                              <p class="notep1">Note:</p>
                              <p>On Linux and UNIX systems, you must be <code class="codeph">root</code> to run <code class="codeph">ocrconfig</code> commands. On Windows systems, the user must be a member of the Administrator's group.
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="CWADD90968"></a><div class="props_rev_3"><a id="GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8" name="GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8"></a><h5 id="CWADD-GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8" class="sect5">Removing an Oracle Cluster Registry Location</h5>
                     <div>
                        <div class="section">
                           <p>To remove an OCR location or a failed OCR location, at least one other OCR must be online. <a id="d37753e1400" class="indexterm-anchor"></a>You can remove an OCR location to reduce OCR-related overhead or to stop mirroring your OCR because you moved OCR to redundant storage such as RAID.
                           </p>
                           <p>Perform the following procedure as the <code class="codeph">root</code> user to remove an OCR location from your Oracle Clusterware environment: 
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Ensure that <span class="italic">at least one</span> OCR location other than the OCR location that you are removing is online. </span><div>
                                 <div class="infoboxnote" id="GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8__GUID-7D6108A3-07D5-42D4-8417-E263772F5E62">
                                    <p class="notep1">Caution:</p>
                                    <p>Do <span class="italic">not</span> perform this OCR removal procedure unless there is at least one other active OCR location online.
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Run the following command on any node in the cluster to remove an OCR location from either Oracle ASM or other location:</span><div><pre class="oac_no_warn" dir="ltr"># ocrconfig -delete +<span class="italic">ASM_disk_group</span> | <span class="italic">file_name</span>
</pre><p>The <span class="italic"><code class="codeph">file_name</code></span> variable can be a device name or a file name. This command updates the OCR configuration on all of the nodes on which Oracle Clusterware is running.
                                 </p>
                                 <div class="infoboxnote" id="GUID-7B9D91BC-7E40-4643-AF7A-37D695875BF8__GUID-A2F356E2-35C3-449F-B959-269047EDC389">
                                    <p class="notep1">Note:</p>
                                    <p>The only configured Oracle ASM OCR location, which is on a different Oracle ASM disk group than the Oracle ASM OCR backup location, cannot be removed.</p>
                                 </div>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div><a id="CWADD91264"></a><a id="CWADD90966"></a><div class="props_rev_3"><a id="GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6" name="GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6"></a><h5 id="CWADD-GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6" class="sect5">Replacing an Oracle Cluster Registry Location</h5>
                     <div>
                        <div class="section">
                           <p>If you must change an existing OCR location, or change a failed OCR location to a working location, then you can use the following procedure, if all remaining OCR locations remain online. The <code class="codeph">ocrconfig -replace</code> command requires that at least two OCR locations are configured.
                           </p>
                           <p><span class="bold">To change an Oracle Cluster Registry location:</span></p>
                           <p>Complete the following procedure:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Use the OCRCHECK utility to verify that a copy of OCR other than the one you are going to replace is <span class="italic">online</span>, using the following command:</span><div><pre class="pre codeblock"><code>$ ocrcheck</code></pre><p>OCRCHECK displays all OCR locations that are registered and whether they are available (online). If an OCR location suddenly becomes unavailable, then it might take a short period for Oracle Clusterware to show the change in status.</p>
                                 <div class="infoboxnote" id="GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6__GUID-ADDAFD5F-2790-4346-B361-ACB3B2A9E50D">
                                    <p class="notep1">Note:</p>
                                    <p>The OCR location that you are <span class="italic">replacing</span> can be either online or offline.
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Use the following command to verify that Oracle Clusterware is running on the node on which you are going to perform the replace operation:</span><div><pre class="pre codeblock"><code>$ crsctl check crs</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Run the following command as <code class="codeph">root</code> to replace the current OCR location using either <code class="codeph"><span class="variable" translate="no">destination_file</span></code> or <code class="codeph">+<span class="variable" translate="no">ASM_disk_group</span></code> to indicate the current and target OCR locations:</span><div><pre class="pre codeblock"><code># ocrconfig -replace <span class="variable" translate="no">current_OCR_location</span> -replacement <span class="variable" translate="no">new_OCR_location</span></code></pre><p>The preceding command fails if you have less than two configured OCR locations that are online.</p>
                                 <p>If you have only one OCR location configured and online, then you must first add a new location and then delete the failed location, as follows:</p><pre class="pre codeblock"><code># ocrconfig -add <span class="variable" translate="no">new_OCR_location</span>
# ocrconfig -delete <span class="variable" translate="no">current_OCR_location</span></code></pre><div class="infoboxnote" id="GUID-699F70A0-254C-4FF5-A5AA-334EE9E29FC6__GUID-732E1A96-DB40-47ED-B2E8-E5C739059BA3">
                                    <p class="notep1">Note:</p>
                                    <p>If your cluster configuration changes while the node on which OCR resides is stopped, and the Oracle Clusterware stack is running on the other nodes, then OCR detects configuration changes and self-corrects the configuration by changing the contents of the <code class="codeph">ocr.loc</code> file.
                                    </p>
                                 </div>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../ostmg/asm-migration-rman.html#OSTMG-GUID-EE232095-823A-4717-8629-75E6A750FCDB" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CWADD90967"></a><div class="props_rev_3"><a id="GUID-D8EB7441-378F-41A6-863A-A1706CC48680" name="GUID-D8EB7441-378F-41A6-863A-A1706CC48680"></a><h5 id="CWADD-GUID-D8EB7441-378F-41A6-863A-A1706CC48680" class="sect5">Repairing an Oracle Cluster Registry Configuration on a Local Node</h5>
                     <div>
                        <p>It may be necessary to repair OCR if your cluster configuration changes while that node is stopped and this node is the only member in the cluster.</p>
                        <div class="section">
                           <p>Repairing an OCR involves either adding, deleting, or replacing an OCR location. For example, if any node that is part of your current Oracle RAC cluster is shut down, then you must update the OCR configuration on the stopped node to let that node rejoin the cluster after the node is restarted. Use the following command syntax as <code class="codeph">root</code> on the restarted node where you use either a <code class="codeph"><span class="variable" translate="no">destination_file</span></code> or <code class="codeph">+<span class="variable" translate="no">ASM_disk_group</span></code> to indicate the current and target OCR locations:
                           </p><pre class="pre codeblock"><code># ocrconfig -repair -replace <span class="variable" translate="no">current_OCR_location</span> -replacement <span class="variable" translate="no">target_OCR_location</span></code></pre><p>This operation only changes OCR on the node on which you run this command. For example, if the OCR location is <code class="codeph">/dev/sde1</code>, then use the command syntax <code class="codeph">ocrconfig -repair -add /dev/sde1</code> on this node to repair OCR on that node.
                           </p>
                           <div class="infoboxnote" id="GUID-D8EB7441-378F-41A6-863A-A1706CC48680__GUID-A74E483B-E875-44D4-B578-E085C4F07095">
                              <p class="notep1">Note:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>You cannot repair the OCR configuration on a node on which the Oracle Cluster Ready Services daemon is running.</p>
                                 </li>
                                 <li>
                                    <p>When you repair OCR on a stopped node using <code class="codeph">ocrconfig -repair</code>, you must provide the same OCR file name (which should be case-sensitive) as the OCR file names on other nodes.
                                    </p>
                                 </li>
                                 <li>
                                    <p>If you run the <code class="codeph">ocrconfig -add | -repair | -replace</code> command, then the device, file, or Oracle ASM disk group that you are adding must be accessible. This means that a device must exist. You must create an empty (0 byte) OCR location, or the Oracle ASM disk group must exist and be mounted.
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="oracle-cluster-registry-utility-reference.html#GUID-2029B8DE-F140-43EF-B4F8-26CC7D31D179" title="Adds an OCR location to an Oracle Automatic Storage Management (Oracle ASM) disk group.Specify an OCR backup directory location.Copies an OCR backup file from one location to another.Removes an OCR device or file.Only root scripts use this command to downgrade OCR to an earlier specified version.Exports the contents of OCR to a target file.Imports the contents of a target file into which you exported the contents of OCR back into OCR.Backs up OCR on demand to a specific location.Overwrites an OCR configuration in the OCR metadata with the current OCR configuration information that is found on the node from which you run this command.Repairs an OCR configuration on the node from which you run this command.Replaces an OCR location to an Oracle Automatic Storage Management (Oracle ASM) disk group.Restores OCR from an automatically created OCR backup file.Displays all available backups.Displays the backup location of the OCR and OLR backup files.Upgrades OCR from a previous version.">OCRCONFIG Command Reference</a></li>
                              <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CWADD90969"></a><div class="props_rev_3"><a id="GUID-32DC0B83-6EA9-4FF2-BC39-4EC54728C392" name="GUID-32DC0B83-6EA9-4FF2-BC39-4EC54728C392"></a><h5 id="CWADD-GUID-32DC0B83-6EA9-4FF2-BC39-4EC54728C392" class="sect5">Overriding the Oracle Cluster Registry Data Loss Protection Mechanism</h5>
                     <div>
                        <div class="section">
                           <p>OCR<a id="d37753e1959" class="indexterm-anchor"></a> has a mechanism that prevents data loss due to accidental overwrites. If you configure a mirrored OCR and if Oracle Clusterware cannot access the mirrored OCR locations and also cannot verify that the available OCR location contains the most recent configuration, then Oracle Clusterware prevents further modification to the available OCR location. In addition, the process prevents overwriting by prohibiting Oracle Clusterware from starting on the node on which only one OCR is available. In such cases, Oracle Database displays an alert message in either Oracle Enterprise Manager, the Oracle Clusterware alert log files, or both. If this problem is local to only one node, you can use other nodes to start your cluster database.
                           </p>
                           <p>However, if you are unable to start any cluster node in your environment and if you can neither repair OCR nor restore access to all OCR locations, then you can override the protection mechanism. The procedure described in the following list enables you to start the cluster using the available OCR location. However, overriding the protection mechanism can result in the loss of data that was not available when the previous known good state was created.</p>
                           <div class="infoboxnote" id="GUID-32DC0B83-6EA9-4FF2-BC39-4EC54728C392__GUID-E2952B5E-2C4D-4B31-8721-26221FBB6400">
                              <p class="notep1">Caution:</p>
                              <p>Overriding OCR using the following procedure can result in the loss of OCR updates that were made between the time of the last known good OCR update made to the currently accessible OCR and the time at which you performed the overwrite. In other words, running the <code class="codeph">ocrconfig -overwrite</code> command can result in data loss if the OCR location that you are using to perform the overwrite does not contain the latest configuration updates for your cluster environment.
                              </p>
                           </div>
                           <p>Perform the following procedure to overwrite OCR if a node cannot start <span class="italic">and</span> if the alert log contains <a id="d37753e1977" class="indexterm-anchor"></a>CLSD-1009 and<a id="d37753e1982" class="indexterm-anchor"></a> CLSD-1011 messages.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Attempt to resolve the cause of the CLSD-1009 and CLSD-1011 messages. </span><div>
                                 <p>Compare the node's OCR configuration (<code class="codeph">ocr.loc</code> on Linux and UNIX systems and the Registry on Windows systems) with other nodes on which Oracle Clusterware is running.
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>If the configurations do not match, run <code class="codeph">ocrconfig -repair</code>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>If the configurations match, ensure that the node can access all of the configured OCRs by running an <code class="codeph">ls</code> command on Linux and UNIX systems. On Windows, use a <code class="codeph">dir</code> command if the OCR location is a file and run <code class="codeph">GuiOracleObjectManager.exe</code> to verify that the part of the cluster with the name exists.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Ensure that the most recent OCR contains the latest OCR updates.</span><div>
                                 <p>Look at output from the <code class="codeph">ocrdump</code> command and determine whether it has your latest updates. 
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>If you cannot resolve the problem that caused the CLSD message, then run the command <code class="codeph">ocrconfig -overwrite</code> to start the node.</span></li>
                        </ol>
                     </div>
                  </div>
               </div><a id="CWADD90970"></a><div class="props_rev_3"><a id="GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60" name="GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60"></a><h4 id="CWADD-GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60" class="sect4">Backing Up Oracle Cluster Registry</h4>
                  <div>
                     <p>This section describes <a id="d37753e2149" class="indexterm-anchor"></a>how to back up OCR content and use it for recovery. The first method uses automatically generated OCR copies and the second method enables you to issue a backup command manually:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">Automatic backups</span>: <a id="d37753e2160" class="indexterm-anchor"></a>Oracle Clusterware automatically creates OCR backups every four hours. At any one time, Oracle Database always retains the last three backup copies of OCR. The CRSD process that creates the backups also creates and retains an OCR backup for each <span class="italic">full day</span> and <span class="italic">after each week</span>. You cannot customize the backup frequencies or the number of files that Oracle Database retains.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Manual backups</span>: Run <a id="d37753e2176" class="indexterm-anchor"></a>the <code class="codeph">ocrconfig -manualbackup</code> command on a node where the Oracle Clusterware stack is up and running to force Oracle Clusterware to perform a backup of OCR at any time, rather than wait for the automatic backup. You must run the command as a user with administrative privileges. The <code class="codeph">-manualbackup</code> option is especially useful when you want to obtain a binary backup on demand, such as before you make changes to OCR. The OLR only supports manual backups.
                           </p>
                        </li>
                     </ul>
                     <p>When the clusterware stack is down on all nodes in the cluster, the backups that are listed by the <code class="codeph">ocrconfig -showbackup</code> command may differ from node to node.
                     </p>
                     <div class="infoboxnote" id="GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60__GUID-2E25EC79-BC7D-4B7A-902A-914A9061E834">
                        <p class="notep1">Note:</p>
                        <p>After you install or upgrade Oracle Clusterware on a node, or add a node to the cluster, when the <code class="codeph">root.sh</code> script finishes, it backs up OLR.
                        </p>
                     </div>
                     <p>This section includes the following topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-6921B0DB-4C97-48D6-9128-373544663DCF">Listing Backup Files</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-619A16D6-AF79-4A48-950B-673F2A496408">Changing Backup Location</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="props_rev_3"><a id="GUID-6921B0DB-4C97-48D6-9128-373544663DCF" name="GUID-6921B0DB-4C97-48D6-9128-373544663DCF"></a><h5 id="CWADD-GUID-6921B0DB-4C97-48D6-9128-373544663DCF" class="sect5">Listing Backup Files</h5>
                     <div>
                        <div class="section">
                           <p>Run the following command to list the backup files:</p><pre class="oac_no_warn" dir="ltr">ocrconfig -showbackup
</pre><p>The <code class="codeph">ocrconfig -showbackup</code> command displays the backup location, timestamp, and the originating node name of the backup files that Oracle Clusterware creates. By default, the <code class="codeph">-showbackup</code> option displays information for both automatic and manual backups but you can include the <code class="codeph">auto</code> or <code class="codeph">manual</code> flag to display only the automatic backup information or only the manual backup information, respectively.
                           </p>
                           <p>Run the following command to inspect the contents and verify the integrity of the backup file:</p><pre class="oac_no_warn" dir="ltr">ocrdump -backupfile <span class="italic">backup_file_name</span>
</pre><p>You can use any backup software to copy the automatically generated backup files at least once daily to a different device from where the primary OCR resides.</p>
                           <p>As of Oracle Clusterware 12<span class="italic">c</span> release 2 (12.2), the default location for generating backups is an Oracle ASM disk group, which you can change between Oracle ASM disk groups, but you <span class="italic">cannot</span> change to a local file system. Oracle recommends that you include the backup file created with the OCRCONFIG utility as part of your operating system backup using standard operating system or third-party tools.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-619A16D6-AF79-4A48-950B-673F2A496408" name="GUID-619A16D6-AF79-4A48-950B-673F2A496408"></a><h5 id="CWADD-GUID-619A16D6-AF79-4A48-950B-673F2A496408" class="sect5">Changing Backup Location</h5>
                     <div>
                        <div class="section">
                           <p>Run the following command to change the location where OCR creates backups:</p><pre class="pre codeblock"><code># ocrconfig -backuploc <span class="variable" translate="no">file_name</span></code></pre><p>The <code class="codeph"><span class="variable" translate="no">file_name</span></code> variable in the preceding command can be a full directory path name that is accessible by all nodes, or it can be an Oracle ASM disk group that is mounted on all nodes. You must migrate OCR to Oracle ASM before changing the OCR backup location to an Oracle ASM disk group. You can change the OCR backup location to an Oracle ASM disk group only if there is at least one Oracle ASM OCR location in a separate disk group.
                           </p>
                           <p>For example, to specify an OCR backup location in a directory:</p><pre class="pre codeblock"><code># ocrconfig -backuploc <span class="variable" translate="no">Grid_home</span>/cdata/cluster3</code></pre><p>To specify an OCR backup location in an Oracle ASM disk group:</p><pre class="pre codeblock"><code># ocrconfig &#x2013;backuploc +bkupdg</code></pre><div class="infoboxnote" id="GUID-619A16D6-AF79-4A48-950B-673F2A496408__GUID-341FAD09-B726-48BC-8F44-5A5D7299304C">
                              <p class="notep1">Note:</p>
                              <p>On Linux and UNIX systems, you must be <code class="codeph">root</code> user to run most but not all of the <code class="codeph">ocrconfig</code> command options. On Windows systems, the user must be a member of the Administrator's group.
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E" title="Use this procedure to import OCR on Linux or UNIX systems.Use this procedure to import OCR on Windows systems.">Administering Oracle Cluster Registry with Export and Import Commands</a></li>
                              <li><a href="oracle-cluster-registry-utility-reference.html#GUID-2029B8DE-F140-43EF-B4F8-26CC7D31D179" title="Adds an OCR location to an Oracle Automatic Storage Management (Oracle ASM) disk group.Specify an OCR backup directory location.Copies an OCR backup file from one location to another.Removes an OCR device or file.Only root scripts use this command to downgrade OCR to an earlier specified version.Exports the contents of OCR to a target file.Imports the contents of a target file into which you exported the contents of OCR back into OCR.Backs up OCR on demand to a specific location.Overwrites an OCR configuration in the OCR metadata with the current OCR configuration information that is found on the node from which you run this command.Repairs an OCR configuration on the node from which you run this command.Replaces an OCR location to an Oracle Automatic Storage Management (Oracle ASM) disk group.Restores OCR from an automatically created OCR backup file.Displays all available backups.Displays the backup location of the OCR and OLR backup files.Upgrades OCR from a previous version.">OCRCONFIG Command Reference</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CWADD92002"></a><div class="props_rev_3"><a id="GUID-648BB199-AFB9-416A-8438-E0331C255E78" name="GUID-648BB199-AFB9-416A-8438-E0331C255E78"></a><h4 id="CWADD-GUID-648BB199-AFB9-416A-8438-E0331C255E78" class="sect4">Restoring Oracle Cluster Registry</h4>
                  <div>
                     <p>A procedure for OCR restoration for your platform.</p>
                     <p>If a resource fails, then before attempting to restore OCR, restart the resource. As a definitive verification that OCR failed, run <code class="codeph">ocrcheck</code> and if the command returns a failure message, then both the primary OCR and the OCR mirror have failed.
                     </p>
                     <div class="infoboxnote" id="GUID-648BB199-AFB9-416A-8438-E0331C255E78__GUID-9C9E0B85-EE30-4845-A0BF-7D7A7BB4A0C8">
                        <p class="notep1">Note:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You <span class="italic">cannot</span> restore your configuration from an OCR backup file using the <code class="codeph">-import</code> option, which is explained in <span class="q">"Administering Oracle Cluster Registry with Export and Import Commands"</span>. You <span class="italic">must instead</span> use the <code class="codeph">-restore</code> option, as described in the following sections.
                              </p>
                           </li>
                           <li>
                              <p>If you store OCR on an Oracle ASM disk group and the disk group is not available, then you must recover and mount the Oracle ASM disk group.</p>
                           </li>
                        </ul>
                     </div>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988" title="Use this procedure to restore OCR on Linux or UNIX systems.">Restoring the Oracle Cluster Registry on Linux or UNIX Systems</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB" title="Use this procedure to restore OCR on Windows systems.">Restoring the Oracle Cluster Registry on Windows Systems</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392" title="Use this procedure to restore OCR in an Oracle Restart environment.">Restoring the Oracle Cluster Registry in an Oracle Restart Environment</a></p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E" title="Use this procedure to import OCR on Linux or UNIX systems.Use this procedure to import OCR on Windows systems.">Administering Oracle Cluster Registry with Export and Import Commands</a></li>
                           <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988" name="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988"></a><h5 id="CWADD-GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988" class="sect5">Restoring the Oracle Cluster Registry on Linux or UNIX Systems</h5>
                     <div>
                        <p>Use this procedure to restore OCR on Linux or UNIX systems.</p>
                        <div class="section">
                           <p>If you are storing OCR on an Oracle ASM disk group, and that disk group is corrupt, then you must restore the Oracle ASM disk group using Oracle ASM utilities, and then mount the disk group again before recovering OCR. Recover OCR by running the <code class="codeph">ocrconfig -restore</code> command, as instructed in the following procedure.
                           </p>
                           <div class="infoboxnote" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-BC1A351D-E254-47B0-9E1F-20728249A8DE">
                              <p class="notep1">Note:</p>
                              <p>If the original OCR location does not exist, then you must create an empty (0 byte) OCR location with the same name as the original OCR location before you run the <code class="codeph">ocrconfig -restore</code> command.
                              </p>
                           </div>
                           <p>Use the following procedure to restore OCR on Linux or UNIX systems:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>List the nodes in your cluster by running the following command on one node:</span><div><pre class="pre codeblock"><code>$ olsnodes</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Depending on whether OCR is located in an Oracle ASM disk group or on network attached storage (NAS), stop Oracle Clusterware by running one of the following commands as root on all of the nodes:</span><div>
                                 <p>If OCR is located in an Oracle ASM disk group, then stop the Oracle Clusterware daemon:</p><pre class="pre codeblock"><code># crsctl stop crs</code></pre><p>If the preceding command returns any error due to OCR corruption, then force stop Oracle Clusterware by running the following command as <code class="codeph">root</code> on all of the nodes:
                                 </p><pre class="pre codeblock"><code># crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>If you are restoring OCR to a cluster file system or network file system, then run the following command as <code class="codeph">root</code> to restore OCR with an OCR backup that you can identify in <span class="q">"Listing Backup Files"</span>:</span><div><pre class="pre codeblock"><code># ocrconfig -restore <span class="variable" translate="no">file_name</span></code></pre><div class="infoboxnote" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-CB3047A5-9646-4C48-B2EA-F0658F23A30B">
                                    <p class="notep1">Note:</p>
                                    <p>If the OCR backup file is located in an Oracle ASM disk group, then ensure that the disk group exists and is mounted.</p>
                                 </div>
                                 <p>After you complete this step, proceed to step <a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__CHDCIGEE">11</a>.
                                 </p>
                                 <p>If you are <span class="italic">not</span> restoring OCR to a cluster file system or network file system, then proceed to the next step.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Start the Oracle Clusterware stack on one node in exclusive mode by running the following command as <code class="codeph">root</code>:</span><div><pre class="pre codeblock"><code># crsctl start crs -excl -nocrs</code></pre><p>The <code class="codeph">-nocrs</code> option ensures that the CRSD process and OCR do not start with the rest of the Oracle Clusterware stack.
                                 </p>
                                 <p>Ignore any errors that display.</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Check whether CRSD is running by running the following command:</span><div><pre class="pre codeblock"><code>$ crsctl status resource ora.crsd -init</code></pre><p>If CRSD is running, then stop it by running the following command as <code class="codeph">root</code>:
                                 </p><pre class="pre codeblock"><code># crsctl stop resource ora.crsd -init</code></pre><div class="infoboxnote" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-A1CDB843-0497-4251-8FE9-FB71879AF66B">
                                    <p class="notep1">Caution:</p>
                                    <p><span class="italic">Do not</span> use the <code class="codeph">-init</code> flag with any other command unless directed to do so by My Oracle Support.
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>To restore OCR to an Oracle ASM disk group, you must first create a disk group using SQL*Plus that has the same name as the disk group you want to restore and mount it on the local node.</span><div>
                                 <p>If you cannot mount the disk group locally, then run the following SQL*Plus command:</p><pre class="pre codeblock"><code>SQL&gt; drop diskgroup <span class="variable" translate="no">disk_group_name</span> force including contents;</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Restore OCR with an OCR backup that you can identify in <span class="q">"Listing Backup Files"</span> by running the following command as <code class="codeph">root</code>:</span><div><pre class="pre codeblock"><code># ocrconfig -restore <span class="variable" translate="no">file_name</span></code></pre><div class="infoboxnote" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-3F136B1E-8331-4E8D-96F0-8BD82A11B8A5">
                                    <p class="notep1">Note:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>If the original OCR location does not exist, then you must create an empty (0 byte) OCR location before you run the <code class="codeph">ocrconfig -restore</code> command.
                                          </p>
                                       </li>
                                       <li>
                                          <p>Ensure that the OCR devices that you specify in the OCR configuration exist and that these OCR devices are valid.</p>
                                       </li>
                                       <li>
                                          <p>If you configured OCR in an Oracle ASM disk group, then ensure that the Oracle ASM disk group exists and is mounted.</p>
                                       </li>
                                       <li>
                                          <p>If the OCR backup file is located in an Oracle ASM disk group, then ensure that the disk group exists and is mounted.</p>
                                       </li>
                                    </ul>
                                 </div>
                                 <div class="infoboxnotealso" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__GUID-4EBBE40F-34D3-45EB-A050-0091E2D33DDA">
                                    <p class="notep1">See Also:</p>
                                    <p><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span> for information about creating OCRs
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Verify the integrity of OCR:</span><div><pre class="pre codeblock"><code># ocrcheck</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Stop Oracle Clusterware on the node where it is running in exclusive mode:</span><div><pre class="pre codeblock"><code># crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Run the <code class="codeph">ocrconfig -repair -replace</code> command as <code class="codeph">root</code> on all the nodes in the cluster where you <span class="italic">did not</span> run the <code class="codeph">ocrconfig -restore</code> command. For example, if you ran the <code class="codeph">ocrconfig -restore</code> command on node 1 of a four-node cluster, then you must run the <code class="codeph">ocrconfig -repair -replace</code> command on nodes 2, 3, and 4.</span></li>
                           <li class="stepexpand" id="GUID-3ADF0C33-9B4C-4FC5-88C5-4C736159E988__CHDCIGEE"><span>Begin to start Oracle Clusterware by running the following command as <code class="codeph">root</code> on all of the nodes:</span><div><pre class="pre codeblock"><code># crsctl start crs</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Verify OCR integrity of all of the cluster nodes that are configured as part of your cluster by running the following CVU command:</span><div><pre class="pre codeblock"><code>$ cluvfy comp ocr -n all -verbose</code></pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../ostmg/asmcmd-diskgroup-commands.html#OSTMG-GUID-FEA13FA9-4FB3-4C4B-B728-99AD2452888A" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                              <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-6921B0DB-4C97-48D6-9128-373544663DCF">Listing Backup Files</a></li>
                              <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                              <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span></a></li>
                              <li><a href="cluster-verification-utility-reference.html#GUID-B445A858-9F00-4423-990E-109545AC11C3" title="CVU can verify the primary cluster components during an operational phase or stage.The following table includes deprecated and desupported CLUVFY commands:This section lists and describes CVU commands.Checks the integrity of Oracle Automatic Storage Management Cluster File System (Oracle ACFS) on all nodes in a cluster.Checks the required administrative privileges for the operation specified by -o parameter on all the nodes that you specify in the node list.Checks the integrity of Oracle Automatic Storage Management (Oracle ASM) on specific nodes in the cluster.Captures system and cluster configuration information to create a baseline.Checks clock synchronization across all the nodes in the node list.Checks the integrity of the cluster manager subcomponent, or Oracle Cluster Synchronization Services (CSS), on the nodes in the node list.Checks the integrity of the Cluster Ready Services (CRS) daemon on the specified nodes.Verifies that the DHCP server exists on the network, and that it can provide a required number of IP addresses.Verifies that the Grid Naming Service (GNS) subdomain delegation has been properly set up in the Domain Name Service (DNS) server.Checks the free space available in the Oracle Clusterware home storage and ensure that there is at least 5% of the total space available. Verifies the integrity of the Grid Naming Service (GNS) on the cluster.Checks the integrity of Grid Plug and Play on a list of nodes in a cluster.Checks the integrity of Oracle Restart on the local node.Checks your Oracle Clusterware and Oracle Database installations for their compliance with mandatory requirements and best practices guidelines, and to ensure that they are functioning properly.Checks for the existence of node applications, namely VIP, NETWORK, and ONS, on all of the specified nodes.Checks the connectivity among the nodes specified in the node list. If you provide an interface list, then CVU checks the connectivity using only the specified interfaces.Determines whether a source node can communicate with other, specific nodes.Checks the integrity of Oracle Cluster Registry (OCR) on all specified nodes.Checks the integrity of the Oracle High Availability Services daemon.Checks the integrity of Oracle Local Registry (OLR) on the local node.Checks the compatibility and properties of the specified nodes against a reference node.Checks the Single Client Access Name (SCAN) configuration.Checks the files and attributes installed with the Oracle software.Checks for free disk space at the location you specify in the -l parameter on all the specified nodes.Use the cluvfy comp ssa component verification command to discover and check the sharing of the specified storage locations. CVU checks sharing for nodes in the node list.Checks that the minimum system requirements are met for the specified product on all the specified nodes.Checks the voting files configuration and the udev settings for the voting files on all the specified nodes.Use the cluvfy stage -pre acfscfg command to verify your cluster nodes are set up correctly before configuring Oracle Automatic Storage Management Cluster File System (Oracle ACFS). Use the cluvfy stage -post acfscfg to check an existing cluster after you configure Oracle ACFS.Performs the appropriate post stage checks for Oracle Clusterware application cluster installation on all the nodes.Use the cluvfy stage -pre cfs stage verification command to verify your cluster nodes are set up correctly before configuring OCFS2. Use the cluvfy stage -post cfs stage verification command to perform the appropriate checks on the specified nodes after configuring OCFS2.Use the cluvfy stage -pre crsinst command with either the -file, -n, -flex, or -upgrade parameters to check the specified nodes before installing or upgrading Oracle Clusterware. Use the cluvfy stage -post crsinst command to check the specified nodes after installing Oracle Clusterware.Checks the specified nodes before configuring an Oracle RAC database to verify whether your system meets all of the criteria for creating a database or for making a database configuration change.Checks the specified nodes before installing or creating an Oracle RAC database to verify that your system meets all of the criteria for installing or creating an Oracle RAC database.Checks the local node after configuring Oracle Restart.Checks network and storage on the specified nodes in the cluster before installing Oracle software. This command also checks for supported storage types and checks each one for sharing.Use the cluvfy stage -pre nodeadd command to verify the specified nodes are configured correctly before adding them to your existing cluster, and to verify the integrity of the cluster before you add the nodes. Use the cluvfy stage -post nodeadd command to verify that the specified nodes have been successfully added to the cluster at the network, shared storage, and clusterware levels.Verifies that specific nodes have been successfully deleted from a cluster. Typically, this command verifies that the node-specific interface configuration details have been removed, the nodes are no longer a part of cluster configuration, and proper Oracle ASM cleanup has been performed.">Cluster Verification Utility Reference</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB" name="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB"></a><h5 id="CWADD-GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB" class="sect5">Restoring the Oracle Cluster Registry on Windows Systems</h5>
                     <div>
                        <p>Use this procedure to restore OCR on Windows systems.</p>
                        <div class="section">
                           <p>If you are storing OCR on an Oracle ASM disk group, and that disk group is corrupt, then you must restore the Oracle ASM disk group using Oracle ASM utilities, and then mount the disk group again before recovering OCR. Recover OCR by running the <code class="codeph">ocrconfig -restore</code> command.
                           </p>
                           <div class="infoboxnote" id="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB__GUID-1F0EE3ED-BB74-46E3-A4E1-7BA586EABF96">
                              <p class="notep1">Note:</p>
                              <p>If the original OCR location does not exist, then you must create an empty (0 byte) OCR location with the same name as the original OCR location before you run the <code class="codeph">ocrconfig -restore</code> command.
                              </p>
                           </div>
                           <p>Use the following procedure to restore OCR on Windows systems:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>List the nodes in your cluster by running the following command on one node:</span><div><pre class="pre codeblock"><code>C:\&gt;olsnodes</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Stop Oracle Clusterware by running the following command as a member of the Administrators group on all of the nodes:</span><div><pre class="pre codeblock"><code>C:\&gt;crsctl stop crs</code></pre><p>If the preceding command returns any error due to OCR corruption, stop Oracle Clusterware by running the following command as a member of the Administrators group on all of the nodes:</p><pre class="pre codeblock"><code>C:\&gt;crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Start the Oracle Clusterware stack on one node in exclusive mode by running the following command as a member of the Administrators group:</span><div><pre class="pre codeblock"><code>C:\&gt;crsctl start crs -excl -nocrs</code></pre><p>The <code class="codeph">-nocrs</code> option ensures that the CRSD process and OCR do not start with the rest of the Oracle Clusterware stack.
                                 </p>
                                 <p>Ignore any errors that display.</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Restore OCR with the OCR backup file that you identified in <span class="q">"Listing Backup Files"</span> by running the following command as a member of the Administrators group:</span><div><pre class="pre codeblock"><code>C:\&gt;ocrconfig -restore <span class="variable" translate="no">file_name</span></code></pre><p>Make sure that the OCR devices that you specify in the OCR configuration exist and that these OCR devices are valid.</p>
                                 <div class="infoboxnote" id="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB__GUID-4DEDA6FF-538D-46EF-BC57-CFCE4E117877">
                                    <p class="notep1">Note:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>Ensure that the OCR devices that you specify in the OCR configuration exist and that these OCR devices are valid.</p>
                                       </li>
                                       <li>
                                          <p>Ensure that the Oracle ASM disk group you specify exists and is mounted.</p>
                                       </li>
                                    </ul>
                                 </div>
                                 <div class="infoboxnotealso" id="GUID-7372F903-4BC0-4FB1-80AA-33B7BBD726EB__GUID-8B945264-FB4B-405F-9DB1-56060B613EE0">
                                    <p class="notep1">See Also:</p>
                                    <p><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span> for information about creating OCRs
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Verify the integrity of OCR:</span><div><pre class="pre codeblock"><code>C:\&gt;ocrcheck</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Stop Oracle Clusterware on the node where it is running in exclusive mode:</span><div><pre class="pre codeblock"><code>C:\&gt;crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Begin to start Oracle Clusterware by running the following command as a member of the Administrators group on all of the nodes:</span><div><pre class="pre codeblock"><code>C:\&gt;crsctl start crs</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Run the following Cluster Verification Utility (CVU) command to verify OCR integrity of all of the nodes in your cluster database:</span><div><pre class="pre codeblock"><code>C:\&gt;cluvfy comp ocr -n all -verbose</code></pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-6921B0DB-4C97-48D6-9128-373544663DCF">Listing Backup Files</a></li>
                              <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span></a></li>
                              <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                              <li><a href="cluster-verification-utility-reference.html#GUID-B445A858-9F00-4423-990E-109545AC11C3" title="CVU can verify the primary cluster components during an operational phase or stage.The following table includes deprecated and desupported CLUVFY commands:This section lists and describes CVU commands.Checks the integrity of Oracle Automatic Storage Management Cluster File System (Oracle ACFS) on all nodes in a cluster.Checks the required administrative privileges for the operation specified by -o parameter on all the nodes that you specify in the node list.Checks the integrity of Oracle Automatic Storage Management (Oracle ASM) on specific nodes in the cluster.Captures system and cluster configuration information to create a baseline.Checks clock synchronization across all the nodes in the node list.Checks the integrity of the cluster manager subcomponent, or Oracle Cluster Synchronization Services (CSS), on the nodes in the node list.Checks the integrity of the Cluster Ready Services (CRS) daemon on the specified nodes.Verifies that the DHCP server exists on the network, and that it can provide a required number of IP addresses.Verifies that the Grid Naming Service (GNS) subdomain delegation has been properly set up in the Domain Name Service (DNS) server.Checks the free space available in the Oracle Clusterware home storage and ensure that there is at least 5% of the total space available. Verifies the integrity of the Grid Naming Service (GNS) on the cluster.Checks the integrity of Grid Plug and Play on a list of nodes in a cluster.Checks the integrity of Oracle Restart on the local node.Checks your Oracle Clusterware and Oracle Database installations for their compliance with mandatory requirements and best practices guidelines, and to ensure that they are functioning properly.Checks for the existence of node applications, namely VIP, NETWORK, and ONS, on all of the specified nodes.Checks the connectivity among the nodes specified in the node list. If you provide an interface list, then CVU checks the connectivity using only the specified interfaces.Determines whether a source node can communicate with other, specific nodes.Checks the integrity of Oracle Cluster Registry (OCR) on all specified nodes.Checks the integrity of the Oracle High Availability Services daemon.Checks the integrity of Oracle Local Registry (OLR) on the local node.Checks the compatibility and properties of the specified nodes against a reference node.Checks the Single Client Access Name (SCAN) configuration.Checks the files and attributes installed with the Oracle software.Checks for free disk space at the location you specify in the -l parameter on all the specified nodes.Use the cluvfy comp ssa component verification command to discover and check the sharing of the specified storage locations. CVU checks sharing for nodes in the node list.Checks that the minimum system requirements are met for the specified product on all the specified nodes.Checks the voting files configuration and the udev settings for the voting files on all the specified nodes.Use the cluvfy stage -pre acfscfg command to verify your cluster nodes are set up correctly before configuring Oracle Automatic Storage Management Cluster File System (Oracle ACFS). Use the cluvfy stage -post acfscfg to check an existing cluster after you configure Oracle ACFS.Performs the appropriate post stage checks for Oracle Clusterware application cluster installation on all the nodes.Use the cluvfy stage -pre cfs stage verification command to verify your cluster nodes are set up correctly before configuring OCFS2. Use the cluvfy stage -post cfs stage verification command to perform the appropriate checks on the specified nodes after configuring OCFS2.Use the cluvfy stage -pre crsinst command with either the -file, -n, -flex, or -upgrade parameters to check the specified nodes before installing or upgrading Oracle Clusterware. Use the cluvfy stage -post crsinst command to check the specified nodes after installing Oracle Clusterware.Checks the specified nodes before configuring an Oracle RAC database to verify whether your system meets all of the criteria for creating a database or for making a database configuration change.Checks the specified nodes before installing or creating an Oracle RAC database to verify that your system meets all of the criteria for installing or creating an Oracle RAC database.Checks the local node after configuring Oracle Restart.Checks network and storage on the specified nodes in the cluster before installing Oracle software. This command also checks for supported storage types and checks each one for sharing.Use the cluvfy stage -pre nodeadd command to verify the specified nodes are configured correctly before adding them to your existing cluster, and to verify the integrity of the cluster before you add the nodes. Use the cluvfy stage -post nodeadd command to verify that the specified nodes have been successfully added to the cluster at the network, shared storage, and clusterware levels.Verifies that specific nodes have been successfully deleted from a cluster. Typically, this command verifies that the node-specific interface configuration details have been removed, the nodes are no longer a part of cluster configuration, and proper Oracle ASM cleanup has been performed.">Cluster Verification Utility Reference</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392" name="GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392"></a><h5 id="CWADD-GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392" class="sect5">Restoring the Oracle Cluster Registry in an Oracle Restart Environment</h5>
                     <div>
                        <p>Use this procedure to restore OCR in an Oracle Restart environment.</p>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392__GUID-F6F7178A-5A04-4A25-9FD4-309F79C18B4F">
                              <p class="notep1">Note:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>OCR is present for backward compatibility.</p>
                                 </li>
                                 <li>
                                    <p>Once an OCR location is created, it does not get updated in the Oracle Restart environment.</p>
                                 </li>
                                 <li>
                                    <p>If the Oracle Restart home has been backed up, and if there is a failure, then restoring the Oracle Restart home restores OCR.</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Stop Oracle High Availability Services by running the following command as <code class="codeph">root</code> on all of the nodes:</span><div><pre class="pre codeblock"><code># crsctl stop has [-f]</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Run the <code class="codeph">ocrcheck -config</code> command to determine the OCR location and then create an empty (0 byte) OCR location with appropriate permissions in that location.</span></li>
                           <li class="stepexpand"><span>Restore OCR by running the following command as <code class="codeph">root</code>:</span><div><pre class="pre codeblock"><code># crsctl pin css -n <span class="variable" translate="no">host_name</span></code></pre><div class="infoboxnote" id="GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392__GUID-E91D4120-BD84-41EB-B5DB-7FFCD773F85A">
                                    <p class="notep1">Note:</p>
                                    <p>Ensure that the OCR devices that you specify in the OCR configuration exist and that these OCR devices are valid.</p>
                                 </div>
                                 <div class="infoboxnotealso" id="GUID-F15F9F72-90F3-456D-8E55-5E3FA0959392__GUID-D75CA63F-4D83-4636-8C44-EE2A760601D7">
                                    <p class="notep1">See Also:</p>
                                    <p><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span> for information about creating OCRs
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Run the <code class="codeph">ocrcheck</code> command to verify the integrity of OCR:</span></li>
                           <li class="stepexpand"><span>Start Oracle High Availability Services by running the following command on all of the nodes:</span><div><pre class="pre codeblock"><code>$ crsctl start has</code></pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CWADD90974"></a><div class="props_rev_3"><a id="GUID-D3B9559B-054A-4574-854E-9865FEDF5EDD" name="GUID-D3B9559B-054A-4574-854E-9865FEDF5EDD"></a><h4 id="CWADD-GUID-D3B9559B-054A-4574-854E-9865FEDF5EDD" class="sect4">Diagnosing Oracle Cluster Registry Problems</h4>
                  <p>Use the OCRDUMP and OCRCHECK utilities to diagnose OCR problems.</p>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="oracle-cluster-registry-utility-reference.html#GUID-F4CE8CF1-24FD-43FA-BF62-70718955B386">OCRDUMP Utility Syntax and Options</a></li>
                           <li><a href="oracle-cluster-registry-utility-reference.html#GUID-458233B3-54A8-4D2E-A9B5-1D3BF6ADEAE5" title="The OCRCHECK utility displays the version of the OCR's block format, total space available and used space, OCRID, and the OCR locations that you have configured.">Using the OCRCHECK Utility</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD834"></a><div class="props_rev_3"><a id="GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E" name="GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E"></a><h4 id="CWADD-GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E" class="sect4">Administering Oracle Cluster Registry with Export and Import Commands</h4>
                  <div>
                     <p><a id="d37753e3893" class="indexterm-anchor"></a>In addition to using the automatically created OCR backup files, you should also export OCR contents before and after making significant configuration changes, such as adding or deleting nodes from your environment, modifying Oracle Clusterware resources, and upgrading, downgrading or creating a database. Do this by using the <code class="codeph">ocrconfig -export</code> command, which exports OCR content to a file format.
                     </p>
                     <div class="infoboxnote" id="GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E__GUID-B5864A03-9AE3-4345-9996-F67600461A23">
                        <p class="notep1">Caution:</p>
                        <p>Note the following restrictions for restoring OCR:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The file format generated by <code class="codeph">ocrconfig -restore</code> is incompatible with the file format generated by <code class="codeph">ocrconfig -export</code>. The <code class="codeph">ocrconfig -export</code> and <code class="codeph">ocrconfig -import</code> commands are compatible. The <code class="codeph">ocrconfig -manualbackup</code> and <code class="codeph">ocrconfig -restore</code> commands are compatible. The two file formats are incompatible and must not be interchangeably used.
                              </p>
                           </li>
                           <li>
                              <p>When exporting OCR, Oracle recommends including "<code class="codeph">ocr</code>", the cluster name, and the timestamp in the name string. For example:
                              </p><pre class="oac_no_warn" dir="ltr">ocr_mycluster1_20090521_2130_export</pre></li>
                        </ul>
                     </div>
                     <p><a id="d37753e3936" class="indexterm-anchor"></a><a id="d37753e3940" class="indexterm-anchor"></a>Using the <code class="codeph">ocrconfig -export</code> command also enables you to restore OCR using the <code class="codeph">-import</code> option if your configuration changes cause errors. For example, if you have <a id="d37753e3951" class="indexterm-anchor"></a>configuration problems that you cannot resolve, or if you are unable to restart Oracle Clusterware after such changes, then restore your configuration using the procedure for your platform.
                     </p>
                     <p>Oracle recommends that you use either automatic or manual backups, and the <code class="codeph">ocrconfig -restore</code> command instead of the <code class="codeph">ocrconfig -export</code> and <code class="codeph">ocrconfig -import</code> commands to restore OCR for the following reasons:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>A backup is a consistent snapshot of OCR, whereas an export is not.</p>
                        </li>
                        <li>
                           <p>Backups are created when the system is online. You must shut down Oracle Clusterware on all nodes in the cluster to get a consistent snapshot using the <code class="codeph">ocrconfig -export</code> command.
                           </p>
                        </li>
                        <li>
                           <p>You can inspect a backup using the OCRDUMP utility. You cannot inspect the contents of an export.</p>
                        </li>
                        <li>
                           <p>You can list backups with the <code class="codeph">ocrconfig -showbackup</code> command, whereas <span class="italic">you</span> must keep track of all generated exports.
                           </p>
                        </li>
                     </ul>
                     <p>This section includes the following topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-257FAFEE-51BE-4472-96F3-22DF84023793" title="Use this procedure to import OCR on Linux or UNIX systems.">Importing Oracle Cluster Registry Content on Linux or UNIX Systems</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E" title="Use this procedure to import OCR on Windows systems.">Importing Oracle Cluster Registry Content on Windows Systems</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-7B87F4D6-4146-4EB0-BD2F-17AED8C5F72E__GUID-3D39B776-87C6-40D5-9B8C-2D8E9F233C80">
                        <p class="notep1">Note:</p>
                        <p>Most configuration changes that you make not only change OCR contents, the configuration changes also cause file and database object creation. Some of these changes are often not restored when you restore OCR. Do not restore OCR as a correction to revert to previous configurations, if some of these configuration changes should fail. This may result in an OCR location that has contents that do not match the state of the rest of your system.</p>
                     </div>
                  </div><a id="CWADD90977"></a><div class="props_rev_3"><a id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793" name="GUID-257FAFEE-51BE-4472-96F3-22DF84023793"></a><h5 id="CWADD-GUID-257FAFEE-51BE-4472-96F3-22DF84023793" class="sect5">Importing Oracle Cluster Registry Content on Linux or UNIX Systems</h5>
                     <div>
                        <p>Use this procedure to import OCR on Linux or UNIX systems.</p>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__GUID-397DBF26-DA77-43D6-A909-9ADD2A77F839">
                              <p class="notep1">Note:</p>
                              <p>This procedure assumes default installation of Oracle Clusterware on all nodes in the cluster, where Oracle Clusterware autostart is enabled.</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>List the nodes in your cluster by running the following command on one node:</span><div><pre class="pre codeblock"><code>$ olsnodes	</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Stop Oracle Clusterware by running the following command as <code class="codeph">root</code> on all of the nodes:</span><div><pre class="pre codeblock"><code># crsctl stop crs</code></pre><p>If the preceding command returns any error due to OCR corruption, stop Oracle Clusterware by running the following command as <code class="codeph">root</code> on all of the nodes:
                                 </p><pre class="pre codeblock"><code># crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Start the Oracle Clusterware stack on one node in exclusive mode by running the following command as <code class="codeph">root</code>:</span><div><pre class="pre codeblock"><code># crsctl start crs -excl</code></pre><p>Ignore any errors that display.</p>
                                 <p>Check whether CRSD is running. If it is, stop it by running the following command as <code class="codeph">root</code>:
                                 </p><pre class="pre codeblock"><code># crsctl stop resource ora.crsd -init</code></pre><div class="infoboxnote" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__GUID-9035DE83-4A8F-4B22-A4F3-892FD5256DD8">
                                    <p class="notep1">Caution:</p>
                                    <p><span class="italic">Do not</span> use the <code class="codeph">-init</code> flag with any other command.
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Import OCR by running the following command as <code class="codeph">root</code>:</span><div><pre class="pre codeblock"><code># ocrconfig -import <span class="variable" translate="no">file_name</span></code></pre><p>If you are importing OCR to a cluster or network file system, then skip to step <a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-257FAFEE-51BE-4472-96F3-22DF84023793__BGBIJGAI">7</a>.
                                 </p>
                                 <div class="infoboxnote" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__GUID-B12EC987-97CC-4525-92E7-C7DB2E2C28A1">
                                    <p class="notep1">Note:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>If the original OCR location does not exist, then you must create an empty (0 byte) OCR location before you run the <code class="codeph">ocrconfig -import</code> command.
                                          </p>
                                       </li>
                                       <li>
                                          <p>Ensure that the OCR devices that you specify in the OCR configuration exist and that these OCR devices are valid.</p>
                                       </li>
                                       <li>
                                          <p>If you configured OCR in an Oracle ASM disk group, then ensure that the Oracle ASM disk group exists and is mounted.</p>
                                       </li>
                                    </ul>
                                 </div>
                                 <div class="infoboxnotealso" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__GUID-F784FF21-BF8F-45C2-9D45-D086D077E213">
                                    <p class="notep1">See Also:</p>
                                    <p><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span> for information about creating OCRs
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Verify the integrity of OCR:</span><div><pre class="pre codeblock"><code># ocrcheck</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Stop Oracle Clusterware on the node where it is running in exclusive mode:</span><div><pre class="pre codeblock"><code># crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__BGBIJGAI"><span>Begin to start Oracle Clusterware by running the following command as <code class="codeph">root</code> on all of the nodes:</span><div><pre class="pre codeblock"><code># crsctl start crs</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Verify OCR integrity of all of the cluster nodes that are configured as part of your cluster by running the following CVU command:</span><div><pre class="pre codeblock"><code>$ cluvfy comp ocr -n all -verbose</code></pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-257FAFEE-51BE-4472-96F3-22DF84023793__GUID-97C8B82D-8ADD-412F-8D86-11CBFFA01BFC">
                              <p class="notep1">Note:</p>
                              <p>You <span class="italic">can only</span> import an exported OCR. To restore OCR from a backup, you must instead use the <code class="codeph">-restore</code> option, as described in <span class="q">"Backing Up Oracle Cluster Registry"</span>.
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure Installation and Upgrade Guide</cite></span></a></li>
                              <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                              <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-8554ACE4-44DF-4DB5-A939-1DC6D62BAE60">Backing Up Oracle Cluster Registry</a></li>
                              <li><a href="cluster-verification-utility-reference.html#GUID-B445A858-9F00-4423-990E-109545AC11C3" title="CVU can verify the primary cluster components during an operational phase or stage.The following table includes deprecated and desupported CLUVFY commands:This section lists and describes CVU commands.Checks the integrity of Oracle Automatic Storage Management Cluster File System (Oracle ACFS) on all nodes in a cluster.Checks the required administrative privileges for the operation specified by -o parameter on all the nodes that you specify in the node list.Checks the integrity of Oracle Automatic Storage Management (Oracle ASM) on specific nodes in the cluster.Captures system and cluster configuration information to create a baseline.Checks clock synchronization across all the nodes in the node list.Checks the integrity of the cluster manager subcomponent, or Oracle Cluster Synchronization Services (CSS), on the nodes in the node list.Checks the integrity of the Cluster Ready Services (CRS) daemon on the specified nodes.Verifies that the DHCP server exists on the network, and that it can provide a required number of IP addresses.Verifies that the Grid Naming Service (GNS) subdomain delegation has been properly set up in the Domain Name Service (DNS) server.Checks the free space available in the Oracle Clusterware home storage and ensure that there is at least 5% of the total space available. Verifies the integrity of the Grid Naming Service (GNS) on the cluster.Checks the integrity of Grid Plug and Play on a list of nodes in a cluster.Checks the integrity of Oracle Restart on the local node.Checks your Oracle Clusterware and Oracle Database installations for their compliance with mandatory requirements and best practices guidelines, and to ensure that they are functioning properly.Checks for the existence of node applications, namely VIP, NETWORK, and ONS, on all of the specified nodes.Checks the connectivity among the nodes specified in the node list. If you provide an interface list, then CVU checks the connectivity using only the specified interfaces.Determines whether a source node can communicate with other, specific nodes.Checks the integrity of Oracle Cluster Registry (OCR) on all specified nodes.Checks the integrity of the Oracle High Availability Services daemon.Checks the integrity of Oracle Local Registry (OLR) on the local node.Checks the compatibility and properties of the specified nodes against a reference node.Checks the Single Client Access Name (SCAN) configuration.Checks the files and attributes installed with the Oracle software.Checks for free disk space at the location you specify in the -l parameter on all the specified nodes.Use the cluvfy comp ssa component verification command to discover and check the sharing of the specified storage locations. CVU checks sharing for nodes in the node list.Checks that the minimum system requirements are met for the specified product on all the specified nodes.Checks the voting files configuration and the udev settings for the voting files on all the specified nodes.Use the cluvfy stage -pre acfscfg command to verify your cluster nodes are set up correctly before configuring Oracle Automatic Storage Management Cluster File System (Oracle ACFS). Use the cluvfy stage -post acfscfg to check an existing cluster after you configure Oracle ACFS.Performs the appropriate post stage checks for Oracle Clusterware application cluster installation on all the nodes.Use the cluvfy stage -pre cfs stage verification command to verify your cluster nodes are set up correctly before configuring OCFS2. Use the cluvfy stage -post cfs stage verification command to perform the appropriate checks on the specified nodes after configuring OCFS2.Use the cluvfy stage -pre crsinst command with either the -file, -n, -flex, or -upgrade parameters to check the specified nodes before installing or upgrading Oracle Clusterware. Use the cluvfy stage -post crsinst command to check the specified nodes after installing Oracle Clusterware.Checks the specified nodes before configuring an Oracle RAC database to verify whether your system meets all of the criteria for creating a database or for making a database configuration change.Checks the specified nodes before installing or creating an Oracle RAC database to verify that your system meets all of the criteria for installing or creating an Oracle RAC database.Checks the local node after configuring Oracle Restart.Checks network and storage on the specified nodes in the cluster before installing Oracle software. This command also checks for supported storage types and checks each one for sharing.Use the cluvfy stage -pre nodeadd command to verify the specified nodes are configured correctly before adding them to your existing cluster, and to verify the integrity of the cluster before you add the nodes. Use the cluvfy stage -post nodeadd command to verify that the specified nodes have been successfully added to the cluster at the network, shared storage, and clusterware levels.Verifies that specific nodes have been successfully deleted from a cluster. Typically, this command verifies that the node-specific interface configuration details have been removed, the nodes are no longer a part of cluster configuration, and proper Oracle ASM cleanup has been performed.">Cluster Verification Utility Reference</a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CWADD90978"></a><div class="props_rev_3"><a id="GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E" name="GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E"></a><h5 id="CWADD-GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E" class="sect5">Importing Oracle Cluster Registry Content on Windows Systems</h5>
                     <div>
                        <p>Use this procedure to import OCR on Windows systems.</p>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E__GUID-2E1B0179-6501-4D84-B6FF-2AA4866EFF4F">
                              <p class="notep1">Note:</p>
                              <p>This procedure assumes default installation of Oracle Clusterware on all nodes in the cluster, where Oracle Clusterware autostart is enabled.</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>List the nodes in your cluster by running the following command on one node:</span><div><pre class="pre codeblock"><code>C:\&gt;olsnodes</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Stop Oracle Clusterware by running the following command as a member of the Administrators group on all of the nodes:</span><div><pre class="pre codeblock"><code>C:\&gt;crsctl stop crs
</code></pre><p>If the preceding command returns any error due to OCR corruption, stop Oracle Clusterware by running the following command as a member of the Administrators group on all of the nodes:</p><pre class="pre codeblock"><code>C:\&gt;crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Start the Oracle Clusterware stack on one node in exclusive mode by running the following command as a member of the Administrators group:</span><div><pre class="pre codeblock"><code>C:\&gt;crsctl start crs -excl</code></pre><p>Ignore any errors that display.</p>
                                 <p>Check whether CRSD is running. If it is, stop it by running the following command as a member of the Administrators group:</p><pre class="pre codeblock"><code>C:\&gt;crsctl stop resource ora.crsd -init</code></pre><div class="infoboxnote" id="GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E__GUID-8F2E6637-4378-4602-BEF9-7FB4989FAD2F">
                                    <p class="notep1">Caution:</p>
                                    <p><span class="italic">Do not</span> use the <code class="codeph">-init</code> flag in any other command.
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Import OCR by running the following command as a member of the Administrators group:</span><div><pre class="pre codeblock"><code>C:\&gt;ocrconfig -import <span class="variable" translate="no">file_name</span></code></pre><p>Make sure that the OCR devices that you specify in the OCR configuration exist and that these OCR devices are valid.</p>
                                 <div class="infoboxnote" id="GUID-DBF6C260-369E-47B3-B8F2-495A703ABC8E__GUID-66408D96-B1B7-498F-9302-1BA50A47C8C4">
                                    <p class="notep1">Note:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>If the original OCR location does not exist, then you must create an empty (0 byte) OCR location before you run the <code class="codeph">ocrconfig -import</code> command.
                                          </p>
                                       </li>
                                       <li>
                                          <p>Ensure that the OCR devices that you specify in the OCR configuration exist and that these OCR devices are valid.</p>
                                       </li>
                                       <li>
                                          <p>Ensure that the Oracle ASM disk group you specify exists and is mounted.</p>
                                       </li>
                                    </ul>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Verify the integrity of OCR:</span><div><pre class="pre codeblock"><code>C:\&gt;ocrcheck</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Stop Oracle Clusterware on the node where it is running in exclusive mode:</span><div><pre class="pre codeblock"><code>C:\&gt;crsctl stop crs -f</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Begin to start Oracle Clusterware by running the following command as a member of the Administrators group on all of the nodes:</span><div><pre class="pre codeblock"><code>C:\&gt;crsctl start crs</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Run the following Cluster Verification Utility (CVU) command to verify OCR integrity of all of the nodes in your cluster database:</span><div><pre class="pre codeblock"><code>C:\&gt;cluvfy comp ocr -n all -verbose</code></pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                              <li><a href="cluster-verification-utility-reference.html#GUID-B445A858-9F00-4423-990E-109545AC11C3" title="CVU can verify the primary cluster components during an operational phase or stage.The following table includes deprecated and desupported CLUVFY commands:This section lists and describes CVU commands.Checks the integrity of Oracle Automatic Storage Management Cluster File System (Oracle ACFS) on all nodes in a cluster.Checks the required administrative privileges for the operation specified by -o parameter on all the nodes that you specify in the node list.Checks the integrity of Oracle Automatic Storage Management (Oracle ASM) on specific nodes in the cluster.Captures system and cluster configuration information to create a baseline.Checks clock synchronization across all the nodes in the node list.Checks the integrity of the cluster manager subcomponent, or Oracle Cluster Synchronization Services (CSS), on the nodes in the node list.Checks the integrity of the Cluster Ready Services (CRS) daemon on the specified nodes.Verifies that the DHCP server exists on the network, and that it can provide a required number of IP addresses.Verifies that the Grid Naming Service (GNS) subdomain delegation has been properly set up in the Domain Name Service (DNS) server.Checks the free space available in the Oracle Clusterware home storage and ensure that there is at least 5% of the total space available. Verifies the integrity of the Grid Naming Service (GNS) on the cluster.Checks the integrity of Grid Plug and Play on a list of nodes in a cluster.Checks the integrity of Oracle Restart on the local node.Checks your Oracle Clusterware and Oracle Database installations for their compliance with mandatory requirements and best practices guidelines, and to ensure that they are functioning properly.Checks for the existence of node applications, namely VIP, NETWORK, and ONS, on all of the specified nodes.Checks the connectivity among the nodes specified in the node list. If you provide an interface list, then CVU checks the connectivity using only the specified interfaces.Determines whether a source node can communicate with other, specific nodes.Checks the integrity of Oracle Cluster Registry (OCR) on all specified nodes.Checks the integrity of the Oracle High Availability Services daemon.Checks the integrity of Oracle Local Registry (OLR) on the local node.Checks the compatibility and properties of the specified nodes against a reference node.Checks the Single Client Access Name (SCAN) configuration.Checks the files and attributes installed with the Oracle software.Checks for free disk space at the location you specify in the -l parameter on all the specified nodes.Use the cluvfy comp ssa component verification command to discover and check the sharing of the specified storage locations. CVU checks sharing for nodes in the node list.Checks that the minimum system requirements are met for the specified product on all the specified nodes.Checks the voting files configuration and the udev settings for the voting files on all the specified nodes.Use the cluvfy stage -pre acfscfg command to verify your cluster nodes are set up correctly before configuring Oracle Automatic Storage Management Cluster File System (Oracle ACFS). Use the cluvfy stage -post acfscfg to check an existing cluster after you configure Oracle ACFS.Performs the appropriate post stage checks for Oracle Clusterware application cluster installation on all the nodes.Use the cluvfy stage -pre cfs stage verification command to verify your cluster nodes are set up correctly before configuring OCFS2. Use the cluvfy stage -post cfs stage verification command to perform the appropriate checks on the specified nodes after configuring OCFS2.Use the cluvfy stage -pre crsinst command with either the -file, -n, -flex, or -upgrade parameters to check the specified nodes before installing or upgrading Oracle Clusterware. Use the cluvfy stage -post crsinst command to check the specified nodes after installing Oracle Clusterware.Checks the specified nodes before configuring an Oracle RAC database to verify whether your system meets all of the criteria for creating a database or for making a database configuration change.Checks the specified nodes before installing or creating an Oracle RAC database to verify that your system meets all of the criteria for installing or creating an Oracle RAC database.Checks the local node after configuring Oracle Restart.Checks network and storage on the specified nodes in the cluster before installing Oracle software. This command also checks for supported storage types and checks each one for sharing.Use the cluvfy stage -pre nodeadd command to verify the specified nodes are configured correctly before adding them to your existing cluster, and to verify the integrity of the cluster before you add the nodes. Use the cluvfy stage -post nodeadd command to verify that the specified nodes have been successfully added to the cluster at the network, shared storage, and clusterware levels.Verifies that specific nodes have been successfully deleted from a cluster. Typically, this command verifies that the node-specific interface configuration details have been removed, the nodes are no longer a part of cluster configuration, and proper Oracle ASM cleanup has been performed.">Cluster Verification Utility Reference</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CWADD90963"></a><div class="props_rev_3"><a id="GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07" name="GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07"></a><h4 id="CWADD-GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07" class="sect4">Oracle Local Registry</h4>
                  <div>
                     <p>In Oracle Clusterware 12<span class="italic">c</span>, each node in a cluster has a local registry for node-specific resources, called an <a id="d37753e4746" class="indexterm-anchor"></a><a id="d37753e4750" class="indexterm-anchor"></a>Oracle Local Registry (OLR), that is installed and configured when Oracle Clusterware installs OCR. Multiple processes on each node have simultaneous read and write access to the OLR particular to the node on which they reside, regardless of whether Oracle Clusterware is running or fully functional.
                     </p>
                     <p>By default, OLR is located at <span class="italic"><code class="codeph">Grid_home</code></span><code class="codeph">/cdata/</code><span class="italic"><code class="codeph">host_name</code></span><code class="codeph">.olr</code> on each node.
                     </p>
                     <p>Manage OLR using the OCRCHECK, OCRDUMP, and OCRCONFIG utilities as <code class="codeph">root</code> with the <code class="codeph">-local</code> option.
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You can check the status of OLR on the local node using the <a id="d37753e4780" class="indexterm-anchor"></a><a id="d37753e4784" class="indexterm-anchor"></a>OCRCHECK utility, as follows:
                           </p><pre class="oac_no_warn" dir="ltr"># ocrcheck -local

Status of Oracle Cluster Registry is as follows :
        Version                  :          3
        Total space (kbytes)     :     262132
        Used space (kbytes)      :      &nbsp;9200
        Available space (kbytes) :     252932
        ID                       : &nbsp;604793089
        Device/File Name         : /private2/crs/cdata/localhost/dglnx6.olr
                                   Device/File integrity check succeeded

        Local OCR integrity check succeeded
</pre></li>
                        <li>
                           <p>You can display the content of OLR on the local node to the text terminal that initiated the program using the <a id="d37753e4794" class="indexterm-anchor"></a><a id="d37753e4798" class="indexterm-anchor"></a>OCRDUMP utility, as follows:
                           </p><pre class="oac_no_warn" dir="ltr"># ocrdump -local -stdout
</pre></li>
                        <li>
                           <p>You can perform administrative tasks on OLR on the local node using the <a id="d37753e4808" class="indexterm-anchor"></a><a id="d37753e4812" class="indexterm-anchor"></a>OCRCONFIG utility.
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a id="d37753e4820" class="indexterm-anchor"></a>To export OLR to a file:
                                 </p><pre class="oac_no_warn" dir="ltr"># ocrconfig &#x2013;local &#x2013;export <span class="italic">file_name</span></pre><div class="infoboxnote" id="GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07__GUID-4B8A6070-237E-4DC6-A15F-F4DE5EB44351">
                                    <p class="notep1">Note:</p>
                                    <p></p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>Oracle recommends that you use the <code class="codeph">-manualbackup</code> and <code class="codeph">-restore</code> commands and not the <code class="codeph">-import</code> and <code class="codeph">-export</code> commands.
                                          </p>
                                       </li>
                                       <li>
                                          <p>When exporting OLR, Oracle recommends including "<code class="codeph">olr</code>", the host name, and the timestamp in the name string. For example:
                                          </p><pre class="oac_no_warn" dir="ltr">olr_myhost1_20090603_0130_export</pre></li>
                                    </ul>
                                 </div>
                              </li>
                              <li>
                                 <p><a id="d37753e4857" class="indexterm-anchor"></a>To import a specified file to OLR:
                                 </p><pre class="oac_no_warn" dir="ltr"># ocrconfig &#x2013;local &#x2013;import <span class="italic">file_name</span>
</pre></li>
                              <li>
                                 <p><a id="d37753e4869" class="indexterm-anchor"></a>To manually back up OLR:
                                 </p><pre class="oac_no_warn" dir="ltr"># ocrconfig &#x2013;local &#x2013;manualbackup</pre><div class="infoboxnote" id="GUID-4DEA42E9-8E97-474B-AAD8-E5E626FB8B07__GUID-4DFA5399-F9B0-4353-B34C-978950F80703">
                                    <p class="notep1">Note:</p>
                                    <p>Oracle Clusterware backs up OLR after installation or upgrade and, by default, periodically backs up OLR, thereafter. At any time after the initial backup, you can manually back up OLR.</p>
                                    <p>Oracle also recommends that you create a new backup when you migrate OCR from Oracle ASM to other storage, or when you migrate OCR from other storage to Oracle ASM. </p>
                                    <p>The default backup location for the OLR is in the path <span class="italic"><code class="codeph">Grid_home</code></span><code class="codeph">/cdata/</code><span class="italic"><code class="codeph">host_name</code></span>. 
                                    </p>
                                 </div>
                              </li>
                              <li>
                                 <p><a id="d37753e4894" class="indexterm-anchor"></a>To view the contents of the OLR backup file:
                                 </p><pre class="oac_no_warn" dir="ltr">ocrdump -local -backupfile <span class="italic">olr_backup_file_name</span>
</pre></li>
                              <li>
                                 <p>To change the OLR backup location:</p><pre class="oac_no_warn" dir="ltr">ocrconfig -local -backuploc <span class="italic">new_olr_backup_path</span>
</pre></li>
                              <li>
                                 <p><a id="d37753e4914" class="indexterm-anchor"></a>To restore OLR:
                                 </p><pre class="oac_no_warn" dir="ltr"># crsctl stop crs
# ocrconfig -local -restore <span class="italic">file_name</span>
# ocrcheck -local
# crsctl start crs
$ cluvfy comp olr</pre></li>
                           </ul>
                        </li>
                     </ul>
                  </div>
               </div><a id="CWADD837"></a><div class="props_rev_3"><a id="GUID-1D3FDBE6-03ED-49B9-A181-2463C59331DA" name="GUID-1D3FDBE6-03ED-49B9-A181-2463C59331DA"></a><h4 id="CWADD-GUID-1D3FDBE6-03ED-49B9-A181-2463C59331DA" class="sect4">Upgrading and Downgrading the Oracle Cluster Registry Configuration</h4>
                  <div>
                     <div class="section">
                        <p><a id="d37753e5043" class="indexterm-anchor"></a><a id="d37753e5047" class="indexterm-anchor"></a>When you upgrade Oracle Clusterware, it automatically runs the <code class="codeph">ocrconfig -upgrade</code> command. To downgrade, follow the downgrade instructions for each component and also downgrade OCR using the <code class="codeph">ocrconfig -downgrade</code> command. If you are upgrading OCR, then you can use the OCRCHECK utility to verify the integrity of OCR.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="CWADD833"></a><div class="props_rev_3"><a id="GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81" name="GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81"></a><h3 id="CWADD-GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81" class="sect3">Managing Voting Files</h3>
               <div>
                  <p>This section includes the following topics for managing voting files in your cluster:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-7680E1EB-C91F-4B32-82B8-80AC5D57D13C" title="If you choose to store your voting files in Oracle ASM, then Oracle ASM stores all the voting files for the cluster in the disk group you choose.">Storing Voting Files on Oracle ASM</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-6F5C4029-78F0-4A06-ADC7-70E1E2C597C8" title="Oracle Clusterware automatically backs up voting file data in OCR as part of any configuration change and automatically restores the data to any voting file you add.">Backing Up Voting Files</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1">Restoring Voting Files</a></p>
                     </li>
                     <li>
                        <p><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-044D58CA-6392-40A1-AB31-C84A2A5A5CE6">Adding_ Deleting_ or Migrating Voting Files</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81__GUID-1E8B8703-4B81-46B8-B353-3CA22CB48159">
                     <p class="notep1">Caution:</p>
                     <p>The <code class="codeph">dd</code> commands used to back up and recover voting files in previous versions of Oracle Clusterware are not supported in Oracle Clusterware 12<span class="italic">c</span>. Restoring voting files that were copied using <code class="codeph">dd</code> or <code class="codeph">cp</code> commands can prevent the Oracle Clusterware 12<span class="italic">c</span> stack from coming up. Use the backup and restore procedures described in this chapter to ensure proper voting file functionality.
                     </p>
                  </div>
                  <div class="infoboxnote" id="GUID-00137A43-61A5-446B-BFEA-D7EFDA535E81__GUID-B7A4CAE8-5323-4A41-B880-2BFDF118E95A">
                     <p class="notep1">Note:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Voting file management requires a valid and working OCR. Before you add, delete, replace, or restore voting files, run the <code class="codeph">ocrcheck</code> command as <code class="codeph">root</code>. If OCR is not available or it is corrupt, then you must restore OCR as described in <span class="q">"Restoring Oracle Cluster Registry"</span>.
                           </p>
                        </li>
                        <li>
                           <p>If you upgrade from a previous version of Oracle Clusterware to Oracle Clusterware 12<span class="italic">c</span> and you want to store voting files in an Oracle ASM disk group, then you must set the <span class="bold">ASM Compatibility</span> (<code class="codeph">COMPATIBLE.ASM</code>) compatibility attribute to <code class="codeph">12.1.0.0</code>.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-648BB199-AFB9-416A-8438-E0331C255E78" title="A procedure for OCR restoration for your platform.">Restoring Oracle Cluster Registry</a></li>
                        <li><a href="../ostmg/diskgroup-compatibility.html#OSTMG-GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                     </ul>
                  </div>
               </div><a id="CWADD91889"></a><div class="props_rev_3"><a id="GUID-7680E1EB-C91F-4B32-82B8-80AC5D57D13C" name="GUID-7680E1EB-C91F-4B32-82B8-80AC5D57D13C"></a><h4 id="CWADD-GUID-7680E1EB-C91F-4B32-82B8-80AC5D57D13C" class="sect4">Storing Voting Files on Oracle ASM</h4>
                  <div>
                     <p>If you choose to store your voting files in Oracle ASM, then Oracle ASM stores all the voting files for the cluster in the disk group you choose.</p>
                     <p>Oracle ASM manages voting files differently from other files that it stores. You cannot use voting files stored in Oracle ASM and voting files not stored in Oracle ASM in the same cluster.</p>
                     <p>Once you configure voting files on Oracle ASM, you can only make changes to the voting files' configuration using the <code class="codeph">crsctl replace votedisk</code> command. This is true even in cases where there are no working voting files. Despite the fact that <code class="codeph">crsctl query css votedisk</code> reports zero vote disks in use, Oracle Clusterware remembers the fact that Oracle ASM was in use and the <code class="codeph">replace</code> verb is required. Only after you use the <code class="codeph">replace</code> verb to move voting files back to non-Oracle ASM storage are the verbs <code class="codeph">add css votedisk</code> and <code class="codeph">delete css votedisk</code> again usable.
                     </p>
                     <p>The number of voting files you can store in a particular Oracle ASM disk group depends upon the redundancy of the disk group.</p>
                     <p>By default, Oracle ASM puts each voting file in its own failure group within the disk group. A failure group is a subset of the disks in a disk group. Failure groups define disks that share components, such that if one fails then other disks sharing the component might also fail. An example of what you might define as a failure group would be a set of SCSI disks sharing the same SCSI controller. Failure groups are used to determine which Oracle ASM disks to use for storing redundant data. For example, if two-way mirroring is specified for a file, then redundant copies of file extents must be stored in separate failure groups.</p>
                     <p>The redundancy level that you choose for the Oracle ASM disk group determines how Oracle ASM mirrors files in the disk group, and determines the number of disks and amount of disk space that you require. If the voting files are in a disk group, then the disk groups that contain Oracle Clusterware files (OCR and voting files) have a higher minimum number of failure groups than other disk groups because the voting files are stored in quorum failure groups.</p>
                     <p>A quorum failure group is a special type of failure group that is used to store the Oracle Clusterware voting files. The quorum failure group is used to ensure that a quorum of the specified failure groups are available. When Oracle ASM mounts a disk group that contains Oracle Clusterware files, the quorum failure group is used to determine if the disk group can be mounted if there is a loss of one or more failure groups. Disks in the quorum failure group do not contain user data, therefore a quorum failure group is not considered when determining redundancy requirements in respect to storing user data.</p>
                     <p>An Oracle ASM flex disk group is a disk group type that supports Oracle ASM file groups and quota groups. In general, a flex disk group enables users to manage storage at the granularity of the database, in addition to at the disk group level.</p>
                     <p>Redundancy levels include:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">External redundancy</span>: An external redundancy disk group requires a minimum of one disk device. The effective disk space in an external redundancy disk group is the sum of the disk space in all of its devices.
                           </p>
                           <p>Because Oracle ASM does not mirror data in an external redundancy disk group, Oracle recommends that you use external redundancy with storage devices such as RAID, or other similar devices that provide their own data protection mechanisms.</p>
                        </li>
                        <li>
                           <p><span class="bold">Normal redundancy</span>: A normal redundancy disk group requires a minimum of two disk devices (or two failure groups). The effective disk space in a normal redundancy disk group is half the sum of the disk space in all of its devices.
                           </p>
                           <p>For Oracle Clusterware files, a normal redundancy disk group requires a minimum of three disk devices (two of the three disks are used by failure groups and all three disks are used by the quorum failure group) and provides three voting files and one OCR and mirror of the OCR. When using a normal redundancy disk group, the cluster can survive the loss of one failure group.</p>
                        </li>
                        <li>
                           <p><span class="bold">High redundancy</span>: In a high redundancy disk group, Oracle ASM uses three-way mirroring to increase performance and provide the highest level of reliability. A high redundancy disk group requires a minimum of three disk devices (or three failure groups). The effective disk space in a high redundancy disk group is one-third the sum of the disk space in all of its devices.
                           </p>
                           <p>For Oracle Clusterware files, a high redundancy disk group requires a minimum of five disk devices (three of the five disks are used by failure groups and all five disks are used by the quorum failure group) and provides five voting files and one OCR and two mirrors of the OCR. With high redundancy, the cluster can survive the loss of two failure groups.</p>
                        </li>
                     </ul>
                     <p>Using the <code class="codeph">crsctl replace votedisk</code> command, you can move a given set of voting files from one Oracle ASM disk group into another, or onto a certified file system. If you move voting files from one Oracle ASM disk group to another, then you can change the number of voting files by placing them in a disk group of a different redundancy level as the former disk group.
                     </p>
                     <div class="infoboxnote" id="GUID-7680E1EB-C91F-4B32-82B8-80AC5D57D13C__GUID-A64F98A4-44B1-4CBD-87D9-51B30C52BB33">
                        <p class="notep1">Note:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You cannot directly influence the number of voting files in one disk group.</p>
                           </li>
                           <li>
                              <p>You cannot use the <code class="codeph">crsctl add | delete votedisk</code> commands on voting files stored in Oracle ASM disk groups because Oracle ASM manages the number of voting files according to the redundancy level of the disk group.
                              </p>
                           </li>
                           <li>
                              <p>You cannot add a voting file to a cluster file system if the voting files are stored in an Oracle ASM disk group. Oracle does not support having voting files in Oracle ASM and directly on a cluster file system for the same cluster at the same time.</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../ostmg/diskgroup-compatibility.html#OSTMG-GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                           <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-044D58CA-6392-40A1-AB31-C84A2A5A5CE6">Adding, Deleting, or Migrating Voting Files</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD90960"></a><div class="props_rev_3"><a id="GUID-6F5C4029-78F0-4A06-ADC7-70E1E2C597C8" name="GUID-6F5C4029-78F0-4A06-ADC7-70E1E2C597C8"></a><h4 id="CWADD-GUID-6F5C4029-78F0-4A06-ADC7-70E1E2C597C8" class="sect4">Backing Up Voting Files</h4>
                  <div>
                     <p>Oracle Clusterware automatically backs up voting file data in OCR as part of any configuration change and automatically restores the data to any voting file you add.</p>
                     <div class="section">
                        <p>If all voting files are corrupted, however, you can restore them as described in <span class="q">"Restoring Voting Files"</span>.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1">Restoring Voting Files</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD90961"></a><div class="props_rev_3"><a id="GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1" name="GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1"></a><h4 id="CWADD-GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1" class="sect4">Restoring Voting Files</h4>
                  <div>
                     <div class="section">
                        <p>If all of the voting files are corrupted, then you can restore them, as follows:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Restore OCR as described in <span class="q">"Restoring Oracle Cluster Registry"</span>, if necessary.</span><div>
                              <p>This step is necessary only if OCR is also corrupted or otherwise unavailable, such as if OCR is on Oracle ASM and the disk group is no longer available.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the following command as <code class="codeph">root</code> from only one node to start the Oracle Clusterware stack in exclusive mode, which does not require voting files to be present or usable:</span><div><pre class="pre codeblock"><code># crsctl start crs -excl</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">crsctl query css votedisk</code> command to retrieve the list of voting files currently defined, similar to the following:</span><div><pre class="pre codeblock"><code>$ crsctl query css votedisk
--  -----    -----------------                --------- ---------
##  STATE    File Universal Id                File Name Disk group
 1. ONLINE   6f57843d89464c46ea747362e8a3fa43 (/dev/sdb1) [DATA]
 2. ONLINE   7c54856e98474f61bf349401e7c9fb95 (/dev/sdc1) [DATA]
 3. ONLINE   9c46232b76234f61fc934673d5c8ec59 (/dev/sdd1) [DATA]</code></pre><p>This list may be empty if all voting files were corrupted, or may have entries that are marked as status <code class="codeph">3</code> or <code class="codeph">OFF</code>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Depending on where you store your voting files, do one of the following:</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>If the voting files are stored in Oracle ASM, then run the following command to migrate the voting files to the Oracle ASM disk group you specify:</p><pre class="pre codeblock"><code>crsctl replace votedisk +<span class="variable" translate="no">asm_disk_group</span></code></pre><p>The Oracle ASM disk group to which you migrate the voting files must exist in Oracle ASM. You can use this command whether the voting files were stored in Oracle ASM or some other storage device.</p>
                                 </li>
                                 <li>
                                    <p>If you did not store voting files in Oracle ASM, then run the following command using the File Universal Identifier (FUID) obtained in the previous step:</p><pre class="pre codeblock"><code>$ crsctl delete css votedisk <span class="variable" translate="no">FUID</span></code></pre><p>Add a voting file, as follows:</p><pre class="pre codeblock"><code>$ crsctl add css votedisk <span class="variable" translate="no">path_to_voting_disk</span></code></pre></li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Stop the Oracle Clusterware stack as <code class="codeph">root</code>:</span><div><pre class="pre codeblock"><code># crsctl stop crs</code></pre><div class="infoboxnote" id="GUID-D977F7F1-94FB-425C-A284-F45C102CE6C1__GUID-E8268B76-35CA-4299-8D0A-98A6C11A1637">
                                 <p class="notep1">Note:</p>
                                 <p>If the Oracle Clusterware stack is running in exclusive mode, then use the <code class="codeph">-f</code> option to force the shutdown of the stack.
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Restart the Oracle Clusterware stack in normal mode as <code class="codeph">root</code>:</span><div><pre class="pre codeblock"><code># crsctl start crs</code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="managing-oracle-cluster-registry-and-voting-files.html#GUID-648BB199-AFB9-416A-8438-E0331C255E78" title="A procedure for OCR restoration for your platform.">Restoring Oracle Cluster Registry</a></li>
                           <li><a href="../ostmg/admin-asm-diskgroups.html#OSTMG-GUID-C455CEB1-0FC3-4DF4-9CD4-25EFA4D2BE01" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD90962"></a><div class="props_rev_3"><a id="GUID-044D58CA-6392-40A1-AB31-C84A2A5A5CE6" name="GUID-044D58CA-6392-40A1-AB31-C84A2A5A5CE6"></a><h4 id="CWADD-GUID-044D58CA-6392-40A1-AB31-C84A2A5A5CE6" class="sect4">Adding, Deleting, or Migrating Voting Files</h4>
                  <div>
                     <p><a id="d37753e5993" class="indexterm-anchor"></a><a id="d37753e5997" class="indexterm-anchor"></a><a id="d37753e6001" class="indexterm-anchor"></a>You can add, remove, and migrate voting files after you install Oracle Clusterware. Note that the commands you use to do this are different, depending on whether your voting files are located in Oracle ASM, or are located in another storage option.
                     </p>
                  </div>
                  <div class="props_rev_3"><a id="GUID-168E2ACA-185B-48B7-AC17-49422A43A32D" name="GUID-168E2ACA-185B-48B7-AC17-49422A43A32D"></a><h5 id="CWADD-GUID-168E2ACA-185B-48B7-AC17-49422A43A32D" class="sect5">Modifying Voting Files that are Stored in Oracle ASM</h5>
                     <div>
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>To <a id="d37753e6132" class="indexterm-anchor"></a>display the voting file FUID and file path of each current voting file, run the <code class="codeph">crsctl query css votedisk</code> command to display output similar to the following:
                                 </p><pre class="oac_no_warn" dir="ltr">$ crsctl query css votedisk
--  -----    -----------------                --------- ---------
##  STATE    File Universal Id                File Name Disk group
 1. ONLINE   6f57843d89464c46ea747362e8a3fa43 (/dev/sdb1) [DATA]
 2. ONLINE   7c54856e98474f61bf349401e7c9fb95 (/dev/sdc1) [DATA]
 3. ONLINE   9c46232b76234f61fc934673d5c8ec59 (/dev/sdd1) [DATA]
</pre><p>This command returns a disk sequence number, the status of the disk, the FUID, the path of the disk, and the name of the Oracle ASM disk group on which the disk is stored.</p>
                              </li>
                              <li>
                                 <p><a id="d37753e6148" class="indexterm-anchor"></a>To migrate voting files from Oracle ASM to an alternative storage device, specify the path to the non-Oracle ASM storage device with which you want to replace the Oracle ASM disk group using the following command:
                                 </p><pre class="oac_no_warn" dir="ltr">$ crsctl replace votedisk <span class="italic">path_to_voting_disk</span>
</pre><p>You can run this command on any node in the cluster.</p>
                              </li>
                              <li>
                                 <p>To <a id="d37753e6163" class="indexterm-anchor"></a>replace all voting files not stored in Oracle ASM with voting files managed by Oracle ASM in an Oracle ASM disk group, run the following command:
                                 </p><pre class="oac_no_warn" dir="ltr">$ crsctl replace votedisk +<span class="italic">asm_disk_group</span></pre></li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-C5843B47-5815-4D64-B455-D27A2752A7A4" name="GUID-C5843B47-5815-4D64-B455-D27A2752A7A4"></a><h5 id="CWADD-GUID-C5843B47-5815-4D64-B455-D27A2752A7A4" class="sect5">Modifying Voting Files that are Not Stored on Oracle ASM</h5>
                     <div>
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>To <a id="d37753e6298" class="indexterm-anchor"></a>display the voting file FUID and file path of each current voting file, run the following command:
                                 </p><pre class="oac_no_warn" dir="ltr">$ crsctl query css votedisk
##  STATE    File Universal Id                File Name Disk group
--  -----    -----------------                --------- ---------
 1. ONLINE   7c54856e98474f61bf349401e7c9fb95 (/cfs/host09_vd3) []
</pre><p>This command returns a disk sequence number, the status of the disk, the FUID, and the path of the disk and no name of an Oracle ASM disk group.</p>
                              </li>
                              <li>
                                 <p>To <a id="d37753e6312" class="indexterm-anchor"></a>add one or more voting files, run the following command, replacing the <span class="italic"><code class="codeph">path_to_voting_disk</code></span> variable with one or more space-delimited, complete paths to the voting files you want to add:
                                 </p><pre class="oac_no_warn" dir="ltr">$ crsctl add css votedisk <span class="italic">path_to_voting_disk</span> [...]
</pre></li>
                              <li>
                                 <p>To <a id="d37753e6329" class="indexterm-anchor"></a>replace voting file A with voting file B, you must add voting file B, and then delete voting file A. To add a new disk and remove the existing disk, run the following command, replacing the <span class="italic"><code class="codeph">path_to_voting_diskB</code></span> variable with the fully qualified path name of voting file B:
                                 </p><pre class="oac_no_warn" dir="ltr">$ crsctl add css votedisk <span class="italic">path_to_voting_diskB</span> -purge
</pre><p>The <code class="codeph">-purge</code> option deletes existing voting files.
                                 </p>
                              </li>
                              <li>
                                 <p>To <a id="d37753e6351" class="indexterm-anchor"></a>remove a voting file, run the following command, specifying one or more space-delimited, voting file FUIDs or comma-delimited directory paths to the voting files you want to remove:
                                 </p><pre class="oac_no_warn" dir="ltr">$ crsctl delete css votedisk {<span class="italic">FUID</span> | <span class="italic">path_to_voting_disk</span>[...]}</pre></li>
                           </ul>
                           <div class="infoboxnote" id="GUID-C5843B47-5815-4D64-B455-D27A2752A7A4__GUID-1C98D09D-3B2D-4D56-AAAA-A2558A1E3AC4">
                              <p class="notep1">Note:</p>
                              <p>If the cluster is down and cannot restart due to lost voting files, then you must start CSS in exclusive mode by running the following command, as <code class="codeph">root</code>:
                              </p><pre class="oac_no_warn" dir="ltr"># crsctl start crs -excl
</pre><p>After you start CSS in exclusive mode, you can replace the voting file, as follows:</p><pre class="oac_no_warn" dir="ltr"># crsctl replace votedisk <span class="italic">path_to_voting_disk</span></pre></div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-B2F1E3CA-AD08-41C2-AC07-746F45EFDE3E" name="GUID-B2F1E3CA-AD08-41C2-AC07-746F45EFDE3E"></a><h5 id="CWADD-GUID-B2F1E3CA-AD08-41C2-AC07-746F45EFDE3E" class="sect5">Migrating Voting Files to Oracle ASM</h5>
                     <div>
                        <div class="section">
                           <p>To <a id="d37753e6497" class="indexterm-anchor"></a>migrate voting files to Oracle ASM, specify the Oracle ASM disk group name in the following command:
                           </p><pre class="oac_no_warn" dir="ltr">$ crsctl replace votedisk +<span class="italic">asm_disk_group</span>
</pre><p>You can run this command on any node in the cluster.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-3CFFB9B4-9DD2-45F1-B4AF-90CB5FB51095" name="GUID-3CFFB9B4-9DD2-45F1-B4AF-90CB5FB51095"></a><h5 id="CWADD-GUID-3CFFB9B4-9DD2-45F1-B4AF-90CB5FB51095" class="sect5">Verifying the Voting File Location</h5>
                     <div>
                        <div class="section">
                           <p>After modifying the voting file, verify the voting file location, as follows:</p><pre class="pre codeblock"><code>$ crsctl query css votedisk</code></pre></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="oracle-clusterware-control-crsctl-utility-reference.html#GUID-D8EE89D2-BC62-4C16-A157-BFFAD80295F8" title="Displays the voting files used by Cluster Synchronization Services, the status of the voting files, and the location of the disks, whether they are stored in Oracle ASM or elsewhere.">crsctl query css votedisk</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>