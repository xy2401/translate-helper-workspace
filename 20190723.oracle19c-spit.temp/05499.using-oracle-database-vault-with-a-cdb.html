<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="You can use Oracle Database Vault in a multitenant container database (CDB).">
      <meta name="description" content="You can use Oracle Database Vault in a multitenant container database (CDB).">
      <title>Using Oracle Database Vault with a CDB</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Administrator’s Guide ">
      <meta property="og:description" content="You can use Oracle Database Vault in a multitenant container database (CDB).">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Administrator’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="multitenant-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-20T09:59:22-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96136-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-oracle-scheduler-with-a-cdb.html" title="Previous" type="text/html">
      <link rel="next" href="using-xstream-with-a-cdb.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Multitenant Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="MULTI">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-oracle-scheduler-with-a-cdb.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-xstream-with-a-cdb.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Administrator’s Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="using-oracle-features-in-a-multitenant-environment.html" property="item" typeof="WebPage"><span property="name">Using Oracle Features in a Multitenant Environment</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Using Oracle Database Vault with a CDB</li>
            </ol>
            <a id="GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" name="GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3"></a>
            
            <h2 id="MULTI-GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" class="sect2"><span class="enumeration_chapter">24 </span> Using Oracle Database Vault with a CDB
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>You can use Oracle Database Vault in a multitenant container database (CDB).</p>
               <p>This section contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-59526942-DC4F-489B-819E-D4F33BA17F9D">About Oracle Database Vault</a><br>The Oracle Database Vault security controls protect application data from unauthorized access, and comply with privacy and regulatory requirements. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-F4182518-DEFF-4433-9593-0D73315DF661">How Oracle Database Vault Works in a Multitenant Environment</a><br>To provide increased security for consolidation, you can use Oracle Database Vault with Oracle Multitenant.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-B5569AED-AC16-482C-BA6D-34E275F016D2">Verifying That Database Vault Is Configured and Enabled</a><br>The <code class="codeph">DBA_DV_STATUS</code>, <code class="codeph">CDB_DV_STATUS</code>, <code class="codeph">DBA_OLS_STATUS</code>, and <code class="codeph">CDB_OLS_STATUS</code> data dictionary views verify if Oracle Database is configured and enabled. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D">Registering Oracle Database Vault with an Oracle Database in a Multitenant Environment</a><br>You can register Oracle Database Vault in a multitenant environment based on several scenarios. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6">Configuring Realms</a><br>You can create a realm around database objects to protect them, and then set authorizations to control user access to this data. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-6308CB8B-6777-44AF-A523-F1A956591F6D">Rule Sets and Rules in a Multitenant Environment</a><br>In a multitenant environment, you can create a rule set and its associated rules in the application root.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84">Command Rules in a Multitenant Environment</a><br>In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-07513135-CB45-4788-A596-E5A71879BB81">Oracle Database Vault Policies in a Multitenant Environment</a><br>Oracle Database Vault policies are only local to the pluggable database (PDB) in which they were created. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F">Using Database Vault Operations Control to Restrict Multitenant Common User Access to Local PDB Data</a><br>You can control PDB access by CDB root common users, such as infrastructure database administrators.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-517E9611-546B-43D9-8C54-37037AF0B198">Converting a Standalone Oracle Database to a PDB and Plugging It into a CDB</a><br>You can convert a standalone Oracle Database Release 12c or later database to a PDB, and then plug this PDB into a CDB.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="using-oracle-features-in-a-multitenant-environment.html#GUID-CE922DAA-66FB-430B-96E5-29FF50BFD2FF" title="You can use Oracle Database features in a multitenant environment.">Using Oracle Features in a Multitenant Environment</a></p>
                  </div>
               </div>
            </div>
            
            <div class="props_rev_3"><a id="GUID-59526942-DC4F-489B-819E-D4F33BA17F9D" name="GUID-59526942-DC4F-489B-819E-D4F33BA17F9D"></a><h3 id="MULTI-GUID-59526942-DC4F-489B-819E-D4F33BA17F9D" class="sect3"><span class="enumeration_section">24.1 </span>About Oracle Database Vault
               </h3>
               <div>
                  <p>The Oracle Database Vault security controls protect application data from unauthorized access, and comply with privacy and regulatory requirements. </p>
                  <p>You can deploy controls to block privileged account access to application data and control sensitive operations inside the database using trusted path authorization. Through the analysis of privileges and roles, you can increase the security of existing applications by using least privilege best practices. Oracle Database Vault secures existing database environments transparently, eliminating costly and time consuming application changes.</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../dvadm/introduction-to-oracle-database-vault.html#DVADM-GUID-0C8AF1B2-6CE9-4408-BFB3-7B2C7F9E7284" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-F4182518-DEFF-4433-9593-0D73315DF661" name="GUID-F4182518-DEFF-4433-9593-0D73315DF661"></a><h3 id="MULTI-GUID-F4182518-DEFF-4433-9593-0D73315DF661" class="sect3"><span class="enumeration_section">24.2 </span>How Oracle Database Vault Works in a Multitenant Environment
               </h3>
               <div>
                  <p>To provide increased security for consolidation, you can use Oracle Database Vault with Oracle Multitenant.</p>
                  <p>Oracle Database Vault can prevent privileged user access inside a pluggable database (PDB) and between the PDB and the common privileged user at the container database. Each PDB has its own Database Vault metadata, such as realms, rule sets, command rules, default policies (such as default realms), and so on. In addition, the objects within the <code class="codeph">DVSYS</code> and <code class="codeph">DVF</code> schemas are automatically available to any child PDBs. Both schemas are common user schemas. 
                  </p>
                  <p>You can configure common realms in the application root only, but you can create common rule sets and command rules in either the application root or the CDB root. A common command rule in the application root applies to its associated PDBs, and common command rules in the CDB root apply to all PDBs in the CDB environment. The ability to create common realms and command rules enables you to create policies that use a shared set of realms, rule sets, or command rules throughout the CDB environments, rather than having to create these same components for every PDB in the multitenant environment. The common protection applies for all PDBs associated with the application root that have Oracle Database Vault enabled.</p>
                  <p>You can create individual local policies for each PDB. When you use Database Vault to protect an object, Database Vault subjects common privileges for common objects to the same enforcement rules as local system privileges. </p>
                  <p>When you configure a PDB that has Database Vault enabled, the <code class="codeph">DVSYS</code> schema is a common user schema that is stored in the root. This means that all the objects within the <code class="codeph">DVSYS</code> schema (tables, data dictionary views, user accounts, PL/SQL packages, default policies, and so on) are subject to the common privileges available for this schema. In other words, you can create realms, factors, and so on in the root to protect the schema in the root. Ensure that you configure Database Vault in the root first, before you configure it in the associated PDBs.
                  </p>
                  <p>When you enable Oracle Database Vault in the CDB root, you can choose either regular mode or strict mode. The settings propagate throughout the CDB based on the setting you choose. For example, suppose a CDB contains both Database Vault-enabled PDBs and PDBs in which Database Vault is not enabled. If you enable Database Vault using regular mode, then both types of PDBs continue to function normally. If you enable Database Vault using strict mode, then the Database Vault-disabled PDBs operate in restricted mode. </p>
                  <p><a href="using-oracle-database-vault-with-a-cdb.html#GUID-F4182518-DEFF-4433-9593-0D73315DF661__CHDGHEHH">Figure 24-1</a> illustrates how the database in regular mode allows different access for common and local database administrators depending if Database Vault is enabled. In this scenario, neither the common user nor the local users have access to the realms in PDB1 and PDB2. Both the common user and the PDB3 local user have access to the Custom App application in PDB3, where Database Vault is not enabled.
                  </p>
                  <div class="figure" id="GUID-F4182518-DEFF-4433-9593-0D73315DF661__CHDGHEHH">
                     <p class="titleinfigure">Figure 24-1 Oracle Database Vault in a Multitenant Environment with Regular Mode</p><img src="img/dvadm_vm_005c.png" alt="Description of Figure 24-1 follows" title="Description of Figure 24-1 follows" longdesc="img_text/dvadm_vm_005c.html"><br><a href="img_text/dvadm_vm_005c.html">Description of "Figure 24-1 Oracle Database Vault in a Multitenant Environment with Regular Mode"</a></div>
                  <!-- class="figure" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-72403156-3E91-43FD-8D06-859DBBC10568" title="In a multitenant environment, you can create a realm to protect common objects in the application root.">Realms in a Multitenant Environment</a></li>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" title="In a multitenant environment, you can create a rule set and its associated rules in the application root.">Rule Sets and Rules in a Multitenant Environment</a></li>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" title="In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.">Command Rules in a Multitenant Environment</a></li>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-517E9611-546B-43D9-8C54-37037AF0B198" title="You can convert a standalone Oracle Database Release 12c or later database to a PDB, and then plug this PDB into a CDB.">Converting a Standalone Oracle Database to a PDB and Plugging It into a CDB</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" name="GUID-B5569AED-AC16-482C-BA6D-34E275F016D2"></a><h3 id="MULTI-GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" class="sect3"><span class="enumeration_section">24.3 </span>Verifying That Database Vault Is Configured and Enabled
               </h3>
               <div>
                  <p>The <code class="codeph">DBA_DV_STATUS</code>, <code class="codeph">CDB_DV_STATUS</code>, <code class="codeph">DBA_OLS_STATUS</code>, and <code class="codeph">CDB_OLS_STATUS</code> data dictionary views verify if Oracle Database is configured and enabled. 
                  </p>
                  <div class="section">In addition to Oracle Database Vault administrators, the Oracle Database <code class="codeph">SYS</code> user and users who have been granted the <code class="codeph">DBA</code> role can query these views. 
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>For Database Vault: </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>If you want to find the Database Vault status for a non-multitenant database, or in a multitenant environment for the root only or an individual PDB, then query <code class="codeph">DBA_DV_STATUS</code>. For example:
                                 </p><pre class="pre codeblock"><code>SELECT * FROM DBA_DV_STATUS;</code></pre><p>Output similar to the following appears:</p><pre class="pre codeblock"><code>NAME                 STATUS
-------------------- -----------
DV_CONFIGURE_STATUS  TRUE
DV_ENABLE_STATUS     TRUE</code></pre></li>
                              <li>
                                 <p>If you want to find the Database Vault status of all PDBs in a multitenant environment, as a common user with administrative privileges, then query <code class="codeph">CDB_DV_STATUS</code>, which provides the addition of a container ID (<code class="codeph">CON_ID</code>) field.
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>For Oracle Label Security, query the following data dictionary views, which are similar to their Database Vault equivalent views:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">DBA_OLS_STATUS</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">CDB_OLS_STATUS</code></p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" name="GUID-68558E32-ABD0-4495-8677-4F9E09283E5D"></a><h3 id="MULTI-GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" class="sect3"><span class="enumeration_section">24.4 </span>Registering Oracle Database Vault with an Oracle Database in a Multitenant Environment
               </h3>
               <div>
                  <p>You can register Oracle Database Vault in a multitenant environment based on several scenarios. </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A">Registering Database Vault in the CDB Root</a><br>In a multitenant environment, you register Oracle Database Vault with common users who will use the Database Vault-enforced roles in the CDB root.
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193">Registering Database Vault Common Users to Manage Specific PDBs</a><br>In a multitenant environment, you must register Oracle Database Vault in the root first, then in the PDBs afterward.
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-75E90559-133D-4B5E-B658-D77810B590C6">Registering Database Vault Local Users to Manage Specific PDBs</a><br>In a multitenant environment, you must register Oracle Database Vault in the root first, and then in the PDBs afterward.
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-54699671-483A-49EF-B900-81D286845E8E">Plugging in a Database Vault-Enabled PDB</a><br>From SQL*Plus, in a multitenant environment, you can plug in a database that already has Database Vault enabled. 
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260">Manually Installing Oracle Database Vault in a Multitenant Environment</a><br>Under certain conditions, for a multitenant environment, you must manually install Oracle Database Vault. For example, a release 11g Oracle database without Database Vault is upgraded to release 12c, then converted to a PDB to be plugged into a 12c Database Vault-enabled database.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A" name="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A"></a><h4 id="MULTI-GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A" class="sect4"><span class="enumeration_section">24.4.1 </span>Registering Database Vault in  the CDB Root
                  </h4>
                  <div>
                     <p>In a multitenant environment, you register Oracle Database Vault with common users who will use the Database Vault-enforced roles in the CDB root.</p>
                     <ol>
                        <li class="stepexpand"><span>In a multitenant environment, log into the root of the database instance as a user who has privileges to create users and grant the <code class="codeph">CREATE SESSION</code> and <code class="codeph">SET CONTAINER</code> privileges.</span><div>
                              <p>For example:</p><pre class="pre codeblock"><code>sqlplus c##dba_debra
Enter password: <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand" id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A__CHDGDEIB"><span>Select user accounts (or create new users) that will be used for the Database Vault Owner (<code class="codeph">DV_OWNER</code> role) and Database Vault Account Manager (<code class="codeph">DV_ACCTMGR</code> role) accounts. </span><div>
                              <p>Oracle strongly recommends that you maintain two accounts for each role. One account, the primary named user account, will be used on a day-to-day basis and the other account will be used as a backup account in case the password of the primary account is lost and must be reset.</p>
                           </div>
                           <div>
                              <p>Prepend the names of these accounts with <code class="codeph">c##</code> or <code class="codeph">C##</code>. For example: 
                              </p><pre class="pre codeblock"><code>GRANT CREATE SESSION, SET CONTAINER TO c##sec_admin_owen IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL;
GRANT CREATE SESSION, SET CONTAINER TO c##dbv_owner_root_backup IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL;
GRANT CREATE SESSION, SET CONTAINER TO c##accts_admin_ace IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL;
GRANT CREATE SESSION, SET CONTAINER TO c##dbv_acctmgr_root_backup IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL;
</code></pre><p>In this specification: </p>
                              <ul style="list-style-type: disc;" id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A__UL_EFL_1LP_GFB">
                                 <li>Create the primary accounts (<code class="codeph">c##sec_admin_owen</code> and<code class="codeph"> c##accts_admin_ace</code>) if these do not already exist for the new roles, <code class="codeph">DV_ADMIN</code> and <code class="codeph">DV_ACCTMGR</code>.
                                 </li>
                                 <li>Replace <span class="italic"><code class="codeph">password</code></span> with a password that is secure. 
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Connect to the root as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege </span><div><pre class="pre codeblock"><code>CONNECT SYS AS SYSDBA
Enter password: <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Configure the two backup Database Vault user accounts. </span><div>For example:<pre class="pre codeblock"><code>BEGIN
 CONFIGURE_DV (
 &nbsp;&nbsp;dvowner_uname         =&gt; 'c##dbv_owner_root_backup',
 &nbsp;&nbsp;dvacctmgr_uname       =&gt; 'c##dbv_acctmgr_root_backup',
   force_local_dvowner   =&gt; FALSE);
 END;
/
</code></pre></div>
                           <div>In this example, setting <code class="codeph">force_local_dvowner</code> to <code class="codeph">FALSE</code> enables the common users to have <code class="codeph">DV_OWNER</code> privileges for the PDBs that are associated with this CDB root. Setting it to <code class="codeph">TRUE</code> restricts the common <code class="codeph">DV_OWNER</code> user to have the <code class="codeph">DV_OWNER</code> role privileges for the CDB root only. If you grant <code class="codeph">DV_OWNER</code> locally to the CDB root common user, then that user cannot grant the <code class="codeph">DV_OWNER</code> role commonly to any other user. 
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">utlrp.sql</code> script to recompile invalidated objects in the root. </span><div><pre class="pre codeblock"><code>@?/rdbms/admin/utlrp.sql
</code></pre><p>If the script provides instructions, follow them, and then run the script again. If the script terminates abnormally without giving any instructions, then run it again.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Connect to the root as the primary Database Vault Owner user that you just configured. </span><div>
                              <p>For example:</p><pre class="pre codeblock"><code>CONNECT c##sec_admin_owen
Enter password: <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Enable Oracle Database Vault using one of the following commands:</span><div>
                              <ul style="list-style-type: disc;" id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A__UL_LYQ_35D_R2B">
                                 <li>
                                    <p>To enable Oracle Database Vault to use regular mode:</p><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV;</code></pre></li>
                                 <li>
                                    <p>If every associated PDB must have Database Vault enabled in this database, use the following command. PDBs that do not have Database Vault enabled will be in restricted mode after the database is restarted and until Database Vault is enabled in the PDB:</p><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV (strict_mode =&gt; 'y');</code></pre></li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Connect with the <code class="codeph">SYSDBA</code> administrative privilege.</span><div><pre class="pre codeblock"><code>CONNECT / AS SYSDBA
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Restart the database. </span><div><pre class="pre codeblock"><code>SHUTDOWN IMMEDIATE
STARTUP
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Verify that Oracle Database Vault and Oracle Label Security are installed and enabled.</span><div><pre class="pre codeblock"><code>SELECT * FROM DBA_DV_STATUS;
SELECT * FROM DBA_OLS_STATUS;
SELECT * FROM CDB_DV_STATUS;
SELECT * FROM CDB_OLS_STATUS;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as the backup <code class="codeph">DV_OWNER</code> user and then grant the <code class="codeph">DV_OWNER</code> role to the primary <code class="codeph">DV_OWNER</code> user that you created earlier.</span><div>
                              <p>For example:</p><pre class="pre codeblock"><code>CONNECT c##dbv_owner_root_backup
Enter password: <span class="italic">password</span>

GRANT DV_OWNER TO c##sec_admin_owen WITH ADMIN OPTION;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as the backup <code class="codeph">DV_ACCTMGR</code> user and then grant the <code class="codeph">DV_ACCTMGR</code> role to the backup <code class="codeph">DV_ACCTMGR</code> user. </span><div>
                              <p>For example:</p><pre class="pre codeblock"><code>CONNECT c##dbv_acctmgr_root_backup
Enter password: <span class="italic">password</span>

GRANT DV_ACCTMGR TO c##accts_admin_ace WITH ADMIN OPTION;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Store the two backup account passwords in a safe location such as a privileged account management (PAM) system in case they are needed in the future.</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" title="The DBA_DV_STATUS, CDB_DV_STATUS, DBA_OLS_STATUS, and CDB_OLS_STATUS data dictionary views verify if Oracle Database is configured and enabled.">Verifying That Database Vault Is Configured and Enabled</a></li>
                           <li><a href="../dvadm/oracle-database-vault-schemas-roles-and-accounts.html#DVADM-GUID-4E1707B4-F9BB-4131-9D3E-90BB273F2832" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                           <li><a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM-GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" title="You can register Oracle Database Vault in a multitenant environment based on several scenarios.">Registering Oracle Database Vault with an Oracle Database in a Multitenant Environment</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193" name="GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193"></a><h4 id="MULTI-GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193" class="sect4"><span class="enumeration_section">24.4.2 </span>Registering Database Vault Common Users to Manage Specific PDBs
                  </h4>
                  <div>
                     <p>In a multitenant environment, you must register Oracle Database Vault in the root first, then in the PDBs afterward.</p>
                     <div class="section"> If you try to register in a PDB first, then an <code class="codeph">ORA-47503: Database Vault is not enabled on CDB$ROOT</code> error appears.
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>If you have not already done so, then identify or create named common user accounts to be used as the Database Vault accounts along with associated backup accounts. </span></li>
                        <li class="stepexpand"><span>Ensure that you have registered Oracle Database Vault in the CDB root and that the <code class="codeph">DV_OWNER</code> role was granted commonly to the common user.</span></li>
                        <li class="stepexpand"><span>Connect to the PDB as an administrator who is local to the PDB. </span><div>For example:<pre class="pre codeblock"><code>CONNECT dba_debra@<span class="italic">pdb_name</span>
Enter password: <span class="italic">password</span>
</code></pre><p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Grant the <code class="codeph">CREATE SESSION</code> and <code class="codeph">SET CONTAINER</code> privileges to the users for this PDB. </span><div>For example: <pre class="pre codeblock"><code>GRANT CREATE SESSION, SET CONTAINER TO c##sec_admin_owen CONTAINER = CURRENT;
GRANT CREATE SESSION, SET CONTAINER TO c##accts_admin_ace CONTAINER = CURRENT;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege </span><div><pre class="pre codeblock"><code>CONNECT SYS@<span class="italic">pdb_name</span> AS SYSDBA
Enter password: <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>While still in the PDB, configure the two backup Database Vault user accounts. </span><div><pre class="pre codeblock"><code>BEGIN
 CONFIGURE_DV (
 &nbsp;&nbsp;dvowner_uname         =&gt; 'c##dbv_owner_root_backup',
 &nbsp;&nbsp;dvacctmgr_uname       =&gt; 'c##dbv_acctmgr_root_backup');
 END;
/
</code></pre><p>In this example, the <code class="codeph">force_local_dvowner</code> parameter is omitted because it is unnecessary. All common users who are configured within a PDB are restricted to the scope of the PDB.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">utlrp.sql</code> script to recompile invalidated objects in this PDB. </span><div><pre class="pre codeblock"><code>@?/rdbms/admin/utlrp.sql
</code></pre><p>If the script provides instructions, follow them, and then run the script again. If the script terminates abnormally without giving any instructions, then run it again.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Connect to the PDB as the backup Database Vault Owner user that you just configured. </span><div>For example:<pre class="pre codeblock"><code>CONNECT c##dbv_owner_root_backup@<span class="italic">pdb_name</span>
Enter password: <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Enable Oracle Database Vault in this PDB.</span><div><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect to the CDB with the <code class="codeph">SYSDBA</code> administrative privilege.</span><div><pre class="pre codeblock"><code>CONNECT / AS SYSDBA
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Close and reopen the PDB. </span><div>For example:<pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> CLOSE IMMEDIATE;

ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> OPEN;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Verify that the PDB is configured and enabled for Database Vault.</span><div><pre class="pre codeblock"><code>CONNECT SYS@<span class="italic">pdb_name</span> AS SYSDBA
Enter password: <span class="italic">password</span>

SELECT * FROM DBA_DV_STATUS;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as the backup <code class="codeph">DV_OWNER</code> user and then grant the <code class="codeph">DV_OWNER</code> role to the primary <code class="codeph">DV_OWNER</code> user that you created earlier.</span><div>
                              <p>For example:</p><pre class="pre codeblock"><code>CONNECT c##dbv_owner_backup
Enter password: <span class="italic">password</span>

GRANT DV_OWNER TO c##sec_admin_owen WITH ADMIN OPTION;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as the backup <code class="codeph">DV_ACCTMGR</code> user and then grant the <code class="codeph">DV_ACCTMGR</code> role to the primary <code class="codeph">DV_ACCTMGR</code> user. </span><div>
                              <p>For example:</p><pre class="pre codeblock"><code>CONNECT c##dbv_acctmgr_root_backup
Enter password: <span class="italic">password</span>

GRANT DV_ACCTMGR TO c##accts_admin_ace WITH ADMIN OPTION;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Store the two backup account passwords in a safe location such as a privileged account management (PAM) system in case they are needed in the future.</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" title="The DBA_DV_STATUS, CDB_DV_STATUS, DBA_OLS_STATUS, and CDB_OLS_STATUS data dictionary views verify if Oracle Database is configured and enabled.">Verifying That Database Vault Is Configured and Enabled</a></li>
                           <li><a href="../dvadm/oracle-database-vault-schemas-roles-and-accounts.html#DVADM-GUID-4E1707B4-F9BB-4131-9D3E-90BB273F2832" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                           <li><a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM-GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" title="You can register Oracle Database Vault in a multitenant environment based on several scenarios.">Registering Oracle Database Vault with an Oracle Database in a Multitenant Environment</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-75E90559-133D-4B5E-B658-D77810B590C6" name="GUID-75E90559-133D-4B5E-B658-D77810B590C6"></a><h4 id="MULTI-GUID-75E90559-133D-4B5E-B658-D77810B590C6" class="sect4"><span class="enumeration_section">24.4.3 </span>Registering Database Vault Local Users to Manage Specific PDBs
                  </h4>
                  <div>
                     <p>In a multitenant environment, you must register Oracle Database Vault in the root first, and then in the PDBs afterward.</p>
                     <div class="p">If you try to register in a PDB first, then an <code class="codeph">ORA-47503: Database Vault is not enabled on CDB$ROOT</code> error appears.
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>In a multitenant environment, log into the PDB as a user who has privileges to create users and to grant the <code class="codeph">CREATE SESSION</code> and <code class="codeph">SET CONTAINER</code> privileges.</span><div>For example:<pre class="pre codeblock"><code>sqlplus sec_admin@<span class="italic">pdb_name</span>
Enter password: <span class="italic">password
</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>If you are not using existing local user named accounts for the new Database Vault roles, create new named local user accounts. </span><div>In both cases, you must create backup accounts to hold the Database Vault roles in case the named user loses or forgets their password.</div>
                           <div><pre class="pre codeblock"><code>GRANT CREATE SESSION, SET CONTAINER TO sec_admin_owen IDENTIFIED BY <span class="italic">password</span>;
GRANT CREATE SESSION, SET CONTAINER TO dbv_owner_backup IDENTIFIED BY <span class="italic">password</span>;
GRANT CREATE SESSION, SET CONTAINER TO accts_admin_ace IDENTIFIED BY <span class="italic">password</span>;
GRANT CREATE SESSION, SET CONTAINER TO dbv_acctmgr_backup IDENTIFIED BY <span class="italic">password</span>;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Ensure that you have registered Oracle Database Vault in the CDB root.</span><div>Temporarily connect to the root and then query the <code class="codeph">DBA_DV_STATUS</code> view. <pre class="pre codeblock"><code>CONNECT SYS / AS SYSDBA
Enter password: <span class="italic">password
</span>
SELECT * FROM DBA_DV_STATUS;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect to the PDB as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege. </span><div><pre class="pre codeblock"><code>CONNECT SYS@<span class="italic">pdb_name</span> AS SYSDBA
Enter password: <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>While still in the PDB, configure the two backup Database Vault user accounts. </span><div><pre class="pre codeblock"><code>BEGIN
 CONFIGURE_DV (
   dvowner_uname         =&gt; 'dbv_owner_backup',
   dvacctmgr_uname       =&gt; 'dbv_acctmgr_backup');
 END;
/
</code></pre><p>In this example, the <code class="codeph">force_local_dvowner</code> parameter is omitted because it is unnecessary. Database Vault roles are granted locally when configured in a PDB.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">utlrp.sql</code> script to recompile invalidated objects in this PDB. </span><div><pre class="pre codeblock"><code>@?/rdbms/admin/utlrp.sql</code></pre><p>If the script provides instructions, follow them, and then run the script again. If the script terminates abnormally without giving any instructions, run it again.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Connect to the PDB as the backup Database Vault Owner user that you just configured. </span><div>For example:<pre class="pre codeblock"><code>CONNECT dbv_owner_backup@<span class="italic">pdb_name</span>
Enter password: <span class="italic">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Enable Oracle Database Vault in this PDB.</span><div><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect to the CDB with the <code class="codeph">SYSDBA</code> administrative privilege.</span><div><pre class="pre codeblock"><code>CONNECT / AS SYSDBA</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Close and reopen the PDB. </span><div><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> CLOSE IMMEDIATE;
ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> OPEN;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Verify that the PDB is configured and enabled for Database Vault.</span><div><pre class="pre codeblock"><code>CONNECT SYS@<span class="italic">pdb_name</span> AS SYSDBA
Enter password: <span class="italic">password</span>

SELECT * FROM DBA_DV_STATUS;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as the backup <code class="codeph">DV_OWNER</code> user and then grant the <code class="codeph">DV_OWNER</code> role to the primary <code class="codeph">DV_OWNER</code> user that you created earlier.</span><div>
                              <p>For example:</p><pre class="pre codeblock"><code>CONNECT dbv_owner_backup
Enter password: <span class="italic">password</span>

GRANT DV_OWNER TO sec_admin_owen WITH ADMIN OPTION;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect as the backup <code class="codeph">DV_ACCTMGR</code> user and then grant the <code class="codeph">DV_ACCTMGR</code> role to the backup <code class="codeph">DV_ACCTMGR</code> user. </span><div>
                              <p>For example:</p><pre class="pre codeblock"><code>CONNECT dbv_acctmgr_backup
Enter password: <span class="italic">password</span>

GRANT DV_ACCTMGR TO c##accts_admin_ace WITH ADMIN OPTION;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Store the two backup account passwords in a safe location such as a privileged account management (PAM) system in case they are needed in the future.</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" title="You can register Oracle Database Vault in a multitenant environment based on several scenarios.">Registering Oracle Database Vault with an Oracle Database in a Multitenant Environment</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-54699671-483A-49EF-B900-81D286845E8E" name="GUID-54699671-483A-49EF-B900-81D286845E8E"></a><h4 id="MULTI-GUID-54699671-483A-49EF-B900-81D286845E8E" class="sect4"><span class="enumeration_section">24.4.4 </span>Plugging in a Database Vault-Enabled PDB
                  </h4>
                  <div>
                     <p>From SQL*Plus, in a multitenant environment, you can plug in a database that already has Database Vault enabled. </p>
                     <p>In this scenario, the plugged in database has its own local Database Vault accounts. Be aware that if you plug a Database Vault-enabled database into a CDB that is not Database Vault enabled, then the PDB will remain in restricted mode until you enable Database Vault in the CDB and then restart the CDB. If you plug a non-Database Vault-enabled PDB into a CDB that is Database Vault enabled, then the PDB remains in restricted mode until you enable Database Vault in the PDB and then restart the PDB. This plugged in non-Database Vault enabled PDB can still be used. However, if the CDB is Database Vault enabled with the strict option set, then the PDB must be Database Vault enabled.</p>
                     <p>Before you plug in a Database Vault-enabled PDB and if the Database Vault roles are granted to common users, ensure that you understand fully how plugging in PDBs affect common users.</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../dbseg/managing-security-for-oracle-database-users.html#DBSEG-GUID-81D0494C-E838-4DD9-AC82-B56473F98D06" target="_blank"><span><cite>Oracle Database Security Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" title="You can register Oracle Database Vault in a multitenant environment based on several scenarios.">Registering Oracle Database Vault with an Oracle Database in a Multitenant Environment</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260" name="GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260"></a><h4 id="MULTI-GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260" class="sect4"><span class="enumeration_section">24.4.5 </span>Manually Installing Oracle Database Vault in a Multitenant Environment
                  </h4>
                  <div>
                     <p>Under certain conditions, for a multitenant environment, you must manually install Oracle Database Vault. For example, a release 11g Oracle database without Database Vault is upgraded to release 12c, then converted to a PDB to be plugged into a 12c Database Vault-enabled database.</p>
                     <div class="section">You must manually install Oracle Database Vault (and Oracle Label Security) in a PDB if this PDB does not have these products when the PDB has been plugged into a CDB where Database Vault and Label Security are installed.</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>As user who has been granted the <code class="codeph">SYSDBA</code> administrative privilege, log in to the PDB in which you want to install Oracle Database Vault. </span><div>
                              <p>For example, to log in to a PDB named <code class="codeph">hr_pdb</code>:
                              </p><pre class="pre codeblock"><code>sqlplus sec_admin@hr_pdb as sysdba
Enter password: <span class="italic">password</span></code></pre><p>To find the available PDBs, run the <code class="codeph">show pdbs</code> command. To check the current PDB, run the <code class="codeph">show con_name</code> command.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>If necessary, check if Oracle Database Vault and Oracle Label Security are already installed on this PDB.</span><div>If the <code class="codeph">DVSYS</code> account (for Database Vault) and the <code class="codeph"> LBACSYS</code> account (for Label Security) exist, then Database Vault and Label Security exist on the PDB. 
                           </div>
                           <div><pre class="pre codeblock"><code>SELECT USERNAME FROM DBA_USERS WHERE USERNAME IN ('DVSYS', 'LBACSYS');</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>If neither Database Vault nor Label Security have been installed, then install Oracle Label Security by executing the <code class="codeph">catols.sql</code> script.</span><div><pre class="pre codeblock"><code>@$ORACLE_HOME/rdbms/admin/catols.sql</code></pre><p>Oracle Label Security must be installed before you can install Oracle Database Vault.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Install Oracle Database Vault by executing the <code class="codeph">catmac.sql</code> script.</span><div><pre class="pre codeblock"><code>@$ORACLE_HOME/rdbms/admin/catmac.sql</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>At the <code class="codeph">Enter value for 1</code> prompt, enter <code class="codeph">SYSTEM</code> as the tablespace to install <code class="codeph">DVSYS</code>.</span></li>
                        <li class="stepexpand"><span>At the <code class="codeph">Enter value for 2</code> prompt, enter the temporary tablespace for the PDB.</span></li>
                     </ol>
                     <div class="section">After the installation is complete, you can register Oracle Database Vault in the PDB. If Database Vault is not registered in the CDB already, you must close the PDB before you can register Database Vault in the CDB root. Database Vault must be registered in CDB root before it can be registered in the PDB. After Database Vault is registered in the CDB root and the database has been restarted, then you can open the PDB and register Database Vault.</div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM-GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" title="You can register Oracle Database Vault in a multitenant environment based on several scenarios.">Registering Oracle Database Vault with an Oracle Database in a Multitenant Environment</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6" name="GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6"></a><h3 id="MULTI-GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6" class="sect3"><span class="enumeration_section">24.5 </span>Configuring Realms
               </h3>
               <div>
                  <p>You can create a realm around database objects to protect them, and then set authorizations to control user access to this data. </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-D200353D-D15B-46AE-82DA-FE874D24800C">What Are Realms?</a><br>Realms enable you to protect database objects, including specific object types. 
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673">Realm Authorizations in a Multitenant Environment</a><br>In a multitenant environment, the rules and behavior for common realm authorizations are similar to the authorizations for other common objects. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-D200353D-D15B-46AE-82DA-FE874D24800C" name="GUID-D200353D-D15B-46AE-82DA-FE874D24800C"></a><h4 id="MULTI-GUID-D200353D-D15B-46AE-82DA-FE874D24800C" class="sect4"><span class="enumeration_section">24.5.1 </span>What Are Realms?
                  </h4>
                  <div>
                     <p>Realms enable you to protect database objects, including specific object types. </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-5B043984-7C0F-49E3-8A0C-A983E4F12FD0">About Realms</a><br>A realm is a grouping of database schemas, database objects, and database roles that must be secured for a given application. 
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-72403156-3E91-43FD-8D06-859DBBC10568">Realms in a Multitenant Environment</a><br>In a multitenant environment, you can create a realm to protect common objects in the application root.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6" title="You can create a realm around database objects to protect them, and then set authorizations to control user access to this data.">Configuring Realms</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-5B043984-7C0F-49E3-8A0C-A983E4F12FD0" name="GUID-5B043984-7C0F-49E3-8A0C-A983E4F12FD0"></a><h5 id="MULTI-GUID-5B043984-7C0F-49E3-8A0C-A983E4F12FD0" class="sect5"><span class="enumeration_section">24.5.1.1 </span>About Realms
                     </h5>
                     <div>
                        <p>A realm is a grouping of database schemas, database objects, and database roles that must be secured for a given application. </p>
                        <p>Think of a realm as zone of protection for your database objects. A schema is a logical collection of database objects such as tables, views, and packages, and a role is a collection of privileges. By arranging schemas and roles into functional groups, you can control the ability of users to use system privileges against these groups and prevent unauthorized data access by the database administrator or other powerful users with system privileges. Oracle Database Vault does not replace the discretionary access control model in the existing Oracle database. It functions as a layer on top of this model for both realms and command rules.</p>
                        <p>Oracle Database Vault provides two types of realms: regular and mandatory. Both realm types can protect either an entire schema or crucial objects within a schema selectively, such as tables and indexes. With a regular realm, an object owner or users who has been granted object privileges can perform queries or DML operations without realm authorization but must have realm authorization to perform DDL operations. A mandatory realm provides stronger protection for objects within a realm. Mandatory realms block both object privilege-based and system privilege-based access and will not allow users with object privileges to perform queries, DML, or DDL operations without realm authorization. In other words, even an object owner cannot access his or her own objects without proper realm authorization if the objects are protected by mandatory realms.</p>
                        <p>For databases that use Oracle Flashback Technology, then both regular and mandatory realms will enforce the same behavior for a flashback table. Users can execute a <code class="codeph">FLASHBACK TABLE</code> SQL statement on a realm-protected table if the user is authorized to the realm.
                        </p>
                        <p>For databases that use Information Lifecycle Management (ILM), a Database Vault administrator can use the <code class="codeph">DBMS_MACADM.AUTHORIZE_MAINTENANCE_USER</code> and <code class="codeph">DBMS_MACADM.UNAUTHORIZE_MAINTENANCE_USER</code> procedure to control who can perform ILM operations on realm-protected objects.
                        </p>
                        <p>You can register schemas, all objects of a certain type in a schema, or individual objects within a schema into a realm. After you create a realm, you can register a set of schema objects or roles (secured objects) for realm protection and authorize a set of users or roles to access the secured objects. Objects that are protected by a regular realm allow DML access to users who have direct object grants. </p>
                        <p>For example, you can create a realm to protect all existing database schemas that are used in an accounting department. The realm prohibits any user who is not authorized to the realm to use system privileges to access the secured accounting data. When an entire schema is protected, all objects in the schema are protected, including tables, indexes, procedures and other objects.</p>
                        <p>You can run reports on realms that you create in Oracle Database Vault. You can use simulation mode during development, test, and even production phases to log only realm violations instead of blocking access. This enables you to quickly test applications using Database Vault realms.</p>
                        <p>You can configure realms by using the Oracle Database Vault Administrator pages in Oracle Enterprise Manager Cloud Control. Alternatively, you can configure realms by using the PL/SQL interfaces and packages provided by Oracle Database Vault.</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-D200353D-D15B-46AE-82DA-FE874D24800C" title="Realms enable you to protect database objects, including specific object types.">What Are Realms?</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-72403156-3E91-43FD-8D06-859DBBC10568" name="GUID-72403156-3E91-43FD-8D06-859DBBC10568"></a><h5 id="MULTI-GUID-72403156-3E91-43FD-8D06-859DBBC10568" class="sect5"><span class="enumeration_section">24.5.1.2 </span>Realms in a Multitenant Environment
                     </h5>
                     <div>
                        <p>In a multitenant environment, you can create a realm to protect common objects in the application root.</p>
                        <p>The advantage of creating a realm in the application root instead of creating a large number objects and realms around these objects within individual pluggable databases (PDBs) is that you can create them in one place, the application root. This way, you can manage them centrally.</p>
                        <p>You cannot create a common realm in the CDB root. </p>
                        <p>A Database Vault common realm can be either a regular realm or a mandatory realm. The realm protects only objects within the application root, not local objects in a PDB. The CDB root, application root, and any affected PDBs all must be Database Vault enabled. </p>
                        <p>To configure a common realm, you must be commonly granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role. To grant common authorizations for a common realm, you must be in the application root. To propagate the realm to the PDBs that are associated with the application root, you must synchronize the application root. For example, to synchronize an application called <code class="codeph">saas_sales_app</code></p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE APPLICATION saas_sales_app SYNC;</code></pre></div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="../dvadm/configuring-realms.html#DVADM-GUID-18D6FFCB-42C2-49D1-9F53-BADE7B0754AB" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-D200353D-D15B-46AE-82DA-FE874D24800C" title="Realms enable you to protect database objects, including specific object types.">What Are Realms?</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
               <div class="sect3"><a id="GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673" name="GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673"></a><h4 id="MULTI-GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673" class="sect4"><span class="enumeration_section">24.5.2 </span>Realm Authorizations in a Multitenant Environment
                  </h4>
                  <div>
                     <p>In a multitenant environment, the rules and behavior for common realm authorizations are similar to the authorizations for other common objects. </p>
                     <p><span class="bold">Local Authorization for a Common Realm</span></p>
                     <p>The local authorization for a common realm refers to the authorization a user has for the PDB that this user is accessing. </p>
                     <p>The rules for the local authorization for a common realm are as follows: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>A user who has been commonly granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role can grant local authorization to common users, common roles, local users, and local roles. The common <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> user can also remove local authorization from a common realm in a PDB.
                           </p>
                        </li>
                        <li>
                           <p>A local Database Vault administrator can authorize locally (that is, grant local authorizations to both local and common users) within the PDB. A common Database Vault administrator can also grant authorizations in each PDB. A common realm authorization can only be granted by a common Database Vault administrator in the application root. </p>
                        </li>
                        <li>
                           <p>The common Database Vault administrator can both add or remove local authorization to and from a common realm from within the PDB.</p>
                        </li>
                        <li>
                           <p> If a common user has only local authorization for a common realm, then this user cannot access the common realm in any other PDB than this local authorization. </p>
                        </li>
                        <li>
                           <p>A common user or a common role can have both the local authorization and the common authorization to a common realm at the same time. Removing a common user’s local authorization from a common realm does not affect the common user’s common authorization. Removing a common user’s common authorization from a common realm does not affect the common user’s local authorization. </p>
                        </li>
                     </ul>
                     <p><span class="bold">Common Authorization for a Common Realm</span></p>
                     <p>The common authorization for a common realm refers to the authorization a common user or a common role has in the application root while the authorization takes effect in every container that is Database Vault enabled.</p>
                     <p>The rules for the local authorization for a common realm are as follows: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>A user who has been commonly granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role can grant common realm authorization to common users or roles in the application root. This common Database Vault administrator can perform the removal of common authorizations while in the application root.
                           </p>
                        </li>
                        <li>
                           <p>This common authorization applies to the containers that have been Database Vault enabled in the CDB. </p>
                        </li>
                        <li>
                           <p>If a common user is authorized to a common realm in the application root, then this user has access to the objects protected by the common realm in the application root and any application PDBs.</p>
                        </li>
                        <li>
                           <p>Any rule sets that are associated with a common realm must be common rule sets. The rules that are added to a common rule set that is associated with common authorization cannot involve any local objects. </p>
                        </li>
                     </ul>
                     <p><span class="bold">How the Authorization of a Realm Works in Both the Application Root and in an Individual PDB</span></p>
                     <p>During the Database Vault enforcement in a container, a common realm performs the same enforcement behaviors as the same realm when it is used locally in a PDB. </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-86DA4697-8BE2-4F27-92E3-C15843F9A3A6" title="You can create a realm around database objects to protect them, and then set authorizations to control user access to this data.">Configuring Realms</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" name="GUID-6308CB8B-6777-44AF-A523-F1A956591F6D"></a><h3 id="MULTI-GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" class="sect3"><span class="enumeration_section">24.6 </span>Rule Sets and Rules in a Multitenant Environment
               </h3>
               <div>
                  <p>In a multitenant environment, you can create a rule set and its associated rules in the application root.</p>
                  <p>A common realm must use a common rule set when the associated realm or command rule is evaluated by Database Vault. The common rule set and its rules can only be created in the application root. After the common rule set is created, it exists in every container that is associated with the root where the common rule set is created. The common rule set can only include common rules.</p>
                  <p>To configure a common rule set and its rules, you must be commonly granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" title="In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.">Command Rules in a Multitenant Environment</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" name="GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84"></a><h3 id="MULTI-GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" class="sect3"><span class="enumeration_section">24.7 </span>Command Rules in a Multitenant Environment
               </h3>
               <div>
                  <p>In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.</p>
                  <p>Common command rules can be associated only with common realms, rule sets, and rules. Local command rules can be associated only with local realm, rule sets, and rules.</p>
                  <p>To apply these command rules to the entire multitenant environment, you must execute the command rule procedures from the CDB root or application root as a common user who has been granted the <code class="codeph">DVADM</code> or <code class="codeph">DVOWNER</code> role. A common command rule that is created in the CDB root will be applied to all PDBs in that CDB environment. A common command rule that is created in the application root will only be applied to the PDBs that are associated with this application root. To propagate the command rule to the PDBs that are associated with the CDB root or application root, you must synchronize the PDB. For example, to synchronize an application root called <code class="codeph">saas_sales_app</code> to its application PDBs:
                  </p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE APPLICATION saas_sales_app SYNC;</code></pre><p>To synchronize a common command rule in the CDB root to a PDB:</p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE APPLICATION APP$CDB$SYSTEM SYNC;</code></pre><p>You can check a user’s roles by querying the <code class="codeph">USER_ROLE_PRIVS</code> data dictionary view. To find information about command rules, query the <code class="codeph">DBA_DV_COMMAND_RULE</code> data dictionary view.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-07513135-CB45-4788-A596-E5A71879BB81" name="GUID-07513135-CB45-4788-A596-E5A71879BB81"></a><h3 id="MULTI-GUID-07513135-CB45-4788-A596-E5A71879BB81" class="sect3"><span class="enumeration_section">24.8 </span>Oracle Database Vault Policies in a Multitenant Environment
               </h3>
               <div>
                  <p>Oracle Database Vault policies are only local to the pluggable database (PDB) in which they were created. </p>
                  <p>That is, if you created the policy in a PDB, then only local realms and command rules can be added to it. You cannot create Database Vault policies that can have common realms or common command rules. </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" name="GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F"></a><h3 id="MULTI-GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" class="sect3"><span class="enumeration_section">24.9 </span>Using Database Vault Operations Control to Restrict Multitenant Common User Access to Local PDB Data
               </h3>
               <div>
                  <p>You can control PDB access by CDB root common users, such as infrastructure database administrators.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-1A67C2FE-A83C-4B5F-AB2E-1A7E96922064">About Using Database Vault Operations Control</a><br>You can automatically restrict common users from accessing pluggable database (PDB) local data in autonomous, regular Cloud, or on-premise environments. 
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-9CC9C99D-7168-4C39-8380-81C1CBF1E8C3">Enabling Database Vault Operations Control</a><br>To enable Database Vault operations control, use the <code class="codeph">DBMS_MACADM.ENABLE_APP_PROTECTION</code> PL/SQL procedure.
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-00868C98-FC37-49BC-B867-558B9FB27B6A">Adding Common Users and Packages to an Exception List</a><br>Common users and applications that must access PDB local data can be added to an exception list.
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-57584CE8-8BC0-40DA-A446-A45AFF882726">Deleting Common Users and Packages from an Exception List</a><br>Users and applications that no longer need to access PDB local data can be removed from the exception list.
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-D23A52A4-0556-4F71-9157-6CC081EF7819">Disabling Database Vault Operations Control</a><br>To disable Database Vault operations control, use the <code class="codeph">DBMS_MACADM.DISABLE_APP_PROTECTION</code> PL/SQL procedure.
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../dvadm/dba-operations-in-an-oracle-database-vault-environment.html#DVADM-GUID-17665902-E9F9-479A-B60A-29853672BB2B" target="_blank">DBA Operations in an Oracle&nbsp;Database&nbsp;Vault&nbsp;Environment<span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-1A67C2FE-A83C-4B5F-AB2E-1A7E96922064" name="GUID-1A67C2FE-A83C-4B5F-AB2E-1A7E96922064"></a><h4 id="MULTI-GUID-1A67C2FE-A83C-4B5F-AB2E-1A7E96922064" class="sect4"><span class="enumeration_section">24.9.1 </span>About Using Database Vault Operations Control
                  </h4>
                  <div>
                     <p>You can automatically restrict common users from accessing pluggable database (PDB) local data in autonomous, regular Cloud, or on-premise environments. </p>
                     <p>To accomplish this, you can use Oracle Database Vault operations control, which applies to common users (such as infrastructure database administrators and applications.</p>
                     <p>Database Vault operations control is useful for situations where a database administrator must log in to the CDB root as a highly privileged user, but still not be able to access PDB customer data. Database operations control does not block PDB database administrators. To block these users, enable Oracle Database Vault in the PDB and then use the Database Vault features such as realm control to block these users. </p>
                     <p>You can create an exception list for Database Vault operations control of common users and packages for situations where a common user or application must perform tasks that must access local data on a PDB. An example of the type of common user that you would specify for the exception list is the <code class="codeph">CTXSYS</code> application account, which is responsible for Oracle Text. Specifying a package in an exception list enables you to apply more fine-grained control instead of providing full access to a user in an exception list.
                     </p>
                     <p>The general process for using Database Vault operations control is as follows: </p>
                     <ol id="GUID-1A67C2FE-A83C-4B5F-AB2E-1A7E96922064__OL_JMR_TFW_Q2B">
                        <li>Enable Database Vault operations control and keep it enabled for the production environment. </li>
                        <li>At this stage Database Vault operations control applies to all PDBs in the environment, regardless of whether the PDB has enabled Database Vault or not.</li>
                        <li>To enable specific users and packages to have access to the local schemas of the PDBs, add them to an exception list. When the user or package no longer needs access, then you can remove them from the exception list. For example, if the database is using Oracle Text, then you can add the <code class="codeph">CTXSYS</code> administrative user account and the package to the exception list. 
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" title="You can control PDB access by CDB root common users, such as infrastructure database administrators.">Using Database Vault Operations Control to Restrict Multitenant Common User Access to Local PDB Data</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-9CC9C99D-7168-4C39-8380-81C1CBF1E8C3" name="GUID-9CC9C99D-7168-4C39-8380-81C1CBF1E8C3"></a><h4 id="MULTI-GUID-9CC9C99D-7168-4C39-8380-81C1CBF1E8C3" class="sect4"><span class="enumeration_section">24.9.2 </span>Enabling Database Vault Operations Control
                  </h4>
                  <div>
                     <p>To enable Database Vault operations control, use the <code class="codeph">DBMS_MACADM.ENABLE_APP_PROTECTION</code> PL/SQL procedure.
                     </p>
                     <div class="section">
                        <p>Oracle recommends that if you elect to use Database Vault operations control for your multitenant production server, then you should keep Database Vault operations control enabled full time.</p> In most cases, you will enable Database Operations control for the entire CDB, not just a specific PDB. If you need to disable it for a specific PDB (for example, for troubleshooting purposes), then you can execute the <code class="codeph">DBMS_MACADM.DISABLE_APP_PROTECTION</code> procedure on the PDB. When you are finished troubleshooting the PDB, re-enable it for Database Vault operations control, as shown in the example in this topic.
                     </div>
                     <!-- class="section" -->
                     <div class="p">Before you enable Database Vault operations control, Database Vault must be enabled and configured in the CDB root. However, Database Vault does not need to be enabled in the PDBs. </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Log in to the CDB root as a common user who has been granted the <code class="codeph">DV_OWNER</code> role. </span><div>For example:<pre class="pre codeblock"><code>sqlplus c##sec_admin_owen_root
Enter password: <span class="italic">password</span>  </code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Execute the <code class="codeph">DBMS_MACADM.ENABLE_APP_PROTECTION</code> procedure. </span><ul id="GUID-9CC9C99D-7168-4C39-8380-81C1CBF1E8C3__CHOICES_YPW_BBS_R2B">
                              <li>To enable Database Vault operations control for all PDBs in the CDB environment: <pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_APP_PROTECTION;</code></pre></li>
                              <li>To enable Database Vault operations control for a specific PBB (for example, <code class="codeph">HRPDB</code>):<pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_APP_PROTECTION ('HRPDB');</code></pre></li>
                           </ul>
                        </li>
                     </ol>
                     <div class="section">At this stage, one or all of the PDBs are enabled for Database Vault operations control. If specific trusted common users or packages must have access to the local schemas of these PDBs to perform special operations, then you can use the <code class="codeph">DBMS_MACADM.ADD_APP_EXCEPTION</code> procedure to add the user or package to an exception list for Database Vault operations control. 
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../dvadm/dba-operations-in-an-oracle-database-vault-environment.html#DVADM-GUID-00868C98-FC37-49BC-B867-558B9FB27B6A" target="_blank">Adding Common Users and Packages to an Exception List<span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" title="You can control PDB access by CDB root common users, such as infrastructure database administrators.">Using Database Vault Operations Control to Restrict Multitenant Common User Access to Local PDB Data</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-00868C98-FC37-49BC-B867-558B9FB27B6A" name="GUID-00868C98-FC37-49BC-B867-558B9FB27B6A"></a><h4 id="MULTI-GUID-00868C98-FC37-49BC-B867-558B9FB27B6A" class="sect4"><span class="enumeration_section">24.9.3 </span>Adding Common Users and Packages to an Exception List
                  </h4>
                  <div>
                     <p>Common users and applications that must access PDB local data can be added to an exception list.</p>
                     <div class="section">Add a user package to the exception list if the package is the only object in the user account that needs access to the PDB local data. This allows for fine grained control over what is put into the exception list. The kinds of common users and packages that you would add to the exception list are ones that are necessary for the functioning of the PDB. For example, if you are using Oracle Spatial, then you should add the <code class="codeph">MDSYS</code> account to the exception list. <code class="codeph">MDSYS</code> requires access to customer PDB data for Oracle Spatial functions. To add a common user and a package to the Database Vault operations control exception list, you can use the <code class="codeph">DBMS_MACADM.ADD_APP_EXCEPTION</code> PL/SQL procedure. To find existing exceptions, you can query the <code class="codeph">DBA_DV_APP_EXCEPTION</code> data dictionary view. 
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Log in to the CDB root as a common user who has been granted the <code class="codeph">DV_OWNER</code> role. </span><div>For example:<pre class="pre codeblock"><code>qlplus c##sec_admin_owen_root
Enter password: <span class="italic">password</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Ensure that the package that you will specify for the common user meets the following requirements:</span><div>
                              <ul style="list-style-type: disc;" id="GUID-00868C98-FC37-49BC-B867-558B9FB27B6A__UL_RMR_XVN_S2B">
                                 <li>The package must be owned by the common user. </li>
                                 <li>A user-created package must be created with definer's rights procedures. </li>
                              </ul>
                              <p>You can find more information about user-created packages by querying the <code class="codeph">DBA_OBJECTS</code> data dictionary view.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Execute the <code class="codeph">DBMS_MACADM.ADD_APP_EXCEPTION</code> procedure. </span><div>For example:<pre class="pre codeblock"><code>DBMS_MACADM.ADD_APP_EXCEPTION ('MDSYS', 'PATCH_APP'); </code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" title="You can control PDB access by CDB root common users, such as infrastructure database administrators.">Using Database Vault Operations Control to Restrict Multitenant Common User Access to Local PDB Data</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-57584CE8-8BC0-40DA-A446-A45AFF882726" name="GUID-57584CE8-8BC0-40DA-A446-A45AFF882726"></a><h4 id="MULTI-GUID-57584CE8-8BC0-40DA-A446-A45AFF882726" class="sect4"><span class="enumeration_section">24.9.4 </span>Deleting Common Users and Packages from an Exception List
                  </h4>
                  <div>
                     <p>Users and applications that no longer need to access PDB local data can be removed from the exception list.</p>
                     <div class="section">To remove a common user and a package from the Database Vault operations control exception list, you can use the <code class="codeph">DBMS_MACADM.DELETE_APP_PROTECTION</code> PL/SQL procedure. To find existing exceptions, you can query the <code class="codeph">DBA_DV_APP_EXCEPTION</code> data dictionary view. 
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Log in to the CDB root as a common user who has been granted the <code class="codeph">DV_OWNER</code> role. </span><div>For example:<pre class="pre codeblock"><code>sqlplus c##sec_admin_owen_root
Enter password: <span class="italic">password</span>  </code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Execute the <code class="codeph">DBMS_MACADM.DELETE_APP_EXCEPTION</code> procedure. </span><div>For example:<pre class="pre codeblock"><code>DBMS_MACADM.DELETE_APP_EXCEPTION ('MDSYS', 'PATCH_APP'); </code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" title="You can control PDB access by CDB root common users, such as infrastructure database administrators.">Using Database Vault Operations Control to Restrict Multitenant Common User Access to Local PDB Data</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-D23A52A4-0556-4F71-9157-6CC081EF7819" name="GUID-D23A52A4-0556-4F71-9157-6CC081EF7819"></a><h4 id="MULTI-GUID-D23A52A4-0556-4F71-9157-6CC081EF7819" class="sect4"><span class="enumeration_section">24.9.5 </span>Disabling Database Vault Operations Control
                  </h4>
                  <div>
                     <p>To disable Database Vault operations control, use the <code class="codeph">DBMS_MACADM.DISABLE_APP_PROTECTION</code> PL/SQL procedure.
                     </p>
                     <div class="section">In most cases, you should keep Database Vault operations control enabled. If troubleshooting requires that a PDB be dropped from Database Vault operations control, then Oracle recommends that you temporarily disable Database Vault operations control for the PDB (and maintain operations control for the rest of the PDBs). After the troubleshooting is complete, then you should re-enable Database Vault operations control. </div>
                     <!-- class="section" -->
                     <ol id="GUID-D23A52A4-0556-4F71-9157-6CC081EF7819__STEPS_HFJ_TSX_Q2B">
                        <li class="stepexpand"><span>Log in to the CDB root as a common user who has been granted the <code class="codeph">DV_OWNER</code> role. </span><div>For example:<pre class="pre codeblock"><code>sqlplus c##sec_admin_owen_root
Enter password: <span class="italic">password</span>  </code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Execute the <code class="codeph">DBMS_MACADM.DISABLE_APP_PROTECTION</code> procedure. </span><ul id="GUID-D23A52A4-0556-4F71-9157-6CC081EF7819__CHOICES_YPW_BBS_R2B">
                              <li>To disable Database Vault operations control for all PDBs in the CDB environment: <pre class="pre codeblock"><code>EXEC DBMS_MACADM.DISABLE_APP_PROTECTION;</code></pre></li>
                              <li>To disable Database Vault operations control for a specific PBB (for example, <code class="codeph">HRPDB</code>):<pre class="pre codeblock"><code>EXEC DBMS_MACADM.DISABLE_APP_PROTECTION ('HRPDB');</code></pre></li>
                           </ul>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-E04CBDD1-17F0-4942-BF78-21C340A4425F" title="You can control PDB access by CDB root common users, such as infrastructure database administrators.">Using Database Vault Operations Control to Restrict Multitenant Common User Access to Local PDB Data</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-517E9611-546B-43D9-8C54-37037AF0B198" name="GUID-517E9611-546B-43D9-8C54-37037AF0B198"></a><h3 id="MULTI-GUID-517E9611-546B-43D9-8C54-37037AF0B198" class="sect3"><span class="enumeration_section">24.10 </span>Converting a Standalone Oracle Database to a PDB and Plugging It into a CDB
               </h3>
               <div>
                  <p>You can convert a standalone Oracle Database Release 12c or later database to a PDB, and then plug this PDB into a CDB.</p>
                  <ol>
                     <li class="stepexpand"><span>Connect to the root as a user who has been granted the <code class="codeph">DV_OWNER</code> role.</span><div>
                           <p>For example: </p><pre class="pre codeblock"><code>sqlplus c##sec_admin
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Grant the <code class="codeph">DV_PATCH_ADMIN</code> role to user <code class="codeph">SYS</code> with <code class="codeph">CONTAINER = CURRENT</code>. </span><div><pre class="pre codeblock"><code>GRANT DV_PATCH_ADMIN TO SYS CONTAINER = CURRENT;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>In the root, connect as user <code class="codeph">SYS</code> with the <code class="codeph">SYSOPER</code> system privilege. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>CONNECT SYS AS SYSOPER <span class="italic">-- Or, CONNECT SYS@hrpdb AS SYSOPER</span>
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Restart the database in read-only mode. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>SHUTDOWN IMMEDIATE
STARTUP MOUNT
ALTER DATABASE OPEN READ ONLY
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect to the Database Vault-enabled database as a user who has the <code class="codeph">DV_OWNER</code> role. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>CONNECT sec_admin@dv_db
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Grant the <code class="codeph">DV_PATCH_ADMIN</code> role to user <code class="codeph">SYS</code> on this database.</span><div><pre class="pre codeblock"><code>GRANT DV_PATCH_ADMIN TO SYS;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Optionally, run the <code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code> function to determine whether the unplugged PDB is compatible with the CDB.</span><div>
                           <p>When you run the function, set the following parameters:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">pdb_descr_file</code>: Set this parameter to the full path to the XML file that will contain a description of the PDB.
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">store_report</code>: Set this parameter to indicate whether you want to generate a report if the PDB is not compatible with the CDB. Set it to <code class="codeph">TRUE</code> to generate a report or <code class="codeph">FALSE</code> to not generate a report. A generated report is stored in the <code class="codeph">PDB_PLUG_IN_VIOLATIONS</code> temporary table and is generated only if the PDB is not compatible with the CDB.
                                 </p>
                              </li>
                           </ul>
                           <p>For example, to determine whether a PDB described by the <code class="codeph">/disk1/usr/dv_db_pdb.xml</code> file is compatible with the current CDB, run the following PL/SQL block:
                           </p><pre class="pre codeblock"><code>SET SERVEROUTPUT ON
DECLARE
  compatible CONSTANT VARCHAR2(3) := 
    CASE DBMS_PDB.CHECK_PLUG_COMPATIBILITY(
           pdb_descr_file =&gt; '/disk1/usr/dv_db_pdb.xml',
           store_report   =&gt; TRUE)
    WHEN TRUE THEN 'YES'
    ELSE 'NO'
END;
BEGIN
  DBMS_OUTPUT.PUT_LINE(compatible);
END;
/
</code></pre><p>If the output is <code class="codeph">YES</code>, then the PDB is compatible, and you can continue with the next step.
                           </p>
                           <p>If the output is <code class="codeph">NO</code>, then the PDB is not compatible. You can check the <code class="codeph">PDB_PLUG_IN_VIOLATIONS</code> temporary table to see why it is not compatible.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Create an XML file that describes the PDB. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>BEGIN
  DBMS_PDB.DESCRIBE(
    pdb_descr_file =&gt; '/disk1/oracle/dv_db.xml');
END;
/
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Run the <code class="codeph">CREATE PLUGGABLE DATABASE</code> statement, and specify the XML file in the <code class="codeph">USING</code> clause. Specify other clauses when they are required.</span><div>
                           <p>For example: </p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE dv_db_pdb AS CLONE USING 'dv_db.xml' NOCOPY;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect to the PDB that you just created as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege. </span><div><pre class="pre codeblock"><code>CONNECT SYS@dv_db_pdb AS SYSDBA
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Execute the <code class="codeph">noncdb_to_pdb.sql</code> script.</span><div><pre class="pre codeblock"><code>@$ORACLE_HOME/rdbms/admin/noncdb_to_pdb.sql
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Open this PDB in a read/write restricted mode.</span><div><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE dv_db_pdb OPEN READ WRITE RESTRICTED;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Run the following procedure to synchronize the PDB:</span><div><pre class="pre codeblock"><code>EXECUTE DBMS_PDB.SYNC_PDB;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect to the root as a user who has been granted the <code class="codeph">DV_OWNER</code> role. </span><div><pre class="pre codeblock"><code>sqlplus c##sec_admin
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Revoke the <code class="codeph">DV_PATCH_ADMIN</code> role from user <code class="codeph">SYS</code> with <code class="codeph">CONTAINER = CURRENT</code>.</span><div><pre class="pre codeblock"><code>REVOKE DV_PATCH_ADMIN FROM SYS CONTAINER = CURRENT;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect to the legacy Database Vault-enabled database as user <code class="codeph">SYS</code> with the <code class="codeph">SYSOPER</code> system privilege.</span><div><pre class="pre codeblock"><code>CONNECT SYS@dv_db_pdb AS SYSOPER
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Restart this database.</span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>SHUTDOWN IMMMEDIATE
STARUP
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Revoke the <code class="codeph">DV_PATCH_ADMIN</code> role from user <code class="codeph">SYS</code>.</span><div><pre class="pre codeblock"><code>REVOKE DV_PATCH_ADMIN FROM SYS;</code></pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="creating-pdbs.html#GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413" title="You can create PDBs, application containers, and application seeds using a variety of techniques.">Creating and Removing PDBs and Application Containers</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>