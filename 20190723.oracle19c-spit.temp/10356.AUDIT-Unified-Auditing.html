<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>AUDIT (Unified Auditing)</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Language Reference ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Language Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-language-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T15:36:36-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96310-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="AUDIT-Traditional-Auditing.html" title="Previous" type="text/html">
      <link rel="next" href="CALL.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Language Reference">
    <meta name="dcterms.isVersionOf" content="SQLRF">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="AUDIT-Traditional-Auditing.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="CALL.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Language Reference </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="SQL-Statements-ALTER-SYNONYM-to-COMMENT.html" property="item" typeof="WebPage"><span property="name">SQL Statements: ALTER SYNONYM to COMMENT</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">AUDIT (Unified Auditing)</li>
            </ol>
            <a id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA" name="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA"></a><a id="SQLRF56111"></a><a id="SQLRF56172"></a><a id="SQLRF56173"></a><a id="SQLRF56408"></a><a id="SQLRF56409"></a><a id="SQLRF56174"></a><a id="SQLRF56175"></a><a id="SQLRF56426"></a><a id="SQLRF56427"></a><a id="SQLRF56428"></a><a id="SQLRF56110"></a>
            
            <h2 id="SQLRF-GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA" class="sect2">AUDIT (Unified Auditing)</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p>This section describes the <code class="codeph">AUDIT</code> statement for <span class="bold">unified</span> <span class="bold">auditing</span>. This type of auditing is new beginning with Oracle Database 12<span class="italic">c</span> and provides a full set of enhanced auditing features. Refer to <a href="../dbseg/introduction-to-auditing.html#DBSEG630" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> for more information on unified auditing.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-483EA9C0-40A4-4A06-B0DF-37ED1C251620">Purpose</p>
                  <p>Use the <code class="codeph">AUDIT</code> statement to:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Enable a unified audit policy for all users or for specified users</p>
                     </li>
                     <li>
                        <p>Specify whether an audit record is created if the audited event fails, succeeds, or both</p>
                     </li>
                     <li>
                        <p>Specify application context attributes, whose values will be recorded in audit records</p>
                     </li>
                  </ul>
                  <p>Operations performed with this statement take effect in subsequent user sessions, not in the current session.</p>
                  <div class="infoboxnotealso" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-BB696BD0-B516-40F3-A4EE-A28E3C737F2C">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="NOAUDIT-Unified-Auditing.html#GUID-EB92BE04-B09C-493F-952E-9629E739900E">NOAUDIT (Unified Auditing)</a></p>
                        </li>
                        <li>
                           <p><a href="CREATE-AUDIT-POLICY-Unified-Auditing.html#GUID-8D6961FB-2E50-46F5-81F7-9AEA314FC693">CREATE AUDIT POLICY (Unified Auditing)</a> 
                           </p>
                        </li>
                        <li>
                           <p><a href="ALTER-AUDIT-POLICY-Unified-Auditing.html#GUID-CC41B5C2-09F4-40BC-B7FD-3B4C0A3F5437">ALTER AUDIT POLICY (Unified Auditing)</a></p>
                        </li>
                        <li>
                           <p><a href="DROP-AUDIT-POLICY-Unified-Auditing.html#GUID-811D3F84-744E-47A1-B69D-C9D2FA4A0844">DROP AUDIT POLICY (Unified Auditing)</a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-CB683898-5CF0-4583-9BFD-6C144A9EBBF4">Prerequisites</p>
                  <p>You must have the <code class="codeph">AUDIT</code> <code class="codeph">SYSTEM</code> system privilege or the <code class="codeph">AUDIT_ADMIN</code> role.
                  </p>
                  <p>If you are connected to a multitenant container database (CDB), then to enable a common unified audit policy, the current container must be the root and you must have the commonly granted <code class="codeph">AUDIT</code> <code class="codeph">SYSTEM</code> privilege or the <code class="codeph">AUDIT_ADMIN</code> common role. To enable a local unified audit policy, the current container must be the container in which the audit policy was created and you must have the commonly granted <code class="codeph">AUDIT</code> <code class="codeph">SYSTEM</code> privilege or the <code class="codeph">AUDIT_ADMIN</code> common role, or you must have the locally granted <code class="codeph">AUDIT</code> <code class="codeph">SYSTEM</code> privilege or the <code class="codeph">AUDIT_ADMIN</code> local role in the container.
                  </p>
                  <p>To specify the <code class="codeph">AUDIT</code> <code class="codeph">CONTEXT</code> ... statement when connected to a CDB, you must have the commonly granted <code class="codeph">AUDIT</code> <code class="codeph">SYSTEM</code> privilege or the <code class="codeph">AUDIT_ADMIN</code> common role, or you must have the locally granted <code class="codeph">AUDIT</code> <code class="codeph">SYSTEM</code> privilege or the <code class="codeph">AUDIT_ADMIN</code> local role in the current session's container.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-6A8C2310-D13D-4ADD-B2FD-0DBE58FC9FBA">Syntax</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-69F34D9A-DBDF-4D25-990B-ACD13889A48E"><span class="italic">unified_audit</span>::=
                  </p>
                  <div class="figure" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-FF36DCF9-40F8-49D8-88D8-4076A56DAAF4"><img src="img/unified_audit.gif" alt="Description of unified_audit.eps follows" title="Description of unified_audit.eps follows" longdesc="img_text/unified_audit.html"><br><a href="img_text/unified_audit.html">Description of the illustration unified_audit.eps</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-CFC2EBE6-7053-4299-835C-F9CE366CD31E"><span class="italic">by_users_with_roles</span>::=
                  </p>
                  <div class="figure" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-E9D8D03B-AAD8-49D2-9B05-187DD139FDC5"><img src="img/by_users_with_roles.gif" alt="Description of by_users_with_roles.eps follows" title="Description of by_users_with_roles.eps follows" longdesc="img_text/by_users_with_roles.html"><br><a href="img_text/by_users_with_roles.html">Description of the illustration by_users_with_roles.eps</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-1894B895-D23D-43D9-B7ED-3EDFF24A63B9">Semantics</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-3C9A879D-1E22-4F6C-B456-9434093B8158"><span class="italic">policy</span></p>
                  <p>Specify the name of the unified audit policy to be enabled. The policy must have been created using the <code class="codeph">CREATE</code> <code class="codeph">AUDIT</code> <code class="codeph">POLICY</code> statement.
                  </p>
                  <p>You can find descriptions of all unified audit policies by querying the <code class="codeph">AUDIT_UNIFIED_POLICIES</code> view and descriptions of all <span class="italic">enabled</span> unified audit policies by querying the <code class="codeph">AUDIT_UNIFIED_ENABLED_POLICIES</code> view.
                  </p>
                  <p>When you enable a unified audit policy, all SQL statements and operations that satisfy either a system privilege or action or role audit option specified in the enabled policy will be audited—that is, a unified audit record will be created in the <code class="codeph">UNIFIED_AUDIT_TRAIL</code> view. If a single SQL statement or operation satisfies multiple enabled policies, then only one unified audit record will be created and all satisfied audit policy names will appear in a comma-separated list in the <code class="codeph">UNIFIED_AUDIT_POLICIES</code> column of the <code class="codeph">UNIFIED_AUDIT_TRAIL</code> view.
                  </p>
                  <div class="infoboxnotealso" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-936B9DA3-BB1E-4B3F-9E4F-894E5E4CBC2C">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="CREATE-AUDIT-POLICY-Unified-Auditing.html#GUID-8D6961FB-2E50-46F5-81F7-9AEA314FC693">CREATE AUDIT POLICY (Unified Auditing)</a></p>
                        </li>
                        <li>
                           <p><span class="italic">Oracle Database Reference</span> for more information on the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sqlrf&amp;id=REFRN29157" target="_blank"><code class="codeph">AUDIT_UNIFIED_POLICIES</code></a>, <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sqlrf&amp;id=REFRN29158" target="_blank"><code class="codeph">AUDIT_UNIFIED_ENABLED_POLICIES</code></a>, and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sqlrf&amp;id=REFRN29162" target="_blank"><code class="codeph">UNIFIED_AUDIT_TRAIL</code></a> views
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-6FC6ED1F-30DD-4A6C-BCE8-80DCC5DCB4B7">BY | EXCEPT</p>
                  <p>Specify the <code class="codeph">BY</code> clause to enable <span class="italic"><code class="codeph">policy</code></span> for only the specified users.
                  </p>
                  <p>Specify the <code class="codeph">EXCEPT</code> clause to enable <span class="italic"><code class="codeph">policy</code></span> for all users except the specified users.
                  </p>
                  <p>If you omit the <code class="codeph">BY</code> and <code class="codeph">EXCEPT</code> clauses and the <span class="italic"><code class="codeph">by_users_with_roles</code> </span> clause, then Oracle Database enables <span class="italic"><code class="codeph">policy</code></span> for all users.
                  </p>
                  <p>If <span class="italic"><code class="codeph">policy</code></span> is a common unified audit policy, then <span class="italic"><code class="codeph">user</code></span> must be a common user. If <span class="italic"><code class="codeph">policy</code></span> is a local unified audit policy, then <span class="italic"><code class="codeph">user</code></span> must be a common user or a local user in the container to which you are connected.
                  </p>
                  <p><span class="bold">Notes on the BY and EXCEPT Clauses</span></p>
                  <p>The following notes apply to the <code class="codeph">BY</code> and <code class="codeph">EXCEPT</code> clauses:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If multiple <code class="codeph">AUDIT</code> ... <code class="codeph">BY</code> ... statements are specified for the same unified audit policy, then the policy is enabled for the union of the users specified in each statement.
                        </p>
                     </li>
                     <li>
                        <p>If multiple <code class="codeph">AUDIT</code> ... <code class="codeph">EXCEPT</code> ... statements are specified for the same unified audit policy, then only the most recently specified statement takes effect. That is, the policy is enabled for all users except the users specified in the most recent <code class="codeph">AUDIT</code> ... <code class="codeph">EXCEPT</code> ... statement.
                        </p>
                     </li>
                     <li>
                        <p>If a policy is enabled using the <code class="codeph">BY</code> clause and you would like to instead enable it using the <code class="codeph">EXCEPT</code> clause, then you must first use the <code class="codeph">NOAUDIT</code> ... <code class="codeph">BY</code> ... statement to disable the policy for all users for whom the policy is currently enabled, and then enable the policy with the <code class="codeph">AUDIT</code> ... <code class="codeph">EXCEPT</code> ... statement.
                        </p>
                     </li>
                     <li>
                        <p>If a policy is enabled using the <code class="codeph">EXCEPT</code> clause and you would like to instead enable it using the <code class="codeph">BY</code> clause, then you must first use the <code class="codeph">NOAUDIT</code> statement to disable the audit policy. Note that you cannot specify the <code class="codeph">EXCEPT</code> clause with the <code class="codeph">NOAUDIT</code> statement. You can then enable the policy with the <code class="codeph">AUDIT</code> ... <code class="codeph">BY</code> ... statement.
                        </p>
                     </li>
                  </ul>
                  <p><span class="bold">Restriction on the BY and EXCEPT Clauses</span></p>
                  <p>You cannot specify an <code class="codeph">AUDIT</code> ... <code class="codeph">BY</code> ... statement and an <code class="codeph">AUDIT</code> ... <code class="codeph">EXCEPT</code> ... statement for the same unified audit policy. If you attempt to do so, then an error occurs.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__BY_USERS_WITH_ROLES-54975FDE">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-067BF75F-8DF7-4D1B-A291-C5D33937B277"><span class="italic">by_users_with_roles</span></p>
                  <p>Specify this clause to enable <span class="italic"><code class="codeph">policy</code></span> only for users who have been directly granted the specified roles. If you subsequently grant one of the roles to an additional user, then the policy automatically apples to that user. If you subsequently revoke one of the roles from a user, then the policy no longer applies to that user.
                  </p>
                  <p>When you are connected to a CDB, if <span class="italic"><code class="codeph">policy</code></span> is a common unified audit policy, then <span class="italic"><code class="codeph">role</code></span> must be a common role. If <span class="italic"><code class="codeph">policy</code></span> is a local unified audit policy, then <span class="italic"><code class="codeph">role</code></span> must be a common role or a local role in the container to which you are connected.
                  </p>
                  <p><span class="bold">Enabling a Local Audit Policy on Roles</span></p>
                  <p>Local audit policy can be enabled on local roles as well as on common roles. When a local audit policy is enabled on a common role, it generates audit records when a common role is granted to user locally or commonly in the container.</p>
                  <p><span class="bold">Enabling a Common Audit Policy on Roles</span></p>
                  <p>Common audit policy can only be enabled on common roles. When a common audit policy is enabled on a common role, it generates audit records when a common role is granted to an user commonly or locally in the ROOT container.</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-1287BF43-370A-4B9C-830B-14A9E3E21934">WHENEVER [NOT] SUCCESSFUL</p>
                  <p>Specify <code class="codeph">WHENEVER</code> <code class="codeph">SUCCESSFUL</code> to audit only SQL statements and operations that succeed.
                  </p>
                  <p>Specify <code class="codeph">WHENEVER</code> <code class="codeph">NOT</code> <code class="codeph">SUCCESSFUL</code> to audit only SQL statements and operations that fail or result in errors.
                  </p>
                  <p>If you omit this clause, then Oracle Database performs the audit regardless of success or failure. </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-3E978C66-4A5C-42BB-9252-0AB856AF0FE9">CONTEXT Clause</p>
                  <p>Specify the <code class="codeph">CONTEXT</code> clause to include the values of context attributes in audit records.
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>For <span class="italic"><code class="codeph">namespace</code></span>, specify the context namespace.
                        </p>
                     </li>
                     <li>
                        <p>For <span class="italic"><code class="codeph">attribute</code></span>, specify one or more context attributes whose values you want to include in audit records.
                        </p>
                     </li>
                     <li>
                        <p>Use the optional <code class="codeph">BY</code> <span class="italic"><code class="codeph">user</code></span> clause to include the values of the context attributes only in audit records for events executed by the specified users. If you omit the <code class="codeph">BY</code> clause, then the values of the context attributes are included in all audit records.
                        </p>
                     </li>
                  </ul>
                  <p>If you specify the <code class="codeph">CONTEXT</code> clause when the current container is the root of a CDB, then the values of context attributes will be included in audit records only for events executed in the root. If you specify the optional <code class="codeph">BY</code> clause, then <span class="italic"><code class="codeph">user</code></span> must be a common user.
                  </p>
                  <p>If you specify the <code class="codeph">CONTEXT</code> clause when the current container is a pluggable database (PDB), then the values of context attributes will be included in audit records only for events executed in that PDB. If you specify the optional <code class="codeph">BY</code> clause, then <span class="italic"><code class="codeph">user</code></span> must be a common user or a local user in that PDB.
                  </p>
                  <p>You can find the application context attributes that are configured to be captured in the audit trail by querying the <code class="codeph">AUDIT_UNIFIED_CONTEXTS</code> view.
                  </p>
                  <div class="infoboxnotealso" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-BCA3F525-19EB-43FF-BC28-8A2E45B990CC">
                     <p class="notep1">See Also:</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sqlrf&amp;id=REFRN29159" target="_blank"><span class="italic">Oracle Database Reference</span></a> for more information on the <code class="codeph">AUDIT_UNIFIED_CONTEXTS</code> view
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__BABGCDGC">
                  <p class="subhead1" id="GUID-B24D6874-4053-4E66-8238-6CD0C87E9DCA__GUID-65052445-018B-4278-BBAF-92361C786912">Examples</p>
                  <p>The following examples enable unified audit policies that were created in the <code class="codeph">CREATE</code> <code class="codeph">AUDIT</code> <code class="codeph">POLICY</code> <span class="q">"<a href="CREATE-AUDIT-POLICY-Unified-Auditing.html#GUID-8D6961FB-2E50-46F5-81F7-9AEA314FC693__BGEGDCFA">Examples</a>"</span>.
                  </p>
                  <p><span class="bold">Enabling a Unified Audit Policy for All Users: Example</span></p>
                  <p>The following statement enables unified audit policy <code class="codeph">table_pol</code> for all users:
                  </p><pre class="oac_no_warn" dir="ltr">AUDIT POLICY table_pol;
</pre><p>The following statement verifies that <code class="codeph">table_pol</code> is enabled for all users:
                  </p><pre class="oac_no_warn" dir="ltr">SELECT policy_name, enabled_opt, user_name
  FROM audit_unified_enabled_policies
  WHERE policy_name = 'TABLE_POL';
 
POLICY_NAME  ENABLED_OPT  USER_NAME
-----------  -----------  ---------
TABLE_POL    BY           ALL USERS</pre><p><span class="bold">Enabling a Unified Audit Policy for Specific Users: Examples</span></p>
                  <p>The following statement enables unified audit policy <code class="codeph">dml_pol</code> for only users <code class="codeph">hr</code> and <code class="codeph">sh</code>:
                  </p><pre class="oac_no_warn" dir="ltr">AUDIT POLICY dml_pol BY hr, sh;
</pre><p>The following statement verifies that <code class="codeph">dml_pol</code> is enabled for only users <code class="codeph">hr</code> and <code class="codeph">sh</code>:
                  </p><pre class="oac_no_warn" dir="ltr">SELECT policy_name, enabled_opt, user_name
  FROM audit_unified_enabled_policies
  WHERE policy_name = 'DML_POL'
  ORDER BY user_name;
 
POLICY_NAME  ENABLED_OPT  USER_NAME
-----------  -----------  ---------
DML_POL      BY           HR
DML_POL      BY           SH
</pre><p>The following statement enables unified audit policy <code class="codeph">read_dir_pol</code> for all users except <code class="codeph">hr</code>:
                  </p><pre class="oac_no_warn" dir="ltr">AUDIT POLICY read_dir_pol EXCEPT hr;
</pre><p>The following statement verifies that <code class="codeph">read_dir_pol</code> is enabled for all users except <code class="codeph">hr</code>:
                  </p><pre class="oac_no_warn" dir="ltr">SELECT policy_name, enabled_opt, user_name
  FROM audit_unified_enabled_policies
  WHERE policy_name = 'READ_DIR_POL';
 
POLICY_NAME   ENABLED_OPT  USER_NAME
------------  -----------  ---------
READ_DIR_POL  EXCEPT       HR
</pre><p>The following statement enables unified audit policy <code class="codeph">security_pol</code> for user <code class="codeph">hr</code> and audits only the SQL statements and operations that fail:
                  </p><pre class="oac_no_warn" dir="ltr">AUDIT POLICY security_pol BY hr WHENEVER NOT SUCCESSFUL;
</pre><p>The following statement verifies that <code class="codeph">security_pol</code> is enabled for only user <code class="codeph">hr</code> and that only the SQL statements and operations that fail will be audited:
                  </p><pre class="oac_no_warn" dir="ltr">SELECT policy_name, enabled_opt, user_name, success, failure
  FROM audit_unified_enabled_policies
  WHERE policy_name = 'SECURITY_POL';
 
POLICY_NAME   ENABLED_OPT           USER_NAME   SUCCESS  FAILURE
------------  --------------------  ----------  -------  -------
SECURITY_POL  BY                    HR          NO       YES</pre><p><span class="bold">Including Values of Context Attributes in Audit Records: Example</span></p>
                  <p>The following statement instructs the database to include the values of namespace <code class="codeph">USERENV</code> attributes <code class="codeph">CURRENT_USER</code> and <code class="codeph">DB_NAME</code> in all audit records for user <code class="codeph">hr</code>:
                  </p><pre class="oac_no_warn" dir="ltr">AUDIT CONTEXT NAMESPACE userenv
  ATTRIBUTES current_user, db_name
  BY hr;</pre></div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>