<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>RMAN Data Repair Concepts</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Backup and Recovery User's Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Backup and Recovery User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96241-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="part-diagnosing-responding-failures.html" title="Previous" type="text/html">
      <link rel="next" href="diagnosing-repairing-failures-dra.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User's Guide">
    <meta name="dcterms.isVersionOf" content="BRADV">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="part-diagnosing-responding-failures.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="diagnosing-repairing-failures-dra.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Backup and Recovery User's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-diagnosing-responding-failures.html" property="item" typeof="WebPage"><span property="name"> Diagnosing and Responding to Failures </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> RMAN Data Repair Concepts </li>
            </ol>
            <a id="GUID-1805CCF7-4AF2-482D-B65A-998192F89C2B" name="GUID-1805CCF7-4AF2-482D-B65A-998192F89C2B"></a><a id="BRADV89703"></a>
            
            <h2 id="BRADV-GUID-1805CCF7-4AF2-482D-B65A-998192F89C2B" class="sect2"><span class="enumeration_chapter">14 </span> RMAN Data Repair Concepts 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter describes the general concepts that you must understand to perform <a href="glossary.html#GUID-80C351AD-232F-4C8F-995C-0B5239E6C378"><span class="xrefglossterm">data repair</span></a>. This chapter contains the following topics:
               </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="rman-data-repair-concepts.html#GUID-6718D3FE-E35D-42D3-BD45-D50E662B5C23" title="While several problems can halt the normal operation of an Oracle database or affect database I/O operations, only the following typically require DBA intervention and data repair: user errors, application errors, and media failures.User errors occur when, either due to an error in application logic or a manual mistake, data in your database is changed or deleted incorrectly. Sometimes a software malfunction can corrupt data blocks. In a physical corruption, which is also called a media corruption, the database does not recognize the block.A media failure occurs when a problem external to the database prevents it from reading from or writing to a file during normal operations. RMAN provides multiple methods of data repair.">Overview of RMAN Data Repair</a></p>
                  </li>
                  <li>
                     <p><a href="rman-data-repair-concepts.html#GUID-D6322BFA-1EF4-48CA-A52D-3FC7E35044FA" title="In an RMAN restore operation, you select files to be restored and then run the RESTORE command. Typically, you restore files in preparation for media recovery.">About RMAN Restore Operations</a></p>
                  </li>
                  <li>
                     <p><a href="rman-data-repair-concepts.html#GUID-76B772E9-9B69-4D86-8735-D9453A425017" title="In media recovery, RMAN applies changes to restored data to roll forward this data in time.">About RMAN Media Recovery</a></p>
                  </li>
               </ul>
            </div><a id="BRADV8199"></a><div class="props_rev_3"><a id="GUID-6718D3FE-E35D-42D3-BD45-D50E662B5C23" name="GUID-6718D3FE-E35D-42D3-BD45-D50E662B5C23"></a><h3 id="BRADV-GUID-6718D3FE-E35D-42D3-BD45-D50E662B5C23" class="sect3"><span class="enumeration_section">14.1 </span>Overview of RMAN Data Repair
               </h3>
               <div>
                  <p>As explained in <span class="q">"<a href="introduction-backup-recovery.html#GUID-7D5CF571-0B7A-46D7-B9DC-CD15F3A4C34F" title="As a backup administrator, your primary job is making and monitoring backups for data protection.">About Data Protection</a>"</span>, a principal purpose of a backup and recovery strategy is data protection. The key to an effective, efficient strategy is to understand the basic options of data repair.
                  </p>
               </div><a id="BRADV89704"></a><div class="props_rev_3"><a id="GUID-4E91B620-9FB4-4DDF-BB1D-A1C5DA71B7F9" name="GUID-4E91B620-9FB4-4DDF-BB1D-A1C5DA71B7F9"></a><h4 id="BRADV-GUID-4E91B620-9FB4-4DDF-BB1D-A1C5DA71B7F9" class="sect4"><span class="enumeration_section">14.1.1 </span>About Problems Requiring Data Repair
                  </h4>
                  <p>While several problems can halt the normal operation of an Oracle database or affect database I/O operations, only the following typically require DBA intervention and data repair: user errors, application errors, and media failures.</p><a id="BRADV89705"></a><div class="props_rev_3"><a id="GUID-8F3BC8E9-34F6-46DF-BDF4-7F69770C349F" name="GUID-8F3BC8E9-34F6-46DF-BDF4-7F69770C349F"></a><h5 id="BRADV-GUID-8F3BC8E9-34F6-46DF-BDF4-7F69770C349F" class="sect5"><span class="enumeration_section">14.1.1.1 </span>About User Errors
                     </h5>
                     <div>
                        <p>User errors occur when, either due to an error in application logic or a manual mistake, data in your database is changed or deleted incorrectly. </p>
                        <p>For example, a user logs in to the wrong database and drops a database table. User errors are estimated to be the greatest single cause of database downtime.</p>
                     </div>
                  </div><a id="BRADV89706"></a><div class="props_rev_3"><a id="GUID-5591B05F-8253-4B25-B64C-E7084E7A8DD9" name="GUID-5591B05F-8253-4B25-B64C-E7084E7A8DD9"></a><h5 id="BRADV-GUID-5591B05F-8253-4B25-B64C-E7084E7A8DD9" class="sect5"><span class="enumeration_section">14.1.1.2 </span>About Application Errors
                     </h5>
                     <p>Sometimes a software malfunction can corrupt data blocks. In a physical corruption, which is also called a media corruption, the database does not recognize the block.</p>
                  </div><a id="BRADV89707"></a><div class="props_rev_3"><a id="GUID-5664E5E8-A5DA-4BA5-91C2-A50954010920" name="GUID-5664E5E8-A5DA-4BA5-91C2-A50954010920"></a><h5 id="BRADV-GUID-5664E5E8-A5DA-4BA5-91C2-A50954010920" class="sect5"><span class="enumeration_section">14.1.1.3 </span>About Media Failures
                     </h5>
                     <div>
                        <p>A media failure occurs when a problem external to the database prevents it from reading from or writing to a file during normal operations. </p>
                        <p>Typical media failures include disk failures and the deletion of database files. Media failures are less common than user or application errors, but your backup and recovery strategy should prepare for them.</p>
                     </div>
                  </div>
               </div><a id="BRADV89708"></a><div class="props_rev_3"><a id="GUID-E78CF06A-1EF0-4B18-8AFA-6C4297B0AF8A" name="GUID-E78CF06A-1EF0-4B18-8AFA-6C4297B0AF8A"></a><h4 id="BRADV-GUID-E78CF06A-1EF0-4B18-8AFA-6C4297B0AF8A" class="sect4"><span class="enumeration_section">14.1.2 </span>About RMAN Data Repair Techniques
                  </h4>
                  <div>
                     <p>RMAN provides multiple methods of data repair.</p>
                     <div class="p">Depending on the situations you anticipate, consider incorporating each of the options described in the following table into your strategy for responding to data loss, and then set up your database to make these options possible.
                        <div class="tblformal" id="GUID-E78CF06A-1EF0-4B18-8AFA-6C4297B0AF8A__GUID-3099E9BC-871C-4502-A352-65D7A2046955">
                           <p class="titleintable">Table 14-1 RMAN Data Repair Techniques</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RMAN Data Repair Techniques" summary="This table briefly describes and then provides links to additional information about RMAN data repair techniques." frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d69940e580">Data Repair Technique</th>
                                    <th align="left" valign="bottom" id="d69940e582">Description</th>
                                    <th align="left" valign="bottom" id="d69940e584">Additional Information</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d69940e588" headers="d69940e580 ">
                                       <p><a href="glossary.html#GUID-5E618F7B-127F-4BE2-9ED5-E9D1B828434D"><span class="xrefglossterm">Data Recovery Advisor</span></a></p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e588 d69940e582 ">
                                       <p>This Oracle Database infrastructure can diagnose failures, advise you on how to respond to them, and repair the failures automatically. </p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e588 d69940e584 ">
                                       <p><span class="q">"<a href="diagnosing-repairing-failures-dra.html#GUID-636EA9BE-2DFB-4FA0-959E-B1290C774ABD" title="The Data Recovery Advisor is a tool that helps reduce database recovery time by determining the best automated repair option for database failures.">Overview of Data Recovery Advisor</a>"</span> 
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d69940e605" headers="d69940e580 ">
                                       <p><a href="glossary.html#GUID-66505C98-875E-4C34-AB45-39762061D6D7"><span class="xrefglossterm">logical flashback features</span></a></p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e605 d69940e582 ">
                                       <p>This subset of <a href="glossary.html#GUID-B9B3A008-D1DB-4B83-B825-70E8B79A9920"><span class="xrefglossterm">Oracle Flashback Technology</span></a> features enables you to view or rewind individual database objects or transactions to a past time. These features do not require use of RMAN.
                                       </p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e605 d69940e584 ">
                                       <p><span class="q">"<a href="rman-performing-flashback-dbpitr.html#GUID-94B90ECF-69C9-40D4-A318-DC4AE9776557" title="This overview describes the purpose and basic concepts of Oracle Flashback Technology and database point-in-time recovery.">Overview of Oracle Flashback Technology and Database Point-in-Time Recovery</a>"</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d69940e624" headers="d69940e580 ">
                                       <p><a href="glossary.html#GUID-DD883C9B-0441-48D3-9DDC-755597782971"><span class="xrefglossterm">Oracle Flashback Database</span></a></p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e624 d69940e582 ">
                                       <p>Flashback Database is a block-level recovery mechanism that is similar to media recovery, but is generally faster and does not require a backup to be restored. You can return your whole database to a previous state without restoring old copies of your data files from backup, if you have enabled flashback logging in advance. You must have a fast recovery area configured for logging for flashback database or guaranteed restore points.</p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e624 d69940e584 ">
                                       <p><span class="q">"<a href="rman-performing-flashback-dbpitr.html#GUID-15D5CF76-8622-4117-8954-3D872A0B0A86" title="Database point-in-time recovery (DBPITR) and Flashback features enable you to recover your database to a prior point in time.">Basic Concepts of Point-in-Time Recovery and Flashback Features</a>"</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d69940e640" headers="d69940e580 ">
                                       <p><a href="glossary.html#GUID-01B3A956-DA97-4B47-9600-FA5549B7E868"><span class="xrefglossterm">data file media recovery</span></a></p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e640 d69940e582 ">
                                       <p>This form of <a href="glossary.html#GUID-5FEE9C7C-AD8F-4CFB-BAF2-E6B52EDC67AB"><span class="xrefglossterm">media recovery</span></a> enables you to restore data file backups and apply archived redo logs or incremental backups to recover lost changes. You can either recover a whole database or a subset of the database. Data file media recovery is the most general-purpose form of recovery and can protect against both physical and logical failures.
                                       </p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e640 d69940e584 ">
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p><span class="q">"<a href="rman-complete-database-recovery.html#GUID-D908719C-9D46-4084-850C-0F81C25094EB" title="Complete recovery returns your database to normal operation after the loss of one or more database files.Complete recovery is recovering a database to the most recent point in time, without the loss of any committed transactions.The complete recovery operations described in this chapter are subject to certain conditions.Zero Data Loss Recovery Appliance (Recovery Appliance) substantially reduces the window of potential data loss that exists between successive archived redo log backups. You to recover target databases to within a few subseconds of a database failure.You must plan your database restore and recovery strategy based on your recovery goal and which database files have been lost.The techniques for determining which files require restore or recovery depend upon the type of file that is lost.The database shuts down immediately when any of the multiplexed control files become inaccessible. The decision about when and how to recover depends on the state of the database and the location of its data files.An easy technique for determining which data files are missing is to run a VALIDATE DATABASE command. Although VALIDATE DATABASE is a good technique for determining whether files are inaccessible, you may want to use SQL queries to obtain more detailed information. It is recommended that you record the DBID of your database.Previewing backups helps you to ensure that all backups required for a restore and recovery operation are available.An offsite backup is stored in a remote location, such as a secure storage facility, and cannot be restored unless the media manager retrieves the media.Validating backups determines if the backups are usable.RMAN restores archived redo log files from backup automatically as needed to perform recovery.RMAN enables you to override the default location for restored archived redo log files.To manage disk space that is used to contain the restored logs, you can specify restore destinations for archived logs multiple times in one RUN block, to distribute restored logs among several destinations.For backups encrypted using certain techniques, you must provide the password that will be used to decrypt these backups.During complete recovery RMAN restores one or more data files and then applies all the redo generated after the restored backup.You use the RESTORE and RECOVER commands to restore and recover the database. If you cannot restore data files to their default locations, then you must update the control file to reflect the new locations of the data files.This scenario assumes that database trgt has lost most or all of its data files. It also assumes that the database uses a fast recovery area.Use the RESTORE and RECOVER commands with the TABLESPACE option to perform complete recovery of a tablespaceYou can recover a database by switching to image copies of inaccessible data files. This technique takes less time than traditional restore and recovery because no backups need to be restored.When one or more data files are damaged, you can perform recovery by switching to existing image copies of the damaged data files.You can perform complete database recovery by switching to image copies of the damaged data files instead of restoring these data files.RMAN and Oracle Enterprise Manager Cloud Control (Cloud Control) provide full support for backup and recovery in a multitenant environment. When you recover a whole CDB, you recover the root and all PDBs in a single operation.You might consider recovering only the root if a data corruption or user error occurs that affects only the root.You can perform complete recovery of one or more PDBs without affecting operations of other open PDBs.Enterprise Manager Cloud Control (Cloud Control) provides an interface to recover PDBs.Use the RECOVER command to perform complete recovery using preplugin backups.Preplugin backups are used to restore and recover a PDB to its state at a time in the past that was before the PDB was plugged in to the current CDB. RMAN performs complete recovery of a PDB using preplugin backups. These preplugin backups were created on a source non-CDB or a source CDB before the PDB was migrated to the current target CDB. This example performs complete recovery of a PDB my_pdb in the destination CDB prod_cdb using preplugin backups.Because tablespaces in different PDBs can have the same name, to eliminate ambiguity, you must connect directly to a PDB to recover one or more of its tablespaces. In contrast, because data file numbers and paths are unique across the CDB, you can connect either to the root or to a PDB when recovering PDB data files.Oracle Enterprise Manager Cloud Control (Cloud Control) provides an interface to recover tablespaces within a PDB.Recovering a CDB by switching to a copy is faster than traditional restore and recovery.RMAN enables you to use the RESTORE and RECOVER commands to perform complete recovery of the application containers without impacting the other containers in the CDB.Use the RESTORE and RECOVER commands to perform complete recovery of the application root.You can perform complete recovery of an application container, which includes the application root and all its application PDBs without impacting the other PDBs within the CDB.Use the RESTORE and RECOVER commands to perform complete recovery of one or more application PDBs.You can recover sparse databases to the most recent point in time using the RESTORE and RECOVER commands.Performing recovery of a database containing sparse data files is very similar to performing recovery of a whole database.Performing recovery of a sparse CDB is very similar to performing the complete recovery of a sparse database. You can recover a sparse PDB while you are connected at the root level or at the CDB level.">Performing Complete Database Recovery</a>"</span></p>
                                          </li>
                                          <li>
                                             <p><span class="q">"<a href="rman-performing-flashback-dbpitr.html#GUID-7D3EE2F7-77A2-4264-8875-CC0AEC64ABE0" title="RMAN DBPITR restores the database from backups before the target time for recovery, then uses incremental backups and redo to roll the database forward to the target time. You can recover to an SCN, time, log sequence number, or restore point. Oracle recommends that you create restore points at important times to make point-in-time recovery more manageable if it ever becomes necessary.">Performing Database Point-in-Time Recovery</a>"</span></p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d69940e732" headers="d69940e580 ">
                                       <p><a href="glossary.html#GUID-923A509A-1C36-4EA4-91C8-6E4F372722C0"><span class="xrefglossterm">block media recovery</span></a></p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e732 d69940e582 ">
                                       <p>This form of <a href="glossary.html#GUID-5FEE9C7C-AD8F-4CFB-BAF2-E6B52EDC67AB"><span class="xrefglossterm">media recovery</span></a> enables you to recover individual blocks within a data file rather than the whole data file. 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e732 d69940e584 ">
                                       <p><span class="q">"<a href="rman-block-media-recovery.html#GUID-B6CFA426-5B2D-401F-B8B3-58FCD9ED3216" title="Block media recovery recovers provides lower mean time to recover (MTTR) by recovering corrupt data blocks.">Overview of Block Media Recovery</a>"</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d69940e751" headers="d69940e580 ">
                                       <p><a href="glossary.html#GUID-8A257409-B3DC-41FD-A2AF-D47560FF9F18"><span class="xrefglossterm">tablespace point-in-time recovery (TSPITR)</span></a></p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e751 d69940e582 ">
                                       <p>This is a specialized form of <a href="glossary.html#GUID-491BEF3A-18F0-4670-B078-2D84765141E8"><span class="xrefglossterm">point-in-time recovery</span></a> in which you recover one or more tablespaces to a time earlier than the rest of the database. 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" headers="d69940e751 d69940e584 ">
                                       <p><span class="q">"<a href="performing-rman-tspitr.html#GUID-416AF503-9611-46AA-81A9-7B9E1A0A5AC1" title="To use RMAN tablespace point-in-time recovery (TSPITR) effectively, it is helpful to understand what types of problems it can resolve, its components, what RMAN does during TSPITR, and the various limitations and restrictions on when and how it can be run. This section explains the basic concepts, preparatory tasks, and modes of running RMAN TSPITR.">Overview of RMAN TSPITR</a>"</span></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <p>In general, the concepts required to use the preceding repair techniques are explained along with the techniques. This chapter explains concepts that are common to several RMAN data repair solutions.</p>
                  </div>
               </div>
            </div><a id="BRADV116"></a><div class="props_rev_3"><a id="GUID-D6322BFA-1EF4-48CA-A52D-3FC7E35044FA" name="GUID-D6322BFA-1EF4-48CA-A52D-3FC7E35044FA"></a><h3 id="BRADV-GUID-D6322BFA-1EF4-48CA-A52D-3FC7E35044FA" class="sect3"><span class="enumeration_section">14.2 </span>About RMAN Restore Operations
               </h3>
               <div>
                  <p>In an RMAN restore operation, you select files to be restored and then run the <code class="codeph">RESTORE</code> command. Typically, you restore files in preparation for media recovery.
                  </p>
                  <p>You can restore the following types of files:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Database (all data files)</p>
                     </li>
                     <li>
                        <p>Tablespaces</p>
                     </li>
                     <li>
                        <p>Control files</p>
                     </li>
                     <li>
                        <p>Archived redo logs</p>
                     </li>
                     <li>
                        <p>Server parameter files</p>
                     </li>
                  </ul>
                  <p>You can specify either the default location or a new location for restored data files and control files. If you restore to the default location, then RMAN overwrites any files with the same name that currently exist in this location. Alternatively, you can use the <code class="codeph">SET NEWNAME</code> command to specify new locations for restored data files. You can then run a <code class="codeph">SWITCH</code> command to update the control file to indicate that the restored files in their new locations are now the current data files.
                  </p>
                  <div class="infoboxnotealso" id="GUID-D6322BFA-1EF4-48CA-A52D-3FC7E35044FA__GUID-C1D72C97-1445-4CA2-A388-BA8F5FE26BC7">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../rcmrf/RESTORE.html#RCMRF149" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for <code class="codeph">RESTORE</code> syntax and prerequisites
                           </p>
                        </li>
                        <li>
                           <p><a href="../rcmrf/SET.html#RCMRF153" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for <code class="codeph">SET NEWNAME</code> syntax
                           </p>
                        </li>
                        <li>
                           <p><a href="../rcmrf/SWITCH.html#RCMRF159" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for <code class="codeph">SWITCH</code> syntax
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV89709"></a><div class="props_rev_3"><a id="GUID-164F7AD2-EF3F-4541-98A3-5DE198D87550" name="GUID-164F7AD2-EF3F-4541-98A3-5DE198D87550"></a><h4 id="BRADV-GUID-164F7AD2-EF3F-4541-98A3-5DE198D87550" class="sect4"><span class="enumeration_section">14.2.1 </span>About RMAN Backup Selection
                  </h4>
                  <div>
                     <p>RMAN uses the records of available backup sets or image copies in the RMAN repository to select the best available backups for use in the restore operation.</p>
                     <p>The most recent backup available, or the most recent backup satisfying any <code class="codeph">UNTIL</code> clause specified in the <code class="codeph">RESTORE</code> command, is the preferred choice. If two backups are from the same point in time, then RMAN prefers image copies over backup sets because RMAN can restore more quickly from image copies than from backup sets (especially those stored on tape).
                     </p>
                     <p>All specifications of the <code class="codeph">RESTORE</code> command must be satisfied before RMAN restores a backup. Unless limited by the <code class="codeph">DEVICE</code> <code class="codeph">TYPE</code> clause, the <code class="codeph">RESTORE</code> command searches for backups on all device types of configured channels. If no available backup in the repository satisfies all the specified criteria, then RMAN returns an error indicating that the file cannot be restored.
                     </p>
                     <p>If you use only manually allocated channels, then a backup job may fail if there is no usable backup on the media for which you allocated channels. Configuring automatic channels makes it more likely that RMAN can find and restore a backup that satisfies the specified criteria.</p>
                     <div class="infoboxnotealso" id="GUID-164F7AD2-EF3F-4541-98A3-5DE198D87550__GUID-78909369-4757-4D9E-889D-C6AA4E9B5F1F">
                        <p class="notep1">See Also:</p>
                        <p><span class="q">"<a href="configuring-rman-client-advanced.html#GUID-EF072AB8-AE89-4847-90B1-2214FD2336B3" title="The CONFIGURE CHANNEL command is used to configure RMAN channel options.">Configuring Advanced Channel Options</a>"</span></p>
                     </div>
                  </div>
               </div><a id="BRADV30001"></a><div class="props_rev_3"><a id="GUID-D76CD1E8-2B9E-40F6-A13F-3264D6BA2B8C" name="GUID-D76CD1E8-2B9E-40F6-A13F-3264D6BA2B8C"></a><h4 id="BRADV-GUID-D76CD1E8-2B9E-40F6-A13F-3264D6BA2B8C" class="sect4"><span class="enumeration_section">14.2.2 </span>About RMAN Restore Failover
                  </h4>
                  <div>
                     <p>RMAN automatically uses restore failover to skip corrupted or inaccessible backups and look for usable backups. When a backup is not found, or contains corrupt data, RMAN automatically looks for another backup from which to restore the desired files. </p>
                     <p>RMAN generates messages that indicate the type of failover that it is performing. For example, when RMAN fails over to another backup of the same file, it generates a message similar to the following:</p><pre class="oac_no_warn" dir="ltr">failover to piece handle=/u01/backup/db_1 tag=BACKUP_031009
</pre><p>If no usable copies are available, then RMAN searches for previous backups. The message generated is similar to the following example:</p><pre class="oac_no_warn" dir="ltr">ORA-19624: operation failed, retry possible
ORA-19505: failed to identify file "/u01/backup/db_1"
ORA-27037: unable to obtain file status
SVR4 Error: 2: No such file or directory
Additional information: 3
failover to previous backup
</pre><p>RMAN performs restore failover repeatedly until it has exhausted all possible backups. If all of the backups are unusable or no backups exists, then RMAN attempts to re-create the data file. Restore failover is also used when there are errors restoring archived redo logs during <code class="codeph">RECOVER</code>, <code class="codeph">RECOVER ... BLOCK</code>, and <code class="codeph">FLASHBACK DATABASE</code> commands.
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-111D4107-6A6A-4910-BB95-D20C4036D7AD" name="GUID-111D4107-6A6A-4910-BB95-D20C4036D7AD"></a><h4 id="BRADV-GUID-111D4107-6A6A-4910-BB95-D20C4036D7AD" class="sect4"><span class="enumeration_section">14.2.3 </span>About RMAN Restore of Encrypted Backups
                  </h4>
                  <div>
                     <p>RMAN automatically decrypts backup sets that are protected with backup encryption when their contents are restored. Additional steps, if any, depend on the on the technique that was used to encrypt the backups.</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Transparent backup encryption using an auto-login software keystore requires no intervention if the Oracle keystore is available.</p>
                           <p>When restoring a backup on a host that is different from the source host on which the backup is created, manually copy the Oracle keystore from the source database to the destination host.</p>
                        </li>
                        <li>
                           <p>Transparent backup encryption using a password-based keystore requires the keystore to be open.</p>
                           <p>Manually copy the Oracle software keystore to the destination host on which the backup is being restored and provide the password required to open the keystore. The <code class="codeph">SET DECRYPTION WALLET OPEN IDENTIFIED BY</code> command to provide the password.
                           </p>
                        </li>
                        <li>
                           <p>Password-encrypted backups require the correct password to be entered before they can be restored.</p>
                           <p>Use the <code class="codeph">SET DECRYPTION IDENTIFIED BY</code> command to specify the password that must be used to decrypt the encrypted backup.
                           </p>
                        </li>
                        <li>
                           <p>Dual-mode encrypted backups can be restored either transparently, by using the Oracle software keystore, or by specifying a password for decryption.</p>
                        </li>
                     </ul>
                     <div class="section">
                        <p class="subhead3" id="GUID-111D4107-6A6A-4910-BB95-D20C4036D7AD__GUID-DEE1B266-2336-44B2-84FC-B4C941405FEB">TDE Master Keys and Transparently Encrypted Backups</p>
                        <p>When you reset (or rotate, rekey) a TDE master encryption key, RMAN can still restore backups that were encrypted using the old TDE master encryption key. This is possible because the Oracle keystore stores a history of all retired TDE master encryption keys.</p>
                        <div class="infoboxnote" id="GUID-111D4107-6A6A-4910-BB95-D20C4036D7AD__GUID-B0FA373C-41FE-4915-849B-9D66B375405B">
                           <p class="notep1">Note:</p>If the Oracle keystore that contains the TDE master key is lost and needs to be recreated, then any backups that were encrypted using the old TDE master keys are invalidated and cannot be used.
                        </div>
                        <div class="infoboxnotealso" id="GUID-111D4107-6A6A-4910-BB95-D20C4036D7AD__GUID-CB1B9672-9246-4B6A-9CC8-366AE0DA2AA6">
                           <p class="notep1">See Also:</p><a href="../asoag/managing-keystore-and-tde-master-encryption-key.html#ASOAG-GUID-0C080CA8-1812-4DCD-AC30-FE47534C7962" target="_blank"><span><cite>Oracle Database Advanced Security Guide</cite></span></a></div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV850"></a><div class="props_rev_3"><a id="GUID-1AE2D74F-250D-4D58-9025-3F47F494AC40" name="GUID-1AE2D74F-250D-4D58-9025-3F47F494AC40"></a><h4 id="BRADV-GUID-1AE2D74F-250D-4D58-9025-3F47F494AC40" class="sect4"><span class="enumeration_section">14.2.4 </span>About RMAN Restore Operations and ASM
                  </h4>
                  <div>
                     <p>When Automatic Storage Management (ASM) disk groups are used, an RMAN restore operation creates new copies of data files only if the full name of a data file, including the incarnation, does not match with the name of an existing data file. </p>
                     <p>A fully qualified ASM file name is of the form <code>+diskgroup/dbname/filetype/filetypetag.file.incarnation</code>. When you first restore the control file and then restore the other database files, the names of the data files in the control file may not match with the names of the existing data files and therefore the data files are recreated.
                     </p>
                     <p>Use one of the following methods to ensure that existing data files are not recreated during a restore or duplicate operation:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>In the control file, use alias names for each data file. The alias must not include the ASM incarnation number.</p>
                        </li>
                        <li>
                           <p>After restoring the control file and before restoring the other database files, use the <code class="codeph">CATALOG</code> command to ensure that the existing data files are cataloged in the restored control file. Next, use the <code class="codeph">SWITCH</code> command to make the restored control file point to the existing data files.
                           </p>
                        </li>
                        <li>
                           <p>Use <code class="codeph">SET NEWNAME</code> to rename the data files before restoring the data files and after restoring the control file.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV89710"></a><div class="props_rev_3"><a id="GUID-43A50B18-3F02-46C9-B760-FF7375FFF5D4" name="GUID-43A50B18-3F02-46C9-B760-FF7375FFF5D4"></a><h4 id="BRADV-GUID-43A50B18-3F02-46C9-B760-FF7375FFF5D4" class="sect4"><span class="enumeration_section">14.2.5 </span>About RMAN Restore Optimization
                  </h4>
                  <div>
                     <p>RMAN uses restore optimization to avoid restoring data files from backup when possible. If a data file is present in the correct location and its header contains the expected information, then RMAN does not restore the data file from backup.</p>
                     <div class="infoboxnote" id="GUID-43A50B18-3F02-46C9-B760-FF7375FFF5D4__GUID-E2108717-8DA3-41F9-A348-1F6827F14DE7">
                        <p class="notep1">Note:</p>
                        <p>Restore optimization only checks the data file header. It does not the scan the data file body for corrupted blocks.</p>
                     </div>
                     <p>You can use the <code class="codeph">FORCE</code> option of the <code class="codeph">RESTORE</code> command to override this behavior and restore the requested files unconditionally.
                     </p>
                     <p>Restore optimization is particularly useful when an operation that restores several data files is interrupted. For example, assume that a full database restore encounters a power failure after all except one data file has been restored. If you run the same <code class="codeph">RESTORE</code> command again, then RMAN only restores the single data file that was not restored during the previous attempt.
                     </p>
                     <p>Restore optimization is also used when duplicating a database. If a data file at the duplicate is in the correct place with the correct header contents, then the data file is not duplicated. Unlike <code class="codeph">RESTORE</code>, <code class="codeph">DUPLICATE</code> does not support a <code class="codeph">FORCE</code> option. To force RMAN to duplicate a data file that is skipped due to restore optimization, delete the data file from the duplicate before running the <code class="codeph">DUPLICATE</code> command.
                     </p>
                     <div class="infoboxnotealso" id="GUID-43A50B18-3F02-46C9-B760-FF7375FFF5D4__GUID-EEB887D1-30F9-43C3-BC85-AEB345E82743">
                        <p class="notep1">See Also:</p>
                        <p><a href="../racad/managing-backup-and-recovery.html#RACAD059" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> for description of <code class="codeph">RESTORE</code> behavior in an Oracle RAC configuration
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="BRADV117"></a><div class="props_rev_3"><a id="GUID-76B772E9-9B69-4D86-8735-D9453A425017" name="GUID-76B772E9-9B69-4D86-8735-D9453A425017"></a><h3 id="BRADV-GUID-76B772E9-9B69-4D86-8735-D9453A425017" class="sect3"><span class="enumeration_section">14.3 </span>About RMAN Media Recovery
               </h3>
               <div>
                  <p>In media recovery, RMAN applies changes to restored data to roll forward this data in time. </p>
                  <p>RMAN can perform either <a href="glossary.html#GUID-01B3A956-DA97-4B47-9600-FA5549B7E868"><span class="xrefglossterm">data file media recovery</span></a> or <a href="glossary.html#GUID-923A509A-1C36-4EA4-91C8-6E4F372722C0"><span class="xrefglossterm">block media recovery</span></a>.
                  </p>
                  <p>Data file media recovery is the application of redo logs or incremental backups to a restored data file to update it to the current time or some other specified time. As explained in <a href="../cncpt/concepts-for-database-administrators.html#CNCPT031" target="_blank"><span><cite>Oracle Database Concepts</cite></span></a>, you can use RMAN to perform <a href="glossary.html#GUID-6486CE9C-3487-4B47-BDAF-EF5199D27E3A"><span class="xrefglossterm">complete recovery</span></a>, <a href="glossary.html#GUID-FCC8BB91-79B6-4AF1-974A-43E75CD161E3"><span class="xrefglossterm">database point-in-time recovery (DBPITR)</span></a>, or <a href="glossary.html#GUID-8A257409-B3DC-41FD-A2AF-D47560FF9F18"><span class="xrefglossterm">tablespace point-in-time recovery (TSPITR)</span></a>. You can use the <code class="codeph">RESTORE</code> command to restore backups of lost and damaged data files or control files and the <code class="codeph">RECOVER</code> command to perform media recovery.
                  </p>
                  <p>Block media recovery is the recovery of individual data blocks rather than entire data files. This section explains data file media recovery only. Block media recovery, which is a specialized form of media recovery, is explained in <span class="q">"<a href="rman-block-media-recovery.html#GUID-B6CFA426-5B2D-401F-B8B3-58FCD9ED3216" title="Block media recovery recovers provides lower mean time to recover (MTTR) by recovering corrupt data blocks.">Overview of Block Media Recovery</a>"</span>.
                  </p>
               </div><a id="BRADV89711"></a><div class="props_rev_3"><a id="GUID-EC33413A-79B8-4ECF-A77B-DF91957D76FF" name="GUID-EC33413A-79B8-4ECF-A77B-DF91957D76FF"></a><h4 id="BRADV-GUID-EC33413A-79B8-4ECF-A77B-DF91957D76FF" class="sect4"><span class="enumeration_section">14.3.1 </span>About Selection of Incremental Backups and Archived Redo Logs
                  </h4>
                  <div>
                     <p>RMAN automates media recovery. RMAN automatically restores and applies both incremental backups and archived redo logs in whatever combination is most efficient.</p>
                     <p>If the RMAN repository indicates that no copies of a required log sequence number exist on disk, then it automatically restores the required log from backup. By default, RMAN restores the archived logs to the fast recovery area, if an archiving destinations is set to <code class="codeph">USE_DB_RECOVERY_FILE_DEST</code>. Otherwise, RMAN restores the logs to the first local archiving destination specified in the initialization parameter file. 
                     </p>
                     <div class="infoboxnotealso" id="GUID-EC33413A-79B8-4ECF-A77B-DF91957D76FF__GUID-59AEC854-59F6-4D66-BD4A-7E91E46898D7">
                        <p class="notep1">See Also:</p>
                        <p><a href="../rcmrf/CROSSCHECK.html#RCMRF119" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for <code class="codeph">CROSSCHECK</code> syntax
                        </p>
                     </div>
                  </div>
               </div><a id="BRADV1171"></a><div class="props_rev_3"><a id="GUID-9942AC94-A35D-4A06-9A45-A5A43B82B23D" name="GUID-9942AC94-A35D-4A06-9A45-A5A43B82B23D"></a><h4 id="BRADV-GUID-9942AC94-A35D-4A06-9A45-A5A43B82B23D" class="sect4"><span class="enumeration_section">14.3.2 </span>About Database Incarnations
                  </h4>
                  <div>
                     <p>A database incarnation is created whenever you open the database with the <code class="codeph">RESETLOGS</code> option. 
                     </p>
                     <p>After complete recovery, you can resume normal operations without an <code class="codeph">OPEN RESETLOGS</code> . After a DBPITR or recovery with a backup control file, however, you must open the database with the <code class="codeph">RESETLOGS</code> option, thereby creating a new incarnation of the database. The database requires a new incarnation to avoid confusion when two different redo streams have the same SCNs, but occurred at different times. If you apply the wrong redo to your database, then you corrupt it.
                     </p>
                     <p>The existence of multiple incarnations of a single database determines how RMAN treats backups that are not in the current incarnation path. Usually, the current database incarnation is the correct one to use. Nevertheless, in some cases resetting the database to a previous incarnation is the best approach. For example, you may be dissatisfied with the results of a point-in-time recovery that you have performed and want to return the database to a time before the <code class="codeph">RESETLOGS</code>. An understanding of database incarnations is helpful to prepare for such situations.
                     </p>
                  </div><a id="BRADV89712"></a><div class="props_rev_3"><a id="GUID-3DC071AD-5209-4F3D-98AA-6C0FA656D1B7" name="GUID-3DC071AD-5209-4F3D-98AA-6C0FA656D1B7"></a><h5 id="BRADV-GUID-3DC071AD-5209-4F3D-98AA-6C0FA656D1B7" class="sect5"><span class="enumeration_section">14.3.2.1 </span>About RMAN OPEN RESETLOGS Operations
                     </h5>
                     <div>
                        <p>RMAN performs certain actions when you open the database with the <code class="codeph">RESETLOGS</code> option.
                        </p>
                        <p>The action performed are as follows:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Archives the current online redo logs (if they are accessible) and then erases the contents of the online redo logs and resets the log sequence number to 1.</p>
                              <p>For example, if the current online redo logs are sequence 1000 and 1001 when you open <code class="codeph">RESETLOGS</code>, then the database archives logs 1000 and 1001 and then resets the online redo logs to sequence 1 and 2.
                              </p>
                           </li>
                           <li>
                              <p>Creates the online redo log files if they do not currently exist.</p>
                           </li>
                           <li>
                              <p>Initializes redo thread records and online redo log records in the control file to the beginning of the new database incarnation.</p>
                              <p>More specifically, the database sets the redo thread status to closed, sets the current thread sequence in the redo thread records to 1, sets the thread checkpoint of each redo thread to the beginning of log sequence 1, chooses one redo log from each thread and initialize its sequence to 1, and so on.</p>
                           </li>
                           <li>
                              <p>Updates all current data files and online redo logs and all subsequent archived redo logs with a new <code class="codeph">RESETLOGS SCN</code> and time stamp.
                              </p>
                           </li>
                        </ul>
                        <p>Because the database does not apply an archived redo log to a data file unless the <code class="codeph">RESETLOGS SCN</code> and time stamps match, the <code class="codeph">RESETLOGS</code> requirement prevents you from corrupting data files with archived logs that are not from direct parent incarnations of the current incarnation. The relationship among incarnations is explained more fully in the following section.
                        </p>
                        <p>In previous releases, it was recommended that you back up the database immediately after the <code class="codeph">OPEN RESETLOGS</code>. Because you can now easily recover a pre-<code class="codeph">RESETLOGS</code> backup like any other backup, making a new database backup is optional. To perform recovery through <code class="codeph">RESETLOGS</code> you must have all archived logs generated after the most recent backup and at least one control file (current, backup, or created).
                        </p>
                     </div>
                  </div><a id="BRADV326"></a><a id="BRADV99974"></a><div class="props_rev_3"><a id="GUID-EC2E2F24-0AD3-486D-9289-407E7F1F5C9C" name="GUID-EC2E2F24-0AD3-486D-9289-407E7F1F5C9C"></a><h5 id="BRADV-GUID-EC2E2F24-0AD3-486D-9289-407E7F1F5C9C" class="sect5"><span class="enumeration_section">14.3.2.2 </span>Relationship Among Database Incarnations
                     </h5>
                     <div>
                        <p>Database incarnations can stand in the following relationships to each other:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The <a href="glossary.html#GUID-4CC16BA6-2C59-4202-AEBB-3518F45BFD56"><span class="xrefglossterm">current incarnation</span></a> is the one in which the database is currently operating.
                              </p>
                           </li>
                           <li>
                              <p>The incarnation from which the current incarnation branched following an <code class="codeph">OPEN RESETLOGS</code> operation is the <a href="glossary.html#GUID-6DFC5F78-79E6-480B-9E29-B20876535B78"><span class="xrefglossterm">parent incarnation</span></a> of the current incarnation.
                              </p>
                           </li>
                           <li>
                              <p>The parent of the parent incarnation is an <a href="glossary.html#GUID-853064EA-D07A-43C2-B27A-1E41928D43A7"><span class="xrefglossterm">ancestor incarnation</span></a>. Any parent of an ancestor incarnation is also an ancestor of the current incarnation.
                              </p>
                           </li>
                           <li>
                              <p>The <a href="glossary.html#GUID-9FA6E4CA-C9C0-47E8-8FDF-2C2A313F8944"><span class="xrefglossterm">direct ancestral path</span></a> of the current incarnation begins with the earliest incarnation and includes only the branches to an ancestor of the current incarnation, the parent incarnation, or the current incarnation.
                              </p>
                           </li>
                        </ul>
                        <p>An incarnation number is used to uniquely tag and identify a stream of redo. <a href="rman-data-repair-concepts.html#GUID-EC2E2F24-0AD3-486D-9289-407E7F1F5C9C__CHDCJGGD">Figure 14-1</a> illustrates a database that goes through several incarnations, each with a different incarnation number.
                        </p>
                        <div class="figure" id="GUID-EC2E2F24-0AD3-486D-9289-407E7F1F5C9C__CHDCJGGD">
                           <p class="titleinfigure">Figure 14-1 Database Incarnation History</p><img src="img/bradv039.gif" alt="Description of Figure 14-1 follows" title="Description of Figure 14-1 follows" longdesc="img_text/bradv039.html"><br><a href="img_text/bradv039.html">Description of "Figure 14-1 Database Incarnation History"</a></div>
                        <!-- class="figure" -->
                        <p>Incarnation 1 of the database starts at SCN 1 and continues through SCN 1000 to SCN 2000. Suppose that at SCN 2000 in incarnation 1, you perform a point-in-time recovery back to SCN 1000, and then open the database with the <code class="codeph">RESETLOGS</code> option. Incarnation 2 now begins at SCN 1000 and continues to SCN 3000. In this example, incarnation 1 is the parent of incarnation 2.
                        </p>
                        <p>Suppose that at SCN 3000 in incarnation 2, you perform a point-in-time recovery to SCN 2000 and open the database with the <code class="codeph">RESETLOGS</code> option. In this case, incarnation 2 is the parent of incarnation 3. Incarnation 1 is an ancestor of incarnation 3.
                        </p>
                        <p>When DBPITR or Flashback Database has occurred in database, an SCN can refer to multiple points in time, depending on which incarnation is current. For example, SCN 1500 in <a href="rman-data-repair-concepts.html#GUID-EC2E2F24-0AD3-486D-9289-407E7F1F5C9C__CHDCJGGD">Figure 14-1</a> could refer to an SCN in incarnation 1 or 2.
                        </p>
                        <p>You can use the <code class="codeph">RESET DATABASE TO INCARNATION</code> command to specify that SCNs are to be interpreted in the frame of reference of a specific database incarnation. The <code class="codeph">RESET DATABASE TO INCARNATION</code> command is required when you use <code class="codeph">FLASHBACK</code>, <code class="codeph">RESTORE</code>, or <code class="codeph">RECOVER</code> to return to an SCN in a noncurrent database incarnation. However, RMAN executes the <code class="codeph">RESET DATABASE TO INCARNATION</code> command implicitly with Flashback, as explained in <span class="q">"<a href="managing-recovery-catalog.html#GUID-304B2237-0921-422F-A084-D83E7B5C8D2B" title="You create an incarnation of the database when you open the database with the RESETLOGS option. You can access a record of the new incarnation in the V$DATABASE_INCARNATION view.">Resetting the Database Incarnation in the Recovery Catalog</a>"</span>.
                        </p>
                        <div class="infoboxnotealso" id="GUID-EC2E2F24-0AD3-486D-9289-407E7F1F5C9C__GUID-E295537F-7A2D-4B82-B057-B1F466123BDC">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="rman-performing-flashback-dbpitr.html#GUID-F1818201-98E5-4B70-BDFE-A61AB84397E6" title="To perform DPITR to an noncurrent database incarnation, you must explicitly execute the RESET DATABASE to reset the database to the incarnation that was current at the target SCN. You must also restore a control file from the database incarnation containing the target SCN.">Recovering the Database to an Ancestor Incarnation</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="../rcmrf/RESET-DATABASE.html#RCMRF148" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for details about the <code class="codeph">RESET DATABASE</code> command
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="BRADV679"></a><div class="props_rev_3"><a id="GUID-195FE6CA-9CEB-4ED1-9810-F7323F119D87" name="GUID-195FE6CA-9CEB-4ED1-9810-F7323F119D87"></a><h5 id="BRADV-GUID-195FE6CA-9CEB-4ED1-9810-F7323F119D87" class="sect5"><span class="enumeration_section">14.3.2.3 </span>About Incarnations of PDBs
                     </h5>
                     <div>
                        <p>A pluggable database (PDB) incarnation is a subincarnation of the multitenant container database (CDB) and is expressed as <code class="codeph">(</code><span class="italic"><code class="codeph">database_incarnation, pdb_incarnation</code></span><code class="codeph">)</code>. 
                        </p>
                        <p>For example, if the CDB is incarnation <code class="codeph">5</code>, and a PDB is incarnation <code class="codeph">3</code>, then the fully specified incarnation number of the PDB is <code class="codeph">(5, 3)</code>. The initial incarnation of a PDB is 0. Subsequent incarnations are unique but not always sequential numbers.
                        </p>
                        <p>The <code class="codeph">V$PDB_INCARNATION</code> view contains information about all PDB incarnations. Use the following query to display the current incarnation of a PDB:
                        </p><pre class="pre codeblock"><code>SELECT PDB_INCARNATION# FROM V$PDB_INCARNATION
   WHERE STATUS = 'CURRENT' AND CON_ID = <span class="italic">PDB_container_id</span>;
</code></pre></div>
                  </div><a id="BRADV89713"></a><div class="props_rev_3"><a id="GUID-8D278206-A634-422C-BA3B-3D4DD09B6B26" name="GUID-8D278206-A634-422C-BA3B-3D4DD09B6B26"></a><h5 id="BRADV-GUID-8D278206-A634-422C-BA3B-3D4DD09B6B26" class="sect5"><span class="enumeration_section">14.3.2.4 </span>About Orphaned Backups
                     </h5>
                     <div>
                        <p>When a database goes through multiple incarnations, some backups can become orphaned backups. Orphaned backups are backups created during incarnations of the database that are not in the direct ancestral path.</p>
                        <p>Assume the scenario shown in <a href="rman-data-repair-concepts.html#GUID-EC2E2F24-0AD3-486D-9289-407E7F1F5C9C__CHDCJGGD">Figure 14-1</a>. If incarnation 3 is the current incarnation, then the following backups are orphaned:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>All backups from incarnation 1 after SCN 1000</p>
                           </li>
                           <li>
                              <p>All backups from incarnation 2 after SCN 2000</p>
                           </li>
                        </ul>
                        <p>In contrast, the following backups are not orphaned because they are in the direct ancestral path:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>All backups from incarnation 1 before SCN 1000</p>
                           </li>
                           <li>
                              <p>All backups from incarnation 2 before SCN 2000</p>
                           </li>
                           <li>
                              <p>All backups from incarnation 3</p>
                           </li>
                        </ul>
                        <p>You can use orphaned backups when you intend to restore the database to an SCN not in the direct ancestral path. RMAN can restore backups from parent and ancestor incarnations and recover to the current time, even across <code class="codeph">OPEN RESETLOGS</code> operations, if a continuous path of archived logs exists from the earliest backups to the point to which you want to recover. If you restore a control file from an incarnation in which the changes represented in the backups had not been abandoned, then RMAN can also restore and recover orphaned backups.
                        </p>
                     </div>
                  </div><a id="BRADV742"></a><div class="props_rev_3"><a id="GUID-21E646E6-CE3C-4C07-BD03-3904D30AD509" name="GUID-21E646E6-CE3C-4C07-BD03-3904D30AD509"></a><h5 id="BRADV-GUID-21E646E6-CE3C-4C07-BD03-3904D30AD509" class="sect5"><span class="enumeration_section">14.3.2.5 </span>About Orphaned PDB Backups
                     </h5>
                     <div>
                        <p>Orphan PDB backups can result when you perform point-in-time recovery on a pluggable database (PDB) and then open the PDB using the <code class="codeph">RESETLOGS</code> option.
                        </p>
                        <p>After recovering a PDB to a specified point-in-time, when you open the PDB using the <code class="codeph">RESETLOGS</code> option, a new incarnation of the PDB is created. Orphan PDB backups are backups that were created when the SCN or time value was between the SCN or time to which the PDB was recovered and the SCN or time at which the PDB was opened in <code class="codeph">RESETLOGS</code> mode. The <code class="codeph">END_RESETLOGS_SCN</code> column of the <code class="codeph">V$PDB_INCARNATION</code> view contains the SCN at which the PDB is opened in <code class="codeph">RESETLOGS</code> mode.
                        </p>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>