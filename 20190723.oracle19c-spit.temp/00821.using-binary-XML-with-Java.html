<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Topics here explain how to use Binary XML with Java.">
      <meta name="description" content="Topics here explain how to use Binary XML with Java.">
      <title>Using Binary XML with Java</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content="Topics here explain how to use Binary XML with Java.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="xml-developers-kit-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T05:58:48-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96292-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="XML-parsing-for-Java.html" title="Previous" type="text/html">
      <link rel="next" href="using-XSLT-processor-for-Java.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML Developers Kit Programmers Guide">
    <meta name="dcterms.isVersionOf" content="ADXDK">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="XML-parsing-for-Java.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-XSLT-processor-for-Java.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XDK-for-Java.html" property="item" typeof="WebPage"><span property="name">Oracle XML Developer's Kit for Java</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Using Binary XML with Java</li>
            </ol>
            <a id="GUID-38D2C558-108C-449A-A9CD-BC2DAD163D5C" name="GUID-38D2C558-108C-449A-A9CD-BC2DAD163D5C"></a><a id="ADXDK985"></a><a id="ADXDK4440"></a>
            
            <h2 id="ADXDK-GUID-38D2C558-108C-449A-A9CD-BC2DAD163D5C" class="sect2"><span class="enumeration_chapter">13 </span>Using Binary XML with Java
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Topics here explain how to use Binary XML with Java.</p>
               <div class="section"> </div>
               <!-- class="section" -->
            </div><a id="ADXDK19188"></a><div class="props_rev_3"><a id="GUID-AE28E8A2-6782-4517-A8F3-9937198DE3CA" name="GUID-AE28E8A2-6782-4517-A8F3-9937198DE3CA"></a><h3 id="ADXDK-GUID-AE28E8A2-6782-4517-A8F3-9937198DE3CA" class="sect3">Introduction to Binary XML for Java</h3>
               <div>
                  <p>Binary XML makes it possible to encode and decode between XML text and compressed binary XML. Application programming interfaces (APIs) are provided on top of Binary XML for direct consumption by the XML applications. Compression and decompression of fragments of an XML document facilitate incremental processing.</p>
                  <p>This chapter assumes that you are familiar with the XML Parser for Java.</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="XML-parsing-for-Java.html#GUID-33E0EA2B-A08A-462E-86B4-3F944409663D" title="Extensible Markup Language (XML) parsing for Java is described.">XML Parsing for Java</a></li>
                     </ul>
                  </div>
               </div>
               <a id="ADXDK19189"></a><div class="props_rev_3"><a id="GUID-5D946D12-1531-453E-BFD0-4B25320D9DF2" name="GUID-5D946D12-1531-453E-BFD0-4B25320D9DF2"></a><h4 id="ADXDK-GUID-5D946D12-1531-453E-BFD0-4B25320D9DF2" class="sect4">Binary XML Storage Format &#x2013; Java</h4>
                  <div>
                     <p>Binary XML is a compact XML-Schema-aware encoding of XML data, but it can be used with XML data that is not based on an XML schema. You can also use binary XML for XML data which is outside the database (in a client-side application, for instance). Binary XML allows for encoding and decoding of XML documents, from text to binary and binary to text. Binary XML is post-parse persistent XML with native database data types.</p>
                     <p><code class="codeph">XMLType</code> tables and columns can be created using the binary XML storage option. The XML data in binary format can be accessed and manipulated by all the existing structured query language (SQL) operators and functions and Procedural Language/Structured Query Language (PL/SQL) APIs that operate on <code class="codeph">XMLType</code>.
                     </p>
                     <p>Binary XML provides more efficient database storage, updating, indexing, query performance, and fragment extraction than unstructured storage. It can store data and metadata together, or separately.</p>
                     <div class="infoboxnotealso" id="GUID-5D946D12-1531-453E-BFD0-4B25320D9DF2__GUID-5682634E-83BD-4A85-96F9-7523D386D909">
                        <p class="notep1">See Also:</p>
                        <p><a href="../adxdb/intro-to-XML-DB.html#ADXDB0120" target="_blank"><span><cite>Oracle XML&nbsp;DB Developer’s Guide</cite></span></a> for a discussion of all the storage models in Oracle XML DB.
                        </p>
                     </div>
                  </div>
               </div><a id="ADXDK19190"></a><div class="props_rev_3"><a id="GUID-AD4B1CA9-CAAD-4F86-89DD-A77B33AEDBB3" name="GUID-AD4B1CA9-CAAD-4F86-89DD-A77B33AEDBB3"></a><h4 id="ADXDK-GUID-AD4B1CA9-CAAD-4F86-89DD-A77B33AEDBB3" class="sect4">Binary XML Processors</h4>
                  <div>
                     <p>A <span class="italic">binary XML processor</span> is an abstract term for a component that processes and transforms binary XML into text and XML text into binary XML. It can also provide a cache for storing schemas. A binary XML processor can originate or receive network protocol requests.
                     </p>
                     <p>The base class for a binary XML processor is <code class="codeph">BinXMLProcessor</code>. 
                     </p>
                  </div>
               </div>
            </div><a id="ADXDK19191"></a><div class="props_rev_3"><a id="GUID-346318B9-78D9-4B61-AE84-1EB09FA47B8C" name="GUID-346318B9-78D9-4B61-AE84-1EB09FA47B8C"></a><h3 id="ADXDK-GUID-346318B9-78D9-4B61-AE84-1EB09FA47B8C" class="sect3">Models for Using Binary XML</h3>
               <div>
                  <p>There are several models for using binary XML in applications. These subsections describe the terminology and the models for using binary XML.</p>
               </div><a id="ADXDK19192"></a><div class="props_rev_3"><a id="GUID-DCAAAD9D-B314-4B47-AA1F-B9C26B548D3B" name="GUID-DCAAAD9D-B314-4B47-AA1F-B9C26B548D3B"></a><h4 id="ADXDK-GUID-DCAAAD9D-B314-4B47-AA1F-B9C26B548D3B" class="sect4">Usage Terminology for Binary XML</h4>
                  <div>
                     <p>Terms related to binary XML usage are described.</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="italic">doc-id</span>: Each encoded XML document is identified by a unique doc-id. It is either a 16-byte Global User identifier (GUID) or an opaque sequence of bytes like a URL.
                           </p>
                        </li>
                        <li>
                           <p><span class="italic">token table</span>: When a text XML document does not have a schema associated with it, then a token (or symbol) table is used to minimize space for repeated items.
                           </p>
                        </li>
                        <li>
                           <p><span class="italic">vocabulary id</span>: Can be a schema-id or a namespace Universal Resource Identifier (URI) for a token table.
                           </p>
                        </li>
                        <li>
                           <p><span class="italic">schema-id</span>: A unique opaque binary identifier for a schema scoped to the binary XML processor. The schema-id is unique for a binary XML processor and is identifiable only within the scope of that binary XML processor. The schema-id remains constant even when the schema is evolved. A schema-id represents the entire set of schema documents, including imported and included schemas.
                           </p>
                        </li>
                        <li>
                           <p><span class="italic">schema version</span>: Every annotated schema has a version number associated with it. The version number is specified as part of the system level annotations. It is incremented by the binary XML processor when a schema is evolved (that is, a new version of the same schema is registered with the binary XML processor).
                           </p>
                        </li>
                        <li>
                           <p><span class="italic">partial validity</span>: Binary XML stream encoding using schema implies at least partial validity with the schema. Partial validity implies no validation for unique keys, keyrefs, identifiers (IDs), or DTD attributes such as IDREF.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADXDK19193"></a><div class="props_rev_3"><a id="GUID-C6CAD115-2D13-40D8-A2C9-583D300B1172" name="GUID-C6CAD115-2D13-40D8-A2C9-583D300B1172"></a><h4 id="ADXDK-GUID-C6CAD115-2D13-40D8-A2C9-583D300B1172" class="sect4">Standalone Model</h4>
                  <div>
                     <p>This is the simplest usage scenario for binary XML. There is a single binary XML processor. </p>
                     <p>The only repository available is the local in-memory vocabulary cache that is not persistent and is available only for the life of the binary XML processor. All schemas must be registered in advance with the binary XML Processor before the encoding, or they can be registered automatically when the XML Processor sees the <code class="codeph">xsi:SchemaLocation</code> tag. For decoding, the schema is already available in the vocabulary cache.
                     </p>
                  </div>
               </div><a id="ADXDK19194"></a><div class="props_rev_3"><a id="GUID-338EF075-9FC3-4FFA-A165-66839D894092" name="GUID-338EF075-9FC3-4FFA-A165-66839D894092"></a><h4 id="ADXDK-GUID-338EF075-9FC3-4FFA-A165-66839D894092" class="sect4">Client/Server Model</h4>
                  <div>
                     <p>In a client-server scenario, the binary XML processor is connected to a database using Java Database Connectivity (JDBC). It is assumed that the XML schema is registered with the database before encoding.</p>
                     <p>Here is an example of how to achieve that:</p><pre class="oac_no_warn" dir="ltr">BEGIN
   DBMS_XMLSCHEMA.registerSchema(
   SCHEMAURL =&gt; 
   'http://xmlns.oracle.com/xdb/documentation/purchaseOrder.xsd',
   SCHEMADOC =&gt; 
   bfilename('XMLDIR','purchaseOrder.xsd'),
   CSID =&gt; nls_charset_id('AL32UTF8'),
   GENTYPES =&gt; FALSE,
   OPTIONS =&gt; REGISTER_BINARYXML );
END;
/
</pre><p>Unless a separate connection is specified for data (using <code class="codeph">associateDataConnection()</code>) it is assumed that all data and metadata is stored and retrieved using a single connection for encoding and decoding.
                     </p>
                  </div>
               </div><a id="ADXDK19195"></a><div class="props_rev_3"><a id="GUID-CB4F1034-DFF8-4F5B-83AC-EC0398FA82C7" name="GUID-CB4F1034-DFF8-4F5B-83AC-EC0398FA82C7"></a><h4 id="ADXDK-GUID-CB4F1034-DFF8-4F5B-83AC-EC0398FA82C7" class="sect4">Web Services Model With Repository</h4>
                  <div>
                     <p>In this scenario there are multiple clients, each running a binary XML processor. One encodes and another decodes. There is a common repository (that is not necessarily a database) connected to all the clients for metadata storage. It can be a file system or some other repository. </p>
                     <p>The first binary XML processor ensures that the schema is registered with the repository before performing the encoding, or the schema might be automatically registered using the <code class="codeph">xsi:schemaLocation</code> tag at the time of encoding. The second binary XML processor is used for decoding, is not aware of the location of the schema, and fetches the schema from the repository.
                     </p>
                     <p>If the first binary XML processor registers a schema and the second binary XML processor registers the same schema in the repository,  the binary XML processor does not compile the schema, but simply returns the <code class="codeph">vocabulary-id</code> of the existing compiled schema in the local vocabulary cache.
                     </p>
                     <p>The <code class="codeph">BinXMLProcessor</code> is not thread-safe, so multiple threads or clients accessing the repository must implement their own thread safety scheme.
                     </p>
                  </div>
               </div><a id="ADXDK19196"></a><div class="props_rev_3"><a id="GUID-8462F9AB-ED74-4D79-A75A-2E7DA7081F4D" name="GUID-8462F9AB-ED74-4D79-A75A-2E7DA7081F4D"></a><h4 id="ADXDK-GUID-8462F9AB-ED74-4D79-A75A-2E7DA7081F4D" class="sect4">Web Services Model Without Repository</h4>
                  <div>
                     <p>In this scenario, there are multiple clients, each running a binary XML processor. Encoding and decoding can happen on different clients. There is no common metadata repository. </p>
                     <p>The encoder must ensure that the binary data passed to the next client is independent of schema: that is, has inline token definitions. This can be achieved by setting <code class="codeph">schemaAware</code> = <code class="codeph">false</code> and <code class="codeph">inlineTokenDefs</code> = <code class="codeph">true</code>, using the <code class="codeph">setProperty()</code> method, during encoding. While decoding, there is no schema required.
                     </p>
                  </div>
               </div>
            </div><a id="ADXDK19197"></a><div class="props_rev_3"><a id="GUID-A7BD5ED7-A114-4066-A2FF-DE400F37E6D5" name="GUID-A7BD5ED7-A114-4066-A2FF-DE400F37E6D5"></a><h3 id="ADXDK-GUID-A7BD5ED7-A114-4066-A2FF-DE400F37E6D5" class="sect3">Components of Binary XML for Java</h3>
               <div>
                  <p>The components of binary XML for Java are described.</p>
                  <p>These are the components:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Binary XML encoding—The binary XML encoder converts XML 1.0 infoset to binary XML.</p>
                     </li>
                     <li>
                        <p>Binary XML decoding—The binary XML decoder converts binary XML to XML infoset.</p>
                     </li>
                     <li>
                        <p>Binary XML vocabulary management, which includes schema management and token management.</p>
                     </li>
                  </ul>
               </div><a id="ADXDK19198"></a><div class="props_rev_3"><a id="GUID-D70995F6-C8A4-45E4-B6D1-D8258FBA37D2" name="GUID-D70995F6-C8A4-45E4-B6D1-D8258FBA37D2"></a><h4 id="ADXDK-GUID-D70995F6-C8A4-45E4-B6D1-D8258FBA37D2" class="sect4">Binary XML Encoding</h4>
                  <div>
                     <p>The encoder is created from a <code class="codeph">BinXMLStream</code>. It takes XML text as input, and it outputs the encoded binary XML to the <code class="codeph">BinXMLStream</code>. It reads the XML text using streaming SAX. The encoding of the XML text is based on the results of parsing the XML text.
                     </p>
                     <p>Set the <code class="codeph">schemaAware</code> flag on the encoder that specifies whether the encoding is schema-aware or schema-less.
                     </p>
                     <p>For schema-aware encoding, the encoder determines whether the schema with the specified schema URL has been registered with the vocabulary manager. For a repository-based or a database-based processor, the encoder queries the repository or the database for the compiled schema based on the schema URL. If the schema is available in the database, it is fetched from the repository or database in the binary XML format and registered with the local vocabulary manager. The vocabulary is schema.</p>
                     <p>Also set a flag to indicate that the encoding produces a binary XML stream that is independent of a schema. In this case, the resulting binary XML stream contains all token definitions inline and is not dependent on schema or external token sets.</p>
                     <p>If the encoding is schema-aware, the encoder uses the data type information from the schema object for more efficient encoding of the SAX stream. There is a default encoding data type associated with each schema built-in data type. Binary XML stream encoding using a schema implies at least partial validity with the schema (For partial validity there is no validation for unique key, or keyref, or ID, or DTD attributes such as IDREF). If the data is known to be completely valid with a schema, the encoded binary XML stream stores this information.</p>
                     <div class="infoboxnotealso" id="GUID-D70995F6-C8A4-45E4-B6D1-D8258FBA37D2__GUID-EC94B7DB-F670-4389-948B-4D95D1B8C358">
                        <p class="notep1">See Also:</p>
                        <p><a href="../adxdb/XML-Schema-and-query-basic.html#ADXDB0600" target="_blank"><span><cite>Oracle XML&nbsp;DB Developer’s Guide</cite></span></a> for tables of the binary encoding data types and their mappings from XML schema data types
                        </p>
                     </div>
                     <p>If there is no schema associated with the text XML, then integer token ids are generated for repeated items in the text XML. Creating a token table of token ids and token definitions is an important compression technique. The token definitions are stored as token tables in the vocabulary cache. If the property for inline token definitions is set, then the token definitions are present inline.</p>
                     <p>Another property on the encoder is specifying PSVI (Post-Schema-Validated Infoset) information as part of the binary stream. If this is set to true then PSVI information can be accessed using XDK extension APIs for PSVI on DOM. If <code class="codeph">psvi = true</code> then the input XML is fully validated with the schema. If <code class="codeph">psvi</code> is <code class="codeph">false</code> then PSVI information is not included in the output binary stream. The default is <code class="codeph">false</code>.
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="using-binary-XML-with-Java.html#GUID-64183150-1F23-48A4-A1E8-81A0CD512429" title="Token sets can be fetched from the database or metadata repository, cached in the local vocabulary manager, and used for decoding. While encoding, token sets can be pushed to the repository for persistence.">Token Management</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="ADXDK19199"></a><div class="props_rev_3"><a id="GUID-0A974367-AA47-40B2-A558-625A6BF3CE11" name="GUID-0A974367-AA47-40B2-A558-625A6BF3CE11"></a><h4 id="ADXDK-GUID-0A974367-AA47-40B2-A558-625A6BF3CE11" class="sect4">Binary XML Decoding</h4>
                  <div>
                     <p>The binary XML decoder converts binary XML to XML infoset. The decoder is created from the <code class="codeph">BinXMLStream</code>; it reads binary XML from this stream and outputs SAX events or provide a pull style <code class="codeph">InfosetReader</code> API for reading the decoded XML.
                     </p>
                     <p>If an XML schema is associated with the <code class="codeph">BinXMLStream</code>, the binary XML decoder retrieves the associated schema object from the vocabulary cache, using the vocabulary id before decoding. If the schema is not available in the vocabulary cache and the connection information to the server is available, then the schema is fetched from the server.
                     </p>
                     <p>If no schema is associated with <code class="codeph">BinXMLStream</code>, then the token definitions can be either inline in the <code class="codeph">BinXMLStream</code> or stored in a token set. If tokens of a corresponding namespace are not stored in the local vocabulary cache, then the token set is fetched from the repository. 
                     </p>
                  </div>
               </div>
            </div><a id="ADXDK19200"></a><div class="props_rev_3"><a id="GUID-4B039190-876F-4A6A-8562-7E73AF36F40F" name="GUID-4B039190-876F-4A6A-8562-7E73AF36F40F"></a><h3 id="ADXDK-GUID-4B039190-876F-4A6A-8562-7E73AF36F40F" class="sect3">Binary XML Vocabulary Management</h3>
               <div>
                  <p>The binary XML processors are of different types depending on where the metadata (schema or token sets) are located—either local binary XML processor or repository binary XML processor.</p>
               </div><a id="ADXDK19201"></a><div class="props_rev_3"><a id="GUID-7AD473C7-8966-4C17-AF64-7865D70FC486" name="GUID-7AD473C7-8966-4C17-AF64-7865D70FC486"></a><h4 id="ADXDK-GUID-7AD473C7-8966-4C17-AF64-7865D70FC486" class="sect4">Schema Management</h4>
                  <div>
                     <p>For metadata persistence, Oracle recommends that you use the DB Binary XML processor. In this case, schemas and token sets are registered with the database. The vocabulary manager fetches the schema or token sets from the database and cache it in the local vocabulary cache for encoding and decoding.</p>
                     <p>If you must use a persistent metadata repository that is not a database, you can plug in your own metadata repository. You must implement the interface for communicating with this repository, <code class="codeph">BinXMLMetadataProvider</code>.
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="using-binary-XML-with-Java.html#GUID-04F717C4-91CC-472B-99FB-38F133F80797" title="A binary XML processor can communicate with the database for various types of binary XML operations involving storage and retrieval of binary XML schemas, token sets, and binary XML streams.">Binary XML</a></li>
                        </ul>
                     </div>
                  </div>
                  <a id="ADXDK19202"></a><div class="props_rev_3"><a id="GUID-7F2B4014-6718-47F1-989E-C5F1493B2B81" name="GUID-7F2B4014-6718-47F1-989E-C5F1493B2B81"></a><h5 id="ADXDK-GUID-7F2B4014-6718-47F1-989E-C5F1493B2B81" class="sect5">Schema Registration for Binary XML Vocabulary Management</h5>
                     <div>
                        <p>Register XML schemas locally with the local binary XML processor. It contains a vocabulary manager that maintains all XML schemas submitted by a user for the duration of its existence. The vocabulary manager associated with a local binary XML processor does not provide for XML schema persistence.</p>
                        <p>If you register the same XML schema again (same schema location and same target namespace) then it is not parsed, and the existing vocabulary identifier is returned. </p>
                        <p>If a new XML schema with the same target namespace and a different schema location is registered, then the existing XML schema definition is augmented with the new schema definitions. In case of conflict, an error is raised.</p>
                     </div>
                  </div><a id="ADXDK19203"></a><div class="props_rev_3"><a id="GUID-AE236BD0-59D1-40C9-A1B3-A9C3EE0B5641" name="GUID-AE236BD0-59D1-40C9-A1B3-A9C3EE0B5641"></a><h5 id="ADXDK-GUID-AE236BD0-59D1-40C9-A1B3-A9C3EE0B5641" class="sect5">Schema Identification</h5>
                     <div>
                        <p>Each schema is identified by a vocabulary id. The vocabulary id is in the scope of the processor and is unique within the processor. Any document that validates with a schema is required to validate with a latest version of the schema.</p>
                     </div>
                  </div><a id="ADXDK19204"></a><div class="props_rev_3"><a id="GUID-2A575201-65AD-4DF9-B655-6A42BEF25610" name="GUID-2A575201-65AD-4DF9-B655-6A42BEF25610"></a><h5 id="ADXDK-GUID-2A575201-65AD-4DF9-B655-6A42BEF25610" class="sect5">Schema Annotations</h5>
                     <div>
                        <p>Binary XML Schema annotations can appear only within element <code class="codeph">&lt;xsd:appInfo&gt;</code> in an XML schema. The vocabulary manager interprets user-level and system-level annotations during XML schema registration. All other schema annotations, such as database-related annotations, are ignored.
                        </p>
                     </div>
                  </div><a id="ADXDK19205"></a><div class="props_rev_3"><a id="GUID-40702A1D-8D84-4ACF-9872-338FF4FFC442" name="GUID-40702A1D-8D84-4ACF-9872-338FF4FFC442"></a><h5 id="ADXDK-GUID-40702A1D-8D84-4ACF-9872-338FF4FFC442" class="sect5">User-Level Annotations</h5>
                     <div>
                        <p>User-level annotations are specified by a user before registration.</p>
                        <p><code class="codeph">encodingType</code>—This annotation can be used within a <code class="codeph">xsd:element</code>, <code class="codeph">xsd:attribute</code> or <code class="codeph">xsd:simpleType</code> elements. It indicates the data type to be used for encoding the node value of the element or attribute. For strings, there is support only for 8-bit encoding of Unicode (UTF-8) encoding in this release.
                        </p>
                     </div>
                  </div><a id="ADXDK19206"></a><div class="props_rev_3"><a id="GUID-EB8A2CDF-E1D0-4834-A43C-AC4EBCC0AD0E" name="GUID-EB8A2CDF-E1D0-4834-A43C-AC4EBCC0AD0E"></a><h5 id="ADXDK-GUID-EB8A2CDF-E1D0-4834-A43C-AC4EBCC0AD0E" class="sect5">System-Level Annotations</h5>
                     <div>
                        <p>The vocabulary manager adds system-level annotations at the time of registration. You cannot overwrite them.</p>
                     </div>
                  </div>
               </div><a id="ADXDK19207"></a><div class="props_rev_3"><a id="GUID-64183150-1F23-48A4-A1E8-81A0CD512429" name="GUID-64183150-1F23-48A4-A1E8-81A0CD512429"></a><h4 id="ADXDK-GUID-64183150-1F23-48A4-A1E8-81A0CD512429" class="sect4">Token Management</h4>
                  <div>
                     <p>Token sets can be fetched from the database or metadata repository, cached in the local vocabulary manager, and used for decoding. While encoding, token sets can be pushed to the repository for persistence. </p>
                     <p>Token definitions can also be included as part of the binary XML stream by setting a flag on the encoder.</p>
                  </div>
               </div>
            </div><a id="ADXDK19208"></a><div class="props_rev_3"><a id="GUID-AE12DDC0-142D-4742-8BE8-0F5557781F4F" name="GUID-AE12DDC0-142D-4742-8BE8-0F5557781F4F"></a><h3 id="ADXDK-GUID-AE12DDC0-142D-4742-8BE8-0F5557781F4F" class="sect3">Using the Java Binary XML Package</h3>
               <div>
                  <p>Use of the binary XML package is described.</p>
                  <div class="section">
                     <p>A <code class="codeph">BinXMLStream</code> class represents the binary XML stream. The different storage locations defined for the binary XML stream are:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">InputStream</code>—stream for reading.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">OutputStream</code>—stream for writing.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">URL</code>—stream for reading.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">File</code>—stream for read and write.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">BLOB</code>—stream for reading and writing.
                           </p>
                        </li>
                        <li>
                           <p>Byte array—stream for reading and writing.</p>
                        </li>
                        <li>
                           <p>In memory—stream for reading and writing.</p>
                        </li>
                     </ul>
                     <p>The <code class="codeph">BinXMLStream</code> object specifies the type of storage during creation.
                     </p>
                     <p>A <code class="codeph">BinXMLStream</code> object can be created from a <code class="codeph">BinXMLProcessor</code> factory. This factory can be initialized with a JDBC connection (for remote metadata access), connection pool, URL or a <code class="codeph">PageManagerPool</code> (for lazy in-memory storage). <code class="codeph">BinXMLEncoder</code> and <code class="codeph">BinXMLDecoder</code> can be created from the <code class="codeph">BinXMLStream</code> for encoding or decoding.
                     </p>
                     <p>Here is an example of creating a processor without a repository, registering a schema, encoding XML SAX events into schema-aware binary format, and storing in a file:</p><pre class="pre codeblock"><code>BinXMLProcessor  proc = BinXMLProcessorFactory.createProcessor();
proc.registerSchema(schemaURL);
BinXMLStream outbin = proc.createBinaryStream(outFile);
BinXMLEncoder enc = outbin.getEncoder();
enc.setSchemaAware(true);
ContentHandler hdlr = enc.getContentHandler();
</code></pre><p>In addition to getting the <code class="codeph">ContentHandler</code>, you can also get the other handlers, such as:
                     </p><pre class="pre codeblock"><code>LexicalHandler lexhdlr = enc.getLexicalHandler();
DTDHandler dtdhdlr = encenc.getDTDHandler();
DeclHandler declhdlr = enc.getDeclHandler();
ErrorHandler errhdlr = enc.getErrorHandler();
</code></pre><p>Use <code class="codeph">hdlr</code> in the application that generates the SAX events.
                     </p>
                     <p>2. Here is an example of creating a processor with a database repository, decoding a schema-aware binary stream and reading the decoded XML using pull API. The schema is fetched from the database repository for decoding.</p><pre class="pre codeblock"><code>DBBinXMLMetadataProvider dbrep = 
     BinXMLMetadataProviderFactory.createDBMetadataProvider();
BinXMLProcessor proc = BinXMLProcessorFactory.createProcessor(dbrep);
BinXMLStream inpbin = proc.createBinaryStream(blob);
BinXMLDecoder dec = inpbin.getDecoder();
InfosetReader xmlreader = dec.getReader();
</code></pre><p>Use <code class="codeph">xmlreader</code> to read XML in a pull-style from the decoder.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADXDK19209"></a><div class="props_rev_3"><a id="GUID-E442D9A0-CB3A-4CFF-8A39-B7A2F673C3E2" name="GUID-E442D9A0-CB3A-4CFF-8A39-B7A2F673C3E2"></a><h4 id="ADXDK-GUID-E442D9A0-CB3A-4CFF-8A39-B7A2F673C3E2" class="sect4">Binary XML Encoder</h4>
                  <div>
                     <p>The encoder takes XML input, which is parsed and read using SAX events, and outputs binary XML.</p>
                  </div><a id="ADXDK19210"></a><div class="props_rev_3"><a id="GUID-A06592C1-D899-479A-ABF6-4759C88478AD" name="GUID-A06592C1-D899-479A-ABF6-4759C88478AD"></a><h5 id="ADXDK-GUID-A06592C1-D899-479A-ABF6-4759C88478AD" class="sect5">Schema-Less Option</h5>
                     <div>
                        <p>You can specify the schema-aware or the schema-less option before encoding. The default is schema-less encoding.</p>
                        <p>If the schema-aware option is set, then the encoding is done based on schema(s) specified in the instance document. The annotated schemas used for encoding are also required at the time of decoding. If the schema-less option is specified, then the encoding is independent of schemas, but the tokens are inline by default. To override the default, set <code class="codeph">Inline-token = false.</code></p>
                     </div>
                  </div><a id="ADXDK19212"></a><a id="ADXDK19211"></a><div class="props_rev_3"><a id="GUID-66597AC6-1E3A-435E-AFE9-29CCD2458C71" name="GUID-66597AC6-1E3A-435E-AFE9-29CCD2458C71"></a><h5 id="ADXDK-GUID-66597AC6-1E3A-435E-AFE9-29CCD2458C71" class="sect5">Inline-Token Option</h5>
                     <div>
                        <p>You can set an option to create a binary XML stream with inline token definitions before encoding. If inlining is turned off then you must ensure that the encoder or decoder processors use the same metadata repository. By default, token definition is inline.</p>
                        <p>Flag <code class="codeph">Inline-token</code> is ignored if the schema-aware option is turned on. 
                        </p>
                        <div class="figure" id="GUID-66597AC6-1E3A-435E-AFE9-29CCD2458C71__GUID-0473E5AF-D727-4FDB-B634-E653BABF6C8A">
                           <p class="titleinfigure">Figure 13-1 Binary XML Encoding</p><img src="img/adxdk124.gif" width="363" alt="Description of Figure 13-1 follows" title="Description of Figure 13-1 follows" longdesc="img_text/adxdk124.html"><br><a href="img_text/adxdk124.html">Description of "Figure 13-1 Binary XML Encoding"</a></div>
                        <!-- class="figure" -->
                     </div>
                  </div>
               </div><a id="ADXDK19214"></a><a id="ADXDK19213"></a><div class="props_rev_3"><a id="GUID-F090EAE2-F039-4787-B91E-D9047AF88270" name="GUID-F090EAE2-F039-4787-B91E-D9047AF88270"></a><h4 id="ADXDK-GUID-F090EAE2-F039-4787-B91E-D9047AF88270" class="sect4">Binary XML Decoder</h4>
                  <div>
                     <p>The binary XML decoder takes a binary XML stream as input and generates SAX Events as output, or it provides a pull interface to read the decoded XML. For an XML schema-aware binary XML stream, the binary XML decoder interacts with the vocabulary manager to extract the schema information.</p>
                     <p>If the vocabulary manager does not contain the required schema, and the processor is of type binary XML with a valid JDBC connection, then the remote schema is fetched from the database or the metadata repository based on the vocabulary id in the binary XML stream to be decoded. Similarly, the set of token definitions can be fetched from the database or the metadata repository.</p>
                     <div class="figure" id="GUID-F090EAE2-F039-4787-B91E-D9047AF88270__GUID-912C510F-EECF-4294-86E4-7C4F8FCD2DA6">
                        <p class="titleinfigure">Figure 13-2 Binary XML Decoder</p><img src="img/adxdk123.gif" width="336" alt="Description of Figure 13-2 follows" title="Description of Figure 13-2 follows" longdesc="img_text/adxdk123.html"><br><a href="img_text/adxdk123.html">Description of "Figure 13-2 Binary XML Decoder"</a></div>
                     <!-- class="figure" -->
                  </div>
               </div><a id="ADXDK19215"></a><div class="props_rev_3"><a id="GUID-04807B10-06DE-42E6-933B-68F2BB738E2A" name="GUID-04807B10-06DE-42E6-933B-68F2BB738E2A"></a><h4 id="ADXDK-GUID-04807B10-06DE-42E6-933B-68F2BB738E2A" class="sect4">Schema Registration Overview</h4>
                  <div>
                     <p>You register an XML schema with the Binary XML Processor. The schema is a text file that can contain user-level annotations. As part of the registration process, the processor adds system-level annotations. The resulting annotated schema is then processed by the Schema Builder to build an XML schema object.</p>
                     <p>This XML schema object is stored in the vocabulary cache. The vocabulary cache assigns a unique vocabulary id for each XML schema object, which is returned as output. The annotated DOM representation of the XML schema is sent to the binary XML encoder.</p>
                  </div>
               </div><a id="ADXDK19216"></a><div class="props_rev_3"><a id="GUID-E5DBDA35-6C90-4FED-BF1E-5CEF2D6428BF" name="GUID-E5DBDA35-6C90-4FED-BF1E-5CEF2D6428BF"></a><h4 id="ADXDK-GUID-E5DBDA35-6C90-4FED-BF1E-5CEF2D6428BF" class="sect4">Resolving xsi:schemaLocation</h4>
                  <div>
                     <p>How <code class="codeph">xsi:schemaLocation</code> is resolved is described.
                     </p>
                     <p>During encoding, if <code class="codeph">schemaAware</code> is true and the property <code class="codeph">ImplcitSchemaRegistration</code> is <code class="codeph">true</code>, then the first <code class="codeph">xsi:schemaLocation</code> tag present in the root element of an XML instance document automatically registers that schema in the local vocabulary manager. No other <code class="codeph">schemaLocation</code> tags are explicitly registered. If the processor is database-oriented then the schema is also registered in the database; similarly for any metadata repository based processor.
                     </p>
                     <p>If the encoding is set to <code class="codeph">schemaAware</code> is <code class="codeph">false</code> or <code class="codeph">ImplcitSchemaRegistration</code> is <code class="codeph">false</code>, then all <code class="codeph">xsi:schemaLocation</code> tags are ignored by the encoder.
                     </p>
                  </div>
               </div><a id="ADXDK19217"></a><div class="props_rev_3"><a id="GUID-04F717C4-91CC-472B-99FB-38F133F80797" name="GUID-04F717C4-91CC-472B-99FB-38F133F80797"></a><h4 id="ADXDK-GUID-04F717C4-91CC-472B-99FB-38F133F80797" class="sect4">Binary XML</h4>
                  <div>
                     <p>A binary XML processor can communicate with the database for various types of binary XML operations involving storage and retrieval of binary XML schemas, token sets, and binary XML streams. </p>
                     <p>A <code class="codeph">DBBinXMLMetadataProvider</code> object is either instantiated with a dedicated JDBC connection or a connection pool to access vocabulary information such as schema and token set. The processor is also associated with one or more data connections to access XML data.
                     </p>
                     <p>Database communication is involved in these ways:</p>
                     <ol>
                        <li>
                           <p>Extracting compiled binary XML schema using the vocabulary ID or the schema URL</p>
                           <p>To retrieve a compiled binary XML schema for encoding, the database is queried based on the schema URL. For decoding the binary XML schema, fetch it from the database based on the vocabulary ID.</p>
                        </li>
                        <li>
                           <p>Storing noncompiled binary XML schema using the schema URL and retrieving the vocabulary id.</p>
                           <p>When the <code class="codeph">xsi:schemaLocation</code> tag is encountered during encoding, the schema is registered in the database for persistent storage in the database. The vocabulary id associated with the schema, and the binary version of the compiled schema is retrieved from the database; the compiled schema object is built and stored in the local cache using the vocabulary id returned from the database.
                           </p>
                        </li>
                        <li>
                           <p>Retrieving a binary token set using namespace URL.</p>
                           <p>If a binary stream to be decoded is associated with token tables for decoding, these are fetched from the database using the metadata connection.</p>
                        </li>
                        <li>
                           <p>Storing binary token set using namespace URL</p>
                           <p>If the XML text has been encoded without a schema, then it produces a token set of token definitions. These token tables can be stored persistently in the database. The metadata connection is used for transferring the token set to the database.</p>
                        </li>
                        <li>
                           <p>Binary XML stream with remote storage option</p>
                           <p>It is your responsibility to create a table containing an <code class="codeph">XMLType</code> column with binary XML for storing the result of encoding and retrieving the binary XML for decoding. Communication with the database can be achieved with Oracle Net Services and JDBC. Fetch the <code class="codeph">XMLType</code> object from the output result set of the JDBC query. The <code class="codeph">BinXMLStream</code> for reading the binary data or for writing out binary data can be created from the <code class="codeph">XMLType</code> object. The <code class="codeph">XMLType</code> class must be extended to support reading and writing of binary XML data.
                           </p>
                        </li>
                     </ol>
                  </div>
               </div><a id="ADXDK19218"></a><div class="props_rev_3"><a id="GUID-8ED117C9-5082-4C23-AF00-7F0AB6C951ED" name="GUID-8ED117C9-5082-4C23-AF00-7F0AB6C951ED"></a><h4 id="ADXDK-GUID-8ED117C9-5082-4C23-AF00-7F0AB6C951ED" class="sect4">Persistent Storage of Metadata</h4>
                  <div>
                     <p>You can provide persistent back-end storage for metadata.</p>
                     <p>A local vocabulary manager and cache stores metadata information in memory for the life of the <code class="codeph">BinXMLProcessor</code>. You can plug in your own back-end storage for metadata by implementing interface <code class="codeph">BinXMLMetadataProvider</code> and plugging it into the <code class="codeph">BinXMLProcessor</code>. Currently only one metadata provider for each processor is supported.
                     </p>
                     <p>You must code a <code class="codeph">FileBinXMLMetadataProvider</code> that implements interface <code class="codeph">BinXMLMetadataProvider</code>. The encoder and decoder uses these APIs to access metadata from the persisted back-end storage. Set up the configuration information for the persistent storage: for example, root directory for a file system in <code class="codeph">FileBinXMLMetadataProvider</code> class. Instantiate <code class="codeph">FileBinXMLMetadataProvider</code> and plug it into the <code class="codeph">BinXMLProcessor</code>.
                     </p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>