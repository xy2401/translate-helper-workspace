<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Oracle Sharding is integrated with Oracle Database replication technologies for high availability and disaster recovery at the shard level.">
      <meta name="description" content="Oracle Sharding is integrated with Oracle Database replication technologies for high availability and disaster recovery at the shard level.">
      <title>Shard-Level High Availability</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Using Oracle Sharding">
      <meta property="og:description" content="Oracle Sharding is integrated with Oracle Database replication technologies for high availability and disaster recovery at the shard level.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Using Oracle Sharding">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="using-oracle-sharding.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-14T12:19:13-08:00">
      <meta name="dcterms.title" content="Using Oracle Sharding">
      <meta name="dcterms.dateCopyrighted" content="2018, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E87088-04">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="sharding-data-routing.html" title="Previous" type="text/html">
      <link rel="next" href="sharding-deployment.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="SHARD">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="sharding-data-routing.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="sharding-deployment.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Using Oracle Sharding</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Shard-Level High Availability</li>
            </ol>
            <a id="GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6" name="GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6"></a>
            
            <h2 id="SHARD-GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6" class="sect2"><span class="enumeration_chapter">7 </span>Shard-Level High Availability
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Sharding is integrated with Oracle Database replication technologies for high availability and disaster recovery at the shard level.</p>
               <p>The following topics describe how to use Oracle’s replication technologies to make your sharded databases highly available:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="sharding-high-availability.html#GUID-133A4C15-FCD5-46E3-B33B-0DB3EBE54064">About Sharding and Replication</a><br>Oracle Sharding is tightly integrated with the Oracle replication and disaster recovery technologies Oracle Data Guard and Oracle GoldenGate.
                  </li>
                  <li class="ulchildlink"><a href="sharding-high-availability.html#GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB">Using Oracle Data Guard with a Sharded Database</a><br>Oracle Data Guard replication maintains one or more synchronized copies (standbys) of a shard (the primary) for high availability and data protection. Standbys may be deployed locally or remotely, and when using Oracle Active Data Guard can also be open for read-only access.
                  </li>
                  <li class="ulchildlink"><a href="sharding-high-availability.html#GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72">Using Oracle GoldenGate with a Sharded Database</a><br>Oracle GoldenGate is used for fine-grained active-active replication where all shards are writable, and each shard can be partially replicated to other shards within a shardgroup.
                  </li>
               </ul>
            </div>
            
            <div class="sect2"><a id="GUID-133A4C15-FCD5-46E3-B33B-0DB3EBE54064" name="GUID-133A4C15-FCD5-46E3-B33B-0DB3EBE54064"></a><h3 id="SHARD-GUID-133A4C15-FCD5-46E3-B33B-0DB3EBE54064" class="sect3"><span class="enumeration_section">7.1 </span>About Sharding and Replication
               </h3>
               <div>
                  <p>Oracle Sharding is tightly integrated with the Oracle replication and disaster recovery technologies Oracle Data Guard and Oracle GoldenGate.</p>
                  <p>Replication provides high availability, disaster recovery, and additional scalability for reads. A unit of replication can be a shard, a part of a shard, or a group of shards.</p>
                  <p>Replication topology in a sharded database is declaratively specified using GDSCTL command syntax. You can choose one of two technologies—Oracle Data Guard or Oracle GoldenGate—to replicate your data. Oracle Sharding automatically deploys the specified replication topology and enables data replication. </p>
                  <p>The availability of a sharded database is not affected by an outage or slowdown of one or more shards. Replication is used to provide individual shard-level high availability (Oracle Active Data Guard or Oracle GoldenGate). Replication is automatically configured and deployed when the sharded database is created. Optionally, you can use Oracle RAC for shard-level high availability, complemented by replication, to maintain shard-level data availability in the event of a cluster outage. Oracle Sharding automatically fails over database connections from a shard to its replica in the event of an unplanned outage.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="sharding-high-availability.html#GUID-E65AA060-0C3D-4F4F-BE9F-4BF1FD3967FB">When To Choose Oracle GoldenGate for Shard High Availability</a><br>When should Oracle GoldenGate be employed as your high availablility solution for Oracle Sharding?
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="sharding-high-availability.html#GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6" title="Oracle Sharding is integrated with Oracle Database replication technologies for high availability and disaster recovery at the shard level.">Shard-Level High Availability</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-E65AA060-0C3D-4F4F-BE9F-4BF1FD3967FB" name="GUID-E65AA060-0C3D-4F4F-BE9F-4BF1FD3967FB"></a><h4 id="SHARD-GUID-E65AA060-0C3D-4F4F-BE9F-4BF1FD3967FB" class="sect4"><span class="enumeration_section">7.1.1 </span>When To Choose Oracle GoldenGate for Shard High Availability
                  </h4>
                  <div>
                     <p>When should Oracle GoldenGate be employed as your high availablility solution for Oracle Sharding?</p>
                     <p>Oracle GoldenGate should be your preferred high availability solution in the following cases:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>All shards read-write.&nbsp;With Active Data Guard the DR/backup shards are read-only.</p>
                        </li>
                        <li>
                           <p>More flexibility in deploying shards.&nbsp;Each shard can be on a different operating system or a different database version.</p>
                        </li>
                        <li>
                           <p>More than a single updatable copy of the data, even within a single shardgroup.&nbsp;For example, with Oracle GoldenGate, using the replication factor of 4, you can have 4 read-write copies of the data that can be updated.</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-E65AA060-0C3D-4F4F-BE9F-4BF1FD3967FB__GUID-492E63F2-8CAD-46E6-AE8F-3CC58ADEDA05">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/shard&amp;id=GGSAU-GUID-2C059382-7753-4EFA-B313-A6E0DAF7EA1C" target="_blank">Working with Oracle GoldenGate Sharding</a> in the Fusion Middleware <span class="italic">Using the Oracle GoldenGate Microservices Architecture</span> guide for more information about using Oracle GoldenGate with Oracle Sharding.
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="sharding-high-availability.html#GUID-133A4C15-FCD5-46E3-B33B-0DB3EBE54064" title="Oracle Sharding is tightly integrated with the Oracle replication and disaster recovery technologies Oracle Data Guard and Oracle GoldenGate.">About Sharding and Replication</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB" name="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB"></a><h3 id="SHARD-GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB" class="sect3"><span class="enumeration_section">7.2 </span>Using Oracle Data Guard with a Sharded Database
               </h3>
               <div>
                  <p>Oracle Data Guard replication maintains one or more synchronized copies (standbys) of a shard (the primary) for high availability and data protection. Standbys may be deployed locally or remotely, and when using Oracle Active Data Guard can also be open for read-only access.</p>
                  <p>Oracle Data Guard can be used as the replication technology for sharded databases using the system-managed, user-defined, or composite method of sharding.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-79D148A4-A50E-4C08-A50C-64D86AFBF196">Using Oracle Data Guard with a System-Managed Sharded Database</p>
                     <p>In system-managed and composite sharding, the logical unit of replication is a group of shards called a <span class="italic">shardgroup</span>. In system-managed sharding, a shardgroup contains all of the data stored in the sharded database. The data is sharded by consistent hash across shards that make up the shardgroup. Shards that belong to a shardgroup are usually located in the same data center. An entire shardgroup can be fully replicated to one or more shardgroups in the same or different data centers.
                     </p>
                     <p>The following figure illustrates how Data Guard replication is used with system-managed sharding. In the example in the figure there is a primary shardgroup, Shardgroup 1, and two standby shardgroups, Shardgroup 2 and Shardgroup 3. Shardgroup 1 consists of Data Guard primary databases (shards 1-3). Shardgroup 2 consists of local standby databases (shards 4-6) which are located in the same datacenter and configured for synchronous replication. And Shardgroup 3 consists of remote standbys (shards 7-9) located in a different datacenter and configured for asynchronous replication. Oracle Active Data Guard is enabled in this configuration, so each standby is open read-only.</p>
                     <div class="figure" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-821EC77F-6FBE-4142-A165-2AD1328EF293">
                        <p class="titleinfigure">Figure 7-1 System-Managed Sharding with Data Guard Replication</p><img src="img/admin_3v_136a.png" alt="Description of Figure 7-1 follows" title="Description of Figure 7-1 follows" longdesc="img_text/admin_3v_136a.html"><br><a href="img_text/admin_3v_136a.html">Description of "Figure 7-1 System-Managed Sharding with Data Guard Replication"</a></div>
                     <!-- class="figure" -->
                     <p>The concept of shardgroup as a logical unit of replication hides from the user the implementation details of replication. With Data Guard, replication is done at the shard (database) level. The sharded database in the figure above consists of three sets of replicated shards: {1, 4, 7}, {2, 5, 8} and {3, 6, 9}. Each set of replicated shards is managed as a Data Guard Broker configuration with fast-start failover (FSFO) enabled.</p>
                     <p>To deploy replication, specify the properties of the shardgroups (region, role, and so on) and add shards to them. Oracle Sharding automatically configures Data Guard and starts an FSFO observer for each set of replicated shards. It also provides load balancing of the read-only workload, role based global services and replication lag, and locality based routing.</p>
                     <p>Run the following GDSCTL commands to deploy the example configuration shown in the figure above.</p><pre class="pre codeblock"><code>CREATE SHARDCATALOG &#x2013;database host00:1521:shardcat &#x2013;region dc1,dc2

ADD GSM -gsm gsm1 -listener 1571 &#x2013;catalog host00:1521:shardcat &#x2013;region dc1
ADD GSM -gsm gsm2 -listener 1571 &#x2013;catalog host00:1521:shardcat &#x2013;region dc2
START GSM -gsm gsm1
START GSM -gsm gsm2

ADD SHARDGROUP -shardgroup shardgroup1 -region dc1 -deploy_as primary 
ADD SHARDGROUP -shardgroup shardgroup2 -region dc1 -deploy_as active_standby 
ADD SHARDGROUP -shardgroup shardgroup3 -region dc2 -deploy_as active_standby 

CREATE SHARD -shardgroup shardgroup1 -destination host01 -credential oracle_cred 
CREATE SHARD -shardgroup shardgroup1 -destination host02 -credential oracle_cred 
CREATE SHARD -shardgroup shardgroup1 -destination host03 -credential oracle_cred 
...
CREATE SHARD -shardgroup shardgroup3  -destination host09 -credential oracle_cred

DEPLOY</code></pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-0C743452-E7C3-485A-82B1-24B5204139D8">Using Oracle Data Guard with a User-Defined Sharded Database</p>
                     <p>With user-defined sharding the logical (and physical) unit of replication is a shard. Shards are not combined into shardgroups. Each shard and its replicas make up a <span class="italic">shardspace</span> which corresponds to a single Data Guard Broker configuration. Replication can be configured individually for each shardspace. Shardspaces can have different numbers of standbys which can be located in different data centers. An example of user-defined sharding with Data Guard replication is shown in the following figure.
                     </p>
                     <div class="figure" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-657DD600-76BF-4F95-B211-BCF9C798B572">
                        <p class="titleinfigure">Figure 7-2 User-Defined Sharding with Data Guard Replication</p><img src="img/admin_3v_135a.png" alt="Description of Figure 7-2 follows" title="Description of Figure 7-2 follows" longdesc="img_text/admin_3v_135a.html"><br><a href="img_text/admin_3v_135a.html">Description of "Figure 7-2 User-Defined Sharding with Data Guard Replication"</a></div>
                     <!-- class="figure" -->
                     <p>Run the following GDSCTL commands to deploy the example user-defined sharded database with Data Guard replication shown in the figure above.</p><pre class="pre codeblock"><code>CREATE SHARDCATALOG -sharding user &#x2013;database host00:1521:cat &#x2013;region dc1,dc2,dc3

ADD GSM -gsm gsm1 -listener 1571 &#x2013;catalog host00:1521:cat &#x2013;region dc1
ADD GSM -gsm gsm2 -listener 1571 &#x2013;catalog host00:1521:cat &#x2013;region dc2
ADD GSM -gsm gsm3 -listener 1571 &#x2013;catalog host00:1521:cat &#x2013;region dc3
START GSM -gsm gsm1
START GSM -gsm gsm2
START GSM -gsm gsm3

ADD SHARDSPACE -shardspace shardspace_a 
ADD SHARDSPACE -shardspace shardspace_b
ADD SHARDSPACE -shardspace shardspace_c

CREATE SHARD -shardspace shardspace_a &#x2013;region dc1 -deploy_as primary  -destination 
host01 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rsp

CREATE SHARD -shardspace shardspace_a &#x2013;region dc1 -deploy_as standby  -destination 
host04 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rsp

CREATE SHARD -shardspace shardspace_a &#x2013;region dc2 -deploy_as standby  -destination 
host06 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rsp

CREATE SHARD -shardspace shardspace_a &#x2013;region dc3 -deploy_as standby  -destination 
host08 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rsp

CREATE SHARD -shardspace shardspace_b &#x2013;region dc1 -deploy_as primary  -destination 
host08 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rs
...

CREATE SHARD -shardspace shardspace_c &#x2013;region dc3 -deploy_as standby  -destination 
host10 -credential oracle_cred -netparamfile /home/oracle/netca_dbhome.rsp

DEPLOY</code></pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-DF0FF1E2-B6A1-4E5E-8DC6-65A32DF948B7">Using Oracle Data Guard with a Composite Sharded Database</p>
                     <p>In composite sharding, similar to user-defined sharding, a sharded database consists of multiple shardspaces. However, each shardspace, instead of replicated shards, contains replicated shardgroups.</p>
                     <div class="figure" id="GUID-52E55FFE-2AF7-45B0-B29A-6664D6CB78AB__GUID-CC41C14B-41D0-4AD6-8668-86F6B1390D14">
                        <p class="titleinfigure">Figure 7-3 Composite Sharding with Data Guard Replication</p><img src="img/admin_3v_133c.png" alt="Description of Figure 7-3 follows" title="Description of Figure 7-3 follows" longdesc="img_text/admin_3v_133c.html"><br><a href="img_text/admin_3v_133c.html">Description of "Figure 7-3 Composite Sharding with Data Guard Replication"</a></div>
                     <!-- class="figure" -->
                     <p>Run the following GDSCTL commands to deploy the example configuration shown in the previous figure.</p><pre class="pre codeblock"><code>CREATE SHARDCATALOG -sharding composite &#x2013;database host00:1521:cat &#x2013;region dc1,dc2,dc3

ADD GSM -gsm gsm1 -listener 1571 &#x2013;catalog host00:1521:cat &#x2013;region dc1
ADD GSM -gsm gsm2 -listener 1571 &#x2013;catalog host00:1521:cat &#x2013;region dc2
ADD GSM -gsm gsm3 -listener 1571 &#x2013;catalog host00:1521:cat &#x2013;region dc3
START GSM -gsm gsm1
START GSM -gsm gsm2
START GSM -gsm gsm3

ADD SHARDSPACE -shardspace shardspace_a 
ADD SHARDSPACE -shardspace shardspace_b

ADD SHARDGROUP -shardgroup shardgroup_a1 &#x2013;shardspace shardspace_a -region dc1 
-deploy_as primary 
ADD SHARDGROUP -shardgroup shardgroup_a2 &#x2013;shardspace shardspace_a -region dc1     
-deploy_as active_standby
ADD SHARDGROUP -shardgroup shardgroup_a3 &#x2013;shardspace shardspace_a -region dc3     
-deploy_as active_standby 
ADD SHARDGROUP -shardgroup shardgroup_b1 &#x2013;shardspace shardspace_b -region dc1 
-deploy_as primary 
ADD SHARDGROUP -shardgroup shardgroup_b2 &#x2013;shardspace shardspace_b -region dc1     
-deploy_as active_standby 
ADD SHARDGROUP -shardgroup shardgroup_b3 &#x2013;shardspace shardspace_b -region dc2     
-deploy_as active_standby 

CREATE SHARD -shardgroup shardgroup_a1 -destination host01 &#x2013;credential orcl_cred  
...

CREATE SHARD -shardgroup shardgroup_b3 -destination host09 -credential orcl_cred 

DEPLOY</code></pre></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="sharding-high-availability.html#GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6" title="Oracle Sharding is integrated with Oracle Database replication technologies for high availability and disaster recovery at the shard level.">Shard-Level High Availability</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72" name="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72"></a><h3 id="SHARD-GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72" class="sect3"><span class="enumeration_section">7.3 </span>Using Oracle GoldenGate with a Sharded Database
               </h3>
               <div>
                  <p>Oracle GoldenGate is used for fine-grained active-active replication where all shards are writable, and each shard can be partially replicated to other shards within a shardgroup.</p>
                  <p>In Oracle GoldenGate, replication is handled at the chunk level. For example, in Shardgroup 1 in the following figure, half of the data stored in each shard is replicated to one shard, and the other half to another shard. If any shard becomes unavailable, its workload is split between two other shards in the shardgroup. The multiple failover destinations mitigate the impact of a shard failure because there is no single shard that has to handle all of the workload from the failed shard.</p>
                  <div class="figure" id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72__SYSTEM-MANAGEDSHARDINGWITHGOLDENGAT-A0EF952D">
                     <p class="titleinfigure">Figure 7-4 System-Managed Sharding with Golden Gate Replication</p><img src="img/admin_3v_137a.png" alt="Description of Figure 7-4 follows" title="Description of Figure 7-4 follows" longdesc="img_text/admin_3v_137a.html"><br><a href="img_text/admin_3v_137a.html">Description of "Figure 7-4 System-Managed Sharding with Golden Gate Replication"</a></div>
                  <!-- class="figure" -->
                  <p>With Oracle GoldenGate replication, a shardgroup can contain multiple replicas of each row in a sharded table; therefore, high availability is provided within a shardgroup, and there is no need to have a local replica of the shardgroup, as there is in the case of Data Guard replication. The number of times each row is replicated within a shardgroup is called its <span class="italic">replication factor</span> and is a configurable parameter.
                  </p>
                  <p>To provide disaster recovery, a shardgroup can be replicated to one or more data centers. Each replica of a shardgroup can have a different number of shards, replication factor, database versions, and hardware platforms. However, all shardgroup replicas must have the same number of chunks, because replication is done at the chunk level. </p>
                  <p>Shardgroup 2 in the figure above contains the same data as Shardgroup 1, but resides in a different data center. Shards in both data centers are writable. The default replication factor, 2, is used for both shardgroups.</p>
                  <p>Note that because Shardgroup 2 contains only two shards and the replication factor is 2, the shards are fully replicated, and each of them contains all of the data stored in the sharded database. This means that any query routed to these shards can be executed without going across shards. There is only one failover destination in this shardgroup; if a shard goes down, the load on the other shard doubles.</p>
                  <p>Oracle Sharding is designed to minimize the number of conflicting updates performed to the same row on different shards. This is achieved designating a <span class="italic">master chunk</span> for each range of hash values and routing most of requests for the corresponding data to this chunk. 
                  </p>
                  <p>Sometimes it is impossible to avoid update conflicts because of state transitions, such as a chunk move or split, or a shard going up or down. The user may also intentionally allow conflicts in order to minimize transaction latency. For such cases Oracle GoldenGate provides automatic conflict detection and resolution which handles all kinds of conflicts including insert-delete conflicts.</p>
                  <p>Before creating any shards, there are some prerequisites:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Register with scheduler (when using GDSCTL <code>create shard</code>)
                        </p>
                     </li>
                     <li>
                        <p>Prepare site-security wallets or client and server certificates.</p>
                     </li>
                     <li>
                        <p>Install Oracle GoldenGate and add at least one secure deployment with sharding option, and start up GoldenGate services and servers.</p>
                     </li>
                     <li>
                        <p>In each Oracle home, make a copy of the client wallets used to add GoldenGate deployments, and place it at $ORACLE_BASE/admin/ggshd_wallet/.</p>
                     </li>
                     <li>
                        <p>Load PL/SQL packages from a GoldenGate install home. If you are creating shards using GDSCTL <code class="codeph">CREATE SHARD</code>, this step is only applicable to the shard catalog. If you are using GDSCTL <code class="codeph">ADD SHARD</code>, it applies to the shard catalog and all of the shards.
                        </p>
                     </li>
                  </ul>
                  <p>Run the following GDSCTL commands to deploy an example configuration shown in the figure above.</p><pre class="pre codeblock"><code>CREATE SHARDCATALOG -database host00:1521:shardcat -chunks 60
 -user 'gsmcatuser/<span class="variable" translate="no">gsmcatuser_password</span>' 
 <span class="bold">-repl OGG</span> -sharding system -sdb orasdb
ADD GSM -gsm gsm1 -listener 1571 &#x2013;catalog shard-dir1:1521:shardcat -localons 3841
ADD GSM -gsm gsm2 -listener 1571 &#x2013;catalog shard-dir1:1521:shardcat -localons 3841
START GSM -gsm gsm1
START GSM -gsm gsm2
CONFIGURE -timeout 900
ADD REGION -region dc1
ADD REGION -region dc2
MODIFY GSM -gsm gsm1 -region dc1
MODIFY GSM -gsm gsm2 -region dc2
ADD SHARDGROUP -shardgroup shardgroup1 -region dc1 <span class="bold">-repfactor 2</span> 
ADD SHARDGROUP -shardgroup shardgroup2 -region dc2 <span class="bold">-repfactor 2</span>  


CREATE SHARD -shardgroup shardgroup1 -destination host01 -credential oracle_cred        
 -netparam /home/oracle/netca_dbhome.rsp -gg_service host01:9900/deployment_name
 -gg_password ggadmin_password -dbparamfile /home/oracle/dbparams01.tmp
 -dbtemplatefile /home/oracle/sharddb01.dbt
 
CREATE SHARD -shardgroup shardgroup1 -destination host02 -credential oracle_cred      
 -netparam /home/oracle/netca_dbhome.rsp -gg_service host02:9900/remote_scheduler_agent
 -gg_password ggadmin_password -dbparamfile /home/oracle/dbparams02.tmp
 -dbtemplatefile /home/oracle/sharddb02.dbt 

CREATE SHARD -shardgroup shardgroup1 -destination host03 -credential oracle_cred      
 -netparam /home/oracle/netca_dbhome.rsp -gg_service host03:9900/remote_scheduler_agent
 -gg_password ggadmin_password -dbparamfile /home/oracle/dbparams03.tmp
 -dbtemplatefile /home/oracle/sharddb03.dbt
 
CREATE SHARD -shardgroup shardgroup2  -destination host04 -credential oracle_cred      
-netparam /home/oracle/netca_dbhome.rsp -gg_service host04:9900/remote_scheduler_agent
 -gg_password ggadmin_password -dbparamfile /home/oracle/dbparams04.tmp
 -dbtemplatefile /home/oracle/sharddb04.dbt
 
CREATE SHARD -shardgroup shardgroup2  -destination host05 -credential oracle_cred      
-netparam /home/oracle/netca_dbhome.rsp -gg_service host05:9900/remote_scheduler_agent
 -gg_password ggadmin_password -dbparamfile /home/oracle/dbparams05.tmp
 -dbtemplatefile /home/oracle/sharddb05.dbt


DEPLOY</code></pre><p>Note that the above example uses <code class="codeph">CREATE SHARD</code> to create new shards during deployment. <code class="codeph">ADD SHARD</code> is the alternative to <code class="codeph">CREATE SHARD</code>, and the <code class="codeph">ADD SHARD</code> method assumes the pre-existence of clean slate database instances ready to be converted into database shards.
                  </p>
                  <div class="infoboxnote" id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72__GUID-762C2E8A-0B04-41BD-BE0B-4AF8429320BB">
                     <p class="notep1">Note:</p>
                     <p>Unlike sharding replication with Data Guard or Active Data Guard, you cannot deploy Oracle GoldenGate manually, it must be done using the <code class="codeph">DEPLOY</code> command.
                     </p>
                     <p>Oracle GoldenGate does not support PDBs as shards.</p>
                  </div>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72__GUID-DB192465-74C2-4853-A026-F4A32BAE6C77">
                     <p class="notep1">See Also:</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/shard&amp;id=GGSAU-GUID-2C059382-7753-4EFA-B313-A6E0DAF7EA1C" target="_blank">Working with Oracle GoldenGate Sharding</a> in the Fusion Middleware <span id="GUID-4FC0AC46-0B8B-4670-BBE4-052228492C72__GGSAU"><cite>Using the Oracle GoldenGate Microservices Architecture</cite></span> guide for more information about using Oracle GoldenGate with Oracle Sharding.
                     </p>
                     <p></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="sharding-high-availability.html#GUID-C668B8C7-0F94-4F85-B8E1-A6B91548BBB6" title="Oracle Sharding is integrated with Oracle Database replication technologies for high availability and disaster recovery at the shard level.">Shard-Level High Availability</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>