<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Optimizing Performance of C++ Applications</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-c-call-interface-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-06T02:31:59-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96205-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="oracle-xa-library.html" title="Previous" type="text/html">
      <link rel="next" href="occi-application-programing-interface.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Oracle C++ Call Interface Programmer's Guide">
    <meta name="dcterms.isVersionOf" content="LNCPP">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-xa-library.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="occi-application-programing-interface.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Optimizing Performance of C++ Applications</li>
            </ol>
            <a id="GUID-0901F6D0-F5DE-462A-A367-EE2C2AA55698" name="GUID-0901F6D0-F5DE-462A-A367-EE2C2AA55698"></a><a id="LNCPP012"></a>
            
            <h2 id="LNCPP-GUID-0901F6D0-F5DE-462A-A367-EE2C2AA55698" class="sect2"><span class="enumeration_chapter">12 </span> Optimizing Performance of C++ Applications
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter describes a few suggestions that lead to better performance for your OCCI custom applications.</p>
               <p>This chapter contains these topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-B822003D-DCE2-4704-9D83-4BF401B26882">About Transparent Application Failover</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-7191B319-0109-446E-96A1-65AB696C8C99">About Connection Sharing</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-96783A66-4018-4CC4-9D9A-36075BB3FF1A">About Application-Managed Data Buffering</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-F6AD3A0C-7DD2-4362-8BFE-F4718D26817C">Using the Array Fetch Using next() Method</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-B406B496-9395-4D76-899F-71E414B68FB9">Modifying Rows Iteratively</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61" title="Oracle Connection Manager in Traffic Director Mode is a proxy that is placed between supported database clients and database instances.">About Using Oracle Connection Manager in Traffic Director Mode</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-5F06D230-7248-4BB0-AC4C-0BC42AC6B3AC">About Run-time Load Balancing of the Stateless Connection Pool</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-8ADCAB82-EBBE-43C0-BECE-4E74687A166D">About Fault Diagnosability</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-740894FB-9DAE-4F98-BA70-0C4E04479200">Using Client Result Cache</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052">About Client-Side Deployment Parameters and Auto Tuning</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-0901F6D0-F5DE-462A-A367-EE2C2AA55698__GUID-EC4BD1C4-6E53-41FC-9630-B47F3073E041">
                  <p class="notep1">See Also:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="occi-application-programing-interface.html#GUID-3C824380-073E-4F32-AA6E-928A18D52F4B">OCCI Application Programming Interface</a></p>
                     </li>
                  </ul>
               </div>
            </div><a id="LNCPP20011"></a><div class="props_rev_3"><a id="GUID-B822003D-DCE2-4704-9D83-4BF401B26882" name="GUID-B822003D-DCE2-4704-9D83-4BF401B26882"></a><h3 id="LNCPP-GUID-B822003D-DCE2-4704-9D83-4BF401B26882" class="sect3"><span class="enumeration_section">12.1 </span>About Transparent Application Failover
               </h3>
               <div>
                  <p>OCCI <span class="bold">Transparent Application Failover</span> (TAF) enables OCCI to be more robust in handling database instance failures in distributed applications at run time. If a server node becomes unavailable, applications automatically reconnect to another surviving node.
                  </p>
                  <p>TAF occurs when the client application, during a roundtrip operation, detects that the database instance is down. It establishes a connection to the backup database configured for TAF. This backup can be another node in an Oracle RAC configuration, a hot standby database, or the same database instance itself. </p>
                  <p>The OCCI/OCI API responsible for the roundtrip on the failed connection will typically return one of the following errors:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">ORA-25401: can not continue fetches</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">ORA-25402: transaction must roll back</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">ORA-25408: can not safely replay call</code></p>
                     </li>
                  </ul>
                  <p>The new connection is may be used for subsequent application requests and for any   ongoing work that must be restarted.Idle connections in the application are not affected.</p>
                  <p>Some design options should be considered when including Transparent Application Failover in an application:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Because of the delays inherent to failover processing, the design of the application may include a notice to the user that a failover is in progress and that normal operation should resume shortly. </p>
                     </li>
                     <li>
                        <p>If the session on the initial instance received <code class="codeph">ALTER SESSION</code> commands before the failover began, they are not automatically replayed on the second instance.
                        </p>
                        <p>Consequently, the developer may want to replay these <code class="codeph">ALTER SESSION</code> commands on the second instance.
                        </p>
                     </li>
                  </ul>
                  <p>It is the user's responsibility to track changes to the <code class="codeph">SESSION</code> parameters.
                  </p>
                  <p>To address these problems, the application can register a failover callback function. After a failover, the callback function is invoked at different times while reestablishing the user's session. </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The first call to the callback function occurs when Oracle first detects an instance connection loss. This callback is intended to allow the application to inform the user of an upcoming delay. </p>
                     </li>
                     <li>
                        <p>If failover is successful, a second call to the callback function occurs when the connection is reestablished and usable. At this time the client may want to replay <code class="codeph">ALTER SESSION</code> commands and inform the user that failover has happened. Note that you must keep track of <code class="codeph">SESSION</code> parameter changes and then replay them after the failover is complete.
                        </p>
                        <p>If failover is unsuccessful, then the callback function is called to inform the application that failover cannot take place.</p>
                     </li>
                     <li>
                        <p>An initial attempt at failover may not always successful. The failover callback should return <code class="codeph">FO_RETRY</code> to indicate that the failover should be attempted again.
                        </p>
                        <div class="infoboxnotealso" id="GUID-B822003D-DCE2-4704-9D83-4BF401B26882__GUID-9E243EF4-4174-48DD-944B-E7A5B6585D4F">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Definition of <code class="codeph">FailOverType</code> and <code class="codeph">FailOverEventType</code> in <a href="connection-class.html#GUID-412D06D3-7636-4A32-AF24-534099F989D0__BBAEAHAH" title="First column lists the attribute used by the class, the second column describes the options available to each attribute">Table 13-11</a> in <a href="occi-application-programing-interface.html#GUID-3C824380-073E-4F32-AA6E-928A18D52F4B">OCCI Application Programming Interface</a> 
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../netag/enabling-advanced-features.html#NETAG455" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> for more detailed information about application failover.
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
                  <div class="p">This section includes the following topics:
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-D8B753E9-89F6-46F1-BB03-4B6836DBD138">Using Transparent Application Failover</a></p>
                        </li>
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-6729D045-E737-4BE9-A50D-6AB39243DA5F">About Objects and Transparent Application Failover</a></p>
                        </li>
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-146ED846-BA38-42BC-8F71-F88BD9631444">Using Connection Pooling and Transparent Application Failover</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="LNCPP20477"></a><div class="props_rev_3"><a id="GUID-D8B753E9-89F6-46F1-BB03-4B6836DBD138" name="GUID-D8B753E9-89F6-46F1-BB03-4B6836DBD138"></a><h4 id="LNCPP-GUID-D8B753E9-89F6-46F1-BB03-4B6836DBD138" class="sect4"><span class="enumeration_section">12.1.1 </span>Using Transparent Application Failover
                  </h4>
                  <div>
                     <div class="section">
                        <p>To enable TAF, the connect string has to be configured for failover and registered on <code class="codeph">Connection</code> (created from <code class="codeph">Environment</code>, <code class="codeph">ConnectionPool</code> and <code class="codeph">StatelessConnectionPool</code>). To register the callback function, use the <a href="connection-class.html#GUID-412D06D3-7636-4A32-AF24-534099F989D0">Connection Class</a> interface <a href="connection-class.html#GUID-0C0A528D-6669-490E-BC2E-9A8183D4F95B">setTAFNotify()</a>:
                        </p><pre class="oac_no_warn" dir="ltr">void Connection::setTAFNotify(
&nbsp;&nbsp;&nbsp;int (*notifyFn)(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Environment *env,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connection *conn,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void *ctx,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FailOverType foType,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FailOverEventType foEvent),
&nbsp;&nbsp;&nbsp;void *ctxTAF);
</pre><p>Note that TAF support for <code class="codeph">ConnectionPool</code>s does not include <code class="codeph">BACKUP</code> and <code class="codeph">PRECONNECT</code> clauses; these should not be used in the connect string.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNCPP20478"></a><div class="props_rev_3"><a id="GUID-6729D045-E737-4BE9-A50D-6AB39243DA5F" name="GUID-6729D045-E737-4BE9-A50D-6AB39243DA5F"></a><h4 id="LNCPP-GUID-6729D045-E737-4BE9-A50D-6AB39243DA5F" class="sect4"><span class="enumeration_section">12.1.2 </span>About Objects and Transparent Application Failover
                  </h4>
                  <div>
                     <p>Transparent application failover works with the OCCI navigational and associative access models and the object cache. In a non-Oracle RAC setup, you must ensure that the object type definitions and object OIDs in primary and backup instances are identical.</p>
                     <p>If the application receives <code class="codeph">ORA-25402: transaction must roll back</code> error after the failover, then it must initiate a rollback to correctly reset the object cache on the client. If a transaction has not started before the failover, the application should still initiate a rollback after the failover to refresh the objects on the client object cache from the new instance.
                     </p>
                  </div>
               </div><a id="LNCPP21907"></a><a id="LNCPP20479"></a><div class="props_rev_3"><a id="GUID-146ED846-BA38-42BC-8F71-F88BD9631444" name="GUID-146ED846-BA38-42BC-8F71-F88BD9631444"></a><h4 id="LNCPP-GUID-146ED846-BA38-42BC-8F71-F88BD9631444" class="sect4"><span class="enumeration_section">12.1.3 </span>Using Connection Pooling and Transparent Application Failover
                  </h4>
                  <div>
                     <div class="section">
                        <p>If the transparent application failover feature is activated, connections created in a connection pool are also failed over. The application failover callback must be specified for each connection obtained from the connection pool; these connections are failed over when used after the primary instance failure.</p>
                        <p>Note that connections in a custom connection pool must be explicitly cleaned and repaired. Consider an application that has 500 connections in a pool; 10 of the connections are busy (doing a round-trip) and 490 are free or idle. If the database instance fails, then TAF will work on 10 active connections, and client requests on these connections must be restarted. When each of the other 490 connections are picked up by the application, TAF is performed and OCCI returns one of error codes <code class="codeph">ORA-25401</code>, <code class="codeph">ORA-24502</code>, or <code class="codeph">ORA-25408</code>, forcing a restart of the user request. The application can avoid these errors on the 490 idle connections by repairing or purging these connections by using the knowledge that TAF was previously activated on 10 connections in the connection pool.
                        </p>
                        <p>To repair connections in OCCI, use the <a href="connection-class.html#GUID-412D06D3-7636-4A32-AF24-534099F989D0">Connection Class</a> interface <a href="connection-class.html#GUID-D158EE4A-59B4-46F6-82FF-F26E6B07C1B7">getServerVersion()</a>, a light-weight, data-neutral database call for starting TAF on connections to failed instances:
                        </p><pre class="oac_no_warn" dir="ltr">string getServerVersion() const;
</pre><p>In the OCCI TAF callback, applications may invoke <a href="connection-class.html#GUID-D158EE4A-59B4-46F6-82FF-F26E6B07C1B7">getServerVersion()</a> on idle connections in the custom pool, to start and complete failover for these connections.
                        </p>
                        <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-146ED846-BA38-42BC-8F71-F88BD9631444__BBACAHGD">Example 12-1</a> demonstrates how to use OCCI for TAF callbacks and for repairing bad connections. Note that the example does not show custom pool data structure or mutexing and concurrency control.
                        </p>
                        <p>Note that TAF behavior is the same for standalone connections and connections in a custom connection pool.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-146ED846-BA38-42BC-8F71-F88BD9631444__BBACAHGD">
                        <p class="titleinexample">Example 12-1 How to Enable TAF for Connection Pooling</p><pre class="oac_no_warn" dir="ltr">#include &lt;occi.h&gt;
#include &lt;iostream&gt;
#include &lt;time.h&gt;
 
using namespace std;
using namespace oracle::occi;
 
//Application custom pool of 3 connections
Environment *env;
Connection *conn1,*conn2,*conn3;
bool conn1free,conn2free,conn3free;
bool repairing = false;
 
int taf_callback(Environment *env, Connection *conn, void *ctx,  
  Connection::FailOverType foType, Connection::FailOverEventType foEvent)
{
   cout &lt;&lt; "TAF callback for connection " &lt;&lt; conn &lt;&lt; endl;

   if(foEvent == Connection::FO_ERROR)
   {
      cout &lt;&lt; "Retrying" &lt;&lt; endl;
      return FO_RETRY;
   }
 
   if (foEvent ==  Connection::FO_END)
   {
     cout &lt;&lt; "TAF complete for connnection " &lt;&lt; conn &lt;&lt; endl;
     if (repairing == false)
     {
      repairing = true;
      cout &lt;&lt; "repairing other idle connections" &lt;&lt; endl;
   
      //ignore errors during TAF
      try
      {
         if (conn1free) conn1-&gt;getServerVersion();
      }
      catch (...)
      {
      }
      try
      {
         if (conn2free) conn2-&gt;getServerVersion();
      }
      catch (...)
      {
      }
      try
      {
         if (conn3free) conn3-&gt;getServerVersion();
      }
      catch (...)
      {
      }
      repairing = false;
     }//if
   }//if
 
   return 0; //continue failover
}
 
main()
{
try
{ 
env = Environment::createEnvironment(Environment::THREADED_MUTEXED);
//open 3 connections;
 conn1 = env-&gt;createConnection("hr","<span class="italic">password</span>","inst1_failback");
 conn2 = env-&gt;createConnection("hr","<span class="italic">password</span>","inst1_failback");
 conn3 = env-&gt;createConnection("hr","<span class="italic">password</span>","inst1_failback");
 
//all connections are 'free'
conn1free = conn2free = conn3free = true;
 
//set TAF callbacks on all connection
conn1-&gt;setTAFNotify(taf_callback,NULL);
conn2-&gt;setTAFNotify(taf_callback,NULL);
conn3-&gt;setTAFNotify(taf_callback,NULL);
 
//use 1 connection
conn1free=false;
cout &lt;&lt; "Using conn1" &lt;&lt; endl;
Statement *stmt = conn1-&gt;createStatement ("select * from employees");
ResultSet *rs  = stmt-&gt;executeQuery();
while (rs-&gt;next())
{
   cout &lt;&lt; (rs-&gt;getString(2)) &lt;&lt; endl;
}
stmt-&gt;closeResultSet(rs);
conn1-&gt;terminateStatement(stmt);
 
cout &lt;&lt; "Shutdown and restart the database" &lt;&lt; endl;
string buf;
cin &gt;&gt; buf;
 
Statement *stmt2;
try
{
   cout &lt;&lt; "Trying a update on EMP table" &lt;&lt; endl;
   stmt2 = conn1-&gt;createStatement("delete from employees");
   stmt2-&gt;executeUpdate();
}
catch (SQLException &amp;ex)
{
   cout &lt;&lt; "Update EMPLOYEES returned error : " &lt;&lt; ex.getMessage() &lt;&lt; endl;
   cin &gt;&gt; buf;
}
 
cout &lt;&lt; "Done" &lt;&lt; endl;
env-&gt;terminateConnection(conn1);
env-&gt;terminateConnection(conn2);
env-&gt;terminateConnection(conn3);
Environment::terminateEnvironment(env);
}
catch(SQLException &amp;ex)
{
cout &lt;&lt; ex.getMessage() &lt;&lt; endl;
}
}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="LNCPP1202"></a><div class="props_rev_3"><a id="GUID-7191B319-0109-446E-96A1-65AB696C8C99" name="GUID-7191B319-0109-446E-96A1-65AB696C8C99"></a><h3 id="LNCPP-GUID-7191B319-0109-446E-96A1-65AB696C8C99" class="sect3"><span class="enumeration_section">12.2 </span>About Connection Sharing
               </h3>
               <div>
                  <p>This section covers the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-E81F6929-F527-4FF3-A38C-58FCC384964E">Introduction to Thread Safety</a></p>
                     </li>
                     <li>
                        <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE">Implementing Thread Safety</a></p>
                     </li>
                     <li>
                        <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-A1BDEA6E-2FB9-4E0F-B15B-83F1A56419A3">About Serialization</a></p>
                     </li>
                     <li>
                        <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-11EFCB7F-D572-43D8-A345-4737BD09E9EF">Operating System Considerations</a></p>
                     </li>
                  </ul>
               </div><a id="LNCPP20480"></a><div class="props_rev_3"><a id="GUID-E81F6929-F527-4FF3-A38C-58FCC384964E" name="GUID-E81F6929-F527-4FF3-A38C-58FCC384964E"></a><h4 id="LNCPP-GUID-E81F6929-F527-4FF3-A38C-58FCC384964E" class="sect4"><span class="enumeration_section">12.2.1 </span>Introduction to Thread Safety
                  </h4>
                  <div>
                     <p>Threads are lightweight processes that exist within a larger process. Threads each share the same code and data segments, but have their own program counters, system registers, and stack. Global and static variables are common to all threads, and a mutual exclusivity mechanism may be required to manage access to these variables from multiple threads within an application. </p>
                     <p>Once spawned, threads run asynchronously to one another. They can access common data elements and make OCCI calls in any order. Because of this shared access to data elements, a mechanism is required to maintain the integrity of data being accessed by multiple threads.   The mechanism to manage data access takes the form of mutexes (mutual exclusivity locks), which ensure that no conflicts arise between multiple threads that are accessing shared resources within an application. In OCCI, mutexes are granted on an OCCI environment basis.</p>
                     <p>This thread safety feature of the Oracle database server and OCCI library enables developers to use OCCI in a multithreaded application with these added benefits: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Multiple threads of execution can make OCCI calls with the same result as successive calls made by a single thread. </p>
                        </li>
                        <li>
                           <p>When multiple threads make OCCI calls, there are no side effects between threads. </p>
                        </li>
                        <li>
                           <p>Even if you do not write a multithreaded program, you do not pay any performance penalty for including thread-safe OCCI calls. </p>
                        </li>
                        <li>
                           <p>Use of multiple threads can improve program performance. You can discern gains on multiprocessor systems where threads run concurrently on separate processors, and on single processor systems where overlap can occur between slower operations and faster operations. </p>
                        </li>
                     </ul>
                     <p>In addition to client/server applications, where the client can be a multithreaded program, thread safety is typically used in three-tier or client/agent/server architectures. In this architecture, the client is concerned only with presentation services. The agent (or application server) processes the application logic for the client application. Typically, this relationship is a many-to-one relationship, with multiple clients sharing the same application server. </p>
                     <p>The server tier in the three-tier architecture is an Oracle database server. The applications server (agent) supports multithreading, with each thread serving a separate client application. In an Oracle environment, this middle-tier application server is an OCCI or precompiler program. </p>
                  </div>
               </div><a id="LNCPP20481"></a><div class="props_rev_3"><a id="GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE" name="GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE"></a><h4 id="LNCPP-GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE" class="sect4"><span class="enumeration_section">12.2.2 </span>Implementing Thread Safety
                  </h4>
                  <div>
                     <div class="section">
                        <p>To take advantage of thread safety by using OCCI, an application must be running in a thread-safe operating system. Then the application must inform OCCI that the application is running in multithreaded mode by specifying <code class="codeph">THREADED_MUTEXED</code> or <code class="codeph">THREADED_UNMUTEXED</code> for the mode parameter of the <code class="codeph">createEnvironment()</code> method. For example, to turn on mutual exclusivity locking, issue the following statement: 
                        </p><pre class="oac_no_warn" dir="ltr">Environment *env = Environment::createEnvironment( 
          Environment::THREADED_MUTEXED);</pre><p>Note that once <code class="codeph">createEnvironment</code> is called with <code class="codeph">THREADED_MUTEXED</code> or <code class="codeph">THREADED_UNMUTEXED</code>, all subsequent calls to the <code class="codeph">createEnvironment</code> method must also be made with <code class="codeph">THREADED_MUTEXED</code> or <code class="codeph">THREADED_UNMUTEXED</code> modes.
                        </p>
                        <p>If a multithreaded application is running in a thread-safe operating system, then the OCCI library manages mutexes for the application on a for each-OCCI-environment basis. However, you can override this feature and have your application maintain its own mutex scheme. This is done by specifying a mode value of <code class="codeph">THREADED_UNMUTEXED</code> to the <code class="codeph">createEnvironment()</code> method.
                        </p>
                        <p>Applications that run on non-thread-safe platforms should not pass a value of <code class="codeph">THREADED_MUTEXED</code> or <code class="codeph">THREADED_UNMUTEXED</code> to the <code class="codeph">createEnvironment()</code> method.
                        </p>
                        <p>If an application is single threaded, regardless of whether the platform is thread safe, the application should pass a value of <code class="codeph">Environment::DEFAULT</code> to the <code class="codeph">createEnvironment()</code> method. This is also the default value for the mode parameter. Single threaded applications which run in <code class="codeph">THREADED_MUTEXED</code> mode may incur performance degradation.
                        </p>
                        <p>OCCI does not support nonblocking mode.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNCPP20482"></a><div class="props_rev_3"><a id="GUID-A1BDEA6E-2FB9-4E0F-B15B-83F1A56419A3" name="GUID-A1BDEA6E-2FB9-4E0F-B15B-83F1A56419A3"></a><h4 id="LNCPP-GUID-A1BDEA6E-2FB9-4E0F-B15B-83F1A56419A3" class="sect4"><span class="enumeration_section">12.2.3 </span>About Serialization
                  </h4>
                  <div>
                     <p>As an application programmer, you have two basic options regarding concurrency in a multithreaded application:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-747EE0AB-EED6-4B03-9029-190AF2C0B609">Automatic Serialization</a>, in which you use OTIS's transparent mechanisms
                           </p>
                        </li>
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-9A71755F-9EC4-4F00-AED0-B7CBBF96DFEF">Application-Provided Serialization</a>, in which you manage the contingencies involved in maintaining multiple threads
                           </p>
                        </li>
                     </ul>
                  </div><a id="LNCPP20483"></a><div class="props_rev_3"><a id="GUID-747EE0AB-EED6-4B03-9029-190AF2C0B609" name="GUID-747EE0AB-EED6-4B03-9029-190AF2C0B609"></a><h5 id="LNCPP-GUID-747EE0AB-EED6-4B03-9029-190AF2C0B609" class="sect5"><span class="enumeration_section">12.2.3.1 </span>Automatic Serialization
                     </h5>
                     <div>
                        <p>In cases where there are multiple threads operating on objects (connections and connection pools) derived from an OCCI environment, you can elect to let OCCI serialize access to those objects. The first step is to pass a value of <code class="codeph">THREADED_MUTEXED</code> to the <code class="codeph">createEnvironment</code> method. At this point, the OCCI library automatically acquires a mutex on thread-safe objects in the environment. 
                        </p>
                        <p>When the OCCI environment is created with <code class="codeph">THREADED_MUTEXED</code> mode, then only the <code class="codeph">Environment</code>, <code class="codeph">Map</code>, <code class="codeph">ConnectionPool</code>, <code class="codeph">StatelessConnectionPool</code> and <code class="codeph">Connection</code> objects are thread-safe. That is, if two threads make simultaneous calls on one of these objects, then OCCI serializes them internally. However, note that all other OCCI objects, such as <code class="codeph">Statement</code>, <code class="codeph">ResultSet</code>, <code class="codeph">SQLException</code>, <code class="codeph">Stream</code>, and so on, are not thread-safe as, applications should not operate on these objects simultaneously from multiple threads.
                        </p>
                        <p>Note that the bulk of processing for an OCCI call happens on the server, so if two threads that use OCCI calls go to the same connection, then one of them could be blocked while the other finishes processing at the server.</p>
                     </div>
                  </div><a id="LNCPP20484"></a><div class="props_rev_3"><a id="GUID-9A71755F-9EC4-4F00-AED0-B7CBBF96DFEF" name="GUID-9A71755F-9EC4-4F00-AED0-B7CBBF96DFEF"></a><h5 id="LNCPP-GUID-9A71755F-9EC4-4F00-AED0-B7CBBF96DFEF" class="sect5"><span class="enumeration_section">12.2.3.2 </span>Application-Provided Serialization
                     </h5>
                     <div>
                        <p>In cases where there are multiple threads operating on objects derived from an OCCI environment, you can chose to manage serialization. The first step is to pass a value of <code class="codeph">THREADED_UNMUTEXED</code> for the <code class="codeph">createEnvironment</code> mode. In this case the application must mutual exclusively lock OCCI calls made on objects derived from the same OCCI environment. This has the advantage that the mutex scheme can be optimized based on the application design to gain greater concurrency.
                        </p>
                        <p>When an OCCI environment is created in this mode, OCCI recognizes that the application is running in a multithreaded application, but that OCCI need not acquire its internal mutexes. OCCI assumes that all calls to methods of objects derived from that OCCI environment are serialized by the application. You can achieve this two different ways:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Each thread has its own environment. That is, the environment and all objects derived from it (connections, connection pools, statements, result sets, and so on) are not shared across threads. In this case your application need not apply any mutexes.</p>
                           </li>
                           <li>
                              <p>If the application shares an OCCI environment or any object derived from the environment across threads, then it must serialize access to those objects (by using a mutex, and so on) such that only one thread is calling an OCCI method on any of those objects.</p>
                           </li>
                        </ul>
                        <p>In both cases, no mutexes are acquired by OCCI. You must ensure that only one OCCI call is in process on any object derived from the OCCI environment at any given time when <code class="codeph">THREADED_UNMUTEXED</code> is used.
                        </p>
                        <p>OCCI is optimized to reuse objects as much as possible. Since each environment has its own heap, multiple environments result in increased consumption of memory. Having multiple environments may imply duplicating work regarding connections, connection pools, statements, and result set objects. This results in further memory consumption.</p>
                        <p>Having multiple connections to the server results in more resource consumption on both the server and the network. Having multiple environments normally entails more connections.</p>
                     </div>
                  </div>
               </div><a id="LNCPP21906"></a><div class="props_rev_3"><a id="GUID-11EFCB7F-D572-43D8-A345-4737BD09E9EF" name="GUID-11EFCB7F-D572-43D8-A345-4737BD09E9EF"></a><h4 id="LNCPP-GUID-11EFCB7F-D572-43D8-A345-4737BD09E9EF" class="sect4"><span class="enumeration_section">12.2.4 </span>Operating System Considerations
                  </h4>
                  <div>
                     <p>Some operating systems provide facilities for spawning processes that allow child processes to reuse states created by their parent process.</p>
                     <p>After a parent process spawns a child process, the child process <span class="italic">must not</span> use the database connection created by the parent. Because SQL*Net expects only one user process to use a particular connection to the database, attempts by the child process to use the same database connection as the parent may cause undesired connection interference, and result in intermittent <code class="codeph">ORA-03137</code> errors.
                     </p>
                     <p>When the application requires multiple concurrent connections, Oracle recommends using threads on platforms that support threading. Oracle supports concurrent connections in both single-threaded and multi-threaded applications.</p>
                     <p>See <span class="q">"<a href="optimizing-performance-of-cplusplus-applications.html#GUID-E81F6929-F527-4FF3-A38C-58FCC384964E">Introduction to Thread Safety</a>"</span> and <span class="q">"<a href="optimizing-performance-of-cplusplus-applications.html#GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE">Implementing Thread Safety</a>"</span> for more information about threads.
                     </p>
                     <p>For improving performance with many concurrently opened connections, see <span class="q">"<a href="accessing-oracle-database-using-cplusplus.html#GUID-753C36CE-E6A0-4F0D-B85E-C253EB916C8D">About Pooling Connections</a>"</span>.
                     </p>
                  </div>
               </div>
            </div><a id="LNCPP1203"></a><div class="props_rev_3"><a id="GUID-96783A66-4018-4CC4-9D9A-36075BB3FF1A" name="GUID-96783A66-4018-4CC4-9D9A-36075BB3FF1A"></a><h3 id="LNCPP-GUID-96783A66-4018-4CC4-9D9A-36075BB3FF1A" class="sect3"><span class="enumeration_section">12.3 </span>About Application-Managed Data Buffering
               </h3>
               <div>
                  <p>When you provide data for bind parameters by the <code class="codeph">set</code><span class="italic">xxx</span> methods in parameterized statements, the values are copied into an internal data buffer, and the copied values are then provided to the database server for insertion. To reduce overhead of copying <code class="codeph">string</code> type data that is available in user buffers, use the <a href="resultset-class.html#GUID-98BF5B63-A834-419B-927B-7F02E9ECF1B3">setDataBuffer()</a> and <a href="resultset-class.html#GUID-1535D185-F592-4B90-B358-998EDC72094A">next()</a> methods of the <a href="resultset-class.html#GUID-9E0C0A68-57B7-4C77-8865-A306BF6953CA">ResultSet Class</a> and the <a href="statement-class.html#GUID-9D152584-D72E-42AE-A3CC-3C6A4F35C11B">execute()</a> method of the <a href="statement-class.html#GUID-DF0FF9BE-6EF5-4D2A-A45D-A6F2FDF6133D">Statement Class</a>.
                  </p>
                  <div class="p">This section includes the following topics:
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-0F9A3D45-5912-4AD0-B0FB-DDA8F03C91B5">Using the setDataBuffer() Method</a></p>
                        </li>
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-D689DB14-F381-4874-9200-8705FCA00CFC">Using the executeArrayUpdate() Method</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="LNCPP20485"></a><div class="props_rev_3"><a id="GUID-0F9A3D45-5912-4AD0-B0FB-DDA8F03C91B5" name="GUID-0F9A3D45-5912-4AD0-B0FB-DDA8F03C91B5"></a><h4 id="LNCPP-GUID-0F9A3D45-5912-4AD0-B0FB-DDA8F03C91B5" class="sect4"><span class="enumeration_section">12.3.1 </span>Using the setDataBuffer() Method
                  </h4>
                  <div>
                     <div class="section">
                        <p>For high performance applications, OCCI provides the <code class="codeph">setDataBuffer</code> method whereby the data buffer is managed by the application. The following example shows the <a href="resultset-class.html#GUID-98BF5B63-A834-419B-927B-7F02E9ECF1B3">setDataBuffer()</a> method: 
                        </p><pre class="oac_no_warn" dir="ltr">void setDataBuffer(int paramIndex,
&nbsp;&nbsp;&nbsp;void *buffer,
&nbsp;&nbsp;&nbsp;Type type,
&nbsp;&nbsp;&nbsp;sb4 size,
&nbsp;&nbsp;&nbsp;ub2 *length,
&nbsp;&nbsp;&nbsp;sb2 *ind = NULL, 
&nbsp;&nbsp;&nbsp;ub2 *rc = NULL); 
</pre><p>The following parameters are used in the previous method example:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">paramIndex</code>: Parameter number
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">buffer</code>: Data buffer containing data
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">type</code>: Type of the data in the data buffer
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">size</code>: Size of the data buffer
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">length</code>: Current length of data in the data buffer
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ind</code>: Indicator information. This indicates whether the data is <code class="codeph">NULL</code> or not. For parameterized statements, a value of <code class="codeph">-1</code> means a <code class="codeph">NULL</code> value is to be inserted. For data returned from callable statements, a value of <code class="codeph">-1</code> means <code class="codeph">NULL</code> data is retrieved.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">rc</code>: Return code. This variable is not applicable to data provided to the <code class="codeph">Statement</code> method. However, for data returned from callable statements, the return code specifies parameter-specific error numbers. 
                              </p>
                           </li>
                        </ul>
                        <p>Not all data types can be provided and retrieved by the <code class="codeph">setDataBuffer()</code> method. For instance, C++ Standard Library strings cannot be provided with the <code class="codeph">setDataBuffer()</code> interface. 
                        </p>
                        <div class="infoboxnotealso" id="GUID-0F9A3D45-5912-4AD0-B0FB-DDA8F03C91B5__GUID-4F095C86-BBAE-47A8-9BF4-7F33B153427E">
                           <p class="notep1">See Also:</p>
                           <p><a href="data-types.html#GUID-62361201-C028-425D-A809-AB0CC01F2F67__CJAFHAAD" title="This table has 4 columns. Column 1 lists external datatypes; column 2 provides a brief description; column 3 lists matching C++ type(s); column 4 lists matching OCCI Types.">Table 5-2</a> in <a href="data-types.html#GUID-90F238BF-BF35-411C-9CB8-3D6A2970729D">Data Types</a> for specific cases
                           </p>
                        </div>
                        <p>There is an important difference between the data provided by the <code class="codeph">set</code><span class="italic">xxx</span><code class="codeph">() </code>methods and <code class="codeph">setDataBuffer()</code> method. When data is copied in the <code class="codeph">set</code><span class="italic">xxx</span><code class="codeph">()</code> methods, the original can change once the data is copied. For example, you can use a <code class="codeph">setString(str1)</code> method, then change the value of <code class="codeph">str1</code> before execute. The value of <code class="codeph">str1</code> that is used is the value at the time <code class="codeph">setString(str1)</code> is called. However, for data provided by the <code class="codeph">setDataBuffer()</code> method, the buffer must remain valid until the execution is completed.
                        </p>
                        <p>If iterative executes or the <code class="codeph">executeArrayUpdate()</code> method is used, then data for multiple rows and iterations can be provided in a single buffer. In this case, the data for the <span class="italic">i</span>th iteration is at <code class="codeph">buffer + (i-1) *size address</code> and the length, indicator, and return codes are at <code class="codeph">*(length + i)</code>, <code class="codeph">*(ind + i)</code>, and <code class="codeph">*(rc + i)</code> respectively.
                        </p>
                        <p>This interface is also meant for use with array executions and callable statements that have array or <code class="codeph">OUT</code> bind parameters. 
                        </p>
                        <p>The same method is available in the <code class="codeph">ResultSet</code> class to retrieve data without re-allocating the buffer for each fetch.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNCPP20487"></a><a id="LNCPP20488"></a><a id="LNCPP20486"></a><div class="props_rev_3"><a id="GUID-D689DB14-F381-4874-9200-8705FCA00CFC" name="GUID-D689DB14-F381-4874-9200-8705FCA00CFC"></a><h4 id="LNCPP-GUID-D689DB14-F381-4874-9200-8705FCA00CFC" class="sect4"><span class="enumeration_section">12.3.2 </span>Using the executeArrayUpdate() Method
                  </h4>
                  <div>
                     <div class="section">
                        <p>If all data is provided with the <code class="codeph">setDataBuffer()</code> methods or output streams (that is, no <code class="codeph">set</code><span class="italic">xxx()</span> methods besides <code class="codeph">setDataBuffer()</code> or <code class="codeph">getStream()</code> are called), then there is a simplified way of doing iterative execution. 
                        </p>
                        <p>In this case, you should not call <code class="codeph">setMaxIterations()</code> and <code class="codeph">setMaxParamSize()</code>. Instead, call the <code class="codeph">setDataBuffer()</code> or <code class="codeph">getStream()</code> method for each parameter with the appropriate size arrays to provide data for each iteration, followed by the <code class="codeph">executeArrayUpdate(int</code> <code class="codeph">arrayLength)</code> method. The <code class="codeph">arrayLength</code> parameter specifies the number of elements provided in each buffer. Essentially, this is same as setting the number of iterations to <code class="codeph">arrayLength</code> and executing the statement. 
                        </p>
                        <p>Since the stream parameters are specified only once, they can be used with array executes as well. However, if any <code class="codeph">set</code><span class="italic">xxx</span><code class="codeph">()</code> methods are used, then the <code class="codeph">addIteration()</code> method is called to provide data for multiple rows. To compare the two approaches, consider <a href="optimizing-performance-of-cplusplus-applications.html#GUID-D689DB14-F381-4874-9200-8705FCA00CFC__CIAEIFHJ">Example 12-2</a> that inserts two employees in the <code class="codeph">employees</code> table: 
                        </p>
                        <p>However, if the first parameter could also be provided through the <code class="codeph">setDataBuffer()</code> interface, then, instead of the <code class="codeph">addIteration()</code> method, you would use the <code class="codeph">executeArrayUpdate()</code> method, as shown in <a href="optimizing-performance-of-cplusplus-applications.html#GUID-D689DB14-F381-4874-9200-8705FCA00CFC__CIAIGGHF">Example 12-3</a>: 
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-D689DB14-F381-4874-9200-8705FCA00CFC__CIAEIFHJ">
                        <p class="titleinexample">Example 12-2 How to Insert Records Using the addIteration() method</p><pre class="oac_no_warn" dir="ltr">Statement *stmt = conn-&gt;createStatement(
&nbsp;&nbsp;"insert into departments (department_id, department_name) values(:1, :2)"); 
char dnames[][100] = {"Community Outreach", "University Recruiting"}; 
ub2 dnameLen[2]; 

for (int i = 0; i &lt; 2; i++) 
&nbsp;&nbsp;dnameLen[i] = strlen(dnames[i] + 1);

stmt-&gt;setMaxIterations(2); &nbsp;&nbsp;&nbsp;// set maximum number of iterations 

stmt-&gt;setInt(1, 7369); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// specify data for the first row 
stmt-&gt;setDataBuffer(2, dnames, OCCI_SQLT_STR, sizeof(dnames[0]), dnameLen); 
stmt-&gt;addIteration(); 

stmt-&gt;setInt(1, 7654); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// specify data for the second row 
                              // a setDatBuffer is unnecessary for the second 
                              // bind parameter as data provided through
                              // setDataBuffer is specified only once. 
stmt-&gt;executeUpdate(); 
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-D689DB14-F381-4874-9200-8705FCA00CFC__CIAIGGHF">
                        <p class="titleinexample">Example 12-3 How to Insert Records Using the executeArrayUpdate() Method</p><pre class="oac_no_warn" dir="ltr">Statement *stmt = conn-&gt;createStatement(
&nbsp;&nbsp;"insert into departments (department_id, department_name) values(:1, :2)"); 
char dnames[][100] = {"Community Outreach", "University Recruiting"}; 
ub2 dnameLen[2]; 

for (int i = 0; i &lt; 2; i++) 
&nbsp;&nbsp;dnameLen[i] = strlen(dnames[i] + 1); 

int ids[2] = {7369, 7654}; 
ub2 idLen[2] = {sizeof(ids[0]), sizeof(ids[1])}; 
stmt-&gt;setDataBuffer(1, ids, OCCIINT, sizeof(ids[0]), idLen); 
stmt-&gt;setDataBuffer(2, dnames, OCCI_SQLT_STR, sizeof(dnames[0]), dnameLen); 

stmt-&gt;executeArrayUpdate(2); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// data for two rows is inserted. </pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="LNCPP20489"></a><a id="LNCPP1204"></a><div class="props_rev_2"><a id="GUID-F6AD3A0C-7DD2-4362-8BFE-F4718D26817C" name="GUID-F6AD3A0C-7DD2-4362-8BFE-F4718D26817C"></a><h3 id="LNCPP-GUID-F6AD3A0C-7DD2-4362-8BFE-F4718D26817C" class="sect3"><span class="enumeration_section">12.4 </span>Using the Array Fetch Using next() Method
               </h3>
               <div>
                  <div class="section">
                     <p>If the application is fetching data with only the <code class="codeph">setDataBuffer()</code> interface or the stream interface, then an array fetch can be executed. The array fetch is implemented through the <code class="codeph">next(</code>) method of the <code class="codeph">ResultSet</code> class. You must process the results obtained through next() before calling it again.
                     </p>
                     <p> This causes up to <span class="italic"><code class="codeph">numRows</code></span> amount of data to be fetched for each column. The buffers specified with the <code class="codeph">setDataBuffer()</code> interface should large enough to hold at least <span class="italic"><code class="codeph">numRows</code></span> of data.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-F6AD3A0C-7DD2-4362-8BFE-F4718D26817C__GUID-4F56D45D-D0E1-4A40-BF56-949B04A764CC">
                     <p class="titleinexample">Example 12-4 How to use Array Fetch with a ResultSet</p><pre class="oac_no_warn" dir="ltr">ResultSet *resultSet = stmt-&gt;executeQuery(...);
resultSet-&gt;setDataBuffer(...);
while (resultSet-&gt;next(<span class="italic">numRows</span>) == DATA_AVAILABLE)
&nbsp;&nbsp;&nbsp;process(resultSet-&gt;getNumArrayRows() );
</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="LNCPP20490"></a><a id="LNCPP1205"></a><div class="props_rev_3"><a id="GUID-B406B496-9395-4D76-899F-71E414B68FB9" name="GUID-B406B496-9395-4D76-899F-71E414B68FB9"></a><h3 id="LNCPP-GUID-B406B496-9395-4D76-899F-71E414B68FB9" class="sect3"><span class="enumeration_section">12.5 </span>Modifying Rows Iteratively
               </h3>
               <div>
                  <div class="section">
                     <p>To process batch errors, specify that the <code class="codeph">Statement</code> object is in a <code class="codeph">batchMode</code> of execution using the <a href="statement-class.html#GUID-EF2EE8DD-29C6-4669-BE6C-76173C5DF0A8">setBatchErrorMode()</a> method. Once the <code class="codeph">batchMode</code> is set and a batch update runs, any resulting errors are reported through the <a href="batchsqlexcept-class.html#GUID-C0D03734-0259-41A6-881A-6176820F7249">BatchSQLException Class</a>.
                     </p>
                     <p>The <code class="codeph">BatchSQLException</code> class provides methods that handle batch errors. <a href="optimizing-performance-of-cplusplus-applications.html#GUID-B406B496-9395-4D76-899F-71E414B68FB9__CHDHIIJD">Example 12-5</a> illustrates how batch handling can be implemented within any OCCI application. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-B406B496-9395-4D76-899F-71E414B68FB9__CHDHIIJD">
                     <p class="titleinexample">Example 12-5 How to Modify Rows Iteratively and Handle Errors</p>
                     <ol>
                        <li>
                           <p>Create the Statement object and set its batch error mode to <code class="codeph">TRUE</code>.
                           </p><pre class="oac_no_warn" dir="ltr">Statement *stmt = conn-&gt;createStatement ("...");
stmt-&gt;setBatchErrorMode (true);
</pre></li>
                        <li>
                           <p>Perform programmatic changes necessary by the application.</p>
                        </li>
                        <li>
                           <p>Update the statement.</p><pre class="oac_no_warn" dir="ltr">try {
&nbsp;&nbsp;updateCount = stmt-&gt;executeUpdate ();
}
</pre></li>
                        <li>
                           <p>Catch and handle any errors generated during the batch insert or update.</p><pre class="oac_no_warn" dir="ltr">catch (BatchSQLException &amp;batchEx)
{
&nbsp;&nbsp;cout&lt;&lt;"Batch Exception: "&lt;&lt;batchEx.what()&lt;&lt;endl;
&nbsp;&nbsp;int errCount = batchEx.getFailedRowCount();
&nbsp;&nbsp;cout &lt;&lt; "Number of rows failed " &lt;&lt; errCount &lt;endl;
&nbsp;&nbsp;for (int i = 0; i &lt; errCount; i++ )
&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;SQLException err = batchEx.getException(i);
&nbsp;&nbsp;&nbsp;&nbsp;unsigned int rowIndex = batchEx.getRowNum(i);
&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;"Row " &lt;&lt; rowIndex &lt;&lt; " failed because of "
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;&lt; err.getErrorCode() &lt;&lt; endl; 
&nbsp;&nbsp;}
&nbsp;&nbsp;// take recovery action on the failed rows
}
</pre></li>
                        <li>
                           <p>Catch and handle other errors generated during the statement update. Note that statement-level errors are still thrown as instances of a <code class="codeph">SQLException</code>.
                           </p><pre class="oac_no_warn" dir="ltr">catch( SQLException &amp;ex) // to catch other SQLExceptions.
{
   cout &lt;&lt; "SQLException: " &lt;&lt; e.what() &lt;&lt; endl;
}</pre></li>
                     </ol>
                  </div>
                  <!-- class="example" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61" name="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61"></a><h3 id="LNCPP-GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61" class="sect3"><span class="enumeration_section">12.6 </span>About Using Oracle Connection Manager in Traffic Director Mode
               </h3>
               <div>
                  <p>Oracle Connection Manager in Traffic Director Mode is a proxy that is placed between supported database clients and database instances.</p>
                  <div class="p">Supported clients from Oracle Database 11<span class="italic">g</span> Release 2 (11.2) and later can connect to Oracle Connection Manager in Traffic Director Mode. Oracle Connection Manager in Traffic Director Mode provides improved high availability (HA) for planned and unplanned database server outages, connection multiplexing support, and load balancing. Support for Oracle Connection Manager in Traffic Director Mode is described in more detail in the following sections
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__MODESOFOPERATION-4FD4C8FE">Modes of Operation</a></p>
                        </li>
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__KEYFEATURES-4FD4D08F">Key Features</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="section" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__MODESOFOPERATION-4FD4C8FE">
                     <p class="subhead2" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__GUID-749BC524-93BC-42F1-B765-970605875B7F">Modes of Operation</p>
                     <p>Oracle Connection Manager in Traffic Director Mode supports the following modes of operation:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <div class="p">In pooled connection mode, Oracle Connection Manager in Traffic Director Mode supports any application using the following database client releases:
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>OCI, OCCI, and Open Source Drivers (Oracle Database 11<span class="italic">g</span> release 2 (11.2.0.4) and later))
                                    </p>
                                 </li>
                                 <li>
                                    <p>JDBC (Oracle Database 12<span class="italic">c</span> release 1 (12.1) and later)
                                    </p>
                                 </li>
                                 <li>
                                    <p>ODP.NET (Oracle Database 12<span class="italic">c</span> release 2 (12.2) and later)
                                    </p>
                                 </li>
                              </ul>
                           </div>
                           <p>In addition, applications must use DRCP. That is, the application must enable DRCP in the connect string (or in the <code class="codeph">tnsnames.ora</code> alias).
                           </p>
                        </li>
                        <li>
                           <p>In non-pooled connection (or dedicated) mode, Oracle Connection Manager in Traffic Director Mode supports any application using database client releases Oracle Database 11<span class="italic">g</span> release 2 (11.2.0.4) and later. In this mode, some capabilities, such as connection multiplexing are not available. 
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__KEYFEATURES-4FD4D08F">
                     <p class="subhead2" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__GUID-3A52B2C3-D63C-4ACB-8FED-1BAFC3801338">Key Features</p>
                     <div class="p">Oracle Connection Manager in Traffic Director Mode furnishes support for the following:
                        <ul style="list-style-type: disc;">
                           <li>
                              <div class="p">Transparent performance enhancements and connection multiplexing, which includes:
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Statement caching, rows prefetching, and result set caching are auto-enabled for all modes of operation.</p>
                                    </li>
                                    <li>
                                       <p>Database session multiplexing (pooled mode only) using the proxy resident connection pool (PRCP), where PRCP is a proxy mode of Database Resident Connection Pooling (DRCP). Applications get transparent connect-time load balancing and run-time load balancing between Oracle Connection Manager in Traffic Director Mode and the database.</p>
                                    </li>
                                    <li>
                                       <p>For multiple Oracle Connection Manager in Traffic Director Mode instances, applications get increased scalability through client-side connect time load balancing or with a load balancer (BIG-IP, NGINX, and others)</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">Zero application downtime
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <div class="p">Planned database maintenance or pluggable database (PDB) relocation
                                          <ul style="list-style-type: disc;">
                                             <li>
                                                <p>Pooled mode</p>
                                                <p>Oracle Connection Manager in Traffic Director Mode responds to Oracle Notification Service (ONS) events for planned outages and redirects work. Connections are drained from the pool on Oracle Connection Manager in Traffic Director Mode when the request completes. Service relocation is supported for Oracle Database 11<span class="italic">g</span> release 2 (11.2.0.4) and later.
                                                </p>
                                                <p>For PDB relocation, Oracle Connection Manager in Traffic Director Mode responds to in-band notifications when a PDB is relocated, that is even when ONS is not configured (for Oracle Database release 18c, version 18.1 and later server only)&nbsp;</p>
                                             </li>
                                             <li>
                                                <p>Non-pooled or dedicated mode</p>
                                                <div class="p">When there is no request boundary information from the client, Oracle Connection Manager in Traffic Director Mode supports planned outage for many applications (as long as only simple session state and cursor state need to be preserved across the request/transaction boundaries). This support includes:
                                                   <ul style="list-style-type: disc;">
                                                      <li>
                                                         <p>Stop service/PDB at the transaction boundary or it leverages Oracle Database release 18c&nbsp;continuous application availability&nbsp;to stop the service at the request boundary</p>
                                                      </li>
                                                      <li>
                                                         <p>Oracle Connection Manager in Traffic Director Mode leverages Transparent Application Failover (TAF) failover restore to reconnect and restore simple states.</p>
                                                      </li>
                                                   </ul>
                                                </div>
                                             </li>
                                          </ul>
                                       </div>
                                    </li>
                                    <li>
                                       <p>Unplanned database outages for read-mostly workloads</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">High Availability of Oracle Connection Manager in Traffic Director Mode to avoid a single point of failure. This is supported by:
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Multiple instances of Oracle Connection Manager in Traffic Director Mode using a load balancer or client side load balancing/failover in the connect string</p>
                                    </li>
                                    <li>
                                       <p>Rolling upgrade of Oracle Connection Manager in Traffic Director Mode instances</p>
                                    </li>
                                    <li>
                                       <p>Graceful close of existing connections from client to Oracle Connection Manager in Traffic Director Mode for planned outages</p>
                                    </li>
                                    <li>
                                       <p>In-band notifications to Oracle Database release 18c and later clients</p>
                                    </li>
                                    <li>
                                       <p>For older clients, notifications are sent with the response of the current request</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">For security and isolation, Oracle Connection Manager in Traffic Director Mode furnishes:
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Database Proxy supporting transmission control protocol/transmission control protocol secure (TCP/TCPS) and protocol conversion</p>
                                    </li>
                                    <li>
                                       <p>Firewall based on the IP address, service name, and secure socket layer/transport layer security (SSL/TLS) wallets</p>
                                    </li>
                                    <li>
                                       <p>Tenant isolation in a multi-tenant environment</p>
                                    </li>
                                    <li>
                                       <p>Protection against denial-of-service and fuzzing attacks</p>
                                    </li>
                                    <li>
                                       <p>Secure tunneling of database traffic across Oracle Database on-premises and Oracle Cloud</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__GUID-A2DD3A99-8792-4704-A482-B66B30AD1B85">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-3917FC5D-4B23-4752-85BA-39A88C4D13F8" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> for information about configuring <code class="codeph">cman.ora</code> configuration file to set up Oracle Connection Manager in Traffic Director Mode
                              </p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-58847B76-3836-41DB-9EB6-A81D5C397024" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> for information about configuring databases for Oracle Connection Manager in Traffic Director Mode proxy authentication
                              </p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-96FA23BA-F32B-4D47-9CBB-69D27E8D94F6" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> for information about configuring Oracle Connection Manager in Traffic Director Mode for unplanned down events
                              </p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-E73658E7-BBF7-4C13-AAD5-70D32062AD8D" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> for information about configuring Oracle Connection Manager in Traffic Director Mode for planned down events
                              </p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-15756B12-5ED5-4EDE-9D4B-6B890D5BE9AF" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span> </a> for information about configuring proxy resident connection pools for use by Oracle Connection Manager in Traffic Director Mode
                              </p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lncpp&amp;id=NETAG-GUID-FC833F8F-CE5A-4C02-A962-244954158853" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> for information about functionality not supported for all drivers with Oracle Connection Manager in Traffic Director Mode
                              </p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lncpp&amp;id=NETRF-GUID-668B9035-0B99-4CDF-B7D5-468B30AD7A80" target="_blank"><span><cite>Oracle Database Net Services Reference</cite></span></a> for an overview of Oracle CMAN configuration file
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="LNCPP20028"></a><div class="props_rev_3"><a id="GUID-5F06D230-7248-4BB0-AC4C-0BC42AC6B3AC" name="GUID-5F06D230-7248-4BB0-AC4C-0BC42AC6B3AC"></a><h3 id="LNCPP-GUID-5F06D230-7248-4BB0-AC4C-0BC42AC6B3AC" class="sect3"><span class="enumeration_section">12.7 </span>About Run-time Load Balancing of the Stateless Connection Pool
               </h3>
               <div>
                  <p>Run-time load balancing in a stateless connection pool dynamically routs connection requests to the least loaded instance of the database. This is achieved by use of service metrics, which are distributed by the Oracle RAC load-balancing advisory.</p>
                  <p>The feature modifies the stateless connection pool in the following ways:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The pool receives periodic notifications about the instance load.</p>
                     </li>
                     <li>
                        <p>When a request for a connection is received, the pool picks the best possible connection for the type of request, based on the load of the instance.</p>
                     </li>
                     <li>
                        <p>The stateless connection pool periodically terminates connections of overloaded instances, maintaining the connection topology that corresponds to the instance load.</p>
                     </li>
                     <li>
                        <p>Since the connections to overloaded instances may be terminated, the pool creates new connections to maintain the concurrency requirement. These new connections are created using the connect-time load balancing of the Oracle RAC listener.</p>
                     </li>
                  </ul>
                  <p>Run-time load balancing is turned on by default when the OCCI environment is created in <code class="codeph">THREADED_MUTEXED</code> and <code class="codeph">EVENTS</code> modes, and when the server is configured to issue event notifications.
                  </p>
                  <div class="infoboxnotealso" id="GUID-5F06D230-7248-4BB0-AC4C-0BC42AC6B3AC__GUID-14845788-AC87-4745-A21F-DFF4FD4F1AF3">
                     <p class="notep1">See Also:</p>
                     <p><a href="../lnoci/index.html" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a></p>
                  </div>
                  <p>This section includes the following topic: <a href="optimizing-performance-of-cplusplus-applications.html#GUID-7DBAD779-65CD-4AED-9A9B-C48D8D533337">API Support</a>.
                  </p>
               </div><a id="LNCPP20491"></a><div class="props_rev_3"><a id="GUID-7DBAD779-65CD-4AED-9A9B-C48D8D533337" name="GUID-7DBAD779-65CD-4AED-9A9B-C48D8D533337"></a><h4 id="LNCPP-GUID-7DBAD779-65CD-4AED-9A9B-C48D8D533337" class="sect4"><span class="enumeration_section">12.7.1 </span>API Support
                  </h4>
                  <div>
                     <p>New <code class="codeph">NO_RLB</code> option for the <code class="codeph">PoolType</code> attribute of the <a href="statelessconnectionpool-class.html#GUID-C0591485-F818-4AC0-9875-ED245BDABCA6">StatelessConnectionPool Class</a> disables run-time load balancing.
                     </p>
                  </div>
               </div>
            </div><a id="LNCPP1206"></a><div class="props_rev_3"><a id="GUID-8ADCAB82-EBBE-43C0-BECE-4E74687A166D" name="GUID-8ADCAB82-EBBE-43C0-BECE-4E74687A166D"></a><h3 id="LNCPP-GUID-8ADCAB82-EBBE-43C0-BECE-4E74687A166D" class="sect3"><span class="enumeration_section">12.8 </span>About Fault Diagnosability
               </h3>
               <div>
                  <p>Fault diagnosability captures diagnostic data, such as dump files or core dump files, on the OCCI client when a problem incident occurs. For each incident, the fault diagnosability feature creates an Automatic Diagnostic Repository (ADR) subdirectory for storing this diagnostic data. For example, if either a Linux or a UNIX application fails with a null pointer reference, then the core file appears in the ADR home directory (if it exists), not in the operating system directory. This section discusses the ADR subdirectory structure and the utility to manage its output, the ADR Command Interpreter (ADRCI).</p>
                  <p>An ADR home is the root directory for all diagnostic data for an instance of a product, such as OCCI, and a particular operating system user. All ADR homes appear under the same root directory, the ADR base. </p>
                  <div class="infoboxnotealso" id="GUID-8ADCAB82-EBBE-43C0-BECE-4E74687A166D__GUID-0B2FA5EE-F101-448F-A5A3-786E12127A41">
                     <p class="notep1">See Also:</p>
                     <p><a href="../admin/diagnosing-and-resolving-problems.html#ADMIN11007" target="_blank"><span><cite>Oracle Database Administrators Guide</cite></span></a></p>
                     <div class="p">This section includes the following topics:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA">Using ADR Base Location</a></p>
                           </li>
                           <li>
                              <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A">Using ADRCI</a></p>
                           </li>
                           <li>
                              <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-20C6A172-C450-44C0-BE4E-CE7AEF56F243">Controlling ADR Creation and Disabling Fault Diagnosability</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="LNCPP20492"></a><div class="props_rev_3"><a id="GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA" name="GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA"></a><h4 id="LNCPP-GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA" class="sect4"><span class="enumeration_section">12.8.1 </span>Using ADR Base Location
                  </h4>
                  <div>
                     <div class="section">
                        <p>The location of the ADR base is determined in the following order:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>In the <code class="codeph">sqlnet.ora</code> file (on <span class="italic"><span class="bold">Windows</span></span>, in the <code class="codeph">%TNS_ADMIN%</code> directory, or on <span class="italic"><span class="bold">Linux</span></span> or <span class="italic"><span class="bold">UNIX</span></span>, in the <code class="codeph">$TNS_ADMIN</code> directory).</span><div>
                              <p>If there is no <code class="codeph">TNS_ADMIN</code> directory, then <code class="codeph">sqlnet.ora</code> is stored in the current directory.
                              </p>
                              <p>If the ADR base is listed in the <code class="codeph">sqlnet.ora</code> file, it is a statement of the type:
                              </p><pre class="oac_no_warn" dir="ltr">ADR_BASE=<span class="italic">/directory/adr</span>
</pre><p>where:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>The <span class="italic"><code class="codeph">adr</code></span> argument is a directory that must exist and be writable by all operating system users who execute OCCI applications and want to share the same ADR base.
                                    </p>
                                 </li>
                                 <li>
                                    <p>The <span class="italic"><code class="codeph">directory</code></span> argument is the path name
                                    </p>
                                 </li>
                              </ul>
                              <p>If <code class="codeph">ADR_BASE</code> is set, and if all users share a single <code class="codeph">sqlnet.ora</code> file, then OCCI stops searching when directory <code class="codeph">adr</code> does not exist or if it is not writable. If <code class="codeph">ADR_BASE</code> is not set, then OCCI continues the search, testing for the existence of other specific directories.
                              </p>
                              <p>For example, if <code class="codeph">sqlnet.ora</code> contains the entry <code class="codeph">ADR_BASE=/home/chuck/test</code> then:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p> ADR base is: </p><pre class="oac_no_warn" dir="ltr">/home/chuck/test/oradiag_chuck
</pre></li>
                                 <li>
                                    <p>ADR home may be: </p><pre class="oac_no_warn" dir="ltr">/home/chuck/test/oradiag_chuck/diag/clients/user_chuck/host_4144260688_11
</pre></li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>If the Oracle base exists (on <span class="italic"><span class="bold">Windows</span></span>: <span class="italic"><code class="codeph">%ORACLE_BASE%</code></span>, or on <span class="italic"><span class="bold">Linux</span></span> and <span class="italic"><span class="bold">UNIX</span></span>: <span class="italic"><code class="codeph">$ORACLE_BASE</code></span>), the client subdirectory also exists because it is created by the Oracle Universal Installer when the database is installed.</span><div>
                              <p>For example, if <span class="italic"><code class="codeph">$ORACLE_BASE</code></span> is <code class="codeph">/home/chuck/obase</code> , then:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p> ADR base is:</p><pre class="oac_no_warn" dir="ltr">/home/chuck/obase
</pre></li>
                                 <li>
                                    <p>ADR home may be: </p><pre class="oac_no_warn" dir="ltr">/home/chuck/obase/diag/clients/user_chuck/host_4144260688_11
</pre></li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>If the Oracle home exists (on <span class="italic"><span class="bold">Windows</span></span>: <span class="italic"><code class="codeph">%ORACLE_HOME%</code></span>, or on <span class="italic"><span class="bold">Linux</span></span> and <span class="italic"><span class="bold">UNIX</span></span>: <span class="italic"><code class="codeph">$ORACLE_HOME</code></span>), the client subdirectory also exists because it is created by the Oracle Universal Installer when the database is installed.</span><div>
                              <p>For example, if <span class="italic"><code class="codeph">$ORACLE_HOME</code></span> is <code class="codeph">/ade/chuck_l1/oracle</code> , then:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p> ADR base is:</p><pre class="oac_no_warn" dir="ltr">/ade/chuck_l1/oracle/log
</pre></li>
                                 <li>
                                    <p>ADR home may be: </p><pre class="oac_no_warn" dir="ltr">/ade/chuck_l1/oracle/log/diag/clients/user_chuck/host_4144260688_11
</pre></li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>On the operating system home directory.</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>On <span class="italic"><span class="bold">Windows</span></span>, the operating system home directory is <span class="italic"><code class="codeph">%USERPROFILE%</code></span>.
                                    </p>
                                    <p>The location of folder <code class="codeph">Oracle</code> is at: 
                                    </p><pre class="oac_no_warn" dir="ltr">C:\Documents and Settings\chuck
</pre><p>If the application runs as a service, the home directory option is skipped.</p>
                                 </li>
                                 <li>
                                    <p>On <span class="italic"><span class="bold">Linux</span></span> and <span class="italic"><span class="bold">UNIX</span></span>, the operating system home directory is <span class="italic"><code class="codeph">$HOME</code></span>.
                                    </p>
                                    <p>The location may be: </p><pre class="oac_no_warn" dir="ltr">/home/chuck/oradiag_chuck
</pre></li>
                              </ul>
                              <p>For example, in an Instant Client, if <span class="italic"><code class="codeph">$HOME</code></span> is <code class="codeph">/home/chuck</code>, then:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p> ADR base is:</p><pre class="oac_no_warn" dir="ltr">/home/chuck/oradiag_chuck
</pre></li>
                                 <li>
                                    <p>ADR home may be: </p><pre class="oac_no_warn" dir="ltr">/home/chuck/oradiag_chuck/diag/clients/user_chuck/host_4144260688_11
</pre></li>
                              </ul>
                              <div class="infoboxnotealso" id="GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA__GUID-7D725391-A376-4CF6-9BB0-C574EDC9FC22">
                                 <p class="notep1">See Also:</p>
                                 <p><span class="q">"<a href="installation-and-upgrading.html#GUID-5556BCFD-E14D-4562-A0CE-5AFAD47AC08F">About the Instant Client</a>"</span></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>In the temporary directory.</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>On <span class="italic"><span class="bold">Windows</span></span>, the temporary directories are searched in the following order:
                                    </p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p><code class="codeph">%TMP%</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">%TEMP%</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">%USERPROFILE%</code></p>
                                       </li>
                                       <li>
                                          <p>Windows system directory</p>
                                       </li>
                                    </ul>
                                 </li>
                                 <li>
                                    <p>On <span class="italic"><span class="bold">Linux</span></span> and <span class="italic"><span class="bold">UNIX</span></span>, the temporary directory is in <code class="codeph">/var/tmp</code>. 
                                    </p>
                                 </li>
                              </ul>
                              <p>For example, in an Instant Client, if <span class="italic"><code class="codeph">$HOME</code></span> is not writable, then:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p> ADR base is:</p><pre class="oac_no_warn" dir="ltr">/var/tmp/oradiag_chuck
</pre></li>
                                 <li>
                                    <p>ADR home may be: </p><pre class="oac_no_warn" dir="ltr">/var/tmp/oradiag_chuck/diag/clients/user_chuck/host_4144260688_11
</pre></li>
                              </ul>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>If none of these directory choices are available and writable, ADR is not created and diagnostics are not stored.</p>
                        <div class="infoboxnotealso" id="GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA__GUID-068B4674-3807-49CB-AB44-D36C6F44DCE6">
                           <p class="notep1">See Also:</p>
                           <p><a href="../netrf/index.html" target="_blank"><span><cite>Oracle Database Net Services Reference</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNCPP20494"></a><a id="LNCPP20495"></a><a id="LNCPP20493"></a><div class="props_rev_3"><a id="GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A" name="GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A"></a><h4 id="LNCPP-GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A" class="sect4"><span class="enumeration_section">12.8.2 </span>Using ADRCI
                  </h4>
                  <div>
                     <div class="section">
                        <p>ADRCI is a command-line tool that enables you to view diagnostic data within the ADR, and to package incident and problem information into a zip file that can be shared with Oracle Support. ADRCI can be used either interactively and through a script. </p>
                        <p>A <span class="bold">problem</span> is a critical error in OCI or the client. Each problem has a problem key. An <span class="bold">incident</span> is a single occurrence of a problem, and it is identified by a unique numeric incident ID. Each incident has a problem key which has a set of attributes: the <code class="codeph">ORA</code> error number, error parameter values, and similar information. Two incidents have the same root cause if their problem keys match.
                        </p>
                        <p>The following examples demonstrate how to use ADRCI on a Linux operating system. Note that ARDCI commands are case-insensitive. All user input is in bold typeface.</p>
                        <div class="infoboxnotealso" id="GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A__GUID-E3351A51-3514-47B0-9B28-2F4690F4B6E7">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../sutil/oracle-adr-command-interpreter-adrci.html#SUTIL700" target="_blank"><span><cite>Oracle Database Utilities</cite></span></a>for an introduction to the ADRCI
                                 </p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="installation-and-upgrading.html#GUID-5556BCFD-E14D-4562-A0CE-5AFAD47AC08F">About the Instant Client</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A__GUID-6A25581C-7456-40D0-A025-EF54C747C2EF">
                        <p class="titleinexample">Example 12-6 How to Use ADRCI for OCCI Application Incidents</p>
                        <p>To launch ADRCI in a Linux system, use the <code class="codeph">adrci</code> command. Once ADRCI starts, find out the particulars of the <code class="codeph">show base</code> command with <code class="codeph">help</code>, and then determine the base of a particular client using the <code class="codeph">-product client</code> option (necessary for OCCI applications). To set the ADRCI base, use the set base command. Once <code class="codeph">ADRCI</code> starts, then the default ADR base is for the <code class="codeph">rdbms</code> server. The <span class="italic"><code class="codeph">$ORACLE_HOME</code></span> is set to <code class="codeph">/ade/chuck_l3/oracle</code>. To view the incidents, use the <code class="codeph">show incidents</code> command. to exit ADRCI, use the <code class="codeph">quit</code> command.
                        </p><pre class="oac_no_warn" dir="ltr">% <span class="bold">adrci</span> 

ADRCI: Release 11.2. - on Wed November 25 16:16:55 2008
 
Copyright (c) 1982, 2008, Oracle.  All rights reserved.

adrci&gt; <span class="bold">help show base</span>
 
  Usage: SHOW BASE [-product &lt;product_name&gt;]
 
  Purpose: Show the current ADR base setting.
 
  Options:
    [-product &lt;product_name&gt;]: This option allows users to show the
    given product's ADR Base location. The current registered products are
    "CLIENT" and "ADRCI".
 
  Examples: 
    show base -product client
    show base
 
adrci&gt; <span class="bold">show base -product client</span>
ADR base is "/ade/chuck_l3/oracle/log"

adrci&gt; <span class="bold">help set base</span>
 
  Usage:  SET BASE &lt;base_str&gt;
 
  Purpose: Set the ADR base to use in the current ADRCI session.
           If there are valid ADR homes under the base, all homes 
           are added to the current ADRCI session.
 
  Arguments:
    &lt;base_str&gt;: It is the ADR base directory, which is a system-dependent
    directory path string.
 
  Notes:
    On platforms that use "." to signify current working directory,
    it can be used as base_str.
 
  Example: 
    set base /net/sttttd1/scratch/someone/view_storage/someone_v1/log
    set base .

adrci&gt; <span class="bold">set base /ade/chuck_l3/oracle/log</span>

adrci&gt; <span class="bold">show incidents</span>
...
adrci&gt; <span class="bold">quit</span></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A__GUID-794139B0-25F9-4654-99E3-9E54F0D86006">
                        <p class="titleinexample">Example 12-7 How to Use ADRCI for Instant Client</p>
                        <p>Because Instant Client does not use <span class="italic"><code class="codeph">$ORACLE_HOME</code></span>, the default ADR base is the user's home directory.
                        </p><pre class="oac_no_warn" dir="ltr">adrci&gt; <span class="bold">show base -product client</span>
ADR base is "/home/chuck/oradiag_chuck"
adrci&gt; <span class="bold">set base /home/chuck/oradiag_chuck</span>
adrci&gt; <span class="bold">show incidents</span>
 
ADR Home = /home/chuck/oradiag_chuck/diag/clients/user_chuck/host_4144260688_11:
*************************************************************************
INCIDENT_ID    PROBLEM_KEY           CREATE_TIME
-------------------------------------------------------------------------
1                     oci 24550 [6]              2007-05-01 17:20:02.803697 -07:00                      
1 rows fetched
 
adrci&gt; <span class="bold">quit</span></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="LNCPP20496"></a><div class="props_rev_3"><a id="GUID-20C6A172-C450-44C0-BE4E-CE7AEF56F243" name="GUID-20C6A172-C450-44C0-BE4E-CE7AEF56F243"></a><h4 id="LNCPP-GUID-20C6A172-C450-44C0-BE4E-CE7AEF56F243" class="sect4"><span class="enumeration_section">12.8.3 </span>Controlling ADR Creation and Disabling Fault Diagnosability
                  </h4>
                  <div>
                     <div class="section">
                        <p>To disable the fault diagnosability feature, you must turn off the capture of diagnostics. Edit the <code class="codeph">sqlnet.ora</code> file by changing the values of the <code class="codeph">DIAG_ADR_ENABLED</code> and <code class="codeph">DIAG_DDE_ENABLED</code> parameters to either <code class="codeph">FALSE</code> or <code class="codeph">OFF</code>; the default values are either <code class="codeph">TRUE</code> or <code class="codeph">ON</code>.
                        </p>
                        <p>To turn off the OCCI signal handler and to re-enable standard operating system failure processing, edit the <code class="codeph">sqlnet.ora</code> file by adding the corresponding parameter: <code class="codeph">DIAG_SIGHANDLER_ENABLED=FALSE</code>.
                        </p>
                        <div class="infoboxnotealso" id="GUID-20C6A172-C450-44C0-BE4E-CE7AEF56F243__GUID-62806A91-EF36-40C9-85F7-F74B42829BA5">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lncpp&amp;id=LNOCI-GUID-E100960D-1E4F-4C3D-A6A3-0D5A5FB06B4C" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="LNCPP21897"></a><a id="LNCPP21896"></a><div class="props_rev_3"><a id="GUID-740894FB-9DAE-4F98-BA70-0C4E04479200" name="GUID-740894FB-9DAE-4F98-BA70-0C4E04479200"></a><h3 id="LNCPP-GUID-740894FB-9DAE-4F98-BA70-0C4E04479200" class="sect3"><span class="enumeration_section">12.9 </span>Using Client Result Cache
               </h3>
               <div>
                  <div class="section">
                     <p>The Client Result Cache improves the response times of queries that are executed repeatedly. This feature uses client memory to cache results of SQL queries executed and fetched from the database. Subsequent execution of the same query fetches the results from the client cache, reducing server CPU usage. Because database round-trips are eliminated, applications have improved response times.</p>
                     <p>OCCI applications may transparently use the Client Result Cache feature by enabling OCCI statement caching. Note that <code class="codeph">SELECT</code> queries that must be cached are annotated with a <code class="codeph">/*+ result_cache */</code> hint. <a href="optimizing-performance-of-cplusplus-applications.html#GUID-740894FB-9DAE-4F98-BA70-0C4E04479200__CIADDJCA">Example 12-8</a> shows how to create a OCCI Statement object that uses such a <code class="codeph">SELECT</code> query.
                     </p>
                     <p>For usage guidelines, cache consistency, and restrictions, see <a href="../lnoci/performance-topics.html#LNOCI10103" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-740894FB-9DAE-4F98-BA70-0C4E04479200__CIADDJCA">
                     <p class="titleinexample">Example 12-8 How to Enable and Use the Client Result Cache</p><pre class="oac_no_warn" dir="ltr">Connection *conn;
Statement *stmt;
ResultSet *rs;
 
...
//enable OCCI Statement Caching
conn-&gt;setStmtCacheSize(20);
 
//Specify the hint in the SELECT query
stmt = conn-&gt;createStatement("select /*+ result_cache */ * from products \
                              where product_id = :1");
 
//the following execute fetches rows from the client cache if
//the query results are cached. If this is the first execute
//of the query, the results fetched from the server are
//cached on the client side.
rs = stmt-&gt;executeQuery();
</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="LNCPP78967"></a><div class="props_rev_3"><a id="GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052" name="GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052"></a><h3 id="LNCPP-GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052" class="sect3"><span class="enumeration_section">12.10 </span>About Client-Side Deployment Parameters and Auto Tuning
               </h3>
               <div>
                  <p>Starting with Oracle Database Release 12<span class="italic">c</span> Release 1 (12.1), Oracle provides <code class="codeph">oraaccess.xml</code>, a client-side configuration file that can be used to configure selected properties, allowing the application behavior to be changed during deployment without modifying the source code.
                  </p>
                  <div class="infoboxnote" id="GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052__GUID-40C288AE-8E23-4CC1-B185-6B79C6745052">
                     <p class="notep1">Note:</p>
                     <p>Do not use the prefetch deployment parameter if the OCCI application is already using the <code class="codeph">setPrefetchRowCount()</code> or <code class="codeph">setPrefetchMemorySize()</code> methods.
                     </p>
                  </div>
                  <div class="infoboxnote" id="GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052__GUID-A0EC8D27-7D85-4E91-BB2E-C3BD9FAB5EBD">
                     <p class="notep1">See:</p>
                     <p><a href="../lnoci/index.html" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a> for more information about client-side deployment parameters and auto tuning
                     </p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>