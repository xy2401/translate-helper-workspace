<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Using DBFS</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database SecureFiles and Large Objects Developer's Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database SecureFiles and Large Objects Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="securefiles-and-large-objects-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T02:58:18-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96333-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="creating-your-own-DBFS-store.html" title="Previous" type="text/html">
      <link rel="next" href="LOB-demonstration-files.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SecureFiles and Large Objects Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADLOB">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="creating-your-own-DBFS-store.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="LOB-demonstration-files.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database SecureFiles and Large Objects Developer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="database-file-system.html" property="item" typeof="WebPage"><span property="name">   Database File System (DBFS)</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">   Using DBFS</li>
            </ol>
            <a id="GUID-817DFDC2-7729-4CB6-BAE7-598E9B021DD8" name="GUID-817DFDC2-7729-4CB6-BAE7-598E9B021DD8"></a><a id="ADLOB0006"></a>
            
            <h2 id="ADLOB-GUID-817DFDC2-7729-4CB6-BAE7-598E9B021DD8" class="sect2"><span class="enumeration_chapter">25 </span>   Using DBFS
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The DBFS File System implementation includes creating and accessing the file system and managing it.</p>
               <p>Topics: </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="using-DBFS.html#GUID-E0712718-FD3F-40DF-8B5A-EC689B1C65DA" title="DBFS is a part of the Oracle database installation and is installed under ORACLE_HOME.">DBFS Installation</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBFS.html#GUID-A4B1B3D5-7080-47EF-86C4-67D6E8F0FC37" title="A DBFS File system can be partitioned or non-partitioned. It may require users to have certain privileges.">Creating a DBFS File System</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBFS.html#GUID-B03D476F-934D-4AD8-B4D7-493B1C0D7513" title="You access a DBFS file system by means of prerequisites, access interfaces, the DBFS security model, and XML DB server protocols.">DBFS File System Access</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBFS.html#GUID-8665C1E7-C96A-4B17-A8F7-1889858EEF18" title="The dbfs_client program can failover to one of the other existing database instances if one of the database instances in an Oracle RAC cluster fails.">DBFS Administration</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBFS.html#GUID-68FE78C8-798C-40DB-8566-F09EB27F4CC9" title="DBFS Online Filesystem Reorganization is a powerful data movement facility with these certain advantages.">Shrinking and Reorganizing DBFS Filesystems</a></p>
                  </li>
               </ul>
            </div><a id="ADLOB45994"></a><div class="props_rev_3"><a id="GUID-E0712718-FD3F-40DF-8B5A-EC689B1C65DA" name="GUID-E0712718-FD3F-40DF-8B5A-EC689B1C65DA"></a><h3 id="ADLOB-GUID-E0712718-FD3F-40DF-8B5A-EC689B1C65DA" class="sect3">DBFS Installation</h3>
               <div>
                  <p>DBFS is a part of the Oracle database installation and is installed under <code class="codeph">ORACLE_HOME</code>. 
                  </p>
                  <p><code class="codeph">$ORACLE_HOME/rdbms/admin</code> contains these DBFS utility scripts: 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Content API (CAPI)</p>
                     </li>
                     <li>
                        <p>SecureFiles Store (SFS)</p>
                     </li>
                  </ul>
                  <p><code class="codeph">$ORACLE_HOME/bin</code> contains:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">dbfs_client</code> executable
                        </p>
                     </li>
                  </ul>
                  <p><code class="codeph">$ORACLE_HOME/rdbms/admin</code> contains:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p> SQL (<code class="codeph">.plb</code> extension) scripts for the content store
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="ADLOB45995"></a><div class="props_rev_3"><a id="GUID-A4B1B3D5-7080-47EF-86C4-67D6E8F0FC37" name="GUID-A4B1B3D5-7080-47EF-86C4-67D6E8F0FC37"></a><h3 id="ADLOB-GUID-A4B1B3D5-7080-47EF-86C4-67D6E8F0FC37" class="sect3">Creating a DBFS File System</h3>
               <div>
                  <p>A DBFS File system can be partitioned or non-partitioned. It may require users to have certain privileges.</p>
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="using-DBFS.html#GUID-579C0D02-6F1F-4723-B1FA-674615E1F5FD" title="Database users must have a minimum set of privileges to create a file system.">Privileges Required to Create a DBFS File System</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-D78E46D3-8C20-45E2-9418-D674EA45317B" title="You can create either non-partitioned or partitioned file systems. Partitioning is the best performing and most scalable way to create a file system in DBFS and is the default.">Advantages of Non-Partitioned Versus Partitioned DBFS File Systems</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-C66F22F9-1C95-41C4-8F32-EE46DF9E4A62" title="You can create a file system by running DBFS_CREATE_FILESYSTEM.SQL while logged in as a user with DBFS administrator privileges.">Creating a Non-Partitioned File System</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-8735D535-2E13-4702-95F9-01F931F2BF46" title="Partitioning creates multiple physical segments in the database, and files are distributed randomly in these partitions.">Creating a Partitioned File System</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-04EDEAFA-765A-44BA-98D6-B7DD415B9020" title="You can drop a file system by running DBFS_DROP_FILESYSTEM.SQL.">Dropping a File System</a></p>
                     </li>
                  </ul>
               </div><a id="ADLOB46187"></a><div class="props_rev_3"><a id="GUID-579C0D02-6F1F-4723-B1FA-674615E1F5FD" name="GUID-579C0D02-6F1F-4723-B1FA-674615E1F5FD"></a><h4 id="ADLOB-GUID-579C0D02-6F1F-4723-B1FA-674615E1F5FD" class="sect4">Privileges Required to Create a DBFS File System</h4>
                  <div>
                     <p>Database users must have a minimum set of privileges to create a file system. </p>
                     <p>Users must have these privileges: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">GRANT CONNECT</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">CREATE SESSION</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">RESOURCE</code>, <code class="codeph">CREATE TABLE</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">CREATE PROCEDURE</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DBFS_ROLE</code></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADLOB46188"></a><div class="props_rev_3"><a id="GUID-D78E46D3-8C20-45E2-9418-D674EA45317B" name="GUID-D78E46D3-8C20-45E2-9418-D674EA45317B"></a><h4 id="ADLOB-GUID-D78E46D3-8C20-45E2-9418-D674EA45317B" class="sect4">Advantages of Non-Partitioned Versus Partitioned DBFS File Systems</h4>
                  <div>
                     <p>You can create either non-partitioned or partitioned file systems. Partitioning is the best performing and most scalable way to create a file system in DBFS and is the default. </p>
                     <p>Space cannot be shared between partitions, so it is possible for one partition to run out of space even when other partitions have space. This is usually not an issue if the file system size is big compared to the size of the individual files. However, if file sizes are a big percentage of the file system size, it may result in the <code class="codeph">ENOSPC</code> error even if the file system is not full.
                     </p>
                     <p>Another implication of partitioning is that a <span class="italic">rename</span> operation can require rewriting the file, which can be expensive if the file is big.
                     </p>
                  </div>
               </div><a id="ADLOB46189"></a><div class="props_rev_3"><a id="GUID-C66F22F9-1C95-41C4-8F32-EE46DF9E4A62" name="GUID-C66F22F9-1C95-41C4-8F32-EE46DF9E4A62"></a><h4 id="ADLOB-GUID-C66F22F9-1C95-41C4-8F32-EE46DF9E4A62" class="sect4">Creating a Non-Partitioned File System</h4>
                  <div>
                     <p>You can create a file system by running <code class="codeph">DBFS_CREATE_FILESYSTEM.SQL</code> while logged in as a user with DBFS administrator privileges. 
                     </p>
                     <div class="section">
                        <p>These steps enable you to create a file system. </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Log in to the database instance:</span><div><pre class="oac_no_warn" dir="ltr">$ sqlplus <span class="italic">dbfs_user</span>/<span class="italic">@db_server</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Enter the following command:</span><div><pre class="oac_no_warn" dir="ltr">@$ORACLE_HOME/rdbms/admin/dbfs_create_filesystem.sql <span class="italic">tablespace_name</span>
     <span class="italic">file_system_name</span>
</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>For example, to create a file system called <code class="codeph">staging_area</code> in an existing tablespace <code class="codeph">dbfs_tbspc</code>:
                        </p><pre class="oac_no_warn" dir="ltr">$ sqlplus <span class="italic">dbfs_user</span>/<span class="italic">db_server</span>
   @$ORACLE_HOME/rdbms/admin/dbfs_create_filesystem.sql
   dbfs_tbspc staging_area</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB46190"></a><div class="props_rev_3"><a id="GUID-8735D535-2E13-4702-95F9-01F931F2BF46" name="GUID-8735D535-2E13-4702-95F9-01F931F2BF46"></a><h4 id="ADLOB-GUID-8735D535-2E13-4702-95F9-01F931F2BF46" class="sect4">Creating a Partitioned File System</h4>
                  <div>
                     <p>Partitioning creates multiple physical segments in the database, and files are distributed randomly in these partitions.</p>
                     <div class="section">
                        <p>You can create a partitioned file system by running <code class="codeph">DBFS_CREATE_FILESYSTEM</code><code class="codeph">_ADVANCED</code>.<code class="codeph">SQL</code> while logged in as a user with DBFS administrator privileges. 
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Log in to the database instance:</span><div><pre class="oac_no_warn" dir="ltr">$ sqlplus <span class="italic">dbfs_user</span>/<span class="italic">@db_server</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Enter the following command:</span><div><pre class="oac_no_warn" dir="ltr">@$ORACLE_HOME/rdbms/admin/dbfs_create_filesystem_advanced.sql tablespace_name
       <span class="italic">file_system_name</span> nocompress nodeduplicate noencrypt partition
</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>For example, to create a partitioned file system called <code class="codeph">staging_area</code> in an existing tablespace <code class="codeph">dbfs_tbspc</code>:
                        </p><pre class="oac_no_warn" dir="ltr">$ sqlplus <span class="italic">dbfs_user</span>/<span class="italic">@db_server</span>  
       @$ORACLE_HOME/rdbms/admin/dbfs_create_filesystem_advanced.sql dbfs_tbspc
       staging_area nocompress nodeduplicate noencrypt partition
</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB45996"></a><div class="props_rev_3"><a id="GUID-04EDEAFA-765A-44BA-98D6-B7DD415B9020" name="GUID-04EDEAFA-765A-44BA-98D6-B7DD415B9020"></a><h4 id="ADLOB-GUID-04EDEAFA-765A-44BA-98D6-B7DD415B9020" class="sect4">Dropping a File System</h4>
                  <div>
                     <p>You can drop a file system by running <code class="codeph">DBFS_DROP_FILESYSTEM.SQL</code>. 
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Log in to the database instance:</span><div><pre class="oac_no_warn" dir="ltr">$ sqlplus <span class="italic">dbfs_user</span>/<span class="italic">@db_server</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Enter the following command:</span><div><pre class="oac_no_warn" dir="ltr">@$ORACLE_HOME/rdbms/admin/dbfs_drop_filesystem.sql <span class="italic"><code class="codeph">file_system_name</code></span>
</pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="ADLOB46191"></a><div class="props_rev_3"><a id="GUID-B03D476F-934D-4AD8-B4D7-493B1C0D7513" name="GUID-B03D476F-934D-4AD8-B4D7-493B1C0D7513"></a><h3 id="ADLOB-GUID-B03D476F-934D-4AD8-B4D7-493B1C0D7513" class="sect3">DBFS File System Access</h3>
               <div>
                  <p>You access a DBFS file system by means of prerequisites, access interfaces, the DBFS security model, and XML DB server protocols.</p>
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="using-DBFS.html#GUID-A1D6C48E-E6AF-450A-8F0E-52FEBF06197B" title="The DBFS File System Client, which is named dbfs_client, runs on each system that will access DBFS filesystems, using certain prerequisites.">DBFS Client Prerequisites</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-F436D220-6BE5-4D72-BF2C-D59B343616CA" title="The DBFS client command-line interface allows you to directly access files stored in DBFS.">DBFS Client Command-Line Interface Operations</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-6B646446-BD50-44CD-9C52-4B1039242910" title="You can mount DBFS using the dbfs_client in Linux and Solaris only.">DBFS Mounting Interface (Linux and Solaris Only)</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-85540258-FBB9-452B-8C20-F1D00A2ECA31">File System Security Model </a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-D6AE78C9-C618-4842-8B44-2BE42E1BEDE3">HTTP_ WebDAV_ and FTP Access to DBFS</a></p>
                     </li>
                  </ul>
               </div><a id="ADLOB45992"></a><div class="props_rev_3"><a id="GUID-A1D6C48E-E6AF-450A-8F0E-52FEBF06197B" name="GUID-A1D6C48E-E6AF-450A-8F0E-52FEBF06197B"></a><h4 id="ADLOB-GUID-A1D6C48E-E6AF-450A-8F0E-52FEBF06197B" class="sect4">DBFS Client Prerequisites</h4>
                  <div>
                     <p>The DBFS File System Client, which is named <code class="codeph">dbfs_client</code>, runs on each system that will access DBFS filesystems, using certain prerequisites.
                     </p>
                     <p> The prerequisites for the DBFS File System Client, <code class="codeph">dbfs_client</code>, are: 
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The <code class="codeph">dbfs_</code><code class="codeph">client</code> host must have the Oracle client libraries installed. 
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">dbfs_client</code> can be used as a direct RDBMS client using the DBFS Command Interface on Linux, Linux.X64, Solaris, Solaris64, AIX, HPUX and Windows platforms.
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">dbfs_client</code> can only be used as a mount client on Linux, Linux.X64, and Solaris 11 platforms. This requires the following:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">dbfs_client</code> host must have the <code class="codeph">FUSE</code> Linux package or the Solaris <code class="codeph">libfuse</code> package installed.
                                 </p>
                              </li>
                              <li>
                                 <p>A group named <code class="codeph">fuse</code> must be created, with the user name that runs the <code class="codeph">dbfs_client</code> as a member.
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-A1D6C48E-E6AF-450A-8F0E-52FEBF06197B__NOTE-14334-DFF87B69">
                              <p class="notep1">See Also:</p>
                              <p><a href="using-DBFS.html#GUID-6B646446-BD50-44CD-9C52-4B1039242910" title="You can mount DBFS using the dbfs_client in Linux and Solaris only.">DBFS Mounting Interface (Linux and Solaris Only)</a> for further details.
                              </p>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADLOB46002"></a><div class="props_rev_3"><a id="GUID-F436D220-6BE5-4D72-BF2C-D59B343616CA" name="GUID-F436D220-6BE5-4D72-BF2C-D59B343616CA"></a><h4 id="ADLOB-GUID-F436D220-6BE5-4D72-BF2C-D59B343616CA" class="sect4">DBFS Client Command-Line Interface Operations</h4>
                  <div>
                     <p>The DBFS client command-line interface allows you to directly access files stored in DBFS. </p>
                     <p>Topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="using-DBFS.html#GUID-456ECF58-F9B5-4F53-8111-B88079DE7650" title="The DBFS client command-line interface allows you to perform many pre-defined commands, such as copy files in and out of the DBFS filesystem from any host on the network.">About the DBFS Client Command-Line Interface</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-CF1B0455-8D24-44BA-9E74-167AC8A01FE5" title="You can create a content store path by providing a path name">Creating Content Store Paths</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-9022B3BF-FF83-4B71-85F1-449CDBF34B28" title="You can use the mkdir command to create a new directory.">Creating a Directory</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-FD6E5F79-2DE5-4F4E-99D2-6AF7D571ECBA" title="You can use the ls command to list the contents of a directory.">Listing a Directory</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-240F6913-94D1-4646-8130-8A3942298EE1" title="You can use the cp command to copy files or directories from the source location to the destination location.">Copying Files and Directories</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-FD1B94B7-57A3-4A53-9C46-ACB75A348B7A" title="You can use the command rm to delete a file or directory.">Removing Files and Directories</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="props_rev_3"><a id="GUID-456ECF58-F9B5-4F53-8111-B88079DE7650" name="GUID-456ECF58-F9B5-4F53-8111-B88079DE7650"></a><h5 id="ADLOB-GUID-456ECF58-F9B5-4F53-8111-B88079DE7650" class="sect5">About the DBFS Client Command-Line Interface</h5>
                     <div>
                        <p>The DBFS client command-line interface allows you to perform many pre-defined commands, such as copy files in and out of the DBFS filesystem from any host on the network.</p>
                        <p></p>
                        <p>The command-line interface has slightly better performance than the DBFS client mount interface because it does not mount the file system, thus bypassing the user space file system. However, it is not transparent to applications. </p>
                        <p>The DBFS client mount interface allows DBFS to be mounted through a file system mount point thus providing transparent access to files stored in DBFS with generic file system operations. </p>
                        <p>To run DBFS commands, specify <code class="codeph">--command</code> to the DBFS client. 
                        </p>
                     </div>
                  </div><a id="ADLOB46192"></a><div class="props_rev_3"><a id="GUID-CF1B0455-8D24-44BA-9E74-167AC8A01FE5" name="GUID-CF1B0455-8D24-44BA-9E74-167AC8A01FE5"></a><h5 id="ADLOB-GUID-CF1B0455-8D24-44BA-9E74-167AC8A01FE5" class="sect5">Creating Content Store Paths</h5>
                     <div>
                        <p>You can create a content store path by providing a path name</p>
                        <div class="section">
                           <p>All DBFS content store paths must be preceded by <code class="codeph">dbfs:</code> .This is an example: <code class="codeph">dbfs:/staging_area/file1</code>. All database path names specified must be absolute paths.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">dbfs_client <span class="italic">db_user</span>@<span class="italic">db_server</span> <span class="bold">--command</span> <span class="italic">command</span> [<span class="italic">switches</span>] [<span class="italic">arguments</span>]
</pre><p>where:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="italic"><code class="codeph">command</code></span> is the executable command, such as <code class="codeph">ls</code>, <code class="codeph">cp</code>, <code class="codeph">mkdir</code>, or <code class="codeph">rm</code>.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="italic"><code class="codeph">switches</code></span> are specific for each command.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="italic"><code class="codeph">arguments</code></span> are file names or directory names, and are specific for each command.
                                 </p>
                              </li>
                           </ul>
                           <p>Note that <code class="codeph">dbfs_client</code> returns a nonzero value in case of failure.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADLOB46007"></a><div class="props_rev_3"><a id="GUID-9022B3BF-FF83-4B71-85F1-449CDBF34B28" name="GUID-9022B3BF-FF83-4B71-85F1-449CDBF34B28"></a><h5 id="ADLOB-GUID-9022B3BF-FF83-4B71-85F1-449CDBF34B28" class="sect5">Creating a Directory</h5>
                     <div>
                        <p>You can use the <code class="codeph">mkdir</code> command to create a new directory.
                        </p>
                        <div class="section">
                           <p>Use this syntax:</p><pre class="oac_no_warn" dir="ltr">dbfs_client <span class="italic">db_user</span>@<span class="italic">db_server</span> --command mkdir <span class="italic">directory_name</span>
</pre><p>where:</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="italic"><code class="codeph">directory_name</code></span> is the name of the directory created. For example:
                                 </p><pre class="oac_no_warn" dir="ltr">$ dbfs_client ETLUser@DBConnectString <span class="bold">--command mkdir</span> dbfs:/staging_area/dir1</pre></li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADLOB46004"></a><div class="props_rev_3"><a id="GUID-FD6E5F79-2DE5-4F4E-99D2-6AF7D571ECBA" name="GUID-FD6E5F79-2DE5-4F4E-99D2-6AF7D571ECBA"></a><h5 id="ADLOB-GUID-FD6E5F79-2DE5-4F4E-99D2-6AF7D571ECBA" class="sect5">Listing a Directory</h5>
                     <div>
                        <p>You can use the <code class="codeph">ls</code> command to list the contents of a directory.
                        </p>
                        <div class="section">
                           <p>Use this syntax:</p><pre class="oac_no_warn" dir="ltr">dbfs_client <span class="italic">db_user</span>@<span class="italic">db_server</span> <span class="bold">--command ls</span> [<span class="italic">switches</span>] <span class="italic">target</span>
</pre><p>where</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="italic"><code class="codeph">target</code></span> is the listed directory.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="italic"><code class="codeph">switches</code></span> is any combination of the following: 
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><code class="codeph">-</code><span class="italic"><code class="codeph">a</code></span> shows all files, including '<code class="codeph">.</code>' and '<code class="codeph">..</code>'.
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">-</code><span class="italic"><code class="codeph">l</code></span> shows the long listing format: name of each file, the file type, permissions, and size. 
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">-</code><span class="italic"><code class="codeph">R</code></span> lists subdirectories recursively.
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                           <p>For example:</p><pre class="oac_no_warn" dir="ltr">$ dbfs_client ETLUser@DBConnectString <span class="bold">--command  ls</span> dbfs:/staging_area/dir1</pre><p>or</p><pre class="oac_no_warn" dir="ltr">$ dbfs_client ETLUser@DBConnectString --command  ls -l -a -R&nbsp;dbfs:/staging_area/dir1 </pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADLOB46005"></a><div class="props_rev_3"><a id="GUID-240F6913-94D1-4646-8130-8A3942298EE1" name="GUID-240F6913-94D1-4646-8130-8A3942298EE1"></a><h5 id="ADLOB-GUID-240F6913-94D1-4646-8130-8A3942298EE1" class="sect5">Copying Files and Directories</h5>
                     <div>
                        <p>You can use the <code class="codeph">cp</code> command to copy files or directories from the source location to the destination location. 
                        </p>
                        <div class="section">
                           <p>The <code class="codeph">cp</code> command also supports recursive copy of directories. 
                           </p><pre class="oac_no_warn" dir="ltr">dbfs_client <span class="italic">db_user</span>@<span class="italic">db_server</span> <span class="bold">--command cp</span> [<span class="italic">switches</span>] <code class="codeph">source</code> <code class="codeph">destination</code></pre><p>where:</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="italic"><code class="codeph">source</code></span> is the source location.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="italic"><code class="codeph">destination</code></span> is the destination location.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="italic"><code class="codeph">switches</code></span> is either <code class="codeph">-R</code> or <code class="codeph">-r</code>, the options to recursively copy all source contents into the destination directory.
                                 </p>
                              </li>
                           </ul>
                           <p>The following example copies the contents of the local directory, <code class="codeph">01-01-10-dump</code> recursively into a directory in DBFS:
                           </p><pre class="oac_no_warn" dir="ltr">$ dbfs_client ETLUser@DBConnectString <span class="bold">--command cp</span> -R  01-01-10-dump dbfs:/staging_area/</pre><p>The following example copies the file <code class="codeph">hello.txt</code> from DBFS to a local file <code class="codeph">Hi.txt</code>: 
                           </p><pre class="oac_no_warn" dir="ltr">$ dbfs_client ETLUser@DBConnectString <span class="bold">--command cp</span> dbfs:/staging_area/hello.txt Hi.txt</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADLOB46006"></a><div class="props_rev_3"><a id="GUID-FD1B94B7-57A3-4A53-9C46-ACB75A348B7A" name="GUID-FD1B94B7-57A3-4A53-9C46-ACB75A348B7A"></a><h5 id="ADLOB-GUID-FD1B94B7-57A3-4A53-9C46-ACB75A348B7A" class="sect5">Removing Files and Directories</h5>
                     <div>
                        <p>You can use the command <code class="codeph">rm</code> to delete a file or directory.
                        </p>
                        <div class="section">
                           <p>The command <code class="codeph">rm</code> also supports recursive delete of directories. 
                           </p><pre class="oac_no_warn" dir="ltr">dbfs_client <span class="italic">db_user</span>@<span class="italic">db_server</span> --command rm [<span class="italic">switches</span>] <span class="italic">target</span>
</pre><p>where:</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="italic"><code class="codeph">target</code></span> is the listed directory.
                                 </p>
                              </li>
                              <li>
                                 <p><span class="italic"><code class="codeph">switches</code></span> is either <code class="codeph">-R</code> or <code class="codeph">-r</code>, the options to recursively delete all contents.
                                 </p>
                              </li>
                           </ul>
                           <p>For example:</p><pre class="oac_no_warn" dir="ltr">$ dbfs_client ETLUser@DBConnectString --command rm  dbfs:/staging_area/srcdir/hello.txt</pre><p>or</p><pre class="oac_no_warn" dir="ltr">$ dbfs_client ETLUser@DBConnectString --command rm -R  dbfs:/staging_area/dir1</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADLOB45997"></a><div class="props_rev_3"><a id="GUID-6B646446-BD50-44CD-9C52-4B1039242910" name="GUID-6B646446-BD50-44CD-9C52-4B1039242910"></a><h4 id="ADLOB-GUID-6B646446-BD50-44CD-9C52-4B1039242910" class="sect4">DBFS Mounting Interface (Linux and Solaris Only)</h4>
                  <div>
                     <p>You can mount DBFS using the <code class="codeph">dbfs_client</code> in Linux and Solaris only. 
                     </p>
                     <p>The instructions indicate the different requirements for the Linux and Solaris platforms.</p>
                     <p>Topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="using-DBFS.html#GUID-0FA47FD4-B4CA-4365-9519-7C70F9DA3183" title="You can use dbfs_client as a mount client in Solaris 11 SRU7 and later, if you install FUSE">Installing FUSE on Solaris 11 SRU7 and Later</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-257CA83F-3AEC-45C9-A5D6-8B487FE43630" title="You can mount the DBFS store by running the dbfs_client program.">Mounting the DBFS Store </a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-04B0BDF1-43D6-41DB-BC9C-95E9D90778D2" title="On Solaris, the user must have the Solaris privilege PRIV_SYS_MOUNT to perform mount and unmount operations on DBFS filesystems.">Solaris-Specific Privileges</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-4D1F748B-D6EF-48CA-B037-A42A7D295B64" title="The dbfs_client mount command for Solaris and Linux uses specific syntax.">About the Mount Command for Solaris and Linux</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-F959E952-C82E-4BEF-96C8-DC17A745D7F4" title="You can mount a file system with a wallet after configuring various environment variables.">Mounting a File System with a Wallet</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-69C0676E-EE2B-4B4B-9956-908D47AA3C54" title="You can mount a file system using dbfs_client.">Mounting a File System with Password at Command Prompt</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-AF702BBF-96BF-4CD7-A9F4-3C385839D5E2" title="You can mount a file system with a password read from a file.">Mounting a File System with Password Read from a File</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-0524AFB6-7C12-4F5B-B934-8C7026727ABB" title="In Linux, you can run fusermount to unmount file systems.">Unmounting a File System</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-135813E9-9DD0-48B1-BBE9-6FA28C757D3B" title="In Linux, you can configure fstab utility to use dbfs_client to mount a DBFS filesystem.">Mounting DBFS Through fstab Utility for Linux</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-69F6C5D1-FF77-4AA0-A07C-A7B525C0453F">Mounting DBFS Through the vfstab Utility for Solaris</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-78E752D1-3E67-483A-9A59-DD30FDF4A728">Restrictions on Mounted File Systems</a></p>
                        </li>
                     </ul>
                  </div><a id="ADLOB46193"></a><div class="props_rev_3"><a id="GUID-0FA47FD4-B4CA-4365-9519-7C70F9DA3183" name="GUID-0FA47FD4-B4CA-4365-9519-7C70F9DA3183"></a><h5 id="ADLOB-GUID-0FA47FD4-B4CA-4365-9519-7C70F9DA3183" class="sect5">Installing FUSE on Solaris 11 SRU7 and Later</h5>
                     <div>
                        <p>You can use <code class="codeph">dbfs_client</code> as a mount client in Solaris 11 SRU7 and later, if you install <code class="codeph">FUSE</code></p>
                        <div class="section">
                           <p> Install <code class="codeph">FUSE</code> to use <code class="codeph">dbfs_client</code> as a mount client in Solaris 11 SRU7 and later.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Run the following package as <code class="codeph">root</code>.
                                 </p><pre class="oac_no_warn" dir="ltr">pkg install libfuse</pre></li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADLOB45998"></a><div class="props_rev_3"><a id="GUID-257CA83F-3AEC-45C9-A5D6-8B487FE43630" name="GUID-257CA83F-3AEC-45C9-A5D6-8B487FE43630"></a><h5 id="ADLOB-GUID-257CA83F-3AEC-45C9-A5D6-8B487FE43630" class="sect5">Mounting the DBFS Store </h5>
                     <div>
                        <p>You can mount the DBFS store by running the <code class="codeph">dbfs_client</code> program. 
                        </p>
                        <div class="section">
                           <p>To run the <code class="codeph">dbfs_client</code> program. 
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li><span>Ensure that <code class="codeph">LD_LIBRARY_PATH</code> has the correct path to the Oracle client libraries.</span></li>
                           <li><span>Run the <code class="codeph">dbfs_client</code> program. </span></li>
                        </ol>
                        <div class="section">
                           <p>The <code class="codeph">dbfs_client</code> program does not return until the file system is unmounted. 
                           </p>
                           <div class="infoboxnotealso" id="GUID-257CA83F-3AEC-45C9-A5D6-8B487FE43630__USINGORACLEWALLETWITHDBFSCLIENTFORT-DFF8A2A0">
                              <p class="notep1">See Also:</p>
                              <p><a href="using-DBFS.html#GUID-52358A56-B0C5-4D07-BEF4-1C7F6F100C02">Using Oracle Wallet with DBFS Client</a> for the most secure method of specifying the password
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADLOB46194"></a><div class="props_rev_3"><a id="GUID-04B0BDF1-43D6-41DB-BC9C-95E9D90778D2" name="GUID-04B0BDF1-43D6-41DB-BC9C-95E9D90778D2"></a><h5 id="ADLOB-GUID-04B0BDF1-43D6-41DB-BC9C-95E9D90778D2" class="sect5">Solaris-Specific Privileges</h5>
                     <div>
                        <p>On Solaris, the user must have the Solaris privilege <code class="codeph">PRIV_SYS_MOUNT</code> to perform mount and unmount operations on DBFS filesystems.
                        </p>
                        <p>Give the user the Solaris privilege <code class="codeph">PRIV_SYS_MOUNT</code> . 
                        </p>
                        <ol>
                           <li>
                              <p>Edit <code class="codeph">/etc/user_attr</code>. 
                              </p>
                           </li>
                           <li>
                              <p>Add or modify the user entry (assuming the user is Oracle) as follows:</p><pre class="oac_no_warn" dir="ltr">oracle::::type=normal;project=group.dba;defaultpriv=basic,priv_sys_mount;;auth s=solaris.smf.*
</pre></li>
                        </ol>
                     </div>
                  </div><a id="ADLOB46195"></a><div class="props_rev_3"><a id="GUID-4D1F748B-D6EF-48CA-B037-A42A7D295B64" name="GUID-4D1F748B-D6EF-48CA-B037-A42A7D295B64"></a><h5 id="ADLOB-GUID-4D1F748B-D6EF-48CA-B037-A42A7D295B64" class="sect5">About the Mount Command for Solaris and Linux</h5>
                     <div>
                        <p>The <code class="codeph">dbfs_client</code> mount command for Solaris and Linux uses specific syntax. 
                        </p>
                        <p>Syntax:</p><pre class="oac_no_warn" dir="ltr">dbfs_client <span class="italic">db_user</span>@<span class="italic">db_server</span> <span class="italic">[</span>-o <span class="italic">option_1</span> -o <span class="italic">option_2</span> <span class="italic">...</span><span class="italic">]</span> <span class="italic">mount_point</span>
</pre><p>where the mandatory parameters are:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="italic"><code class="codeph">db_user</code></span> is the name of the database user who owns the DBFS content store file system.
                              </p>
                           </li>
                           <li>
                              <p><span class="italic"><code class="codeph">db_server</code></span> is a valid connect string to the Oracle Database server, such as <code class="codeph">hrdb_host:1521/hrservice</code>.
                              </p>
                           </li>
                           <li>
                              <p><span class="italic"><code class="codeph">mount_point</code></span> is the path where the Database File System is mounted. Note that all file systems owned by the database user are visible at the mount point.
                              </p>
                           </li>
                        </ul>
                        <p>The options are:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">direct_io</code>: To bypass the OS page cache and provide improved performance for large files. Programs in the file system cannot be executed with this option. Oracle recommends this option when DBFS is used as an ETL staging area.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">wallet</code>: To run the DBFS client in the background. The Wallet must be configured to get its credentials.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">failover</code>: To fail over the DBFS client to surviving database instances without data loss. Expect some performance cost on writes, especially for small files.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">allow_root</code>: To allow the root user to access the filesystem. You must set the <code class="codeph">user_allow_other</code> parameter in the <code class="codeph">/etc/fuse.conf</code> configuration file.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">allow_other</code>: To allow other users to access the filesystem. You must set the <code class="codeph">user_allow_other</code> parameter in the <code class="codeph">/etc/fuse.conf</code> configuration file.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">rw</code>: To mount the filesystem as read-write. This is the default setting.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ro</code>: To mount the filesystem as read-only. Files cannot be modified.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">trace_level=</code><span class="italic"><code class="codeph">n</code></span> sets the trace level. Trace levels are:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">1 DEBUG</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">2 INFO</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">3 WARNING</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">4 ERROR</code>: The default tracing level. It outputs diagnostic information only when an error happens. It is recommended that this tracing level is always enabled. 
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">5 CRITICAL</code></p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p><code class="codeph">trace_file=STR</code>: Specifies the tracing log file, where <code class="codeph">STR</code> can be either a <span class="italic"><code class="codeph">file_name</code></span> or <code class="codeph">syslog</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">trace_size=</code><span class="italic"><code class="codeph">trcfile_size</code></span>: Specifies size of the trace file in MB. By default, <code class="codeph">dbfs_client</code> rotates tracing output between two 10MB files. Specifying <code class="codeph">0</code> for <code class="codeph">trace_size</code> sets the maximum size of the trace file to unlimited.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="ADLOB46196"></a><div class="props_rev_3"><a id="GUID-F959E952-C82E-4BEF-96C8-DC17A745D7F4" name="GUID-F959E952-C82E-4BEF-96C8-DC17A745D7F4"></a><h5 id="ADLOB-GUID-F959E952-C82E-4BEF-96C8-DC17A745D7F4" class="sect5">Mounting a File System with a Wallet</h5>
                     <div>
                        <p>You can mount a file system with a wallet after configuring various environment variables.</p>
                        <div class="section">
                           <p>You must first configure the <code class="codeph">LD_LIBRARY_PATH</code> and <span class="italic"><code class="codeph">ORACLE_HOME</code></span> environment variables correctly before mounting a file system with a wallet. 
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Login as admin user. </span></li>
                           <li class="stepexpand"><span>Mount the DBFS store. (Oracle recommends that you do not perform this step as root user.)</span><div><pre class="oac_no_warn" dir="ltr">% dbfs_client @/dbfsdb -o wallet,rw,user,direct_io /mnt/dbfs
</pre></div>
                           </li>
                           <li class="stepexpand"><span>[Optional] To test if the previous step was successful, as admin user, list the <code class="codeph">dbfs</code> directory.</span><div><pre class="oac_no_warn" dir="ltr">$ ls /mnt/tdbfs</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div class="sect5"><a id="TASK-14-DFF8D7B9" name="TASK-14-DFF8D7B9"></a><h6 id="ADLOB-TASK-14-DFF8D7B9" class="sect6"></h6>
                        <div>
                           <div class="section">
                              <p class="subhead3" id="TASK-14-DFF8D7B9__GUID-47680EDD-07ED-4D75-BF40-EFF8F2558126"></p>
                              <div class="infoboxnotealso" id="TASK-14-DFF8D7B9__USINGORACLEWALLETWITHDBFSCLIENT-DFF8E4C4">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="using-DBFS.html#GUID-52358A56-B0C5-4D07-BEF4-1C7F6F100C02">Using Oracle Wallet with DBFS Client</a></p>
                              </div>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-69C0676E-EE2B-4B4B-9956-908D47AA3C54" name="GUID-69C0676E-EE2B-4B4B-9956-908D47AA3C54"></a><h5 id="ADLOB-GUID-69C0676E-EE2B-4B4B-9956-908D47AA3C54" class="sect5">Mounting a File System with Password at Command Prompt</h5>
                     <div>
                        <p>You can mount a file system using <code class="codeph">dbfs_client</code>.
                        </p>
                        <div class="section">
                           <p>You must enter a password on the command prompt to mount a file system using <code class="codeph">dbfs_client</code>.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Run the following:</p><pre class="oac_no_warn" dir="ltr">$ dbfs_client ETLUser@DBConnectString /mnt/dbfs
  password: xxxxxxx</pre></li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-AF702BBF-96BF-4CD7-A9F4-3C385839D5E2" name="GUID-AF702BBF-96BF-4CD7-A9F4-3C385839D5E2"></a><h5 id="ADLOB-GUID-AF702BBF-96BF-4CD7-A9F4-3C385839D5E2" class="sect5">Mounting a File System with Password Read from a File</h5>
                     <div>
                        <p>You can mount a file system with a password read from a file.</p>
                        <div class="section">
                           <p>The following example mounts a file system and frees the terminal. It reads the password from a file: </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Run the following:</p><pre class="oac_no_warn" dir="ltr">$ nohup dbfs_client ETLUser@DBConnectString /mnt/dbfs &lt; <span class="italic">passwordfile</span>.f &amp;
$ ls -l /mnt/dbfs
drwxrwxrwx 10 root root 0 Feb  9 17:28 staging_area</pre></li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADLOB45999"></a><div class="props_rev_3"><a id="GUID-0524AFB6-7C12-4F5B-B934-8C7026727ABB" name="GUID-0524AFB6-7C12-4F5B-B934-8C7026727ABB"></a><h5 id="ADLOB-GUID-0524AFB6-7C12-4F5B-B934-8C7026727ABB" class="sect5">Unmounting a File System</h5>
                     <div>
                        <p>In Linux, you can run <code class="codeph">fusermount</code> to unmount file systems.
                        </p>
                        <div class="section">
                           <p>To run <code class="codeph">fusermount</code> in Linux, do the following:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Run the following:</p><pre class="oac_no_warn" dir="ltr"> $ fusermount -u &lt;<span class="italic"><code class="codeph">mount point</code></span>&gt;
</pre></li>
                           </ul>
                           <p>In Solaris, you can run <code class="codeph">umount</code> to unmount file systems.
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Run the following:</p><pre class="oac_no_warn" dir="ltr"> $ umount -u &lt;<span class="italic"><code class="codeph">mount point</code></span>&gt;</pre></li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADLOB46000"></a><div class="props_rev_3"><a id="GUID-135813E9-9DD0-48B1-BBE9-6FA28C757D3B" name="GUID-135813E9-9DD0-48B1-BBE9-6FA28C757D3B"></a><h5 id="ADLOB-GUID-135813E9-9DD0-48B1-BBE9-6FA28C757D3B" class="sect5">Mounting DBFS Through fstab Utility for Linux</h5>
                     <div>
                        <p>In Linux, you can configure <code class="codeph">fstab</code> utility to use <code class="codeph">dbfs_client</code> to mount a DBFS filesystem. 
                        </p>
                        <div class="section">
                           <p>To mount DBFS through <code class="codeph">/etc/fstab</code>, you must use Oracle Wallet for authentication. 
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Login as <code class="codeph">root</code> user.</span></li>
                           <li class="stepexpand"><span>Change the user and group of <code class="codeph">dbfs_client</code> to user <code class="codeph">root</code> and group <code class="codeph">fuse</code>.</span><div><pre class="oac_no_warn" dir="ltr"># chown root.fuse $ORACLE_HOME/bin/dbfs_client
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Set the <code class="codeph">setuid</code> bit on <code class="codeph">dbfs_client</code> and restrict <code class="codeph">execute</code> privileges to the user and group only.</span><div><pre class="oac_no_warn" dir="ltr"># chmod u+rwxs,g+rx-w,o-rwx dbfs_client
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create a symbolic link to <code class="codeph">dbfs_client</code> in <code class="codeph">/sbin</code> as "<code class="codeph">mount.dbfs</code>".</span><div><pre class="oac_no_warn" dir="ltr">$ ln -s $ORACLE_HOME/bin/dbfs_client /sbin/mount.dbfs
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create a new Linux group called "<code class="codeph">fuse</code>".</span></li>
                           <li class="stepexpand"><span>Add the Linux user that is running the DBFS Client to the <code class="codeph">fuse</code> group.</span></li>
                           <li class="stepexpand"><span>Add the following line to <code class="codeph">/etc/fstab</code>:</span><div><pre class="oac_no_warn" dir="ltr">/sbin/mount.dbfs#<span class="italic">db_user</span>@<span class="italic">db_server</span> <span class="italic">mount_point</span> fuse rw,user,noauto 0 0
</pre><p>For example:</p><pre class="oac_no_warn" dir="ltr">/sbin/mount.dbfs#/@DBConnectString /mnt/dbfs fuse rw,user,noauto 0 0
</pre></div>
                           </li>
                           <li class="stepexpand"><span>The Linux user can mount the DBFS file system using the standard Linux <code class="codeph">mount</code> command. For example:</span><div><pre class="oac_no_warn" dir="ltr">$ mount /mnt/dbfs
</pre><p>Note that <code class="codeph">FUSE</code> does not currently support <code class="codeph">automount</code>.
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div><a id="ADLOB46197"></a><div class="props_rev_3"><a id="GUID-69F6C5D1-FF77-4AA0-A07C-A7B525C0453F" name="GUID-69F6C5D1-FF77-4AA0-A07C-A7B525C0453F"></a><h5 id="ADLOB-GUID-69F6C5D1-FF77-4AA0-A07C-A7B525C0453F" class="sect5">Mounting DBFS Through the vfstab Utility for Solaris</h5>
                     <div>
                        <div class="section">
                           <p>On Solaris, file systems are commonly configured using the <code class="codeph">vfstab</code> utility. 
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create a mount shell script <code class="codeph">mount_dbfs.sh</code> to use to start <code class="codeph">dbfs_client</code>. All the environment variables that are required for Oracle RDBMS must be exported. These environment variables include <code class="codeph">TNS_ADMIN</code>, <code class="codeph">ORACLE_HOME</code>, and <code class="codeph">LD_LIBRARY_PATH</code>. For example:</span><div><pre class="oac_no_warn" dir="ltr">#!/bin/ksh
export TNS_ADMIN=/export/home/oracle/dbfs/tnsadmin
export ORACLE_HOME=/export/home/oracle/11.2.0/dbhome_1
export DBFS_USER=dbfs_user
export DBFS_PASSWD=/tmp/passwd.f
export DBFS_DB_CONN=dbfs_db
export O=$ORACLE_HOME
export LD_LIBRARY_PATH=$O/lib:$O/rdbms/lib:/usr/lib:/lib:$LD_LIBRARY_PATH
export NOHUP_LOG=/tmp/dbfs.nohup

(nohup $ORACLE_HOME/bin/dbfs_client $DBFS_USER@$DBFS_DB_CONN &lt; $DBFS_PASSWD
         2&gt;&amp;1 &amp; ) &amp;</pre></div>
                           </li>
                           <li class="stepexpand"><span>Add an entry for DBFS to <code class="codeph">/etc/vfstab</code>. Specify the <code class="codeph">mount_dbfs.sh</code> script for the <code class="codeph">device_to_mount</code>. Specify <code class="codeph">uvfs</code> for the <code class="codeph">FS_type</code>. Specify no <code class="codeph">formount_at_boot</code>. Specify mount options as needed. For example:</span><div><pre class="oac_no_warn" dir="ltr">/usr/local/bin/mount_dbfs.sh - /mnt/dbfs uvfs - no rw,allow_other
</pre></div>
                           </li>
                           <li class="stepexpand"><span>User can mount the DBFS file system using the standard Solaris mount command. For example:</span><div><pre class="oac_no_warn" dir="ltr">$ mount /mnt/dbfs
</pre></div>
                           </li>
                           <li class="stepexpand"><span>User can unmount the DBFS file system using the standard Solaris umount command. For example:</span><div><pre class="oac_no_warn" dir="ltr">$ umount /mnt/dbfs
</pre></div>
                           </li>
                        </ol>
                     </div>
                  </div><a id="ADLOB46001"></a><div class="props_rev_3"><a id="GUID-78E752D1-3E67-483A-9A59-DD30FDF4A728" name="GUID-78E752D1-3E67-483A-9A59-DD30FDF4A728"></a><h5 id="ADLOB-GUID-78E752D1-3E67-483A-9A59-DD30FDF4A728" class="sect5">Restrictions on Mounted File Systems</h5>
                     <div>
                        <p>DBFS supports most file system operations with exceptions. Exceptions are:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">ioctl</code></p>
                           </li>
                           <li>
                              <p>range locking (file locking is supported)</p>
                           </li>
                           <li>
                              <p>asynchronous I/O through <code class="codeph">libaio</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">O_DIRECT</code> file opens
                              </p>
                           </li>
                           <li>
                              <p>hard links, pipes</p>
                           </li>
                           <li>
                              <p>other special file modes </p>
                           </li>
                        </ul>
                        <p>Memory-mapped files are supported except in shared-writable mode. For performance reasons, DBFS does not update the file access time every time file data or the file data attributes are read.</p>
                        <p>You cannot run programs from a DBFS-mounted file system if the <code class="codeph">direct_io</code> option is specified.
                        </p>
                        <p>Oracle does not support exporting DBFS file systems using NFS or Samba.</p>
                     </div>
                  </div>
               </div><a id="ADLOB46010"></a><div class="props_rev_3"><a id="GUID-85540258-FBB9-452B-8C20-F1D00A2ECA31" name="GUID-85540258-FBB9-452B-8C20-F1D00A2ECA31"></a><h4 id="ADLOB-GUID-85540258-FBB9-452B-8C20-F1D00A2ECA31" class="sect4">File System Security Model </h4>
                  <div>
                     <p>The database manages security in DBFS. It does not use the operating system security model. </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="using-DBFS.html#GUID-6006E126-7A80-4D8F-B35B-23E31096F512">About the File System Security Model</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-B23998F8-3354-4FBE-82F9-39D4739EE934">Enabling Shared Root Access</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-CBDEAA51-801F-444D-8895-CCDE0C21662B">About DBFS Access Among Multiple Database Users</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-0932DE6C-801B-4F37-8BA9-33866E76FF7A">Establishing DBFS Access Sharing Across Multiple Database Users</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="props_rev_3"><a id="GUID-6006E126-7A80-4D8F-B35B-23E31096F512" name="GUID-6006E126-7A80-4D8F-B35B-23E31096F512"></a><h5 id="ADLOB-GUID-6006E126-7A80-4D8F-B35B-23E31096F512" class="sect5">About the File System Security Model</h5>
                     <div>
                        <p>DBFS operates under a security model where all file systems created by a user are private to that user, by default. </p>
                        <p>Oracle recommends maintaining this model. Because operating system users and Oracle Database users are different, it is possible to allow multiple operating system users to mount a single DBFS filesystem. These mounts may potentially have different mount options and permissions. For example, <code class="codeph">user1</code> may mount a DBFS filesystem as <code class="codeph">READ ONLY</code>, and <code class="codeph">user2</code> may mount it as <code class="codeph">READ WRITE</code>. However, Oracle Database views both users as having the same privileges because they would be accessing the filesystem as the same database user.
                        </p>
                        <p>Access to a database file system requires a database login as a database user with privileges on the tables that underlie the file system.The database administrator grants access to a file system to database users, and different database users may have different <code class="codeph">READ</code> or <code class="codeph">UPDATE</code> privileges to the file system. The database administrator has access to all files stored in the DBFS file system.
                        </p>
                        <p>On each client computer, access to a DBFS mount point is limited to the operating system user that mounts the file system. This, however, does not limit the number of users who can access the DBFS file system, because many users may separately mount the same DBFS file system.</p>
                        <p>DBFS only performs database privilege checking. Linux performs operating system file-level permission checking when a DBFS file system is mounted. DBFS does not perform this check either when using the command interface or when using the PL/SQL interface directly.</p>
                     </div>
                  </div><a id="ADLOB46163"></a><a id="ADLOB46162"></a><div class="props_rev_3"><a id="GUID-B23998F8-3354-4FBE-82F9-39D4739EE934" name="GUID-B23998F8-3354-4FBE-82F9-39D4739EE934"></a><h5 id="ADLOB-GUID-B23998F8-3354-4FBE-82F9-39D4739EE934" class="sect5">Enabling Shared Root Access</h5>
                     <div>
                        <div class="section">
                           <p>As an operating system user who mounts the file system, you can allow root access to the file system by specifying the <code class="codeph">allow_root</code> option. This option requires that the <code class="codeph">/etc/fuse.conf</code> file contain the <code class="codeph">user_allow_other</code> field, as demonstrated in <a href="using-DBFS.html#GUID-B23998F8-3354-4FBE-82F9-39D4739EE934__CIHDHFDH">Example 25-1</a>.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-B23998F8-3354-4FBE-82F9-39D4739EE934__CIHDHFDH">
                           <p class="titleinexample">Example 25-1 Enabling Root Access for Other Users</p><pre class="oac_no_warn" dir="ltr"># Allow users to specify the 'allow_root' mount option.
user_allow_other
</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADLOB46164"></a><div class="props_rev_3"><a id="GUID-CBDEAA51-801F-444D-8895-CCDE0C21662B" name="GUID-CBDEAA51-801F-444D-8895-CCDE0C21662B"></a><h5 id="ADLOB-GUID-CBDEAA51-801F-444D-8895-CCDE0C21662B" class="sect5">About DBFS Access Among Multiple Database Users</h5>
                     <div>
                        <p>Some circumstances may require that multiple database users access the same filesystem. For example, the database user that owns the filesystem may be a privileged user and sharing its user credentials may pose a security risk. To mitigate this, DBFS allows multiple database users to share a subset of the filesystem state.</p>
                        <p>While DBFS registrations and mounts made through the DBFS content API are private to each user, the underlying filesystem and the tables on which they rely may be shared across users. After this is done, the individual filesystems may be independently mounted and used by different database users, either through SQL/PLSQL, or through <code class="codeph">dbfs_client</code> APIs.
                        </p>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-0932DE6C-801B-4F37-8BA9-33866E76FF7A" name="GUID-0932DE6C-801B-4F37-8BA9-33866E76FF7A"></a><h5 id="ADLOB-GUID-0932DE6C-801B-4F37-8BA9-33866E76FF7A" class="sect5">Establishing DBFS Access Sharing Across Multiple Database Users</h5>
                     <div>
                        <div class="section">
                           <p>You can share DBFS across multiple database users.</p>
                           <p>In the following example, user <code class="codeph">user1</code> is able to modify the filesystem, and user <code class="codeph">user2</code> can see these changes. Here, <code class="codeph">user1</code> is the database user that creates a filesystem, and <code class="codeph">user2</code> is the database user that eventually uses <code class="codeph">dbfs_client</code> to mount and access the filesystem. Both <code class="codeph">user1</code> and <code class="codeph">user2</code> must have the <code class="codeph">DBFS_ROLE</code> privilege.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Connect as the user who creates the filesystem.</span><div><pre class="oac_no_warn" dir="ltr">sys@tank as sysdba&gt; connect user1
Connected.
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Create the filesystem <code class="codeph">user1_FS</code>, register the store, and mount it as <code class="codeph">user1_mt</code>.</span><div><pre class="oac_no_warn" dir="ltr">user1@tank&gt; exec dbms_dbfs_sfs.createFilesystem('user1_FS');
user1@tank&gt; exec dbms_dbfs_content.registerStore('user1_FS', 'posix', 'DBMS_DBFS_SFS');
user1@tank&gt; exec dbms_dbfs_content.mountStore('user1_FS', 'user1_mnt');
user1@tank&gt; commit;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>[Optional] You may check that the previous step has completed successfully by viewing all mounts.</span><div><pre class="oac_no_warn" dir="ltr">user1@tank&gt; select * from table(dbms_dbfs_content.listMounts);

STORE_NAME           |   STORE_ID|PROVIDER_NAME
---------------------|- ---------|------------------------------------------
PROVIDER_PKG         |PROVIDER_ID|PROVIDER_VERSION     |STORE_FEATURES
---------------------|-----------|---------------------|--------------------
STORE_GUID
----------
STORE_MOUNT
----------------------------------------------------------------------------
CREATED
----------------------------------------------------------------------------
MOUNT_PROPERTIES(PROPNAME, PROPVALUE, TYPECODE)
----------------------------------------------------------------------------
user1_FS             | 1362968596|posix
"DBMS_DBFS_SFS"      | 3350646887|0.5.0                | 12714135  141867344
user1_mnt
01-FEB-10 09.44.25.357858 PM
DBMS_DBFS_CONTENT_PROPERTIES_T(
&nbsp;&nbsp;DBMS_DBFS_CONTENT_PROPERTY_T('principal', (null), 9),
&nbsp;&nbsp;DBMS_DBFS_CONTENT_PROPERTY_T('owner', (null), 9), 
&nbsp;&nbsp;DBMS_DBFS_CONTENT_PROPERTY_T('acl', (null), 9), 
&nbsp;&nbsp;DBMS_DBFS_CONTENT_PROPERTY_T('asof', (null), 187),
&nbsp;&nbsp;DBMS_DBFS_CONTENT_PROPERTY_T('read_only', '0', 2))</pre><p></p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>[Optional] Connect as the user who will use the <code class="codeph">dbfs_client</code>.</span><div><pre class="oac_no_warn" dir="ltr">user1@tank&gt; connect user2
Connected.
</pre></div>
                           </li>
                           <li class="stepexpand"><span>[Optional] Note that <code class="codeph">user2</code> cannot see <code class="codeph">user1</code>'s DBFS state, as he has no mounts.</span><div><pre class="oac_no_warn" dir="ltr">user2@tank&gt; select * from table(dbms_dbfs_content.listMounts);
</pre></div>
                           </li>
                           <li class="stepexpand"><span>While connected as <code class="codeph">user1</code>, export filesystem <code class="codeph">user1_FS</code> for access to any user with <code class="codeph">DBFS_ROLE</code> privilege.</span><div><pre class="oac_no_warn" dir="ltr">user1@tank&gt; exec dbms_dbfs_sfs.exportFilesystem('user1_FS');
user1@tank&gt; commit;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Connect as the user who will use the <code class="codeph">dbfs_client</code>.</span><div><pre class="oac_no_warn" dir="ltr">user1@tank&gt; connect user2
Connected.
</pre></div>
                           </li>
                           <li class="stepexpand"><span>As <code class="codeph">user2</code>, view all available tables.</span><div><pre class="oac_no_warn" dir="ltr">user2@tank&gt; select * from table(dbms_dbfs_sfs.listTables);

SCHEMA_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |TABLE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |PTABLE_NAME
---------------------------|---------------------------|-------------------
VERSION#
--------------------------------CREATED
---------------------------------------------------------------------------
FORMATTED
---------------------------------------------------------------------------
PROPERTIES(PROPNAME, PROPVALUE, TYPECODE)
---------------------------------------------------------------------------
user1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |SFS$_FST_11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |SFS$_FSTP_11
0.5.0
01-FEB-10 09.43.53.497856 PM
01-FEB-10 09.43.53.497856 PM
(null)
</pre></div>
                           </li>
                           <li class="stepexpand"><span>As <code class="codeph">user2</code>, register and mount the store, but do not re-create the <code class="codeph">user1_FS</code> filesystem.</span><div><pre class="oac_no_warn" dir="ltr">user2@tank&gt; exec dbms_dbfs_sfs.registerFilesystem(
&nbsp;&nbsp;&nbsp;'user2_FS', 'user1', 'SFS$_FST_11');
user2@tank&gt; exec dbms_dbfs_content.registerStore(
&nbsp;&nbsp;&nbsp;'user2_FS', 'posix', 'DBMS_DBFS_SFS');
user2@tank&gt; exec dbms_dbfs_content.mountStore(
&nbsp;&nbsp;&nbsp;'user2_FS', 'user2_mnt');
user2@tank&gt; commit;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>[Optional] As <code class="codeph">user2</code>, you may check that the previous step has completed successfully by viewing all mounts.</span><div><pre class="oac_no_warn" dir="ltr">user2@tank&gt; select * from table(dbms_dbfs_content.listMounts);

STORE_NAME           |   STORE_ID|PROVIDER_NAME
---------------------|- ---------|------------------------------------------
PROVIDER_PKG         |PROVIDER_ID|PROVIDER_VERSION     |STORE_FEATURES
---------------------|-----------|---------------------|--------------------
STORE_GUID
----------
STORE_MOUNT
----------------------------------------------------------------------------
CREATED
----------------------------------------------------------------------------
MOUNT_PROPERTIES(PROPNAME, PROPVALUE, TYPECODE)
----------------------------------------------------------------------------
user2_FS             | 1362968596|posix
"DBMS_DBFS_SFS"      | 3350646887|0.5.0                | 12714135  141867344
user1_mnt
01-FEB-10 09.46.16.013046 PM
DBMS_DBFS_CONTENT_PROPERTIES_T(
&nbsp;&nbsp;DBMS_DBFS_CONTENT_PROPERTY_T('principal', (null), 9),
&nbsp;&nbsp;DBMS_DBFS_CONTENT_PROPERTY_T('owner', (null), 9), 
&nbsp;&nbsp;DBMS_DBFS_CONTENT_PROPERTY_T('acl', (null), 9), 
&nbsp;&nbsp;DBMS_DBFS_CONTENT_PROPERTY_T('asof', (null), 187),
&nbsp;&nbsp;DBMS_DBFS_CONTENT_PROPERTY_T('read_only', '0', 2))</pre><p></p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>[Optional] List path names for <code class="codeph">user2</code> and <code class="codeph">user1</code>. Note that another mount, <code class="codeph">user2_mnt,</code>for store <code class="codeph">user2_FS,</code> is available for <code class="codeph">user2</code>. However, the underlying filesystem data is the same for <code class="codeph">user2</code> as for <code class="codeph">user1</code>.</span><div><pre class="oac_no_warn" dir="ltr">user2@tank&gt; select pathname from dbfs_content;
 
PATHNAME
-------------------------------------------------------------------------------
/user2_mnt
/user2_mnt/.sfs/tools
/user2_mnt/.sfs/snapshots
/user2_mnt/.sfs/content
/user2_mnt/.sfs/attributes
/user2_mnt/.sfs/RECYCLE
/user2_mnt/.sfs

user2@tank&gt; connect user1
Connected.

user1@tank&gt; select pathname from dbfs_content;
 
PATHNAME
---------------------
/user1_mnt
/user1_mnt/.sfs/tools
/user1_mnt/.sfs/snapshots
/user1_mnt/.sfs/content
/user1_mnt/.sfs/attributes
/user1_mnt/.sfs/RECYCLE
/user1_mnt/.sfs
</pre></div>
                           </li>
                           <li class="stepexpand"><span>In filesystem <code class="codeph">user1_FS</code>, <code class="codeph">user1</code> creates file <span class="italic"><code class="codeph">xxx</code></span>.</span><div><pre class="oac_no_warn" dir="ltr">user1@tank&gt; var ret number;
user1@tank&gt; var data blob;
user1@tank&gt; exec :ret := dbms_fuse.fs_create('/user1_mnt/<span class="italic">xxx</span>', content =&gt; :data);
user1@tank&gt; select :ret from dual;
      :RET
----------
         0
</pre></div>
                           </li>
                           <li class="stepexpand"><span>[Optional] Write to file <span class="italic"><code class="codeph">xxx</code></span>, created in the previous step.</span><div><pre class="oac_no_warn" dir="ltr">user1@tank&gt; var buf varchar2(100);
user1@tank&gt; exec :buf := 'hello world';
user1@tank&gt; exec dbms_lob.writeappend(:data, length(:buf), utl_raw.cast_to_raw(:buf));
user1@tank&gt; commit;
 </pre></div>
                           </li>
                           <li class="stepexpand"><span>[Optional] Show that file <span class="italic"><code class="codeph">xxx</code></span> exists, and contains the appended data.</span><div><pre class="oac_no_warn" dir="ltr">user1@tank&gt; select pathname, utl_raw.cast_to_varchar2(filedata) 
&nbsp;&nbsp;from dbfs_content where filedata is not null;
 
PATHNAME
-------------------------------------------------------------------------------
UTL_RAW.CAST_TO_VARCHAR2(FILEDATA)
-------------------------------------------------------------------------------
/user1_mnt/<span class="italic">xxx</span>
hello world
</pre></div>
                           </li>
                           <li class="stepexpand"><span>User <code class="codeph">user2</code> sees the same file in their own DBFS-specific path name and mount prefix.</span><div><pre class="oac_no_warn" dir="ltr">user1@tank&gt; connect user2
Connected.
 
user2@tank&gt; select pathname, utl_raw.cast_to_varchar2(filedata) from
&nbsp;&nbsp;dbfs_content where filedata is not null;
 
PATHNAME
-------------------------------------------------------------------------------
UTL_RAW.CAST_TO_VARCHAR2(FILEDATA)
-------------------------------------------------------------------------------
/user2_mnt/<span class="italic">xxx</span>
hello world
</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>After the export and register pairing completes, both users behave as equals with regard to their usage of the underlying tables. The <code class="codeph">exportFilesystem()</code> procedure manages the necessary grants for access to the same data, which is shared between schemas. After <code class="codeph">user1</code> calls <code class="codeph">exportFilesystem()</code>, filesystem access may be granted to any user with <code class="codeph">DBFS_ROLE</code>. Note that a different role can be specified.
                           </p>
                           <p>Subsequently, <code class="codeph">user2</code> may create a new DBFS filesystem that shares the same underlying storage as the <code class="codeph">user1_FS</code> filesystem, by invoking <code class="codeph">dbms_dbfs_sfs.registerFilesystem()</code>, <code class="codeph">dbms_dbfs_sfs.registerStore()</code>, and <code class="codeph">dmbs_dbfs_sfs.mountStore()</code> procedure calls.
                           </p>
                           <p>When multiple database users share a filesystem, they must ensure that all database users unregister their interest in the filesystem before the owner (here, <code class="codeph">user1</code>) drops the filesystem.
                           </p>
                           <p>Oracle does not recommend that you run the DBFS as <code class="codeph">root</code>.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADLOB46203"></a><div class="props_rev_3"><a id="GUID-D6AE78C9-C618-4842-8B44-2BE42E1BEDE3" name="GUID-D6AE78C9-C618-4842-8B44-2BE42E1BEDE3"></a><h4 id="ADLOB-GUID-D6AE78C9-C618-4842-8B44-2BE42E1BEDE3" class="sect4">HTTP, WebDAV, and FTP Access to DBFS</h4>
                  <div>
                     <p>Components that enable HTTP, WebDAV, and FTP access to DBFS over the Internet use various XML DB server protocols.</p>
                     <p>Topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="using-DBFS.html#GUID-A7D24E13-93A7-4B58-92BB-27A93D1A5226">Internet Access to DBFS Through XDB </a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-253DFD3A-DEE3-4D0C-BC06-3D423EA05EC6">Web Distributed Authoring and Versioning (WebDAV) Access</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-02C9A2D0-3647-48BE-81FF-876EB45CBC2F">FTP Access to DBFS</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-7A591ACE-C0BD-4AED-A216-22CC06645901">HTTP Access to DBFS</a></p>
                        </li>
                     </ul>
                  </div><a id="ADLOB46212"></a><div class="props_rev_3"><a id="GUID-A7D24E13-93A7-4B58-92BB-27A93D1A5226" name="GUID-A7D24E13-93A7-4B58-92BB-27A93D1A5226"></a><h5 id="ADLOB-GUID-A7D24E13-93A7-4B58-92BB-27A93D1A5226" class="sect5">Internet Access to DBFS Through XDB </h5>
                     <div>
                        <p>To provide database users who have DBFS authentication with a hierarchical file system-like view of registered and mounted DBFS stores, stores are displayed under the path <code class="codeph">/dbfs</code>. 
                        </p>
                        <p>The <code class="codeph">/dbfs</code> folder is a virtual folder because the resources in its subtree are stored in DBFS stores, not the XDB repository. XDB issues a <code class="codeph">dbms_dbfs_content.list()</code> command for the root path name "<code class="codeph">/</code>" (with invoker rights) and receives a list of store access points as subfolders in the <code class="codeph">/dbfs</code> folder. The list is comparable to <code class="codeph">store_mount</code> parameters passed to <code class="codeph">dbms_dbfs_content.mountStore().</code> FTP and WebDAV users can navigate to these stores, while HTTP and HTTPS users access URLs from browsers. 
                        </p>
                        <p>Note that features implemented by the XDB repository, such as repository events, resource configurations, and ACLs, are not available for the <code class="codeph">/dbfs</code> folder. 
                        </p>
                        <p><a href="DBFS-content-API.html#GUID-630BE6DB-0178-4EE4-8D7D-824BA886F68E" title="You can enable applications to use the Database File System (DBFS) in several different programming environments.">DBFS Content API</a> for guidelines on DBFS store creation, registration, deregistration, mount, unmount and deletion
                        </p>
                     </div>
                  </div><a id="ADLOB46213"></a><div class="props_rev_3"><a id="GUID-253DFD3A-DEE3-4D0C-BC06-3D423EA05EC6" name="GUID-253DFD3A-DEE3-4D0C-BC06-3D423EA05EC6"></a><h5 id="ADLOB-GUID-253DFD3A-DEE3-4D0C-BC06-3D423EA05EC6" class="sect5">Web Distributed Authoring and Versioning (WebDAV) Access</h5>
                     <div>
                        <p>WebDAV is an IETF standard protocol that provides users with a file-system-like interface to a repository over the Internet. </p>
                        <p>WebDAV server folders are typically accessed through Web Folders on Microsoft Windows (2000/NT/XP/Vista/7, and so on). You can access a resource using its fully qualified name, for example, <code class="codeph">/dbfs/sfs1/dir1/file1.txt</code>, where <code class="codeph">sfs1</code> is the name of a DBFS store. 
                        </p>
                        <p>You need to set up WebDAV on Windows to access the DBFS filesystem.</p>
                        <div class="infoboxnotealso" id="GUID-253DFD3A-DEE3-4D0C-BC06-3D423EA05EC6__GUID-5B101177-8FAF-4C5D-859F-2EF0C594CFBD">
                           <p class="notep1">See Also:</p>
                           <p><a href="../adxdb/repository-access-using-protocols.html#ADXDB5562" target="_blank"><span class="italic">Oracle XML DB Developer's Guide</span></a></p>
                        </div>
                        <p>The user authentication required to access the DBFS virtual folder is the same as for the XDB repository.</p>
                        <p>When a WebDAV client connects to a WebDAV server for the first time, the user is typically prompted for a username and password, which the client uses for all subsequent requests. From a protocol point-of-view, every request contains authentication information, which XDB uses to authenticate the user as a valid database user. If the user does not exist, the client does not get access to the DBFS store or the XDB repository. Upon successful authentication, the database user becomes the current user in the session. </p>
                        <p>XDB supports both basic authentication and digest authentication. For security reasons, it is highly recommended that HTTPS transport be used if basic authentication is enabled.</p>
                     </div>
                  </div><a id="ADLOB46214"></a><div class="props_rev_3"><a id="GUID-02C9A2D0-3647-48BE-81FF-876EB45CBC2F" name="GUID-02C9A2D0-3647-48BE-81FF-876EB45CBC2F"></a><h5 id="ADLOB-GUID-02C9A2D0-3647-48BE-81FF-876EB45CBC2F" class="sect5">FTP Access to DBFS</h5>
                     <div>
                        <p>FTP access to DBFS uses the standard FTP clients found on most Unix-based distributions. FTP is a file transfer mechanism built on client-server architecture with separate control and data connections. </p>
                        <p>FTP users are authenticated as database users. The protocol, as outlined in RFC 959, uses clear text user name and password for authentication. Therefore, FTP is not a secure protocol. </p>
                        <p>The following commands are supported for DBFS:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">USER</code>: Authentication username
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">PASS</code>: Authentication password
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">CWD</code>: Change working directory
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">CDUP</code>: Change to Parent directory
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">QUIT</code>: Disconnect
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">PORT</code>: Specifies an address and port to which the server should connect
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">PASV</code>: Enter passive mode
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">TYPE</code>: Sets the transfer mode, such as, ASCII or Binary
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">RETR</code>: Transfer a copy of the file
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">STOR</code>: Accept the data and store the data as a file at the server site 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">RNFR</code>: Rename From
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">RNTO</code>: Rename To
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DELE</code>: Delete file
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">RMD</code>: Remove directory
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">MKD</code>: Make a directory
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">PWD</code>: Print working directory
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">LIST</code>: Listing of a file or directory. Default is current directory.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">NLST</code>: Returns file names in a directory
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">HELP</code>: Usage document
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">SYST</code>: Return system type
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">FEAT</code>: Gets the feature list implemented by the server
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">NOOP</code>: No operation (used for keep-alives)
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">EPRT</code>: Extended address (IPv6) and port to which the server should connect
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">EPSV</code>: Enter extended passive mode (IPv6)
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="ADLOB46215"></a><div class="props_rev_3"><a id="GUID-7A591ACE-C0BD-4AED-A216-22CC06645901" name="GUID-7A591ACE-C0BD-4AED-A216-22CC06645901"></a><h5 id="ADLOB-GUID-7A591ACE-C0BD-4AED-A216-22CC06645901" class="sect5">HTTP Access to DBFS</h5>
                     <div>
                        <p>Users have read-only access through HTTP/HTTPS protocols. Users point their browsers to a DBFS store using the XDB HTTP server with a URL such as <code class="codeph">https://hostname:</code><span class="italic"><code class="codeph">port</code></span><code class="codeph">/dbfs/sfs1</code> where <code class="codeph">sfs1</code> is a DBFS store name.
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="ADLOB46008"></a><div class="props_rev_3"><a id="GUID-8665C1E7-C96A-4B17-A8F7-1889858EEF18" name="GUID-8665C1E7-C96A-4B17-A8F7-1889858EEF18"></a><h3 id="ADLOB-GUID-8665C1E7-C96A-4B17-A8F7-1889858EEF18" class="sect3">DBFS Administration</h3>
               <div>
                  <p><a id="d96781e4827" class="indexterm-anchor"></a>DBFS administration includes tools that perform diagnostics, manage failover, perform backup and so on. 
                  </p>
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="using-DBFS.html#GUID-52358A56-B0C5-4D07-BEF4-1C7F6F100C02">Using Oracle Wallet with DBFS Client</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-E834E96E-F30D-45C0-8AF0-55B2F6361723">DBFS Diagnostics</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-1FFAC0EF-36D7-449A-A17A-A9A9FB513F48" title="The dbfs_client program can failover to one of the other existing database instances if one of the database instances in an Oracle RAC cluster fails.">Preventing Data Loss During Failover Events</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-98B94C27-7E22-4198-A3D2-A1B697D6B681">Bypassing Client-Side Write Caching</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-FE5CE3DE-FDC1-4F47-8407-D70FFA00AF99">Backing up DBFS</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-DE04F6CD-8E24-4CD8-8A74-1FAAE54211A9">Small File Performance of DBFS</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-32BF7F5E-1E6C-4CDD-81DC-DC9E6E55DC22">Enabling Advanced SecureFiles LOB Features for DBFS</a></p>
                     </li>
                  </ul>
               </div><a id="ADLOB46009"></a><div class="props_rev_3"><a id="GUID-52358A56-B0C5-4D07-BEF4-1C7F6F100C02" name="GUID-52358A56-B0C5-4D07-BEF4-1C7F6F100C02"></a><h4 id="ADLOB-GUID-52358A56-B0C5-4D07-BEF4-1C7F6F100C02" class="sect4">Using Oracle Wallet with DBFS Client</h4>
                  <div>
                     <div class="section">
                        <p>An Oracle Wallet allows the DBFS client to mount a DBFS store without requiring the user to enter a password. </p>
                        <div class="infoboxnotealso" id="GUID-52358A56-B0C5-4D07-BEF4-1C7F6F100C02__ORACLEDATABASEENTERPRISEUSERSECURIT-DFF94F39">
                           <p class="notep1">See Also:</p>
                           <p><a href="../dbimi/using-oracle-wallet-manager.html#DBIMI160" target="_blank"><span class="italic">Oracle Database Enterprise User Security Administrator's Guide</span></a> for more information about creation and management of wallets
                           </p>
                        </div>
                        <p>The "<code class="codeph">/@</code>" syntax means to use the wallet, as shown in Step <a href="using-DBFS.html#GUID-52358A56-B0C5-4D07-BEF4-1C7F6F100C02__CIHEDBAE">7</a>. 
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Create a directory for the wallet. For example:</span><div><pre class="oac_no_warn" dir="ltr">mkdir $ORACLE_HOME/oracle/wallet
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create an auto-login wallet.</span><div><pre class="oac_no_warn" dir="ltr">mkstore -wrl $ORACLE_HOME/oracle/wallet -create
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Add the wallet location in the client's <code class="codeph">sqlnet.ora</code> file:</span><div><pre class="oac_no_warn" dir="ltr">WALLET_LOCATION = (SOURCE = (METHOD = FILE) (METHOD_DATA = (DIRECTORY =
 $ORACLE_HOME/oracle/wallet) ) ) 
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Add the following parameter in the client's <code class="codeph">sqlnet.ora</code> file:</span><div><pre class="oac_no_warn" dir="ltr">SQLNET.WALLET_OVERRIDE = TRUE
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Create credentials:</span><div><pre class="oac_no_warn" dir="ltr">mkstore -wrl <span class="italic">wallet_location</span> -createCredential <span class="italic">db_connect_string</span> <span class="italic">username</span> <span class="italic">password</span>
</pre><p>For example:</p><pre class="oac_no_warn" dir="ltr">mkstore -wrl $ORACLE_HOME/oracle/wallet -createCredential DBConnectString scott <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Add the connection alias to your <code class="codeph">tnsnames.ora</code> file.</span></li>
                        <li class="stepexpand" id="GUID-52358A56-B0C5-4D07-BEF4-1C7F6F100C02__CIHEDBAE"><span>Use <code class="codeph">dbfs_client</code> with Oracle Wallet.</span><div>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">$ dbfs_client -o wallet /@DBConnectString /mnt/dbfs </pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="ADLOB46011"></a><div class="props_rev_3"><a id="GUID-E834E96E-F30D-45C0-8AF0-55B2F6361723" name="GUID-E834E96E-F30D-45C0-8AF0-55B2F6361723"></a><h4 id="ADLOB-GUID-E834E96E-F30D-45C0-8AF0-55B2F6361723" class="sect4">DBFS Diagnostics</h4>
                  <div>
                     <p>The <code class="codeph">dbfs_client</code> program supports multiple levels of tracing to help diagnose problems. It  can either output traces to a file or to <code class="codeph">/var/log/messages</code> using the <code class="codeph">syslog</code> daemon on Linux. 
                     </p>
                     <p>When you trace to a file, the <code class="codeph">dbfs_client</code> program keeps two trace files on disk. <code class="codeph">dbfs_client</code>, rotates the trace files automatically, and limits disk usage to 20 MB.
                     </p>
                     <p>By default, tracing is turned off except for critical messages which are always logged to <code class="codeph">/var/log/messages</code>. 
                     </p>
                     <p>If <code class="codeph">dbfs_client</code> cannot connect to the Oracle Database, enable tracing using the <code class="codeph">trace_level</code> and <code class="codeph">trace_file</code> options. Tracing prints additional messages to log file for easier debugging.
                     </p>
                     <p>DBFS uses Oracle Database for storing files. Sometimes Oracle server issues are propagated to <code class="codeph">dbfs_client</code> as errors. If there is a <code class="codeph">dbfs_client</code> error, please view the Oracle server logs to see if that is the root cause.
                     </p>
                  </div>
               </div><a id="ADLOB46166"></a><a id="ADLOB46012"></a><div class="props_rev_3"><a id="GUID-1FFAC0EF-36D7-449A-A17A-A9A9FB513F48" name="GUID-1FFAC0EF-36D7-449A-A17A-A9A9FB513F48"></a><h4 id="ADLOB-GUID-1FFAC0EF-36D7-449A-A17A-A9A9FB513F48" class="sect4">Preventing Data Loss During Failover Events</h4>
                  <div>
                     <p>The <code class="codeph">dbfs_client</code> program can failover to one of the other existing database instances if one of the database instances in an Oracle RAC cluster fails. 
                     </p>
                     <div class="p">For <code class="codeph">dbfs_client</code> failover to work correctly, you must modify the Oracle database service and specify failover parameters.  Run the <code class="codeph">DBMS_SERVICE.MODIFY_SERVICE</code> procedure to modify the service as shown <a href="using-DBFS.html#GUID-1FFAC0EF-36D7-449A-A17A-A9A9FB513F48__CIHJDDEE">Example 25-2</a></div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-1FFAC0EF-36D7-449A-A17A-A9A9FB513F48__CIHJDDEE">
                        <p class="titleinexample">Example 25-2 Enabling DBFS Client Failover Events</p><pre class="oac_no_warn" dir="ltr">exec DBMS_SERVICE.MODIFY_SERVICE(service_name =&gt; 'service_name',
              aq_ha_notifications =&gt; true,
              failover_method =&gt; 'BASIC',
              failover_type =&gt; 'SELECT',
              failover_retries =&gt; 180,
              failover_delay =&gt; 1);
</pre><p>Once you have completed the prerequisite, you can prevent data loss during a failover of the DBFS connection after a failure of the back-end Oracle database instance. In this case, cached <span class="italic">writes</span> may be lost if the client loses the connection. However, back-end failover to other Oracle RAC instances or standby databases does not cause lost writes. 
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p> Specify the <code class="codeph">-o failover</code> mount option:
                              </p><pre class="oac_no_warn" dir="ltr">$ dbfs_client <span class="italic">database_user</span>@<span class="italic">database_server</span> -o failover /mnt/dbfs </pre></li>
                        </ul>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADLOB46013"></a><div class="props_rev_3"><a id="GUID-98B94C27-7E22-4198-A3D2-A1B697D6B681" name="GUID-98B94C27-7E22-4198-A3D2-A1B697D6B681"></a><h4 id="ADLOB-GUID-98B94C27-7E22-4198-A3D2-A1B697D6B681" class="sect4">Bypassing Client-Side Write Caching</h4>
                  <div>
                     <div class="section">
                        <p>The sharing and caching semantics for <code class="codeph">dbfs_client</code> are similar to NFS in using the <span class="italic">close-to-open cache consistency</span> behavior. This allows multiple copies of <code class="codeph">dbfs_client</code> to access the same shared file system. The default mode caches writes on the client and flushes them after a timeout or after the user closes the file. Also, writes to a file only appear to clients that open the file after the writer closed the file. 
                        </p>
                        <p>You can bypass client-side write caching.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Specify <code class="codeph">O_SYNC</code> when the file is opened.
                              </p>
                              <p>To force writes in the cache to disk call <code class="codeph">fsync</code>. 
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB46014"></a><div class="props_rev_3"><a id="GUID-FE5CE3DE-FDC1-4F47-8407-D70FFA00AF99" name="GUID-FE5CE3DE-FDC1-4F47-8407-D70FFA00AF99"></a><h4 id="ADLOB-GUID-FE5CE3DE-FDC1-4F47-8407-D70FFA00AF99" class="sect4">Backing up DBFS</h4>
                  <div>
                     <p>You have two alternatives for backing up DBFS. You can back up the tables that underlie the file system at the database level or use a file system backup utility, such as Oracle Secure Backup, through a mount point.</p>
                     <p>Topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="using-DBFS.html#GUID-CF5FAA8E-5F15-483C-9684-7A9F05B7EE18">DBFS Backup at the Database Level</a></p>
                        </li>
                        <li>
                           <p><a href="using-DBFS.html#GUID-3A4486EB-05E9-442C-B93D-880984472D69">DBFS Backup Through a File System Utility</a></p>
                        </li>
                     </ul>
                  </div><a id="ADLOB46168"></a><div class="props_rev_3"><a id="GUID-CF5FAA8E-5F15-483C-9684-7A9F05B7EE18" name="GUID-CF5FAA8E-5F15-483C-9684-7A9F05B7EE18"></a><h5 id="ADLOB-GUID-CF5FAA8E-5F15-483C-9684-7A9F05B7EE18" class="sect5">DBFS Backup at the Database Level</h5>
                     <div>
                        <p>An advantage of backing up the tables at the database level is that the files in the file system are always consistent with the relational data in the database. A full restore and recover of the database also fully restores and recovers the file system with no data loss. During a point-in-time recovery of the database, the files are recovered to the specified time. As usual with database backup, modifications that occur during the backup do not affect the consistency of a restore. The entire restored file system is always consistent with respect to a specified time stamp.</p>
                     </div>
                  </div><a id="ADLOB46169"></a><div class="props_rev_3"><a id="GUID-3A4486EB-05E9-442C-B93D-880984472D69" name="GUID-3A4486EB-05E9-442C-B93D-880984472D69"></a><h5 id="ADLOB-GUID-3A4486EB-05E9-442C-B93D-880984472D69" class="sect5">DBFS Backup Through a File System Utility</h5>
                     <div>
                        <div class="section">
                           <p>The advantage of backing up the file system using a file system backup utility is that individual files can be restored from backup more easily. Any changes made to the restored files after the last backup are lost.</p>
                           <p>Specify the <code class="codeph">allow_root</code> mount option if backups are scheduled using the Oracle Secure Backup Administrative Server. 
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADLOB46015"></a><div class="props_rev_3"><a id="GUID-DE04F6CD-8E24-4CD8-8A74-1FAAE54211A9" name="GUID-DE04F6CD-8E24-4CD8-8A74-1FAAE54211A9"></a><h4 id="ADLOB-GUID-DE04F6CD-8E24-4CD8-8A74-1FAAE54211A9" class="sect4">Small File Performance of DBFS</h4>
                  <div>
                     <p>Like any shared file system, the performance of DBFS for small files lags the performance of a local file system. </p>
                     <p>Each file data or metadata operation in DBFS must go through the <code class="codeph">FUSE</code> user mode file system and then be forwarded across the network to the database. Therefore, each operation that is not cached on the client takes a few milliseconds to run in DBFS.
                     </p>
                     <p>For operations that involve an input/output (IO) to disk, the time delay overhead is masked by the wait for the disk IO. Naturally, larger IOs have a lower percentage overhead than smaller IOs. The network overhead is more noticeable for operations that do not issue a disk IO.</p>
                     <p>When you compare the operations on a few small files with a local file system, the overhead is not noticeable, but operations that affect thousands of small files incur a much more noticeable overhead. For example, listing a single directory or looking at a single file produce near instantaneous response, while searching across a directory tree with many thousands of files results in a larger relative overhead.</p>
                  </div>
               </div><a id="ADLOB46170"></a><a id="ADLOB46016"></a><div class="props_rev_3"><a id="GUID-32BF7F5E-1E6C-4CDD-81DC-DC9E6E55DC22" name="GUID-32BF7F5E-1E6C-4CDD-81DC-DC9E6E55DC22"></a><h4 id="ADLOB-GUID-32BF7F5E-1E6C-4CDD-81DC-DC9E6E55DC22" class="sect4">Enabling Advanced SecureFiles LOB Features for DBFS</h4>
                  <div>
                     <div class="section">
                        <p>DBFS offers advanced features available with SecureFiles LOBs: compression, deduplication, encryption, and partitioning. </p>
                        <p>For example, DBFS can be configured as a compressed file system with partitioning. At the time of creating a DBFS file system, you must specify the set of enabled features for the file system.</p>
                        <div class="infoboxnotealso" id="GUID-32BF7F5E-1E6C-4CDD-81DC-DC9E6E55DC22__USINGORACLELOBSTORAGEANDCREATINGAPA-DFF9C4E2">
                           <p class="notep1">See Also:</p>
                           <p><a href="using-oracle-LOBs-storage.html#GUID-EC76077B-3EE9-491E-AC6D-171DA919B84C" title="Oracle LOB storage has two types, SecureFiles LOB storage and BasicFiles LOB storage, which are used with different types of tablespaces.">Using Oracle LOB Storage</a> and <a href="using-DBFS.html#GUID-8735D535-2E13-4702-95F9-01F931F2BF46" title="Partitioning creates multiple physical segments in the database, and files are distributed randomly in these partitions.">Creating a Partitioned File System</a> for more information about the features of SecureFiles LOBs.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-32BF7F5E-1E6C-4CDD-81DC-DC9E6E55DC22__GUID-E34C30BB-4066-4E46-BC7E-ADA00283E4B9">
                        <p class="titleinexample">Example 25-3 Enabling Advanced Secure Files LOB Features for DBFS</p><pre class="oac_no_warn" dir="ltr">$ sqlplus @dbfs_create_filesystem_advanced <span class="italic">tablespace_name</span> <span class="italic">file_systemname</span>
&nbsp;&nbsp;[compress-high | compress-medium | compress-low | nocompress] 
&nbsp;&nbsp;[deduplicate | nodeduplicate]
&nbsp;&nbsp;[encrypt | noencrypt]
&nbsp;&nbsp;[partition | non-partition]</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADLOB46216"></a><div class="props_rev_3"><a id="GUID-68FE78C8-798C-40DB-8566-F09EB27F4CC9" name="GUID-68FE78C8-798C-40DB-8566-F09EB27F4CC9"></a><h3 id="ADLOB-GUID-68FE78C8-798C-40DB-8566-F09EB27F4CC9" class="sect3">Shrinking and Reorganizing DBFS Filesystems</h3>
               <div>
                  <p>A DBFS Filesystem uses Online Filesystem Reorganization to shrink itself, enabling the release of allocated space back to the containing tablespace. </p>
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="using-DBFS.html#GUID-53227EBD-8AFE-47CF-813F-6B509677B83E">About Changing DBFS Filesystems</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-FD348CE7-CE3D-4A88-B5D2-6EBAFFC35923" title="DBFS Online Filesystem Reorganization is a powerful data movement facility with these certain advantages."> Advantages of Online Filesystem Reorganization</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-93914AB9-E5DB-4C02-82CC-D9E9EF15F00B">Determining Availability of Online Filesystem Reorganization</a></p>
                     </li>
                     <li>
                        <p><a href="using-DBFS.html#GUID-3DF29109-3B00-4C76-819F-6017BF4671A0">Invoking Online Filesystem Reorganization</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-53227EBD-8AFE-47CF-813F-6B509677B83E" name="GUID-53227EBD-8AFE-47CF-813F-6B509677B83E"></a><h4 id="ADLOB-GUID-53227EBD-8AFE-47CF-813F-6B509677B83E" class="sect4">About Changing DBFS Filesystems</h4>
                  <div>
                     <p>DBFS filesystems, like other database segments, grow dynamically with the addition or enlargement of files and directories. Growth occurs with the allocation of space from the tablespace that holds the DBFS filesystem to the various segments that make up the filesystem.</p>
                     <p>However, even if files and directories in the DBFS filesystem are deleted, the allocated space is not released back to the containing tablespace, but continues to exist and be available for other DBFS entities. A process called Online Filesystem Reorganization solves this problem by shrinking the DBFS Filesystem.</p>
                     <p>The DBFS Online Filesystem Reorganization utility internally uses the Oracle Database online redefinition facility, with the original filesystem and a temporary placeholder corresponding to the base and interim objects in the online redefinition model. </p>
                     <div class="infoboxnotealso" id="GUID-53227EBD-8AFE-47CF-813F-6B509677B83E__GUID-A62284D2-7AD4-4C53-8DA1-C2A956837954">
                        <p class="notep1">See Also:</p>
                        <p><a href="../admin/managing-tables.html#ADMIN01514" target="_blank"><span class="italic">Oracle Database Administrator's Guide</span></a> for further information about online redefinition
                        </p>
                     </div>
                  </div>
               </div><a id="ADLOB46217"></a><div class="props_rev_3"><a id="GUID-FD348CE7-CE3D-4A88-B5D2-6EBAFFC35923" name="GUID-FD348CE7-CE3D-4A88-B5D2-6EBAFFC35923"></a><h4 id="ADLOB-GUID-FD348CE7-CE3D-4A88-B5D2-6EBAFFC35923" class="sect4"> Advantages of Online Filesystem Reorganization</h4>
                  <div>
                     <p>DBFS Online Filesystem Reorganization is a powerful data movement facility with these certain advantages. </p>
                     <p>These are:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">It is online:</span> When reorganization is taking place, the filesystem remains fully available for read and write operations for all applications.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">It can reorganize the structure:</span> The underlying physical structure and organization of the DBFS filesystem can be changed in many ways, such as:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>A non-partitioned filesystem can be converted to a partitioned filesystem and vice-versa.</p>
                              </li>
                              <li>
                                 <p>Special SecureFiles LOB properties can be selectively enabled or disabled in any combination, including the compression, encryption, and deduplication properties. </p>
                              </li>
                              <li>
                                 <p>The data in the filesystem can be moved across tablespaces or within the same tablespace.</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p><span class="bold">It can reorganize multiple filesystems concurrently:</span> Multiple different filesystems can be reorganized at the same time, if no temporary filesystems have the same name and the tablespaces have enough free space, typically, twice the space requirement for each filesystem being reorganized.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADLOB46218"></a><div class="props_rev_3"><a id="GUID-93914AB9-E5DB-4C02-82CC-D9E9EF15F00B" name="GUID-93914AB9-E5DB-4C02-82CC-D9E9EF15F00B"></a><h4 id="ADLOB-GUID-93914AB9-E5DB-4C02-82CC-D9E9EF15F00B" class="sect4">Determining Availability of Online Filesystem Reorganization</h4>
                  <div>
                     <div class="section">
                        <p>DBFS for Oracle Database 12<span class="italic">c</span> and later supports online filesystem reorganization. Some earlier versions also support the facility. To determine if your version does, query for a specific function in the DBFS PL/SQL packages, as shown below:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Query for a specific function in the DBFS PL/SQL packages.</p>
                           </li>
                        </ul><pre class="oac_no_warn" dir="ltr">$ sqlplus / as sysdba
SELECT * FROM dba_procedures
WHERE   owner = 'SYS'
    and object_name = 'DBMS_DBFS_SFS'
    and procedure_name = 'REORGANIZEFS';
</pre><p>If this query returns a single row similar to the one in this output, the DBFS installation supports Online Filesystem Reorganization. If the query does not return any rows, then the DBFS installation should either be upgraded or requires a patch for bug-10051996.</p><pre class="oac_no_warn" dir="ltr"> 
OWNER
----------------------------------------------------------------------------------
OBJECT_NAME
----------------------------------------------------------------------------------
PROCEDURE_NAME
----------------------------------------------------------------------------------
OBJECT_ID|SUBPROGRAM_ID|OVERLOAD                                |OBJECT_TYPE  |AGG|PIP
----------|-------------|-----------------------------------|-------------|---|---
IMPLTYPEOWNER
----------------------------------------------------------------------------------
IMPLTYPENAME
----------------------------------------------------------------------------------
PAR|INT|DET|AUTHID
---|---|---|------------
SYS
DBMS_DBFS_SFS
REORGANIZEFS
     11424|           52|(null)                                  |PACKAGE      |NO |NO
(null)
(null)
NO |NO |NO |CURRENT_USER
</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB46219"></a><div class="props_rev_3"><a id="GUID-3DF29109-3B00-4C76-819F-6017BF4671A0" name="GUID-3DF29109-3B00-4C76-819F-6017BF4671A0"></a><h4 id="ADLOB-GUID-3DF29109-3B00-4C76-819F-6017BF4671A0" class="sect4">Invoking Online Filesystem Reorganization</h4>
                  <div>
                     <div class="section">
                        <p>You can perform an Online Filesystem Reorganization by creating a temporary DBFS filesystem. </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span>Create a temporary DBFS filesystem with the desired new organization and structure: including the desired target tablespace (which may be the same tablespace as the filesystem being reorganized), desired target SecureFiles LOB storage properties (compression, encryption, or deduplication), and so on.</span></li>
                        <li><span>Invoke the PL/SQL procedure to reorganize the DBFS filesystem using the newly-created temporary filesystem for data movement.</span></li>
                        <li><span>Once the reorganization procedure completes, drop the temporary filesystem.</span></li>
                     </ol>
                     <div class="section">
                        <p>The example below reorganizes DBFS filesystem <code class="codeph">FS1</code> in tablespace <code class="codeph">TS1</code> into a new tablespace <code class="codeph">TS2</code>, using a temporary filesystem named <code class="codeph">TMP_FS</code>, where all filesystems belong to database user <code class="codeph">dbfs_user</code>:
                        </p><pre class="oac_no_warn" dir="ltr">$ cd $ORACLE_HOME/rdbms/admin
$ sqlplus dbfs_user/***
 
@dbfs_create_filesystem TS2 TMP_FS
EXEC DBMS_DBFS_SFS.REORGANIZEFS('FS1', 'TMP_FS');
@dbfs_drop_filesystem TMP_FS
QUIT;
</pre><p>where:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">TMP_FS</code> can have any valid name. It is intended as a temporary placeholder and can be dropped (as shown in the example above) or retained as a fully materialized point-in-time snapshot of the original filesystem.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">FS1</code> is the original filesystem and is unaffected by the attempted reorganization. It remains usable for all DBFS operations, including SQL, PL/SQL, and <code class="codeph">dbfs_client</code> mounts and commandline, during the reorganization. At the end of the reorganization, FS1 has the new structure and organization used to create <code class="codeph">TMP_FS</code> and vice versa (<code class="codeph">TMP_FS</code> will have the structure and organization originally used for <code class="codeph">FS1</code>). If the reorganization fails for any reason, DBFS attempts to clean up the internal state of <code class="codeph">FS1</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">TS2</code> needs enough space to accommodate all active (non-deleted) files and directories in <code class="codeph">FS1</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">TS1</code> needs at least twice the amount of space being used by <code class="codeph">FS1</code> if the filesystem is moved within the same tablespace as part of a shrink.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>