<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Oracle Call Interface (OCI)</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Object-Relational Developer's Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Object-Relational Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="object-relational-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T02:05:10-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96436-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="plsql.html" title="Previous" type="text/html">
      <link rel="next" href="pro-c-cpp.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Object-Relational Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADOBJ">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="plsql.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="pro-c-cpp.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Object-Relational Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="object-support-in-oracle-programming-environments.html" property="item" typeof="WebPage"><span property="name"> Object Support in Oracle Programming Environments </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle Call Interface (OCI)</li>
            </ol>
            <a id="GUID-D3515120-813C-480B-93BC-6C9027FE14E1" name="GUID-D3515120-813C-480B-93BC-6C9027FE14E1"></a>
            
            <h2 id="ADOBJ-GUID-D3515120-813C-480B-93BC-6C9027FE14E1" class="sect2"><span class="enumeration_section">4.4 </span>Oracle Call Interface (OCI)
            </h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d15326e6" class="indexterm-anchor"></a>OCI is a set of C library functions that applications can use to manipulate data and schemas in an Oracle database.
               </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="oracle-call-interface-oci.html#GUID-B274BB40-BAC1-4D9B-BEE8-0B1BD223640C">About Oracle Call Interface (OCI)</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-call-interface-oci.html#GUID-30CAFE06-6176-498D-AFF7-6B5D98A97EBC">Associative Access in OCI Programs</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-call-interface-oci.html#GUID-5D5499A5-D30A-45BA-B9B8-88F14FFADA6B">Navigational Access in OCI Programs</a></p>
                  </li>
               </ul>
            </div><a id="ADOBJ7194"></a><div class="props_rev_3"><a id="GUID-B274BB40-BAC1-4D9B-BEE8-0B1BD223640C" name="GUID-B274BB40-BAC1-4D9B-BEE8-0B1BD223640C"></a><h3 id="ADOBJ-GUID-B274BB40-BAC1-4D9B-BEE8-0B1BD223640C" class="sect3"><span class="enumeration_section">4.4.1 </span>About Oracle Call Interface (OCI)
               </h3>
               <div>
                  <p>OCI supports both traditional 3GL and object-oriented techniques for database access, as explained in the following sections.</p>
                  <p>An important component of OCI is a set of calls to manage a workspace called the object cache. The <a id="d15326e111" class="indexterm-anchor"></a><a id="d15326e115" class="indexterm-anchor"></a>object cache is a memory block on the client side that allows programs to store entire objects and to navigate among them without additional round trips to the server.
                  </p>
                  <p>The object cache is completely under the control and management of the application programs using it. The Oracle server has no access to it. The application programs using it must maintain data coherency with the server and protect the workspace against simultaneous conflicting access.</p>
                  <p>OCI provides functions to</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Access objects on the server using <a id="d15326e128" class="indexterm-anchor"></a>SQL.
                        </p>
                     </li>
                     <li>
                        <p>Access, manipulate and manage objects in the object cache by traversing pointers or <code class="codeph">REF</code>s.
                        </p>
                     </li>
                     <li>
                        <p>Convert Oracle dates, strings and numbers to C data types.</p>
                     </li>
                     <li>
                        <p>Manage the size of the object cache's memory.</p>
                     </li>
                  </ul>
                  <p>OCI improves concurrency by <a id="d15326e149" class="indexterm-anchor"></a><a id="d15326e153" class="indexterm-anchor"></a>allowing individual objects to be locked. It improves performance by supporting complex object retrieval.
                  </p>
                  <p>OCI developers can use the object type translator to generate the C data types corresponding to a Oracle object types.</p>
                  <div class="infoboxnotealso" id="GUID-B274BB40-BAC1-4D9B-BEE8-0B1BD223640C__GUID-29986D8F-9D3A-4FF1-A4C3-62AFC869F55B">
                     <p class="notep1">See Also:</p>
                     <p><a href="../lnoci/oci-object-relational-programming.html#LNOCI100" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a> for more information about using objects with OCI
                     </p>
                  </div>
               </div>
            </div><a id="ADOBJ7195"></a><div class="props_rev_3"><a id="GUID-30CAFE06-6176-498D-AFF7-6B5D98A97EBC" name="GUID-30CAFE06-6176-498D-AFF7-6B5D98A97EBC"></a><h3 id="ADOBJ-GUID-30CAFE06-6176-498D-AFF7-6B5D98A97EBC" class="sect3"><span class="enumeration_section">4.4.2 </span>Associative Access in OCI Programs
               </h3>
               <div>
                  <p>OCI programs support associative access to objects with an API that can manipulate object data.</p>
                  <p><a id="d15326e220" class="indexterm-anchor"></a>Traditionally, 3GL programs manipulate data stored in a relational database by executing SQL statements and PL/SQL procedures. Data is usually manipulated on the server without incurring the cost of transporting the data to the client(s). OCI supports this associative access to objects by providing an API for executing SQL statements that manipulate object data. Specifically, OCI enables you to:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Execute SQL statements that manipulate object data and object type schema information</p>
                     </li>
                     <li>
                        <p>Pass object instances, object references (<code class="codeph">REF</code>s), and collections as input variables in SQL statements
                        </p>
                     </li>
                     <li>
                        <p>Return object instances, <code class="codeph">REF</code>s, and collections as output of SQL statement fetches
                        </p>
                     </li>
                     <li>
                        <p>Describe the properties of SQL statements that return object instances, <code class="codeph">REF</code>s, and collections
                        </p>
                     </li>
                     <li>
                        <p>Describe and execute PL/SQL procedures or functions with object parameters or results</p>
                     </li>
                     <li>
                        <p>Synchronize object and relational functionality through enhanced commit and rollback functions</p>
                     </li>
                  </ul>
                  <p>See <span class="q">"<a href="pro-c-cpp.html#GUID-563052BA-73D1-40BA-8351-705AA29A98BB">Associative Access in Pro*C/C++</a>"</span>.
                  </p>
               </div>
            </div><a id="ADOBJ7196"></a><div class="props_rev_3"><a id="GUID-5D5499A5-D30A-45BA-B9B8-88F14FFADA6B" name="GUID-5D5499A5-D30A-45BA-B9B8-88F14FFADA6B"></a><h3 id="ADOBJ-GUID-5D5499A5-D30A-45BA-B9B8-88F14FFADA6B" class="sect3"><span class="enumeration_section">4.4.3 </span>Navigational Access in OCI Programs
               </h3>
               <div>
                  <p>OCI programs provide navigational access by means of an API.</p>
                  <p><a id="d15326e313" class="indexterm-anchor"></a>In the object-oriented programming paradigm, applications model their real-world entities as a set of inter-related objects that form graphs of objects. The relationships between objects are implemented as references. An application processes objects by starting at some initial set of objects, using the references in these initial objects to traverse the remaining objects, and performing computations on each object. OCI provides an API for this style of access to objects, known as navigational access. Specifically, OCI enables you to:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Cache objects in memory on the client machine</p>
                     </li>
                     <li>
                        <p>Dereference an object reference and pin the corresponding object in the object cache. The pinned object is transparently mapped in the host language representation.</p>
                     </li>
                     <li>
                        <p>Notify the cache when the pinned object is no longer needed</p>
                     </li>
                     <li>
                        <p>Fetch a graph of related objects from the database into the client cache in one call</p>
                     </li>
                     <li>
                        <p>Lock objects</p>
                     </li>
                     <li>
                        <p>Create, update, and delete objects in the cache</p>
                     </li>
                     <li>
                        <p>Flush changes made to objects in the client cache to the database</p>
                     </li>
                  </ul>
                  <p>See <span class="q">"<a href="pro-c-cpp.html#GUID-7162D120-3CDB-4549-85C4-283E4F0E5DFA">Navigational Access in Pro*C/C++</a>"</span>.
                  </p>
               </div>
            </div><a id="ADOBJ7197"></a><div class="props_rev_3"><a id="GUID-EDDCDEB1-988B-47C0-9C2B-80821CEC6D2E" name="GUID-EDDCDEB1-988B-47C0-9C2B-80821CEC6D2E"></a><h3 id="ADOBJ-GUID-EDDCDEB1-988B-47C0-9C2B-80821CEC6D2E" class="sect3"><span class="enumeration_section">4.4.4 </span>Object Cache
               </h3>
               <div>
                  <p><a id="d15326e397" class="indexterm-anchor"></a>To support high-performance navigational access of objects, OCI runtime provides an object cache for caching objects in memory. 
                  </p>
                  <p>The object cache supports references (<code class="codeph">REF</code>s) to database objects in the object cache, the database objects can be identified (that is, pinned) through their references. Applications do not need to allocate or free memory when database objects are loaded into the cache, because the object cache provides transparent and efficient memory management for database objects. 
                  </p>
                  <p>Also, when database objects are loaded into the cache, they are transparently mapped into the host language representation. For example, in the C programming language, the database object is mapped to its corresponding C structure. The object cache maintains the association between the object copy in the cache and the corresponding database object. Upon transaction commit, changes made to the object copy in the cache are propagated automatically to the database.</p>
                  <p>The object cache maintains a fast look-up table for mapping <code class="codeph">REF</code>s to objects. When an application dereferences a <code class="codeph">REF</code> and the corresponding object is not yet cached in the object cache, the object cache automatically sends a request to the server to fetch the object from the database and load it into the object cache. Subsequent dereferences of the same <code class="codeph">REF</code> are faster because they become local cache access and do not incur network round-trips. 
                  </p>
                  <p>To notify the object cache that an application is accessing an object in the cache, the application pins the object; when it is finished with the object, it unpins it. The object cache maintains a pin count for each object in the cache. The count is incremented upon a pin call and decremented upon an unpin call. When the pin count goes to zero, it means the object is no longer needed by the application. </p>
                  <p>The object cache uses a least-recently used (LRU) algorithm to manage the size of the cache. When the cache reaches the maximum size, the LRU algorithm frees candidate objects with a pin count of zero.</p>
               </div>
            </div><a id="ADOBJ7198"></a><div class="props_rev_3"><a id="GUID-99AA9F59-9347-45FF-A569-70E218A30F89" name="GUID-99AA9F59-9347-45FF-A569-70E218A30F89"></a><h3 id="ADOBJ-GUID-99AA9F59-9347-45FF-A569-70E218A30F89" class="sect3"><span class="enumeration_section">4.4.5 </span>Building an OCI Program That Manipulates Objects
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d15326e475" class="indexterm-anchor"></a>You can build an OCI program to manipulate objects by representing types in the C host language format.
                     </p>
                     <p>When you build an OCI program that manipulates objects, you must complete the following general steps</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Define the object types that correspond to the application objects. </span></li>
                     <li class="stepexpand"><span>Execute the SQL DDL statements to populate the database with the necessary object types. </span></li>
                     <li class="stepexpand"><span>Represent the object types in the host language format.</span><div>
                           <p>For example, to manipulate instances of the object types in a C program, you must represent these types in the C host language format. You can do this by representing the object types as C structs. You can use a tool provided by Oracle called the Object Type Translator (OTT) to generate the C mapping of the object types. The OTT puts the equivalent C structs in header (*.h) files. You include these *.h files in the *.c files containing the C functions that implement the application. </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Construct the application executable by compiling and linking the application's *.c files with the OCI library.</span><div>
                           <div class="infoboxnotealso" id="GUID-99AA9F59-9347-45FF-A569-70E218A30F89__GUID-5EA111EF-4B40-4243-8760-1A5CAEFF9192">
                              <p class="notep1">See Also:</p>
                              <p> <a href="../lnoci/oci-object-relational-programming.html#LNOCI100" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a> for tips and techniques for using OCI program effectively with objects
                              </p>
                           </div>
                        </div>
                     </li>
                  </ol>
               </div>
            </div><a id="ADOBJ7200"></a><a id="ADOBJ7199"></a><div class="props_rev_3"><a id="GUID-A03F7475-9470-4D25-9060-E5E055347D4A" name="GUID-A03F7475-9470-4D25-9060-E5E055347D4A"></a><h3 id="ADOBJ-GUID-A03F7475-9470-4D25-9060-E5E055347D4A" class="sect3"><span class="enumeration_section">4.4.6 </span>Defining User-Defined Constructors in C
               </h3>
               <div>
                  <div class="section">
                     <p>When defining a user-defined constructor in C, you must specify <code class="codeph">SELF</code> (and you may optionally specify <code class="codeph">SELF</code> <code class="codeph">TDO</code>) in the <code class="codeph">PARAMETERS</code> clause. 
                     </p>
                     <p>On entering the C function, the attributes of the C structure that the object maps to are all initialized to <code class="codeph">NULL</code>. The value returned by the function is mapped to an instance of the user-defined type.
                     </p>
                     <p> <a href="oracle-call-interface-oci.html#GUID-A03F7475-9470-4D25-9060-E5E055347D4A__CCHDJCAC">Example 4-1</a> shows how to define a user-defined constructor in C.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-A03F7475-9470-4D25-9060-E5E055347D4A__CCHDJCAC">
                     <p class="titleinexample">Example 4-1 Defining a User-Defined Constructor in C</p><pre class="oac_no_warn" dir="ltr">CREATE LIBRARY person_lib TRUSTED AS STATIC
/

CREATE TYPE person AS OBJECT
  (  name VARCHAR2(30),
     CONSTRUCTOR FUNCTION person(SELF IN OUT NOCOPY person, name VARCHAR2) 
         RETURN SELF AS RESULT);
/

CREATE TYPE BODY person IS
    CONSTRUCTOR FUNCTION person(SELF IN OUT NOCOPY person, name VARCHAR2) 
         RETURN SELF AS RESULT
    IS EXTERNAL NAME "cons_person_typ" LIBRARY person_lib WITH CONTEXT
    PARAMETERS(context, SELF, name OCIString, name INDICATOR sb4); 
END;/
</pre><p>The <code class="codeph">SELF</code> parameter is mapped like an <code class="codeph">IN</code> parameter, so in the case of a <code class="codeph">NOT</code> <code class="codeph">FINAL</code> type, it is mapped to <code class="codeph">(dvoid *)</code>, not <code class="codeph">(dvoid **)</code>. The return value's <code class="codeph">TDO</code> must match the <code class="codeph">TDO</code> of <code class="codeph">SELF</code> and is therefore implicit. The return value can never be null, so the return indicator is implicit as well.
                     </p>
                  </div>
                  <!-- class="example" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>