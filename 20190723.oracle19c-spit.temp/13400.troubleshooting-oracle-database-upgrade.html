<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">
      <meta name="description" content="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">
      <title>Troubleshooting the Upgrade for Oracle Database</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database Upgrade Guide">
      <meta property="og:description" content="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database Upgrade Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-upgrade-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-04-25T08:26:31-07:00">
      <meta name="dcterms.title" content="Database Upgrade Guide">
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96252-05">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="transporting-upgrading-database-full-transportable-export-import.html" title="Previous" type="text/html">
      <link rel="next" href="rerunning-upgrades-oracle-database.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="UPGRD">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="transporting-upgrading-database-full-transportable-export-import.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="rerunning-upgrades-oracle-database.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database Upgrade Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="upgrading-oracle-database.html" property="item" typeof="WebPage"><span property="name">Upgrading Oracle Database</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Troubleshooting the Upgrade for Oracle Database</li>
            </ol>
            <a id="GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" name="GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2"></a><a id="UPGRD12409"></a>
            
            <h2 id="UPGRD-GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" class="sect2">Troubleshooting the Upgrade for Oracle Database</h2>
         </header>
         <div class="ind">
            <div>
               <p>Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.</p>
               <p>Also review the related links to learn about changes that affect this release, which may be related to errors you receive, and to see how to rerun the upgrade after you resolve errors. </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-21A033B9-5994-4FFC-8D30-D0ABCBB1AC19">About Starting Oracle Database in Upgrade Mode</a><br>When you start Oracle Database in upgrade mode, you can only run queries on fixed views. If you attempt to run other views or PL/SQL, then you receive errors.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-6444C924-B085-4941-897D-F8611F9C7625">Running DBUA with Different ORACLE_HOME Owner</a><br>Review this topic if your Oracle Database homes are owned by different operating system user accounts, or you encounter an <samp class="sysout">upgrade.xml not found</samp> error.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-FC90995E-8E54-4E8B-B889-A497866CCA2A">Invalid Object Warnings and DBA Registry Errors</a><br>Before you start your upgrade, Oracle strongly recommends that you run the preupgrade information tool (<code class="codeph">preupgrd.jar</code>).
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-A6C4B02E-EF6D-449D-82E8-732AF59A7F8B">Invalid Objects and Premature Use of Postupgrade Tool</a><br>Never run the postupgrade status tool for the new Oracle Database release (<code class="codeph">utlusts.sql</code>) until after you complete the upgrade.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-785B0B45-97D9-49FD-8312-2562210D4AF8">Resolving Oracle Database Upgrade Script Termination Errors</a><br>Review this section if you encounter ORA-00942, ORA-00904, or ORA-01722 errors. 
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-AD67C5DA-7481-454D-B259-E362839451AB">Troubleshooting Causes of Resource Limits Errors while Upgrading Oracle Database</a><br>Review this section if you encounter ORA-01650, ORA-01651, ORA-01652, ORA-01653, ORA-01654, ORA-01655, ORA-0431, ORA-01562, ORA-19815, or other errors that suggest resource limit errors. 
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-5C6DA3B0-396D-4532-A735-9A27C1AF28FE">Resolving SQL*Plus Edition Session Startup Error for Oracle Database</a><br>Use this section to understand and resolve SP2&#x2013;1540: "Oracle Database cannot startup in an Edition session."
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-A58002D5-370D-462E-9AA8-7E87142F70B9">Error ORA-00020 Maximum Number of Processes Exceeded When Running utlrp.sql</a><br>This error may indicate that your Oracle configuration does not have sufficient number of processes available for the recompile.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-30A17B15-665C-4403-A66F-8BC1A0585A15">Fixing ORA-01822 with DBMS_DST Package After Upgrades</a><br>Use this procedure to fix <samp class="sysout">ORA-01822</samp> and<samp class="sysout"> ORA-16512</samp> errors involving time zone file mismatches.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-C6C97136-C79D-49EB-A1AA-16744FB3DA4B">Fixing ORA-28365: Wallet Is Not Open Error</a><br>If you use Oracle wallet with Transparent Data Encryption (TDE), and you use Database Upgrade Assistant (DBUA) to upgrade the database, then you can encounter an ORA-28365 "wallet is not open" error. 
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-1F73128E-6DCE-46F8-9587-6E833732607F">Resolving issues with view CDB_JAVA_POLICY</a><br>If the view CDB_JAVA_POLICY becomes invalid, then use this procedure. 
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-2FF8F7DD-EF1A-4E2B-8A86-EC427B78EA2C">Continuing Upgrades After Server Restarts (ADVM/ACFS Driver Error)</a><br>On Windows platforms, an error may occur related to ADVM or ACFS drivers if a server restarts during an upgrade.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-8AA2F6FB-516F-408C-868C-3979C46A5F7C">Component Status and Upgrades</a><br>Component status settings are affected both by the components that you previously installed, and by the support of those components for upgrades.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-16E662C1-2877-4C97-A9D5-531735FAA2AC">Standard Edition Starter Database and Components with Status OPTION OFF</a><br>Starting in Oracle Database 18c (18.1), all <code class="codeph">OPTION OFF</code> components are upgraded to the new release, but these options are disabled for Oracle Database Standard Edition (SE) remain OPTION OFF.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-50E0EE5B-9549-4A35-8F27-5134AC42D484">Adjusting Oracle ASM Password File Location After Upgrade</a><br>You must create a new password file for Oracle ASM after an Oracle Grid Infrastructure upgrade. 
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-371A976A-C6B5-408A-85C3-13B8D4D80BF0">Fixing "Warning XDB Now Invalid" Errors with Pluggable Database Upgrades</a><br>Review this topic if you encounter "Warning: XDB now invalid, invalid objects found” errors when upgrading pluggable databases (PDBs). 
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-0BBD601F-03AD-495F-BE3B-EBF6F5180A12">Fixing ORA-27248: sys.dra_reevaluate_open_failures is running</a><br>Use this procedure to identify <code>DRA_REEVALUATE_OPEN_FAILURES</code> jobs that block upgrades.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-82B1B90A-9268-4FCA-91B5-9486A01B0C11">Fixing ORA-22288: File or LOB Operation FILEOPEN Failed Soft Link in Path</a><br>ORA-22288 occurs when symbolic links are in directory object paths or filenames when opening BFILES.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-39D29002-04E8-4C15-99CB-3BA74DE7C9E3">Fixing Oracle Database Enterprise User Security, OLS-OID, and Provisioning Profile Error</a><br>Review to understand <samp class="sysout">ORA-16000: database open for read-only access</samp> errors.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-C9EA4C17-E283-4D21-9C9B-0EE97FE2A486">Fixing 32K Migration Error with utl32k.sql and MAX_STRING_SIZE</a><br>Use this procedure to fix <samp class="sysout">ORA-01722: invalid number</samp> upgrade errors.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-906173BF-B48E-4E2A-86EF-7B174E564AC0">Recovering from a CRS Shutdown and Oracle ASM Losing Rolling Migration</a><br>A Cluster Ready Services (CRS) shutdown on all cluster member nodes can place the cluster in a heterogeneous state. Use this procedure to recover from that problem.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-6D5F3EEE-D8CC-45F8-81A7-1C3BC96952FA">Data Type Versioning Can Cause Cross-Version Replication (ORA-26656)</a><br>Review the user-defined object types affected by versioning.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-A6410CD4-4DCE-41D3-BBA1-0CF1CC8204E5">Referenced Symbol Count is Undefined Error libclntsh.so.11.1</a><br>Review this topic if you encounter errors that reference <code class="codeph">libclntsh.so.11.1</code> with "referenced symbol count is undefined", "cannot open shared object file", or similar errors.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-264F7099-5C9F-42D1-B3D7-D9754CA7F3C2">Resolving Timestamp Errors Due to ISO 8601 Timestamps</a><br>Review this topic if you encounter timestamp errors with applications after upgrading to Oracle Database 12<span class="italic">c</span>, 18c, or later releases.
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-2F4DAD7F-92E4-415C-A91B-7EE480633E3E">Fixing Failed Upgrades Where Only Datapatch Fails</a><br>If only datapatch fails during an upgrade, then rerun datapatch directly. 
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-C18782A1-4A4F-4C06-B0D6-F58ECE28E13C">Error "Timezone Datafiles May Not Be Downgraded To a Lower Version"</a><br>You encounter a time zone error that prohibits the upgrade if the daylight savings time (DST) version in the database you are upgrading is newer than the DST in the database release to which you are upgrading. 
                  </li>
                  <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-25BB78B8-B59D-4039-B838-9BCA13A5377C">Fixing Failures to Complete Registration of Listeners with DBUA</a><br>On the Database Upgrade Assistant Progress step, a window appears with this warning: "Unable to create database entry in the directory service. No Listeners configured."
                  </li>
               </ul>
               <div class="relinfo">
                  <p><strong>Related Topics</strong></p>
                  <ul>
                     <li><a href="rerunning-upgrades-oracle-database.html#GUID-190D00A4-BE9A-4139-B3FC-A29C2BFBE91B" title="Use these options to rerun upgrades.">Rerunning Upgrades for Oracle Database</a></li>
                  </ul>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="upgrading-oracle-database.html#GUID-CC88F262-3370-4FFA-8604-EDA9F20F56D9" title="Oracle provides a comprehensive set of tools for upgrading Oracle Database with minimal downtime and for migrating your applications to the new release.">Upgrading Oracle Database</a></p>
                  </div>
               </div>
            </div><a id="UPGRD52874"></a><div class="props_rev_3"><a id="GUID-21A033B9-5994-4FFC-8D30-D0ABCBB1AC19" name="GUID-21A033B9-5994-4FFC-8D30-D0ABCBB1AC19"></a><h3 id="UPGRD-GUID-21A033B9-5994-4FFC-8D30-D0ABCBB1AC19" class="sect3">About Starting Oracle Database in Upgrade Mode</h3>
               <div>
                  <p>When you start Oracle Database in upgrade mode, you can only run queries on fixed views. If you attempt to run other views or PL/SQL, then you receive errors.</p>
                  <p>When the database is started in upgrade mode, only queries on fixed views execute without errors. This restriction applies until you either run the Parallel Upgrade Utility (<code>catctl.pl</code>) directly, or indirectly by using the <code>dbupgrade</code> script). Before running an upgrade script, using PL/SQL on any other view, or running queries on any other view returns an error. If you receive any of the errors described in this section, then issue the <code class="codeph">SHUTDOWN ABORT</code> command to shut down the database, and then correct the problem.
                  </p>
                  <p>The following list of errors can occur when you attempt to start the new Oracle Database release. Some of these errors write to the alert log, and not to your session.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">ORA-00401: the value for parameter compatible is not supported by this release</code></p>
                        <p>The <code class="codeph">COMPATIBLE</code> initialization parameter is set to a value less than <code class="codeph">11.2.0</code>.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">ORA-39701: database must be mounted EXCLUSIVE for UPGRADE or DOWNGRADE</code></p>
                        <p>The <code class="codeph">CLUSTER_DATABASE</code> initialization parameter is set to <code class="codeph">TRUE</code> instead of <code class="codeph">FALSE</code>.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">ORA-39700: database must be opened with UPGRADE option</code></p>
                        <p>The <code class="codeph">STARTUP</code> command was issued without the <code class="codeph">UPGRADE</code> keyword.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">Ora-00704: bootstrap failure</code></p>
                        <p>The path variable can be pointing to the earlier release Oracle home. </p>
                     </li>
                     <li>
                        <p><code class="codeph">ORA-00336: log file size xxxx blocks is less than minimum 8192 blocks</code></p>
                        <p>A redo log file size is less than 4 MB.</p>
                     </li>
                  </ul>
                  <p>If errors appear listing desupported initialization parameters, then make a note of the desupported initialization parameters, and continue with the upgrade. Remove the desupported initialization parameters the next time you shut down the database.</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="https://support.oracle.com/rs?type=doc&amp;id=1349722.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=1349722.1</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="UPGRD60135"></a><div class="props_rev_3"><a id="GUID-6444C924-B085-4941-897D-F8611F9C7625" name="GUID-6444C924-B085-4941-897D-F8611F9C7625"></a><h3 id="UPGRD-GUID-6444C924-B085-4941-897D-F8611F9C7625" class="sect3">Running DBUA with Different ORACLE_HOME Owner</h3>
               <div>
                  <p>Review this topic if your Oracle Database homes are owned by different operating system user accounts, or you encounter an <samp class="sysout">upgrade.xml not found</samp> error.
                  </p>
                  <p>DBUA upgrades by default assume that both the source (release earlier than Oracle Database 12<span class="italic">c</span>) Oracle home and the destination (new 12<span class="italic">c</span>) Oracle home are owned by the same user. If each Oracle home is not owned by the same user, then you must change to database file permissions and pass additional parameters to DBUA. If you do not do this, then during upgrade, the DBUA Prerequisite Checks page reports <samp class="sysout">upgrade.xml not found</samp> errors. You are not permitted to proceed with the upgrade until this error is corrected. 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>All Oracle Database installation owners should have the group that you designate as the OINSTALL group (or Oracle Inventory group) as their primary group. Ensure all database files (data files, the redo file, control files, archive log destination, recovery area, SPFILE, and password file) are readable and writable by both the new 12<span class="italic">c</span> and pre-12<span class="italic">c</span> binary owners. If this is not the case, then confirm that each installation owner has the same group as their primary group, and ensure that members of the OINSTALL group have read/write access to all the earlier release and later release Oracle Database files and directories.
                        </p>
                     </li>
                     <li>
                        <p>Run DBUA by specifying the <code>-logdir</code> command line option, and provide a directory to which both the new release and earlier release binary owners can write. For example: <code class="codeph">/tmp</code>. DBUA uses the directory you designate with the <span class="parmname" translate="no">logdir </span> parameter to store the output from the Pre-upgrade Information Tool, and to store any DBUA log files generated during the upgrade. You run the Pre-Upgrade Information tool from the earlier release Oracle Database instance as the earlier release Oracle Database installation owner user account.
                        </p>
                        <p>For example:</p><pre class="pre codeblock"><code>dbua -logdir /tmp</code></pre></li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-FC90995E-8E54-4E8B-B889-A497866CCA2A" name="GUID-FC90995E-8E54-4E8B-B889-A497866CCA2A"></a><h3 id="UPGRD-GUID-FC90995E-8E54-4E8B-B889-A497866CCA2A" class="sect3">Invalid Object Warnings and DBA Registry Errors</h3>
               <div>
                  <p>Before you start your upgrade, Oracle strongly recommends that you run the preupgrade information tool (<code class="codeph">preupgrd.jar</code>).
                  </p>
                  <p>The preupgrade information tool identifies invalid SYS and SYSTEM objects, as well as other invalid objects. Use <code class="codeph">utlrp.sql</code> to recompile invalid objects. If you fail to do this before an upgrade, then it becomes difficult to determine which objects in your system were invalid before starting the upgrade, and which objects become invalid as a result of the upgrade. 
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-preupgrade-information-tool-for-oracle-database.html#GUID-C0219AF1-AD43-4097-B358-E53E48958647">Using the Pre-Upgrade Information Tool for Oracle Database</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-A6C4B02E-EF6D-449D-82E8-732AF59A7F8B" name="GUID-A6C4B02E-EF6D-449D-82E8-732AF59A7F8B"></a><h3 id="UPGRD-GUID-A6C4B02E-EF6D-449D-82E8-732AF59A7F8B" class="sect3">Invalid Objects and Premature Use of Postupgrade Tool</h3>
               <div>
                  <p>Never run the postupgrade status tool for the new Oracle Database release (<code class="codeph">utlusts.sql</code>) until after you complete the upgrade.
                  </p>
                  <p>Oracle recommends that you run the postupgrade status tool only after the upgrade process is complete, and after you have run <code class="codeph">utlrp.sql</code>. If the postupgrade status tool is run before you run <code class="codeph">@utlrp.sql</code>, then the output of tool may not display the accurate final component status value. If the tool is run before running <code class="codeph">utlrp.sql</code>, then the component status values may not properly reflect the final state. You can only determine the final component state after running <code class="codeph">utlrp.sql</code>. 
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD52875"></a><div class="props_rev_3"><a id="GUID-785B0B45-97D9-49FD-8312-2562210D4AF8" name="GUID-785B0B45-97D9-49FD-8312-2562210D4AF8"></a><h3 id="UPGRD-GUID-785B0B45-97D9-49FD-8312-2562210D4AF8" class="sect3">Resolving Oracle Database Upgrade Script Termination Errors</h3>
               <div>
                  <p>Review this section if you encounter ORA-00942, ORA-00904, or ORA-01722 errors. </p>
                  <p>If you do not run the Pre-Upgrade Information Tool before starting the upgrade, then the <code class="codeph">catctl.pl</code> and <code class="codeph">catupgrd.sql</code> scripts terminate with errors as follows:
                  </p><pre class="pre codeblock"><code>ORA-00942: table or view does not exist
ORA-00904: "TZ_VERSION": invalid identifier
ORA-01722: invalid number
</code></pre><p>If you receive any of these errors, then complete the following procedure: </p>
                  <ol>
                     <li>
                        <p>Enter a <code>SHUTDOWN ABORT</code> command, and wait for the command to complete running. 
                        </p>
                     </li>
                     <li>
                        <p>Revert to the original Oracle home directory</p>
                     </li>
                     <li>
                        <p>Run the Pre-Upgrade Information Tool.</p>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-preupgrade-information-tool-for-oracle-database.html#GUID-C0219AF1-AD43-4097-B358-E53E48958647" title="Review these topics to understand and to use the Pre-Upgrade information tool (preupgrade.jar).">Pre-Upgrade Information Tool for Oracle Database</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="UPGRD12410"></a><div class="props_rev_3"><a id="GUID-AD67C5DA-7481-454D-B259-E362839451AB" name="GUID-AD67C5DA-7481-454D-B259-E362839451AB"></a><h3 id="UPGRD-GUID-AD67C5DA-7481-454D-B259-E362839451AB" class="sect3">Troubleshooting Causes of Resource Limits Errors while Upgrading Oracle Database</h3>
               <div>
                  <p>Review this section if you encounter ORA-01650, ORA-01651, ORA-01652, ORA-01653, ORA-01654, ORA-01655, ORA-0431, ORA-01562, ORA-19815, or other errors that suggest resource limit errors. </p>
                  <p>If you run out of resources during an upgrade, then increase the resource allocation. After increasing the resource allocation, shut down the instance with <kbd class="userinput">SHUTDOWN ABORT</kbd>, and restart the instance in <kbd class="userinput">UPGRADE</kbd> mode before re-running the <code>catupgrd.sql</code> script.
                  </p>
                  <p>The resources that generally require increases for a new Oracle Database release are as follows:</p>
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code> tablespaces
                           </p>
                           <p>If your <code class="codeph">SYSTEM</code> tablespace size is insufficient, then typically you receive the following error message:
                           </p><pre class="oac_no_warn" dir="ltr">ORA-01650: unable to extend rollback segment <span class="italic">string</span> by <span class="italic">string</span> in tablespace <span class="italic">string</span>
ORA-01651: unable to extend save undo segment by <span class="italic">string</span> for tablespace <span class="italic">string</span>
ORA-01652: unable to extend temp segment by <span class="italic">string</span> in tablespace <span class="italic">string</span>
ORA-01653: unable to extend table <span class="italic">string</span>.<span class="italic">string</span> by <span class="italic">string</span> in tablespace <span class="italic">string</span>
ORA-01654: unable to extend index <span class="italic">string</span>.<span class="italic">string</span> by <span class="italic">string</span> in tablespace <span class="italic">string</span>
ORA-01655: unable to extend cluster <span class="italic">string</span>.<span class="italic">string</span> by <span class="italic">string</span> in tablespace <span class="italic">string</span>
</pre><p>To avoid these errors, set <code class="codeph">AUTOEXTEND ON MAXSIZE UNLIMITED</code> for the <code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code> tablespaces.
                           </p>
                        </li>
                        <li>
                           <p>Shared memory</p>
                           <p>In some cases, you may require larger shared memory pool sizes. The error message indicates which shared memory initialization parameter you must increase, in the following format:</p><pre class="oac_no_warn" dir="ltr">ORA-04031: unable to allocate <span class="italic">string</span> bytes of shared memory ("<span class="variable" translate="no">string</span>","<span class="variable" translate="no">string</span>","<span class="variable" translate="no">string</span>","<span class="variable" translate="no">string</span>")
</pre><div class="infoboxnotealso" id="GUID-AD67C5DA-7481-454D-B259-E362839451AB__GUID-416288E2-B906-4637-83F9-CD06746DFB5A">
                              <p class="notep1">See Also:</p>
                              <p><a href="../admin/managing-memory.html#ADMIN11218" target="_blank"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about using manual shared memory management
                              </p>
                           </div>
                        </li>
                        <li>
                           <p>Rollback segments/undo tablespace</p>
                           <p>If you are using rollback segments, then you must have a single large (100 MB) <code class="codeph">PUBLIC</code> rollback segment online while the upgrade scripts are being run. Smaller public rollback segments should be taken offline during the upgrade. If your rollback segment size is insufficient, then typically you encounter the following error:
                           </p><pre class="pre codeblock"><code>ORA-01562: failed to extend rollback segment number <span class="variable" translate="no">string</span>
</code></pre><p>If you are using an undo tablespace, then be sure it is at least 400 MB.</p>
                        </li>
                        <li>
                           <p>Fast Recovery Area</p>
                           <p>If you are using a Fast Recovery Area and it fills up during the upgrade, then the following error appears in the alert log, followed by suggestions for recovering from the problem:</p><pre class="pre codeblock"><code>ORA-19815: WARNING: db_recovery_file_dest_size of <span class="italic">string</span> bytes is 98.99%
used, and has <span class="variable" translate="no">string</span> remaining bytes available.
</code></pre><pre class="oac_no_warn" dir="ltr"></pre><p>Identify the root cause of the problem, and take appropriate actions to proceed with the upgrade. To avoid issues during the upgrade, increase the amount of space available in your Fast Recovery Area before starting the upgrade.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD52742"></a><div class="props_rev_3"><a id="GUID-5C6DA3B0-396D-4532-A735-9A27C1AF28FE" name="GUID-5C6DA3B0-396D-4532-A735-9A27C1AF28FE"></a><h3 id="UPGRD-GUID-5C6DA3B0-396D-4532-A735-9A27C1AF28FE" class="sect3">Resolving SQL*Plus Edition Session Startup Error for Oracle Database</h3>
               <div>
                  <p>Use this section to understand and resolve SP2&#x2013;1540: "Oracle Database cannot startup in an Edition session."</p>
                  <p>If an upgrade script or a command running in SQL*Plus set the <span class="parmname" translate="no">EDITION</span> parameter, then Oracle Database cannot start properly afterward. When you attempt to start the database, you receive the following error:
                  </p><pre class="oac_no_warn" dir="ltr">SP2-1540: "Oracle Database cannot startup in an Edition session"</pre><p>To avoid this problem, after running <code>catugrd.sql</code> or any SQL*Plus session where this parameter is changed, exit the SQL*Plus session and restart the instance in a different session.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-A58002D5-370D-462E-9AA8-7E87142F70B9" name="GUID-A58002D5-370D-462E-9AA8-7E87142F70B9"></a><h3 id="UPGRD-GUID-A58002D5-370D-462E-9AA8-7E87142F70B9" class="sect3">Error ORA-00020 Maximum Number of Processes Exceeded When Running utlrp.sql</h3>
               <div>
                  <p>This error may indicate that your Oracle configuration does not have sufficient number of processes available for the recompile.</p>
                  <p>Refer to Oracle documentation for more details about setting the <span class="parmname" translate="no">PROCESSES</span> parameter.
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-A58002D5-370D-462E-9AA8-7E87142F70B9__GUID-80D2361F-0129-40EA-9D4D-3D8B5602A0DF">
                     <p class="notep1">See Also:</p>
                     <p><a href="../refrn/PROCESSES.html#REFRN10175" target="_blank"><span><cite>Oracle Database Reference</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD52648"></a><div class="props_rev_3"><a id="GUID-30A17B15-665C-4403-A66F-8BC1A0585A15" name="GUID-30A17B15-665C-4403-A66F-8BC1A0585A15"></a><h3 id="UPGRD-GUID-30A17B15-665C-4403-A66F-8BC1A0585A15" class="sect3">Fixing ORA-01822 with DBMS_DST Package After Upgrades</h3>
               <div>
                  <p>Use this procedure to fix <samp class="sysout">ORA-01822</samp> and<samp class="sysout"> ORA-16512</samp> errors involving time zone file mismatches.
                  </p>
                  <p>Running the <code class="codeph">DBMS_DST</code> package after upgrading to Oracle Database 12<span class="italic">c</span> can result in an <code class="codeph">ORA-01882: time zone region not found</code> error.
                  </p>
                  <p>This error is returned if the time zone file version is set incorrectly. An incorrect time zone setting results in the region IDs of several time zone regions being stored incorrectly in the database. For example:</p><pre class="oac_no_warn" dir="ltr">ERROR at line 1:
@  ORA-01882: time zone region not found
@  ORA-06512: at "SYS.DBMS_DST", line 113
@  ORA-06512: at "SYS.DBMS_DST", line 1101
@  ORA-06512: at line 1
</pre><p>To fix this problem, update the time zone version, and re-run the upgrade.</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-C6C97136-C79D-49EB-A1AA-16744FB3DA4B" name="GUID-C6C97136-C79D-49EB-A1AA-16744FB3DA4B"></a><h3 id="UPGRD-GUID-C6C97136-C79D-49EB-A1AA-16744FB3DA4B" class="sect3">Fixing ORA-28365: Wallet Is Not Open Error</h3>
               <div>
                  <p>If you use Oracle wallet with Transparent Data Encryption (TDE), and you use Database Upgrade Assistant (DBUA) to upgrade the database, then you can encounter an ORA-28365 "wallet is not open" error. </p>
                  <div class="section">To avoid this problem, complete the following tasks before upgrading: </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Log in as an authorized user.</span></li>
                     <li class="stepexpand"><span>Manually copy the <code class="codeph">sqlnet.ora</code> file, and the wallet file, <code class="codeph">ewallet.p12</code>, to the new release Oracle home.</span></li>
                     <li class="stepexpand"><span>Open the Oracle wallet in mount.</span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>SQL&gt; STARTUP MOUNT;
SQL&gt; ALTER SYSTEM SET ENCRYPTION WALLET OPEN</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Start the upgrade as usual. </span></li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-1F73128E-6DCE-46F8-9587-6E833732607F" name="GUID-1F73128E-6DCE-46F8-9587-6E833732607F"></a><h3 id="UPGRD-GUID-1F73128E-6DCE-46F8-9587-6E833732607F" class="sect3">Resolving issues with view CDB_JAVA_POLICY</h3>
               <div>
                  <p>If the view CDB_JAVA_POLICY becomes invalid, then use this procedure. </p>
                  <div class="section">
                     <p>After an upgrade to Oracle Database 12<span class="italic">c</span> release 2 (12.2) and later releases, or a downgrade from release 12.2 or later releases to 12.1, you can encounter issues with the CDB_JAVA_POLICY view. CDB_JAVA_POLICY can become invalid, or it can encounter errors when you use it in a manner that normally works. If this happens, then connect as SYS, and run the following commands.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-1F73128E-6DCE-46F8-9587-6E833732607F__GUID-12E0B7EA-B343-46C7-B0E3-AC45F368A22E">
                     <p>Non-CDBs:</p><pre class="pre codeblock"><code>alter session set "_ORACLE_SCRIPT"=true;

exec CDBView.create_cdbview(false,'SYS','dba_java_policy','CDB_java_policy');

grant select on SYS.CDB_java_policy to select_catalog_role
/
create or replace public synonym CDB_java_policy for SYS.CDB_java_policy
/
</code></pre><p>Multitenant architecture systems:</p>
                     <p>Run these same commands, but run them first in CDB$ROOT, and then in other containers in the CDB.</p>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD60105"></a><div class="props_rev_3"><a id="GUID-2FF8F7DD-EF1A-4E2B-8A86-EC427B78EA2C" name="GUID-2FF8F7DD-EF1A-4E2B-8A86-EC427B78EA2C"></a><h3 id="UPGRD-GUID-2FF8F7DD-EF1A-4E2B-8A86-EC427B78EA2C" class="sect3">Continuing Upgrades After Server Restarts (ADVM/ACFS Driver Error)</h3>
               <div>
                  <p>On Windows platforms, an error may occur related to ADVM or ACFS drivers if a server restarts during an upgrade.</p>
                  <p>If a server restarts during the upgrade, then you may see one of the following error messages:</p><pre class="pre codeblock"><code>ACFS-9427: Failed to unload ADVM/ACFS drivers. A system reboot is recommended
</code></pre><pre class="pre codeblock"><code>ACFS-9428 Failed to load ADVM/ACFS drivers. A system reboot is recommended.</code></pre><ul style="list-style-type: disc;">
                     <li>
                        <p>Cause</p>
                        <p>The ADVM and ACFS drivers are still in use. You must restart the system to start the new drivers.</p>
                     </li>
                     <li>
                        <p>Action</p>
                        <p>Complete the steps as described in the following procedures.</p>
                     </li>
                  </ul>
                  <p>For nodes other than the first node (the node on which the upgrade is started):</p>
                  <ol>
                     <li>
                        <p>Restart the node where the error occurs.</p>
                     </li>
                     <li>
                        <p>Run the root script on that node again.</p>
                     </li>
                  </ol>
                  <p>For first nodes (the node on which the upgrade is started):</p>
                  <ol>
                     <li>
                        <p>Complete the upgrade of all other nodes in the cluster.</p>
                     </li>
                     <li>
                        <p>Restart the first node.</p>
                     </li>
                     <li>
                        <p>Run the root script on the first node again.</p>
                     </li>
                     <li>
                        <p>To complete the upgrade, log in as root, and run the script <code class="codeph">configToolAllCommands</code>, located in the path <span class="italic"><code class="codeph">Grid_home</code></span><code class="codeph">/cfgtoollogs/configToolAllCommands</code>.
                        </p>
                     </li>
                  </ol>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-2FF8F7DD-EF1A-4E2B-8A86-EC427B78EA2C__GUID-B6FF10E8-EB42-44CB-8F47-5461C1A8914B">
                     <p class="notep1">See Also:</p>
                     <p><a href="../install-and-upgrade.html" target="_blank"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for your operating system for more information about troubleshooting upgrade issues for clusters
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-8AA2F6FB-516F-408C-868C-3979C46A5F7C" name="GUID-8AA2F6FB-516F-408C-868C-3979C46A5F7C"></a><h3 id="UPGRD-GUID-8AA2F6FB-516F-408C-868C-3979C46A5F7C" class="sect3">Component Status and Upgrades</h3>
               <div>
                  <p>Component status settings are affected both by the components that you previously installed, and by the support of those components for upgrades.</p>
                  <p>Topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-5F3F0B5E-BF6E-488E-8819-850843758675">Understanding Component Status With the Post-Upgrade Status Tool</a><br>The Post-Upgrade Status tool, <code>utlusts.sql</code>, reports database component status after an upgrade is completed. 
                     </li>
                     <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-3D897BE9-AF83-4D96-831E-02AA070C7632">Component OPTION OFF Status and Upgrades</a><br>The upgrade status of <code class="codeph">OPTION OFF</code> components is affected both by the support in the target release for a component, and if a component must be upgraded as part of an upgrade.
                     </li>
                     <li class="ulchildlink"><a href="troubleshooting-oracle-database-upgrade.html#GUID-5D85ED88-0740-44DE-AA53-318D7240FF0E">Example of an Upgrade Summary Report</a><br>Upgrade summary reports provide information about the upgrade status of components.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               <a id="UPGRD12411"></a><div class="props_rev_3"><a id="GUID-5F3F0B5E-BF6E-488E-8819-850843758675" name="GUID-5F3F0B5E-BF6E-488E-8819-850843758675"></a><h4 id="UPGRD-GUID-5F3F0B5E-BF6E-488E-8819-850843758675" class="sect4">Understanding Component Status With the Post-Upgrade Status Tool</h4>
                  <div>
                     <p>The Post-Upgrade Status tool, <code>utlusts.sql</code>, reports database component status after an upgrade is completed. 
                     </p>
                     <p>You can run the Post-Upgrade Status Tool <code>utlusts.sql</code> anytime after upgrade, post-upgrade, or after recompiling invalid objects with <code>utlrp.sql</code>. 
                     </p>
                     <p>The following list briefly describes the status values that the Post-Upgrade Status tool reports:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><samp class="sysout">INVALID</samp></p>
                           <p>When the upgrade completed, some objects for the component remained in an invalid state. If you find no errors in the log file for component upgrades then run the script <code>utlrp.sql</code>. Running this script may change the status of invalid components to <code class="codeph">VALID</code> without rerunning the entire upgrade. Check the <code class="codeph">DBA_REGISTRY</code> view after running <code>utlrp.sql</code>. 
                           </p>
                        </li>
                        <li>
                           <p><samp class="sysout">VALID</samp></p>
                           <p>The component is valid with no errors.</p>
                        </li>
                        <li>
                           <p><samp class="sysout">LOADING</samp></p>
                           <p>The component is loading</p>
                        </li>
                        <li>
                           <p><samp class="sysout">LOADED</samp></p>
                           <p>The component has successfully finished loading.</p>
                        </li>
                        <li>
                           <p><samp class="sysout">UPGRADING</samp></p>
                           <p>The component is in process being upgraded.</p>
                        </li>
                        <li>
                           <p><samp class="sysout">UPGRADED</samp></p>
                           <p>The component has completed upgrading with no errors. </p>
                        </li>
                        <li>
                           <p><samp class="sysout">DOWNGRADING</samp></p>
                           <p>The component is in process being downgraded.</p>
                        </li>
                        <li>
                           <p><samp class="sysout">DOWNGRADED</samp></p>
                           <p>The component has completed downgrading with no errors.</p>
                        </li>
                        <li>
                           <p><samp class="sysout">REMOVING</samp></p>
                           <p>The component is in process being removed.</p>
                        </li>
                        <li>
                           <p><samp class="sysout">REMOVED</samp></p>
                           <p>The component was not upgraded because it was removed from the database.</p>
                        </li>
                        <li>
                           <p><samp class="sysout">OPTION OFF</samp></p>
                           <p>The server option required for the component was not installed or was not linked with the server. Check the <code class="codeph">V$OPTION</code> view and the install logs. Install the component or relink the server with the required option, and then re-run the Parallel Upgrade Utility. 
                           </p>
                        </li>
                        <li>
                           <p><samp class="sysout">NO SCRIPT</samp></p>
                           <p>The component upgrade script was not found in $ORACLE_HOME. Check the install logs, install the component software, and then re-run the Parallel Upgrade Utility.</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-5F3F0B5E-BF6E-488E-8819-850843758675__GUID-DB88692E-C2CB-4E46-B785-DDB278D7810D">
                        <p class="notep1">Note:</p>
                        <p>You can run the Parallel Upgrade Utility (<code>catctl.pl</code> using the command-line scripts <code>dbupgrade</code> on Linux and UNIX, and <code>dbupgrade.cmd</code> on Windows) .
                        </p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="oracle-database-upgrade-utilities.html#GUID-7935BC31-8818-4757-A6E7-A180C3E95A62">Scripts for Upgrading Oracle Database</a></li>
                           <li><a href="improvements-data-dictionary-upgrade-and-upgrade-status-displays.html#GUID-34429081-C0F4-4C8F-AB66-6A0D1A02977A">Change to Upgrade Status Setting</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-8AA2F6FB-516F-408C-868C-3979C46A5F7C" title="Component status settings are affected both by the components that you previously installed, and by the support of those components for upgrades.">Component Status and Upgrades</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3D897BE9-AF83-4D96-831E-02AA070C7632" name="GUID-3D897BE9-AF83-4D96-831E-02AA070C7632"></a><h4 id="UPGRD-GUID-3D897BE9-AF83-4D96-831E-02AA070C7632" class="sect4">Component OPTION OFF Status and Upgrades</h4>
                  <div>
                     <p>The upgrade status of <code class="codeph">OPTION OFF</code> components is affected both by the support in the target release for a component, and if a component must be upgraded as part of an upgrade.
                     </p>
                     <p>There are three cases where OPTION OFF components are upgraded, or are not upgraded.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-3D897BE9-AF83-4D96-831E-02AA070C7632__GUID-3DA67F51-B44D-4B04-B1A7-DECC24886A5D">Unsupported Components With Status <code class="codeph">OPTION OFF</code></p>
                        <p>If there is a component in the database that is in the status OPTION OFF, and that component is no longer supported for database upgrades to the target release, then this component is not upgraded. After the upgrade, its version and status remain unchanged..</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3D897BE9-AF83-4D96-831E-02AA070C7632__GUID-BE542D84-6530-471F-8C77-A384FAD1A879">Supported Components With Status <code class="codeph">OPTION OFF</code></p>
                        <p>If there is a component in the database that is in the status <code class="codeph">OPTION OFF</code>, but that component is supported for database upgrades to the target release, then this component is upgraded.  After the upgrade, the component’s version matches the target release version. The status for this component is either <code class="codeph">UPGRADED</code> (a successful upgrade), or <code class="codeph">INVALID</code> (errors).  Rerun the upgrade as needed, until all the upgraded components have a status of <code class="codeph">UPGRADED</code>.  Then run <code class="codeph">utlrp.sql</code>.  If a component was in the status <code class="codeph">OPTION OFF</code> before the upgrade, then after it is upgraded, and its compile and validation is successful, its status reverts back to OPTION OFF.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3D897BE9-AF83-4D96-831E-02AA070C7632__GUID-E460BB5D-CED6-4EA8-85C7-2C4F7D1CE38E">Supported Components With Required Options That Must Be Upgraded</p>
                        <p>Starting with Oracle Database 18.1, all components with required options must be upgraded. These components are:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">RAC</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">SDO</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">APS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">XOQ</code></p>
                           </li>
                        </ul>
                        <p>Components that must be upgraded follow the same procedure for upgrades as for standard supported components with status <code class="codeph">OPTION OFF</code></p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-8AA2F6FB-516F-408C-868C-3979C46A5F7C" title="Component status settings are affected both by the components that you previously installed, and by the support of those components for upgrades.">Component Status and Upgrades</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-5D85ED88-0740-44DE-AA53-318D7240FF0E" name="GUID-5D85ED88-0740-44DE-AA53-318D7240FF0E"></a><h4 id="UPGRD-GUID-5D85ED88-0740-44DE-AA53-318D7240FF0E" class="sect4">Example of an Upgrade Summary Report </h4>
                  <div>
                     <p>Upgrade summary reports provide information about the upgrade status of components.</p>
                     <p>After the upgrade completes, starting with Oracle Database 12<span class="italic">c</span> release 2, the upgrade utility script (for example, in Oracle Database 19c, <code class="codeph">utlusts.sql</code>) writes a copy of the report using the following write order:
                     </p>
                     <ol>
                        <li>
                           <p><code class="codeph">ORACLE_BASE/cfgtoollogs/<span class="variable" translate="no">db_unique_name</span>/upgrade<span class="variable" translate="no">YYMMDDHHMMSC</span>/upg_summary.rpt</code></p>
                        </li>
                        <li>
                           <p><code>$ORACLE_HOME/rdbms/log/upg_summary.rpt</code></p>
                        </li>
                        <li>
                           <p>Linux and UNIX:</p><pre class="pre codeblock"><code>/tmp/upg_summary.rpt</code></pre><p>Windows:</p><pre class="pre codeblock"><code> \TEMP\upg_summary.rpt</code></pre></li>
                     </ol>
                     <p>If the utility script cannot create the report under the first directory scheme, then it attempts to write to the second location, and then the third location. If it cannot write to any of these paths, then it does not write an upgrade summary report. This example is from Oracle Database 18c.</p>
                     <div class="example" id="GUID-5D85ED88-0740-44DE-AA53-318D7240FF0E__CHDBHFDB">
                        <p class="titleinexample">Example 4-39 Upgrade Summary Report for the Post-Upgrade Status Tool</p><pre class="pre codeblock"><code>
Oracle Database Release 18 Post-Upgrade Status Tool    05-27-2018 23:41:0

Component                               Current         Full     Elapsed Time
Name                                    Status          Version  HH:MM:SS

Oracle Server                          UPGRADED      18.3.0.0.0  00:18:21
JServer JAVA Virtual Machine           UPGRADED      18.3.0.0.0  00:04:31
Oracle XDK                             UPGRADED      18.3.0.0.0  00:00:51
Oracle Database Java Packages          UPGRADED      18.3.0.0.0  00:00:22
OLAP Analytic Workspace                UPGRADED      18.3.0.0.0  00:00:51
Oracle Label Security                  UPGRADED      18.3.0.0.0  00:00:20
Oracle Database Vault                  UPGRADED      18.3.0.0.0  00:00:40
Oracle Text                            UPGRADED      18.3.0.0.0  00:01:37
Oracle Workspace Manager               UPGRADED      18.3.0.0.0  00:01:10
Oracle Real Application Clusters       UPGRADED      18.3.0.0.0  00:00:00
Oracle XML Database                    UPGRADED      18.3.0.0.0  00:02:17
Oracle Multimedia                      UPGRADED      18.3.0.0.0  00:03:01
Spatial                                UPGRADED      18.3.0.0.0  00:06:23
Oracle OLAP API                        UPGRADED      18.3.0.0.0  00:00:22
Upgrade Datapatch                                                00:00:10
Final Actions                                                    00:00:20
Post Upgrade                                                     00:00:05
Post Upgrade Datapatch                                           00:00:04

Total Upgrade Time: 00:41:45</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-8AA2F6FB-516F-408C-868C-3979C46A5F7C" title="Component status settings are affected both by the components that you previously installed, and by the support of those components for upgrades.">Component Status and Upgrades</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-16E662C1-2877-4C97-A9D5-531735FAA2AC" name="GUID-16E662C1-2877-4C97-A9D5-531735FAA2AC"></a><h3 id="UPGRD-GUID-16E662C1-2877-4C97-A9D5-531735FAA2AC" class="sect3">Standard Edition Starter Database and Components with Status OPTION OFF</h3>
               <div>
                  <p>Starting in Oracle Database 18c (18.1), all <code class="codeph">OPTION OFF</code> components are upgraded to the new release, but these options are disabled for Oracle Database Standard Edition (SE) remain OPTION OFF.
                  </p>
                  <p>When you upgrade Oracle Database Standard Edition (SE) starter databases, the components that are not included with starter databases are turned on and upgraded. When <code class="codeph">utlrp.sql</code> is run, options that are not turned on with your server and not included with SE are reset to <code class="codeph">OPTION OFF</code> in the <code class="codeph">DBA_REGISTRY</code> view.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD60136"></a><div class="props_rev_3"><a id="GUID-50E0EE5B-9549-4A35-8F27-5134AC42D484" name="GUID-50E0EE5B-9549-4A35-8F27-5134AC42D484"></a><h3 id="UPGRD-GUID-50E0EE5B-9549-4A35-8F27-5134AC42D484" class="sect3">Adjusting Oracle ASM Password File Location After Upgrade</h3>
               <div>
                  <p>You must create a new password file for Oracle ASM after an Oracle Grid Infrastructure upgrade. </p>
                  <div class="section">
                     <p>The Oracle ASM password file location is not shown in the command output when you run <code class="codeph">srvctl config asm</code> after a Grid Infrastructure upgrade. The location of the password file is not automatically passed to the new Oracle ASM disk group. To enable SRVCTL to have the password file location after upgrade, you must advance the diskgroup compatibility setting and create a PWFILE in the disk group. Then SRVCTL reports the configured location of the shared PWFILE.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-50E0EE5B-9549-4A35-8F27-5134AC42D484__GUID-3916DB42-FB24-4643-8CE8-D1726A11D7C0">
                     <p class="notep1">See Also:</p>
                     <p><a href="../ostmg/authenticate-access-asm-instance.html#OSTMG95331" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a> for information about managing shared password files in disk groups
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-371A976A-C6B5-408A-85C3-13B8D4D80BF0" name="GUID-371A976A-C6B5-408A-85C3-13B8D4D80BF0"></a><h3 id="UPGRD-GUID-371A976A-C6B5-408A-85C3-13B8D4D80BF0" class="sect3">Fixing "Warning XDB Now Invalid" Errors with Pluggable Database Upgrades</h3>
               <div>
                  <p>Review this topic if you encounter "Warning: XDB now invalid, invalid objects found” errors when upgrading pluggable databases (PDBs). </p>
                  <div class="section">
                     <p>You can encounter XML object errors when you plug an Oracle Database 12<span class="italic">c</span> release 1 (12.1) pluggable database (PDB) into an Oracle Database 12<span class="italic">c</span> release 2 (12.2) or later release multitenant container database (CDB). 
                     </p>
                     <p> Common objects (objects with <span class="parmname" translate="no">sharing='METADATA LINK'</span> in <code class="codeph">dba_objects</code>) are created by registering system-generated names in an object-relational XML schema. Those common types are created by registering some ORDSYS schemas with object-relational storage. 
                     </p>
                     <p>The names of these common objects are system-generated, and the names generated in release 12.1 can be different from the names used for these objects in release 12.2 and later releases. Because of these possible name changes, you can find that the release 12.1 object types do not have matching common types in the release 12.2 or later release CDB root.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">
                     <p>Resolve this issue using the following procedure: </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Query the view <code class="codeph">PDB_PLUG_IN_VIOLATIONS</code> in the target CDB root to see if there is any action containing <code class="codeph">'GetTypeDDL'</code> </span><div>If you find <code class="codeph">'GetTypeDDL'</code> actions, then the upgraded PDB has the common objects issue. 
                        </div>
                     </li>
                     <li class="stepexpand"><span>Run the PL/SQL packages <code class="codeph">SET SERVEROUTPUT ON</code> and <code class="codeph">exec xdb.DBMS_XMLSTORAGE_MANAGE.GetTypeDDL</code> in the target PDB to generate a user-named SQL script (for example, <code class="codeph">script1.sql</code>). </span></li>
                     <li class="stepexpand"><span>Run the script you created in step 2 (for example, <code class="codeph">script1.sql</code> in the source 12.1 CDB to obtain the type creation script for each of the common types for which you are encountering errors</span></li>
                     <li class="stepexpand"><span>Generate another user-named SQL script (for example, <code class="codeph">script2.sql</code>) that contains these creation scripts.</span></li>
                     <li class="stepexpand"><span>Run the script that you created on the source 12.1 CDB (for example, <code class="codeph">script2.sql</code>) in the target PDB. </span><div></div>
                     </li>
                  </ol>
                  <div class="section">The script that you generate from the release 12.1 source CDB type creation scripts generates all of these objects in the target PDB. Making these common objects available in the target PDB should eliminate the invalid XDB errors.</div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD60137"></a><div class="props_rev_3"><a id="GUID-0BBD601F-03AD-495F-BE3B-EBF6F5180A12" name="GUID-0BBD601F-03AD-495F-BE3B-EBF6F5180A12"></a><h3 id="UPGRD-GUID-0BBD601F-03AD-495F-BE3B-EBF6F5180A12" class="sect3">Fixing ORA-27248: sys.dra_reevaluate_open_failures is running</h3>
               <div>
                  <p>Use this procedure to identify <code>DRA_REEVALUATE_OPEN_FAILURES</code> jobs that block upgrades.
                  </p>
                  <p>During an upgrade, if DBUA fails with the error <samp class="sysout">ORA-27248: sys.dra_reevaluate_open_failures is running</samp>, then the job <code class="codeph">DRA_REEVALUATE_OPEN_FAILURES</code> is running, which causes upgrade failures. Ensure that the job is stopped before continuing the upgrade. 
                  </p>
                  <p>In a job definition, if <code class="codeph">ALLOW_RUNS_IN_RESTRICTED_MODE</code> is set to TRUE, and the job owner is permitted to log in during restricted mode, then that job is permitted to run when the database is in restricted or upgrade mode. The default setting for this parameter is FALSE. 
                  </p>
                  <p>Use the following query to see the state of any running jobs:</p><pre class="oac_no_warn" dir="ltr">SQL&gt; select OBJECT_NAME, Owner, OBJECT_TYPE from dba_objects whereobject_name like '%DRA_REEVA%';
</pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-82B1B90A-9268-4FCA-91B5-9486A01B0C11" name="GUID-82B1B90A-9268-4FCA-91B5-9486A01B0C11"></a><h3 id="UPGRD-GUID-82B1B90A-9268-4FCA-91B5-9486A01B0C11" class="sect3">Fixing ORA-22288: File or LOB Operation FILEOPEN Failed Soft Link in Path</h3>
               <div>
                  <p>ORA-22288 occurs when symbolic links are in directory object paths or filenames when opening BFILES.</p>
                  <div class="section">
                     <p>When you create a directory object or BFILE objects, you must meet the following conditions.</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The operating system file must not be a symbolic or hard link.</p>
                        </li>
                        <li>
                           <p>The operating system directory path named in the Oracle DIRECTORY object must be an existing operating system directory path.</p>
                        </li>
                        <li>
                           <p>The operating system directory path named in the Oracle DIRECTORY object should not contain any symbolic links in its components.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-82B1B90A-9268-4FCA-91B5-9486A01B0C11__GUID-6971E64E-4A72-4AE5-A373-0D64CED71E4B">
                     <p>When a BFILE is opened, the entire directory path and filename is checked. If any symbolic link is found, then you receive the following error.</p><pre class="pre codeblock"><code> ORA-22288: file or LOB operation FILEOPEN failed soft link in path</code></pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <p>To resolve this error, remove symbolic links, and comply with other requirements for creating BFILEs. </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../adlob/introduction-to-large-objects.html#ADLOB-GUID-E4FEEE1B-26EB-45E3-931A-54501A900F87" target="_blank"><span><cite>Oracle Database SecureFiles and Large Objects Developer's Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-39D29002-04E8-4C15-99CB-3BA74DE7C9E3" name="GUID-39D29002-04E8-4C15-99CB-3BA74DE7C9E3"></a><h3 id="UPGRD-GUID-39D29002-04E8-4C15-99CB-3BA74DE7C9E3" class="sect3">Fixing Oracle Database Enterprise User Security, OLS-OID, and Provisioning Profile Error</h3>
               <div>
                  <p>Review to understand <samp class="sysout">ORA-16000: database open for read-only access</samp> errors.
                  </p>
                  <div class="section">
                     <p>After upgrading databases that use OLS and a standby database, you may see ORA-16000 (database open for read-only access). After switchover, update the Provisioning profile with the connect information of the new primary. If you do not update the Provisioning profile, then the policies continue to be propagated to the new standby (old primary) and the database continues to fail with ORA-16000 errors.</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-39D29002-04E8-4C15-99CB-3BA74DE7C9E3__GUID-67654FFF-AFE8-47BC-802E-CF240EFF5C93">
                     <p class="notep1">See Also:</p>
                     <p><a href="../dbimi/upgrading-from-oracle9i-to-oracle-database-12c-release-12-2.html#DBIMI10245" target="_blank"><span class="italic">Oracle Database Enterprise User Security Administrator's Guide</span></a>for information about the additional steps required for upgrading Oracle Database from release 10<span class="italic">g</span> (10.1) and higher to Oracle Database 12<span class="italic">c</span></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-C9EA4C17-E283-4D21-9C9B-0EE97FE2A486" name="GUID-C9EA4C17-E283-4D21-9C9B-0EE97FE2A486"></a><h3 id="UPGRD-GUID-C9EA4C17-E283-4D21-9C9B-0EE97FE2A486" class="sect3">Fixing 32K Migration Error with utl32k.sql and MAX_STRING_SIZE</h3>
               <div>
                  <p>Use this procedure to fix <samp class="sysout">ORA-01722: invalid number</samp> upgrade errors.
                  </p>
                  <p>If the initialization parameter <span class="parmname" translate="no">MAX_STRING_SIZE</span> is set to <code>EXTENDED</code>, but the 32K migration that the <code>utl32k.sql</code> script carries out is not completed, then the database upgrade fails with the following error:
                  </p><pre class="oac_no_warn" dir="ltr">SELECT TO_NUMBER('32K_MIGRATION_NOT_COMPLETED')
                    *
      ERROR at line 1:
      ORA-01722: invalid number
</pre><p>The database upgrade does not automatically run the <code>utl32k.sql</code> script, and does not perform the 32K migration. 
                  </p>
                  <p>Complete the upgrade and the 32K migration by using this manual procedure:</p>
                  <ol>
                     <li>
                        <p>Reset the initialization parameter <span class="parmname" translate="no">MAX_STRING_SIZE</span> to <span class="parmname" translate="no">STANDARD</span>. 
                        </p>
                     </li>
                     <li>
                        <p>Restart the database in <code>UPGRADE</code> mode.
                        </p>
                     </li>
                     <li>
                        <p>Rerun the upgrade using the manual procedure.</p>
                     </li>
                     <li>
                        <p>After the database is upgraded, set the initialization parameter <span class="parmname" translate="no">MAX_STRING_SIZE</span> to <code>EXTENDED</code>.
                        </p>
                     </li>
                     <li>
                        <p>Restart the database in <code>UPGRADE</code> mode.
                        </p>
                     </li>
                     <li>
                        <p>Run the SQL script <code class="codeph">../rdbms/admin/utl32k.sql</code>.
                        </p>
                     </li>
                  </ol>
                  <p>After you run the <code>utl32k.sql</code> script, the upgraded database completes the 32K migration and supports the <span class="parmname" translate="no">EXTENDED</span> parameter.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-906173BF-B48E-4E2A-86EF-7B174E564AC0" name="GUID-906173BF-B48E-4E2A-86EF-7B174E564AC0"></a><h3 id="UPGRD-GUID-906173BF-B48E-4E2A-86EF-7B174E564AC0" class="sect3">Recovering from a CRS Shutdown and Oracle ASM Losing Rolling Migration</h3>
               <div>
                  <p>A Cluster Ready Services (CRS) shutdown on all cluster member nodes can place the cluster in a heterogeneous state. Use this procedure to recover from that problem.</p>
                  <p>Oracle Automatic Storage Management (Oracle ASM) loses the rolling migration state if CRS shuts down on all nodes. This CRS shutdown can create a heterogeneous state, so that you cannot restart all cluster member nodes. You cannot start two nodes of different versions in the cluster. If you attempt to start nodes running different versions of Oracle ASM, then one of the sets of heterogeneous nodes running Oracle ASM nodes fails, generating either ORA-15153 or ORA-15163 error messages.</p>
                  <p> Consider the following scenario of four nodes (node1, node2, node3, and node4) that are at Oracle Database release 11.2.0.2 and being upgraded to release 12.1.0.2.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Node1 and node2 are upgraded to 12.1.0.2 and running.</p>
                     </li>
                     <li>
                        <p>Node3 and node 4 are still at 11.2.0.2 and running.</p>
                     </li>
                     <li>
                        <p>Now consider that there is an outage where all CRS stacks are down, which leaves the cluster in a heterogeneous state (that is, two nodes at 11.2.0.2 and two nodes at 12.1.0.2).</p>
                     </li>
                  </ul>
                  <p>Using this scenario as an example, complete the following procedure:</p>
                  <ol>
                     <li>
                        <p>Restart only the nodes that are in the earlier release. In this scenario, start the nodes in release 11.2.0.2 ( node3 or node4, or both).</p>
                     </li>
                     <li>
                        <p>run the following SQL command on the Oracle ASM instance on node3 or node4 before starting any 12.1.0.2 node: </p><pre class="oac_no_warn" dir="ltr"><code class="codeph">ALTER SYSTEM START ROLLING MIGRATION TO '12.1.0.2'</code></pre></li>
                     <li>
                        <p>Continue the documented upgrade procedure from the point of failure. </p>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-6D5F3EEE-D8CC-45F8-81A7-1C3BC96952FA" name="GUID-6D5F3EEE-D8CC-45F8-81A7-1C3BC96952FA"></a><h3 id="UPGRD-GUID-6D5F3EEE-D8CC-45F8-81A7-1C3BC96952FA" class="sect3">Data Type Versioning Can Cause Cross-Version Replication (ORA-26656)</h3>
               <div>
                  <p>Review the user-defined object types affected by versioning.</p>
                  <p>Release 12.1.0.2 introduces versioning of data types that can be attributes of Oracle object types (reference Bug 18897657). Because of this feature, cross-version replication between release 12.1.0.1 and release 12.1.0.2 databases can be affected, which results in ORA-26656 errors. </p>
                  <p>If any user-defined object types contain attributes of <code class="codeph">DATE</code>, <code class="codeph">TIMESTAMP</code>, <code class="codeph">TIMESTAMP WITH TIME ZONE</code>, <code class="codeph">TIMESTAMP WITH LOCAL TIME ZONE</code>, <code class="codeph">BINARY_FLOAT</code>, <code class="codeph">BINARY_DOUBLE</code>, <code class="codeph">NCHAR</code>, <code class="codeph">NVARCHAR2</code>, <code class="codeph">NCLOB</code>, <code class="codeph">ANYDATA</code>, and similar objects, then you must apply the mandatory Patch Set Update 18038108 to all release 12.1.0.1 instances.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-A6410CD4-4DCE-41D3-BBA1-0CF1CC8204E5" name="GUID-A6410CD4-4DCE-41D3-BBA1-0CF1CC8204E5"></a><h3 id="UPGRD-GUID-A6410CD4-4DCE-41D3-BBA1-0CF1CC8204E5" class="sect3">Referenced Symbol Count is Undefined Error libclntsh.so.11.1</h3>
               <div>
                  <p>Review this topic if you encounter errors that reference <code class="codeph">libclntsh.so.11.1</code> with "referenced symbol count is undefined", "cannot open shared object file", or similar errors.
                  </p>
                  <p>During an upgrade to Oracle Database 12<span class="italic">c</span> or 18c, client applications linked against the <code class="codeph">libclntsh.so.11.1</code> file may fail to run on Oracle Solaris, HP-UX Itanium or IBM AIX platforms. In that event, you see error messages similar to the following:
                  </p><pre class="pre codeblock"><code>referenced symbol count is undefined</code></pre><div class="section">
                     <p class="subhead2" id="GUID-A6410CD4-4DCE-41D3-BBA1-0CF1CC8204E5__GUID-E9D05AEA-BEDF-4BE1-98A7-3735A1DBECDC">Workaround</p>
                     <p>Relink affected client applications against the new <code class="codeph">libclntsh.so.12.2</code> for Oracle Database 12<span class="italic">c</span>, or <code class="codeph">libclntssh.so.18.1</code> file for Oracle Database 18c.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-264F7099-5C9F-42D1-B3D7-D9754CA7F3C2" name="GUID-264F7099-5C9F-42D1-B3D7-D9754CA7F3C2"></a><h3 id="UPGRD-GUID-264F7099-5C9F-42D1-B3D7-D9754CA7F3C2" class="sect3">Resolving Timestamp Errors Due to ISO 8601 Timestamps</h3>
               <div>
                  <p>Review this topic if you encounter timestamp errors with applications after upgrading to Oracle Database 12<span class="italic">c</span>, 18c, or later releases.
                  </p>
                  <p>ISO 8601 is an international standard for exchanging date and time-related data, established by the International Organization for Standardization (ISO), and the International Electrotechnical Commission (IEC). The purpose of this standard is to provide a common international standard for representing dates and times, to avoid misinterpretation of dates and times with data used between countries using different conventions for writing numeric dates and times. For example:</p><pre class="pre codeblock"><code>2015-09-23T19:25:25.123456+00:00</code></pre><p>Oracle recommends that you use this standard. </p>
                  <p>By default, the initialization parameter UNIFORM_LOG_TIMESTAMP_FORMAT is set to TRUE. If using the ISO 8601 standard causes scripts to break, then you can set UNIFORM_LOG_TIMESTAMP_FORMAT to FALSE to cause the Oracle Database 12.2 release or later releases to revert to the timestamp format used in Oracle Database 12.1. After you change the initialization parameter, fix your scripts so that they can use ISO 8601 timestamps. When your scripts can use the ISO 8601 standard, change the parameter back to the default value of TRUE. </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-2F4DAD7F-92E4-415C-A91B-7EE480633E3E" name="GUID-2F4DAD7F-92E4-415C-A91B-7EE480633E3E"></a><h3 id="UPGRD-GUID-2F4DAD7F-92E4-415C-A91B-7EE480633E3E" class="sect3">Fixing Failed Upgrades Where Only Datapatch Fails</h3>
               <div>
                  <p>If only datapatch fails during an upgrade, then rerun datapatch directly. </p>
                  <div class="section">
                     <p> The Datapatch script, <code class="codeph">datapatch.pl</code> , is a PERL script. In some patching operations, the final post-upgrade patches may not run, due to errors such as ORA-20001. If only the Datapatch script fails, then you do not need to run the upgrade again to fix this issue. Instead, run <code class="codeph">datapatch.pl</code> directly. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">
                     <p>To fix a failed datapatch, log in as the Oracle user, and complete this procedure:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span> Change directory to Opatch inside the upgraded Oracle home. </span><div><pre class="pre codeblock"><code>$ cd $ORACLE_HOME/OPatch</code></pre></div>
                        <div></div>
                     </li>
                     <li class="stepexpand"><span>Run the datapatch command.</span><div><pre class="pre codeblock"><code>$ ./datapatch -verbose</code></pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-C18782A1-4A4F-4C06-B0D6-F58ECE28E13C" name="GUID-C18782A1-4A4F-4C06-B0D6-F58ECE28E13C"></a><h3 id="UPGRD-GUID-C18782A1-4A4F-4C06-B0D6-F58ECE28E13C" class="sect3">Error "Timezone Datafiles May Not Be Downgraded To a Lower Version"</h3>
               <div>
                  <p>You encounter a time zone error that prohibits the upgrade if the daylight savings time (DST) version in the database you are upgrading is newer than the DST in the database release to which you are upgrading. </p>
                  <div class="section">
                     <p>Scenario: You run Database Upgrade Assistant (DBUA) to upgrade from an earlier release Oracle Database to a later release Oracle Database, and encounter the following error:</p><pre class="pre codeblock"><code>SEVERE: Timezone datafiles may not be downgraded to a lower version as a
result of an Oracle Database upgrade.</code></pre><p>This error occurs if you upgrade from an earlier Oracle Database release to a later Oracle Database release, and your earlier release Oracle Database Oracle home has a more recent DST patch than the new upgrade Oracle Database Oracle home. In the log file, <code class="codeph">preupgrade.log</code>, you are instructed to patch the new Oracle Database Oracle home with the updated DST patch from the old Oracle home. For example:
                     </p> 
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-C18782A1-4A4F-4C06-B0D6-F58ECE28E13C__GUID-E9528D8A-8220-4878-9001-4BFCF6B5DE38"><pre class="pre codeblock"><code>+ Patch the new 12.2.0.1.0 $ORACLE_HOME/oracore/zoneinfo/ with the version 
29 time zone data file from the 12.1.0.2.0 
$ORACLE_HOME/oracore/zoneinfo/.&nbsp;&nbsp; 

The database is using a time zone file version that is newer than the
version shipped with the 12.2.0.1.0 release. 

Timezone datafiles may not be downgraded to a lower version as a result
of an Oracle Database upgrade.</code></pre><p>However, this error can persist, even if you patch the new Oracle home to the same version as the earlier release Oracle Database Oracle home.</p>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-C18782A1-4A4F-4C06-B0D6-F58ECE28E13C__GUID-AC87F00F-3924-42A4-9D57-D05EC1ECD881">
                     <p>Workaround:</p>
                     <p>If you continue to encounter this error after patching the new Oracle home with the current time zone file, then run Oracle Database Upgrade Assistant with the flag <code class="codeph">-ignorePreReqs true</code> flag. Running the assistant with tis 
                     </p><pre class="pre codeblock"><code>$ dbua -sid mydb -oracleHome /u02/product/12.2.0/dbhome_1/ -ignorePreReqs - true</code></pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <div class="infoboxnote" id="GUID-C18782A1-4A4F-4C06-B0D6-F58ECE28E13C__GUID-7F99134A-6BF0-4782-9562-CF784AC3A072">
                        <p class="notep1">Caution:</p>
                        <p>Only use this workaround of turning off prerequisite checks for this specific scenario. Ignoring valid failed checks that report timezone version errors between Oracle homes results in upgrade failures.</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-25BB78B8-B59D-4039-B838-9BCA13A5377C" name="GUID-25BB78B8-B59D-4039-B838-9BCA13A5377C"></a><h3 id="UPGRD-GUID-25BB78B8-B59D-4039-B838-9BCA13A5377C" class="sect3">Fixing Failures to Complete Registration of Listeners with DBUA</h3>
               <div>
                  <p>On the Database Upgrade Assistant Progress step, a window appears with this warning: "Unable to create database entry in the directory service. No Listeners configured."</p>
                  <div class="section">
                     <p>In this scenario, you have completed the following steps:</p>
                     <ol>
                        <li>
                           <p>Created a listener in your earlier release Oracle home using Net Configuration Assistant (NetCA) or Net Manager. </p>
                        </li>
                        <li>
                           <p>Installed the new Oracle Database release in the new Oracle home, and registered it against the listener.</p>
                        </li>
                        <li>
                           <p>You want to register the listener to Oracle Internet Directory (OID), and upgrade the database, or you want to register the listener on OID on the new Oracle home.</p>
                        </li>
                     </ol>
                     <div class="infoboxnote" id="GUID-25BB78B8-B59D-4039-B838-9BCA13A5377C__GUID-1E647DF5-15C0-434B-B0ED-0E053584DC84">
                        <p class="notep1">Note:</p>
                        <p>If the listener is running from another Oracle home on the server, or the listener is running from the current Oracle home, but it is not configured in the <code class="codeph">LISTENER.ORA</code> file (that is, it uses an automatically generated default configuration), then DBCA is unable to locate the listener. 
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>DBUA is no longer performing direct registration of the upgraded database to OID during the upgrade itself. </p>
                     <p>To resolve this issue, complete the following tasks:</p>
                     <ol>
                        <li>
                           <p>De-register the listener from OID.</p>
                        </li>
                        <li>
                           <p>Perform the database upgrade.</p>
                        </li>
                        <li>
                           <p>Register again the migrated listener to the OID registry on the new release Oracle Database Oracle home.</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="troubleshooting-oracle-database-upgrade.html#GUID-474BFAA2-0CD6-4672-8A7A-BF640F4FBFB2" title="Use these troubleshooting tips to address errors or issues that you may encounter while upgrading your database.">Troubleshooting the Upgrade for Oracle Database</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>