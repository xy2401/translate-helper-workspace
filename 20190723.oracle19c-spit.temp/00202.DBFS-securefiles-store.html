<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="There are certain procedures for setting up and using a DBFS SecureFiles Store.">
      <meta name="description" content="There are certain procedures for setting up and using a DBFS SecureFiles Store.">
      <title>DBFS SecureFiles Store</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database SecureFiles and Large Objects Developer's Guide">
      <meta property="og:description" content="There are certain procedures for setting up and using a DBFS SecureFiles Store.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database SecureFiles and Large Objects Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="securefiles-and-large-objects-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T02:58:18-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96333-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="introducing-database-file-system.html" title="Previous" type="text/html">
      <link rel="next" href="DBFS-hierarchical-store.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SecureFiles and Large Objects Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADLOB">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="introducing-database-file-system.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="DBFS-hierarchical-store.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database SecureFiles and Large Objects Developer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="database-file-system.html" property="item" typeof="WebPage"><span property="name">   Database File System (DBFS)</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> DBFS SecureFiles Store </li>
            </ol>
            <a id="GUID-F71C0B85-F08D-4CD0-9EB3-AB84C9B355AE" name="GUID-F71C0B85-F08D-4CD0-9EB3-AB84C9B355AE"></a><a id="ADLOB4594"></a>
            
            <h2 id="ADLOB-GUID-F71C0B85-F08D-4CD0-9EB3-AB84C9B355AE" class="sect2"><span class="enumeration_chapter">21 </span> DBFS SecureFiles Store 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>There are certain procedures for setting up and using a DBFS SecureFiles Store.</p>
               <p>Topics: </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="DBFS-securefiles-store.html#GUID-8DC871AC-95D6-496B-A277-AA47DA94BF64" title="There are several aspects to setting up a SecureFiles Store.">Setting Up a SecureFiles Store</a></p>
                  </li>
                  <li>
                     <p><a href="DBFS-securefiles-store.html#GUID-D25B94D8-8B78-443D-9167-45B0F9EFC378" title="The DBFS Content API provides methods to populate a SecureFiles Store file system and otherwise manage it.">Using a DBFS SecureFiles Store File System</a></p>
                  </li>
                  <li>
                     <p><a href="DBFS-securefiles-store.html#GUID-CE03355D-56C2-4497-9BD7-AD170EFD9615" title="The DBFS SecureFiles Store package (DBMS_DBFS_SFS) is a store provider for DBMS_DBFS_CONTENT that supports SecureFiles LOB storage for DBFS content.">About DBFS SecureFiles Store Package_ DBMS_DBFS_SFS</a></p>
                  </li>
               </ul>
            </div><a id="ADLOB46057"></a><div class="props_rev_3"><a id="GUID-8DC871AC-95D6-496B-A277-AA47DA94BF64" name="GUID-8DC871AC-95D6-496B-A277-AA47DA94BF64"></a><h3 id="ADLOB-GUID-8DC871AC-95D6-496B-A277-AA47DA94BF64" class="sect3">Setting Up a SecureFiles Store</h3>
               <div>
                  <p>There are several aspects to setting up a SecureFiles Store.</p>
                  <p>This section shows how to set up a SecureFiles Store.</p>
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-C971D674-D133-40E2-9B03-503002DDB20C" title="You must use a regular database user for all operational access to the Content API and stores.">About Managing Permissions</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-F6A9C96C-C527-4A42-A3DA-CD95DDEFE8C8" title="You must grant the DBFS_ROLE role to any user that needs to use the DBFS content API.">Creating or Setting Permissions</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-31709BF1-B980-4252-9428-7E6FE86612A5" title="You must create the SecureFiles file system stores that the DBFS Content API accesses.">Creating a SecureFiles File System Store</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-21EEB659-373D-4101-B276-071928FBBFD5" title="You should never directly access tables that hold data for a SecureFiles Store file systems, even through the DBMS_DBFS_SFS package methods.">Accessing Tables that Hold SecureFiles System Store Data</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-30782F65-0AC4-46FE-94D3-8E2A195D2327" title="You can truncate and re-initialize tables associated with an SecureFiles Store.">Initializing SecureFiles Store File Systems</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-63980D61-CA18-4D58-8B87-E6AD1ECA969A" title="SecureFiles LOBs are only available in Oracle Database 11g Release 1 and higher. They are not available in earlier releases.">Comparison of SecureFiles LOBs to BasicFiles LOBs</a></p>
                     </li>
                  </ul>
               </div><a id="ADLOB46062"></a><div class="props_rev_3"><a id="GUID-C971D674-D133-40E2-9B03-503002DDB20C" name="GUID-C971D674-D133-40E2-9B03-503002DDB20C"></a><h4 id="ADLOB-GUID-C971D674-D133-40E2-9B03-503002DDB20C" class="sect4">About Managing Permissions</h4>
                  <div>
                     <p>You must use a regular database user for all operational access to the Content API and stores. </p>
                     <p>Do not use <code class="codeph">SYS</code> or <code class="codeph">SYSTEM</code> users or <code class="codeph">SYSDBA</code> or <code class="codeph">SYSOPER</code> system privileges. For better security and separation of duty, only allow specific trusted users the ability to manage DBFS Content API operations.
                     </p>
                     <p>You must grant each user the <code class="codeph">DBFS_ROLE</code> role. Otherwise, the user is not authorized to use the DBFS Content API. A user with suitable administrative privileges (or <code class="codeph">SYSDBA</code>) can grant the role to additional users as needed. 
                     </p>
                     <p>Because of the way roles, access control, and definer and invoker rights interact in the database, it may be necessary to explicitly grant various permissions (typically execute permissions) on DBFS Content API types (SQL types with the <code class="codeph">DBMS_DBFS_CONTENT_</code> <span class="italic"><code class="codeph">xxx</code></span> prefix) and packages (typically only <code class="codeph">DBMS_DBFS_CONTENT</code> and <code class="codeph">DBMS_DBFS_SFS</code>) to users who might otherwise have the <code class="codeph">DBFS_ROLE</code> role.
                     </p>
                     <p>These explicit, direct grants are normal and to be expected, and can be provided as needed and on demand. </p>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-F6A9C96C-C527-4A42-A3DA-CD95DDEFE8C8" name="GUID-F6A9C96C-C527-4A42-A3DA-CD95DDEFE8C8"></a><h4 id="ADLOB-GUID-F6A9C96C-C527-4A42-A3DA-CD95DDEFE8C8" class="sect4">Creating or Setting Permissions</h4>
                  <div>
                     <p>You must grant the <code class="codeph">DBFS_ROLE</code> role to any user that needs to use the DBFS content API.
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Create or determine DBFS Content API target users. </span><div>
                              <p>This example uses this user and password: <code class="codeph">sfs_demo/</code><span class="italic"><code class="codeph">password</code></span></p>
                              <p>At minimum, this database user must have the <code class="codeph">CREATE SESSION</code>, <code class="codeph">CREATE RESOURCE</code>, and <code class="codeph">CREATE VIEW</code> privileges.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Grant the <code class="codeph">DBFS_ROLE</code> role to the user. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT / as sysdba
GRANT dbfs_role TO sfs_demo;
</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>This sets up the DBFS Content API for any database user who has the <code class="codeph">DBFS_ROLE</code> role.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB46157"></a><a id="ADLOB46063"></a><div class="props_rev_3"><a id="GUID-31709BF1-B980-4252-9428-7E6FE86612A5" name="GUID-31709BF1-B980-4252-9428-7E6FE86612A5"></a><h4 id="ADLOB-GUID-31709BF1-B980-4252-9428-7E6FE86612A5" class="sect4">Creating a SecureFiles File System Store</h4>
                  <div>
                     <p>You must create the SecureFiles file system stores that the DBFS Content API accesses.</p>
                     <div class="section">
                        <p>The <code class="codeph">CREATEFILESYSTEM</code> procedure auto-commits before and after its execution (like a DDL). The method <code class="codeph">CREATESTORE</code> is a wrapper around <code class="codeph">CREATEFILESYSTEM</code>.
                        </p>
                        <div class="infoboxnotealso" id="GUID-31709BF1-B980-4252-9428-7E6FE86612A5__SEEORACLEDATABASEPLSQLPACKAGESANDTY-DFE6E1FE">
                           <p class="notep1">See Also:</p>
                           <p><a href="../arpls/index.html" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for <code class="codeph">DBMS_DBFS_SFS</code> syntax details
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-31709BF1-B980-4252-9428-7E6FE86612A5__GUID-74E2E548-18B1-4776-A02E-E977A7EF7B8C">To create a SecureFiles File System Store:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Create the necessary stores to be accessed using the DBFS Content API:</span><div><pre class="oac_no_warn" dir="ltr">DECLARE
  BEGIN
    DBMS_DBFS_SFS.CREATEFILESYSTEM(
      store_name =&gt; 'FS1',
      tbl_name =&gt; 'T1',
      tbl_tbs =&gt; null,
      use_bf =&gt; false 
    );
    COMMIT;
  END;
/
</pre><p>where:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">store_name</code> is any arbitrary, user-unique name.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">tbl_name</code> is a valid table name, created in the current schema.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">tbl_tbs</code> is a valid tablespace name used for the store table and its dependent segments, such as indexes, LOBs, or nested tables. The default is <code class="codeph">NULL</code> and specifies a tablespace of the current schema.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">use_bf</code> specifies that BasicFiles LOBs should be used, if <code class="codeph">true</code>, or not used, if <code class="codeph">false</code>.
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Register this store with the DBFS Content API as a new store managed by the SecureFiles Store provider. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo
Enter password:<span class="italic">password</span>
DECLARE
&nbsp;&nbsp;BEGIN
&nbsp;&nbsp;&nbsp;&nbsp;DBMS_DBFS_CONTENT.REGISTERSTORE(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store_name    =&gt; 'FS1',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provider_name =&gt; 'anything',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provider_package =&gt; '<span class="bold">dbms_dbfs_sfs</span>'
&nbsp;&nbsp;&nbsp;&nbsp;);
&nbsp;&nbsp;&nbsp;&nbsp;COMMIT;
&nbsp;&nbsp;END;
/
</pre><p>where:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">store_name</code> is SecureFiles Store <code class="codeph">FS1</code>, which uses table <code class="codeph">SFS_DEMO.T1</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">provider_name</code> is ignored.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">provider_package</code> is <code class="codeph">DBMS_DBFS_SFS</code>, for SecureFiles Store reference provider.
                                    </p>
                                 </li>
                              </ul>
                              <p>This operation associates the SecureFiles Store <code class="codeph">FS1</code> with the <code class="codeph">DBMS_DBFS_SFS</code> provider.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Mount the store at suitable a mount-point.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo
Enter password: <span class="italic">password</span>
DECLARE
&nbsp;&nbsp;BEGIN
&nbsp;&nbsp;&nbsp;&nbsp;DBMS_DBFS_CONTENT.MOUNTSTORE(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store_name    =&gt; 'FS1',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store_mount   =&gt; 'mnt1'
&nbsp;&nbsp;&nbsp;&nbsp;);
&nbsp;&nbsp;&nbsp;&nbsp;COMMIT;
&nbsp;&nbsp;END;
/
</pre><p>where:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">store_name</code> is SecureFiles Store <code class="codeph">FS1</code>, which uses table <code class="codeph">SFS_DEMO.T1</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">store_mount</code> is the <a href="glossary.html#GUID-D2894DED-27C9-4846-A980-D51E22388EC7"><span class="xrefglossterm">mount point</span></a>.
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>[Optional] To see the results of the preceding steps, you can use the following statements.</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>To verify SecureFiles Store tables and file systems:</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM TABLE(DBMS_DBFS_SFS.LISTTABLES);
SELECT * FROM TABLE(DBMS_DBFS_SFS.LISTFILESYSTEMS);
</pre></li>
                                 <li>
                                    <p>To verify ContentAPI Stores and mounts:</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM TABLE(DBMS_DBFS_CONTENT.LISTSTORES);
SELECT * FROM TABLE(DBMS_DBFS_CONTENT.LISTMOUNTS);
 </pre></li>
                                 <li>
                                    <p>To verify SecureFiles Store features:</p><pre class="oac_no_warn" dir="ltr">var fs1f number;
exec :fs1f := dbms_dbfs_content.getFeaturesByName('FS1');
select * from table(dbms_dbfs_content.decodeFeatures(:fs1f)); 
</pre></li>
                                 <li>
                                    <p>To verify resource and property views:</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM DBFS_CONTENT;
SELECT * FROM DBFS_CONTENT_PROPERTIES;
</pre></li>
                              </ul>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-21EEB659-373D-4101-B276-071928FBBFD5" name="GUID-21EEB659-373D-4101-B276-071928FBBFD5"></a><h4 id="ADLOB-GUID-21EEB659-373D-4101-B276-071928FBBFD5" class="sect4">Accessing Tables that Hold SecureFiles System Store Data</h4>
                  <div>
                     <p>You should never directly access tables that hold data for a SecureFiles Store file systems, even through the <code class="codeph">DBMS_DBFS_SFS</code> package methods. 
                     </p>
                     <div class="section">
                        <p>This is the correct way to access the file systems.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>For procedural operations: Use the DBFS Content API (<code class="codeph">DBMS_DBFS_CONTENT</code> methods). 
                              </p>
                           </li>
                           <li>
                              <p>For SQL operations: Use the resource and property views (<code class="codeph">DBFS_CONTENT</code> and <code class="codeph">DBFS_CONTENT_PROPERTIES</code>). 
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB46065"></a><div class="props_rev_3"><a id="GUID-30782F65-0AC4-46FE-94D3-8E2A195D2327" name="GUID-30782F65-0AC4-46FE-94D3-8E2A195D2327"></a><h4 id="ADLOB-GUID-30782F65-0AC4-46FE-94D3-8E2A195D2327" class="sect4">Initializing SecureFiles Store File Systems</h4>
                  <div>
                     <p>You can truncate and re-initialize tables associated with an SecureFiles Store.</p>
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Use the procedure <code class="codeph">INITFS()</code>.
                              </p>
                              <p>The procedure executes like a DDL, auto-committing before and after its execution.</p>
                           </li>
                        </ul>
                        <p>The following example uses file system <code class="codeph">FS1</code> and table <code class="codeph">SFS_DEMO</code>.<code class="codeph">T1</code>, which is associated with the  SecureFiles Store <code class="codeph">store_name</code>.
                        </p><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo;
Enter password: <span class="italic">password</span>
EXEC DBMS_DBFS_SFS.INITFS(<span class="italic">store_name</span> =&gt; 'FS1');</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADLOB46064"></a><div class="props_rev_3"><a id="GUID-63980D61-CA18-4D58-8B87-E6AD1ECA969A" name="GUID-63980D61-CA18-4D58-8B87-E6AD1ECA969A"></a><h4 id="ADLOB-GUID-63980D61-CA18-4D58-8B87-E6AD1ECA969A" class="sect4">Comparison of SecureFiles LOBs to BasicFiles LOBs</h4>
                  <div>
                     <p>SecureFiles LOBs are only available in Oracle Database 11<span class="italic">g</span> Release 1 and higher. They are not available in earlier releases. 
                     </p>
                     <p>You must use BasicFiles LOB storage for LOB storage in tablespaces that are not managed with Automatic Segment Space Management (ASSM).</p>
                     <p>Compatibility must be at least 11.1.0.0 to use SecureFiles LOBs.</p>
                     <p>Additionally, you need to specify the following in <code class="codeph">DBMS_DBFS_SFS.CREATEFILESYSTEM:</code></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>To use SecureFiles LOBs (the default), specify <code class="codeph">use_bf =&gt; false.</code> 
                           </p>
                        </li>
                        <li>
                           <p>To use BasicFiles LOBs, specify <code class="codeph">use_bf =&gt; true</code>.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADLOB46061"></a><div class="props_rev_3"><a id="GUID-D25B94D8-8B78-443D-9167-45B0F9EFC378" name="GUID-D25B94D8-8B78-443D-9167-45B0F9EFC378"></a><h3 id="ADLOB-GUID-D25B94D8-8B78-443D-9167-45B0F9EFC378" class="sect3">Using a DBFS SecureFiles Store File System</h3>
               <div>
                  <p>The DBFS Content API provides methods to populate a SecureFiles Store file system and otherwise manage it.</p>
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-CCD4D723-3998-47DD-9A77-56F629E5C119" title="You can create new file and directory elements to populate a SecureFiles Store file system.">DBFS Content API Working Example </a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-9EA41230-B03F-4B36-BB14-687DABB295B1" title="You can use the unmountStore method to drop SecureFiles Store file systems.">Dropping SecureFiles Store File Systems</a></p>
                     </li>
                  </ul>
               </div><a id="ADLOB46159"></a><a id="ADLOB46067"></a><div class="props_rev_3"><a id="GUID-CCD4D723-3998-47DD-9A77-56F629E5C119" name="GUID-CCD4D723-3998-47DD-9A77-56F629E5C119"></a><h4 id="ADLOB-GUID-CCD4D723-3998-47DD-9A77-56F629E5C119" class="sect4">DBFS Content API Working Example </h4>
                  <div>
                     <p>You can create new file and directory elements to populate a SecureFiles Store file system. </p>
                     <p>If you have executed the steps in <span class="q">"<a href="DBFS-securefiles-store.html#GUID-8DC871AC-95D6-496B-A277-AA47DA94BF64" title="There are several aspects to setting up a SecureFiles Store.">Setting Up a SecureFiles Store</a>"</span>, set the DBFS Content API permissions, created at least one SecureFiles Store reference file system, and mounted it under the mount point <code class="codeph">/mnt1</code>, then you can create a new file and directory elements as demonstrated in <a href="DBFS-securefiles-store.html#GUID-CCD4D723-3998-47DD-9A77-56F629E5C119__BABHCECE">Example 21-1</a>. 
                     </p>
                     <div class="example" id="GUID-CCD4D723-3998-47DD-9A77-56F629E5C119__BABHCECE">
                        <p class="titleinexample">Example 21-1 Working with DBFS Content API</p><pre class="oac_no_warn" dir="ltr">CONNECT tjones
Enter password: <span class="bold">password</span>
 
DECLARE
   ret integer;
   b   blob;
   str varchar2(1000)  := '' || chr(10) ||
 
'#include &lt;stdio.h&gt;' || chr(10) ||
'' || chr(10) ||
'int main(int argc, char** argv)' || chr(10) ||
'{' || chr(10) ||
'    (void) printf("hello world\n");' || chr(10) ||
'    RETURN 0;' || chr(10) ||
'}' || chr(10) ||
'';
 
    BEGIN
        ret := dbms_fuse.fs_mkdir('/mnt1/<span class="bold">FS1</span>');
        ret := dbms_fuse.fs_creat('/mnt1/FS1/hello.c', content =&gt; b);
        dbms_lob.writeappend(b, length(str), utl_raw.cast_to_raw(str));
        COMMIT;
    END;
    /
    SHOW ERRORS;
 
    -- verify newly created directory and file
    SELECT pathname, pathtype, length(filedata),
        utl_raw.cast_to_varchar2(filedata)
        FROM dbfs_content
            WHERE pathname LIKE '/mnt1/<span class="bold">FS1</span>%'
            ORDER BY pathname;
</pre><p>The file system can be populated and accessed from PL/SQL with <code class="codeph">DBMS_DBFS_CONTENT</code>. The file system can be accessed read-only from SQL using the <code class="codeph">dbfs_content</code> and <code class="codeph">dbfs_content_properties</code> views. 
                        </p>
                        <p>The file system can also be populated and accessed using regular file system APIs and UNIX utilities when mounted using FUSE, or by the standalone <code class="codeph">dbfs_client</code> tool (in environments where <code class="codeph">FUSE</code> is either unavailable or not set up). 
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADLOB46066"></a><div class="props_rev_3"><a id="GUID-9EA41230-B03F-4B36-BB14-687DABB295B1" name="GUID-9EA41230-B03F-4B36-BB14-687DABB295B1"></a><h4 id="ADLOB-GUID-9EA41230-B03F-4B36-BB14-687DABB295B1" class="sect4">Dropping SecureFiles Store File Systems</h4>
                  <div>
                     <p>You can use the <code class="codeph">unmountStore</code> method to drop SecureFiles Store file systems.
                     </p>
                     <div class="section">
                        <p>This method removes all stores referring to the file system from the metadata tables, and drops the underlying file system table. The procedure executes like a DDL, auto-committing before and after its execution.</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Unmount the store. </span><div><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo
Enter password: <span class="italic">password</span>
DECLARE
  BEGIN
    <code class="codeph">DBMS_DBFS_CONTENT.UNMOUNTSTORE</code>(
      store_name    =&gt; '<span class="bold">FS1</span>',
      store_mount   =&gt; 'mntl';
    );
    COMMIT;
END;
/
</pre><p>where:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">store_name</code> is SecureFiles Store <code class="codeph">FS1</code>, which uses table <code class="codeph">SFS_DEMO.T1</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">store_mount</code> is the mount point.
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Unregister the stores.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo
Enter password: <span class="italic">password</span>
EXEC DBMS_DBFS_CONTENT.UNREGISTERSTORE(store_name =&gt; 'FS1');
COMMIT;
</pre><p>where <code class="codeph">store_name</code> is SecureFiles Store <code class="codeph">FS1</code>, which uses table <code class="codeph">SFS_DEMO.T1</code>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Drop the file system.</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sfs_demo/******;
EXEC DBMS_DBFS_SFS.DROPFILESYSTEM(store_name =&gt; 'FS1');
COMMIT;
</pre><p>where <code class="codeph">store_name</code> is SecureFiles Store <code class="codeph">FS1</code>, which uses table <code class="codeph">SFS_DEMO.T1</code>.
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="ADLOB46184"></a><div class="props_rev_3"><a id="GUID-CE03355D-56C2-4497-9BD7-AD170EFD9615" name="GUID-CE03355D-56C2-4497-9BD7-AD170EFD9615"></a><h3 id="ADLOB-GUID-CE03355D-56C2-4497-9BD7-AD170EFD9615" class="sect3">About DBFS SecureFiles Store Package, DBMS_DBFS_SFS</h3>
               <div>
                  <p>The DBFS SecureFiles Store package (<code class="codeph">DBMS_DBFS_SFS</code>) is a store provider for <code class="codeph">DBMS_DBFS_CONTENT</code> that supports SecureFiles LOB storage for DBFS content.
                  </p>
                  <p> To use the <code class="codeph">DBMS_DBFS_SFS</code> package, you must be granted the <code class="codeph">DBFS_ROLE</code> role.
                  </p>
                  <p>The SecureFiles Store provider is a default implementation of the DBFS Content API (and is a standard example of a store provider that conforms to the Provider SPI) that enables applications that already use LOBs as columns in their schema, to access the <code class="codeph">BLOB</code> columns. This enables existing applications to easily add PL/SQL provider implementations and provide access through the DBFS Content API without changing their schemas or their business logic. 
                  </p>
                  <p>Applications can also read and write content that is stored in other (third party) stores through the standard DBFS Content API interface.</p>
                  <p>In a SecureFiles Store, the underlying user data is stored in SecureFiles LOBs and metadata such as pathnames, IDs, and properties are stored as columns in relational tables. </p>
                  <div class="infoboxnotealso" id="GUID-CE03355D-56C2-4497-9BD7-AD170EFD9615__GUID-7B826B84-0463-4FBA-B4BE-E5462C86B0D1">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>See <a href="../arpls/DBMS_DBFS_SFS.html#ARPLS72180" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information about the <code class="codeph">DBMS_DBFS_SFS</code> package.
                           </p>
                        </li>
                        <li>
                           <p><a href="creating-your-own-DBFS-store.html#GUID-01819696-9FE0-41AB-9388-A0ECA1F72E52" title="In order to customize a DBFS store, you must implement the DBFS Content SPI (DBMS_DBFS_CONTENT_SPI). It is the basis for existing stores such as the DBFS SecureFiles Store and the DFFS Hierarchical Store, as well as any user-defined DBFS stores that you create.The DBFS Content SPI (Store Provider Interface) is a specification only and has no package body.You can use this example store provider for DBFS, TaBleFileSystem Store Provider ("tbfs"), as a skeleton for custom providers or as a learning tool, to become familiar with the DBFS and its SPI.These are the mechanics of the example store provider for DBFS, TaBleFileSystem Store Provider ("tbfs").You will need certain files for installation and setup of the DBFS TaBleFileSystem Store Provider ("tbfs").Once the example store provider for DBFS, TaBleFileSystem Store Provider ("tbfs") is installed, files can be added or removed in several different ways and other changes can be made to the TBFS.The TBFS is simple because its primary purpose is to serve as a teaching and learning example.The TBFS.SQL script is the top level driver script.The TBL.SQL script creates a test user, a tablespace, the table that backs the filesystem and so on.The spec.sql script provide the SPI specification of the tbfs.The body.sql script provides the SPI implementation of the tbfs.The capi.sql script registers and mounts the DBFS.">Creating Your Own DBFS Store</a> and <a href="../arpls/DBMS_DBFS_CONTENT_SPI.html#ARPLS72231" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for more information about the Provider SPI defined in <code class="codeph">DBMS_DBFS_CONTENT_SPI</code>.
                           </p>
                        </li>
                        <li>
                           <p><a href="using-oracle-LOBs-storage.html#GUID-A65C0BA7-BA2A-4DDE-A577-4670CCCC60C0" title="SecureFiles LOBs can only be created in tablespaces managed with Automatic Segment Space Management (ASSM), unlike BasicFiles LOB storage.">SecureFiles LOB Storage</a>for advanced features of SecureFiles LOBs.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-90F97F5A-8163-4634-813F-7EE372032479" name="GUID-90F97F5A-8163-4634-813F-7EE372032479"></a><h3 id="ADLOB-GUID-90F97F5A-8163-4634-813F-7EE372032479" class="sect3">Database File System (DBFS)— POSIX File Locking</h3>
               <div>
                  <p>Starting from Oracle Database 12<span class="italic">c </span> Release 2(12.2), Oracle supports the Database File system <code class="codeph">POSIX</code> File locking feature. The DBFS provides file locking support for:
                  </p>
                  <div class="p">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">POSIX</code> applications using <code class="codeph">DBFS_CLIENT</code> (in mount mode) as a front-end interface to DBFS. 
                           </p>
                        </li>
                        <li>
                           <p>Applications using <code class="codeph">PL/SQL</code> as an interface to DBFS. 
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="infoboxnote" id="GUID-90F97F5A-8163-4634-813F-7EE372032479__GUID-A50948ED-6F41-40CA-8A5F-962335794859">
                     <p class="notep1">Note:</p>
                     <p>Oracle supports only Full-file locks in DBFS. Full-file lock implies locking the entire file from byte zero offset to the end of file.</p>
                  </div>
                  <p>Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-025D32E0-656F-4E76-836C-15DEEC222296" title="Advisory locking is a file locking mechanism that locks the file for a single process.">About Advisory Locking</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-E82F2616-7310-4624-BD1D-E9629AAF9800" title="Mandatory locking is a file locking mechanism that takes support from participating processes.">About Mandatory Locking</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-AE084E03-789E-40D2-9699-BA4477DFBF0D" title="Enabling the file locking mechanism helps applications to block files for various file system operations.">File Locking Support</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-4105E3EB-7D07-4957-BB09-7BCBBC3FC698">Compatibility and Migration Factors of Database Filesystem—File Locking</a></p>
                     </li>
                     <li>
                        <p><a href="DBFS-securefiles-store.html#GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE">Examples of Database Filesystem—File Locking</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-025D32E0-656F-4E76-836C-15DEEC222296" name="GUID-025D32E0-656F-4E76-836C-15DEEC222296"></a><h4 id="ADLOB-GUID-025D32E0-656F-4E76-836C-15DEEC222296" class="sect4">About Advisory Locking</h4>
                  <div>
                     <p>Advisory locking is a file locking mechanism that locks the file for a single process.</p>
                     <p>File locking mechanism cannot independently enforce any form of locking and requires support from the participating processes. For example, if a process <code class="codeph">P1</code> has a <code class="codeph">write</code> lock on file <code class="codeph">F1</code>, the locking API or the operating system does not perform any action to prevent any other process <code class="codeph">P2</code> from issuing a <code class="codeph">read</code> or <code class="codeph">write</code> system call on the file <code class="codeph">F1</code>. This behavior of file locking mechanism is also applicable to other file system operations. The processes that are involved (in file locking mechanism) must follow a lock or unlock protocol provided in a suitable API form by the user-level library. File locking semantics are guaranteed to work provided, the processes incorporate the recommended usage of the locking protocol and respect the results of API calls.
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-E82F2616-7310-4624-BD1D-E9629AAF9800" name="GUID-E82F2616-7310-4624-BD1D-E9629AAF9800"></a><h4 id="ADLOB-GUID-E82F2616-7310-4624-BD1D-E9629AAF9800" class="sect4">About Mandatory Locking</h4>
                  <div>
                     <p>Mandatory locking is a file locking mechanism that takes support from participating processes.</p>
                     <p>Mandatory locking is an enforced locking scheme that does not rely on the participating processes to cooperate and/or follow the locking API. For example, if a process <code class="codeph">P1</code> has taken a <code class="codeph">write</code> lock on file <code class="codeph">F1</code> and if  a different process <code class="codeph">P2</code> attempts to issue a <code class="codeph">read</code>/<code class="codeph">write</code> system call (or any other file system operation) on file <code class="codeph">F1</code> , the request is blocked because the concerned file is exclusively locked by process <code class="codeph">P1</code>.
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-AE084E03-789E-40D2-9699-BA4477DFBF0D" name="GUID-AE084E03-789E-40D2-9699-BA4477DFBF0D"></a><h4 id="ADLOB-GUID-AE084E03-789E-40D2-9699-BA4477DFBF0D" class="sect4">File Locking Support</h4>
                  <div>
                     <p>Enabling the file locking mechanism helps applications to block files for various file system operations.</p>
                     <p>The <code class="codeph">fcntl()</code>, <code class="codeph">lockf()</code>, and <code class="codeph">flock()</code> system calls in <code class="codeph">UNIX</code> and <code class="codeph">LINUX</code> provide file locking support. These system calls enable applications to use the file locking facility through <code class="codeph">dbfs_client-FUSE</code> callback interface. File Locks provided by <code class="codeph">fcntl()</code> are widely known as POSIX file locks and the file locks provided by <code class="codeph">flock()</code> are known as BSD file locks. The semantics and behavior of POSIX and BSD file locks differ from each other. The locks placed on the same file through <code class="codeph">fcntl()</code> and <code class="codeph">flock()</code> are orthogonal to each other. The semantics of file locking functionality designed and implemented in DBFS is similar to POSIX file locks. In DBFS, semantics of file locks placed through <code class="codeph">flock()</code> system call will be similar to POSIX file locks (such as <code class="codeph">fcntl()</code>) and not BSD file locks.  <code class="codeph">lockf()</code> is a library call that is implemented as a wrapper over <code class="codeph">fcntl()</code> system call on most of the UNIX systems, and hence, it provides POSIX file locking semantics. In DBFS, file locks placed through <code class="codeph">fcntl()</code>, <code class="codeph">flock()</code>, and <code class="codeph">lockf()</code> system-calls provide same kind of behavior and semantics of POSIX file locks.
                     </p>
                     <div class="infoboxnote" id="GUID-AE084E03-789E-40D2-9699-BA4477DFBF0D__GUID-3F2E6C77-70ED-4465-B9EC-A376131F182F">
                        <p class="notep1">Note:</p> BSD file locking semantics are not supported.
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-4105E3EB-7D07-4957-BB09-7BCBBC3FC698" name="GUID-4105E3EB-7D07-4957-BB09-7BCBBC3FC698"></a><h4 id="ADLOB-GUID-4105E3EB-7D07-4957-BB09-7BCBBC3FC698" class="sect4">Compatibility and Migration Factors of Database Filesystem—File Locking</h4>
                  <div>
                     <p></p>
                     <p>The Database Filesystem File Locking feature does not impact the compatibility of <code class="codeph">DBFS</code> and <code class="codeph">SFS</code> store provider with <code class="codeph">RDBMS</code>. 
                     </p>
                     <p><code class="codeph">DBFS_CLIENT</code> is a standalone OCI Client and uses <code class="codeph">OCI</code> calls and <code class="codeph">DBMS_FUSE API</code>. 
                     </p>
                     <div class="infoboxnote" id="GUID-4105E3EB-7D07-4957-BB09-7BCBBC3FC698__GUID-F46A470A-5018-4A0D-90F9-2C3750C806FE">
                        <p class="notep1">Note:</p>
                        <p>This feature will be compatible with <code class="codeph">Ora</code><code class="codeph">SDK/RSF</code> .
                        </p>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE" name="GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE"></a><h4 id="ADLOB-GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE" class="sect4">Examples of Database Filesystem—File Locking</h4>
                  <div>
                     <p></p>
                     <p>The following examples illustrate the advisory locking and the locking functions available on <code class="codeph">UNIX</code> based systems. The following example uses two running processes — Process A and Process B. 
                     </p>
                     <div class="example" id="GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE__EXAMPLE1NOLOCKING-3C33D561">
                        <p class="titleinexample">Example 21-2 No locking</p>
                        <p><code class="codeph">Process A opens file:</code></p><pre class="pre codeblock"><code>file_desc = open(“/path/to/file”, O_RDONLY); 
/* Reads data into bufffers */ 
read(fd, buf1, sizeof(buf)); 
read(fd, buf2, sizeof(buf));
close(file_desc);</code></pre><p>Subjected to OS scheduling, <code class="codeph">process B</code> can enter any time and issue a <code class="codeph">write</code> system call affecting the integrity of file data.
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE__EXAMPLE2ADVISORYLOCKINGUSEDBUTPROCE-3C33D280">
                        <p class="titleinexample">Example 21-3 Advisory locking used but process B does not follow the protocol</p>
                        <p><code class="codeph">Process A opens file:</code></p><pre class="pre codeblock"><code>file_desc = open(“/path/to/file”, O_RDONLY); 
ret = AcquireLock(file_desc, RD_LOCK); 
if(ret) 
{ 
	read(fd, buf1, sizeof(buf)); 
	read(fd, buf2, sizeof(buf)); 
	ReleaseLock(file_desc); 
} 
close(file_desc);</code></pre><p>Subjected to OS scheduling, <code class="codeph">process B</code> can come in any time and still issue a <code class="codeph">write</code> system call ignoring that <code class="codeph">process A</code> already holds a <code class="codeph">read</code> lock.
                        </p>
                        <p><code class="codeph">Process B opens file:</code></p><pre class="pre codeblock"><code>file_desc1 = open(“/path/to/file”, O_WRONLY); 
write(file_desc1, buf, sizeof(buf)); 
close(file_desc1);</code></pre><p>The above code is executed and leads to inconsistent data in the file.</p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-F953FA91-373F-41AB-B3C0-3AA87EED8DCE__EXAMPLE-144-3C33DBDB">
                        <p class="titleinexample">Example 21-4 Advisory locking used and processes are following the protocol</p>
                        <p><code class="codeph">Process A opens file:</code></p><pre class="pre codeblock"><code>file_desc = open(“/path/to/file”, O_RDONLY); 
ret = AcquireLock(file_desc, RD_LOCK); 
if(ret) 
{
	read(fd, buf1, sizeof(buf)); 
	read(fd, buf2, sizeof(buf)); 
	ReleaseLock(file_desc);
}
close(file_desc);</code></pre><p><code class="codeph">Process B opens file:</code></p><pre class="pre codeblock"><code>file_desc1 = open(“/path/to/file”, O_WRONLY); 
ret = AcquireLock(file_desc1, WR_LOCK); 
/* The above call will take care of checking the existence of a lock */ 
if(ret) 
{ 
	write(file_desc1, buf, sizeof(buf)); 
	ReleaseLock(file_desc1); 
} close(file_desc1);</code></pre><p><code class="codeph">Process B</code> follows the lock API and this API makes sure that the process does not <code class="codeph">write</code> to the file without acquiring a lock.
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B85868BC-63B1-438F-962C-ED52F19B6E01" name="GUID-B85868BC-63B1-438F-962C-ED52F19B6E01"></a><h4 id="ADLOB-GUID-B85868BC-63B1-438F-962C-ED52F19B6E01" class="sect4">File Locking Behavior</h4>
                  <div>
                     <p></p>
                     <p>The <code class="codeph">DBFS</code> File Locking feature exhibits the following behaviors: 
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>File locks in <code class="codeph">DBFS</code> are implemented with idempotent functions. If a process issues “N” <code class="codeph">read</code> or <code class="codeph">write</code> lock calls on the same file, only the first call will have an effect, and the subsequent “N-1” calls will be treated as redundant and returns No Operation (NOOP).
                           </p>
                        </li>
                        <li>
                           <p>File can be unlocked exactly once. If a process issues “N” <code class="codeph">unlock</code> calls on the same file, only the first call will have an effect, and the subsequent “N-1” calls will be treated as redundant and returns NOOP.
                           </p>
                        </li>
                        <li>
                           <p>Lock conversion is supported only from <code class="codeph">read</code> to <code class="codeph">write</code>. If a process <code class="codeph">P</code> holds a <code class="codeph">read</code> lock on file <code class="codeph">F</code> ( and <code class="codeph">P</code> is the only process holding the <code class="codeph">read</code> lock), then a <code class="codeph">write</code> lock request by <code class="codeph">P</code> on file <code class="codeph">F</code> will convert the <code class="codeph">read</code> lock to <code class="codeph">exclusive</code>/<code class="codeph">write</code> lock.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-75A47F45-BA4A-4903-95E3-5E52C7B375B9" name="GUID-75A47F45-BA4A-4903-95E3-5E52C7B375B9"></a><h4 id="ADLOB-GUID-75A47F45-BA4A-4903-95E3-5E52C7B375B9" class="sect4">Scheduling File Locks</h4>
                  <div>
                     <p></p>
                     <p>DBFS File Locking feature supports lock scheduling. This facility is implemented purely on the DBFS client side.   Lock request scheduling is required when client application uses blocking call semantics in their <code class="codeph">fcntl()</code>, <code class="codeph">lockf()</code>, and <code class="codeph">flock()</code> calls.
                     </p>
                     <p>There are two types of scheduling:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="DBFS-securefiles-store.html#GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C">Greedy Scheduling</a></p>
                        </li>
                        <li>
                           <p><a href="DBFS-securefiles-store.html#GUID-5C5D4AE4-8CEE-4B3D-93E7-E085C6168CDF">Fair Scheduling</a></p>
                        </li>
                     </ul>
                     <p>Oracle provides the following command line option to switch the scheduling behavior.</p>
                     <p><code class="codeph">Mount -o lock_sched_option = <span class="codeinlineitalic">lock_sched_option Value</span>;</code></p>
                     <div class="p">
                        <div class="tblformal" id="GUID-75A47F45-BA4A-4903-95E3-5E52C7B375B9__LOCK_SCHED_OPTIONVALUEDESCRIPTION-3FC3B812">
                           <p class="titleintable">Table 21-1  <code class="codeph">lock_sched_option</code> Value Description
                           </p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title=" lock_sched_option Value Description" summary="This table provides the description for lock_sched_option values." frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d88633e2374"> Value</th>
                                    <th align="left" valign="bottom" width="20%" id="d88633e2376">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d88633e2380" headers="d88633e2374 ">1</td>
                                    <td align="left" valign="top" width="20%" headers="d88633e2380 d88633e2376 ">Sets the scheduling type to <a href="DBFS-securefiles-store.html#GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C">Greedy Scheduling</a>. (Default)
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d88633e2390" headers="d88633e2374 ">2</td>
                                    <td align="left" valign="top" width="20%" headers="d88633e2390 d88633e2376 ">Sets the scheduling type to <a href="DBFS-securefiles-store.html#GUID-5C5D4AE4-8CEE-4B3D-93E7-E085C6168CDF">Fair Scheduling</a>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnote" id="GUID-75A47F45-BA4A-4903-95E3-5E52C7B375B9__LOCKREQUESTSCHEDULINGWORKSONLYONPER-3FC42CE7">
                           <p class="notep1">Note:</p>Lock Request Scheduling works only on per <code class="codeph">DBFS</code> Client mount basis. For example, lock requests are not scheduled across multiple mounts of the same file system.
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C" name="GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C"></a><h5 id="ADLOB-GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C" class="sect5">Greedy Scheduling</h5>
                     <div>
                        <p></p>
                        <div class="section">
                           <p>In this scheduling technique, the file lock requests does not follow any guaranteed order.</p>
                           <div class="infoboxnote" id="GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C__GUID-905D6536-8A4D-4DE8-9AB7-9633D152EF9D">
                              <p class="notep1">Note:</p>This is the default scheduling option provided by DBFS Client.
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-F925AE51-F3BF-44D4-BB4B-A3E00C35713C__GUID-EFCF7067-AA1E-4EB5-96A2-B83AE67CD239">
                           <p>&nbsp;If a file <code class="codeph">F</code> is <code class="codeph">read</code> locked by process <code class="codeph">P1</code>, and if processes <code class="codeph">P2</code> and <code class="codeph">P3</code> submit blocking <code class="codeph">write</code> lock requests on file <code class="codeph">F</code>, the processes <code class="codeph">P2</code> and <code class="codeph">P3</code> will be blocked (using a form of spin lock) and made to wait for its turn to acquire the lock.&nbsp;During the wait, if a process <code class="codeph">P4</code> submits a <code class="codeph">read</code> lock request (blocking call or a non-blocking call) on file <code class="codeph">F</code>, <code class="codeph">P4</code> will be granted the <code class="codeph">read</code> lock even if there are two processes (<code class="codeph">P2</code> and <code class="codeph">P3</code>) waiting to acquire the <code class="codeph">write</code> lock. Once both <code class="codeph">P1</code> and <code class="codeph">P4</code> release their respective <code class="codeph">read</code> locks, one of <code class="codeph">P2</code> and <code class="codeph">P3</code> will succeed in acquiring the lock. But, the order in which processes <code class="codeph">P2</code> and <code class="codeph">P3</code> acquire the lock is not determined. It is possible that process <code class="codeph">P2</code> would have requested first, but the process <code class="codeph">P3</code>’s request might get unblocked and acquire the lock and the process <code class="codeph">P2</code> must wait for <code class="codeph">P3</code> to release the lock.
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-5C5D4AE4-8CEE-4B3D-93E7-E085C6168CDF" name="GUID-5C5D4AE4-8CEE-4B3D-93E7-E085C6168CDF"></a><h5 id="ADLOB-GUID-5C5D4AE4-8CEE-4B3D-93E7-E085C6168CDF" class="sect5">Fair Scheduling</h5>
                     <div>
                        <p></p>
                        <div class="section">
                           <p>This scheduling technique is implemented using a queuing mechanism on per file basis. For example, if a file <code class="codeph">F</code> is read locked by process <code class="codeph">P1</code>, and processes <code class="codeph">P2</code> and <code class="codeph">P3</code> submit blocking write lock requests on file <code class="codeph">F</code>, these two processes will be blocked (using a form of spin lock) and will wait to acquire the lock. The requests will be queued in the order received by the DBFS client. If a process <code class="codeph">P4</code> submits a read lock request (blocking call or a non-blocking call) on file <code class="codeph">F</code>, this request will be queued even though a read lock can be granted to this process. 
                           </p>
                           <p>DBFS Client ensures that after <code class="codeph">P1</code> releases its read lock, the order in which lock requests are honored is P2-&gt;P3 -&gt; P4.
                           </p>
                           <p>This implies that <code class="codeph">P2</code> will be the first one to get the lock. Once <code class="codeph">P2</code> releases its lock, <code class="codeph">P3</code> will get the lock and so on.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>