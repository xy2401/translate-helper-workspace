<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter explains advanced forms of database duplication.">
      <meta name="description" content="This chapter explains advanced forms of database duplication.">
      <title>Duplicating Databases: Advanced Topics</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Backup and Recovery User's Guide">
      <meta property="og:description" content="This chapter explains advanced forms of database duplication.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Backup and Recovery User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96241-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="rman-duplicating-databases.html" title="Previous" type="text/html">
      <link rel="next" href="creating-transportable-tablespace-sets.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User's Guide">
    <meta name="dcterms.isVersionOf" content="BRADV">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rman-duplicating-databases.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="creating-transportable-tablespace-sets.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Backup and Recovery User's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-transfering-data-rman.html" property="item" typeof="WebPage"><span property="name"> Transferring Data with RMAN</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Duplicating Databases: Advanced Topics</li>
            </ol>
            <a id="GUID-8E3B1C4D-9B1F-422D-9A35-8A5AE71C36F5" name="GUID-8E3B1C4D-9B1F-422D-9A35-8A5AE71C36F5"></a>
            
            <h2 id="BRADV-GUID-8E3B1C4D-9B1F-422D-9A35-8A5AE71C36F5" class="sect2"><span class="enumeration_chapter">26 </span>Duplicating Databases: Advanced Topics
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter explains advanced forms of database duplication.</p>
               <p>This chapter contains the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="rman-duplicating-databases-advanced.html#GUID-2D8041F5-A322-452F-980C-5E81E1902D1C" title="If the source database and duplicate database do not use the same names for database files, then you must choose an alternative naming strategy for the duplicate files.">Specifying Alternative Names for Duplicate Database Files</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="You can use the shared disk technique to make backups available to the auxiliary instance. When NFS or shared disk is not an option, then the path that stores the backups must exist on both the source and destination hosts, unless the BACKUP LOCATION option is used for the DUPLICATE command without a target or recovery catalog connection.">Making Disk Backups Accessible Without Shared Disk</a></p>
                  </li>
               </ul>
            </div>
            <div class="sect2"><a id="GUID-2D8041F5-A322-452F-980C-5E81E1902D1C" name="GUID-2D8041F5-A322-452F-980C-5E81E1902D1C"></a><h3 id="BRADV-GUID-2D8041F5-A322-452F-980C-5E81E1902D1C" class="sect3"><span class="enumeration_section">26.1 </span>Specifying Alternative Names for Duplicate Database Files
               </h3>
               <div>
                  <p>If the source database and duplicate database do not use the same names for database files, then you must choose an alternative naming strategy for the duplicate files.</p>
                  <div class="section">
                     <p>Depending on whether the source and duplicate databases use Oracle Managed Files (OMF) or Oracle Automatic Storage Management (ASM), use one of the following strategies:</p>
                  </div>
                  <!-- class="section" -->
                  <ul>
                     <li class="stepexpand"><span><a href="rman-duplicating-databases-advanced.html#GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65" title="When the source and duplicate database either use different directory structures or use the same structure but you want to name the duplicate files differently, then you must specify how duplicate database files must be named.">Specifying Non-OMF or Non-ASM Alternative Names for Duplicate Database Files</a></span></li>
                     <li class="stepexpand"><span><a href="rman-duplicating-databases-advanced.html#GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE" title="The CONFIGURE AUXNAME command is an alternative to the SET NEWNAME command. The difference is that after you configure the auxiliary name the first time, additional DUPLICATE commands reuse the configured settings. In contrast, you must reissue the SET NEWNAME command every time you execute the DUPLICATE command.">Using the CONFIGURE AUXNAME Command to Name File System Data Files and OMF or ASM Target Data Files</a></span><div>
                           <p>If the source data files use OMF, then you cannot rename them by using the <code class="codeph">DB_FILE_NAME_CONVERT</code> initialization parameter. <a href="performing-rman-tspitr.html#GUID-AEA2C5F4-214B-4795-86DE-69BC307832EE" title="Multiple methods are available to rename OMF (non-ASM) file names for the auxiliary database.">Using Non-ASM Storage</a> discusses the details and options of OMF-managed data files.
                           </p>
                        </div>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65" name="GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65"></a><h4 id="BRADV-GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65" class="sect4"><span class="enumeration_section">26.1.1 </span>Specifying Non-OMF or Non-ASM Alternative Names for Duplicate Database Files
                  </h4>
                  <div>
                     <p>When the source and duplicate database either use different directory structures or use the same structure but you want to name the duplicate files differently, then you must specify how duplicate database files must be named.</p>
                     <div class="section">
                        <p><a href="rman-duplicating-databases-advanced.html#GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65__GUID-9E492CBE-B861-4ACB-AA35-89E96B264B97" title="This table describes the formats available for naming duplicate database files">Table 26-1</a> summarizes the formats that are available for naming each type of file.
                        </p>
                        <div class="tblformal" id="GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65__GUID-9E492CBE-B861-4ACB-AA35-89E96B264B97">
                           <p class="titleintable">Table 26-1 Substitution Variables for the SET NEWNAME Command</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Substitution Variables for the SET NEWNAME Command" summary="This table describes the formats available for naming duplicate database files" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d122325e301"><span class="bold">Variable</span></th>
                                    <th align="left" valign="bottom" width="20%" id="d122325e304"><span class="bold">Description</span></th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d122325e309" headers="d122325e301 ">
                                       <p><code class="codeph">%b</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d122325e309 d122325e304 ">
                                       <p>Specifies the file name stripped of directory paths. For example, if a data file is named <code class="codeph">/oradata/prod/financial.dbf</code>, then <code class="codeph">%b</code> results in <code class="codeph">financial.dbf</code>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d122325e326" headers="d122325e301 ">
                                       <p><code class="codeph">%f</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d122325e326 d122325e304 ">
                                       <p>Specifies the absolute file number of the data file for which the new name is generated. For example, if data file 2 is duplicated, then <code class="codeph">%f</code> generates the value 2.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d122325e337" headers="d122325e301 ">
                                       <p><code class="codeph">%I</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d122325e337 d122325e304 ">
                                       <p>Specifies the DBID.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d122325e345" headers="d122325e301 ">
                                       <p><code class="codeph">%N</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d122325e345 d122325e304 ">
                                       <p>Specifies the tablespace name.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d122325e353" headers="d122325e301 ">
                                       <p><code class="codeph">%U</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d122325e353 d122325e304 ">
                                       <p>Specifies the following format: <code class="codeph">data-D-%d_id-%I_TS-%N_FNO-%f</code></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>Use one of the following techniques to provide alternate names for non-OMF or non-ASM duplicate database files:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="rman-duplicating-databases-advanced.html#GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2" title="Use the SET NEWNAME command before you execute the DUPLICATE command to name duplicate data files.">Using the SET NEWNAME Command to Name File System Data Files and Temp Files</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases-advanced.html#GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE" title="The CONFIGURE AUXNAME command is an alternative to the SET NEWNAME command. The difference is that after you configure the auxiliary name the first time, additional DUPLICATE commands reuse the configured settings. In contrast, you must reissue the SET NEWNAME command every time you execute the DUPLICATE command.">Using the CONFIGURE AUXNAME Command to Name File System Data Files and OMF or ASM Target Data Files</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="sect4"><a id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2" name="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2"></a><h5 id="BRADV-GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2" class="sect5"><span class="enumeration_section">26.1.1.1 </span>Using the SET NEWNAME Command to Name File System Data Files and Temp Files
                     </h5>
                     <div>
                        <p>Use the <code class="codeph">SET NEWNAME</code> command before you execute the <code class="codeph">DUPLICATE</code> command to name duplicate data files.
                        </p>
                        <div class="section">
                           <p> RMAN supports the following commands, listed in order of precedence:</p>
                           <ol>
                              <li>
                                 <p><code class="codeph">SET NEWNAME FOR DATAFILE</code> and <code class="codeph">SET NEWNAME FOR TEMPFILE</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">SET NEWNAME FOR TABLESPACE</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">SET NEWNAME FOR DATABASE</code></p>
                              </li>
                           </ol>
                           <p>The order of precedence means that the <code class="codeph">SET NEWNAME FOR TABLESPACE</code> command specifies names for files that are not named by the <code class="codeph">SET NEWNAME FOR DATAFILE</code> and <code class="codeph">SET NEWNAME FOR TEMPFILE</code> commands, whereas the <code class="codeph">SET NEWNAME FOR DATABASE</code> command specifies names for files that are not named by the <code class="codeph">SET NEWNAME FOR TABLESPACE</code>, <code class="codeph">SET NEWNAME FOR DATAFILE</code>, or <code class="codeph">SET NEWNAME FOR TEMPFILE</code> commands.
                           </p>
                           <p>When yo use the <code class="codeph">SET NEWNAME FOR DATAFILE</code> command, you can specify a full path as a literal, as in <code class="codeph">/oradata1/system01.dbf</code>. However, when you use the <code class="codeph">SET</code> command with the <code class="codeph">FOR DATABASE</code> or <code class="codeph">FOR TABLESPACE</code> options, you must use at least one of these substitution variables, described in <a href="rman-duplicating-databases-advanced.html#GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65__GUID-9E492CBE-B861-4ACB-AA35-89E96B264B97" title="This table describes the formats available for naming duplicate database files">Table 26-1</a>: <code class="codeph">%b</code>, <code class="codeph">%f</code>, <code class="codeph">%U</code>(<code class="codeph">%I</code> and <code class="codeph">%N</code> are optional).
                           </p>
                           <p>To use the <code class="codeph">SET NEWNAME</code> command to specify new file names:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Ensure that the prerequisites for the selected duplication technique are met.</span><div>
                                 <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Complete the required planning tasks before you begin database duplication. </span><div>
                                 <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Prepare the auxiliary instance that is used when you create the duplicate database.</span><div>
                                 <p>While duplicating an Oracle Real Application Clusters (Oracle RAC) database, set the <code class="codeph">CLUSTER_DATABASE</code> initialization parameter on the auxiliary database to <code class="codeph">FALSE</code>. This parameter can be reset to <code class="codeph">TRUE</code> after the duplication process completes.
                                 </p>
                                 <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Start RMAN and connect to required databases. Depending on your duplication technique, you may need to connect to one or more of the following: target database, auxiliary instance, or recovery catalog.</span><div>
                                 <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="You must start the RMAN client and connect to the database instances as required by the chosen duplication technique. The RMAN client can be located on any host so long as it can connect to the necessary databases over the network.">Starting RMAN and Connecting to Databases</a>"</span>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Place the source database in a proper state, if necessary.</span><div>
                                 <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="If RMAN is connected to the source database as TARGET, then the source database must be in a proper state for duplication.">Placing the Source Database in a Proper State</a>"</span>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>(Optional) Configure RMAN channels to improve duplication performance. Channels perform the primary task of duplicating the database.</span><div>
                                 <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Within a <code class="codeph">RUN</code> command, issue the <code class="codeph">SET NEWNAME</code> command before you issue the <code class="codeph">DUPLICATE</code> command.</span></li>
                        </ol>
                        <div class="example" id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-F74D6F45-8786-4DA2-A873-EEAD94BCDA92">
                           <p class="titleinexample">Example 26-1 Duplicating Databases with the SET NEWNAME FOR DATAFILE Command</p>
                           <p>This example illustrates a script that specifies new names for data files 1 through 5 and temp file 1. The script does not set a new name for data file 6 because it is in the <code class="codeph">TOOLS</code> tablespace, which is excluded from the duplicate database.
                           </p>
                           <div class="p">Assume the following:
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>DBID is 87650928</p>
                                 </li>
                                 <li>
                                    <p>Database name is <code class="codeph">PROD</code></p>
                                 </li>
                              </ul>
                           </div>
                           <p>Use the following command to duplicate the database:</p><pre class="pre codeblock"><code>RUN
{
SET NEWNAME FOR DATAFILE 1 TO '/oradata1/system01.dbf'; 
SET NEWNAME FOR DATAFILE 2 TO '/oradata2/sysaux01.dbf';
SET NEWNAME FOR DATAFILE 3 TO '/oradata3/undotbs01.dbf';
SET NEWNAME FOR DATAFILE 4 TO '/oradata4/users01.dbf'; 
SET NEWNAME FOR DATAFILE 5 TO '/oradata5/users02.dbf';
SET NEWNAME FOR TEMPFILE 1 TO '/oradatat/temp01.dbf'; 
DUPLICATE TARGET DATABASE TO dupdb
  SKIP TABLESPACE tools
  LOGFILE
     GROUP 1 ('/duplogs/redo01a.log','/duplogs/redo01b.log') SIZE 4M REUSE, 
     GROUP 2 ('/duplogs/redo02a.log', '/duplogs/redo02b.log') SIZE 4M REUSE;
}</code></pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-8BBF6497-1BAB-4DB1-B850-8B91F57CFFE7">
                           <p class="titleinexample">Example 26-2 Duplicating Databases with the SET NEWNAME FOR DATAFILE and SET NEWNAME FOR TABLESPACE Commands</p>
                           <p>This example is a variation of <a href="rman-duplicating-databases-advanced.html#GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-F74D6F45-8786-4DA2-A873-EEAD94BCDA92">Example 26-1</a> and uses a single <code class="codeph">SET NEWNAME</code> command to name all data files in the tablespace <code class="codeph">users</code>. After the example completes, the file names for tablespace <code class="codeph">users</code> are set to: <code class="codeph">/oradata4/users01.dbf</code> and <code class="codeph">/oradata5/users02.dbf</code>.
                           </p>
                           <p>Use the following command to duplicate the database:</p><pre class="pre codeblock"><code>{
SET NEWNAME FOR TABLESPACE users TO '/oradata%f/%b';
SET NEWNAME FOR DATAFILE 1 TO '/oradata1/system01.dbf';
SET NEWNAME FOR DATAFILE 2 TO '/oradata2/sysaux01.dbf';
SET NEWNAME FOR DATAFILE 3 TO '/oradata3/undotbs01.dbf';
SET NEWNAME FOR TEMPFILE 1 TO '/oradatat/temp01.dbf';
DUPLICATE TARGET DATABASE TO dupdb
SKIP TABLESPACE tools
LOGFILE
   GROUP 1 ('/duplogs/redo01a.log','/duplogs/redo01b.log') SIZE 4M REUSE,
   GROUP 2 ('/duplogs/redo02a.log','/duplogs/redo02b.log') SIZE 4M REUSE;
}</code></pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-2F07DAA1-075B-4C14-A406-980CBA954A35">
                           <p class="titleinexample">Example 26-3 Duplicating Database with the SET NEWNAME FOR DATABASE Command</p>
                           <p>This example is a variation of <a href="rman-duplicating-databases-advanced.html#GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-F74D6F45-8786-4DA2-A873-EEAD94BCDA92">Example 26-1</a> and uses a single <code class="codeph">SET</code> command to name all data files in the database. 
                           </p>
                           <p>Use the following command to duplicate the database:</p><pre class="pre codeblock"><code>RUN
{
SET NEWNAME FOR DATABASE TO '/oradata/%U';
DUPLICATE TARGET DATABASE TO dupdb
  SKIP TABLESPACE tools
  LOGFILE
    GROUP 1 ('/duplogs/redo01a.log','/duplogs/redo01b.log') SIZE 4M REUSE,
    GROUP 2 ('/duplogs/redo02a.log','/duplogs/redo02b.log') SIZE 4M REUSE;
}</code></pre><p>The following table shows the results from this example.</p>
                           <div class="tblformal" id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-E94CC87D-EE72-4BEE-A608-535B8F43421C">
                              <p class="titleintable">Table 26-2 Results for the SET NEWNAME DATABASE Command</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="Results for the SET NEWNAME DATABASE Command" summary="This table lists the before and after results from SET NEWNAME DATABASE." frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e756">Before SET NEWNAME DATABASE </th>
                                       <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e759">Tablespace Name </th>
                                       <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e762">Data File Number</th>
                                       <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e765">After SET NEWNAME DATABASE TO '/oradata/%U';</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e770" headers="d122325e756 ">
                                          <p><code class="codeph">.../system01.dbf </code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e770 d122325e759 ">
                                          <p><code class="codeph">SYSTEM</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e770 d122325e762 ">
                                          <p>1</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e770 d122325e765 ">
                                          <p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-SYSTEM_FNO-1</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e786" headers="d122325e756 ">
                                          <p><code class="codeph">.../sysaux01.dbf</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e786 d122325e759 ">
                                          <p><code class="codeph">SYSAUX</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e786 d122325e762 ">
                                          <p>2</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e786 d122325e765 ">
                                          <p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-SYSAUX_FNO-2</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e802" headers="d122325e756 ">
                                          <p><code class="codeph">.../undotbs01.dbf</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e802 d122325e759 ">
                                          <p><code class="codeph">UNDOTS</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e802 d122325e762 ">
                                          <p>3</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e802 d122325e765 ">
                                          <p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-UNDOTS_FNO-3</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e818" headers="d122325e756 ">
                                          <p><code class="codeph">.../users01.dbf</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e818 d122325e759 ">
                                          <p><code class="codeph">USERS</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e818 d122325e762 ">
                                          <p>4</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e818 d122325e765 ">
                                          <p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-USERS_FNO-4</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e834" headers="d122325e756 ">
                                          <p><code class="codeph">.../users02.dbf</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e834 d122325e759 ">
                                          <p><code class="codeph">USERS</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e834 d122325e762 ">
                                          <p>5</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e834 d122325e765 ">
                                          <p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-USERS_FNO-5</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e850" headers="d122325e756 ">
                                          <p><code class="codeph">.../temp01.dbf</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e850 d122325e759 ">
                                          <p><code class="codeph">TEMP</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e850 d122325e762 ">
                                          <p>1</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e850 d122325e765 ">
                                          <p><code class="codeph">/oradata/data-D-PROD_id-87650928_TS-TEMP_FNO-1</code></p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <div class="infoboxnotealso" id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-F3B28FFA-0060-4281-94BC-088EE60CFA67">
                              <p class="notep1">See Also:</p>
                              <p><a href="../rcmrf/SET.html#RCMRF-GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for details on substitution variables usable in <code class="codeph">SET NEWNAME</code></p>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE" name="GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE"></a><h5 id="BRADV-GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE" class="sect5"><span class="enumeration_section">26.1.1.2 </span>Using the CONFIGURE AUXNAME Command to Name File System Data Files and OMF or ASM Target Data Files
                     </h5>
                     <div>
                        <p>The <code class="codeph">CONFIGURE AUXNAME</code> command is an alternative to the <code class="codeph">SET NEWNAME</code> command. The difference is that after you configure the auxiliary name the first time, additional <code class="codeph">DUPLICATE</code> commands reuse the configured settings. In contrast, you must reissue the <code class="codeph">SET NEWNAME</code> command every time you execute the <code class="codeph">DUPLICATE</code> command.
                        </p>
                        <div class="section">
                           <p>To use the <code class="codeph">CONFIGURE AUXNAME</code> command to specify names for duplicate data files:
                           </p>
                           <ol>
                              <li>
                                 <p>Issue a <code class="codeph">CONFIGURE AUXNAME</code> command for each file to name in the duplicate database.
                                 </p>
                                 <p>For example, enter the following commands at the RMAN prompt to specify names for files data files 1 through 5:</p><pre class="pre codeblock"><code>CONFIGURE AUXNAME FOR DATAFILE 1 TO '/oradata1/system01.dbf';
CONFIGURE AUXNAME FOR DATAFILE 2 TO '/oradata2/sysaux01.dbf';
CONFIGURE AUXNAME FOR DATAFILE 3 TO '/oradata3/undotbs01.dbf';
CONFIGURE AUXNAME FOR DATAFILE 4 TO '/oradata4/users01.dbf'; 
CONFIGURE AUXNAME FOR DATAFILE 5 TO '/oradata5/users02.dbf';</code></pre></li>
                              <li>
                                 <p>Issue a <code class="codeph">DUPLICATE</code> command.
                                 </p>
                                 <p>For example, enter the following command at the RMAN prompt:</p><pre class="pre codeblock"><code>SET NEWNAME FOR TEMPFILE 1 TO '/oradatat/temp01.dbf'; 
DUPLICATE TARGET DATABASE
  TO dupdb
  SKIP TABLESPACE tools
  LOGFILE
     GROUP 1 ('/duplogs/redo01a.log','/duplogs/redo01b.log') SIZE 4M REUSE,
     GROUP 2 ('/duplogs/redo02a.log','/duplogs/redo02b.log') SIZE 4M REUSE;</code></pre></li>
                           </ol>
                           <div class="infoboxnotealso" id="GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE__GUID-317CDC14-A5EB-4868-930E-64B4B1D9348D">
                              <p class="notep1">See Also:</p>
                              <p><a href="../rcmrf/CONFIGURE.html#RCMRF-GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for details on using <code class="codeph">CONFIGURE AUXNAME</code></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-EC10A9C8-DF30-407E-9B0A-E597ABFE5D6F" name="GUID-EC10A9C8-DF30-407E-9B0A-E597ABFE5D6F"></a><h4 id="BRADV-GUID-EC10A9C8-DF30-407E-9B0A-E597ABFE5D6F" class="sect4"><span class="enumeration_section">26.1.2 </span>Specifying OMF or ASM Alternative Names for Duplicate Database Files
                  </h4>
                  <div>
                     <p>You must specify how to name duplicate database files when the source database and duplicate database do not use the same names for database files.</p>
                     <p>The following sections discuss requirements and procedures for creating a duplicate database when some or all files of the duplicate database use OMF or ASM:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-CA4E1982-6C0F-4111-A971-96990D4634DC" title="When you create a duplicate database that uses OMF, you must set initialization parameters in the auxiliary instance. If you use the SPFILE option of the DUPLICATE command to name the files, then you can set initialization parameters in the SPFILE option.">Settings and Restrictions for OMF Initialization Parameters</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-82E9B9C5-74D6-4B22-A03C-2A24930B8A03" title="You must identify the initialization parameters that control the location where files are created and set these parameters to an ASM disk group.">Setting Initialization Parameters for ASM</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA" title="This section contains examples on duplicating databases to ASM.">Examples: Duplicating Databases to ASM</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA" title="To name Oracle managed data files, you can use the SET NEWNAME command with the TO NEW option instead of the TO 'filename' option. RMAN creates the specified data files or temp files with OMF names in the location specified by the DB_CREATE_FILE_DEST parameter.">Using the SET NEWNAME Command to Create OMF or ASM Files</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-086A9599-15DB-4441-8E02-A939CBC5FF96" title="In addition to using the SET NEWNAME or CONFIGURE AUXNAME commands, you can use the DB_FILE_NAME_CONVERT parameter to transform target file names. You can either specify the DB_FILE_NAME_CONVERT option in the DUPLICATE command or you can set it in the initialization parameter file of the auxiliary instance.">Using the DB_FILE_NAME_CONVERT Parameter to Generate Names for Non-OMF or ASM Data Files</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-A11B8766-5078-433F-927E-D77314236755" title="If the LOG_FILE clause has been omitted and none of the OMF initialization parameters DB_CREATE_FILE_DEST, DB_CREATE_ONLINE_DEST_n, or DB_RECOVERY_FILE_DEST are specified, then the LOG_FILE_NAME_CONVERT parameter can transform target file names. This works in the same way that the DB_FILE_NAME_CONVERT parameter does to transform target file names from log_* to duplog_*.">Using the LOG_FILE_NAME_CONVERT Parameter to Generate Names for Non-OMF or ASM Log Files</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-EC10A9C8-DF30-407E-9B0A-E597ABFE5D6F__GUID-5EBD5330-8C1C-4E8D-86D9-41B44CEDD939">
                        <p class="notep1">See Also:</p>
                        <p><span class="italic">Oracle Automatic Storage Management Administrator's Guide</span> for an introduction to ASM and OMF
                        </p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-CA4E1982-6C0F-4111-A971-96990D4634DC" name="GUID-CA4E1982-6C0F-4111-A971-96990D4634DC"></a><h5 id="BRADV-GUID-CA4E1982-6C0F-4111-A971-96990D4634DC" class="sect5"><span class="enumeration_section">26.1.2.1 </span>Settings and Restrictions for OMF Initialization Parameters 
                     </h5>
                     <div>
                        <p>When you create a duplicate database that uses OMF, you must set initialization parameters in the auxiliary instance. If you use the <code class="codeph">SPFILE</code> option of the <code class="codeph">DUPLICATE</code> command to name the files, then you can set initialization parameters in the <code class="codeph">SPFILE</code> option. 
                        </p>
                        <p><a href="rman-duplicating-databases-advanced.html#GUID-CA4E1982-6C0F-4111-A971-96990D4634DC__GUID-A3E1C5B8-E35B-4825-A0C7-A9E3AD4AD1D8" title="Relevant initialization parameters for Oracle Managed Files">Table 26-3</a> describes the relevant parameters and recommended settings. 
                        </p>
                        <div class="tblformal" id="GUID-CA4E1982-6C0F-4111-A971-96990D4634DC__GUID-A3E1C5B8-E35B-4825-A0C7-A9E3AD4AD1D8">
                           <p class="titleintable">Table 26-3 Initialization Parameters for Oracle Managed Files</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Initialization Parameters for Oracle Managed Files" summary="Relevant initialization parameters for Oracle Managed Files" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1286">Initialization Parameter</th>
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1289">Purpose</th>
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1292">Recommendation</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1297" headers="d122325e1286 ">
                                       <p><code class="codeph">DB_CREATE_FILE_DEST</code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1297 d122325e1289 ">
                                       <p>Specifies the default location for Oracle managed data files. This location is also the default location for Oracle managed control files and online logs if no <code class="codeph">DB_CREATE_ONLINE_LOG_DEST</code> initialization parameters are specified.
                                       </p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1297 d122325e1292 ">
                                       <p>Set this parameter to the location for OMF. Any database files that have no location specified are created in the directory specified by the <code class="codeph">DB_CREATE_FILE_DEST</code> parameter. You can override the default for specific files by using the <code class="codeph">SET NEWNAME</code> command, as described in <span class="q">"<a href="rman-duplicating-databases-advanced.html#GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA" title="To name Oracle managed data files, you can use the SET NEWNAME command with the TO NEW option instead of the TO 'filename' option. RMAN creates the specified data files or temp files with OMF names in the location specified by the DB_CREATE_FILE_DEST parameter.">Using the SET NEWNAME Command to Create OMF or ASM Files</a>"</span>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1339" headers="d122325e1286 ">
                                       <p><code class="codeph">DB_CREATE_ONLINE_LOG_DEST_<span class="codeinlineitalic">n</span></code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1339 d122325e1289 ">
                                       <p>Specifies the default location for Oracle managed control files and online redo logs. If multiple parameters are set, then one control file and one online redo log is created in each location.</p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1339 d122325e1292 ">
                                       <p>Set these parameters (_1, _2, and so on) only if you want to multiplex the control files and online redo log files in multiple locations.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1352" headers="d122325e1286 ">
                                       <p><code class="codeph">DB_RECOVERY_FILE_DEST</code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1352 d122325e1289 ">
                                       <p>Specifies the default location for the fast recovery area. The fast recovery area contains multiplexed copies of current control files and online redo log files.</p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1352 d122325e1292 ">
                                       <p>Set this parameter if you want a multiplexed copy of the control file and online redo log file in the recovery area.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p><a href="rman-duplicating-databases-advanced.html#GUID-CA4E1982-6C0F-4111-A971-96990D4634DC__GUID-4841F1A7-6E5C-49FD-BABD-2ED20BBCA3BC" title="List of Initialization Parameter Restrictions for Oracle Managed Files">Table 26-4</a> lists the restrictions on setting other initialization parameters.
                        </p>
                        <div class="tblformal" id="GUID-CA4E1982-6C0F-4111-A971-96990D4634DC__GUID-4841F1A7-6E5C-49FD-BABD-2ED20BBCA3BC">
                           <p class="titleintable">Table 26-4 Initialization Parameter Restrictions for Oracle Managed Files</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Initialization Parameter Restrictions for Oracle Managed Files" summary="List of Initialization Parameter Restrictions for Oracle Managed Files" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1379">Initialization Parameter</th>
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1382">Purpose</th>
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1385">Restriction</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1390" headers="d122325e1379 ">
                                       <p><code class="codeph">CONTROL_FILES</code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1390 d122325e1382 ">
                                       <p>Specifies one or more names of control files, separated by commas.</p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1390 d122325e1385 ">
                                       <p>Do not set this parameter if you want the duplicate database control files in an OMF format. When you use control files in an OMF format, Oracle recommends that you use a server parameter file at the duplicate database .</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1401" headers="d122325e1379 ">
                                       <p><code class="codeph">DB_FILE_NAME_CONVERT</code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1401 d122325e1382 ">
                                       <p>Converts the file name of a new data file on the primary database to a file name on the duplicate database.</p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1401 d122325e1385 ">
                                       <p>Do not set this parameter. Omitting this parameter enables the database to generate valid Oracle managed file names for the duplicate data files.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1412" headers="d122325e1379 ">
                                       <p><code class="codeph">LOG_FILE_NAME_CONVERT</code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1412 d122325e1382 ">
                                       <p>Converts the file name of a new log file on the primary database to the file name of a log file on the standby database.</p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1412 d122325e1385 ">
                                       <p>Do not set this parameter. Omitting this parameter allows the database to generate valid Oracle managed online redo log file names.</p>
                                       <p>To direct duplicate database online redo log files to Oracle managed storage, you can use the <code class="codeph">DB_CREATE_FILE_DEST</code>, <code class="codeph">DB_RECOVERY_FILE_DEST</code>, or <code class="codeph">DB_CREATE_ONLINE_LOG_DEST_<span class="codeinlineitalic">n</span></code> initialization parameters to identify an Oracle managed location for the online logs.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-82E9B9C5-74D6-4B22-A03C-2A24930B8A03" name="GUID-82E9B9C5-74D6-4B22-A03C-2A24930B8A03"></a><h5 id="BRADV-GUID-82E9B9C5-74D6-4B22-A03C-2A24930B8A03" class="sect5"><span class="enumeration_section">26.1.2.2 </span>Setting Initialization Parameters for ASM
                     </h5>
                     <div>
                        <p>You must identify the initialization parameters that control the location where files are created and set these parameters to an ASM disk group. </p>
                        <p>The procedure for creating a duplicate database to an ASM location is similar to that of creating a duplicate database to OMF. For example, set the <code class="codeph">DB_CREATE_FILE_DEST</code>, <code class="codeph">DB_CREATE_ONLINE_DEST_<span class="codeinlineitalic">n</span></code>, and <code class="codeph">CONTROL_FILES</code> parameters to <code class="codeph">+DISK1</code>.
                        </p>
                        <div class="infoboxnotealso" id="GUID-82E9B9C5-74D6-4B22-A03C-2A24930B8A03__GUID-520B2CC8-308F-40DD-A677-D0AA782872F8">
                           <p class="notep1">See Also:</p>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-CA4E1982-6C0F-4111-A971-96990D4634DC" title="When you create a duplicate database that uses OMF, you must set initialization parameters in the auxiliary instance. If you use the SPFILE option of the DUPLICATE command to name the files, then you can set initialization parameters in the SPFILE option.">Settings and Restrictions for OMF Initialization Parameters</a></p>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA" name="GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA"></a><h5 id="BRADV-GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA" class="sect5"><span class="enumeration_section">26.1.2.3 </span>Examples: Duplicating Databases to ASM
                     </h5>
                     <div>
                        <p>This section contains examples on duplicating databases to ASM.</p>
                        <div class="example" id="GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA__GUID-832F053F-FE17-45D6-9094-829936EB187E">
                           <p class="titleinexample">Example 26-4 Duplicating a Database from a File System to ASM</p>
                           <p>In this example, you use active database duplication. If the source database uses a server parameter file (or a backup is available), then you can create a temporary initialization parameter file on the destination host and set only the <code class="codeph">DB_NAME</code> parameter.
                           </p>
                           <p>Assume that the source database <code class="codeph">prod</code> is on <code class="codeph">host1</code> and stores its data files in a non-ASM file system. The control files for <code class="codeph">prod</code> are located in <code class="codeph">/oracle/oradata/prod/</code>. You want to duplicate the source database to database <code class="codeph">dupdb</code> on remote host <code class="codeph">host2</code>. You want to store the duplicate database files in ASM disk group <code class="codeph">+DISK1</code>.
                           </p>
                           <p>After connecting RMAN to the target, duplicate, and recovery catalog databases, run the following RMAN script to duplicate the database.</p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE TO dupdb
FROM ACTIVE DATABASE
SPFILE
PARAMETER_VALUE_CONVERT '/oracle/oradata/prod/', '+DISK1'
SET DB_CREATE_FILE_DEST +DISK1;</code></pre><p>When the <code class="codeph">DUPLICATE</code> command completes, the duplicate database is created, with data files, online redo log files, and control files in ASM disk group <code class="codeph">+DISK1</code>.
                           </p>
                        </div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA__GUID-C9E585B7-665E-42F8-8B9B-D469D53F4C39">
                           <p class="titleinexample">Example 26-5 Duplicating a Database from ASM to ASM</p>
                           <p>In this example, you use active database duplication. If the source database uses a server parameter file (or a backup is available), then you can create a temporary initialization parameter file on the destination host and set only the <code class="codeph">DB_NAME</code> parameter.
                           </p>
                           <p>Assume that the source database <code class="codeph">prod</code> is on <code class="codeph">host1</code> and stores its data files in ASM disk group <code class="codeph">+DISK1</code>. You want to duplicate the target to database <code class="codeph">dupdb</code> on remote host <code class="codeph">host2</code>. You want to store the data files for <code class="codeph">dupdb</code> in ASM. Specifically, you want to store the data files and control files in disk group <code class="codeph">+DISK2</code>.
                           </p>
                           <p>In the <code class="codeph">DUPLICATE</code> command, set <code class="codeph">PARAMETER_VALUE_CONVERT</code> to convert all directory locations from <code class="codeph">+DISK1</code> to <code class="codeph">+DISK2</code>. The new file names in <code class="codeph">+DISK2</code> are generated by ASM and do not match the original file names in disk group <code class="codeph">+DISK1</code>. 
                           </p>
                           <p>After connecting to the target, duplicate, and catalog databases, run the following RMAN script to duplicate the database.</p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE
TO dupdb
FROM ACTIVE DATABASE
SPFILE PARAMETER_VALUE_CONVERT '+DISK1','+DISK2'
SET DB_RECOVERY_FILE_DEST_SIZE='750G';</code></pre><p>When the <code class="codeph">DUPLICATE</code> command completes, the duplicate database is created, with data files, online redo logs, and control files in the larger ASM disk group <code class="codeph">+DISK2</code>.
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA" name="GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA"></a><h5 id="BRADV-GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA" class="sect5"><span class="enumeration_section">26.1.2.4 </span>Using the SET NEWNAME Command to Create OMF or ASM Files
                     </h5>
                     <div>
                        <p>To name Oracle managed data files, you can use the <code class="codeph">SET NEWNAME</code> command with the <code class="codeph">TO NEW</code> option instead of the <code class="codeph">TO '<span class="codeinlineitalic">filename</span>'</code> option. RMAN creates the specified data files or temp files with OMF names in the location specified by the <code class="codeph">DB_CREATE_FILE_DEST</code> parameter.
                        </p>
                        <div class="section">
                           <p>To use the <code class="codeph">SET NEWNAME</code> command to specify names for OMF:
                           </p>
                           <ol>
                              <li>
                                 <p>Set the <code class="codeph">DB_CREATE_FILE_DEST</code> initialization parameter at the auxiliary instance to the desired location.
                                 </p>
                              </li>
                              <li>
                                 <p>Enclose the <code class="codeph">DUPLICATE</code> command in a <code class="codeph">RUN</code> block and use the <code class="codeph">SET NEWNAME</code> command with the <code class="codeph">TO NEW</code> option for OMF.
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA__GUID-F92206B1-407C-46D9-BD4C-5CCEE29814DB">
                           <p class="titleinexample">Example 26-6 Duplicating Databases with the SET NEWNAME FOR DATAFILE and SET NEWNAME FOR TABLESPACE Commands</p>
                           <p>This example illustrates a script that specifies literal names for data files 1-5. The only Oracle Managed Files in the source database are the data files in the <code class="codeph">users</code> tablespace. Therefore, the <code class="codeph">TO NEW</code> option is specified in the <code class="codeph">SET NEWNAME</code> command for these files.
                           </p><pre class="pre codeblock"><code>RUN
{
SET NEWNAME FOR TABLESPACE users TO NEW;
SET NEWNAME FOR DATAFILE 3 TO NEW;
SET NEWNAME FOR DATAFILE 1 TO '/oradata1/system01.dbf';
SET NEWNAME FOR DATAFILE 2 TO '/oradata2/sysaux01.dbf';
SET NEWNAME FOR TEMPFILE 1 TO '/oradatat/temp01';
DUPLICATE TARGET DATABASE TO dupdb
  SKIP TABLESPACE tools
  LOGFILE
    GROUP 1 ('/duplogs/redo01a.log','/duplogs/redo01b.log') SIZE 4M REUSE,
    GROUP 2 ('/duplogs/redo02a.log','/duplogs/redo02b.log') SIZE 4M REUSE;
}</code></pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA__GUID-EB974396-00C3-43A6-B6A1-A532F3A39E50">
                           <p class="titleinexample">Example 26-7 Using the SET NEWNAME Command to Create Files in an ASM Disk Group</p>
                           <p>This example uses the <code class="codeph">SET NEWNAME</code> command to direct individual data files, temp files, or tablespaces to a specified ASM disk group.
                           </p><pre class="pre codeblock"><code>RUN
{
SET NEWNAME FOR DATAFILE 1 TO "+DGROUP1";
SET NEWNAME FOR DATAFILE 2 TO "+DGROUP2";
.
.
.
DUPLICATE TARGET DATABASE
TO dupdb
FROM ACTIVE DATABASE
SPFILE SET DB_CREATE_FILE_DEST +DGROUP3;
}</code></pre></div>
                        <!-- class="example" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA__GUID-CB28FE6F-6660-4DE1-82C2-479CB07CA833">
                              <p class="notep1">See Also:</p>
                              <p><a href="rman-duplicating-databases-advanced.html#GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2" title="Use the SET NEWNAME command before you execute the DUPLICATE command to name duplicate data files.">Using the SET NEWNAME Command to Name File System Data Files and Temp Files</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-086A9599-15DB-4441-8E02-A939CBC5FF96" name="GUID-086A9599-15DB-4441-8E02-A939CBC5FF96"></a><h5 id="BRADV-GUID-086A9599-15DB-4441-8E02-A939CBC5FF96" class="sect5"><span class="enumeration_section">26.1.2.5 </span>Using the DB_FILE_NAME_CONVERT Parameter to Generate Names for Non-OMF or ASM Data Files
                     </h5>
                     <div>
                        <p>In addition to using the <code class="codeph">SET NEWNAME</code> or <code class="codeph">CONFIGURE AUXNAME</code> commands, you can use the <code class="codeph">DB_FILE_NAME_CONVERT</code> parameter to transform target file names. You can either specify the <code class="codeph">DB_FILE_NAME_CONVERT</code> option in the <code class="codeph">DUPLICATE</code> command or you can set it in the initialization parameter file of the auxiliary instance.
                        </p>
                        <div class="section">
                           <p> For example, you can change the target file name from the <code class="codeph">/oracle/</code> directory to the <code class="codeph">/dup/oracle/</code> directory. The <code class="codeph">DB_FILE_NAME_CONVERT</code> parameter allows you to specify multiple conversion file name pairs. It can also be used to produce names for data files and temp files.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-086A9599-15DB-4441-8E02-A939CBC5FF96__GUID-412E315A-28C3-4CFE-A7EC-6D8A9099FD17">Restrictions of the DB_FILE_NAME_CONVERT Parameter</p>
                           <p>You cannot use the <code class="codeph">DB_FILE_NAME_CONVERT</code> option of the <code class="codeph">DUPLICATE</code> command to control generation of new names for files at the duplicate instance that are in the OMF format at the source database instance.
                           </p>
                           <div class="infoboxnotealso" id="GUID-086A9599-15DB-4441-8E02-A939CBC5FF96__GUID-78B27DE3-F3B1-445C-A2A6-B399B5313EFB">
                              <p class="notep1">See Also:</p>
                              <p><a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-A11B8766-5078-433F-927E-D77314236755" name="GUID-A11B8766-5078-433F-927E-D77314236755"></a><h5 id="BRADV-GUID-A11B8766-5078-433F-927E-D77314236755" class="sect5"><span class="enumeration_section">26.1.2.6 </span>Using the LOG_FILE_NAME_CONVERT Parameter to Generate Names for Non-OMF or ASM Log Files
                     </h5>
                     <div>
                        <p>If the <code class="codeph">LOG_FILE</code> clause has been omitted and none of the OMF initialization parameters <code class="codeph">DB_CREATE_FILE_DEST</code>, <code class="codeph">DB_CREATE_ONLINE_DEST_n</code>, or <code class="codeph">DB_RECOVERY_FILE_DEST</code> are specified, then the <code class="codeph">LOG_FILE_NAME_CONVERT</code> parameter can transform target file names. This works in the same way that the <code class="codeph">DB_FILE_NAME_CONVERT</code> parameter does to transform target file names from <code class="codeph">log_*</code> to <code class="codeph">duplog_*</code>. 
                        </p>
                        <div class="section">
                           <p>You can specify multiple conversion file name pairs with this parameter. When you specify the <code class="codeph">LOG_FILE_NAME_CONVERT</code> parameter, RMAN uses the <code class="codeph">REUSE</code> parameter when creating the online redo logs. If an online redo log file exists at the named location and is of the correct size, then it is reused for the duplication process.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-A11B8766-5078-433F-927E-D77314236755__GUID-C845CC21-83E2-4BD5-A37F-18F34696740A">Restrictions of the LOG_FILE_NAME_CONVERT Parameter</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p> If you set OMF initialization parameters, do not specify the <code class="codeph">LOG_FILE_NAME_CONVERT</code> parameter.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">LOG_FILE_NAME_CONVERT</code> parameter cannot be specified as a clause in the <code class="codeph">DUPLICATE</code> command, it can only be specified in the initialization parameter of the auxiliary instance.
                                 </p>
                              </li>
                              <li>
                                 <p>You cannot use the <code class="codeph">LOG_FILE_NAME_CONVERT</code> initialization parameter to control generation of new names for files at the duplicate instance that are in the OMF format at the source database instance. 
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" name="GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13"></a><h3 id="BRADV-GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" class="sect3"><span class="enumeration_section">26.2 </span>Making Disk Backups Accessible Without Shared Disk
               </h3>
               <div>
                  <p>You can use the shared disk technique to make backups available to the auxiliary instance. When NFS or shared disk is not an option, then the path that stores the backups must exist on <span class="italic">both</span> the source and destination hosts, unless the <code class="codeph">BACKUP LOCATION</code> option is used for the <code class="codeph">DUPLICATE</code> command without a target or recovery catalog connection.
                  </p>
                  <div class="section">
                     <p>Assume that you maintain two hosts, <code class="codeph">srchost</code> and <code class="codeph">dsthost</code>. The database on <code class="codeph">srchost</code> is <code class="codeph">srcdb</code>. The RMAN backups of <code class="codeph">srcdb</code> reside in the <code class="codeph">/dsk1/bkp</code> directory on host <code class="codeph">srchost</code>. The directory <code class="codeph">/dsk1/bkp</code> is in use on the destination host, so you intend to store backups in the <code class="codeph">/dsk2/dup</code> directory on the destination host. 
                     </p>
                     <p>To transfer the backups from the source host to the destination host:</p>
                     <ol>
                        <li>
                           <p>Create a directory in the source host that has the same name as the directory on the destination host that contains the backups.</p>
                           <p>For example, if you intend to store the RMAN backups in the <code class="codeph">/dsk2/dup</code> directory on the destination host, then create the <code class="codeph">/dsk2/dup</code> directory on the source host.
                           </p>
                        </li>
                        <li>
                           <div class="p">On the source host, copy the backups to the directory created in the previous step, and then catalog the backups. You can use either of the following approaches:
                              <ul style="list-style-type: disc;">
                                 <li>Connect RMAN to the source database as <code class="codeph">TARGET</code> and use the <code class="codeph">BACKUP</code> command to back up the backups. For example, use the <code class="codeph">BACKUP COPY OF DATABASE</code> command to copy the backups in <code class="codeph">/dsk1/bkp</code> on the source host to <code class="codeph">/dsk2/dup</code> on the source host. In this case, RMAN automatically catalogs the backups in the new location. If you are duplicating a PDB, then use the <code class="codeph">PLUGGABLE DATABASE</code> syntax of the <code class="codeph">BACKUP COPY OF</code> command to copy only the backups of the PDB.
                                 </li>
                                 <li>Use an operating system utility to copy the backups in the <code class="codeph">/dsk1/bkp</code> directory on the source host to the <code class="codeph">/dsk2/dup</code> directory on the source host. Afterward, connect RMAN to the source database as <code class="codeph">TARGET</code> and use the <code class="codeph">CATALOG</code> command to update the source control file with the location of the manually transferred backups.
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p>Manually transfer the backups in the new directory on the source host to the identically named directory on the destination host.</p>
                           <p>For example, use FTP to transfer the backups in the <code class="codeph">/dsk2/dup</code> directory on the source host to the <code class="codeph">/dsk2/dup</code> directory on the destination host.
                           </p>
                        </li>
                     </ol>The auxiliary channel can search for backups in the <code class="codeph">/dsk2/dup</code> directory on the destination host and restore them.
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>