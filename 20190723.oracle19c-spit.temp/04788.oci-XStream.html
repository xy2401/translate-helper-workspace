<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>OCI XStream Functions</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-call-interface-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-14T08:46:00-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96204-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="handler-and-descriptor-attributes.html" title="Previous" type="text/html">
      <link rel="next" href="intro-to-XStream-functions.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Oracle Call Interface Programmer's Guide">
    <meta name="dcterms.isVersionOf" content="LNOCI">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="handler-and-descriptor-attributes.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="intro-to-XStream-functions.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">OCI XStream Functions </li>
            </ol>
            <a id="GUID-527DB451-F87E-479A-8F35-25FD8D01E2EC" name="GUID-527DB451-F87E-479A-8F35-25FD8D01E2EC"></a><a id="LNOCI72914"></a>
            
            <h2 id="LNOCI-GUID-527DB451-F87E-479A-8F35-25FD8D01E2EC" class="sect2"><span class="enumeration_chapter">35 </span>OCI XStream Functions 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter describes the XStream functions for OCI.</p>
               <p>A row logical change record (LCR) is used to encapsulate each row change. It includes the schema name, table name, DML operation, and the column values. For update operations, both before and after column values are included. The column data is in the format specified by the "Program Variable" column in <a href="oci-XStream-functions.html#GUID-80F5BEE8-EC26-426F-A114-9F7B7AFD497E__BABHDBAJ" title="This table has 4 columns. Column 1 is the table column data type, column 2 is the LCR column data type, column 3 is the program variable, and column 4 is the OCI conversion function name.">Table 35-3</a>. Character columns are converted to the client's character set.
               </p>
               <p>A DDL LCR is used to encapsulate each DDL change. It includes the object name, the DDL text, and the DDL command, for example, <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> or <code class="codeph">TRUNCATE</code> <code class="codeph">TABLE</code>. See <a href="handle-and-descriptor-attributes.html#GUID-A251CF91-EB9F-4DBC-8BB8-FB5EA92C20DE__CACEIFFF" title="This table has 2 long columns going from left to right that appear as 6 columns. Column 1 is the SQL function code of the SQL command and column 2 is its corresponding SQL statement. Column 3 is the SQL function code of the SQL command and column 4 is its corresponding SQL statement. Column 5 is the SQL function code of the SQL command and column 6 is its corresponding SQL statement.">Table A-1</a> for a list of DDL command codes.
               </p>
               <div class="infoboxnotealso" id="GUID-527DB451-F87E-479A-8F35-25FD8D01E2EC__GUID-C72AE714-3901-4261-973E-2C19A77700AD">
                  <p class="notep1">See Also:</p>
                  <p><a href="../nlspg/OCI-programming-in-global-environment.html#NLSPG451" target="_blank"><span><cite>Oracle Database Globalization Support Guide</cite></span></a> for more information about NLS settings.
                  </p>
                  <p>XStream sample programs are found in <code class="codeph">xstream/oci</code> under the <code class="codeph">$ORACLE_HOME/demo</code> directory.
                  </p>
               </div>
               <p>Each LCR also has a transaction ID and position. For transactions captured outside Oracle databases, any byte-comparable <code class="codeph">RAW</code> array can be used as the LCR position, if the position of each LCR in the stream is strictly increasing.
               </p>
               <p>This chapter contains the topic:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="oci-XStream.html#GUID-EAC548D6-2769-4138-B90D-CE42D4F29F22" title="XStream Out allows a remote client to attach to an outbound server (a Streams apply process) and extract row changes in the form of Logical Change Records (LCRs).Describes characteristics of an LCR stream.If the outbound server or the client aborts abnormally, the connection between the two is automatically broken. The client needs to maintain the processed low position to properly recover after a restart.To replicate non-Oracle data into Oracle databases use XStream In which allows a remote client to attach to an inbound server (a Streams apply process) and send row and DDL changes in the form of LCRs.The processed low position is the position below which the inbound server no longer requires any LCRs.Stream position refers to the position of an LCR in a given LCR stream.Describes the security characteristics of XStreams.">About Using the XStream Interface</a></p>
                  </li>
                  <li>
                     <p><a href="intro-to-XStream-functions.html#GUID-9462F061-7482-43E1-809C-66D69A68CD64" title="Lists and describes the conventions used to describe the functions.">Introduction to XStream Functions</a></p>
                  </li>
                  <li>
                     <p><a href="oci-XStream-functions.html#GUID-FEF426F1-90C1-49DB-ADCD-C7CF298F66B8" title="Lists and describes OCI XStream Functions.">OCI XStream Functions</a></p>
                  </li>
               </ul>
            </div>
            <div class="props_rev_3"><a id="GUID-EAC548D6-2769-4138-B90D-CE42D4F29F22" name="GUID-EAC548D6-2769-4138-B90D-CE42D4F29F22"></a><h3 id="LNOCI-GUID-EAC548D6-2769-4138-B90D-CE42D4F29F22" class="sect3"><span class="enumeration_section">35.1 </span>About Using the XStream Interface
               </h3>
               <div>
                  <p>Since Oracle Database 11g Release 2, Oracle Streams provides enhanced APIs, known as eXtended Streams (XStream) Out and XStream In, to enable high performance, near real-time information-sharing infrastructure between Oracle databases and non-Oracle databases, non-RDBMS Oracle products, file systems, third party software applications, and so on.</p>
                  <p>XStream is built on top of Streams infrastructure.</p>
                  <div class="p">This section includes the following topics:
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="oci-XStream.html#GUID-9E682886-1812-4E18-B99F-1FCF2F6C0A54" title="XStream Out allows a remote client to attach to an outbound server (a Streams apply process) and extract row changes in the form of Logical Change Records (LCRs).">XStream Out</a></p>
                        </li>
                        <li>
                           <p><a href="oci-XStream.html#GUID-A8AFCE7F-E475-4C75-AC3B-5A37B6F83B90" title="To replicate non-Oracle data into Oracle databases use XStream In which allows a remote client to attach to an inbound server (a Streams apply process) and send row and DDL changes in the form of LCRs.">XStream In</a></p>
                        </li>
                        <li>
                           <p><a href="oci-XStream.html#GUID-CFF27EA8-C0B5-4B49-8966-52AC4AD45F8E" title="Describes the security characteristics of XStreams.">Security of XStreams</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-EAC548D6-2769-4138-B90D-CE42D4F29F22__GUID-F201BA01-D9AC-44B7-9C9E-D7C3F1C728C2">
                     <p class="notep1">See Also:</p>
                     <p> <a href="oci-XStream.html#GUID-527DB451-F87E-479A-8F35-25FD8D01E2EC" title="XStream Out allows a remote client to attach to an outbound server (a Streams apply process) and extract row changes in the form of Logical Change Records (LCRs).Describes characteristics of an LCR stream.If the outbound server or the client aborts abnormally, the connection between the two is automatically broken. The client needs to maintain the processed low position to properly recover after a restart.To replicate non-Oracle data into Oracle databases use XStream In which allows a remote client to attach to an inbound server (a Streams apply process) and send row and DDL changes in the form of LCRs.The processed low position is the position below which the inbound server no longer requires any LCRs.Stream position refers to the position of an LCR in a given LCR stream.Describes the security characteristics of XStreams.">OCI XStream Functions</a></p>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-9E682886-1812-4E18-B99F-1FCF2F6C0A54" name="GUID-9E682886-1812-4E18-B99F-1FCF2F6C0A54"></a><h4 id="LNOCI-GUID-9E682886-1812-4E18-B99F-1FCF2F6C0A54" class="sect4"><span class="enumeration_section">35.1.1 </span>XStream Out
                  </h4>
                  <div>
                     <p>XStream Out allows a remote client to attach to an outbound server (a Streams apply process) and extract row changes in the form of Logical Change Records (LCRs).</p>
                     <p>To use XStream Out, a capture and an apply process must be created similar to other Streams setup. All data types supported by Oracle Streams including LOB, <code class="codeph">LONG</code>, and <code class="codeph">XMLType</code> are supported by XStreams. Such an apply process is called an outbound server. The capture and the outbound server may or may not be on the same database instance. After the capture and the outbound server have started, row changes will be captured and sent to the outbound server. An external client can then connect to this outbound server using OCI. After the connection is established, the client can loop waiting for LCRs from the outbound server. The client can register a client-side callback to be invoked each time an LCR is received. At anytime, the client can detach from the outbound server as needed. Upon restart, the outbound server knows where in the redo stream to start streaming LCRs to the client.
                     </p>
                     <div class="p">This section includes the following topics:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="oci-XStream.html#GUID-E3CA74B0-6F37-4531-A5BE-1EFCFEFE6837" title="Describes characteristics of an LCR stream.">LCR Streams</a></p>
                           </li>
                           <li>
                              <p><a href="oci-XStream.html#GUID-3D9E7038-EB91-4E74-95AF-9DDB3328222A" title="If the outbound server or the client aborts abnormally, the connection between the two is automatically broken. The client needs to maintain the processed low position to properly recover after a restart.">The Processed Low Position and Restart Considerations</a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-9E682886-1812-4E18-B99F-1FCF2F6C0A54__GUID-FDEEA92B-B682-494A-954C-2D3739372FC8">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../xstrm/introduction-to-xstream.html#XSTRM1086" target="_blank"><span><cite>Oracle Database XStream Guide</cite></span></a> for more details of XStreams concepts
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-E3CA74B0-6F37-4531-A5BE-1EFCFEFE6837" name="GUID-E3CA74B0-6F37-4531-A5BE-1EFCFEFE6837"></a><h5 id="LNOCI-GUID-E3CA74B0-6F37-4531-A5BE-1EFCFEFE6837" class="sect5"><span class="enumeration_section">35.1.1.1 </span>LCR Streams
                     </h5>
                     <div>
                        <p>Describes characteristics of an LCR stream.</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>An LCR stream must be repeatable.</p>
                           </li>
                           <li>
                              <p>An LCR stream must contain a list of assembled and committed transactions.</p>
                           </li>
                           <li>
                              <p>LCRs from one transaction are contiguous. There is no interleaving of transactions in the LCR stream.</p>
                           </li>
                           <li>
                              <p>Each transaction within an LCR stream must have an ordered list of LCRs and a transaction ID.</p>
                           </li>
                           <li>
                              <p>The last LCR in each transaction must be a commit LCR.</p>
                           </li>
                           <li>
                              <p>Each LCR must have a unique position.</p>
                           </li>
                           <li>
                              <p>The position of all LCRs within a single transaction and across transactions must be strictly increasing.</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-3D9E7038-EB91-4E74-95AF-9DDB3328222A" name="GUID-3D9E7038-EB91-4E74-95AF-9DDB3328222A"></a><h5 id="LNOCI-GUID-3D9E7038-EB91-4E74-95AF-9DDB3328222A" class="sect5"><span class="enumeration_section">35.1.1.2 </span>The Processed Low Position and Restart Considerations
                     </h5>
                     <div>
                        <p>If the outbound server or the client aborts abnormally, the connection between the two is automatically broken. The client needs to maintain the processed low position to properly recover after a restart.</p>
                        <p>The processed low position is a position below which all LCRs have been processed by the client. This position should be maintained by the client while applying each transaction. Periodically this position is sent to the server while the client executes XStream Out APIs. This position indicates to the server that the client has processed all LCRs below or equal to this position; thus, the server can purge redo logs that are no longer needed.</p>
                        <p>Upon restart, the client must re-attach to the outbound server. During the attach call, the client can notify the outbound server of the last position received by the client. The outbound server then sends LCRs with position greater than this last position. If the client does not specify the last position (that is, a <code class="codeph">NULL</code> is specified), the outbound server will retrieve the processed low position from its system tables and derive the starting position to mine the redo logs. It will send to the client the LCRs with position greater than this processed low position. 
                        </p>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-A8AFCE7F-E475-4C75-AC3B-5A37B6F83B90" name="GUID-A8AFCE7F-E475-4C75-AC3B-5A37B6F83B90"></a><h4 id="LNOCI-GUID-A8AFCE7F-E475-4C75-AC3B-5A37B6F83B90" class="sect4"><span class="enumeration_section">35.1.2 </span>XStream In
                  </h4>
                  <div>
                     <p>To replicate non-Oracle data into Oracle databases use XStream In which allows a remote client to attach to an inbound server (a Streams apply process) and send row and DDL changes in the form of LCRs.</p>
                     <p>An external client application connects to the inbound server using OCI. After the connection is established, the client application acts as the capture agent for the inbound server by streaming LCRs to it. A client application can attach to only one inbound server per database connection. Each inbound server only allows one client attaching to it.</p>
                     <p>XStream In uses the following features of Oracle Streams:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>High performance processing of DML changes using an apply process and, optionally, apply process parallelism.</p>
                        </li>
                        <li>
                           <p>Apply process features such as SQL generation, conflict detection and resolution, error handling, and customized processing with apply handlers.</p>
                        </li>
                        <li>
                           <p>Streaming network transmission of information with minimal network round trips.</p>
                        </li>
                     </ul>
                     <p>XStream In supports all of the data types that are supported by Oracle Streams, including LOBs, <code class="codeph">LONG</code>, <code class="codeph">LONG</code> <code class="codeph">RAW</code>, and <code class="codeph">XMLType</code>. A client application sends LOB and <code class="codeph">XMLType</code> data to the inbound server in chunks. Several chunks make up a single column value of LOB or <code class="codeph">XMLType</code>.
                     </p>
                     <div class="p">This section includes the following topics:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="oci-XStream.html#GUID-C4406AE9-9D42-49F8-B4B7-C8942A410D52" title="The processed low position is the position below which the inbound server no longer requires any LCRs.">Processed Low Position and Restart Ability</a></p>
                           </li>
                           <li>
                              <p><a href="oci-XStream.html#GUID-B5079754-01CC-4E34-9398-9A062B6F0102" title="Stream position refers to the position of an LCR in a given LCR stream.">Stream Position</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-C4406AE9-9D42-49F8-B4B7-C8942A410D52" name="GUID-C4406AE9-9D42-49F8-B4B7-C8942A410D52"></a><h5 id="LNOCI-GUID-C4406AE9-9D42-49F8-B4B7-C8942A410D52" class="sect5"><span class="enumeration_section">35.1.2.1 </span>Processed Low Position and Restart Ability
                     </h5>
                     <div>
                        <p>The processed low position is the position below which the inbound server no longer requires any LCRs.</p>
                        <p>This position corresponds with the oldest SCN for an Oracle Streams apply process that applies changes captured by a capture process.</p>
                        <p>The processed low position indicates that the LCRs less than or equal to this position have been processed by the inbound server. If the client re-attaches to the inbound server, it only needs to send LCRs greater than the processed low position because the inbound server discards any LCRs that are less than or equal to the processed low position.</p>
                        <p>If the client application aborts abnormally, then the connection between the client application and the inbound server is automatically broken. Upon restart, the client application retrieves the processed low position from the inbound server and instructs its capture agent to retrieve changes starting from this processed low position.</p>
                        <p>To limit the recovery time of a client application using the XStream In interface, the client application can send activity, such as empty transactions, periodically to the inbound server. When there are no LCRs to send to the server, the client can send a row LCR with a commit directive to advance the inbound server's processed low position. This activity acts as an acknowledgement so that the inbound server's processed low position can be advanced. The LCR stream sent to an inbound server must follow the LCR stream properties for XStream Out defined above.</p>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-B5079754-01CC-4E34-9398-9A062B6F0102" name="GUID-B5079754-01CC-4E34-9398-9A062B6F0102"></a><h5 id="LNOCI-GUID-B5079754-01CC-4E34-9398-9A062B6F0102" class="sect5"><span class="enumeration_section">35.1.2.2 </span>Stream Position
                     </h5>
                     <div>
                        <p>Stream position refers to the position of an LCR in a given LCR stream.</p>
                        <p>For transactions captured outside Oracle databases the stream position must be encoded in certain format (for example, base-16 encoding) that supports byte comparison. The stream position is key to the total order of transaction stream sent by clients using the XStream In interface.</p>
                     </div>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-CFF27EA8-C0B5-4B49-8966-52AC4AD45F8E" name="GUID-CFF27EA8-C0B5-4B49-8966-52AC4AD45F8E"></a><h4 id="LNOCI-GUID-CFF27EA8-C0B5-4B49-8966-52AC4AD45F8E" class="sect4"><span class="enumeration_section">35.1.3 </span>Security of XStreams
                  </h4>
                  <div>
                     <p>Describes the security characteristics of XStreams.</p>
                     <p>XStream Out allows regular users to receive LCRs without requiring system level privileges. System level privileges, such as DBA role, are required to configure XStream Out. The user who configures XStream Out can specify a regular user as the connect user who can attach to an outbound server to receive LCRs.</p>
                     <p>XStream In allows regular users to update tables in its own schema without requiring system level privileges (for example, DBA) to configure XStream In.</p>
                     <p>XStream cannot assume that the connected user to the inbound or outbound server is trusted.</p>
                     <p>OCI clients must connect to an Oracle database prior to attaching to an XStream outbound or inbound server created on that database. The connected user must be the same as the <code class="codeph">connect_user</code> configured for the attached outbound server or the <code class="codeph">apply_user</code> configured for the attached inbound server; otherwise, an error is raised.
                     </p>
                     <div class="infoboxnotealso" id="GUID-CFF27EA8-C0B5-4B49-8966-52AC4AD45F8E__GUID-91D5CCB2-56DD-43D9-B261-3C2CC7F67735">
                        <p class="notep1">See Also:</p>
                        <p><a href="../xstrm/configuring-xstream-out.html#XSTRM1496" target="_blank"><span><cite>Oracle Database XStream Guide</cite></span></a> for more about configuring Oracle XStreams
                        </p>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>