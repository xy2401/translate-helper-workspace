<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>3.14.6。�使用函数作为测试用例的数据</title>
<link rel="stylesheet" type="text/css" href="../../css/style.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="../index.html" title="Jubula User Manual">
<link rel="up" href="ch03s14.html" title="3.14.�Working with test data">
<link rel="prev" href="ch03s14s05.html" title="3.14.5.�Using variables as data for Test Cases">
<link rel="next" href="ch03s14s07.html" title="3.14.7.�Concatenating (combining) parameters">
</head>
<body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">3.14.6。�使用函数作为测试用例的数据</th></tr>
<tr>
<td width="20%" align="left">
<a href="ch03s14s05.html" accesskey="p">上一页</a> �</td>
<th width="60%" align="center">3.14。�使用测试数据</th>
<td width="20%" align="right">� <a href="ch03s14s07.html" accesskey="n">下一步</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="breadcrumbs" xmlns:d="http://docbook.org/ns/docbook">
<span class="breadcrumb-link"><a href="../index.html">Jubula用户手册</a></span> &gt; <span class="breadcrumb-link"><a href="ch03.html">任务</a></span> &gt; <span class="breadcrumb-link"><a href="ch03s14.html">使用测试数据</a></span> &gt; <span class="breadcrumb-node">使用函数作为</span> <span class="breadcrumb-link"><a href="ch03s14.html">测试用例的数据</a></span>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="using-functions-as-data-for-test-cases"></a> 3.14.6。�使用函数作为测试用例的数据</h3></div></div></div>
<a name="using-functions-as-data-for-test-cases.guidancerDataSetViewContextId"></a><a name="using-functions-as-data-for-test-cases.guidancerPropertiesViewContextId"></a><a name="using-functions-as-data-for-test-cases.guidancerCentralTestDataEditorContextId"></a><p>您可以使用<span class="emphasis"><em>函数</em></span>自行计算特定值而无需输入结果。有一些特定的功能可以开箱即用，还可以添加其他功能。
  </p>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="syntax-for-functions"></a> 3.14.6.1。�函数的语法</h4></div></div></div>
<p>用于引入功能的标志是问号： <span class="input">？</span>（没有引号）。
    </p>
<p>在符号之后，您必须输入函数的名称，后跟函数所需的参数，例如：</p>
<p>
      <code class="literal">?add(arg1,arg2)</code>
    </p>
<p>参数以逗号分隔，并放在圆括号内。
    </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="pre-defined-functions"></a> 3.14.6.2。�预定义的功能</h4></div></div></div>
<p>ITE中可直接使用以下功能：</p>
<p>
      <span class="strong"><strong>数学函数</strong></span><br xmlns:d="http://docbook.org/ns/docbook">以下函数将结果显示为十进制数，例如1.0,1.2等。</p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term">加</span></dt>
<dd><p>将0或更多数字添加到0，例如： <span class="input">？加（1,2）</span> 。
          </p></dd>
<dt><span class="term">子</span></dt>
<dd><p>从第一个数字中减去第二个数字： <span class="input">？sub（3,2）</span> 。<br xmlns:d="http://docbook.org/ns/docbook">此功能仅接受两个数字。
          </p></dd>
<dt><span class="term">MULT</span></dt>
<dd><p>将0或更多数字乘以1，例如： <span class="input">？mult（2,4）</span> 。
          </p></dd>
<dt><span class="term">DIV</span></dt>
<dd><p>将第一个数字除以第二个数字： <span class="input">？div（2,1）</span> 。<br xmlns:d="http://docbook.org/ns/docbook">此功能仅接受两个数字。
          </p></dd>
<dt><span class="term">TRUNC</span></dt>
<dd><p>采用两个参数，要截断的小数和要截断小数的精度（作为整数）。使用<span class="input">0</span>将数字切除为无小数位（即接收一个普通整数），并使用<span class="input">1</span>将小数切成一位小数位等： <span class="input">？trunc（2.396,0）</span>给出<span class="input">2</span>和<span class="input">？trunc（2.789,1）</span>给出<span class="input">2.7</span> 。
          </p></dd>
<dt><span class="term">回合</span></dt>
<dd>
<p>采用两个参数，小数要舍入，精度（作为整数）舍入到。此函数使用<span class="emphasis"><em>半向</em></span>舍入来舍入数字，以便如果舍入后的最后小数位数为5或更高，则最终数字将增加1，例如： <span class="input">？圆（2.56,1）</span>给出<span class="input">2.6</span> 。如果舍入后的最终数字是4或更少，则没有增量，例如。
            <span class="input">？圆（2.43,1）</span>给出<span class="input">2.4</span> 。
          </p>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="102" height="89" src="../images/img1.jpg"></td>
<td class="topbotline"><span class="strong"><strong>目前只能使用以小数点<span class="emphasis"><em>周期</em></span>或<span class="emphasis"><em>fullstop</em></span> （ <span class="input">。</span> ）格式化的数字。可能不会使用数千个分离器。例如， <span class="input">1.5</span>被接受，但<span class="input">1,5</span>不被接受。 <span class="input">1000</span>可以进入，但<span class="input">1000</span>不能。输入<span class="input">1.000</span>相当于输入<span class="input">1</span> 。您可以使用<span class="input">formatNumber</span>函数将数字转换为整数或更改数字所具有的小数点数。
          </strong></span></td>
</tr></tbody>
</table>
</dd>
<dt><span class="term">formatNumber</span></dt>
<dd><p>采用两个参数，要格式化的小数和格式化数字应包含的小数位数。使用此功能时，数字或小数位不会舍入。
            <span class="input">？formatNumber（15.43,0）</span>给出<span class="input">15</span> 。 <span class="input">？formatNumber（15.4,3）</span>给出<span class="input">15.4</span> ，不会附加零。 <span class="input">？formatNumber（15.4356,2）</span>给出<span class="input">15.43</span> 。
          </p></dd>
</dl></div>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>在负数周围使用单引号，例如'-0.5'。
    </strong></span></td>
</tr></tbody>
</table>
<p>
      <span class="strong"><strong>日期功能</strong></span>
    </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term">现在</span></dt>
<dd><p>以当前格式保存当前日期，该格式可用作formatDate和modifyDate函数的基础。这个函数没有参数： <span class="input">？现在（）</span> 。
          </p></dd>
<dt><span class="term">formatDate</span></dt>
<dd><p>将日期设置为特定格式。要格式化的日期作为第一个参数输入，后跟格式字符串，例如<span class="input">？formatDate（？now（），dd-MM-yyyy）</span> 。这里可以使用的格式是Java中SimpleDateFormat类的格式。
          </p></dd>
<dt><span class="term">parseDate</span></dt>
<dd><p>读取一个日期值并根据给定的格式字符串将其解析为内部格式（即应该如何理解日期）。第一个参数是日期，第二个参数是格式字符串<span class="input">？parseDate（2011.06.25，YYYY。MM.dd）</span> 。在阅读和使用AUT中显示的日期时，应使用此功能。</p></dd>
<dt><span class="term">modifyDate</span></dt>
<dd><p>此功能可以将天（d），月（M），年（y），小时（h），分钟（i），秒（s）和毫秒（j）添加到给定日期。必须首先解析日期（即使用parseDate），以便使用正确的内部格式。这个函数有两个参数：第一个是要修改的日期，第二个是要执行的修改，例如<span class="input">？modifyDate（？now（），1d）</span> 。加法作为正整数输入（但没有加号，例如1d，1M，1y），减法作为负整数输入，例如-1d，-1M，-1y，-1i。
          </p></dd>
</dl></div>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>如果您想将日期函数的结果用作测试数据的一部分（即输入或检查），那么您很可能需要在已执行的任何日期修改上使用formatDate。
    </strong></span></td>
</tr></tbody>
</table>
<p>
      <span class="strong"><strong>测试功能</strong></span>
    </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term">getNodeAttribute</span></dt>
<dd><p>读取解析此函数的节点（例如测试用例，测试步骤）上的值，并将其用作测试步骤的数据。它有四个可能的参数， <span class="emphasis"><em>name</em></span>读取节点的名称， <span class="emphasis"><em>comment</em></span>读取节点上的注释， <span class="emphasis"><em>description</em></span>读取节点上的原始（非呈现）描述， <span class="emphasis"><em>task.id</em></span>读取节点上的任务ID。如果内容为空，则使用的值为<span class="emphasis"><em>null</em></span> 。如果您在此重用位置覆盖了名称或注释，则会使用这些新详细信息。
          </p></dd>
<dt><span class="term">getCentralTestDataSetValue</span></dt>
<dd><p>使用此功能可以访问保存在中央数据集中的值。这使您可以将已集中定义的值与本地使用的值组合，或者允许组合测试中不同中央数据集的值。它根据您定义为键的列中的值以及要在其中搜索所需值的列，在特定中央数据集中查找单个单元格。它需要四个参数：要搜索的中央数据集的名称，要用作“键”的列的名称（如果需要，可以将列命名为KEY），键列中的值（指定行）以及所需数据单元所在的列。
          </p></dd>
</dl></div>
<p>
      <span class="strong"><strong>getCentralTestDataSetValue函数的示例</strong></span><br xmlns:d="http://docbook.org/ns/docbook">可以使用此示例中央数据集（例如<span class="emphasis"><em>Customer）</em></span>来举例说明从中央数据集检索数据的功能：</p>
<p>
      </p>
<div class="informaltable"><table border="1">
<colgroup>
<col align="center">
<col align="center">
</colgroup>
<thead><tr>
<th align="center">客户类型</th>
<th align="center">顾客姓名</th>
</tr></thead>
<tbody>
<tr>
<td align="center">NormalUser</td>
<td align="center">Bob Normal</td>
</tr>
<tr>
<td align="center">超级用户</td>
<td align="center">爱丽丝超级</td>
</tr>
<tr>
<td align="center">SupportUser</td>
<td align="center">约翰支持</td>
</tr>
</tbody>
</table></div>
<p>
    </p>
<p>要使用客户类型选择客户名称，您应输入：</p>
<div class="blockquote"><blockquote class="blockquote"><p>
        <span class="strong"><strong>？getCentralTestDataSetValue<br xmlns:d="http://docbook.org/ns/docbook">（客户，CUSTOMER_TYPE，超级用户，CUSTOMER_NAME）</strong></span>
      </p></blockquote></div>
<p>这将查看名为<span class="emphasis"><em>Customer</em></span>的中央数据集，在<span class="emphasis"><em>CUSTOMER_TYPE</em></span>列中找到值<span class="emphasis"><em>SuperUser</em></span> ，并使用该行选择<span class="emphasis"><em>CUSTOMER_NAME</em></span>列中的单元格 -  Alice Super。
    </p>
<p>如果使用此功能，则可以尝试使用属性或数据集视图中的跳转到中央测试数据集命令跳转到引用的数据集（ <a class="xref" href="../userInterface/ch05s05s02.html" title="5.5.2。�属性视图">Section�5.5.2，“属性视图”</a> ， <a class="xref" href="../userInterface/ch05s05s03.html" title="5.5.3。�数据集视图">Section� 5.5.3，“数据集视图”</a> ）。
    </p>
<p>
      <span class="strong"><strong>来自其他库的包装函数</strong></span><br xmlns:d="http://docbook.org/ns/docbook">您还可以在测试中使用以下功能。有关它们的完整文档，请参阅相应的库。
    </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term">randomInt（独占最大值）</span></dt>
<dd><p>使用此函数生成一个随机整数，但不包括您指定的值。该函数来自<span class="emphasis"><em>org.apache.commons.lang.math。RandomUtils</em></span>
          </p></dd>
<dt><span class="term">replaceAll（字符串，正则表达式，替换）</span></dt>
<dd><p>使用此函数可以用其他内容替换指定的字符串的所有部分。执行替换的<span class="emphasis"><em>字符串</em></span>作为<span class="emphasis"><em>字符串</em></span>输入，要替换的<span class="emphasis"><em>字符串</em></span>的部分由<span class="emphasis"><em>正则表达式</em></span>定义，替换它的字符串作为<span class="emphasis"><em>替换</em></span> 。该函数来自<span class="emphasis"><em>java.util.regex</em></span> 。
          </p></dd>
<dt><span class="term">UUID（）</span></dt>
<dd><p>此函数生成通用唯一标识符。该函数来自<span class="emphasis"><em>java.util。UUID</em></span> 。</p></dd>
<dt><span class="term">base64Encode（串）</span></dt>
<dd><p>此函数将字符串编码为base 64。该函数来自<span class="emphasis"><em>org.apache.commons.codec.binary。Base64</em></span> 。
          </p></dd>
<dt><span class="term">base64Decode（串）</span></dt>
<dd><p>此函数解码基数为64的字符串。该函数来自<span class="emphasis"><em>org.apache.commons.codec.binary。Base64</em></span> 。
          </p></dd>
<dt><span class="term">进行urlencode（串）</span></dt>
<dd><p>此函数对（使用UTF-8）字符串进行编码，以便在URL中进一步使用。</p></dd>
<dt><span class="term">urlDecode（串）</span></dt>
<dd><p>此函数从URL解码（使用UTF-8）字符串。</p></dd>
</dl></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="embedding-functions-in-other-functions"></a> 3.14.6.3。�嵌入功能在其他功能中</h4></div></div></div>
<p>函数可以作为参数添加到其他函数中。例如，如果你想使用减法的结果作为你的加法的第一个参数，你可以像这样写：</p>
<p>
      <span class="input">？加（？子（2,1），1）</span>
    </p>
<p>结果为<span class="input">1.0 + 1</span> ，即<span class="input">2.0</span>
    </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="useful-examples-for-functions"></a> 3.14.6.4。�功能的有用示例</h4></div></div></div>
<p>特别是在涉及日期功能时，通常需要使用彼此嵌入的多个功能。
    </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term">？formatDate（？now（），dd'MMMM'yyyy）</span></dt>
<dd><p>例如2012年2月29日</p></dd>
<dt><span class="term">？formatDate（？now（），dd'MMM'yyyy）</span></dt>
<dd><p>例如2012年2月29日</p></dd>
<dt><span class="term">？formatDate（？now（），dd-MMM-yyyy）</span></dt>
<dd><p>例如，2012年2月29日</p></dd>
<dt><span class="term">？formatDate（？now（），dd。MM.yyyy）</span></dt>
<dd><p>例如29.02.2012</p></dd>
<dt><span class="term">？formatDate（？now（），dd / MM / yyyy）</span></dt>
<dd><p>例如29/02/2012</p></dd>
</dl></div>
<p>涉及嵌入式函数的更复杂的示例是：</p>
<div class="blockquote"><blockquote class="blockquote"><p>
        <span class="strong"><strong>？formatDate（？modifyDate（？parseDate<br xmlns:d="http://docbook.org/ns/docbook">（2012年2月22日，dd。MM.yyyy）， -  1D），DD。MM.yy）</strong></span><br xmlns:d="http://docbook.org/ns/docbook">此函数将日期22.2.2012解析为内部格式，减去一天，然后将其格式化为dd。MM.yy，在这种情况下：21.2.12。
      </p></blockquote></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="adding-your-own-functions"></a> 3.14.6.5。�添加自己的功能</h4></div></div></div>
<p>您还可以使用扩展点添加自己的功能。这在开发者手册中有所描述。
    </p>
</div>
</div>
<br xmlns:d="http://docbook.org/ns/docbook"><hr xmlns:d="http://docbook.org/ns/docbook">
<address xmlns:d="http://docbook.org/ns/docbook">版权所有BREDEX GmbH 2015。根据Eclipse Public License v1.0提供。</address>
<br xmlns:d="http://docbook.org/ns/docbook">
</body>
</html>