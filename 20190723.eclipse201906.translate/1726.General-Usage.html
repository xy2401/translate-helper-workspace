<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
		<title>Valgrind用户指南 - 一般用法</title>
		<link type="text/css" rel="stylesheet" href="../../../book.css"></link>
	</head>
	<body dir="ltr">
		<table class="navigation" border="0" style="width:100%" summary="navigation">
			<tr>
				<th align="center" colspan="3" style="width:100%">一般用法</th>
			</tr>
			<tr>
				<td align="left" style="width:20%">
					<a href="Installing.html" title="安装">
						<img alt="以前" border="0" src="../../../images/prev.gif">
					</a>
				</td>
				<td align="center" style="width:60%"></td>
				<td align="right" style="width:20%">
					<a href="Using-Memcheck.html" title="使用Memcheck">
						<img alt="下一个" border="0" src="../../../images/next.gif">
					</a>
				</td>
			</tr>
			<tr>
				<td align="left" valign="top" style="width:20%">安装</td>
				<td align="center" style="width:60%"></td>
				<td align="right" valign="top" style="width:20%">使用Memcheck</td>
			</tr>
		</table><hr class="navigation-separator">
		<h1 id="General_Usage">一般用法</h1>
		<p>您可以使用Valgrind插件的“一键启动”快捷方式来运行默认配置文件。这样做类似于从命令行运行<code>valgrind ./ <i>program_name</i></code> 。要使用单击启动快捷方式，请在“ <b><i>项目资源管理器”</i></b>窗口中右键单击<i>项目</i>或<i>二进制</i>名称，然后导航到“ <u>分析工具”</u> &gt;“ <u>使用Valgrind配置文件”</u> 。如果属于该程序的源文件在任何打开的编辑器上可用，您还可以在编辑器中右键单击以导航到单击启动。

			<br>
			<img border="0" src="images/Vg_original_menu.png">
		</p>
		<h2 id="Configuring_a_Profile_Run">配置配置文件运行</h2>
		<p>要配置Valgrind配置文件运行，请导航到“性能<u>分析工具”</u> &gt;“ <u>配置文件配置”</u>以访问“ <b><i>配置文件配置”</i></b>菜单。
			<br>
			<img border="0" src="images/Vg_config.png">
		</p>
		<p>“ <b><i>配置文件配置”</i></b>菜单允许您使用一些基本的Valgrind配置文件选项配置配置文件运行，以及每个Valgrind工具最有用的选项。可以在特定配置文件运行的<b><i>Valgrind选项选项</i></b>卡中配置这些设置。

			<br>
			<img border="0" src="images/Screenshot-ProfileConfigurations-valgrind-options-tab.png">
		</p>
		<h3 id="General_Options">常规选项</h3>
		<p>“ <b><i>常规选项”选项</i></b>卡允许您配置以下选项：</p>
		<ul>
			<li>
				<b><i>要运行的工具</i></b>允许您在配置文件运行中选择<a href="Using-Memcheck.html#Using_Memcheck">Memcheck</a> ， <a href="Using-Massif.html#Using_Massif">Massif</a>和<a href="Using-Cachegrind.html#Using_Cachegrind">Cachegrind</a> 。默认情况下，使用单击快捷方式将运行<a href="Using-Memcheck.html#Using_Memcheck">Memcheck</a>工具。
			</li>
			<li>
				<b><i>exec</i></b>上的跟踪子进程配置是否跟踪通过<code>exec</code>系统调用启动的子进程。这与使用<code>--trace-children=</code>选项相同。默认情况下禁用此功能。
				<br>有关在每个Valgrind工具的<b><i>exec</i></b>选项上使用<b><i>Trace子</i></b>项的更多详细信息，请参阅<a href="Special-Cases.html#Profiling_Child_Processes">Profiling Child Processes</a> 。
			</li>
			<li>
				<b><i>在退出时运行__libc_freeres</i></b>配置是否在配置文件运行退出后运行<code>__libc_freeres</code>例程。此例程指示<code>glibc</code>释放它已分配的所有内存，类似于使用<code>--run-libc-freeres=</code>选项。默认情况下启用此选项。
			</li>
			<li>
				默认情况下启用<b><i>fork后的子项</i></b> ，并且在大多数情况下无法配置。此选项禁用从<code>fork</code>调用创建的子进程的任何调试或日志记录输出。
			</li>
			<li>
				<b><i>Demangle C ++名称</i></b>允许Valgrind将编码的C ++名称（在编译期间由<code>g++</code> “修改”）转换回类似于其原始形式的名称。默认情况下启用此选项。
			</li>
			<li>
				<b><i>报告的限制错误</i></b>指示Valgrind在检测到总共10,000,000个实际错误或1,000个唯一错误后停止报告错误。默认情况下启用此选项。
			</li>
			<li>
				<b><i>堆栈跟踪中的调用方</i></b>配置Valgrind应使用多少级别的函数调用名来标识程序位置。默认情况下，Valgrind使用12个级别。
			</li>
			<li>
				<b><i>在主</i></b>配置下<b><i>显示错误错误的</i></b>堆栈跟踪应显示出现在<code>main()</code>下面的任何函数。默认情况下禁用此功能。
			</li>
			<li>
				<b><i>最大堆栈帧大小</i></b>是<b><i>堆栈帧</i></b>的最大大小，默认设置为2000000。
			</li>
		</ul>
		<p>有关这些选项的更多信息，请参阅<code>man valgrind</code> 。</p>
		<h3 id="Suppressions">镇压</h3>
		<p>您还可以配置您的配置文件运行以使用抑制文件（类似于<code>--suppressions=</code>选项）。为此，请单击“ <b><i>抑制”</i></b>选项卡。

			<br>
			<img border="0" src="images/Screenshot-Suppressions.png">
		</p>
		<p>“ <u>工作区”</u>按钮允许您从工作区中选择资源作为抑制文件。要使用工作区外的抑制文件，请使用“ <u>文件系统”</u>按钮。</p>
		<h2 id="Exporting_Valgrind_Data">导出Valgrind数据</h2>
		<p>要导出Valgrind配置文件运行期间收集的原始数据，请使用“ <b><i>导出”</i></b>向导菜单。要访问“ <b><i>导出”</i></b>向导菜单，请导航到“ <u>文件”</u> &gt;“ <u>导出”，</u>然后选择“ <u>其他</u> ”类别下的“ <u>Valgrind日志文件</u> ”。
		</p>
		<p>
			<br>
			<img border="0" src="images/ValgrindExportWizard.png">
		</p>
		<p>或者，您也可以使用<u>Export Valgrind Log Files</u>图标（ <img border="0" src="images/Exportbuttonvalgrindview.gif"> ）在Valgrind视图工具栏上访问“ <b><i>导出”</i></b>向导菜单。
		</p>
		<h2 id="Error_Markers">错误标记</h2>
		<p>Valgrind Eclipse插件使用错误标记来识别底层Valgrind工具发现的特定错误给用户。使用这些标记的子工具是Memcheck和Helgrind;每个发出特定的内存或并发错误。</p>
		<p>
			<img border="0" src="images/Memcheck_error.png">
		</p>
		<p>在Linux Tools的2.1版本中，可以通过简单地重新构建或清理相应的项目来清除这些错误标记。对于旧版本，“ <b><i>删除标记”</i></b>工具栏操作可用于手动清除标记。
		</p>
		<p>
			<img border="0" src="images/Valgrind_toolbar_action.png">
		</p>
		<h2 id="Other_Operating_Systems">其他操作系统</h2>
		<p>Valgrind Eclipse插件仅在Linux系统上进行设计和测试。但是，Valgrind工具也可以在Mac OS X上使用，Linux Tools Eclipse Valgrind插件也可以使用。这些插件在Mac OS X上不受官方支持，但以下是使其运行的说明。</p>
		<h3 id="Mac_OS_X_10.6">Mac OS X 10.6</h3>
		<p>截至2010年4月19日，Valgrind工具的正式发布不适用于10.6。但是，有一些补丁可以使它工作。</p>
		<p>编译Valgrind工具的简要说明如下： <a href="http://code.google.com/p/data-race-test/wiki/ValgrindOnSnowLeopard">http</a> ： <a href="http://code.google.com/p/data-race-test/wiki/ValgrindOnSnowLeopard">//code.google.com/p/data-race-test/wiki/ValgrindOnSnowLeopard</a>
		</p>
		<p>实质上，您需要运行以下脚本。（确保已安装wget）</p>
		<pre>svn co -r 11104 svn：//svn.valgrind.org/valgrind/trunk valgrind cd valgrind wget <a href="http://bugs.kde.org/attachment.cgi?id=40091">http://bugs.kde.org/attachment.cgi?id=40091</a> -O snow-leopard.patch wget <a href="http://bugsfiles.kde.org/attachment.cgi?id=40900">http：/ /bugsfiles.kde.org/attachment.cgi?id=40900</a> -O arc4random.patch wget <a href="http://bugsfiles.kde.org/attachment.cgi?id=42530">http://bugsfiles.kde.org/attachment.cgi?id=42530</a> -O sidt.patch wget <a href="http://bugsfiles.kde.org/attachment.cgi?id=42892">http：//bugsfiles.kde .org / attachment.cgi？id = 42892</a> -O signal.patch patch -p0 &lt;snow-leopard.patch patch -p0 &lt;arc4random.patch patch -p1 &lt;signal.patch cd VEX; patch -p0 &lt;../sidt.patch; cd ..触摸darwin10-drd.supp touch darwin10.supp ./autogen.sh || autoreconf -fvi ./configure --prefix =`pwd` / inst make -j 8 &amp;&amp; make install</pre>
		<p>完成此操作后，请参阅下面有关其他Mac OS的说明</p>
		<h3 id="x86_64_Mac_OS">x86_64 Mac OS</h3>
		<p>Valgrind只与Mac OS上的x86二进制文件兼容，因此如果您有x86_64，则需要确保构建x86二进制文件。为此，请右键单击该项目，然后选择“属性”。</p>
		<p>在Properties窗口中，选择C / C ++ Build，然后将'-m32'添加到MacOS X C ++ Linker，GCC C ++编译器和GCC C编译器的Command字段中。这将导致创建x86二进制文件。</p>
		<h3 id="All_Mac_OS">所有Mac OS</h3>
		<p>首先确保安装了Valgrind命令行工具的版本。有关Valgrind的特殊说明，请参见<a href="http://valgrind.org/">http://valgrind.org/</a>并参见上文。安装后，您需要创建一个符号链接到/ usr / bin / valgrind，以便Valgrind插件可以找到它。
		</p>
		<p>使用<code>which valgrind</code>来查找Valgrind二进制文件的安装位置。</p>
		<p><code>ln -s /usr/bin/valgrind /location/of/valgrind</code>将创建符号链接。</p>
		<p>之后，Eclipse Valgrind插件应该按照此Wiki页面的其他部分中的指定工作。</p><hr class="navigation-separator">
		<table class="navigation" border="0" style="width:100%" summary="navigation">
			<tr>
				<td align="left" style="width:20%">
					<a href="Installing.html" title="安装">
						<img alt="以前" border="0" src="../../../images/prev.gif">
					</a>
				</td>
				<td align="center" style="width:60%">
					<a href="User-Guide.html" title="Valgrind用户指南">
						<img alt="Valgrind用户指南" border="0" src="../../../images/home.gif">
					</a>
				</td>
				<td align="right" style="width:20%">
					<a href="Using-Memcheck.html" title="使用Memcheck">
						<img alt="下一个" border="0" src="../../../images/next.gif">
					</a>
				</td>
			</tr>
			<tr>
				<td align="left" valign="top" style="width:20%">安装</td>
				<td align="center" style="width:60%"></td>
				<td align="right" valign="top" style="width:20%">使用Memcheck</td>
			</tr>
		</table>
	</body>
</html>