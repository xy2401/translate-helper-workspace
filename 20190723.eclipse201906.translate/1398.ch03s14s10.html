<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>10年3月14日。�使用Excel文件作为外部数据源</title>
<link rel="stylesheet" type="text/css" href="../../css/style.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="../index.html" title="Jubula User Manual">
<link rel="up" href="ch03s14.html" title="3.14.�Working with test data">
<link rel="prev" href="ch03s14s09.html" title="3.14.9.�Using central data sets">
<link rel="next" href="ch03s14s11.html" title="3.14.11.�Using the Data Sets View to enter data loops">
</head>
<body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">10年3月14日。�使用Excel文件作为外部数据源</th></tr>
<tr>
<td width="20%" align="left">
<a href="ch03s14s09.html" accesskey="p">上一页</a> �</td>
<th width="60%" align="center">3.14。�使用测试数据</th>
<td width="20%" align="right">� <a href="ch03s14s11.html" accesskey="n">下一步</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="breadcrumbs" xmlns:d="http://docbook.org/ns/docbook">
<span class="breadcrumb-link"><a href="../index.html">Jubula用户手册</a></span> &gt; <span class="breadcrumb-link"><a href="ch03.html">任务</a></span> &gt; <span class="breadcrumb-link"><a href="ch03s14.html">使用测试数据</a></span> &gt; <span class="breadcrumb-node">使用Excel文件作为外部数据源</span>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="using-an-excel-file-as-an-external-data-source"></a> 10年3月14日。�使用Excel文件作为外部数据源</h3></div></div></div>
<a name="using-an-excel-file-as-an-external-data-source.guidancerPropertiesViewContextId"></a><p>在“属性”视图中，您可以将Excel文件作为数据源添加到“测试用例”，其中包含从测试用例或测试步骤中引用的参数。
  </p>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="102" height="89" src="../images/img1.jpg"></td>
<td class="topbotline"><span class="strong"><strong>不鼓励通过Excel添加数据，因为只有在测试运行后才能找到数据的任何问题。我们建议使用ITE中的中央测试数据集来管理项目中的数据（ <a class="xref" href="ch03s14s09.html" title="3.14.9。�使用中央数据集">Section�3.14.9，“使用中央数据集”</a> ）。
  </strong></span></td>
</tr></tbody>
</table>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><p>导航到要添加Excel文件的测试用例的“属性”视图。
      </p></li>
<li class="listitem">
<p>在<span class="emphasis"><em>Excel数据文件</em></span>字段中输入Excel文件的路径。
      </p>
<p>Excel文件的路径可以是绝对路径或相对路径（如果已指定数据文件路径（图<a class="xref" href="ch03s29s02.html#gdprefs" title="Figure3.32。�参考对话框">�3.32，“首选项对话框”</a> ））。
      </p>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>必须以特定方式<a class="xref" href="ch03s14s10.html#configuring-the-excel-file" title="3.14.10.1.�Configuring the Excel file">配置Excel文件</a>才能读取它（ <a class="xref" href="ch03s14s10.html#configuring-the-excel-file" title="3.14.10.1。�配置Excel文件">Section�3.14.10.1，“配置Excel文件”</a> ）。
      </strong></span></td>
</tr></tbody>
</table>
</li>
<li class="listitem">
<p>如果重复使用此测试用例，则输入的Excel文件将与测试用例一起重复使用。重复使用测试用例时，您可以选择是保留此文件还是将其更改为另一个文件。
      </p>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>如果将Excel文件存储在工作区中，则可以使用就地编辑器从导航器视图中直接在ITE中打开这些文件。
      </strong></span></td>
</tr></tbody>
</table>
</li>
<li class="listitem">
<p>使用Excel文件作为数据的测试用例在浏览器中标有一个小的Excel图标，以帮助您以后更轻松地找到它。
      </p>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="102" height="89" src="../images/img1.jpg"></td>
<td class="topbotline"><span class="strong"><strong>请注意，Excel文件在测试执行开始时读取。此后对文件的任何更改都不会影响测试数据。有关在Excel中使用日期函数的信息，请参阅章节<a class="xref" href="ch03s14s10.html#using-the-today-function-in-excel" title="3.14.10.2。�在Excel中使用= TODAY（）函数">�3.14.10.2，“在Excel中使用= TODAY（）函数”一节</a> 。
      </strong></span></td>
</tr></tbody>
</table>
</li>
</ol></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="configuring-the-excel-file"></a> 3.14.10.1。�配置Excel文件</h4></div></div></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc">
<li class="listitem">
<p>Excel中的工作表可以任意命名。
        </p>
<div class="figure">
<a name="excel"></a><div class="figure-contents"><div class="mediaobject"><img src="../images/excelexample.png" xmlns:d="http://docbook.org/ns/docbook"></div></div>
<div class="figure-title">Figure3.23。�示例Excel表</div>
</div>
<br class="figure-break"><p>仅使用第一张纸。
        </p>
</li>
<li class="listitem">
<p>使用测试用例中的参数名称命名每列的顶部单元格。
        </p>
<p>例如，如果输入了引用“ <span class="emphasis"><em>= VALUE1</em></span> ”，则必须在列的顶部单元格中输入<span class="input">VALUE1</span> ，该列将包含该参数的数据。
        </p>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>值区分大小写。
        </strong></span></td>
</tr></tbody>
</table>
</li>
<li class="listitem"><p>确保测试用例的所有参数都有一列。
        </p></li>
<li class="listitem"><p>不要在桌子上留下任何空隙。
        </p></li>
<li class="listitem"><p>您必须为测试用例中使用的每个参数都有一个条目。
        </p></li>
<li class="listitem">
<p>然后，您可以填写要用于这些参数的值或公式。表中的每一行代表所用参数的一组数据。
        </p>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>我们建议您<span class="emphasis"><em>在</em></span>添加测试数据<span class="emphasis"><em>之前</em></span>将单元格格式化为文本。这可确保Excel的数字格式不会以意外和不合需要的方式修改测试数据。特别是对于布尔值<span class="emphasis"><em>true</em></span>和<span class="emphasis"><em>false</em></span> ，请确保将列格式化为文本。
        </strong></span></td>
</tr></tbody>
</table>
</li>
<li class="listitem">
<p>如果您的Excel表包含每天更改的数据，请确保在开始测试之前打开该文件。否则，将使用来自上次打开状态的数据。
        </p>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>如果将Excel文件存储在工作区中，则可以使用就地编辑器从导航器视图中直接在ITE中打开这些文件。
        </strong></span></td>
</tr></tbody>
</table>
</li>
<li class="listitem"><p>请参阅后面的部分，使用Excel中的<span class="emphasis"><em>today</em></span>函数获取当前日期（ <a class="xref" href="ch03s14s10.html#using-the-today-function-in-excel" title="3.14.10.2。�在Excel中使用= TODAY（）函数">Section�3.14.10.2，“在Excel中使用= TODAY（）函数”</a> ）。
        </p></li>
<li class="listitem"><p>Excel文件可能不包含任何要用作数据源的工作表中的自动筛选器。在运行测试之前，从所有Excel工作表中删除所有过滤器。</p></li>
</ul></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="using-the-today-function-in-excel"></a> 3.14.10.2。�在Excel中使用= TODAY（）函数</h4></div></div></div>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><p>由于Excel将“ <span class="emphasis"><em>= today（）</em></span> ”函数存储为六位数字，因此必须使用特定进程才能使用此函数将日期作为测试的一部分进行检查。</p></li>
<li class="listitem"><p>在与您用于数据集的工作表不同的工作表中输入function <span class="input">= today（）</span> 。如果需要，可以在同一工作表中输入它，但要确保它有自己的列。它不能位于您将用作数据集的其中一列中。
        </p></li>
<li class="listitem"><p>例如，your = today（）函数位于第一页，单元格G4。
        </p></li>
<li class="listitem"><p>您希望您的日期显示为dd.mm.yyyy。
        </p></li>
<li class="listitem">
<p>在数据集的列中，输入以下公式：</p>
<div class="blockquote"><blockquote class="blockquote"><p>=文本（工作表Sheet1！G4，“dd.mm.yyyy”）</p></blockquote></div>
</li>
<li class="listitem">
<p>这将意味着日期将被视为与Excel一起显示。
        </p>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>如果您使用的是= today（）函数，请不要忘记在开始测试之前打开Excel文件。否则，将使用来自上次打开状态的数据。
        </strong></span></td>
</tr></tbody>
</table>
<p xmlns:d="http://docbook.org/ns/docbook"></p><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>如果将Excel文件存储在工作区中，则可以使用就地编辑器从导航器视图中直接在ITE中打开这些文件。
        </strong></span></td>
</tr></tbody>
</table>
</li>
</ol></div>
</div>
</div>
<br xmlns:d="http://docbook.org/ns/docbook"><hr xmlns:d="http://docbook.org/ns/docbook">
<address xmlns:d="http://docbook.org/ns/docbook">版权所有BREDEX GmbH 2015。根据Eclipse Public License v1.0提供。</address>
<br xmlns:d="http://docbook.org/ns/docbook">
</body>
</html>
