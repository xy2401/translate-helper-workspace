<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>3.14.10. Using an Excel file as an external data source</title>
<link rel="stylesheet" type="text/css" href="../../css/style.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="../index.html" title="Jubula User Manual">
<link rel="up" href="ch03s14.html" title="3.14. Working with test data">
<link rel="prev" href="ch03s14s09.html" title="3.14.9. Using central data sets">
<link rel="next" href="ch03s14s11.html" title="3.14.11. Using the Data Sets View to enter data loops">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">3.14.10. Using an Excel file as an external data source</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch03s14s09.html">Prev</a> </td>
<th width="60%" align="center">3.14. Working with test data</th>
<td width="20%" align="right"> <a accesskey="n" href="ch03s14s11.html">Next</a>
</td>
</tr>
</table>
<hr>
</div>
<div xmlns:d="http://docbook.org/ns/docbook" class="breadcrumbs">
<span class="breadcrumb-link"><a href="../index.html">Jubula User Manual</a></span> &gt; <span class="breadcrumb-link"><a href="ch03.html">Tasks</a></span> &gt; <span class="breadcrumb-link"><a href="ch03s14.html">Working with test data</a></span> &gt; <span class="breadcrumb-node">Using an Excel file as an external data source</span>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="using-an-excel-file-as-an-external-data-source"></a>3.14.10. Using an Excel file as an external data source</h3></div></div></div>
<a name="using-an-excel-file-as-an-external-data-source.guidancerPropertiesViewContextId"></a><p>
    In the Properties View, you can add Excel files as a data source to
    Test Cases which contain parameters referenced from the
    Test Cases or Test Steps they contain.
  </p>
<p xmlns:d="http://docbook.org/ns/docbook"><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="102" height="89" src="../images/img1.jpg"></td>
<td class="topbotline"><span class="strong"><strong>
    The addition of data via Excel is discouraged, because any problems with the data can only be found once the test is running. We recommend using the central test data sets in the ITE to manage data within the Project (<a class="xref" href="ch03s14s09.html" title="3.14.9. Using central data sets">Section 3.14.9, &#8220;Using central data sets&#8221;</a>).
  </strong></span></td>
</tr></tbody>
</table></p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><p>
        Navigate to the Properties View for the Test Case you want to
        add the Excel file to.
      </p></li>
<li class="listitem">
<p>
        Enter the path to the Excel file in the
        <span class="emphasis"><em>Excel data file</em></span> field.
      </p>
<p>
        The path to the Excel file can be absolute or relative (if
        you have specified a data files path (<a class="xref" href="ch03s29s02.html#gdprefs" title="Figure 3.32. Preference Dialog">Figure 3.32, &#8220;Preference Dialog&#8221;</a>)).
      </p>
<p xmlns:d="http://docbook.org/ns/docbook"><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>
        The Excel file must be configured in a specific way in order it to be read (<a class="xref" href="ch03s14s10.html#configuring-the-excel-file" title="3.14.10.1. Configuring the Excel file">Section 3.14.10.1, &#8220;Configuring the Excel file&#8221;</a>).
      </strong></span></td>
</tr></tbody>
</table></p>
</li>
<li class="listitem">
<p>
        If you reuse this Test Case, the Excel file you enter will
        be reused along with the Test Case. When you reuse the
        Test Case, you can choose whether you leave this file or
        change it for another one.
      </p>
<p xmlns:d="http://docbook.org/ns/docbook"><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>
        If you store your Excel files in your workspace, you will be able to open these directly in the ITE from the navigator view using the in-place editor.
      </strong></span></td>
</tr></tbody>
</table></p>
</li>
<li class="listitem">
<p>
        A Test Case with an Excel file as data is marked with a
        small Excel icon in the browsers to help you find it more
        easily later.
      </p>
<p xmlns:d="http://docbook.org/ns/docbook"><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="102" height="89" src="../images/img1.jpg"></td>
<td class="topbotline"><span class="strong"><strong>
        Please note that the Excel file is read at the start of the test execution. Any changes to the file after this will not affect the test data. For information on using the date function in Excel, see the section later <a class="xref" href="ch03s14s10.html#using-the-today-function-in-excel" title="3.14.10.2. Using the =TODAY() function in Excel">Section 3.14.10.2, &#8220;Using the =TODAY() function in Excel&#8221;</a>.
      </strong></span></td>
</tr></tbody>
</table></p>
</li>
</ol></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="configuring-the-excel-file"></a>3.14.10.1. Configuring the Excel file</h4></div></div></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
<p>
          The worksheet in Excel can be named arbitrarily.
        </p>
<div class="figure">
<a name="excel"></a><div class="figure-contents"><div class="mediaobject"><img xmlns:d="http://docbook.org/ns/docbook" src="../images/excelexample.png"></div></div>
<div class="figure-title">Figure 3.23. Example Excel Table</div>
</div>
<br class="figure-break"><p>
          Only the first sheet will be used.
        </p>
</li>
<li class="listitem">
<p>
          Name the top cell of each column with a parameter name
          from your Test Case.
        </p>
<p>
          For example, if you entered the reference
          &#8221;<span class="emphasis"><em>=VALUE1</em></span>&#8221;, then you must enter <span class="input">VALUE1</span>
          in the top cell of the column which will contain data for
          that parameter.
        </p>
<p xmlns:d="http://docbook.org/ns/docbook"><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>
          Values are case sensitive.
        </strong></span></td>
</tr></tbody>
</table></p>
</li>
<li class="listitem"><p>
          Make sure that all the parameters for your Test Case have
          a column.
        </p></li>
<li class="listitem"><p>
          Do not leave any gaps in the table.
        </p></li>
<li class="listitem"><p>
          You must have an entry for each parameter used in the
          Test Case.
        </p></li>
<li class="listitem">
<p>
          You can then fill in the values or formulae you want to
          use for these parameters. Each row in the table represents
          one set of data for the parameters used.
        </p>
<p xmlns:d="http://docbook.org/ns/docbook"><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>
          We recommend that you format cells as text <span class="emphasis"><em>before</em></span> adding the test data. This ensures that Excel's number formatting won't modify the test data in unexpected and undesirable ways. Especially for the boolean values <span class="emphasis"><em>true</em></span> and <span class="emphasis"><em>false</em></span>, make sure you format the column as text.
        </strong></span></td>
</tr></tbody>
</table></p>
</li>
<li class="listitem">
<p>
          If your Excel table contains data which change from
          day-to-day, then make sure you open the file before
          starting your test. Otherwise, the data from the
          last-opened state will be used.
        </p>
<p xmlns:d="http://docbook.org/ns/docbook"><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>
          If you store your Excel files in your workspace, you will be able to open these directly in the ITE from the navigator view using the in-place editor.
        </strong></span></td>
</tr></tbody>
</table></p>
</li>
<li class="listitem"><p>
          See the section later on using the <span class="emphasis"><em>today</em></span> function
          in Excel to get the current date (<a class="xref" href="ch03s14s10.html#using-the-today-function-in-excel" title="3.14.10.2. Using the =TODAY() function in Excel">Section 3.14.10.2, &#8220;Using the =TODAY() function in Excel&#8221;</a>).
        </p></li>
<li class="listitem"><p>
          Excel files may not contain autofilters in any of the
          worksheets to be used as data sources. Remove any filters
          from all your Excel sheets before running a test.
        </p></li>
</ul></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="using-the-today-function-in-excel"></a>3.14.10.2. Using the =TODAY() function in Excel</h4></div></div></div>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><p>
          Because Excel stores the &#8221;<span class="emphasis"><em>=today()</em></span>&#8221; function as
          a six-digit number, you must use a particular process to
          use this function to check a date as part of a test.
        </p></li>
<li class="listitem"><p>
          Enter the function <span class="input">=today()</span> in a a different
          sheet to the one you are using for your data sets. You can
          enter it in the same sheet if you want to, but make sure
          that it has its own column. It must not be in one of the
          columns you will use as a data set.
        </p></li>
<li class="listitem"><p>
          For example, your =today() function is in sheet one, cell
          G4.
        </p></li>
<li class="listitem"><p>
          You want your date to appear as dd.mm.yyyy.
        </p></li>
<li class="listitem">
<p>
          In the column for your data set, enter the following
          formula:
        </p>
<div class="blockquote"><blockquote class="blockquote"><p>
            =text(Sheet1!G4, &#8221;dd.mm.yyyy&#8221;)
          </p></blockquote></div>
</li>
<li class="listitem">
<p>
          This will mean that the date will be treated as it appears
          with Excel.
        </p>
<p xmlns:d="http://docbook.org/ns/docbook"><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>
          If you are using the =today() function, don't forget to open the Excel file before  starting your test. Otherwise, the data from the last-opened state will be used.
        </strong></span></td>
</tr></tbody>
</table></p>
<p xmlns:d="http://docbook.org/ns/docbook"><table>
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td><img align="bottom" width="100" height="91" src="../images/img2.jpg"></td>
<td class="topbotline"><span class="strong"><strong>
          If you store your Excel files in your workspace, you will be able to open these directly in the ITE from the navigator view using the in-place editor.
        </strong></span></td>
</tr></tbody>
</table></p>
</li>
</ol></div>
</div>
</div>
<br xmlns:d="http://docbook.org/ns/docbook"><hr xmlns:d="http://docbook.org/ns/docbook">
<address xmlns:d="http://docbook.org/ns/docbook">Copyright BREDEX GmbH 2015. Made available under the Eclipse Public License v1.0.</address>
<br xmlns:d="http://docbook.org/ns/docbook">
</body>
</html>
