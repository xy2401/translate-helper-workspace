<!doctype html public "-//w3c//dtd html 4.0 transitional//en" gtc:encodedoriginal="PCFkb2N0eXBlIGh0bWwgcHVibGljICItLy93M2MvL2R0ZCBodG1sIDQuMCB0cmFuc2l0aW9uYWwvL2VuIj4=">
<html >
<head>
<meta name="copyright" content="Copyright (c) IBM Corporation and others 2000, 2005. This page is made available under license. For full details see the LEGAL in the documentation book that contains this page.">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" href="../../../book.css" type="text/css" charset="ISO-8859-1">

   <title>桌面 -  Java编辑器示例</title>
</head>
<body >

<h2>
<b>示例 -  Java编辑器</b></h2>

<h3>介绍</h3>Java编辑器示例演示了可用于自定义文本编辑器的标准功能。它还说明了如何为文件扩展名注册编辑器（在本例中为.jav）以及如何定义该编辑器使用的自定义文档提供程序。此示例仅用于演示目的。Eclipse Java Tooling提供了Java编辑支持。
<p>此示例的代码位于<code>org.eclipse.ui.examples.javaeditor</code>插件中。要探索代码，建议将该插件导入工作区。
</p>

<h3>
<b>示例编辑器中演示的功能</b></h3>

<ul>
<li>语法高亮</li>

<li>内容类型敏感内容辅助（Javadoc和Java代码）</li>

<li>内容大纲和编辑之间的通信，即内容大纲选择提供编辑器的高亮范围</li>

<li>两种不同的演示模式</li>

<ul>
<li>使用可视范围指示器标记高光范围</li>

<li>限制编辑器只显示高亮范围内的文本（例如，显示Java类的单个方法）</li>
</ul>

<li>标记处理</li>

<li>文件共享</li>
</ul>

<h3>功能未展示</h3>

<ul>
<li>内容格式</li>

<li>动态协调内容大纲页面</li>
</ul>

<h3>运行示例Java编辑器</h3>

<ol>
<li>创建一个项目</li>

<li>在新创建的项目中创建文件扩展名为“.jav”的文件。Java示例编辑器自动打开。</li>

<li>插入Java代码。Java代码是动态着色的。示例编辑器以不同的颜色显示以下语言元素：多行注释，单行注释，Java语言保留字，字符串和字符常量，常规Java代码，以及遵循Javadoc准则的多行注释。在这些Javadoc注释中，Javadoc关键字（绿色）和HTML标记（灰色）的颜色不同。</li>

<li>通过在Java注释外插入“/ *”来打开新的Java多行注释。插入的“/ *”和第一次出现的“* /”或文本结尾之间的所有文本都将其颜色更改为红色。附加另一个“*”。红色范围将颜色更改为黑色，因为现在认为常规多行注释包含Javadoc。使用CTRL-SPACE调用代码辅助。内容辅助的功能是支持用户编写代码。因此，在调用时，内容辅助应列出调用位置的所有可能的有效完成。在Javadoc中，示例编辑器总是提出所有Javadoc关键字。</li>

<li>在Java注释之外使用CTRL + SHIFT + SPACE调用内容提示。列出了五个提案。选择一个，然后按ENTER键。显示所选提案的当前行上方会出现一个小的浮动红色窗口。内容提示用于让用户表达她的意图（例如，输入方法调用），然后呈现引导用户这样做的上下文信息。在示例编辑器中，该提议在初始调用位置周围被视为有效的五个字符。虽然内容提示可见，但使用CTRL + SPACE调用内容辅助。在这种情况下调用的内容辅助应该有助于用户完成她声明的意图，这在内容提示中仍然可见。在常规Java代码中，示例编辑器总是提出所有Java关键字。</li>

<li>保存Java代码。保存更新内容大纲。内容大纲包含十个条目，每个条目代表编辑器中十个大小相等的Java代码段之一。选择这种样式的内容大纲表明高亮范围的语义可以任意定义。（见下一步。）</li>

<li>选择内容大纲中的一个条目。相应的行在编辑器的左侧垂直标尺中用蓝色条标记。</li>

<li>现在切换到Java编辑器的分段表示模式。为此，请确保编辑器具有焦点，然后在桌面工具栏中按下该按钮，其悬停帮助显示“启用/禁用分段源查看器”。此功能用于单个方法视图和类似功能。</li>

<li>在内容大纲中选择一个不同的条目。现在编辑器只显示选定的段。通过取消选择内容大纲中的条目，将再次显示完整的Java代码。</li>

<li>在内容大纲中选择一个条目，选择可见文本的一部分，然后为选择添加任务。任务显示在任务列表中。修改可见代码。在任务列表中，选择以前创建的任务，然后按“转到文件”按钮。在可见区域中选择任务，正确地考虑先前应用的修改。</li>

<li>在内容大纲中选择另一个条目。从任务列表中显示以前添加的任务。编辑器的高亮范围会自动放大，以包含显示任务的范围。</li>

<li>打开一个新工作区。在新工作区中，打开与原始工作区中相同文件的Java编辑器。修改编辑器内容。切换回原始工作区。编辑器显示在其他工作区中所做的更改。显示相同文件的两个编辑器已链接。</li>
</ol>

<h3>创建自定义文本编辑器的原则</h3>通常需要执行以下步骤来开发自定义文本编辑器。
<ol>
<li>创建文档提供程序。文档提供程序（请参阅IDocumentProvider）生成和管理包含编辑器输入元素的文本表示的文档（请参阅IDocument）。决定如何执行元素和文本表示之间的转换以及文档提供者是否应该在多个编辑者之间共享是很重要的。请参阅Java示例编辑器中的类FileDocumentProvider。</li>

<li>创建文档分区程序。文档分区程序（请参阅IDocumentPartitioner）将文档划分为不相交的区域。分区器从分区器预定义的一组内容类型中为每个区域分配一种内容类型。在每个文档更改时，必须更新文档的分区。请参阅Java示例编辑器中的JavaPartitioner类。JavaPartitioner确定类型“多行注释”，“Javadoc注释”和“其他所有”类型的区域。必须确保在文档提供者生成的每个文档上设置文档提供者。</li>

<li>确定应提供哪个源查看器插件。其他受支持的插件包括自动缩进策略，双击策略，内容格式化程序和文本演示协调程序。随后的描述将仅限于文本表示协调程序（请参阅IPresentationReconciler）。在Java示例编辑器中，文本表示协调程序用于实现语法突出显示。</li>

<li>为所有源查看器插件创建适用于每种受支持内容类型的扩展。如上所示，文档分区程序定义了支持的内容类型。IPresentationReconciler的默认实现支持IPresentationDamagers和IPresentationRepairers作为扩展。这些扩展被认为是特定于特定内容类型的。因此，对于自定义编辑器，用户必须首先选择受支持的内容类型的子集。所选子集中的类型的区域将例如是语法突出显示的。对于每种类型，必须实现扩展。请参阅示例编辑器中的JavaDamagerRepairer和JavaDocDamagerRepairer。</li>

<li>使用以前创建的插件和扩展构建源查看器配置。请参阅示例编辑器中的JavaSourceViewerConfiguration。</li>

<li>使用开发的文档分区程序和源查看器配置自定义TextEditor或AbstractTextEditor类。添加或替换操作并调整编辑器上下文菜单的构造。在实际版本中，此自定义必须在子类中完成。请参阅示例编辑器中的JavaEditor。</li>

<li>设置一个适当的操作栏贡献者，为桌面的工具栏和菜单提供与编辑器相关的操作。请参阅示例编辑器中的JavaActionContributor。</li>

<li>扩展编辑器插件的XML配置文件，以便编辑器在预定义的编辑器扩展点注册一组特定的文件扩展名。还要在XML文件中设置操作栏参与者。请参阅此示例的plugin.xml。</li>
</ol>

<h3>代码组织的例子</h3>Java编辑器示例代码分为四个包：<ul>
<li>
<code>org.eclipse.ui.examples.javaeditor</code>包含所有特定于编辑器的类。</li>

<li>
<code>org.eclipse.ui.examples.javaeditor.java</code>包含所有Java特定的源查看器插件，例如JavaDamagerRepairer以及Java特定的文档分区程序。</li>

<li>
<code>org.eclipse.ui.examples.javaeditor.javadoc </code>包含所有Javadoc特定的源查看器插件，例如JavaDocDamagerRepairer。</li>

<br><code>org.eclipse.ui.examples.javaeditor.util</code>包含其他三个包共享的便捷类。</ul>
</body>
</html>
