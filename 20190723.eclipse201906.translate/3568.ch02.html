<html ><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>如何提供Psychopath XPath表达式</title><link href="book.css" type="text/css" rel="stylesheet"><link href="book.css" type="text/css" rel="stylesheet"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="usermanual"><link rel="up" href="index.html" title="usermanual"><link rel="prev" href="ch01.html" title="Introduction"><link rel="next" href="ch02s02.html" title="Schema Aware"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter" title="如何提供Psychopath XPath表达式"><div class="titlepage"><div><div><h2 class="title"><a name="How_to_feed_Psychopath_XPath_expressions"></a>如何提供Psychopath XPath表达式</h2></div></div></div><div class="toc"><p><b>目录</b></p><ul><li><span class="section"><a href="ch02.html#Non-Schema_Aware">非架构意识</a></span></li><li><span class="section"><a href="ch02s02.html">架构意识</a></span></li><li><span class="section"><a href="ch02s03.html">如何在PsychoPath中使用XPath 2.0语法</a></span><ul><li><span class="section"><a href="ch02s03.html#Constants">常量</a></span></li><li><span class="section"><a href="ch02s03s02.html">路径表达式</a></span></li><li><span class="section"><a href="ch02s03s03.html">轴步骤</a></span></li><li><span class="section"><a href="ch02s03s04.html">设置差异，交集和联盟</a></span></li><li><span class="section"><a href="ch02s03s05.html">算术表达式</a></span><ul><li><span class="section"><a href="ch02s03s05.html#Unary">一元</a></span></li><li><span class="section"><a href="ch02s03s05s02.html">乘法和除法：</a></span></li><li><span class="section"><a href="ch02s03s05s03.html">加减：</a></span></li></ul></li><li><span class="section"><a href="ch02s03s06.html">范围表达式</a></span></li><li><span class="section"><a href="ch02s03s07.html">比较</a></span></li><li><span class="section"><a href="ch02s03s08.html">条件表达式</a></span></li><li><span class="section"><a href="ch02s03s09.html">量化表达式</a></span></li><li><span class="section"><a href="ch02s03s10.html">而且，或表达式</a></span></li><li><span class="section"><a href="ch02s03s11.html">SequenceType匹配表达式</a></span></li></ul></li></ul></div><p>由于PsychoPath已经被实现为外部库而不是完整的程序，因此为了使用它，需要从另一个程序内部访问它。要从其他程序使用PsychoPath处理XPath 2.0表达式，需要完成以下过程：</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>加载XML文档</p></li><li class="listitem"><p>（可选）验证XML文档</p></li><li class="listitem"><p>初始化与文档根相关的静态和动态上下文</p></li><li class="listitem"><p>解析XPath 2.0表达式</p></li><li class="listitem"><p>静态验证XPath 2.0表达式</p></li><li class="listitem"><p>评估与XML文档相关的XPath 2.0表达式</p></li></ol></div><p>为了更好地了解这个过程是如何工作的，我们将通过一个处理和评估字符串表达式“Hello World！”的例子。在此示例中，我们加载的XML文档称为“XPexample.xml”。</p><p>所有5个主要步骤都在<a class="ulink" href="/wiki/PsychoPathXPathProcessor/UserInterface" target="_top">用户界面</a>中详细说明，因此下面只是一个简短的代码摘要：</p><div class="section" title="非架构意识"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="Non-Schema_Aware"></a>非架构意识</h2></div></div></div><div class="literallayout"><p>/ **<br>*首先加载并选择性地验证XML文档<br>* /<br>
</p></div><div class="literallayout"><p>//从XML文档创建一个InputStream<br>InputStream = new FileInputStream（“XPexample.xml”）;<br>
</p></div><div class="literallayout"><p>//初始化Xerces DOM加载器。<br>DOMLoader loader = new XercesLoader（）;<br>
</p></div><div class="literallayout"><p>//（可选）设置标志以验证XML文档<br>// loader.set_validating（validate）;<br>//加载XML文档并存储DOM根目录<br>Document doc = loader.load（is）;<br>
</p></div><div class="literallayout"><p>//使用具有适当默认值的构建器初始化StaticContext。<br>StaticContextBuilder scb = new StaticContextBuilder（）;<br>
</p></div><div class="literallayout"><p>/ **<br>*将XPath 2.0表达式解析为可执行表达式，包括<br>*静态检查和验证。<br>* /<br>String xpathText =“string-join（// character / name，'，'）”;<br>XPath2Expression expr = new Engine（）。parseExpression（xpathText，scb）;<br>
</p></div><div class="literallayout"><p>//评估XPath 2.0表达式，存储结果<br>//在ResultSequence中<br>ResultSequence rs = expr.evaluate（new DynamicContextBuilder（scb），<br>new Object [] {doc}）;<br>
</p></div><div class="literallayout"><p>for（int i = 0; i &lt;rs.size（）; ++ i）{<br>System.out.println（“＃”+ i +“：”+ rs.value（i））;<br>}<br>
</p></div><p>

</p></div></div></body></html>