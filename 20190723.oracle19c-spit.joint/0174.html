<html id="03541.EXP-00000.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>EXP-00000到EXP-00114</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Error Messages"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Error Messages"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-error-messages.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-16T07:32:34-07:00"></meta>
      <meta name="dcterms.title" content="Database Error Messages"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E95938-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="EVM-00001.html" title="Previous" type="text/html"></link>
      <link rel="next" href="GIMR-01001.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ERRMG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="EVM-00001.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="GIMR-01001.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库错误消息</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">EXP-00000到EXP-00114</li>
            </ol>
            <a id="GUID-DF48625B-F309-41FF-8414-B31D39526C3B" name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B"></a>
            
            <h2 id="ERRMG-GUID-DF48625B-F309-41FF-8414-B31D39526C3B" class="sect2"><span class="enumeration_chapter">32</span> EXP-00000到EXP-00114</h2>
         </header>
         <div class="ind">
            <div>
               <dl>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-00C10289-9B28-4392-84EC-DA5004BC01B9"><!-- --></a> EXP-00000：导出未成功终止\ n</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出遇到Oracle错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>在本手册的ORA消息章节中查找随附的Oracle消息，并采取适当的措施。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-52743FC8-5BC1-4556-930E-2AEE1FBDC310"><!-- --></a> EXP-00001：数据字段截断 - 列长度= <span class="variable" translate="no">number</span> ，缓冲区大小= <span class="variable" translate="no">number</span>实际大小= <span class="variable" translate="no">number</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法适合数据缓冲区中的列。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>记录给定大小的参数和随附的消息，并将其作为导出内部错误报告给客户支持。（该表的一部分已导出。出口将继续下一个表格。）

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-569D633C-7EA0-44FA-907A-951537120407"><!-- --></a> EXP-00002：写入导出文件时出错</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法写入导出文件，可能是因为设备错误。此消息通常后跟来自操作系统的设备消息。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>采取适当的措施来恢复设备。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-E14D4F03-7044-4795-A7DD-E71AF7F4F0FD"><!-- --></a> EXP-00003：找不到段的存储定义（ <span class="variable" translate="no">number</span> ， <span class="variable" translate="no">number</span> ）</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法找到群集，索引或表的存储定义。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>记录随附的消息并将其作为导出内部错误报告给客户支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-300572EA-F125-47DE-B65C-19ABE702FA18"><!-- --></a> EXP-00004：用户名或密码无效</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定了无效的用户名或密码。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用有效的用户名和密码重试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-DCC89145-C41F-4D96-8991-88425AB02245"><!-- --></a> EXP-00005：所有允许的登录尝试都失败</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>重复尝试使用无效的用户名或密码登录。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>关闭该实用程序，然后重新启动并使用有效的用户名和密码重试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-241B50DE-CB02-4876-BBB4-6D717D1FFBCA"><!-- --></a> EXP-00006：内部不一致错误</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出的数据结构已损坏。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>记录随附的消息并将其作为导出内部错误报告给客户支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-5E369F4D-B60D-4C3B-AA9E-75B579EFFF44"><!-- --></a> EXP-00007：字典显示没有<span class="variable" translate="no">string</span>列。 <span class="variable" translate="no">string</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法从数据字典中收集列信息。该表可能已被删除。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>重试导出，如果再次出现此错误，请将其作为导出内部错误报告给客户支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-0F4E3FA3-A349-4F99-BF2C-50D4DA4303D1"><!-- --></a> EXP-00008：遇到ORACLE错误<span class="variable" translate="no">number</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出遇到引用的Oracle错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>在本手册的ORA消息章节中查找Oracle消息并采取适当的措施。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-1958FE18-20BB-46E6-A732-8FEA2FA00674"><!-- --></a> EXP-00009：没有权限导出<span class="variable" translate="no">string</span>的表<span class="variable" translate="no">string</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>尝试导出另一个用户的表。只有数据库管理员才能导出其他用户的表。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请求数据库管理员执行导出。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-F60A09FA-6723-49BB-8F7B-71CD5E032B60"><!-- --></a> EXP-00010： <span class="variable" translate="no">string</span>不是有效的用户名</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定了无效的用户名。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>关闭该实用程序，然后重新启动并使用有效的用户名重试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-3E0377E8-7FBF-4519-B555-2E621741B8FC"><!-- --></a> EXP-00011： <span class="variable" translate="no">string</span> 。 <span class="variable" translate="no">string</span>不存在</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法找到指定的表。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用正确的表名重试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-9CBBA706-E481-4E4A-AFD8-157A74B8DB42"><!-- --></a> EXP-00012： <span class="variable" translate="no">string</span>不是有效的导出模式</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定了无效的导出模式。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用有效的导出模式重试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-C343FF39-8210-4FEB-BBD3-F0269BAFB443"><!-- --></a> EXP-00013：回复“Y”，“N”，“返回”或“。”退出</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>输入了无效的响应。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>输入消息中显示的任何响应。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-7271700A-A56B-455C-A9ED-D57895943ECD"><!-- --></a> EXP-00014：表<span class="variable" translate="no">string</span>行<span class="variable" translate="no">number</span>错误\ n</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出在获取行时遇到Oracle错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>在本手册的ORA消息章节中查找随附的Oracle消息，并采取适当的措施。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-34824D0F-3E5E-4CCC-AA1F-F28E73E7B4D2"><!-- --></a> EXP-00015：表<span class="variable" translate="no">string</span>行<span class="variable" translate="no">number</span> ，列<span class="variable" translate="no">string</span> ，数据类型<span class="variable" translate="no">number</span>出错</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出在读取或写入列时遇到错误。随附的消息提供了更多信息。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>更正错误，然后重试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-C1DF2B4B-16D7-407A-88D4-16B712445CF8"><!-- --></a> EXP-00016：读取默认审核选项时遇到ORACLE错误</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出在读取默认审核选项（更新，删除等）时遇到Oracle错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>在本手册的ORA消息章节中查找随附的Oracle消息，并采取适当的措施。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-3CCC2ED4-A41F-4F69-A98E-A1C60D9B6881"><!-- --></a> EXP-00017：需要功能“ <span class="variable" translate="no">string</span> ”，但数据库中不存在</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>输入的命令需要指定的功能。未安装该功能，或者表V $ OPTION中缺少描述该功能的行</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用消息中指定的功能重新安装Oracle。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-7D097784-0003-413D-997B-6EE9D3B61AB5"><!-- --></a> EXP-00018：列<span class="variable" translate="no">string</span>数据类型（ <span class="variable" translate="no">number</span> ），表<span class="variable" translate="no">string</span> 。 <span class="variable" translate="no">string</span>不受支持</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出不支持引用的数据类型。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用可接受的数据类型（CHAR，NUMBER，DATE，LONG或RAW）重试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-2298045E-383E-45AA-8761-15269F7DB7F5"><!-- --></a> EXP-00019：无法处理参数，输入'EXP HELP = Y'寻求帮助</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定了无效的命令行参数。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>在联机帮助屏幕上查看有效参数集，然后重试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-C514DF21-02E7-48D4-A283-3C0CA1A1CAE9"><!-- --></a> EXP-00020：无法分配大小<span class="variable" translate="no">number</span>内存</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法分配必要的内存。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>减小导出缓冲区大小以便需要更少的内存，或增加导出的运行时内存大小。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-D908D843-4D0D-45A1-8938-FC602177622B"><!-- --></a> EXP-00021：只能在完整数据库模式下执行增量导出</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>执行增量导出时指定了USER或TABLE模式。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>指定FULL数据库模式（FULL = Y）并重试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-77CBA522-F3F6-4200-BB67-41635CCC40B1"><!-- --></a> EXP-00022：必须是SYS或SYSTEM才能进行增量导出</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>不存在执行增量导出所需的权限。只有数据库管理员才能执行增量导出。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请数据库管理员执行增量导出。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-DD03F5A8-FBE2-4249-83C8-D17A2212168F"><!-- --></a> EXP-00023：必须是DBA才能执行完整数据库或表空间导出</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>执行FULL数据库导出所需的权限不存在。只有数据库管理员才能执行FULL数据库导出。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请数据库管理员执行FULL数据库导出。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-E4FEAFE6-5ADC-4940-B42E-D1A79A006B4A"><!-- --></a> EXP-00024：未安装导出视图，请通知您的DBA</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>未安装必要的导出视图。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请数据库管理员安装所需的导出视图。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-BDC9D6F0-EC59-4AEA-9E7F-CF3FC25FCA29"><!-- --></a> EXP-00025：字典显示没有约束<span class="variable" translate="no">string</span>列。 <span class="variable" translate="no">number</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法从数据字典中收集有关引用的约束的列信息。约束可能已被更改。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>重试导出，如果再次出现此错误，请将其作为导出内部错误报告给客户支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-3C31FE9B-C3B8-432F-AFD7-EC1EB44E79FD"><!-- --></a> EXP-00026：指定冲突模式</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定了冲突的导出模式。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>仅指定一个参数并重试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-DAE134EC-68B7-4F41-BAB7-8E142BEE94D3"><!-- --></a> EXP-00027：无法计算ORACLE块大小</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法计算Oracle块大小。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>将此报告作为导出内部错误提供给客户支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-3C2F62C6-B727-4D64-ADDD-7292C94D1963"><!-- --></a> EXP-00028：无法打开<span class="variable" translate="no">string</span>进行写入</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法打开导出文件进行写入。此消息通常后跟来自操作系统的设备消息。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>采取适当的措施来恢复设备。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-6BFA6A42-7EED-440E-9D14-23335B10B3E0"><!-- --></a> EXP-00029：增量导出模式和一致模式不兼容</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定了一致和增量导出。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>没有。一致模式已关闭。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-8687C640-8851-4951-8BA3-30CCA54DB774"><!-- --></a> EXP-00030：读取输入时遇到意外的文件结尾</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>在读取用户输入时遇到文件结尾。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>如果要重定向输出到导出，请检查文件是否有错误。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-49D76D23-9F44-49D8-A96D-C67CA6122A38"><!-- --></a> EXP-00031：Arraysize不在有效范围内。使用arraysize = <span class="variable" translate="no">number</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定的arraysize值不在有效范围内。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>没有</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-959A62E2-C99D-4137-9BDC-5B9F5E98DBF0"><!-- --></a> EXP-00032：非DBA可能无法导出其他用户</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>只有数据库管理员才能导出到其他用户。非数据库管理员尝试指定owner = user，其中exporter不是用户。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请求由数据库管理员执行此操作。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-62E1339E-6B81-458E-9421-2DC5C722EB91"><!-- --></a> EXP-00033：找不到环境字符集</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>缺少或未正确指定环境字符集。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>确保正确指定了环境字符集并且该环境字符集存在。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-52E966A7-1BD2-4279-B3C3-E16F32D547C1"><!-- --></a> EXP-00034：rowid错误：file＃ <span class="variable" translate="no">number</span> block＃ <span class="variable" translate="no">number</span> slot＃ <span class="variable" translate="no">number</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>标识发生错误的rowid。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>这是一条信息消息。无需任何操作。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-AE89ECA9-F836-4D18-85EF-B81EDEE3DF84"><!-- --></a> EXP-00035：QUERY参数仅对表模式导出有效</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>您在导出命令中指定了QUERY参数，但未执行表模式导出。QUERY参数不能用于用户模式导出，完全导出，也不能用于时间点恢复导出。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>如果要为表选择行的子集，则必须使用表模式导出独立地导出表。发出表模式导出命令，该命令指定要在导出期间执行的表名和查询。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-075793F2-43A3-4FF0-887E-D13B312CA528"><!-- --></a> EXP-00036：字典中不存在对象<span class="variable" translate="no">number</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>在词典中找不到指定的对象。导出期间可能已删除该对象</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>对象不再存在;不需要采取任何行动。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-6B905D2B-DD87-4D41-A9D2-FCFC9B04F692"><!-- --></a> EXP-00037：导出视图与数据库版本不兼容</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出实用程序的版本高于数据库版本，因此不兼容。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用相同版本的Export实用程序作为数据库。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-1635D7C2-66C2-403D-B11A-0A39692A77B0"><!-- --></a> EXP-00038：clu $中的Bad Hash群集ID</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span> clu $中的函数ID不是合法的数字。Clu $已经损坏。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>联系全球支持</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-98930435-2D32-4F0D-B6DC-762B4DBD8AD6"><!-- --></a> EXP-00039：导出文件<span class="variable" translate="no">string</span>必须位于磁盘上</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>在某些平台上，导出可以从磁带读取文件。如果导出文件集中的第一个文件位于磁盘上并且您为第二个或后续文件指定了磁带设备，则会显示此消息。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>验证是否为导出文件指定了正确的文件名。请记住，所有导出文件都可以在磁盘上，或者所有文件都可以在磁带上，但不能同时包含磁带和磁盘。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-8AA76D5C-5F30-4A75-9A67-374D6BE6EF1D"><!-- --></a> EXP-00040：转储文件和日志文件必须不同</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>转储文件和日志文件不能是同一个文件。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>为转储文件和日志文件指定不同的文件名，然后重试该操作。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-3BF3B1D1-9818-4C63-BCA8-97F8BCEEE6F1"><!-- --></a> EXP-00041：INCTYPE参数已过时</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出在解析导出选项时遇到INCTYPE参数。不再支持增量导出。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请参阅Oracle备份和恢复指南。出口将继续尝试。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-68AE7355-DCB0-4ED6-A4E8-30211BF2FFA4"><!-- --></a> EXP-00042：在道具中缺少NLS_CHARACTERSET / NLS_NCHAR_CHARACTERSET $</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>在props $ table中未输入NLS_CHARACTERSET / NLS_NCHAR_CHARACTERSET的值“</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>内部错误。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-3911A123-C39E-4E77-A3D8-0A11B87EA9D7"><!-- --></a> EXP-00043：表<span class="variable" translate="no">string</span> “ <span class="variable" translate="no">string</span> ”列为“ <span class="variable" translate="no">string</span> ”的行中的数据字典信息无效</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出实用程序从数据字典中检索到无效数据。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>联系Oracle Worldwide Suport。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-8D5A3AE5-80F0-4404-9F47-15606960D92E"><!-- --></a> EXP-00044：必须连接'AS SYSDBA'才能进行时间点恢复或可传输表空间导入</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>用户必须以“as SYSDBA”身份登录才能执行可传输的表空间导入或Point-In-Time Recovery导入。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请求数据库管理员执行可传输表空间导入或表空间时间点恢复导入。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-C92DA614-907E-4CEA-B222-013A9AAE20E3"><!-- --></a> EXP-00045：无法导出SYSTEM表空间以进行时间点恢复或可传输表空间</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span> SYSTEM表空间不能是恢复集或可传输表空间集的一部分。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle Wordwide支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-489B1F5A-FB3D-4398-B206-3C35ED103B59"><!-- --></a> EXP-00046：名为<span class="variable" translate="no">string</span>表空间不存在</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>字典中不存在指定的表空间。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle Wordwide支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-6A3E5C35-B1B0-4C77-8A82-EF7088CB8FED"><!-- --></a> EXP-00047：缺少表空间名称</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>未提供表空间名称</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>提供表空间名称</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-FF8EDD3B-A7CB-4896-960D-31E25F633D5B"><!-- --></a> EXP-00048：无法为时间点恢复或可传输表空间导出SYSAUX表空间</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span> SYSAUX表空间不能是恢复集或可传输表空间集的一部分。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle Wordwide支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-FF7B8742-E3A7-4287-9A5E-5E227167AF67"><!-- --></a> EXP-00049： <span class="variable" translate="no">string</span>选项与时间点恢复或可传输表空间导出不兼容</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定了一个与Point-in-time Recovery或Transportable Tablespace Export不兼容的选项。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>在没有显示选项的情况下重试导出。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-604FF59E-2363-47F8-A86D-8267CAD06332"><!-- --></a> EXP-00050：无法执行分区导出“ <span class="variable" translate="no">string</span>上的非分区表”，“ <span class="variable" translate="no">string</span> ”</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>此分区导出中指定的表不是分区表。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用表模式，或指定非分区表。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-058B243F-8B04-4B1E-9FFD-C6D221D72AED"><!-- --></a> EXP-00051：“ <span class="variable" translate="no">string</span> ” - 给定分区或子分区名称不是“ <span class="variable" translate="no">string</span> ”表的一部分</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定的分区或子分区名称不在指定的表中。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>检查是否指定了正确的表，分区或子分区名称。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-07B7339A-B38E-4E04-8FD0-2943D3C6A8FE"><!-- --></a> EXP-00052：分区<span class="variable" translate="no">string</span>行<span class="variable" translate="no">number</span>错误\ n</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出在获取行时遇到引用的Oracle错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>在本手册的ORA消息章节中查找Oracle消息并采取适当的措施。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-A311F413-4F59-4AF2-A0E3-0C8DBB93BB1F"><!-- --></a> EXP-00053：无法对表<span class="variable" translate="no">string</span>执行QUERY，因为该表具有内部嵌套表</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>您在具有一个或多个内部嵌套表的表上指定了QUERY参数。无法在具有内部嵌套表的表上指定QUERY参数。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>通过省略QUERY参数导出整个表。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-EC1CF023-E438-4E5D-BCAB-466D36D312FE"><!-- --></a> EXP-00054：子分区<span class="variable" translate="no">string</span>行<span class="variable" translate="no">number</span>错误\ n</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出在获取行时遇到引用的Oracle错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>在本手册的ORA消息章节中查找Oracle消息并采取适当的措施。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-5DDEA3A0-C2CF-495F-9B21-1B163DF04C9F"><!-- --></a> EXP-00055： <span class="variable" translate="no">string</span> 。 <span class="variable" translate="no">string</span>标记为不可导出</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>在NOEXP $表中将对象标记为不可导出。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>咨询数据库管理员。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-2EFB7DAE-6E68-44A4-91EB-E89E52B0E022"><!-- --></a> EXP-00057：无法初始化参数管理器</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>参数管理器初始化失败。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>记录后面的消息并将其作为导出内部错误报告给Oracle Wordwide支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-B94FD5E3-67CD-4B6B-B5B1-73C3DFF8C734"><!-- --></a> EXP-00058：密码验证<span class="variable" translate="no">string</span>配置文件的功能不存在</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>找不到配置文件的功能。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>检查配置文件是否已正确创建。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-41B3322D-0DC0-4A8F-AD07-466EE39F861C"><!-- --></a> EXP-00059：将对象类型的标识符转换为字符时出错</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>对象类型标识符的无效长度阻止了其转换。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-265DD428-F061-4581-98F7-E94524281885"><!-- --></a> EXP-00060：对象类型有多个TYPE BODY</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>找到了一个对象类型的TYPE BODY。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>尝试删除TYPE BODY，如果不成功，请联系Oracle全球支持</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-A9170004-2279-4413-A535-957CBC88418F"><!-- --></a> EXP-00061：无法找到嵌套表的外部表名</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>在内部嵌套表上导出位图索引或可发布操作时，无法使用NTAB $表找到外部表的名称。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>验证表是否已正确定义。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-33F2E43C-2023-4A6E-B16C-4B6B31EDD69D"><!-- --></a> EXP-00062：对象类型的无效源语句</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>在对象类型的SOURCE $语句中找不到TYPE</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-335C46AA-A550-43E4-BCDA-635502EA009C"><!-- --></a> EXP-00063：更改语言句柄时出错</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>无法更改语言句柄。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-DDAA550E-F0B4-4D2D-B0BF-893AC59ACACB"><!-- --></a> EXP-00064： <span class="variable" translate="no">string</span>是内部嵌套表，无法导出。
                  </dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>尝试导出没有父表的内部嵌套表。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>导出内部嵌套表的父级。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-6E9DDE1B-2104-4695-83CB-09646E0B477C"><!-- --></a> EXP-00065：将lob写入转储文件时出错。
                  </dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>无法将当前LOB写入转储文件。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>确定写入失败的原因并进行修复。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-0AD69981-0B78-43A4-BA7F-B730322D3E8E"><!-- --></a> EXP-00066：对象表<span class="variable" translate="no">string</span>缺少其对象标识符索引</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>所有对象表必须具有对象标识符索引，但指定的表在其对象标识符列上缺少索引。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>重新创建类型表并重试该操作。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-0A0C1EF2-3DD6-4FD2-82FF-462EA4F515E0"><!-- --></a> EXP-00068：表空间<span class="variable" translate="no">string</span>处于脱机状态</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出导出表空间失败（表空间处于脱机状态）。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使表空间联机并重新导出。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-4D2BD64C-5ECD-4942-A546-6F091308DA35"><!-- --></a> EXP-00070：尝试释放未分配的内存</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>尝试释放未分配的内存。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-8B7FE1F5-39D7-421E-91AB-4A943F252D76"><!-- --></a> EXP-00071：QUERY参数与直接路径导出不兼容</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>您为直接路径导出的QUERY参数指定了值。QUERY参数不能与直接路径导出一起使用。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用DIRECT = N重新发出导出命令或从命令行中省略DIRECT参数。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-19CA13B6-A83F-476C-8311-2980E8DE9071"><!-- --></a> EXP-00072：关闭导出文件<span class="variable" translate="no">string</span>出错</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>尝试关闭导出文件时发生错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-E9E3F74E-6E1D-448A-AB27-C4AE38FD410D"><!-- --></a> EXP-00073：转储文件太小</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>您指定了FILESIZE参数或VOLSIZE参数（如果您的平台支持它），并且参数的值太小，无法保存导出文件的标头信息以及任何数据。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>增加FILESIZE或VOLSIZE参数的值。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-1883B224-7B84-4D22-AD6B-A290B14D67F1"><!-- --></a> EXP-00074：向下舍入VOLSIZE，新值为<span class="variable" translate="no">string</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span> VOLSIZE参数必须是RECORDLENGTH的倍数，但您为VOLSIZE指定的值不符合此要求。VOLSIZE的值已向下舍入为用于转储文件的RECORDLENGTH的倍数。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>无需采取任何行动。您可以调整VOLSIZE或RECORDLENGTH参数以避免出现此消息。导入此文件时，必须指定此消息报告的VOLSIZE值。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-2194B34B-2BFD-465D-A72F-0620BFE59545"><!-- --></a> EXP-00075：向下舍入FILESIZE，新值为<span class="variable" translate="no">string</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span> FILESIZE参数必须是RECORDLENGTH的倍数，但您为FILESIZE指定的值不符合此要求。FILESIZE的值已向下舍入为用于转储文件的RECORDLENGTH的倍数。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>无需采取任何行动。您可以调整FILESIZE或RECORDLENGTH参数以避免此消息。导入此文件时，必须指定此消息报告的FILESIZE值。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-94DA3D0B-A84A-4927-A958-063CEEC3E35A"><!-- --></a> EXP-00076：为磁带输出指定了多个设备</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>您在导出到磁带设备时指定了多个文件名。EXPORT使用相同的设备写入所需的磁带卷数量的所有文件。因此，在写入磁带时，导出将仅接受FILE参数的一个值。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：重新</span>输入EXPORT命令，但在FILE参数中仅指定一个磁带设备。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-9A952012-50AD-4F8F-B1A5-4E83747F29C4"><!-- --></a> EXP-00077：为无界导出文件指定的多个输出文件</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>您在执行导出时指定了多个文件名，并且还为FILESIZE参数指定了值0。请注意，如果未在命令行中指定FILESIZE，则使用0。由于FILESIZE的值为0表示只写入一个文件且该文件没有大小限制，因此永远不能使用您在FILE参数中指定的其他文件。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>如果您打算编写多个文件，请重新指定该命令，但使用FILESIZE指定EXPORT应写入每个文件的最大字节数。如果您打算只写一个文件而不限制其大小，请重新发出EXPORT命令，但只为FILE参数指定一个文件名。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-82C52496-62F2-4C1E-BA5E-E1D2C8040E1D"><!-- --></a> EXP-00078：导出索引<span class="variable" translate="no">string</span>元数据时出错。将跳过索引创建</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>域索引在CREATE INDEX语句之前通过匿名PL / SQL块导出私有元数据。Export通过在与索引关联的实现类型上调用ODCIIndexGetMetadata方法来完成此操作。此例程中出现问题。由于元数据被视为索引的组成部分，因此CREATE INDEX语句未写入转储文件。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系索引实现类型的开发人员。如果这是Oracle提供的索引（可能通过数据盒带），请联系Oracle全球支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-E1E4BF85-4DD9-48C3-8FCC-42E871B8A072"><!-- --></a> EXP-00079：表“ <span class="variable" translate="no">string</span> ”中的数据受到保护。常规路径可能只是导出部分表。
                  </dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>没有DBMS_RLS执行权限的用户（访问控制包）尝试导出具有访问控制的表。由于表所有者也受到访问控制，因此所有者可能无法导出表中的所有行，而只能导出他可以看到的行。此外，为了保持表的完整性，导出表的用户应具有足够的权限，以便在导入时使用安全策略重新创建表。因此，强烈建议数据库管理员应该处理此表的导出。授予表所有者执行权限也会满足此安全检查，但它可能具有其他安全隐患。如果表没有对象，可以使用直接模式。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请数据库管理员导出/导入此表/视图。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-4D14B128-599D-4F6D-BF1D-59926D5A13BD"><!-- --></a> EXP-00080：表“ <span class="variable" translate="no">string</span> ”中的数据受到保护。使用传统模式。
                  </dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>没有DBMS_RLS执行权限的用户（访问控制包）尝试直接导出已启用访问控制的表。而是使用传统的导出模式。请注意，由于访问控制，只能导出部分表。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请数据库管理员导出/导入此表/视图。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-05B2E388-83FB-46D8-BE45-97052E88DB94"><!-- --></a> EXP-00081：将表/视图“ <span class="variable" translate="no">string</span> ”的访问控制导出为非DBA。</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>非DBA用户尝试导出表/视图以及关联的细粒度访问控制策略。导入表/视图时，用户可能没有足够的权限重新创建访问控制策略。并且这样的事件可能导致表/视图的安全模型不一致。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请数据库管理员导出/导入此表/视图。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-09A80A4B-A755-4DB1-A124-26AEB8E6FA90"><!-- --></a> EXP-00082：传递给过程对象支持的函数名称无效： <span class="variable" translate="no">string</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>内部不一致错误：列出的函数不是导出的过程对象接口规范的方法。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-F84948CB-CCB4-4932-A47D-45005AAF4D01"><!-- --></a> EXP-00083：调用<span class="variable" translate="no">string</span>时发生上一个问题。 <span class="variable" translate="no">string</span> 。 <span class="variable" translate="no">string</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>列出的包为过程操作提供导出/导入支持。调用指定的函数时发生了先前列出的错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持。大多数软件包由Oracle内部盒式磁带或服务器开发组提供。包名称将帮助支持确定问题的正确所有者。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-BDD053BF-348E-4E8C-8532-9A44D621D19D"><!-- --></a> EXP-00084：意外DbmsJava错误<span class="variable" translate="no">number</span>在步骤<span class="variable" translate="no">number</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>从调用DbmsJava过程返回错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>记录随附的消息并将其作为导出内部错误报告给客户支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-008644E2-437D-48B4-BC0B-86F038B47FF2"><!-- --></a> EXP-00085：调用<span class="variable" translate="no">string</span>时发生上一个问题。 <span class="variable" translate="no">string</span> 。对象<span class="variable" translate="no">number</span> <span class="variable" translate="no">string</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>列出的包为过程对象提供导出/导入支持，即DDL由存储过程提供的对象。调用指定的函数时发生了先前列出的错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持。大多数软件包由Oracle内部盒式磁带或服务器开发组提供。包名称将帮助支持确定问题的正确所有者。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-6AB82FCE-144C-4DB5-B1A5-00B976AD1320"><!-- --></a> EXP-00086：表“ <span class="variable" translate="no">string</span> ”中的主键REF在导入时可能无效</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定的表包含主键REF，这些REF在导入数据库中可能无效。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>不要使用“导出/导入”在具有不同字符集的数据库之间移动主键REF。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-D60D33E1-D346-4D3F-8F54-76E847AF5F69"><!-- --></a> EXP-00087：模式/表名称的内部哈希表出现问题</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>很可能是为哈希表条目分配内存的问题。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-0AD5AE6F-46F8-4AA6-8DDD-E3DF6045AEEC"><!-- --></a> EXP-00089：FILE_FORMAT规范无效</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span> FILE_FORMAT规范不包含“％s”的实例。必须存在此通配符字符串。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>更正错误并重新输入EXPORT命令。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-73DEA35F-F045-4CD9-9547-3099DA7F9E8E"><!-- --></a> EXP-00090：无法固定输入“ <span class="variable" translate="no">string</span> ”。“ <span class="variable" translate="no">string</span> ”</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法将指定类型固定在对象缓存中。这通常是因为类型无法生效（例如，由于访问子类型中的授权违规）。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用违规类型修复问题，直到可以成功编译类型。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-28FA9484-582F-413C-BF1F-41DD069393F1"><!-- --></a> EXP-00091：导出可疑统计数据。
                  </dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出能够导出统计信息，但统计信息可能无法使用。统计信息是有问题的，因为在导出期间发生了以下一个或多个：发生了行错误，客户端字符集或NCHARSET与服务器不匹配，导出时指定了查询子句，仅导出了某些分区或子分区，或者处理表时发生致命错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>要导出不可疑的统计信息，请更改客户端字符集或NCHARSET以匹配服务器，导出不带查询子句，导出完整表。如果需要，可以提供导入参数，以便只导入不可疑的统计信息，并重新计算所有可疑的统计信息。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-BD771C01-3400-4538-96BC-9A64B58E3314"><!-- --></a> EXP-00092：无法将NLS_NUMERIC_CHARACTERS设置为所需的默认值。
                  </dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出无法将NLS_NUMERIC_CHARACTERS设置为“。”，</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>记录随附的消息并将其作为导出内部错误报告给客户支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-CE1B8080-8C4C-48B0-ADEF-D71E73CABCF9"><!-- --></a> EXP-00093：无法转换为服务器字符集的句柄</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>内部错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>联系全球支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-F82D7427-9167-4D22-BDE0-581B69012023"><!-- --></a> EXP-00094：无法转换为服务器国家字符集的句柄</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>内部错误。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">行动：</span>联系全球支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-0E81C3D9-EAA4-4BEE-9A2C-FA927FF3247F"><!-- --></a> EXP-00095：Flashback_time和Flashback_scn不兼容</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>指定了flashback_time和flashback_scn参数。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>仅使用一个闪回参数重新发出命令。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-DCC345F7-250F-4D1A-986A-58A37F49F5E5"><!-- --></a> EXP-00097：对象类型“ <span class="variable" translate="no">string</span> ”。“ <span class="variable" translate="no">string</span> ”未处于有效状态，不会导出类型</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>对象类型的状态无效，这可能是由依赖类型的修改（或删除）引起的，而没有级联更改。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>必须使用ALTER TYPE COMPILE重新编译类型。</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-AC54DD09-F0F1-4AF7-9A06-0C0ABA5D327E"><!-- --></a> EXP-00098：表中的数据尚未升级，表格不会被导出</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出正在尝试处理包含对已演变类型的引用的表。为了使Export成功处理表，必须将每个表中的所有数据升级到每个引用类型的最新版本。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>必须使用ALTER TABLE UPGRADE DATA更新表。</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-83076DF3-025B-485A-97E8-02519ABCA022"><!-- --></a> EXP-00099：表“ <span class="variable" translate="no">string</span> ”。“ <span class="variable" translate="no">string</span> ”未处于有效状态，表格不会被导出</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>已修改表或其某个依赖类型而没有级联更改。这使表处于INVALID状态。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>必须使用ALTER TABLE UPDATE更新表。</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-93323D69-0CF1-48BA-92AE-CD88B0BB57DE"><!-- --></a> EXP-00100：将对象类型的哈希码转换为字符时出错</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>对象类型标识符的无效长度阻止了其转换。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-DC8EA66E-C639-4C49-BEB2-3B6471295F2F"><!-- --></a> EXP-00101：版本1可扩展索引“ <span class="variable" translate="no">string</span> ”。“ <span class="variable" translate="no">string</span> ”不能包含在可传输表空间导出中</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span> Transporable Tablespace可扩展索引必须至少为版本2。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：将</span>可扩展性索引实现升级到版本2规范。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-E070AED4-1FAB-4BBF-858D-B56ABF3202F5"><!-- --></a> EXP-00102：忽略可恢复参数 - 当前会话无法恢复</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>当前会话无法恢复。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>必须指定RESUMABLE = Y才能启用可恢复会话，以使RESUMABLE_NAME和RESUMABLE_TIMEOUT参数生效。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-66EF8303-D9D8-429E-AAAD-35F8CE1D2F60"><!-- --></a> EXP-00103：FLASHBACK_TIME参数无效</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span> FLASHBACK_TIME未包含有效时间戳或产生有效时间戳的表达式。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>以YYYY-MM-DD HH24格式指定时间戳值：MI：SS或计算结果为有效时间戳的表达式。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-282CB012-1D83-4CFB-8788-44480C9A2B2E"><!-- --></a> EXP-00104：表<span class="variable" translate="no">string</span>中列<span class="variable" translate="no">string</span>数据类型（ <span class="variable" translate="no">string</span> ）。不支持<span class="variable" translate="no">string</span> ，不会导出表</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>该列的数据类型不包含所需的支持。该表不会被导出。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用“数据泵”版本的“导出”导出此表。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-87401197-49FD-4878-8FD2-E06D5A1120EE"><!-- --></a> EXP-00105：此用户不支持参数<span class="variable" translate="no">string</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>用户在连接为sysdba时尝试指定CONSISTENT或OBJECT_CONSISTENT。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>如果需要一致的导出，则以另一个用户身份进行连接。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-6194CE46-CE08-481D-84C8-F1F25EFF5AAF"><!-- --></a> EXP-00106：无效的数据库链接密码</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>数据库链接的编码密码无效</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>请删除数据库链接并在导入后重新创建它。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-007B7AA0-A5FC-4DA1-A33B-5A05D8CA517C"><!-- --></a> EXP-00107：表<span class="variable" translate="no">string</span>中列<span class="variable" translate="no">string</span>功能（ <span class="variable" translate="no">string</span> ）。 <span class="variable" translate="no">string</span>不受支持。该表不会被导出。
                  </dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出不包含此功能所需的支持。该表不会被导出。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用“数据泵”版本的“导出”导出此表。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-23C5F765-9042-41A2-B3D6-F84119468B3A"><!-- --></a> EXP-00108：获取NULL lob</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>内部错误</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-49465702-69B1-41A8-9AC6-9FE1F1A7329D"><!-- --></a> EXP-00109：找不到XSL分隔符</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>内部错误</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>联系Oracle全球支持。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-FF7AC37C-39E3-48EA-916C-A3B74633A3CD"><!-- --></a> EXP-00110：表空间<span class="variable" translate="no">string</span>已加密，不会导出</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>经典导出不支持加密表空间功能</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用DATAPUMP实用程序导出此表空间。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-D7511116-C7EA-41C7-8F77-A4A542710709"><!-- --></a> EXP-00111：表<span class="variable" translate="no">string</span>驻留在加密表空间<span class="variable" translate="no">string</span> ，不会导出</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>经典导出不支持加密表空间功能</p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用DATAPUMP实用程序导出此表。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-52E10468-8012-40BF-BB94-B5AE90C831B9"><!-- --></a> EXP-00112：索引<span class="variable" translate="no">string</span>是XMLType，无法导出</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出不包含此功能所需的支持。无法导出索引。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用Oracle Data Pump Utility导出此索引。

                     </p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-EFE17DB5-0D1F-4A59-B1D2-5D9C47A6F065"><!-- --></a> EXP-00113：不支持功能<span class="variable" translate="no">string</span> 。 <span class="variable" translate="no">string</span> <span class="variable" translate="no">string</span> 。无法导出<span class="variable" translate="no">string</span></dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>导出不包含此功能所需的支持。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>使用Oracle Data Pump Utility</p>
                     
                  </dd>
                  <dt class="dlterm"><a name="GUID-DF48625B-F309-41FF-8414-B31D39526C3B__GUID-6C5B816B-E987-485C-A7EF-D8EA7D309651"><!-- --></a> EXP-00114： <span class="variable" translate="no">string</span> <span class="variable" translate="no">string</span>长度超过最大限制</dt>
                  <dd>
                     
                     <p>
                        <span class="keyword">原因：</span>提供的长度超过允许的最大限制。

                     </p>
                     
                  </dd>
                  <dd class="ddexpand">
                     
                     <p>
                        <span class="keyword">操作：</span>检查输入值并提供正确的值。

                     </p>
                     
                  </dd>
               </dl>
            </div>
         </div>
      </article>
   </body>
</html><html id="13052.tuning-program-global-area.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>调整计划全球区域</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Performance Tuning Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Performance Tuning Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-performance-tuning-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-12T22:26:14-07:00"></meta>
      <meta name="dcterms.title" content="Database Performance Tuning Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96347-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="tuning-result-cache.html" title="Previous" type="text/html"></link>
      <link rel="next" href="part-IV-managing-system-resources.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGDBA"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="tuning-result-cache.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="part-IV-managing-system-resources.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库性能调优指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-III-tuning-database-memory.html" property="item" typeof="WebPage"><span property="name">调整数据库内存</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">调整计划全球区域</li>
            </ol>
            <a id="GUID-FE1954FB-FAC9-4302-896E-6F47EB6C8A73" name="GUID-FE1954FB-FAC9-4302-896E-6F47EB6C8A73"></a><a id="TGDBA346"></a>
            
            <h2 id="TGDBA-GUID-FE1954FB-FAC9-4302-896E-6F47EB6C8A73" class="sect2"><span class="enumeration_chapter">16</span>调整计划全球区域</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何调整程序全局区域（PGA）。如果使用自动内存管理来管理系统上的数据库内存，则无需按本章所述手动调整PGA。</p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="tuning-program-global-area.html#GUID-C698E2D4-495D-4DD7-AB7F-916F9C6EE8D1">关于计划全球区域</a></p>
                  </li>
                  <li>
                     <p><a href="tuning-program-global-area.html#GUID-251F5619-7D47-492F-8B9B-C2BA6BA3BA66">使用自动内存管理调整程序全局区域的大小</a></p>
                  </li>
                  <li>
                     <p><a href="tuning-program-global-area.html#GUID-C1796FFD-5A7E-4FA7-945B-4B6CE374091A">使用硬限制调整程序全局区域的大小</a></p>
                  </li>
               </ul>
            </div><a id="TGDBA347"></a><div class="props_rev_3"><a id="GUID-C698E2D4-495D-4DD7-AB7F-916F9C6EE8D1" name="GUID-C698E2D4-495D-4DD7-AB7F-916F9C6EE8D1"></a><h3 id="TGDBA-GUID-C698E2D4-495D-4DD7-AB7F-916F9C6EE8D1" class="sect3"><span class="enumeration_section">16.1</span>关于计划全球区域</h3>
               <div>
                  <p>程序全局区域（PGA）是一个私有内存区域，包含服务器进程的数据和控制信息。只有服务器进程才能访问PGA。 Oracle数据库代表服务器进程在PGA中读取和写入信息。这种信息的一个例子是光标的运行时区域。每次执行游标时，都会在执行该游标的服务器进程的PGA内存区域中为该游标创建一个新的运行时区域。</p>
                  <div class="infoboxnote" id="GUID-C698E2D4-495D-4DD7-AB7F-916F9C6EE8D1__GUID-40D90668-E3DC-4E57-8B68-198A7C0A5593">
                     <p class="notep1">注意：</p>
                     <p>使用共享服务器时，部分运行时区域可位于共享全局区域（SGA）中。</p>
                  </div>
                  <p>对于复杂查询（例如决策支持查询），运行时区域的很大一部分专用于由内存密集型操作员分配的工作区域，包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>基于排序的运算符，例如<code class="codeph">ORDER</code> <code class="codeph">BY</code> ， <code class="codeph">GROUP</code> <code class="codeph">BY</code> ， <code class="codeph">ROLLUP</code>和窗口函数</p>
                     </li>
                     <li>
                        <p>哈希联接</p>
                     </li>
                     <li>
                        <p>位图合并</p>
                     </li>
                     <li>
                        <p>位图创建</p>
                     </li>
                     <li>
                        <p>写入批量加载操作使用的缓冲区</p>
                     </li>
                  </ul>
                  <p>排序运算符使用工作区（排序区域）来执行一组行的内存中排序。类似地，散列连接运算符使用工作区（散列区）从其左输入构建散列表。</p>
               </div><a id="TGDBA469"></a><div class="props_rev_3"><a id="GUID-41CAC946-617F-4708-A3C2-EFF28CCD0C5F" name="GUID-41CAC946-617F-4708-A3C2-EFF28CCD0C5F"></a><h4 id="TGDBA-GUID-41CAC946-617F-4708-A3C2-EFF28CCD0C5F" class="sect4"><span class="enumeration_section">16.1.1</span>工作区大小</h4>
                  <div>
                     <p>Oracle数据库使您可以控制和调整大小<a id="d49029e207" class="indexterm-anchor"></a><a id="d49029e211" class="indexterm-anchor"></a>工作区。通常，较大的工作区域可以以较高的存储器消耗为代价显着改善特定操作员的性能。可用的工作区域大小包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>最佳</p>
                           <p>最佳大小是当工作区的大小足够大以至于它可以容纳由其关联的SQL运算符分配的输入数据和辅助存储器结构时。这是工作区的理想尺寸。</p>
                        </li>
                        <li>
                           <p>一号通</p>
                           <p>一次通过大小是当工作区的大小低于最佳大小并且在部分输入数据上执行额外通过时。使用一次通过大小，响应时间增加。</p>
                        </li>
                        <li>
                           <p>多通</p>
                           <p>多次通过大小是指工作区域的大小低于一次通过阈值并且需要多次通过输入数据。对于多次通过大小，响应时间显着增加，因为与输入数据大小相比，工作区域的大小太小。</p>
                        </li>
                     </ul>
                     <p>例如，必须对10 GB数据进行排序的串行排序操作需要多于10 GB才能以最佳大小运行，并且至少需要40 MB才能作为一次通过大小运行。如果工作区小于40 MB，则排序操作必须对输入数据执行多次传递。</p>
                     <p>在确定工作区域大小时，目标是让大多数工作区域以最佳大小运行（纯OLTP系统超过90％，甚至100％），并且只有少数工作区域以一次通过大小运行（小于10％）。应避免多次执行，原因如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>多次执行会严重降低性能。</p>
                           <p>大量的多遍工作区域对其关联的SQL运算符的响应时间具有指数级的不利影响。</p>
                        </li>
                        <li>
                           <p>运行一次执行不需要大量内存。</p>
                           <p>在一次通过大小中排序1 GB数据只需要22 MB。</p>
                        </li>
                     </ul>
                     <p>即使对于运行大型排序和散列连接的DSS系统，一次执行的内存要求也相对较小。配置有合理数量的PGA存储器的系统不需要对输入数据执行多次传递。</p>
                  </div>
               </div>
            </div><a id="TGDBA363"></a><div class="props_rev_3"><a id="GUID-251F5619-7D47-492F-8B9B-C2BA6BA3BA66" name="GUID-251F5619-7D47-492F-8B9B-C2BA6BA3BA66"></a><h3 id="TGDBA-GUID-251F5619-7D47-492F-8B9B-C2BA6BA3BA66" class="sect3"><span class="enumeration_section">16.2</span>使用自动内存管理调整程序全局区域大小</h3>
               <div>
                  <p>自动PGA内存管理简化并改进了PGA内存的分配方式。默认情况下，启用PGA内存管理。在此模式下，Oracle数据库通过动态调整专用于工作区的PGA内存部分，根据SGA内存大小的20％自动调整PGA的大小。最小值为10MB。</p>
                  <div class="infoboxnote" id="GUID-251F5619-7D47-492F-8B9B-C2BA6BA3BA66__GUID-63A3F267-DED8-4F6D-A1E8-4B6D75E76882">
                     <p class="notep1">注意：</p>
                     <p>为了向后兼容，可以通过将<code class="codeph">PGA_AGGREGATE_TARGET</code>初始化参数的值设置为0来禁用自动PGA内存管理。禁用自动PGA内存管理时，可以使用关联的<code class="codeph">_AREA_SIZE</code>参数（例如<code class="codeph">SORT_AREA_SIZE</code>初始化参数）调整工作区的最大大小。
                     </p>
                  </div>
                  <p>本节介绍如何使用自动PGA内存管理调整PGA的大小，并包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="tuning-program-global-area.html#GUID-6D7A1290-77B1-4388-BA84-73B8594DCF44">配置自动PGA内存管理</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-program-global-area.html#GUID-7A3C7085-C5F9-4E02-A57D-FDC491723FAD">设置PGA_AGGREGATE_TARGET的初始值</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-program-global-area.html#GUID-903DB64B-3019-4272-8812-4F00A05371FB">监控自动PGA内存管理</a></p>
                     </li>
                     <li>
                        <p><a href="tuning-program-global-area.html#GUID-C8C6D009-CF38-4996-AD0E-D97CE0CECE3D">调整PGA_AGGREGATE_TARGET</a></p>
                     </li>
                  </ul>
               </div><a id="TGDBA470"></a><div class="props_rev_3"><a id="GUID-6D7A1290-77B1-4388-BA84-73B8594DCF44" name="GUID-6D7A1290-77B1-4388-BA84-73B8594DCF44"></a><h4 id="TGDBA-GUID-6D7A1290-77B1-4388-BA84-73B8594DCF44" class="sect4"><span class="enumeration_section">16.2.1</span>配置自动PGA内存管理</h4>
                  <div>
                     <div class="section">
                        <p>在自动PGA内存管理模式下运行Oracle数据库时，会自动调整所有会话的工作区大小，并且在此模式下运行的所有会话都会忽略<code class="codeph">*_AREA_SIZE</code>参数。Oracle数据库自动从<code class="codeph">PGA_AGGREGATE_TARGET</code>初始化参数派生可用于活动工作区的PGA内存总量。PGA内存量设置为<code class="codeph">PGA_AGGREGATE_TARGET</code>的值减去分配给系统其他组件的PGA内存量（例如会话分配的PGA内存）。然后，Oracle数据库根据特定的内存要求将生成的PGA内存分配给各个活动工作区。
                        </p>
                        <p>Oracle数据库尝试通过动态控制分配给工作区的PGA内存量来遵守DBA设置的<code class="codeph">PGA_AGGREGATE_TARGET</code>值。为此，Oracle数据库首先尝试最大化所有内存密集型SQL操作的最佳工作区数。其余工作区域以单通道模式执行，除非DBA设置的PGA内存限制（使用<code class="codeph">PGA_AGGREGATE_TARGET</code>参数）非常低，因此需要多次执行才能减少内存消耗以符合PGA目标限制。
                        </p>
                        <p>配置新数据库实例时，可能很难确定<code class="codeph">PGA_AGGREGATE_TARGET</code>的相应设置。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6D7A1290-77B1-4388-BA84-73B8594DCF44__GUID-8405E02C-0202-4078-943E-D694E85F4A92">配置自动PGA内存管理：</p>
                        <ol>
                           <li>
                              <p>对<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值进行初始估计，如<span class="q">“ <a href="tuning-program-global-area.html#GUID-7A3C7085-C5F9-4E02-A57D-FDC491723FAD">设置PGA_AGGREGATE_TARGET的初始值</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>在数据库实例上运行代表性工作负载并监视其性能，如<span class="q">“ <a href="tuning-program-global-area.html#GUID-903DB64B-3019-4272-8812-4F00A05371FB">监视自动PGA内存管理</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>调优的价值<code class="codeph">PGA_AGGREGATE_TARGET</code>为<span class="q">“</span>中所述使用Oracle PGA建议统计参数， <span class="q"><a href="tuning-program-global-area.html#GUID-C8C6D009-CF38-4996-AD0E-D97CE0CECE3D">调整PGA_AGGREGATE_TARGET</a> ”。</span>
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-6D7A1290-77B1-4388-BA84-73B8594DCF44__GUID-1253D2F9-042A-4B72-A7D5-8D238D964AD8">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">PGA_AGGREGATE_TARGET</code>初始化参数的信息，请<a href="../refrn/PGA_AGGREGATE_TARGET.html#REFRN-GUID-DEBBD3F7-9F6D-4AC8-952C-0E0B2E62312D" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGDBA471"></a><div class="props_rev_3"><a id="GUID-7A3C7085-C5F9-4E02-A57D-FDC491723FAD" name="GUID-7A3C7085-C5F9-4E02-A57D-FDC491723FAD"></a><h4 id="TGDBA-GUID-7A3C7085-C5F9-4E02-A57D-FDC491723FAD" class="sect4"><span class="enumeration_section">16.2.2</span>设置PGA_AGGREGATE_TARGET的初始值</h4>
                  <div>
                     <div class="section">
                        <p>根据Oracle数据库实例的可用内存量设置<code class="codeph">PGA_AGGREGATE_TARGET</code>初始化参数的初始值。然后可以在实例级别调整并动态修改此值。默认情况下，Oracle数据库使用20％的SGA大小作为此值。但是，对于大型DSS系统，此设置可能太低。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7A3C7085-C5F9-4E02-A57D-FDC491723FAD__GUID-7CA439E8-F6B9-495E-9C16-83E5F943C09A">要设置PGA_AGGREGATE_TARGET的初始值：</p>
                        <ol>
                           <li>
                              <p>确定为同一系统上运行的操作系统和其他非Oracle应用程序保留的总物理内存量。</p>
                              <p>例如，您可能决定为操作系统和其他非Oracle应用程序保留总物理内存的20％，将系统内80％的内存专用于Oracle数据库实例。</p>
                           </li>
                           <li>
                              <p>除以SGA和PGA之间的剩余可用内存：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>对于OLTP系统，PGA内存通常占可用内存的一小部分，剩余大部分内存用于SGA。</p>
                                    <p>Oracle建议最初将20％的可用内存分配给PGA，将80％分配给SGA。因此，OLTP系统的<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的初始值可以计算为：</p>
                                    <p><code class="codeph">PGA_AGGREGATE_TARGET</code> =（ <span class="italic"><code class="codeph">total_mem</code></span> * 0.8）* 0.2其中<span class="italic"><code class="codeph">total_mem</code></span>是系统上可用的物理内存总量。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于运行大量内存密集型查询的DSS系统，PGA内存通常可以使用高达70％的可用内存。</p>
                                    <p>Oracle建议最初将50％的可用内存分配给PGA，将50％分配给SGA。因此，DSS系统的<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的初始值可以计算为：</p>
                                    <p><code class="codeph">PGA_AGGREGATE_TARGET</code> =（ <span class="italic"><code class="codeph">total_mem</code></span> * 0.8）* 0.5其中<span class="italic"><code class="codeph">total_mem</code></span>是系统上可用的物理内存总量。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>例如，如果Oracle数据库实例配置为在具有4 GB物理内存的系统上运行，并且如果80％（或3.2 GB）内存专用于Oracle数据库实例，则最初将<code class="codeph">PGA_AGGREGATE_TARGET</code>设置为640 MB OLTP系统，或DSS系统1,600 MB。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGDBA472"></a><div class="props_rev_3"><a id="GUID-903DB64B-3019-4272-8812-4F00A05371FB" name="GUID-903DB64B-3019-4272-8812-4F00A05371FB"></a><h4 id="TGDBA-GUID-903DB64B-3019-4272-8812-4F00A05371FB" class="sect4"><span class="enumeration_section">16.2.3</span>监控自动PGA内存管理</h4>
                  <div>
                     <p>在开始调整过程之前，在数据库实例上运行代表性工作负载并监视其性能。Oracle数据库收集的PGA统计信息使您可以确定最大PGA大小是否配置不足或配置过多。通过监视这些统计信息，您可以评估自动PGA内存管理的性能，并相应地调整<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值。
                     </p>
                     <p>本节介绍如何使用性能视图监视自动PGA内存管理，并包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-892FC04E-16ED-435D-8DF3-8B74A379993B">使用V $ PGASTAT视图</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-9C657D3F-C162-46E1-AC5A-BFF7AAA3B3BA">使用V $ PROCESS视图</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-B837C371-5384-49B5-9C6D-12982A8DF3BD">使用V $ PROCESS_MEMORY视图</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-58B5CC9D-1B5D-4A1E-8417-C6C18FD06811">使用V $ SQL_WORKAREA_HISTOGRAM视图</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-E2A9A057-60C3-4021-B6AC-8ECA79049CD5">使用V $ WORKAREA_ACTIVE视图</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-060EB774-7876-40E3-B690-03409346AA9A">使用V $ SQL_WORKAREA视图</a></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA475"></a><a id="TGDBA474"></a><a id="TGDBA476"></a><a id="TGDBA473"></a><div class="props_rev_3"><a id="GUID-892FC04E-16ED-435D-8DF3-8B74A379993B" name="GUID-892FC04E-16ED-435D-8DF3-8B74A379993B"></a><h5 id="TGDBA-GUID-892FC04E-16ED-435D-8DF3-8B74A379993B" class="sect5"><span class="enumeration_section">16.2.3.1</span>使用V $ PGASTAT视图</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">V$PGASTAT</code>视图提供有关PGA内存使用情况和自动PGA内存管理器的实例级统计信息。
                           </p>
                           <p>以下示例显示了此视图的查询。</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM V $ PGASTAT;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">NAME VALUE UNIT ----------------------------------------------- --------- ---------- ------------聚合PGA目标参数41156608字节聚合PGA自动目标21823488字节全局内存绑定2057216字节总PGA使用16899072字节总PGA分配35014656字节最大PGA分配136795136字节总可用PGA内存524288字节PGA内存释放回OS 1713242112字节总PGA用于自动工作区0字节最大PGA用于自动工作区2383872字节总PGA用于手动工作区0字节最大PGA用于手动工作区域8470528字节超过分配计数291字节处理2124600320字节额外字节读取/写入39949312字节高速缓存命中百分比98.15％</pre><p><a href="tuning-program-global-area.html#GUID-892FC04E-16ED-435D-8DF3-8B74A379993B__BGBFJJBJ" title="描述V $ PGASTAT视图中显示的主要统计信息。">表16-1</a>描述了<code class="codeph">V$PGASTAT</code>视图中显示的主要统计信息。
                           </p>
                           <div class="tblformal" id="GUID-892FC04E-16ED-435D-8DF3-8B74A379993B__BGBFJJBJ">
                              <p class="titleintable">表16-1 V $ PGASTAT视图中的统计信息</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="V $ PGASTAT视图中的统计信息" width="100%" border="1" summary="Describes the main statistics shown in the V$PGASTAT view." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="31%" id="d49029e741">统计</th>
                                       <th align="left" valign="bottom" width="69%" id="d49029e744">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d49029e749" headers="d49029e741 ">
                                          <p><code class="codeph">聚合PGA目标参数</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d49029e749 d49029e744 ">
                                          <p>此统计信息显示<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的当前值。默认值为SGA大小的20％。将此参数设置为0将禁用自动PGA内存管理。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d49029e760" headers="d49029e741 ">
                                          <p><code class="codeph">聚合PGA自动目标</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d49029e760 d49029e744 ">
                                          <p>此统计信息显示Oracle数据库可用于在自动模式下运行的工作区的PGA内存量。此数量是从<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值和当前工作区工作负载动态派生的。因此，它由Oracle数据库不断调整。如果此值与<code class="codeph">PGA_AGGREGATE_TARGET</code>值相比较小，那么大多数PGA内存将被其他系统组件（例如PL / SQL或Java）使用，并且很少留给工作区域。确保在自动模式下运行的工作区域保留足够的PGA内存。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d49029e774" headers="d49029e741 ">
                                          <p><code class="codeph">全局记忆界限</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d49029e774 d49029e744 ">
                                          <p>此统计信息显示在自动模式下执行的工作区的最大大小。Oracle数据库不断调整此值以反映工作区工作负载的当前状态。当系统中活动工作区域的数量增加时，全局存储器限制通常会减少。根据经验，全局边界的值不应减少到小于1 MB。如果是，请增加<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d49029e785" headers="d49029e741 ">
                                          <p><code class="codeph">分配的总PGA</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d49029e785 d49029e744 ">
                                          <p>此统计信息显示数据库实例分配的当前PGA内存量。Oracle数据库尝试将此数字保持为小于<code class="codeph">PGA_AGGREGATE_TARGET</code>值。但是，如果工作区工作负载快速增加或者<code class="codeph">PGA_AGGREGATE_TARGET</code>参数设置为过低的值，则分配的PGA可能会在短时间内超过此值一小部分。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d49029e799" headers="d49029e741 ">
                                          <p><code class="codeph">总可用PGA内存</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d49029e799 d49029e744 ">
                                          <p>此统计信息表示可以释放多少分配的PGA内存。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d49029e807" headers="d49029e741 ">
                                          <p><code class="codeph">用于汽车工作区的总PGA</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d49029e807 d49029e744 ">
                                          <p>此统计信息表示在自动模式下运行的工作区当前消耗了多少PGA内存。使用此数字可确定PGA内存的其他使用者（例如PL / SQL或Java）消耗了多少内存：</p><pre class="oac_no_warn" dir="ltr">PGA其他=分配的总PGA  - 用于自动工作区的总PGA</pre></td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d49029e817" headers="d49029e741 ">
                                          <p><code class="codeph">超额分配数</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d49029e817 d49029e744 ">
                                          <p>此统计信息是从实例启动累积的。如果<code class="codeph">PGA_AGGREGATE_TARGET</code>值太小而无法容纳<code class="codeph">PGA other</code>组件以及执行工作区工作负载所需的最小内存，则可能会发生过度分配PGA内存。在这种情况下，Oracle数据库无法<code class="codeph">PGA_AGGREGATE_TARGET</code>值，必须分配额外的PGA内存。如果发生过度分配，请使用<code class="codeph">V$PGA_TARGET_ADVICE</code>视图提供的信息增加<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值，如<span class="q">“ <a href="tuning-program-global-area.html#GUID-4ED57621-B8D5-438C-A1CB-B5204A6C0427">使用V $ PGA_TARGET_ADVICE视图</a> ”中所述</span> 。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d49029e846" headers="d49029e741 ">
                                          <p><code class="codeph">处理的总字节数</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d49029e846 d49029e744 ">
                                          <p>此统计信息表示自实例启动以来内存密集型SQL运算符处理的字节数。例如，处理的字节数是排序操作的输入大小。此数字用于计算<code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>度量标准。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d49029e863" headers="d49029e741 ">
                                          <p><code class="codeph">额外的字节读/写</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d49029e863 d49029e744 ">
                                          <p>当工作区域无法以最佳方式运行时，将对输入数据执行一次或多次额外传递。此统计信息表示自实例启动以来在这些额外传递期间处理的字节数。此数字还用于计算<code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>度量标准。理想情况下，与<code class="codeph">total bytes processed</code>相比，它应该很小。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d49029e883" headers="d49029e741 ">
                                          <p><code class="codeph">缓存命中百分比</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d49029e883 d49029e744 ">
                                          <p>该指标由Oracle数据库计算，以反映PGA内存组件的性能。它是从实例启动累积的。值100％表示自实例启动以来系统执行的所有工作区都使用最佳数量的PGA内存。这是理想的，但除了纯OLTP系统外很少发生。通常，某些工作区域运行一次通过甚至多次通过，具体取决于PGA内存的总体大小。当工作区域无法以最佳方式运行时，将对输入数据执行一次或多次额外传递。这会降低<code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code> ，与输入数据的大小和执行的额外通过次数成比例。有关如何计算此度量标准的示例，请参见<a href="tuning-program-global-area.html#GUID-892FC04E-16ED-435D-8DF3-8B74A379993B__BGBECDGE">示例16-1</a> 。
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p><a href="tuning-program-global-area.html#GUID-892FC04E-16ED-435D-8DF3-8B74A379993B__BGBECDGE">例16-1</a>显示了额外传递如何影响<code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>度量标准。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-892FC04E-16ED-435D-8DF3-8B74A379993B__BGBECDGE">
                           <p class="titleinexample">例16-1计算缓存命中百分比</p>
                           <p>已执行四种排序操作，三种是小型（1 MB输入数据），另一种是更大（100 MB输入数据）。四个操作处理的总字节数（BP）为103 MB。如果其中一个小类运行一次通过，则执行超过1 MB输入数据的额外通过。此1 MB值是<code class="codeph">read/written</code>的<code class="codeph">extra</code> <code class="codeph">bytes</code>数或EBP。</p>
                           <p><code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>使用以下公式计算：</p><pre class="oac_no_warn" dir="ltr">BP x 100 /（BP + EBP）</pre><p>在此示例中， <code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>为99.03％。该值反映了只有一个小型排序操作执行了额外的传递，而所有其他排序操作都能够以最佳大小运行。因此， <code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>几乎是100％，因为超过1 MB的额外传递代表一个微小的开销。但是，如果较大的排序操作以一次通过大小运行，则EBP为100 MB而不是1 MB，并且<code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>降至50.73％，因为额外的通过具有更大的影响。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="TGDBA478"></a><a id="TGDBA477"></a><div class="props_rev_3"><a id="GUID-9C657D3F-C162-46E1-AC5A-BFF7AAA3B3BA" name="GUID-9C657D3F-C162-46E1-AC5A-BFF7AAA3B3BA"></a><h5 id="TGDBA-GUID-9C657D3F-C162-46E1-AC5A-BFF7AAA3B3BA" class="sect5"><span class="enumeration_section">16.2.3.2</span>使用V $ PROCESS视图</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">V$PROCESS</code>视图为连接到数据库实例的每个Oracle进程包含一行。使用此视图中的以下列来监视这些进程的PGA内存使用情况：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">PGA_USED_MEM</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">PGA_ALLOC_MEM</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">PGA_FREEABLE_MEM</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">PGA_MAX_MEM</code></p>
                              </li>
                           </ul>
                           <p><a href="tuning-program-global-area.html#GUID-9C657D3F-C162-46E1-AC5A-BFF7AAA3B3BA__BGBFGAGD">例16-2</a>显示了该视图的查询。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-9C657D3F-C162-46E1-AC5A-BFF7AAA3B3BA__BGBFGAGD">
                           <p class="titleinexample">例16-2查询V $ PROCESS视图</p><pre class="oac_no_warn" dir="ltr">SELECT程序，pga_used_mem，pga_alloc_mem，pga_freeable_mem，pga_max_mem FROM V $ PROCESS;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">PROGRAM PGA_USED_MEM PGA_ALLOC_MEM PGA_FREEABLE_MEM PGA_MAX_MEM ----------------------- ------------ ---------- --- ---------------- ----------- PSEUDO 0 0 0 0 oracle @ examp1690（PMON）314540 685860 0 685860 oracle @ examp1690（MMAN ）313992 685860 0 685860 oracle @ examp1690（DBW0）696720 1063112 0 1063112 oracle @ examp1690（LGWR）10835108 22967940 0 22967940 oracle @ examp1690（CKPT）352716 710376 0 710376 oracle @ examp1690（SMON）541508 948004 0 1603364 oracle @ examp1690（RECO ）323688 685860 0 816932 oracle @ examp1690（q001）233508 585128 0 585128 oracle @ examp1690（QMNC）314332 685860 0 685860 oracle @ examp1690（MMON）885756 1996548 393216 1996548 oracle @ examp1690（MMNL）315068 685860 0 685860 oracle @ examp1690（q000 ）330872 716200 65536 716200 oracle @ examp1690（CJQ0）533476 1013540 0 1144612</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="TGDBA479"></a><div class="props_rev_3"><a id="GUID-B837C371-5384-49B5-9C6D-12982A8DF3BD" name="GUID-B837C371-5384-49B5-9C6D-12982A8DF3BD"></a><h5 id="TGDBA-GUID-B837C371-5384-49B5-9C6D-12982A8DF3BD" class="sect5"><span class="enumeration_section">16.2.3.3</span>使用V $ PROCESS_MEMORY视图</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">V$PROCESS_MEMORY</code>视图按每个Oracle进程的命名组件类别显示动态PGA内存使用情况。此视图最多包含每个Oracle进程的六行，一行用于：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>每个命名的组件类别：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>Java的</p>
                                    </li>
                                    <li>
                                       <p>PL / SQL</p>
                                    </li>
                                    <li>
                                       <p>OLAP</p>
                                    </li>
                                    <li>
                                       <p>SQL</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Freeable</p>
                                 <p>已由操作系统分配给进程的内存，但不是特定类别的内存</p>
                              </li>
                              <li>
                                 <p>其他</p>
                                 <p>已分配给类别但未分配给命名类别的内存</p>
                              </li>
                           </ul>
                           <p>使用此视图中的以下列可动态监视六个类别中每个类别的Oracle进程的PGA内存使用情况：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">类别</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">ALLOCATED</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">用过的</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">MAX_ALLOCATED</code></p>
                              </li>
                           </ul>
                           <div class="infoboxnote" id="GUID-B837C371-5384-49B5-9C6D-12982A8DF3BD__GUID-7AE26004-F418-47DC-B893-F928457DD4BF">
                              <p class="notep1">注意：</p>
                              <p><code class="codeph">V$PROCESS_MEMORY_DETAIL</code>视图显示超过500 MB PGA使用率的Oracle进程的动态PGA内存使用情况。从Oracle Database 12 <span class="italic">c</span>第2版开始，可以使用<code class="codeph">V$PROCESS_MEMORY_DETAIL</code>视图。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-B837C371-5384-49B5-9C6D-12982A8DF3BD__GUID-518C46AB-7937-4422-B512-AE93AE46C1E0">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<a href="../refrn/V-PROCESS_MEMORY_DETAIL.html#REFRN-GUID-D16BB4C3-C11D-4EAD-BA06-F96A5450F8E8" target="_blank"><code class="codeph">V$PROCESS_MEMORY</code></a>和<a href="../refrn/V-PROCESS_MEMORY_DETAIL.html#REFRN-GUID-D16BB4C3-C11D-4EAD-BA06-F96A5450F8E8" target="_blank"><code class="codeph">V$PROCESS_MEMORY_DETAIL</code></a>视图的详细信息，请<span class="italic">参见Oracle数据库参考</span></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA481"></a><a id="TGDBA482"></a><a id="TGDBA480"></a><div class="props_rev_3"><a id="GUID-58B5CC9D-1B5D-4A1E-8417-C6C18FD06811" name="GUID-58B5CC9D-1B5D-4A1E-8417-C6C18FD06811"></a><h5 id="TGDBA-GUID-58B5CC9D-1B5D-4A1E-8417-C6C18FD06811" class="sect5"><span class="enumeration_section">16.2.3.4</span>使用V $ SQL_WORKAREA_HISTOGRAM视图</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">V$SQL_WORKAREA_HISTOGRAM</code>视图显示自实例启动以来以最佳，一次通过和多次通过内存大小执行的工作区数。此视图中的统计信息分为多个桶。存储桶由工作区域的最佳存储器要求定义。每个存储桶由一系列最佳内存要求标识，由<code class="codeph">LOW_OPTIMAL_SIZE</code>和<code class="codeph">HIGH_OPTIMAL_SIZE</code>列中的值指定。
                           </p>
                           <p>例如，排序操作可能需要3 MB内存才能以最佳大小运行（缓存）。有关此排序操作使用的工作区的统计信息放在由以下内容定义的存储区中：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">LOW_OPTIMAL_SIZE</code> = 2097152（2 MB）</p>
                              </li>
                              <li>
                                 <p><code class="codeph">HIGH_OPTIMAL_SIZE</code> = 4194303（4 MB减去1个字节）</p>
                              </li>
                           </ul>
                           <p>统计数据按工作区大小进行细分，因为以最佳，一次通过或多次通过大小运行工作区的性能影响主要取决于工作区的大小。在此示例中，有关工作区的统计信息放在此存储桶中，因为3 MB位于此最佳大小范围内。</p>
                           <p><a href="tuning-program-global-area.html#GUID-58B5CC9D-1B5D-4A1E-8417-C6C18FD06811__BGBBCAEC">例16-3</a>和<a href="tuning-program-global-area.html#GUID-58B5CC9D-1B5D-4A1E-8417-C6C18FD06811__BGBIFJDF">例16-4</a>显示了查询该视图的两种方法。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-58B5CC9D-1B5D-4A1E-8417-C6C18FD06811__BGBBCAEC">
                           <p class="titleinexample">示例16-3查询V $ SQL_WORKAREA_HISTOGRAM视图：非空桶</p>
                           <p>以下查询显示所有非空桶的统计信息：</p><pre class="oac_no_warn" dir="ltr">SELECT low_optimal_size / 1024 low_kb，（high_optimal_size + 1）/ 1024 high_kb，optimal_executions，onepass_executions，multipasses_executions FROM V $ SQL_WORKAREA_HISTOGRAM WHERE total_executions！= 0;</pre><p>查询的结果可能如下所示：</p><pre class="oac_no_warn" dir="ltr">LOW_KB HIGH_KB OPTIMAL_EXECUTIONS ONEPASS_EXECUTIONS MULTIPASSES_EXECUTIONS ------ ------- ------------------ -------------- ---- ---------------------- 8 16 156255 0 0 16 32 150 0 0 32 64 89 0 0 64 128 13 0 0 128 256 60 0 0 256 512 8 0 0 512 1024 657 0 0 1024 2048 551 16 0 2048 4096 538 26 0 4096 8192 243 28 0 8192 16384 137 35 0 16384 32768 45 107 0 32768 65536 0 153 0 65536 131072 0 73 0 131072 262144 0 44 0 262144 524288 0 22 0</pre><p>在此示例中，输出显示 - 在1 MB到2 MB的bucket-551工作区中以最佳大小运行，而16个以一次通过大小运行且没有以多次通过大小运行。它还表明，1 MB以下的所有工作区域都能够以最佳尺寸运行。</p>
                        </div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-58B5CC9D-1B5D-4A1E-8417-C6C18FD06811__BGBIFJDF">
                           <p class="titleinexample">示例16-4查询V $ SQL_WORKAREA_HISTOGRAM视图：最佳百分比</p>
                           <p>以下查询显示自启动以来以最佳，一次通过或多次通过大小执行工作区的次数百分比。此查询仅考虑特定大小的工作区域，最佳内存要求至少为64 KB：</p><pre class="oac_no_warn" dir="ltr">SELECT optimal_count，ROUND（optimal_count * 100 / total，2）optimal_perc，onepass_count，ROUND（onepass_count * 100 / total，2）onepass_perc，multipass_count，ROUND（multipass_count * 100 / total，2）multipass_perc FROM（SELECT DECODE（SUM（total_executions） ），0,1，SUM（total_executions））total，SUM（optimal_executions）optimal_count，SUM（onepass_executions）onepass_count，SUM（multipass_executions）multipass_count FROM V $ SQL_WORKAREA_HISTOGRAM WHERE low_optimal_size&gt; = 64 * 1024）;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">OPTIMAL_COUNT OPTIMAL_PERC ONEPASS_COUNT ONEPASS_PERC MULTIPASS_COUNT MULTIPASS_PERC ------------- ------------ ------------- ------ ------ --------------- -------------- 2239 81.63 504 18.37 0 0</pre><p>在此示例中，输出显示81.63％的工作区域能够以最佳大小运行。剩余的工作区域（18.37％）以一次通过的尺寸运行，并且没有一个以多次通过尺寸运行。</p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="TGDBA484"></a><a id="TGDBA483"></a><div class="props_rev_3"><a id="GUID-E2A9A057-60C3-4021-B6AC-8ECA79049CD5" name="GUID-E2A9A057-60C3-4021-B6AC-8ECA79049CD5"></a><h5 id="TGDBA-GUID-E2A9A057-60C3-4021-B6AC-8ECA79049CD5" class="sect5"><span class="enumeration_section">16.2.3.5</span>使用V $ WORKAREA_ACTIVE视图</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">V$WORKAREA_ACTIVE</code>视图显示数据库实例中活动（或执行）的工作区。此视图中排除了小的活动排序操作（低于64 KB）。使用此视图可精确监控所有活动工作区的大小，并确定这些活动工作区是否溢出到临时段。
                           </p>
                           <p><a href="tuning-program-global-area.html#GUID-E2A9A057-60C3-4021-B6AC-8ECA79049CD5__BGBDHADJ">例16-5</a>显示了该视图的查询。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-E2A9A057-60C3-4021-B6AC-8ECA79049CD5__BGBDHADJ">
                           <p class="titleinexample">示例16-5查询V $ WORKAREA_ACTIVE视图</p><pre class="oac_no_warn" dir="ltr">SELECT TO_NUMBER（DECODE（sid，65535，null，sid））sid，operation_type操作，TRUNC（expected_size / 1024）esize，TRUNC（actual_mem_used / 1024）mem，TRUNC（max_mem_used / 1024）“max mem”，number_passes pass，TRUNC （TEMPSEG_SIZE / 1024）tsize FROM V $ SQL_WORKAREA_ACTIVE ORDER BY 1,2;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">SID OPERATION ESIZE MEM MAX MEM PASS TSIZE --- ----------------- --------- --------- ---- ----- ----- ------- 8 GROUP BY（SORT）315 280 904 0 8 HASH-JOIN 2995 2377 2430 1 20000 9 GROUP BY（SORT）34300 22688 22688 0 11 HASH-JOIN 18044 54482 54482 0 12 HASH-JOIN 18044 11406 21406 1 120000</pre><p>在此示例中，输出显示：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>会话12（ <code class="codeph">SID</code>列）在以一次通过大小运行的工作区中运行散列连接操作（ <code class="codeph">OPERATION</code>列）（ <code class="codeph">PASS</code>列）</p>
                              </li>
                              <li>
                                 <p>PGA内存管理器期望此散列连接操作使用的最大内存量为18044 KB（ <code class="codeph">ESIZE</code>列）</p>
                              </li>
                              <li>
                                 <p>工作区目前使用11406 KB内存（ <code class="codeph">MEM</code>列）</p>
                              </li>
                              <li>
                                 <p>工作区域过去使用了高达21406 KB的PGA存储器（ <code class="codeph">MAX</code> <code class="codeph">MEM</code>列）</p>
                              </li>
                              <li>
                                 <p>工作区域溢出到120000 KB的临时段（ <code class="codeph">TSIZE</code>列）</p>
                              </li>
                           </ul>
                           <p>当工作区被释放时 - 或者当其关联的SQL运算符的执行完成时 - 它将自动从该视图中删除。</p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="TGDBA486"></a><a id="TGDBA485"></a><div class="props_rev_3"><a id="GUID-060EB774-7876-40E3-B690-03409346AA9A" name="GUID-060EB774-7876-40E3-B690-03409346AA9A"></a><h5 id="TGDBA-GUID-060EB774-7876-40E3-B690-03409346AA9A" class="sect5"><span class="enumeration_section">16.2.3.6</span>使用V $ SQL_WORKAREA视图</h5>
                     <div>
                        <div class="section">
                           <p>Oracle数据库维护每个加载游标的累积工作区统计信息，其执行计划使用一个或多个工作区。每次取消分配工作区时， <code class="codeph">V$SQL_WORKAREA</code>使用该工作区的执行统计信息更新<code class="codeph">V$SQL_WORKAREA</code>视图。
                           </p>
                           <p>您可以使用<code class="codeph">V$SQL</code>视图加入<code class="codeph">V$SQL_WORKAREA</code>视图以将工作区与游标相关联，并使用<code class="codeph">V$SQL_PLAN</code>视图来精确确定计划中的哪个运算符使用工作区。
                           </p>
                           <p><a href="tuning-program-global-area.html#GUID-060EB774-7876-40E3-B690-03409346AA9A__BGBGHEAG">例16-6</a>显示了该视图的三个查询。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-060EB774-7876-40E3-B690-03409346AA9A__BGBGHEAG">
                           <p class="titleinexample">示例16-6查询V $ SQL_WORKAREA视图</p>
                           <p>以下查询查找需要最多缓存内存的前10个工作区：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM（SELECT workarea_address，operation_type，policy，estimated_optimal_size FROM V $ SQL_WORKAREA ORDER BY estimated_optimal_size DESC）WHERE ROWNUM &lt;= 10;</pre><p>以下查询查找具有一个或多个工作区的游标，这些工作区已在一个或多个传递中执行：</p><pre class="oac_no_warn" dir="ltr">col sql_text格式A80包装SELECT sql_text，sum（ONEPASS_EXECUTIONS）onepass_cnt，sum（MULTIPASSES_EXECUTIONS）mpass_cnt FROM V $ SQL s，V $ SQL_WORKAREA wa WHERE s.address = wa.address GROUP BY sql_text HAVING sum（ONEPASS_EXECUTIONS + MULTIPASSES_EXECUTIONS）&gt; 0;</pre><p>使用特定游标的哈希值和地址，以下查询显示游标执行计划，包括有关相关工作区的信息：</p><pre class="oac_no_warn" dir="ltr">col“O / 1 / M”格式a10列名格式a20 SELECT操作，选项，object_name名称，trunc（bytes / 1024/1024）“input（MB）”，TRUNC（last_memory_used / 1024）last_mem，TRUNC（estimated_optimal_size / 1024 ）optimal_mem，TRUNC（estimated_onepass_size / 1024）onepass_mem，DECODE（optimal_executions，null，null，optimal_executions ||'/'|| onepass_executions ||'/'|| multipasses_executions）“O / 1 / M”FROM V $ SQL_PLAN p， V $ SQL_WORKAREA w WHERE p.address = w.address（+）AND p.hash_value = w.hash_value（+）AND p.id = w.operation_id（+）AND p.address = '88BB460C'AND p.hash_value = 3738161960;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">操作选项名称输入（MB）LAST_MEM OPTIMAL_ME ONEPASS_ME O / 1 / M ------------ -------- -------- ------- -  -------- ---------- ---------- ------ SELECT STATE HASH GROUP BY 4582 8 16 16 16/0/0 HASH JOIN SEMI 4582 5976 5194 2187 16/0/0表访问全部订单51表访问FUL LINEITEM 1000</pre><p>您可以通过在查询中指定模式来从<code class="codeph">V$SQL</code>视图中获取地址和哈希值，如以下查询所示：</p><pre class="oac_no_warn" dir="ltr">SELECT地址，hash_value FROM V $ SQL WHERE sql_text LIKE'％ <span class="italic">my_pattern</span> ％';</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="TGDBA487"></a><div class="props_rev_3"><a id="GUID-C8C6D009-CF38-4996-AD0E-D97CE0CECE3D" name="GUID-C8C6D009-CF38-4996-AD0E-D97CE0CECE3D"></a><h4 id="TGDBA-GUID-C8C6D009-CF38-4996-AD0E-D97CE0CECE3D" class="sect4"><span class="enumeration_section">16.2.4</span>调整PGA_AGGREGATE_TARGET</h4>
                  <div>
                     <p>为了帮助您调整<code class="codeph">PGA_AGGREGATE_TARGET</code>初始化参数的值，Oracle数据库提供了两个PGA性能建议视图： <code class="codeph">V$PGA_TARGET_ADVICE</code>和<code class="codeph">V$PGA_TARGET_ADVICE_HISTOGRAM</code> 。通过使用这些视图，您无需使用经验方法来调整<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值。相反，您可以使用这些视图来预测更改<code class="codeph">PGA_AGGREGATE_TARGET</code>参数值将如何影响关键PGA统计信息。
                     </p>
                     <p>本节介绍如何调整<code class="codeph">PGA_AGGREGATE_TARGET</code>初始化参数的值，并包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-326DEB90-E13C-4511-8731-F8A37C4D83D6">启用自动生成PGA性能咨询视图</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-4ED57621-B8D5-438C-A1CB-B5204A6C0427">使用V $ PGA_TARGET_ADVICE视图</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-A2C80240-8436-42FC-B40F-B0358C955216">使用V $ PGA_TARGET_ADVICE_HISTOGRAM视图</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-1E3F26AD-1F4A-4188-B775-53429DE27963">使用V $ SYSSTAT和V $ SESSTAT视图</a></p>
                        </li>
                        <li>
                           <p><a href="tuning-program-global-area.html#GUID-BC6CBF45-EA12-44AE-AB84-EE7DF7B09DE8">教程：如何调整PGA_AGGREGATE_TARGET</a></p>
                        </li>
                     </ul>
                  </div><a id="TGDBA488"></a><div class="props_rev_3"><a id="GUID-326DEB90-E13C-4511-8731-F8A37C4D83D6" name="GUID-326DEB90-E13C-4511-8731-F8A37C4D83D6"></a><h5 id="TGDBA-GUID-326DEB90-E13C-4511-8731-F8A37C4D83D6" class="sect5"><span class="enumeration_section">16.2.4.1</span>启用自动生成PGA性能咨询视图</h5>
                     <div>
                        <div class="section">
                           <p>Oracle数据库通过记录工作负载历史记录生成<code class="codeph">V$PGA_TARGET_ADVICE</code>和<code class="codeph">V$PGA_TARGET_ADVICE_HISTOGRAM</code>视图，然后针对<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的不同值模拟此历史记录。<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值是从其当前值的分数和倍数导出的，以评估可能的更高和更低的值。这些值用于预测，范围从10 MB到最大256 GB。模拟过程在后台进行，并不断更新工作负载历史记录以生成模拟结果。您可以通过查询这些视图随时查看结果。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-326DEB90-E13C-4511-8731-F8A37C4D83D6__GUID-13320479-F08F-43BE-867D-2469FA60F3A2">要启用自动生成PGA性能建议视图：</p>
                           <ol>
                              <li>
                                 <p>设置<code class="codeph">PGA_AGGREGATE_TARGET</code>参数以启用自动PGA内存管理。
                                 </p>
                                 <p>将此参数设置为0将禁用自动PGA内存管理，不建议这样做。有关设置此参数的信息，请参阅<span class="q">“ <a href="tuning-program-global-area.html#GUID-7A3C7085-C5F9-4E02-A57D-FDC491723FAD">设置PGA_AGGREGATE_TARGET的初始值</a> ”</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">STATISTICS_LEVEL</code>参数设置为<code class="codeph">TYPICAL</code> （默认值）或<code class="codeph">ALL</code> 。</p>
                                 <p>将此参数设置为<code class="codeph">BASIC</code>会禁用PGA性能建议视图的生成，因此不建议这样做。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnote" id="GUID-326DEB90-E13C-4511-8731-F8A37C4D83D6__GUID-C0FC7DFB-9733-4004-879D-13BE54D78073">
                              <p class="notep1">注意：</p>
                              <p>在实例启动时或<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值更改时，将重置PGA建议性能视图的内容。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA491"></a><a id="TGDBA490"></a><a id="TGDBA489"></a><div class="props_rev_3"><a id="GUID-4ED57621-B8D5-438C-A1CB-B5204A6C0427" name="GUID-4ED57621-B8D5-438C-A1CB-B5204A6C0427"></a><h5 id="TGDBA-GUID-4ED57621-B8D5-438C-A1CB-B5204A6C0427" class="sect5"><span class="enumeration_section">16.2.4.2</span>使用V $ PGA_TARGET_ADVICE视图</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">V$PGA_TARGET_ADVICE</code>视图预测如何更改<code class="codeph">PGA_AGGREGATE_TARGET</code>初始化参数的值将影响<code class="codeph">V$PGASTAT</code>视图中的以下统计信息：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>缓存命中百分比</p>
                              </li>
                              <li>
                                 <p>超额分配数</p>
                              </li>
                           </ul>
                           <p>以下示例显示了此视图的查询。</p><pre class="oac_no_warn" dir="ltr">SELECT ROUND（pga_target_for_estimate / 1024/1024）target_mb，estd_pga_cache_hit_percentage cache_hit_perc，estd_overalloc_count FROM V $ PGA_TARGET_ADVICE;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">TARGET_MB CACHE_HIT_PERC ESTD_OVERALLOC_COUNT ---------- -------------- -------------------- 63 23 367 125 24 30 250 30 3 375 39 0 500 58 0 600 59 0 700 59 0 800 60 0 900 60 0 1000 61 0 1500 67 0 2000 76 0 3000 83 0 4000 85 0</pre><p>下图说明了如何绘制此查询的结果。</p>
                           <div class="figure" id="GUID-4ED57621-B8D5-438C-A1CB-B5204A6C0427__BGBCEIAF">
                              <p class="titleinfigure">图16-1 V $ PGA_TARGET_ADVICE的图形表示</p><img src="img/figure_161_v_pga_target_advice.png" alt="下面是图16-1的描述" title="下面是图16-1的描述" longdesc="img_text/figure_161_v_pga_target_advice.html"><br><a href="img_text/figure_161_v_pga_target_advice.html">“图16-1 V $ PGA_TARGET_ADVICE的图形表示”的描述</a></div>
                           <!-- class="figure" -->
                           <p>该曲线显示PGA <code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>如何随着<code class="codeph">PGA_AGGREGATE_TARGET</code>参数值的增加而提高。图中的阴影区域表示<code class="codeph">over</code> <code class="codeph">allocation</code>区域，其中<code class="codeph">ESTD_OVERALLOCATION_COUNT</code>列的值不为零。此区域表示<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值太小，无法满足最低PGA内存要求。如果在<code class="codeph">over</code> <code class="codeph">allocation</code>区域内设置了<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值，则内存管理器将过度分配内存，并且消耗的实际PGA内存将超过设置的限制。因此，在该区域中设置<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值是没有意义的。在此特定示例中， <code class="codeph">PGA_AGGREGATE_TARGET</code>参数应设置为至少375 MB。</p>
                           <p><code class="codeph">over</code> <code class="codeph">allocation</code>区域，PGA <code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>的值迅速增加。这是由于最佳或一次通过工作区域的数量增加以及多次执行次数的减少。在某些情况下，在该示例中约为500MB，曲线中的拐点对应于大多数（可能所有）工作区域可以以最佳或至少一次通过尺寸运行的点。除此之外， <code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>不断增加，但速度较慢，直至开始逐渐减少，并且随着<code class="codeph">PGA_AGGREGATE_TARGET</code>参数值的增加，只能实现轻微改善。在图中，当<code class="codeph">PGA_AGGREGATE_TARGET</code>达到3 GB时会发生这种情况。此时， <code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>为83％，只有一个额外千兆字节的PGA内存才能实现边际改善（2％）。在此示例中，3 GB是<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的最佳值。
                           </p>
                           <div class="infoboxnote" id="GUID-4ED57621-B8D5-438C-A1CB-B5204A6C0427__GUID-CC65C720-18FA-42A0-84BC-20B9111289FA">
                              <p class="notep1">注意：</p>
                              <p>尽管PGA <code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>的理论最大值是100％，但是即使<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值进一步增加，也可能对可能阻止达到该理论最大值的工作区的最大大小存在实际限制。这应该仅在最佳内存要求很大的大型DSS系统中发生，并且可能导致<code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>的值以较低的百分比逐渐减小，例如90％。
                              </p>
                           </div>
                           <p>理想的是，的值<code class="codeph">PGA_AGGREGATE_TARGET</code>参数应设置为最佳值，或者至少在超出该区域的最大可能值<code class="codeph">over</code> <code class="codeph">allocation</code>区。根据经验，PGA <code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code>应该高于60％，因为在60％的情况下，系统几乎处理了理想情况下实际需要处理的字节数的两倍。在此示例中， <code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值应设置为至少500 MB，并尽可能接近3 GB。但是， <code class="codeph">PGA_AGGREGATE_TARGET</code>参数的正确设置取决于可以为PGA组件专用的内存量。通常，添加PGA内存需要减少某些SGA组件的内存 - 如共享池或缓冲区缓存 - 因为专用于数据库实例的总内存通常受系统上可用物理内存量的限制。因此，任何增加PGA内存的决定都必须在系统中可用内存的较大上下文和各种SGA组件的性能（您可以使用共享池建议和缓冲区缓存顾问统计信息监视）中进行。如果无法减少SGA组件的内存，请考虑向系统添加更多物理内存。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGDBA493"></a><a id="TGDBA492"></a><div class="props_rev_3"><a id="GUID-A2C80240-8436-42FC-B40F-B0358C955216" name="GUID-A2C80240-8436-42FC-B40F-B0358C955216"></a><h5 id="TGDBA-GUID-A2C80240-8436-42FC-B40F-B0358C955216" class="sect5"><span class="enumeration_section">16.2.4.3</span>使用V $ PGA_TARGET_ADVICE_HISTOGRAM视图</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">V$PGA_TARGET_ADVICE_HISTOGRAM</code>视图预测如何更改<code class="codeph">PGA_AGGREGATE_TARGET</code>初始化参数的值将影响<code class="codeph">V$SQL_WORKAREA_HISTOGRAM</code>视图中的统计信息。使用此视图可显示有关用于预测的<code class="codeph">PGA_AGGREGATE_TARGET</code>值的预测最佳，一次通过和多次通过工作区执行次数的详细信息。
                           </p>
                           <p>的<code class="codeph">V$PGA_TARGET_ADVICE_HISTOGRAM</code>视图等同于<code class="codeph">V$SQL_WORKAREA_HISTOGRAM</code>视图，有两个附加列来表示<code class="codeph">PGA_AGGREGATE_TARGET</code>用于预测值。因此，可以在此视图上使用针对<code class="codeph">V$SQL_WORKAREA_HISTOGRAM</code>视图执行的任何查询，并使用附加谓词来选择<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的所需值。
                           </p>
                           <p><a href="tuning-program-global-area.html#GUID-A2C80240-8436-42FC-B40F-B0358C955216__BGBGCFAG">示例16-7</a>显示了此视图的查询，该查询显示<code class="codeph">V$SQL_WORKAREA_HISTOGRAM</code>视图的预测内容，其中<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值设置为其当前值的两倍。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-A2C80240-8436-42FC-B40F-B0358C955216__BGBGCFAG">
                           <p class="titleinexample">例16-7查询V $ PGA_TARGET_ADVICE_HISTOGRAM视图</p><pre class="oac_no_warn" dir="ltr">SELECT low_optimal_size / 1024 low_kb，（high_optimal_size + 1）/ 1024 high_kb，estd_optimal_executions estd_opt_cnt，estd_onepass_executions estd_onepass_cnt，estd_multipasses_executions estd_mpass_cnt FROM V $ PGA_TARGET_ADVICE_HISTOGRAM WHERE pga_target_factor = 2 AND estd_total_executions！= 0 ORDER BY 1;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">LOW_KB HIGH_KB ESTD_OPTIMAL_CNT ESTD_ONEPASS_CNT ESTD_MPASS_CNT ------ ------- ---------------- ---------------- -------------- 8 16 156107 0 0 16 32 148 0 0 32 64 89 0 0 64 128 13 0 0 128 256 58 0 0 256 512 10 0 0 512 1024 653 0 0 1024 2048 530 0 0 2048 4096 509 0 0 4096 8192 227 0 0 8192 16384 176 0 0 16384 32768 133 16 0 32768 65536 66 103 0 65536 131072 15 47 0 131072 262144 0 48 0 262144 524288 0 23 0</pre><p>在此示例中，输出显示将<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值增加2倍将使16 MB以下的所有工作区域以最佳大小执行。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="TGDBA495"></a><a id="TGDBA494"></a><div class="props_rev_3"><a id="GUID-1E3F26AD-1F4A-4188-B775-53429DE27963" name="GUID-1E3F26AD-1F4A-4188-B775-53429DE27963"></a><h5 id="TGDBA-GUID-1E3F26AD-1F4A-4188-B775-53429DE27963" class="sect5"><span class="enumeration_section">16.2.4.4</span>使用V $ SYSSTAT和V $ SESSTAT视图</h5>
                     <div>
                        <div class="section">
                           <p><code class="codeph">V$SYSSTAT</code>和<code class="codeph">V$SESSTAT</code>视图中的统计<code class="codeph">V$SYSSTAT</code>显示了使用最佳，一次通过和多次通过内存大小执行的工作区总数。自实例或会话启动以来，这些统计信息是累积的。
                           </p>
                           <p><a href="tuning-program-global-area.html#GUID-1E3F26AD-1F4A-4188-B775-53429DE27963__BGBEEAEI">示例16-8</a>显示了<code class="codeph">V$SYSSTAT</code>视图的查询，该视图显示自实例启动以来以这三种大小执行工作区的总数和工作区的百分比：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-1E3F26AD-1F4A-4188-B775-53429DE27963__BGBEEAEI">
                           <p class="titleinexample">示例16-8查询V $ SYSSTAT视图</p><pre class="oac_no_warn" dir="ltr">SELECT name profile，cnt，DECODE（total，0,0，ROUND（cnt * 100 / total））percentage FROM（SELECT name，value cnt，（SUM（value）over（））total FROM V $ SYSSTAT WHERE name LIKE' workarea exec％'）;</pre><p>此查询的输出可能如下所示：</p><pre class="oac_no_warn" dir="ltr">PROFILE CNT PERCENTAGE ----------------------------------- ----------  - -------- workarea执行 - 最佳5395 95工作区执行 -  onepass 284 5 workarea执行 -  multipass 0 0</pre><p>在此示例中，输出显示以最佳大小执行了5,395个工作区执行（或95％），并且以一次通过大小执行了284个工作区执行（或5％）。</p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="TGDBA496"></a><div class="props_rev_3"><a id="GUID-BC6CBF45-EA12-44AE-AB84-EE7DF7B09DE8" name="GUID-BC6CBF45-EA12-44AE-AB84-EE7DF7B09DE8"></a><h5 id="TGDBA-GUID-BC6CBF45-EA12-44AE-AB84-EE7DF7B09DE8" class="sect5"><span class="enumeration_section">16.2.4.5</span>教程：如何调整PGA_AGGREGATE_TARGET</h5>
                     <div>
                        <div class="section">
                           <p>本教程提供了使用本章中讨论的各种视图调整<code class="codeph">PGA_AGGREGATE_TARGET</code>参数值的指南。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-BC6CBF45-EA12-44AE-AB84-EE7DF7B09DE8__GUID-D8A4698C-EB6D-4566-82A0-A8ACD49D5A8B">调整PGA_AGGREGATE_TARGET：</p>
                           <ol>
                              <li>
                                 <p>设置<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值以避免内存过量分配。
                                 </p>
                                 <p>使用<code class="codeph">V$PGA_TARGET_ADVICE</code>视图确保未在超分配区域内设置<code class="codeph">PGA_AGGREGATE_TARGET</code>值，如<span class="q">“ <a href="tuning-program-global-area.html#GUID-4ED57621-B8D5-438C-A1CB-B5204A6C0427">使用V $ PGA_TARGET_ADVICE视图</a> ”中所述</span> 。在例16-8中， <code class="codeph">PGA_AGGREGATE_TARGET</code>值应设置为至少375 MB。</p>
                              </li>
                              <li>
                                 <p>根据响应时间要求和内存限制，最大化PGA <code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code> 。
                                 </p>
                                 <p>使用<code class="codeph">V$PGA_TARGET_ADVICE</code>视图确定<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的最佳值，并将其值设置为最佳值，或者设置为可能的最大值，如<span class="q">“ <a href="tuning-program-global-area.html#GUID-4ED57621-B8D5-438C-A1CB-B5204A6C0427">使用V $ PGA_TARGET_ADVICE视图</a> ”中所述</span> 。
                                 </p>
                                 <p>假设可以分配给PGA的内存限制为<span class="italic">X</span> ：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>如果限制<span class="italic">X</span>高于最佳值，请将<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值设置为最佳值。
                                       </p>
                                       <p>在例16-8中，如果您有10 GB专用于PGA，请将<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值设置为3 GB，并将剩余的7 GB专用于SGA。</p>
                                    </li>
                                    <li>
                                       <p>如果限制<span class="italic">X</span>小于最佳值，请将<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值设置为<span class="italic">X.</span></p>
                                       <p>在示例16-8中，如果您只有2 GB专用于PGA，请将<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值设置为2 GB并接受75％的<code class="codeph">cache</code> <code class="codeph">hit</code> <code class="codeph">percentage</code> 。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>验证<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的新值将导致所需的最佳和一次通过工作区执行次数，并避免执行任何多次通过工作区。
                                 </p>
                                 <p>使用<code class="codeph">V$PGA_TARGET_ADVICE_HISTOGRAM</code>视图预测最佳，一次通过和多次通过工作区执行的次数，如<span class="q">“ <a href="tuning-program-global-area.html#GUID-A2C80240-8436-42FC-B40F-B0358C955216">使用V $ PGA_TARGET_ADVICE_HISTOGRAM视图</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>如果需要更多PGA内存，则通过减少SGA组件的内存或向系统添加更多物理内存来增加PGA内存。</p>
                              </li>
                              <li>
                                 <p>在任何时候，确保最佳，一次通过和多次通过的工作区执行次数与预测相匹配，并在必要时调整<code class="codeph">PGA_AGGREGATE_TARGET</code>参数的值。
                                 </p>
                                 <p>使用<code class="codeph">V$SYSSTAT</code>和<code class="codeph">V$SESSTAT</code>视图分别验证自实例或会话启动以来最佳，一次通过和多次通过内存大小执行的工作区总数，如<span class="q">“ <a href="tuning-program-global-area.html#GUID-1E3F26AD-1F4A-4188-B775-53429DE27963">使用V $ SYSSTAT和V $ SESSTAT意见</a> “</span> 。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="TGDBA95344"></a><div class="props_rev_3"><a id="GUID-C1796FFD-5A7E-4FA7-945B-4B6CE374091A" name="GUID-C1796FFD-5A7E-4FA7-945B-4B6CE374091A"></a><h3 id="TGDBA-GUID-C1796FFD-5A7E-4FA7-945B-4B6CE374091A" class="sect3"><span class="enumeration_section">16.3</span>通过指定绝对限制来确定程序全局区域的大小</h3>
               <div>
                  <p>在自动PGA内存管理模式下，Oracle数据库通过动态控制分配给工作区的PGA内存量来尝试遵循<code class="codeph">PGA_AGGREGATE_TARGET</code>值。但是，由于以下原因，PGA内存使用量有时可能超过<code class="codeph">PGA_AGGREGATE_TARGET</code>设置：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">PGA_AGGREGATE_TARGET</code>设置充当目标，而不是限制。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">PGA_AGGREGATE_TARGET</code>仅控制可调内存的分配。
                        </p>
                     </li>
                  </ul>
                  <div class="p">过多的PGA使用会导致高速交换。发生这种情况时，系统可能会变得无响应且不稳定。在这种情况下，请考虑使用以下任何方法来指定PGA内存使用的绝对限制：<ul style="list-style-type:disc">
                        <li>
                           <p>使用<code class="codeph">PGA_AGGREGATE_LIMIT</code>参数设置整体PGA内存使用的绝对限制。
                           </p>
                           <p>请参见<span class="q">“ <a href="tuning-program-global-area.html#GUID-2DAF0E1B-E24F-4463-BB5D-B1C89904C443">使用PGA_AGGREGATE_LIMIT参数调整程序全局区域大小</a> ”</span> 
                           </p>
                        </li>
                        <li>
                           <p>使用资源管理器过程<code class="codeph">DBMS_RESOURCE_MANAGER.CREATE_PLAN_DIRECTIVE</code>为特定使用者组中每个会话的PGA内存使用量设置绝对限制。
                           </p>
                           <p>请参阅<span class="q">“ <a href="tuning-program-global-area.html#GUID-5988E64F-5BE0-4976-BACF-9310154F24E7">使用资源管理器调整程序全局区域大小</a> ”</span></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="TGDBA95346"></a><div class="props_rev_3"><a id="GUID-2DAF0E1B-E24F-4463-BB5D-B1C89904C443" name="GUID-2DAF0E1B-E24F-4463-BB5D-B1C89904C443"></a><h4 id="TGDBA-GUID-2DAF0E1B-E24F-4463-BB5D-B1C89904C443" class="sect4"><span class="enumeration_section">16.3.1</span>使用PGA_AGGREGATE_LIMIT参数调整程序全局区域的大小</h4>
                  <div>
                     <div class="section">
                        <p><code class="codeph">PGA_AGGREGATE_LIMIT</code>初始化参数使您可以指定PGA内存使用的绝对限制。如果超出<code class="codeph">PGA_AGGREGATE_LIMIT</code>值，Oracle数据库将按以下顺序中止或终止消耗最不可用的PGA内存的会话或进程：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>对中断最耗尽的PGA内存的会话的调用将被中止。</p>
                           </li>
                           <li>
                              <p>如果PGA内存使用率仍超过<code class="codeph">PGA_AGGREGATE_LIMIT</code> ，则终止消耗最不可用的PGA内存的会话和进程。
                              </p>
                           </li>
                        </ul>
                        <p>在确定要中止或终止的会话和进程时，Oracle数据库将并行查询视为一个单元。</p>
                        <p>默认情况下， <code class="codeph">PGA_AGGREGATE_LIMIT</code>参数设置为2 GB， <code class="codeph">PGA_AGGREGATE_TARGET</code>值的200％或<code class="codeph">PROCESSES</code>参数值的3 MB的较大值。但是，它不会超过物理内存大小的120％减去总SGA大小。默认值将打印到警报日志中。如果无法确定系统上的物理内存量，则会在警报日志中打印警告消息。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-2DAF0E1B-E24F-4463-BB5D-B1C89904C443__GUID-D14D6529-8A07-49A5-A3C1-C3A4B56921B4">要设置PGA_AGGREGATE_LIMIT：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将<code class="codeph">PGA_AGGREGATE_LIMIT</code>初始化参数设置为所需的字节数值。
                              </p>
                              <p>该值表示为数字，后跟<code class="codeph">K</code> （表示千字节）， <code class="codeph">M</code> （表示兆字节）或<code class="codeph">G</code> （表示千兆字节）。将值设置为0将禁用PGA内存的硬限制。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-2DAF0E1B-E24F-4463-BB5D-B1C89904C443__GUID-E8E34211-5CDA-4EDB-BDA0-C4DE7142D7B2">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关<code class="codeph">PGA_AGGREGATE_LIMIT</code>初始化参数的信息，请<a href="../refrn/PGA_AGGREGATE_LIMIT.html#REFRN10328" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">V$PGASTAT</code>视图的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgdba&amp;id=REFRN30180" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                              </li>
                              <li>
                                 <p><a href="../admin/managing-resources-with-oracle-database-resource-manager.html#ADMIN027" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a> ，了解有关Oracle数据库资源管理器和使用者组的信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-5988E64F-5BE0-4976-BACF-9310154F24E7" name="GUID-5988E64F-5BE0-4976-BACF-9310154F24E7"></a><h4 id="TGDBA-GUID-5988E64F-5BE0-4976-BACF-9310154F24E7" class="sect4"><span class="enumeration_section">16.3.2</span>使用资源管理器调整程序全局区域的大小</h4>
                  <div>
                     <p>您可以使用Oracle数据库资源管理器的<code class="codeph">DBMS_RESOURCE_MANAGER.CREATE_PLAN_DIRECTIVE</code>过程的<code class="codeph">SESSION_PGA_LIMIT</code>参数，为可以分配给特定使用者组中的每个会话的PGA内存量设置绝对限制。如果会话超过为其使用者组设置的PGA内存限制，则该会话将以<code class="codeph">ORA-10260</code>错误消息终止。
                     </p>
                     <div class="infoboxnotealso" id="GUID-5988E64F-5BE0-4976-BACF-9310154F24E7__ORACLEDATABASEADMINISTRATIONGUIDE-0279DEF5">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="italic">Oracle数据库管理指南</span>主题：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="../admin/managing-resources-with-oracle-database-resource-manager.html#ADMIN-GUID-6D549CB5-9AEB-43F2-9901-0092C7B76115" target="_blank"><span class="q">“程序全局区域（PGA）”</span></a> ，了解有关限制消费者组中每个会话的PGA内存的更多信息。
                                    </p>
                                 </li>
                                 <li>
                                    <p><a href="../admin/managing-resources-with-oracle-database-resource-manager.html#ADMIN-GUID-3BDCC024-22DD-479D-A7C3-92E7145C854F" target="_blank"><span class="q">“创建资源计划指令”</span></a> ，以获取有关使用<code class="codeph">DBMS_RESOURCE_MANAGER.CREATE_PLAN_DIRECTIVE</code>过程<a href="../admin/managing-resources-with-oracle-database-resource-manager.html#ADMIN-GUID-3BDCC024-22DD-479D-A7C3-92E7145C854F" target="_blank"><span class="q">创建资源计划指令</span></a>的更多信息。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_RESOURCE_MANAGER.html#ARPLS-GUID-8EC6C735-338D-46D4-B346-AD16D0622B30" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a> ，了解<code class="codeph">DBMS_RESOURCE_MANAGER.CREATE_PLAN_DIRECTIVE</code>过程的语法。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="05213.dynamic-sql.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Dynamic SQL is a programming methodology for generating and running SQL statements at run time."></meta>
      <meta name="description" content="Dynamic SQL is a programming methodology for generating and running SQL statements at run time."></meta>
      <title>PL / SQL动态SQL</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database PL/SQL Language Reference "></meta>
      <meta property="og:description" content="Dynamic SQL is a programming methodology for generating and running SQL statements at run time."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database PL/SQL Language Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-pl-sql-language-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-13T20:26:20-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96448-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="static-sql.html" title="Previous" type="text/html"></link>
      <link rel="next" href="plsql-subprograms.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Language Reference"></meta>
    <meta name="dcterms.isVersionOf" content="LNPLS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="static-sql.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="plsql-subprograms.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库PL / SQL语言参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">PL / SQL动态SQL</li>
            </ol>
            <a id="GUID-7E2F596F-9CA3-4DC8-8333-0C117962DB73" name="GUID-7E2F596F-9CA3-4DC8-8333-0C117962DB73"></a><a id="LNPLS513"></a><a id="LNPLS011"></a>
            
            <h2 id="LNPLS-GUID-7E2F596F-9CA3-4DC8-8333-0C117962DB73" class="sect2"><span class="enumeration_chapter">7</span> PL / SQL动态SQL</h2>
         </header>
         <div class="ind">
            <div>
               <p><span class="bold">动态SQL</span>是一种在运行时生成和运行SQL语句的编程方法。
               </p>
               <p>在编写通用查询系统等通用和灵活程序，编写必须运行数据库定义语言（DDL）语句的程序时，或者在编译时不知道SQL语句的全文或数字时，它非常有用或其输入和输出变量的数据类型。</p>
               <p>PL / SQL提供了两种编写动态SQL的方法：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p>本机动态SQL，一种用于构建和运行动态SQL语句的PL / SQL语言（即本机）功能</p>
                  </li>
                  <li>
                     <p><code class="codeph">DBMS_SQL</code>包，用于构建，运行和描述动态SQL语句的API</p>
                  </li>
               </ul>
               <p>本机动态SQL代码比使用<code class="codeph">DBMS_SQL</code>包的等效代码更容易读取和写入，并且运行速度明显更快（特别是当它可以由编译器优化时）。但是，要编写本机动态SQL代码，必须在编译时知道动态SQL语句的输入和输出变量的数量和数据类型。如果在编译时不知道此信息，则必须使用<code class="codeph">DBMS_SQL</code>包。如果希望存储的子程序隐式返回查询结果（而不是通过<code class="codeph">OUT</code> <code class="codeph">REF</code> <code class="codeph">CURSOR</code>参数），则还必须使用<code class="codeph">DBMS_SQL</code>包。
               </p>
               <p>当您需要<code class="codeph">DBMS_SQL</code>包和本机动态SQL时，可以使用<span class="q">“ <a href="dynamic-sql.html#GUID-A194C9FA-221A-466B-9179-6238FEC5143B">DBMS_SQL.TO_REFCURSOR函数</a> ”</span>和<span class="q">“ <a href="dynamic-sql.html#GUID-8DF5B8A3-70F8-4AF5-A747-B1CE6B7D90DF">DBMS_SQL.TO_CURSOR_NUMBER函数</a> ”</span>在它们之间切换。
               </p>
               <div class="section">
                  <p class="subhead1" id="GUID-7E2F596F-9CA3-4DC8-8333-0C117962DB73__GUID-44B456EB-7CB5-4348-AAA6-8A004AE3CF99">话题</p>
               </div>
               <!-- class="section" -->
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="dynamic-sql.html#GUID-DAFD83C8-FA3A-40A6-95E5-3B2F082E1798">何时需要动态SQL</a></p>
                  </li>
                  <li>
                     <p><a href="dynamic-sql.html#GUID-D2613968-6660-4AA2-9057-28E425A3040D" title="本机动态SQL使用EXECUTE IMMEDIATE语句处理大多数动态SQL语句。">本机动态SQL</a></p>
                  </li>
                  <li>
                     <p><a href="dynamic-sql.html#GUID-4E1FD47B-7E1A-42E9-9792-210F13C75A1B" title="DBMS_SQL包定义了一个称为SQL游标号的实体。因为SQL游标号是PL / SQL整数，所以可以将其传递到调用边界并存储它。">DBMS_SQL包</a></p>
                  </li>
                  <li>
                     <p><a href="dynamic-sql.html#GUID-1E31057E-057F-4A53-B1DD-8BC2C337AA2C" title="SQL注入恶意利用在SQL语句中使用客户端提供的数据的应用程序，从而获得对数据库的未授权访问以查看或操纵受限数据。">SQL注入</a></p>
                  </li>
               </ul>
            </div><a id="LNPLS01101"></a><div class="props_rev_3"><a id="GUID-DAFD83C8-FA3A-40A6-95E5-3B2F082E1798" name="GUID-DAFD83C8-FA3A-40A6-95E5-3B2F082E1798"></a><h3 id="LNPLS-GUID-DAFD83C8-FA3A-40A6-95E5-3B2F082E1798" class="sect3"><span class="enumeration_section">7.1</span>何时需要动态SQL</h3>
               <div>
                  <p>在PL / SQL中，您需要运行动态SQL：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>编译时文本未知的SQL</p>
                        <p>例如， <code class="codeph">SELECT</code>语句包含在编译时未知的标识符（例如表名）或<code class="codeph">WHERE</code>子句，其中子条目的数量在编译时是未知的。
                        </p>
                     </li>
                     <li>
                        <p>不支持作为静态SQL的SQL</p>
                        <p>也就是说，任何SQL构造都不包含在<span class="q">“ <a href="static-sql.html#GUID-54ABD9E3-EA4D-4C60-A84A-021925501C0C" title="除非另有说明，否则静态SQL具有与SQL相同的语法。">静态SQL的描述</a> ”中</span> 。
                        </p>
                     </li>
                  </ul>
                  <p>如果您不需要动态SQL，请使用具有以下优点的静态SQL：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>成功编译将验证静态SQL语句是否引用了有效的数据库对象，以及是否具有访问这些对象所需的特权。</p>
                     </li>
                     <li>
                        <p>成功编译会创建架构对象依赖项。</p>
                        <p>有关架构对象依赖关系的信息，请参阅“ <a href="../adfns/schema-object-dependency.html#ADFNS99967" target="_blank"><span class="italic">Oracle数据库开发指南”</span></a> 。
                        </p>
                     </li>
                  </ul>
                  <p>有关在PL / SQL中使用静态SQL语句的信息，请参阅<a href="static-sql.html#GUID-A2E4086F-94DC-4CC7-9E4B-30285BEC3313" title="静态SQL是一种PL / SQL功能，它允许直接在PL / SQL语句中使用SQL语法。">PL / SQL静态SQL</a> 。</p>
               </div>
            </div><a id="LNPLS514"></a><a id="LNPLS01102"></a><div class="props_rev_3"><a id="GUID-D2613968-6660-4AA2-9057-28E425A3040D" name="GUID-D2613968-6660-4AA2-9057-28E425A3040D"></a><h3 id="LNPLS-GUID-D2613968-6660-4AA2-9057-28E425A3040D" class="sect3"><span class="enumeration_section">7.2本</span>机动态SQL</h3>
               <div>
                  <p>本机动态SQL使用<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句处理大多数动态SQL语句。
                  </p>
                  <p>如果动态SQL语句是返回多行的<code class="codeph">SELECT</code>语句，则本机动态SQL为您提供以下选择：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>将<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句与<code class="codeph">BULK</code> <code class="codeph">COLLECT</code> <code class="codeph">INTO</code>子句一起使用。
                        </p>
                     </li>
                     <li>
                        <p>使用<code class="codeph">OPEN</code> <code class="codeph">FOR</code> ， <code class="codeph">FETCH</code>和<code class="codeph">CLOSE</code>语句。
                        </p>
                     </li>
                  </ul>
                  <p>在本机动态SQL <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">DELETE</code> ， <code class="codeph">MERGE</code>和单行<code class="codeph">SELECT</code>语句之后，SQL游标属性的工作方式与它们的静态SQL对应项相同。有关SQL游标属性的更多信息，请参阅<span class="q">“ <a href="static-sql.html#GUID-F1FE15F9-5C96-4C4E-B240-B7363D25A8F1" title="游标是指向私有SQL区域的指针，该区域存储有关处理特定SELECT或DML语句的信息。">游标概述</a> ”</span> 。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-D2613968-6660-4AA2-9057-28E425A3040D__GUID-9C922323-0C53-4EFD-A818-B4BBD2C93A2B">话题</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="dynamic-sql.html#GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217" title="EXECUTE IMMEDIATE语句是本机动态SQL处理大多数动态SQL语句的方法。">EXECUTE IMMEDIATE声明</a></p>
                        </li>
                        <li>
                           <p><a href="dynamic-sql.html#GUID-BAC52F38-B427-4860-9B6D-336B3AEE6AD2">OPEN FOR，FETCH和CLOSE语句</a></p>
                        </li>
                        <li>
                           <p><a href="dynamic-sql.html#GUID-4E5C6A4F-C1DB-44DD-964E-C683120B448E" title="如果在动态SQL语句中重复占位符名称，请注意占位符与绑定变量关联的方式取决于动态SQL语句的类型。">动态SQL语句中重复的占位符名称</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="LNPLS626"></a><a id="LNPLS515"></a><a id="LNPLS516"></a><a id="LNPLS517"></a><a id="LNPLS1854"></a><a id="LNPLS1855"></a><a id="LNPLS628"></a><a id="LNPLS01115"></a><div class="props_rev_3"><a id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217" name="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217"></a><h4 id="LNPLS-GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217" class="sect4"><span class="enumeration_section">7.2.1</span> EXECUTE IMMEDIATE语句</h4>
                  <div>
                     <p><code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句是本机动态SQL处理大多数动态SQL语句的方法。
                     </p>
                     <p>如果动态SQL语句是<span class="bold">自包含的</span> （即，如果它没有绑定变量的占位符，并且它可能返回的唯一结果是错误），那么<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句不需要子句。
                     </p>
                     <p>如果动态SQL语句包含绑定变量的占位符，则每个占位符必须在<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句的相应子句中具有相应的绑定变量，如下所示：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果动态SQL语句是最多可返回一行的<code class="codeph">SELECT</code>语句，则在<code class="codeph">INTO</code>子句中放置绑定变量（定义），在<code class="codeph">USING</code>子句中放入绑定变量。
                           </p>
                        </li>
                        <li>
                           <p>如果动态SQL语句是可以返回多行的<code class="codeph">SELECT</code>语句，则在<code class="codeph">BULK</code> <code class="codeph">COLLECT</code> <code class="codeph">INTO</code>子句中放置绑定变量（定义），在<code class="codeph">USING</code>子句中放入绑定变量。
                           </p>
                        </li>
                        <li>
                           <p>如果动态SQL语句是没有<code class="codeph">RETURNING</code> <code class="codeph">INTO</code>子句的DML语句（ <code class="codeph">SELECT</code>除外），则将所有绑定变量放在<code class="codeph">USING</code>子句中。
                           </p>
                        </li>
                        <li>
                           <p>如果动态SQL语句是带有<code class="codeph">RETURNING</code> <code class="codeph">INTO</code>子句的DML语句，则在<code class="codeph">USING</code>子句中放入绑定变量，在<code class="codeph">RETURNING</code> <code class="codeph">INTO</code>子句中输出out-bind变量。
                           </p>
                        </li>
                        <li>
                           <p>如果动态SQL语句是匿名PL / SQL块或<code class="codeph">CALL</code>语句，请将所有绑定变量放在<code class="codeph">USING</code>子句中。
                           </p>
                           <p>如果动态SQL语句调用子程序，请确保：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>子程序可以在模式级别创建，也可以在包规范中声明和定义。</p>
                              </li>
                              <li>
                                 <p>对应于子程序参数的占位符的每个绑定变量都具有与该子程序参数相同的参数模式以及与子程序参数的数据类型兼容的数据类型。</p>
                              </li>
                              <li>
                                 <p>没有绑定变量是保留字<code class="codeph">NULL</code> 。</p>
                                 <p>要解决此限制，请使用未初始化的变量，以便使用<code class="codeph">NULL</code> ，如<a href="dynamic-sql.html#GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__BHCBIICB">例7-7所示</a> 。
                                 </p>
                              </li>
                              <li>
                                 <p>没有绑定变量具有SQL不支持的数据类型（例如由字符串索引的关联数组）。</p>
                                 <p>如果数据类型是集合或记录类型，则必须在包规范中声明它。</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__GUID-C61A4D55-E5C8-4939-BD57-9D81EF049CC3">
                        <p class="notep1">注意：</p>
                        <p>可以按任何顺序评估绑定变量。如果程序确定评估顺序，那么在程序执行此操作时，其行为是不确定的。</p>
                     </div>
                     <p>在<a href="dynamic-sql.html#GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__CHDECEFD">例7-4</a> ， <a href="dynamic-sql.html#GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__CHDFAJCJ">例7-5</a>和<a href="dynamic-sql.html#GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__CHDJAAIJ">例7-6中</a> ，动态PL / SQL块是一个匿名PL / SQL块，它调用具有PL / SQL集合类型的形式参数的子程序。集合类型不是SQL数据类型。在每个示例中，集合类型在包规范中声明，子程序在包规范中声明并在包体中定义。
                     </p>
                     <div class="infoboxnotealso" id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__GUID-DFDCF893-E357-49BA-B39C-5105AEB3E0BB">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关在模式级别创建函数的信息，请<span class="q"><a href="CREATE-FUNCTION-statement.html#GUID-B71BC5BD-B87C-4054-AAA5-213E856651F2" title="The CREATE FUNCTION statement creates or replaces a standalone function or a call specification.">参见</a> “ <a href="CREATE-FUNCTION-statement.html#GUID-B71BC5BD-B87C-4054-AAA5-213E856651F2" title="CREATE FUNCTION语句创建或替换独立函数或调用规范。">CREATE FUNCTION语句</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="CREATE-PROCEDURE-statement.html#GUID-5F84DB47-B5BE-4292-848F-756BF365EC54" title="CREATE PROCEDURE语句创建或替换独立过程或调用规范。">CREATE PROCEDURE Statement</a> ”</span>有关在模式级别创建过程的信息</p>
                           </li>
                           <li>
                              <p>有关包的信息，请参阅<span class="q">“ <a href="plsql-packages.html#GUID-C285EC5A-BE50-4192-A88E-48C0778B34E0" title="本章介绍如何将相关的PL / SQL代码和数据捆绑到一个包中，其内容可供许多应用程序使用。">PL / SQL包</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="CREATE-PACKAGE-statement.html#GUID-03A70A54-90FF-4293-B6B8-F0B35E184AC5" title="CREATE PACKAGE语句创建或替换存储包的规范，存储包是数据库中作为一个单元存储的相关过程，函数和其他程序对象的封装集合。">CREATE PACKAGE Statement</a> ”</span>有关在包中声明子程序的信息</p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="CREATE-PACKAGE-BODY-statement.html#GUID-68526FF2-96A1-4F14-A10B-4DD3E1CD80BE" title="CREATE PACKAGE BODY语句创建或替换存储包的主体，该包是相关过程，存储函数和作为单元存储在数据库中的其他程序对象的封装集合。">CREATE PACKAGE BODY Statement</a> ”</span>有关在包中声明和定义子程序的信息</p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="CREATE-PACKAGE-statement.html#GUID-03A70A54-90FF-4293-B6B8-F0B35E184AC5" title="CREATE PACKAGE语句创建或替换存储包的规范，存储包是数据库中作为一个单元存储的相关过程，函数和其他程序对象的封装集合。">CREATE PACKAGE语句</a> ”</span> ，以获取有关在包规范中声明类型的更多信息</p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="EXECUTE-IMMEDIATE-statement.html#GUID-C3245A95-B85B-4280-A01F-12307B108DC8" title="EXECUTE IMMEDIATE语句在单个操作中构建并运行动态SQL语句。">EXECUTE IMMEDIATE语句</a> ”，</span>为的语法细节<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句</p>
                           </li>
                           <li>
                              <p>有关集合类型的信息，请参阅<span class="q">“ <a href="plsql-collections-and-records.html#GUID-7115C8B6-62F9-496D-BEC3-F7441DFE148A" title="PL / SQL允许您定义两种复合数据类型：集合和记录。">PL / SQL集合和记录</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                     <div class="example" id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__CHDIEFCJ">
                        <p class="titleinexample">示例7-1从动态PL / SQL块调用子程序</p>
                        <p>在此示例中，动态PL / SQL块是一个匿名PL / SQL块，它调用在模式级别创建的子程序。</p><pre class="oac_no_warn" dir="ltr"><span class="bold">- 动态PL / SQL块调用的子程序：</span> CREATE OR REPLACE PROCEDURE create_dept（ <span class="bold">在OUT</span> NUMBER中设置，dname <span class="bold">在</span> VARCHAR2中，mgrid <span class="bold">在</span> NUMBER中，locid <span class="bold">在</span> NUMBER中）AUTHID DEFINER as BEGIN deptid：= departments_seq。NEXTVAL; INSERT INTO部门（department_id，department_name，manager_id，location_id）VALUES（deptid，dname，mgrid，locid）;结束; / DECLARE plsql_block VARCHAR2（500）; new_deptid NUMBER（4）; new_dname VARCHAR2（30）：='广告'; new_mgrid NUMBER（6）：= 200; new_locid NUMBER（4）：= 1700; BEGIN <span class="bold">- 动态PL / SQL块调用子程序：</span> plsql_block：='BEGIN create_dept（：a，：b，：c，：d）;结束;'; <span class="bold">/ *在USING子句中指定绑定变量。</span>
<span class="bold">指定第一个参数的模式。</span>
<span class="bold">默认情况下，其他参数的模式是正确的。* /</span> EXECUTE IMMEDIATE plsql_block使用<span class="bold">输出</span> new_deptid，new_dname，new_mgrid，new_locid;结束; /</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__CHDFCDFC">
                        <p class="titleinexample">例7-2用BOOLEAN形式参数动态调用子程序</p>
                        <p>在此示例中，动态PL / SQL块是一个匿名PL / SQL块，它调用具有PL / SQL（但不是SQL）数据类型<code class="codeph">BOOLEAN</code>的形式参数的子程序。</p><pre class="oac_no_warn" dir="ltr">创建或替换过程p（x <span class="bold">BOOLEAN</span> ）AUTHID DEFINER，如果x那么DBMS_OUTPUT.PUT_LINE（'x为真'）;万一;结束; / DECLARE dyn_stmt VARCHAR2（200）; <span class="bold">b BOOLEAN</span> ：= TRUE; BEGIN dyn_stmt：='BEGIN <span class="bold">p（：x）</span> ;结束;';执行立即dyn_stmt使用<span class="bold">b</span> ;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">x是真的</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__CHDFCAGD">
                        <p class="titleinexample">例7-3用RECORD形式参数动态调用子程序</p>
                        <p>在此示例中，动态PL / SQL块是一个匿名PL / SQL块，它调用具有PL / SQL（但不是SQL）数据类型<code class="codeph">RECORD</code>的形式参数的子程序。记录类型在包规范中声明，子程序在包规范中声明并在包体中定义。
                        </p><pre class="oac_no_warn" dir="ltr">创建或替换包装pkg AUTHID DEFINER作为<span class="bold">类型rec IS RECORD（n1 NUMBER，n2 NUMBER）;</span> <span class="bold">程序p（x OUT rec，y NUMBER，z NUMBER）;</span>结束pkg; /创建或替换包装体pkg作为程序p（x OUT rec，y NUMBER，z NUMBER）AS BEGIN x.n1：= y; x.n2：= z;结束p;结束pkg; / DECLARE <span class="bold">r pkg.rec;</span> dyn_str VARCHAR2（3000）; BEGIN dyn_str：='BEGIN pkg.p <span class="bold">（：x，6,8）;</span>结束;';执行立即dyn_str使用<span class="bold">OUT</span> ; DBMS_OUTPUT.PUT_LINE（'r.n1 ='|| r.n1）; DBMS_OUTPUT.PUT_LINE（'r.n2 ='|| r.n2）;结束; /</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__CHDECEFD">
                        <p class="titleinexample">示例7-4使用Assoc动态调用子程序。数组形式参数</p>
                        <p>在此示例中，动态PL / SQL块是一个匿名PL / SQL块，它调用子程序，该子程序具有由<code class="codeph">PLS_INTEGER</code>索引的PL / SQL集合类型关联数组的形式参数。</p>
                        <div class="infoboxnote" id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__GUID-4A3E7FB5-07E9-42AF-B3BD-17B834418F49">
                           <p class="notep1">注意：</p>
                           <p>在此上下文中使用的关联数组类型必须由<code class="codeph">PLS_INTEGER</code>索引。</p>
                        </div><pre class="oac_no_warn" dir="ltr">创建或替换包pkg AUTHID DEFINER作为<span class="bold">类型number_names是VARCHAR2的表（5）</span> <span class="bold">INDEX BY PLS_INTEGER;</span> <span class="bold">PROCEDURE print_number_names（x number_names）;</span>结束pkg; /创建或替换包装体程pkg AS PROCEDURE print_number_names（x number_names）是从i开始的。第一.. x。最后的循环DBMS_OUTPUT.PUT_LINE（x（i））;结束循环;结束;结束pkg; / DECLARE <span class="bold">digit_names pkg.number_names;</span> dyn_stmt VARCHAR2（3000）; BEGIN digit_names（0）：='零'; digit_names（1）：='one'; digit_names（2）：='two'; digit_names（3）：='three'; digit_names（4）：='four'; digit_names（5）：='five'; digit_names（6）：='six'; digit_names（7）：='seven'; digit_names（8）：='八'; digit_names（9）：='nine'; dyn_stmt：='BEGIN <span class="bold">pkg.print_number_names（：x）;</span>结束;';执行IMMEDIATE dyn_stmt使用<span class="bold">digit_names</span> ;结束; /</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__CHDFAJCJ">
                        <p class="titleinexample">示例7-5使用嵌套表格形式参数动态调用子程序</p>
                        <p>在此示例中，动态PL / SQL块是一个匿名PL / SQL块，它调用具有PL / SQL集合类型嵌套表的形式参数的子程序。</p><pre class="oac_no_warn" dir="ltr">创建或替换包装pkg AUTHID DEFINER作为<span class="bold">TYPE名称IS TABLE OF VARCHAR2（10）;</span> <span class="bold">PROCEDURE print_names（x names）;</span>结束pkg; /创建或替换包装体pkg作为程序print_names（x名称）为x IN开始。第一.. x。最后的循环DBMS_OUTPUT.PUT_LINE（x（i））;结束循环;结束;结束pkg; / DECLARE <span class="bold">fruit pkg.names;</span> dyn_stmt VARCHAR2（3000）; BEGIN fruits：= pkg.names（'apple'，'banana'，'cherry'）; dyn_stmt：='BEGIN <span class="bold">pkg.print_names（：x）;</span>结束;';执行即时dyn_stmt使用<span class="bold">水果</span> ;结束; /</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__CHDJAAIJ">
                        <p class="titleinexample">例7-6用Varray形式参数动态调用子程序</p>
                        <p>在此示例中，动态PL / SQL块是一个匿名PL / SQL块，它调用具有PL / SQL集合类型varray的形式参数的子程序。</p><pre class="oac_no_warn" dir="ltr">创建或替换包装pkg AUTHID DEFINER作为<span class="bold">类型四个IS VARRAY（4）OF VARCHAR2（5）;</span> <span class="bold">程序print_foursome（x四人组）;</span>结束pkg; /创建或替换包装体pkg作为程序print_foursome（x四人组）如果是x，则开始。COUNT = 0那么DBMS_OUTPUT.PUT_LINE（'空'）;我喜欢我的x。第一.. x。最后的循环DBMS_OUTPUT.PUT_LINE（x（i））;结束循环;万一;结束;结束pkg; / DECLARE <span class="bold">指示pkg.foursome;</span> dyn_stmt VARCHAR2（3000）; BEGIN指示：= pkg.foursome（'north'，'south'，'east'，'west'）; dyn_stmt：='BEGIN <span class="bold">pkg.print_foursome（：x）;</span>结束;';执行立即dyn_stmt使用<span class="bold">指示</span> ;结束; /</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__BHCBIICB">
                        <p class="titleinexample">示例7-7未初始化的变量在USING子句中表示NULL</p>
                        <p>此示例使用未初始化的变量来表示<code class="codeph">USING</code>子句中的保留字<code class="codeph">NULL</code> 。
                        </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE employees_temp AS SELECT * FROM EMPLOYEES; DECLARE a_null CHAR（1）; <span class="bold">- 在运行时自动设置为NULL</span> BEGIN EXECUTE IMMEDIATE'UPDATE employees_temp SET commission_pct = <span class="bold">：</span> <span class="bold">x'USING a_null</span> ;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="LNPLS630"></a><a id="LNPLS519"></a><a id="LNPLS629"></a><div class="props_rev_3"><a id="GUID-BAC52F38-B427-4860-9B6D-336B3AEE6AD2" name="GUID-BAC52F38-B427-4860-9B6D-336B3AEE6AD2"></a><h4 id="LNPLS-GUID-BAC52F38-B427-4860-9B6D-336B3AEE6AD2" class="sect4"><span class="enumeration_section">7.2.2</span>打开FOR，FETCH和CLOSE语句</h4>
                  <div>
                     <p>如果动态SQL语句表示返回多行的<code class="codeph">SELECT</code>语句，则可以使用本机动态SQL处理它，如下所示：</p>
                     <ol>
                        <li>
                           <p>使用<code class="codeph">OPEN</code> <code class="codeph">FOR</code>语句将游标变量与动态SQL语句相关联。在<code class="codeph">OPEN</code> <code class="codeph">FOR</code>语句的<code class="codeph">USING</code>子句中，为动态SQL语句中的每个占位符指定一个绑定变量。
                           </p>
                           <p><code class="codeph">USING</code>子句不能包含文字<code class="codeph">NULL</code> 。要解决此限制，请使用未初始化的变量，以便使用<code class="codeph">NULL</code> ，如<a href="dynamic-sql.html#GUID-30ADFC05-8DFB-4C8A-831D-426C2E97F217__BHCBIICB">例7-7所示</a> 。
                           </p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">FETCH</code>语句一次检索一个结果集行，一次检索几个结果集行，或一次检索所有结果集行。
                           </p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">CLOSE</code>语句关闭游标变量。
                           </p>
                        </li>
                     </ol>
                     <p>如果集合符合<span class="q">“ <a href="static-sql.html#GUID-65ADB424-2C2D-49ED-9E98-99A3A68BA248">查询集合</a> ”中</span>的条件，则动态SQL语句可以查询集合。
                     </p>
                     <div class="infoboxnotealso" id="GUID-BAC52F38-B427-4860-9B6D-336B3AEE6AD2__GUID-A4B16287-D713-478E-8E53-B4F5A63D2C08">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>语法详细信息<span class="q">“ <a href="OPEN-FOR-statement.html#GUID-EB7AF439-FDD3-4461-9E3F-B621E8ABFB96" title="OPEN FOR语句将游标变量与查询相关联，分配数据库资源以处理查询，标识结果集，并将光标定位在结果集的第一行之前。">OPEN FOR Statement</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="FETCH-statement.html#GUID-75BC6E63-841A-4103-9B96-8AC97F5C28BB" title="FETCH语句从多行查询的结果集中检索数据行 - 一次一行，一次几行，或一次所有行 - 并将数据存储在变量，记录或集合中。">FETCH语句</a> ”</span>用于语法详细信息</p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="CLOSE-statement.html#GUID-46E7086C-8C29-4689-A062-0FF059E268FD" title="CLOSE语句关闭一个命名游标，释放其资源以供重用。">CLOSE Statement</a> ”</span>用于语法详细信息</p>
                           </li>
                        </ul>
                     </div>
                     <div class="example" id="GUID-BAC52F38-B427-4860-9B6D-336B3AEE6AD2__BHCFDIAI">
                        <p class="titleinexample">示例7-8具有OPEN FOR，FETCH和CLOSE语句的本机动态SQL</p>
                        <p>此示例列出了作为管理员的所有员工，一次检索一个结果集行。</p><pre class="oac_no_warn" dir="ltr">DECLARE TYPE EmpCurTyp是REF CURSOR; v_emp_cursor EmpCurTyp; emp_record employees％ROWTYPE; v_stmt_str VARCHAR2（200）; v_e_job employees.job％TYPE; BEGIN <span class="bold">- 带占位符的动态SQL语句：</span> v_stmt_str：='SELECT * FROM employees WHERE job_id =：j'; <span class="bold">- 打开游标并在USING子句中指定绑定变量：</span> OPEN v_emp_cursor FOR v_stmt_str使用'MANAGER'; <span class="bold">- 一次从结果集中获取行：</span> LOOP FETCH v_emp_cursor INTO emp_record;退出时v_emp_cursor％NOTFOUND;结束循环; <span class="bold">- 关闭游标：</span> CLOSE v_emp_cursor;结束; /</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-BAC52F38-B427-4860-9B6D-336B3AEE6AD2__CHDDBFJB">
                        <p class="titleinexample">示例7-9使用本机动态SQL查询集合</p>
                        <p>此示例与<a href="static-sql.html#GUID-65ADB424-2C2D-49ED-9E98-99A3A68BA248__BABJDADA">示例6-30</a>类似，只是集合变量<code class="codeph">v1</code>是绑定变量。
                        </p><pre class="oac_no_warn" dir="ltr">创建或替换包装pkg AUTHID DEFINER作为类型rec IS RECORD（f1 NUMBER，f2 VARCHAR2（30））; TYPE mytab IS TABLE OF rec INDEX BY pls_integer;结束; / DECLARE <span class="bold">v1 pkg.mytab; - 记录集合</span> v2 pkg.rec; c1 SYS_REFCURSOR;开始<span class="bold">打开c1 FOR'SELECT * FROM TABLE（：1）'使用v1;</span> FETCH c1 INTO v2;关闭c1; DBMS_OUTPUT.PUT_LINE（'记录中的值为'|| v2.f1 ||'和'|| v2.f2）;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="LNPLS520"></a><a id="LNPLS631"></a><div class="props_rev_3"><a id="GUID-4E5C6A4F-C1DB-44DD-964E-C683120B448E" name="GUID-4E5C6A4F-C1DB-44DD-964E-C683120B448E"></a><h4 id="LNPLS-GUID-4E5C6A4F-C1DB-44DD-964E-C683120B448E" class="sect4"><span class="enumeration_section">7.2.3</span>动态SQL语句中重复的占位符名称</h4>
                  <div>
                     <p>如果在动态SQL语句中重复占位符名称，请注意占位符与绑定变量关联的方式取决于动态SQL语句的类型。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4E5C6A4F-C1DB-44DD-964E-C683120B448E__GUID-057AA3A3-A1A7-421B-AB14-8FA69A3C3509">话题</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="dynamic-sql.html#GUID-D17344F2-3CA5-4F33-A074-47E059CA91CC" title="如果动态SQL语句不表示匿名PL / SQL块或CALL语句，则重复占位符名称是无关紧要的。">动态SQL语句不是匿名阻止或CALL语句</a></p>
                           </li>
                           <li>
                              <p><a href="dynamic-sql.html#GUID-A31BBD6E-1CB5-47D2-A01B-48DC3BE203C7" title="如果动态SQL语句表示匿名PL / SQL块或CALL语句，则重复占位符名称很重要。">动态SQL语句是匿名块或CALL语句</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="LNPLS632"></a><div class="props_rev_3"><a id="GUID-D17344F2-3CA5-4F33-A074-47E059CA91CC" name="GUID-D17344F2-3CA5-4F33-A074-47E059CA91CC"></a><h5 id="LNPLS-GUID-D17344F2-3CA5-4F33-A074-47E059CA91CC" class="sect5"><span class="enumeration_section">7.2.3.1</span>动态SQL语句不是匿名块或CALL语句</h5>
                     <div>
                        <p>如果动态SQL语句不表示匿名PL / SQL块或<code class="codeph">CALL</code>语句，则重复占位符名称是无关紧要的。
                        </p>
                        <p>占位符与<code class="codeph">USING</code>子句中的绑定变量按位置关联，而不是按名称关联。
                        </p>
                        <p>例如，在此动态SQL语句中，重复名称： <code class="codeph">x</code>无关紧要：</p><pre class="oac_no_warn" dir="ltr">sql_stmt：='INSERT INTO payroll VALUES（：x，：x，：y，：x）';</pre><p>在相应的<code class="codeph">USING</code>子句中，您必须提供四个绑定变量。它们可以是不同的;例如：</p><pre class="oac_no_warn" dir="ltr">EXECUTE IMMEDIATE sql_stmt使用a，b，c，d;</pre><p>前面的<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句运行此SQL语句：</p><pre class="oac_no_warn" dir="ltr">插入工资单值（a，b，c，d）</pre><p>要将相同的绑定变量与每次出现的<code class="codeph">x</code>相关联，您必须重复该绑定变量;例如：</p><pre class="oac_no_warn" dir="ltr">EXECUTE IMMEDIATE sql_stmt使用a，a，b，a;</pre><p>前面的<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句运行此SQL语句：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO工资单值（a，a，b，a）</pre></div>
                  </div><a id="LNPLS634"></a><a id="LNPLS633"></a><div class="props_rev_3"><a id="GUID-A31BBD6E-1CB5-47D2-A01B-48DC3BE203C7" name="GUID-A31BBD6E-1CB5-47D2-A01B-48DC3BE203C7"></a><h5 id="LNPLS-GUID-A31BBD6E-1CB5-47D2-A01B-48DC3BE203C7" class="sect5"><span class="enumeration_section">7.2.3.2</span>动态SQL语句是匿名块或CALL语句</h5>
                     <div>
                        <p>如果动态SQL语句表示匿名PL / SQL块或<code class="codeph">CALL</code>语句，则重复占位符名称很重要。
                        </p>
                        <p>每个唯一占位符名称必须在<code class="codeph">USING</code>子句中具有相应的绑定变量。如果重复占位符名称，则无需重复其对应的绑定变量。对该占位符名称的所有引用都对应于<code class="codeph">USING</code>子句中的一个绑定变量。
                        </p>
                        <div class="example" id="GUID-A31BBD6E-1CB5-47D2-A01B-48DC3BE203C7__CHDFHEAG">
                           <p class="titleinexample">示例7-10动态PL / SQL块中重复的占位符名称</p>
                           <p>在此示例中，对第一个唯一占位符名称<code class="codeph">x</code>所有引用都与<code class="codeph">USING</code>子句中的第一个绑定变量<code class="codeph">a</code>相关联，第二个唯一占位符名称： <code class="codeph">y</code>与<code class="codeph">USING</code>的第二个绑定变量相关联。条款， <code class="codeph">b</code> 。
                           </p><pre class="oac_no_warn" dir="ltr">CREATE PROCEDURE calc_stats（w NUMBER，x NUMBER，y NUMBER，z NUMBER）是BEGIN DBMS_OUTPUT.PUT_LINE（w + x + y + z）;结束; / DECLARE一个数字：= 4; b NUMBER：= 7; plsql_block VARCHAR2（100）; BEGIN plsql_block：='BEGIN calc_stats（：x，：x，：y，：x）;结束;'; EXECUTE IMMEDIATE plsql_block使用a，b; <span class="bold">-  calc_stats（a，a，b，a）</span> END; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="LNPLS2173"></a><a id="LNPLS01108"></a><div class="props_rev_3"><a id="GUID-4E1FD47B-7E1A-42E9-9792-210F13C75A1B" name="GUID-4E1FD47B-7E1A-42E9-9792-210F13C75A1B"></a><h3 id="LNPLS-GUID-4E1FD47B-7E1A-42E9-9792-210F13C75A1B" class="sect3"><span class="enumeration_section">7.3</span> DBMS_SQL包</h3>
               <div>
                  <p>DBMS_SQL包定义了一个称为SQL游标号的实体。因为SQL游标号是PL / SQL整数，所以可以将其传递到调用边界并存储它。</p>
                  <p>如果满足以下任何条件，则必须使用<code class="codeph">DBMS_SQL</code>包来运行动态SQL语句：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在运行时之前，您不知道<code class="codeph">SELECT</code>列表。
                        </p>
                     </li>
                     <li>
                        <p>直到运行时才知道必须绑定<code class="codeph">SELECT</code>或DML语句中的占位符。
                        </p>
                     </li>
                     <li>
                        <p>您希望存储的子程序隐式返回查询结果（而不是通过<code class="codeph">OUT</code> <code class="codeph">REF</code> <code class="codeph">CURSOR</code>参数），这需要<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">RETURN_RESULT</code>程序。
                        </p>
                     </li>
                  </ul>
                  <p>在这些情况下，您必须使用本机动态SQL而不是<code class="codeph">DBMS_SQL</code>包：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>动态SQL语句将行检索到记录中。</p>
                     </li>
                     <li>
                        <p>在发出动态SQL语句（ <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">DELETE</code> ， <code class="codeph">MERGE</code>或单行<code class="codeph">SELECT</code>语句）之后，您希望使用SQL游标属性<code class="codeph">%FOUND</code> ， <code class="codeph">%ISOPEN</code> ， <code class="codeph">%NOTFOUND</code>或<code class="codeph">%ROWCOUNT</code> 。
                        </p>
                     </li>
                  </ul>
                  <p>当您需要<code class="codeph">DBMS_SQL</code>包和本机动态SQL时，可以使用<code class="codeph">DBMS_SQL</code>函数在它们之间切换。 <code class="codeph">TO_REFCURSOR</code>和<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">TO_CURSOR_NUMBER</code> 。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-4E1FD47B-7E1A-42E9-9792-210F13C75A1B__GUID-F9B6E901-8744-4B79-81D0-98D843671A2A">话题</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="dynamic-sql.html#GUID-8CFE5AA9-0BBD-417B-A7EE-6F05AF49001B">DBMS_SQL.RETURN_RESULT过程</a></p>
                        </li>
                        <li>
                           <p><a href="dynamic-sql.html#GUID-1D6A4302-CBA0-47A6-B4A7-80B089DF4E61">DBMS_SQL.GET_NEXT_RESULT过程</a></p>
                        </li>
                        <li>
                           <p><a href="dynamic-sql.html#GUID-A194C9FA-221A-466B-9179-6238FEC5143B">DBMS_SQL.TO_REFCURSOR函数</a></p>
                        </li>
                        <li>
                           <p><a href="dynamic-sql.html#GUID-8DF5B8A3-70F8-4AF5-A747-B1CE6B7D90DF">DBMS_SQL.TO_CURSOR_NUMBER函数</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-4E1FD47B-7E1A-42E9-9792-210F13C75A1B__GUID-05B48BB9-8E56-451E-A4DD-8E3A6047E821">
                        <p class="notep1">注意：</p>
                        <p>您可以远程调用<code class="codeph">DBMS_SQL</code>子程序。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-4E1FD47B-7E1A-42E9-9792-210F13C75A1B__GUID-9361F58E-E823-4C88-8DA9-00B9EAD77BEA">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“本<a href="dynamic-sql.html#GUID-D2613968-6660-4AA2-9057-28E425A3040D" title="本机动态SQL使用EXECUTE IMMEDIATE语句处理大多数动态SQL语句。">机动态SQL</a> ”，</span>用于获取有关本机动态SQL的信息</p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_SQL.html#ARPLS058" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a>有关<code class="codeph">DBMS_SQL</code>包的更多信息，包括运行具有未知数量的输入或输出变量的动态SQL语句的说明（“方法4”）</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="LNPLS2175"></a><a id="LNPLS2174"></a><div class="props_rev_3"><a id="GUID-8CFE5AA9-0BBD-417B-A7EE-6F05AF49001B" name="GUID-8CFE5AA9-0BBD-417B-A7EE-6F05AF49001B"></a><h4 id="LNPLS-GUID-8CFE5AA9-0BBD-417B-A7EE-6F05AF49001B" class="sect4"><span class="enumeration_section">7.3.1</span> DBMS_SQL.RETURN_RESULT过程</h4>
                  <div>
                     <p><code class="codeph">DBMS_SQL</code> 。 <code class="codeph">RETURN_RESULT</code>过程允许存储的子程序隐式地将查询结果返回给客户端程序（间接调用子程序）或子程序的直接调用者。在<code class="codeph">DBMS_SQL</code>之后。 <code class="codeph">RETURN_RESULT</code>返回结果，只有收件人才能访问它。
                     </p>
                     <p><code class="codeph">DBMS_SQL</code> 。 <code class="codeph">RETURN_RESULT</code>有两个重载：</p><pre class="oac_no_warn" dir="ltr">程序RETURN_RESULT（rc IN OUT <span class="bold">SYS_REFCURSOR</span> ，to_client in BOOLEAN DEFAULT TRUE）;程序RETURN_RESULT（rc IN OUT <span class="bold">INTEGER</span> ，to_client in BOOLEAN DEFAULT TRUE）;</pre><p><code class="codeph">rc</code>参数是打开游标变量（ <code class="codeph">SYS_REFCURSOR</code> ）或打开游标的游标号（ <code class="codeph">INTEGER</code> ）。要打开游标并获取其游标编号，请调用<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">OPEN_CURSOR</code>函数，在<a href="../arpls/DBMS_SQL.html#ARPLS68275" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考中描述</span></a> 。
                     </p>
                     <p>当<code class="codeph">to_client</code>参数为<code class="codeph">TRUE</code> （默认值）时，为<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">RETURN_RESULT</code>过程将查询结果返回给客户端程序（间接调用子程序）;当此参数为<code class="codeph">FALSE</code> ，该过程将查询结果返回给子程序的直接调用者。
                     </p>
                     <div class="infoboxnotealso" id="GUID-8CFE5AA9-0BBD-417B-A7EE-6F05AF49001B__GUID-408BA65C-2409-4206-B3EC-27A403EA4EB7">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">DBMS_SQL</code>更多信息，请<a href="../arpls/DBMS_SQL.html#ARPLS73893" target="_blank"><span class="italic">参见Oracle Database PL / SQL包和类型参考</span></a> 。 <code class="codeph">RETURN_RESULT</code></p>
                           </li>
                           <li>
                              <p><a href="../lnoci/performance-topics.html#LNOCI73008" target="_blank"><span class="italic">Oracle调用接口程序员指南</span></a> ，了解有关隐式查询结果的C和.NET支持的信息</p>
                           </li>
                           <li>
                              <p><a href="../sqpug/using-scripts-in-SQL-Plus.html#SQPUG200" target="_blank"><span class="italic">SQL * Plus用户指南和参考</span></a>有关SQL * Plus支持隐式查询结果的信息</p>
                           </li>
                        </ul>
                     </div>
                     <div class="example" id="GUID-8CFE5AA9-0BBD-417B-A7EE-6F05AF49001B__CHDFBIBJ">
                        <p class="titleinexample">例7-11 DBMS_SQL.RETURN_RESULT过程</p>
                        <p>在此示例中，过程<code class="codeph">p</code>调用<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">RETURN_RESULT</code>没有可选<code class="codeph">to_client</code>参数（这是<code class="codeph">TRUE</code>默认情况下）。因此， <code class="codeph">DBMS_SQL</code> 。 <code class="codeph">RETURN_RESULT</code>将查询结果返回给子程序客户端（调用<code class="codeph">p</code>的匿名块）。在<code class="codeph">p</code>将结果返回到匿名块之后，只有匿名块才能访问该结果。
                        </p><pre class="oac_no_warn" dir="ltr">创建或替换程序作为c1 SYS_REFCURSOR的AUTHID DEFINER; c2 SYS_REFCURSOR; BEGIN OPEN c1 FOR SELECT first_name，last_name FROM employees WHERE employee_id = 176; <span class="bold">DBMS_SQL.RETURN_RESULT（c1）;</span> <span class="bold"> - 现在p无法访问结果。</span>OPEN c2 FOR SELECT city，state_province FROM locations WHERE country_id ='AU'; <span class="bold">DBMS_SQL.RETURN_RESULT（c2）;</span> <span class="bold"> - 现在p无法访问结果。</span>结束; / BEGIN p;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">ResultSet＃1 FIRST_NAME LAST_NAME -------------------- ------------------------- Jonathon Taylor结果集＃2 CITY STATE_PROVINCE ------------------------------ ------------- ------------悉尼新南威尔士州</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="LNPLS2177"></a><a id="LNPLS2176"></a><div class="props_rev_3"><a id="GUID-1D6A4302-CBA0-47A6-B4A7-80B089DF4E61" name="GUID-1D6A4302-CBA0-47A6-B4A7-80B089DF4E61"></a><h4 id="LNPLS-GUID-1D6A4302-CBA0-47A6-B4A7-80B089DF4E61" class="sect4"><span class="enumeration_section">7.3.2</span> DBMS_SQL.GET_NEXT_RESULT过程</h4>
                  <div>
                     <p><code class="codeph">DBMS_SQL</code> 。 <code class="codeph">GET_NEXT_RESULT</code>过程获取<code class="codeph">DBMS_SQL</code>的下一个结果。 <code class="codeph">RETURN_RESULT</code>过程返回给收件人。这两个过程以相同的顺序返回结果。
                     </p>
                     <p><code class="codeph">DBMS_SQL</code> 。 <code class="codeph">GET_NEXT_RESULT</code>有两个重载：</p><pre class="oac_no_warn" dir="ltr">程序GET_NEXT_RESULT（c IN INTEGER，rc OUT <span class="bold">SYS_REFCURSOR</span> ）;程序GET_NEXT_RESULT（c IN INTEGER，rc OUT <span class="bold">INTEGER</span> ）;</pre><p><code class="codeph">c</code>参数是直接或间接调用使用<code class="codeph">DBMS_SQL</code>的子程序的打开游标的游标号。 <code class="codeph">RETURN_RESULT</code>过程隐式返回查询结果。
                     </p>
                     <p>要打开游标并获取其游标编号，请调用<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">OPEN_CURSOR</code>功能。<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">OPEN_CURSOR</code>有一个可选参数<code class="codeph">treat_as_client_for_results</code> 。当此参数为<code class="codeph">FALSE</code> （默认值）时，打开此游标（调用子程序）的调用者不会被视为从使用<code class="codeph">DBMS_SQL</code>的子程序接收客户端查询结果的客户端。 <code class="codeph">RETURN_RESULT</code>查询结果返回给上层的客户端。当此参数为<code class="codeph">TRUE</code> ，调用者将被视为客户端。有关<code class="codeph">DBMS_SQL</code>更多信息。 <code class="codeph">OPEN_CURSOR</code>函数，请参见<a href="../arpls/DBMS_SQL.html#ARPLS68275" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a> 。
                     </p>
                     <p><code class="codeph">rc</code>参数是游标变量（ <code class="codeph">SYS_REFCURSOR</code> ）或打开游标的游标号（ <code class="codeph">INTEGER</code> ）。
                     </p>
                     <p>在<a href="dynamic-sql.html#GUID-1D6A4302-CBA0-47A6-B4A7-80B089DF4E61__CHDBBIFI">示例7-12中</a> ，过程<code class="codeph">get_employee_info</code>使用<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">RETURN_RESULT</code>将两个查询结果返回给客户端程序，并由匿名块<code class="codeph">&lt;&lt;main&gt;&gt;</code>动态调用。因为<code class="codeph">&lt;&lt;main&gt;&gt;</code>需要接收<code class="codeph">get_employee_info</code>返回的两个查询结果， <code class="codeph">&lt;&lt;main&gt;&gt;</code>打开一个游标以使用<code class="codeph">DBMS_SQL</code>调用<code class="codeph">get_employee_info</code> 。 <code class="codeph">OPEN_CURSOR</code> ，参数<code class="codeph">treat_as_client_for_results</code>设置为<code class="codeph">TRUE</code> 。因此， <code class="codeph">DBMS_SQL</code> 。 <code class="codeph">GET_NEXT_RESULT</code>将其结果返回给<code class="codeph">&lt;&lt;main&gt;&gt;</code> ，它使用光标<code class="codeph">rc</code>来获取它们。
                     </p>
                     <div class="example" id="GUID-1D6A4302-CBA0-47A6-B4A7-80B089DF4E61__CHDBBIFI">
                        <p class="titleinexample">例7-12 DBMS_SQL.GET_NEXT_RESULT过程</p><pre class="oac_no_warn" dir="ltr">创建或替换过程get_employee_info（id IN VARCHAR2）AUTHID DEFINER as rc SYS_REFCURSOR; BEGIN  - 返回员工信息OPEN rc FOR SELECT first_name，last_name，email，phone_number FROM employees WHERE employee_id = id; <span class="bold">DBMS_SQL.RETURN_RESULT（RC）;</span> - 返回员工职位历史OPEN RC FOR SELECT job_title，start_date，end_date FROM job_history jh，jobs j WHERE jh.employee_id = id AND jh.job_id = j.job_id ORDER BY start_date DESC; <span class="bold">DBMS_SQL.RETURN_RESULT（RC）;</span>结束; / <span class="bold">&lt;&lt; main &gt;&gt;</span> DECLARE c INTEGER; rc SYS_REFCURSOR; n NUMBER; first_name VARCHAR2（20）; last_name VARCHAR2（25）;电子邮件VARCHAR2（25）; phone_number VARCHAR2（20）; job_title VARCHAR2（35）; start_date DATE; end_date DATE; BEGIN <span class="bold">c：= DBMS_SQL.OPEN_CURSOR（true）;</span> DBMS_SQL.PARSE（ <span class="bold">c</span> ，' <span class="bold">BEGIN get_employee_info（：id）; END;</span> '，DBMS_SQL.NATIVE）; DBMS_SQL.BIND_VARIABLE（c，'：id'，176）; n：= DBMS_SQL.EXECUTE（c）; - 获取员工信息<span class="bold">dbms_sql.get_next_result（c，rc）;</span> <span class="bold">FETCH rc INTO first_name，last_name，email，phone_number;</span> DBMS_OUTPUT.PUT_LINE（'Employee：'|| first_name ||''|| last_name）; DBMS_OUTPUT.PUT_LINE（'电子邮件：'|| email）; DBMS_OUTPUT.PUT_LINE（'电话：'|| phone_number）; - 获取员工职位历史DBMS_OUTPUT.PUT_LINE（'标题：'）; <span class="bold">DBMS_SQL.GET_NEXT_RESULT（c，rc）;</span> LOOP <span class="bold">FETCH rc INTO job_title，start_date，end_date;</span>退出时rc％NOTFOUND; DBMS_OUTPUT.PUT_LINE（' - '|| job_title ||'（'|| start_date ||' - '|| end_date ||'）'）;结束循环; DBMS_SQL.CLOSE_CURSOR（C）;结束主; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">员工：Jonathon Taylor电子邮件：JTAYLOR电话：011.44.1644.429265标题： - 销售经理（01-JAN-07  -  31-DEC-07） - 销售代表（24-MAR-06-31-DEC-06）PL / SQL程序成功完成。</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="LNPLS635"></a><a id="LNPLS01113"></a><div class="props_rev_3"><a id="GUID-A194C9FA-221A-466B-9179-6238FEC5143B" name="GUID-A194C9FA-221A-466B-9179-6238FEC5143B"></a><h4 id="LNPLS-GUID-A194C9FA-221A-466B-9179-6238FEC5143B" class="sect4"><span class="enumeration_section">7.3.3</span> DBMS_SQL.TO_REFCURSOR函数</h4>
                  <div>
                     <p><code class="codeph">DBMS_SQL</code> 。 <code class="codeph">TO_REFCURSOR</code>函数将SQL游标编号转换为弱游标变量，您可以在本机动态SQL语句中使用该变量。
                     </p>
                     <p>在将SQL游标号传递给<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">TO_REFCURSOR</code>函数，您必须<code class="codeph">OPEN</code> ， <code class="codeph">PARSE</code>和<code class="codeph">EXECUTE</code>它（否则会发生错误）。
                     </p>
                     <p>将SQL游标编号转换为<code class="codeph">REF</code> <code class="codeph">CURSOR</code>变量后， <code class="codeph">DBMS_SQL</code>操作只能将其作为<code class="codeph">REF</code> <code class="codeph">CURSOR</code>变量访问，而不能作为SQL游标编号访问。例如，使用<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">IS_OPEN</code>函数查看转换的SQL游标号是否仍然打开会导致错误。
                     </p>
                     <p><a href="dynamic-sql.html#GUID-A194C9FA-221A-466B-9179-6238FEC5143B__g1777282">例7-13</a>使用<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">TO_REFCURSOR</code>函数用于从<code class="codeph">DBMS_SQL</code>包切换到本机动态SQL。</p>
                     <div class="example" id="GUID-A194C9FA-221A-466B-9179-6238FEC5143B__g1777282">
                        <p class="titleinexample">示例7-13从DBMS_SQL包切换到本机动态SQL</p><pre class="oac_no_warn" dir="ltr">创建或替换类型vc_array IS TABLE OF VARCHAR2（200）; / CREATE OR REPLACE TYPE numlist是数字表; / CREATE OR REPLACE PROCEDURE do_query_1（占位符vc_array，bindvars vc_array，sql_stmt VARCHAR2）AUTHID DEFINER是TYPE类型是否为REF CURSOR; src_cur curtype; curid NUMBER; bindnames vc_array; empnos numlist; depts numlist;返回NUMBER; isopen BOOLEAN; BEGIN <span class="bold">- 打开SQL游标号：</span> curid：= DBMS_SQL.OPEN_CURSOR; <span class="bold">- 解析SQL游标号：</span> DBMS_SQL.PARSE（curid，sql_stmt，DBMS_SQL.NATIVE）; bindnames：=占位符; - 绑定变量：FOR i IN 1 ..绑定名称。COUNT LOOP DBMS_SQL.BIND_VARIABLE（curid，bindnames（i），bindvars（i））;结束循环; <span class="bold">- 运行SQL游标号：</span> ret：= DBMS_SQL.EXECUTE（curid）; <span class="bold">- 从DBMS_SQL切换到本机动态SQL：</span> src_cur：= DBMS_SQL.TO_REFCURSOR（curid）; FETCH src_cur BULK收集进入empnos，depts; <span class="bold">- 这会导致错误，因为curid被转换为REF CURSOR：</span> -  isopen：= DBMS_SQL.IS_OPEN（curid）;关闭src_cur;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="LNPLS636"></a><a id="LNPLS00001"></a><div class="props_rev_3"><a id="GUID-8DF5B8A3-70F8-4AF5-A747-B1CE6B7D90DF" name="GUID-8DF5B8A3-70F8-4AF5-A747-B1CE6B7D90DF"></a><h4 id="LNPLS-GUID-8DF5B8A3-70F8-4AF5-A747-B1CE6B7D90DF" class="sect4"><span class="enumeration_section">7.3.4</span> DBMS_SQL.TO_CURSOR_NUMBER函数</h4>
                  <div>
                     <p><code class="codeph">DBMS_SQL</code> 。 <code class="codeph">TO_CURSOR_NUMBER</code>函数将<code class="codeph">REF</code> <code class="codeph">CURSOR</code>变量（强或弱）转换为SQL游标号，您可以将其传递给<code class="codeph">DBMS_SQL</code>子程序。
                     </p>
                     <p>在将<code class="codeph">REF</code> <code class="codeph">CURSOR</code>变量传递给<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">TO_CURSOR_NUMBER</code>函数，您必须<code class="codeph">OPEN</code>它。
                     </p>
                     <p>将<code class="codeph">REF</code> <code class="codeph">CURSOR</code>变量转换为SQL游标数后，本机动态SQL操作无法访问它。
                     </p>
                     <p><a href="dynamic-sql.html#GUID-8DF5B8A3-70F8-4AF5-A747-B1CE6B7D90DF__BHCHJBHJ">例7-14</a>使用<code class="codeph">DBMS_SQL</code> 。 <code class="codeph">TO_CURSOR_NUMBER</code>函数用于从本机动态SQL切换到<code class="codeph">DBMS_SQL</code>包。
                     </p>
                     <div class="example" id="GUID-8DF5B8A3-70F8-4AF5-A747-B1CE6B7D90DF__BHCHJBHJ">
                        <p class="titleinexample">示例7-14从本机动态SQL切换到DBMS_SQL包</p><pre class="oac_no_warn" dir="ltr">创建或替换过程do_query_2（sql_stmt VARCHAR2）AUTHID DEFINER类型为curtype IS REF CURSOR; src_cur curtype; curid NUMBER; desctab DBMS_SQL.DESC_TAB; colcnt NUMBER; namevar VARCHAR2（50）; numvar NUMBER; datevar DATE; empno NUMBER：= 100; BEGIN  -  sql_stmt：= SELECT ...FROM employees WHERE employee_id =：b1'; <span class="bold">- 打开REF CURSOR变量：</span> OPEN src_cur FOR sql_stmt USING empno; <span class="bold">- 从本机动态SQL切换到DBMS_SQL包：</span> curid：= DBMS_SQL.TO_CURSOR_NUMBER（src_cur）; DBMS_SQL.DESCRIBE_COLUMNS（curid，colcnt，desctab）; - 定义列：FOR i IN 1 .. colcnt LOOP IF desctab（i）.col_type = 2 THEN DBMS_SQL.DEFINE_COLUMN（curid，i，numvar）; ELSIF desctab（i）.col_type = 12那么DBMS_SQL.DEFINE_COLUMN（curid，i，datevar）; - 语句ELSE DBMS_SQL.DEFINE_COLUMN（curid，i，namevar，50）;万一;结束循环; - 使用DBMS_SQL包获取行：WHILE DBMS_SQL.FETCH_ROWS（curid）&gt; 0 LOOP FOR i IN 1 .. colcnt LOOP IF（desctab（i）.col_type = 1）那么DBMS_SQL.COLUMN_VALUE（curid，i，namevar）; ELSIF（desctab（i）.col_type = 2）那么DBMS_SQL.COLUMN_VALUE（curid，i，numvar）; ELSIF（desctab（i）.col_type = 12）那么DBMS_SQL.COLUMN_VALUE（curid，i，datevar）; - 陈述END IF;结束循环;结束循环; DBMS_SQL.CLOSE_CURSOR（curid）;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="LNPLS521"></a><a id="LNPLS637"></a><a id="LNPLS01109"></a><div class="props_rev_3"><a id="GUID-1E31057E-057F-4A53-B1DD-8BC2C337AA2C" name="GUID-1E31057E-057F-4A53-B1DD-8BC2C337AA2C"></a><h3 id="LNPLS-GUID-1E31057E-057F-4A53-B1DD-8BC2C337AA2C" class="sect3"><span class="enumeration_section">7.4</span> SQL注入</h3>
               <div>
                  <p>SQL注入恶意利用在SQL语句中使用客户端提供的数据的应用程序，从而获得对数据库的未授权访问以查看或操纵受限数据。</p>
                  <p>本节介绍PL / SQL中的SQL注入漏洞，并说明如何防范它们。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-1E31057E-057F-4A53-B1DD-8BC2C337AA2C__GUID-36C59DA9-FB2E-425E-9A86-39F0EB280269">话题</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="dynamic-sql.html#GUID-9353B33A-460A-4D4F-8FFF-FFF06A8C68D5" title="所有SQL注入技术都利用单个漏洞：字符串输入未正确验证并连接到动态SQL语句中。">SQL注入技术</a></p>
                        </li>
                        <li>
                           <p><a href="dynamic-sql.html#GUID-4503110E-DF12-487E-B613-6890CC55B6CD" title="如果在PL / SQL应用程序中使用动态SQL，则必须检查输入文本以确保它完全符合您的预期。">防止SQL注入</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-1E31057E-057F-4A53-B1DD-8BC2C337AA2C__CHDBJCFF">
                     <p class="titleinexample">示例7-15 SQL注入示例的设置</p>
                     <p>要尝试这些示例，请运行这些语句。</p>
                     <div class="infoboxnote" id="GUID-1E31057E-057F-4A53-B1DD-8BC2C337AA2C__GUID-38E9A2F6-64C1-49E1-B4CF-50224D594ECD">
                        <p class="notep1">实时SQL：</p>
                        <p>您可以在<a href="https://livesql.oracle.com/apex/livesql/docs/lnpls/plsql-dynamic-sql/tdlnplsdynamic3.html" target="_blank">SQL注入演示中</a>在Oracle Live SQL上查看和运行此示例</p>
                     </div><pre class="oac_no_warn" dir="ltr">DROP TABLE secret_records; CREATE TABLE secret_records（user_name VARCHAR2（9），service_type VARCHAR2（12），value VARCHAR2（30），date_created DATE）; INSERT INTO secret_records（user_name，service_type，value，date_created）VALUES（'Andy'，'服务员'，'在Cafe Pete'供应晚餐，SYSDATE）; INSERT INTO secret_records（user_name，service_type，value，date_created）VALUES（'Chuck'，'Merger'，'Buy company XYZ'，SYSDATE）;</pre></div>
                  <!-- class="example" -->
               </div><a id="LNPLS522"></a><a id="LNPLS638"></a><div class="props_rev_3"><a id="GUID-9353B33A-460A-4D4F-8FFF-FFF06A8C68D5" name="GUID-9353B33A-460A-4D4F-8FFF-FFF06A8C68D5"></a><h4 id="LNPLS-GUID-9353B33A-460A-4D4F-8FFF-FFF06A8C68D5" class="sect4"><span class="enumeration_section">7.4.1</span> SQL注入技术</h4>
                  <div>
                     <p>所有SQL注入技术都利用单个漏洞：字符串输入未正确验证并连接到动态SQL语句中。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-9353B33A-460A-4D4F-8FFF-FFF06A8C68D5__GUID-76E36AC5-93EA-43EC-BC1A-A65F13D09B0B">话题</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="dynamic-sql.html#GUID-0ED23CF7-1967-4C06-88CF-B3BB4AE7687F" title="语句修改意味着故意更改动态SQL语句，以便它以应用程序开发人员无意识的方式运行。">声明修改</a></p>
                           </li>
                           <li>
                              <p><a href="dynamic-sql.html#GUID-BA52854E-DAA5-497E-82B0-1686D4ED7C5C" title="语句注入意味着用户将一个或多个SQL语句附加到动态SQL语句。">声明注入</a></p>
                           </li>
                           <li>
                              <p><a href="dynamic-sql.html#GUID-9D45630C-ECBF-409B-91C0-D85CCC3FBD75" title="鲜为人知的SQL注入技术使用NLS会话参数来修改或注入SQL语句。">数据类型转换</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="LNPLS640"></a><a id="LNPLS639"></a><div class="props_rev_3"><a id="GUID-0ED23CF7-1967-4C06-88CF-B3BB4AE7687F" name="GUID-0ED23CF7-1967-4C06-88CF-B3BB4AE7687F"></a><h5 id="LNPLS-GUID-0ED23CF7-1967-4C06-88CF-B3BB4AE7687F" class="sect5"><span class="enumeration_section">7.4.1.1</span>声明修改</h5>
                     <div>
                        <p><span class="bold">语句修改</span>意味着故意更改动态SQL语句，以便它以应用程序开发人员无意识的方式运行。
                        </p>
                        <p>通常，用户通过更改<code class="codeph">SELECT</code>语句的<code class="codeph">WHERE</code>子句或插入<code class="codeph">UNION</code> <code class="codeph">ALL</code>子句来检索未经授权的数据。此技术的典型示例是通过使<code class="codeph">WHERE</code>子句始终为<code class="codeph">TRUE</code>来绕过密码身份验证。</p>
                        <div class="example" id="GUID-0ED23CF7-1967-4C06-88CF-B3BB4AE7687F__BJEJABIC">
                           <p class="titleinexample">示例7-16易于语句修改的过程</p>
                           <p>此示例创建一个易受语句修改影响的过程，然后使用和不使用语句修改调用该过程。通过语句修改，该过程返回一个所谓的秘密记录。</p>
                           <div class="infoboxnote" id="GUID-0ED23CF7-1967-4C06-88CF-B3BB4AE7687F__GUID-38E9A2F6-64C1-49E1-B4CF-50224D594ECD">
                              <p class="notep1">实时SQL：</p>
                              <p>您可以在<a href="https://livesql.oracle.com/apex/livesql/docs/lnpls/plsql-dynamic-sql/tdlnplsdynamic3.html" target="_blank">SQL注入演示中</a>在Oracle Live SQL上查看和运行此示例</p>
                           </div>
                           <p>创建易受攻击的程</p><pre class="oac_no_warn" dir="ltr">CREATE或REPLACE PROCEDURE get_record（user_name IN VARCHAR2，service_type IN VARCHAR2，rec OUT VARCHAR2）AUTHID DEFINER IS query VARCHAR2（4000）; BEGIN <span class="bold">- 以下SELECT语句易受修改</span> <span class="bold">- 因为它使用连接来构建WHERE子句。</span>query：='SELECT value FROM secret_records WHERE user_name ='''|| user_name || '''AND service_type ='''|| service_type || '' ''; DBMS_OUTPUT.PUT_LINE（'查询：'||查询）; EXECUTE IMMEDIATE查询INTO rec; DBMS_OUTPUT.PUT_LINE（'Rec：'|| rec）;结束; /</pre><p>演示没有SQL注入的过程：</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON; DECLARE record_value VARCHAR2（4000）; BEGIN get_record（'Andy'，'Waiter'，record_value）;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">查询：SELECT值FROM secret_records WHERE user_name ='Andy'AND service_type ='Waiter'Rec：在Cafe Pete享用晚餐</pre><p>声明修改示例：</p><pre class="oac_no_warn" dir="ltr">DECLARE record_value VARCHAR2（4000）; BEGIN get_record（ <span class="bold">'</span> Anybody''OR <span class="bold">service_type =''Merger'' - '，</span> 'Anything'，record_value）;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">查询：SELECT值FROM secret_records WHERE user_name ='Anybody'或</span> <span class="bold">service_type ='合并' - 'AND service_type ='任何'</span> <span class="bold">Rec：购买公司XYZ</span> PL / SQL程序已成功完成。</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="LNPLS642"></a><a id="LNPLS641"></a><div class="props_rev_3"><a id="GUID-BA52854E-DAA5-497E-82B0-1686D4ED7C5C" name="GUID-BA52854E-DAA5-497E-82B0-1686D4ED7C5C"></a><h5 id="LNPLS-GUID-BA52854E-DAA5-497E-82B0-1686D4ED7C5C" class="sect5"><span class="enumeration_section">7.4.1.2</span>语句注入</h5>
                     <div>
                        <p><span class="bold">语句注入</span>意味着用户将一个或多个SQL语句附加到动态SQL语句。
                        </p>
                        <p>匿名PL / SQL块容易受到这种技术的攻击。</p>
                        <div class="example" id="GUID-BA52854E-DAA5-497E-82B0-1686D4ED7C5C__BJEHHAFF">
                           <p class="titleinexample">示例7-17易于语句注入的过程</p>
                           <p>此示例创建一个易受语句注入攻击的过程，然后使用和不使用语句注入调用该过程。使用语句注入，该过程将删除<a href="dynamic-sql.html#GUID-0ED23CF7-1967-4C06-88CF-B3BB4AE7687F__BJEJABIC">示例7-16中</a>公开的所谓秘密记录。
                           </p>
                           <div class="infoboxnote" id="GUID-BA52854E-DAA5-497E-82B0-1686D4ED7C5C__GUID-38E9A2F6-64C1-49E1-B4CF-50224D594ECD">
                              <p class="notep1">实时SQL：</p>
                              <p>您可以在<a href="https://livesql.oracle.com/apex/livesql/docs/lnpls/plsql-dynamic-sql/tdlnplsdynamic3.html" target="_blank">SQL注入演示中</a>在Oracle Live SQL上查看和运行此示例</p>
                           </div>
                           <p>创建易受攻击的程</p><pre class="oac_no_warn" dir="ltr">创建或替换过程p（user_name IN VARCHAR2，service_type IN VARCHAR2）AUTHID DEFINER是block1 VARCHAR2（4000）; BEGIN <span class="bold">- 以下块容易受到语句注入的影响</span> <span class="bold">- 因为它是通过连接构建的。</span>block1：='BEGIN DBMS_OUTPUT.PUT_LINE（''user_name：'|| user_name ||'''）;' || 'DBMS_OUTPUT.PUT_LINE（''service_type：'|| service_type ||'''）;结束;'; DBMS_OUTPUT.PUT_LINE（'Block1：'|| block1）; EXECUTE IMMEDIATE block1;结束; /</pre><p>演示没有SQL注入的过程：</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON; BEGIN p（'安迪'，'服务员'）;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">Block1：BEGIN DBMS_OUTPUT.PUT_LINE（'user_name：Andy'）; DBMS_OUTPUT.PUT_LINE（'service_type：Waiter'）;结束; user_name：Andy service_type：服务员</pre><p>SQL * Plus格式化命令：</p><pre class="oac_no_warn" dir="ltr">COLUMN date_created FORMAT A12;</pre><p>查询：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">SELECT * FROM secret_records ORDER BY user_name;</span>
</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">USER_NAME SERVICE_TYPE VALUE DATE_CREATED --------- ------------ ------------------------- ----- ------------ Andy Waiter在Cafe Pete 28-APR-10 Chuck Merger购买公司XYZ 28-APR-10</pre><p>声明修改示例：</p><pre class="oac_no_warn" dir="ltr">BEGIN p（'Anybody'， <span class="bold">'Anything''）;</span> <span class="bold">DELETE FROM secret_records WHERE service_type = INITCAP（''Merger'</span> ）;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">Block1：BEGIN DBMS_OUTPUT.PUT_LINE（'user_name：Anybody'）; DBMS_OUTPUT.PUT_LINE（'service_type：Anything <span class="bold">'）;</span> <span class="bold">DELETE FROM secret_records WHERE service_type = INITCAP（'Merger'</span> ）;结束; user_name：Anybody service_type：已成功完成任何PL / SQL过程。
</pre><p>查询：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">SELECT * FROM secret_records;</span>
</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">USER_NAME SERVICE_TYPE VALUE DATE_CREATED --------- ------------ ------------------------- ----- ------------ Andy Waiter在Cafe Pete 18-MAR-09 <span class="bold">1行选择</span>晚餐<span class="bold">。</span></pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="LNPLS644"></a><a id="LNPLS643"></a><div class="props_rev_3"><a id="GUID-9D45630C-ECBF-409B-91C0-D85CCC3FBD75" name="GUID-9D45630C-ECBF-409B-91C0-D85CCC3FBD75"></a><h5 id="LNPLS-GUID-9D45630C-ECBF-409B-91C0-D85CCC3FBD75" class="sect5"><span class="enumeration_section">7.4.1.3</span>数据类型转换</h5>
                     <div>
                        <p>鲜为人知的SQL注入技术使用NLS会话参数来修改或注入SQL语句。</p>
                        <p>必须将连接到动态SQL语句文本中的日期时间或数值转换为<code class="codeph">VARCHAR2</code>数据类型。转换可以是隐式的（当值是连接运算符的操作数时）或显式的（当值是<code class="codeph">TO_CHAR</code>函数的参数时）。此数据类型转换取决于运行动态SQL语句的数据库会话的NLS设置。日期时间值的转换使用参数<code class="codeph">NLS_DATE_FORMAT</code> ， <code class="codeph">NLS_TIMESTAMP_FORMAT</code>或<code class="codeph">NLS_TIMESTAMP_TZ_FORMAT</code>指定的格式模型，具体取决于特定的日期时间数据类型。数值的转换应用参数<code class="codeph">NLS_NUMERIC_CHARACTERS</code>指定的十进制和组分隔符。</p>
                        <p>一个日期时间格式模型是<code class="codeph">"</code> <span class="italic"><code class="codeph">text</code></span> <code class="codeph">"</code> 。<span class="italic"><code class="codeph">text</code></span>将复制到转换结果中。例如，如果<code class="codeph">NLS_DATE_FORMAT</code>值为<code class="codeph">'"Month:" Month'</code> ，那么在6月， <code class="codeph">TO_CHAR(SYSDATE)</code>将返回<code class="codeph">'Month: June'</code> 。日期时间格式模型可能会被滥用，如<a href="dynamic-sql.html#GUID-9D45630C-ECBF-409B-91C0-D85CCC3FBD75__CHDEIABG">例7-18</a>所示。
                        </p>
                        <div class="example" id="GUID-9D45630C-ECBF-409B-91C0-D85CCC3FBD75__CHDEIABG">
                           <p class="titleinexample">示例7-18通过数据类型转换易受SQL注入的过程</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM secret_records;</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">USER_NAME SERVICE_TYPE VALUE DATE_CREATE --------- ------------ ------------------------- ----- ----------- Andy Waiter在Cafe Pete 28-APR-2010 Chuck Merger购买公司XYZ 28-APR-2010</pre><p>创建易受攻击的程</p><pre class="oac_no_warn" dir="ltr">- 返回不超过一个月的记录CREATE OR REPLACE PROCEDURE get_recent_record（user_name IN VARCHAR2，service_type IN VARCHAR2，rec OUT VARCHAR2）AUTHID DEFINER IS query VARCHAR2（4000）; BEGIN <span class="bold">/ *以下SELECT语句很容易被修改，</span> <span class="bold">因为它使用连接来构建WHERE子句，</span> <span class="bold">并且因为SYSDATE取决于NLS_DATE_FORMAT的值。 * /</span> query：='SELECT value FROM secret_records WHERE user_name ='''|| user_name || '''AND service_type ='''|| service_type || '''和date_created&gt;'''|| <span class="bold">（SYSDATE  -  30）</span> || '' ''; DBMS_OUTPUT.PUT_LINE（'查询：'||查询）; EXECUTE IMMEDIATE查询INTO rec; DBMS_OUTPUT.PUT_LINE（'Rec：'|| rec）;结束; /</pre><p>演示没有SQL注入的过程：</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON; <span class="bold">ALTER SESSION SET NLS_DATE_FORMAT ='DD-MON-YYYY';</span> DECLARE record_value VARCHAR2（4000）; BEGIN get_recent_record（'Andy'，'Waiter'，record_value）;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">查询：SELECT值FROM secret_records WHERE user_name ='Andy'AND service_type ='Waiter'和date_created&gt; '29 -MAR-2010'Rec：在Cafe Pete享用晚餐</pre><p>声明修改示例：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">ALTER SESSION SET NLS_DATE_FORMAT ='“''OR service_type =''Merger”';</span> DECLARE record_value VARCHAR2（4000）; BEGIN get_recent_record（'Anybody'，'Anything'，record_value）;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">查询：SELECT值FROM secret_records WHERE user_name ='Anybody'AND</span> <span class="bold">service_type ='Anything'AND_created&gt;''OR service_type ='合并'</span> <span class="bold">Rec：购买公司XYZ</span> PL / SQL程序已成功完成。</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="LNPLS645"></a><div class="props_rev_3"><a id="GUID-4503110E-DF12-487E-B613-6890CC55B6CD" name="GUID-4503110E-DF12-487E-B613-6890CC55B6CD"></a><h4 id="LNPLS-GUID-4503110E-DF12-487E-B613-6890CC55B6CD" class="sect4"><span class="enumeration_section">7.4.2</span>防止SQL注入</h4>
                  <div>
                     <p>如果在PL / SQL应用程序中使用动态SQL，则必须检查输入文本以确保它完全符合您的预期。</p>
                     <p>您可以使用以下技术：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="dynamic-sql.html#GUID-EF9233BB-9570-453D-96EB-E13F43B10596" title="使PL / SQL代码无法受到SQL注入攻击的最有效方法是使用绑定变量。">绑定变量</a></p>
                        </li>
                        <li>
                           <p><a href="dynamic-sql.html#GUID-44F80A6B-99B4-4DB7-8BF8-B17994AD197A" title="始终让您的程序验证用户输入以确保它是预期的。">验证检查</a></p>
                        </li>
                        <li>
                           <p><a href="dynamic-sql.html#GUID-4DB96B62-75BE-424E-B6F7-BB0597FCAA58" title="建议不仅从安全角度使用显式的与语言环境无关的格式模型来构造SQL，还要确保动态SQL语句在任何全球化环境中正确运行。">显式格式模型</a></p>
                        </li>
                     </ul>
                  </div><a id="LNPLS647"></a><a id="LNPLS646"></a><div class="props_rev_3"><a id="GUID-EF9233BB-9570-453D-96EB-E13F43B10596" name="GUID-EF9233BB-9570-453D-96EB-E13F43B10596"></a><h5 id="LNPLS-GUID-EF9233BB-9570-453D-96EB-E13F43B10596" class="sect5"><span class="enumeration_section">7.4.2.1</span>绑定变量</h5>
                     <div>
                        <p>使PL / SQL代码无法受到SQL注入攻击的最有效方法是使用绑定变量。</p>
                        <p>数据库仅使用绑定变量的值，并且不以任何方式解释其内容。（绑定变量也可以提高性能。）</p>
                        <div class="example" id="GUID-EF9233BB-9570-453D-96EB-E13F43B10596__BJEIJEBJ">
                           <p class="titleinexample">例7-19防止SQL注入的绑定变量</p>
                           <p>此示例中的过程不受SQL注入的影响，因为它使用绑定变量构建动态SQL语句（而不是像<a href="dynamic-sql.html#GUID-0ED23CF7-1967-4C06-88CF-B3BB4AE7687F__BJEJABIC">示例7-16</a>中的易受攻击过程那样通过连接）。相同的绑定技术修复了<a href="dynamic-sql.html#GUID-BA52854E-DAA5-497E-82B0-1686D4ED7C5C__BJEHHAFF">例7-17中</a>所示的易受攻击的过程。
                           </p>
                           <p>创建无懈可击的程序：</p><pre class="oac_no_warn" dir="ltr">创建或替换过程get_record_2（user_name IN VARCHAR2，service_type IN VARCHAR2，rec OUT VARCHAR2）AUTHID DEFINER IS query VARCHAR2（4000）; BEGIN query：='SELECT value FROM secret_records WHERE user_name = <span class="bold">：a</span> AND service_type = <span class="bold">：b</span> '; DBMS_OUTPUT.PUT_LINE（'查询：'||查询）; EXECUTE IMMEDIATE query INTO rec <span class="bold">USING user_name，service_type</span> ; DBMS_OUTPUT.PUT_LINE（'Rec：'|| rec）;结束; /</pre><p>演示没有SQL注入的过程：</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON; DECLARE record_value VARCHAR2（4000）; BEGIN get_record_2（'Andy'，'Waiter'，record_value）;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">查询：SELECT值FROM secret_records WHERE user_name = <span class="bold">：a</span> AND service_type = <span class="bold">：b</span> Rec：成功完成Cafe Pete PL / SQL程序的晚餐。
 </pre><p>尝试声明修改：</p><pre class="oac_no_warn" dir="ltr">DECLARE record_value VARCHAR2（4000）; BEGIN get_record_2（'Anybody''OR service_type =''Merger'' - '，'Anything'，record_value）;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">查询：SELECT值FROM secret_records WHERE user_name = <span class="bold">：a</span> AND service_type = <span class="bold">：b</span> <span class="bold">第1行的</span> DECLARE * <span class="bold">ERROR：</span> <span class="bold">ORA-01403：未找到数据</span> <span class="bold">ORA-06512：位于“HR.GET_RECORD_2”，第15行</span> <span class="bold">ORA-06512：第4行</span></pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="LNPLS649"></a><a id="LNPLS648"></a><div class="props_rev_3"><a id="GUID-44F80A6B-99B4-4DB7-8BF8-B17994AD197A" name="GUID-44F80A6B-99B4-4DB7-8BF8-B17994AD197A"></a><h5 id="LNPLS-GUID-44F80A6B-99B4-4DB7-8BF8-B17994AD197A" class="sect5"><span class="enumeration_section">7.4.2.2</span>验证检查</h5>
                     <div>
                        <p>始终让您的程序验证用户输入以确保它是预期的。</p>
                        <p>例如，如果用户正在传递<code class="codeph">DELETE</code>语句的部门号，请通过从<code class="codeph">departments</code>表中选择来检查此部门号的有效性。同样，如果用户输入要删除的表的名称，请通过从静态数据字典视图<code class="codeph">ALL_TABLES</code>进行选择来检查该表是否存在。</p>
                        <div class="infoboxnote" id="GUID-44F80A6B-99B4-4DB7-8BF8-B17994AD197A__GUID-EEBA64CB-B62B-4CE1-9661-F0AB2AC2E021">
                           <p class="notep1">警告：</p>
                           <p>检查用户名及其密码的有效性时，无论哪个项无效，都始终返回相同的错误。否则，收到错误消息“无效密码”但不是“无效用户名”（或反向）的恶意用户可以意识到他或她已正确猜到其中一个。</p>
                        </div>
                        <p>在验证检查代码中， <code class="codeph">DBMS_ASSERT</code>包中的子程序通常很有用。例如，您可以使用<code class="codeph">DBMS_ASSERT</code> 。 <code class="codeph">ENQUOTE_LITERAL</code>函数用于将字符串文字括在引号中，如<a href="dynamic-sql.html#GUID-44F80A6B-99B4-4DB7-8BF8-B17994AD197A__CHDGJEGD">例7-20所示</a> 。这可以防止恶意用户在开始引号和相应的右引号之间注入文本。
                        </p>
                        <div class="infoboxnote" id="GUID-44F80A6B-99B4-4DB7-8BF8-B17994AD197A__GUID-4AD6631A-88F3-4964-9000-7C2FB39EC9B2">
                           <p class="notep1">警告：</p>
                           <p>尽管<code class="codeph">DBMS_ASSERT</code>子程序在验证代码中很有用，但它们并不能替代它。例如，输入字符串可以是一个合格的SQL名称（通过验证<code class="codeph">DBMS_ASSERT</code> 。 <code class="codeph">QUALIFIED_SQL_NAME</code> ），仍然是一个欺诈性的密码。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-44F80A6B-99B4-4DB7-8BF8-B17994AD197A__GUID-B11BBB2F-639D-4520-9A31-8F6724B0DA3E">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">DBMS_ASSERT</code>子程序的信息，请<code class="codeph">DBMS_ASSERT</code> <a href="../arpls/DBMS_ASSERT.html#ARPLS231" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                        </div>
                        <div class="example" id="GUID-44F80A6B-99B4-4DB7-8BF8-B17994AD197A__CHDGJEGD">
                           <p class="titleinexample">例7-20验证检查防止SQL注入</p>
                           <p>在此示例中，过程<code class="codeph">raise_emp_salary</code>检查在更新<code class="codeph">employees</code>表之前传递给它的列名的有效性，然后匿名块从动态PL / SQL块和动态SQL语句调用该过程。
                           </p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PROCEDURE raise_emp_salary（column_value NUMBER，emp_column VARCHAR2，amount NUMBER）AUTHID DEFINER IS v_column VARCHAR2（30）; sql_stmt VARCHAR2（200）; BEGIN <span class="bold">- 检查作为输入提供的列名的有效性：</span> SELECT column_name INTO v_column FROM USER_TAB_COLS WHERE TABLE_NAME ='EMPLOYEES'AND COLUMN_NAME = emp_column; sql_stmt：='UPDATE employees SET salary = salary +：1 WHERE'|| <span class="bold">DBMS_ASSERT.ENQUOTE_NAME（v_column，FALSE）</span> || '=：2'; EXECUTE IMMEDIATE sql_stmt USING amount，column_value; <span class="bold">- 如果列名有效：</span> IF SQL％ROWCOUNT&gt; 0那么DBMS_OUTPUT.PUT_LINE（'工资更新为：'|| emp_column ||'='|| column_value）;万一; <span class="bold">- 如果列名</span>无效：EXSEPTION NO_DATA_FOUND那么DBMS_OUTPUT.PUT_LINE（'无效列：'|| emp_column）; END raise_emp_salary; / DECLARE plsql_block VARCHAR2（500）; BEGIN <span class="bold">- 从动态PL / SQL块调用raise_emp_salary：</span> plsql_block：='BEGIN raise_emp_salary（：cvalue，：cname，：amt）;结束;'; EXECUTE IMMEDIATE plsql_block使用110，'DEPARTMENT_ID'，10; <span class="bold">- 从动态SQL语句调用raise_emp_salary：</span> EXECUTE IMMEDIATE'BEGIN raise_emp_salary（：cvalue，：cname，：amt）;结束;'使用112，'EMPLOYEE_ID'，10;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">工资更新时间：DEPARTMENT_ID = 110薪资更新时间：EMPLOYEE_ID = 112</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="LNPLS651"></a><a id="LNPLS650"></a><div class="props_rev_3"><a id="GUID-4DB96B62-75BE-424E-B6F7-BB0597FCAA58" name="GUID-4DB96B62-75BE-424E-B6F7-BB0597FCAA58"></a><h5 id="LNPLS-GUID-4DB96B62-75BE-424E-B6F7-BB0597FCAA58" class="sect5"><span class="enumeration_section">7.4.2.3</span>显式格式模型</h5>
                     <div>
                        <p>建议不仅从安全角度使用显式的与语言环境无关的格式模型来构造SQL，还要确保动态SQL语句在任何全球化环境中正确运行。</p>
                        <p>如果使用连接到SQL或PL / SQL语句文本的日期时间和数值，并且不能将它们作为绑定变量传递，请使用独立于NLS参数值的显式格式模型将它们转换为文本。正在运行的会话。确保转换后的值具有SQL datetime或numeric literals的格式。</p>
                        <div class="example" id="GUID-4DB96B62-75BE-424E-B6F7-BB0597FCAA58__CHDFIIEF">
                           <p class="titleinexample">例7-21防止SQL注入的显式格式模型</p>
                           <p>此过程对SQL注入是无懈可击的，因为它使用<code class="codeph">TO_CHAR</code>函数和与语言环境无关的格式模型显式地将datetime参数值<code class="codeph">SYSDATE</code> <code class="codeph">-</code> <code class="codeph">30</code>转换为<code class="codeph">VARCHAR2</code>值（不是隐式地，如<a href="dynamic-sql.html#GUID-9D45630C-ECBF-409B-91C0-D85CCC3FBD75__CHDEIABG">示例7-18</a>中的易受攻击的过程） ）。
                           </p>
                           <p>创建无懈可击的程序：</p><pre class="oac_no_warn" dir="ltr">- 返回不超过一个月的记录CREATE OR REPLACE PROCEDURE get_recent_record（user_name IN VARCHAR2，service_type IN VARCHAR2，rec OUT VARCHAR2）AUTHID DEFINER IS query VARCHAR2（4000）; BEGIN / *以下SELECT语句易受修改，因为它使用连接来构建WHERE子句。* / query：='SELECT value FROM secret_records WHERE user_name ='''|| user_name || '''AND service_type ='''|| service_type || '''和date_created&gt; DATE'''|| <span class="bold">TO_CHAR（SYSDATE  -  30，'YYYY-MM-DD'</span> ）|| '' ''; DBMS_OUTPUT.PUT_LINE（'查询：'||查询）; EXECUTE IMMEDIATE查询INTO rec; DBMS_OUTPUT.PUT_LINE（'Rec：'|| rec）;结束; /</pre><p>尝试声明修改：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">ALTER SESSION SET NLS_DATE_FORMAT ='“''OR service_type =''Merger”';</span> DECLARE record_value VARCHAR2（4000）; BEGIN get_recent_record（'Anybody'，'Anything'，record_value）;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">查询：FROM secret_records SELECT值其中user_name = '任何人' AND</span> <span class="bold">SERVICE_TYPE = '任何' AND DATE_CREATED&gt; DATE '2010-03-29'</span> <span class="bold">DECLARE</span> <span class="bold">*</span> <span class="bold">ERROR位于第1行<span class="bold">：ORA-01403：</span></span> <span class="bold">发现</span> <span class="bold">ORA-06512</span> <span class="bold">无数据</span> <span class="bold">：在“SYS .GET_RECENT_RECORD“，第21行</span> <span class="bold">ORA-06512：第4行</span> </pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="09691.sharding-loading-data.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can migrate data from a non-sharded database to an Oracle Sharding sharded database using the methods described here."></meta>
      <meta name="description" content="You can migrate data from a non-sharded database to an Oracle Sharding sharded database using the methods described here."></meta>
      <title>将数据迁移到Sharded数据库</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Using Oracle Sharding"></meta>
      <meta property="og:description" content="You can migrate data from a non-sharded database to an Oracle Sharding sharded database using the methods described here."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Using Oracle Sharding"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="using-oracle-sharding.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-14T12:19:13-08:00"></meta>
      <meta name="dcterms.title" content="Using Oracle Sharding"></meta>
      <meta name="dcterms.dateCopyrighted" content="2018, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E87088-04"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="sharding-deployment.html" title="Previous" type="text/html"></link>
      <link rel="next" href="sharding-lifecycle-management.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="SHARD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="sharding-deployment.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="sharding-lifecycle-management.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">使用Oracle Sharding</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">将数据迁移到Sharded数据库</li>
            </ol>
            <a id="GUID-6140925F-6192-4C6F-9ADC-BC2332ADA3B0" name="GUID-6140925F-6192-4C6F-9ADC-BC2332ADA3B0"></a>
            
            <h2 id="SHARD-GUID-6140925F-6192-4C6F-9ADC-BC2332ADA3B0" class="sect2"><span class="enumeration_chapter">9将</span>数据迁移到分片数据库</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以使用此处描述的方法将数据从非分片数据库迁移到Oracle Sharding分片数据库。</p>
               <p>这些数据加载方法假定您在要迁移到分片数据库时使用非分片Oracle数据库。提出的这些方法也适用于从其他数据库系统以及第一次数据库用户迁移数据。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="sharding-loading-data.html#GUID-041069C8-FA7B-4BA5-BFB8-B5A949DA12A9">关于将数据迁移到分片数据库</a><br>在Oracle Sharding软件安装以及分片数据库配置和创建之后，您可以将数据迁移到分片数据库。
                  </li>
                  <li class="ulchildlink"><a href="sharding-loading-data.html#GUID-6E455646-F4AA-4992-B50B-58A1290355FE">将数据加载到分片数据库的一般准则</a><br>从非分片数据库转换为分片数据库涉及将数据从非分片表移动到分片和重复表。将数据从非分片表移动到重复表不会带来任何复杂性，但是将数据从非分片表移动到分片表需要特别注意。
                  </li>
                  <li class="ulchildlink"><a href="sharding-loading-data.html#GUID-DD36B05A-AC5F-488D-9012-70043ED3E7EE">迁移架构</a><br>在将现有数据库迁移到分片数据库之前，必须确定如何组织分片数据库，包括分片数和复制策略，并且必须确定应用程序中哪些表是分片的，哪些表是重复的表。对于分片表，您必须确定分片方法以及表族中分片表之间的父子关系。
                  </li>
                  <li class="ulchildlink"><a href="sharding-loading-data.html#GUID-18D1592D-3A41-4C81-ABEF-86527A610A3D">准备源数据库</a><br>要使转换为分片数据库模式更顺畅，可以修改源非分片数据库，使其与目标分片数据库中的表定义匹配。
                  </li>
                  <li class="ulchildlink"><a href="sharding-loading-data.html#GUID-59B5EABA-3C10-4329-B662-9E17F2303498">准备目标分片数据库</a><br>在开始将数据迁移到分片数据库之前，必须根据设计创建分片数据库模式。
                  </li>
                  <li class="ulchildlink"><a href="sharding-loading-data.html#GUID-B464BEB3-AEB7-4F6D-8328-C25F69FD223F">迁移您的数据</a><br>使用单个分片或多个分片创建目标分片数据库后，如果已定义分片和重复表，则可以开始将数据迁移到分片数据库中。
                  </li>
                  <li class="ulchildlink"><a href="sharding-loading-data.html#GUID-FD50835F-514F-4E74-95D3-BD0B4A6B0F20">迁移您的应用程序</a><br>分片数据库操作环境使应用程序能够直接访问分片。此功能提供了真正的线性可扩展性，但它的价格很低 - 对应用程序代码稍作改动。
                  </li>
               </ul>
            </div>
            
            <div class="sect2"><a id="GUID-041069C8-FA7B-4BA5-BFB8-B5A949DA12A9" name="GUID-041069C8-FA7B-4BA5-BFB8-B5A949DA12A9"></a><h3 id="SHARD-GUID-041069C8-FA7B-4BA5-BFB8-B5A949DA12A9" class="sect3"><span class="enumeration_section">9.1</span>关于将数据迁移到分片数据库</h3>
               <div>
                  <p>在Oracle Sharding软件安装以及分片数据库配置和创建之后，您可以将数据迁移到分片数据库。</p>
                  <p>以下是迁移到分片数据库环境的高级步骤。</p>
                  <ol>
                     <li>设计并创建分片数据库模式。</li>
                     <li>迁移数据。</li>
                     <li>迁移应用程序。</li>
                  </ol>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-041069C8-FA7B-4BA5-BFB8-B5A949DA12A9__GUID-9D648D57-1DC0-4351-BFAE-DE1153704986">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="sharding-overview.html#GUID-DDF69235-8761-44DA-98AC-3080A239E63E" title="Oracle Sharding适用于适用于分片数据库的OLTP应用程序。">应用程序适用于分片，</a>以熟悉迁移到分片数据库应用程序的约束。
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="sharding-loading-data.html#GUID-6140925F-6192-4C6F-9ADC-BC2332ADA3B0" title="您可以使用此处描述的方法将数据从非分片数据库迁移到Oracle Sharding分片数据库。">数据迁移到Sharded数据库</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-6E455646-F4AA-4992-B50B-58A1290355FE" name="GUID-6E455646-F4AA-4992-B50B-58A1290355FE"></a><h3 id="SHARD-GUID-6E455646-F4AA-4992-B50B-58A1290355FE" class="sect3"><span class="enumeration_section">9.2</span>将数据加载到分片数据库的一般准则</h3>
               <div>
                  <p>从非分片数据库转换为分片数据库涉及将数据从非分片表移动到分片和重复表。将数据从非分片表移动到重复表不会带来任何复杂性，但是将数据从非分片表移动到分片表需要特别注意。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-6E455646-F4AA-4992-B50B-58A1290355FE__GUID-4C5D6A0D-884E-4B75-8BC6-DDFBEB05E343">将数据加载到重复的表中</p>
                     <p>可以使用任何现有的数据库工具将数据加载到重复的表中：Data Pump，SQL Loader或纯SQL。必须使用分片目录（协调程序）数据库节点加载数据。换句话说，重复表的全部内容包含在分片目录数据库中。由于复制表的内容使用实例化视图完全复制到数据库分片，因此加载重复的表可能比将相同数据加载到非分片表中所花费的时间更长。</p>
                     <div class="figure" id="GUID-6E455646-F4AA-4992-B50B-58A1290355FE__FIG_JCC_F5G_5GB">
                        <p class="titleinfigure">图9-1加载重复的表</p><br><div class="imageleft"><img class="imageleft" id="GUID-6E455646-F4AA-4992-B50B-58A1290355FE__IMAGE_KCC_F5G_5GB" src="img/load_duplicate_tables.png" alt="下面是图9-1的描述" title="下面是图9-1的描述" longdesc="img_text/load_duplicate_tables.html"><br><a href="img_text/load_duplicate_tables.html">“图9-1加载重复表”的说明</a></div><br></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-6E455646-F4AA-4992-B50B-58A1290355FE__GUID-51AE4E26-A9F9-4055-AFD7-EE916519E5B1">将数据加载到分片表中</p>
                     <p>加载分片表时，每个数据库分片都适应整个数据集的不同子集（分片），因此在将每个子集加载到特定分片之前，必须分割（混洗）数据。</p>
                     <div class="figure" id="GUID-6E455646-F4AA-4992-B50B-58A1290355FE__FIG_OD1_CVG_5GB">
                        <p class="titleinfigure">图9-2使用分片目录加载分片表</p><br><div class="imageleft"><img class="imageleft" id="GUID-6E455646-F4AA-4992-B50B-58A1290355FE__IMAGE_PD1_CVG_5GB" src="img/load_sharded_tables_coordinator.png" alt="下面是图9-2的描述" title="下面是图9-2的描述" longdesc="img_text/load_sharded_tables_coordinator.html"><br><a href="img_text/load_sharded_tables_coordinator.html">“图9-2使用碎片目录加载分片表”的说明</a></div><br></div>
                     <!-- class="figure" -->
                     <p>您必须使用Oracle Data Pump实用程序在子集中的数据库分片中加载数据。请考虑以下两个选项：</p>
                     <ul id="GUID-6E455646-F4AA-4992-B50B-58A1290355FE__UL_D45_C42_KGB" style="list-style-type:disc">
                        <li>通过分片协调器（目录）节点加载数据，如上所示。</li>
                        <li>将数据直接加载到数据库分片，如下所示。</li>
                     </ul>
                     <div class="figure" id="GUID-6E455646-F4AA-4992-B50B-58A1290355FE__FIG_GY2_TVG_5GB">
                        <p class="titleinfigure">图9-3直接将Sharded Tables加载到数据库碎片</p><br><div class="imageleft"><img class="imageleft" id="GUID-6E455646-F4AA-4992-B50B-58A1290355FE__IMAGE_HY2_TVG_5GB" src="img/load_sharded_tables_direct.png" alt="下面是图9-3的描述" title="下面是图9-3的描述" longdesc="img_text/load_sharded_tables_direct.html"><br><a href="img_text/load_sharded_tables_direct.html">“图9-3直接将分片表加载到数据库碎片”的说明</a></div><br></div>
                     <!-- class="figure" -->
                     <p>使用分片协调器将数据加载到分片数据库比将整个数据集加载到非分片表中要慢，因为分片逻辑在分片协调器（目录）节点上运行，以及将数据推送到分片的额外开销。</p>
                     <p>将数据直接加载到数据库分片中要快得多，因为每个分片都是单独加载的。也就是说，通过在每个分片上运行Data Pump，您可以在使用整个数据集的最大子集加载分片所需的时间段内完成数据加载操作。平均而言，加载时间可以近似为将整个数据集加载到非分片数据库所需的时间除以分片数据库中的分片数。</p>
                     <p>您可以使用开源分片库拆分库，将分割（混洗）逻辑集成到您的应用程序中，而不是依赖Oracle Data Pump实用程序来拆分不同子集中的加载数据集。分片库源代码以及样本使用可在Oracle Sharding Tools Library中找到， <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/shard&amp;id=sharding_tools_library" target="_blank">网址</a>为<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/shard&amp;id=sharding_tools_library" target="_blank">https://github.com/oracle/db-sharding/</a> 。基于此分片库，Oracle开发了一个通用流加载库，供Oracle云中使用。此时，流媒体加载库仅在请求时可用。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="sharding-loading-data.html#GUID-6140925F-6192-4C6F-9ADC-BC2332ADA3B0" title="您可以使用此处描述的方法将数据从非分片数据库迁移到Oracle Sharding分片数据库。">数据迁移到Sharded数据库</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-DD36B05A-AC5F-488D-9012-70043ED3E7EE" name="GUID-DD36B05A-AC5F-488D-9012-70043ED3E7EE"></a><h3 id="SHARD-GUID-DD36B05A-AC5F-488D-9012-70043ED3E7EE" class="sect3"><span class="enumeration_section">9.3</span>迁移模式</h3>
               <div>
                  <p>在将现有数据库迁移到分片数据库之前，必须确定如何组织分片数据库，包括分片数和复制策略，并且必须确定应用程序中哪些表是分片的，哪些表是重复的表。对于分片表，您必须确定分片方法以及表族中分片表之间的父子关系。</p>
                  <p>使用示例应用程序说明了到分片数据库环境的模式迁移，该应用程序是在数据模型和强加约束上定义的。我们分析了如何使用示例程序代码迁移到分片数据库对应用程序的影响。下图显示了示例应用程序数据模型</p>
                  <div class="figure" id="GUID-DD36B05A-AC5F-488D-9012-70043ED3E7EE__GUID-3D6A995B-26D2-4857-9631-8FCFBE978202">
                     <p class="titleinfigure">图9-4</p><img src="img/sample_schema.png" alt="下面是图9-4的描述" title="下面是图9-4的描述" longdesc="img_text/sample_schema.html"><br><a href="img_text/sample_schema.html">“图9-4”的描述</a></div>
                  <!-- class="figure" -->
                  <p>数据模型包括四个表：Customers，Orders，StockItems和LineItems，该模型强制执行以下主键约束。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>顾客。（CustNo）</p>
                     </li>
                     <li>
                        <p>命令。（PONO）</p>
                     </li>
                     <li>
                        <p>StockItems。（StockNo）</p>
                     </li>
                     <li>
                        <p>了LineItem。（LineNo，PONo）</p>
                     </li>
                  </ul>
                  <p>数据模型定义了以下参照完整性约束。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>顾客。CustNo  - &gt;订单。CustNo</p>
                     </li>
                     <li>
                        <p>命令。PONo  - &gt; LineItems。PONO</p>
                     </li>
                     <li>
                        <p>StockItems。StockNo  - &gt; LineItems。StockNo</p>
                     </li>
                  </ul>
                  <p>以下DDL语句创建示例应用程序数据库模式定义：</p><pre class="pre codeblock"><code>CREATE TABLE客户（CustNo NUMBER（3）NOT NULL，CusName VARCHAR2（30）NOT NULL，Street VARCHAR2（20）NOT NULL，City VARCHAR2（20）NOT NULL，State CHAR（2）NOT NULL，Zip VARCHAR2（10）NOT NULL，Phone VARCHAR2（12），PRIMARY KEY（CustNo））; CREATE TABLE订单（PoNo NUMBER（5），CustNo NUMBER（3）REFERENCES Customers，OrderDate DATE，ShipDate DATE，ToStreet VARCHAR2（20），ToCity VARCHAR2（20），ToState CHAR（2），ToZip VARCHAR2（10），PRIMARY KEY （PoNo））; CREATE TABLE StockItems（StockNo NUMBER（4）PRIMARY KEY Description VARCHAR2（20），Price NUMBER（6,2））; CREATE TABLE LineItems（LineNo NUMBER（2），PoNo NUMBER（5）REFERENCES Orders，StockNo NUMBER（4）REFERENCES StockItems，Quantity NUMBER（2），Discount NUMBER（4,2），PRIMARY KEY（LineNo，PoNo））;</code></pre><div class="section">
                     <p class="subhead2" id="GUID-DD36B05A-AC5F-488D-9012-70043ED3E7EE__GUID-B5F2DD8A-C80D-4520-9858-C009749FE400">分片密钥</p>
                     <p>Sharding是一种基于跨多个独立Oracle数据库的水平分区的数据库扩展技术。根据分片键列的值将数据库请求路由到适当的分片数据库。分片设计目标是选择一个分片键，最大化单个分片操作，并最小化或消除交叉分片操作。</p>
                     <p>基于样本应用程序数据模型中标识的外键功能依赖性的主键，形成下表族。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>客户 - 父表</p>
                        </li>
                        <li>
                           <p>订单 - 儿童表</p>
                        </li>
                        <li>
                           <p>Lineitems  - 孙子表</p>
                        </li>
                     </ul>
                     <p>剩下的StockItems表只是一个查找表，将库存项目编号映射到库存项目描述和价格（StockNo  - &gt;（描述，价格））。</p>
                     <p>对于使用引用分区的表系列成员，以及定义StockItems查找表的其他DDL语句，分片数据库定义需要以下表DDL语句：</p><pre class="pre codeblock"><code>CREATE <span class="bold">SHARDED</span> TABLE客户（CustNo NUMBER（3）NOT NULL，CusName VARCHAR2（30）NOT NULL，Street VARCHAR2（20）NOT NULL，City VARCHAR2（20）NOT NULL，State CHAR（2）NOT NULL，Zip VARCHAR2（10） NOT NULL，Phone VARCHAR2（12），CONSTRAINT RootPK PRIMARY KEY（CustNo）） <span class="bold">PARTITION BY CONSISTENT HASH</span> （CustNo）PARTITIONS AUTO TABLESPACE SET ts1;创建<span class="bold">SHARDED</span> TABLE订单（PoNo NUMBER（5）NOT NULL，CustNo NUMBER（3）NOT NULL，OrderDate DATE，ShipDate DATE，ToStreet VARCHAR2（20），ToCity VARCHAR2（20），ToState CHAR（2），ToZip VARCHAR2（10） ，CONSTRAINT OrderPK PRIMARY KEY（CustNo，PoNo）CONSTRAINT CustFK外键（CustNo）REFERENCES Cusomters（CustNo）） <span class="bold">PARTITION BY REFERENCE</span> （CustFK）;创建<span class="bold">重复的</span>表StockItems（StockNo NUMBER（4）PRIMARY KEY描述VARCHAR2（20），价格NUMBER（6,2））; CREATE <span class="bold">SHARDED</span> TABLE LineItems（LineNo NUMBER（2）NOT NULL，PoNo NUMBER（5）NOT NULL，StockNo NUMBER（4）REFERENCES StockItems，Quantity NUMBER（2），Discount NUMBER（4,2），CONSTRAINT LinePK PRIMARY KEY（ <span class="bold">CustNo</span> ， LINENO，PONO）约束LineFK外键<span class="bold">（CustNo，PONO）</span>参考文献订单<span class="bold">（CustNo，PONO））PARTITION BY REFERENCE（LineFK）;</span></code></pre><p>将上面显示的分片数据库DDL与原始（非分片）数据库表进行比较后，您会注意到以下结构表更改（以粗体斜体显示）。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>表系列中表的<code class="codeph">CREATE TABLE</code>语句包含附加的<code class="codeph">SHARDED</code>关键字。
                           </p>
                        </li>
                        <li>
                           <p>查找表的<code class="codeph">CREATE TABLE</code>语句包含其他关键字<code class="codeph">DUPLICATED</code> 。</p>
                        </li>
                        <li>
                           <p>表系列中的所有表都包含分片键列CustNo作为主键的前导列。这是特定于分片的反规范化，它在表族层次结构的每个级别扩展复合主键，以包括直接父键（也称为级别键）作为主要组件。</p>
                        </li>
                        <li>
                           <p>分片键<code class="codeph">PARTITIONED BY</code>分片键列分割。在这种特殊情况下，系列的根表由<code class="codeph">CONSISTENT HASH</code>划分。这种划分模式传播到较低层级<code class="codeph">BY REFERENCE</code> （参考分区）。<code class="codeph">CONSISTENT HASH</code>的数据分区称为系统管理的分片方法（与用户定义的分片相反）。
                           </p>
                        </li>
                        <li>
                           <p>在系统管理的分片中，为分片表定义了表空间集。第一组表空间用于<code class="codeph">SHARDED</code>表。表空间集在分片数据库中用作一个或多个分片表和索引的逻辑存储单元。表空间集包含分布在分片空间中的分片中的多个表空间。数据库自动在表空间集中创建表空间。表空间的数量是自动确定的，并且等于相应分片空间中的块数。
                           </p>
                           <p><code class="codeph">CREATE TABLESPACE SET tbs1;</code>对于分片表</p>
                           <p>在我们的示例中，Customers，Orders和LineItem放置在表空间集tbs1中。这意味着表系列中三个表的相应分区存储在同一个表空间集tbs1（按引用分区）中。但是，可以为每个表指定单独的表空间集。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="sharding-physical-organization.html#GUID-3D0475BE-3F6F-4D2E-8B2E-B1161DBB1A78" title="跨分片的分区分布是通过在驻留在不同分片上的表空间中创建分区来实现的。">分区，表空间和块</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="sharding-loading-data.html#GUID-6140925F-6192-4C6F-9ADC-BC2332ADA3B0" title="您可以使用此处描述的方法将数据从非分片数据库迁移到Oracle Sharding分片数据库。">数据迁移到Sharded数据库</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-18D1592D-3A41-4C81-ABEF-86527A610A3D" name="GUID-18D1592D-3A41-4C81-ABEF-86527A610A3D"></a><h3 id="SHARD-GUID-18D1592D-3A41-4C81-ABEF-86527A610A3D" class="sect3"><span class="enumeration_section">9.4</span>准备源数据库</h3>
               <div>
                  <p>要使转换为分片数据库模式更顺畅，可以修改源非分片数据库，使其与目标分片数据库中的表定义匹配。</p>
                  <p>理想情况下，目标分片数据库中的表定义（表名，列名及其数据类型）和源数据库中的表定义将完全相同。但是，作为转换为分片数据库的一部分，您可能需要修改表定义以在分片数据库中使用。如果是这种情况，您可以修改源，非分片数据库，使其与新分片数据库中的表定义匹配。根据更改的程度，这还可能需要更改应用程序代码。通过修改源数据库模式，使其在迁移过程之前与目标分片数据库模式匹配，可以为从原始非分片数据库到新分片数据库的不间断转换提供条件。如果停机时间最短，这些准备工作是最短停机时间的先决条件。此外，如示例应用程序所示，迁移准备是一个无缝且易于反转的过程。您准备源数据库的活动是非常需要的，但不是必需的。如果由于某种原因无法修改源数据库操作环境，则可以跳过此主题。</p>
                  <p>此处显示的步骤遵循上一主题中定义的相同示例模式。</p>
                  <p>要迁移示例数据库，必须使用<code class="codeph">ALTER TABLE</code>将分片键列CustNo添加到源数据库中的LineItems表，如此示例所示。
                  </p><pre class="pre codeblock"><code>ALTER TABLE LineItems ADD（CustNo NUMBER（3））;</code></pre><p>使用此附加列，源表中的行数据布局和目标分片表中的所需布局是相同的。现在，您已准备好使用匹配数据填充此新列。LineItems表中的其他分片键列CustNo中的值必须从以父子关系加入LineItems的Orders派生。</p><pre class="pre codeblock"><code>选择订单。CustNo FROM Orders JOIN LineItems ON Orders。PONo = LineItems。PONO;</code></pre><p>在此示例中，使用<code class="codeph">MERGE</code>语句填充CustNo列。您还可以使用标准SQL来实现相同的目标。在此处显示的示例中， <code class="codeph">MERGE</code>语句如下所示。
                  </p><pre class="pre codeblock"><code>SQL&gt; BEGIN 2 MERGE INTO LineItems l 3使用订单o 4 ON（l。PONo = o。PONo）5匹配时6更新设置l。CustNo = o。CustNo; 7结束; 8 /</code></pre><p>您可能会在此时发现要为CustNo列维护参照完整性。要确保正确填充新列，应在执行<code class="codeph">MERGE</code>语句后添加<code class="codeph">NOT NULL</code>约束，如下所示。
                  </p><pre class="pre codeblock"><code>ALTER TABLE LineItems MODIFY CustNo NOT NULL;</code></pre><p>通过运行上面的<code class="codeph">MERGE</code>语句，可以将LineItems表行布局和行数据置于所需状态。附加的CustNo列使LineItems表的分片方式与表系列（Customers）的根相同。您可以考虑将此更改用作实际迁移之前的最后一个操作之一。否则，您必须在应用程序中维护此新列。因此，还必须为现有数据库中添加的分片键列维护引用完整性。匹配的CustNo列的参照完整性约束在LineItems表中定义，如此处所示。
                  </p><pre class="pre codeblock"><code>ALTER TABLE LineItems ADD CONSTRAINT LineFk FOREIGN KEY（CustNo，PONo）REFERENCES Orders（CustNo，PONo）;</code></pre><p>在更改LineItems表上的参照完整性约束之前，必须删除引用Orders表的现有<code class="codeph">FOREIGN KEY</code>约束。这可以通过在<code class="codeph">ALTER TABLE LineItems READ ONLY;</code>包含<code class="codeph">DROP CONSTRAINT</code>后跟<code class="codeph">ADD CONSTRAINT</code>语句来安全地完成<code class="codeph">ALTER TABLE LineItems READ ONLY;</code>和<code class="codeph">ALTER TABLE LineItems READ WRITE;</code> ，或者只是通过在约束修改期间使用<code class="codeph">LOCK TABLE LineItems IN SHARE MODE</code> 。
                  </p>
                  <p>作为在LineItems表中添加CustNo列作为外键定义的一部分的结果，您必须修改Orders表上的主键。反过来，更改主键需要重建索引，这可能需要一些时间才能完成。只有在计划在迁移到分片数据库之前的一段时间内针对此新架构运行应用程序时，此工作才有意义。</p>
                  <p>以下示例说明了将分片键添加到LineItems表后更改LineItems和Orders架构。在删除LineItems表上的现有外键约束和Orders表上的主键约束之前，必须检索相应的约束名称，如下所示。</p><pre class="pre codeblock"><code>SQL&gt; SELECT a.table_name，a.column_name，a.constraint_name 2 FROM ALL_CONS_COLUMNS A，ALL_CONSTRAINTS C 3 WHERE A.CONSTRAINT_NAME = C.CONSTRAINT_NAME 4 and a.table_name ='LINEITEMS'和C.CONSTRAINT_TYPE ='R'; LINEITEMS PONO SYS_C009087 LINEITEMS STOCKNO SYS_C009088 SQL&gt; SELECT cols.table_name，cols.column_name，cols.constraint_name，cols.position 2 FROM all_constraints cons，all_cons_columns cols 3 WHERE cons.constraint_type ='P'4 AND cons.constraint_name = cols.constraint_name 5 AND cols.table_name ='ORDERS'6 ORDER BY cols.table_name，cols.position; ORDERS ORDER_ID ORDER_PK 1 ORDERS PONO SYS_C009148 1 SQL&gt; ALTER TABLE LineItems READ ONLY;表改变了。SQL&gt; ALTER TABLE命令只读;表改变了。SQL&gt; ALTER TABLE LineItems DROP CONSTRAINT SYS_C009087;表改变了。SQL&gt; ALTER TABLE ORDERS DROP CONSTRAINT SYS_C009148;表改变了。SQL&gt; ALTER TABLE ORDERS ADD CONSTRAINT order_pk PRIMARY KEY（CustNo，PONo）;表改变了。SQL&gt; ALTER TABLE LineItems ADD CONSTRAINT LineFk FOREIGN KEY（CustNo，PONo）REFERENCES Orders（CustNo，PONo）;表改变了。SQL&gt; ALTER TABLE命令READ WRITE;表改变了。SQL&gt; ALTER TABLE LineItems READ WRITE;表改变了。</code></pre><p>同样，您应该通过将CustNo包含为前导列，将LineItems表的<code class="codeph">PRIMARY KEY</code>定义扩展为完整级别键，如此处所示。
                  </p><pre class="pre codeblock"><code>ALTER TABLE LineItems ADD CONSTRAINT LinePK PRIMARY KEY（CustNo，PONo，LineNo）;</code></pre><p>同样，在引入新<code class="codeph">PRIMARY KEY</code>约束之前，必须先删除它。要保持数据完整性，请使用前面建议的两种事务隔离策略之一修改<code class="codeph">PRIMARY KEY</code>和<code class="codeph">FOREIGN KEY</code>约束。在以下示例中，LineItems表在发生约束修改时被锁定。之后， <code class="codeph">COMMIT</code>释放锁。
                  </p><pre class="pre codeblock"><code>SQL&gt; SELECT cols.table_name，cols.column_name，cols.constraint_name，cols.position 2 FROM all_constraints cons，all_cons_columns cols 3 WHERE cons.constraint_type ='P'4 AND cons.constraint_name = cols.constraint_name 5 AND cols.table_name =' LINEITEMS'6 ORDER BY cols.table_name，cols.position; LINEITEMS LINENO SYS_C009086 1 LINEITEMS PONO SYS_C009086 2 SQL&gt; LOCK TABLE LineItems IN SHARE MODE;表（已锁定）。SQL&gt; ALTER TABLE LINEITEMS DROP CONSTRAINT SYS_C009086;表改变了。SQL&gt; ALTER TABLE LineItems ADD CONSTRAINT LinePK PRIMARY KEY（CustNo，PONo，LineNo）;表改变了。SQL&gt; COMMIT;提交完成。</code></pre><p>与参照完整性相关的修改是可选的。提议的修改使源数据库非常接近于类似于分片目标数据库。这进一步促进了过渡过程。</p>
                  <p>在某些情况下，不能强制引用完整性，也不希望创建引用完整性。如果是这种情况，则无法定义引用分区。在这种情况下，您可以使用<code class="codeph">PARENT</code>子句。
                  </p>
                  <p>最后，LineItems表中的其他CustNo列可能会影响现有查询，例如<code class="codeph">SELECT * FROM LineItems</code> 。要避免此问题，您可以将CustNo列修改为不可见，如此处所示。
                  </p><pre class="pre codeblock"><code>SQL&gt; ALTER TABLE LineItems MODIFY CustNo INVISIBLE;</code></pre><p>通过对源数据库表的这些修改，您已为迁移准备了现有的示例数据库。</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="sharding-loading-data.html#GUID-6140925F-6192-4C6F-9ADC-BC2332ADA3B0" title="您可以使用此处描述的方法将数据从非分片数据库迁移到Oracle Sharding分片数据库。">数据迁移到Sharded数据库</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-59B5EABA-3C10-4329-B662-9E17F2303498" name="GUID-59B5EABA-3C10-4329-B662-9E17F2303498"></a><h3 id="SHARD-GUID-59B5EABA-3C10-4329-B662-9E17F2303498" class="sect3"><span class="enumeration_section">9.5</span>准备目标分片数据库</h3>
               <div>
                  <p>在开始将数据迁移到分片数据库之前，必须根据设计创建分片数据库模式。</p>
                  <p>从非分片数据库环境到分片数据库环境的数据迁移可以通过两种不同的方式完成：</p>
                  <ul id="GUID-59B5EABA-3C10-4329-B662-9E17F2303498__UL_DHR_4W4_LGB" style="list-style-type:disc">
                     <li><span class="bold">两步法：</span>这是一种更加谨慎，渐进的数据迁移方法。仅使用一个分片创建分片数据库。只要您的分片数据库包含在一个分片中，您的应用程序以及数据库维护过程就可以在不更改应用程序代码和/或可忽略不计的相关修改的情况下使用。换句话说，在迁移到分片环境时，分片数据库的行为与非分片数据库的行为方式相同。然后，一旦修改了应用程序和分片操作过程，就可以继续将数据库扩展到适当数量的分片。
                     </li>
                     <li><span class="bold">单步方法：</span>最初使用适当数量的分片创建分片数据库。在这种情况下，您的应用程序和操作过程应该为迁移时的分片操作做好充分准备。
                     </li>
                  </ul>
                  <p>更谨慎的两步方法可以平滑但更长时间地转换为分片数据库环境。针对单个分片运行应用程序，您可以有时间逐步修改应用程序以进行直接路由。只有在修改现有应用程序以使用分片导向器连接到正确的分片后，才能实例化剩余的分片。</p>
                  <p>该过程的第一步是创建仅包含一个分片的分片数据库。然后，您可以按照以下某个部分中的建议修改现有应用程序。最后一步是将分片数据库向外扩展到所需的分片数。此方法还提供了在向外扩展之前在所有分片上拆分和重新平衡数据块的机会。</p>
                  <p>这种两步迁移方法不仅需要更多时间，而且还需要更多空间。如果将所有数据迁移到单个分片，则可以无限制地将分片表数据直接加载到单个分片。缩小到多个分片后，如果要将分片表直接正确加载到多个数据库分片中，则应严格使用数据泵实用程序。重复的表驻留在目录数据库中，您应始终使用目录数据库加载重复的表。</p>
                  <p>无论您决定使用一步法还是两步法，都必须在将数据加载到分片数据库之前导出数据并创建分片数据库模式。在下面的示例中，假设软件安装已完成，并且您已创建分片数据库环境，至少包括分片目录和分片的一个或多个数据库。您可以创建新的分片目录或使用现有分片目录。为了说明迁移过程，此过程中的示例使用以下数据库实例：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>orignode  - 托管原始非分片数据库实例的站点，SID = orig</p>
                     </li>
                     <li>
                        <p>catnode  - 托管分片目录数据库实例的目录节点，SID = ctlg</p>
                     </li>
                     <li>
                        <p>shrdnodeN  - 托管数据库分片实例的分片节点，SID = shrdN，其中N可以是1,2，依此类推</p>
                     </li>
                     <li>
                        <p>gsmnode  - 托管分片导向器（GSM）实例的目录节点，SID = gsm1</p>
                     </li>
                  </ul>
                  <p>无论您是否已修改源数据库以准备迁移，迁移过程都需要修改DDL定义，包括至少包括<code class="codeph">CREATE SHARDED TABLE</code>和<code class="codeph">CREATE DUPLICATED TABLE</code>语句。要将数据库模式迁移到目标分片数据库，必须从源数据库中提取DDL定义并修改SHARDED和DUPLICATED表元数据。从源数据库中提取DDL语句的便捷方法是创建数据泵提取文件。然后对数据库导出文件使用Data Pump导入实用程序，如下所示。
                  </p><pre class="pre codeblock"><code>impdp uname / pwd @ orignode directory = expdir dumpfile = sample.dmp sqlfile = sample_ddl.sql</code></pre><p>在此示例中， <code class="codeph">impdp</code>命令实际上不执行转储文件内容的导入。而是， <code class="codeph">sqlfile</code>参数触发创建名为sample_ddl.sql的脚本，该脚本包含导出转储文件中的所有DDL。此数据库导出文件的创建如下所示。
                  </p><pre class="pre codeblock"><code>expdp uname / pwd @ orignode full = Y directory = expdir dumpfile = sample.dmp logfile = sample.log</code></pre><p>完整数据库导出文件包含整个数据库内容：数据和元数据。导出整个数据库可能需要很长时间。如果要快速执行此步骤，则只能导出元数据，或仅导出包含您感兴趣的表集的部分，如此示例所示。</p><pre class="pre codeblock"><code>expdp uname / pwd directory = DATA_PUMP_DIR dumpfile = sample_mdt.dmp logfile = sample_mdt.log INCLUDE = TABLE：\“IN \（\'CUSTOMERS \'，\'ORDERS \'，\'STOCKITEMS \'，\'LINEITEMS \'\ ）\“一致= Y内容= METADATA_ONLY</code></pre><p>以这种方式减少导出可以更有效地捕获数据库元数据的一致映像，而无需冗长的数据库数据转储过程。您仍然必须以文本格式获取DDL语句，并根据分片数据库模式设计的要求执行DDL修改。如果您决定导出整个数据库，则可能还会将其用作加载数据的输入。</p>
                  <p>Data Pump提供了一种传输数据的安全方式。数据库管理员必须授权数据库用户访问数据库导出目录，如此处所示。</p><pre class="pre codeblock"><code>创建或替换DIRECTORY expdir AS'/ some / directory'; GRANT READ，WRITE ON DIRECTORY expdir to uname; GRANT EXP_FULL_DATABASE要取消;</code></pre><p>使用完整数据库导出时，数据库管理员必须向用户<code class="codeph">uname</code>授予<code class="codeph">EXP_FULL_DATABASE</code>角色。表级导出不需要其他角色。有关数据泵实用程序的详细信息，请参阅下面参考中的“数据库实用程序”文档。
                  </p>
                  <p>如果修改了源（非分片）数据库以使行布局与目标（分片）数据库匹配，则不需要完整的数据库或表级别导出。可以按原样有效地传输数据，而无需中间转储文件。</p>
                  <p>完成分片数据库模式后，使用数据库管理员凭据对分片目录数据库（ctlg）运行准备好的DDL。必须在启用了<code class="codeph">SHARD DDL</code>设置的会话中执行所有DDL语句，以确保所有DDL语句都从目录数据库（ctlg）传播到分片数据库（shrd1,2，...，N）。
                  </p><pre class="pre codeblock"><code>ALTER SESSTION ENABLE SHARD DDL;</code></pre><p>通过定义分片和重复的表，您的分片数据库已准备好进行数据加载。建议您在加载数据之前使用GDSCTL <code class="codeph">VALIDATE</code>命令验证分片配置。
                  </p><pre class="pre codeblock"><code>gdsctl验证</code></pre><p>成功验证后，分片数据库已准备好进行数据加载。如果发现不一致或错误，则必须使用GDSCTL命令<code class="codeph">SHOW DDL</code>和<code class="codeph">RECOVER</code>更正问题。</p>
                  <p>默认情况下，数据泵导出实用程序文件基于每个表一致。如果希望导出中的所有表与同一时间点保持一致，则必须使用<code class="codeph">FLASHBACK_SCN</code>或<code class="codeph">FLASHBACK_TIME</code>参数。建议使用一致的“截至”时间点数据库导出文件。如果您选择从非分片数据库到分片数据库的不间断迁移（即，如果要在迁移期间提供连续数据库操作），这一点尤为重要。Oracle GoldenGate补充了在连续操作期间使用Data Pump迁移到分片数据库。生成一致数据库快照的导出命令如下所示。
                  </p><pre class="pre codeblock"><code>expdp uname / pwd @ orignode full = Y directory = expdir dumpfile = sample.dmp logfile = sample.log CONSISTENT = Y FLASHBACK_TIME = SYSTIMESTAMP</code></pre><p>一致的快照数据库映像需要额外的<code class="codeph">CONSISTENT</code>或<code class="codeph">FLASHBACK_TIME</code>参数。当您运行该命令时，您会注意到<code class="codeph">CONSISTENT</code>和<code class="codeph">FLASHBACK_TIME</code>这两个参数的含义相同。请注意，时间戳转换为系统更改号（SCN），如此处所示。
                  </p><pre class="pre codeblock"><code>SQL&gt; SELECT TIMESTAMP_TO_SCN（SYSTIMESTAMP）FROM dual; TIMESTAMP_TO_SCN（SYSTIMESTAMP）------------------------------ 1559981</code></pre><p>如果您更喜欢在<code class="codeph">FLASHBACK_TIME</code>使用<code class="codeph">FLASHBACK_SCN</code> ，则可以通过从V $ DATABASE中选择它来获取当前SCN，如下所示。
                  </p><pre class="pre codeblock"><code>SQL&gt; SELECT current_scn FROM v $ database; CURRENT_SCN ----------- 1560005</code></pre><p>或者，您可以如此处所示声明它。</p><pre class="pre codeblock"><code>SQL&gt; SET SERVEROUTPUT ON SQL&gt; DECLARE SCN NUMBER; 2 BEGIN 3 SCN：= DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER; 4 DBMS_OUTPUT.PUT_LINE（SCN）; 5结束; 6/1560598</code></pre><p>您可能需要请求数据库管理员访问<code class="codeph">DBMS_FLASHBACK</code>授权。</p>
                  <p>您可以使用<code class="codeph">PARALLEL</code>参数使Data Pump更快地运行。此参数应与<code class="codeph">DUMPFILE</code>参数中的％U通配符结合使用，以允许创建多个转储文件，如此示例所示。
                  </p><pre class="pre codeblock"><code>expdp uname / pwd @ orignode full = Y directory = expdir dumpfile = samp_％U.dmp logfile = samp.log CONSISTENT = Y PARALLEL = 3</code></pre><p>上面的命令使用四个并行工作程序，并创建四个后缀为_01，_02，_03的转储文件。导入期间可以使用相同的通配符，以允许您引用多个输入文件。请注意，三个转储文件samp_01.dmp，samp_02.dmp和samp_03.dmp是通过并行导出而不是前一个示例中创建的单个输出文件sample.dmp创建的。此外，并行导出的经过时间小于串行执行所用时间的三分之一，即单个转储文件输出。</p>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-59B5EABA-3C10-4329-B662-9E17F2303498__GUID-8219201B-DAA6-4512-A101-96D088AF9447">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="sharding-deployment.html#GUID-F99B8742-4089-4E77-87D4-4691EA932207" title="分片数据库部署包括安装所需软件组件，创建目录，角色和分片数据库，配置高可用性复制以及为分片数据库创建架构的先决条件和说明。">Sharded数据库部署</a></p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/shard&amp;id=SUTIL-GUID-501A9908-BCC5-434C-8853-9A6096766B5A" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a></p>
                     <p><a href="../gsmug/gdsctl-reference.html#GSMUG-GUID-E6E76443-AD85-455C-99AA-BF0A7856F880" target="_blank"><span><cite>“Oracle数据库全球数据服务概念和管理指南”</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="sharding-loading-data.html#GUID-6140925F-6192-4C6F-9ADC-BC2332ADA3B0" title="您可以使用此处描述的方法将数据从非分片数据库迁移到Oracle Sharding分片数据库。">数据迁移到Sharded数据库</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-B464BEB3-AEB7-4F6D-8328-C25F69FD223F" name="GUID-B464BEB3-AEB7-4F6D-8328-C25F69FD223F"></a><h3 id="SHARD-GUID-B464BEB3-AEB7-4F6D-8328-C25F69FD223F" class="sect3"><span class="enumeration_section">9.6</span>迁移数据</h3>
               <div>
                  <p>使用单个分片或多个分片创建目标分片数据库后，如果已定义分片和重复表，则可以开始将数据迁移到分片数据库中。</p>
                  <p>在开始将数据从源迁移到分片数据库之前，请确保了解以下数据加载注意事项：</p>
                  <ul style="list-style-type:disc">
                     <li>迁移重复表和分片表之间的差异<p>重复的表驻留在分片目录中，它们始终使用任何可用的数据加载实用程序或纯SQL加载到分片目录数据库中。但是，您有两种加载分片表的选项。可以使用分片协调器（目录）加载分片表，也可以使用数据泵实用程序将它们直接加载到分片中。</p>
                     </li>
                     <li>使用协调器迁移分片表或直接加载到分片<p>将分片表直接加载到分片数据库总是更快，因为您可以同时加载多个分片。</p>
                     </li>
                     <li>迁移到多个分片或迁移到单个分片<p>使用单个分片将非分片数据库迁移到分片数据库不需要对应用程序和数据库维护过程进行重大更改。在准备将数据拆分为分片之前，您可以继续保持当前操作的基本不变。但是，将非分片数据库迁移到具有多个分片的分片数据库涉及非平凡的准备过程，对应用程序源代码的修改是最耗时的先决条件。如果您打算使用单个分片迁移到分片数据库，则还必须设置计划以将数据库扩展为多个分片，即稍后在多个分片中分布数据库块。同时，您可以处理使用带有多个分片的分片数据库运行所需的应用程序和其他更改。</p>
                     </li>
                     <li>通过停机或不间断迁移进行迁移<p>仅使用一个分片从非分片数据库到分片数据库的不间断迁移比迁移到具有多个分片的分片数据库更容易，更简单。在数据库运行时，将执行从一个分片到多个分片的后续向外扩展。</p>
                        <p>如果要在一个步骤中从非分片数据库迁移到目标多分片数据库，强烈建议您首先在测试环境中进行尝试，并且只有在确保迁移生产环境后才开始迁移生产环境。测试环境无任何问题地迁移。</p>
                     </li>
                  </ul>
                  <p>无论是否在源数据库中准备目标行数据布局，都有各种方法可供选择以进行有效的数据迁移。选择最适合您条件的方法：可用磁盘空间，远程文件访问，网络吞吐量等。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-B464BEB3-AEB7-4F6D-8328-C25F69FD223F__GUID-BEDEF66C-FC5D-4902-B4B7-F928F7296716">考虑迁移期间的停机时间</p>
                     <p>如果要消除数据库停机时间，则迁移计划必须包含Oracle GoldenGate。要使目标（分片）数据库与源（非分片）数据库保持同步，必须使用Oracle GoldenGate处理迁移过程中对源数据库所做的更改。</p>
                     <p>除了零停机迁移的好处之外，您还可以选择使用Oracle GoldenGate进行分片数据库的主动 - 主动复制。如果已为分片数据库定义了Oracle GoldenGate主动 - 主动复制，则应将所有数据迁移活动限制为分片目录数据库。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-B464BEB3-AEB7-4F6D-8328-C25F69FD223F__GUID-66344188-4E93-451A-9E88-9035CCC80C41">使用停机时间将数据迁移到Sharded表</p>
                     <p>如果您不使用Oracle GoldenGate，请采取措施在迁移期间尽可能保持数据库可用;你应该计划停机时间。</p>
                     <p>如果您决定在迁移之前修改源，非分片数据库表，则表模式将与目标分片数据库模式匹配，并且与未执行此预迁移步骤相比，数据迁移过程将更加顺畅。此方法在源数据库中生成相同的行数据布局，并在目标分片数据库中生成相应的布局，因此您可以直接复制数据库内容。</p>
                     <ol id="GUID-B464BEB3-AEB7-4F6D-8328-C25F69FD223F__OL_CBW_TKL_MGB">
                        <li>从数据库表导出数据。<pre class="pre codeblock"><code>expdp uname / pwd @ non_sharded_db directory = file_dir dumpfile = original_tables.dmp logfile = original_table.log INCLUDE = TABLE：\“IN \（\'CUSTOMERS \'，\'ORDERS \'，\'STOCKITEMS \'，\'LINEITEMS \ '\）\“一致= Y内容= DATA_ONLY</code></pre><p>此数据泵导出示例仅限于Oracle Sharding示例应用程序使用的表。由于已在示例中创建了SHARDED和DUPLICATED表，因此只导出表内容（DATA_ONLY）。</p>
                        </li>
                        <li>在开始将数据导入分片数据库之前，使目标数据库节点可以访问导出文件（original_tables.dmp）。
                           <p>您可以将此文件（或并行导出时的多个文件）移动到目标数据库系统，也可以通过网络共享该文件。</p>
                        </li>
                        <li>导出完成后，您可以开始将内容导入分片数据库。
                           <p>必须使用分片目录加载DUPLICATED表（StockItems）。以下是导入命令的示例。</p><pre class="pre codeblock"><code>impdp uname / pwd @ catnode：1521 / ctlg directory = data_pump_dir dumpfile = original_tables.dmp logfile = imp.log tables = <span class="italic">StockItems</span> content = DATA_ONLY</code></pre></li>
                        <li>直接加载分片，或使用分片目录加载它们。
                           <p>加载SHARDED表（Customers，Orders和LineItems）的最佳方法是直接在每个分片（shrd1,2，...，N）上运行数据泵。以下是第一个分片上的import命令的示例。</p><pre class="pre codeblock"><code>impdp uname / pwd @ shrdnode：1521 / shrd1 directory = data_pump_dir dumpfile = original_tables.dmp logfile = imp.log tables = <span class="italic">Customers</span> ， <span class="italic">Orders</span> ， <span class="italic">LineItems</span> content = DATA_ONLY</code></pre><p>或者，您可以在分片目录上运行Data Pump以加载所有表。以下示例显示了import命令。</p><pre class="pre codeblock"><code>impdp uname / pwd @ catnode：1521 / ctlg directory = data_pump_dir dumpfile = original_tables.dmp logfile = imp.log tables = <span class="italic">Customers</span> ， <span class="italic">Orders</span> ， <span class="italic">LineItems，StockItems</span> content = DATA_ONLY</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-B464BEB3-AEB7-4F6D-8328-C25F69FD223F__GUID-08E571DD-D3E5-437E-8DB5-1A5F3837B32B">无需停机即可将数据迁移到Sharded表</p>
                     <p>Oracle Sharding提供了Oracle GoldenGate复制与Data Pump导出和导入实用程序之间的紧密集成。如果Oracle GoldenGate当前不存在于源数据库或目标分片数据库中，则在安装之前，应将数据库升级到源数据库和目标数据库上的最新版本的Oracle数据库。升级数据库可提供最大可用功能并简化设置。使用Oracle Database 12c第2版及更高版本，您可以在目标分片数据库上的非分片源和集成副本上使用集成捕获。</p>
                     <p>只要使用数据泵导出和导入来重新创建整个数据库，Oracle GoldenGate就可确保在导出和导入期间和之后迁移数据库。您可以自行决定在迁移过程中Oracle GoldenGate需要复制的内容。建议您不要复制应用程序不需要的数据库更改。</p>
                     <p>为源数据库和目标数据库配置Oracle GoldenGate时，建议您在安排生产迁移之前使用实时数据进行测试。如果克隆源数据库，则可以使用克隆来测试迁移，而不会影响生产环境。</p>
                     <div class="figure" id="GUID-B464BEB3-AEB7-4F6D-8328-C25F69FD223F__FIG_FZ1_HSG_5GB">
                        <p class="titleinfigure">图9-5无停机迁移</p><br><div class="imageleft"><img class="imageleft" id="GUID-B464BEB3-AEB7-4F6D-8328-C25F69FD223F__IMAGE_GZ1_HSG_5GB" src="img/migration_without_downtime.png" alt="下面是图9-5的描述" title="下面是图9-5的描述" longdesc="img_text/migration_without_downtime.html"><br><a href="img_text/migration_without_downtime.html">“图9-5无停机迁移”的说明</a></div><br></div>
                     <!-- class="figure" -->
                     <p>上面说明了使用Data Pump与Oracle GoldenGate结合的迁移过程。大部分数据迁移是使用Data Pump执行的，将数据直接移动到分片目录和分片。数据泵运行期间的数据库更改将收集在Oracle GoldeGate本地跟踪文件中，并移至分片目录数据库。对分片表的更改将从分片目录数据库传播到分片。</p>
                     <p>从Data Pump的角度来看，源数据库（ORIG）使用impdp非分片和impdp分片进程分为分片目录（CTLG）和分片数据库（SHRD1，SHRD2和SHRD3）。impdp非分片进程将重复的表迁移到分片目录数据库。三个impdp分片并行进程将分片表直接迁移到分片SHRD1，SHRD2和SHRD3。</p>
                     <p>从Oracle GoldenGate的角度来看，所有数据库共享从Extract根进程分叉的extract（exsh），pump（pmsh）和replicat（rpsh）进程管道。</p>
                     <p>假设你准备的<code class="codeph">obey</code>对应于上图的文件，用于从源数据库节点（orignode）到碎片目录节点（catnode）的Oracle GoldenGate管线一个GGSCI终端会话看起来像下面的例子。
                     </p><pre class="pre codeblock"><code>查看参数./dirprm/add_exsh_2pumps.oby  - 添加名为exsh的更改数据提取进程组 -  exsh从orig数据库读取DUPLICATED和SHARDED表重做日志添加提取exsh，tranlog，立即开始 - 将跟踪文件关联为输出exsh进程组添加exttrail ./dirdat/et，提取exsh  - 添加SHARDED和DUPLICATE更改数据提取泵进程pmsh  -  pmsh将本地跟踪数据复制到ctlgnode远程跟踪位置add extract pmsh，exttrailsource ./dirdat/et  -  associate远程跟踪pmsh添加rmttrail ./dirdat/et，提取pmsh  - 连接到数据库并添加表级补充日志记录： -  Customers，Orders，LineItems和StockItems表添加trandata uname。客户添加trandata uname。订单添加trandata uname。LineItems添加trandata uname。StockItems</code></pre><p>运行GGSCI <code class="codeph">obey</code>命令为管道，其次是<code class="codeph">info all</code> 。
                     </p><pre class="pre codeblock"><code>服从./dirprm/add_exsh_2pumps.oby信息全部</code></pre><p>您应该看到初始化非分片和分片管道的提取过程，并等待处于停止状态。</p><pre class="pre codeblock"><code>... EXTRACT STOPPED exsh ... EXTRACT STOPPED pmsh ......</code></pre><p>检查分片和目录表的进程组参数<code class="codeph">EXTRACT</code> 。
                     </p><pre class="pre codeblock"><code>查看参数exsh  - 第一行必须提取后跟名称提取exsh  - 登录信息获取元数据userid uname @ orignode，密码pwd  - 导出写入跟踪信息exttrail ./dirdat/exsh  - 检查点时间间隔与源checkpointsecs 1  - 源表table uname。客户表uname。订单表uname。LineItems表uname。StockItems</code></pre><p>查看所有表的泵过程组的参数，pmsh。</p><pre class="pre codeblock"><code>查看parms pmsh  - 第一行必须提取后跟名称extract pmsh  - 无需登录数据库passthru  - 连接到远程主机，写入并与管理器通话rmthost shrdnode，mgrport 7810  - 其中是路径在远程主机rmttrail ./dirdat/rt上 - 检查点时间间隔与目标checkpointsecs 1  - 表table uname。客户表uname。订单表uname。LineItems表uname。StockItems</code></pre><p>在假设Shard目录节点（catnode）上的管理器进程使用端口号7810的情况下创建Oracle GoldenGate Pump进程。这是一个公平的假设，因为分片目录和分片数据库在不同的机器上运行。</p>
                     <p>检查分片目录节点（catnode）上的定义。</p><pre class="pre codeblock"><code>view params mgr PORT 7810  - 源端的PUMP进程用于目标DYNAMICPORTLIST 8000-8010 SYSLOG NONE上的收集器</code></pre><p>在分片目录节点（catnode）上，查看准备好的Replicat进程obey命令文件。</p><pre class="pre codeblock"><code>view params ./dirprm/add_rpsh.oby  - 连接数据库dblogin userid uname @ catnode，密码pwd  - 添加checkpoint表add checkpointtable uname.gg_checkpoint  - 添加replicat进程rpsh，将远程跟踪转换为SQL，不断添加replicat rpsh ，exttrail ./dirdat/rt,checkpointtable uname.gg_checkpoint</code></pre><p>如果修改源数据库以匹配分片行数据布局以准备迁移，则可能引入了不可见列。通过将<code class="codeph">MAPINVISIBLECOLUMNS</code>添加为复制过程参数，可以在复制过程中保留不可见列。
                     </p>
                     <p>在分片目录节点（catnode）上运行obey文件./dirprm/add_rpsh.oby。</p>
                     <p>此时，系统配置为数据迁移，无需停机。大部分负载由Data Pump导出（expdp）和import（impdp）数据库实用程序执行。导出和导入过程中的最终数据库更改由Oracle GoldenGate进程同步。请注意，Oracle GoldenGate Pump流程与任何数据泵流程无关。</p>
                     <p>在开始数据泵导出之前，必须为Oracle GoldenGate复制过程提供每个表的实例化提交序列号（CSN），这些表是数据泵导出的一部分。如前所述，这可以通过运行带有<code class="codeph">FLASBACK_SCN=scn_num</code> <code class="codeph">CONSISTENT=Y</code>和<code class="codeph">FLASBACK_SCN=scn_num</code> expdp来完成。可以使用以下语句获取<code class="codeph">FLASHBACK_SCN</code> 。
                     </p><pre class="pre codeblock"><code>从v $ database中选择current_scn;</code></pre><p>因为expdp是使用<code class="codeph">CONSISTENT=Y</code>运行的，所以所有表图像都显示为“scn_num”，因此复制过程可以从相同的位置启动，在本例中为CSN编号。
                     </p>
                     <p>对于分片目录节点上的replicat，相应的GGSCI命令可能如下所示。</p><pre class="pre codeblock"><code>START REPLICAT rpsh，AFTERCSN scn_num</code></pre><p>更简单的方法是在源节点上使用<code class="codeph">ADD SCHEMATRANDATA</code> GGSCI命令。此命令填充系统表和视图，以便可以在导入时使用实例化CSN。这样，Oracle GoldenGate CSN通过匹配表示数据库的已提交版本的两个戳记，与Data Pump SCN同步。换句话说，自动定义用于导出过程的<code class="codeph">FLASHBACK_SCN</code>和用于复制过程的<code class="codeph">AFTERCSN</code> ，如此处所示。
                     </p><pre class="pre codeblock"><code>ADD SCHEMATRANDATA uname PREPARESCN ALLCOLS</code></pre><p><code class="codeph">ADD SCHEMATRANDATA</code>命令为ORIG数据库的给定“uname”模式中的所有当前和未来表启用模式级补充日志记录，以自动记录Oracle GoldenGate用于行标识的键的超集。<code class="codeph">PREPARESCN</code>参数指示数据泵导出（expdp）自动生成操作， <code class="codeph">SET_INSTANTIATION_CSN</code>在导入（impdp）时为目标处的每个表设置实例化CSN（GGSCI命令， <code class="codeph">SET_INSTANTIATION_CSN</code> ）。<code class="codeph">ALLCOLS</code>参数为给定模式中的所有当前和未来表启用所有受支持的键和非键列的无条件补充日志记录。此选项可以记录计算依赖关系所需的密钥，以及筛选，冲突解决或其他目的所需的列。请务必注意，与分片相关的数据迁移仅限于特定的表集，而其他数据库（增量）更改不会传播到分片目录。
                     </p>
                     <p>应在启动数据泵导出之前停止目标数据库上的复制。始终应该是这种情况，因为目标数据库是从头开始创建的。此处显示了用于停止sahrd目录节点上的replicat进程的GGSCI命令。</p><pre class="pre codeblock"><code>停止REPLICAT rpsh</code></pre><p>此命令将保留下次启动复制过程时的同步状态，并确保Oracle GoldenGate管理器进程不会自动启动复制过程。</p>
                     <p>在启动数据泵导出之前，源数据库上的提取过程应处于活动状态。使用<code class="codeph">INFO EXTRACT</code>或<code class="codeph">STATUS EXTRACT</code>命令检查提取是否已处于活动<code class="codeph">STATUS EXTRACT</code> 。如果尚未启动，则以下命令将启动提取过程。
                     </p><pre class="pre codeblock"><code>开始提取exsh，现在开始</code></pre><p>从现在开始，提取进程将收集对分片过程中涉及的所有表的源数据库的更改，并且您可以安全地启动数据泵导出。</p><pre class="pre codeblock"><code>expdp uname / pwd @ orignode full = Y directory = expdir dumpfile = sample.dmp logfile = sample.log</code></pre><p>最好验证是否自动添加导出实用程序expdp <code class="codeph">FLASHBACK_SCN</code>参数。您应该能够在expdp命令输出中找到消息“FLASHBACK自动启用以保持数据库完整性”。导出完成后，立即继续在目标数据库上导入数据泵，如前面针对分片目录所述。
                     </p><pre class="pre codeblock"><code>impdp uname / pwd @ catnode：1521 / ctlg directory = data_pump_dir dumpfile = sample.dmp logfile = imp.log tables = Customers，Orders，LineItems，StockItems content = DATA_ONLY</code></pre><p>此时，在分片目录节点上启动复制进程是安全的。</p><pre class="pre codeblock"><code>START REPLICAT rpsh</code></pre><p>从此时起，源数据库中的选定表集（Customers，Orders，LineItems和StockItems）将与分片中的Customers，Orders和LineItems表以及分片目录数据库中的StockItems重复表同步。 。在启动复制过程之后，查看复制过程的报告文件是一种很好的做法。在导出过程中验证replicat进程是否知道数据库中存在的SCN或CSN编号，并且它知道现在需要在目标表上应用该SCN之后的任何更改，查找“实例化CSN过滤是在表uname上启用。客户，uname，订单，......“验证。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="sharding-loading-data.html#GUID-6140925F-6192-4C6F-9ADC-BC2332ADA3B0" title="您可以使用此处描述的方法将数据从非分片数据库迁移到Oracle Sharding分片数据库。">数据迁移到Sharded数据库</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-FD50835F-514F-4E74-95D3-BD0B4A6B0F20" name="GUID-FD50835F-514F-4E74-95D3-BD0B4A6B0F20"></a><h3 id="SHARD-GUID-FD50835F-514F-4E74-95D3-BD0B4A6B0F20" class="sect3"><span class="enumeration_section">9.7</span>迁移您的应用程序</h3>
               <div>
                  <p>分片数据库操作环境使应用程序能够直接访问分片。此功能提供了真正的线性可扩展性，但它的价格很低 - 对应用程序代码稍作改动。</p>
                  <p>以下示例向您展示如何迁移您的应用程序。这些示例是我们迁移数据库模式和数据的示例应用程序的框架。示例应用程序的关键部分包括订单管理和报告功能。包含在Java类POManager中。此类中的第一个静态方法使用addCustomer（）方法在Customers表中引入了一个新行。使用参数列表将列值传递给此函数，如此处所示。</p><pre class="pre codeblock"><code>import java.sql。*; import java.io.*; import oracle.jdbc.driver。*;公共类POManager {public static void addCustomer（int custNo，String custName，String street，String city，String state，String zipCode，String phoneNo）抛出SQLException {String sql =“INSERT INTO Customers VALUES（？，？，？，？， ？，？，？）“; try {Connection conn = DriverManager.getConnection（”jdbc：default：connection：“）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，custNo）; pstmt.setString（2，custName）; pstmt .setString（3，street）; pstmt.setString（4，city）; pstmt.setString（5，state）; pstmt.setString（6，zipCode）; pstmt.setString（7，phoneNo）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（））;}}</code></pre><p>POManager类中的第二个静态方法addStockItem（）在StockItem表中添加一行。列值作为参数值传递，如以下示例所示。</p><pre class="pre codeblock"><code>public static void addStockItem（int stockNo，String description，float price）抛出SQLException {String sql =“INSERT INTO StockItems VALUES（？，？，？）“; try {Connection conn = DriverManager.getConnection（”jdbc：default：connection：“）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，stockNo）; pstmt.setString（2，description）; pstmt .setFloat（3，price）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（））;}}</code></pre><p>POManager类中的第三个静态方法enterOrder（）在Orders表中添加一行。列值在参数列表中提供，如此处所示。</p><pre class="pre codeblock"><code>public static void enterOrder（int orderNo，int custNo，String orderDate，String shipDate，String toStreet，String toCity，String toState，String toZipCode）throws SQLException {String sql =“INSERT INTO ORERS VALUES（？，？，？，？，？ ，？，？，？）“; try {Connection conn = DriverManager.getConnection（”jdbc：default：connection：“）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，orderNo）; pstmt.setInt（2，custNo）; pstmt .setString（3，orderDate）; pstmt.setString（4，shipDate）; pstmt.setString（5，toStreet）; pstmt.setString（6，toCity）; pstmt.setString（7，toState）; pstmt.setString（8， toZipCode）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（））;}}</code></pre><p>POManager类中的下一个静态方法addLineItem（）在LineItems表中添加一行。列值作为参数值传入，如以下示例所示。</p><pre class="pre codeblock"><code>public static void addLineItem（int lineNo，int orderNo，int stockNo，int quantity，float discount）抛出SQLException {String sql =“INSERT INTO LineItems VALUES（？，？，？，？，？）“; try {Connection conn = DriverManager.getConnection（”jdbc：default：connection：“）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，lineNo）; pstmt.setInt（2，orderNo）; pstmt .setInt（3，stockNo）; pstmt.setInt（4，quantity）; pstmt.setFloat（5，discount）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println （e.getMessage（））;}}</code></pre><p>POManager类中的下一个静态方法totalOrders（）为Orders表中的每个订单生成总订单值。使用printResult（）方法打印出结果集关系，如下所示。</p><pre class="pre codeblock"><code>public static void totalOrders（）抛出SQLException {String sql =“SELECT O.PONo，ROUND（SUM（S.Price * L.Quantity））AS TOTAL”+“FROM Orders O，LineItems L，StockItems S”+“WHERE O .PONo = L.PONo AND L.StockNo = S.StockNo“+”GROUP by O.PONo“;尝试{Connection conn = DriverManager.getConnection（“jdbc：default：connection：”）; PreparedStatement pstmt = conn.prepareStatement（sql）; ResultSet rset = pstmt.executeQuery（）; printResults（RSET）; rset.close（）; pstmt.close（）; } catch（SQLException e）{System.err.println（e.getMessage（））;}}</code></pre><p>下面显示的辅助方法printResults（）用于打印totalOrders（）方法生成的结果集关系。对结果集关系的引用作为参数传递。</p><pre class="pre codeblock"><code>static void printResults（ResultSet rset）抛出SQLException {String buffer =“”;尝试{ResultSetMetaData meta = rset.getMetaData（）; int cols = meta.getColumnCount（），rows = 0; for（int i = 1; i &lt;= cols; i ++）{int size = meta.getPrecision（i）; String label = meta.getColumnLabel（i）; if（label.length（）&gt; size）size = label.length（）; while（label.length（）&lt;size）label + =“”; buffer = buffer + label +“”; } buffer = buffer +“\ n”; while（rset.next（））{rows ++; for（int i = 1; i &lt;= cols; i ++）{int size = meta.getPrecision（i）; String label = meta.getColumnLabel（i）;字符串值= rset.getString（i）; if（label.length（）&gt; size）size = label.length（）; while（value.length（）&lt;size）value + =“”; buffer = buffer + value +“”; } buffer = buffer +“\ n”; } if（rows == 0）buffer =“找不到数据！\ n“; System.out.println（buffer）;} catch（SQLException e）{System.err.println（e.getMessage（））;}}</code></pre><p>checkStockItem（）静态方法（如下所示）检索指定库存项目的所有订单，客户和行项目详细信息。库存项目作为参数传入。上面详述的辅助方法printResults（）用于打印checkStockItem（）方法生成的结果集关系。</p><pre class="pre codeblock"><code>public static void checkStockItem（int stockNo）抛出SQLException {String sql =“SELECT O.PONo，O.CustNo，L.StockNo，”+“L.LineNo，L.Quantity，L.Discount”+“FROM Orders O，LineItems L“+”在哪里O.PONo = L.PONo和L.StockNo =？“; try {Connection conn = DriverManager.getConnection（”jdbc：default：connection：“）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，stockNo）; ResultSet rset = pstmt.executeQuery（）; printResults （rset）; rset.close（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（））;}}</code></pre><p>changeQuantity（）静态方法更新给定订单和库存项目的行项目数量。特定订单号和库存项目作为输入参数提供，如下所示。</p><pre class="pre codeblock"><code>public static void changeQuantity（int newQty，int orderNo，int stockNo）抛出SQLException {String sql =“UPDATE LineItems SET Quantity =？“+”PONo =？和StockNo =？“; try {Connection conn = DriverManager.getConnection（”jdbc：default：connection：“）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，newQty）; pstmt.setInt（2，orderNo）; pstmt .setInt（3，stockNo）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（））;}}</code></pre><p>最后一个静态方法deleteOrder（）从Orders表和所有关联的行项中删除指定的顺序。要删除的顺序被指定为输入参数，如以下示例所示。</p><pre class="pre codeblock"><code>public static void deleteOrder（int orderNo）抛出SQLException {String sql =“DELETE FROM LineItems WHERE PONo =？“; try {Connection conn = DriverManager.getConnection（”jdbc：default：connection：“）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，orderNo）; pstmt.executeUpdate（）; sql =”DELETE从订单那里PONO =？“;; pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，orderNo）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（） ）;}}}</code></pre><p>现在，查看为分片修改的示例应用程序代码。首先要注意的是从OracleShardingKey开始，额外导入与分片相关的Java包。</p><pre class="pre codeblock"><code>import java.sql。*; import java.io.*; import oracle.jdbc.driver。*; // //导入分片和相关包//导入oracle.jdbc。OracleShardingKey; import oracle.jdbc。OracleType; import oracle.jdbc.pool。OracleDataSource; // //示例应用程序：订单管理和报告//为分片修改//公共类POManager {//示例应用程序私有OracleDataSource ods使用的分片数据库的连接工厂; // //使用Sharded数据库连接属性构造POManager类。//连接到分片数据库时使用服务名称，例如：//“jdbc：oracle：thin：@（DESCRIPTION =（ADDRESS =（HOST = myhost）（PORT = 3216）”//“（PROTOCOL = tcp）） （CONNECT_DATA =（SERVICE_NAME = myservice）（REGION = east）））“// public POManager（String yourURL，String yourUser，String yourPwd）抛出SQLException {ods = new OracleDataSource（）; ods.setURL（yourURL）; ods.setUser（yourUser）; ods.setPassword（yourPwd）; } // POManager</code></pre><p>如上所示，POManager类现在包含Connection对象的OracleDataSource工厂。以下两种方法向您展示如何使用连接工厂生成直接和代理路由连接。getCatConn（）方法返回与分片目录的连接。getShardConn（）方法返回与作为参数提供的分片键匹配的分片的连接。</p><pre class="pre codeblock"><code>// //连接到Sharding Catalog数据库。// public static Connection getCatConn（）throws SQLException {Connection catConn = ods.getConnection（）; } // getCatConn // //使用分片键连接到Shard数据库。// public static Connection getShardConn（int custNo）抛出SQLException {OracleShardingKey shardKey = ods.createShardingKeyBuilder（）。subkey（custNo，JDBCType。NUMERIC）.build（）; OracleConnection shardConn = ods.createConnectionBuilder（）。shardingKey（shardingKey）; return shardConn; } // getShardConn</code></pre><p>考虑到所有这些，您将使用getShardConn（）重写分片环境的addCustomer（）方法，如下所示。</p><pre class="pre codeblock"><code>// //连接到Shard数据库以添加客户。// public static void addCustomer（int custNo，String custName，String street，String city，String state，String zipCode，String phoneNo）抛出SQLException {String sql =“INSERT INTO Customers VALUES（？，？，？，？，？， ？，？）“; try {Connection conn = getShardConn（custNo）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，custNo）; pstmt.setString（2，custName）; pstmt.setString（3，street）; pstmt .setString（4，city）; pstmt.setString（5，state）; pstmt.setString（6，zipCode）; pstmt.setString（7，phoneNo）; pstmt.executeUpdate（）; pstmt.close（）;} catch（ SQLException e）{System.err.println（e.getMessage（））;}} // addCustomer</code></pre><p>在addStockItem（）中，使用getCatConn（）连接到分片目录数据库并插入到重复的表StockItems中。</p><pre class="pre codeblock"><code>// //连接到Sharding Catalog以添加库存项目。// public static void addStockItem（int stockNo，String description，float price）抛出SQLException {String sql =“INSERT INTO StockItems VALUES（？，？，？）“; try {Connection conn = getCatConn（）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，stockNo）; pstmt.setString（2，description）; pstmt.setFloat（3，price）; pstmt。 executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（））;}} // addStockItem</code></pre><p>Orders表是Customers表的子表。要插入Orders表，请根据提供的分片键连接到分片数据库，如以下示例所示。</p><pre class="pre codeblock"><code>// //连接到Shard数据库以为客户添加订单。// public static void enterOrder（int orderNo，int custNo，String orderDate，String shipDate，String toStreet，String toCity，String toState，String toZipCode）throws SQLException {String sql =“INSERT INTO ORERS VALUES（？，？，？，？ ，？，？，？，？）“; try {Connection conn = getShardConn（custNo）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，orderNo）; pstmt.setInt（2，custNo）; pstmt.setString（3，orderDate）; pstmt .setString（4，shipDate）; pstmt.setString（5，toStreet）; pstmt.setString（6，toCity）; pstmt.setString（7，toState）; pstmt.setString（8，toZipCode）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（））;}} // enterOrder</code></pre><p>请注意，对于表族的根，客户和直接子级别Orders，分片kay作为参数提供。对于直接子级以下的级别，您可能没有完整级别的密钥，因此必须从直接父级检索它。在下面的示例中，有一个辅助方法getCustomerFromOrder（），用于根据Order表键值orderNo从Order表中检索分片键custNo。每个子表行都应该有一个父行。这就是为没有父母的孩子或有多个父母的孩子提出完整性违规例外的原因。</p><pre class="pre codeblock"><code>// //确定哪个分片顺序在// static int getCustomerFromOrder（int orderNo）抛出SQLException {String sql =“SELECT O.CustNo FROM Orders O”+“WHERE O.PONo =？“; int custNo; int rsSize = 0;异常异常;尝试{Connection conn = getCatConn（）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，orderNo）; PreparedStatement pstmt = conn.prepareStatement（sql） ; ResultSet rset = pstmt.executeQuery（）; while（rset.next（）&amp;&amp; rsSize &lt;3）{custNo = rs.getInt（“CustNo）; rsSize ++;} rset.close（）; pstmt.close（）;} catch （SQLException e）{System.err.println（e.getMessage（））;} if（rsSize == 0）{throw new SQLIntegrityConstraintViolationException（“No matching parent level key”）; if（rsSize == 2）{throw new SQLIntegrityConstraintViolationException（“多个父级别密钥”）;} return custNo;} // getCustomerFromOrder</code></pre><div class="infoboxnote" id="GUID-FD50835F-514F-4E74-95D3-BD0B4A6B0F20__GUID-E25A47B3-8BD7-429B-8E38-6D8B57CF34F4">
                     <p class="notep1">注意：</p>您的代码不应对分片数据库中的分片数做出任何假设。
                  </div>
                  <p>以下示例显示了原始POManager类中提供的重写的addLineItem（）方法，现在使用getCustomerFromOrder（）辅助方法。对于给定的orderNo，它查询分片目录以查找匹配的custNo值。查询的这一部分使用代理路由传播到所有分片。辅助函数返回单个custNo值。根据此值，使用到该分片的直接路由来插入LineItems表行。</p><pre class="pre codeblock"><code>// //从目录中获取客户（父级），然后插入碎片！// public static void addLineItem（int lineNo，int orderNo，int stockNo，int quantity，float discount）抛出SQLException {String sql =“INSERT INTO LineItems VALUES（？，？，？，？，？，？）“; try {int custNo = getCustomerFromOrder（orderNo）; Connection conn = getShardConn（custNo）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，custNo）; pstmt.setInt（2，lineNo）; pstmt。 setInt（3，orderNo）; pstmt.setInt（4，stockNo）; pstmt.setInt（5，quantity）; pstmt.setFloat（6，discount）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException） e）{System.err.println（e.getMessage（））;}} // addLineItem // //您可以使用整个关键字，直接插入分片。// public static void addLineItemWithinParent（int lineNo，int orderNo，int custNo，int stockNo，int quantity，float discount）抛出SQLException {String sql =“INSERT INTO LineItems VALUES（？，？，？，？，？，？）“; try {Connection conn = getShardConn（custNo）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，custNo）; pstmt.setInt（2，lineNo）; pstmt.setInt（3，orderNo）; pstmt .setInt（4，stockNo）; pstmt.setInt（5，quantity）; pstmt.setFloat（6，discount）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println （e.getMessage（））;}} // addLineItemWithinParent</code></pre><div class="infoboxnote" id="GUID-FD50835F-514F-4E74-95D3-BD0B4A6B0F20__GUID-E3F55FFD-25BA-4540-A3DE-00C6EA4C693E">
                     <p class="notep1">注意：</p>大多数情况下，应用程序上下文中将提供完整级别的键上下文。这就是为什么我们引入额外的方法addLineItemWithinParent（），它根据LineItems表复合级别键中的前导列custNo直接连接到分片。这消除了分片目录的往返。避免使用与我们的辅助函数类似的昂贵的分片编程实践：尽可能使用getCustomerFromOrder（）。
                  </div>
                  <p>必须使用分片目录连接执行大多数聚合查询。分片目录数据库使用代理路由来从分片收集部分结果。最终聚合是基于分片产生的部分结果产生的。这就是原始POManager类中引入的totalOrders（）方法被重写以连接到分片目录数据库的原因，如下所示。</p><pre class="pre codeblock"><code>// // xshard聚合连接到分片目录// public static void totalOrders（）throws SQLException {String sql =“SELECT O.PONo，ROUND（SUM（S.Price * L.Quantity））AS TOTAL”+“FROM订单O，LineItems L，StockItems S“+”WHERE O.PONo = L.PONo AND L.StockNo = S.StockNo“+”GROUP by O.PONo“;尝试{Connection conn = getCatConn（）; PreparedStatement pstmt = conn.prepareStatement（sql）; ResultSet rset = pstmt.executeQuery（）; printResults（RSET）; rset.close（）; pstmt.close（）; } catch（SQLException e）{System.err.println（e.getMessage（））;}} // totalOrders</code></pre><p>之前介绍的printResults（）辅助函数不依赖于数据库结构，因此不需要进行任何修改。</p><pre class="pre codeblock"><code>// //辅助函数 - 无需更改// static void printResults（ResultSet rset）抛出SQLException {String buffer =“”;尝试{ResultSetMetaData meta = rset.getMetaData（）; int cols = meta.getColumnCount（），rows = 0; for（int i = 1; i &lt;= cols; i ++）{int size = meta.getPrecision（i）; String label = meta.getColumnLabel（i）; if（label.length（）&gt; size）size = label.length（）; while（label.length（）&lt;size）label + =“”; buffer = buffer + label +“”; } buffer = buffer +“\ n”; while（rset.next（））{rows ++; for（int i = 1; i &lt;= cols; i ++）{int size = meta.getPrecision（i）; String label = meta.getColumnLabel（i）;字符串值= rset.getString（i）; if（label.length（）&gt; size）size = label.length（）; while（value.length（）&lt;size）value + =“”; buffer = buffer + value +“”; } buffer = buffer +“\ n”; } if（rows == 0）buffer =“找不到数据！\ n“; System.out.println（buffer）;} catch（SQLException e）{System.err.println（e.getMessage（））;}} // printResults</code></pre><p>StockItem表键列stockNo中的值可能与所有分片上的Order表行匹配。这就是为什么你必须修改原始POManager类中引入的checkStockItem（）方法来连接到分片目录。分片目录数据库返回由于在每个分片中执行本地连接而返回的所有行的并集。</p><pre class="pre codeblock"><code>// // xshard查询匹配重复表// public static void checkStockItem（int stockNo）抛出SQLException {String sql =“SELECT O.PONo，O.CustNo，L.StockNo，”+“L.LineNo，L.Quantity， L.Discount“+”FROM Orders O，LineItems L“+”WHERE O.PONo = L.PONo AND L.StockNo =？“; try {Connection conn = getCatConn（）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，stockNo）; ResultSet rset = pstmt.executeQuery（）; printResults（rset）; rset.close（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（））;}} // checkStockItem</code></pre><p>原始POManager类中引入的changeQuantity（）方法更新了孙表LineItems。同样，使用getCustomerFromOrder（）辅助方法获取分片键，以便应用程序可以连接到正确的分片以执行更新。与addLineItem（）方法修改类似，您应该期望custNo列值在应用程序上下文中可用。这就是为什么你应该在changeQuantity（）中使用changeQuantifyWithinParent（），保存到分片目录的往返。</p><pre class="pre codeblock"><code>// //从目录中获取客户（父级）然后更新分片！// public static void changeQuantity（int newQty，int orderNo，int stockNo）抛出SQLException {String sql =“UPDATE LineItems SET Quantity =？“+”WHERE CustNo =？和PONo =？和StockNo =？“; try {int custNo = getCustomerFromOrder（orderNo）; Connection conn = getShardConn（custNo）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，newQty）; pstmt.setInt（2，custNo）; pstmt。 setInt（3，orderNo）; pstmt.setInt（4，stockNo）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（））;}} // changeQuantity // //您可以使用完整级别的密钥，直接更新分片。// public static void changeQuantityWithinParent（int newQty，int custNo，int orderNo，int stockNo）抛出SQLException {String sql =“UPDATE LineItems SET Quantity =？“+”WHERE CustNo =？和PONo =？和StockNo =？“; try {Connection conn = getShardConn（custNo）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，newQty）; pstmt.setInt（2，custNo）; pstmt.setInt（3，orderNo）; pstmt .setInt（4，stockNo）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System.err.println（e.getMessage（））;}} // changeQuantityWithinParent</code></pre><p>对最后一个方法deleteOrder（）的修改遵循应用于addLineItem（）和changeQuantity（）的相同指导原则。在从LineItems表中删除行之前，应用程序应首先在分片目录中查找与请求的顺序对应的custNo分片键值。获得分片键后，连接到分片并执行删除。同样，使用deleteOrderWithinParent（）方法，期望在应用程序上下文中提供分片键值。</p><pre class="pre codeblock"><code>// //首先从目录中获取客户（父级），在分片中删除！// public static void deleteOrder（int orderNo）throws SQLException {String sql =“DELETE FROM LineItems WHERE CustNo =？和PONo =？“; try {int custNo = getCustomerFromOrder（orderNo）; Connection conn = getShardConn（custNo）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，orderNo）; pstmt.executeUpdate（）; sql =”DELETE FROM订单在哪里PONo =？“;; pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，custNo）; pstmt.setInt（2，orderNo）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System。 err.println（e.getMessage（））;}} // deleteOrder // //你已经得到了整个级别的密钥，直接在shard中删除// public static void deleteOrderWithinParent（int custNo，int orderNo）throws SQLException {String sql =“DELETE FROM LineItems WHERE CustNo =？和PONo =？“; try {Connection conn = getShardConn（custNo）; PreparedStatement pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，orderNo）; pstmt.executeUpdate（）; sql =”DELETE FROM Orders WHERE PONo =？“;; pstmt = conn.prepareStatement（sql）; pstmt.setInt（1，custNo）; pstmt.setInt（2，orderNo）; pstmt.executeUpdate（）; pstmt.close（）;} catch（SQLException e）{System。 err.println（e.getMessage（））;}} // deleteOrderWithinParent} // POManager</code></pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="sharding-loading-data.html#GUID-6140925F-6192-4C6F-9ADC-BC2332ADA3B0" title="您可以使用此处描述的方法将数据从非分片数据库迁移到Oracle Sharding分片数据库。">数据迁移到Sharded数据库</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html><html id="01920.oracle-clusterware-agent-framework-c-application-program-interfaces.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>Oracle Clusterware Agent Framework C应用程序接口</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Clusterware Administration and Deployment Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Clusterware Administration and Deployment Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="clusterware-administration-and-deployment-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-24T07:05:38-07:00"></meta>
      <meta name="dcterms.title" content="Clusterware Administration and Deployment Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E95727-05"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="server-control-command-reference.html" title="Previous" type="text/html"></link>
      <link rel="next" href="oracle-clusterware-c-application-program-interfaces.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CWADD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="server-control-command-reference.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="oracle-clusterware-c-application-program-interfaces.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">“Clusterware管理和部署指南”</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle Clusterware Agent Framework C应用程序接口</li>
            </ol>
            <a id="GUID-1B0838C1-2211-4EF6-8108-0BFC06F51082" name="GUID-1B0838C1-2211-4EF6-8108-0BFC06F51082"></a><a id="CWADD92426"></a>
            
            <h2 id="CWADD-GUID-1B0838C1-2211-4EF6-8108-0BFC06F51082" class="sect2"><span class="enumeration_appendix">H</span> Oracle Clusterware Agent Framework C应用程序接口</h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Clusterware管理使用Oracle Clusterware注册为资源的应用程序，并且必须能够访问能够启动，停止和监视特定资源的特定于应用程序的基元。Oracle Clusterware通过称为<span class="italic">代理</span>的实体运行所有特定于资源的命令。
               </p>
               <p>代理程序是包含用于管理资源的代理程序框架和用户代码的程序。代理框架是一个C库，使您可以插入特定于应用程序的代码来管理自定义应用程序。您可以将C或C ++中的所有实际应用程序管理功能（例如，启动，停止和检查应用程序的运行状况）编程到代理程序中。这些功能称为<span class="italic">入口点</span> 。代理框架负责代表Oracle Clusterware调用这些入口点函数。代理开发人员可以使用这些入口点来插入有关如何启动，停止和监视资源的特定资源所需的功能。代理能够管理多个资源。
               </p>
               <p>本附录包括以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-9B95F8E6-76AD-444A-BEA2-956038E35080">代理框架数据类型</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-A142ECEA-AC0C-4937-90A4-071A98A49B04">代理框架上下文初始化和持久性</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-527AB33A-F618-4BF4-BCA3-42D8AA3DDBD0">C和C ++入口点函数的原型</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E">C和C ++入口点类型和代码</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-6246C353-CC04-49A7-9AF7-54EEF0F60795">C和C ++入口点函数返回值</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-DF728937-D87A-43EE-8DE8-1B72219ED8FB">多线程注意事项</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-AE0637F9-774B-4408-A948-09BE47A12EAB">弃用的API</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-D18CD5D3-F691-48AD-B2FC-7970DA919E1B" title="注册代理管理的资源类型。启动对特定资源的检查操作。创建迭代器以访问当前资源的所有属性。删除存储在代理框架中的cookie。使用资源重试反馈终止代理进程。从创建的迭代器返回下一个属性名称和值。获取当前资源的属性值。返回当前正在执行的检查命令的类型。返回调用入口点的命令的类型。检索存储在代理框架中的cookie的值。返回要在资源上执行的自定义操作的名称。检索正在执行入口点的资源的ID。检索当前命令的资源名称。返回当前命令的重试尝试次数。检索正在为其执行入口点的资源的类型名称。初始化代理框架。返回ABORT入口点的原因。将诊断消息打印到代理日志文件。修改当前资源的属性。重置属性迭代器。向Oracle Clusterware服务器和用户报告进度，警告和错误消息。在代理框架中存储cookie及其值。设置要对资源上的特定操作执行的C / C ++入口点函数。注册代理进程退出时要调用的函数。在当前资源上设置自定义标签。启动代理框架。">API参考</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9">代理示例</a></p>
                  </li>
               </ul>
            </div><a id="CWADD92428"></a><a id="CWADD92427"></a><div class="sect2"><a id="GUID-9B95F8E6-76AD-444A-BEA2-956038E35080" name="GUID-9B95F8E6-76AD-444A-BEA2-956038E35080"></a><h3 id="CWADD-GUID-9B95F8E6-76AD-444A-BEA2-956038E35080" class="sect3">代理框架数据类型</h3>
               <div>
                  <p>Oracle Clusterware代理框架使用Oracle定义的可移植数据类型来表示字符串和数字。通过使用这些数据类型，您可以在多个平台上构建和执行代理程序。<a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-9B95F8E6-76AD-444A-BEA2-956038E35080__CACEJGGA" title="此表列出并描述了代理框架中使用的Oracle数据类型。">表H-1</a>列出并描述了代理框架中使用的Oracle数据类型。
                  </p>
                  <div class="tblformal" id="GUID-9B95F8E6-76AD-444A-BEA2-956038E35080__CACEJGGA">
                     <p class="titleintable">表H-1代理框架中使用的Oracle数据类型</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="代理框架中使用的Oracle数据类型" width="100%" border="1" summary="This table lists and describes Oracle data types used in the agent framework." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d183093e309">Oracle数据类型</th>
                              <th align="left" valign="bottom" width="69%" id="d183093e312">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d183093e317" headers="d183093e309 ">
                                 <p>UB4</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d183093e317 d183093e312 ">
                                 <p>无符号32位整数</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d183093e324" headers="d183093e309 ">
                                 <p>SB4</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d183093e324 d183093e312 ">
                                 <p>有符号的32位整数</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d183093e331" headers="d183093e309 ">
                                 <p>oratext *</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d183093e331 d183093e312 ">
                                 <p>C样式以null结尾的字符串，显式转换为<span class="bold">char *</span> required</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>代理框架API返回<code class="codeph">clsagfwret</code>类型的状态值，如下所示：</p>
                  <ul class="simple" style="list-style-type:none;padding-left:0">
                     <li><code class="codeph">CLSAGFW_SUCCESS</code> ：函数执行成功</li>
                     <li><code class="codeph">CLSAGFW_FAIL</code> ：参数或执行函数时出错</li>
                     <li></li>
                  </ul>
                  <p>API返回的字符串值只能在当前命令入口点的范围内访问。代理可以将返回的字符串值复制到其自己的缓冲区以保留该值。</p>
               </div>
            </div><a id="CWADD92429"></a><div class="sect2"><a id="GUID-A142ECEA-AC0C-4937-90A4-071A98A49B04" name="GUID-A142ECEA-AC0C-4937-90A4-071A98A49B04"></a><h3 id="CWADD-GUID-A142ECEA-AC0C-4937-90A4-071A98A49B04" class="sect3">代理框架上下文初始化和持久性</h3>
               <div>
                  <p>代理框架由<code class="codeph">clsagfw_init()</code>函数调用初始化。没有您需要维护的上下文。操作入口点函数传递指向代理框架上下文的指针（类型为<code class="codeph">clsagfw_aectx</code> ）。此上下文特定于被调用的入口点，不能在入口点的范围之外使用。其他代理框架API将此上下文指针作为参数。这是代理框架维护但不显式初始化或销毁的不透明数据结构。
                  </p>
               </div>
            </div><a id="CWADD92430"></a><div class="sect2"><a id="GUID-527AB33A-F618-4BF4-BCA3-42D8AA3DDBD0" name="GUID-527AB33A-F618-4BF4-BCA3-42D8AA3DDBD0"></a><h3 id="CWADD-GUID-527AB33A-F618-4BF4-BCA3-42D8AA3DDBD0" class="sect3">C和C ++入口点函数的原型</h3>
               <div>
                  <p>代理程序实现资源管理命令的入口点函数，并使用代理程序框架注册这些函数。代理框架调用入口点函数以对资源执行命令或操作。入口点函数需要符合以下原型和约定：</p><pre class="oac_no_warn" dir="ltr">typedef ub4（* clsagfw_action_entry）（const clsagfw_aectx * aectx）</pre><p>使用指向代理框架维护的上下文区域的指针调用入口点函数。此函数应返回一个值，指示入口点的执行状态。对于CHECK入口点，该函数返回资源的当前状态。</p>
                  <p>如果使用C ++开发代理，则使用<span class="bold"><code class="codeph">extern 'C'</code></span>关键字声明入口点函数原型。
                  </p>
               </div>
            </div><a id="CWADD92432"></a><a id="CWADD92431"></a><div class="sect2"><a id="GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E" name="GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E"></a><h3 id="CWADD-GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E" class="sect3">C和C ++入口点类型和代码</h3>
               <div>
                  <p>代理框架当前定义了与资源管理命令和对资源执行的操作相对应的七种入口点类型。代理必须注册START，STOP，CHECK和CLEAN命令的入口点。其他命令入口点是可选的。代理通过为每种资源类型和命令调用<code class="codeph">clsagfw_set_entrypoint()</code> API来注册入口点。<a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E__CACGAJFF" title="此表列出并描述了入口点类型。">表H-2</a>列出并描述了入口点类型及其等效类型代码。
                  </p>
                  <div class="tblformal" id="GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E__CACGAJFF">
                     <p class="titleintable">表H-2入口点类型</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="入口点类型" width="100%" border="1" summary="This table lists and describes entry point types." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="16%" id="d183093e748">名称</th>
                              <th align="left" valign="bottom" width="49%" id="d183093e751">描述</th>
                              <th align="left" valign="bottom" width="36%" id="d183093e754">类型代码</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e759" headers="d183093e748 ">
                                 <p>开始</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e759 d183093e751 ">
                                 <p>启动资源并将其联机</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e759 d183093e754 ">
                                 <p>CLSAGFW_ACTION_START</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e769" headers="d183093e748 ">
                                 <p>停</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e769 d183093e751 ">
                                 <p>停止资源并使其脱机</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e769 d183093e754 ">
                                 <p>CLSAGFW_ACTION_STOP</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e779" headers="d183093e748 ">
                                 <p>清洁</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e779 d183093e751 ">
                                 <p>在资源上发生命令失败后清理</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e779 d183093e754 ">
                                 <p>CLSAGFW_ACTION_CLEAN</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e789" headers="d183093e748 ">
                                 <p>校验</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e789 d183093e751 ">
                                 <p>检查资源的状态</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e789 d183093e754 ">
                                 <p>CLSAGFW_ACTION_CHECK</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e799" headers="d183093e748 ">
                                 <p>中止</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e799 d183093e751 ">
                                 <p>结束已超时的执行命令</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e799 d183093e754 ">
                                 <p>CLSAGFW_ACTION_ABORT</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e809" headers="d183093e748 ">
                                 <p>删除</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e809 d183093e751 ">
                                 <p>资源即将被删除</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e809 d183093e754 ">
                                 <p>CLSAGFW_ACTION_RES_DELETED</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e819" headers="d183093e748 ">
                                 <p>修改</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e819 d183093e751 ">
                                 <p>资源被修改</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e819 d183093e754 ">
                                 <p>CLSAGFW_RESATTR_MODIFIED</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d183093e829" headers="d183093e748 ">
                                 <p>行动</p>
                              </td>
                              <td align="left" valign="top" width="49%" headers="d183093e829 d183093e751 ">
                                 <p>在资源上调用自定义操作</p>
                              </td>
                              <td align="left" valign="top" width="36%" headers="d183093e829 d183093e754 ">
                                 <p>CLSAGFW_RES_ACTION</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="infoboxnotealso" id="GUID-F6CDAA84-1AE4-4F31-BAA5-7D7EEC03985E__GUID-AB2DC922-B92B-4370-B943-F6C0D80C770B">
                     <p class="notep1">也可以看看：</p>
                     <p>有关入口点的更多信息，请参阅<span class="q">“ <a href="making-applications-highly-available-using-oracle-clusterware.html#GUID-342D37E6-E73E-4A80-BEAC-699EC25E46C5" title="Oracle Clusterware将应用程序和进程作为您向Oracle Clusterware注册的资源进行管理。虚拟机是为正在运行的操作系统创建的环境，称为客户操作系统。虚拟机显示为计算机桌面上的一个窗口，可以全屏模式显示，也可以在另一台计算机上远程显示。资源组是逻辑上相关的资源组的容器。在Oracle Clusterware中，资源类型是一类资源的模板。使用CRSCTL创建资源组，资源组类型以及向资源组添加资源。Oracle Clusterware通过称为代理的实体运行所有特定于资源的命令。操作脚本定义一个或多个操作以启动，停止，检查或清除资源。使用crsctl add resource命令在Oracle Clusterware 12c中注册资源。">Oracle Clusterware资源和代理</a> ”</span></p>
                  </div>
               </div>
            </div><a id="CWADD92433"></a><div class="sect2"><a id="GUID-6246C353-CC04-49A7-9AF7-54EEF0F60795" name="GUID-6246C353-CC04-49A7-9AF7-54EEF0F60795"></a><h3 id="CWADD-GUID-6246C353-CC04-49A7-9AF7-54EEF0F60795" class="sect3">C和C ++入口点函数返回值</h3>
               <div>
                  <p>除CHECK入口点之外的所有入口点函数都返回以下值之一以指示入口点的执行状态：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="bold">CLSAGFW_AE_SUCCESS</span> ：入口点执行成功完成</p>
                     </li>
                     <li>
                        <p><span class="bold">CLSAGFW_AE_FAIL</span> ：入口点执行失败</p>
                     </li>
                  </ul>
                  <p>代理框架调用CHECK入口点函数来监视资源的状态。此函数返回以下值之一，表示资源的当前状态：</p>
                  <ul class="simple" style="list-style-type:none;padding-left:0">
                     <li>CLSAGFW_ONLINE</li>
                     <li>CLSAGFW_UNPLANNED_OFFLINE</li>
                     <li>CLSAGFW_PLANNED_OFFLINE</li>
                     <li>CLSAGFW_UNKNOWN</li>
                     <li>CLSAGFW_PARTIAL</li>
                     <li>CLSAGFW_FAILED</li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-6246C353-CC04-49A7-9AF7-54EEF0F60795__GUID-C0996094-F7DE-47C9-9950-20A68F15F28F">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="making-applications-highly-available-using-oracle-clusterware.html#GUID-CD3442A5-D6A8-4370-ABDA-CB686A736D3C" title="Oracle Clusterware通过称为代理的实体运行所有特定于资源的命令。">Oracle Clusterware中的代理</a> ”</span> ，以获取有关评估和返回资源状态的更多信息</p>
                  </div>
               </div>
            </div><a id="CWADD92434"></a><div class="sect2"><a id="GUID-DF728937-D87A-43EE-8DE8-1B72219ED8FB" name="GUID-DF728937-D87A-43EE-8DE8-1B72219ED8FB"></a><h3 id="CWADD-GUID-DF728937-D87A-43EE-8DE8-1B72219ED8FB" class="sect3">多线程注意事项</h3>
               <div>
                  <p>Oracle Clusterware代理框架在设计上是多线程的。代理程序代码还可以启动新线程以执行特定于应用程序的功能，例如监视外部事件源。代理框架一次只执行一个资源的一个入口点，唯一的例外是ABORT入口点，该入口点被调用以结束对资源的当前活动操作。C和C ++开发人员必须确保所有代理程序代码都是多线程安全的。必须使用锁定机制（例如互斥锁）序列化对全局变量和其他资源的访问。代理程序包含的其他外部C或C ++库也应该是多线程安全的。</p>
               </div>
            </div><a id="CWADD92941"></a><a id="CWADD92940"></a><div class="sect2"><a id="GUID-AE0637F9-774B-4408-A948-09BE47A12EAB" name="GUID-AE0637F9-774B-4408-A948-09BE47A12EAB"></a><h3 id="CWADD-GUID-AE0637F9-774B-4408-A948-09BE47A12EAB" class="sect3">弃用的API</h3>
               <div>
                  <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-AE0637F9-774B-4408-A948-09BE47A12EAB__BABEACFC" title="此表列出了已弃用的代理框架API命令及其替代项。">表H-3</a>列出了已弃用的代理框架API以及Oracle Clusterware的相应替换API。
                  </p>
                  <div class="tblformalwide" id="GUID-AE0637F9-774B-4408-A948-09BE47A12EAB__BABEACFC">
                     <p class="titleintable">表H-3不推荐使用的代理框架API</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="不推荐使用的代理框架API" width="100%" border="1" summary="This table lists deprecated agent framework API commands and their replacements." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="45%" id="d183093e1266">弃用的API</th>
                              <th align="left" valign="bottom" width="55%" id="d183093e1269">替换</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="45%" id="d183093e1274" headers="d183093e1266 "><pre class="oac_no_warn" dir="ltr">clsagfw_exit（）</pre></td>
                              <td align="left" valign="top" width="55%" headers="d183093e1274 d183093e1269 "><pre class="oac_no_warn" dir="ltr">clsagfw_exit2（）</pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="45%" id="d183093e1281" headers="d183093e1266 "><pre class="oac_no_warn" dir="ltr">clsagfw_send_status（）</pre></td>
                              <td align="left" valign="top" width="55%" headers="d183093e1281 d183093e1269 "><pre class="oac_no_warn" dir="ltr">clsagfw_send_status2（）</pre></td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="CWADD92435"></a><div class="sect2"><a id="GUID-D18CD5D3-F691-48AD-B2FC-7970DA919E1B" name="GUID-D18CD5D3-F691-48AD-B2FC-7970DA919E1B"></a><h3 id="CWADD-GUID-D18CD5D3-F691-48AD-B2FC-7970DA919E1B" class="sect3">API参考</h3>
               <div>
                  <p>本节列出并描述了以下功能：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822" title="注册代理管理的资源类型。">clsagfw_add_type（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-AE09D76E-63EC-4270-83FC-0504D38276BD" title="启动对特定资源的检查操作。">clsagfw_check_resource（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0" title="创建迭代器以访问当前资源的所有属性。">clsagfw_create_attr_iterator（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC" title="删除存储在代理框架中的cookie。">clsagfw_delete_cookie（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-452087CF-77B9-4381-94A6-3E89E978A58C" title="使用资源重试反馈终止代理进程。">clsagfw_exit2（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B" title="从创建的迭代器返回下一个属性名称和值。">clsagfw_get_attr_from_iterator（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86" title="获取当前资源的属性值。">clsagfw_get_attrvalue（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-7D7A085C-51D6-446F-9687-B04A20AA139A" title="返回当前正在执行的检查命令的类型。">clsagfw_get_check_type（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3" title="返回调用入口点的命令的类型。">clsagfw_get_cmdid（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-24F42F78-86EB-4157-89E5-31C98F37946B" title="检索存储在代理框架中的cookie的值。">clsagfw_get_cookie（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A" title="返回要在资源上执行的自定义操作的名称。">clsagfw_get_request_action_name（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6" title="检索正在执行入口点的资源的ID。">clsagfw_get_resource_id（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9" title="检索当前命令的资源名称。">clsagfw_get_resource_name（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06" title="返回当前命令的重试尝试次数。">clsagfw_get_retry_count（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37" title="检索正在为其执行入口点的资源的类型名称。">clsagfw_get_type_name（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21" title="初始化代理框架。">clsagfw_init（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7" title="返回ABORT入口点的原因。">clsagfw_is_cmd_timedout（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4" title="将诊断消息打印到代理日志文件。">clsagfw_log（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B" title="修改当前资源的属性。">clsagfw_modify_attribute（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B" title="重置属性迭代器。">clsagfw_reset_attr_iterator（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-BCB22E7E-D21C-445E-A253-3B099331304B" title="向Oracle Clusterware服务器和用户报告进度，警告和错误消息。">clsagfw_send_status2（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C" title="在代理框架中存储cookie及其值。">clsagfw_set_cookie（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842" title="设置要对资源上的特定操作执行的C / C ++入口点函数。">clsagfw_set_entrypoint（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C" title="注册代理进程退出时要调用的函数。">clsagfw_set_exitcb（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841" title="在当前资源上设置自定义标签。">clsagfw_set_resource_state_label（）</a></code></p>
                     </li>
                     <li>
                        <p><code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-800B6FFF-3807-47E2-8239-92C293D1E385" title="启动代理框架。">clsagfw_startup（）</a></code></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822" name="GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822"></a><h4 id="CWADD-GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822" class="sect4">clsagfw_add_type（）</h4>
                  <div>
                     <p>注册代理管理的资源类型。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822__GUID-CA3DDE40-D277-442D-A24A-573295DCADC9">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_add_type（const oratext * type_name）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822__GUID-95DD9DE0-3454-4378-895C-70F664B8117F">输入</p>
                        <p><code class="codeph">type_name</code> ：代理要管理的资源类型名称</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-62EC5F68-5A8B-41B9-A4BB-7825031F2822__GUID-2D8725C5-FCEF-47D2-A1B2-F611F6A7BA44">使用说明</p>
                        <p>启动时，代理必须注册它管理的所有资源类型。单个代理可以管理多种资源类型和多种资源。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-AE09D76E-63EC-4270-83FC-0504D38276BD" name="GUID-AE09D76E-63EC-4270-83FC-0504D38276BD"></a><h4 id="CWADD-GUID-AE09D76E-63EC-4270-83FC-0504D38276BD" class="sect4">clsagfw_check_resource（）</h4>
                  <div>
                     <p>启动对特定资源的检查操作。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-AE09D76E-63EC-4270-83FC-0504D38276BD__GUID-7409E839-ECE8-4260-B889-21658608EE56">句法</p><pre class="pre codeblock"><code>void clsagfw_check_resource（const oratext * pResId）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AE09D76E-63EC-4270-83FC-0504D38276BD__GUID-DBE12892-2CF6-4E4A-87C9-54FD6DBD0050">输入</p>
                        <p><code class="codeph">pResId</code> ：资源的识别</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-AE09D76E-63EC-4270-83FC-0504D38276BD__GUID-63A52656-064E-4DA5-95D0-E94C1405B9A8">使用说明</p>
                        <p>代理可以在入口点或其他后台线程中使用此功能来启动对特定资源的检查操作。代理框架在另一个线程中调度并执行检查操作。如果从CHECK入口点调用，则此函数无效。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0" name="GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0"></a><h4 id="CWADD-GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0" class="sect4">clsagfw_create_attr_iterator（）</h4>
                  <div>
                     <p>创建迭代器以访问当前资源的所有属性。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0__GUID-21F8ECB8-9B38-4BE4-B03C-A69F3F57F549">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_create_attr_iterator（const clsagfw_aectx * pAeCtx，clsagfw_ai_flags flags）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0__GUID-D03AFB99-7F92-49C3-8401-13EF5EBEA0E8">输入</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                           </li>
                           <li>
                              <p><code class="codeph">flags</code> ：</p>
                              <p>             <code class="codeph">CLSAGFW_ALL_ATTRS</code> ：资源的所有属性</p>
                              <p>             <code class="codeph">CLSAGFW_MODIFIED_ATTRS</code> ：仅修改属性</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-74BF1AD0-D54A-4592-A08C-7072DE37DFD0__GUID-9DC193DC-0E11-4DEC-9F15-D061CED131CB">使用说明</p>
                        <p>代理程序调用此函数来创建迭代器以浏览资源的所有属性。这对于管理不同类型的多个资源的代理很有用。迭代器是在代理框架上下文中维护的内部迭代器。通过调用<code class="codeph">clsagfw_get_attr_from_iterator()</code> API来检索每个属性。只能在MODIFY入口点访问已修改的属性。在任何给定时间，入口点只能创建一个迭代器。所有后续创建迭代器的尝试都会获得指向已创建的迭代器的指针。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC" name="GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC"></a><h4 id="CWADD-GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC" class="sect4">clsagfw_delete_cookie（）</h4>
                  <div>
                     <p>删除存储在代理框架中的cookie。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC__GUID-6289891F-90D3-4EFC-A0BF-C73974F746E0">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_delete_cookie（const oratext * key）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC__GUID-AD08D837-F4C8-41F8-8207-5F0F12CFA119">输入</p>
                        <p><code class="codeph">key</code> ：cookie的键，以null结尾的字符串</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3224508B-72A9-4E7B-8A47-5B803FD915DC__GUID-470E209E-B50C-48AC-9C76-1685B55BECBE">使用说明</p>
                        <p>此函数删除cookie并释放cookie使用的所有内存及其值。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-452087CF-77B9-4381-94A6-3E89E978A58C" name="GUID-452087CF-77B9-4381-94A6-3E89E978A58C"></a><h4 id="CWADD-GUID-452087CF-77B9-4381-94A6-3E89E978A58C" class="sect4">clsagfw_exit2（）</h4>
                  <div>
                     <p>使用资源重试反馈终止代理进程。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-452087CF-77B9-4381-94A6-3E89E978A58C__GUID-01DB4A37-73A5-49FF-A2A5-21079BDDFA4A">句法</p><pre class="pre codeblock"><code>void clsagfw_exit2（const oratext * rid，sb4 exitCode，bool retry）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-452087CF-77B9-4381-94A6-3E89E978A58C__GUID-CDCE196D-14F2-437B-B3FD-C6578E4925B4">输入</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">rid</code> ：导致无法恢复的错误的资源的资源ID</p>
                           </li>
                           <li>
                              <p><code class="codeph">exitCode</code> ：处理退出代码</p>
                           </li>
                           <li>
                              <p><code class="codeph">retry</code> ：重试资源的选项</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-452087CF-77B9-4381-94A6-3E89E978A58C__GUID-50EA6F2A-5ACE-4122-BF6D-0B6B2D4E22A6">使用说明</p>
                        <p>在执行资源的入口点时，代理可能会遇到不可恢复的错误，然后必须终止当前进程。代理可以使用此API来结束代理进程，并在资源上向代理框架提供反馈，这是导致无法恢复的错误的原因。如果retry参数设置为<span class="italic">true</span> ，则在代理进程重新启动时将重试资源上的当前命令。如果参数设置为<span class="italic">false</span> ，则不会重试当前资源命令，并且禁用资源监视。当特定资源是代理重复失败的原因时，可以使用此选项。Oracle Clusterware服务器会跟踪导致代理退出的资源，并在故障率很高时自动禁用资源。要重新启用由于高故障率而禁用的资源，必须发出显式请求以启动资源（例如，使用CRSCTL）。
                        </p>
                        <p>Oracle Clusterware服务器重新启动代理以继续监视代理管理的资源。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B" name="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B"></a><h4 id="CWADD-GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B" class="sect4">clsagfw_get_attr_from_iterator（）</h4>
                  <div>
                     <p>从创建的迭代器返回下一个属性名称和值。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B__GUID-092EF3B4-81EB-4887-A706-4E42542111CE">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_get_attr_from_iterator（const clsagfw_aectx * pAeCtx，const oratext ** argName，const oratext ** argValue）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B__GUID-245BDF89-B7B4-4573-913F-84454D9AAA0D">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B__GUID-B14245A3-3927-40F5-A3F6-BCAAD3254E8C">返回</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">argname</code> ：属性名称</p>
                           </li>
                           <li>
                              <p><code class="codeph">argValue</code> ：属性值</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6616A067-3258-4D1E-B6EE-1098ABF2D67B__GUID-576CC7DE-CCF1-4F89-9CCB-3853E6678CDB">使用说明</p>
                        <p>在代理框架上下文中创建迭代器后，使用此函数检索属性。当此函数返回时，迭代器将前进到下一个属性。如果API返回CLSAGFW_FAIL，则不再有资源要检索的属性。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86" name="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86"></a><h4 id="CWADD-GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86" class="sect4">clsagfw_get_attrvalue（）</h4>
                  <div>
                     <p>获取当前资源的属性值。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86__GUID-F7F1B394-7B02-4B1A-A23D-FE1F7A94B80F">句法</p><pre class="pre codeblock"><code>void clsagfw_get_attrvalue（const clsagfw_aectx * pAeCtx，const oratext * pAttrName，const oratext ** pAttrValue）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86__GUID-E1468BEB-84FD-47B0-BBB2-A6D7E597C60A">输入</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                           </li>
                           <li>
                              <p><code class="codeph">pAttrName</code> ：要检索的属性的名称</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86__GUID-37A9BEC8-554B-43C2-8005-CAC8DE0B4450">返回</p>
                        <p><code class="codeph">pAttrValue</code> ：指定属性的值</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9B4900CC-0BE6-46AB-A8B8-D91D6C598B86__GUID-72B2671F-7A3F-48AC-BBB8-9A71E3A64AF1">使用说明</p>
                        <p>代理使用此API来检索当前命令资源的单个属性的值。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7D7A085C-51D6-446F-9687-B04A20AA139A" name="GUID-7D7A085C-51D6-446F-9687-B04A20AA139A"></a><h4 id="CWADD-GUID-7D7A085C-51D6-446F-9687-B04A20AA139A" class="sect4">clsagfw_get_check_type（）</h4>
                  <div>
                     <p>返回当前正在执行的检查命令的类型。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-7D7A085C-51D6-446F-9687-B04A20AA139A__GUID-7FF69B67-3E86-4411-B2DD-E094A5C07772">句法</p><pre class="pre codeblock"><code>clsagfw_checktype clsagfw_get_check_type（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7D7A085C-51D6-446F-9687-B04A20AA139A__GUID-688A3557-4019-4074-A0FD-1D795FCE3563">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7D7A085C-51D6-446F-9687-B04A20AA139A__GUID-A5AED642-FBB0-4EAA-802C-5AE0F31F1E4E">使用说明</p>
                        <p>代理框架针对多个条件调用资源的CHECK入口点。通过使用此功能，代理可以识别当前CHECK入口点的确切条件并执行适当的操作。</p>
                        <p>可能的条件包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">CLSAGFW_INITIAL_CHECK</span> ：检查在启动或重新启动Oracle Clusterware服务器时作为初始探测阶段的一部分调用的入口点。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">CLSAGFW_CHECK_AFTER_CMD</span> ：检查调用的入口点以跟进先前的操作（例如启动或停止），以确定操作执行后的结果资源状态。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">CLSAGFW_PERIODIC_CHECK</span> ：定期检查代理框架调用的入口点以监视资源的状态。时间间隔在资源的<code class="codeph">CHECK_INTERVAL</code>属性中指定。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">CLSAGFW_EXTERNAL_CHECK</span> ：检查代理框架在收到来自外部实体（如CRSCTL）的显式检查请求时调用的入口点。</p>
                           </li>
                           <li>
                              <p><span class="bold">CLSAGFW_CHECKFROM_EP</span> ：通过调用<code class="codeph">clsagfw_check_resource()</code> API检查代理本身启动的操作。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3" name="GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3"></a><h4 id="CWADD-GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3" class="sect4">clsagfw_get_cmdid（）</h4>
                  <div>
                     <p>返回调用入口点的命令的类型。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3__GUID-179A7993-BABC-4652-8DB8-E96E334BB4D3">句法</p><pre class="pre codeblock"><code>clsagfw_aecode clsagfw_get_cmdid（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3__GUID-D854E0F9-86AE-4B5F-B73B-DAC2AE8F7B5F">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5F052C35-F002-44BC-981A-90EB38E2CFF3__GUID-54356944-5773-4E55-A813-E94B0E083370">使用说明</p>
                        <p>代理可以在ABORT入口点调用此API以确定正在中止的资源命令。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-24F42F78-86EB-4157-89E5-31C98F37946B" name="GUID-24F42F78-86EB-4157-89E5-31C98F37946B"></a><h4 id="CWADD-GUID-24F42F78-86EB-4157-89E5-31C98F37946B" class="sect4">clsagfw_get_cookie（）</h4>
                  <div>
                     <p>检索存储在代理框架中的cookie的值。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-24F42F78-86EB-4157-89E5-31C98F37946B__GUID-19ECE386-8F42-4D2A-A156-8624404CDB39">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfwret clsagfw_set_cookie（const oratext * key，const void ** value）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-24F42F78-86EB-4157-89E5-31C98F37946B__GUID-795AF91F-E624-4F96-8406-977FB0BA2CB1">输入</p>
                        <p><code class="codeph">key</code> ：cookie的键，以null结尾的字符串</p>
                        <p><code class="codeph">Value</code> ：指向cookie值的指针</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A" name="GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A"></a><h4 id="CWADD-GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A" class="sect4">clsagfw_get_request_action_name（）</h4>
                  <div>
                     <p>返回要在资源上执行的自定义操作的名称。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A__GUID-4269D22E-1165-41D6-9621-D94B13908CF5">句法</p><pre class="pre codeblock"><code>const oratext * clsagfw_get_request_action_name（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A__GUID-DE01E973-35CD-4CEC-922B-21FCC926766D">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给用户入口点的代理框架上下文</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DC809473-DDBA-4D62-B860-DAF768A4B06A__GUID-8A961D7B-AFDE-4F03-BD94-DA335BF528E1">使用说明</p>
                        <p>在ACTION入口点调用此函数以检索您在请求操作命令中指定的操作名称。您可以在资源的ACTION属性中配置资源的操作列表。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6" name="GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6"></a><h4 id="CWADD-GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6" class="sect4">clsagfw_get_resource_id（）</h4>
                  <div>
                     <p>检索正在执行入口点的资源的ID。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6__GUID-5918E859-DB36-4863-9573-9611F298D260">句法</p><pre class="pre codeblock"><code>const oratext * clsagfw_get_resource_id（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6__GUID-8C6F4EA9-1D7C-4187-B67F-C2F47561E2D1">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4D6EA7DF-B212-45B3-91ED-9AA1AE6200E6__GUID-1240969F-4741-4FC8-9DA5-29D6743A3991">使用说明</p>
                        <p>此函数返回Oracle Clusterware生成的资源ID。要检索资源的公共显示名称，请使用<code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9" title="检索当前命令的资源名称。">clsagfw_get_resource_name()</a></code> API。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9" name="GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9"></a><h4 id="CWADD-GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9" class="sect4">clsagfw_get_resource_name（）</h4>
                  <div>
                     <p>检索当前命令的资源名称。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9__GUID-A097A44A-9886-494A-B250-BD52C89E6E37">句法</p><pre class="pre codeblock"><code>const oratext * clsagfw_get_resource_name（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9__GUID-317809A6-9F94-483D-A9D8-20A01BB193C8">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9__GUID-0140BCD0-AAAD-4AFD-919E-501BBAAD64F4">使用说明</p>
                        <p>此函数返回正在为其执行当前命令和入口点的资源的名称。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06" name="GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06"></a><h4 id="CWADD-GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06" class="sect4">clsagfw_get_retry_count（）</h4>
                  <div>
                     <p>返回当前命令的重试尝试次数。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06__GUID-FA275796-3249-4C11-98B9-11B848725927">句法</p><pre class="pre codeblock"><code>ub4 clsagfw_get_retry_count（const clsagfw_aectx * pAeCtx）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06__GUID-4E5A9A58-62FF-423E-8FEB-7A6450433869">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给用户入口点的代理框架上下文</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-2B1F79C0-6C9E-4BD8-9709-C0092E699D06__GUID-E26D738D-EEA3-4538-A441-57ABD73BC9F5">使用说明</p>
                        <p>代理可以在入口点调用此函数以检查是否正在重试当前命令。代理进程或Oracle Clusterware服务器进程可以在对资源执行命令的过程中终止。当代理或服务器进程重新启动时，Oracle Clusterware会重试失败的命令。该命令可能在先前的尝试中已成功或部分执行。当Oracle Clusterware重试命令时，代理可以执行恢复或清理操作。可以重试命令的次数是Oracle Clusterware的内部参数。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37" name="GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37"></a><h4 id="CWADD-GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37" class="sect4">clsagfw_get_type_name（）</h4>
                  <div>
                     <p>检索正在为其执行入口点的资源的类型名称。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37__GUID-81C067C9-6587-4E7C-8733-5FCEDB3A9B27">句法</p><pre class="pre codeblock"><code>const oratext * clsagfw_get_type_name（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37__GUID-12029F61-EB81-4CD7-ACD3-8192415168B8">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-22B8F816-B746-4C5A-8EE6-B2312F401B37__GUID-A92D75F7-5E09-4CFD-9428-7F7A5F5CC053">使用说明</p>
                        <p>此函数返回Oracle Clusterware生成的资源ID。要检索资源的公共显示名称，请使用<code class="codeph"><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-BAB747A7-4AC4-4EB4-AAC2-419C09ACE1E9" title="检索当前命令的资源名称。">clsagfw_get_resource_name()</a></code> API。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21" name="GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21"></a><h4 id="CWADD-GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21" class="sect4">clsagfw_init（）</h4>
                  <div>
                     <p>初始化代理框架。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21__GUID-830E1A20-5C7A-4930-8BE1-3FF37DCE3457">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_init（sb4 argc，oratext ** argv，ub4 flags，const oratext * logName，void * reserved）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21__GUID-1F27FCF8-D3DD-4589-9D3F-7FBE6801A212">输入</p>
                        <p><code class="codeph">argc</code> ：传递给代理进程的命令行参数的数量</p>
                        <p><code class="codeph">argv</code> ：传递给代理进程的命令行参数</p>
                        <p><code class="codeph">flags</code> ：</p>
                        <p><code class="codeph">logName</code> ：此代理的日志文件的名称</p>
                        <p><code class="codeph">reserved</code> ：传递NULL</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-87A74224-9BCA-41F8-90AB-6B17D93C6A21__GUID-A5CBA3CA-46D9-40F4-B9E9-AB1D8BB85CD1">使用说明</p>
                        <p>当必须对资源执行操作时，Oracle Clusterware会自动启动为资源配置的代理。在启动时，代理进程首先调用此函数以初始化代理框架运行时。必须将Oracle Clusterware服务器传递给代理进程的命令行参数传递给<code class="codeph">clsagfw_init()</code> 。初始化完成后，代理可以注册由代理管理的资源类型。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7" name="GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7"></a><h4 id="CWADD-GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7" class="sect4">clsagfw_is_cmd_timedout（）</h4>
                  <div>
                     <p>返回ABORT入口点的原因。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7__GUID-58CBCE73-26BA-425A-9601-372C3C8313B3">句法</p><pre class="pre codeblock"><code>bool clsagfw_is_cmd_timedout（const clsagfw_aectx * pAeCtx）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7__GUID-B60F40B6-FB79-4455-8645-067851ADB096">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B0D795A7-493E-42F8-8416-0EE6A19244B7__GUID-1EC4E16D-4EA0-44C4-A401-8D60A175B66E">使用说明</p>
                        <p>代理可以在ABORT入口点中使用此函数来标识ABORT入口点调用的原因。如果命令执行时间超过其超时值，或者Oracle Clusterware管理员中止命令，则可以调用ABORT入口点。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4" name="GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4"></a><h4 id="CWADD-GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4" class="sect4">clsagfw_log（）</h4>
                  <div>
                     <p>将诊断消息打印到代理日志文件。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4__GUID-E50403F5-885B-47EA-B217-94C80018865E">句法</p><pre class="pre codeblock"><code>void clsagfw_log（const clsagfw_aectx * pAeCtx，const ub4 log_level，const oratext * fmtp，...）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4__GUID-442FD625-6F8B-47ED-BFC2-6538D3260740">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给用户入口点的代理框架上下文</p>
                        <p><code class="codeph">log_level</code> ：消息的日志级别，取值范围为1-5</p>
                        <p><code class="codeph">fmtp</code> ：消息格式字符串，根据标准C库打印规范</p>
                        <p><code class="codeph">...</code> ：与格式字符串对应的变量参数</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9B6E15B5-D6CC-4125-9F61-64DF59410DA4__GUID-882A5145-292A-4C1A-9670-D73DBF2009FE">使用说明</p>
                        <p>代理程序调用此函数来记录有助于调试和理解代理程序执行的诊断消息。您可以使用<code class="codeph">LOG_LEVEL</code>参数来控制日志消息的数量。您可以使用CRSCTL配置资源的当前日志记录级别，如下所示：</p><pre class="oac_no_warn" dir="ltr">$ crsctl设置日志级别res“myResource1 = 3”</pre><p>错误将记录到<code class="codeph">TODO</code>目录中的代理日志文件中。默认情况下，日志文件的名称与代理可执行文件名称相同。您可以通过将<code class="codeph">logName</code>参数传递给<code class="codeph">clsagfw_init()</code> API来更改此设置。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B" name="GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B"></a><h4 id="CWADD-GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B" class="sect4">clsagfw_modify_attribute（）</h4>
                  <div>
                     <p>修改当前资源的属性。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B__GUID-4E37C94D-1B64-431F-8F5C-2DF9B025AA67">句法</p><pre class="pre codeblock"><code>void clsagfw_modify_attribute（const clsagfw_aectx * pAeCtx，const oratext * pAttrName，const oratext * pAttrValue）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B__GUID-B7FC4F29-F09C-49BF-BBEA-7679DFF1818D">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                        <p><code class="codeph">pAttrName</code> ：要修改的属性的名称</p>
                        <p><code class="codeph">pAttrValue</code> ：属性的新值</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-53EAECD0-2E3A-4551-A21F-69BFEA734D8B__GUID-115E72C1-2574-41FD-8AC3-26E806B3E0FF">使用说明</p>
                        <p>代理可以通过调用此API来修改当前命令资源的属性值。资源修改请求将发送到Oracle Clusterware服务器进行验证，更新后的属性值仅在Oracle Clusterware服务器确认后才会反映在代理中。此功能只能从START，STOP和CLEAN入口点调用。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B" name="GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B"></a><h4 id="CWADD-GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B" class="sect4">clsagfw_reset_attr_iterator（）</h4>
                  <div>
                     <p>重置属性迭代器。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B__GUID-80222244-D1F1-49EF-B1EF-038562F0024C">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_reset_attr_iterator（const clsagfw_aectx * pAeCtx，clsagfw_ai_flags flags）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B__GUID-29903647-2101-4BDE-8A48-618E86B56CE4">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                        <p><code class="codeph">flags</code> ：要访问的属性：</p>
                        <p>            <code class="codeph">CLSAGFW_ALL_ATTRS</code> ：资源的所有属性</p>
                        <p>            <code class="codeph">CLSAGFW_MODIFIED_ATTRS</code> ：仅修改属性</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-507370BC-58AC-4FD2-BAE0-1AE092B1B14B__GUID-B970722B-C935-4200-BB34-0E964433C269">使用说明</p>
                        <p>此函数重置代理框架上下文中的迭代器，以便代理可以重新启动属性导航。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-BCB22E7E-D21C-445E-A253-3B099331304B" name="GUID-BCB22E7E-D21C-445E-A253-3B099331304B"></a><h4 id="CWADD-GUID-BCB22E7E-D21C-445E-A253-3B099331304B" class="sect4">clsagfw_send_status2（）</h4>
                  <div>
                     <p>向Oracle Clusterware服务器和用户报告进度，警告和错误消息。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-BCB22E7E-D21C-445E-A253-3B099331304B__GUID-F9841C4E-0F6D-47F4-88C6-B78BF90E6ACB">句法</p><pre class="pre codeblock"><code>void clsagfw_send_status2（const clsagfw_aectx * pAeCtx，const oratext * pResId，clsagfw_status_type type，const oratext * fmtp，...）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BCB22E7E-D21C-445E-A253-3B099331304B__GUID-8E98061F-4C6F-498C-A66D-6F121F9B4638">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                        <p><code class="codeph">pResId</code> ：报告消息的资源</p>
                        <p><code class="codeph">type</code> ：以下类型的消息之一：</p>
                        <p>          <code class="codeph">CLSAGFW_STATUS_PROGRESS</code> ：进度消息</p>
                        <p>          <code class="codeph">CLSAGFW_STATUS_WARNING</code> ：警告消息</p>
                        <p>          <code class="codeph">CLSAGFW_STATUS_ERROR</code> ：错误消息</p>
                        <p><code class="codeph">fmtp</code> ：消息格式字符串</p>
                        <p><code class="codeph">...</code> ：与消息格式字符串中的位置对应的变量</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BCB22E7E-D21C-445E-A253-3B099331304B__GUID-4C70A852-8960-4C90-8326-BDC73F17BC36">使用说明</p>
                        <p>在执行命令期间，代理可以向Oracle Clusterware服务器和执行资源操作的用户发送信息性消息。这些消息可以告知您执行进度以及是否有任何警告或错误。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C" name="GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C"></a><h4 id="CWADD-GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C" class="sect4">clsagfw_set_cookie（）</h4>
                  <div>
                     <p>在代理框架中存储cookie及其值。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C__GUID-BBAE0B51-155D-4E6A-864B-AD3C14EE1525">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfwret clsagfw_set_cookie（const oratext * key，const void * value）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C__GUID-509982C0-7D1E-47A1-80E9-FD4C12F52DF0">输入</p>
                        <p><code class="codeph">key</code> ：cookie的键，以null结尾的字符串</p>
                        <p><code class="codeph">Value</code> ：指向要存储的cookie值的指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-EAA6711F-A7E8-453D-B3DE-3711461CC31C__GUID-0117165C-9C1B-4756-81AB-9ECE22099480">使用说明</p>
                        <p>稍后可以通过调用<code class="codeph">clsagfw_get_cookie()</code>来检索保存的cookie的值。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842" name="GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842"></a><h4 id="CWADD-GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842" class="sect4">clsagfw_set_entrypoint（）</h4>
                  <div>
                     <p>设置要对资源上的特定操作执行的C / C ++入口点函数。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842__GUID-0C202471-EAF2-4645-B21E-9F62501EBCFD">句法</p><pre class="pre codeblock"><code>void clsagfw_set_entrypoint（const oratext * type_name，clsagfw_action_entry action_entry，clsagfw_aecode action_entrycode）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842__GUID-BFD50C9B-9B22-4C48-BD5B-ED462FBAA618">输入</p>
                        <p><code class="codeph">key</code> ：cookie的键，以null结尾的字符串</p>
                        <p><code class="codeph">Value</code> ：指向要存储的cookie值的指针</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FC4CAD-F6AF-4030-8C3C-CFC92C9A9842__GUID-187506C8-CFFC-4A4B-90DE-54F8CD2B19C6">使用说明</p>
                        <p>稍后可以通过调用<code class="codeph">clsagfw_get_cookie()</code>来检索保存的cookie的值。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C" name="GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C"></a><h4 id="CWADD-GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C" class="sect4">clsagfw_set_exitcb（）</h4>
                  <div>
                     <p>注册代理进程退出时要调用的函数。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C__GUID-83430690-2C2B-49E3-B715-F47E565490E8">句法</p><pre class="pre codeblock"><code>typedef void（* clsagfw_exit_callback）（sb4 exitCode）; void clsagfw_set_exitcb（clsagfw_exit_callback exit_func）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C__GUID-CA8ECBB8-7996-43A0-8776-7EC9BE638C13">输入</p>
                        <p><code class="codeph">exit_func</code> ：代理进程退出时要调用的函数</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4FE4ECFB-2712-4D6A-933A-CE0737F4559C__GUID-61A162D6-0117-4BD0-99E8-59335027C130">使用说明</p>
                        <p>当代理框架终止代理进程时，代理可以注册要调用的回调函数。回调函数可以执行代理实例化的任何内部资源的正确清理。如果代理进程正在退出以从无法恢复的错误中恢复，则Oracle Clusterware服务器不会重新启动代理，直到旧的化身退出为止。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841" name="GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841"></a><h4 id="CWADD-GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841" class="sect4">clsagfw_set_resource_state_label（）</h4>
                  <div>
                     <p>在当前资源上设置自定义标签。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841__GUID-E03F333F-A299-406D-AE2A-41B4721B6D2C">句法</p><pre class="pre codeblock"><code>void clsagfw_set_resource_state_label（const clsagfw_aectx * pAeCtx，const oratext * pLabel）;</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841__GUID-36BF0255-AD42-4E5F-9A01-0CDE4F980918">输入</p>
                        <p><code class="codeph">pAeCtx</code> ：传递给入口点的代理框架上下文指针</p>
                        <p><code class="codeph">pLabel</code> ：与资源关联的标签，以null结尾的字符串</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B6065249-F1B5-4D12-B26B-EDA24CFCB841__GUID-394FD817-7B85-4890-B3CB-B43FE4DA8D98">使用说明</p>
                        <p>代理可以使用此功能设置与资源状态关联的描述性标签。此标签在资源的<code class="codeph">STATE_DETAILS</code>属性中报告。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-800B6FFF-3807-47E2-8239-92C293D1E385" name="GUID-800B6FFF-3807-47E2-8239-92C293D1E385"></a><h4 id="CWADD-GUID-800B6FFF-3807-47E2-8239-92C293D1E385" class="sect4">clsagfw_startup（）</h4>
                  <div>
                     <p>启动代理框架。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-800B6FFF-3807-47E2-8239-92C293D1E385__GUID-D1ACD077-3DD3-4219-B43D-49DC90AE2061">句法</p><pre class="pre codeblock"><code>clsagfwret clsagfw_startup（void）</code></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-800B6FFF-3807-47E2-8239-92C293D1E385__GUID-6A1E87A4-F587-4D68-AC46-FC72C5EE0D5E">使用说明</p>
                        <p>初始化代理框架并注册资源类型及其入口点后，代理将调用此API以启动代理框架，然后启动多线程基础结构以监视资源并对其执行操作。</p>
                        <p>成功时，此函数永远不会返回到调用线程。当需要时，代理框架线程将调用资源操作的入口点。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="CWADD92533"></a><a id="CWADD92532"></a><div class="sect2"><a id="GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9" name="GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9"></a><h3 id="CWADD-GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9" class="sect3">代理示例</h3>
               <div>
                  <p><a href="oracle-clusterware-agent-framework-c-application-program-interfaces.html#GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9__CACDAJEB">示例H-1</a>详述了用于管理表示文件的资源的代理实现。
                  </p>
                  <div class="example" id="GUID-DD78FC7D-82CB-4783-8DAF-1DC1FD7EFAE9__CACDAJEB">
                     <p class="titleinexample">示例H-1 demoagent1.cpp</p><pre class="oac_no_warn" dir="ltr">/ *版权所有（c）2004,2012，Oracle和/或其附属公司。版权所有。* / / * * NAME * Demoagent1.cpp：演示代理监视文件* * DESCRIPTION *这是一个演示代理来监视文件的示例程序。代理具有以下任务：*  - 启动时：创建文件。*  - 关闭时：删除文件。*  -  On check命令：检测文件是否存在。*  - 关于清除命令：删除文件。*此程序可用作构建更复杂*代理的基础，以管理现实资源。* #include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;clsagfw.h&gt;</pre></div>
                  <!-- class="example" -->
                  <p>包括代理框架<code class="codeph">clsagfw.h</code>头文件。
                  </p><pre class="oac_no_warn" dir="ltr">#define TEST_TYPE1（oratext *）“HOTFILE_TYPE”#define TEST_PATHNAME_ATTR（oratext *）“PATH_NAME”/ * * NAME * test_agent_exit * DESCRIPTION *清理的功能，每当代理*进程即将终止时由框架调用* PARAMS * exitCode ，这是描述退出原因的sb4。* RETURNS * void * / void test_agent_exit（sb4 exitCode）{clsagfw_log（NULL，1，（oratext *）“Demo Agent正在退出.. \ n”）; }</pre><p>退出与代理框架注册的回调函数。</p><pre class="oac_no_warn" dir="ltr">/ * * NAME * type1_start * DESCRIPTION *'start'命令的操作入口点。为* monitoring创建文件。* PARAMS *指向代理框架上下文的指针* RETURNS * ub4，可以是CLSAGFW_AE_FAIL或CLSAGFW_AE_SUCCESS *，具体取决于操作是失败还是成功。* / ub4 type1_start（const clsagfw_aectx * ectx）{ub4 ret = CLSAGFW_AE_FAIL; const oratext * pResName = NULL; const oratext * pPathName = NULL; FILE * fp; clsagfw_log（ectx，1，（oratext *）“Start action called ..”）; / *尝试读取资源名称* / if（clsagfw_get_attrvalue（ectx，（oratext *）“NAME”，＆pResName）！= CLSAGFW_SUCCESS）{goto done; / / *尝试读取PATH_NAME属性* / if（clsagfw_get_attrvalue（ectx，TEST_PATHNAME_ATTR，＆pPathName）！= CLSAGFW_SUCCESS）{goto done; }</pre><p>使用<code class="codeph">clsagfw_get_attrvalue()</code>检索资源名称和<code class="codeph">PATH_NAME</code>属性的值。
                  </p><pre class="oac_no_warn" dir="ltr">clsagfw_log（ectx，1，（oratext *）“启动操作参数：resName =％s，pathName =％s”，pResName，pPathName）; / *尝试创建文件* / fp = fopen（（char *）pPathName，“w”）;如果（！fp）{/ *无法创建文件* / clsagfw_log（ectx，1，（oratext *）“资源％s的START操作：FAILED \ n”，pResName）; ret = CLSAGFW_AE_FAIL; } else {/ *成功创建文件* / clsagfw_log（ectx，1，（oratext *）“资源％s的START操作：SUCCESS \ n”，pResName）; ret = CLSAGFW_AE_SUCCESS; FCLOSE（FP）;完成：返回ret; }</pre><p>通过调用<code class="codeph">clsagfw_log()</code>将诊断和错误消息记录到代理程序日志文件中。
                  </p><pre class="oac_no_warn" dir="ltr">/ * * NAME * type1_stop * DESCRIPTION *'stop'和'clean'命令的动作入口点。删除*正在监视的文件。* PARAMS *指向代理框架上下文的指针* RETURNS * ub4，可以是CLSAGFW_AE_FAIL或CLSAGFW_AE_SUCCESS *，具体取决于操作是失败还是成功。* / ub4 type1_stop（const clsagfw_aectx * ectx）{ub4 ret = CLSAGFW_AE_FAIL; const oratext * pResName = NULL; const oratext * pPathName = NULL; clsagfw_log（ectx，1，（oratext *）“停止动作调用..”）; / *尝试读取资源名称* / if（clsagfw_get_attrvalue（ectx，（oratext *）“NAME”，＆pResName）！= CLSAGFW_SUCCESS）{clsagfw_log（ectx，1，（oratext *）“STOP动作：％s：无法读取属性\ n”，pResName）;完成; / / *尝试读取PATH_NAME属性* / if（clsagfw_get_attrvalue（ectx，TEST_PATHNAME_ATTR，＆pPathName）！= CLSAGFW_SUCCESS）{pPathName = pResName; } clsagfw_log（ectx，1，（oratext *）“停止动作参数：resName =％s，pathName =％s”，pResName，pPathName）; / *尝试删除文件* / if（remove（（char *）pPathName））{/ *无法删除文件* / clsagfw_log（ectx，1，（oratext *）“资源％s的停止操作：FAILED \ n“，pResName）; ret = CLSAGFW_AE_FAIL; } else {/ *成功删除文件* / clsagfw_log（ectx，1，（oratext *）“资源％s的停止操作：SUCCESS \ n”，pResName）; ret = CLSAGFW_AE_SUCCESS;完成：返回ret; } / * * NAME * type1_check * DESCRIPTION *'check'命令的操作入口点。确定*文件是否存在。* PARAMS *指向代理框架上下文的指针。* RETURNS * ub4，它给出了资源的状态。有关此函数的*返回代码的详细信息，请查看*代理框架参考。* / ub4 type1_check（const clsagfw_aectx * ectx）{ub4 ret = CLSAGFW_UNKNOWN; const oratext * pResName = NULL; const oratext * pPathName = NULL; FILE * fp; clsagfw_log（ectx，1，（oratext *）“检查动作叫......”）; / *尝试读取资源名称* / if（clsagfw_get_attrvalue（ectx，（oratext *）“NAME”，＆pResName）！= CLSAGFW_SUCCESS）{goto done; / / *尝试读取PATH_NAME属性* / if（clsagfw_get_attrvalue（ectx，TEST_PATHNAME_ATTR，＆pPathName）！= CLSAGFW_SUCCESS）{clsagfw_log（ectx，1，（oratext *）“CHECK action：％s：无法读取属性\ n”，pResName）;完成; } clsagfw_log（ectx，1，（oratext *）“检查操作参数：resName =％s，pathName =％s”，pResName，pPathName）; / *检查文件是否可访问* / fp = fopen（（char *）pPathName，“r”）;如果（！fp）{/ *无法打开文件* / clsagfw_log（ectx，1，（oratext *）“检查操作：％s状态 -  UNPLANNED_OFFLINE \ n”，pResName）; ret = CLSAGFW_UNPLANNED_OFFLINE; } else {/ *打开文件成功* / clsagfw_log（ectx，1，（oratext *）“检查操作：％s状态 -  ONLINE \ n”，pResName）; FCLOSE（FP）; ret = CLSAGFW_ONLINE;完成：返回ret; / * *代理框架的初始化和类型的注册是在main中完成的。* / int main（sb4 argc，oratext ** argv）{clsagfw_log（NULL，1，（oratext *）“***代理框架演示代理已启动*** \ n”）; / * *初始化代理框架* / if（clsagfw_init（argc，argv，0，NULL，0）！= CLSAGFW_SUCCESS）{clsagfw_log（NULL，1，（oratext *）“无法初始化代理框架\ n”）; clsagfw_exit（-1）; } / * *设置退出回调函数* / clsagfw_set_exitcb（test_agent_exit）; / * *将类型定义添加到框架* / if（clsagfw_add_type（TEST_TYPE1）！= CLSAGFW_SUCCESS）{clsagfw_log（NULL，1，（oratext *）“将类型％s添加到框架中失败\ n”，TEST_TYPE1）; clsagfw_exit（-1）; } / * *设置HOTFILE_TYPE * / clsagfw_set_entrypoint的所有入口点（TEST_TYPE1，type1_start，CLSAGFW_ACTION_START）; clsagfw_set_entrypoint（TEST_TYPE1，type1_stop，CLSAGFW_ACTION_STOP）; clsagfw_set_entrypoint（TEST_TYPE1，type1_check，CLSAGFW_ACTION_CHECK）; clsagfw_set_entrypoint（TEST_TYPE1，type1_stop，CLSAGFW_ACTION_CLEAN）; clsagfw_log（NULL，1，（oratext *）“向代理框架添加资源类型[％s] \ n”，TEST_TYPE1）; / * *全部设置为，启动框架。如果框架成功启动，则此函数不会返回。* / clsagfw_startup（）; / ***未达到** /返回0; }</pre></div>
            </div>
         </div>
      </article>
   </body>
</html><html id="00380.getting-started-with-database-administration.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This chapter provides a brief roadmap for administering your database. It introduces you to Oracle Enterprise Manager Database Express (EM Express), the Web-based interface for managing an Oracle database."></meta>
      <meta name="description" content="This chapter provides a brief roadmap for administering your database. It introduces you to Oracle Enterprise Manager Database Express (EM Express), the Web-based interface for managing an Oracle database."></meta>
      <title>数据库管理入门</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="2 Day DBA"></meta>
      <meta property="og:description" content="This chapter provides a brief roadmap for administering your database. It introduces you to Oracle Enterprise Manager Database Express (EM Express), the Web-based interface for managing an Oracle database."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="2 Day DBA"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="2-day-dba.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-23T23:13:13-07:00"></meta>
      <meta name="dcterms.title" content="2 Day DBA"></meta>
      <meta name="dcterms.dateCopyrighted" content="2004, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96197-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="installing-oracle-database-creating-database.html" title="Previous" type="text/html"></link>
      <link rel="next" href="configuring-the-network-environment.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADMQS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="installing-oracle-database-creating-database.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="configuring-the-network-environment.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">2天DBA</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">数据库管理入门</li>
            </ol>
            <a id="GUID-2BF9BB16-53C9-4E40-952D-774FEA514335" name="GUID-2BF9BB16-53C9-4E40-952D-774FEA514335"></a><a id="ADMQS003"></a>
            
            <h2 id="ADMQS-GUID-2BF9BB16-53C9-4E40-952D-774FEA514335" class="sect2"><span class="enumeration_chapter">3</span>数据库管理入门</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='getting-started-with-database-administration'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>本章提供了管理数据库的简要路线图。它向您介绍了Oracle Enterprise Manager Database Express（EM Express），这是用于管理Oracle数据库的基于Web的界面。</p>
               <p>本章包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="getting-started-with-database-administration.html#GUID-C30ACE99-853A-43FB-A628-FC65E034B67D" title="本节概述了管理Oracle数据库实例所涉及的任务。本指南中的每一章都详细介绍了不同的任务。">管理数据库：概述</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-database-administration.html#GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2" title="在使用访问Oracle数据库的某些工具（例如SQL * Plus）之前，必须为操作系统配置环境变量。Oracle数据库使用这些环境变量来确定工具应连接的数据库实例。">配置操作系统环境变量</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-database-administration.html#GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA" title="EM Express是一个基于Web的数据库管理工具，它构建在Oracle数据库中。它支持关键性能管理和基本数据库管理功能。">Oracle Enterprise Manager Database Express简介</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-database-administration.html#GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923" title="您可以使用Oracle Enterprise Manager Database Express（EM Express）来管理非CDB，多租户容器数据库（CDB）和可插拔数据库（PDB）。EM Express使用HTTPS端口连接和管理非CDB，CDB和PDB。">启动EM Express</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-database-administration.html#GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" title="仅当数据库配置助手（DBCA）在配置数据库或可插拔数据库（PDB）时未向您提供Oracle Enterprise Manager Database Express（EM Express）URL或者您需要更改时，才需要执行本节中的步骤稍后是EM Express端口。">为EM Express配置HTTPS端口</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-database-administration.html#GUID-638AB4AB-27B5-4C00-8EA4-ACCDE0C985F5" title="除了使用EM Express监视和管理本地Oracle数据库之外，您还可以使用EM Express来管理Oracle数据库云服务（DBCS）数据库部署。">关于EM Express和数据库云服务部署</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-database-administration.html#GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4" title="Database Home页面是Oracle Enterprise Manager Database Express（EM Express）中的主数据库管理页面。">访问数据库主页</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-database-administration.html#GUID-E01797C6-B9D5-4124-BF24-092CE93F34B9" title="作为数据库管理员，您可以使用SYS或SYSTEM用户帐户登录Oracle Enterprise Manager Database Express（EM Express）以执行管理和其他任务。非管理用户可能还希望登录EM Express。">授予非管理用户访问EM Express的权限</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-database-administration.html#GUID-ADF47AF3-3546-4AC4-9D6B-E3F54B35FF6F" title="除了使用Oracle Enterprise Manager Database Express（EM Express）中提供的图形用户界面（GUI）页面之外，您还可以使用其他Oracle工具（如SQL Developer和SQL * Plus）来管理数据库。">使用基于SQL的管理工具管理数据库</a></p>
                  </li>
                  <li>
                     <p><a href="getting-started-with-database-administration.html#GUID-90D9A35A-8A40-4205-9C10-BB49BEF72A0B" title="Oracle示例（OBE）有一系列关于Oracle Database 2 Day DBA指南的系列文章。本OBE将引导您完成本章中的任务，并包含带注释的屏幕截图。">数据库管理入门：Oracle示例系列</a></p>
                  </li>
               </ul>
            </div><a id="ADMQS12132"></a><a id="ADMQS037"></a><div class="props_rev_3"><a id="GUID-C30ACE99-853A-43FB-A628-FC65E034B67D" name="GUID-C30ACE99-853A-43FB-A628-FC65E034B67D"></a><h3 id="ADMQS-GUID-C30ACE99-853A-43FB-A628-FC65E034B67D" class="sect3"><span class="enumeration_section">3.1</span>管理数据库：概述</h3>
               <div>
                  <p>本节概述了管理Oracle数据库实例所涉及的任务。本指南中的每一章都详细介绍了不同的任务。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-C30ACE99-853A-43FB-A628-FC65E034B67D__GUID-B7B7FECE-F418-4F08-9F23-1973A8BDB5A3">要管理Oracle数据库：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>启动数据库实例。</span><div>
                           <p>安装后，您的实例将启动并且您的数据库已打开。在将来，有时可能会进行数据库维护或因电源或介质故障而关闭数据库实例并稍后重新启动它。</p>
                           <p>请参阅<span class="q">“ <a href="managing-the-oracle-instance.html#GUID-C2CFFCE3-95F7-4D3D-B388-294DBBF25793" title="本节提供有关可用于启动或关闭Oracle实例的两种方法的说明。">关闭并启动Oracle实例</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>（可选）配置网络环境以使客户端能够连接到您的数据库。</span><div>
                           <p>请参阅<span class="q">“ <a href="configuring-the-network-environment.html#GUID-C6DD213A-D37E-4905-983D-F9DCA8AE286A" title="本章帮助您配置客户端/服务器网络。">配置网络环境</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>检查数据库存储结构：表空间和数据文件，联机重做日志文件和控制文件。根据需要创建或修改存储结构。</span><div>
                           <p>请参阅<span class="q">“ <a href="managing-database-storage-structures.html#GUID-1C4BBF52-BBD8-4F37-92DD-80D414A75B59" title="本章讨论使用Oracle Enterprise Manager Database Express（EM Express）查看和管理数据库的存储结构。">管理数据库存储结构</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>检查内存分配并根据需要进行调整。</span><div>
                           <p>请参阅<span class="q">“ <a href="managing-the-oracle-instance.html#GUID-8BDFF6EB-2EDE-4307-9393-D159E2F1E84F" title="本节提供有关管理Oracle实例内存的背景信息，并包含有关如何调整Oracle实例的内存分配的说明。">管理内存</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>根据需要查看，解锁和重置预定义数据库用户的密码。创建新用户，并为其分配权限和角色。</span><div>
                           <p>请参阅<span class="q">“ <a href="administering-user-accounts-and-security.html#GUID-7FC1D8BE-4BB9-4642-A4CE-29CD2B8A5F23" title="本章介绍如何使用Oracle Enterprise Manager Database Express（EM Express）创建和管理用户帐户。">管理用户帐户和安全性</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>创建必要的架构对象，包括表，视图和索引。使用数据填充表格。</span><div>
                           <p>请参阅<span class="q">“ <a href="managing-schema-objects.html#GUID-F11F80CE-A94A-4459-ABA7-0B1E5A16ADE2" title="本章讨论使用SQL Developer创建和管理模式对象。">管理架构对象</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>创建或查看数据库的备份策略并备份数据库。</span><div>
                           <p>请参阅<span class="q">“ <a href="performing-backup-and-recovery.html#GUID-C6EEB732-9548-4814-8558-8B903DD74759" title="本章将向您介绍使用Oracle Recovery Manager（RMAN）进行Oracle数据库备份和恢复。阅读本章后，您应熟悉Oracle数据库备份和恢复操作的基本概念，了解如何实施基于磁盘的备份策略，以及对数据库文件执行简单修复。">执行备份和恢复</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>启用在线重做日志文件的归档（如果尚未完成）。</span><div>
                           <p>请参阅<span class="q">“ <a href="performing-backup-and-recovery.html#GUID-192720EF-64C7-465B-982A-F8AABFD81DC1">配置恢复设置</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>监视数据库性能，诊断性能问题，并根据需要调整数据库。</span><div>
                           <p>请参阅<span class="q">“ <a href="monitoring-and-tuning-the-database.html#GUID-95716F9A-C500-4CCD-AC3F-6541E3191E40" title="监视数据库的性能并确保其以最佳状态执行是数据库管理员的一项重要任务。本章讨论Oracle数据库中包含的特性和功能，这些特性和功能可以轻松监控数据库运行状况，识别性能问题并实施任何纠正措施。">监视和调整数据库</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>使用最新版本使Oracle数据库软件保持最新。</span><div>
                           <p>请参阅<span class="q">“ <a href="managing-oracle-database-software.html#GUID-04A112C8-5A4E-4DEE-9D95-7B8F6BF5514C" title="本章介绍如何使Oracle数据库软件保持最新。">管理Oracle数据库软件</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                  </ol>
               </div>
            </div><a id="ADMQS12370"></a><a id="ADMQS12371"></a><a id="ADMQS12369"></a><div class="props_rev_3"><a id="GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2" name="GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2"></a><h3 id="ADMQS-GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2" class="sect3"><span class="enumeration_section">3.2</span>配置操作系统环境变量</h3>
               <div>
                  <p>在使用访问Oracle数据库的某些工具（例如SQL * Plus）之前，必须为操作系统配置环境变量。Oracle数据库使用这些环境变量来确定工具应连接的数据库实例。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2__GUID-C13BE538-F4E4-4D1E-B71E-91F378BA8A20">要在Linux和UNIX系统上为数据库实例配置操作系统环境变量：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ol>
                        <li>
                           <p>打开操作系统命令窗口。</p>
                        </li>
                        <li>
                           <p>确保正确设置了环境变量<code class="codeph">ORACLE_HOME</code>和<code class="codeph">ORACLE_SID</code> 。用于设置这些环境变量的命令取决于用于与操作系统连接的shell。例如：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>（bash或ksh） <code class="codeph">export ORACLE_SID=orcl</code></p>
                              </li>
                              <li>
                                 <p>（csh或tcsh） <code class="codeph">setenv ORACLE_SID orcl</code></p>
                              </li>
                           </ul>
                           <p>您可以使用脚本<code class="codeph">coraenv</code> （对于C shell）和<code class="codeph">oraenv</code> （对于其他shell）来设置它们。这些脚本通常位于<code class="codeph">/usr/local/bin</code>目录中。
                           </p>
                        </li>
                        <li>
                           <p>确保<code class="codeph">$ORACLE_HOME/bin</code>目录位于<code class="codeph">PATH</code>环境变量中。
                           </p>
                        </li>
                        <li>
                           <p>您还可以在软件所有者的主目录中编辑默认shell的配置文件，例如<code class="codeph">/home/oracle</code> ，以便每次以该用户身份登录时都会设置这些环境变量。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2__GUID-0C530373-E3C7-4035-915B-4276FF2233CB">在Windows系统上为数据库实例配置操作系统环境变量：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>打开操作系统命令窗口。</span></li>
                     <li class="stepexpand"><span>使用<code class="codeph">regedit</code>确保将<code class="codeph">ORACLE_HOME</code>和<code class="codeph">ORACLE_SID</code>参数设置为<code class="codeph">HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE\KEY_HOME_NAME</code>注册表子项中的正确值。</span></li>
                     <li class="stepexpand"><span>确保<code class="codeph">%ORACLE_HOME%\bin</code>目录位于<code class="codeph">PATH</code>环境变量中。在命令提示符处，使用类似于以下内容的命令：</span><div><pre class="oac_no_warn" dir="ltr">设置PATH =％ORACLE_HOME％\ bin;％PATH％</pre></div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2__GUID-651FE8FB-79DA-4CD3-81A2-73DFA251F1CF">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关设置环境变量的更多信息，请<a href="../unxar/administering-oracle-database.html#UNXAR001" target="_blank"><span><cite>参见适用于Linux和基于UNIX的操作系统的Oracle数据库管理员参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关修改注册表项的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/admqs&amp;id=NTQRF180" target="_blank"><span><cite>参见Microsoft Windows的Oracle数据库管理员参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADMQS12308"></a><a id="ADMQS12310"></a><a id="ADMQS031"></a><div class="props_rev_3"><a id="GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA" name="GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA"></a><h3 id="ADMQS-GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA" class="sect3"><span class="enumeration_section">3.3</span> Oracle Enterprise Manager Database Express简介</h3>
               <div>
                  <div><span>EM Express是一个基于Web的数据库管理工具，它构建在Oracle数据库中。它支持关键性能管理和基本数据库管理功能。</span> 从体系结构的角度来看，EM Express没有中间层或中间件组件，确保其在数据库服务器上的开销可以忽略不计。
                  </div>
                  <p>运用<a id="d9663e453" class="indexterm-anchor"></a> EM Express，您可以执行管理任务，例如管理用户安全性和管理数据库内存和存储。您还可以查看有关数据库的性能和信息。
                  </p>
                  <p>EM Express仅在数据库打开时可用。这意味着EM Express不能用于启动数据库。其他需要数据库更改状态的操作（例如启用或禁用ARCHIVELOG模式）在EM Express中也不可用。</p>
                  <div class="infoboxnote" id="GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA__GUID-F6C4F908-26FE-4010-8633-B5B02CA63EAC">
                     <p class="notep1">注意：</p>
                     <p>根据行业标准，Oracle正在弃用基于Flash的Oracle Enterprise Manager Express（Oracle EM Express）。从Oracle Database 19c开始，Oracle EM Express是Oracle数据库的默认管理选项，它基于Java JET技术。在此初始版本中，基于Flash的Oracle EM Express中有一些选项在JET版本中不可用。如有必要，请使用以下命令恢复为Flash Oracle EM Express：</p><pre class="pre codeblock"><code>SQL&gt; @？/ rdbms / admin / execemx emx</code></pre><p>要返回JET Oracle EM Express，请使用以下命令：</p><pre class="pre codeblock"><code>SQL&gt; @？/ rdbms / admin / execemx omx</code></pre></div>
                  <div class="infoboxnote" id="GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA__GUID-78AA9A75-6452-4B13-89D9-8C4E74AD0DFB">
                     <p class="notep1">注意：</p>
                     <p>Oracle Database 12 <span class="italic">c中</span>不再提供企业管理器数据库控制。您可以使用Enterprise Manager Cloud Control 12 <span class="italic">c</span>或EM Express 12 <span class="italic">c</span>来管理Oracle Database 12 <span class="italic">c</span>数据库。
                     </p>
                     <p>Enterprise Manager Cloud Control支持Oracle Database 12 <span class="italic">c</span>目标，包括多租户<a id="d9663e489" class="indexterm-anchor"></a><a id="d9663e493" class="indexterm-anchor"></a>容器数据库（CDB），可插拔数据库（PDB），非CDB，Oracle Real Application Clusters（Oracle RAC）数据库和Oracle自动存储管理（Oracle ASM）数据库。
                     </p>
                     <p>有关CDB和PDB的介绍，请参阅“ <a href="../multi/introduction-to-the-multitenant-architecture.html#CNCPT89234" target="_blank"><span><cite>Oracle Multitenant管理员指南</cite></span></a> <a href="../multi/managing-a-multitenant-environment.html#ADMIN13506" target="_blank"><span><cite>”</cite></span></a> ;有关管理CDB和PDB的信息，请参阅“ <a href="../multi/introduction-to-the-multitenant-architecture.html#CNCPT89234" target="_blank"><span><cite>Oracle Realitenant管理员指南</cite></span></a> <a href="../racad/introduction-to-oracle-rac.html#RACAD1111" target="_blank"><span><cite>”</cite></span></a> ;有关Oracle RAC数据库的更多信息，请参阅<a href="../racad/introduction-to-oracle-rac.html#RACAD1111" target="_blank"><span><cite>“Oracle Real Application Management管理和部署指南”;</cite></span></a>有关更多信息，请参阅“ <a href="../ostmg/asm-intro.html#OSTMG036" target="_blank"><span><cite>Oracle自动存储管理管理员指南</cite></span></a> ”有关Oracle ASM数据库的信息。
                     </p>
                  </div>
                  <p>您可以针对非CDB，CDB，PDB或Oracle RAC数据库实例使用下面描述的企业管理器Database Express功能。</p>
                  <p>组态：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>初始化参数（init.ora）管理</p>
                     </li>
                     <li>
                        <p>内存管理</p>
                     </li>
                     <li>
                        <p>数据库功能用法</p>
                     </li>
                     <li>
                        <p>数据库属性</p>
                     </li>
                  </ul>
                  <p>存储：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>表空间管理</p>
                     </li>
                     <li>
                        <p>撤消管理<a id="GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA__CACFEJIB" name="GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA__CACFEJIB" href="#GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA__CACFEJIB" in="" a="" cdb,="" this="" feature="" is="" available="" for="" the="" cdb="" only,="" not="" individual="" pdbs=")" ="" onclick="footdisplay(1, "><sup>脚1</sup></a></p>
                     </li>
                     <li>
                        <p>重做管理<a id="fnsrc_d9663e556" name="fnsrc_d9663e556" href="#fnsrc_d9663e556" in="" a="" cdb,="" this="" feature="" is="" available="" for="" the="" cdb="" only,="" not="" individual="" pdbs=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></p>
                     </li>
                     <li>
                        <p>归档日志管理<a id="fnsrc_d9663e561" name="fnsrc_d9663e561" href="#fnsrc_d9663e561" in="" a="" cdb,="" this="" feature="" is="" available="" for="" the="" cdb="" only,="" not="" individual="" pdbs=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></p>
                     </li>
                     <li>
                        <p>控制文件管理<a id="fnsrc_d9663e566" name="fnsrc_d9663e566" href="#fnsrc_d9663e566" in="" a="" cdb,="" this="" feature="" is="" available="" for="" the="" cdb="" only,="" not="" individual="" pdbs=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></p>
                     </li>
                  </ul>
                  <p>性能：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Performance Hub，包括以下功能：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>实时性能监控和调整</p>
                           </li>
                           <li>
                              <p>历史表现和调整</p>
                           </li>
                           <li>
                              <p>SQL监控（实时和历史）</p>
                           </li>
                           <li>
                              <p>数据库操作监控</p>
                           </li>
                           <li>
                              <p>ADDM，包括实时ADDM</p>
                           </li>
                           <li>
                              <p>活动会话历史记录（ASH）分析</p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>自动和手动SQL Tuning Advisor</p>
                     </li>
                  </ul>
                  <div class="section">
                     <p class="subhead2" id="GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA__GUID-0E492352-F8A5-4F20-B525-9F64EAB8B5D1">数据库主页</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>数据库管理的主页是Database Home页面。这是您登录EM Express时加载的页面。请参阅<span class="q">“ <a href="getting-started-with-database-administration.html#GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4" title="Database Home页面是Oracle Enterprise Manager Database Express（EM Express）中的主数据库管理页面。">访问数据库主页</a> ”</span> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA__GUID-C1A3C334-9942-464B-BEE8-FB3FE46BE5A0">导航</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>数据库主页顶部的菜单将数据库管理任务组织为不同的类别。选择菜单选项将转到该数据库管理任务的EM Express页面。例如，要查看“用户”页面，请从“ <span class="bold">安全性”</span>菜单中选择“ <span class="bold">用户”</span> 。
                     </p>
                     <div class="figure" id="GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA__GUID-9993F4BB-9FD2-4B70-9891-142653BDE426"><img src="img/exp_menus.gif" width="273" alt="exp_menus.gif的描述如下" title="exp_menus.gif的描述如下" longdesc="img_text/exp_menus.html"><br><a href="img_text/exp_menus.html">说明exp_menus.gif的描述</a></div>
                     <!-- class="figure" -->
                     <div class="infoboxnotealso" id="GUID-BA75AD46-D22E-4914-A31E-C395CD6A2BBA__GUID-0EC679F3-75C1-488C-9D5C-37250A46BCE2">
                        <p class="notep1">也可以看看：</p>
                        <p>有关Oracle Enterprise Manager的详细信息，请参见<a href="../admin/distributed-database-concepts.html#ADMIN12110" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a> <a id="d9663e633" class="indexterm-anchor"></a>云控制</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADMQS12462"></a><div class="props_rev_3"><a id="GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923" name="GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923"></a><h3 id="ADMQS-GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923" class="sect3"><span class="enumeration_section">3.4</span>启动EM Express</h3>
               <div>
                  <p>您可以使用Oracle Enterprise Manager Database Express（EM Express）来管理非CDB，多租户容器数据库（CDB）和可插拔数据库（PDB）。EM Express使用HTTPS端口连接和管理非CDB，CDB和PDB。</p>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923__GUID-ABAAAFCE-10EF-4BCF-8E86-64AB0D8BB848">
                        <p class="notep1">注意：</p>
                        <p>您可以使用EM Express管理CDB以及CDB中除种子PDB之外的所有PDB。</p>
                     </div>
                     <p>您必须知道非CDB，CDB或PDB的HTTPS端口才能使用EM Express管理数据库。</p>
                     <p>通常，非CDB或CDB及其PDB的HTTPS端口由DBCA在配置非CDB或CDB时提供。</p>
                     <p>在Web浏览器中指定EM Express URL时，请输入数据库主机名而不是“localhost”。“</p>
                     <p>换句话说，以此格式输入EM Express URL以启动EM Express：</p><pre class="oac_no_warn" dir="ltr">https：// <span class="italic"><code class="codeph">database-hostname</code></span> ： <span class="italic"><code class="codeph">portnumber</code></span> / em /</pre><p>例如：</p><pre class="oac_no_warn" dir="ltr">https://mydbhost.example.com:5500/em/</pre><p>当EM Express提示您输入用户名和密码时，请以具有<code class="codeph">DBA</code>权限的用户身份登录（例如<code class="codeph">SYS</code>或<code class="codeph">SYSTEM</code> ）。
                     </p>
                     <p><span class="q">“ <a href="administering-user-accounts-and-security.html#GUID-CF1CD853-AF15-41EC-BC80-61918C73FDB5" title="安装Oracle数据库时会自动创建SYS和SYSTEM管理用户帐户。它们都是使用您在安装时提供的密码创建的，并且它们都自动被授予DBA角色。">SYS和SYSTEM用户</a> ”</span>提供有关使用<code class="codeph">SYSTEM</code>帐户进行日常管理任务的建议替代方法的信息。
                     </p>
                     <div class="infoboxnote" id="GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923__GUID-3C7B1754-62C1-40F3-856F-C55754B79AB4">
                        <p class="notep1">注意：</p>
                        <p>第一次在Web浏览器中输入EM Express的URL时，浏览器可能会显示警告消息。</p>
                        <p>EM Express是一个构建在Oracle XML DB之上的servlet。 Oracle XML DB默认钱包具有自签名证书，并且一些现有浏览器将自签名证书视为不受信任，因为它们未由受信任的CA（证书颁发机构）签名。但是，自签名证书仍然是安全的，因为它确保在Oracle XML DB服务器和客户端（浏览器）之间加密流量。</p>
                        <p>因此，请在Web浏览器中输入EM Express URL的安全例外。</p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923__GUID-CF71EBEC-4D02-4718-A14D-2E346416C1FD">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="getting-started-with-database-administration.html#GUID-4F64DEA7-E7B6-4E3C-A0CB-328080680DE3" title="要为非CDB启动Oracle Enterprise Manager Database Express（EM Express），请在DBCA配置非CDB时使用Database Configuration Assistant（DBCA）提供的EM Express URL。">为非CDB启动EM Express</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="getting-started-with-database-administration.html#GUID-A9A56FE4-74BC-4EEB-9DC1-8F62965DACF4" title="要为多租户容器数据库（CDB）启动Oracle Enterprise Manager Database Express（EM Express），请在DBCA配置CDB时使用Database Configuration Assistant（DBCA）提供的EM Express URL。">为CDB启动EM Express</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="getting-started-with-database-administration.html#GUID-06C767B0-B435-4C6B-9123-C39C030DF457" title="要为PDB启动EM Express，请确保PDB以读/写模式打开，然后尝试本主题中描述的以下方法之一（按所示顺序）：">为PDB启动EM Express</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADMQS12483"></a><div class="props_rev_3"><a id="GUID-4F64DEA7-E7B6-4E3C-A0CB-328080680DE3" name="GUID-4F64DEA7-E7B6-4E3C-A0CB-328080680DE3"></a><h4 id="ADMQS-GUID-4F64DEA7-E7B6-4E3C-A0CB-328080680DE3" class="sect4"><span class="enumeration_section">3.4.1</span>启动非CDB的EM Express</h4>
                  <div>
                     <div><span>要为非CDB启动Oracle Enterprise Manager Database Express（EM Express），请在DBCA配置非CDB时使用Database Configuration Assistant（DBCA）提供的EM Express URL。</span> <span class="q">“ <a href="installing-oracle-database-creating-database.html#GUID-011C3545-9427-44F7-9645-2D402A88017F" title="本节简要介绍系统类安装的步骤。大多数步骤对所有平台都是通用的，涉及运行Oracle Universal Installer（OUI）。">安装Oracle数据库软件</a> ”中</span>描述了URL的分配<span class="q">。</span> URL包括非CDB的HTTPS端口号。</div>
                     <div class="section">
                        <p>如果你不知道<a id="d9663e800" class="indexterm-anchor"></a>非CDB的HTTPS端口号，在非CDB中发出以下SQL语句，该语句返回为EM Express配置的端口：</p><pre class="oac_no_warn" dir="ltr">从dual中选择dbms_xdb_config.gethttpsport（）;</pre><p>如果<code class="codeph">gethttpsport</code>过程返回的值不是0，则返回的值是您应该使用EM Express连接到非CDB的端口。
                        </p>
                        <p>如果过程返回值0，则表示未为非CDB配置HTTPS端口。在这种情况下，您必须为此非CDB手动配置HTTPS端口，如<span class="q">“ <a href="getting-started-with-database-administration.html#GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" title="The steps in this section need to be performed only if Database Configuration Assistant (DBCA) did not provide you with the Oracle Enterprise Manager Database Express (EM Express) URL when configuring your database or pluggable database (PDB), or if you need to change the EM Express port later on.">为EM Express配置HTTPS端口</a> ”中<a href="getting-started-with-database-administration.html#GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" title="仅当数据库配置助手（DBCA）在配置数据库或可插拔数据库（PDB）时未向您提供Oracle Enterprise Manager Database Express（EM Express）URL或者您需要更改时，才需要执行本节中的步骤稍后是EM Express端口。">所述</a> 。</span></p>
                        <div class="infoboxnotealso" id="GUID-4F64DEA7-E7B6-4E3C-A0CB-328080680DE3__GUID-352954A2-D21E-4BB4-9B8A-D8CBF44AF363">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="getting-started-with-database-administration.html#GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923" title="您可以使用Oracle Enterprise Manager Database Express（EM Express）来管理非CDB，多租户容器数据库（CDB）和可插拔数据库（PDB）。EM Express使用HTTPS端口连接和管理非CDB，CDB和PDB。">启动EM Express</a> ”</span></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">gethttpsport</code>过程的更多信息，请<code class="codeph">gethttpsport</code> <a href="../arpls/DBMS_XDB_CONFIG.html#ARPLS74944" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADMQS12484"></a><div class="props_rev_3"><a id="GUID-A9A56FE4-74BC-4EEB-9DC1-8F62965DACF4" name="GUID-A9A56FE4-74BC-4EEB-9DC1-8F62965DACF4"></a><h4 id="ADMQS-GUID-A9A56FE4-74BC-4EEB-9DC1-8F62965DACF4" class="sect4"><span class="enumeration_section">3.4.2</span>启动CDB的EM Express</h4>
                  <div>
                     <div><span>要为多租户容器数据库（CDB）启动Oracle Enterprise Manager Database Express（EM Express），请在DBCA配置CDB时使用Database Configuration Assistant（DBCA）提供的EM Express URL。</span> <span class="q">“ <a href="installing-oracle-database-creating-database.html#GUID-011C3545-9427-44F7-9645-2D402A88017F" title="本节简要介绍系统类安装的步骤。大多数步骤对所有平台都是通用的，涉及运行Oracle Universal Installer（OUI）。">安装Oracle数据库软件</a> ”中</span>描述了URL的分配<span class="q">。</span> URL包括CDB的HTTPS端口号。</div>
                     <div class="section">
                        <p>如果你不知道<a id="d9663e886" class="indexterm-anchor"></a> CDB的HTTPS端口号，转到root并发出以下SQL语句，该语句返回为EM Express配置的端口：</p><pre class="oac_no_warn" dir="ltr">alter session set container = CDB $ ROOT;从dual中选择dbms_xdb_config.gethttpsport（）;</pre><p>如果<code class="codeph">gethttpsport</code>过程返回的值不是0，则返回的值是您应该使用EM Express连接到CDB的端口。
                        </p>
                        <p>如果此语句返回值0，则表示未为CDB配置HTTPS端口。在这种情况下，您必须手动为此CDB配置HTTPS端口，如<span class="q">“ <a href="getting-started-with-database-administration.html#GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" title="The steps in this section need to be performed only if Database Configuration Assistant (DBCA) did not provide you with the Oracle Enterprise Manager Database Express (EM Express) URL when configuring your database or pluggable database (PDB), or if you need to change the EM Express port later on.">为EM Express配置HTTPS端口</a> ”中<a href="getting-started-with-database-administration.html#GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" title="仅当数据库配置助手（DBCA）在配置数据库或可插拔数据库（PDB）时未向您提供Oracle Enterprise Manager Database Express（EM Express）URL或者您需要更改时，才需要执行本节中的步骤稍后是EM Express端口。">所述</a> 。</span></p>
                        <p>连接到根目录时，EM Express会显示数据并启用适用于整个CDB的操作。</p>
                        <div class="infoboxnotealso" id="GUID-A9A56FE4-74BC-4EEB-9DC1-8F62965DACF4__GUID-CC85BD6B-0BC8-4993-91C0-DE24E7802211">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="getting-started-with-database-administration.html#GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923" title="您可以使用Oracle Enterprise Manager Database Express（EM Express）来管理非CDB，多租户容器数据库（CDB）和可插拔数据库（PDB）。EM Express使用HTTPS端口连接和管理非CDB，CDB和PDB。">启动EM Express</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="managing-pdbs-with-em-express.html#GUID-24A7DC45-7A14-47A1-B14A-E1A7093CE6D9" title="本章介绍如何使用Oracle Enterprise Manager Database Express（EM Express）管理多租户容器数据库（CDB）中的可插拔数据库（PDB）。">使用EM Express管理PDB</a> ”</span> ，了解有关使用EM Express管理CDB中的可插拔数据库（PDB）的更多信息</p>
                              </li>
                              <li>
                                 <p>有关使用<code class="codeph">ALTER SESSION</code>语句切换到容器的信息，请参阅<a href="../multi/administering-a-cdb-with-sql-plus.html#ADMIN13616" target="_blank"><span><cite>“Oracle Multitenant管理员指南”</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">gethttpsport</code>过程的更多信息，请<code class="codeph">gethttpsport</code> <a href="../arpls/DBMS_XDB_CONFIG.html#ARPLS74944" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADMQS12485"></a><div class="props_rev_3"><a id="GUID-06C767B0-B435-4C6B-9123-C39C030DF457" name="GUID-06C767B0-B435-4C6B-9123-C39C030DF457"></a><h4 id="ADMQS-GUID-06C767B0-B435-4C6B-9123-C39C030DF457" class="sect4"><span class="enumeration_section">3.4.3</span>启动PDB的EM Express</h4>
                  <div>
                     <p>要为PDB启动EM Express，请确保PDB以读/写模式打开，然后尝试本主题中描述的以下方法之一（按所示顺序）：</p>
                     <div class="section">
                        <ol>
                           <li>
                              <p>连接到包含PDB的CDB的CDB $ ROOT容器，并发出以下SQL语句来配置CDB的全局端口：</p><pre class="oac_no_warn" dir="ltr">exec dbms_xdb_config.setglobalportenabled（TRUE）;</pre></li>
                           <li>
                              <p>然后，在Web浏览器中，输入Database Configuration Assistant（DBCA）在配置包含PDB的CDB时提供的EM Express URL。</p>
                              <p>默认情况下，DBCA为CDB配置的HTTPS端口也可用于该CDB中的PDB。</p>
                           </li>
                           <li>
                              <p>出现EM Express登录屏幕时，请指定管理员凭据，并在“ <span class="uicontrol bold">容器名称”</span>字段中输入要连接的PDB的<span class="uicontrol bold">名称</span> 。
                              </p>
                           </li>
                        </ol>
                        <p>使用全局端口的优点是您不需要为每个PDB配置端口。 （在一个大型网站中，可能有数千个PDB。）使用全局端口，您可以配置一个端口，然后将EM Express设置为指向它。第二个优点是您不需要查找此PDB的端口号;此配置自动将请求路由到PDB。</p>
                        <p>如果EM Express未连接到PDB，请尝试下一个方法：</p>
                        <ol>
                           <li>
                              <p>连接到要管理的PDB（本例中为PDB1）和<a id="d9663e1006" class="indexterm-anchor"></a>使用<code class="codeph">gethttpsport</code>过程确定是否为EM Express配置了HTTPS端口：</p><pre class="oac_no_warn" dir="ltr">alter session set container = PDB1;从dual中选择dbms_xdb_config.gethttpsport（）;</pre><p>如果<code class="codeph">gethttpsport</code>过程返回的值不是0，则返回的值是您应该使用EM Express连接到PDB的端口。
                              </p>
                           </li>
                           <li>
                              <p>如果<code class="codeph">gethttpsport</code>过程返回0，则必须为此PDB手动配置HTTPS端口，如<span class="q">“ <a href="getting-started-with-database-administration.html#GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" title="The steps in this section need to be performed only if Database Configuration Assistant (DBCA) did not provide you with the Oracle Enterprise Manager Database Express (EM Express) URL when configuring your database or pluggable database (PDB), or if you need to change the EM Express port later on.">为EM Express配置HTTPS端口</a> ”中<a href="getting-started-with-database-administration.html#GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" title="仅当数据库配置助手（DBCA）在配置数据库或可插拔数据库（PDB）时未向您提供Oracle Enterprise Manager Database Express（EM Express）URL或者您需要更改时，才需要执行本节中的步骤稍后是EM Express端口。">所述</a> 。</span></p>
                              <p>手动为PDB配置HTTPS端口后，可以在EM Express URL中指定该端口以连接到该PDB。当您使用为EM Express URL中的PDB手动配置的HTTPS端口时， <span class="uicontrol bold">容器名称</span>字段不会出现在EM Express登录屏幕上，因为该端口只能用于访问该PDB。</p>
                           </li>
                        </ol>
                        <p>连接到PDB时，EM Express会显示数据并启用仅适用于PDB的操作。</p>
                        <div class="infoboxnotealso" id="GUID-06C767B0-B435-4C6B-9123-C39C030DF457__GUID-09F3F54D-7484-48B7-A46F-551E473C2DB3">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="getting-started-with-database-administration.html#GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923" title="您可以使用Oracle Enterprise Manager Database Express（EM Express）来管理非CDB，多租户容器数据库（CDB）和可插拔数据库（PDB）。EM Express使用HTTPS端口连接和管理非CDB，CDB和PDB。">启动EM Express</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="managing-pdbs-with-em-express.html#GUID-24A7DC45-7A14-47A1-B14A-E1A7093CE6D9" title="本章介绍如何使用Oracle Enterprise Manager Database Express（EM Express）管理多租户容器数据库（CDB）中的可插拔数据库（PDB）。">使用EM Express管理PDB</a> ”</span> ，了解有关使用EM Express管理多租户容器数据库（CDB）中的PDB的更多信息</p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">dbms_xdb_config.setglobalportenabled</code>过程的详细信息，请<code class="codeph">dbms_xdb_config.setglobalportenabled</code> <a href="../arpls/DBMS_XDB_CONFIG.html#ARPLS-GUID-24CC7F8C-33C9-4444-A4FA-48BAD06353BA" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">dbms_xdb_config.isglobalportenabled</code>函数的信息，请<code class="codeph">dbms_xdb_config.isglobalportenabled</code> <a href="../arpls/DBMS_XDB_CONFIG.html#ARPLS-GUID-1247CAF7-5A8C-4CF5-8081-19E8C7A7E8CC" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关使用<code class="codeph">ALTER SESSION</code>语句切换到容器的信息，请参阅<a href="../multi/administering-a-cdb-with-sql-plus.html#ADMIN13616" target="_blank"><span><cite>“Oracle Multitenant管理员指南”</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">dbms_xdb_config.gethttpsport</code>过程的更多信息，请<code class="codeph">dbms_xdb_config.gethttpsport</code> <a href="../arpls/DBMS_XDB_CONFIG.html#ARPLS74944" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ADMQS12133"></a><a id="ADMQS032"></a><div class="props_rev_3"><a id="GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" name="GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5"></a><h3 id="ADMQS-GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" class="sect3"><span class="enumeration_section">3.5</span>配置EM Express的HTTPS端口</h3>
               <div>
                  <div><span>仅当数据库配置助手（DBCA）在配置数据库或可插拔数据库（PDB）时未向您提供Oracle Enterprise Manager Database Express（EM Express）URL或者您需要更改时，才需要执行本节中的步骤稍后是EM Express端口。</span> 否则，您可以按照<span class="q">“ <a href="getting-started-with-database-administration.html#GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923" title="You can use Oracle Enterprise Manager Database Express (EM Express) to manage non-CDBs, multitenant container databases (CDBs), and pluggable databases (PDBs). EM Express uses an HTTPS port to connect to and manage non-CDBs, CDBs, and PDBs.">启动EM Express</a> ”中</span>的说明<span class="q"><a href="getting-started-with-database-administration.html#GUID-F1C3023C-35DC-4086-A63F-F58F3FFC2923" title="您可以使用Oracle Enterprise Manager Database Express（EM Express）来管理非CDB，多租户容器数据库（CDB）和可插拔数据库（PDB）。EM Express使用HTTPS端口连接和管理非CDB，CDB和PDB。">启动EM Express</a> 。</span></div>
                  <div class="section">
                     <p>在从Web浏览器访问EM Express之前，必须配置EM Express的HTTPS端口。配置EM Express的HTTPS端口后，可以使用它来访问EM Express。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5__GUID-CBD6FDAC-FABE-4269-9143-11EFB2FAAA13">要为EM Express手动配置HTTPS端口：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>配置并启动Oracle Net Listener（侦听器）。您可以使用lsnrctl来启动，停止和查看侦听器的状态。</span></li>
                     <li class="stepexpand"><span>如果侦听器在非标准端口上运行（例如，不是1521）， <code class="codeph">local_listener</code>使用EM Express管理的数据库的<code class="codeph">init.ora</code>文件必须包含<code class="codeph">local_listener</code>条目，以便HTTPS端口可以向正确的侦听器注册。<code class="codeph">local_listener</code>条目引用指向正确侦听器的TNSNAMES条目。例如：</span><div><pre class="oac_no_warn" dir="ltr">LOCAL_LISTENER = INST1</pre><p>其中<code class="codeph">inst1</code>是<code class="codeph">tnsnames.ora</code>中定义的TNSNAMES条目，指向侦听器。例如：</p><pre class="oac_no_warn" dir="ltr">inst1 =（DESCRIPTION =（ADDRESS =（PROTOCOL = tcp）（HOST = <span class="italic"><code class="codeph">host_name</code></span> ）（PORT = 1234））（CONNECT_DATA =（SERVICE_NAME = <span class="italic"><code class="codeph">service_name</code></span> ）（SERVER = DEDICATED）））</pre><p>在此示例中，1234是侦听器已配置为侦听的非标准端口。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>通过将以下条目添加到要使用EM Express管理的数据库的<code class="codeph">init.ora</code>文件中来启用TCP调度程序：</span><div><pre class="oac_no_warn" dir="ltr">调度员= “（PROTOCOL = TCP）（SERVICE = &lt;SID&gt; XDB）”</pre><p>例如，如果数据库SID是ORCL，那么条目将是：</p><pre class="oac_no_warn" dir="ltr">调度员= “（PROTOCOL = TCP）（SERVICE = ORCLXDB）”</pre></div>
                     </li>
                     <li class="stepexpand"><span>重新启动数据库，以便<code class="codeph">init.ora</code>文件中所做的更改生效。</span></li>
                     <li class="stepexpand"><span>使用PL / SQL过程<code class="codeph">DBMS_XDB_CONFIG.SETHTTPSPORT</code>将数据库的EM Express的HTTPS端口设置为未使用的端口。这将更新Oracle XML DB存储库中<code class="codeph">xdbconfig.xml</code>文件中的HTTPS <code class="codeph">port</code> 。必须以<code class="codeph">SYS / AS SYSDBA</code>身份连接才能运行该过程。</span><div>
                           <p>例如，设置<a id="d9663e1235" class="indexterm-anchor"></a>适用于非CDB的EM Express的HTTPS端口：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; exec DBMS_XDB_CONFIG.SETHTTPSPORT（5500）;</pre><p>设置<a id="d9663e1244" class="indexterm-anchor"></a>用于多租户容器数据库（CDB）的EM Express的HTTPS端口，转到CDB中的根目录，然后使用CDB中的PL / SQL过程<code class="codeph">DBMS_XDB_CONFIG.SETHTTPSPORT</code>将CDB的EM Express的HTTPS端口设置为一个端口没有使用。这将更新Oracle XML DB存储库中<code class="codeph">xdbconfig.xml</code>文件中的HTTPS <code class="codeph">port</code> 。必须以<code class="codeph">SYS / AS SYSDBA</code>身份连接才能运行该过程。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter session set container = CDB $ ROOT; SQL&gt; exec DBMS_XDB_CONFIG.SETHTTPSPORT（5501）;</pre><p>设置<a id="d9663e1265" class="indexterm-anchor"></a>用于PDB的EM Express的HTTPS端口，确保PDB以读/写模式打开，然后使用PDB中的PL / SQL过程<code class="codeph">DBMS_XDB_CONFIG.SETHTTPSPORT</code>将PDB的EM Express的HTTPS端口设置为一个端口没有使用。这将更新Oracle XML DB存储库中<code class="codeph">xdbconfig.xml</code>文件中的HTTPS <code class="codeph">port</code> 。必须以<code class="codeph">SYS / AS SYSDBA</code>身份连接才能运行该过程。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter session set container = PDB1; SQL&gt; exec DBMS_XDB_CONFIG.SETHTTPSPORT（5502）;</pre><p>使用以下命令确认端口已向侦听器注册：</p><pre class="oac_no_warn" dir="ltr">$ lsnrctl status | grep -i 5502（DESCRIPTION =（ADDRESS =（PROTOCOL = tcps）（HOST = <span class="italic"><code class="codeph">hostname.example.com</code></span> ）（PORT = 5502））（安全=（my_wallet_directory = / $ <span class="italic"><code class="codeph">ORACLE_BASE</code></span> / admin / <span class="italic"><code class="codeph">sid</code></span> / xdb_wallet））（Presentation = HTTP）（会话= RAW））</pre></div>
                     </li>
                     <li class="stepexpand"><span>要访问EMB以获取非CDB，CDB或PDB，请在Web浏览器中以下列格式输入URL，指定要管理的非CDB，CDB或PDB的EM Express端口号：</span><div><pre class="oac_no_warn" dir="ltr">https：// <span class="italic"><code class="codeph">database-hostname</code></span> ： <span class="italic"><code class="codeph">portnumber</code></span> / em /</pre><p>例如：</p><pre class="oac_no_warn" dir="ltr">https://mydbhost.example.com:5500/em/</pre><p>当系统提示您输入用户名和密码时，请以具有DBA权限的用户身份登录（例如<code class="codeph">SYS</code>或<code class="codeph">SYSTEM</code> ）。
                           </p>
                           <div class="infoboxnote" id="GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5__GUID-2FFA5532-CEDD-4CE9-8749-0AC5B411C2C2">
                              <p class="notep1">注意：</p>
                              <p>EM Express的TLS版本由数据库的<code class="codeph">sqlnet.ora</code>文件中设置的<code class="codeph">SSL_VERSION</code>参数确定。
                              </p>
                              <p>有关<code class="codeph">SSL_VERSION</code>参数的详细信息，请参阅<a href="../netrf/parameters-for-the-sqlnet.ora.html#NETRF-GUID-A2A81CEE-162D-4602-8315-990C8CC9E9E2" target="_blank"><span><cite>Oracle数据库网络服务参考</cite></span></a> 。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5__GUID-F279B926-7545-4F1C-B471-6A5C9421862C">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关配置和使用侦听器的详细信息，请参见<a href="../netag/configuring-and-administering-oracle-net-listener.html#NETAG010" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p>有关侦听器参数的详细信息，请参阅<a href="../netrf/index.html" target="_blank"><span><cite>Oracle数据库网络服务参考</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">local_listener</code>条目的详细信息，请<code class="codeph">local_listener</code> <a href="../netag/configuring-and-administering-oracle-net-listener.html#NETAG1154" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p>有关访问Oracle XML DB存储库的更多信息，请参见<a href="../adxdb/repository-access-using-protocols.html#ADXDB2500" target="_blank"><span><cite>Oracle XML DB Developer's Guide</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p>有关管理Oracle XML DB的更多信息，请<a href="../adxdb/administration-of-XML-DB.html#ADXDB2700" target="_blank"><span><cite>参见Oracle XML DB Developer's Guide</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">sethttpsport</code>过程的更多信息，请<code class="codeph">sethttpsport</code> <a href="../arpls/DBMS_XDB_CONFIG.html#ARPLS74945" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p><a href="../multi/administering-a-cdb-with-sql-plus.html#ADMIN13632" target="_blank"><span><cite>Oracle Multitenant管理员指南</cite></span></a> ，了解有关使用<code class="codeph">ALTER PLUGGABLE DATABASE</code>语句修改PDB模式的信息</p>
                                 </li>
                                 <li>
                                    <p>有关使用<code class="codeph">ALTER SESSION</code>语句切换到容器的信息，请参阅<a href="../multi/administering-a-cdb-with-sql-plus.html#ADMIN13616" target="_blank"><span><cite>“Oracle Multitenant管理员指南”</cite></span></a></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="managing-pdbs-with-em-express.html#GUID-24A7DC45-7A14-47A1-B14A-E1A7093CE6D9" title="本章介绍如何使用Oracle Enterprise Manager Database Express（EM Express）管理多租户容器数据库（CDB）中的可插拔数据库（PDB）。">使用EM Express管理PDB</a> ”</span> ，了解有关使用EM Express管理CDB中的PDB的更多信息</p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="administering-user-accounts-and-security.html#GUID-CF1CD853-AF15-41EC-BC80-61918C73FDB5" title="安装Oracle数据库时会自动创建SYS和SYSTEM管理用户帐户。它们都是使用您在安装时提供的密码创建的，并且它们都自动被授予DBA角色。">SYS和SYSTEM用户</a> ”</span> ，了解有关使用<code class="codeph">SYSTEM</code>帐户进行日常管理任务的建议替代方法的信息</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </li>
                  </ol>
               </div>
            </div>
            <div class="sect2"><a id="GUID-638AB4AB-27B5-4C00-8EA4-ACCDE0C985F5" name="GUID-638AB4AB-27B5-4C00-8EA4-ACCDE0C985F5"></a><h3 id="ADMQS-GUID-638AB4AB-27B5-4C00-8EA4-ACCDE0C985F5" class="sect3"><span class="enumeration_section">3.6</span>关于EM Express和数据库云服务部署</h3>
               <div>
                  <p>除了使用EM Express监视和管理本地Oracle数据库之外，您还可以使用EM Express来管理Oracle数据库云服务（DBCS）数据库部署。</p>
                  <p>有关使用EM Express管理DBCS数据库部署的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/admqs&amp;id=CSDBI-GUID-EAB971AC-3BF3-4370-B8DF-B72F777A5575" target="_blank"><span class="italic">Oracle Cloud管理Oracle数据库云服务</span></a> 。
                  </p>
               </div>
            </div><a id="ADMQS12135"></a><a id="ADMQS033"></a><div class="props_rev_3"><a id="GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4" name="GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4"></a><h3 id="ADMQS-GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4" class="sect3"><span class="enumeration_section">3.7</span>访问数据库主页</h3>
               <div>
                  <p>Database Home页面是Oracle Enterprise Manager Database Express（EM Express）中的主数据库管理页面。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4__GUID-6A3D5DF9-4E8C-442C-85E9-042F287D2A6E">要访问数据库主页：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>确保已配置EM Express的HTTPS端口。</span><div>
                           <p>请参阅<span class="q">“ <a href="getting-started-with-database-administration.html#GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" title="仅当数据库配置助手（DBCA）在配置数据库或可插拔数据库（PDB）时未向您提供Oracle Enterprise Manager Database Express（EM Express）URL或者您需要更改时，才需要执行本节中的步骤稍后是EM Express端口。">为EM Express配置HTTPS端口</a> ”</span> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>在Web浏览器中，输入要管理的数据库或可插拔数据库（PDB）的EM Express URL：</span><div><pre class="oac_no_warn" dir="ltr">https：// <span class="italic">database-hostname：portnumber</span> / em</pre><p>例如，如果您在名为<code class="codeph">mydbhost.example.com</code>的主机上安装了数据库，并且端口号<code class="codeph">5500</code>被配置为数据库的EM Express的HTTPS端口号，则输入以下URL：</p><pre class="oac_no_warn" dir="ltr">https://mydbhost.example.com:5500/em</pre><p>如果数据库实例正在运行，则在访问EM Express时将显示“登录”页面。</p>
                           <p>如果数据库实例未运行，请启动它。有关启动实例的信息，请参见“ <a href="../admin/starting-up-and-shutting-down.html#ADMIN10063" target="_blank"><span><cite>Oracle数据库管理员指南”</cite></span></a> 。
                           </p>
                           <p>如果将端口号5501配置为要管理的PDB的EM Express的HTTPS端口号，请输入以下URL：</p><pre class="oac_no_warn" dir="ltr">https://mydbhost.example.com:5501/em</pre><p>如果PDB在读/写模式下打开，则在访问EM Express时会显示“登录”页面。</p>
                           <p>如果PDB未在读/写模式下打开，请以读/写模式打开它。有关使用<code class="codeph">ALTER PLUGGABLE DATABASE</code>语句以读/写模式打开PDB的信息，请参阅“ <a href="../multi/administering-a-cdb-with-sql-plus.html#ADMIN13632" target="_blank"><span><cite>Oracle Multitenant管理员指南”</cite></span></a> 。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>使用有权访问EM Express的用户帐户登录数据库或PDB。<code class="codeph">EM_EXPRESS_BASIC</code>和<code class="codeph">EM_EXPRESS_ALL</code>角色是为EM Express创建的，并且至少被授予其中一个角色的用户可以登录EM Express。</span><div>
                           <p>此用户最初可能是<code class="codeph">SYS</code>或<code class="codeph">SYSTEM</code> ，其中包含您在数据库安装期间指定的密码。
                           </p>
                           <p>虽然您可以使用<code class="codeph">SYSTEM</code>帐户执行日常管理任务，但Oracle强烈建议创建一个命名用户帐户，以便管理Oracle数据库以启用对数据库活动的监视。要备份，恢复或升级数据库，您必须以具有SYSDBA权限的用户身份登录。
                           </p>
                           <p>EM Express显示数据库主页。</p>
                           <div class="figure" id="GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4__GUID-021C3C5C-354F-4156-BDCB-9DE44FEE2C6E"><img src="img/exp_db_home_page2.gif" width="512" alt="下面是exp_db_home_page2.gif的描述" title="下面是exp_db_home_page2.gif的描述" longdesc="img_text/exp_db_home_page2.html"><br><a href="img_text/exp_db_home_page2.html">插图描述exp_db_home_page2.gif</a></div>
                           <!-- class="figure" -->
                           <div class="infoboxnote" id="GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4__GUID-A2CD7784-38B4-417D-82F3-182ACCFB61F5">
                              <p class="notep1">注意：</p>
                              <p>上面的数据库主页是针对CDB的。 “性能”部分中的“容器”选项卡未显示在非CDB或PDB的“数据库主页”页面上。</p>
                           </div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>要在导航到另一个EM Express页面后返回数据库主页，您可以：</span><div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>单击任何EM Express页面左上角的数据库图标：</p>
                                 <div class="figure" id="GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4__GUID-4BCBC2A5-1A42-47B9-8AA5-1B6E4A15EE6A"><img src="img/exp_db_home_page_icon2.gif" width="122" alt="下面是exp_db_home_page_icon2.gif的说明" title="下面是exp_db_home_page_icon2.gif的说明" longdesc="img_text/exp_db_home_page_icon2.html"><br><a href="img_text/exp_db_home_page_icon2.html">说明exp_db_home_page_icon2.gif的说明</a></div>
                                 <!-- class="figure" -->
                              </li>
                              <li>
                                 <p>单击Web浏览器的“ <span class="bold">后退”</span>按钮，直到出现“数据库主页”。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ol>
                  <div class="section">
                     <p>数据库主页的各个部分提供有关数据库的环境和状态的信息。“状态”部分显示有关数据库的基本信息。当数据库实例是多租户容器数据库（CDB）时，“状态”部分中“类型”字段之后的行是将实例标识为CDB的链接，并列出CDB中的PDB数。单击<span class="bold">CDB（n PDB）</span>链接以查看CDB的Containers页面，其中显示CDB容器（PDB）的状态，性能和资源信息。“事件 - 最近24小时”部分列出了过去24小时内数据库中的严重错误警报。“SQL监视器”部分会警告您可能会影响数据库性能的长时间运行的SQL语句。然后，您可以使用菜单选项获取有关问题区域的更多详细信息，并在某些情况下获取解决问题的建议。<a href="monitoring-and-tuning-the-database.html#GUID-95716F9A-C500-4CCD-AC3F-6541E3191E40" title="监视数据库的性能并确保其以最佳状态执行是数据库管理员的一项重要任务。本章讨论Oracle数据库中包含的特性和功能，这些特性和功能可以轻松监控数据库运行状况，识别性能问题并实施任何纠正措施。">监视和调整数据库</a>中讨论了这些主题。
                     </p>
                     <div class="infoboxnotealso" id="GUID-E2807CDE-1401-4A79-8131-EBC6D45C71B4__GUID-003F7540-05BD-4CAD-9222-3F0AE8B97CC2">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="getting-started-with-database-administration.html#GUID-EB851101-07BE-4038-BB9D-06E01CC7F5D5" title="仅当数据库配置助手（DBCA）在配置数据库或可插拔数据库（PDB）时未向您提供Oracle Enterprise Manager Database Express（EM Express）URL或者您需要更改时，才需要执行本节中的步骤稍后是EM Express端口。">为EM Express配置HTTPS端口</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="managing-pdbs-with-em-express.html#GUID-24A7DC45-7A14-47A1-B14A-E1A7093CE6D9" title="本章介绍如何使用Oracle Enterprise Manager Database Express（EM Express）管理多租户容器数据库（CDB）中的可插拔数据库（PDB）。">使用EM Express管理PDB</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADMQS12090"></a><div class="props_rev_3"><a id="GUID-E01797C6-B9D5-4124-BF24-092CE93F34B9" name="GUID-E01797C6-B9D5-4124-BF24-092CE93F34B9"></a><h3 id="ADMQS-GUID-E01797C6-B9D5-4124-BF24-092CE93F34B9" class="sect3"><span class="enumeration_section">3.8</span>授予非管理用户访问EM Express的权限</h3>
               <div>
                  <div><span>作为数据库管理员，您可以使用<code class="codeph">SYS</code>或<code class="codeph">SYSTEM</code>用户帐户登录Oracle Enterprise Manager Database Express（EM Express）以执行管理和其他任务。非管理用户可能还希望登录EM Express。</span> 例如，应用程序开发人员可能希望利用EM Express界面来创建或修改表，索引，视图等。您必须先授予这些用户访问EM Express的权限，然后才能登录。
                  </div>
                  <p><a id="d9663e1690" class="indexterm-anchor"></a>要使非管理用户能够访问EM Express，必须为其授予<code class="codeph">EM_EXPRESS_BASIC</code>或<code class="codeph">EM_EXPRESS_ALL</code>角色。
                  </p>
                  <p><code class="codeph">EM_EXPRESS_BASIC</code>角色使用户能够连接到EM Express并以只读模式查看页面。<code class="codeph">EM_EXPRESS_BASIC</code>角色包括<code class="codeph">SELECT_CATALOG_ROLE</code>角色。
                  </p>
                  <p><code class="codeph">EM_EXPRESS_ALL</code>角色使用户能够连接到EM Express并使用EM Express提供的所有功能（对所有EM Express功能的读/写访问）。<code class="codeph">EM_EXPRESS_ALL</code>角色包括<code class="codeph">EM_EXPRESS_BASIC</code>角色。
                  </p>
                  <p>有关向用户帐户<span class="q"><a href="administering-user-accounts-and-security.html#GUID-D44F6873-123C-480E-AF2D-20A4670DA70A" title="You can use Oracle Enterprise Manager Database Express (EM Express) to grant privileges and roles to a user account.">授予权限和角色的示例</a></span> ，请参阅<span class="q">“ <a href="administering-user-accounts-and-security.html#GUID-D44F6873-123C-480E-AF2D-20A4670DA70A" title="您可以使用Oracle Enterprise Manager Database Express（EM Express）向用户帐户授予权限和角色。">示例：向用户帐户授予权限和角色</a> ”</span> 。
                  </p>
                  <div class="infoboxnotealso" id="GUID-E01797C6-B9D5-4124-BF24-092CE93F34B9__GUID-1952C54C-A637-4F73-9402-52C1A15A7E18">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="administering-user-accounts-and-security.html#GUID-CF1CD853-AF15-41EC-BC80-61918C73FDB5" title="安装Oracle数据库时会自动创建SYS和SYSTEM管理用户帐户。它们都是使用您在安装时提供的密码创建的，并且它们都自动被授予DBA角色。">SYS和SYSTEM用户</a> ”</span> ，了解有关使用<code class="codeph">SYSTEM</code>帐户进行日常管理任务的建议替代方法的信息</p>
                  </div>
               </div>
            </div><a id="ADMQS12035"></a><div class="props_rev_3"><a id="GUID-ADF47AF3-3546-4AC4-9D6B-E3F54B35FF6F" name="GUID-ADF47AF3-3546-4AC4-9D6B-E3F54B35FF6F"></a><h3 id="ADMQS-GUID-ADF47AF3-3546-4AC4-9D6B-E3F54B35FF6F" class="sect3"><span class="enumeration_section">3.9</span>使用基于SQL的管理工具管理数据库</h3>
               <div>
                  <div><span>除了使用Oracle Enterprise Manager Database Express（EM Express）中提供的图形用户界面（GUI）页面之外，您还可以使用其他Oracle工具（如SQL Developer和SQL * Plus）来管理数据库。</span> 这些工具使您可以执行数据库管理操作，以及直接在数据库中查询，插入，更新或删除数据。
                  </div>
                  <p>以下部分提供了详细信息：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="getting-started-with-database-administration.html#GUID-BE3E18AA-BB53-47DC-BD11-78E08AE5D3E3" title="为了执行其许多操作，Oracle Enterprise Manager Database Express（EM Express）将结构化查询语言（SQL）语句提交到数据库。SQL（发音为sequel）是一种行业标准的类似英语的计算机编程语言，用于查询和更新数据库。">关于SQL</a></p>
                     </li>
                     <li>
                        <p><a href="getting-started-with-database-administration.html#GUID-16D90628-1B26-4035-AA61-BCF2D47539AD" title="SQL * Plus是一个命令行程序，用于将SQL和PL / SQL语句提交到Oracle数据库。您可以以交互方式或SQL * Plus脚本提交语句。">关于SQL * Plus</a></p>
                     </li>
                     <li>
                        <p><a href="getting-started-with-database-administration.html#GUID-DE8A79BD-FAE4-4364-98FF-D2BD992A06E7" title="本节介绍如何从命令行和Windows“开始”菜单启动SQL * Plus并连接到数据库。">启动SQL * Plus并连接到数据库</a></p>
                     </li>
                     <li>
                        <p><a href="getting-started-with-database-administration.html#GUID-5A09A54A-9ECA-40B8-B73A-65A5CB81DD04" title="SQL Developer提供了另一个用于访问Oracle数据库的GUI。SQL Developer支持SQL和PL / SQL语言的开发。它在Oracle数据库的默认安装中可用。">关于SQL Developer</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-ADF47AF3-3546-4AC4-9D6B-E3F54B35FF6F__GUID-80ACA4A9-3732-4B67-A8B5-CE4E1DCFAEA1">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../tdddg/connecting-exploring-database.html#TDDDG12200" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/Introduction-to-Oracle-SQL.html#SQLRF001" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADMQS12311"></a><div class="props_rev_3"><a id="GUID-BE3E18AA-BB53-47DC-BD11-78E08AE5D3E3" name="GUID-BE3E18AA-BB53-47DC-BD11-78E08AE5D3E3"></a><h4 id="ADMQS-GUID-BE3E18AA-BB53-47DC-BD11-78E08AE5D3E3" class="sect4"><span class="enumeration_section">3.9.1</span>关于SQL</h4>
                  <div>
                     <p>为了执行其许多操作，Oracle Enterprise Manager Database Express（EM Express）将结构化查询语言（SQL）语句提交到数据库。SQL（发音为<span class="italic">sequel</span> ）是一种行业标准的类似英语的计算机编程语言，用于查询和更新数据库。
                     </p>
                     <p>以下是SQL查询的示例，该查询列出了有关用户<code class="codeph">hr</code>拥有的countries表中国家/地区的信息：</p><pre class="oac_no_warn" dir="ltr">来自HR.COUNTRIES的SELECT COUNTRY_ID，COUNTRY_NAME;</pre><p>SQL是一种功能强大的语言，也可用于执行各种数据库管理任务。以下SQL语句创建数据库用户<code class="codeph">nick</code>并为其分配您选择的<span class="italic">密码</span> ，由<span class="italic">密码</span>表示：</p><pre class="oac_no_warn" dir="ltr">通过<span class="italic">密码</span>识别CREATE USER nick;</pre><p>在EM Express中执行某些管理任务时，可以单击“ <span class="bold">显示SQL”</span>以查看EM Express生成和提交的SQL语句。
                     </p>
                  </div>
               </div><a id="ADMQS12312"></a><div class="props_rev_3"><a id="GUID-16D90628-1B26-4035-AA61-BCF2D47539AD" name="GUID-16D90628-1B26-4035-AA61-BCF2D47539AD"></a><h4 id="ADMQS-GUID-16D90628-1B26-4035-AA61-BCF2D47539AD" class="sect4"><span class="enumeration_section">3.9.2</span>关于SQL * Plus</h4>
                  <div>
                     <div><span>SQL * Plus是一个命令行程序，用于将SQL和PL / SQL语句提交到Oracle数据库。您可以以交互方式或SQL * Plus脚本提交语句。</span> SQL * Plus随数据库一起安装，位于<span class="italic"><code class="codeph"><span class="codeinlineitalic"><code class="codeph">ORACLE_HOME</code></span></code></span> <code class="codeph">/bin</code>目录中。
                     </div>
                     <p>您可以从命令行或Microsoft Windows上的“开始”菜单启动SQL * Plus。</p>
                     <p>加载SQL * Plus时，它会发出SQL提示符，如下所示：</p><pre class="oac_no_warn" dir="ltr">SQL&gt;</pre><p>在SQL提示符下，您可以输入执行管理任务的语句，例如关闭数据库或创建新用户，或者可以查询，插入，更新和删除数据。</p>
                     <p>您可以在多行上输入单个SQL语句。您必须以分号（;）结束每个语句。对于大多数语句，您可以通过在一行上单独输入斜杠（/）来重新运行语句。</p>
                     <div class="infoboxnotealso" id="GUID-16D90628-1B26-4035-AA61-BCF2D47539AD__GUID-883F0DA4-52CF-4921-8321-EF5190239263">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../sqpug/SQL-Plus-quick-start.html#SQPUG002" target="_blank"><span><cite>SQL * Plus用户指南和参考</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../cncpt/concepts-for-database-administrators.html#CNCPT829" target="_blank"><span><cite>Oracle数据库概念</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADMQS12142"></a><a id="ADMQS12143"></a><a id="ADMQS0361"></a><div class="props_rev_3"><a id="GUID-DE8A79BD-FAE4-4364-98FF-D2BD992A06E7" name="GUID-DE8A79BD-FAE4-4364-98FF-D2BD992A06E7"></a><h4 id="ADMQS-GUID-DE8A79BD-FAE4-4364-98FF-D2BD992A06E7" class="sect4"><span class="enumeration_section">3.9.3</span>启动SQL * Plus并连接到数据库</h4>
                  <div>
                     <p>本节介绍如何从命令行和Windows“开始”菜单启动SQL * Plus并连接到数据库。</p>
                     <div class="section">
                        <p>对于新安装，使用<code class="codeph">SYS</code>或<code class="codeph">SYSTEM</code>数据库帐户连接到数据库。当您输入<code class="codeph">SYS</code>或斜杠（ <code class="codeph">/</code> ）作为用户名并提供<code class="codeph">AS</code> <code class="codeph">SYSDBA</code>子句时，将使用操作系统身份验证对您的访问进行身份验证。<span class="bold">操作系统身份验证</span>使用Windows，UNIX或Linux主机用户帐户向Oracle数据库进行身份验证。您必须使用作为特殊主机用户组成员的用户帐户登录主机。在UNIX和Linux上，此用户组通常是<code class="codeph">dba</code> 。通过这种类型的身份验证，您可以连接到尚未启动的Oracle数据库，以便可以启动它。有关更多信息，请参见“ <a href="../admin/getting-started-with-database-administration.html#ADMIN11010" target="_blank"><span><cite>Oracle数据库管理员指南”</cite></span></a> 。
                        </p>
                        <p>以下过程说明如何使用<code class="codeph">SYSDBA</code>权限以<code class="codeph">SYS</code>用户身份登录数据库。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DE8A79BD-FAE4-4364-98FF-D2BD992A06E7__GUID-3BE96531-5C30-4A14-BC4A-7A4C4A560D78">要启动SQL * Plus并从命令行连接到数据库：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ol>
                           <li>
                              <p>打开命令窗口。</p>
                           </li>
                           <li>
                              <p>配置操作系统环境变量，如<span class="q">“ <a href="getting-started-with-database-administration.html#GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2" title="Before using certain tools that access the Oracle database, such as SQL*Plus, you must configure environment variables for your operating system. These environment variables are used by Oracle Database to determine the database instance to which the tool should connect.">配置操作系统环境变量</a> ”中<a href="getting-started-with-database-administration.html#GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2" title="在使用访问Oracle数据库的某些工具（例如SQL * Plus）之前，必须为操作系统配置环境变量。Oracle数据库使用这些环境变量来确定工具应连接的数据库实例。">所述</a> 。</span></p>
                           </li>
                           <li>
                              <p>使用以下格式的命令启动SQL * Plus：</p><pre class="oac_no_warn" dir="ltr">sqlplus { <span class="italic"><code class="codeph">username</code></span> | /} [as sysdba]</pre><p>此命令的示例是：</p><pre class="oac_no_warn" dir="ltr">$ sqlplus / AS SYSDBA输入密码： <span class="italic">密码</span>
</pre><p>对于<span class="italic"><code class="codeph">username</code></span> ，您可以使用<code class="codeph">SYS</code>或<code class="codeph">SYSTEM</code>管理用户。在提示符下，输入您在安装期间设置的密码。如果使用<code class="codeph">SYS</code>用户，则必须在用户名后包含<code class="codeph">AS SYSDBA</code> 。
                              </p>
                              <p>SQL * Plus将您连接到默认数据库实例（Microsoft Windows）或环境变量（Linux和UNIX）指定的数据库实例。</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DE8A79BD-FAE4-4364-98FF-D2BD992A06E7__GUID-290A4110-2A1F-4EE5-AF49-297A3E8F98EF">要启动SQL * Plus并从Windows“开始”菜单连接到数据库：</p>
                        <ol>
                           <li>
                              <p>配置操作系统环境变量，如<span class="q">“ <a href="getting-started-with-database-administration.html#GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2" title="Before using certain tools that access the Oracle database, such as SQL*Plus, you must configure environment variables for your operating system. These environment variables are used by Oracle Database to determine the database instance to which the tool should connect.">配置操作系统环境变量</a> ”中<a href="getting-started-with-database-administration.html#GUID-EC18C4A6-3BA5-4C14-9D76-B0DD62FEFFF2" title="在使用访问Oracle数据库的某些工具（例如SQL * Plus）之前，必须为操作系统配置环境变量。Oracle数据库使用这些环境变量来确定工具应连接的数据库实例。">所述</a> 。</span></p>
                           </li>
                           <li>
                              <p>单击“ <span class="uicontrol bold">开始”</span> ，选择“ <span class="uicontrol bold">程序”</span> （或“ <span class="uicontrol bold">所有程序”</span> ），然后选择“ <span class="uicontrol bold">Oracle  -</span> <span class="bold"><span class="italic">HOME_NAME”</span></span> ，“ <span class="uicontrol bold">应用程序开发”</span> ，再选择“ <span class="uicontrol bold">SQL * Plus”</span> 。
                              </p>
                           </li>
                           <li>
                              <p>出现提示时，输入用于连接数据库的帐户的<span class="uicontrol bold">用户名</span>和<span class="uicontrol bold">密码</span> 。
                              </p>
                              <p>对于用户名，您可以使用<code class="codeph">SYS</code>或<code class="codeph">SYSTEM</code>管理帐户，并且可以使用在安装期间设置的密码。
                              </p>
                              <p>如果使用<code class="codeph">SYS</code>或<code class="codeph">/</code>作为用户名，请使用空格，然后使用<code class="codeph">AS</code> <code class="codeph">SYSDBA</code>子句，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">输入用户名：SYS AS SYSDBA输入密码： <span class="italic">password</span>或输入用户名：/ AS SYSDBA</pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-DE8A79BD-FAE4-4364-98FF-D2BD992A06E7__GUID-6DBC6F44-1A0A-4F19-90D5-3458752A8F01">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="administering-user-accounts-and-security.html#GUID-CF1CD853-AF15-41EC-BC80-61918C73FDB5" title="安装Oracle数据库时会自动创建SYS和SYSTEM管理用户帐户。它们都是使用您在安装时提供的密码创建的，并且它们都自动被授予DBA角色。">SYS和SYSTEM用户</a> ”</span> ，了解有关使用<code class="codeph">SYSTEM</code>帐户进行日常管理任务的建议替代方法的信息</p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="configuring-the-network-environment.html#GUID-1A15D322-B3AC-426A-86A1-EB7590930687" title="本节介绍如何使用SQL * Plus和简单连接命名方法从客户端计算机连接到Oracle数据库。">从客户端计算机连接到Oracle数据库</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="administering-user-accounts-and-security.html#GUID-3C78F89D-3616-48FA-B2B8-CE6988D78939" title="管理帐户和权限使您可以执行管理功能，例如管理用户，管理数据库内存以及启动和关闭数据库。">关于管理帐户和权限</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../admin/index.html" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a></p>
                              </li>
                              <li>
                                 <p><a href="../sqpug/starting-SQL-Plus.html#SQPUG352" target="_blank"><span><cite>SQL * Plus用户指南和参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADMQS12036"></a><div class="props_rev_3"><a id="GUID-5A09A54A-9ECA-40B8-B73A-65A5CB81DD04" name="GUID-5A09A54A-9ECA-40B8-B73A-65A5CB81DD04"></a><h4 id="ADMQS-GUID-5A09A54A-9ECA-40B8-B73A-65A5CB81DD04" class="sect4"><span class="enumeration_section">3.9.4</span>关于SQL Developer</h4>
                  <div>
                     <p>SQL Developer提供了另一个用于访问Oracle数据库的GUI。SQL Developer支持SQL和PL / SQL语言的开发。它在Oracle数据库的默认安装中可用。</p>
                     <p>使用SQL Developer，您可以浏览数据库对象，运行SQL语句和SQL脚本，以及编辑和调试PL / SQL语句。您还可以运行任意数量的报告，还可以创建和保存自己的报告。</p>
                     <p>您还可以从Oracle技术网（OTN）网站下载最新版本的SQL Developer。</p>
                     <div class="infoboxnotealso" id="GUID-5A09A54A-9ECA-40B8-B73A-65A5CB81DD04__GUID-9D3FA743-3FE3-4B2E-B96B-FE43FBD9A152">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关安装和使用SQL Developer的信息，请参阅<span class="q">“ <a href="managing-schema-objects.html#GUID-F565723B-46AF-42EC-BA3C-F738663DCC99" title="Oracle SQL Developer是SQL * Plus的图形化版本，它为数据库管理员提供了一种执行涉及模式对象的基本任务的便捷方式。">关于SQL Developer</a> ”</span></p>
                           </li>
                           <li>
                              <p>有关启动SQL Developer的说明，请参见<a href="../tdddg/connecting-exploring-database.html#TDDDG12200" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../cncpt/concepts-for-database-developers.html#CNCPT7654" target="_blank"><span><cite>Oracle数据库概念</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="ADMQS038"></a><div class="props_rev_3"><a id="GUID-90D9A35A-8A40-4205-9C10-BB49BEF72A0B" name="GUID-90D9A35A-8A40-4205-9C10-BB49BEF72A0B"></a><h3 id="ADMQS-GUID-90D9A35A-8A40-4205-9C10-BB49BEF72A0B" class="sect3"><span class="enumeration_section">3.10</span>数据库管理入门：Oracle示例系列</h3>
               <div>
                  <p>Oracle示例（OBE）有一系列关于<span class="italic">Oracle Database 2 Day DBA</span>指南的系列文章。本OBE将引导您完成本章中的任务，并包含带注释的屏幕截图。
                  </p>
                  <div class="section">
                     <p>要查看数据库管理OBE入门，请在Web浏览器中输入以下URL：</p>
                     <p><a href="https://apexapps.oracle.com/pls/apex/f?p=44785:24:0::NO:24:P24_CONTENT_ID:16825" target="_blank"><code class="codeph">https://apexapps.oracle.com/pls/apex/f?p=44785:24:0::NO:24:P24_CONTENT_ID:16825</code></a></p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <hr><br><p style="text-decoration:underline">脚注图例</p>脚注1：<p>在CDB中，此功能仅适用于CDB，不适用于单个PDB。</p><br></div>
      </article>
   </body>
</html><html id="01176.Rule-TYPEs.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This chapter describes the types used with rules, rule sets, and evaluation contexts."></meta>
      <meta name="description" content="This chapter describes the types used with rules, rule sets, and evaluation contexts."></meta>
      <title>规则类型</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="PL/SQL Packages and Types Reference"></meta>
      <meta property="og:description" content="This chapter describes the types used with rules, rule sets, and evaluation contexts."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="PL/SQL Packages and Types Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-pl-sql-packages-and-types-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-25T11:24:34-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96430-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="MGD_ID-Package-Types.html" title="Previous" type="text/html"></link>
      <link rel="next" href="SODA_TYPES.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference"></meta>
    <meta name="dcterms.isVersionOf" content="ARPLS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="MGD_ID-Package-Types.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="SODA_TYPES.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">PL / SQL包和类型参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">规则类型</li>
            </ol>
            <a id="GUID-8F7F6A05-3356-4B93-860D-78B0E1931C8B" name="GUID-8F7F6A05-3356-4B93-860D-78B0E1931C8B"></a><a id="ARPLS319"></a><a id="ARPLS319"></a>
            
            <h2 id="ARPLS-GUID-8F7F6A05-3356-4B93-860D-78B0E1931C8B" class="sect2"><span class="enumeration_chapter">281</span>规则类型</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍与规则，规则集和评估上下文一起使用的类型。</p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="Rule-TYPEs.html#GUID-E2621898-DE72-49F4-8456-02C94B91823C" title="这些类型在规则中使用，并使客户端能够使用规则引擎评估规则。">概观</a></p>
                  </li>
                  <li>
                     <p><a href="Rule-TYPEs.html#GUID-FBF1A00D-1783-4397-8EA9-FFB4056E1538" title="PUBLIC被授予对这些RULE类型的EXECUTE特权。">安全模型</a></p>
                  </li>
                  <li>
                     <p><a href="Rule-TYPEs.html#GUID-F5D7718F-78FF-4E63-82BD-A640C77BB9A4" title="此表列出了规则类型并简要描述了它们。">规则类型摘要</a></p>
                  </li>
               </ul>
            </div><a id="ARPLS73292"></a><a id="ARPLS73292"></a><div class="props_rev_3"><a id="GUID-E2621898-DE72-49F4-8456-02C94B91823C" name="GUID-E2621898-DE72-49F4-8456-02C94B91823C"></a><h3 id="ARPLS-GUID-E2621898-DE72-49F4-8456-02C94B91823C" class="sect3"><span class="enumeration_section">281.1</span>规则类型概述</h3>
               <div>
                  <p>这些类型在规则中使用，并使客户端能够使用规则引擎评估规则。</p>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-E2621898-DE72-49F4-8456-02C94B91823C__GUID-DEB785F2-6F75-47A5-9EB5-79FC3A20502B">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="DBMS_RULE.html#GUID-B846207D-78A5-4EB5-BE93-9224756F6CC0" title="DBMS_RULE包中包含的子程序可用于评估指定事件的规则集。">DBMS_RULE</a></p>
                           </li>
                           <li>
                              <p><a href="DBMS_RULE_ADM.html#GUID-3AC54B50-C163-43E0-AFB6-DD1B7C1CDF03" title="DBMS_RULE_ADM包提供用于创建和管理规则，规则集和规则评估上下文的子程序。">DBMS_RULE_ADM</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS73293"></a><a id="ARPLS73293"></a><div class="props_rev_3"><a id="GUID-FBF1A00D-1783-4397-8EA9-FFB4056E1538" name="GUID-FBF1A00D-1783-4397-8EA9-FFB4056E1538"></a><h3 id="ARPLS-GUID-FBF1A00D-1783-4397-8EA9-FFB4056E1538" class="sect3"><span class="enumeration_section">281.2</span>规则类型安全模型</h3>
               <div>
                  <p><code class="codeph">PUBLIC</code>被授予对这些RULE类型的<code class="codeph">EXECUTE</code>特权。
                  </p>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-FBF1A00D-1783-4397-8EA9-FFB4056E1538__GUID-8C87A603-8B63-462C-BAD3-E2E2B62155A5">
                        <p class="notep1">也可以看看：</p>
                        <p>有关用户组<code class="codeph">PUBLIC</code>详细信息，请<a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG40048" target="_blank"><span class="italic">参见“Oracle数据库安全指南”</span></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ARPLS822"></a><a id="ARPLS71919"></a><a id="ARPLS71919"></a><a id="ARPLS822"></a><div class="props_rev_3"><a id="GUID-F5D7718F-78FF-4E63-82BD-A640C77BB9A4" name="GUID-F5D7718F-78FF-4E63-82BD-A640C77BB9A4"></a><h3 id="ARPLS-GUID-F5D7718F-78FF-4E63-82BD-A640C77BB9A4" class="sect3"><span class="enumeration_section">281.3</span>规则类型摘要</h3>
               <div>
                  <p>此表列出了<code class="codeph">Rule Types</code>并简要描述了它们。
                  </p>
                  <div class="tblformal" id="GUID-F5D7718F-78FF-4E63-82BD-A640C77BB9A4__GUID-B773CF5D-E5F5-4997-AF98-C5E640A896B8">
                     <p class="titleintable">表281-1规则类型</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="规则类型" width="100%" border="1" summary="This table lists the Rule Types in alphabetical order and briefly describes them." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="42%" id="d1605288e443">类型</th>
                              <th align="left" valign="bottom" width="58%" id="d1605288e446">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e451" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-66F76A1D-DB2B-43D0-AE15-CB1368EA1125" title="RE $ ATTRIBUTE_VALUE类型指定变量属性的值。">RE $ ATTRIBUTE_VALUE类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e451 d1605288e446 ">
                                 <p>指定变量属性的值</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e465" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-C1B16B9A-740D-445F-B561-3A5E758FD73A" title="RE $ ATTRIBUTE_VALUE_LIST类型标识属性值列表。">RE $ ATTRIBUTE_VALUE_LIST类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e465 d1605288e446 ">
                                 <p>标识属性值列表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e480" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-A756F133-62C4-4F33-B5A8-508149836105" title="RE $ COLUMN_VALUE类型指定表列的值。">RE $ COLUMN_VALUE类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e480 d1605288e446 ">
                                 <p>指定表列的值</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e494" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-B4DBAE4D-BD5E-4343-98FC-46E0C72AEA46" title="RE $ COLUMN_VALUE_LIST类型标识列值列表。">RE $ COLUMN_VALUE_LIST类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e494 d1605288e446 ">
                                 <p>标识列值列表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e508" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-C98C3E09-ACF9-423A-BF53-1C71D5053A66" title="RE $ NAME_ARRAY类型标识名称列表。">RE $ NAME_ARRAY类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e508 d1605288e446 ">
                                 <p>标识名称列表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e522" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-C98C3E09-ACF9-423A-BF53-1C71D5053A66" title="RE $ NAME_ARRAY类型标识名称列表。">RE $ NAME_ARRAY类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e522 d1605288e446 ">
                                 <p>标识名称 - 值对的列表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e536" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274" title="标识包含名称 - 值对列表的对象以及对此列表进行操作的方法。">RE $ NV_LIST类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e536 d1605288e446 ">
                                 <p>标识包含名称 - 值对列表的对象以及对此列表进行操作的方法。此对象类型用于表示规则的事件上下文和操作上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e548" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-046D6972-5724-4AE1-B22B-02A605FC6FDF" title="RE $ COLUMN_VALUE类型标识名称 - 值对。">RE $ NV_NODE类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e548 d1605288e446 ">
                                 <p>标识名称 - 值对</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e562" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-BD91B0B5-CBC7-4BD3-BA21-3CF907285F13" title="RE $ RULE_HIT类型指定由于评估而找到的规则。">RE $ RULE_HIT类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e562 d1605288e446 ">
                                 <p>指定由于评估而找到的规则</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e577" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-B4D58719-CDF0-4BE2-977D-B17B910EC236" title="RE $ RULE_HIT_LIST类型标识由于评估而找到的规则列表。">RE $ RULE_HIT_LIST类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e577 d1605288e446 ">
                                 <p>标识由于评估而找到的规则列表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e592" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-1090B4F6-2AC3-40F6-BC90-29B3988EF1BD" title="RE $ RULE_HIT类型是create，允许用于传递规则列表作为参数。">RE $ RULE_NAME类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e592 d1605288e446 ">
                                 <p>允许用户将规则列表作为参数传递。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e608" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-D1A9F34A-9A66-4298-A15B-6C0C3E06AE2F" title="RE $ RULE_HIT_LIST type标识规则名称值的列表。">RE $ RULE_NAME_LIST类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e608 d1605288e446 ">
                                 <p>标识规则名称值的列表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e622" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-A0E1AEE9-D955-41FA-983F-C9A7A2C98A11" title="RE $ TABLE_ALIAS类型提供与规则评估上下文中使用的别名对应的表。">RE $ TABLE_ALIAS类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e622 d1605288e446 ">
                                 <p>提供与规则评估上下文中使用的别名对应的表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e636" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-2278B65F-2B5A-4934-87D5-7839C5516147" title="RE $ TABLE_ALIAS_LIST类型标识规则评估上下文中使用的表别名列表。">RE $ TABLE_ALIAS_LIST类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e636 d1605288e446 ">
                                 <p>标识规则评估上下文中使用的表别名列表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e651" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-2B77E586-8DE0-4DE4-BF99-51F18DD7B816" title="RE $ TABLE_VALUE类型使用ROWID指定表行的值。">RE $ TABLE_VALUE类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e651 d1605288e446 ">
                                 <p>使用<code class="codeph">ROWID</code>指定表行的值</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e671" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-6C381E6D-B306-43A6-8857-B6BA277665F9" title="RE $ TABLE_VALUE_LIST类型标识表值列表。">RE $ TABLE_VALUE_LIST类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e671 d1605288e446 ">
                                 <p>标识表值列表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e686" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-375A770A-B997-4D96-9708-324C110AFD71" title="RE $ VALUE类型表示一个数据点值元素。">RE $ VALUE类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e686 d1605288e446 ">
                                 <p>表示一个数据点值元素</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e701" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-31A9ABB9-5395-438D-9CFC-2BD227702B7F" title="RE $ TABLE_VALUE_LIST类型是用于定义RE $ VALUE类型列表的varray。它表示数据点元素的列表。">RE $ VALUE_LIST类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e701 d1605288e446 ">
                                 <p>定义<code class="codeph">RE$VALUE</code>类型的列表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e721" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221" title="RE $ VARIABLE_TYPE类型提供规则评估上下文中使用的变量的类型。指定的变量名称必须满足架构对象命名规则。">RE $ VARIABLE_TYPE类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e721 d1605288e446 ">
                                 <p>提供规则评估上下文中使用的变量的类型</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e736" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-C6E738A8-F0B2-4EFD-B2D0-83C7F4C0F832" title="RE $ VARIABLE_TYPE_LIST类型标识规则评估上下文中使用的变量及其类型的列表。">RE $ VARIABLE_TYPE_LIST类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e736 d1605288e446 ">
                                 <p>标识规则评估上下文中使用的变量及其类型的列表</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e751" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-67420543-C600-4AAE-8647-A11DC15990E9" title="RE $ VARIABLE_VALUE类型指定变量的值。">RE $ VARIABLE_VALUE类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e751 d1605288e446 ">
                                 <p>指定变量的值</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="42%" id="d1605288e766" headers="d1605288e443 ">
                                 <p><a href="Rule-TYPEs.html#GUID-29C791A6-E5AD-409F-B9FE-8A3CE01BBF2A" title="RE $ VARIABLE_VALUE_LIST类型标识变量值列表。">RE $ VARIABLE_VALUE_LIST类型</a></p>
                              </td>
                              <td align="left" valign="top" width="58%" headers="d1605288e766 d1605288e446 ">
                                 <p>标识变量值列表</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>规则类型与以下Oracle提供的PL / SQL包一起使用：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">DBMS_RULE</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DBMS_RULE_ADM</code></p>
                        </li>
                     </ul>
                     <p>您可以使用<code class="codeph">DBMS_RULE_ADM</code>包来创建和管理规则，规则集和评估上下文，并且可以使用<code class="codeph">DBMS_RULE</code>包来评估规则。
                     </p>
                     <p>使用复制（Oracle GoldenGate和XStream）时，规则确定捕获进程捕获哪些更改，传播传播哪些消息，应用进程应用哪些消息，以及消息传递客户端将哪些消息出列。以下复制（Oracle GoldenGate和XStream）包使用规则：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">DBMS_APPLY_ADM</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DBMS_CAPTURE_ADM</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DBMS_PROPAGATION_ADM</code></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="ARPLS571"></a><a id="ARPLS71920"></a><a id="ARPLS71920"></a><a id="ARPLS571"></a><div class="props_rev_3"><a id="GUID-66F76A1D-DB2B-43D0-AE15-CB1368EA1125" name="GUID-66F76A1D-DB2B-43D0-AE15-CB1368EA1125"></a><h4 id="ARPLS-GUID-66F76A1D-DB2B-43D0-AE15-CB1368EA1125" class="sect4"><span class="enumeration_section">281.3.1</span> RE $ ATTRIBUTE_VALUE类型</h4>
                  <div>
                     <p><code class="codeph">RE$ATTRIBUTE_VALUE</code>类型指定变量属性的值。
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-66F76A1D-DB2B-43D0-AE15-CB1368EA1125__GUID-CDD3E058-58BB-45A3-8F3E-5E6CC286F04B">
                           <p class="notep1">注意：</p>
                           <p>如果名称包含特殊字符，请将变量名称和属性名称括在双引号（“）中。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-66F76A1D-DB2B-43D0-AE15-CB1368EA1125__GUID-6BDE69EF-071A-4065-B720-F4BBEE031A73">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ ATTRIBUTE_VALUE（variable_name VARCHAR2（32），attribute_name VARCHAR2（4000），attribute_value ANYDATA）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-66F76A1D-DB2B-43D0-AE15-CB1368EA1125__GUID-26DA7A5B-A332-4FED-906D-31DB1F76E19B">属性</p>
                        <div class="tblformal" id="GUID-66F76A1D-DB2B-43D0-AE15-CB1368EA1125__GUID-2C5EAF7F-08C1-4EC1-B9A3-AE840764B544">
                           <p class="titleintable">表281-2 RE $ ATTRIBUTE_VALUE属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ ATTRIBUTE_VALUE属性" width="100%" border="1" summary="This table describes Attributes of the RuleType RE$ATTRIBUTE_VALUE." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d1605288e935">属性</th>
                                    <th align="left" valign="bottom" width="69%" id="d1605288e938">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e943" headers="d1605288e935 ">
                                       <p><code class="codeph">变量名</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e943 d1605288e938 ">
                                       <p>指定规则中使用的变量</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e951" headers="d1605288e935 ">
                                       <p><code class="codeph">ATTRIBUTE_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e951 d1605288e938 ">
                                       <p>指定属性名称。属性名称可以是多组件名称，例如<code class="codeph">a1.b2.c3</code> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e962" headers="d1605288e935 ">
                                       <p><code class="codeph">ATTRIBUTE_VALUE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e962 d1605288e938 ">
                                       <p>指定属性值</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS572"></a><a id="ARPLS572"></a><div class="props_rev_3"><a id="GUID-C1B16B9A-740D-445F-B561-3A5E758FD73A" name="GUID-C1B16B9A-740D-445F-B561-3A5E758FD73A"></a><h4 id="ARPLS-GUID-C1B16B9A-740D-445F-B561-3A5E758FD73A" class="sect4"><span class="enumeration_section">281.3.2</span> RE $ ATTRIBUTE_VALUE_LIST类型</h4>
                  <div>
                     <p><code class="codeph">RE$ATTRIBUTE_VALUE_LIST</code>类型标识属性值列表。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C1B16B9A-740D-445F-B561-3A5E758FD73A__GUID-A64B57F7-74C1-478C-91DF-F8E640986D7F">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ ATTRIBUTE_VALUE_LIST AS VARRAY（1024）OF SYS.RE $ ATTRIBUTE_VALUE;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS573"></a><a id="ARPLS71921"></a><a id="ARPLS71921"></a><a id="ARPLS573"></a><div class="props_rev_3"><a id="GUID-A756F133-62C4-4F33-B5A8-508149836105" name="GUID-A756F133-62C4-4F33-B5A8-508149836105"></a><h4 id="ARPLS-GUID-A756F133-62C4-4F33-B5A8-508149836105" class="sect4"><span class="enumeration_section">281.3.3</span> RE $ COLUMN_VALUE类型</h4>
                  <div>
                     <p><code class="codeph">RE$COLUMN_VALUE</code>类型指定表列的值。
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-A756F133-62C4-4F33-B5A8-508149836105__GUID-D9CF63EB-37DC-46F5-99F6-F64B7B6836ED">
                           <p class="notep1">注意：</p>
                           <p>如果名称包含特殊字符，请将列名括在双引号（“）中。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-A756F133-62C4-4F33-B5A8-508149836105__GUID-A4807DDB-73BE-4132-A73E-CF523E1416FF">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ COLUMN_VALUE（table_alias VARCHAR2（32），column_name VARCHAR2（4000），column_value ANYDATA）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-A756F133-62C4-4F33-B5A8-508149836105__GUID-015DF46C-EBB1-4A01-A990-D24A3D709F98">属性</p>
                        <div class="tblformal" id="GUID-A756F133-62C4-4F33-B5A8-508149836105__GUID-B2651771-184B-4AF1-84BB-B7FE16A5A33D">
                           <p class="titleintable">表281-3 RE $ COLUMN_VALUE属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ COLUMN_VALUE属性" width="100%" border="1" summary="This table describes Attributes of the RuleType RE$COLUMN_V ALUE." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d1605288e1192">属性</th>
                                    <th align="left" valign="bottom" width="69%" id="d1605288e1195">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e1200" headers="d1605288e1192 ">
                                       <p><code class="codeph">table_alias</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e1200 d1605288e1195 ">
                                       <p>指定规则中用于表的别名</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e1208" headers="d1605288e1192 ">
                                       <p><code class="codeph">列名</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e1208 d1605288e1195 ">
                                       <p>指定列名称</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e1216" headers="d1605288e1192 ">
                                       <p><code class="codeph">COLUMN_VALUE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e1216 d1605288e1195 ">
                                       <p>指定列值</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS574"></a><a id="ARPLS574"></a><div class="props_rev_3"><a id="GUID-B4DBAE4D-BD5E-4343-98FC-46E0C72AEA46" name="GUID-B4DBAE4D-BD5E-4343-98FC-46E0C72AEA46"></a><h4 id="ARPLS-GUID-B4DBAE4D-BD5E-4343-98FC-46E0C72AEA46" class="sect4"><span class="enumeration_section">281.3.4</span> RE $ COLUMN_VALUE_LIST类型</h4>
                  <div>
                     <p><code class="codeph">RE$COLUMN_VALUE_LIST</code>类型标识列值列表。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-B4DBAE4D-BD5E-4343-98FC-46E0C72AEA46__GUID-F8DDAE66-73CC-46ED-AA01-5E5C36906577">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ COLUMN_VALUE_LIST AS VARRAY（1024）OF SYS.RE $ COLUMN_VALUE;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS575"></a><a id="ARPLS575"></a><div class="props_rev_3"><a id="GUID-C98C3E09-ACF9-423A-BF53-1C71D5053A66" name="GUID-C98C3E09-ACF9-423A-BF53-1C71D5053A66"></a><h4 id="ARPLS-GUID-C98C3E09-ACF9-423A-BF53-1C71D5053A66" class="sect4"><span class="enumeration_section">281.3.5</span> RE $ NAME_ARRAY类型</h4>
                  <div>
                     <p><code class="codeph">RE$NAME_ARRAY</code>类型标识名称列表。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C98C3E09-ACF9-423A-BF53-1C71D5053A66__GUID-FCA886A1-C076-4D06-845E-3594DE7F020D">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ NAME_ARRAY AS VARRAR（1024）OF VARCHAR2（30）;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS576"></a><a id="ARPLS576"></a><div class="props_rev_3"><a id="GUID-4F7A31B7-29D3-424E-87F1-11EA6B9ABB67" name="GUID-4F7A31B7-29D3-424E-87F1-11EA6B9ABB67"></a><h4 id="ARPLS-GUID-4F7A31B7-29D3-424E-87F1-11EA6B9ABB67" class="sect4"><span class="enumeration_section">281.3.6</span> RE $ NV_ARRAY类型</h4>
                  <div>
                     <p><code class="codeph">RE$NV_ARRAY</code>类型标识名称 - 值对的列表。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4F7A31B7-29D3-424E-87F1-11EA6B9ABB67__GUID-690AC72D-A2E5-4481-A9EE-B57C4BEB1848">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ NV_ARRAY AS VARRAY（1024）OF SYS.RE $ NV_NODE;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS577"></a><a id="ARPLS71923"></a><a id="ARPLS71924"></a><a id="ARPLS71925"></a><a id="ARPLS71926"></a><a id="ARPLS71927"></a><a id="ARPLS71928"></a><a id="ARPLS71929"></a><a id="ARPLS71930"></a><a id="ARPLS71931"></a><a id="ARPLS71932"></a><a id="ARPLS71933"></a><a id="ARPLS71923"></a><a id="ARPLS71924"></a><a id="ARPLS71925"></a><a id="ARPLS71926"></a><a id="ARPLS71927"></a><a id="ARPLS71928"></a><a id="ARPLS71929"></a><a id="ARPLS71930"></a><a id="ARPLS71931"></a><a id="ARPLS71932"></a><a id="ARPLS71933"></a><a id="ARPLS577"></a><div class="props_rev_3"><a id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274" name="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274"></a><h4 id="ARPLS-GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274" class="sect4"><span class="enumeration_section">281.3.7</span> RE $ NV_LIST类型</h4>
                  <div>
                     <p>标识包含名称 - 值对列表的对象以及对此列表进行操作的方法。</p>
                     <div class="section">
                        <p>此对象类型用于表示规则集评估的事件上下文和规则的操作上下文。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-28F5FC1D-3E1F-4E71-BFBA-D6DD97B86CE7">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ NV_LIST AS OBJECT（actx_list SYS.RE $ NV_ARRAY）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-3FC07F8E-CAF0-4916-9AD8-091CE8604E41">属性</p>
                        <div class="tblformal" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-263E2093-F412-4B1B-9BDA-21D8091553DD">
                           <p class="titleintable">表281-4 RE $ NV_LIST属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ NV_LIST属性" width="100%" border="1" summary="This table describes Attributes of the RuleType  RE$NV_LIST." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d1605288e1715">属性</th>
                                    <th align="left" valign="bottom" width="69%" id="d1605288e1718">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e1723" headers="d1605288e1715 ">
                                       <p><code class="codeph">actx_list</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e1723 d1605288e1718 ">
                                       <p>名称 - 值对列表</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-C90C433F-F2BC-45DD-AC90-67B15680FACF">RE $ NV_LIST子程序</p>
                        <p>本节介绍<code class="codeph">SYS.RE$NV_LIST</code>类型的以下成员过程和成员函数：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="Rule-TYPEs.html#GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__I997111">ADD_PAIR会员程序</a></p>
                           </li>
                           <li>
                              <p><a href="Rule-TYPEs.html#GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__CHDDFAIC">GET_ALL_NAMES会员功能</a></p>
                           </li>
                           <li>
                              <p><a href="Rule-TYPEs.html#GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__I997145">GET_VALUE成员函数</a></p>
                           </li>
                           <li>
                              <p><a href="Rule-TYPEs.html#GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__I997168">REMOVE_PAIR会员程序</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__I997111">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-2418EB15-6F89-4C9A-84A4-93BD83B056FF">ADD_PAIR会员程序</p>
                        <p>将名称 - 值对添加到名称 - 值对列表中。</p>
                        <div class="infoboxnote" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-80BD348B-0BD9-44AD-B0C3-FE7BF06553F1">
                           <p class="notep1">注意：</p>
                           <p>如果名称包含特殊字符，请将名称括在双引号（“）中。</p>
                        </div>
                        <p>句法</p><pre class="oac_no_warn" dir="ltr">成员程序ADD_PAIR（名称IN VARCHAR2，值IN ANYDATA）;</pre><p>参数</p>
                        <div class="tblformal" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-E19ED44D-DEDE-494D-A39D-54E9F8FE0B4C">
                           <p class="titleintable">表281-5 ADD_PAIR过程参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="ADD_PAIR过程参数" width="100%" border="1" summary="This table describes the Parameters of the SYS.RE$NV_LIST type member subprogam ADD_PAIR." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d1605288e1779">参数</th>
                                    <th align="left" valign="bottom" width="69%" id="d1605288e1782">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e1787" headers="d1605288e1779 ">
                                       <p><code class="codeph">名称</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e1787 d1605288e1782 ">
                                       <p>名称 - 值对中的名称将添加到列表中。如果列表中存在该名称，则此过程会引发错误。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e1795" headers="d1605288e1779 ">
                                       <p><code class="codeph">值</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e1795 d1605288e1782 ">
                                       <p>要添加到列表中的名称 - 值对中的值</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__CHDDFAIC">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-BCA1DDFC-B8A0-4BB1-BAC2-4AE4A7C93A9C">GET_ALL_NAMES会员功能</p>
                        <p>返回名称 - 值对列表中所有名称的列表。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-19D36B7A-CE70-43BE-BBDF-A72E4BCB5A0B">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">成员函数GET_ALL_NAMES（）返回SYS.RE $ NAME_ARRAY;</pre></div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__I997145">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-86757AE5-12E4-445A-BED8-4F4593DF731A">GET_VALUE成员函数</p>
                        <p>返回名称 - 值对列表中指定名称的值。</p>
                        <div class="infoboxnote" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-8347A070-B5AA-4DA9-82B7-8E07006F0FA7">
                           <p class="notep1">注意：</p>
                           <p>如果名称包含特殊字符，请将名称括在双引号（“）中。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-BC77F195-9710-420C-9335-8AEFE96B4058">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">成员函数GET_VALUE（名称IN VARCHAR2）返回ANYDATA;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-9E301E65-024C-4B84-A926-E02366EA3712">参数</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-E992CCDE-21BA-4609-A8EE-E2D1081465F5">
                        <p class="titleintable">表281-6 GET_VALUE函数参数</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="GET_VALUE函数参数" width="100%" border="1" summary="This table describes the Parameters of the SYS.RE$NV_LIST type member subprogam GET_VALUE." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d1605288e1841">参数</th>
                                 <th align="left" valign="bottom" width="69%" id="d1605288e1844">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d1605288e1849" headers="d1605288e1841 ">
                                    <p><code class="codeph">名称</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d1605288e1849 d1605288e1844 ">
                                    <p>要返回其值的名称</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__I997168">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-AFBBE58E-1F02-436A-AC58-95CEA484EF8D">REMOVE_PAIR会员程序</p>
                        <p>从名称 - 值对列表中删除具有指定名称的名称 - 值对。</p>
                        <div class="infoboxnote" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-EB043578-2B03-4CC8-BFF8-F0F4F1090AD7">
                           <p class="notep1">注意：</p>
                           <p>如果名称包含特殊字符，请将名称括在双引号（“）中。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-8EBC0C7F-B9C1-4EEA-A0A1-1CEA6371AA9E">句法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">会员程序REMOVE_PAIR（名称IN VARCHAR2）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-ECF327FB-3A37-459B-AD3D-A74EE5C8ACC3">参数</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-59062511-EE10-4AFD-B4C2-86F88E3F0274__GUID-E0C6E64A-86E8-48FE-B1E2-BF61DCF72428">
                        <p class="titleintable">表281-7 REMOVE_PAIR过程参数</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="REMOVE_PAIR过程参数" width="100%" border="1" summary="This table describes the Parameters of the SYS.RE$NV_LIST type member subprogam REMOVE_PAIR." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d1605288e1883">参数</th>
                                 <th align="left" valign="bottom" width="69%" id="d1605288e1886">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d1605288e1891" headers="d1605288e1883 ">
                                    <p><code class="codeph">名称</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d1605288e1891 d1605288e1886 ">
                                    <p>要删除的对的名称</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="ARPLS578"></a><a id="ARPLS71934"></a><a id="ARPLS71934"></a><a id="ARPLS578"></a><div class="props_rev_3"><a id="GUID-046D6972-5724-4AE1-B22B-02A605FC6FDF" name="GUID-046D6972-5724-4AE1-B22B-02A605FC6FDF"></a><h4 id="ARPLS-GUID-046D6972-5724-4AE1-B22B-02A605FC6FDF" class="sect4"><span class="enumeration_section">281.3.8</span> RE $ NV_NODE类型</h4>
                  <div>
                     <p><code class="codeph">RE$COLUMN_VALUE</code>类型标识名称 - 值对。
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-046D6972-5724-4AE1-B22B-02A605FC6FDF__GUID-B1073B57-BD02-4999-845B-0D72F706EFDE">
                           <p class="notep1">注意：</p>
                           <p>如果名称包含特殊字符，请将名称括在双引号（“）中。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-046D6972-5724-4AE1-B22B-02A605FC6FDF__GUID-C97A3D25-ADE9-42CB-8DE0-3A879C7A1B81">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ NV_NODE（nvn_name VARCHAR2（30），nvn_value ANYDATA）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-046D6972-5724-4AE1-B22B-02A605FC6FDF__GUID-D909002C-59A1-45C9-884B-62863319ECAA">属性</p>
                        <div class="tblformal" id="GUID-046D6972-5724-4AE1-B22B-02A605FC6FDF__GUID-D84CB080-DEBC-43AD-840A-B93CC1D596C2">
                           <p class="titleintable">表281-8 RE $ NV_NODE属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ NV_NODE属性" width="100%" border="1" summary="This table describes Attributes of the RuleType RE$NV_NODE." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d1605288e2019">属性</th>
                                    <th align="left" valign="bottom" width="69%" id="d1605288e2022">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e2027" headers="d1605288e2019 ">
                                       <p><code class="codeph">nvn_name</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e2027 d1605288e2022 ">
                                       <p>指定名称 - 值对中的名称</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e2035" headers="d1605288e2019 ">
                                       <p><code class="codeph">nvn_value</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e2035 d1605288e2022 ">
                                       <p>指定名称 - 值对中的值</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS579"></a><a id="ARPLS71935"></a><a id="ARPLS71935"></a><a id="ARPLS579"></a><div class="props_rev_3"><a id="GUID-BD91B0B5-CBC7-4BD3-BA21-3CF907285F13" name="GUID-BD91B0B5-CBC7-4BD3-BA21-3CF907285F13"></a><h4 id="ARPLS-GUID-BD91B0B5-CBC7-4BD3-BA21-3CF907285F13" class="sect4"><span class="enumeration_section">281.3.9</span> RE $ RULE_HIT类型</h4>
                  <div>
                     <p><code class="codeph">RE$RULE_HIT</code>类型指定由于评估而找到的规则。
                     </p>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-BD91B0B5-CBC7-4BD3-BA21-3CF907285F13__GUID-9001400A-7BCA-4677-8095-1519E14AF4BA">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="DBMS_RULE_ADM.html#GUID-153359B7-F63E-4E1E-B9F2-A4B06C8C0CE7" title="此过程创建规则。">CREATE_RULE过程</a></p>
                              </li>
                              <li>
                                 <p><a href="DBMS_RULE_ADM.html#GUID-BFF7D165-FDF5-4726-BCBE-5A234BCE93B9" title="此过程更改指定规则的一个或多个方面。">ALTER_RULE程序</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BD91B0B5-CBC7-4BD3-BA21-3CF907285F13__GUID-41EA7B3E-6F92-4DB6-91C6-190C681304C7">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ RULE_HIT（rule_name VARCHAR2（65），rule_action_context RE $ NV_LIST）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BD91B0B5-CBC7-4BD3-BA21-3CF907285F13__GUID-55078AE1-7B0D-450C-97CF-20A3E987B59F">属性</p>
                        <div class="tblformal" id="GUID-BD91B0B5-CBC7-4BD3-BA21-3CF907285F13__GUID-F1968F03-9AA8-4040-B379-1303DD1F6813">
                           <p class="titleintable">表281-9 RE $ RULE_HIT属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ RULE_HIT属性" width="100%" border="1" summary="This table describes Attributes of the RuleType RE$RULE_HIT." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d1605288e2178">属性</th>
                                    <th align="left" valign="bottom" width="69%" id="d1605288e2181">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e2186" headers="d1605288e2178 ">
                                       <p><code class="codeph">RULE_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e2186 d1605288e2181 ">
                                       <p><span class="italic"><code class="codeph">schema_name.rule_name</code></span>形式的规则名称。例如， <code class="codeph">hr</code>模式中名为<code class="codeph">employee_rule</code>的规则以“ <code class="codeph">hr"."employee_rule"</code>的形式返回。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e2207" headers="d1605288e2178 ">
                                       <p><code class="codeph">rule_action_context</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e2207 d1605288e2181 ">
                                       <p>在指定的规则动作上下文<code class="codeph">CREATE_RULE</code>或<code class="codeph">ALTER_RULE</code>所述的程序<code class="codeph">DBMS_RULE_ADM</code>包</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS580"></a><a id="ARPLS580"></a><div class="props_rev_3"><a id="GUID-B4D58719-CDF0-4BE2-977D-B17B910EC236" name="GUID-B4D58719-CDF0-4BE2-977D-B17B910EC236"></a><h4 id="ARPLS-GUID-B4D58719-CDF0-4BE2-977D-B17B910EC236" class="sect4"><span class="enumeration_section">281.3.10</span> RE $ RULE_HIT_LIST类型</h4>
                  <div>
                     <p><code class="codeph">RE$RULE_HIT_LIST</code>类型标识由于评估而找到的规则列表。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-B4D58719-CDF0-4BE2-977D-B17B910EC236__GUID-FF311537-A3E1-4791-93A2-F5CA445169C4">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ RULE_HIT_LIST AS VARRAY（1024）OF SYS.RE $ RULE_HIT;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS74464"></a><a id="ARPLS74465"></a><a id="ARPLS74465"></a><a id="ARPLS74464"></a><div class="props_rev_3"><a id="GUID-1090B4F6-2AC3-40F6-BC90-29B3988EF1BD" name="GUID-1090B4F6-2AC3-40F6-BC90-29B3988EF1BD"></a><h4 id="ARPLS-GUID-1090B4F6-2AC3-40F6-BC90-29B3988EF1BD" class="sect4"><span class="enumeration_section">281.3.11</span> RE $ RULE_NAME类型</h4>
                  <div>
                     <p><code class="codeph">RE$RULE_HIT</code>类型是create，允许用于传递规则列表作为参数。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-1090B4F6-2AC3-40F6-BC90-29B3988EF1BD__GUID-F37FC213-B00D-4D21-B7D7-1A07368CBDF1">句法</p><pre class="oac_no_warn" dir="ltr">创建或替换类型SYS.RE $ RULE_NAME AS OBJECT（rule_name IN varchar2，evaluation_context IN varchar2）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1090B4F6-2AC3-40F6-BC90-29B3988EF1BD__GUID-6A856CFD-B6EE-4F69-8103-C1BCE7CB1C15">属性</p>
                        <div class="tblformal" id="GUID-1090B4F6-2AC3-40F6-BC90-29B3988EF1BD__GUID-D2484309-5587-4A7A-AD50-3C3851D2B542">
                           <p class="titleintable">表281-10 RE $ RULE_NAME属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ RULE_NAME属性" width="100%" border="1" summary="This table describes Attributes of the RuleType RE$RULE_NAME." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d1605288e2443">属性</th>
                                    <th align="left" valign="bottom" width="69%" id="d1605288e2446">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e2451" headers="d1605288e2443 ">
                                       <p><code class="codeph">RULE_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e2451 d1605288e2446 ">
                                       <p><span class="italic"><code class="codeph">SCHEMA_NAME.RULE_NAME</code></span>表单中的规则名称。例如， <code class="codeph">hr</code>模式中名为<code class="codeph">employee_rule</code>的规则以“ <code class="codeph">hr"."employee_rule"</code>的形式返回。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e2472" headers="d1605288e2443 ">
                                       <p><code class="codeph">Evaluation_context</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e2472 d1605288e2446 ">
                                       <p><code class="codeph">DBMS_RULE_ADM</code>包的<code class="codeph">CREATE_RULE</code>或<code class="codeph">ALTER_RULE</code>过程中指定的评估上下文</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS74466"></a><a id="ARPLS74466"></a><div class="props_rev_3"><a id="GUID-D1A9F34A-9A66-4298-A15B-6C0C3E06AE2F" name="GUID-D1A9F34A-9A66-4298-A15B-6C0C3E06AE2F"></a><h4 id="ARPLS-GUID-D1A9F34A-9A66-4298-A15B-6C0C3E06AE2F" class="sect4"><span class="enumeration_section">281.3.12</span> RE $ RULE_NAME_LIST类型</h4>
                  <div>
                     <p><code class="codeph">RE$RULE_HIT_LIST</code> type标识规则名称值的列表。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-D1A9F34A-9A66-4298-A15B-6C0C3E06AE2F__GUID-426F9526-4069-4EED-BA7E-A2D7722358B7">句法</p><pre class="oac_no_warn" dir="ltr">创建或替换SYS.RE $ RULE_NAME的类型SYS.RE $ RULE_NAME_LIST AS VARRAY（1024）;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS581"></a><a id="ARPLS71936"></a><a id="ARPLS71936"></a><a id="ARPLS581"></a><div class="props_rev_3"><a id="GUID-A0E1AEE9-D955-41FA-983F-C9A7A2C98A11" name="GUID-A0E1AEE9-D955-41FA-983F-C9A7A2C98A11"></a><h4 id="ARPLS-GUID-A0E1AEE9-D955-41FA-983F-C9A7A2C98A11" class="sect4"><span class="enumeration_section">281.3.13</span> RE $ TABLE_ALIAS类型</h4>
                  <div>
                     <p><code class="codeph">RE$TABLE_ALIAS</code>类型提供与规则评估上下文中使用的别名对应的表。
                     </p>
                     <div class="section">
                        <p>指定的表名必须满足架构对象命名规则。</p>
                        <div class="infoboxnote" id="GUID-A0E1AEE9-D955-41FA-983F-C9A7A2C98A11__GUID-ABF20AF4-9D51-4184-9FE2-0F066DA5BF0B">
                           <p class="notep1">注意：</p>
                           <p>如果名称包含特殊字符，请将表名括在双引号（“）中。</p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-A0E1AEE9-D955-41FA-983F-C9A7A2C98A11__GUID-5F64E826-2F47-4F14-898F-3AE312528093">
                           <p class="notep1">也可以看看：</p>
                           <p>有关架构对象命名规则的信息，请<a href="../sqlrf/Basic-Elements-of-Oracle-SQL.html#SQLRF002" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-A0E1AEE9-D955-41FA-983F-C9A7A2C98A11__GUID-92D4E4D9-AA99-4D5C-ABB6-2712CB25ACC1">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ TABLE_ALIAS是OBJECT（table_alias VARCHAR2（32），table_name VARCHAR2（194））;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-A0E1AEE9-D955-41FA-983F-C9A7A2C98A11__GUID-A8BD49A3-2846-48FF-9ECB-15900CBAF4D1">属性</p>
                        <div class="tblformal" id="GUID-A0E1AEE9-D955-41FA-983F-C9A7A2C98A11__GUID-C8762783-9E39-4B95-A89F-FB46CA0FF78B">
                           <p class="titleintable">表281-11 RE $ TABLE_ALIAS属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ TABLE_ALIAS属性" width="100%" border="1" summary="This table describes Attributes of the RuleType RE$TABLE_ALIAS." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="21%" id="d1605288e2718">属性</th>
                                    <th align="left" valign="bottom" width="79%" id="d1605288e2721">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d1605288e2726" headers="d1605288e2718 ">
                                       <p><code class="codeph">table_alias</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d1605288e2726 d1605288e2721 ">
                                       <p>用于规则中表的别名</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d1605288e2734" headers="d1605288e2718 ">
                                       <p><code class="codeph">TABLE_NAME</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d1605288e2734 d1605288e2721 ">
                                       <p>别名引用的表名。可以指定同义词。表名在评估上下文模式中解析。</p>
                                       <p>格式为以下之一：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">schema_name</span> 。 <span class="italic">table_name</span> <span class="italic">table_name</span>
</pre><p>例如，如果<span class="italic"><code class="codeph">schema_name</code></span>为<code class="codeph">hr</code>且<span class="italic"><code class="codeph">table_name</code></span>为<code class="codeph">employees</code> ，则输入以下内容：</p><pre class="oac_no_warn" dir="ltr">HR.EMPLOYEES</pre></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS582"></a><a id="ARPLS582"></a><div class="props_rev_3"><a id="GUID-2278B65F-2B5A-4934-87D5-7839C5516147" name="GUID-2278B65F-2B5A-4934-87D5-7839C5516147"></a><h4 id="ARPLS-GUID-2278B65F-2B5A-4934-87D5-7839C5516147" class="sect4"><span class="enumeration_section">281.3.14</span> RE $ TABLE_ALIAS_LIST类型</h4>
                  <div>
                     <p><code class="codeph">RE$TABLE_ALIAS_LIST</code>类型标识规则评估上下文中使用的表别名列表。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-2278B65F-2B5A-4934-87D5-7839C5516147__GUID-BF20FCD3-E210-405E-85E3-DFF01617A596">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ TABLE_ALIAS_LIST AS VARRAY（1024）OF SYS.RE $ TABLE_ALIAS;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS583"></a><a id="ARPLS71937"></a><a id="ARPLS71937"></a><a id="ARPLS583"></a><div class="props_rev_3"><a id="GUID-2B77E586-8DE0-4DE4-BF99-51F18DD7B816" name="GUID-2B77E586-8DE0-4DE4-BF99-51F18DD7B816"></a><h4 id="ARPLS-GUID-2B77E586-8DE0-4DE4-BF99-51F18DD7B816" class="sect4"><span class="enumeration_section">281.3.15</span> RE $ TABLE_VALUE类型</h4>
                  <div>
                     <p><code class="codeph">RE$TABLE_VALUE</code>类型使用<code class="codeph">ROWID</code>指定表行的值。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-2B77E586-8DE0-4DE4-BF99-51F18DD7B816__GUID-3A877B46-55F7-4F64-BD61-4A3E300DCA68">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ TABLE_VALUE（table_alias VARCHAR2（32），table_rowid VARCHAR2（18））;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-2B77E586-8DE0-4DE4-BF99-51F18DD7B816__GUID-5D40FB47-C9D1-4551-ABE1-766F6999195B">属性</p>
                        <div class="tblformal" id="GUID-2B77E586-8DE0-4DE4-BF99-51F18DD7B816__GUID-F094AC66-29EE-4F77-ACA3-969F03908B59">
                           <p class="titleintable">表281-12 RE $ TABLE_VALUE属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ TABLE_VALUE属性" width="100%" border="1" summary="This table describes Attributes of the RuleType RE$TABLE_VALUE." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d1605288e2994">属性</th>
                                    <th align="left" valign="bottom" width="69%" id="d1605288e2997">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e3002" headers="d1605288e2994 ">
                                       <p><code class="codeph">table_alias</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e3002 d1605288e2997 ">
                                       <p>指定规则中用于表的别名</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e3010" headers="d1605288e2994 ">
                                       <p><code class="codeph">table_rowid</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e3010 d1605288e2997 ">
                                       <p>指定表行的rowid</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS584"></a><a id="ARPLS584"></a><div class="props_rev_3"><a id="GUID-6C381E6D-B306-43A6-8857-B6BA277665F9" name="GUID-6C381E6D-B306-43A6-8857-B6BA277665F9"></a><h4 id="ARPLS-GUID-6C381E6D-B306-43A6-8857-B6BA277665F9" class="sect4"><span class="enumeration_section">281.3.16</span> RE $ TABLE_VALUE_LIST类型</h4>
                  <div>
                     <p><code class="codeph">RE$TABLE_VALUE_LIST</code>类型标识表值列表。
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-6C381E6D-B306-43A6-8857-B6BA277665F9__GUID-022DA62D-1137-40DA-BBC2-48647A9E3947">
                           <p class="notep1">注意：</p>
                           <p>列表中列表中的每个表别名必须是唯一的。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6C381E6D-B306-43A6-8857-B6BA277665F9__GUID-B8E1331B-6B1D-49D4-97EF-44A08DAFB02D">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ TABLE_VALUE_LIST AS VARRAY（1024）OF SYS.RE $ TABLE_VALUE;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS74467"></a><a id="ARPLS74468"></a><a id="ARPLS74468"></a><a id="ARPLS74467"></a><div class="props_rev_3"><a id="GUID-375A770A-B997-4D96-9708-324C110AFD71" name="GUID-375A770A-B997-4D96-9708-324C110AFD71"></a><h4 id="ARPLS-GUID-375A770A-B997-4D96-9708-324C110AFD71" class="sect4"><span class="enumeration_section">281.3.17</span> RE $ VALUE类型</h4>
                  <div>
                     <p><code class="codeph">RE$VALUE</code>类型表示一个数据点值元素。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-375A770A-B997-4D96-9708-324C110AFD71__GUID-3DA61193-A1EC-4EE4-B0A4-5FDB0DAAF221">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ VALUE（table_values IN SYS.RE $ TABLE_VALUE_LIST：= NULL，column_values IN SYS.RE $ COLUMN_VALUE_LIST：= NULL，variable_values IN SYS.RE $ VARIABLE_VALUE_LIST：= NULL，attribute_values IN SYS.RE $ ATTRIBUTE_VALUE_LIST：= NULL ）</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-375A770A-B997-4D96-9708-324C110AFD71__GUID-721858ED-6B4B-4372-A4B7-5533F6277C61">属性</p>
                        <div class="tblformal" id="GUID-375A770A-B997-4D96-9708-324C110AFD71__GUID-9065E8A8-FF0B-47AE-B2C7-C7BFD0CF9A95">
                           <p class="titleintable">表281-13 RE $ VALUE属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ VALUE属性" width="100%" border="1" summary="This table describes Attributes of the RuleType RE$VALUE." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="21%" id="d1605288e3241">属性</th>
                                    <th align="left" valign="bottom" width="79%" id="d1605288e3244">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d1605288e3249" headers="d1605288e3241 ">
                                       <p><code class="codeph">table_values</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d1605288e3249 d1605288e3244 ">
                                       <p>用于表达式求值的表行的ROWID</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d1605288e3257" headers="d1605288e3241 ">
                                       <p><code class="codeph">column_值</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d1605288e3257 d1605288e3244 ">
                                       <p>表达式中引用的列的值</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d1605288e3265" headers="d1605288e3241 ">
                                       <p><code class="codeph">variable_values</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d1605288e3265 d1605288e3244 ">
                                       <p>表达式中引用的变量值</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d1605288e3273" headers="d1605288e3241 ">
                                       <p><code class="codeph">ATTRIBUTE_VALUES</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d1605288e3273 d1605288e3244 ">
                                       <p>表达式中引用的属性值</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS74469"></a><a id="ARPLS74469"></a><div class="props_rev_3"><a id="GUID-31A9ABB9-5395-438D-9CFC-2BD227702B7F" name="GUID-31A9ABB9-5395-438D-9CFC-2BD227702B7F"></a><h4 id="ARPLS-GUID-31A9ABB9-5395-438D-9CFC-2BD227702B7F" class="sect4"><span class="enumeration_section">281.3.18</span> RE $ VALUE_LIST类型</h4>
                  <div>
                     <p><code class="codeph">RE$TABLE_VALUE_LIST</code>类型是用于定义<code class="codeph">RE$VALUE</code>类型列表的varray。它表示数据点元素的列表。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-31A9ABB9-5395-438D-9CFC-2BD227702B7F__GUID-79AE3969-5AAD-4325-B63B-28668635C8A9">句法</p><pre class="oac_no_warn" dir="ltr">创建或替换类型SYS.RE $ VALUE _LIST作为SYS.RE $ VALUE的VARRAY（1024）;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS585"></a><a id="ARPLS71938"></a><a id="ARPLS71938"></a><a id="ARPLS585"></a><div class="props_rev_3"><a id="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221" name="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221"></a><h4 id="ARPLS-GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221" class="sect4"><span class="enumeration_section">281.3.19</span> RE $ VARIABLE_TYPE类型</h4>
                  <div>
                     <p><code class="codeph">RE$VARIABLE_TYPE</code>类型提供规则评估上下文中使用的变量的类型。指定的变量名称必须满足架构对象命名规则。
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__GUID-4797988D-56C8-440C-B53F-888D6AF8E761">
                           <p class="notep1">注意：</p>
                           <p>如果名称包含特殊字符，请将变量名称括在双引号（“）中。</p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__GUID-0E6B9340-5EBD-444D-850F-551562C2DD37">
                           <p class="notep1">也可以看看：</p>
                           <p>有关架构对象命名规则的信息，请<a href="../sqlrf/Basic-Elements-of-Oracle-SQL.html#SQLRF002" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__GUID-67726475-9B5B-45A0-9F93-312396E8C76C">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ VARIABLE_TYPE（variable_name VARCHAR2（32），variable_type VARCHAR2（4000），variable_value_function VARCHAR2（228），variable_method_function VARCHAR2（228））;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__GUID-1D9C3389-96A2-4DC9-8C2F-DCC53C69FB1B">属性</p>
                        <div class="tblformal" id="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__GUID-062A2A73-9586-482D-ABE6-72A82B9EE2E1">
                           <p class="titleintable">表281-14 RE $ VARIABLE_TYPE属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ VARIABLE_TYPE属性" width="100%" border="1" summary="This table describes Attributes of the RuleType RE$VARIABLE_TYPE." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="37%" id="d1605288e3512">属性</th>
                                    <th align="left" valign="bottom" width="63%" id="d1605288e3515">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="37%" id="d1605288e3520" headers="d1605288e3512 ">
                                       <p><code class="codeph">变量名</code></p>
                                    </td>
                                    <td align="left" valign="top" width="63%" headers="d1605288e3520 d1605288e3515 ">
                                       <p>规则中使用的变量名称</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="37%" id="d1605288e3528" headers="d1605288e3512 ">
                                       <p><code class="codeph">variable_type</code></p>
                                    </td>
                                    <td align="left" valign="top" width="63%" headers="d1605288e3528 d1605288e3515 ">
                                       <p>在评估上下文模式中解析的类型。可以指定任何有效的Oracle内置数据类型，用户定义类型或Oracle提供的类型。有关这些类型的更多信息，请参见<a href="../sqlrf/Basic-Elements-of-Oracle-SQL.html#SQLRF002" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="37%" id="d1605288e3541" headers="d1605288e3512 ">
                                       <p><code class="codeph">variable_value_function</code></p>
                                    </td>
                                    <td align="left" valign="top" width="63%" headers="d1605288e3541 d1605288e3515 ">
                                       <p>可以为隐式变量指定的值函数。可以指定同义词。函数名称在评估上下文模式中解析。它使用评估上下文代表规则集的所有者执行，或者包含使用评估上下文的规则。</p>
                                       <p>有关详细信息，请参阅<span class="q">“ <a href="Rule-TYPEs.html#GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__I997441">使用说明</a> ”</span> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="37%" id="d1605288e3555" headers="d1605288e3512 ">
                                       <p><code class="codeph">variable_method_function</code></p>
                                    </td>
                                    <td align="left" valign="top" width="63%" headers="d1605288e3555 d1605288e3515 ">
                                       <p>指定值函数，该函数可以返回方法调用的结果。如果有许多简单的规则可以在变量上调用方法，那么指定这样的函数可以加快评估速度。该功能可以是同义词或远程功能。</p>
                                       <p>函数名称在评估上下文模式中解析。它使用评估上下文代表规则集的所有者执行，或者包含使用评估上下文的规则。</p>
                                       <p>有关详细信息，请参阅<span class="q">“ <a href="Rule-TYPEs.html#GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__I997441">使用说明</a> ”</span> 。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__I997441">
                        <p class="subhead3" id="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__GUID-3D704018-2CE6-4E35-83AF-4252D1F7C4AA">使用说明</p>
                        <p><code class="codeph">variable_value_function</code>参数和<code class="codeph">variable_method_function</code>参数的函数具有以下格式：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">schema_name</span> 。 <span class="italic">package_name</span> 。 <span class="italic">function_name</span> @ <span class="italic">dblink</span>
</pre><p>可以省略格式的以下任何部分： <span class="italic"><code class="codeph">schema_name</code></span> ， <span class="italic"><code class="codeph">package_name</code></span>和<span class="italic"><code class="codeph">@dblink</code></span> 。
                        </p>
                        <p>例如，如果<span class="italic"><code class="codeph">schema_name</code></span>是<code class="codeph">hr</code> ，则<span class="italic"><code class="codeph">package_name</code></span>是<code class="codeph">var_pac</code> ， <span class="italic"><code class="codeph">function_name</code></span>是<code class="codeph">func_value</code> ， <span class="italic"><code class="codeph">dblink</code></span>是<code class="codeph">dbs1.net</code> ，然后输入以下内容：</p><pre class="oac_no_warn" dir="ltr">hr.var_pac.func_value@dbs1.net</pre><p>以下部分描述了函数的签名。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__GUID-89453E65-7E7B-4791-A247-C94BB7874D55">对variable_value_function进行签名</p>
                        <p>该函数必须具有以下签名：</p><pre class="oac_no_warn" dir="ltr">FUNCTION <span class="italic">variable_value_function_name</span> （Evaluation_context_schema IN VARCHAR2，evaluation_context_name IN VARCHAR2，variable_name IN VARCHAR2，event_context IN SYS.RE $ NV_LIST）RETURN SYS.RE $ VARIABLE_VALUE;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4EA2F12D-02E2-4840-A344-12F2D4B52221__GUID-B1472E34-B849-4CDA-A857-3038DBF8F8AB">对variable_method_function的签名</p>
                        <p>此功能必须具有以下签名：</p><pre class="oac_no_warn" dir="ltr">FUNCTION <span class="italic">variable_method_function_name</span> （Evaluation_context_schema IN VARCHAR2，evaluation_context_name IN VARCHAR2，variable_value IN SYS.RE $ VARIABLE_VALUE，method_name IN VARCHAR2，event_context IN SYS.RE $ NV_LIST）RETURN SYS.RE $ ATTRIBUTE_VALUE;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS586"></a><a id="ARPLS586"></a><div class="props_rev_3"><a id="GUID-C6E738A8-F0B2-4EFD-B2D0-83C7F4C0F832" name="GUID-C6E738A8-F0B2-4EFD-B2D0-83C7F4C0F832"></a><h4 id="ARPLS-GUID-C6E738A8-F0B2-4EFD-B2D0-83C7F4C0F832" class="sect4"><span class="enumeration_section">281.3.20</span> RE $ VARIABLE_TYPE_LIST类型</h4>
                  <div>
                     <p><code class="codeph">RE$VARIABLE_TYPE_LIST</code>类型标识规则评估上下文中使用的变量及其类型的列表。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C6E738A8-F0B2-4EFD-B2D0-83C7F4C0F832__GUID-7691AB24-0D43-4154-9CDA-7E632D841C99">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ VARIABLE_TYPE_LIST AS VARRAY（1024）OF SYS.RE $ VARIABLE_TYPE;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS587"></a><a id="ARPLS71939"></a><a id="ARPLS71939"></a><a id="ARPLS587"></a><div class="props_rev_3"><a id="GUID-67420543-C600-4AAE-8647-A11DC15990E9" name="GUID-67420543-C600-4AAE-8647-A11DC15990E9"></a><h4 id="ARPLS-GUID-67420543-C600-4AAE-8647-A11DC15990E9" class="sect4"><span class="enumeration_section">281.3.21</span> RE $ VARIABLE_VALUE类型</h4>
                  <div>
                     <p><code class="codeph">RE$VARIABLE_VALUE</code>类型指定变量的值。
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-67420543-C600-4AAE-8647-A11DC15990E9__GUID-75F7F527-D725-42A3-96B3-C8CDCCD8718D">
                           <p class="notep1">注意：</p>
                           <p>如果名称包含特殊字符，请将变量名称括在双引号（“）中。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-67420543-C600-4AAE-8647-A11DC15990E9__GUID-D9C6B823-84C8-4E15-9144-3548940FEBD5">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ VARIABLE_VALUE（variable_name VARCHAR2（32），variable_data ANYDATA）;</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-67420543-C600-4AAE-8647-A11DC15990E9__GUID-10ADAEA4-AB4E-4F4F-B0DC-DCEC1E7F1F5B">属性</p>
                        <div class="tblformal" id="GUID-67420543-C600-4AAE-8647-A11DC15990E9__GUID-01B021A0-0C97-4EF0-9547-8851A3F8E788">
                           <p class="titleintable">表281-15 RE $ VARIABLE_VALUE属性</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="RE $ VARIABLE_VALUE属性" width="100%" border="1" summary="This table describes Attributes of the RuleType RE$VARIABLE_VALUE." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d1605288e3887">属性</th>
                                    <th align="left" valign="bottom" width="69%" id="d1605288e3890">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e3895" headers="d1605288e3887 ">
                                       <p><code class="codeph">变量名</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e3895 d1605288e3890 ">
                                       <p>指定规则中使用的变量名称</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d1605288e3903" headers="d1605288e3887 ">
                                       <p><code class="codeph">variable_data</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d1605288e3903 d1605288e3890 ">
                                       <p>指定变量值的数据</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ARPLS588"></a><a id="ARPLS588"></a><div class="props_rev_3"><a id="GUID-29C791A6-E5AD-409F-B9FE-8A3CE01BBF2A" name="GUID-29C791A6-E5AD-409F-B9FE-8A3CE01BBF2A"></a><h4 id="ARPLS-GUID-29C791A6-E5AD-409F-B9FE-8A3CE01BBF2A" class="sect4"><span class="enumeration_section">281.3.22</span> RE $ VARIABLE_VALUE_LIST类型</h4>
                  <div>
                     <p><code class="codeph">RE$VARIABLE_VALUE_LIST</code>类型标识变量值列表。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-29C791A6-E5AD-409F-B9FE-8A3CE01BBF2A__GUID-0BFE6AAC-EC23-4452-9BA3-F96C6C7A2783">句法</p><pre class="oac_no_warn" dir="ltr">TYPE SYS.RE $ VARIABLE_VALUE_LIST AS VARRAY（1024）OF SYS.RE $ VARIABLE_VALUE;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="03386.using-training-mode-to-log-realm-and-command-rule-activities.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls."></meta>
      <meta name="description" content="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls."></meta>
      <title>使用模拟模式记录领域和命令规则活动</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Administrator&#39;s Guide "></meta>
      <meta property="og:description" content="Simulation mode writes violations to the simulation log instead of preventing SQL execution to quickly test new and modified Oracle Database Vault controls."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Administrator&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-vault-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-28T15:24:22-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96302-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="configuring-oracle-database-vault-policies.html" title="Previous" type="text/html"></link>
      <link rel="next" href="integrating-database-vault-with-other-oracle-products.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Vault Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="DVADM"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="configuring-oracle-database-vault-policies.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="integrating-database-vault-with-other-oracle-products.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">管理员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用模拟模式记录领域和命令规则活动</li>
            </ol>
            <a id="GUID-23CA88C2-C52C-4676-8564-2395898BECE7" name="GUID-23CA88C2-C52C-4676-8564-2395898BECE7"></a>
            
            <h2 id="DVADM-GUID-23CA88C2-C52C-4676-8564-2395898BECE7" class="sect2"><span class="enumeration_chapter">10</span>使用模拟模式记录领域和命令规则活动</h2>
         </header>
         <div class="ind">
            <div>
               <p>模拟模式将违规写入模拟日志，而不是阻止SQL执行以快速测试新的和已修改的Oracle Database Vault控件。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-FE4E06E7-42E3-4743-8750-83D9B5ED0723">关于模拟模式</a><br>通过模拟模式，您可以捕获模拟日志中的违规，而不是通过Oracle Database Vault领域和命令规则阻止SQL执行。
                  </li>
                  <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8E572333-F101-4BCE-A89C-AFE1A83728C2">模拟模式用例</a><br>模拟模式对于测试新领域和命令规则的开发配置非常有用。
                  </li>
                  <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0">在仿真模式下记录领域</a><br>您可以在模拟模式下设置常规和强制域。
                  </li>
                  <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C">教程：使用模拟模式跟踪对领域的违规</a><br>本教程介绍如何创建使用模拟模式的领域，然后测试对领域的违规。
                  </li>
                  <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6">在仿真模式下记录领域的用例和指南</a><br>Oracle提供了一组用于在仿真模式下记录领域的用例和指南。
                  </li>
               </ul>
            </div>
            
            <div class="sect2"><a id="GUID-FE4E06E7-42E3-4743-8750-83D9B5ED0723" name="GUID-FE4E06E7-42E3-4743-8750-83D9B5ED0723"></a><h3 id="DVADM-GUID-FE4E06E7-42E3-4743-8750-83D9B5ED0723" class="sect3">关于模拟模式</h3>
               <div>
                  <p>通过模拟模式，您可以捕获模拟日志中的违规，而不是通过Oracle Database Vault领域和命令规则阻止SQL执行。</p>
                  <p>模拟模式存储在一个位置捕获的错误，以便于分析。要使用模拟模式，在创建或更新领域或命令规则时，可以将其设置为模拟模式，而不是启用或禁用领域或命令规则。领域或命令规则仍处于启用状态，但由于违规未被阻止而是记录到模拟日志文件中，因此您可以在为生产环境启用之前测试任何潜在错误。启用模拟模式后，报告可能包含多个域或命令规则的违规。有关可以帮助您更好地识别用户SQL语句源的更详细报告，可以将模拟模式配置为包含PL / SQL调用堆栈。调用堆栈以递归方式捕获调用过程和函数，以更好地排除Database Vault审计记录的故障。调用堆栈信息存储在<code class="codeph">DVSYS.DBA_DV_SIMULATION_LOG</code>数据字典视图的<code class="codeph">PL_SQL_STACK</code>列中。
                  </p>
                  <p>例如，域的以下创建语句启用模拟模式并生成PL / SQL调用堆栈：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_MACADM.CREATE_REALM（realm_name =&gt;'HR Apps'，description =&gt;'保护HR领域的领域'，启用=&gt; DBMS_MACUTL.G_SIMULATION，audit_options =&gt; DBMS_MACUTL.G_REALM_AUDIT_FAIL，realm_type =&gt; 1，realm_scope =&gt; DBMS_MACUTL.G_SCOPE_LOCAL ，pl_sql_stack =&gt; TRUE）;结束; /</pre><p>在此阶段，仍然可以执行违反领域或命令规则的SQL语句，但这些活动将记录到<code class="codeph">DBA_DV_SIMULATION_LOG</code>数据字典视图中。例如，以下查询查找针对HR Apps领域的违规以及为仿真模式配置的任何其他领域或命令规则：</p><pre class="oac_no_warn" dir="ltr">SELECT USERNAME，COMMAND，SQLTEXT，VIOLATION_TYPE FROM DBA_DV_SIMULATION_LOG WHERE REALM_NAME =“HR APPS”; USERNAME COMMAND SQLTEXT VIOLATION_TYPE -------- ---------- ---------------------------- --- -------------- DGRANT从HR.EMPLOYEES中选择SELECT SALARY;境界违规</pre><p>完成对领域或命令规则的测试后，已被授予<code class="codeph">DV_ADMIN</code>或<code class="codeph">DV_OWNER</code>角色的用户可以通过删除此视图的基础表的内容<code class="codeph">DVSYS.SIMULATION_LOG$</code>来清除<code class="codeph">DBA_DV_SIMULATION_LOG</code>数据字典视图。
                  </p>
                  <p>例如：</p><pre class="oac_no_warn" dir="ltr">DELETE FROM DVSYS.SIMULATION_LOG $;</pre><p>要么：</p><pre class="oac_no_warn" dir="ltr">DELETE FROM DVSYS.SIMULATION_LOG $ WHERE COMMAND ='SELECT';</pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="模拟模式将违规写入模拟日志，而不是阻止SQL执行以快速测试新的和已修改的Oracle Database Vault控件。">使用模拟模式记录领域和命令规则活动</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-8E572333-F101-4BCE-A89C-AFE1A83728C2" name="GUID-8E572333-F101-4BCE-A89C-AFE1A83728C2"></a><h3 id="DVADM-GUID-8E572333-F101-4BCE-A89C-AFE1A83728C2" class="sect3">模拟模式用例</h3>
               <div>
                  <p>模拟模式对于测试新领域和命令规则的开发配置非常有用。</p>
                  <p>使用案例如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>申请认证</p>
                        <p>在认证应用程序时，可以在应用程序测试环境中使用如下模拟模式：</p>
                        <ol>
                           <li>
                              <p>在启用模拟模式的情况下，将应用程序的所有模式放入强制领域。</p>
                           </li>
                           <li>
                              <p>运行完整的回归测试。</p>
                           </li>
                           <li>
                              <p>通过查询<code class="codeph">DBA_DV_SIMULATION_LOG</code>数据字典视图来分析模拟模式日志，以查找可以访问这些模式的人员。
                              </p>
                           </li>
                           <li>
                              <p>使用新授权更新领域，并启用领域（即，不使用模拟模式）。</p>
                           </li>
                           <li>
                              <p>重新运行回归测试。</p>
                           </li>
                        </ol>
                     </li>
                     <li>
                        <p>引入新的命令规则</p>
                        <p>您可以在启用了Oracle Database Vault的生产数据库上使用模拟模式。</p>
                        <ol>
                           <li>
                              <p>在模拟模式下将新命令规则投入生产，这需要很长时间。</p>
                           </li>
                           <li>
                              <p>通过查询<code class="codeph">DBA_DV_SIMULATION_LOG</code>来分析模拟模式日志，以确定命令规则是否正常工作。
                              </p>
                           </li>
                           <li>
                              <p>根据需要更改命令规则。</p>
                           </li>
                           <li>
                              <p>启用命令规则。</p>
                           </li>
                        </ol>
                     </li>
                     <li>
                        <p>在仿真模式下将新领域放入生产数据库。</p>
                        <p>此方法可以帮助查找在规则集中设置可信路径规则以及查找领域的授权用户所需的系统上下文信息。</p>
                        <ol>
                           <li>
                              <p>在强制模式下创建新领域并添加受保护对象</p>
                           </li>
                           <li>
                              <p>不要添加任何授权用户。</p>
                           </li>
                           <li>
                              <p>从将使用的普通IP地址运行应用程序和开发操作。</p>
                           </li>
                           <li>
                              <p>检查模拟日志文件，以获取可用于创建受信任路径的授权用户和系统上下文信息。</p>
                           </li>
                           <li>
                              <p>创建可信路径，然后添加授权用户。</p>
                           </li>
                           <li>
                              <p>清除模拟日志并再次运行应用程序和开发操作任务。</p>
                           </li>
                           <li>
                              <p>一段时间后，查看模拟日志。如果所有控件都已正确更新，则模拟日志为空。模拟模式下的日志条目表示您需要对领域和规则集进行的其他更改，或者日志条目可能表示恶意使用。</p>
                           </li>
                        </ol>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="模拟模式将违规写入模拟日志，而不是阻止SQL执行以快速测试新的和已修改的Oracle Database Vault控件。">使用模拟模式记录领域和命令规则活动</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-5487F685-D481-49E6-B990-20CC319219C0" name="GUID-5487F685-D481-49E6-B990-20CC319219C0"></a><h3 id="DVADM-GUID-5487F685-D481-49E6-B990-20CC319219C0" class="sect3">在仿真模式下记录领域</h3>
               <div>
                  <p>您可以在模拟模式下设置常规和强制域。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-2AAA8F0B-1BAF-4447-B9E4-61FCA8B80775">在仿真模式下记录领域时的注意事项</a><br>如果要在模拟模式下使用域，有几种用例需要考虑。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-EBBAB054-8139-4E2B-876C-C06FA5F8DD4D">使用案例：模拟模式下的所有新领域</a><br>在此用例中，所有领域都是强制的或常规的，并且所有用户创建的领域都处于模拟模式。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-06AF9BEA-4FCF-4FC4-9099-66C426B39048">使用案例：引入现有领域的新领域</a><br>在此用例中，您将一组新领域添加到具有现有领域集的数据库中。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-DCFE00C3-7A46-404F-969D-C7BB019219FD">使用案例：测试领域中新对象的添加</a><br>在此用例中，您将新对象添加到现有领域，然后使用模拟模式对其进行测试，而不删除当前领域保护。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-0963EA64-53C8-4E9E-8B06-E1280D406E71">使用案例：测试从领域中删除对象</a><br>在此用例中，您将测试将对象移除到现有领域。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-39B63BF4-4A03-45B4-A0C8-4C7821E0C370">使用案例：测试向域中添加授权用户</a><br>在此用例中，您通过添加更多用户来放松安全控制。如果您只是添加更多授权用户，则无需模拟任何内容。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-B677F532-E093-4B29-928A-9344F3FA28A9">使用案例：测试从领域中删除授权用户</a><br>在此用例中，您希望删除授权用户并使用模拟模式检查用户是否仍需要访问该领域。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-01ED0923-611C-440D-BAF0-1A88034AFF0A">使用案例：使用领域测试新因素</a><br>在此用例中，您要测试对因子的更改。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-FDD5237B-5A2E-406D-A031-9ECF849949CF">使用案例：测试对现有命令规则的更改</a><br>在此用例中，您在保持启用原始命令规则的同时测试对现有命令规则的更改。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="模拟模式将违规写入模拟日志，而不是阻止SQL执行以快速测试新的和已修改的Oracle Database Vault控件。">使用模拟模式记录领域和命令规则活动</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-2AAA8F0B-1BAF-4447-B9E4-61FCA8B80775" name="GUID-2AAA8F0B-1BAF-4447-B9E4-61FCA8B80775"></a><h4 id="DVADM-GUID-2AAA8F0B-1BAF-4447-B9E4-61FCA8B80775" class="sect4">在仿真模式下记录领域时的注意事项</h4>
                  <div>
                     <p>如果要在模拟模式下使用域，有几种用例需要考虑。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用所有新的Database Vault控件测试应用程序：所有领域都处于模拟模式</p>
                        </li>
                        <li>
                           <p>向现有工作的Database Vault控件添加领域：只有一部分领域处于模拟模式</p>
                        </li>
                        <li>
                           <p>将新对象添加到现有的已启用领域，然后使用模拟模式测试差异，而不是禁用现有控件</p>
                        </li>
                        <li>
                           <p>从现有的启用域中删除一个或多个现有对象，然后使用模拟模式测试差异，而不是禁用现有控件</p>
                        </li>
                        <li>
                           <p>将新的授权用户添加到现有的已启用领域，然后使用模拟模式测试差异，而不是禁用现有控件</p>
                        </li>
                        <li>
                           <p>从现有的已启用域中删除一个或多个现有授权用户，然后使用模拟模式测试差异，而不是禁用现有控件</p>
                        </li>
                        <li>
                           <p>在现有的启用领域中添加或更改因子，然后使用模拟模式测试差异，而不是禁用现有控件</p>
                        </li>
                        <li>
                           <p>测试对生产中的命令规则的更改，同时保持启用原始命令规则</p>
                        </li>
                     </ul>
                     <p>当用户执行SQL语句并且失败时，对于已启用的域，对于模拟的域失败，或者由于这两个原因而失败，它可能会失败。可能存在强制领域，常规领域或两者。这些条件确定模拟日志中捕获的数据。</p>
                     <p>在创建了下一节中描述的用例之后，当对象具有保护它的两种类型的域时，常规域完全被强制域所强制。在强制和常规领域保护同一对象的所有情况下，关于模拟日志可以忽略常规领域。在模拟日志中仅捕获强制域失败。常规域失败输入模拟日志的唯一时间是对象的所有域都是常规域。然后，要将常规域写入模拟日志，必须执行以下操作：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>仿真模式中的所有常规领域都失败了</p>
                        </li>
                        <li>
                           <p>启用的所有常规域也会失败</p>
                        </li>
                     </ul>
                     <p>如果至少一个启用或模拟常规域成功，则不记录任何模拟常规域。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="您可以在模拟模式下设置常规和强制域。">在模拟模式下记录领域</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-EBBAB054-8139-4E2B-876C-C06FA5F8DD4D" name="GUID-EBBAB054-8139-4E2B-876C-C06FA5F8DD4D"></a><h4 id="DVADM-GUID-EBBAB054-8139-4E2B-876C-C06FA5F8DD4D" class="sect4">使用案例：模拟模式下的所有新领域</h4>
                  <div>
                     <p>在此用例中，所有领域都是强制的或常规的，并且所有用户创建的领域都处于模拟模式。</p>
                     <p>示例如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>仅限强制领域，均为仿真模式</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>用户有权在所有强制领域中执行SQL语句。模拟日志表中未捕获任何内容。</p>
                              </li>
                              <li>
                                 <p>用户未通过一个或多个强制领域检查。所有领域检查失败都记录到模拟日志中。强制域检查用户的SQL语句成功的位置未记录。</p>
                                 <p>在此示例中，有三个强制领域。用户SQL语句在一个领域成功，而在另外两个领域失败。只有两个失败的域检查记录在模拟日志中。</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>仅限常规域，均为仿真模式</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>用户被授权在至少一个常规域中执行SQL语句。用户应该可以访问数据，因此不会将任何内容记录到模拟日志中。</p>
                              </li>
                              <li>
                                 <p>用户无权在所有常规域中执行SQL语句。模拟日志捕获所有失败的域授权失败。这使用户能够选择应该授权用户的领域。SQL只需要在一个常规领域中被授权才能工作，并且不需要更新所有常规领域来授权SQL。</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>强制和常规领域的混合，它们都处于模拟模式</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>在这种情况下，您可以在用户被拒绝时捕获关键领域。在强制和常规领域的情况下，强制领域是关键领域。所有必需领域必须通过授权检查才能获得用户访问权限。实际上，当强制领域保护对象时，常规领域可能被认为是多余的。因此，在强制和常规领域都保护同一对象的情况下，只有强制领域才能控制SQL语句是被阻止还是被允许执行。用户是否被授权到常规领域并不重要。此示例遵循第一个场景的规则，适用于模拟模式下的强制域。</p>
                              </li>
                              <li>
                                 <p>用户有权在所有强制领域中执行SQL语句。模拟日志表中未捕获任何内容。即使用户可能在一个或多个常规领域中成功或失败，也不会捕获关于常规领域故障的任何内容。</p>
                              </li>
                              <li>
                                 <p>用户未通过一个或多个强制领域检查。所有领域检查失败都记录到模拟日志中。强制域检查用户SQL语句成功的位置不会被记录。</p>
                                 <p>例如，有三个强制领域。用户SQL语句在一个领域成功，而在另外两个领域失败。只有两个失败的域检查记录在模拟日志中。</p>
                                 <p>不需要捕获常规域，因为只需要在模拟日志中捕获强制域。</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="您可以在模拟模式下设置常规和强制域。">在模拟模式下记录领域</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-06AF9BEA-4FCF-4FC4-9099-66C426B39048" name="GUID-06AF9BEA-4FCF-4FC4-9099-66C426B39048"></a><h4 id="DVADM-GUID-06AF9BEA-4FCF-4FC4-9099-66C426B39048" class="sect4">使用案例：引入现有领域的新领域</h4>
                  <div>
                     <p>在此用例中，您将一组新领域添加到具有现有领域集的数据库中。</p>
                     <p>现有领域已启用并正常运行。新领域处于模拟模式。仅当仿真和启用的域同时保护同一对象时，此用例才适用。</p>
                     <p>例子：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>模拟模式中的新强制领域，具有现有的已启用强制领域。此用例显示了对象的一些其他强制域：为现有对象添加更多安全性。</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>在模拟模式下启用强制领域和强制领域都使用用户SQL语句成功：在这种情况下，SQL正常执行并且没有捕获任何内容</p>
                              </li>
                              <li>
                                 <p>启用强制领域（至少一个）失败，仿真模式下的强制领域都成功：SQL被阻止，没有任何内容写入模拟日志</p>
                              </li>
                              <li>
                                 <p>启用强制领域（至少一个）失败，仿真模式下的强制领域出现一个或多个故障：SQL被阻止，仿真模式下所有失败的强制领域都被输入到仿真日志中</p>
                              </li>
                              <li>
                                 <p>在仿真模式下启用强制领域所有成功和强制领域至少有一个失败：SQL未被阻止，所有失败的强制领域在仿真模式下进入仿真日志</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>仿真模式中的新常规领域，具有现有的已启用常规领域：更多常规领域添加到安全对象，为用户提供访问敏感数据的新方法</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>启用常规域（至少一个）和仿真模式中的常规域（至少一个）成功：用户SQL正常执行，没有写入模拟日志</p>
                              </li>
                              <li>
                                 <p>启用常规域（至少一个）成功，仿真模式下的常规域都失败：用户SQL正常执行，没有任何内容输入到模拟日志中</p>
                              </li>
                              <li>
                                 <p>启用常规域的所有失败和仿真模式下的常规域都会失败：用户SQL被阻止，仿真模式下的所有常规域都输入到仿真日志中。如果需要，用户必须评估要授权的常规领域。当前实现阻止SQL并且不会将模拟模式中的常规域添加到模拟日志中，因为启用的常规域无论如何都会阻塞它。这必须更改，因为用户可能已添加新领域以在此用例中授权SQL。没有办法告诉新的SQL应该如何工作会发生什么，但是在仿真模式中也被所有常规领域阻止（当模拟模式中的一个常规领域被设计为允许它工作时）。这将模拟针对此情况的审核日志条目。</p>
                              </li>
                              <li>
                                 <p>启用常规域所有失败和仿真模式（至少一个）成功的常规域：用户SQL被阻止，并且没有任何内容写入模拟日志。</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>具有现有已启用强制域的新常规域：在这种情况下，您无需执行任何操作。启用的强制域将继续控制对象，如果启用或不启用，则模拟模式下的新常规域将不会产生任何影响。在这种情况下，不应生成模拟日志。</p>
                        </li>
                        <li>
                           <p>现有启用常规领域的仿真模式中的新强制领域：当启用的常规领域现在控制对象时，当启用仿真模式中的新强制领域时，他们将完全控制对象而不受旧版启用的控制常规领域。因此，将为所有强制领域创建模拟日志。这与具有现有启用的强制领域的新强制领域的方案相同。</p>
                        </li>
                        <li>
                           <p>模拟模式中的新常规领域，具有现有的强制和常规领域：启用的强制领域将是决定领域，是否将模拟模式中的新常规领域添加到系统中现有的已启用常规领域。这与作为强制和常规领域混合的场景相同，都在模拟模式下。没有任何内容写入模拟日志。</p>
                        </li>
                        <li>
                           <p>模拟模式下的新强制领域，启用强制和常规领域：可以忽略启用的常规领域。这与具有现有启用的强制领域的新强制领域的方案相同。</p>
                        </li>
                        <li>
                           <p>在模拟模式下将新的强制和常规领域与现有的强制和常规领域相结合：忽略所有已启用和强制的常规领域。这只是向现有对象添加更多强制领域。这与具有现有启用的强制域的新强制域相同。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="您可以在模拟模式下设置常规和强制域。">在模拟模式下记录领域</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-DCFE00C3-7A46-404F-969D-C7BB019219FD" name="GUID-DCFE00C3-7A46-404F-969D-C7BB019219FD"></a><h4 id="DVADM-GUID-DCFE00C3-7A46-404F-969D-C7BB019219FD" class="sect4">使用案例：测试领域中新对象的添加</h4>
                  <div>
                     <p>在此用例中，您将新对象添加到现有领域，然后使用模拟模式对其进行测试，而不删除当前领域保护。</p>
                     <p>Oracle建议您在模拟模式下为具有相同授权用户和规则集的新对象创建重复域。这样，现有领域可以在测试新对象时继续为现有对象提供保护。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="您可以在模拟模式下设置常规和强制域。">在模拟模式下记录领域</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-0963EA64-53C8-4E9E-8B06-E1280D406E71" name="GUID-0963EA64-53C8-4E9E-8B06-E1280D406E71"></a><h4 id="DVADM-GUID-0963EA64-53C8-4E9E-8B06-E1280D406E71" class="sect4">使用案例：测试从领域中删除对象</h4>
                  <div>
                     <p>在此用例中，您将测试将对象移除到现有领域。</p>
                     <p>由于要删除现有对象的安全控件，因此无需使用模拟模式。只需从领域中删除对象即可。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="您可以在模拟模式下设置常规和强制域。">在模拟模式下记录领域</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-39B63BF4-4A03-45B4-A0C8-4C7821E0C370" name="GUID-39B63BF4-4A03-45B4-A0C8-4C7821E0C370"></a><h4 id="DVADM-GUID-39B63BF4-4A03-45B4-A0C8-4C7821E0C370" class="sect4">使用案例：测试向域中添加授权用户</h4>
                  <div>
                     <p>在此用例中，您通过添加更多用户来放松安全控制。如果您只是添加更多授权用户，则无需模拟任何内容。</p>
                     <p>如果要添加正在访问领域中的数据的新功能，但不确定要向领域授权哪些新数据库用户，则只需将新功能作为测试运行（如果尚未授权，将阻止该功能）。查看Database Vault审核日志以查看尝试访问领域数据的用户名，并添加现在已授权的任何新数据库用户。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="您可以在模拟模式下设置常规和强制域。">在模拟模式下记录领域</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-B677F532-E093-4B29-928A-9344F3FA28A9" name="GUID-B677F532-E093-4B29-928A-9344F3FA28A9"></a><h4 id="DVADM-GUID-B677F532-E093-4B29-928A-9344F3FA28A9" class="sect4">使用案例：测试从领域中删除授权用户</h4>
                  <div>
                     <p>在此用例中，您希望删除授权用户并使用模拟模式检查用户是否仍需要访问该领域。</p>
                     <p>您可能不确定是否删除此用户，因为您必须检查授权用户是否正在访问授权活动的领域。</p>
                     <p>如果数据仅受常规域保护，则可以将授权用户克隆为唯一区别。从原始领域中删除要删除的用户，然后将此用户添加到克隆领域。然后更改克隆领域的审核设置以捕获<code class="codeph">audit on success</code> 。这使得被删除的用户在一段时间内访问领域时可以在审计记录中看到。在这种情况下也可以使用审计策略。对于受强制领域保护的数据，最佳解决方案是创建审核策略。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="您可以在模拟模式下设置常规和强制域。">在模拟模式下记录领域</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-01ED0923-611C-440D-BAF0-1A88034AFF0A" name="GUID-01ED0923-611C-440D-BAF0-1A88034AFF0A"></a><h4 id="DVADM-GUID-01ED0923-611C-440D-BAF0-1A88034AFF0A" class="sect4">使用案例：使用领域测试新因素</h4>
                  <div>
                     <p>在此用例中，您要测试对因子的更改。</p>
                     <p>有两种情况可能会发生变化：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>对应用程序或基础架构的更改会强制更改因子</p>
                           <p>在这种情况下，您无需保留原始因素。但是，对象和授权用户应该能够在测试新因素时保持启用状态。使用已启用的域，您可以从授权用户中删除这些因素。同时，在没有授权用户的情况下，在模拟模式下为相同的受保护对象创建强制域。常规领域将保护对象免受未授权用户的攻击，而模拟领域将捕获所有访问以及因子信息。然后可以为每个用户挖掘模拟日志以提出新的因子，然后可以在模拟模式中将其添加到强制领域，以确保在迁移到原始常规领域之前它是干净的。</p>
                        </li>
                        <li>
                           <p>对应用程序或基础架构没有任何更改，但会发生诸如添加新因素或删除因素之类的更改</p>
                           <p>添加因子时，必须从原始因子克隆第二个模拟领域，但添加了新因子。如果模拟日志显示使用情况干净，那么您可以安全地将新因子引入原始领域。</p>
                           <p>丢弃因子会降低安全性配置文件，因此您只需从规则集中删除该因子即可。不需要进行测试。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="您可以在模拟模式下设置常规和强制域。">在模拟模式下记录领域</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-FDD5237B-5A2E-406D-A031-9ECF849949CF" name="GUID-FDD5237B-5A2E-406D-A031-9ECF849949CF"></a><h4 id="DVADM-GUID-FDD5237B-5A2E-406D-A031-9ECF849949CF" class="sect4">使用案例：测试对现有命令规则的更改</h4>
                  <div>
                     <p>在此用例中，您在保持启用原始命令规则的同时测试对现有命令规则的更改。</p>
                     <p>在生产中启用更改之前，可能需要更新命令规则并进行理想测试。对于将添加到一组现有命令规则的新命令规则，请在创建新命令规则时将其置于模拟模式。其他预先存在的命令规则已启用并提供保护。</p>
                     <p>如果要修改现有命令规则，则无法维护现有保护并测试新修改。Oracle建议您创建审核策略以捕获原始命令规则正在执行的操作，然后为其设置警报。审计不会像命令规则那样阻止SQL，但至少可以提醒您该操作。然后，您可以将新更新的命令规则置于模拟模式并进行测试。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-5487F685-D481-49E6-B990-20CC319219C0" title="您可以在模拟模式下设置常规和强制域。">在模拟模式下记录领域</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" name="GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C"></a><h3 id="DVADM-GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" class="sect3">教程：使用模拟模式跟踪对领域的违规</h3>
               <div>
                  <p>本教程介绍如何创建使用模拟模式的领域，然后测试对领域的违规。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-A7AE4EB7-B00A-42E1-BCFD-D914BD36F8A3">关于本教程</a><br>在本教程中，您将围绕<code class="codeph">HR.EMPLOYEES</code>表创建一个领域并测试对它的违规。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-A33AA63A-9DC2-4482-92E8-714823CC965F">第1步：为本教程创建用户</a><br>您必须为本教程创建三个用户。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-6AE7A50C-6498-4D86-8EC4-537E30920482">第2步：创建领域和Oracle Database Vault策略</a><br>接下来，围绕<code class="codeph">HR.EMPLOYEES</code>表创建一个领域，然后将此领域添加到Oracle Database Vault策略中。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-650EA278-861B-4F50-BAAF-1323621E491B">第3步：测试领域和政策</a><br>用户<code class="codeph">tjones_dba</code>将在域上提交违规以测试领域和策略。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-79944EF8-A802-4D5B-AC3F-302F926D9A35">第4步：查询DBA_DV_SIMULATION_LOG查看违规情况</a><br>现在，您可以检查模拟模式日志，记录用户<code class="codeph">tjones_dba</code>提交的违规行为。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-1D92ACE9-1FB6-404F-A026-AB62AA50353A">步骤5：启用并重新测试领域</a><br>现在您已捕获违规，用户<code class="codeph">psmith</code>可以更新<code class="codeph">HR.EMPLOYEES_pol</code>策略。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-6D55E925-85AF-491A-9184-7E4D8636FC47">第6步：删除本教程的组件</a><br>如果不再需要，可以删除为本教程创建的组件。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="模拟模式将违规写入模拟日志，而不是阻止SQL执行以快速测试新的和已修改的Oracle Database Vault控件。">使用模拟模式记录领域和命令规则活动</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-A7AE4EB7-B00A-42E1-BCFD-D914BD36F8A3" name="GUID-A7AE4EB7-B00A-42E1-BCFD-D914BD36F8A3"></a><h4 id="DVADM-GUID-A7AE4EB7-B00A-42E1-BCFD-D914BD36F8A3" class="sect4">关于本教程</h4>
                  <div>
                     <p>在本教程中，您将围绕<code class="codeph">HR.EMPLOYEES</code>表创建一个领域并测试对它的违规。
                     </p>
                     <p><code class="codeph">HR.EMPLOYEES</code>表包含员工工资等机密数据。为了测试领域，管理员<code class="codeph">tjones_dba</code>将查找并修改另一名员工<code class="codeph">smavris</code>的薪水。Database Vault管理员<code class="codeph">leo_dvowner</code>将使用模拟模式跟踪<code class="codeph">HR.EMPLOYEES</code>表的违规情况。为此，用户<code class="codeph">leo_dvowner</code>将创建一个数据库保管库策略，委派管理员，用户<code class="codeph">psmith</code>将拥有该策略。然后，用户<code class="codeph">psmith</code>将能够对策略进行有限的更改，而无需<code class="codeph">DV_OWNER</code>或<code class="codeph">DV_ADMIN</code>角色。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="本教程介绍如何创建使用模拟模式的领域，然后测试对领域的违规。">教程：使用模拟模式跟踪对域的违规</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-A33AA63A-9DC2-4482-92E8-714823CC965F" name="GUID-A33AA63A-9DC2-4482-92E8-714823CC965F"></a><h4 id="DVADM-GUID-A33AA63A-9DC2-4482-92E8-714823CC965F" class="sect4">第1步：为本教程创建用户</h4>
                  <div>
                     <p>您必须为本教程创建三个用户。</p>
                     <div class="section">用户是： <code class="codeph">psmith</code> ，谁是Database Vault策略所有者; <code class="codeph">tjones_dba</code> ，在<code class="codeph">HR.EMPLOYEES</code>表上犯下违规行为;和<code class="codeph">smavris</code> ，他们的工资是<code class="codeph">tjones_dba</code>违法行为的接收者。
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">DV_ACCTMGR</code>角色的用户身份登录数据库实例。</span><div>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">sqlplus bea_dvacctmgr输入密码： <span class="italic">密码</span>
</pre><p>在多租户环境中，您必须登录到相应的可插拔数据库（PDB）。例如：</p><pre class="oac_no_warn" dir="ltr">CONNECT bea_dvacctmgr @hrpdb输入密码： <span class="italic">密码</span>
</pre><p>要查找可用的PDB，请运行<code class="codeph">show pdbs</code>命令。要检查当前PDB，请运行<code class="codeph">show con_name</code>命令。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>创建以下用户并授予他们<code class="codeph">CREATE SESSION</code>权限。</span><div><pre class="oac_no_warn" dir="ltr">GRANT创建会话以psmith IDENTIFIED BY <span class="italic">密码</span> ; GRANT创建会话到tjones_dba通过<span class="italic">密码</span>识别; GRANT创建会话以通过<span class="italic">密码</span>识别;</pre><p>请遵循“ <a href="../dbseg/configuring-authentication.html#DBSEG33223" target="_blank"><span><cite>Oracle数据库安全指南”中</cite></span></a>的准则，将<span class="italic"><code class="codeph">password</code></span>替换为安全的密码。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">DV_OWNER</code>角色的用户身份进行连接。</span><div>例如：<pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner  - <span class="italic">或者，leo_dvowner @hrpdb</span>输入密码： <span class="italic">密码</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>向用户<code class="codeph">psmith</code>授予<code class="codeph">DV_POLICY_OWNER</code>角色，该角色使<code class="codeph">psmith</code>能够管理Database Vault策略。</span><div><pre class="oac_no_warn" dir="ltr">GRANT DV_POLICY_OWNER到psmith;</pre></div>
                        </li>
                        <li class="stepexpand"><span>以<code class="codeph">SYS</code>用户身份连接<code class="codeph">SYSDBA</code>管理权限。</span><div><pre class="oac_no_warn" dir="ltr">将SYS作为SYSDBA连接<span class="italic">- 或者，连接SYS @hrpdb</span> AS SYSDBA输入密码： <span class="italic">password</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>将<code class="codeph">DBA</code>角色授予用户<code class="codeph">tjones_dba</code> </span><div><pre class="oac_no_warn" dir="ltr">GRANT DBA TO tjones_dba;</pre></div>
                        </li>
                        <li class="stepexpand"><span>作为<code class="codeph">HR</code>模式所有者连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT HR <span class="italic">- 或者，HR @ hrpdb</span>输入密码： <span class="italic">密码</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>将<code class="codeph">HR.EMPLOYEES</code>表的<code class="codeph">SELECT</code>权限授予用户<code class="codeph">smavris</code> </span><div><pre class="oac_no_warn" dir="ltr">人力资源选择HR.EMPLOYEES到smavris;</pre></div>
                        </li>
                     </ol>
                     <div class="section">在此阶段，用户已全部创建并被授予适当的权限。</div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="本教程介绍如何创建使用模拟模式的领域，然后测试对领域的违规。">教程：使用模拟模式跟踪对域的违规</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-6AE7A50C-6498-4D86-8EC4-537E30920482" name="GUID-6AE7A50C-6498-4D86-8EC4-537E30920482"></a><h4 id="DVADM-GUID-6AE7A50C-6498-4D86-8EC4-537E30920482" class="sect4">第2步：创建领域和Oracle Database Vault策略</h4>
                  <div>
                     <p>接下来，围绕<code class="codeph">HR.EMPLOYEES</code>表创建一个领域，然后将此领域添加到Oracle Database Vault策略中。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">DV_OWNER</code>角色的用户身份进行连接。</span><div>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner  - <span class="italic">或者，leo_dvowner @hrpdb</span>输入密码： <span class="italic">密码</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>围绕<code class="codeph">HR.EMPLOYEES</code>表创建领域，如下所示。</span><div>
                              <p>这些过程创建<code class="codeph">HR.EMPLOYEES_realm</code> ，将<code class="codeph">HR.EMPLOYEES</code>表添加到此域，将<code class="codeph">HR</code>作为所有者进行身份验证，将用户<code class="codeph">psmith</code>作为参与者进行身份验证，并在模拟模式下设置域。
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_MACADM.CREATE_REALM（realm_name =&gt;'HR.EMPLOYEES_realm'，description =&gt;'Realm to protected HR.EMPLOYEES'，enabled =&gt; DBMS_MACUTL.G_SIMULATION，audit_options =&gt; DBMS_MACUTL.G_REALM_AUDIT_FAIL，realm_type =&gt; 0）;结束; / BEGIN DBMS_MACADM.ADD_OBJECT_TO_REALM（realm_name =&gt;'HR.EMPLOYEES_realm'，object_owner =&gt;'HR'，object_name =&gt;'EMPLOYEES'，object_type =&gt;'TABLE'）;结束; /</pre></div>
                        </li>
                        <li class="stepexpand"><span>创建<code class="codeph">HR.EMPLOYEES_pol</code> Database Vault策略并将其设置为模拟模式。</span><div>
                              <p>这些过程创建<code class="codeph">HR.EMPLOYEES_pol</code>策略，将刚刚创建的域添加到策略，然后将用户<code class="codeph">psmith</code>添加为策略的所有者。
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_MACADM.CREATE_POLICY（policy_name =&gt;'HR.EMPLOYEES_pol'，description =&gt;'保护HR.EMPLOYEES的政策'，policy_state =&gt; DBMS_MACADM.G_SIMULATION）;结束; / BEGIN DBMS_MACADM.ADD_REALM_TO_POLICY（policy_name =&gt;'HR.EMPLOYEES_pol'，realm_name =&gt;'HR.EMPLOYEES_realm'）;结束; / BEGIN DBMS_MACADM.ADD_OWNER_TO_POLICY（policy_name =&gt;'HR.EMPLOYEES_pol'，owner_name =&gt;'PSMITH'）;结束; /</pre></div>
                        </li>
                     </ol>
                     <div class="section">此时，领域和策略已准备好进行测试。</div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="本教程介绍如何创建使用模拟模式的领域，然后测试对领域的违规。">教程：使用模拟模式跟踪对域的违规</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-650EA278-861B-4F50-BAAF-1323621E491B" name="GUID-650EA278-861B-4F50-BAAF-1323621E491B"></a><h4 id="DVADM-GUID-650EA278-861B-4F50-BAAF-1323621E491B" class="sect4">第3步：测试领域和政策</h4>
                  <div>
                     <p>用户<code class="codeph">tjones_dba</code>将在域上提交违规以测试领域和策略。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以用户<code class="codeph">tjones_dba</code>连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT tjones_dba  - <span class="italic">或者，tjones_dba @hrpdb</span>输入密码： <span class="italic">password</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>在<code class="codeph">HR.EMPLOYEES</code>表中查询<code class="codeph">smavris</code>的工资。</span><div><pre class="oac_no_warn" dir="ltr">从HR.EMPLOYEES中选择SALARY EMAIL ='SMAVRIS';</pre><p>应出现类似以下的输出：</p><pre class="oac_no_warn" dir="ltr">SALARY ---------- 6500</pre></div>
                        </li>
                        <li class="stepexpand"><span>将<code class="codeph">smavris</code>的薪水减半。</span><div><pre class="oac_no_warn" dir="ltr">更新HR.EMPLOYEES SET SALARY = SALARY / 2 WHERE EMAIL ='SMAVRIS'; 1行更新。</pre></div>
                        </li>
                        <li class="stepexpand"><span>以用户<code class="codeph">smavris</code>连接。</span><div><pre class="oac_no_warn" dir="ltr">连接smavris <span class="italic">- 或者，smavris @ hrpdb</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>查询<code class="codeph">smavris</code>的工资。</span><div><pre class="oac_no_warn" dir="ltr">从HR.EMPLOYEES中选择SALARY EMAIL ='SMAVRIS';</pre><p>应出现类似以下的输出：</p><pre class="oac_no_warn" dir="ltr">SALARY ---------- 3250</pre></div>
                        </li>
                     </ol>
                     <div class="section">此时， <code class="codeph">tjones_dba</code>的违规已记录在<code class="codeph">DBA_DV_SIMULATION_LOG</code>数据字典视图中。
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="本教程介绍如何创建使用模拟模式的领域，然后测试对领域的违规。">教程：使用模拟模式跟踪对域的违规</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-79944EF8-A802-4D5B-AC3F-302F926D9A35" name="GUID-79944EF8-A802-4D5B-AC3F-302F926D9A35"></a><h4 id="DVADM-GUID-79944EF8-A802-4D5B-AC3F-302F926D9A35" class="sect4">第4步：查询DBA_DV_SIMULATION_LOG查看违规情况</h4>
                  <div>
                     <p>现在，您可以检查模拟模式日志，记录用户<code class="codeph">tjones_dba</code>提交的违规行为。
                     </p>
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">DV_OWNER</code>角色的用户身份进行连接。</span><div>例如：<pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner  - <span class="italic">或者，leo_dvowner @hrpdb</span>输入密码： <span class="italic">密码</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>查询<code class="codeph">DBA_DV_SIMULATION_LOG</code>数据字典视图。</span><div><pre class="oac_no_warn" dir="ltr">SELECT USERNAME，SQLTEXT，VIOLATION_TYPE FROM（SELECT T1。*，T2。COLUMN_VALUE AS REALM来自DVSYS.DBA_DV_SIMULATION_LOG T1，表（T1。REALM_NAME）T2）WHERE REALM ='HR.EMPLOYEES_realm';</pre><p>应出现类似以下的输出：</p><pre class="oac_no_warn" dir="ltr">用户名  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - - ------------------------------- SQLTEXT ------------------ -------------------------------------------------- ------------ VIOLATION_TYPE ------------------------------------- ------------------------------------------- TJONES_DBA从HR.EMPLOYEES选择SALARY哪里有电子邮件='SMAVRIS'境界违规TJONES_DBA更新HR.EMPLOYEES设置SALARY = SALARY / 2哪里有电子邮件='SMAVRIS'境界违规</pre></div>
                        </li>
                     </ol>
                     <div class="section">输出结果表明用户<code class="codeph">tjones_dba</code>犯了两项罪名：首先，他查看了另一名员工的工资，不仅如此，他将其减半。违规类型是领域违规。<code class="codeph">smavris</code>的查询未被捕获，因为她合法地可以查看她的薪水。
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="本教程介绍如何创建使用模拟模式的领域，然后测试对领域的违规。">教程：使用模拟模式跟踪对域的违规</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-1D92ACE9-1FB6-404F-A026-AB62AA50353A" name="GUID-1D92ACE9-1FB6-404F-A026-AB62AA50353A"></a><h4 id="DVADM-GUID-1D92ACE9-1FB6-404F-A026-AB62AA50353A" class="sect4">步骤5：启用并重新测试领域</h4>
                  <div>
                     <p>现在您已捕获违规，用户<code class="codeph">psmith</code>可以更新<code class="codeph">HR.EMPLOYEES_pol</code>策略。
                     </p>
                     <div class="section">这样就可以启用<code class="codeph">HR.EMPLOYEES_realm</code> 。然后，您可以再次测试违规行为。
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以<code class="codeph">psmith</code>用户<code class="codeph">psmith</code>连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT psmith  - <span class="italic">或者，psmith @hrpdb</span>输入密码： <span class="italic">密码</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>更新策略以使其启用。</span><div><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_MACADM.UPDATE_POLICY_STATE（policy_name =&gt;'HR.EMPLOYEES_pol'，policy_state =&gt; 1）;结束; /</pre></div>
                        </li>
                        <li class="stepexpand"><span>以用户<code class="codeph">tjones_dba</code>连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT tjones_dba  - <span class="italic">或者，tjones_dba @hrpdb</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>尝试将<code class="codeph">smavris</code>的薪水降低到新的水平。</span><div><pre class="oac_no_warn" dir="ltr">更新HR.EMPLOYEES SET SALARY = SALARY / 2 WHERE EMAIL ='SMAVRIS';</pre><p>应出现类似以下的输出：</p><pre class="oac_no_warn" dir="ltr">第1行的错误：ORA-01031：权限不足</pre></div>
                           <div>现在启用的策略使域能够保护<code class="codeph">HR.EMPLOYEES</code>表。 <code class="codeph">smavris</code>的薪水不再萎缩。
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="本教程介绍如何创建使用模拟模式的领域，然后测试对领域的违规。">教程：使用模拟模式跟踪对域的违规</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-6D55E925-85AF-491A-9184-7E4D8636FC47" name="GUID-6D55E925-85AF-491A-9184-7E4D8636FC47"></a><h4 id="DVADM-GUID-6D55E925-85AF-491A-9184-7E4D8636FC47" class="sect4">第6步：删除本教程的组件</h4>
                  <div>
                     <p>如果不再需要，可以删除为本教程创建的组件。</p>
                     <ol>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">DV_OWNER</code>角色的用户身份进行连接。</span><div>例如：<pre class="oac_no_warn" dir="ltr">CONNECT leo_dvowner  - <span class="italic">或者，leo_dvowner @hrpdb</span>输入密码： <span class="italic">密码</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>删除<code class="codeph">HR.EMPLOYEES_pol</code>数据库保险库策略。</span><div><pre class="oac_no_warn" dir="ltr">EXEC DBMS_MACADM.DROP_POLICY（'HR.EMPLOYEES_pol'）;</pre></div>
                           <div>首先必须删除该策略，然后才能删除其内容。</div>
                        </li>
                        <li class="stepexpand"><span>删除<code class="codeph">HR.EMPLOYEES_realm</code> 。</span><div><pre class="oac_no_warn" dir="ltr">EXEC DBMS_MACADM.DELETE_REALM（'HR.EMPLOYEES_realm'）;</pre></div>
                        </li>
                        <li class="stepexpand"><span>删除累积的模拟模式日志数据。</span><div>
                              <p>由于模拟模式日志仅捕获有关用户<code class="codeph">tjones_dba</code>信息，因此您只能删除与此用户相关的行。
                              </p><pre class="oac_no_warn" dir="ltr">DELETE FROM DVSYS.SIMULATION_LOG $ WHERE USERNAME ='TJONES_DBA';</pre></div>
                        </li>
                        <li class="stepexpand"><span>以用户<code class="codeph">HR</code>身份连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT HR <span class="italic">- 或者，连接HR @ hrpdb</span>输入密码： <span class="italic">密码</span></pre></div>
                        </li>
                        <li class="stepexpand"><span>将<code class="codeph">smavris</code>的工资恢复到其违规前状态。</span><div><pre class="oac_no_warn" dir="ltr">更新HR.EMPLOYEES SET SALARY = 6500 WHERE EMAIL ='SMAVRIS';</pre></div>
                        </li>
                        <li class="stepexpand"><span>以已被授予<code class="codeph">DV_ACCTMGR</code>角色的用户身份进行连接。</span><div>
                              <p>例如：</p><pre class="oac_no_warn" dir="ltr">CONNECT bea_dvacctmgr <span class="italic">- 或者，bea_dvacctmgr @hrpdb</span>输入密码： <span class="italic">密码</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>删除用户<code class="codeph">psmith</code> ， <code class="codeph">smavris</code>和<code class="codeph">tjones_dba</code> 。</span><div><pre class="oac_no_warn" dir="ltr">DROP USER psmith; DROP USER smavris; DROP USER tjones_dba;</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-8BB95940-7D8D-4AEB-9A53-246BA2AEED4C" title="本教程介绍如何创建使用模拟模式的领域，然后测试对领域的违规。">教程：使用模拟模式跟踪对域的违规</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" name="GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6"></a><h3 id="DVADM-GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" class="sect3">在仿真模式下记录领域的用例和指南</h3>
               <div>
                  <p>Oracle提供了一组用于在仿真模式下记录领域的用例和指南。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-A0E0CF4F-6F62-47A9-9188-8476A58E8C21">关于在模拟模式下记录领域</a><br>使用的领域类型可能会影响写入模拟日志的数据。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-17165018-8ED0-48F2-A1E7-768FB746D5A1">用例：模拟模式下的全新领域</a><br>在此用例中，所有领域都是强制的或常规的，并且所有用户创建的领域都处于模拟模式。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568">使用案例：引入现有领域的新领域</a><br>新领域处于模拟模式，现有领域已启用并正常工作。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-E6F9354E-443E-4735-86E4-4EF6E9D96230">用例：添加到领域的新对象</a><br>您可以将新对象添加到现有领域，然后使用模拟模式对其进行测试，而无需删除当前领域保护。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-11157AE0-2A52-4BC5-ACD1-42D049907534">使用案例：从领域中删除对象</a><br>您可以使用<code class="codeph">DBMS_MACADM.DELETE_OBJECT_FROM_REALM</code>过程从<code class="codeph">DBMS_MACADM.DELETE_OBJECT_FROM_REALM</code>删除对象。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-01CECD47-345B-40DA-BBD1-FD04E85D1C9A">使用案例：将授权用户添加到领域</a><br>您可以使用<code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code>过程将授权用户添加到<code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code> 。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-152BA89E-73F2-4406-8C31-A1643EB5A652">使用案例：从领域中删除授权用户</a><br>您可以使用<code class="codeph">DBMS_MACADM.DELETE_AUTH_FROM_REALM</code>过程从<code class="codeph">DBMS_MACADM.DELETE_AUTH_FROM_REALM</code>删除授权用户。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-42CF4507-F6F0-439B-81D7-5BEEE395B116">使用案例：测试领域中的新因素</a><br>如果某个领域有新因素，您可以使用模拟模式来测试这些因素是否有变化。
                     </li>
                     <li class="ulchildlink"><a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-924D0FAD-920E-4EF3-8618-5124DB9B1E79">使用案例：在保持原始命令控制的同时测试对现有命令规则的更改</a><br>您可以在保持启用原始命令控件的同时测试对现有命令规则的更改。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-23CA88C2-C52C-4676-8564-2395898BECE7" title="模拟模式将违规写入模拟日志，而不是阻止SQL执行以快速测试新的和已修改的Oracle Database Vault控件。">使用模拟模式记录领域和命令规则活动</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-A0E0CF4F-6F62-47A9-9188-8476A58E8C21" name="GUID-A0E0CF4F-6F62-47A9-9188-8476A58E8C21"></a><h4 id="DVADM-GUID-A0E0CF4F-6F62-47A9-9188-8476A58E8C21" class="sect4">关于在模拟模式下记录领域</h4>
                  <div>
                     <p>使用的领域类型可能会影响写入模拟日志的数据。</p>
                     <p>当用户执行SQL语句并且失败时，对于已模拟（或两者）的域启用或失败的域可能会失败。这些可能是强制领域，常规领域或两者。这些条件决定了模拟日志中捕获的内容。</p>
                     <p>当一个对象同时具有常规域和强制域以保护它时，强制域保护优先。当常规领域和强制领域都保护对象时，模拟日志仅捕获强制领域中的活动。模拟日志将仅捕获强制域失败。模拟日志捕获常规域失败的唯一时间是对象的所有域都是常规域，并且如果常规域具有以下行为：</p>
                     <ul id="GUID-A0E0CF4F-6F62-47A9-9188-8476A58E8C21__UL_ARG_1DQ_SFB" style="list-style-type:disc">
                        <li>仿真模式中的所有常规域都会失败，并且</li>
                        <li>启用的所有常规域也会失败</li>
                     </ul>
                     <p>如果至少一个启用或模拟常规域成功，则模拟日志中不会记录任何模拟常规域。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle提供了一组用于在仿真模式下记录领域的用例和指南。">在仿真模式下记录领域的用例和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-17165018-8ED0-48F2-A1E7-768FB746D5A1" name="GUID-17165018-8ED0-48F2-A1E7-768FB746D5A1"></a><h4 id="DVADM-GUID-17165018-8ED0-48F2-A1E7-768FB746D5A1" class="sect4">用例：模拟模式下的全新领域</h4>
                  <div>
                     <p>在此用例中，所有领域都是强制的或常规的，并且所有用户创建的领域都处于模拟模式。</p>
                     <ul id="GUID-17165018-8ED0-48F2-A1E7-768FB746D5A1__UL_P3M_QHV_SFB" style="list-style-type:disc">
                        <li><span class="bold">仅限强制领域：所有都处于模拟模式</span><p>用户有权在所有强制领域中执行SQL语句。模拟日志表中未捕获任何内容。</p>
                           <p>如果用户未通过一个或多个强制域检查，则所有域检查失败都将写入模拟日志。强制域检查用户SQL语句成功的位置是否未写入模拟日志。假设有三个强制域，并且用户SQL语句在一个领域成功，而在另外两个领域失败。只有两个失败的域检查才会写入模拟日志。</p>
                        </li>
                        <li><span class="bold">仅限常规域：全部处于模拟模式</span><p>假设用户被授权在至少一个常规域中执行SQL语句。该用户应该可以访问数据，因此没有任何内容写入模拟日志。</p>
                           <p>或者，假设用户未被授权执行任何常规域的SQL语句。模拟日志将捕获失败的域授权失败。由于记录了故障，管理员可以选择应授权用户的域。SQL只需要在一个常规域中授权才能工作。并非所有常规域都需要更新才能授权SQL。</p>
                        </li>
                        <li><span class="bold">强制和常规领域的混合：都处于模拟模式</span><p>在这种情况下，您可以在用户被拒绝时捕获门控领域。对于强制性和常规领域，强制领域是门控领域。所有必需领域必须通过授权检查才能获得用户访问权限。事实上，当强制领域保护对象时，常规领域可能被认为是多余的。因此，在存在强制和常规领域的情况下，只应将强制领域记录到模拟日志中。用户是否被授权到常规领域并不重要。在这种情况下，只使用强制域，它们都处于模拟模式。</p>
                           <p>假设用户被授权在所有强制领域中执行SQL语句。在这种情况下，模拟日志表中没有捕获任何内容。即使用户可能在一个或多个常规领域中成功或失败，也不会捕获关于常规领域故障的任何内容。</p>
                           <p>如果用户未通过一个或多个强制领域检查，则会将所有领域检查失败记录到模拟日志中。强制域检查用户SQL语句成功的位置未记录。例如，假设有三个强制领域。如果用户的SQL语句在一个领域成功并且与另外两个领域失败，则只有两个失败的领域检查记录在模拟日志中。不需要捕获常规领域，因为对于这种情况，它并不重要。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle提供了一组用于在仿真模式下记录领域的用例和指南。">在仿真模式下记录领域的用例和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568" name="GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568"></a><h4 id="DVADM-GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568" class="sect4">使用案例：引入现有领域的新领域</h4>
                  <div>
                     <p>新领域处于模拟模式，现有领域已启用并正常工作。</p>
                     <p>仅当仿真模式和启用的域同时保护同一对象时，此用例才适用。</p>
                     <ul id="GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568__UL_MHG_5MW_SFB" style="list-style-type:disc">
                        <li><span class="bold">具有现有已启用强制域的新启用的强制域</span><p>此方案显示现有对象的一些其他强制领域，旨在为对象添加更多安全性。</p>
                           <ul id="GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568__UL_OHC_2PW_SFB" style="list-style-type:disc">
                              <li>在模拟模式下启用强制领域和强制领域都是成功的用户SQL：SQL正常执行，没有任何内容写入模拟日志。</li>
                              <li>至少一个启用的强制域失败，并且模拟模式下的强制域成功：SQL被阻止，并且没有任何内容写入模拟模式日志。</li>
                              <li>至少一个启用的强制域失败，并且仿真模式下的强制域具有一个或多个故障：SQL被阻止，并且仿真模式中所有失败的强制域都被写入仿真模式日志。</li>
                              <li>启用强制领域都是成功的，并且仿真模式中的强制领域至少有一个故障：SQL未被阻止，并且仿真模式中所有失败的强制领域都被写入模拟日志。</li>
                           </ul>
                        </li>
                        <li>具有现有启用的常规领域的仿真模式中的新常规领域：将更多常规领域添加到安全对象中，以便为用户提供访问敏感数据的新方法。
                           <ul id="GUID-F083B2C0-6FCF-46FD-B00B-6447B9A54568__UL_IFF_TYW_SFB" style="list-style-type:disc">
                              <li>在仿真模式下，至少一个启用的常规域和至少一个常规域成功：SQL正常执行，没有任何内容写入模拟日志。</li>
                              <li>至少一个启用的常规域和模拟模式下的所有常规域都失败：SQL语句正常执行，因此没有任何内容写入模拟日志。</li>
                              <li>仿真模式下所有已启用的常规域和常规域都会失败：SQL语句被阻止，仿真模式下的所有常规域都将写入仿真日志。如有必要，您必须评估要授权的常规域。Oracle Database Vault将阻止SQL，而不是在仿真日志中以仿真模式记录常规域，因为启用的常规域仍会阻止它。这必须更改，因为用户可能已添加新领域以在此用例中授权SQL。没有办法告诉新的SQL应该如何工作会发生什么，但是在仿真模式中也被所有常规领域阻止（当模拟模式中的一个常规领域被设计为允许它工作时）。这将模拟针对此情况的审核日志条目。</li>
                              <li>启用的常规域都会失败，并且仿真模式中的至少一个常规域成功：SQL被阻止，并且没有任何内容写入模拟日志。</li>
                           </ul>
                        </li>
                        <li>具有现有启用的常规领域的仿真模式中的新常规领域：这是无所事事的情况。启用的常规域将继续控制对象，如果启用或不启用模拟模式下的新常规域将不会产生任何影响。由于没有影响，因此不会生成模拟日志。</li>
                        <li>具有现有启用的常规领域的模拟模式中的新强制领域：当启用的常规领域现在将控制对象时，当启用模拟模式中的新强制领域时，他们将完全控制对象而不受较旧的常规领域。因此，将为未通过授权检查的模拟模式中的所有强制领域生成模拟日志。这与用例一样，当强制域都处于模拟模式时。</li>
                        <li>模拟模式下的新常规领域，在模拟模式下启用现有的强制领域和启用的常规领域：启用的强制领域将是新模拟模式常规领域是否添加到系统中现有启用的常规领域的决定领域。这与具有现有启用的常规域的模拟模式中具有新常规域的用例相同。什么都不会写入模拟日志。</li>
                        <li>模拟模式中的新强制领域，具有现有的强制和常规领域：可以忽略已启用的常规领域。此用例与具有现有已启用强制域的新模拟模式强制域的用例相同。</li>
                        <li>新的模拟模式强制和常规领域与现有的强制和常规领域的混合：忽略所有启用和模拟模式的常规领域。这只是向现有对象添加更多强制领域。此用例与具有新模拟强制领域和启用强制领域的用例相同。</li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle提供了一组用于在仿真模式下记录领域的用例和指南。">在仿真模式下记录领域的用例和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-E6F9354E-443E-4735-86E4-4EF6E9D96230" name="GUID-E6F9354E-443E-4735-86E4-4EF6E9D96230"></a><h4 id="DVADM-GUID-E6F9354E-443E-4735-86E4-4EF6E9D96230" class="sect4">用例：添加到领域的新对象</h4>
                  <div>
                     <p>您可以将新对象添加到现有领域，然后使用模拟模式对其进行测试，而无需删除当前领域保护。</p>
                     <p>Oracle建议您在模拟模式下为具有相同授权用户和规则集的新对象创建重复域。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle提供了一组用于在仿真模式下记录领域的用例和指南。">在仿真模式下记录领域的用例和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-11157AE0-2A52-4BC5-ACD1-42D049907534" name="GUID-11157AE0-2A52-4BC5-ACD1-42D049907534"></a><h4 id="DVADM-GUID-11157AE0-2A52-4BC5-ACD1-42D049907534" class="sect4">使用案例：从领域中删除对象</h4>
                  <div>
                     <p>您可以使用<code class="codeph">DBMS_MACADM.DELETE_OBJECT_FROM_REALM</code>过程从<code class="codeph">DBMS_MACADM.DELETE_OBJECT_FROM_REALM</code>删除对象。
                     </p>
                     <p>但是，由于要删除现有对象的安全控件，因此无需使用模拟模式。您需要做的就是从领域中删除对象。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle提供了一组用于在仿真模式下记录领域的用例和指南。">在仿真模式下记录领域的用例和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-01CECD47-345B-40DA-BBD1-FD04E85D1C9A" name="GUID-01CECD47-345B-40DA-BBD1-FD04E85D1C9A"></a><h4 id="DVADM-GUID-01CECD47-345B-40DA-BBD1-FD04E85D1C9A" class="sect4">使用案例：将授权用户添加到领域</h4>
                  <div>
                     <p>您可以使用<code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code>过程将授权用户添加到<code class="codeph">DBMS_MACADM.ADD_AUTH_TO_REALM</code> 。
                     </p>
                     <p>在这种情况下，您通过添加更多用户来放松安全控制。您不需要设置模拟模式;只需添加用户。如果您不知道要添加哪些授权用户并希望使用模拟模式来查找，则Oracle Database Vault允许所有用户访问这些对象。在这种情况下，您必须将原始域置于模拟模式。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle提供了一组用于在仿真模式下记录领域的用例和指南。">在仿真模式下记录领域的用例和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-152BA89E-73F2-4406-8C31-A1643EB5A652" name="GUID-152BA89E-73F2-4406-8C31-A1643EB5A652"></a><h4 id="DVADM-GUID-152BA89E-73F2-4406-8C31-A1643EB5A652" class="sect4">使用案例：从领域中删除授权用户</h4>
                  <div>
                     <p>您可以使用<code class="codeph">DBMS_MACADM.DELETE_AUTH_FROM_REALM</code>过程从<code class="codeph">DBMS_MACADM.DELETE_AUTH_FROM_REALM</code>删除授权用户。
                     </p>
                     <p>在这种情况下，您可能已经或可能没有从领域授权列表中删除用户。但是，您希望查看已删除的用户是否仍可以访问授权活动的领域，如下所示：</p>
                     <ol id="GUID-152BA89E-73F2-4406-8C31-A1643EB5A652__OL_Y45_LMG_5FB">
                        <li>克隆领域。</li>
                        <li>在原始领域中，删除要删除的用户，然后将此用户添加到克隆领域。</li>
                        <li>在克隆的域上配置审核，以便在审核记录中显示要删除的用户。
                           <ul id="GUID-152BA89E-73F2-4406-8C31-A1643EB5A652__UL_PG2_WNG_5FB" style="list-style-type:disc">
                              <li>如果克隆的域是常规域，则使用<code class="codeph">DBMS_MACADM.UPDATE_REALM</code>过程将<code class="codeph">audit_options</code>参数设置为<code class="codeph">DBMS_MACUTL.G_REALM_AUDIT_SUCCESS</code> 。或者，创建统一的审核策略以捕获用户的成功活动。
                              </li>
                              <li>如果克隆领域是强制领域，则创建统一的审核策略以捕获用户的成功活动。</li>
                           </ul>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle提供了一组用于在仿真模式下记录领域的用例和指南。">在仿真模式下记录领域的用例和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-42CF4507-F6F0-439B-81D7-5BEEE395B116" name="GUID-42CF4507-F6F0-439B-81D7-5BEEE395B116"></a><h4 id="DVADM-GUID-42CF4507-F6F0-439B-81D7-5BEEE395B116" class="sect4">使用案例：测试领域中的新因素</h4>
                  <div>
                     <p>如果某个领域有新因素，您可以使用模拟模式来测试这些因素是否有变化。</p>
                     <p>在这种情况下，有两个用例：</p>
                     <ul id="GUID-42CF4507-F6F0-439B-81D7-5BEEE395B116__UL_KBK_YPG_5FB" style="list-style-type:disc">
                        <li><span class="bold">应用程序或基础架构发生了变化，这些变化将迫使这些因素发生变化。</span> 
                           <p>在此方案中，启用（常规）域，然后从授权用户中删除这些因子。然后在没有授权用户的模拟模式下为相同的受保护对象创建强制域。常规领域将保护对象免受未授权用户的攻击，而仿真模式下的强制领域将捕获所有访问权限以及有关因素的任何信息。您可以检查每个用户的模拟日志，以获得新的因子，然后可以在模拟模式下将其添加到强制领域。这将确保在将强制域迁移到原始常规域之前，它是干净的。</p>
                        </li>
                        <li><span class="bold">应用程序或基础架构没有任何变化，但是正在对这些因素进行更改，例如添加的新因素或删除的现有因素。</span><p>在这种情况下，关注的是如何配置新因子的添加。丢弃因素会降低安全性配置文件，因此您只需从规则集中删除因子即可。添加因子时，必须从原始域克隆域，然后将其配置为处于模拟模式。将新因子添加到此克隆领域。如果此克隆领域的模拟日志记录是干净的，那么您可以安全地将因子添加到原始领域。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle提供了一组用于在仿真模式下记录领域的用例和指南。">在仿真模式下记录领域的用例和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-924D0FAD-920E-4EF3-8618-5124DB9B1E79" name="GUID-924D0FAD-920E-4EF3-8618-5124DB9B1E79"></a><h4 id="DVADM-GUID-924D0FAD-920E-4EF3-8618-5124DB9B1E79" class="sect4">使用案例：在保持原始命令控制的同时测试对现有命令规则的更改</h4>
                  <div>
                     <p>您可以在保持启用原始命令控件的同时测试对现有命令规则的更改。</p>
                     <p>更新命令规则时，理想情况下应在启用更改和生产之前对其进行测试。对于新的命令规则，您只需将其置于模拟模式。但是，现有的命令规则已启用并提供保护。在这种情况下，Oracle建议您创建审核策略以捕获原始命令规则正在执行的操作并为其设置警报。审核策略不会阻止SQL发生，但至少您会收到警报。在您确信原始命令规则正常工作后，您可以将更新的命令规则置于模拟模式，然后进行测试。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-training-mode-to-log-realm-and-command-rule-activities.html#GUID-D60381F6-9D4F-40FC-A409-FB144FE490C6" title="Oracle提供了一组用于在仿真模式下记录领域的用例和指南。">在仿真模式下记录领域的用例和指南</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="04714.optimizing-performance-of-cplusplus-applications.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>优化C ++应用程序的性能</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="oracle-c-call-interface-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-06T02:31:59-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96205-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="oracle-xa-library.html" title="Previous" type="text/html"></link>
      <link rel="next" href="occi-application-programing-interface.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Oracle C++ Call Interface Programmer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="LNCPP"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-xa-library.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="occi-application-programing-interface.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">优化C ++应用程序的性能</li>
            </ol>
            <a id="GUID-0901F6D0-F5DE-462A-A367-EE2C2AA55698" name="GUID-0901F6D0-F5DE-462A-A367-EE2C2AA55698"></a><a id="LNCPP012"></a>
            
            <h2 id="LNCPP-GUID-0901F6D0-F5DE-462A-A367-EE2C2AA55698" class="sect2"><span class="enumeration_chapter">12</span>优化C ++应用程序的性能</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍了一些可以提高OCCI自定义应用程序性能的建议。</p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-B822003D-DCE2-4704-9D83-4BF401B26882">关于透明应用程序故障转移</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-7191B319-0109-446E-96A1-65AB696C8C99">关于连接共享</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-96783A66-4018-4CC4-9D9A-36075BB3FF1A">关于应用程序管理数据缓冲</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-F6AD3A0C-7DD2-4362-8BFE-F4718D26817C">使用数组提取使用next（）方法</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-B406B496-9395-4D76-899F-71E414B68FB9">迭代地修改行</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61" title="Traffic Director Mode中的Oracle Connection Manager是一个放置在支持的数据库客户端和数据库实例之间的代理。">关于在Traffic Director模式下使用Oracle Connection Manager</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-5F06D230-7248-4BB0-AC4C-0BC42AC6B3AC">关于无状态连接池的运行时负载平衡</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-8ADCAB82-EBBE-43C0-BECE-4E74687A166D">关于故障诊断</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-740894FB-9DAE-4F98-BA70-0C4E04479200">使用客户端结果缓存</a></p>
                  </li>
                  <li>
                     <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052">关于客户端部署参数和自动调整</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-0901F6D0-F5DE-462A-A367-EE2C2AA55698__GUID-EC4BD1C4-6E53-41FC-9630-B47F3073E041">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="occi-application-programing-interface.html#GUID-3C824380-073E-4F32-AA6E-928A18D52F4B">OCCI应用程序编程接口</a></p>
                     </li>
                  </ul>
               </div>
            </div><a id="LNCPP20011"></a><div class="props_rev_3"><a id="GUID-B822003D-DCE2-4704-9D83-4BF401B26882" name="GUID-B822003D-DCE2-4704-9D83-4BF401B26882"></a><h3 id="LNCPP-GUID-B822003D-DCE2-4704-9D83-4BF401B26882" class="sect3"><span class="enumeration_section">12.1</span>关于透明应用程序故障转移</h3>
               <div>
                  <p>OCCI <span class="bold">透明应用程序故障转移</span> （TAF）使OCCI在运行时处理分布式应用程序中的数据库实例故障时更加强大。如果服务器节点不可用，应用程序将自动重新连接到另一个幸存节点。
                  </p>
                  <p>当客户端应用程序在往返操作期间检测到数据库实例已关闭时，会发生TAF。它建立与为TAF配置的备份数据库的连接。此备份可以是Oracle RAC配置中的另一个节点，热备用数据库或相同的数据库实例本身。</p>
                  <p>负责失败连接往返的OCCI / OCI API通常会返回以下错误之一：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">ORA-25401：无法继续提取</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">ORA-25402：交易必须回滚</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">ORA-25408：无法安全重播通话</code></p>
                     </li>
                  </ul>
                  <p>新连接可用于后续应用程序请求以及必须重新启动的任何正在进行的工作。应用程序中的空闲连接不受影响。</p>
                  <p>在应用程序中包含透明应用程序故障转移时，应考虑一些设计选项：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>由于故障转移处理固有的延迟，应用程序的设计可能包括通知用户正在进行故障转移并且应该很快恢复正常操作。</p>
                     </li>
                     <li>
                        <p>如果初始实例上的<code class="codeph">ALTER SESSION</code>在故障转移开始之前收到<code class="codeph">ALTER SESSION</code>命令，则它们不会在第二个实例上自动重播。
                        </p>
                        <p>因此，开发人员可能希望在第二个实例上重播这些<code class="codeph">ALTER SESSION</code>命令。
                        </p>
                     </li>
                  </ul>
                  <p>用户有责任跟踪<code class="codeph">SESSION</code>参数的更改。
                  </p>
                  <p>为解决这些问题，应用程序可以注册故障转移回调函数。故障转移后，在重新建立用户会话时，将在不同时间调用回调函数。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>当Oracle首次检测到实例连接丢失时，会发生对回调函数的第一次调用。此回调旨在允许应用程序通知用户即将发生的延迟。</p>
                     </li>
                     <li>
                        <p>如果故障转移成功，则在重新建立和使用连接时会发生对回调函数的第二次调用。此时，客户端可能希望重播<code class="codeph">ALTER SESSION</code>命令并通知用户已发生故障转移。请注意，您必须跟踪<code class="codeph">SESSION</code>参数更改，然后在故障转移完成后重播它们。
                        </p>
                        <p>如果故障转移不成功，则调用回调函数以通知应用程序无法进行故障转移。</p>
                     </li>
                     <li>
                        <p>故障转移的初始尝试可能并不总是成功。故障转移回调应返回<code class="codeph">FO_RETRY</code>以指示应再次尝试故障转移。
                        </p>
                        <div class="infoboxnotealso" id="GUID-B822003D-DCE2-4704-9D83-4BF401B26882__GUID-9E243EF4-4174-48DD-944B-E7A5B6585D4F">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="occi-application-programing-interface.html#GUID-3C824380-073E-4F32-AA6E-928A18D52F4B">OCCI应用程序编程接口</a> <a href="connection-class.html#GUID-412D06D3-7636-4A32-AF24-534099F989D0__BBAEAHAH" title="第一列列出类使用的属性，第二列描述每个属性可用的选项">中表13-11</a>中<code class="codeph">FailOverType</code>和<code class="codeph">FailOverEventType</code>定义 
                                 </p>
                              </li>
                              <li>
                                 <p>有关应用程序故障转移的详细信息，请参见<a href="../netag/enabling-advanced-features.html#NETAG455" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a>
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
                  <div class="p">本节包括以下主题：<ul style="list-style-type:disc">
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-D8B753E9-89F6-46F1-BB03-4B6836DBD138">使用透明应用程序故障转移</a></p>
                        </li>
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-6729D045-E737-4BE9-A50D-6AB39243DA5F">关于对象和透明应用程序故障转移</a></p>
                        </li>
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-146ED846-BA38-42BC-8F71-F88BD9631444">使用连接池和透明应用程序故障转移</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="LNCPP20477"></a><div class="props_rev_3"><a id="GUID-D8B753E9-89F6-46F1-BB03-4B6836DBD138" name="GUID-D8B753E9-89F6-46F1-BB03-4B6836DBD138"></a><h4 id="LNCPP-GUID-D8B753E9-89F6-46F1-BB03-4B6836DBD138" class="sect4"><span class="enumeration_section">12.1.1</span>使用透明应用程序故障转移</h4>
                  <div>
                     <div class="section">
                        <p>要启用TAF，必须配置连接字符串以进行故障转移并在<code class="codeph">Connection</code>注册（从<code class="codeph">Environment</code> ， <code class="codeph">ConnectionPool</code>和<code class="codeph">StatelessConnectionPool</code>创建）。要注册回调函数，请使用<a href="connection-class.html#GUID-412D06D3-7636-4A32-AF24-534099F989D0">Connection Class</a>接口<a href="connection-class.html#GUID-0C0A528D-6669-490E-BC2E-9A8183D4F95B">setTAFNotify（）</a> ：</p><pre class="oac_no_warn" dir="ltr">void Connection :: setTAFNotify（int（* notifyFn）（Environment * env，Connection * conn，void * ctx，FailOverType foType，FailOverEventType foEvent），void * ctxTAF）;</pre><p>请注意，对<code class="codeph">ConnectionPool</code>的TAF支持不包括<code class="codeph">BACKUP</code>和<code class="codeph">PRECONNECT</code>子句;这些不应该在连接字符串中使用。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNCPP20478"></a><div class="props_rev_3"><a id="GUID-6729D045-E737-4BE9-A50D-6AB39243DA5F" name="GUID-6729D045-E737-4BE9-A50D-6AB39243DA5F"></a><h4 id="LNCPP-GUID-6729D045-E737-4BE9-A50D-6AB39243DA5F" class="sect4"><span class="enumeration_section">12.1.2</span>关于对象和透明应用程序故障转移</h4>
                  <div>
                     <p>透明应用程序故障转移与OCCI导航和关联访问模型以及对象缓存一起使用。在非Oracle RAC设置中，必须确保主实例和备份实例中的对象类型定义和对象OID相同。</p>
                     <p>如果应用程序收到<code class="codeph">ORA-25402: transaction must roll back</code>在故障转移后<code class="codeph">ORA-25402: transaction must roll back</code>错误，那么它必须启动回滚以正确重置客户端上的对象缓存。如果事务在故障转移之前尚未启动，则应用程序仍应在故障转移后启动回滚，以从新实例刷新客户端对象缓存上的对象。
                     </p>
                  </div>
               </div><a id="LNCPP21907"></a><a id="LNCPP20479"></a><div class="props_rev_3"><a id="GUID-146ED846-BA38-42BC-8F71-F88BD9631444" name="GUID-146ED846-BA38-42BC-8F71-F88BD9631444"></a><h4 id="LNCPP-GUID-146ED846-BA38-42BC-8F71-F88BD9631444" class="sect4"><span class="enumeration_section">12.1.3</span>使用连接池和透明应用程序故障转移</h4>
                  <div>
                     <div class="section">
                        <p>如果激活透明应用程序故障转移功能，则还会在连接池中创建的连接进行故障转移。必须为从连接池获取的每个连接指定应用程序故障转移回调;在主实例失败后使用时，这些连接会被故障转移。</p>
                        <p>请注意，必须明确清除和修复自定义连接池中的连接。考虑一个池中有500个连接的应用程序; 10个连接正忙（进行往返），490个空闲或空闲。如果数据库实例失败，则TAF将处理10个活动连接，并且必须重新启动这些连接上的客户端请求。当应用程序拾取每个其他490个连接时，执行TAF并且OCCI返回错误代码<code class="codeph">ORA-25401</code> ， <code class="codeph">ORA-24502</code>或<code class="codeph">ORA-25408</code> ，强制重新启动用户请求。应用程序可以通过使用先前在连接池中的10个连接上激活TAF的知识来修复或清除这些连接，从而避免490空闲连接上的这些错误。
                        </p>
                        <p>要修复OCCI中的<a href="connection-class.html#GUID-412D06D3-7636-4A32-AF24-534099F989D0">连接</a> ，请使用<a href="connection-class.html#GUID-412D06D3-7636-4A32-AF24-534099F989D0">Connection Class</a>接口<a href="connection-class.html#GUID-D158EE4A-59B4-46F6-82FF-F26E6B07C1B7">getServerVersion（）</a> ，这是一个轻量级，数据中立的数据库调用，用于在与失败实例的连接上启动TAF：</p><pre class="oac_no_warn" dir="ltr">string getServerVersion（）const;</pre><p>在OCCI TAF回调中，应用程序可以在自定义池中的空闲连接上调用<a href="connection-class.html#GUID-D158EE4A-59B4-46F6-82FF-F26E6B07C1B7">getServerVersion（）</a> ，以启动并完成这些连接的故障转移。
                        </p>
                        <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-146ED846-BA38-42BC-8F71-F88BD9631444__BBACAHGD">例12-1</a>演示了如何将OCCI用于TAF回调和修复错误连接。请注意，该示例未显示自定义池数据结构或静音和并发控制。
                        </p>
                        <p>请注意，自定义连接池中的独立连接和连接的TAF行为是相同的。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-146ED846-BA38-42BC-8F71-F88BD9631444__BBACAHGD">
                        <p class="titleinexample">例12-1如何为连接池启用TAF</p><pre class="oac_no_warn" dir="ltr">#include &lt;occi.h&gt; #include &lt;iostream&gt; #include &lt;time.h&gt; using namespace std; using namespace oracle :: occi; // 3个连接的应用程序自定义池Environment * env;连接* conn1，* conn2，* conn3; bool conn1free，conn2free，conn3free; bool repairing = false; int taf_callback（Environment * env，Connection * conn，void * ctx，Connection :: FailOverType foType，Connection :: FailOverEventType foEvent）{cout &lt;&lt;“TAF callback for connection”&lt;&lt; conn &lt;&lt; endl; if（foEvent == Connection :: FO_ERROR）{cout &lt;&lt;“Retrying”&lt;&lt; endl;返回FO_RETRY; if（foEvent == Connection :: FO_END）{cout &lt;&lt;“TAF complete for connnection”&lt;&lt; conn &lt;&lt; endl; if（修复==假）{repairing = true; cout &lt;&lt;“修复其他空闲连接”&lt;&lt; endl; //在TAF尝试期间忽略错误{if（conn1free）conn1-&gt; getServerVersion（）;抓住（...）{} try {if（conn2free）conn2-&gt; getServerVersion（）;抓住（...）{} try {if（conn3free）conn3-&gt; getServerVersion（）;抓住（...）{}修复=假; } // if} //如果返回0; // continue failover} main（）{try {env = Environment :: createEnvironment（Environment :: THREADED_MUTEXED）; //打开3个连接; conn1 = env-&gt; createConnection（“hr”，“ <span class="italic">password</span> ”，“inst1_failback”）; conn2 = env-&gt; createConnection（“hr”，“ <span class="italic">password</span> ”，“inst1_failback”）; conn3 = env-&gt; createConnection（“hr”，“ <span class="italic">password</span> ”，“inst1_failback”）; //所有连接都是'空闲'conn1free = conn2free = conn3free = true; //在所有连接上设置TAF回调conn1-&gt; setTAFNotify（taf_callback，NULL）; conn2-&gt; setTAFNotify（taf_callback，NULL）; conn3-&gt; setTAFNotify（taf_callback，NULL）; //使用1个连接conn1free = false; cout &lt;&lt;“使用conn1”&lt;&lt; endl; Statement * stmt = conn1-&gt; createStatement（“select * from employees”）; ResultSet * rs = stmt-&gt; executeQuery（）; while（rs-&gt; next（））{cout &lt;&lt;（rs-&gt; getString（2））&lt;&lt; endl; } stmt-&gt; closeResultSet（rs）; conn1-&gt; terminateStatement（语句）; cout &lt;&lt;“关闭并重新启动数据库”&lt;&lt; endl;字符串buf; cin &gt;&gt; buf;声明* stmt2; try {cout &lt;&lt;“在EMP表上尝试更新”&lt;&lt; endl; stmt2 = conn1-&gt; createStatement（“从员工中删除”）; stmt2-&gt;的executeUpdate（）; } catch（SQLException＆ex）{cout &lt;&lt;“Update EMPLOYEES返回错误：”&lt;&lt; ex.getMessage（）&lt;&lt; endl; cin &gt;&gt; buf; } cout &lt;&lt;“完成”&lt;&lt; endl; env-&gt; terminateConnection（conn1连接）; env-&gt; terminateConnection（CONN2）; env-&gt; terminateConnection（CONN3）;环境:: terminateEnvironment（ENV）; } catch（SQLException＆ex）{cout &lt;&lt; ex.getMessage（）&lt;&lt; endl; }}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="LNCPP1202"></a><div class="props_rev_3"><a id="GUID-7191B319-0109-446E-96A1-65AB696C8C99" name="GUID-7191B319-0109-446E-96A1-65AB696C8C99"></a><h3 id="LNCPP-GUID-7191B319-0109-446E-96A1-65AB696C8C99" class="sect3"><span class="enumeration_section">12.2</span>关于连接共享</h3>
               <div>
                  <p>本节包括以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-E81F6929-F527-4FF3-A38C-58FCC384964E">线程安全简介</a></p>
                     </li>
                     <li>
                        <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE">实施线程安全</a></p>
                     </li>
                     <li>
                        <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-A1BDEA6E-2FB9-4E0F-B15B-83F1A56419A3">关于序列化</a></p>
                     </li>
                     <li>
                        <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-11EFCB7F-D572-43D8-A345-4737BD09E9EF">操作系统注意事项</a></p>
                     </li>
                  </ul>
               </div><a id="LNCPP20480"></a><div class="props_rev_3"><a id="GUID-E81F6929-F527-4FF3-A38C-58FCC384964E" name="GUID-E81F6929-F527-4FF3-A38C-58FCC384964E"></a><h4 id="LNCPP-GUID-E81F6929-F527-4FF3-A38C-58FCC384964E" class="sect4"><span class="enumeration_section">12.2.1</span>线程安全简介</h4>
                  <div>
                     <p>线程是存在于更大进程中的轻量级进程。每个线程共享相同的代码和数据段，但有自己的程序计数器，系统寄存器和堆栈。全局变量和静态变量对于所有线程都是通用的，并且可能需要互斥机制来管理从应用程序内的多个线程对这些变量的访问。</p>
                     <p>一旦产生，线程就会彼此异步运行。他们可以访问公共数据元素并以任何顺序进行OCCI调用。由于对数据元素的这种共享访问，需要一种机制来维护多个线程访问的数据的完整性。管理数据访问的机制采用互斥（互斥锁）的形式，确保在访问应用程序中的共享资源的多个线程之间不会发生冲突。在OCCI中，互斥体是在OCCI环境的基础上授予的。</p>
                     <p>Oracle数据库服务器和OCCI库的此线程安全功能使开发人员能够在多线程应用程序中使用OCCI，并具有以下额外优势：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>多个执行线程可以使OCCI调用与单个线程进行的连续调用具有相同的结果。</p>
                        </li>
                        <li>
                           <p>当多个线程进行OCCI调用时，线程之间没有副作用。</p>
                        </li>
                        <li>
                           <p>即使您不编写多线程程序，也不会因包含线程安全的OCCI调用而支付任何性能损失。</p>
                        </li>
                        <li>
                           <p>使用多个线程可以提高程序性能。您可以在多处理器系统上辨别线程，其中线程在单独的处理器上并发运行，并且在单处理器系统上可以在较慢的操作和更快的操作之间发生重叠。</p>
                        </li>
                     </ul>
                     <p>除客户端/服务器应用程序（客户端可以是多线程程序）之外，线程安全性通常用于三层或客户端/代理程序/服务器体系结构中。在此体系结构中，客户端仅关注表示服务。代理（或应用程序服务器）处理客户端应用程序的应用程序逻辑。通常，此关系是多对一关系，多个客户端共享同一应用程序服务器。</p>
                     <p>三层体系结构中的服务器层是Oracle数据库服务器。应用程序服务器（代理）支持多线程，每个线程为单独的客户端应用程序提供服务。在Oracle环境中，此中间层应用程序服务器是OCCI或预编译器程序。</p>
                  </div>
               </div><a id="LNCPP20481"></a><div class="props_rev_3"><a id="GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE" name="GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE"></a><h4 id="LNCPP-GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE" class="sect4"><span class="enumeration_section">12.2.2</span>实现线程安全</h4>
                  <div>
                     <div class="section">
                        <p>要通过使用OCCI来利用线程安全性，应用程序必须在线程安全的操作系统中运行。然后，应用程序必须通过为<code class="codeph">createEnvironment()</code>方法的mode参数指定<code class="codeph">THREADED_MUTEXED</code>或<code class="codeph">THREADED_UNMUTEXED</code>来通知OCCI应用程序在多线程模式下运行。例如，要启用互斥锁定，请发出以下声明：</p><pre class="oac_no_warn" dir="ltr">Environment * env = Environment :: createEnvironment（Environment :: THREADED_MUTEXED）;</pre><p>请注意，一旦<code class="codeph">createEnvironment</code>被称为与<code class="codeph">THREADED_MUTEXED</code>或<code class="codeph">THREADED_UNMUTEXED</code> ，对所有后续调用<code class="codeph">createEnvironment</code>方法也必须做出<code class="codeph">THREADED_MUTEXED</code>或<code class="codeph">THREADED_UNMUTEXED</code>模式。
                        </p>
                        <p>如果多线程应用程序在线程安全的操作系统中运行，则OCCI库在每个OCCI环境的基础上管理应用程序的互斥锁。但是，您可以覆盖此功能并让您的应用程序维护自己的互斥锁方案。这是通过为<code class="codeph">createEnvironment()</code>方法指定<code class="codeph">THREADED_UNMUTEXED</code>的模式值来完成的。
                        </p>
                        <p>在非线程安全平台上运行的应用程序不应将<code class="codeph">THREADED_MUTEXED</code>或<code class="codeph">THREADED_UNMUTEXED</code>值传递给<code class="codeph">createEnvironment()</code>方法。
                        </p>
                        <p>如果应用程序是单线程的，则无论平台是否是线程安全的，应用程序都应将<code class="codeph">Environment::DEFAULT</code>的值传递给<code class="codeph">createEnvironment()</code>方法。这也是mode参数的默认值。在<code class="codeph">THREADED_MUTEXED</code>模式下运行的单线程应用程序可能会导致性能下降。
                        </p>
                        <p>OCCI不支持非阻塞模式。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNCPP20482"></a><div class="props_rev_3"><a id="GUID-A1BDEA6E-2FB9-4E0F-B15B-83F1A56419A3" name="GUID-A1BDEA6E-2FB9-4E0F-B15B-83F1A56419A3"></a><h4 id="LNCPP-GUID-A1BDEA6E-2FB9-4E0F-B15B-83F1A56419A3" class="sect4"><span class="enumeration_section">12.2.3</span>关于序列化</h4>
                  <div>
                     <p>作为应用程序员，您在多线程应用程序中有两个关于并发的基本选项：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-747EE0AB-EED6-4B03-9029-190AF2C0B609">自动序列化</a> ，您可以使用OTIS的透明机制</p>
                        </li>
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-9A71755F-9EC4-4F00-AED0-B7CBBF96DFEF">应用程序提供的序列化</a> ，您可以在其中管理维护多个线程所涉及的意外事件</p>
                        </li>
                     </ul>
                  </div><a id="LNCPP20483"></a><div class="props_rev_3"><a id="GUID-747EE0AB-EED6-4B03-9029-190AF2C0B609" name="GUID-747EE0AB-EED6-4B03-9029-190AF2C0B609"></a><h5 id="LNCPP-GUID-747EE0AB-EED6-4B03-9029-190AF2C0B609" class="sect5"><span class="enumeration_section">12.2.3.1</span>自动序列化</h5>
                     <div>
                        <p>如果有多个线程在从OCCI环境派生的对象（连接和连接池）上运行，您可以选择让OCCI序列化对这些对象的访问。第一步是将值<code class="codeph">THREADED_MUTEXED</code>传递给<code class="codeph">createEnvironment</code>方法。此时，OCCI库会自动获取环境中线程安全对象的互斥锁。
                        </p>
                        <p>使用<code class="codeph">THREADED_MUTEXED</code>模式创建OCCI环境时，只有<code class="codeph">Environment</code> ， <code class="codeph">Map</code> ， <code class="codeph">ConnectionPool</code> ， <code class="codeph">StatelessConnectionPool</code>和<code class="codeph">Connection</code>对象是线程安全的。也就是说，如果两个线程同时调用其中一个对象，则OCCI会在内部对它们进行序列化。但请注意，所有其他OCCI对象（如<code class="codeph">Statement</code> ， <code class="codeph">ResultSet</code> ， <code class="codeph">SQLException</code> ， <code class="codeph">Stream</code>等）都不是线程安全的，因为应用程序不应同时从多个线程对这些对象进行操作。
                        </p>
                        <p>请注意，OCCI调用的大部分处理都发生在服务器上，因此如果使用OCCI调用的两个线程转到同一连接，则其中一个线程可能会被阻塞，而另一个线程在服务器上完成处理。</p>
                     </div>
                  </div><a id="LNCPP20484"></a><div class="props_rev_3"><a id="GUID-9A71755F-9EC4-4F00-AED0-B7CBBF96DFEF" name="GUID-9A71755F-9EC4-4F00-AED0-B7CBBF96DFEF"></a><h5 id="LNCPP-GUID-9A71755F-9EC4-4F00-AED0-B7CBBF96DFEF" class="sect5"><span class="enumeration_section">12.2.3.2</span>应用程序提供的序列化</h5>
                     <div>
                        <p>如果有多个线程在从OCCI环境派生的对象上运行，则可以选择管理序列化。第一步是为<code class="codeph">createEnvironment</code>模式传递<code class="codeph">THREADED_UNMUTEXED</code>值。在这种情况下，应用程序必须相互独占地锁定对从同一OCCI环境派生的对象进行的OCCI调用。这具有以下优点：可以基于应用程序设计来优化互斥方案以获得更大的并发性。
                        </p>
                        <p>在此模式下创建OCCI环境时，OCCI会识别应用程序在多线程应用程序中运行，但OCCI无需获取其内部互斥锁。OCCI假定所有对从该OCCI环境派生的对象方法的调用都由应用程序序列化。您可以通过以下两种方式实现：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>每个线程都有自己的环境。也就是说，环境和从中派生的所有对象（连接，连接池，语句，结果集等）不会跨线程共享。在这种情况下，您的应用程序不需要应用任何互斥锁。</p>
                           </li>
                           <li>
                              <p>如果应用程序共享OCCI环境或跨线程从环境派生的任何对象，则它必须序列化对这些对象的访问（通过使用互斥锁等），这样只有一个线程在任何这些对象上调用OCCI方法。</p>
                           </li>
                        </ul>
                        <p>在这两种情况下，OCCI都没有获得互斥体。你必须确保只有一个OCCI通话过程中从OCCI环境在任何给定的时间派生的任何物体上时<code class="codeph">THREADED_UNMUTEXED</code>使用。
                        </p>
                        <p>OCCI经过优化，可以尽可能地重用对象。由于每个环境都有自己的堆，因此多个环境会导致内存消耗增加。拥有多个环境可能意味着重复有关连接，连接池，语句和结果集对象的工作。这导致进一步的内存消耗。</p>
                        <p>与服务器建立多个连接会导致服务器和网络上的资源消耗更多。拥有多个环境通常需要更多连接。</p>
                     </div>
                  </div>
               </div><a id="LNCPP21906"></a><div class="props_rev_3"><a id="GUID-11EFCB7F-D572-43D8-A345-4737BD09E9EF" name="GUID-11EFCB7F-D572-43D8-A345-4737BD09E9EF"></a><h4 id="LNCPP-GUID-11EFCB7F-D572-43D8-A345-4737BD09E9EF" class="sect4"><span class="enumeration_section">12.2.4</span>操作系统注意事项</h4>
                  <div>
                     <p>某些操作系统提供了生成进程的工具，允许子进程重用其父进程创建的状态。</p>
                     <p>父进程生成子进程后，子进程<span class="italic">不得</span>使用父进程创建的数据库连接。由于SQL * Net只希望一个用户进程使用与数据库的特定连接，因此子进程尝试使用与父进程相同的数据库连接可能会导致意外的连接干扰，并导致间歇性的<code class="codeph">ORA-03137</code>错误。
                     </p>
                     <p>当应用程序需要多个并发连接时，Oracle建议在支持线程的平台上使用线程。Oracle支持单线程和多线程应用程序中的并发连接。</p>
                     <p>有关<span class="q"><a href="optimizing-performance-of-cplusplus-applications.html#GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE">线程</a></span>的更多信息，请参见<span class="q">“ <a href="optimizing-performance-of-cplusplus-applications.html#GUID-E81F6929-F527-4FF3-A38C-58FCC384964E">线程安全性简介</a> ”</span>和<span class="q">“ <a href="optimizing-performance-of-cplusplus-applications.html#GUID-2462E0CD-D58A-405C-B7D6-E725ED5147AE">实现线程安全性</a> ”</span> 。
                     </p>
                     <p>要提高许多并发打开的连接的性能，请参阅<span class="q">“ <a href="accessing-oracle-database-using-cplusplus.html#GUID-753C36CE-E6A0-4F0D-B85E-C253EB916C8D">关于池连接</a> ”</span> 。
                     </p>
                  </div>
               </div>
            </div><a id="LNCPP1203"></a><div class="props_rev_3"><a id="GUID-96783A66-4018-4CC4-9D9A-36075BB3FF1A" name="GUID-96783A66-4018-4CC4-9D9A-36075BB3FF1A"></a><h3 id="LNCPP-GUID-96783A66-4018-4CC4-9D9A-36075BB3FF1A" class="sect3"><span class="enumeration_section">12.3</span>关于应用程序管理数据缓冲</h3>
               <div>
                  <p>当您通过参数化语句中的<code class="codeph">set</code> <span class="italic">xxx</span>方法提供绑定参数的数据时，会将值复制到内部数据缓冲区中，然后将复制的值提供给数据库服务器以进行插入。要减少复制用户缓冲区中可用的<code class="codeph">string</code>类型数据的开销，请使用<a href="resultset-class.html#GUID-9E0C0A68-57B7-4C77-8865-A306BF6953CA">ResultSet类</a>的<a href="resultset-class.html#GUID-98BF5B63-A834-419B-927B-7F02E9ECF1B3">setDataBuffer（）</a>和<a href="resultset-class.html#GUID-1535D185-F592-4B90-B358-998EDC72094A">next（）</a>方法以及<a href="statement-class.html#GUID-DF0FF9BE-6EF5-4D2A-A45D-A6F2FDF6133D">Statement类</a>的<a href="statement-class.html#GUID-9D152584-D72E-42AE-A3CC-3C6A4F35C11B">execute（）</a>方法。
                  </p>
                  <div class="p">本节包括以下主题：<ul style="list-style-type:disc">
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-0F9A3D45-5912-4AD0-B0FB-DDA8F03C91B5">使用setDataBuffer（）方法</a></p>
                        </li>
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-D689DB14-F381-4874-9200-8705FCA00CFC">使用executeArrayUpdate（）方法</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="LNCPP20485"></a><div class="props_rev_3"><a id="GUID-0F9A3D45-5912-4AD0-B0FB-DDA8F03C91B5" name="GUID-0F9A3D45-5912-4AD0-B0FB-DDA8F03C91B5"></a><h4 id="LNCPP-GUID-0F9A3D45-5912-4AD0-B0FB-DDA8F03C91B5" class="sect4"><span class="enumeration_section">12.3.1</span>使用setDataBuffer（）方法</h4>
                  <div>
                     <div class="section">
                        <p>对于高性能应用程序，OCCI提供<code class="codeph">setDataBuffer</code>方法，由此数据缓冲区由应用程序管理。以下示例显示了<a href="resultset-class.html#GUID-98BF5B63-A834-419B-927B-7F02E9ECF1B3">setDataBuffer（）</a>方法：</p><pre class="oac_no_warn" dir="ltr">void setDataBuffer（int paramIndex，void * buffer，Type type，sb4 size，ub2 * length，sb2 * ind = NULL，ub2 * rc = NULL）;</pre><p>以前的方法示例中使用以下参数：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">paramIndex</code> ：参数号</p>
                           </li>
                           <li>
                              <p><code class="codeph">buffer</code> ：包含数据的数据缓冲区</p>
                           </li>
                           <li>
                              <p><code class="codeph">type</code> ：数据缓冲区中数据的类型</p>
                           </li>
                           <li>
                              <p><code class="codeph">size</code> ：数据缓冲区的大小</p>
                           </li>
                           <li>
                              <p><code class="codeph">length</code> ：数据缓冲区中当前的数据长度</p>
                           </li>
                           <li>
                              <p><code class="codeph">ind</code> ：指标信息。这表示数据是否为<code class="codeph">NULL</code> 。对于参数化语句，值为<code class="codeph">-1</code>表示要插入<code class="codeph">NULL</code>值。对于从可调用语句返回的数据，值<code class="codeph">-1</code>表示检索<code class="codeph">NULL</code>数据。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">rc</code> ：返回代码。此变量不适用于提供给<code class="codeph">Statement</code>方法的数据。但是，对于从可调用语句返回的数据，返回代码指定特定于参数的错误号。
                              </p>
                           </li>
                        </ul>
                        <p>并非所有数据类型都可以通过<code class="codeph">setDataBuffer()</code>方法提供和检索。例如，C ++标准库字符串不能与<code class="codeph">setDataBuffer()</code>接口一起提供。
                        </p>
                        <div class="infoboxnotealso" id="GUID-0F9A3D45-5912-4AD0-B0FB-DDA8F03C91B5__GUID-4F095C86-BBAE-47A8-9BF4-7F33B153427E">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="data-types.html#GUID-62361201-C028-425D-A809-AB0CC01F2F67__CJAFHAAD" title="该表有4列。第1列列出了外部数据类型;第2栏提供简要说明;第3列列出了匹配的C ++类型;第4列列出了匹配的OCCI类型。">表5-2</a>针对特定情况的<a href="data-types.html#GUID-90F238BF-BF35-411C-9CB8-3D6A2970729D">数据类型</a></p>
                        </div>
                        <p><code class="codeph">set</code> <span class="italic">xxx</span> <code class="codeph">()</code>方法和<code class="codeph">setDataBuffer()</code>方法提供的数据之间存在重要差异。在<code class="codeph">set</code> <span class="italic">xxx</span> <code class="codeph">()</code>方法中复制数据时，一旦复制数据，原始文件就会更改。例如，您可以使用<code class="codeph">setString(str1)</code>方法，然后在执行之前更改<code class="codeph">str1</code>的值。使用的<code class="codeph">str1</code>的值是调用<code class="codeph">setString(str1)</code>时的值。但是，对于<code class="codeph">setDataBuffer()</code>方法提供的数据，缓冲区必须保持有效，直到执行完成。
                        </p>
                        <p>如果执行迭代或使用<code class="codeph">executeArrayUpdate()</code>方法，则可以在单个缓冲区中提供多行和迭代的数据。在这种情况下，第<span class="italic">i</span>次迭代的数据位于<code class="codeph">buffer + (i-1) *size address</code> ，长度，指示符和返回码位于<code class="codeph">*(length + i)</code> ， <code class="codeph">*(ind + i)</code>和<code class="codeph">*(rc + i)</code>分别。
                        </p>
                        <p>此接口还适用于具有数组或<code class="codeph">OUT</code>绑定参数的数组执行和可调用语句。
                        </p>
                        <p><code class="codeph">ResultSet</code>类中提供了相同的方法来检索数据，而无需为每次提取重新分配缓冲区。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNCPP20487"></a><a id="LNCPP20488"></a><a id="LNCPP20486"></a><div class="props_rev_3"><a id="GUID-D689DB14-F381-4874-9200-8705FCA00CFC" name="GUID-D689DB14-F381-4874-9200-8705FCA00CFC"></a><h4 id="LNCPP-GUID-D689DB14-F381-4874-9200-8705FCA00CFC" class="sect4"><span class="enumeration_section">12.3.2</span>使用executeArrayUpdate（）方法</h4>
                  <div>
                     <div class="section">
                        <p>如果所有数据都是使用<code class="codeph">setDataBuffer()</code>方法或输出流提供的（也就是说，除了<code class="codeph">setDataBuffer()</code>或<code class="codeph">getStream()</code>之外没有<code class="codeph">set</code> <span class="italic">xxx（）</span>方法），那么有一种简化的迭代执行方式。
                        </p>
                        <p>在这种情况下，您不应该调用<code class="codeph">setMaxIterations()</code>和<code class="codeph">setMaxParamSize()</code> 。相反，为具有适当大小数组的每个参数调用<code class="codeph">setDataBuffer()</code>或<code class="codeph">getStream()</code>方法，以便为每次迭代提供数据，然后执行<code class="codeph">executeArrayUpdate(int</code> <code class="codeph">arrayLength)</code>方法。<code class="codeph">arrayLength</code>参数指定每个缓冲区中提供的元素数。本质上，这与将迭代次数设置为<code class="codeph">arrayLength</code>并执行语句相同。
                        </p>
                        <p>由于流参数仅指定一次，因此它们也可以与数组执行一起使用。但是，如果使用任何<code class="codeph">set</code> <span class="italic">xxx</span> <code class="codeph">()</code>方法，则<code class="codeph">addIteration()</code>方法以提供多行数据。要比较这两种方法，请考虑在<code class="codeph">employees</code>表中插入两个雇员的<a href="optimizing-performance-of-cplusplus-applications.html#GUID-D689DB14-F381-4874-9200-8705FCA00CFC__CIAEIFHJ">示例12-2</a> ：</p>
                        <p>但是，如果第一个参数也可以通过<code class="codeph">setDataBuffer()</code>接口提供，那么，您将使用<code class="codeph">executeArrayUpdate()</code>方法而不是<code class="codeph">addIteration()</code>方法，如<a href="optimizing-performance-of-cplusplus-applications.html#GUID-D689DB14-F381-4874-9200-8705FCA00CFC__CIAIGGHF">例12-3</a>所示：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-D689DB14-F381-4874-9200-8705FCA00CFC__CIAEIFHJ">
                        <p class="titleinexample">示例12-2如何使用addIteration（）方法插入记录</p><pre class="oac_no_warn" dir="ltr">Statement * stmt = conn-&gt; createStatement（“insert into departments（department_id，department_name）values（：1，：2）”）; char dnames [] [100] = {“社区外展”，“大学招聘”}; ub2 dnameLen [2]; for（int i = 0; i &lt;2; i ++）dnameLen [i] = strlen（dnames [i] + 1）; stmt-&gt; setMaxIterations（2）; //设置最大迭代次数stmt-&gt; setInt（1,7369）; //指定第一行的数据stmt-&gt; setDataBuffer（2，dnames，OCCI_SQLT_STR，sizeof（dnames [0]），dnameLen）; stmt-&gt; addIteration（）; stmt-&gt; setInt（1,7654）; //指定第二行的数据//第二个// bind参数不需要setDatBuffer，因为// setDataBuffer提供的数据只指定一次。stmt-&gt;的executeUpdate（）;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-D689DB14-F381-4874-9200-8705FCA00CFC__CIAIGGHF">
                        <p class="titleinexample">示例12-3如何使用executeArrayUpdate（）方法插入记录</p><pre class="oac_no_warn" dir="ltr">Statement * stmt = conn-&gt; createStatement（“insert into departments（department_id，department_name）values（：1，：2）”）; char dnames [] [100] = {“社区外展”，“大学招聘”}; ub2 dnameLen [2]; for（int i = 0; i &lt;2; i ++）dnameLen [i] = strlen（dnames [i] + 1）; int ids [2] = {7369,7654}; ub2 idLen [2] = {sizeof（ids [0]），sizeof（ids [1]）}; stmt-&gt; setDataBuffer（1，ids，OCCIINT，sizeof（ids [0]），idLen）; stmt-&gt; setDataBuffer（2，dnames，OCCI_SQLT_STR，sizeof（dnames [0]），dnameLen）; stmt-&gt; executeArrayUpdate（2）; //插入了两行数据。</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="LNCPP20489"></a><a id="LNCPP1204"></a><div class="props_rev_2"><a id="GUID-F6AD3A0C-7DD2-4362-8BFE-F4718D26817C" name="GUID-F6AD3A0C-7DD2-4362-8BFE-F4718D26817C"></a><h3 id="LNCPP-GUID-F6AD3A0C-7DD2-4362-8BFE-F4718D26817C" class="sect3"><span class="enumeration_section">12.4</span>使用next（）方法使用数组提取</h3>
               <div>
                  <div class="section">
                     <p>如果应用程序仅使用<code class="codeph">setDataBuffer()</code>接口或流接口获取数据，则可以执行数组提取。数组提取是通过<code class="codeph">ResultSet</code>类的<code class="codeph">next(</code> ）方法实现的。在再次调用之前，您必须处理通过next（）获得的结果。
                     </p>
                     <p>这会导致每列最多获取<span class="italic"><code class="codeph">numRows</code></span>数据量。使用<code class="codeph">setDataBuffer()</code>接口指定的缓冲区应足够大，至少可容纳数量的<span class="italic"><code class="codeph">numRows</code></span> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-F6AD3A0C-7DD2-4362-8BFE-F4718D26817C__GUID-4F56D45D-D0E1-4A40-BF56-949B04A764CC">
                     <p class="titleinexample">示例12-4如何对ResultSet使用Array Fetch</p><pre class="oac_no_warn" dir="ltr">ResultSet * resultSet = stmt-&gt; executeQuery（...）; resultSet-&gt; setDataBuffer（...）; while（resultSet-&gt; next（ <span class="italic">numRows</span> ）== DATA_AVAILABLE）进程（resultSet-&gt; getNumArrayRows（））;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="LNCPP20490"></a><a id="LNCPP1205"></a><div class="props_rev_3"><a id="GUID-B406B496-9395-4D76-899F-71E414B68FB9" name="GUID-B406B496-9395-4D76-899F-71E414B68FB9"></a><h3 id="LNCPP-GUID-B406B496-9395-4D76-899F-71E414B68FB9" class="sect3"><span class="enumeration_section">12.5</span>迭代修改行</h3>
               <div>
                  <div class="section">
                     <p>处理批次的错误，指定<code class="codeph">Statement</code>对象处于<code class="codeph">batchMode</code>使用执行的<a href="statement-class.html#GUID-EF2EE8DD-29C6-4669-BE6C-76173C5DF0A8">setBatchErrorMode（）</a>方法。设置<code class="codeph">batchMode</code>并运行批量更新后，将通过<a href="batchsqlexcept-class.html#GUID-C0D03734-0259-41A6-881A-6176820F7249">BatchSQLException类</a>报告任何结果错误。
                     </p>
                     <p><code class="codeph">BatchSQLException</code>类提供处理批错误的方法。<a href="optimizing-performance-of-cplusplus-applications.html#GUID-B406B496-9395-4D76-899F-71E414B68FB9__CHDHIIJD">例12-5</a>说明了如何在任何OCCI应用程序中实现批处理。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-B406B496-9395-4D76-899F-71E414B68FB9__CHDHIIJD">
                     <p class="titleinexample">示例12-5如何迭代地修改行并处理错误</p>
                     <ol>
                        <li>
                           <p>创建Statement对象并将其批处理错误模式设置为<code class="codeph">TRUE</code> 。</p><pre class="oac_no_warn" dir="ltr">Statement * stmt = conn-&gt; createStatement（“...”）; stmt-&gt; setBatchErrorMode（true）;</pre></li>
                        <li>
                           <p>执行应用程序所需的程序化更改。</p>
                        </li>
                        <li>
                           <p>更新声明。</p><pre class="oac_no_warn" dir="ltr">尝试{updateCount = stmt-&gt; executeUpdate（）; }</pre></li>
                        <li>
                           <p>捕获并处理批量插入或更新期间生成的任何错误。</p><pre class="oac_no_warn" dir="ltr">catch（BatchSQLException＆batchEx）{cout &lt;&lt;“Batch Exception：”&lt;&lt; batchEx.what（）&lt;&lt; endl; int errCount = batchEx.getFailedRowCount（）; cout &lt;&lt;“失败的行数”&lt;&lt; errCount &lt;endl; for（int i = 0; i &lt;errCount; i ++）{SQLException err = batchEx.getException（i）; unsigned int rowIndex = batchEx.getRowNum（i）; cout &lt;&lt;“Row”&lt;&lt; rowIndex &lt;&lt;“失败，因为”&lt;&lt; err.getErrorCode（）&lt;&lt; endl; } //对失败的行执行恢复操作}</pre></li>
                        <li>
                           <p>捕获并处理语句更新期间生成的其他错误。请注意，语句级错误仍然作为<code class="codeph">SQLException</code>实例<code class="codeph">SQLException</code> 。
                           </p><pre class="oac_no_warn" dir="ltr">catch（SQLException＆ex）//捕获其他SQLExceptions。{cout &lt;&lt;“SQLException：”&lt;&lt; e.what（）&lt;&lt; endl; }</pre></li>
                     </ol>
                  </div>
                  <!-- class="example" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61" name="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61"></a><h3 id="LNCPP-GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61" class="sect3"><span class="enumeration_section">12.6</span>关于在Traffic Director模式下使用Oracle Connection Manager</h3>
               <div>
                  <p>Traffic Director Mode中的Oracle Connection Manager是一个放置在支持的数据库客户端和数据库实例之间的代理。</p>
                  <div class="p">Oracle Database <span class="italic">11g</span>第2版（11.2）及更高版本中支持的客户端可以在Traffic Director模式下连接到Oracle Connection Manager。流量控制器模式中的Oracle连接管理器为计划内和计划外数据库服务器中断，连接多路复用支持和负载平衡提供了改进的高可用性（HA）。以下各节将更详细地介绍对Traffic Director模式中的Oracle Connection Manager的支持<ul style="list-style-type:disc">
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__MODESOFOPERATION-4FD4C8FE">运作模式</a></p>
                        </li>
                        <li>
                           <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__KEYFEATURES-4FD4D08F">主要特点</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="section" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__MODESOFOPERATION-4FD4C8FE">
                     <p class="subhead2" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__GUID-749BC524-93BC-42F1-B765-970605875B7F">运作模式</p>
                     <p>流量控制器模式中的Oracle连接管理器支持以下操作模式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <div class="p">在池连接模式下，流量控制器模式中的Oracle连接管理器支持使用以下数据库客户端版本的任何应用程序：<ul style="list-style-type:disc">
                                 <li>
                                    <p>OCI，OCCI和开源驱动程序（Oracle Database <span class="italic">11g第</span> 2版（11.2.0.4）及更高版本））</p>
                                 </li>
                                 <li>
                                    <p>JDBC（Oracle Database 12c <span class="italic">第</span> 1版（12.1）及更高版本）</p>
                                 </li>
                                 <li>
                                    <p>ODP.NET（Oracle Database 12 <span class="italic">c第</span> 2版（12.2）及更高版本）</p>
                                 </li>
                              </ul>
                           </div>
                           <p>此外，应用程序必须使用DRCP。也就是说，应用程序必须在连接字符串（或<code class="codeph">tnsnames.ora</code>别名）中启用DRCP。
                           </p>
                        </li>
                        <li>
                           <p>在非池化连接（或专用）模式下，流量控制器模式中的Oracle连接管理器支持使用数据库客户机版本Oracle Database <span class="italic">11g第</span> 2版（11.2.0.4）及更高版本的任何应用程序。在此模式下，某些功能（如连接多路复用）不可用。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__KEYFEATURES-4FD4D08F">
                     <p class="subhead2" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__GUID-3A52B2C3-D63C-4ACB-8FED-1BAFC3801338">主要特点</p>
                     <div class="p">Traffic Director Mode中的Oracle Connection Manager提供以下支持：<ul style="list-style-type:disc">
                           <li>
                              <div class="p">透明的性能增强和连接多路复用，包括：<ul style="list-style-type:disc">
                                    <li>
                                       <p>对所有操作模式自动启用语句高速缓存，行预取和结果集高速缓存。</p>
                                    </li>
                                    <li>
                                       <p>使用代理驻留连接池（PRCP）的数据库会话多路复用（仅池化模式），其中PRCP是数据库驻留连接池（DRCP）的代理模式。应用程序在Traffic Director模式下的Oracle Connection Manager与数据库之间获得透明的连接时负载平衡和运行时负载平衡。</p>
                                    </li>
                                    <li>
                                       <p>对于Traffic Director模式实例中的多个Oracle Connection Manager，应用程序通过客户端连接时间负载平衡或负载均衡器（BIG-IP，NGINX等）获得更高的可扩展性</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">零应用程序停机时间<ul style="list-style-type:disc">
                                    <li>
                                       <div class="p">计划数据库维护或可插拔数据库（PDB）重定位<ul style="list-style-type:disc">
                                             <li>
                                                <p>合并模式</p>
                                                <p>流量控制器模式中的Oracle Connection Manager响应Oracle Notification Service（ONS）事件以计划中断和重定向工作。请求完成后，在流量控制器模式下，Oracle Connection Manager上的池中的连接将耗尽。Oracle Database <span class="italic">11g第</span> 2版（11.2.0.4）及更高版本支持服务重定位。
                                                </p>
                                                <p>对于PDB重定位，当PDB重新定位时，流量控制器模式中的Oracle连接管理器会响应带内通知，即使未配置ONS时也是如此（对于Oracle数据库版本18c，仅限版本18.1及更高版本的服务器）</p>
                                             </li>
                                             <li>
                                                <p>非汇集或专用模式</p>
                                                <div class="p">当客户端没有请求边界信息时，流量控制器模式中的Oracle连接管理器支持许多应用程序的计划中断（只要在请求/事务边界上只需要保留简单的会话状态和游标状态）。这种支持包括：<ul style="list-style-type:disc">
                                                      <li>
                                                         <p>在事务边界处停止服务/ PDB，或者利用Oracle数据库版本18c连续应用程序可用性来停止请求边界处的服务</p>
                                                      </li>
                                                      <li>
                                                         <p>流量控制器模式中的Oracle连接管理器利用透明应用程序故障转移（TAF）故障转移还原来重新连接和还原简单状态。</p>
                                                      </li>
                                                   </ul>
                                                </div>
                                             </li>
                                          </ul>
                                       </div>
                                    </li>
                                    <li>
                                       <p>针对大多数读取工作负载的计划外数据库中断</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">流量控制器模式中Oracle Connection Manager的高可用性，以避免单点故障。这得到以下支持：<ul style="list-style-type:disc">
                                    <li>
                                       <p>流量控制器模式中的多个Oracle连接管理器实例，使用连接字符串中的负载平衡器或客户端负载平衡/故障转移</p>
                                    </li>
                                    <li>
                                       <p>在Traffic Director模式实例中滚动升级Oracle Connection Manager</p>
                                    </li>
                                    <li>
                                       <p>针对计划中断，在流量控制器模式下从客户端到Oracle Connection Manager的现有连接的正常关闭</p>
                                    </li>
                                    <li>
                                       <p>带有Oracle数据库版本18c及更高版本客户端的带内通知</p>
                                    </li>
                                    <li>
                                       <p>对于较旧的客户端，通知将与当前请求的响应一起发送</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">为了安全性和隔离性，Traffic Director Mode中的Oracle Connection Manager提供：<ul style="list-style-type:disc">
                                    <li>
                                       <p>数据库代理支持传输控制协议/传输控制协议安全（TCP / TCPS）和协议转换</p>
                                    </li>
                                    <li>
                                       <p>防火墙基于IP地址，服务名称和安全套接字层/传输层安全性（SSL / TLS）钱包</p>
                                    </li>
                                    <li>
                                       <p>多租户环境中的租户隔离</p>
                                    </li>
                                    <li>
                                       <p>防止拒绝服务和模糊测试攻击</p>
                                    </li>
                                    <li>
                                       <p>跨Oracle数据库本地和Oracle Cloud安全地隧道传输数据库流量</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-BF9AFFD6-537A-4252-BBFB-3A60EEAC3E61__GUID-A2DD3A99-8792-4704-A482-B66B30AD1B85">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关配置<code class="codeph">cman.ora</code>配置文件以在Traffic Director模式下设置Oracle Connection Manager的信息，请<code class="codeph">cman.ora</code> <a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-3917FC5D-4B23-4752-85BA-39A88C4D13F8" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-58847B76-3836-41DB-9EB6-A81D5C397024" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a> ，了解有关在Traffic Director模式代理身份验证中为Oracle Connection Manager配置数据库的信息</p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-96FA23BA-F32B-4D47-9CBB-69D27E8D94F6" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a> ，了解有关在流量控制器模式下为计划外停机事件配置Oracle Connection Manager的信息</p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-E73658E7-BBF7-4C13-AAD5-70D32062AD8D" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a> ，了解有关在Traffic Director模式下为计划的关闭事件配置Oracle Connection Manager的信息</p>
                           </li>
                           <li>
                              <p><a href="../netag/configuring-oracle-connection-manager.html#NETAG-GUID-15756B12-5ED5-4EDE-9D4B-6B890D5BE9AF" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”，</cite></span></a>以获取有关在流量控制器模式下配置Oracle Connection Manager使用的代理驻留连接池的信息</p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lncpp&amp;id=NETAG-GUID-FC833F8F-CE5A-4C02-A962-244954158853" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a> ，了解有关在流量控制器模式下使用Oracle Connection Manager的所有驱动程序不支持的功能的信息</p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lncpp&amp;id=NETRF-GUID-668B9035-0B99-4CDF-B7D5-468B30AD7A80" target="_blank"><span><cite>Oracle Database Net Services参考</cite></span></a> ，以获取Oracle CMAN配置文件的概述</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="LNCPP20028"></a><div class="props_rev_3"><a id="GUID-5F06D230-7248-4BB0-AC4C-0BC42AC6B3AC" name="GUID-5F06D230-7248-4BB0-AC4C-0BC42AC6B3AC"></a><h3 id="LNCPP-GUID-5F06D230-7248-4BB0-AC4C-0BC42AC6B3AC" class="sect3"><span class="enumeration_section">12.7</span>关于无状态连接池的运行时负载平衡</h3>
               <div>
                  <p>无状态连接池中的运行时负载平衡动态地将连接请求路由到最少加载的数据库实例。这是通过使用服务指标实现的，服务指标由Oracle RAC负载平衡通报分发。</p>
                  <p>该功能通过以下方式修改无状态连接池：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>池会定期收到有关实例加载的通知。</p>
                     </li>
                     <li>
                        <p>收到连接请求后，池会根据实例的负载为请求类型选择最佳连接。</p>
                     </li>
                     <li>
                        <p>无状态连接池定期终止重载实例的连接，维护与实例加载相对应的连接拓扑。</p>
                     </li>
                     <li>
                        <p>由于可以终止与重载实例的连接，因此池会创建新连接以维持并发要求。这些新连接是使用Oracle RAC侦听器的连接时负载平衡创建的。</p>
                     </li>
                  </ul>
                  <p>在<code class="codeph">THREADED_MUTEXED</code>和<code class="codeph">EVENTS</code>模式下创建OCCI环境时，以及当服务器配置为发出事件通知时，默认情况下会启用运行时负载平衡。
                  </p>
                  <div class="infoboxnotealso" id="GUID-5F06D230-7248-4BB0-AC4C-0BC42AC6B3AC__GUID-14845788-AC87-4745-A21F-DFF4FD4F1AF3">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../lnoci/index.html" target="_blank"><span><cite>Oracle调用接口程序员指南</cite></span></a></p>
                  </div>
                  <p>本节包括以下主题： <a href="optimizing-performance-of-cplusplus-applications.html#GUID-7DBAD779-65CD-4AED-9A9B-C48D8D533337">API支持</a> 。
                  </p>
               </div><a id="LNCPP20491"></a><div class="props_rev_3"><a id="GUID-7DBAD779-65CD-4AED-9A9B-C48D8D533337" name="GUID-7DBAD779-65CD-4AED-9A9B-C48D8D533337"></a><h4 id="LNCPP-GUID-7DBAD779-65CD-4AED-9A9B-C48D8D533337" class="sect4"><span class="enumeration_section">12.7.1</span> API支持</h4>
                  <div>
                     <p>新<code class="codeph">NO_RLB</code>的选项<code class="codeph">PoolType</code>的属性<a href="statelessconnectionpool-class.html#GUID-C0591485-F818-4AC0-9875-ED245BDABCA6">StatelessConnectionPool类</a>禁用运行时的负载均衡。
                     </p>
                  </div>
               </div>
            </div><a id="LNCPP1206"></a><div class="props_rev_3"><a id="GUID-8ADCAB82-EBBE-43C0-BECE-4E74687A166D" name="GUID-8ADCAB82-EBBE-43C0-BECE-4E74687A166D"></a><h3 id="LNCPP-GUID-8ADCAB82-EBBE-43C0-BECE-4E74687A166D" class="sect3"><span class="enumeration_section">12.8</span>关于故障诊断</h3>
               <div>
                  <p>故障可诊断性在发生问题事件时在OCCI客户端上捕获诊断数据，例如转储文件或核心转储文件。对于每个事件，故障可诊断功能会创建一个自动诊断存储库（ADR）子目录，用于存储此诊断数据。例如，如果Linux或UNIX应用程序失败并带有空指针引用，则核心文件将显示在ADR主目录（如果存在）中，而不是在操作系统目录中。本节讨论ADR子目录结构和管理其输出的实用程序ADR命令解释器（ADRCI）。</p>
                  <p>ADR主目录是产品实例（如OCCI）和特定操作系统用户的所有诊断数据的根目录。所有ADR家庭都出现在同一个根目录ADR基础之下。</p>
                  <div class="infoboxnotealso" id="GUID-8ADCAB82-EBBE-43C0-BECE-4E74687A166D__GUID-0B2FA5EE-F101-448F-A5A3-786E12127A41">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../admin/diagnosing-and-resolving-problems.html#ADMIN11007" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a></p>
                     <div class="p">本节包括以下主题：<ul style="list-style-type:disc">
                           <li>
                              <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA">使用ADR基本位置</a></p>
                           </li>
                           <li>
                              <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A">使用ADRCI</a></p>
                           </li>
                           <li>
                              <p><a href="optimizing-performance-of-cplusplus-applications.html#GUID-20C6A172-C450-44C0-BE4E-CE7AEF56F243">控制ADR创建和禁用故障可诊断性</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="LNCPP20492"></a><div class="props_rev_3"><a id="GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA" name="GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA"></a><h4 id="LNCPP-GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA" class="sect4"><span class="enumeration_section">12.8.1</span>使用ADR基本位置</h4>
                  <div>
                     <div class="section">
                        <p>ADR基地的位置按以下顺序确定：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<code class="codeph">sqlnet.ora</code>文件中（在<span class="italic"><span class="bold">Windows上</span></span> ，在<code class="codeph">%TNS_ADMIN%</code>目录中，或在<span class="italic"><span class="bold">Linux</span></span>或<span class="italic"><span class="bold">UNIX上</span></span> ，在<code class="codeph">$TNS_ADMIN</code>目录中）。</span><div>
                              <p>如果没有<code class="codeph">TNS_ADMIN</code>目录，则<code class="codeph">sqlnet.ora</code>存储在当前目录中。
                              </p>
                              <p>如果在<code class="codeph">sqlnet.ora</code>文件中列出了ADR基础，则它是类型的语句：</p><pre class="oac_no_warn" dir="ltr">ADR_BASE = <span class="italic">/ directory / adr</span>
</pre><p>哪里：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="italic"><code class="codeph">adr</code></span>参数是一个目录，必须存在并且可由执行OCCI应用程序并希望共享相同ADR基础的所有操作系统用户写入。
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="italic"><code class="codeph">directory</code></span>参数是路径名</p>
                                 </li>
                              </ul>
                              <p>如果设置了<code class="codeph">ADR_BASE</code> ，并且所有用户共享一个<code class="codeph">sqlnet.ora</code>文件，则当目录<code class="codeph">adr</code>不存在或者它不可写时，OCCI将停止搜索。如果未设置<code class="codeph">ADR_BASE</code> ，则OCCI继续搜索，测试是否存在其他特定目录。
                              </p>
                              <p>例如，如果<code class="codeph">sqlnet.ora</code>包含条目<code class="codeph">ADR_BASE=/home/chuck/test</code>那么：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>ADR基础是：</p><pre class="oac_no_warn" dir="ltr">/家庭/夹具/测试/ oradiag_chuck</pre></li>
                                 <li>
                                    <p>ADR主页可能是：</p><pre class="oac_no_warn" dir="ltr">/家庭/夹具/测试/ oradiag_chuck /诊断/客户/ user_chuck / host_4144260688_11</pre></li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果存在Oracle基础（在<span class="italic"><span class="bold">Windows上</span></span> ： <span class="italic"><code class="codeph">%ORACLE_BASE%</code></span> ，或在<span class="italic"><span class="bold">Linux</span></span>和<span class="italic"><span class="bold">UNIX上</span></span> ： <span class="italic"><code class="codeph">$ORACLE_BASE</code></span> ），则客户端子目录也存在，因为它是在安装数据库时由Oracle Universal Installer创建的。</span><div>
                              <p>例如，如果<span class="italic"><code class="codeph">$ORACLE_BASE</code></span>是<code class="codeph">/home/chuck/obase</code> ，那么：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>ADR基础是：</p><pre class="oac_no_warn" dir="ltr">/家庭/夹头/一个obase</pre></li>
                                 <li>
                                    <p>ADR主页可能是：</p><pre class="oac_no_warn" dir="ltr">/家庭/夹头/ obase的/诊断/客户/ user_chuck / host_4144260688_11</pre></li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果Oracle主目录存在（在<span class="italic"><span class="bold">Windows上</span></span> ： <span class="italic"><code class="codeph">%ORACLE_HOME%</code></span> ，或在<span class="italic"><span class="bold">Linux</span></span>和<span class="italic"><span class="bold">UNIX上</span></span> ： <span class="italic"><code class="codeph">$ORACLE_HOME</code></span> ），则客户端子目录也存在，因为它是在安装数据库时由Oracle Universal Installer创建的。</span><div>
                              <p>例如，如果<span class="italic"><code class="codeph">$ORACLE_HOME</code></span>是<code class="codeph">/ade/chuck_l1/oracle</code> ，那么：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>ADR基础是：</p><pre class="oac_no_warn" dir="ltr">/ ADE / chuck_l1 / ORACLE /日志</pre></li>
                                 <li>
                                    <p>ADR主页可能是：</p><pre class="oac_no_warn" dir="ltr">/ ADE / chuck_l1 / ORACLE /日志/诊断/客户/ user_chuck / host_4144260688_11</pre></li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在操作系统主目录中。</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>在<span class="italic"><span class="bold">Windows上</span></span> ，操作系统主目录为<span class="italic"><code class="codeph">%USERPROFILE%</code></span> 。
                                    </p>
                                    <p><code class="codeph">Oracle</code>文件夹的位置是：</p><pre class="oac_no_warn" dir="ltr">C：\ Documents and Settings \ chuck</pre><p>如果应用程序作为服务运行，则会跳过主目录选项。</p>
                                 </li>
                                 <li>
                                    <p>在<span class="italic"><span class="bold">Linux</span></span>和<span class="italic"><span class="bold">UNIX上</span></span> ，操作系统主目录是<span class="italic"><code class="codeph">$HOME</code></span> 。</p>
                                    <p>位置可能是：</p><pre class="oac_no_warn" dir="ltr">/家庭/夹头/ oradiag_chuck</pre></li>
                              </ul>
                              <p>例如，在Instant Client中，如果<span class="italic"><code class="codeph">$HOME</code></span>是<code class="codeph">/home/chuck</code> ，则：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>ADR基础是：</p><pre class="oac_no_warn" dir="ltr">/家庭/夹头/ oradiag_chuck</pre></li>
                                 <li>
                                    <p>ADR主页可能是：</p><pre class="oac_no_warn" dir="ltr">/家庭/夹头/ oradiag_chuck /诊断/客户/ user_chuck / host_4144260688_11</pre></li>
                              </ul>
                              <div class="infoboxnotealso" id="GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA__GUID-7D725391-A376-4CF6-9BB0-C574EDC9FC22">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="installation-and-upgrading.html#GUID-5556BCFD-E14D-4562-A0CE-5AFAD47AC08F">关于Instant Client</a> ”</span></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在临时目录中。</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>在<span class="italic"><span class="bold">Windows上</span></span> ，按以下顺序搜索临时目录：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><code class="codeph">％TMP％</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">％TEMP％</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">％用户资料％</code></p>
                                       </li>
                                       <li>
                                          <p>Windows系统目录</p>
                                       </li>
                                    </ul>
                                 </li>
                                 <li>
                                    <p>在<span class="italic"><span class="bold">Linux</span></span>和<span class="italic"><span class="bold">UNIX上</span></span> ，临时目录位于<code class="codeph">/var/tmp</code> 。
                                    </p>
                                 </li>
                              </ul>
                              <p>例如，在Instant Client中，如果<span class="italic"><code class="codeph">$HOME</code></span>不可写，则：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>ADR基础是：</p><pre class="oac_no_warn" dir="ltr">/ var / tmp中/ oradiag_chuck</pre></li>
                                 <li>
                                    <p>ADR主页可能是：</p><pre class="oac_no_warn" dir="ltr">/ var / tmp中/ oradiag_chuck /诊断/客户/ user_chuck / host_4144260688_11</pre></li>
                              </ul>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>如果这些目录选项都不可用且不可写，则不会创建ADR并且不会存储诊断。</p>
                        <div class="infoboxnotealso" id="GUID-1D994784-B26E-4934-ADFE-83A997CCF3DA__GUID-068B4674-3807-49CB-AB44-D36C6F44DCE6">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../netrf/index.html" target="_blank"><span><cite>Oracle数据库网络服务参考</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNCPP20494"></a><a id="LNCPP20495"></a><a id="LNCPP20493"></a><div class="props_rev_3"><a id="GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A" name="GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A"></a><h4 id="LNCPP-GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A" class="sect4"><span class="enumeration_section">12.8.2</span>使用ADRCI</h4>
                  <div>
                     <div class="section">
                        <p>ADRCI是一个命令行工具，使您可以在ADR中查看诊断数据，并将事件和问题信息打包到可与Oracle支持共享的zip文件中。ADRCI可以交互方式使用，也可以通过脚本使用。</p>
                        <p><span class="bold">问题</span>是OCI或客户端的严重错误。每个问题都有一个问题关键。<span class="bold">事件</span>是一次出现问题，并由唯一的数字事件ID标识。每个事件都有一个问题键，它具有一组属性： <code class="codeph">ORA</code>错误号，错误参数值和类似信息。如果问题键匹配，则两个事件具有相同的根本原因。
                        </p>
                        <p>以下示例演示了如何在Linux操作系统上使用ADRCI。请注意，ARDCI命令不区分大小写。所有用户输入均为粗体字。</p>
                        <div class="infoboxnotealso" id="GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A__GUID-E3351A51-3514-47B0-9B28-2F4690F4B6E7">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../sutil/oracle-adr-command-interpreter-adrci.html#SUTIL700" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a> ，介绍ADRCI</p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="installation-and-upgrading.html#GUID-5556BCFD-E14D-4562-A0CE-5AFAD47AC08F">关于Instant Client</a> ”</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A__GUID-6A25581C-7456-40D0-A025-EF54C747C2EF">
                        <p class="titleinexample">例12-6如何将ADRCI用于OCCI应用程序事件</p>
                        <p>要在Linux系统中启动ADRCI，请使用<code class="codeph">adrci</code>命令。一旦ADRCI开始，找出的细节<code class="codeph">show base</code>与命令<code class="codeph">help</code> ，然后确定使用特定客户端的基础<code class="codeph">-product client</code>选项（必要OCCI应用程序）。要设置ADRCI基数，请使用set base命令。<code class="codeph">ADRCI</code>启动后，默认ADR基础用于<code class="codeph">rdbms</code>服务器。<span class="italic"><code class="codeph">$ORACLE_HOME</code></span>设置为<code class="codeph">/ade/chuck_l3/oracle</code> 。要查看事件，请使用<code class="codeph">show incidents</code>命令。要退出ADRCI，请使用<code class="codeph">quit</code>命令。
                        </p><pre class="oac_no_warn" dir="ltr">％ <span class="bold">adrci</span> ADRCI：版本11.2。 -  11月25日星期三16:16:55 2008版权所有（c）1982,2008，Oracle。版权所有。adrci&gt; <span class="bold">help show base</span>用法：SHOW BASE [-product &lt;product_name&gt;]目的：显示当前的ADR基本设置。选项：[ -  product &lt;product_name&gt;]：此选项允许用户显示给定产品的ADR Base位置。目前注册的产品是“客户”和“ADRCI”。示例：show base -product client show base adrci&gt; <span class="bold">show base -product client</span> ADR base is“/ ade / chuck_l3 / oracle / log”adrci&gt; <span class="bold">help set base</span>用法：SET BASE &lt;base_str&gt;目的：设置要使用的ADR基数目前的ADRCI会议。如果基地下有有效的ADR住宅，则所有住宅都将添加到当前的ADRCI会话中。参数：&lt;base_str&gt;：它是ADR基目录，它是一个依赖于系统的目录路径字符串。注意：在使用“。”的平台上。表示当前工作目录，它可以用作base_str。示例：set base / net / sttttd1 / scratch / someone / view_storage / someone_v1 / log set base。adrci&gt; <span class="bold">set base / ade / chuck_l3 / oracle / log</span> adrci&gt; <span class="bold">show</span> <span class="bold">events</span> ...adrci&gt; <span class="bold">退出</span></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-15F8B697-7B7B-4583-A6C8-D74760315E2A__GUID-794139B0-25F9-4654-99E3-9E54F0D86006">
                        <p class="titleinexample">示例12-7如何使用ADRCI for Instant Client</p>
                        <p>由于Instant Client不使用<span class="italic"><code class="codeph">$ORACLE_HOME</code></span> ，因此默认ADR基础是用户的主目录。
                        </p><pre class="oac_no_warn" dir="ltr">adrci&gt; <span class="bold">show base -product client</span> ADR base is“/ home / chuck / oradiag_chuck”adrci&gt; <span class="bold">set base / home / chuck / oradiag_chuck</span> adrci&gt; <span class="bold">show</span> <span class="bold">events</span> ADR Home = / home / chuck / oradiag_chuck / diag / clients / user_chuck / host_4144260688_11： ************************************************** *********************** INCIDENT_ID PROBLEM_KEY CREATE_TIME ------------------------ ------------------------------------------------- 1 oci 24550 [6] 2007-05-01 17：20：02.803697 -07：00 1行取出adrci&gt; <span class="bold">退出</span></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="LNCPP20496"></a><div class="props_rev_3"><a id="GUID-20C6A172-C450-44C0-BE4E-CE7AEF56F243" name="GUID-20C6A172-C450-44C0-BE4E-CE7AEF56F243"></a><h4 id="LNCPP-GUID-20C6A172-C450-44C0-BE4E-CE7AEF56F243" class="sect4"><span class="enumeration_section">12.8.3</span>控制ADR创建和禁用故障诊断</h4>
                  <div>
                     <div class="section">
                        <p>要禁用故障可诊断功能，必须关闭诊断捕获。通过将<code class="codeph">DIAG_ADR_ENABLED</code>和<code class="codeph">DIAG_DDE_ENABLED</code>参数的值更改为<code class="codeph">FALSE</code>或<code class="codeph">OFF</code>来编辑<code class="codeph">sqlnet.ora</code>文件;默认值为<code class="codeph">TRUE</code>或<code class="codeph">ON</code> 。</p>
                        <p>要关闭OCCI信号处理程序并重新启用标准操作系统故障处理，请通过添加相应参数来编辑<code class="codeph">sqlnet.ora</code>文件： <code class="codeph">DIAG_SIGHANDLER_ENABLED=FALSE</code> 。</p>
                        <div class="infoboxnotealso" id="GUID-20C6A172-C450-44C0-BE4E-CE7AEF56F243__GUID-62806A91-EF36-40C9-85F7-F74B42829BA5">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/lncpp&amp;id=LNOCI-GUID-E100960D-1E4F-4C3D-A6A3-0D5A5FB06B4C" target="_blank"><span><cite>Oracle调用接口程序员指南</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="LNCPP21897"></a><a id="LNCPP21896"></a><div class="props_rev_3"><a id="GUID-740894FB-9DAE-4F98-BA70-0C4E04479200" name="GUID-740894FB-9DAE-4F98-BA70-0C4E04479200"></a><h3 id="LNCPP-GUID-740894FB-9DAE-4F98-BA70-0C4E04479200" class="sect3"><span class="enumeration_section">12.9</span>使用客户端结果缓存</h3>
               <div>
                  <div class="section">
                     <p>客户端结果缓存可以改善重复执行的查询的响应时间。此功能使用客户端内存来缓存从数据库执行和提取的SQL查询的结果。后续执行同一查询将从客户端缓存中获取结果，从而降低服务器CPU使用率。由于消除了数据库往返，因此应用程序可以缩短响应时间。</p>
                     <p>OCCI应用程序可以通过启用OCCI语句缓存来透明地使用客户端结果缓存功能。请注意，必须缓存的<code class="codeph">SELECT</code>查询使用<code class="codeph">/*+ result_cache */</code> hint进行注释。<a href="optimizing-performance-of-cplusplus-applications.html#GUID-740894FB-9DAE-4F98-BA70-0C4E04479200__CIADDJCA">例12-8</a>显示了如何创建使用这种<code class="codeph">SELECT</code>查询的OCCI Statement对象。
                     </p>
                     <p>有关使用指南，缓存一致性和限制，请参阅<a href="../lnoci/performance-topics.html#LNOCI10103" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-740894FB-9DAE-4F98-BA70-0C4E04479200__CIADDJCA">
                     <p class="titleinexample">示例12-8如何启用和使用客户端结果缓存</p><pre class="oac_no_warn" dir="ltr">连接*连接;声明* stmt; ResultSet * rs; ...//启用OCCI语句缓存conn-&gt; setStmtCacheSize（20）; //在SELECT查询中指定提示stmt = conn-&gt; createStatement（“select / * + result_cache * / * from products \ where product_id =：1”）; //如果//缓存了查询结果，则以下execute从客户端缓存中获取行。如果这是查询的第一个执行//，则从服务器获取的结果将缓存在客户端。rs = stmt-&gt; executeQuery（）;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="LNCPP78967"></a><div class="props_rev_3"><a id="GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052" name="GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052"></a><h3 id="LNCPP-GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052" class="sect3"><span class="enumeration_section">12.10</span>关于客户端部署参数和自动调整</h3>
               <div>
                  <p>从Oracle Database Release 12 <span class="italic">c</span>第1版（12.1）开始，Oracle提供了<code class="codeph">oraaccess.xml</code> ，这是一个客户端配置文件，可用于配置所选属性，允许在部署期间更改应用程序行为，而无需修改源代码。
                  </p>
                  <div class="infoboxnote" id="GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052__GUID-40C288AE-8E23-4CC1-B185-6B79C6745052">
                     <p class="notep1">注意：</p>
                     <p>如果OCCI应用程序已在使用<code class="codeph">setPrefetchRowCount()</code>或<code class="codeph">setPrefetchMemorySize()</code>方法，请不要使用prefetch部署参数。
                     </p>
                  </div>
                  <div class="infoboxnote" id="GUID-E8DD631B-9AFF-49F5-BFBA-ED55001DB052__GUID-A0EC8D27-7D85-4E91-BB2E-C3BD9FAB5EBD">
                     <p class="notep1">看到：</p>
                     <p>有关客户端部署参数和自动调整的更多信息，请参阅<a href="../lnoci/index.html" target="_blank"><span><cite>“Oracle调用接口程序员指南”</cite></span></a></p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>