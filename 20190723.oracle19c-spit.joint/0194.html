<html id="01721.server-side-programming.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="SQL explains the Structured Query Language (SQL) language and how the database processes SQL statements. This chapter explains how Procedural Language/SQL (PL/SQL) or Java programs stored in the database can use SQL."></meta>
      <meta name="description" content="SQL explains the Structured Query Language (SQL) language and how the database processes SQL statements. This chapter explains how Procedural Language/SQL (PL/SQL) or Java programs stored in the database can use SQL."></meta>
      <title>服务器端编程：PL / SQL和Java</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Concepts"></meta>
      <meta property="og:description" content="SQL explains the Structured Query Language (SQL) language and how the database processes SQL statements. This chapter explains how Procedural Language/SQL (PL/SQL) or Java programs stored in the database can use SQL."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Concepts"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-concepts.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T07:47:16-08:00"></meta>
      <meta name="dcterms.title" content="Database Concepts"></meta>
      <meta name="dcterms.dateCopyrighted" content="1993, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96138-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="sql.html" title="Previous" type="text/html"></link>
      <link rel="next" href="oracle-transaction-management.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CNCPT"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="sql.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="oracle-transaction-management.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库概念</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-data-access.html" property="item" typeof="WebPage"><span property="name">Oracle数据访问</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">服务器端编程：PL / SQL和Java</li>
            </ol>
            <a id="GUID-D4A154D2-DF56-45DA-863C-BED5DA6BDA34" name="GUID-D4A154D2-DF56-45DA-863C-BED5DA6BDA34"></a><a id="CNCPT036"></a>
            
            <h2 id="CNCPT-GUID-D4A154D2-DF56-45DA-863C-BED5DA6BDA34" class="sect2"><span class="enumeration_chapter">8</span>服务器端编程：PL / SQL和Java</h2>
         </header>
         <div class="ind">
            <div>
               <p><span class="bold">SQL</span>解释了结构化查询语言（SQL）语言以及数据库如何处理SQL语句。本章介绍了数据库中存储的过程语言/ SQL（PL / SQL）或Java程序如何使用SQL。</p>
               <p>本章包括以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="server-side-programming.html#GUID-6B5D98B7-A25D-4187-B3A9-43629E214635" title="在诸如SQL的非过程语言中，指定要操作的数据集，但不指定要执行的操作或它们的执行方式。">服务器端编程简介</a></p>
                  </li>
                  <li>
                     <p><a href="server-side-programming.html#GUID-1E17CED5-73C6-4C10-85F1-A2CB4D5F9855" title="PL / SQL提供了一种服务器端存储过程语言，易于使用，与SQL无缝连接，健壮，可移植且安全。您可以使用称为PL / SQL单元的过程对象来访问和操作数据库数据。">PL / SQL概述</a></p>
                  </li>
                  <li>
                     <p><a href="server-side-programming.html#GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7" title="Java已经成为面向对象编程语言的首选。">Oracle数据库中的Java概述</a></p>
                  </li>
                  <li>
                     <p><a href="server-side-programming.html#GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63" title="数据库触发器是一个编译的存储程序单元，用PL / SQL或Java编写，Oracle数据库调用（" fire=")=" ="">触发器概述</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-D4A154D2-DF56-45DA-863C-BED5DA6BDA34__GUID-E8018424-A5DC-43F5-9CFF-E7C8FD41C575">
                  <p class="notep1">也可以看看：</p>
                  <p><span class="q">“ <a href="sql.html#GUID-DA48618A-A6BB-421A-A10A-02859D8ED9AD" title="本章概述了结构化查询语言（SQL）以及Oracle数据库如何处理SQL语句。">SQL</a> ”</span>用于概述SQL语言</p>
               </div>
            </div><a id="CNCPT1758"></a><div class="props_rev_3"><a id="GUID-6B5D98B7-A25D-4187-B3A9-43629E214635" name="GUID-6B5D98B7-A25D-4187-B3A9-43629E214635"></a><h3 id="CNCPT-GUID-6B5D98B7-A25D-4187-B3A9-43629E214635" class="sect3">服务器端编程简介</h3>
               <div>
                  <p>在诸如SQL的非过程语言中，指定要操作的数据集，但不指定要执行的操作或它们的执行方式。</p>
                  <p>在过程语言程序中，大多数语句执行依赖于先前或后续语句以及SQL中不可用的控制结构（例如循环或条件分支）。为了说明过程语言和非过程语言之间的区别，假设以下SQL语句查询<code class="codeph">employees</code>表：</p><pre class="pre codeblock"><code>SELECT employee_id，department_id，last_name，salary FROM employees;</code></pre><p>前面的语句请求数据，但不对数据应用逻辑。但是，假设您希望应用程序确定数据集中的每个员工是否应根据薪资和部门绩效进行加薪。加薪的一个必要条件是员工在过去五年内没有获得超过三次加薪。如果要求加薪，则申请必须调整工资并通过电子邮件发送给经理;否则，应用程序必须更新报告。</p>
                  <p>问题是需要条件逻辑和程序流控制的过程数据库应用程序如何使用SQL。基本的开发方法如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>使用客户端编程将SQL语句嵌入用过程语言（如C，C ++或Java）编写的应用程序中</p>
                        <p>您可以将SQL语句放在源代码中，然后在编译之前将其提交给<a href="glossary.html#GUID-FDCF892E-6AD5-4AC9-9D1D-A9C7D106D21D"><span class="xrefglossterm">预编译器</span></a>或Java转换器。或者，您可以取消预编译步骤并使用API（如Java数据库连接（JDBC）或Oracle调用接口（OCI））来使应用程序与数据库交互。
                        </p>
                     </li>
                     <li>
                        <p>使用服务器端编程来开发驻留在数据库中的数据逻辑</p>
                        <p>应用程序可以显式调用用PL / SQL（发音为<span class="italic">PL sequel</span> ）或Java编写的存储子程序（过程和函数）。您还可以创建一个名为program unit的<a href="glossary.html#GUID-8BA32C58-ACF3-4B6B-941F-586DE399D22A"><span class="xrefglossterm">触发器</span></a> ，该<a href="glossary.html#GUID-8BA32C58-ACF3-4B6B-941F-586DE399D22A"><span class="xrefglossterm">触发器</span></a>存储在数据库中并响应指定的事件而调用。
                        </p>
                     </li>
                  </ul>
                  <p>本章介绍第二种方法。服务器端编程的主要好处是可以在任何地方部署内置于数据库中的功能。数据库而不是应用程序确定在给定操作系统上执行任务的最佳方式。此外，子程序通过在服务器上集中应用程序处理来增加可伸缩性，使客户端能够重用代码。由于子程序调用快速有效，因此单个调用可以启动计算密集型存储子程序，从而减少网络流量。</p>
                  <p>您可以使用以下语言在Oracle数据库中存储数据逻辑：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>PL / SQL</p>
                        <p>PL / SQL是SQL的Oracle数据库过程扩展。 PL / SQL与数据库集成，支持所有Oracle SQL语句，函数和数据类型。用数据库API编写的应用程序可以调用PL / SQL存储的子程序，并将PL / SQL代码块发送到数据库以供执行。</p>
                     </li>
                     <li>
                        <p>Java的</p>
                        <p>Oracle数据库还为开发，存储和部署Java应用程序提供支持。Java存储的子程序在数据库中运行，并且独立于在中间层中运行的程序。Java存储的子程序使用与PL / SQL类似的执行模型与SQL接口。</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-6B5D98B7-A25D-4187-B3A9-43629E214635__GUID-7663186E-29A6-4904-B7B0-7435318534A7">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-87F23274-B506-486B-8775-880016095EF5" title="您可以使用预编译器或Java转换器将SQL语句放在源代码中，也可以使用API使应用程序与数据库交互。">客户端数据库编程</a> ”</span> ，了解如何使用预编译器和API嵌入SQL</p>
                        </li>
                        <li>
                           <p><a href="../tdddg/two-day-developer-intro.html#TDDDG10000" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a> ，介绍Oracle数据库应用程序开发</p>
                        </li>
                        <li>
                           <p><a href="../adfns/application-architecture.html#ADFNS00109" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a> ，了解如何选择编程环境</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="CNCPT416"></a><div class="props_rev_3"><a id="GUID-1E17CED5-73C6-4C10-85F1-A2CB4D5F9855" name="GUID-1E17CED5-73C6-4C10-85F1-A2CB4D5F9855"></a><h3 id="CNCPT-GUID-1E17CED5-73C6-4C10-85F1-A2CB4D5F9855" class="sect3">PL / SQL概述</h3>
               <div>
                  <p>PL / SQL提供了一种服务器端存储过程语言，易于使用，与SQL无缝连接，健壮，可移植且安全。您可以使用称为<span class="italic">PL / SQL单元的</span>过程对象来访问和操作数据库数据。
                  </p>
                  <p>PL / SQL单元通常分类如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="glossary.html#GUID-4BF65C07-E5DD-454C-8AD0-E38EF5672CE4"><span class="xrefglossterm">PL / SQL子程序</span></a>是存储在数据库中的PL / SQL块，可以通过应用程序中的名称进行调用。创建子程序时，数据库会解析子程序并将其解析后的表示存储在数据库中。您可以将子程序声明为过程或函数。
                        </p>
                     </li>
                     <li>
                        <p><a href="glossary.html#GUID-97C2CD46-CE4D-4A23-B44D-815A1E8F0906"><span class="xrefglossterm">PL / SQL匿名块</span></a>是PL / SQL块，它出现在应用程序中，未在数据库中命名或存储。在许多应用程序中，PL / SQL块可以出现在SQL语句出现的任何位置。
                        </p>
                     </li>
                  </ul>
                  <p>PL / SQL编译器和解释器嵌入在Oracle SQL Developer中，为开发人员提供了在客户端和服务器上的一致且有利的开发模型。此外，可以从多个数据库客户端调用PL / SQL存储过程，例如Pro * C，JDBC，ODBC或OCI，以及Oracle Reports和Oracle Forms。</p>
                  <div class="infoboxnotealso" id="GUID-1E17CED5-73C6-4C10-85F1-A2CB4D5F9855__GUID-9582AD50-F0BC-40DA-9E70-09D4B64431F4">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-D1C1BC1D-03C7-4A18-BB88-0D76F311DAF0" title="Oracle提供了几种用于开发数据库应用程序的工具。本节介绍一些常用的开发工具。">数据库开发人员工具</a> ”</span></p>
                        </li>
                        <li>
                           <p>有关PL / SQL的完整信息，包括包，请参阅<a href="../lnpls/overview.html#LNPLS001" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="CNCPT1776"></a><div class="props_rev_3"><a id="GUID-7C398775-F4FB-47A2-AED5-458E00FB1E35" name="GUID-7C398775-F4FB-47A2-AED5-458E00FB1E35"></a><h4 id="CNCPT-GUID-7C398775-F4FB-47A2-AED5-458E00FB1E35" class="sect4">PL / SQL子程序</h4>
                  <div>
                     <p>PL / SQL子程序是一个命名的PL / SQL块，允许调用者提供只能输入，仅输出或输入和输出值的参数。</p>
                     <p>子程序解决特定问题或执行相关任务，并作为模块化，可维护数据库应用程序的构建块。子程序是<a href="glossary.html#GUID-D2210901-18F2-43C0-B0CC-6953E94CD7EF"><span class="xrefglossterm">PL / SQL过程</span></a>或<a href="glossary.html#GUID-1DBC272B-41F6-43A9-A894-D7E714017E2B"><span class="xrefglossterm">PL / SQL函数</span></a> 。过程和函数是相同的，除了函数总是向调用者返回单个值，而过程不返回。本章中的术语<span class="italic">PL / SQL过程</span>涉及过程或函数。
                     </p>
                     <div class="infoboxnotealso" id="GUID-7C398775-F4FB-47A2-AED5-458E00FB1E35__GUID-9FD5B2CC-EB41-4A46-9D75-A9E0DF550A82">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../lnpcb/introduction.html#GUID-2F2833F4-62F3-4FC7-8FC1-B742E44727B0" target="_blank"><span><cite>Pro * C / C ++程序员指南</cite></span></a>和<a href="../lnpcb/embedded-PLSQL.html#LNPCB006" target="_blank"><span><cite>Pro * COBOL程序员指南</cite></span></a> ，了解这些语言的存储过程</p>
                           </li>
                           <li>
                              <p><a href="../lnpls/overview.html#LNPLS174" target="_blank"><span><cite>Oracle数据库PL / SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="CNCPT1777"></a><div class="props_rev_3"><a id="GUID-BC90E680-65D8-4CD4-BCE2-A6A2FE732D59" name="GUID-BC90E680-65D8-4CD4-BCE2-A6A2FE732D59"></a><h5 id="CNCPT-GUID-BC90E680-65D8-4CD4-BCE2-A6A2FE732D59" class="sect5">PL / SQL子程序的优点</h5>
                     <div>
                        <p>与客户端编程相比，服务器端编程具有许多优势。</p>
                        <p>优点包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>改善了性能</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>与发布单个SQL语句或将整个PL / SQL块的文本发送到Oracle数据库相比，应用程序必须通过网络发送的信息量很小，因为信息只发送一次，然后在使用时调用。</p>
                                 </li>
                                 <li>
                                    <p>程序的编译形式在数据库中很容易获得，因此在执行时不需要编译。</p>
                                 </li>
                                 <li>
                                    <p>如果该过程存在于<a href="glossary.html#GUID-3F87437B-614A-472E-B691-F09D4A310DE4"><span class="xrefglossterm">SGA</span></a>的<a href="glossary.html#GUID-64AFFF3A-C836-44F9-A25C-86CE4B9B16A8"><span class="xrefglossterm">共享池中</span></a> ，则数据库无需从磁盘检索它并可立即开始执行。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>内存分配</p>
                              <p>由于存储过程利用了Oracle数据库的共享内存功能，因此它必须只将一个过程副本加载到内存中，以供多个用户执行。在用户之间共享代码导致应用程序的数据库内存需求大幅减少。</p>
                           </li>
                           <li>
                              <p>提高生产力</p>
                              <p>存储过程可提高开发效率。通过围绕一组通用过程设计应用程序，可以避免冗余编码。例如，您可以编写过程来操作<code class="codeph">employees</code>表中的行。任何应用程序都可以调用这些过程，而无需重写SQL语句。如果数据管理方法发生变化，则只需修改过程，而不是使用过程的应用程序。
                              </p>
                              <p>存储过程可能是实现代码重用的最佳方法。因为用连接到数据库的任何语言编写的任何客户端应用程序都可以调用存储过程，所以它们在所有环境中提供最大的代码重用。</p>
                           </li>
                           <li>
                              <p>廉正</p>
                              <p>存储过程可提高应用程序的完整性和一致性。通过围绕一组通用程序开发应用程序，可以降低编码错误的可能性。</p>
                              <p>例如，您可以测试子程序以确保它返回准确的结果，并在验证后，在任何数量的应用程序中重复使用它而无需重新测试。如果更改了过程引用的数据结构，则只能重新编译该过程。调用该过程的应用程序不一定需要修改。</p>
                           </li>
                           <li>
                              <p>具有定义者权利程序的安全性</p>
                              <p>存储过程可以帮助实施数据安全性。<a href="glossary.html#GUID-743039B9-002B-48D5-AE43-001BCDBEAA3E"><span class="xrefglossterm">定义者权限PL / SQL过程</span></a>以其所有者的<a href="glossary.html#GUID-197053D8-1AA8-4B0F-BEE1-8C8AD2DBD0C6"><span class="xrefglossterm">权限</span></a>执行，而不是其当前用户。因此，您可以通过允许用户仅通过使用定义者权限运行的过程和函数来访问数据来限制用户执行的数据库任务。
                              </p>
                              <p>例如，您可以授予用户访问更新表但不授予对表本身的访问权限的过程的权限。当用户调用该过程时，它将以其所有者的权限运行。仅具有运行该过程的权限（但不具有从基础表进行查询，更新或删除的权限）的用户可以调用该过程，但不能以任何其他方式操作表数据。</p>
                           </li>
                           <li>
                              <p>具有调用者权限过程的继承权限和模式上下文</p>
                              <p><a href="glossary.html#GUID-25256D39-4B45-410E-8CEA-2463E6934152"><span class="xrefglossterm">调用者权限PL / SQL过程</span></a>在当前用户的模式中使用当前用户的权限执行。换句话说，调用者的权限过程不依赖于特定的用户或模式。即使底层数据在用户模式之间划分，Invoker的权限过程也使应用程序开发人员可以轻松集中应用程序逻辑。
                              </p>
                              <p>例如，在<code class="codeph">hr.employees</code>表上运行更新过程的<code class="codeph">hr_manager</code>用户可以更新工资，而运行相同过程的<code class="codeph">hr_clerk</code>仅限于更新地址数据。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-BC90E680-65D8-4CD4-BCE2-A6A2FE732D59__GUID-4D946D74-A5A8-4FB2-86E1-A824B1EAB4B5">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="topics-for-database-administrators-and-developers.html#GUID-4D6D2B67-1B65-476D-852A-976E9D153EEC" title="通常，数据库安全性涉及用户身份验证，加密，访问控制和监视。">数据库安全概述</a> ”</span></p>
                              </li>
                              <li>
                                 <p>有关PL / SQL子程序概述的<a href="../lnpls/plsql-subprograms.html#LNPLS008" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p><a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG50010" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a> ，了解有关定义者和调用者权利的更多信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT88932"></a><a id="CNCPT88931"></a><div class="props_rev_3"><a id="GUID-07E0EC3E-2629-4673-9762-202B8074CB52" name="GUID-07E0EC3E-2629-4673-9762-202B8074CB52"></a><h5 id="CNCPT-GUID-07E0EC3E-2629-4673-9762-202B8074CB52" class="sect5">创建PL / SQL子程序</h5>
                     <div>
                        <p>独立存储的子程序是在模式级别使用<code class="codeph">CREATE PROCEDURE</code>或<code class="codeph">CREATE FUNCTION</code>语句创建的子程序。程序包中定义的<span class="bold">子程序</span>称为<span class="bold">程序包子程序，</span>并被视为程序包的一部分。
                        </p>
                        <p>数据库将子程序存储在数据字典中作为模式对象。子程序具有规范，其包括任何参数的描述和主体。</p>
                        <div class="example" id="GUID-07E0EC3E-2629-4673-9762-202B8074CB52__BABIAJHG">
                           <p class="titleinexample">例8-1 PL / SQL过程</p>此示例显示了独立PL / SQL过程<code class="codeph">hire_employees</code>的创建语句的一部分。该过程在<code class="codeph">employees</code>表中插入一行。<pre class="pre codeblock"><code>CREATE PROCEDURE hire_employees（p_last_name VARCHAR2，p_job_id VARCHAR2，p_manager_id NUMBER，p_hire_date DATE，p_salary NUMBER，p_commission_pct NUMBER，p_department_id NUMBER）已开始。。。INSERT INTO员工（employee_id，last_name，job_id，manager_id，hire_date，salary，commission_pct，department_id）VALUES（emp_sequence。NEXTVAL，p_last_name，p_job_id，p_manager_id，p_hire_date，p_salary，p_commission_pct，p_department_id）; 。。。结束;</code></pre><div class="infoboxnotealso" id="GUID-07E0EC3E-2629-4673-9762-202B8074CB52__GUID-631AA004-1EFF-4F80-9559-6B808C3C5337">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="../tdddg/stored-subprograms-packages.html#TDDDG41000" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a> ，了解如何创建子程序</p>
                                 </li>
                                 <li>
                                    <p><a href="../lnpls/CREATE-PROCEDURE-statement.html#LNPLS01373" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解<code class="codeph">CREATE PROCEDURE</code>语句</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="CNCPT88934"></a><a id="CNCPT88933"></a><div class="props_rev_3"><a id="GUID-E94C8618-0464-45DA-AA90-07BA9EB4458C" name="GUID-E94C8618-0464-45DA-AA90-07BA9EB4458C"></a><h5 id="CNCPT-GUID-E94C8618-0464-45DA-AA90-07BA9EB4458C" class="sect5">执行PL / SQL子程序</h5>
                     <div>
                        <p>用户可以以多种方式以交互方式执行子程序。</p>
                        <p>选项是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用Oracle工具，例如SQL * Plus或SQL Developer</p>
                           </li>
                           <li>
                              <p>在数据库应用程序的代码中显式调用它，例如Oracle Forms或预编译器应用程序</p>
                           </li>
                           <li>
                              <p>在另一个过程或触发器的代码中显式调用它</p>
                           </li>
                        </ul>
                        <p>下图显示了调用<code class="codeph">hire_employees</code>不同数据库应用程序。
                        </p>
                        <div class="figure" id="GUID-E94C8618-0464-45DA-AA90-07BA9EB4458C__FIG-124-16F280AE">
                           <p class="titleinfigure">图8-1存储过程的多次执行</p><img src="img/cncpt073.gif" alt="下面是图8-1的描述" title="下面是图8-1的描述" longdesc="img_text/cncpt073.html"><br><a href="img_text/cncpt073.html">“图8-1存储过程的多次执行”的描述</a></div>
                        <!-- class="figure" -->
                        <p>或者，特权用户可以使用Oracle Enterprise Manager或SQL * Plus运行<code class="codeph">hire_employees</code>过程，使用如下语句：</p><pre class="pre codeblock"><code>执行hire_employees（'TSMITH'，'CLERK'，1037，SYSDATE，500，NULL，20）;</code></pre><p>上述语句在<code class="codeph">employees</code>表中插入<code class="codeph">TSMITH</code>的新记录。
                        </p>
                        <p>存储过程取决于其正文中引用的对象。数据库自动跟踪和管理这些依赖项。例如，如果以一种会影响此过程的方式更改<code class="codeph">hire_employees</code>过程引用的<code class="codeph">employees</code>表的定义，则必须重新编译该过程以验证它是否仍按设计工作。通常，数据库会自动管理此类依赖关系管理。
                        </p>
                        <div class="infoboxnotealso" id="GUID-E94C8618-0464-45DA-AA90-07BA9EB4458C__GUID-FFA83CB7-EAD2-4F20-8084-56F8E7F995B1">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-D1C1BC1D-03C7-4A18-BB88-0D76F311DAF0" title="Oracle提供了几种用于开发数据库应用程序的工具。本节介绍一些常用的开发工具。">用于数据库开发人员的工具</a> ”</span>以了解有关SQL * Plus和SQL Developer的更多信息</p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-87F23274-B506-486B-8775-880016095EF5" title="您可以使用预编译器或Java转换器将SQL语句放在源代码中，也可以使用API使应用程序与数据库交互。">客户端数据库编程</a> ”</span>以了解有关预编译器的更多信息</p>
                              </li>
                              <li>
                                 <p><a href="../lnpls/plsql-subprograms.html#LNPLS008" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解如何使用PL / SQL子程序</p>
                              </li>
                              <li>
                                 <p><a href="../sqpug/EXECUTE.html#SQPUG043" target="_blank"><span><cite>SQL * Plus用户指南和参考</cite></span></a>了解<code class="codeph">EXECUTE</code>命令</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1784"></a><div class="props_rev_3"><a id="GUID-87FA8137-A449-4542-8869-441C63810C63" name="GUID-87FA8137-A449-4542-8869-441C63810C63"></a><h4 id="CNCPT-GUID-87FA8137-A449-4542-8869-441C63810C63" class="sect4">PL / SQL包</h4>
                  <div>
                     <p><span class="bold">PL / SQL包</span>是一组相关的子程序，以及它们使用的游标和变量，它们一起存储在数据库中以便作为一个单元继续使用。应用程序或用户可以显式调用打包的子程序。
                     </p>
                     <p>Oracle数据库包括许多提供的包，这些包扩展了数据库功能并提供对SQL功能的PL / SQL访问。例如， <code class="codeph">UTL_HTTP</code>包允许来自PL / SQL和SQL的HTTP标注访问Internet上的数据或调用Oracle Web Server Cartridges。您可以在创建应用程序时使用提供的包，也可以在创建自己的存储过程时使用提供的包。
                     </p>
                  </div><a id="CNCPT1785"></a><div class="props_rev_3"><a id="GUID-C7F00F30-5D7F-47F2-856F-CEE8E6465820" name="GUID-C7F00F30-5D7F-47F2-856F-CEE8E6465820"></a><h5 id="CNCPT-GUID-C7F00F30-5D7F-47F2-856F-CEE8E6465820" class="sect5">PL / SQL包的优点</h5>
                     <div>
                        <p>PL / SQL包为应用程序开发人员提供了许多优势。</p>
                        <p>优点包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>封装</p>
                              <p>通过包，您可以在命名的存储单元中封装或分组存储过程，变量，数据类型等。封装在开发过程中提供了更好的组织，并且更具灵活性。您可以创建规范和引用公共过程，而无需实际创建包体。封装简化了权限管理。授予包的权限使得包构造可供被授权者访问。</p>
                           </li>
                           <li>
                              <p>数据安全</p>
                              <p>包定义方法使您可以指定哪些变量，游标和过程是公共的和私有的。公共意味着包可以直接访问它。私有意味着它对包的用户是隐藏的。</p>
                              <p>例如，一个包可以包含10个过程。您可以定义包，以便只有三个过程是公共的，因此可供包的用户执行。其余过程是私有的，只能通过包中的过程访问。不要将公共和私有包变量与<code class="codeph">PUBLIC</code>授权混淆。</p>
                           </li>
                           <li>
                              <p>更好的性能</p>
                              <p>当第一次调用包中的过程时，整个包以小块的形式加载到内存中。此负载在一次操作中完成，而不是独立过程所需的单独负载。当调用相关的打包过程时，不需要磁盘I / O来在内存中运行已编译的代码。</p>
                              <p>可以更换和重新编译封装体，而不会影响规格。因此，除非还替换了包规范，否则无需重新编译引用包的构造（始终通过规范）的模式对象。通过使用包，可以最小化不必要的重新编译，从而减少对整体数据库性能的影响。</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="CNCPT88936"></a><a id="CNCPT88935"></a><div class="props_rev_3"><a id="GUID-1CB910EF-09B4-43FD-AEC5-7450296AC58C" name="GUID-1CB910EF-09B4-43FD-AEC5-7450296AC58C"></a><h5 id="CNCPT-GUID-1CB910EF-09B4-43FD-AEC5-7450296AC58C" class="sect5">创建PL / SQL包</h5>
                     <div>
                        <p>您可以分为两部分创建包：规范和正文。包规范声明了包的所有公共构造，而包体定义了包的所有构造（公共和私有）。</p>
                        <p>以下示例显示了为<code class="codeph">employees_management</code>创建包规范的语句的一部分，该声明封装了用于管理员工数据库的多个子程序。包的每个部分都使用不同的语句创建。
                        </p><pre class="pre codeblock"><code>CREATE PACKAGE employees_management AS FUNCTION hire_employees（last_name VARCHAR2，job_id VARCHAR2，manager_id NUMBER，salary NUMBER，commission_pct NUMBER，department_id NUMBER）返回号码;程序fire_employees（employee_id NUMBER）; PROCEDURE salary_raise（employee_id NUMBER，salary_incr NUMBER）; 。。。no_sal EXCEPTION; END employees_management;</code></pre><p>规范声明函数<code class="codeph">hire_employees</code> ，过程<code class="codeph">fire_employees</code>和<code class="codeph">salary_raise</code> ，以及异常<code class="codeph">no_sal</code> 。所有这些公共程序对象都可供有权访问该程序包的用户使用。
                        </p>
                        <p><code class="codeph">CREATE PACKAGE BODY</code>语句定义规范中声明的对象。必须在与包相同的模式中创建包体。创建程序包后，您可以开发调用任何这些公共过程或函数的应用程序，或者引发程序包的任何公共异常。
                        </p>
                        <div class="infoboxnotealso" id="GUID-1CB910EF-09B4-43FD-AEC5-7450296AC58C__GUID-0E9E3A46-FE7F-4067-B814-DCEBD37F6E15">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../lnpls/CREATE-PACKAGE-statement.html#LNPLS01371" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解<code class="codeph">CREATE PACKAGE</code>语句</p>
                        </div>
                     </div>
                  </div><a id="CNCPT88938"></a><a id="CNCPT88937"></a><div class="props_rev_3"><a id="GUID-82299071-97A1-47B6-A0AB-202F65F3F865" name="GUID-82299071-97A1-47B6-A0AB-202F65F3F865"></a><h5 id="CNCPT-GUID-82299071-97A1-47B6-A0AB-202F65F3F865" class="sect5">执行PL / SQL包子程序</h5>
                     <div>
                        <p>数据库触发器，存储的子程序，3GL应用程序和Oracle工具可以引用包内容。</p>
                        <p>下图显示了调用<code class="codeph">employees_management</code>包中的过程和函数的数据库应用程序。
                        </p>
                        <div class="figure" id="GUID-82299071-97A1-47B6-A0AB-202F65F3F865__I18841">
                           <p class="titleinfigure">图8-2在PL / SQL包中调用子程序</p><img src="img/cncpt075.gif" width="595" alt="下面是图8-2的描述" title="下面是图8-2的描述" longdesc="img_text/cncpt075.html"><br><a href="img_text/cncpt075.html">“图8-2调用PL / SQL包中的子程序”的描述</a></div>
                        <!-- class="figure" -->
                        <p>数据库应用程序显式调用打包过程。在被授予<code class="codeph">employees_management</code>包的权限后，用户可以显式运行其中包含的任何过程。例如，SQL * Plus可以发出以下语句来运行<code class="codeph">hire_employees</code>包过程：</p><pre class="pre codeblock"><code>执行employees_management.hire_employees（'TSMITH'，'CLERK'，1037，SYSDATE，500，NULL，20）;</code></pre><div class="infoboxnotealso" id="GUID-82299071-97A1-47B6-A0AB-202F65F3F865__GUID-4EB5C854-FCD7-4E1E-8937-02E52D926F6C">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../lnpls/plsql-packages.html#LNPLS009" target="_blank"><span><cite>Oracle Database PL / SQL语言参考，</cite></span></a>用于介绍PL / SQL包</p>
                              </li>
                              <li>
                                 <p><a href="../adfns/coding-subprograms-and-packages.html#ADFNS009" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a> ，了解如何编写PL / SQL包</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT88939"></a><a id="CNCPT1779"></a><div class="props_rev_3"><a id="GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA" name="GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA"></a><h4 id="CNCPT-GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA" class="sect4">PL / SQL匿名块</h4>
                  <div>
                     <p>PL / SQL匿名块是未命名的非持久PL / SQL单元。</p>
                     <p>匿名块的典型用途包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>启动对子程序和包构造的调用</p>
                        </li>
                        <li>
                           <p>隔离异常处理</p>
                        </li>
                        <li>
                           <p>通过在其他PL / SQL块中嵌套代码来管理控制</p>
                        </li>
                     </ul>
                     <p>匿名块没有存储子程序的代码重用优势。<a href="server-side-programming.html#GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA__CHDJGEBD" title="此表总结了匿名块和子程序之间的差异。">表8-1</a>总结了两种类型的PL / SQL单元之间的差异。
                     </p>
                     <div class="tblformal" id="GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA__CHDJGEBD">
                        <p class="titleintable">表8-1匿名块和子程序之间的差异</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="匿名块和子程序之间的差异" width="100%" border="1" summary="This table summarizes the differences between anonymous blocks and subprograms." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="40%" id="d40402e3948">是PL / SQL单元......</th>
                                 <th align="left" valign="bottom" width="30%" id="d40402e3951">匿名块</th>
                                 <th align="left" valign="bottom" width="30%" id="d40402e3954">子程序</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e3959" headers="d40402e3948 ">
                                    <p>用名字指定？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3959 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3959 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e3969" headers="d40402e3948 ">
                                    <p>编译每次重用？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3969 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3969 d40402e3954 ">
                                    <p>没有</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e3979" headers="d40402e3948 ">
                                    <p>存储在数据库中？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3979 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3979 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e3989" headers="d40402e3948 ">
                                    <p>其他应用程序是否可以调用？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3989 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3989 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e3999" headers="d40402e3948 ">
                                    <p>能够返回绑定变量值吗？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3999 d40402e3951 ">
                                    <p>是</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3999 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e4009" headers="d40402e3948 ">
                                    <p>能够返回功能值吗？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e4009 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e4009 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e4019" headers="d40402e3948 ">
                                    <p>能够接受参数吗？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e4019 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e4019 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>匿名块由可选的声明部分，可执行部分和一个或多个可选的异常处理程序组成。以下示例匿名块将员工姓氏选择到变量中并输出名称：</p><pre class="pre codeblock"><code>DECLARE v_lname VARCHAR2（25）; BEGIN SELECT last_name INTO v_lname FROM employees WHERE employee_id = 101; DBMS_OUTPUT.PUT_LINE（'员工姓氏为'|| v_lname）;结束;</code></pre><p>Oracle数据库编译PL / SQL块并将其放在SGA的共享池中，但它不会将源代码或编译版本存储在数据库中，以便在当前实例之外重用。与触发器不同，每次将匿名块加载到内存时都会编译它。共享SQL允许重用和共享共享池中的匿名PL / SQL块，直到它们从共享池中刷新。</p>
                     <div class="infoboxnotealso" id="GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA__GUID-4D91FDC9-6046-4771-AC6B-BC9324CDA94B">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../adfns/coding-subprograms-and-packages.html#ADFNS311" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a> ，了解有关匿名PL / SQL块的更多信息</p>
                     </div>
                  </div>
               </div><a id="CNCPT1770"></a><div class="props_rev_3"><a id="GUID-0C8B57A4-9717-4E9A-8401-D817E2F0A308" name="GUID-0C8B57A4-9717-4E9A-8401-D817E2F0A308"></a><h4 id="CNCPT-GUID-0C8B57A4-9717-4E9A-8401-D817E2F0A308" class="sect4">PL / SQL语言构造</h4>
                  <div>
                     <p>PL / SQL块可以包括各种不同的PL / SQL语言结构。</p>
                     <p>这些结构包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>变量和常量</p>
                           <p>您可以在过程，函数或包中声明这些构造。您可以在SQL或PL / SQL语句中使用变量或常量来捕获或在需要时提供值。</p>
                        </li>
                        <li>
                           <p>游标</p>
                           <p>您可以在过程，函数或包中显式声明<a href="glossary.html#GUID-D1D3E8DD-CD5C-4C0D-93E4-DE0BF0BD53A3"><span class="xrefglossterm">游标</span></a> ，以促进面向记录的Oracle数据库数据处理。PL / SQL引擎也可以隐式声明游标。
                           </p>
                        </li>
                        <li>
                           <p>例外</p>
                           <p>PL / SQL允许您显式处理在处理PL / SQL代码期间出现的内部和用户定义的错误条件，称为<span class="italic">异常</span> 。
                           </p>
                        </li>
                     </ul>
                     <p>PL / SQL可以运行<a href="glossary.html#GUID-4962BC92-A7FC-471D-BE50-4650A791E3E7"><span class="xrefglossterm">动态SQL</span></a>语句，直到运行时才能知道其完整文本。动态SQL语句存储在运行时由程序输入或构建的字符串中。此技术使您可以创建通用过程。例如，您可以创建一个对运行时名称未知的表进行操作的过程。
                     </p>
                     <div class="infoboxnotealso" id="GUID-0C8B57A4-9717-4E9A-8401-D817E2F0A308__GUID-0E7BF886-54C0-4F4C-A75A-F1AE955DDDA0">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关动态SQL的详细信息，请<a href="../lnpls/dynamic-sql.html#LNPLS011" target="_blank"><span><cite>参见Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_SQL.html#ARPLS058" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a> ，了解如何在<code class="codeph">DBMS_SQL</code>包中使用动态SQL</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT1786"></a><div class="props_rev_3"><a id="GUID-BE22C508-16F7-4D82-B7DE-DA10D9210F78" name="GUID-BE22C508-16F7-4D82-B7DE-DA10D9210F78"></a><h4 id="CNCPT-GUID-BE22C508-16F7-4D82-B7DE-DA10D9210F78" class="sect4">PL / SQL集合和记录</h4>
                  <div>
                     <p>许多编程技术使用集合类型，例如数组，包，列表，嵌套表，集合和树。</p>
                     <p>为了支持数据库应用程序中的收集技术，PL / SQL提供了数据类型<code class="codeph">TABLE</code>和<code class="codeph">VARRAY</code> 。这些类型使您能够声明关联数组，嵌套表和可变大小数组。
                     </p>
                  </div><a id="CNCPT1787"></a><div class="props_rev_3"><a id="GUID-9E35FAD6-6C27-479B-AC42-0A1B83E66882" name="GUID-9E35FAD6-6C27-479B-AC42-0A1B83E66882"></a><h5 id="CNCPT-GUID-9E35FAD6-6C27-479B-AC42-0A1B83E66882" class="sect5">集合</h5>
                     <div>
                        <p><span class="bold">PL / SQL集合</span>是一组有序的元素，它们都是相同的类型。
                        </p>
                        <p>每个元素都有一个唯一的下标，用于确定其在集合中的位置。要创建集合，首先要定义集合类型，然后声明该类型的变量。</p>
                        <p>集合的工作方式与大多数第三代编程语言中的数组类似。此外，集合可以作为参数传递。因此，您可以使用它们将数据列移入和移出数据库表，或者移动到客户端应用程序和存储的子程序之间。</p>
                     </div>
                  </div><a id="CNCPT1788"></a><div class="props_rev_3"><a id="GUID-689D64D1-5BAA-437B-847D-16B6D09AB032" name="GUID-689D64D1-5BAA-437B-847D-16B6D09AB032"></a><h5 id="CNCPT-GUID-689D64D1-5BAA-437B-847D-16B6D09AB032" class="sect5">记录</h5>
                     <div>
                        <p><span class="bold">PL / SQL记录</span>是一个复合变量，可以存储不同类型的数据值，类似于C，C ++或Java中的结构类型。记录对于保存表行或表行中的某些列的数据非常有用。
                        </p>
                        <p>假设您有关于员工的数据，例如姓名，工资和雇用日期。这些项目的类型不同但在逻辑上相关。包含每个项目字段的记录允许您将数据视为逻辑单元。</p>
                        <p>您可以使用<code class="codeph">%ROWTYPE</code>属性声明一条记录，该记录表示从游标中获取的表行或行。使用用户定义的记录，您可以声明自己的字段。
                        </p>
                        <div class="infoboxnotealso" id="GUID-689D64D1-5BAA-437B-847D-16B6D09AB032__GUID-12732388-5988-4909-A43F-B02041E68410">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../lnpls/plsql-collections-and-records.html#LNPLS005" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解如何使用PL / SQL记录</p>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT88940"></a><a id="CNCPT1767"></a><div class="props_rev_3"><a id="GUID-D8D5CA8C-4D62-4EEF-B891-6D9C3CFA3D3F" name="GUID-D8D5CA8C-4D62-4EEF-B891-6D9C3CFA3D3F"></a><h4 id="CNCPT-GUID-D8D5CA8C-4D62-4EEF-B891-6D9C3CFA3D3F" class="sect4">PL / SQL如何运行</h4>
                  <div>
                     <p>PL / SQL支持解释执行和本机执行。</p>
                     <p>在解释执行中，PL / SQL源代码被编译成所谓的字节码表示。作为Oracle数据库的一部分实现的可移植虚拟计算机运行此字节码。</p>
                     <p>本机执行在计算密集型单元上提供最佳性能。在这种情况下，PL / SQL单元的源代码直接编译为给定平台的目标代码。此目标代码链接到Oracle数据库。</p>
                     <p><a href="glossary.html#GUID-DA886C43-D6F7-41D4-9CD8-63770DA864B1"><span class="xrefglossterm">PL / SQL引擎</span></a>定义，编译和运行PL / SQL单元。该引擎是许多Oracle产品的特殊组件，包括Oracle数据库。虽然许多Oracle产品都有PL / SQL组件，但本主题专门介绍了可以存储在Oracle数据库中并使用Oracle Database PL / SQL引擎进行处理的PL / SQL单元。每个Oracle工具的文档都描述了其PL / SQL功能。
                     </p>
                     <p>下图说明了Oracle数据库中包含的PL / SQL引擎。</p>
                     <div class="figure" id="GUID-D8D5CA8C-4D62-4EEF-B891-6D9C3CFA3D3F__BABFIHDH">
                        <p class="titleinfigure">图8-3 PL / SQL引擎和Oracle数据库</p><img src="img/cncpt070.gif" alt="下面是图8-3的描述" title="下面是图8-3的描述" longdesc="img_text/cncpt070.html"><br><a href="img_text/cncpt070.html">“图8-3 PL / SQL引擎和Oracle数据库”的描述</a></div>
                     <!-- class="figure" -->
                     <p>PL / SQL单元存储在数据库中。当应用程序调用存储过程时，数据库会将已编译的PL / SQL单元加载到<a href="glossary.html#GUID-78C0E867-233A-4857-B9FE-A3852A9B7BDF"><span class="xrefglossterm">系统全局区域（SGA）中</span></a>的<a href="glossary.html#GUID-64AFFF3A-C836-44F9-A25C-86CE4B9B16A8"><span class="xrefglossterm">共享池中</span></a> 。PL / SQL和SQL语句执行程序一起处理过程中的语句。
                     </p>
                     <p>您可以从另一个PL / SQL块调用存储过程，该块可以是匿名块或另一个存储过程。例如，您可以从Oracle Forms调用存储过程。</p>
                     <p>在Oracle数据库上执行的PL / SQL过程可以调用以C编程语言编写并存储在共享库中的外部过程或函数。C例程在与Oracle数据库不同的地址空间中运行。</p>
                     <div class="infoboxnotealso" id="GUID-D8D5CA8C-4D62-4EEF-B891-6D9C3CFA3D3F__GUID-0F2F1705-348A-4E0B-B0CA-7B05837E163D">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="memory-architecture.html#GUID-1CB2BA23-4386-46DA-9146-5FE0E4599AC6" title="共享池缓存各种类型的程序数据。">共享池</a> ”</span>以了解有关共享池的用途和内容的更多信息</p>
                           </li>
                           <li>
                              <p><a href="../lnpls/overview.html#LNPLS00103" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解PL / SQL体系结构</p>
                           </li>
                           <li>
                              <p><a href="../adfns/external-procedures.html#ADFNS1402" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a>了解有关外部过程的更多信息</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT88941"></a><a id="CNCPT616"></a><div class="props_rev_3"><a id="GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7" name="GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7"></a><h3 id="CNCPT-GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7" class="sect3">Oracle数据库中的Java概述</h3>
               <div>
                  <p>Java已经成为面向对象编程语言的首选。</p>
                  <p>Java包括以下功能：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Java虚拟机（JVM），它提供了平台独立性的基础</p>
                     </li>
                     <li>
                        <p>自动存储管理技术，例如垃圾收集</p>
                     </li>
                     <li>
                        <p>借用C语言并强制执行强类型的语言语法</p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7__GUID-00A7F2DE-530D-48A2-97CF-D1459D4ED5FE">
                     <p class="notep1">注意：</p>
                     <p>本章假定您对Java语言有一定的了解。</p>
                  </div>
                  <p>该数据库为Java程序提供了动态数据处理引擎，该引擎支持复杂查询和多个数据视图。客户端请求被组合为数据查询以便立即处理。查询结果是动态生成的。</p>
                  <p>Java和Oracle数据库的结合可帮助您创建基于组件的，以网络为中心的应用程序，这些应用程序可随业务需求的变化而轻松更新。此外，您还可以将应用程序和数据存储从桌面移到智能网络和以网络为中心的服务器上。更重要的是，您可以从任何客户端设备访问这些应用程序和数据存储。</p>
                  <p>下图显示了传统的双层客户端/服务器配置，其中客户端调用Java存储过程的方式与调用PL / SQL子程序的方式相同。</p>
                  <div class="figure" id="GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7__BABECJGF">
                     <p class="titleinfigure">图8-4双层客户/服务器配置</p><img src="img/cncpt236.gif" alt="下面是图8-4的描述" title="下面是图8-4的描述" longdesc="img_text/cncpt236.html"><br><a href="img_text/cncpt236.html">“图8-4双层客户/服务器配置”的描述</a></div>
                  <!-- class="figure" -->
                  <div class="infoboxnotealso" id="GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7__GUID-2B7609D1-BFA5-432A-AEAE-012F03A1C1A4">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../tdpjd/using-java-with-oracle-database.html#TDPJD101" target="_blank"><span><cite>Oracle数据库2天+ Java开发人员指南</cite></span></a> ，介绍如何将Java与Oracle数据库结合使用</p>
                  </div>
               </div><a id="CNCPT1797"></a><div class="props_rev_3"><a id="GUID-F754E0BC-5C62-4D65-91BD-96314493EB2F" name="GUID-F754E0BC-5C62-4D65-91BD-96314493EB2F"></a><h4 id="CNCPT-GUID-F754E0BC-5C62-4D65-91BD-96314493EB2F" class="sect4">Java虚拟机（JVM）概述</h4>
                  <div>
                     <p><span class="bold">JVM</span>是运行已编译Java代码的虚拟处理器。
                     </p>
                     <p>Java源代码编译为与平台无关的低级机器指令（称为<span class="italic">字节码）</span> 。Java字节码通过JVM解释为依赖于平台的操作。
                     </p>
                  </div><a id="CNCPT88942"></a><a id="CNCPT820"></a><div class="props_rev_3"><a id="GUID-ACAF8922-A3D5-4260-9935-9D92BBA578A5" name="GUID-ACAF8922-A3D5-4260-9935-9D92BBA578A5"></a><h5 id="CNCPT-GUID-ACAF8922-A3D5-4260-9935-9D92BBA578A5" class="sect5">Oracle JVM概述</h5>
                     <div>
                        <p><span class="bold">Oracle JVM</span>是一个标准的，Java兼容的环境，可以运行任何纯Java应用程序。它与JLS和JVM规范兼容。
                        </p>
                        <p>Oracle JVM支持标准Java二进制格式和API。此外，Oracle数据库遵循标准Java语言语义，包括运行时的动态类加载。</p>
                        <p>下图说明了Oracle Java应用程序如何驻留在Java核心类库之上，Java核心类库位于Oracle JVM之上。由于Oracle Java支持系统位于数据库中，因此JVM与数据库库交互，而不是直接与操作系统交互。</p>
                        <div class="figure" id="GUID-ACAF8922-A3D5-4260-9935-9D92BBA578A5__I21492">
                           <p class="titleinfigure">图8-5 Java组件结构</p><img src="img/cncpt206.gif" alt="下面是图8-5的描述" title="下面是图8-5的描述" longdesc="img_text/cncpt206.html"><br><a href="img_text/cncpt206.html">“图8-5 Java组件结构”的描述</a></div>
                        <!-- class="figure" -->
                        <p>与其他Java环境不同，Oracle JVM嵌入在Oracle数据库中。Oracle JVM与典型客户端JVM之间存在一些重要差异。例如，在标准Java环境中，通过在命令行上发出以下命令，通过解释器运行Java应用程序，其中<span class="italic"><code class="codeph">classname</code></span>是JVM首先解释的类的名称：</p><pre class="pre codeblock"><code>java <span class="italic">classname</span>
</code></pre><p>上述命令使应用程序在操作系统上的进程内运行。但是，如果未使用命令行界面，则必须将应用程序加载到数据库中，发布接口，然后在数据库<a href="glossary.html#GUID-D6A3934F-BA6D-464F-9612-C683E20514A4"><span class="xrefglossterm">数据字典中</span></a>运行该应用程序。
                        </p>
                        <div class="infoboxnotealso" id="GUID-ACAF8922-A3D5-4260-9935-9D92BBA578A5__GUID-F0C5092E-A66C-4525-9A50-6A54586DB228">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<a href="../jjdev/Oracle-JVM-overview.html#JJDEV01300" target="_blank"><span><cite>Oracle</cite></span></a> JVM与典型客户端JVM之间的其他差异的说明，请参阅<a href="../jjdev/Oracle-JVM-overview.html#JJDEV01300" target="_blank"><span><cite>Oracle数据库Java开发人员指南</cite></span></a></p>
                        </div>
                     </div>
                  </div><a id="CNCPT88943"></a><a id="CNCPT821"></a><div class="props_rev_3"><a id="GUID-50C3A528-351E-4DF4-9C76-1EB238973120" name="GUID-50C3A528-351E-4DF4-9C76-1EB238973120"></a><h5 id="CNCPT-GUID-50C3A528-351E-4DF4-9C76-1EB238973120" class="sect5">Oracle JVM的主要组件</h5>
                     <div>
                        <p>Oracle JVM通过共享其内存堆并直接访问其关系数据，在与数据库内核相同的进程空间和地址空间中运行。此设计可优化内存使用并提高吞吐量。</p>
                        <p>Oracle JVM为Java对象提供运行时环境。它完全支持Java数据结构，方法分派，异常处理和语言级线程。它还支持所有核心Java类库，包括<code class="codeph">java.lang</code> ， <code class="codeph">java.io</code> ， <code class="codeph">java.net</code> ， <code class="codeph">java.math</code>和<code class="codeph">java.util</code> 。
                        </p>
                        <p>下图显示了Oracle JVM的主要组件。</p>
                        <div class="figure" id="GUID-50C3A528-351E-4DF4-9C76-1EB238973120__BABJJHIA">
                           <p class="titleinfigure">图8-6 Oracle JVM的主要组件</p><img src="img/cncpt254.gif" width="429" alt="下面是图8-6的描述" title="下面是图8-6的描述" longdesc="img_text/cncpt254.html"><br><a href="img_text/cncpt254.html">“图8-6 Oracle JVM的主要组件”的描述</a></div>
                        <!-- class="figure" -->
                        <p>Oracle JVM将标准Java命名空间嵌入数据库模式中。此功能允许Java程序访问整个企业中存储在Oracle数据库和应用程序服务器中的Java对象。</p>
                        <p>此外，Oracle JVM与数据库的可扩展共享内存架构紧密集成。Java程序在没有用户干预的情况下有效地使用调用，会话和对象生存期。因此，Oracle JVM和中间层Java业务对象可以扩展，即使它们具有会话长状态。</p>
                        <div class="infoboxnotealso" id="GUID-50C3A528-351E-4DF4-9C76-1EB238973120__GUID-2036FC3C-F815-41C9-AD61-3718EE6454B5">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../jjdev/Oracle-JVM-overview.html#JJDEV01300" target="_blank"><span><cite>Oracle数据库Java开发人员指南，</cite></span></a>用于描述Oracle JVM的主要组件</p>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1804"></a><div class="props_rev_3"><a id="GUID-2F70C608-849D-4E54-BC09-BDE53E01012E" name="GUID-2F70C608-849D-4E54-BC09-BDE53E01012E"></a><h4 id="CNCPT-GUID-2F70C608-849D-4E54-BC09-BDE53E01012E" class="sect4">Java编程环境</h4>
                  <div>
                     <p>Oracle为企业应用程序开发人员提供了用于创建，部署和管理Java应用程序的端到端Java解决方案。</p>
                     <p>该解决方案包括客户端和服务器端编程接口，支持Java开发的工具以及与Oracle数据库集成的Java虚拟机。所有这些产品都与Java标准兼容。</p>
                     <p>Java编程环境包含以下附加功能：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Java存储过程作为Java等价物和PL / SQL的伴随。 Java存储过程与PL / SQL紧密集成。您可以从PL / SQL包调用Java存储过程，从Java存储过程调用过程。</p>
                        </li>
                        <li>
                           <p>用于访问SQL数据的JDBC和SQLJ编程接口。</p>
                        </li>
                        <li>
                           <p>有助于开发，加载和管理类的工具和脚本。</p>
                        </li>
                     </ul>
                  </div><a id="CNCPT1805"></a><div class="props_rev_3"><a id="GUID-48434C99-5806-4174-A2E1-DC07ADA0CCBC" name="GUID-48434C99-5806-4174-A2E1-DC07ADA0CCBC"></a><h5 id="CNCPT-GUID-48434C99-5806-4174-A2E1-DC07ADA0CCBC" class="sect5">Java存储过程</h5>
                     <div>
                        <p><span class="bold">Java存储过程</span>是发布到SQL并存储在数据库中的Java方法。
                        </p>
                        <p>与PL / SQL子程序一样，可以使用SQL * Plus等产品直接调用Java过程，也可以使用触发器间接调用Java过程。您可以从任何Oracle Net客户端-OCI，预编译器或JDBC访问它。</p>
                        <p>要发布Java方法，可以编写调用规范，将Java方法名称，参数类型和返回类型映射到SQL对应项。当客户端应用程序调用时，Java存储过程可以接受参数，引用Java类并返回Java结果值。</p>
                        <p>通过引用调用规范的名称来调用Java方法的应用程序。运行时系统在Oracle数据字典中查找调用规范定义并运行相应的Java方法。</p>
                        <p>此外，您可以使用Java开发独立于PL / SQL的强大程序。 Oracle数据库提供了Java编程语言和JVM的完全兼容的实现。</p>
                        <div class="infoboxnotealso" id="GUID-48434C99-5806-4174-A2E1-DC07ADA0CCBC__GUID-5BFDF774-1865-4E72-85B5-80D6498FC1EA">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../jjdev/developing-Java-stored-procedures.html#GUID-AE1E5C4B-A077-4D1E-8821-6A7142BF1FEA" target="_blank"><span><cite>Oracle数据库Java开发人员指南</cite></span></a>介绍了如何使用Java编写存储过程，如何从PL / SQL访问它们，以及如何从Java访问PL / SQL功能</p>
                        </div>
                     </div>
                  </div><a id="CNCPT823"></a><div class="props_rev_3"><a id="GUID-A7135BCC-A366-428F-BC69-23CD20914DF5" name="GUID-A7135BCC-A366-428F-BC69-23CD20914DF5"></a><h5 id="CNCPT-GUID-A7135BCC-A366-428F-BC69-23CD20914DF5" class="sect5">Java和PL / SQL集成</h5>
                     <div>
                        <p>您可以从PL / SQL从Java和Java程序调用现有的PL / SQL程序。此解决方案可保护和利用您的PL / SQL和Java代码。</p>
                        <p>Oracle数据库提供了两种从Java访问SQL数据的不同方法：JDBC和SQLJ。 JDBC在客户端和服务器上都可用，而SQLJ仅在客户端上可用。</p>
                     </div><a id="CNCPT825"></a><div class="props_rev_3"><a id="GUID-174E853D-233D-4202-AC5D-E76637A2AA44" name="GUID-174E853D-233D-4202-AC5D-E76637A2AA44"></a><h6 id="CNCPT-GUID-174E853D-233D-4202-AC5D-E76637A2AA44" class="sect6">JDBC驱动程序</h6>
                        <div>
                           <p>JDBC是一种数据库访问协议，使您可以连接到数据库并运行SQL语句和查询到数据库。</p>
                           <p>核心Java类库只提供一个JDBC API， <code class="codeph">java.sql</code> 。但是，JDBC旨在使供应商能够提供为特定数据库提供必要专业化的驱动程序。Oracle提供了下表中显示的不同JDBC驱动程序。
                           </p>
                           <div class="tblformal" id="GUID-174E853D-233D-4202-AC5D-E76637A2AA44__GUID-69263B4E-8D8F-4A25-A6D1-570DE44532B4">
                              <p class="titleintable">表8-2 JDBC驱动程序</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="JDBC驱动程序" width="100%" border="1" summary="This table is a list and description of provided JDBC drivers." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d40402e7956">司机</th>
                                       <th align="left" valign="bottom" id="d40402e7959">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d40402e7964" headers="d40402e7956 ">
                                          <p>JDBC瘦驱动程序</p>
                                       </td>
                                       <td align="left" valign="top" headers="d40402e7964 d40402e7959 ">
                                          <p>您可以使用JDBC Thin驱动程序编写访问Oracle SQL数据的纯Java应用程序和applet。JDBC Thin驱动程序特别适用于基于Web的应用程序和applet，因为您可以从Web页面动态下载它，类似于任何其他Java applet。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d40402e7971" headers="d40402e7956 ">
                                          <p>JDBC OCI驱动程序</p>
                                       </td>
                                       <td align="left" valign="top" headers="d40402e7971 d40402e7959 ">
                                          <p>JDBC OCI驱动程序访问特定于Oracle的本机代码，即非Java代码，以及客户端或中间层上的库，与JDBC Thin驱动程序相比，性能得到提升，代价是规模更大，客户端更大安装。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d40402e7978" headers="d40402e7956 ">
                                          <p>JDBC服务器端内部驱动程序</p>
                                       </td>
                                       <td align="left" valign="top" headers="d40402e7978 d40402e7959 ">
                                          <p>当Java代码在服务器上运行时，Oracle数据库使用服务器端内部驱动程序。它允许在服务器上的Oracle JVM中运行的Java应用程序使用JDBC访问本地定义的数据，即同一系统和同一进程中的数据。它提供了性能提升，因为它能够直接使用底层的Oracle RDBMS库，而不需要Java代码和SQL数据之间的中间网络连接的开销。通过在服务器上支持相同的Java-SQL接口，Oracle数据库不需要您在部署时重做代码。</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <div class="infoboxnotealso" id="GUID-174E853D-233D-4202-AC5D-E76637A2AA44__GUID-31D8041A-7029-4E39-93B8-44043A2BE52D">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-C5A31D66-F743-4BAC-9698-4B2058E3D8A9" title="ODBC是一种标准API，它使应用程序能够连接到数据库，然后准备和运行SQL语句。">ODBC和JDBC</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><a href="../tdpjd/index.html" target="_blank"><span><cite>Oracle数据库2天+ Java开发人员指南</cite></span></a>和<a href="../jjdbc/introducing-JDBC.html#GUID-D6975767-9F5A-4B30-8910-9298DDD7FEF0" target="_blank"><span><cite>Oracle数据库JDBC开发人员指南</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div><a id="CNCPT826"></a><div class="props_rev_3"><a id="GUID-BCCC0B04-0B9C-45BA-A34A-46051F0643E1" name="GUID-BCCC0B04-0B9C-45BA-A34A-46051F0643E1"></a><h6 id="CNCPT-GUID-BCCC0B04-0B9C-45BA-A34A-46051F0643E1" class="sect6">SQLJ</h6>
                        <div>
                           <p><strong class="term">SQLJ</strong>是用于在Java程序中嵌入SQL语句的ANSI标准。您可以使用客户端SQLJ程序。此外，您可以将SQLJ程序与JDBC结合使用。</p>
                           <div class="infoboxnote" id="GUID-BCCC0B04-0B9C-45BA-A34A-46051F0643E1__GUID-5E38EC2B-B52D-4CC8-9EB6-F152C47190BF">
                              <p class="notep1">注意：</p>
                              <p>从<span>Oracle Database 12c第</span> 2版（12.2）开始，Oracle数据库不支持运行<span class="italic">服务器端</span> SQLJ代码，包括在数据库环境中运行存储过程，函数和触发器。
                              </p>
                           </div>
                           <p>SQLJ提供了一种简单但功能强大的方法来开发从Java访问数据库的客户端和中间层应用程序。开发人员使用SQLJ编写程序，然后使用SQLJ转换器将嵌入式SQL转换为基于JDBC的纯Java代码。在运行时，程序可以使用标准JDBC驱动程序与多供应商数据库进行通信。</p>
                           <p>以下示例显示了一个简单的SQLJ可执行语句：</p><pre class="pre codeblock"><code>字符串名称; #sql {SELECT first_name INTO：name FROM employees WHERE employee_id = 112}; System.out.println（“名称是”+名称+“，员工编号=”+ employee_id）;</code></pre><div class="infoboxnotealso" id="GUID-BCCC0B04-0B9C-45BA-A34A-46051F0643E1__GUID-6F096BBC-3733-4FC4-9A9E-8A70A63EC57A">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li><span class="q">“ <a href="concepts-for-database-developers.html#GUID-575F8325-3839-45ED-B370-2292D208D9C3" title="SQLJ是用于在Java源代码中嵌入SQL语句的ANSI SQL-1999标准。SQLJ为Java数据库连接（JDBC）API提供了一种更简单的替代方法，用于从Java进行客户端SQL数据访问。">SQLJ</a> ”</span></li>
                                 <li>
                                    <p><a href="../jsqlj/intro-to-SQLJ.html#GUID-B3A3C319-5C61-40C6-B3FB-37C2BD98AD48" target="_blank"><span><cite>Oracle数据库SQLJ开发人员指南</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT118"></a><div class="props_rev_3"><a id="GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63" name="GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63"></a><h3 id="CNCPT-GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63" class="sect3">触发器概述</h3>
               <div>
                  <p>数据库<span class="bold">触发器</span>是一个编译的存储程序单元，用PL / SQL或Java编写，Oracle Database在某些情况下自动调用（“触发”）。
                  </p>
                  <p>只要发生以下操作之一，就会触发触发器：</p>
                  <ol>
                     <li>
                        <p>由任何用户发布的特定表或视图上的<a href="glossary.html#GUID-B5F2F112-1B33-41B5-B63D-9DC8F99A369D"><span class="xrefglossterm">DML</span></a>语句</p>
                        <p>DML语句修改模式对象中的数据。例如，插入和删除行是DML操作。</p>
                     </li>
                     <li>
                        <p>由特定用户或任何用户发布的<a href="glossary.html#GUID-64F19D78-A73F-44A5-AA2E-60EBC800CB22"><span class="xrefglossterm">DDL</span></a>语句</p>
                        <p>DDL语句定义模式对象。例如，创建表并添加列是DDL操作。</p>
                     </li>
                     <li>
                        <p>数据库事件</p>
                        <p>用户登录或注销，错误以及数据库启动或关闭是可以调用触发器的事件。</p>
                     </li>
                  </ol>
                  <p>触发器是类似于子程序的架构对象，但它们的调用方式不同。子程序由用户，应用程序或触发器显式运行。触发事件发生时，数据库会隐式调用触发器。</p>
                  <div class="infoboxnotealso" id="GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63__GUID-4D2869DE-CDF1-4430-A0E7-EBCCFD3859DB">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="sql.html#GUID-662EE4B0-7D5E-43F5-806D-A2AE404D77BF" title="对Oracle数据库中的信息执行的所有操作都使用SQL语句运行。SQL语句是由标识符，参数，变量，名称，数据类型和SQL保留字组成的计算机程序或指令。">SQL语句概述</a> ”</span>以了解DML和DDL</p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="oracle-database-instance.html#GUID-5FCFB104-8365-4E7B-87A1-736E65D6658F" title="数据库实例提供用户对数据库的访问权限。实例和数据库可以处于各种状态。">数据库实例启动和关闭概述</a> ”</span></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="CNCPT88945"></a><div class="props_rev_3"><a id="GUID-F1177761-342B-468C-BE5B-943A1ABC7B7C" name="GUID-F1177761-342B-468C-BE5B-943A1ABC7B7C"></a><h4 id="CNCPT-GUID-F1177761-342B-468C-BE5B-943A1ABC7B7C" class="sect4">触发器的优点</h4>
                  <div>
                     <p>正确使用触发器使您能够构建和部署更强大且更有效地使用数据库的应用程序。</p>
                     <p>您可以使用触发器：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>自动生成派生列值</p>
                        </li>
                        <li>
                           <p>防止无效的交易</p>
                        </li>
                        <li>
                           <p>提供审核和事件记录</p>
                        </li>
                        <li>
                           <p>记录有关表访问的信息</p>
                        </li>
                     </ul>
                     <p>您可以使用触发器来强制执行所有客户端应用程序通用的低级业务规则。例如，多个应用程序可以访问<code class="codeph">employees</code>表。如果此表上的触发器确保插入数据的格式，则不需要在每个客户端中复制此业务逻辑。由于应用程序无法绕过触发器，因此会自动使用触发器中的业务逻辑。
                     </p>
                     <p>您可以使用触发器和完整性约束来定义和实施任何类型的完整性规则。但是，Oracle强烈建议您仅使用触发器来强制执行使用<a href="glossary.html#GUID-67F8FE8C-EBA5-4796-820A-8919982A1411"><span class="xrefglossterm">完整性约束</span></a>无法定义的复杂业务规则。
                     </p>
                     <p>过度使用触发器会导致复杂的相互依赖性，这在大型应用程序中很难维护。例如，当调用触发器时，其触发器操作中的SQL语句可能会触发其他触发器，从而导致可能产生意外影响的级联触发器。</p>
                     <div class="infoboxnotealso" id="GUID-F1177761-342B-468C-BE5B-943A1ABC7B7C__GUID-A5182620-E802-41C6-98FD-F6FD3E3E6142">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="data-integrity.html#GUID-A8893CD7-8B19-42AA-8550-9713071FA679" title="数据保持数据完整性非常重要，这符合数据库管理员或应用程序开发人员确定的业务规则。">数据完整性简介</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../tdddg/using-triggers.html#TDDDG50000" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../lnpls/plsql-triggers.html#LNPLS2002" target="_blank"><span><cite>Oracle Database PL / SQL语言参考，</cite></span></a>用于规划应用程序触发器时的准则和限制</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT318"></a><div class="props_rev_3"><a id="GUID-02E647D9-D55E-4C74-993A-65FCE1AFE6AA" name="GUID-02E647D9-D55E-4C74-993A-65FCE1AFE6AA"></a><h4 id="CNCPT-GUID-02E647D9-D55E-4C74-993A-65FCE1AFE6AA" class="sect4">触发器的类型</h4>
                  <div>
                     <p>触发器可以根据其调用方式和它们执行的操作类型进行分类。</p>
                     <p>Oracle数据库支持以下类型的触发器：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>行触发器</p>
                           <p>每次表格受触发语句影响时，都会触发<a href="glossary.html#GUID-24EF0C74-72E4-4455-8C95-C52A1CDDF81C"><span class="xrefglossterm">行触发器</span></a> 。例如，如果语句更新多行，则对于受<code class="codeph">UPDATE</code>影响的每一行，行触发器将触发一次。如果触发语句不影响任何行，则不会运行行触发器。如果触发器操作中的代码依赖于触发语句提供的数据或受影响的行，则行触发器很有用。
                           </p>
                        </li>
                        <li>
                           <p>声明触发器</p>
                           <p>无论受触发语句影响的行数如何，都会代表触发语句触发一次<a href="glossary.html#GUID-85D25BFF-A802-4DAB-B86C-A41EFCA11B6E"><span class="xrefglossterm">语句触发器</span></a> 。例如，如果语句从表中删除100行，则语句级<code class="codeph">DELETE</code>触发器仅触发一次。如果触发器操作中的代码不依赖于触发语句提供的数据或受影响的行，则语句触发器很有用。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">INSTEAD OF</code>触发器</p>
                           <p>Oracle数据库<a href="glossary.html#GUID-9BB0F932-40F0-4727-85A1-904E162405D0"><span class="xrefglossterm">触发INSTEAD OF触发器</span></a> ，而不是执行触发语句。这些触发器对于透明地修改无法通过DML语句直接修改的视图非常有用。
                           </p>
                        </li>
                        <li>
                           <p>事件触发器</p>
                           <p>您可以使用触发器向订阅者发布有关数据库事件的信息。事件触发器分为以下几类：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="glossary.html#GUID-EFE577C5-037A-4974-8358-F3761AC70601"><span class="xrefglossterm">系统事件触发器</span></a>可能由数据库实例启动和关闭或错误消息等事件引起。
                                 </p>
                              </li>
                              <li>
                                 <p>由于与用户登录和注销，DDL语句和DML语句相关的<a href="glossary.html#GUID-54BD71CF-7D44-4CB2-9FC4-90F5CA8EF110"><span class="xrefglossterm">事件，将触发用户事件触发器</span></a> 。
                                 </p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-02E647D9-D55E-4C74-993A-65FCE1AFE6AA__GUID-2C35DBFE-34BB-461E-A13F-A4F34C3D3C7E">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../tdddg/using-triggers.html#TDDDG51000" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../lnpls/plsql-triggers.html#LNPLS2005" target="_blank"><span><cite>Oracle数据库PL / SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT88946"></a><div class="props_rev_3"><a id="GUID-A29549A3-AB75-4CCD-9093-559F8B5DA9B2" name="GUID-A29549A3-AB75-4CCD-9093-559F8B5DA9B2"></a><h4 id="CNCPT-GUID-A29549A3-AB75-4CCD-9093-559F8B5DA9B2" class="sect4">触发器的时间</h4>
                  <div>
                     <p>您可以定义触发器计时 - 是否在触发语句之前或之后运行触发器操作。</p>
                     <p><a href="glossary.html#GUID-2B4F37A3-7EB0-455F-8704-32C072C25198"><span class="xrefglossterm">简单触发器</span></a>是表上的单个触发器，使您可以为以下某个时间点指定操作：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在解雇声明之前</p>
                        </li>
                        <li>
                           <p>在受到解雇声明影响的每一行之前</p>
                        </li>
                        <li>
                           <p>在每一行受到触发声明影响之后</p>
                        </li>
                        <li>
                           <p>解雇声明后</p>
                        </li>
                     </ul>
                     <p>对于语句和行触发器， <code class="codeph">BEFORE</code>触发器可以在更改数据库之前增强安全性并启用业务规则。<code class="codeph">AFTER</code>触发器非常适合记录操作。
                     </p>
                     <p><a href="glossary.html#GUID-AE8C3B7A-EF80-4452-9C4D-4094E21BFC9E"><span class="xrefglossterm">复合触发器</span></a>可以在多个定时点<a href="glossary.html#GUID-AE8C3B7A-EF80-4452-9C4D-4094E21BFC9E"><span class="xrefglossterm">触发</span></a> 。复合触发器有助于编写一种方法，在该方法中，您为各种时序点实现的操作共享公共数据。
                     </p>
                     <div class="infoboxnotealso" id="GUID-A29549A3-AB75-4CCD-9093-559F8B5DA9B2__GUID-2DFB36FF-EEA0-49F7-92E3-02A53665E5EB">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../lnpls/plsql-triggers.html#LNPLS2005" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解复合触发器</p>
                     </div>
                  </div>
               </div><a id="CNCPT88948"></a><a id="CNCPT88947"></a><a id="CNCPT218"></a><div class="props_rev_3"><a id="GUID-146A5161-0BEA-4556-B0BC-DB29306FACFA" name="GUID-146A5161-0BEA-4556-B0BC-DB29306FACFA"></a><h4 id="CNCPT-GUID-146A5161-0BEA-4556-B0BC-DB29306FACFA" class="sect4">创建触发器</h4>
                  <div>
                     <p><code class="codeph">CREATE TRIGGER</code>语句创建或替换数据库触发器。
                     </p>
                     <p>PL / SQL触发器具有以下一般语法形式：</p><pre class="pre codeblock"><code>CREATE TRIGGER <span class="italic">trigger_name</span> <span class="italic">triggering_statement</span> [ <span class="italic">trigger_restriction</span> ] BEGIN <span class="italic">triggered_action</span> ;结束;</code></pre><p>PL / SQL触发器具有以下基本组件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>触发器名称</p>
                           <p>该名称在同一模式中的其他触发器名称中必须是唯一的。例如，名称可能是<code class="codeph">part_reorder_trigger</code> 。
                           </p>
                        </li>
                        <li>
                           <p>触发事件或语句</p>
                           <p>触发事件或语句是导致触发器被调用的SQL语句，数据库事件或用户事件。例如，用户更新表。</p>
                        </li>
                        <li>
                           <p>触发限制</p>
                           <p>触发器限制指定一个布尔<a href="glossary.html#GUID-E2141FFA-A7B2-4113-BEEE-2401FC38AB2E"><span class="xrefglossterm">表达式</span></a> ，该触发器必须为<code class="codeph">true</code>才能触发。例如，除非可用部件的数量小于当前的重新订购数量，否则不会调用触发器。
                           </p>
                        </li>
                        <li>
                           <p>触发动作</p>
                           <p>触发操作是包含在发出触发语句并且触发器限制评估为true时要运行的SQL语句和代码的过程。例如，用户将行插入到挂单表中。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-146A5161-0BEA-4556-B0BC-DB29306FACFA__GUID-AA1B80EE-D949-46E9-AF54-604B974722C0">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../tdddg/using-triggers.html#TDDDG52000" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a>和<a href="../lnpls/CREATE-PROCEDURE-statement.html#LNPLS2004" target="_blank"><span><cite>Oracle数据库PL / SQL语言参考</cite></span></a> ，了解如何创建触发器</p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/CREATE-TRIGGER.html#SQLRF01405" target="_blank"><span><cite>Oracle Database SQL语言参考</cite></span></a>了解<code class="codeph">CREATE TRIGGER</code>语句</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-355D97A1-A490-477F-9888-278624393ABF" name="GUID-355D97A1-A490-477F-9888-278624393ABF"></a><h5 id="CNCPT-GUID-355D97A1-A490-477F-9888-278624393ABF" class="sect5">示例：CREATE TRIGGER语句</h5>
                     <div>
                        <p>此示例创建一个触发器，该行触发器在行项目表上执行<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code>语句时触发。
                        </p>
                        <div class="example" id="GUID-355D97A1-A490-477F-9888-278624393ABF__GUID-AE3458EA-D92C-4D1D-B59D-5052C751E1FE">
                           <p>假设您使用以下语句创建<code class="codeph">orders</code>和<code class="codeph">lineitems</code>表。<code class="codeph">orders</code>表包含每个唯一订单的行，而<code class="codeph">lineitems</code>表包含订单中每个项目的行。
                           </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE命令（order_id NUMBER PRIMARY KEY，/ *其他属性* / line_items_count NUMBER DEFAULT 0）; CREATE TABLE lineitems（order_id REFERENCES orders，seq_no NUMBER，/ * other attributes * / CONSTRAINT lineitems PRIMARY KEY（order_id，seq_no））;</pre><p>以下语句创建一个示例触发器，该触发器使用<code class="codeph">orders</code>中的项目数自动更新<code class="codeph">orders</code>表：</p><pre class="pre codeblock"><code>创建或替换TRIGGER lineitems_trigger插入或更新或删除线条项目后每行开始IF（插入或更新）然后更新订单SET line_items_count = NVL（line_items_count，0）+1 WHERE order_id =：new.order_id;万一; IF（删除或更新）然后更新订单SET line_items_count = NVL（line_items_count，0）-1 WHERE order_id =：old.order_id;万一;结束; /</code></pre><p>在<code class="codeph">lineitems_trigger</code> ，触发语句是<code class="codeph">lineitems</code>表上的<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code> 。不存在触发限制。为每个更改的行调用触发器。触发器可以访问受触发语句影响的当前行的旧列值和新列值。要修改的表的每一列都存在两个相关名：旧值（ <code class="codeph">:old</code> ）和新值（ <code class="codeph">:new</code> ）。如果会话更新或插入订单的<code class="codeph">lineitems</code>中的行，则在操作之后，触发器将按此顺序计算项目数，并使用计数更新<code class="codeph">orders</code>表。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-787A32DF-959F-4821-AFAD-3B3424769D25" name="GUID-787A32DF-959F-4821-AFAD-3B3424769D25"></a><h5 id="CNCPT-GUID-787A32DF-959F-4821-AFAD-3B3424769D25" class="sect5">示例：调用行级触发器</h5>
                     <div>
                        <p>在这种情况下，客户启动两个订单并添加和删除订单中的订单项。</p>
                        <div class="example" id="GUID-787A32DF-959F-4821-AFAD-3B3424769D25__GUID-BEC423E0-5961-4151-9B6A-BA6A53BCF4DA">
                           <p>该方案基于<a href="server-side-programming.html#GUID-355D97A1-A490-477F-9888-278624393ABF" title="此示例创建一个触发器，该行触发器在行项目表上执行INSERT，UPDATE或DELETE语句时触发。">Example：CREATE TRIGGER Statement中创建的触发器</a> 。
                           </p>
                           <div class="tblformalwide" id="GUID-787A32DF-959F-4821-AFAD-3B3424769D25__GUID-94121B35-F6AD-4813-A58F-C13FCA364DD0">
                              <p class="titleintable">表8-3行级触发器方案</p>
                              <table cellpadding="4" cellspacing="0" class="FormalWide" title="行级触发场景" width="100%" border="1" summary="This table describes a scenario where a customer initiates two orders and adds and removes line items from the orders." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="20%" id="d40402e10648">SQL语句</th>
                                       <th align="left" valign="bottom" width="20%" id="d40402e10651">触发的SQL语句</th>
                                       <th align="left" valign="bottom" width="20%" id="d40402e10654">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10659" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO orders（order_id）VALUES（78）;已创建1行。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10659 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10659 d40402e10654 ">
                                          <p>客户创建ID为78的订单。此时客户订单中没有商品。</p>
                                          <p>由于未对<code class="codeph">lineitems</code>表执行任何操作，因此不会调用触发器。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10672" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO orders（order_id）VALUES（92）;已创建1行。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10672 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10672 d40402e10654 ">
                                          <p>客户创建一个ID为92的单独订单。此时客户订单中没有商品。</p>
                                          <p>由于未对<code class="codeph">lineitems</code>表执行任何操作，因此不会调用触发器。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10685" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO lineitems（order_id，seq_no）VALUES（78,1）;已创建1行。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10685 d40402e10651 "><pre class="oac_no_warn" dir="ltr">更新订单SET line_items_count = NVL（NULL，0）+1 WHERE order_id = 78;</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10685 d40402e10654 ">
                                          <p>客户在订单中添加商品78。</p>
                                          <p><code class="codeph">INSERT</code>调用触发器。触发的语句将订单78的行项目计数从0增加到1。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10700" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO lineitems（order_id，seq_no）VALUES（78,2）;已创建1行。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10700 d40402e10651 "><pre class="oac_no_warn" dir="ltr">更新订单SET line_items_count = NVL（1,0）+1 WHERE order_id = 78;</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10700 d40402e10654 ">
                                          <p>客户在订单78中添加了一个额外的项目。</p>
                                          <p><code class="codeph">INSERT</code>调用触发器。触发的语句将订单78的行项目计数从1增加到2。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10715" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM orders; ORDER_ID LINE_ITEMS_COUNT --------- ---------------- 78 2 92 0</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10715 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10715 d40402e10654 ">
                                          <p>客户查询两个订单的状态。订单78包含两个项目。订单92不包含任何项目。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10723" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM lineitems; ORDER_ID SEQ_NO ---------- ---------- 78 1 78 2</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10723 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10723 d40402e10654 ">
                                          <p>客户查询订单项的状态。每个项目由订单ID和序列号唯一标识。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10731" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; UPDATE lineitems SET order_id = 92; 2行更新。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10731 d40402e10651 "><pre class="oac_no_warn" dir="ltr">UPDATE命令SET line_items_count = NVL（NULL，0）+1 WHERE order_id = 92;更新订单SET line_items_count = NVL（2,0）-1 WHERE order_id = 78;</pre><pre class="oac_no_warn" dir="ltr">更新订单SET line_items_count = NVL（1,0）+1 WHERE order_id = 92;更新订单SET line_items_count = NVL（1,0）-1 WHERE order_id = 78;</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10731 d40402e10654 ">
                                          <p>客户将订单78中的订单项移至订单92。</p>
                                          <p><code class="codeph">UPDATE</code>语句更改<code class="codeph">lineitems</code>表中的2行，每行为每行调用一次触发器。
                                          </p>
                                          <p>每次调用触发器时，都会满足触发器中的两个<code class="codeph">IF</code>条件。第一个条件使订单92的计数递增，而第二个条件减少订单78的计数。因此，运行四个总<code class="codeph">UPDATE</code>语句。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10759" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM orders; ORDER_ID LINE_ITEMS_COUNT --------- ---------------- 78 0 92 2</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10759 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10759 d40402e10654 ">
                                          <p>客户查询两个订单的状态。净效应是订单92的行项目计数从0增加到2，而订单78的计数从2减少到0。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10767" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM lineitems; ORDER_ID SEQ_NO ---------- ---------- 92 1 92 2</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10767 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10767 d40402e10654 ">
                                          <p>客户查询订单项的状态。每个项目由订单ID和序列号唯一标识。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10775" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; DELETE FROM lineitems;删除了2行。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10775 d40402e10651 "><pre class="oac_no_warn" dir="ltr">更新订单SET line_items_count = NVL（2,0）-1 WHERE order_id = 92;更新订单SET line_items_count = NVL（1,0）-1 WHERE order_id = 92;</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10775 d40402e10654 ">
                                          <p>客户现在从所有订单中删除所有订单项。</p>
                                          <p><code class="codeph">DELETE</code>语句在<code class="codeph">lineitems</code>表中更改了2行，每行为每行调用一次触发器。对于每个触发器调用，只满足触发器中的一个<code class="codeph">IF</code>条件。每次条件将订单92的计数减少1。因此，运行两个总<code class="codeph">UPDATE</code>语句。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10799" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM orders; ORDER_ID LINE_ITEMS_COUNT --------- ---------------- 78 0 92 0 SQL&gt; SELECT * FROM lineitems;没有选择任何行</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10799 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10799 d40402e10654 ">
                                          <p>客户查询两个订单的状态。这两个订单都不包含订单项。</p>
                                          <p>客户还会查询订单项的状态。没有物品存在。</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="CNCPT1697"></a><div class="props_rev_3"><a id="GUID-F5B4011B-AA09-4D61-A409-6AB290A9025F" name="GUID-F5B4011B-AA09-4D61-A409-6AB290A9025F"></a><h4 id="CNCPT-GUID-F5B4011B-AA09-4D61-A409-6AB290A9025F" class="sect4">执行触发器</h4>
                  <div>
                     <p>Oracle数据库使用与子程序执行相同的步骤在内部执行触发器。</p>
                     <p>唯一细微的区别是，如果用户帐户有权运行触发语句，则有权触发触发器。有了这个例外，数据库验证并运行触发器的方式与存储的子程序相同。</p>
                     <div class="infoboxnotealso" id="GUID-F5B4011B-AA09-4D61-A409-6AB290A9025F__GUID-ADC3DCE9-FC22-4342-9967-BDC3475C475B">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../lnpls/plsql-triggers.html#LNPLS020" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解有关触发器执行的更多信息</p>
                     </div>
                  </div>
               </div><a id="CNCPT88949"></a><a id="CNCPT1696"></a><div class="props_rev_3"><a id="GUID-D54C348D-BFC6-41B6-AEDD-C081C1089208" name="GUID-D54C348D-BFC6-41B6-AEDD-C081C1089208"></a><h4 id="CNCPT-GUID-D54C348D-BFC6-41B6-AEDD-C081C1089208" class="sect4">存储触发器</h4>
                  <div>
                     <p>Oracle数据库以编译形式将PL / SQL触发器存储在数据库模式中，就像PL / SQL存储过程一样。</p>
                     <p>当<code class="codeph">CREATE TRIGGER</code>语句提交时，编译的PL / SQL代码存储在数据库中。共享池删除PL / SQL触发器的源代码。
                     </p>
                     <p>下图显示了具有隐式调用PL / SQL触发器的SQL语句的数据库应用程序。触发器与其关联表分开存储。</p>
                     <div class="figure" id="GUID-D54C348D-BFC6-41B6-AEDD-C081C1089208__BABJAIBB">
                        <p class="titleinfigure">图8-7触发器</p><img src="img/cncpt076.gif" alt="下面是图8-7的描述" title="下面是图8-7的描述" longdesc="img_text/cncpt076.html"><br><a href="img_text/cncpt076.html">“图8-7触发器”的描述</a></div>
                     <!-- class="figure" -->
                     <p>Java触发器的存储方式与PL / SQL触发器的存储方式相同。但是，Java触发器引用使用<code class="codeph">CALL</code>语句单独编译的Java代码。因此，创建Java触发器涉及创建Java代码并创建引用此Java代码的触发器。
                     </p>
                     <div class="infoboxnotealso" id="GUID-D54C348D-BFC6-41B6-AEDD-C081C1089208__GUID-AF279AA8-4118-4B89-B4FD-B5E68A3B2C0D">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../lnpls/plsql-triggers.html#LNPLS2007" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解有关编译和存储触发器的信息</p>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="00273.managing-the-redo-log.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You manage the redo log by completing tasks such as creating redo log groups and members, relocating and renaming redo log members, dropping redo log groups and members, and forcing log switches."></meta>
      <meta name="description" content="You manage the redo log by completing tasks such as creating redo log groups and members, relocating and renaming redo log members, dropping redo log groups and members, and forcing log switches."></meta>
      <title>管理重做日志</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Administrator’s Guide "></meta>
      <meta property="og:description" content="You manage the redo log by completing tasks such as creating redo log groups and members, relocating and renaming redo log members, dropping redo log groups and members, and forcing log switches."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Administrator’s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-14T11:02:35-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96348-04"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="managing-control-files.html" title="Previous" type="text/html"></link>
      <link rel="next" href="managing-archived-redo-log-files.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADMIN"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="managing-control-files.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="managing-archived-redo-log-files.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库管理员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-database-structure-and-storage.html" property="item" typeof="WebPage"><span property="name">Oracle数据库结构和存储</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">管理重做日志</li>
            </ol>
            <a id="GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" name="GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4"></a><a id="ADMIN007"></a>
            
            <h2 id="ADMIN-GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" class="sect2"><span class="enumeration_chapter">11</span>管理重做日志</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-79189E7E-7431-49CA-B342-3B971186503A">什么是重做日志？</a><br>恢复操作最关键的结构是<span class="bold">重做日志</span> ，它由两个或多个预分配文件组成，这些文件存储在数据库发生时对数据库所做的所有更改。Oracle数据库的每个实例都有一个关联的重做日志，以便在实例发生故障时保护数据库。
                  </li>
                  <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-D77BCD54-908E-49F8-A80D-C8D3E9465D70">规划重做日志</a><br>配置数据库实例重做日志时，可以遵循准则。
                  </li>
                  <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-081AE57B-A821-4F26-97B2-4B141FDB3946">创建重做日志组和成员</a><br>规划数据库的重做日志，并在数据库创建期间创建所有必需的组和重做日志文件的成员。但是，您可能希望创建其他组或成员。例如，将组添加到重做日志可以纠正重做日志组可用性问题。
                  </li>
                  <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-F593023B-3071-4776-95F2-9B8B6C6E670B">重定位和重命名重做日志成员</a><br>您可以使用操作系统命令重定位重做日志，然后使用<code class="codeph">ALTER DATABASE</code>语句使数据库知道其新名称（位置）。
                  </li>
                  <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-54E1DA00-B999-4463-B868-85ADDC108D5D">删除重做日志组和成员</a><br>在某些情况下，您可能希望删除整组重做日志成员。
                  </li>
                  <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-6A7FB6CB-AF29-40BC-BDB3-B514C502B2F6">强制日志切换</a><br>当LGWR停止写入一个重做日志组并开始写入另一个时，会发生日志切换。默认情况下，当前重做日志文件组填充时会自动进行日志切换。
                  </li>
                  <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-E8BC43CA-D047-4AEF-AB4A-2566BE44D73A">验证重做日志文件中的块</a><br>您可以将数据库配置为使用校验和来验证重做日志文件中的块。
                  </li>
                  <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-AA0EBC79-6670-409E-AED1-666FCEF3F25F">清除重做日志文件</a><br>数据库打开时，重做日志文件可能会损坏，并最终停止数据库活动，因为归档无法继续。
                  </li>
                  <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-27E9B63B-03E4-43E5-BA59-AB0EDDDE5CE6">FORCE LOGGING设置的优先顺序</a><br>您可以在各个级别设置<code class="codeph">FORCE LOGGING</code>和<code class="codeph">NOLOGGING</code> ，例如数据库，可插拔数据库（PDB），表空间或数据库对象。当<code class="codeph">FORCE LOGGING</code>设置为一个或多个级别时， <code class="codeph">FORCE LOGGING</code>设置的优先级决定了重做日志中记录的内容。
                  </li>
                  <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-05FCB15E-BE40-40EB-B756-4D280461AD7E">重做日志数据字典视图</a><br>您可以查询一组数据字典视图，以获取有关重做日志的信息。
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4__GUID-62907E67-41BF-454A-80A3-935FCEEC89B8">
                  <p class="notep1">也可以看看：</p>
                  <p><a href="using-oracle-managed-files.html#GUID-4A3C4616-0D81-4BBA-8EAD-FCAA8AD5C15A" title="Oracle数据库可以管理组成数据库的文件。">使用Oracle Managed Files</a>获取有关由Oracle数据库服务器创建和管理的重做日志文件的信息</p>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="oracle-database-structure-and-storage.html#GUID-F11D30A7-BF12-4D8F-A1C2-D7437D38F8C7" title="您可以创建和管理数据库结构和存储组件。">Oracle数据库结构和存储</a></p>
                  </div>
               </div>
            </div>
            <a id="ADMIN11302"></a><div class="props_rev_3"><a id="GUID-79189E7E-7431-49CA-B342-3B971186503A" name="GUID-79189E7E-7431-49CA-B342-3B971186503A"></a><h3 id="ADMIN-GUID-79189E7E-7431-49CA-B342-3B971186503A" class="sect3"><span class="enumeration_section">11.1</span>什么是重做日志？
               </h3>
               <p>恢复操作最关键的结构是<span class="bold">重做日志</span> ，它由两个或多个预分配文件组成，这些文件存储在数据库发生时对数据库所做的所有更改。Oracle数据库的每个实例都有一个关联的重做日志，以便在实例发生故障时保护数据库。
               </p>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-F3679E5E-5153-47D0-B9F9-B3825F519D0B">重做主题</a><br>在多个数据库实例的上下文中讲话时，每个数据库实例的重做日志也称为<span class="italic">重做线程</span> 。
                     </li>
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-4625A35C-EF8A-4A9E-8D19-829C1A665A34">重做日志内容</a><br>重做日志文件用<span class="bold">重做记录</span>填充。
                     </li>
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-4F316F04-8645-4F4B-9406-8978285D2D28">Oracle数据库如何写入重做日志</a><br>数据库的重做日志包含两个或多个重做日志文件。数据库至少需要两个文件，以保证一个文件始终可用于写入而另一个文件正在存档（如果数据库处于<code class="codeph">ARCHIVELOG</code>模式）。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" title="您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。">管理重做日志</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADMIN11303"></a><div class="props_rev_3"><a id="GUID-F3679E5E-5153-47D0-B9F9-B3825F519D0B" name="GUID-F3679E5E-5153-47D0-B9F9-B3825F519D0B"></a><h4 id="ADMIN-GUID-F3679E5E-5153-47D0-B9F9-B3825F519D0B" class="sect4"><span class="enumeration_section">11.1.1</span>重做主题</h4>
                  <div>
                     <p>在多个数据库实例的上下文中讲话时，每个数据库实例的重做日志也称为<span class="italic">重做线程</span> 。
                     </p>
                     <p>在典型配置中，只有一个数据库实例访问Oracle数据库，因此只存在一个线程。但是，在Oracle Real Application Clusters环境中，两个或多个实例同时访问单个数据库，每个实例都有自己的重做线程。每个实例的单独重做线程可避免争用一组重做日志文件，从而消除潜在的性能瓶颈。</p>
                     <p>本章介绍如何在标准单实例Oracle数据库上配置和管理重做日志。在所有讨论和语句示例中，可以假定线程号为1。有关Oracle Real Application Clusters环境中的重做日志组的信息，请参阅“ <a href="../racad/administering-storage-in-oracle-rac.html#RACAD704" target="_blank"><span class="italic">Oracle Real Application Clusters管理和部署指南”</span></a> 。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-79189E7E-7431-49CA-B342-3B971186503A" title="恢复操作最关键的结构是重做日志，它由两个或多个预分配文件组成，这些文件存储在数据库发生时对数据库所做的所有更改。Oracle数据库的每个实例都有一个关联的重做日志，以便在实例发生故障时保护数据库。">什么是重做日志？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN11304"></a><div class="props_rev_3"><a id="GUID-4625A35C-EF8A-4A9E-8D19-829C1A665A34" name="GUID-4625A35C-EF8A-4A9E-8D19-829C1A665A34"></a><h4 id="ADMIN-GUID-4625A35C-EF8A-4A9E-8D19-829C1A665A34" class="sect4"><span class="enumeration_section">11.1.2</span>重做日志内容</h4>
                  <div>
                     <p>重做日志文件用<span class="bold">重做记录</span>填充。
                     </p>
                     <p>重做记录（也称为<span class="bold">重做条目</span> ）由一组<span class="bold">更改向量组成</span> ，每个<span class="bold">更改向量</span>都是对数据库中单个块所做更改的描述。例如，如果更改employee表中的工资值，则会生成一个重做记录，其中包含描述表的数据段块，还原段数据块和还原段的事务表的更改的更改向量。
                     </p>
                     <p>重做条目记录可用于重建对数据库所做的所有更改的数据，包括还原段。因此，重做日志还可以保护回滚数据。使用重做数据恢复数据库时，数据库将读取重做记录中的更改向量，并将更改应用于相关块。</p>
                     <p>重做记录在SGA的重做日志缓冲区中以循环方式缓冲（请参阅<span class="q">“ <a href="managing-the-redo-log.html#GUID-4F316F04-8645-4F4B-9406-8978285D2D28" title="数据库的重做日志包含两个或多个重做日志文件。数据库至少需要两个文件，以保证一个文件始终可用于写入而另一个文件正在存档（如果数据库处于ARCHIVELOG模式）。">Oracle数据库如何写入重做日志</a> ”</span> ），并通过Log Writer（LGWR）数据库后台进程写入其中一个重做日志文件。每当提交事务时，LGWR将事务重做记录从SGA的重做日志缓冲区写入重做日志文件，并分配<span class="bold">系统更改号</span> （SCN）以标识每个已提交事务的重做记录。只有当与给定事务关联的所有重做记录在联机日志中安全地位于磁盘上时，才会通知用户进程已提交事务。
                     </p>
                     <p>在提交相应的事务之前，还可以将重做记录写入重做日志文件。如果重做日志缓冲区填充或其他事务提交，LGWR会将重做日志缓冲区中的所有重做日志条目刷新到重做日志文件，即使某些重做记录可能未提交。如有必要，数据库可以回滚这些更改。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-79189E7E-7431-49CA-B342-3B971186503A" title="恢复操作最关键的结构是重做日志，它由两个或多个预分配文件组成，这些文件存储在数据库发生时对数据库所做的所有更改。Oracle数据库的每个实例都有一个关联的重做日志，以便在实例发生故障时保护数据库。">什么是重做日志？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN13039"></a><a id="ADMIN11305"></a><div class="props_rev_3"><a id="GUID-4F316F04-8645-4F4B-9406-8978285D2D28" name="GUID-4F316F04-8645-4F4B-9406-8978285D2D28"></a><h4 id="ADMIN-GUID-4F316F04-8645-4F4B-9406-8978285D2D28" class="sect4"><span class="enumeration_section">11.1.3</span> Oracle数据库如何写入重做日志</h4>
                  <div>
                     <p>数据库的重做日志包含两个或多个重做日志文件。数据库至少需要两个文件，以保证一个文件始终可用于写入而另一个文件正在存档（如果数据库处于<code class="codeph">ARCHIVELOG</code>模式）。
                     </p>
                     <p>有关详细信息，请参阅<span class="q">“ <a href="managing-archived-redo-log-files.html#GUID-5EE4AC49-E1B2-41A2-BEE7-AA951EAAB2F3" title="您可以通过完成NOARCHIVELOG或ARCHIVELOG模式之间的选择以及指定存档目标等任务来管理存档的重做日志文件。">管理存档的重做日志文件</a> ”</span> 。
                     </p>
                     <p>LGWR以循环方式写入重做日志文件。当前重做日志文件填满时，LGWR开始写入下一个可用的重做日志文件。当最后一个可用的重做日志文件被填满时，LGWR返回第一个重做日志文件并写入它，再次开始循环。<a href="managing-the-redo-log.html#GUID-4F316F04-8645-4F4B-9406-8978285D2D28__I1006202">图11-1</a>说明了重做日志文件的循环写入。每行旁边的数字表示LGWR写入每个重做日志文件的顺序。
                     </p>
                     <p>LGWR可以使用填充的重做日志文件以供重复使用，具体取决于是否启用了存档。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果禁用归档（数据库处于<code class="codeph">NOARCHIVELOG</code>模式），则在将记录的更改写入数据文件后，可以使用填充的重做日志文件。
                           </p>
                        </li>
                        <li>
                           <p>如果启用了归档（数据库处于<code class="codeph">ARCHIVELOG</code>模式），则在将记录的更改写入数据文件<span class="italic">并且</span>文件已归档后，LGWR可以使用填充的重做日志文件。
                           </p>
                        </li>
                     </ul>
                     <div class="figure" id="GUID-4F316F04-8645-4F4B-9406-8978285D2D28__I1006202">
                        <p class="titleinfigure">图11-1 LGWR重用日志文件</p><img src="img/admin054.gif" width="322" alt="下面是图11-1的描述" title="下面是图11-1的描述" longdesc="img_text/admin054.html"><br><a href="img_text/admin054.html">“图11-1 LGWR重用日志文件”的说明</a></div>
                     <!-- class="figure" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-C185CE02-EDFB-4FE7-9C50-B80D8DD5214D">活动（当前）和非活动重做日志文件</a><br>Oracle数据库一次只使用一个重做日志文件来存储从重做日志缓冲区写入的重做记录。LGWR正在写入的重做日志文件称为<span class="bold">当前</span>重做日志文件。
                        </li>
                        <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-F1D9C389-98A8-4733-9539-6B0112EFBB10">日志开关和日志序列号</a><br><span class="bold">日志切换</span>是数据库停止写入一个重做日志文件并开始写入另一个重做日志文件的点。通常，当完整填充当前重做日志文件时会发生日志切换，并且写入必须继续到下一个重做日志文件。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-79189E7E-7431-49CA-B342-3B971186503A" title="恢复操作最关键的结构是重做日志，它由两个或多个预分配文件组成，这些文件存储在数据库发生时对数据库所做的所有更改。Oracle数据库的每个实例都有一个关联的重做日志，以便在实例发生故障时保护数据库。">什么是重做日志？</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADMIN11306"></a><div class="props_rev_3"><a id="GUID-C185CE02-EDFB-4FE7-9C50-B80D8DD5214D" name="GUID-C185CE02-EDFB-4FE7-9C50-B80D8DD5214D"></a><h5 id="ADMIN-GUID-C185CE02-EDFB-4FE7-9C50-B80D8DD5214D" class="sect5"><span class="enumeration_section">11.1.3.1</span>活动（当前）和非活动重做日志文件</h5>
                     <div>
                        <p>Oracle数据库一次只使用一个重做日志文件来存储从重做日志缓冲区写入的重做记录。LGWR正在写入的重做日志文件称为<span class="bold">当前</span>重做日志文件。
                        </p>
                        <p>实例恢复所需的重做日志文件称为<span class="bold">活动</span>重做日志文件。实例恢复不再需要的重做日志文件称为<span class="bold">非活动</span>重做日志文件。
                        </p>
                        <p>如果已启用归档（数据库处于<code class="codeph">ARCHIVELOG</code>模式），则在其中一个归档后台进程（ARC <span class="italic">n</span> ）归档其内容之前，数据库无法重用或覆盖活动的联机日志文件。如果禁用了归档（数据库处于<code class="codeph">NOARCHIVELOG</code>模式），则当最后一个重做日志文件已满时，LGWR将继续覆盖序列中的下一个日志文件。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-4F316F04-8645-4F4B-9406-8978285D2D28" title="数据库的重做日志包含两个或多个重做日志文件。数据库至少需要两个文件，以保证一个文件始终可用于写入而另一个文件正在存档（如果数据库处于ARCHIVELOG模式）。">Oracle数据库如何写入重做日志</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN11307"></a><div class="props_rev_3"><a id="GUID-F1D9C389-98A8-4733-9539-6B0112EFBB10" name="GUID-F1D9C389-98A8-4733-9539-6B0112EFBB10"></a><h5 id="ADMIN-GUID-F1D9C389-98A8-4733-9539-6B0112EFBB10" class="sect5"><span class="enumeration_section">11。1。2。2</span>日志开关和日志序列号</h5>
                     <div>
                        <p><span class="bold">日志切换</span>是数据库停止写入一个重做日志文件并开始写入另一个重做日志文件的点。通常，当完整填充当前重做日志文件时会发生日志切换，并且写入必须继续到下一个重做日志文件。
                        </p>
                        <p>但是，无论当前重做日志文件是否已完全填充，您都可以将日志切换配置为定期发生。您也可以手动强制日志切换。</p>
                        <p>每次发生日志切换并且LGWR开始向其写入时，Oracle数据库会为每个重做日志文件分配一个新的<span class="bold">日志序列号</span> 。当数据库归档重做日志文件时，归档日志会保留其日志序列号。循环使用的重做日志文件将获得下一个可用的日志序列号。
                        </p>
                        <p>每个联机或归档的重做日志文件由其日志序列号唯一标识。在崩溃，实例或介质恢复期间，数据库使用必需的归档和重做日志文件的日志序列号以升序正确应用重做日志文件。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-4F316F04-8645-4F4B-9406-8978285D2D28" title="数据库的重做日志包含两个或多个重做日志文件。数据库至少需要两个文件，以保证一个文件始终可用于写入而另一个文件正在存档（如果数据库处于ARCHIVELOG模式）。">Oracle数据库如何写入重做日志</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="ADMIN11308"></a><div class="props_rev_3"><a id="GUID-D77BCD54-908E-49F8-A80D-C8D3E9465D70" name="GUID-D77BCD54-908E-49F8-A80D-C8D3E9465D70"></a><h3 id="ADMIN-GUID-D77BCD54-908E-49F8-A80D-C8D3E9465D70" class="sect3"><span class="enumeration_section">11.2</span>规划重做日志</h3>
               <p>配置数据库实例重做日志时，可以遵循准则。</p>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-BDEEE3CB-7917-4C73-AB2D-434583D5F838">多路复用重做日志文件</a><br>为了防止涉及重做日志本身的故障，Oracle数据库允许<span class="bold">多路复用</span>重做日志，这意味着重做日志的两个或多个相同副本可以自动保存在不同的位置。
                     </li>
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-79C81D0E-2F5C-48F2-8506-E78FF499D089">将重做日志成员放在不同的磁盘上</a><br>设置多路复用重做日志时，请将组成员放在不同的物理磁盘上。如果单个磁盘发生故障，则只有一个组的一个成员对LGWR不可用，而LGWR仍可访问其他成员，因此该实例可以继续运行。
                     </li>
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-CA8CEB76-518F-42AD-A994-F66030B6DCB0">规划重做日志文件的大小</a><br>设置重做日志文件的大小时，请考虑是否要归档重做日志。应调整重做日志文件的大小，以便可以将填充的组存档到单个脱机存储介质单元（例如磁带或磁盘），并且介质上剩余的空间最少。
                     </li>
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-AC858C69-317E-4193-838D-59F8DDEA1927">规划重做日志文件的块大小</a><br>与数据库块大小（可介于2K和32K之间）不同，重做日志文件始终默认为块大小，该大小等于磁盘的物理扇区大小。从历史上看，这通常是512字节（512B）。
                     </li>
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-11CAAE2C-D46D-4611-8AAB-F9CB941D3934">选择重做日志文件的数量</a><br>确定数据库实例的适当重做日志文件数的最佳方法是测试不同的配置。在不妨碍LGWR编写重做日志信息的情况下，最佳配置具有最少的组。
                     </li>
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-DF2F4A14-2F01-48F5-BD6A-CB468E69338A">控制档案滞后</a><br>您可以强制所有启用的重做日志线程以固定的时间间隔切换其当前日志。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" title="您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。">管理重做日志</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADMIN13040"></a><a id="ADMIN11309"></a><div class="props_rev_3"><a id="GUID-BDEEE3CB-7917-4C73-AB2D-434583D5F838" name="GUID-BDEEE3CB-7917-4C73-AB2D-434583D5F838"></a><h4 id="ADMIN-GUID-BDEEE3CB-7917-4C73-AB2D-434583D5F838" class="sect4"><span class="enumeration_section">11.2.1</span>复用重做日志文件</h4>
                  <div>
                     <p>为了防止涉及重做日志本身的故障，Oracle数据库允许<span class="bold">多路复用</span>重做日志，这意味着重做日志的两个或多个相同副本可以自动保存在不同的位置。
                     </p>
                     <div class="section">
                        <p>为了获得最大收益，这些位置应位于不同的磁盘上。但是，即使重做日志的所有副本都在同一磁盘上，冗余也可以帮助防止I / O错误，文件损坏等。当多路复用重做日志文件时，LGWR会将相同的重做日志信息同时写入多个相同的重做日志文件，从而消除单点重做日志失败。</p>
                        <p>通过创建重做日志文件<span class="italic">组</span>来实现多路复用。<span class="bold">组</span>由重做日志文件及其多路复用副本组成。据说每个相同的副本都是该组的<span class="bold">成员</span> 。每个重做日志组都由一个数字定义，例如组1，组2等。
                        </p>
                        <div class="figure" id="GUID-BDEEE3CB-7917-4C73-AB2D-434583D5F838__i1006259">
                           <p class="titleinfigure">图11-2多路复用重做日志文件</p><img src="img/admin052.gif" width="444" alt="下面是图11-2的描述" title="下面是图11-2的描述" longdesc="img_text/admin052.html"><br><a href="img_text/admin052.html">“图11-2多路复用重做日志文件”的说明</a></div>
                        <!-- class="figure" -->
                        <p>在<a href="managing-the-redo-log.html#GUID-BDEEE3CB-7917-4C73-AB2D-434583D5F838__i1006259">图11-2中</a> ， <code class="codeph">A_LOG1</code>和<code class="codeph">B_LOG1</code>都是组1的成员， <code class="codeph">A_LOG2</code>和<code class="codeph">B_LOG2</code>都是组2的成员，依此类推。组中的每个成员必须具有相同的大小。
                        </p>
                        <p>日志文件组的每个成员同时处于活动状态 - 即由LGWR同时写入 - 由LGWR分配的相同日志序列号指示。在<a href="managing-the-redo-log.html#GUID-BDEEE3CB-7917-4C73-AB2D-434583D5F838__i1006259">图11-2中</a> ，第一个LGWR同时写入<code class="codeph">A_LOG1</code>和<code class="codeph">B_LOG1</code> 。然后它同时写入<code class="codeph">A_LOG2</code>和<code class="codeph">B_LOG2</code> ，依此类推。LGWR永远不会同时写入不同组的成员（例如， <code class="codeph">A_LOG1</code>和<code class="codeph">B_LOG2</code> ）。
                        </p>
                        <div class="infoboxnote" id="GUID-BDEEE3CB-7917-4C73-AB2D-434583D5F838__GUID-398F16D2-C5A5-485E-9DF2-443296CD3682">
                           <p class="notep1">注意：</p>
                           <p>Oracle建议您多路复用重做日志文件。如果需要恢复，丢失日志文件数据可能是灾难性的。请注意，在复用重做日志时，数据库必须增加它执行的I / O量。根据您的配置，这可能会影响整体数据库性能。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-298AD9D5-4825-4C3E-95A8-29FED1B9B6A5">响应重做日志失败</a><br>每当LGWR无法写入组的成员时，数据库会将该成员标记为<code class="codeph">INVALID</code>并将错误消息写入LGWR跟踪文件和数据库警报日志，以指示不可访问文件的问题。
                        </li>
                        <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-70E18DAF-4D20-41DD-B20E-2209DAECD424">法律和非法配置</a><br>在大多数情况下，多路复用重做日志应该是对称的：重做日志的所有组应该具有相同数量的成员。但是，数据库不要求多路复用重做日志是对称的。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-D77BCD54-908E-49F8-A80D-C8D3E9465D70" title="配置数据库实例重做日志时，可以遵循准则。">规划重做日志</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADMIN11310"></a><div class="props_rev_3"><a id="GUID-298AD9D5-4825-4C3E-95A8-29FED1B9B6A5" name="GUID-298AD9D5-4825-4C3E-95A8-29FED1B9B6A5"></a><h5 id="ADMIN-GUID-298AD9D5-4825-4C3E-95A8-29FED1B9B6A5" class="sect5"><span class="enumeration_section">11.2.1.1</span>响应重做日志失败</h5>
                     <div>
                        <p>每当LGWR无法写入组的成员时，数据库会将该成员标记为<code class="codeph">INVALID</code>并将错误消息写入LGWR跟踪文件和数据库警报日志，以指示不可访问文件的问题。
                        </p>
                        <p>当重做日志成员不可用时，LGWR的具体反应取决于缺乏可用性的原因，如下表所示。</p>
                        <div class="tblformal" id="GUID-298AD9D5-4825-4C3E-95A8-29FED1B9B6A5__GUID-877E0605-EF7F-4CD6-BC61-9B03BE39EC34">
                           <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes the action of Log Writer (LGWR) when responding to various conditions. The condition is listed in the left column of the table with the corresponding LGWR action described in the right column." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="33%" id="d132399e983">条件</th>
                                    <th align="left" valign="bottom" width="67%" id="d132399e986">LGWR行动</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d132399e991" headers="d132399e983 ">
                                       <p>LGWR可以成功写入组中的至少一个成员</p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d132399e991 d132399e986 ">
                                       <p>写作正常进行。LGWR写入组的可用成员并忽略不可用的成员。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d132399e998" headers="d132399e983 ">
                                       <p>LGWR无法访问日志交换机中的下一个组，因为该组必须已归档</p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d132399e998 d132399e986 ">
                                       <p>数据库操作暂时停止，直到该组可用或存档为止。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d132399e1005" headers="d132399e983 ">
                                       <p>由于介质故障，LGWR在日志切换时无法访问下一组的所有成员</p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d132399e1005 d132399e986 ">
                                       <p>Oracle数据库返回错误，数据库实例关闭。在这种情况下，您可能需要在丢失重做日志文件的情况下对数据库执行介质恢复。</p>
                                       <p>如果数据库检查点已超出丢失的重做日志，则无需进行介质恢复，因为数据库已将重做日志中记录的数据保存到数据文件中。您只需删除无法访问的重做日志组。如果数据库未归档错误日志，请使用<code class="codeph">ALTER DATABASE CLEAR LOGFILE UNARCHIVED</code>禁用归档，然后才能删除日志。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="33%" id="d132399e1017" headers="d132399e983 ">
                                       <p>当LGWR写信给他们时，一群人的所有成员突然无法进入</p>
                                    </td>
                                    <td align="left" valign="top" width="67%" headers="d132399e1017 d132399e986 ">
                                       <p>Oracle数据库返回错误，数据库实例立即关闭。在这种情况下，您可能需要执行介质恢复。如果包含日志的介质实际上没有丢失 - 例如，如果无意中关闭了日志驱动器 - 可能不需要介质恢复。在这种情况下，您只需要重新打开驱动器并让数据库执行自动实例恢复。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BDEEE3CB-7917-4C73-AB2D-434583D5F838" title="为了防止涉及重做日志本身的故障，Oracle数据库允许多路复用重做日志，这意味着重做日志的两个或多个相同副本可以自动保存在不同的位置。">多路复用重做日志文件</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN13041"></a><a id="ADMIN11311"></a><div class="props_rev_3"><a id="GUID-70E18DAF-4D20-41DD-B20E-2209DAECD424" name="GUID-70E18DAF-4D20-41DD-B20E-2209DAECD424"></a><h5 id="ADMIN-GUID-70E18DAF-4D20-41DD-B20E-2209DAECD424" class="sect5"><span class="enumeration_section">11.2.1.2</span>法律和非法配置</h5>
                     <div>
                        <p>在大多数情况下，多路复用重做日志应该是对称的：重做日志的所有组应该具有相同数量的成员。但是，数据库不要求多路复用重做日志是对称的。</p>
                        <p>例如，一个组只能有一个成员，其他组可以有两个成员。此配置可防止磁盘故障暂时影响某些重做日志成员，但保留其他重做日志成员。</p>
                        <p>实例重做日志的唯一要求是它至少有两个组。<a href="managing-the-redo-log.html#GUID-70E18DAF-4D20-41DD-B20E-2209DAECD424__i1206318">图11-3</a>显示了合法和非法的多路复用日志配置。第二种配置是非法的，因为它只有一个组。
                        </p>
                        <div class="figure" id="GUID-70E18DAF-4D20-41DD-B20E-2209DAECD424__i1206318">
                           <p class="titleinfigure">图11-3合法和非法多路复用重做日志配置</p><img src="img/admin053.gif" width="476" alt="下面是图11-3的描述" title="下面是图11-3的描述" longdesc="img_text/admin053.html"><br><a href="img_text/admin053.html">“图11-3合法和非法多路复用重做日志配置”的说明</a></div>
                        <!-- class="figure" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BDEEE3CB-7917-4C73-AB2D-434583D5F838" title="为了防止涉及重做日志本身的故障，Oracle数据库允许多路复用重做日志，这意味着重做日志的两个或多个相同副本可以自动保存在不同的位置。">多路复用重做日志文件</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="ADMIN11312"></a><div class="props_rev_3"><a id="GUID-79C81D0E-2F5C-48F2-8506-E78FF499D089" name="GUID-79C81D0E-2F5C-48F2-8506-E78FF499D089"></a><h4 id="ADMIN-GUID-79C81D0E-2F5C-48F2-8506-E78FF499D089" class="sect4"><span class="enumeration_section">11.2.2</span>将重做日志成员放在不同的磁盘上</h4>
                  <div>
                     <p>设置多路复用重做日志时，请将组成员放在不同的物理磁盘上。如果单个磁盘发生故障，则只有一个组的一个成员对LGWR不可用，而LGWR仍可访问其他成员，因此该实例可以继续运行。</p>
                     <div class="section">
                        <p>如果归档重做日志，请在磁盘上传播重做日志成员，以消除LGWR和ARC <span class="italic">n</span>后台进程之间的争用。例如，如果您有两组多路复用重做日志成员（ <span class="italic">双工</span>重做日志），请将每个成员放在不同的磁盘上，并将归档目标设置为第五个磁盘。这样做可以避免LGWR（写入成员）和ARC <span class="italic">n</span> （阅读成员）之间的争用。
                        </p>
                        <p>还应将数据文件放在与重做日志文件不同的磁盘上，以减少写入数据块和重做记录时的争用。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-D77BCD54-908E-49F8-A80D-C8D3E9465D70" title="配置数据库实例重做日志时，可以遵循准则。">规划重做日志</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN11313"></a><div class="props_rev_3"><a id="GUID-CA8CEB76-518F-42AD-A994-F66030B6DCB0" name="GUID-CA8CEB76-518F-42AD-A994-F66030B6DCB0"></a><h4 id="ADMIN-GUID-CA8CEB76-518F-42AD-A994-F66030B6DCB0" class="sect4"><span class="enumeration_section">11.2.3</span>规划重做日志文件的大小</h4>
                  <div>
                     <p>设置重做日志文件的大小时，请考虑是否要归档重做日志。应调整重做日志文件的大小，以便可以将填充的组存档到单个脱机存储介质单元（例如磁带或磁盘），并且介质上剩余的空间最少。</p>
                     <div class="section">
                        <p>例如，假设只有一个填充的重做日志组可以放在磁带上，49％的磁带存储容量仍未使用。在这种情况下，最好稍微减小重做日志文件的大小，以便可以在每个磁带上存档两个日志组。</p>
                        <p>同一多路复用重做日志组的所有成员必须具有相同的大小。不同组的成员可以具有不同的大小。但是，在组之间改变文件大小没有任何优势。如果未在日志切换之间设置检查点，请使所有组的大小相同，以保证检查点定期发生。</p>
                        <p>重做日志文件允许的最小大小为4 MB。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-CA8CEB76-518F-42AD-A994-F66030B6DCB0__GUID-1DBFBC0D-31D3-4CA7-A5F7-E24E1982F84F">
                        <p class="notep1">也可以看看：</p>
                        <p>特定于操作系统的Oracle文档。重做日志文件的默认大小取决于操作系统。</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-D77BCD54-908E-49F8-A80D-C8D3E9465D70" title="配置数据库实例重做日志时，可以遵循准则。">规划重做日志</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN12891"></a><div class="props_rev_3"><a id="GUID-AC858C69-317E-4193-838D-59F8DDEA1927" name="GUID-AC858C69-317E-4193-838D-59F8DDEA1927"></a><h4 id="ADMIN-GUID-AC858C69-317E-4193-838D-59F8DDEA1927" class="sect4"><span class="enumeration_section">11.2.4</span>规划重做日志文件的块大小</h4>
                  <div>
                     <p>与数据库块大小（可介于2K和32K之间）不同，重做日志文件始终默认为块大小，该大小等于磁盘的物理扇区大小。从历史上看，这通常是512字节（512B）。</p>
                     <div class="section">
                        <p>一些较新的高容量磁盘驱动器提供4K字节（4K）扇区大小，以增加ECC功能和提高格式效率。大多数Oracle数据库平台都能够检测到更大的扇区大小。然后，数据库会自动在这些磁盘上创建4K块大小的重做日志文件。</p>
                        <p>但是，块大小为4K时，重做浪费会增加。实际上，4K块中的重做浪费量与512B块相比非常重要。您可以通过查看存储在<code class="codeph">V$SESSTAT</code>和<code class="codeph">V$SYSSTAT</code>视图中的统计信息来确定重做浪费的数量。
                        </p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT name，value FROM v $ sysstat WHERE name ='redo wastage'; NAME VALUE -------------------------------- ---------- redo wastage 17941684</pre><p>为避免额外的重做浪费，如果您使用仿真模式磁盘 - 在磁盘接口上模拟512B扇区大小的4K扇区磁盘驱动器 - 您可以通过指定512B块大小覆盖重做日志的默认4K块大小或对于某些平台，1K块大小。但是，当重做日志写入与4K物理扇区的开头不对齐时，会导致性能显着下降。由于4K物理扇区中的八个512B插槽中的七个未对齐，因此通常会发生性能下降。因此，在4K扇区大小的仿真模式磁盘上规划重做日志块大小时，必须评估性能和磁盘浪费之间的权衡。</p>
                        <p>您可以使用<code class="codeph">CREATE</code> <code class="codeph">DATABASE</code> ， <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code>和<code class="codeph">CREATE</code> <code class="codeph">CONTROLFILE</code>语句中的<code class="codeph">BLOCKSIZE</code>关键字指定联机重做日志文件的块大小。在某些平台上，允许的块大小为512和4096。在其他平台上，允许的块大小为1024和4096。
                        </p>
                        <p>以下语句添加块大小为512B的重做日志文件组。 <code class="codeph">BLOCKSIZE</code> <code class="codeph">512</code>子句有效，但512B扇区大小的磁盘不需要。对于4K扇区大小的仿真模式磁盘， <code class="codeph">BLOCKSIZE</code> <code class="codeph">512</code>子句会覆盖默认的4K大小。
                        </p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE orcl ADD LOGFILE GROUP 4（'/ u01/logs/orcl/redo04a.log','/u01/logs/orcl/redo04b.log'）SIZE 100M BLOCKSIZE 512 REUSE;</pre><p>要确定重做日志文件块大小，请运行以下查询：</p><pre class="oac_no_warn" dir="ltr">SQL&gt;从V $ LOG中选择BLOCKSIZE; BLOCKSIZE --------- 512</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-AC858C69-317E-4193-838D-59F8DDEA1927__GUID-939D5C96-F280-4E34-848E-1DD8548D34AE">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">ALTER</code> <code class="codeph">DATABASE</code>命令的信息，请<a href="../sqlrf/ALTER-DATABASE.html#SQLRF00802" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a> 。
                              </p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">V$SESSTAT</code>视图的信息，请参阅<a href="../refrn/V-SESSTAT.html#REFRN30232" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">V$SYSSTAT</code>视图的信息，请<a href="../refrn/V-SYSSTAT.html#REFRN30272" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-D77BCD54-908E-49F8-A80D-C8D3E9465D70" title="配置数据库实例重做日志时，可以遵循准则。">规划重做日志</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN11314"></a><div class="props_rev_3"><a id="GUID-11CAAE2C-D46D-4611-8AAB-F9CB941D3934" name="GUID-11CAAE2C-D46D-4611-8AAB-F9CB941D3934"></a><h4 id="ADMIN-GUID-11CAAE2C-D46D-4611-8AAB-F9CB941D3934" class="sect4"><span class="enumeration_section">11.2.5</span>选择重做日志文件数</h4>
                  <div>
                     <p>确定数据库实例的适当重做日志文件数的最佳方法是测试不同的配置。在不妨碍LGWR编写重做日志信息的情况下，最佳配置具有最少的组。</p>
                     <div class="section">
                        <p>在某些情况下，数据库实例可能只需要两个组。在其他情况下，数据库实例可能需要其他组来保证LGWR始终可以使用回收组。在测试期间，确定当前重做日志配置是否令人满意的最简单方法是检查LGWR跟踪文件和数据库警报日志的内容。如果消息指示LGWR经常因为检查点尚未完成或组尚未归档而必须等待组，请添加组。</p>
                        <p>在设置或更改实例重做日志的配置之前，请考虑可以限制重做日志文件数的参数。以下参数限制了可以添加到数据库的重做日志文件的数量：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">CREATE</code> <code class="codeph">DATABASE</code>语句中使用的<code class="codeph">MAXLOGFILES</code>参数确定每个数据库的最大重做日志文件组数。组值的范围可以从1到<code class="codeph">MAXLOGFILES</code> 。您可以超出<code class="codeph">MAXLOGFILES</code>限制，并根据需要扩展控制文件。如果未为<code class="codeph">CREATE</code> <code class="codeph">DATABASE</code>语句指定<code class="codeph">MAXLOGFILES</code> ，则数据库使用特定于操作系统的默认值。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">CREATE</code> <code class="codeph">DATABASE</code>语句中使用的<code class="codeph">MAXLOGMEMBERS</code>参数确定每个组的最大成员数。与<code class="codeph">MAXLOGFILES</code> ，覆盖此上限的唯一方法是重新创建数据库或控制文件。因此，在创建数据库之前考虑此限制很重要。如果没有为<code class="codeph">CREATE</code> <code class="codeph">DATABASE</code>语句指定<code class="codeph">MAXLOGMEMBERS</code>参数，则数据库使用操作系统默认值。
                              </p>
                              <div class="infoboxnotealso" id="GUID-11CAAE2C-D46D-4611-8AAB-F9CB941D3934__GUID-C901AC4F-8E71-4751-955A-9114927320BE">
                                 <p class="notep1">也可以看看：</p>
                                 <p>您的操作系统特定Oracle文档，用于<code class="codeph">MAXLOGFILES</code>和<code class="codeph">MAXLOGMEMBERS</code>参数的默认值和合法值</p>
                              </div>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-D77BCD54-908E-49F8-A80D-C8D3E9465D70" title="配置数据库实例重做日志时，可以遵循准则。">规划重做日志</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN11315"></a><div class="props_rev_3"><a id="GUID-DF2F4A14-2F01-48F5-BD6A-CB468E69338A" name="GUID-DF2F4A14-2F01-48F5-BD6A-CB468E69338A"></a><h4 id="ADMIN-GUID-DF2F4A14-2F01-48F5-BD6A-CB468E69338A" class="sect4"><span class="enumeration_section">11.2.6</span>控制档案滞后</h4>
                  <div>
                     <p>您可以强制所有启用的重做日志线程以固定的时间间隔切换其当前日志。</p>
                     <p>在主/备用数据库配置中，通过在主站点上归档重做日志然后将它们发送到备用数据库，可以对备用数据库进行更改。备用数据库正在应用的更改可能会滞后于主数据库上发生的更改，因为备用数据库必须等待主数据库重做日志中的更改存档（进入存档的重做日志），然后运到它。要限制此延迟，可以设置<code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数。通过设置此参数，您可以以秒为单位指定延迟可以达到的时间长度。
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-B98F2908-4EB1-42E8-B7A8-B1BAE5BBD13E">设置ARCHIVE_LAG_TARGET初始化参数</a><br>设置<code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数时，会使数据库定期检查实例的当前重做日志，并确定何时切换日志。
                        </li>
                        <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-32967FFB-598B-42D5-8A79-9ED5BC3EDC68">影响ARCHIVE_LAG_TARGET设置的因素</a><br>设置<code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数时，需要考虑几个因素。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-D77BCD54-908E-49F8-A80D-C8D3E9465D70" title="配置数据库实例重做日志时，可以遵循准则。">规划重做日志</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADMIN11316"></a><div class="props_rev_3"><a id="GUID-B98F2908-4EB1-42E8-B7A8-B1BAE5BBD13E" name="GUID-B98F2908-4EB1-42E8-B7A8-B1BAE5BBD13E"></a><h5 id="ADMIN-GUID-B98F2908-4EB1-42E8-B7A8-B1BAE5BBD13E" class="sect5"><span class="enumeration_section">11.2.6.1</span>设置ARCHIVE_LAG_TARGET初始化参数</h5>
                     <div>
                        <p>设置<code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数时，会使数据库定期检查实例的当前重做日志，并确定何时切换日志。
                        </p>
                        <div class="section">
                           <p>如果满足以下条件，则实例将切换日志：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>当前日志是在<span class="italic">n</span>秒前创建的，当前日志的估计存档时间是<span class="italic">m</span>秒（与当前日志中使用的重做块数成比例），其中<span class="italic">n</span> + <span class="italic">m</span>超过<code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数的值。
                                 </p>
                              </li>
                              <li>
                                 <p>当前日志包含重做记录。</p>
                              </li>
                           </ul>
                           <p>在Oracle Real Application Clusters环境中，该实例也会导致<span class="bold"> </span>如果他们落后于其他线程来切换和存档他们的日志。当群集中的一个实例比其他实例更空闲时（例如，当您运行Oracle Real Application Clusters的双节点主/辅助配置时），这可能特别有用。
                           </p>
                           <p><code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数提供数据库当前日志可以跨越多长时间（以秒为单位）的上限。由于还会考虑估计的存档时间，因此这不是确切的日志切换时间。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>设置<code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数。
                                 </p>
                              </li>
                           </ul>
                           <p>以下初始化参数设置将日志切换间隔设置为30分钟（典型值）。</p><pre class="oac_no_warn" dir="ltr">ARCHIVE_LAG_TARGET = 1800</pre><p>值为0将禁用此基于时间的日志切换功能。这是默认设置。</p>
                           <p>即使没有备用数据库，也可以设置<code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数。例如，可以专门设置<code class="codeph">ARCHIVE_LAG_TARGET</code>参数以强制切换和存档日志。
                           </p>
                           <p><code class="codeph">ARCHIVE_LAG_TARGET</code>是一个动态参数，可以使用<code class="codeph">ALTER SYSTEM SET</code>语句进行设置。
                           </p>
                           <div class="infoboxnote" id="GUID-B98F2908-4EB1-42E8-B7A8-B1BAE5BBD13E__GUID-52A55073-257E-4CBE-9561-AAAD3BCD0065">
                              <p class="notep1">注意：</p>
                              <p>必须在Oracle Real Application Clusters环境的所有实例中将<code class="codeph">ARCHIVE_LAG_TARGET</code>参数设置为相同的值。如果不这样做会导致不可预测的行为。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-DF2F4A14-2F01-48F5-BD6A-CB468E69338A" title="您可以强制所有启用的重做日志线程以固定的时间间隔切换其当前日志。">控制存档延迟</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADMIN11317"></a><div class="props_rev_3"><a id="GUID-32967FFB-598B-42D5-8A79-9ED5BC3EDC68" name="GUID-32967FFB-598B-42D5-8A79-9ED5BC3EDC68"></a><h5 id="ADMIN-GUID-32967FFB-598B-42D5-8A79-9ED5BC3EDC68" class="sect5"><span class="enumeration_section">11.2.6.2</span>影响ARCHIVE_LAG_TARGET设置的因素</h5>
                     <div>
                        <p>设置<code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数时，需要考虑几个因素。
                        </p>
                        <p>在确定是否要设置<code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数以及确定此参数的值时，请考虑以下因素。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>切换（以及归档）日志的开销</p>
                           </li>
                           <li>
                              <p>由于日志已满的情况，正常日志切换的频率</p>
                           </li>
                           <li>
                              <p>备用数据库中允许多少重做丢失</p>
                           </li>
                        </ul>
                        <p>如果自然日志切换比指定的间隔更频繁地发生，则设置<code class="codeph">ARCHIVE_LAG_TARGET</code>可能不是非常有用。然而，在重做生成速度不规则的情况下，该间隔确实为每个当前日志覆盖的时间范围提供上限。
                        </p>
                        <p>如果<code class="codeph">ARCHIVE_LAG_TARGET</code>初始化参数设置为非常低的值，则可能会对性能产生负面影响。这可能会导致频繁的日志切换。将参数设置为合理的值，以免降低主数据库的性能。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-DF2F4A14-2F01-48F5-BD6A-CB468E69338A" title="您可以强制所有启用的重做日志线程以固定的时间间隔切换其当前日志。">控制存档延迟</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="ADMIN11318"></a><div class="props_rev_3"><a id="GUID-081AE57B-A821-4F26-97B2-4B141FDB3946" name="GUID-081AE57B-A821-4F26-97B2-4B141FDB3946"></a><h3 id="ADMIN-GUID-081AE57B-A821-4F26-97B2-4B141FDB3946" class="sect3"><span class="enumeration_section">11.3</span>创建重做日志组和成员</h3>
               <div>
                  <p>规划数据库的重做日志，并在数据库创建期间创建所有必需的组和重做日志文件的成员。但是，您可能希望创建其他组或成员。例如，将组添加到重做日志可以纠正重做日志组可用性问题。</p>
                  <p>要创建新的重做日志组和成员，您必须具有<code class="codeph">ALTER DATABASE</code>系统特权。数据库最多可包含<code class="codeph">MAXLOGFILES</code>组。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-3CEE7E42-F1C2-49B1-B15C-35F3BA921176">创建重做日志组</a><br>要创建一组新的重做日志文件，请使用带有<code class="codeph">ADD LOGFILE</code>子句的SQL语句<code class="codeph">ALTER DATABASE</code> 。
                     </li>
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-8402EE7E-21E6-4866-9D8B-66C87B5BA8F2">创建重做日志成员</a><br>在某些情况下，可能没有必要创建一组完整的重做日志文件。组可能已存在，但不完整，因为组中的一个或多个成员被删除（例如，由于磁盘故障）。在这种情况下，您可以将新成员添加到现有组。
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-081AE57B-A821-4F26-97B2-4B141FDB3946__GUID-1B9F224C-CF0C-47B8-8944-85452E876B7B">
                     <p class="notep1">也可以看看：</p>
                     <p>有关<code class="codeph">ALTER DATABASE</code>语句的完整说明，请<a href="../sqlrf/ALTER-DATABASE.html#SQLRF00802" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" title="您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。">管理重做日志</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADMIN11319"></a><div class="props_rev_3"><a id="GUID-3CEE7E42-F1C2-49B1-B15C-35F3BA921176" name="GUID-3CEE7E42-F1C2-49B1-B15C-35F3BA921176"></a><h4 id="ADMIN-GUID-3CEE7E42-F1C2-49B1-B15C-35F3BA921176" class="sect4"><span class="enumeration_section">11.3.1</span>创建重做日志组</h4>
                  <div>
                     <p>要创建一组新的重做日志文件，请使用带有<code class="codeph">ADD LOGFILE</code>子句的SQL语句<code class="codeph">ALTER DATABASE</code> 。
                     </p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<code class="codeph">ADD LOGFILE</code>子句运行SQL语句<code class="codeph">ALTER DATABASE</code> 。
                              </p>
                           </li>
                        </ul>
                        <p>例如，以下语句将一组新的重做日志添加到数据库：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE添加LOGFILE（'/ orcle / dbs / log1c.rdo'，'/ oracle / dbs / log2c.rdo'）SIZE 100M;</pre><div class="infoboxnote" id="GUID-3CEE7E42-F1C2-49B1-B15C-35F3BA921176__GUID-CA775AF7-46C3-4CE0-998D-8C7ADD73437A">
                           <p class="notep1">注意：</p>
                           <p>提供新日志成员的完整路径名以指定其位置。否则，将在数据库服务器的默认目录或当前目录中创建文件，具体取决于您的操作系统。</p>
                        </div>
                        <p>您还可以使用<code class="codeph">GROUP</code>子句指定标识组的编号：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE添加LOGFILE GROUP 10（'/ orcle / dbs / log1c.rdo'，'/ oracle / dbs / log2c.rdo'）SIZE 100M BLOCKSIZE 512;</pre><p>使用组号可以更轻松地管理重做日志组。但是，组编号必须介于1和<code class="codeph">MAXLOGFILES</code>之间。不要跳过重做日志文件组编号（即，不要对组10,20,30等编号），否则将占用数据库控制文件中不必要的空间。
                        </p>
                        <p>在前面的语句中， <code class="codeph">BLOCKSIZE</code>子句是可选的。有关详细信息，请参阅<span class="q">“ <a href="managing-the-redo-log.html#GUID-AC858C69-317E-4193-838D-59F8DDEA1927" title="与数据库块大小（可介于2K和32K之间）不同，重做日志文件始终默认为块大小，该大小等于磁盘的物理扇区大小。从历史上看，这通常是512字节（512B）。">规划重做日志文件的块大小</a> ”</span> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-081AE57B-A821-4F26-97B2-4B141FDB3946" title="规划数据库的重做日志，并在数据库创建期间创建所有必需的组和重做日志文件的成员。但是，您可能希望创建其他组或成员。例如，将组添加到重做日志可以纠正重做日志组可用性问题。">创建重做日志组和成员</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN11320"></a><div class="props_rev_3"><a id="GUID-8402EE7E-21E6-4866-9D8B-66C87B5BA8F2" name="GUID-8402EE7E-21E6-4866-9D8B-66C87B5BA8F2"></a><h4 id="ADMIN-GUID-8402EE7E-21E6-4866-9D8B-66C87B5BA8F2" class="sect4"><span class="enumeration_section">11.3.2</span>创建重做日志成员</h4>
                  <div>
                     <p>在某些情况下，可能没有必要创建一组完整的重做日志文件。组可能已存在，但不完整，因为组中的一个或多个成员被删除（例如，由于磁盘故障）。在这种情况下，您可以将新成员添加到现有组。</p>
                     <div class="section">
                        <p></p>
                        <p>要为现有组创建新的重做日志成员，请执行以下操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<code class="codeph">ADD LOGFILE MEMBER</code>子句运行SQL语句<code class="codeph">ALTER DATABASE</code> 。
                              </p>
                           </li>
                        </ul>
                        <p>例如，以下语句将新的重做日志成员添加到重做日志组编号2：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE将LOGFILE成员'/oracle/dbs/log2b.rdo'添加到组2;</pre><p>请注意，必须指定文件名，但不必指定大小。新成员的大小取决于组中现有成员的大小。</p>
                        <p>使用<code class="codeph">ALTER DATABASE</code>语句时，您也可以通过在<code class="codeph">TO</code>子句中指定组的所有其他成员来标识目标组，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE添加LOGFILE成员'/oracle/dbs/log2c.rdo'TO（'/ orcle / dbs / log2a.rdo'，'/ oracle / dbs / log2b.rdo'）;</pre><div class="infoboxnote" id="GUID-8402EE7E-21E6-4866-9D8B-66C87B5BA8F2__GUID-FB8FC7B6-B6D9-4BE4-93C2-57F8C72E4C87">
                           <p class="notep1">注意：</p>
                           <p>完全指定新日志成员的文件名，以指示应在何处创建操作系统文件。否则，将根据您的操作系统在数据库服务器的默认目录或当前目录中创建文件。您还可能注意到新日志成员的状态显示为<code class="codeph">INVALID</code> 。这是正常的，它在第一次使用时会变为活动状态（空白）。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-081AE57B-A821-4F26-97B2-4B141FDB3946" title="规划数据库的重做日志，并在数据库创建期间创建所有必需的组和重做日志文件的成员。但是，您可能希望创建其他组或成员。例如，将组添加到重做日志可以纠正重做日志组可用性问题。">创建重做日志组和成员</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADMIN12596"></a><a id="ADMIN11321"></a><div class="props_rev_3"><a id="GUID-F593023B-3071-4776-95F2-9B8B6C6E670B" name="GUID-F593023B-3071-4776-95F2-9B8B6C6E670B"></a><h3 id="ADMIN-GUID-F593023B-3071-4776-95F2-9B8B6C6E670B" class="sect3"><span class="enumeration_section">11.4</span>重定位和重命名重做日志成员</h3>
               <div>
                  <p>您可以使用操作系统命令重定位重做日志，然后使用<code class="codeph">ALTER DATABASE</code>语句使数据库知道其新名称（位置）。
                  </p>
                  <div class="section">
                     <p>例如，如果要删除当前用于某些重做日志文件的磁盘，或者数据文件和多个重做日志文件存储在同一磁盘上并且应该分开以减少争用，则此过程是必需的。</p>
                     <p>要重命名重做日志成员，您必须具有<code class="codeph">ALTER DATABASE</code>系统特权。此外，您可能还需要操作系统权限才能将文件复制到所需的位置以及打开和备份数据库的权限。
                     </p>
                     <p>在重新定位重做日志或对数据库进行任何其他结构更改之前，请在执行操作时遇到问题时完全备份数据库。作为预防措施，在重命名或重定位一组重做日志文件后，立即备份数据库控制文件。</p>
                     <p>使用以下步骤重定位重做日志。用于说明这些步骤的示例假定：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>日志文件位于两个磁盘上： <code class="codeph">diska</code>和<code class="codeph">diskb</code> 。
                           </p>
                        </li>
                        <li>
                           <p>重做日志是双工的：一个组由成员<code class="codeph">/diska/logs/log1a.rdo</code>和<code class="codeph">/diskb/logs/log1b.rdo</code>组成，第二个组由成员<code class="codeph">/diska/logs/log2a.rdo</code>和<code class="codeph">/diskb/logs/log2b.rdo</code> 。
                           </p>
                        </li>
                        <li>
                           <p>位于<code class="codeph">diska</code>上的重做日志文件必须重定位到<code class="codeph">diskc</code> 。新文件名将反映新位置： <code class="codeph">/diskc/logs/log1c.rdo</code>和<code class="codeph">/diskc/logs/log2c.rdo</code> 。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>要重命名重做日志成员：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p></p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>关闭数据库。</span><div><pre class="oac_no_warn" dir="ltr">关掉</pre></div>
                     </li>
                     <li class="stepexpand"><span>将重做日志文件复制到新位置。</span><div>
                           <p>必须使用相应的操作系统命令复制操作系统文件，例如重做日志成员。有关复制文件的详细信息，请参阅操作系统特定的文档。</p>
                           <div class="infoboxnote" id="GUID-F593023B-3071-4776-95F2-9B8B6C6E670B__GUID-B4A61C30-9FA9-41B3-B653-F8AD0617126C">
                              <p class="notep1">注意：</p>
                              <p>您可以执行操作系统命令来复制文件（或执行其他操作系统命令），而无需使用<code class="codeph">HOST</code>命令退出SQL * Plus。某些操作系统允许您使用字符代替<code class="codeph">HOST</code>一词。例如，您可以使用感叹号（！）在UNIX中。</p>
                           </div>
                           <p>以下示例使用操作系统命令（UNIX）将重做日志成员移动到新位置：</p><pre class="oac_no_warn" dir="ltr">mv /diska/logs/log1a.rdo /diskc/logs/log1c.rdo mv /diska/logs/log2a.rdo /diskc/logs/log2c.rdo</pre></div>
                     </li>
                     <li class="stepexpand"><span>启动数据库，mount，但不要打开它。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT / as SYSDBA STARTUP MOUNT</pre></div>
                     </li>
                     <li class="stepexpand"><span>重命名重做日志成员。</span><div>
                           <p>使用带有<code class="codeph">RENAME FILE</code>子句的<code class="codeph">ALTER DATABASE</code>语句重命名数据库重做日志文件。
                           </p><pre class="oac_no_warn" dir="ltr">更改数据库重命名文件'/diska/logs/log1a.rdo'，'/ diska / logs / log2a.rdo'TO'/diskc /logs / log1c.rdo'，'/ diskc / logs / log2c.rdo';</pre></div>
                     </li>
                     <li class="stepexpand"><span>打开数据库以进行正常操作。</span><div>
                           <p>打开数据库时，重做日志更改将生效。</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE OPEN;</pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" title="您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。">管理重做日志</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN11322"></a><div class="props_rev_3"><a id="GUID-54E1DA00-B999-4463-B868-85ADDC108D5D" name="GUID-54E1DA00-B999-4463-B868-85ADDC108D5D"></a><h3 id="ADMIN-GUID-54E1DA00-B999-4463-B868-85ADDC108D5D" class="sect3"><span class="enumeration_section">11.5</span>删除重做日志组和成员</h3>
               <div>
                  <p>在某些情况下，您可能希望删除整组重做日志成员。</p>
                  <p>例如，您希望减少实例重做日志中的组数。在不同的情况下，您可能希望删除一个或多个特定的重做日志成员。例如，如果发生磁盘故障，您可能需要删除故障磁盘上的所有重做日志文件，以便数据库不会尝试写入不可访问的文件。在其他情况下，特定的重做日志文件变得不必要。例如，文件可能存储在不适当的位置。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-FDF5B2DF-90AE-4668-A271-98B21179058F">删除日志组</a><br>您可以删除重做日志组。
                     </li>
                     <li class="ulchildlink"><a href="managing-the-redo-log.html#GUID-31B302F1-8B81-4A2C-AF35-A84FB6216820">删除重做日志成员</a><br>您可以删除重做日志成员。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" title="您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。">管理重做日志</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADMIN11323"></a><div class="props_rev_3"><a id="GUID-FDF5B2DF-90AE-4668-A271-98B21179058F" name="GUID-FDF5B2DF-90AE-4668-A271-98B21179058F"></a><h4 id="ADMIN-GUID-FDF5B2DF-90AE-4668-A271-98B21179058F" class="sect4"><span class="enumeration_section">11.5.1</span>删除日志组</h4>
                  <div>
                     <p>您可以删除重做日志组。</p>
                     <div class="section">
                        <p>要删除重做日志组，您必须具有<code class="codeph">ALTER DATABASE</code>系统特权。在删除重做日志组之前，请考虑以下限制和预防措施：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>无论组中的成员数是多少，实例都需要至少两组重做日志文件。（一个小组由一个或多个成员组成。）</p>
                           </li>
                           <li>
                              <p>只有在重做日志组处于非活动状态时，才能删除它。如果必须删除当前组，则首先强制执行日志切换。</p>
                           </li>
                           <li>
                              <p>在删除之前，请确保存档重做日志组（如果已启用存档）。要查看是否发生了这种情况，请使用<code class="codeph">V$LOG</code>视图。
                              </p><pre class="oac_no_warn" dir="ltr">SELECT GROUP＃，ARCHIVED，STATUS FROM V $ LOG; GROUP＃ARC STATUS --------- --- ---------------- 1 YES ACTIVE 2 NO CURRENT 3 YES INACTIVE 4 YES INACTIVE</pre></li>
                        </ul>
                        <p>要删除重做日志组：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<code class="codeph">DROP LOGFILE</code>子句运行SQL语句<code class="codeph">ALTER DATABASE</code> 。
                              </p>
                           </li>
                        </ul>
                        <p>例如，以下语句删除重做日志组编号3：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE DROP LOGFILE GROUP 3;</pre><p>从数据库中删除重做日志组时，如果未使用Oracle托管文件功能，则不会从磁盘中删除操作系统文件。而是更新相关数据库的控制文件以从数据库结构中删除组的成员。删除重做日志组后，请确保已成功完成删除，然后使用相应的操作系统命令删除已删除的重做日志文件。</p>
                        <p>使用Oracle Managed Files时，系统会自动为您清理操作系统文件。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-54E1DA00-B999-4463-B868-85ADDC108D5D" title="在某些情况下，您可能希望删除整组重做日志成员。">删除重做日志组和成员</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADMIN11324"></a><div class="props_rev_3"><a id="GUID-31B302F1-8B81-4A2C-AF35-A84FB6216820" name="GUID-31B302F1-8B81-4A2C-AF35-A84FB6216820"></a><h4 id="ADMIN-GUID-31B302F1-8B81-4A2C-AF35-A84FB6216820" class="sect4"><span class="enumeration_section">11.5.2</span>删除重做日志成员</h4>
                  <div>
                     <p>您可以删除重做日志成员。</p>
                     <div class="section">
                        <p>要删除重做日志成员，您必须具有<code class="codeph">ALTER DATABASE</code>系统特权。删除单个重做日志成员之前，请考虑以下限制和注意事项：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>允许删除重做日志文件，以便多路复用重做日志暂时不对称。例如，如果使用双工组重做日志文件，则可以删除一个组中的一个成员，即使所有其他组各有两个成员。但是，您应该立即纠正这种情况，以便所有组至少有两个成员，从而消除重做日志可能出现的单点故障。</p>
                           </li>
                           <li>
                              <p>无论组中的成员数是多少，实例始终至少需要两个有效的重做日志文件组。（一个小组由一个或多个成员组成。）如果要删除的成员是该组的最后一个有效成员，则在其他成员生效之前，您不能删除该成员。要查看重做日志文件状态，请使用<code class="codeph">V$LOGFILE</code>视图。如果数据库无法访问重做日志文件，则该日志文件将变为<code class="codeph">INVALID</code> 。如果数据库怀疑它不完整或正确，它将变为<code class="codeph">STALE</code> 。过时的日志文件在其下一次成为活动组时再次变为有效。
                              </p>
                           </li>
                           <li>
                              <p>仅当重做日志成员<span class="italic">不</span>属于活动组或当前组时，才可以删除该日志成员。要删除活动组的成员，请首先强制执行日志切换。
                              </p>
                           </li>
                           <li>
                              <p>在删除成员之前，请确保归档重做日志成员所属的组（如果已启用存档）。要查看是否发生了这种情况，请使用<code class="codeph">V$LOG</code>视图。
                              </p>
                           </li>
                        </ul>
                        <p>要删除特定的非活动重做日志成员：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用<code class="codeph">DROP LOGFILE MEMBER</code>子句运行<code class="codeph">ALTER DATABASE</code>语句。
                              </p>
                           </li>
                        </ul>
                        <p>以下语句删除了重做日志<code class="codeph">/oracle/dbs/log3c.rdo</code> ：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE DROP LOGFILE MEMBER'/oracle/dbs/log3c.rdo';</pre><p>从数据库中删除重做日志成员时，不会从磁盘中删除操作系统文件。而是更新关联数据库的控制文件以从数据库结构中删除该成员。删除重做日志文件后，请确保已成功完成删除，然后使用相应的操作系统命令删除已删除的重做日志文件。</p>
                        <p>要删除活动组的成员，必须先强制执行日志切换。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-54E1DA00-B999-4463-B868-85ADDC108D5D" title="在某些情况下，您可能希望删除整组重做日志成员。">删除重做日志组和成员</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADMIN11325"></a><div class="props_rev_3"><a id="GUID-6A7FB6CB-AF29-40BC-BDB3-B514C502B2F6" name="GUID-6A7FB6CB-AF29-40BC-BDB3-B514C502B2F6"></a><h3 id="ADMIN-GUID-6A7FB6CB-AF29-40BC-BDB3-B514C502B2F6" class="sect3"><span class="enumeration_section">11.6</span>强制日志切换</h3>
               <div>
                  <p>当LGWR停止写入一个重做日志组并开始写入另一个时，会发生日志切换。默认情况下，当前重做日志文件组填充时会自动进行日志切换。</p>
                  <div class="section">
                     <p>您可以强制日志切换使当前活动组处于非活动状态，并可用于重做日志维护操作。例如，您要删除当前活动的组，但在该组处于非活动状态之前无法执行此操作。如果必须在完全填充组成员之前的特定时间归档当前活动组，则可能还需要强制执行日志切换。此选项在具有大量重做日志文件的配置中非常有用，这些文件需要很长时间才能填充。</p>
                     <p>要强制执行日志切换，您必须具有<code class="codeph">ALTER SYSTEM</code>权限。
                     </p>
                     <p>要强制日志切换，</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用<code class="codeph">SWITCH LOGFILE</code>子句运行<code class="codeph">ALTER SYSTEM</code>语句。
                           </p>
                        </li>
                     </ul>
                     <p>例如，以下语句强制执行日志切换：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SWITCH LOGFILE;</pre></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" title="您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。">管理重做日志</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN11326"></a><div class="props_rev_3"><a id="GUID-E8BC43CA-D047-4AEF-AB4A-2566BE44D73A" name="GUID-E8BC43CA-D047-4AEF-AB4A-2566BE44D73A"></a><h3 id="ADMIN-GUID-E8BC43CA-D047-4AEF-AB4A-2566BE44D73A" class="sect3"><span class="enumeration_section">11.7</span>验证重做日志文件中的块</h3>
               <div>
                  <p>您可以将数据库配置为使用校验和来验证重做日志文件中的块。</p>
                  <div class="section">
                     <p>如果将初始化参数<code class="codeph">DB_BLOCK_CHECKSUM</code>设置为<code class="codeph">TYPICAL</code> （缺省值），则数据库会在每个数据库块写入磁盘时计算每个数据库块的校验和，包括每个重做日志块在写入当前日志时。校验和存储在块的标题中。
                     </p>
                     <p>Oracle数据库使用校验和来检测重做日志块中的损坏。在恢复期间从存档日志中读取块时以及将块写入存档日志文件时，数据库将验证重做日志块。如果检测到损坏，则会引发错误并将其写入警报日志。</p>
                     <p>如果在尝试存档时在重做日志块中检测到损坏，系统将尝试从组中的另一个成员读取该块。如果该块在重做日志组的所有成员中都已损坏，则无法继续存档。</p>
                     <p>可以使用<code class="codeph">ALTER SYSTEM</code>语句动态更改<code class="codeph">DB_BLOCK_CHECKSUM</code>参数的值。
                     </p>
                     <div class="infoboxnote" id="GUID-E8BC43CA-D047-4AEF-AB4A-2566BE44D73A__GUID-EBB19B3C-1CB1-466F-8DC7-5BB6BAEBCBCF">
                        <p class="notep1">注意：</p>
                        <p>启用<code class="codeph">DB_BLOCK_CHECKSUM</code> ，数据库性能会有轻微的开销和降低。监视数据库性能，以确定使用数据块校验和检测损坏的好处是否超过性能影响。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-E8BC43CA-D047-4AEF-AB4A-2566BE44D73A__GUID-39377A4B-92ED-4C75-8D1B-326682B01655">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../refrn/DB_BLOCK_CHECKSUM.html#REFRN10030" target="_blank"><span class="italic">Oracle Database Reference，</span></a>用于描述<code class="codeph">DB_BLOCK_CHECKSUM</code>初始化参数</p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" title="您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。">管理重做日志</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN11327"></a><div class="props_rev_3"><a id="GUID-AA0EBC79-6670-409E-AED1-666FCEF3F25F" name="GUID-AA0EBC79-6670-409E-AED1-666FCEF3F25F"></a><h3 id="ADMIN-GUID-AA0EBC79-6670-409E-AED1-666FCEF3F25F" class="sect3"><span class="enumeration_section">11.8</span>清除重做日志文件</h3>
               <div>
                  <p>数据库打开时，重做日志文件可能会损坏，并最终停止数据库活动，因为归档无法继续。</p>
                  <div class="section">
                     <p>在这种情况下，要在不关闭数据库的情况下重新初始化文件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>运行<code class="codeph">ALTER DATABASE CLEAR LOGFILE</code> SQL语句。
                           </p>
                        </li>
                     </ul>
                     <p>以下语句清除重做日志组编号3中的日志文件：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE CLEAR LOGFILE GROUP 3;</pre><p>此语句克服了两种情况：无法删除重做日志：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果只有两个日志组</p>
                        </li>
                        <li>
                           <p>损坏的重做日志文件属于当前组</p>
                        </li>
                     </ul>
                     <p>如果尚未归档损坏的重做日志文件，请在语句中使用<code class="codeph">UNARCHIVED</code>关键字。
                     </p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE CLEAR UNARCHIVED LOGFILE GROUP 3;</pre><p>此语句清除损坏的重做日志并避免存档它们。已清除的重做日志即使未归档也可供使用。</p>
                     <p>如果清除恢复备份所需的日志文件，则无法再从该备份恢复。数据库在警报日志中写入一条消息，描述无法恢复的备份。</p>
                     <div class="infoboxnote" id="GUID-AA0EBC79-6670-409E-AED1-666FCEF3F25F__GUID-DCB6ED22-DF4F-46E9-A99A-192D7ECF60A9">
                        <p class="notep1">注意：</p>
                        <p>如果清除未归档的重做日志文件，则应该对数据库进行另一次备份。</p>
                     </div>
                     <p>要清除使脱机表空间联机所需的未归档重做日志，请使用<code class="codeph">ALTER DATABASE CLEAR LOGFILE</code>语句中的<code class="codeph">UNRECOVERABLE DATAFILE</code>子句。
                     </p>
                     <p>如果清除使脱机表空间联机所需的重做日志，则无法再次使表空间联机。您必须删除表空间或执行不完整的恢复。请注意，正常脱机的表空间不需要恢复。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" title="您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。">管理重做日志</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-27E9B63B-03E4-43E5-BA59-AB0EDDDE5CE6" name="GUID-27E9B63B-03E4-43E5-BA59-AB0EDDDE5CE6"></a><h3 id="ADMIN-GUID-27E9B63B-03E4-43E5-BA59-AB0EDDDE5CE6" class="sect3"><span class="enumeration_section">11.9</span> FORCE LOGGING设置的优先顺序</h3>
               <div>
                  <p>您可以在各个级别设置<code class="codeph">FORCE LOGGING</code>和<code class="codeph">NOLOGGING</code> ，例如数据库，可插拔数据库（PDB），表空间或数据库对象。当<code class="codeph">FORCE LOGGING</code>设置为一个或多个级别时， <code class="codeph">FORCE LOGGING</code>设置的优先级决定了重做日志中记录的内容。
                  </p>
                  <p>您可以将多租户容器数据库（CDB）和非CDB放入<code class="codeph">FORCE LOGGING</code>模式。在此模式下，数据库会记录数据库中的所有更改，但临时表空间和临时段的更改除外。此设置优先于您为各个表空间指定的任何<code class="codeph">NOLOGGING</code>或<code class="codeph">FORCE LOGGING</code>设置，并且与您为各个数据库对象指定的任何<code class="codeph">NOLOGGING</code>设置无关。
                  </p>
                  <p>您还可以将表空间放入<code class="codeph">FORCE LOGGING</code>模式。数据库记录对表空间中所有对象的所有更改，但对临时段的更改除外，从而覆盖单个对象的任何<code class="codeph">NOLOGGING</code>设置。
                  </p>
                  <p>此外，您可以使用<span class="italic">logging_clause</span>为各种类型的数据库对象指定日志记录属性，以确定是否将在重做日志文件（ <code class="codeph">LOGGING</code> ）中记录某些DML操作（ <code class="codeph">NOLOGGING</code> ）。您可以为以下类型的数据库对象指定日志记录属性：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>表</p>
                     </li>
                     <li>
                        <p>索引</p>
                     </li>
                     <li>
                        <p>物化观点</p>
                     </li>
                  </ul>
                  <p>下表总结了每个级别的日志记录设置，并显示了非CDB的结果。</p>
                  <div class="tblformal" id="GUID-27E9B63B-03E4-43E5-BA59-AB0EDDDE5CE6__GUID-9ABE160E-DDF6-4D1B-9CFF-ADD7B82C49B2">
                     <p class="titleintable">表11-1非CDB的FORCE LOGGING设置的优先级</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="非CDB的FORCE LOGGING设置的优先顺序" border="1" summary="This table describes the result of FORCE LOGGING, NOLOGGING, and LOGGING attributes set at various levels for a non-CDB." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" id="d132399e2847">数据库</th>
                              <th align="left" valign="bottom" id="d132399e2849">表空间</th>
                              <th align="left" valign="bottom" id="d132399e2851">数据库对象LOGGING属性</th>
                              <th align="left" valign="bottom" id="d132399e2853">结果</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d132399e2857" headers="d132399e2847 "><code class="codeph">强制记录</code></td>
                              <td align="left" valign="top" headers="d132399e2857 d132399e2849 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2857 d132399e2851 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2857 d132399e2853 ">记录</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d132399e2867" headers="d132399e2847 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2867 d132399e2849 "><code class="codeph">强制记录</code></td>
                              <td align="left" valign="top" headers="d132399e2867 d132399e2851 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2867 d132399e2853 ">记录</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d132399e2878" headers="d132399e2847 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2878 d132399e2849 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2878 d132399e2851 "><code class="codeph">测井</code></td>
                              <td align="left" valign="top" headers="d132399e2878 d132399e2853 ">记录</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d132399e2890" headers="d132399e2847 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2890 d132399e2849 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2890 d132399e2851 "><code class="codeph">NOLOGGING</code></td>
                              <td align="left" valign="top" headers="d132399e2890 d132399e2853 ">没有记录</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>下表总结了每个级别的日志记录设置，并显示了CDB的结果。</p>
                  <div class="tblformal" id="GUID-27E9B63B-03E4-43E5-BA59-AB0EDDDE5CE6__GUID-9692C7A0-4C20-42E3-962E-D04531ADA431">
                     <p class="titleintable">表11-2 CDB的FORCE LOGGING设置的优先级</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="CDB的FORCE LOGGING设置的优先顺序" border="1" summary="This table describes the result of FORCE LOGGING, NOLOGGING, and LOGGING attributes set at various levels for a CDB." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" id="d132399e2916">CDB</th>
                              <th align="left" valign="bottom" id="d132399e2918">PDB</th>
                              <th align="left" valign="bottom" id="d132399e2920">表空间</th>
                              <th align="left" valign="bottom" id="d132399e2922">数据库对象LOGGING属性</th>
                              <th align="left" valign="bottom" id="d132399e2924">结果</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d132399e2928" headers="d132399e2916 "><code class="codeph">强制记录</code></td>
                              <td align="left" valign="top" headers="d132399e2928 d132399e2918 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2928 d132399e2920 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2928 d132399e2922 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2928 d132399e2924 ">记录</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d132399e2940" headers="d132399e2916 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2940 d132399e2918 "><code class="codeph">ENABLE FORCE LOGGING</code></td>
                              <td align="left" valign="top" headers="d132399e2940 d132399e2920 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2940 d132399e2922 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2940 d132399e2924 ">记录</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d132399e2953" headers="d132399e2916 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2953 d132399e2918 "><code class="codeph">启用力量NOLOGGING</code></td>
                              <td align="left" valign="top" headers="d132399e2953 d132399e2920 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2953 d132399e2922 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2953 d132399e2924 ">没有记录</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d132399e2966" headers="d132399e2916 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2966 d132399e2918 "><code class="codeph">DISABLE FORCE [NO]LOGGING</code> （无设置）</td>
                              <td align="left" valign="top" headers="d132399e2966 d132399e2920 "><code class="codeph">强制记录</code></td>
                              <td align="left" valign="top" headers="d132399e2966 d132399e2922 ">忽视</td>
                              <td align="left" valign="top" headers="d132399e2966 d132399e2924 ">记录</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d132399e2981" headers="d132399e2916 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2981 d132399e2918 "><code class="codeph">DISABLE FORCE [NO]LOGGING</code> （无设置）</td>
                              <td align="left" valign="top" headers="d132399e2981 d132399e2920 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2981 d132399e2922 "><code class="codeph">测井</code></td>
                              <td align="left" valign="top" headers="d132399e2981 d132399e2924 ">记录</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" id="d132399e2997" headers="d132399e2916 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2997 d132399e2918 "><code class="codeph">DISABLE FORCE [NO]LOGGING</code> （无设置）</td>
                              <td align="left" valign="top" headers="d132399e2997 d132399e2920 "><code class="codeph">没有力量记录</code></td>
                              <td align="left" valign="top" headers="d132399e2997 d132399e2922 "><code class="codeph">NOLOGGING</code></td>
                              <td align="left" valign="top" headers="d132399e2997 d132399e2924 ">没有记录</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" title="您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。">管理重做日志</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN11328"></a><div class="props_rev_3"><a id="GUID-05FCB15E-BE40-40EB-B756-4D280461AD7E" name="GUID-05FCB15E-BE40-40EB-B756-4D280461AD7E"></a><h3 id="ADMIN-GUID-05FCB15E-BE40-40EB-B756-4D280461AD7E" class="sect3"><span class="enumeration_section">11.10</span>重做日志数据字典视图</h3>
               <div>
                  <p>您可以查询一组数据字典视图，以获取有关重做日志的信息。</p>
                  <div class="section">
                     <p>以下视图提供有关重做日志的信息。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-05FCB15E-BE40-40EB-B756-4D280461AD7E__GUID-36595937-FA63-477B-9FF0-78119FE632BF">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="The first column of this table lists the views that are used for providing information about redo logs. The second column contains a corresponding description of each view." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="34%" id="d132399e3076">视图</th>
                              <th align="left" valign="bottom" width="66%" id="d132399e3079">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="34%" id="d132399e3084" headers="d132399e3076 ">
                                 <p><code class="codeph"><a href="../refrn/V-LOG.html#REFRN30127" target="_blank">V $ LOG</a></code></p>
                              </td>
                              <td align="left" valign="top" width="66%" headers="d132399e3084 d132399e3079 ">
                                 <p>显示控制文件中的重做日志文件信息</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="34%" id="d132399e3094" headers="d132399e3076 ">
                                 <p><code class="codeph"><a href="../refrn/V-LOGFILE.html#REFRN30129" target="_blank">V $ LOGFILE</a></code></p>
                              </td>
                              <td align="left" valign="top" width="66%" headers="d132399e3094 d132399e3079 ">
                                 <p>标识重做日志组以及成员和成员状态</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="34%" id="d132399e3104" headers="d132399e3076 ">
                                 <p><code class="codeph"><a href="../refrn/V-LOG_HISTORY.html#REFRN30128" target="_blank">V $ LOG_HISTORY</a></code></p>
                              </td>
                              <td align="left" valign="top" width="66%" headers="d132399e3104 d132399e3079 ">
                                 <p>包含日志历史信息</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>以下查询返回有关数据库的重做日志的控制文件信息。</p><pre class="oac_no_warn" dir="ltr">SELECT GROUP＃，THREAD＃，SEQUENCE＃，BYTES，MEMBERS，ARCHIVED，STATUS，FIRST_CHANGE＃，FIRST_TIME FROM V $ LOG; GROUP＃THREAD #SEQ BYTES成员ARC STATUS FIRST_CHANGE＃FIRST_TIM ------ ------- ----- ------- ------- --- --- ------ ------------- --------- 1 1 10605 1048576 1是活动11515628 16-APR-00 2 1 10606 1048576 1 NO CURRENT 11517595 16 -APR-00 3 1 10603 1048576 1是不活动11511666 16-APR-00 4 1 10604 1048576 1是不活动11513647 16-APR-00</pre><p>要查看组中所有成员的名称，请使用类似于以下内容的查询：</p><pre class="oac_no_warn" dir="ltr">SELECT GROUP＃，STATUS，成员来自V $ LOGFILE; GROUP＃STATUS会员------ ------- --------------------------------- -  1 D：\ ORANT \ ORADATA \ IDDB2 \ REDO04。LOG 2 D：\ ORANT \ ORADATA \ IDDB2 \ REDO03。LOG 3 D：\ ORANT \ ORADATA \ IDDB2 \ REDO02。LOG 4 D：\ ORANT \ ORADATA \ IDDB2 \ REDO01。LOG</pre><p>如果成员的<code class="codeph">STATUS</code>为空，则表示该文件正在使用中。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="managing-the-redo-log.html#GUID-BC1F1762-0BB1-4218-B7AF-6160C395AAE4" title="您可以通过完成诸如创建重做日志组和成员，重定位和重命名重做日志成员，删除重做日志组和成员以及强制日志切换等任务来管理重做日志。">管理重做日志</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html><html id="05800.olap-dml-basic-concepts.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>OLAP DML基本概念</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="DML Reference"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="DML Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="olap-dml-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T13:59:56-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1994, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96403-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="changes-this-release-for-oracle-olap-dml-reference.html" title="Previous" type="text/html"></link>
      <link rel="next" href="data-types-operators-and-expressions.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OLAP DML Reference"></meta>
    <meta name="dcterms.isVersionOf" content="OLADM"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="changes-this-release-for-oracle-olap-dml-reference.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="data-types-operators-and-expressions.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">DML参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">OLAP DML基本概念</li>
            </ol>
            <a id="GUID-AE73B986-6DC0-4057-A536-D3734B1A6575" name="GUID-AE73B986-6DC0-4057-A536-D3734B1A6575"></a><a id="OLADM101"></a><a id="olapdml_basic_concepts"></a>
            
            <h2 id="OLADM-GUID-AE73B986-6DC0-4057-A536-D3734B1A6575" class="sect2"><span class="enumeration_chapter">1</span> OLAP DML基本概念</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="olap-dml-basic-concepts.html#GUID-308085B5-9043-466F-891A-7732E22BE2C9">什么是OLAP DML？</a></p>
                  </li>
                  <li>
                     <p><a href="olap-dml-basic-concepts.html#GUID-3F820E5D-0C63-4E51-BEBE-4674B6A7DFDB">OLAP DML的基本语法单元</a></p>
                  </li>
                  <li>
                     <p><a href="olap-dml-basic-concepts.html#GUID-2DCC16E8-A4C9-4727-B0A4-CC95F4EBBE84">如何执行OLAP DML语句</a></p>
                  </li>
                  <li>
                     <p><a href="olap-dml-basic-concepts.html#GUID-8E8E3CDE-4020-4670-B669-D45440DFEAD4">分析工作区简介</a></p>
                  </li>
                  <li>
                     <p><a href="olap-dml-basic-concepts.html#GUID-2964E902-70D4-4E18-83A0-3EBB9E7B30B0">分析工作区数据对象简介</a></p>
                  </li>
                  <li>
                     <p><a href="olap-dml-basic-concepts.html#GUID-D032BBB4-A0ED-41C1-80B7-D93CA5172FD6">OLAP DML语句应用于数据对象的所有值</a></p>
                  </li>
               </ul>
            </div><a id="OLADM102"></a><a id="olapdml_what_is_the_dml"></a><div class="props_rev_3"><a id="GUID-308085B5-9043-466F-891A-7732E22BE2C9" name="GUID-308085B5-9043-466F-891A-7732E22BE2C9"></a><h3 id="OLADM-GUID-308085B5-9043-466F-891A-7732E22BE2C9" class="sect3"><span class="enumeration_section">1.1</span>什么是OLAP DML？
               </h3>
               <div>
                  <p>OLAP DML是用于定义Oracle OLAP对象和操作Oracle OLAP数据的原始语言。</p>
                  <p>有两种主要类型的OLAP DML语句：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>OLAP DML语句，它们使用OLAP API以前在Oracle数据字典中定义的Oracle OLAP多维数据集和多维数据集维度。有关这些语句的介绍，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-D5779171-E334-4EFC-8C5C-957A4AD22EE5">Cube-Aware OLAP DML语句</a> ”</span> 。
                        </p>
                     </li>
                     <li>
                        <p>OLAP DML语句，用于创建和操作在分析工作区中定义和存储的低级OLAP对象。有关这些语句的介绍，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-B8981366-2453-49BC-87D5-35C19575A631">直接在分析工作区对象上工作的OLAP DML语句</a> ”</span> 。
                        </p>
                     </li>
                  </ul>
               </div><a id="OLADM1043"></a><a id="olapdml_cube_aware_dml"></a><div class="props_rev_3"><a id="GUID-D5779171-E334-4EFC-8C5C-957A4AD22EE5" name="GUID-D5779171-E334-4EFC-8C5C-957A4AD22EE5"></a><h4 id="OLADM-GUID-D5779171-E334-4EFC-8C5C-957A4AD22EE5" class="sect4"><span class="enumeration_section">1.1.1</span>立方体感知OLAP DML语句</h4>
                  <div>
                     <p>OLAP多维数据集是一流的Oracle OLAP对象，在Oracle数据字典中定义。某些OLAP DML语句适用于多维数据集和其他第一类OLAP对象。</p>
                     <div class="infoboxnotealso" id="GUID-D5779171-E334-4EFC-8C5C-957A4AD22EE5__GUID-723D9593-EB46-4ED6-BFB7-6520ADD7A19D">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="italic">“Oracle OLAP用户指南”</span> ，了解有关OLAP多维数据集和其他第一级OLAP对象的信息。
                        </p>
                     </div>
                     <p>以下OLAP DML程序使用先前定义的OLAP多维数据集和多维数据集维度。</p>
                     <ul class="simple" style="list-style-type:none;padding-left:0">
                        <li><a href="olap-dml-commands-a-g.html#GUID-5A4A5FD5-23AA-4553-BF34-0568EE4C6180">ADD_CUBE_MODEL</a></li>
                        <li><a href="olap-dml-commands-a-g.html#GUID-4702593D-35D3-4BE5-A0C6-B1174B292698">ADD_DIMENSION_MEMBER</a></li>
                        <li><a href="olap-dml-commands-a-g.html#GUID-0F365AE1-E2A3-48E2-B1DF-A844E4DC77A2">ADD_MODEL_DIMENSION</a></li>
                        <li><a href="olap-dml-commands-a-g.html#GUID-B88E03E6-CD8E-48AE-9560-342FAAE6E803">CREATE_LOGICAL_MODEL</a></li>
                        <li><a href="olap-dml-commands-h-z.html#GUID-3EEE2BA7-D6A4-46AA-8875-B56311DA7DAD">REMOVE_CUBE_MODEL</a></li>
                        <li><a href="olap-dml-commands-h-z.html#GUID-13E476D5-40B5-4C4C-806D-B36753BD2F80">REMOVE_DIMENSION_MEMBER</a></li>
                        <li><a href="olap-dml-commands-h-z.html#GUID-2ACE5119-95A3-450D-BD7F-23BDA96BEFA0">REMOVE_MODEL_DIMENSION</a></li>
                        <li><a href="olap-dml-commands-h-z.html#GUID-CE469F87-7148-4156-890C-9146EF42E548">SET_INCLUDED_MODEL</a></li>
                        <li><a href="olap-dml-commands-h-z.html#GUID-580435F9-30E6-4DF5-84E8-409EB6B91739">SET_PROPERTY</a></li>
                        <li><a href="olap-dml-commands-h-z.html#GUID-FB7A3475-6276-405F-A75C-50BF54C5C5A8">UPDATE_ATTRIBUTE_VALUE</a></li>
                        <li><a href="olap-dml-commands-h-z.html#GUID-8AB2DDBF-140D-449D-AD20-FD1A3CB9F692">UPDATE_DIMENSION_MEMBER</a></li>
                        <li></li>
                     </ul>
                     <p>通常，这些程序将OLAP多维数据集或多维数据集维度的Oracle数据字典名称作为输入。当程序执行时，它们不仅对多维数据集或多维数据集维度进行必要的更改，而且还会对作为这些多维数据集和多维数据集维度的基础的所有分析工作区对象进行更改。</p>
                     <p>此外，您可以在<span class="italic">不支持</span>多维数据集的OLAP DML语句中使用<a href="olap-dml-functions-l-z.html#GUID-1B4F6A63-7E48-4EAE-BAD0-A6BC636AD6E8">OBJORG</a>函数来指定作为OLAP多维数据集和多维数据集维度基础的分析工作区对象。
                     </p>
                  </div>
               </div><a id="OLADM1044"></a><div class="props_rev_3"><a id="GUID-B8981366-2453-49BC-87D5-35C19575A631" name="GUID-B8981366-2453-49BC-87D5-35C19575A631"></a><h4 id="OLADM-GUID-B8981366-2453-49BC-87D5-35C19575A631" class="sect4"><span class="enumeration_section">1.1.2</span>直接在分析工作区对象上工作的OLAP DML语句</h4>
                  <div>
                     <p>从历史上看，OLAP DML语句不适用于OLAP数据字典中定义的第一级OLAP对象。相反，OLAP DML语句创建和操作定义并存储在分析工作区中的较低级别OLAP对象。对于今天的大多数OLAP DML语句，情况仍然如此。</p>
                     <div class="infoboxnote" id="GUID-B8981366-2453-49BC-87D5-35C19575A631__GUID-06167C6E-011D-4ABF-86C2-29B965509CB9">
                        <p class="notep1">注意：</p>
                        <p>除非另有说明，否则本手册中提供的语句和信息适用于不支持多维数据集的OLAP DML语句（即，OLAP DML语句直接在分析工作区对象上工作）。</p>
                     </div>
                     <p>对于直接在分析工作空间对象上工作的OLAP DML语句，如果需要对象名称作为语句的输入，则对象名称是分析工作空间中定义的对象的名称，而不是Oracle数据字典中定义的对象名称。</p>
                     <p>您可以使用这些OLAP DML语句创建分析分析工作区数据的程序，而无需使用SQL，Java，OLAP API或Oracle OLAP工具。您可以使用OLAP DML定义分析工作区和存储在分析工作区中的对象。例如，您可以：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>按照<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-93E0871F-0EF4-47DE-B175-9782970EE205">定义新的分析工作区</a> ”中的说明</span>创建分析工作<span class="q"><a href="olap-dml-basic-concepts.html#GUID-93E0871F-0EF4-47DE-B175-9782970EE205">区</a></span> 。
                           </p>
                        </li>
                        <li>
                           <p>使用<a href="olap-dml-commands-a-g.html#GUID-569FA3A3-ADF7-488B-9D39-AB8785572C11">DEFINE</a>命令在分析工作区中定义多维数据对象。
                           </p>
                        </li>
                        <li>
                           <p>定义分析数据的计算对象和程序，如<a href="formulas-models-aggregations-and-allocations.html#GUID-D261BFC7-B50F-45BE-92D6-5800E2627C5B">公式，模型，聚合和分配中所述</a> 。
                           </p>
                        </li>
                        <li>
                           <p>填充和分析多维数据对象中的数据。</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="OLADM1045"></a><a id="OLADM1046"></a><a id="OLADM1047"></a><a id="OLADM1048"></a><a id="OLADM1049"></a><a id="OLADM104"></a><div class="props_rev_3"><a id="GUID-3F820E5D-0C63-4E51-BEBE-4674B6A7DFDB" name="GUID-3F820E5D-0C63-4E51-BEBE-4674B6A7DFDB"></a><h3 id="OLADM-GUID-3F820E5D-0C63-4E51-BEBE-4674B6A7DFDB" class="sect3"><span class="enumeration_section">1.2</span> OLAP DML的基本句法单元</h3>
               <div>
                  <p>OLAP DML的基本语法单元是选项，属性，命令，函数和程序。所有这些有时统称为OLAP DML语句。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-3F820E5D-0C63-4E51-BEBE-4674B6A7DFDB__GUID-267BABAB-D829-4D3F-922E-B9AE028E19C3">OLAP DML选项</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>OLAP DML选项是一种特殊类型的分析工作空间对象，它指定Oracle OLAP如何计算或格式化数据或激活Oracle OLAP操作的某些方面的特征。某些选项是只读的，而其他选项是可以指定值的读/写选项。读/写选项具有默认值。</p>
                     <p>您无法将自己的选项定义为分析工作区的一部分。但是，您可以使用任何定义为Oracle OLAP DML一部分的选项。这些选项在<a href="olap-dml-options.html#GUID-14D3D0B3-3244-461B-997B-A0CB0C82AFAA">OLAP DML选项</a>中记录为参考主题。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-3F820E5D-0C63-4E51-BEBE-4674B6A7DFDB__GUID-EB068A7C-8425-4BD8-9E0F-8934644987C5">OLAP DML属性</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>属性是与分析工作空间对象的定义关联的命名值。您可以使用OLAP DML PROPERTY命令为对象命名，创建和分配属性。</p>
                     <p>以$（美元符号）开头的属性被Oracle OLAP识别为系统属性。您无法创建系统属性;但是，在某些情况下，您可以将系统属性分配给对象。这些系统属性在<a href="olap-dml-properties.html#GUID-60615C24-460C-4A4C-A6D5-B5BBC6D3FC68" title="$ AGGMAP属性指定Oracle OLAP使用标识的aggmap自动聚合非预先计算的数据，以替换尺寸变量中的NA值，但不替换变量的会话缓存（如果有）。因此，您无需显式使用AGGREGATE函数来聚合具有$ AGGMAP属性的变量中的非预先计算数据。$ AGGREGATE_FORCECALC属性指定与AGGREGATE函数中FORCECALC关键字指定的行为相同的行为。通过向变量添加$ AGGREGATE_FORCECALC属性，可以在使用AGGREGATE函数聚合变量时确保此行为，即使该函数不包含FORCECALC关键字也是如此。$ AGGREGATE_FORCEORDER属性指定与AGGREGATE命令或AGGREGATE函数中FORCEORDER关键字指定的行为相同的行为。通过向变量添加$ AGGREGATE_FORCEORDER属性，可以在聚合变量时确保此行为，即使它由AGGREGATE语句聚合也不包括FORCEORDER关键字。$ AGGREGATE_FROM属性指定与AGGREGATE命令或AGGREGATE函数中的FROM子句指定的行为相同的行为。通过向变量添加$ AGGREGATE_FROM属性，可以在聚合变量时确保此行为，即使它由AGGREGATE语句聚合也不包含FROM子句。$ AGGREGATE_FROMVAR属性指定与AGGREGATE命令或AGGREGATE函数中的FROMVAR子句指定的行为相同的行为。通过向变量添加$ AGGREGATE_FROMVAR属性，可以在聚合变量时确保此行为，即使它由不包含FROMVAR子句的AGGREGATE语句聚合也是如此。$ ALLOCMAP属性指定用于变量分配的默认aggmap，该变量是Oracle OLAP在变量是不包含USING短语的ALLOCATE语句的目标变量时使用的aggmap。$ COUNTVAR属性指定与AGGREGATE命令或AGGREGATE函数中的COUNTVAR子句指定的行为相同的行为。通过向变量添加$ COUNTVAR属性，可以在聚合变量时确保此行为，即使它由AGGREGATE语句聚合也不包括COUNTVAR子句。$ DEFAULT_LANGUAGE属性将维度标识为定义它的分析工作区的语言维度，并指定该语言维度的默认语言。$ GID_DEPTH属性指定添加它的分组ID关系中分组ID的级别数。$ GID_LIST属性包含用于创建分组ID的级别的名称。$ GID_TYPE属性指定分组ID的分组类型。$ LOOP_AGGMAP属性用于确定在执行带有LOOP OPTIMIZED子句的SQL OLAP_TABLE函数时如何循环分配它的公式。它指定当Oracle OLAP生成包含公式的UNION子句时要使用的aggmap对象的名称。您为此属性指定的值将覆盖与变量关联的所有其他aggmaps（例如，变量具有$ AGGMAP属性的aggmaps），并且可用于阐明Oracle OLAP在公式的基础变量时应使用哪个aggmap与不同的aggmaps相关联。$ LOOP_DENSE属性用于确定在执行带有LOOP OPTIMIZED子句的OLAP_TABLE SQL函数时如何循环分配它的公式。$ LOOP_TYPE属性指定在具有LOOP OPTIMIZED子句的OLAP_TABLE SQL函数中使用公式时如何循环包含多个变量的公式。$ LOOP_VAR属性指定当执行带有LOOP OPTIMIZED子句的OLAP_TABLE SQL函数时，分配它的公式将以与属性中指定的变量或QDR相同的方式循环。$ NATRIGGER属性指定Oracle OLAP的值来替换尺寸变量中的NA值，但不替换变量的会话缓存中的值（如果有）。$ STORETRIGGERVAL属性指定在执行$ NATRIGGER表达式时，Oracle OLAP是否使用表达式的结果替换变量中的NA值。$ VARCACHE属性指定Oracle OLAP是存储还是缓存作为执行AGGREGATE函数或$ NATRIGGER表达式的结果的变量数据。">OLAP DML属性</a>中记录为参考主题。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-3F820E5D-0C63-4E51-BEBE-4674B6A7DFDB__GUID-E3CB83AD-CD16-42F1-B13D-9A14C5219748">OLAP DML函数</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>OLAP函数的工作方式与其他编程语言中的命令非常相似。他们启动行动并返回一个值。唯一的例外是OLAP DML函数的循环特性，如<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-D032BBB4-A0ED-41C1-80B7-D93CA5172FD6">OLAP DML语句应用于数据对象的所有值</a> ”中所述</span> 。
                     </p>
                     <p>大多数OLAP DML函数都是标准文本和计算函数。其他OLAP DML函数返回更复杂的信息。此外，您可以通过编写OLAP DML程序来扩充OLAP DML的功能，以用作函数。</p>
                     <p>内置的OLAP DML函数在OLAP DML函数中记录为参考主题<a href="olap-dml-functions-a-k.html#GUID-61DF603D-3BD7-43B0-B14A-9C536BFF80CE">：A  -  K</a>和<a href="olap-dml-functions-l-z.html#GUID-B01E26A8-F738-4D2C-A274-6B0B3941A2A7">OLAP DML函数：L  -  Z.</a></p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-3F820E5D-0C63-4E51-BEBE-4674B6A7DFDB__GUID-413D4C31-75EC-410F-AECB-467907C1109C">OLAP DML命令</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>OLAP DML命令的工作方式与其他编程语言中的命令非常相似 - 一个例外是OLAP DML命令的循环特性，如<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-D032BBB4-A0ED-41C1-80B7-D93CA5172FD6">OLAP DML语句应用于数据对象的所有值</a> ”中所述</span> 。
                     </p>
                     <p>许多OLAP DML命令执行复杂的操作。其中一些命令是数据定义命令，如用于创建分析工作区的AW命令和用于在分析工作区中定义对象的DEFINE命令。其他OLAP DML命令是数据操作命令。Oracle OLAP将某些命令识别为可触发OLAP DML程序执行的事件。（有关详细信息，请参阅<span class="q">“ <a href="olap-dml-programs.html#GUID-6DC225EC-360D-4292-A4A9-ED27E60B1BB0">触发器程序</a> ”</span> 。）此外，您可以通过编写OLAP DML程序来扩充OLAP DML的功能，以用作命令。
                     </p>
                     <p>内置的OLAP DML命令在第8章<a href="olap-dml-commands-a-g.html#GUID-E53A76E2-3ED0-4084-BEFC-942266F3F811" title="ALLOCATE命令通过在分层维度下分配可变数据来计算来自上层数据的较低级别数据。">OLAP DML命令：AG</a>和<a href="olap-dml-commands-h-z.html#GUID-C5C279D8-A1CE-4814-B6AE-BDD06AF798D8">OLAP DML命令：HZ</a>中记录为参考主题。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-3F820E5D-0C63-4E51-BEBE-4674B6A7DFDB__GUID-6CC41724-DFFA-4B2D-BBEE-132FD8F24675">OLAP DML程序</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>几个OLAP DML程序作为OLAP DML的一部分提供。其中一些程序会生成可以打印或在线查看的报告。作为OLAP DML的一部分提供的其他程序对程序员和数据库管理员执行标准的使用计算。有关OLAP DML随附的程序的详细信息，请参阅<span class="q">“</span> OLAP DML随附的<span class="q"><a href="olap-dml-programs.html#GUID-2A2A7710-6459-440B-B9F8-3EC1408D4DB0">程序</a> ”</span> 。
                     </p>
                     <p>您还可以编写自己的OLAP DML程序，以增强OLAP DML的功能，如<a href="olap-dml-programs.html#GUID-6CC5769C-7292-42CD-BF33-BBECF9456606">OLAP DML程序中所述</a> 。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="OLADM105"></a><a id="olapdml_how_to_execute_statements"></a><div class="props_rev_3"><a id="GUID-2DCC16E8-A4C9-4727-B0A4-CC95F4EBBE84" name="GUID-2DCC16E8-A4C9-4727-B0A4-CC95F4EBBE84"></a><h3 id="OLADM-GUID-2DCC16E8-A4C9-4727-B0A4-CC95F4EBBE84" class="sect3"><span class="enumeration_section">1.3</span>如何执行OLAP DML语句</h3>
               <div>
                  <div class="section">
                     <p>执行OLAP DML语句的最简单方法是使用OLAP工作表。OLAP工作表作为Analytic Workspace Manager的一部分提供。要从Analytic Workspace Manager中打开OLAP工作表，请执行以下操作：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li><span>连接到Oracle数据库实例。</span></li>
                     <li><span>选择一个架构。</span></li>
                     <li><span>选择工具，然后选择OLAP工作表。</span></li>
                  </ol>
                  <div class="section">
                     <p>您还可以在SQL和Java中执行OLAP DML语句：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用PL / SQL <code class="codeph">DBMS_AW</code>包，您可以执行<span class="italic">Oracle OLAP DML参考</span>手册中所述的OLAP DML语句。
                           </p>
                        </li>
                        <li>
                           <p>使用作为Oracle OLAP Java API的一部分提供的<code class="codeph">SPL_Executor</code> ，您可以在Java程序中嵌入OLAP DML语句。
                           </p>
                           <div class="infoboxnotealso" id="GUID-2DCC16E8-A4C9-4727-B0A4-CC95F4EBBE84__GUID-E0910B0D-126E-4088-BB9B-2D8BAE459C74">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="italic">Oracle OLAP Java API参考</span></p>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="OLADM107"></a><a id="olapdml_intro_to_aws"></a><div class="props_rev_3"><a id="GUID-8E8E3CDE-4020-4670-B669-D45440DFEAD4" name="GUID-8E8E3CDE-4020-4670-B669-D45440DFEAD4"></a><h3 id="OLADM-GUID-8E8E3CDE-4020-4670-B669-D45440DFEAD4" class="sect3"><span class="enumeration_section">1.4</span>分析工作区简介</h3>
               <div>
                  <p>从概念上讲，分析工作区是Oracle OLAP用于执行OLAP分析的Oracle数据库的一部分。物理上，分析工作区作为LOB存储在名为<code class="codeph">AW$</code> <span class="italic"><code class="codeph">workspacename</code></span>的表中。
                  </p>
                  <p>分析工作区还包含以下类型的对象以及这些对象的OLAP DML定义：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>包含要分析的数据和分析结果的多维数据对象。</p>
                     </li>
                     <li>
                        <p>包含指定分析的OLAP DML语句的计算对象（即公式，模型，聚合和分配）。</p>
                     </li>
                     <li>
                        <p>执行复杂分析的OLAP DML程序。</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-8E8E3CDE-4020-4670-B669-D45440DFEAD4__GUID-31E607AA-EC02-4B9D-B2E5-570CF8053AF2">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-2964E902-70D4-4E18-83A0-3EBB9E7B30B0">分析工作区数据对象简介</a> ”</span> ， <a href="formulas-models-aggregations-and-allocations.html#GUID-D261BFC7-B50F-45BE-92D6-5800E2627C5B">公式，模型，聚合和分配</a>以及<a href="olap-dml-programs.html#GUID-6CC5769C-7292-42CD-BF33-BBECF9456606">OLAP DML程序</a></p>
                  </div>
               </div><a id="OLADM108"></a><div class="props_rev_3"><a id="GUID-3D251C92-8AD0-4A88-B0C7-A271D535D7CE" name="GUID-3D251C92-8AD0-4A88-B0C7-A271D535D7CE"></a><h4 id="OLADM-GUID-3D251C92-8AD0-4A88-B0C7-A271D535D7CE" class="sect4"><span class="enumeration_section">1.4.1</span>创建和删除分析工作区所需的权限</h4>
                  <div>
                     <p>由于分析工作区在Oracle数据库实例中物理存储为表，因此您需要SQL GRANT权限才能使用分析工作区。您需要的权限取决于分析工作区是在您拥有的模式中还是在您不拥有的模式中：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果您是架构的所有者，则只需要创建分析工作区或附加分析工作区时，您只需要SQL GRANT权限。下表概述了执行这些任务必须授予的权限以及与这些任务相关的OLAP DML命令。</p>
                           <div class="tblformal" id="GUID-3D251C92-8AD0-4A88-B0C7-A271D535D7CE__GUID-C0F842FD-A8A7-4ADE-9CC1-9D07E643A7D4">
                              <table cellpadding="4" cellspacing="0" class="Formal" title="" width="90%" border="1" summary="Analytic workspace tasks and OLAP DML commands and GRANT privileges need to perform these tasks when the analytic workspace is in a schema that you own." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="33%" id="d9708e541">任务</th>
                                       <th align="left" valign="bottom" width="30%" id="d9708e544">OLAP DML命令</th>
                                       <th align="left" valign="bottom" width="37%" id="d9708e547">需要SQL GRANT权限</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d9708e552" headers="d9708e541 ">
                                          <p>创建分析工作区</p>
                                       </td>
                                       <td align="left" valign="top" width="30%" headers="d9708e552 d9708e544 ">
                                          <p><a href="olap-dml-commands-a-g.html#GUID-A2169EB6-3612-4FAF-B2CC-2DF145D71FC7">AW创建</a></p>
                                       </td>
                                       <td align="left" valign="top" width="37%" headers="d9708e552 d9708e547 ">
                                          <p>创建表</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d9708e563" headers="d9708e541 ">
                                          <p>附加分析工作区AS OF</p>
                                       </td>
                                       <td align="left" valign="top" width="30%" headers="d9708e563 d9708e544 ">
                                          <p>带有ASOF关键字的<a href="olap-dml-commands-a-g.html#GUID-A87A91D4-FA55-4B37-A67B-799ED47DB052">AW ATTACH</a></p>
                                       </td>
                                       <td align="left" valign="top" width="37%" headers="d9708e563 d9708e547 ">
                                          <p>闪回表</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </li>
                        <li>
                           <p>如果您不是架构的所有者，则需要SQL GRANT权限才能创建分析工作区，在ASOF模式下附加分析工作区，删除分析工作区以及截断分析工作区，如下表所示。</p>
                           <div class="tblformal" id="GUID-3D251C92-8AD0-4A88-B0C7-A271D535D7CE__GUID-AD12B755-DF68-442E-A5E9-2BBDCDBAC514">
                              <table cellpadding="4" cellspacing="0" class="Formal" title="" width="90%" border="1" summary="Analytic workspace tasks and OLAP DML commands and GRANT privileges need to perform these tasks when the analytic workspace is in a schema that you do not own." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="33%" id="d9708e586">任务</th>
                                       <th align="left" valign="bottom" width="30%" id="d9708e589">OLAP DML命令</th>
                                       <th align="left" valign="bottom" width="37%" id="d9708e592">需要SQL GRANT权限</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d9708e597" headers="d9708e586 ">
                                          <p>创建分析工作区</p>
                                       </td>
                                       <td align="left" valign="top" width="30%" headers="d9708e597 d9708e589 ">
                                          <p><a href="olap-dml-commands-a-g.html#GUID-A2169EB6-3612-4FAF-B2CC-2DF145D71FC7">AW创建</a></p>
                                       </td>
                                       <td align="left" valign="top" width="37%" headers="d9708e597 d9708e592 ">
                                          <p>创建任何表，选择任何表，更新任何表</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d9708e608" headers="d9708e586 ">
                                          <p>附加分析工作区AS OF</p>
                                       </td>
                                       <td align="left" valign="top" width="30%" headers="d9708e608 d9708e589 ">
                                          <p>带有ASOF关键字的<a href="olap-dml-commands-a-g.html#GUID-A87A91D4-FA55-4B37-A67B-799ED47DB052">AW ATTACH</a></p>
                                       </td>
                                       <td align="left" valign="top" width="37%" headers="d9708e608 d9708e592 ">
                                          <p>FLASHBACK任何表</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d9708e620" headers="d9708e586 ">
                                          <p>删除分析工作区</p>
                                       </td>
                                       <td align="left" valign="top" width="30%" headers="d9708e620 d9708e589 ">
                                          <p><a href="olap-dml-commands-a-g.html#GUID-AD130122-9E29-437F-9266-075C5EF2E370">AW DELETE</a></p>
                                       </td>
                                       <td align="left" valign="top" width="37%" headers="d9708e620 d9708e592 ">
                                          <p>DROP ANY TABLE</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d9708e631" headers="d9708e586 ">
                                          <p>截断分析工作区</p>
                                       </td>
                                       <td align="left" valign="top" width="30%" headers="d9708e631 d9708e589 ">
                                          <p><a href="olap-dml-commands-a-g.html#GUID-DD99BD2D-BEAB-4061-AB97-82FF2FECA84A">AW TRUNCATE</a></p>
                                       </td>
                                       <td align="left" valign="top" width="37%" headers="d9708e631 d9708e592 ">
                                          <p>TRUNCATE ANY TABLE</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </li>
                     </ul>
                     <p>请注意，在运行命名的PL / SQL过程时，Oracle数据库不会打开角色。在这种情况下，您必须直接具有CREATE TABLE权限。</p>
                  </div>
               </div><a id="OLADM109"></a><div class="props_rev_3"><a id="GUID-93E0871F-0EF4-47DE-B175-9782970EE205" name="GUID-93E0871F-0EF4-47DE-B175-9782970EE205"></a><h4 id="OLADM-GUID-93E0871F-0EF4-47DE-B175-9782970EE205" class="sect4"><span class="enumeration_section">1.4.2</span>定义新的分析工作区</h4>
                  <div>
                     <p>您可以使用OLAP DML创建分析工作区。要创建分析工作区，请使用CREATE关键字发出AW命令，然后发出UPDATE语句和COMMIT语句。</p>
                  </div>
               </div><a id="OLADM110"></a><div class="props_rev_3"><a id="GUID-11FE14A2-7A37-492F-B574-D82728A0FED4" name="GUID-11FE14A2-7A37-492F-B574-D82728A0FED4"></a><h4 id="OLADM-GUID-11FE14A2-7A37-492F-B574-D82728A0FED4" class="sect4"><span class="enumeration_section">1.4.3</span>使用以前定义的分析工作区</h4>
                  <div>
                     <p>在使用先前定义的分析工作区之前，必须首先通过发出AW ATTACH语句来附加分析工作区。您可以使用以下任何附件模式附加分析工作区：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">只读</span> ：用户可以对工作空间中的数据进行私有更改，以执行假设分析，但不能提交任何这些更改。可以在只读模式下附加任意数量的用户。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">读/写访问模式</span> ：一次只能<span class="bold">读取/写入</span>一个用户可以打开分析工作区。用户必须提交对工作区所做的全部更改或不提交任何更改。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">读/写独占访问模式</span> ：读/写独占连接模式与任何其他访问模式不兼容。当另一个用户在任何模式下附加分析工作区时，用户无法以分析/写入独占模式附加分析工作区。一次只能有一个用户可以以读/写方式打开分析工作区。用户必须提交对工作区所做的全部更改或不提交任何更改。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">多重写入器访问模式</span> ：可以通过多个会话同时访问以多写入器模式连接的分析工作区。在多写入器模式下，用户可以通过为各个变量，关系，值集和维度指定附件模式（只读或读/写），以受控方式同时修改同一分析工作区。
                           </p>
                        </li>
                     </ul>
                     <p>有关各种附件模式的更多信息，请参阅<a href="olap-dml-commands-a-g.html#GUID-A87A91D4-FA55-4B37-A67B-799ED47DB052">AW ATTACH</a>语句的语法和注释。
                     </p>
                  </div>
               </div><a id="OLADM1050"></a><a id="OLADM111"></a><div class="props_rev_3"><a id="GUID-F9B1E464-5FA4-49D1-941C-A7055A283367" name="GUID-F9B1E464-5FA4-49D1-941C-A7055A283367"></a><h4 id="OLADM-GUID-F9B1E464-5FA4-49D1-941C-A7055A283367" class="sect4"><span class="enumeration_section">1.4.4</span>查看有关分析工作区的信息</h4>
                  <div>
                     <p>下表列出了可用于查看有关分析工作区的信息的OLAP DML语句</p>
                     <div class="tblformal" id="GUID-F9B1E464-5FA4-49D1-941C-A7055A283367__BABDFCEG">
                        <p class="titleintable">表1-1查看有关分析工作区的信息的语句</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="查看有关分析工作区的信息的语句" width="100%" border="1" summary="This table lists the OLAP DML statements that you can use to manage analytic workspaces." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="29%" id="d9708e771">声明</th>
                                 <th align="left" valign="bottom" width="71%" id="d9708e774">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d9708e779" headers="d9708e771 ">
                                    <p><a href="olap-dml-functions-a-k.html#GUID-AD71932C-00EB-41C4-9059-876CE03D5205">AW功能</a></p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d9708e779 d9708e774 ">
                                    <p>返回有关当前附加工作空间的信息。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d9708e787" headers="d9708e771 ">
                                    <p><a href="olap-dml-commands-a-g.html#GUID-7E15216F-8529-488B-8A2B-C17A9405CAE4">AWDESCRIBE</a>计划</p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d9708e787 d9708e774 ">
                                    <p>将有关当前分析工作空间的信息发送到当前outfile。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d9708e796" headers="d9708e771 ">
                                    <p><a href="olap-dml-functions-a-k.html#GUID-6AF3A7B2-E49A-4178-92F9-A347F26AD7B3">EXISTS</a>功能</p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d9708e796 d9708e774 ">
                                    <p>返回一个值，该值指示是否在任何连接的工作空间中定义了对象。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d9708e805" headers="d9708e771 ">
                                    <p><a href="olap-dml-commands-h-z.html#GUID-6730EB17-D6E4-4E9D-92A0-C60D5BE0439C">LISTBY</a>计划</p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d9708e805 d9708e774 ">
                                    <p>列出分析工作区中由一个或多个指定维或复合体标注或相关的所有对象。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d9708e814" headers="d9708e771 ">
                                    <p><a href="olap-dml-commands-h-z.html#GUID-67A0A769-8D3B-4089-94A3-95987FDDDCCF">LISTNAMES</a>计划</p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d9708e814 d9708e774 ">
                                    <p>列出分析工作区中对象的名称。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d9708e823" headers="d9708e771 ">
                                    <p><a href="olap-dml-functions-l-z.html#GUID-4AD8C727-8B19-4840-8F68-C11EF7E08DC3">OBJ</a>功能</p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d9708e823 d9708e774 ">
                                    <p>返回有关分析工作空间对象的信息。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d9708e832" headers="d9708e771 ">
                                    <p><a href="olap-dml-functions-l-z.html#GUID-F4B7A81F-4ACE-4833-9E7E-4513C4F5ABB7">OBJLIST</a>功能</p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d9708e832 d9708e774 ">
                                    <p>列出您指定的一个或多个工作空间中的对象。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d9708e841" headers="d9708e771 ">
                                    <p><a href="olap-dml-commands-a-g.html#GUID-A90506EF-24DF-44C0-86CA-0D51AFAD921B">DESCRIBE</a>命令</p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d9708e841 d9708e774 ">
                                    <p>列出一个或多个工作空间对象的简单定义。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d9708e850" headers="d9708e771 ">
                                    <p><a href="olap-dml-commands-a-g.html#GUID-1B30E714-3236-466D-9777-68EA704B51DF">FULLDSC</a>计划</p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d9708e850 d9708e774 ">
                                    <p>列出一个或多个工作空间对象的完整定义，包括对象的属性和触发器。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div>
            </div><a id="OLADM1051"></a><a id="olapdml_about_data_objects"></a><div class="props_rev_3"><a id="GUID-2964E902-70D4-4E18-83A0-3EBB9E7B30B0" name="GUID-2964E902-70D4-4E18-83A0-3EBB9E7B30B0"></a><h3 id="OLADM-GUID-2964E902-70D4-4E18-83A0-3EBB9E7B30B0" class="sect3"><span class="enumeration_section">1.5</span>分析工作区数据对象简介</h3>
               <div>
                  <p>关系数据库通常将数据值存储在表示第三范式数据的表中。在这种类型的实现中，关系数据库表的键列值是单个数据级别的唯一值。例如，在关系数据库的一个级别，您可能有一个表，其中包含名为City的键列，其中包含城市的名称，在数据库的下一个最高级别，表中包含名为state的键列，其中包含状态名称， 等等等等。</p>
                  <p>在分析工作区中，保存要分析的数据的对象是称为变量的数组。变量中的键存储在其他对象中，这些对象充当变量的维度。为了支持高性能OLAP分析，来自多个级别的值存储在称为分层维度的单个维度中。例如，分析工作空间可能具有名为geog的层次结构维度，其具有城市和州的名称作为值。</p>
                  <p>存储与两个或多个维度的值相关的值的对象称为关系。因此，分层维度中不同级别的值之间的一对多关系存储在分析工作空间中。例如，层次地理维度中的城市和州值之间的关系将存储在通常称为父亲关系的分析工作空间关系中。（有关详细信息，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-DDB9F83C-9589-4E2C-A1F2-9B64742C7B73">父母关系</a> ”</span> 。）
                  </p>
                  <p>通常定义其他分析工作空间对象以保留有关分层维度的其他信息。几个重要的OLAP DML命令和函数（例如LIMIT命令）假定在分析工作区中存在这些对象，因为这些对象的名称是语句语法中的一个参数。</p>
                  <p>使用OLAP DML定义的数据对象是存储在分析工作区中的多维对象。当您使用OLAP DML语句对这些多维数据对象执行操作时，这些操作会同时应用于这些对象包含的整个值集。</p>
                  <div class="infoboxnotealso" id="GUID-2964E902-70D4-4E18-83A0-3EBB9E7B30B0__GUID-D71F8CDE-68BC-4CDB-B966-E58041F78AF2">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-7179E66A-1925-489B-86CC-822C9687E1D3">分析工作区数据对象的类型</a> ”</span>和<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-A6C8F1DD-9AAE-4031-BB1F-1B8269DEA718">支持使用层次结构的对象</a> ”</span> 。
                     </p>
                  </div>
               </div><a id="OLADM113"></a><div class="props_rev_3"><a id="GUID-7179E66A-1925-489B-86CC-822C9687E1D3" name="GUID-7179E66A-1925-489B-86CC-822C9687E1D3"></a><h4 id="OLADM-GUID-7179E66A-1925-489B-86CC-822C9687E1D3" class="sect4"><span class="enumeration_section">1.5.1</span>分析工作区数据对象的类型</h4>
                  <div>
                     <p>OLAP DML支持使用以下类型的分析工作区数据对象：</p>
                     <ul class="simple" style="list-style-type:none;padding-left:0">
                        <li><a href="olap-dml-basic-concepts.html#GUID-0FF3BAAC-753C-4115-8C8F-0BDCD193B453">变量</a></li>
                        <li><a href="olap-dml-basic-concepts.html#GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__BABBAGFI">简单的尺寸</a></li>
                        <li><a href="olap-dml-basic-concepts.html#GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__BABGDCBJ">Concat尺寸</a></li>
                        <li><a href="olap-dml-basic-concepts.html#GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__BABIHGIG">复合材料</a></li>
                        <li><a href="olap-dml-basic-concepts.html#GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__BABEJCCH">分区模板</a></li>
                        <li><a href="olap-dml-basic-concepts.html#GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__BABJDDCE">别名尺寸</a></li>
                        <li><a href="olap-dml-basic-concepts.html#GUID-5378B123-4415-4FC8-9F91-72D4310A1594">关系</a></li>
                        <li><a href="olap-dml-basic-concepts.html#GUID-1EB0143C-5881-4BE4-9CA2-6C0EFE01E034">值集和代理对象</a></li>
                     </ul>
                     <div class="infobox-tip" id="GUID-7179E66A-1925-489B-86CC-822C9687E1D3__GUID-E1E55F22-6AD0-44D1-B683-C2849D32B4F1">
                        <p class="notep1">小费：</p>
                        <p>您可以使用<a href="olap-dml-functions-l-z.html#GUID-1B4F6A63-7E48-4EAE-BAD0-A6BC636AD6E8">OBJORG</a>函数指定分析多维数据集和多维数据集维度的分析工作区对象。
                        </p>
                     </div>
                  </div><a id="OLADM114"></a><div class="props_rev_3"><a id="GUID-0FF3BAAC-753C-4115-8C8F-0BDCD193B453" name="GUID-0FF3BAAC-753C-4115-8C8F-0BDCD193B453"></a><h5 id="OLADM-GUID-0FF3BAAC-753C-4115-8C8F-0BDCD193B453" class="sect5"><span class="enumeration_section">1.5.1.1</span>变量</h5>
                     <div>
                        <p>分析工作区中最重要的数据对象是变量。变量是存储数据的对象。变量中的所有数据必须具有相同的数据类型。通常，您使用变量来包含量化业务特定方面的数据值例如，您的业务可能有多个类别的事务（以美元，单位，百分比等衡量），每个类别都存储在自己的变量中。例如，您可以以美元（销售变量）和单位（单位变量）记录销售数据。</p>
                        <p>因为OLAP DML是一种多维编程语言，所以变量是多维的，并且与其他OLAP语言有时称为度量的对应。从概念上讲，您可以将具有两个维度的变量视为表格，将具有三个维度的变量视为多维数据集，依此类推。在物理上，变量存储为多维数组，数组的实际结构由变量的尺寸确定的对象确定。</p>
                        <p>变量的范围和持久性可以变化。永久变量是变量，变量值和定义都存储在分析工作区中。临时变量仅在当前会话期间具有值。更新和提交分析工作区时，仅保存临时变量的定义。退出分析工作区时，将丢弃数据值。您还可以在程序中定义变量。</p>
                        <p>您可以在程序中定义标量变量，但是使用OLAP DML定义的大多数变量都是标注变量。尺寸标注变量是包含多个值的数组。变量的索引或维度为变量提供组织。维度的值类似于关系表中的键，因为它们唯一地标识数据值。例如，如果您的销售变量按时间，地理位置和产品维度标注，则时间，地理位置和产品值的每个组合都会标识销售额中的值。（请注意，变量的索引实际上不是维度的值，而是维度中值的INTEGER位置。）</p>
                        <p>变量可以通过平面或分层维度来确定尺寸。当维度中的值全部处于同一级别时，存在平面维度;没有值是另一个值的子节点或父节点。当具有单个维度的值彼此处于一对多（父对子）关系时，存在分层维度。</p>
                        <p>层次维度是在单个维度内组织和构造此类数据的方法。然后，您可以使用它来标注包含所有级别数据的变量。某些维度具有多个层次结构。您可以通过创建自我关系来指定维值的父对子关系。您使用分层维度来定义一个变量，该变量包含单个变量中不同聚合级别的数据。将所有这些值存储在单个变量中可以为想要查看数据的用户提供更快的响应时间，特别是在变量很大时。</p>
                        <p>通常，变量中与层级维度中的上级值对应的单元格包含变量单元格中与较低级别维度值对应的值的总和或总和。例如，在使用表示时间的分层维度定义的销售变量中，每个季度的变量单元格可能表示该季度中月份的总销售额。</p>
                        <p>定义具有分层维度的变量后，可以将变量数据添加到层次结构的最低级别，然后计算或聚合更高级别的层次结构的值。相反，您可以将数据从较高级别分发或分配到较低级别的层次结构。</p>
                        <div class="infoboxnote" id="GUID-0FF3BAAC-753C-4115-8C8F-0BDCD193B453__GUID-DC5A40A1-5B11-4C8C-A5EB-38257A623002">
                           <p class="notep1">看到：</p>
                           <p><a href="olap-dml-commands-a-g.html#GUID-0F57584C-1BD9-4F2B-993B-F5E1EF2B8D09">DEFINE VARIABLE</a></p>
                        </div>
                     </div>
                  </div><a id="OLADM1052"></a><a id="OLADM1053"></a><a id="OLADM1054"></a><a id="OLADM1055"></a><a id="OLADM1056"></a><a id="OLADM115"></a><div class="props_rev_3"><a id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB" name="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB"></a><h5 id="OLADM-GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB" class="sect5"><span class="enumeration_section">1.5.1.2</span>可以标注变量的对象</h5>
                     <div>
                        <p>实际构造和存储变量和关系数据的方式取决于用于标注变量或关系的对象类型以及这些对象在变量或关系的定义中出现的顺序。变量可以通过简单尺寸，连续尺寸，复合材料，分区模板和别名尺寸来确定尺寸。选择标注变量的对象决定了变量数据的存储方式。</p>
                        <div class="infoboxnotealso" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-FCEC5ED5-3874-4C13-8185-65416AE66FEB">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-A6C8F1DD-9AAE-4031-BB1F-1B8269DEA718">支持使用层次结构的对象</a> ”</span></p>
                        </div>
                        <div class="section" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__BABBAGFI">
                           <p class="subhead3" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-EAC6F8B5-35C4-4221-998D-F02386F9D81D">简单的尺寸</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>简单维度的成员是全部具有相同数据类型的数据值。当变量通过简单维度标注时，变量中的每个维度都有一个单元格。当存在变量没有数据的维度成员时，Oracle OLAP会在该空值的变量中存储NA值。如果存储此类NA值将导致整页NA值，则Oracle OLAP实际上不会存储NA值。</p>
                           <div class="infoboxnote" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-68BFE69C-785F-4643-A16D-0E0BD37021DD">
                              <p class="notep1">看到：</p>
                              <p><a href="olap-dml-commands-a-g.html#GUID-AA553A2F-30BD-4F6D-8897-F8685877ADA3">DEFINE DIMENSION（简单）</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__BABGDCBJ">
                           <p class="subhead3" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-6EA8496B-96FD-421B-8C23-B72464C835F8">Concat尺寸</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>您可以在先前定义的简单尺寸或联合尺寸上定义连接尺寸。因此，concat维度的基本维度可以是不同的数据类型。您可以使用concat维度表示层次结构，该维度在其基本维度中具有两个或更多简单的平面维度。您可以使用concat维度轻松地将分析工作区中的维度映射到关系表中的列，从而提高从关系结构到分析工作区结构的数据加载效率。</p>
                           <div class="infoboxnote" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-D2DE500D-632A-4C49-AFE2-53F0ED7ACAEC">
                              <p class="notep1">看到：</p>
                              <p><a href="olap-dml-commands-a-g.html#GUID-98B47AAF-D6FF-4DB6-BF6A-C491BB37CC81">DEFINE DIMENSION CONCAT</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__BABIHGIG">
                           <p class="subhead3" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-EEB37989-8B8F-4DB8-8A98-16523029D5D8">复合材料</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p><a id="d9708e1086" class="indexterm-anchor"></a>您可以在先前定义的尺寸上定义合成。从概念上讲，您可以考虑由两种结构组成的复合：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>复合对象本身。该组合包含维度 - 值组合（即复合元组），Oracle OLAP使用它来确定由组合标注的任何变量的结构。</p>
                              </li>
                              <li>
                                 <p>复合值与其基本维度值之间的索引。</p>
                              </li>
                           </ul>
                           <p>对于由复合维度定义的变量，Oracle OLAP不会为基本维度中的每个值创建单元格，如果变量由简单维度标注。相反，它仅为存储在复合元组中的那些维值创建数组元素（即可变单元格）。对于复合中的每个元组，变量的数据按单元顺序存储。从数据存储的角度来看，复合中基本维度值的每个组合都被视为常规维度的值。因此，当您使用一个常规维度和一个复合定义变量时，变量的数据将存储为二维变量。使用复合材料减少为变量创建的元素数量可以提高数据存储效率。</p>
                           <div class="infoboxnote" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-24B1CAA0-3774-48FD-9C8A-8D7EE444DDC3">
                              <p class="notep1">看到：</p>
                              <p><a href="olap-dml-commands-a-g.html#GUID-780312CE-CA79-4208-959A-C875ECB61B48">DEFINE COMPOSITE</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__BABEJCCH">
                           <p class="subhead3" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-EA40DE49-928B-4028-895E-0BFE28E59E2F">分区模板</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>您可以在先前定义的尺寸或合成上定义分区模板。分区模板是分区变量的分区的规范。分区变量作为多个行存储在作为分析工作区的LOB的关系表中 - 每个分区都是表中的一行。</p>
                           <div class="infoboxnote" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-99D68CC8-3D52-40D7-A39C-D8FBF88FE3B0">
                              <p class="notep1">看到：</p>
                              <p><a href="olap-dml-commands-a-g.html#GUID-939941D6-A002-42C5-9000-33D36DF8EA8A">DEFINE PARTITION TEMPLATE</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__BABJDDCE">
                           <p class="subhead3" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-6CB5081A-B2BB-4273-85A0-34374233E8A4">别名尺寸</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>别名维度是简单维度的别名。别名维度与其基本维度具有相同的类型和值。通常，如果要将变量按相同尺寸标注两次，则可以定义别名维。</p>
                           <div class="infoboxnote" id="GUID-F44FE0AB-A638-41AD-A758-73EBCA2228DB__GUID-389598DB-A98D-43E9-8FD1-D6526B8B97EB">
                              <p class="notep1">看到：</p>
                              <p><a href="olap-dml-commands-a-g.html#GUID-EE7469D4-65B6-4F97-A897-EAE60E168914">DEFINE DIMENSION ALIASOF</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLADM116"></a><div class="props_rev_3"><a id="GUID-5378B123-4415-4FC8-9F91-72D4310A1594" name="GUID-5378B123-4415-4FC8-9F91-72D4310A1594"></a><h5 id="OLADM-GUID-5378B123-4415-4FC8-9F91-72D4310A1594" class="sect5"><span class="enumeration_section">1.5.1.3</span>关系</h5>
                     <div>
                        <p>关系是一个对象，它建立给定维度的值与分析工作区中相同维度或其他维度的值之间的对应关系。关系是尺寸数组。关系中的每个单元格都保存维度值的索引。您可以定义两个或多个维度之间的关系，一组维度之间的多个关系，或自身的维度（自我关系）。</p>
                        <p>最常见的是，关系是层次维度的自我关系。通过在参与一对多（父对子）关系的维度中创建值之间的关系，您可以按子值组织数据，并按父值查看数据聚合。例如，您可以创建一个<code class="codeph">geog.parent</code>的关系<code class="codeph">geography</code>维度来定义城市和州值之间的关系<code class="codeph">geography</code> 。通过这种方式，您可以按城市组织数据并按州查看数据聚合。
                        </p>
                        <div class="infoboxnotealso" id="GUID-5378B123-4415-4FC8-9F91-72D4310A1594__GUID-70220935-1208-4CED-A0E7-65EED128FFC2">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="olap-dml-commands-a-g.html#GUID-BC21E6B7-5DF5-4969-ABE5-E2A7CC6A74B1">定义关系</a></p>
                        </div>
                     </div>
                  </div><a id="OLADM1057"></a><a id="OLADM1058"></a><a id="OLADM117"></a><div class="props_rev_3"><a id="GUID-1EB0143C-5881-4BE4-9CA2-6C0EFE01E034" name="GUID-1EB0143C-5881-4BE4-9CA2-6C0EFE01E034"></a><h5 id="OLADM-GUID-1EB0143C-5881-4BE4-9CA2-6C0EFE01E034" class="sect5"><span class="enumeration_section">1.5.1.4值</span>集和代理对象</h5>
                     <div>
                        <p>OLAP DML提供了以下特殊数据对象，在定义变量时不会使用它们，而是在查询变量时，</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-1EB0143C-5881-4BE4-9CA2-6C0EFE01E034__GUID-9B540834-AE66-4A0E-99D5-6A1686DC6FAF">值集对象</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>值集是一个或多个先前定义的维的维值列表。您可以使用值集来跨会话保存维度状态列表。</p>
                           <div class="infoboxnote" id="GUID-1EB0143C-5881-4BE4-9CA2-6C0EFE01E034__GUID-67578ED2-8ED3-4E65-8A28-1511F6AEE5E1">
                              <p class="notep1">看到：</p>
                              <p><a href="olap-dml-commands-a-g.html#GUID-D5BFE678-2044-490D-B46E-19B89AA0BBBD">DEFINE VALUESET</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-1EB0143C-5881-4BE4-9CA2-6C0EFE01E034__GUID-014E5970-1F04-4B8A-83F6-DAF75E7175E7">代孕</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>维度代理是先前定义的维度的替代值集合。您不能通过代理来标注变量，但是您可以在模型，LIMIT命令，限定数据引用或使用FILEREAD，FILEVIEW，SQL FETCH等语句的数据加载中使用代理而不是维度。 SQL IMPORT。</p>
                           <div class="infoboxnote" id="GUID-1EB0143C-5881-4BE4-9CA2-6C0EFE01E034__GUID-6BA9020B-A00C-45CF-B260-49259D4C5E33">
                              <p class="notep1">看到：</p>
                              <p><a href="olap-dml-commands-a-g.html#GUID-7A07E22E-2BBA-46F6-A031-BFBAB90AE86F">DEFINE SURROGATE</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="OLADM1059"></a><a id="OLADM118"></a><div class="props_rev_3"><a id="GUID-A6C8F1DD-9AAE-4031-BB1F-1B8269DEA718" name="GUID-A6C8F1DD-9AAE-4031-BB1F-1B8269DEA718"></a><h4 id="OLADM-GUID-A6C8F1DD-9AAE-4031-BB1F-1B8269DEA718" class="sect4"><span class="enumeration_section">1.5.2</span>支持使用层次结构的对象</h4>
                  <div>
                     <p>通常，变量由分层对象标注尺寸。例如，您可能有一个按地理位置，时间和产品标注尺寸的销售变量。geog维度可能有两个层次结构（一个用于政治部门，另一个用于销售区域），每个层次结构可以有多个级别，其中政治地理层次结构的顶层是All Country，而销售地理层次结构的顶层是All区域。<a href="olap-dml-basic-concepts.html#GUID-A6C8F1DD-9AAE-4031-BB1F-1B8269DEA718__BABHCJJD">示例1-1</a>说明了定义和填充此类型的分层地理维度。
                     </p>
                     <p>通常，在定义层次结构维度后，可以为该维度定义以下对象：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>列表维度，列出维度层次结构的名称。有关详细信息和示例，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-C549C23C-B212-46F3-9554-7EF66DED9843">Hierlist维度</a> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>用于定义层次结构的父级关系。当维度为其定义了父级时，维度只是一个层次维度。有关更多信息和示例，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-DDB9F83C-9589-4E2C-A1F2-9B64742C7B73">Parentrel关系</a> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>levellist关系，列出所有层次结构的所有级别的名称。有关更多信息和示例，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-247C1B87-E4E3-4313-8E2E-D18DA9F2F290">Levellist Dimension</a> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>hierlevels valueset，即每个层次结构的级别值。有关更多信息和示例，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-960FA7B3-D459-47FA-9B04-8A8D259BDEC7">Hierlevels Valueset</a> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>inhier valueset或变量，用于标识每个层次结构的值。有关更多信息和示例，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-3AEE9CB7-E70C-4D78-B02B-ECE81F012EE9">Inhier值集或变量</a> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>levelrel关系，它将层次维度的每个值与层次结构中的级别相关联。有关更多信息和示例，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-9CC46DC7-F8B4-417C-8094-493613FA8735">Levelrel关系</a> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>familyrel关系，即每个层次维度值及其相关值。有关更多信息和示例，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-AFD82568-4D30-43B1-A193-AD553DB11A1C">Familyrel关系</a> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>gidrel关系，它是每个层次结构中每个值的分组ID。有关更多信息和示例，请参阅<span class="q">“ <a href="olap-dml-basic-concepts.html#GUID-195094D6-3CD6-4E52-8161-06E5C3DE3E29">Gidrel关系</a> ”</span> 。
                           </p>
                        </li>
                     </ul>
                     <div class="example" id="GUID-A6C8F1DD-9AAE-4031-BB1F-1B8269DEA718__BABHCJJD">
                        <p class="titleinexample">示例1-1定义和填充分层维度命名的geog</p><pre class="oac_no_warn" dir="ltr">DEFINE geog DIMENSION TEXT LD具有两个层次结构的地理位置“使用城市，州，地区和国家/地区值填充维度维护地理位置ADD'波士顿''斯普林菲尔德''哈特福德''曼斯菲尔德''蒙特利尔''Walla Walla''波特兰''奥克兰''圣地亚哥''MA''CT''WA''CA''魁北克''东''西''所有地区''美国''加拿大''所有国家'“显示geog REPORT中的价值观geog GEOG --------------波士顿斯普林菲尔德哈特福德曼斯菲尔德蒙特利尔Walla Walla波特兰奥克兰圣地亚哥MA CT WA CA魁北克东西部所有地区美国加拿大所有国家</pre></div>
                     <!-- class="example" -->
                  </div><a id="OLADM1060"></a><a id="OLADM119"></a><div class="props_rev_3"><a id="GUID-C549C23C-B212-46F3-9554-7EF66DED9843" name="GUID-C549C23C-B212-46F3-9554-7EF66DED9843"></a><h5 id="OLADM-GUID-C549C23C-B212-46F3-9554-7EF66DED9843" class="sect5"><span class="enumeration_section">1.5.2.1</span> Hierlist维度</h5>
                     <div>
                        <p>层次结构维度是分析工作空间中的<code class="codeph">TEXT</code>维度，其具有作为值的层次结构维度的层次结构的名称。例如，如果公司具有不同的日历和会计年度，则该公司的时间维度将具有两个层次结构：一个用于日历，另一个用于年份。支持该时间层次结构的hierlist维度将具有两个值：Calendar和Fiscal。
                        </p>
                        <p>为了保持一致性，分析工作空间包括每个层次维度的层级维度 - 即使该层次维度只有一个层次结构。</p>
                        <div class="example" id="GUID-C549C23C-B212-46F3-9554-7EF66DED9843__BABDDIGC">
                           <p class="titleinexample">示例1-2定义和填充名单维度命名geog_hierlist</p>
                           <p>此示例说明了定义和填充此类型的维度。</p><pre class="oac_no_warn" dir="ltr">DEFINE geog_hierlist DIMENSION TEXT LD geog维度的层次结构列表“填充geog_hierlist维度MAINTAIN geog_hierlist ADD'Resional_Geog''Drint_Geog'”显示geog_hierlist维度的值REPORT geog_hierlist GEOG_HIERLIST -------------- Political_Geog Sales_Geog</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="OLADM1061"></a><a id="OLADM120"></a><div class="props_rev_3"><a id="GUID-DDB9F83C-9589-4E2C-A1F2-9B64742C7B73" name="GUID-DDB9F83C-9589-4E2C-A1F2-9B64742C7B73"></a><h5 id="OLADM-GUID-DDB9F83C-9589-4E2C-A1F2-9B64742C7B73" class="sect5"><span class="enumeration_section">1.5.2.2</span>父母关系</h5>
                     <div>
                        <p>父亲关系是层次维度与自身（自我关系）和层次结构维度之间的关系。它标识层次结构中每个维度成员的父级。</p>
                        <div class="example" id="GUID-DDB9F83C-9589-4E2C-A1F2-9B64742C7B73__BABGJHHC">
                           <p class="titleinexample">示例1-3定义和填充父类关系名为geog_parentrel</p>
                           <p>此示例说明了定义和填充此类关系。</p><pre class="oac_no_warn" dir="ltr">“定义关系DEFINE geog_parentrel RELATION geog &lt;geog geog_hierlist&gt; LD自我关系显示每个值的父项的geog”填充关系中的每个单元格“与geog值的父项”此示例使用带有QDR的赋值语句来执行geog_parentrel （geog_hierlist'Sales_Geog'geog'Boston'）='MA'geog_parentrel（geog_hierlist'Sales_Geog'geog'Hartford'）='CT'geog_parentrel（geog_hierlist'Sales_Geog'geog'Springfield'）='MA'geog_parentrel（geog_hierlist'Drint_Geog' geog'Mansfield'）='CT'geog_parentrel（geog_hierlist'Sales_Geog'geog'Montite'）='魁北克'geog_parentrel（geog_hierlist'Sales_Geog'geog'Walla Walla'）='WA'geog_parentrel（geog_hierlist'Sales_Geog'geog'Portland' ）='WA'geog_parentrel（geog_hierlist'Sales_Geog'geog'Oakland'）='CA'geog_parentrel（geog_hierlist'Sales_Geog'geog'San Diego'）='CA'geog_parentrel（geog_hierlist'Sales_Geog'geog'CT'）='东'geog_parentrel（geog_hierlist'Sales_Geog'geog'MA'）='E ast'geog_parentrel（geog_hierlist'Sales_Geog'geog'WA'）='West'geog_parentrel（geog_hierlist'Sales_Geog'geog'CA'）='West'geog_parentrel（geog_hierlist'Sales_Geog'geog'Cublin'）='East'geog_parentrel（geog_hierlist 'Sales_Geog'geog'East'）='所有地区'geog_parentrel（geog_hierlist'Sales_Geog'geog'West'）='所有地区'geog_parentrel（geog_hierlist'Resional_Geog'geog'Boston'）='MA'geog_parentrel（geog_hierlist'Resional_Geog' geog'Hartford'）='CT'geog_parentrel（geog_hierlist'Ederal_Geog'geog'Springfield'）='MA'geog_parentrel（geog_hierlist'Resional_Geog'geog'Mansfield'）='CT'geog_parentrel（geog_hierlist'Resional_Geog'geog'Monttel'） ='魁北克'geog_parentrel（geog_hierlist'Ederal_Geog'geog'Walla Walla'）='WA'geog_parentrel（geog_hierlist'Resional_Geog'geog'Portland'）='WA'geog_parentrel（geog_hierlist'Resional_Geog'geog'Oakland'）='CA' geog_parentrel（geog_hierlist'Resional_Geog'geog'San Diego'）='CA'geog_paren trel（geog_hierlist'Ederal_Geog'geog'CT'）='USA'geog_parentrel（geog_hierlist'Ederal_Geog'geog'MA'）='USA'geog_parentrel（geog_hierlist'Resional_Geog'geog'WA'）='USA'geog_parentrel（geog_hierlist'Resional_Geog 'geog'CA'）='美国'geog_parentrel（geog_hierlist'Political_Geog'geog'魁北克'）='加拿大'geog_parentrel（geog_hierlist'Resional_Geog'geog'USA'）='所有国家'geog_parentrel（geog_hierlist'Resional_Geog'geog'加拿大'）='所有国家'“显示geog_parentrel的值REPORT DOWN geog W 20 geog_parentrel ------------- GEOG_PARENTREL -------------- --- ----------- GEOG_HIERLIST -------------- GEOG Political_Geog Sales_Geog -------------- ------- ------------- -------------------- Boston MA MA Springfield MA MA Hartford CT CT Mansfield CT CT Montreal Quebec Quebec Walla Walla WA WA Portland WA WA Oakland CA CA圣地亚哥CA CA MA美国东部CT美国东部WA美国西部CA美国西魁北克加拿大东部NA所有地区West NA所有地区所有地区NA NA美国所有国家NA加拿大所有国家NA所有国家NA NA</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="OLADM1062"></a><a id="OLADM121"></a><div class="props_rev_3"><a id="GUID-247C1B87-E4E3-4313-8E2E-D18DA9F2F290" name="GUID-247C1B87-E4E3-4313-8E2E-D18DA9F2F290"></a><h5 id="OLADM-GUID-247C1B87-E4E3-4313-8E2E-D18DA9F2F290" class="sect5"><span class="enumeration_section">1.5.2.3</span> Levellist维度</h5>
                     <div>
                        <p>levellist维度是TEXT维度，其具有作为值的名称，层次维度的层次结构的所有级别。</p>
                        <div class="example" id="GUID-247C1B87-E4E3-4313-8E2E-D18DA9F2F290__BABBIIEA">
                           <p class="titleinexample">示例1-4定义和填充levellist维度命名为geog_levellist</p>
                           <p>此示例说明了定义和填充此类型的维度。</p><pre class="oac_no_warn" dir="ltr">DEFINE geog_levellist DIMENSION TEXT LD地理维度层次结构使用的级别列表“使用”Political_Geog和Sales_Geog层次结构的级别名称填充geog_levellist维度MAINTAIN geog_levellist ADD'所有国家/地区''国家/地区'所有地区''区域'MAINTAIN geog_levellist ADD'State-Prov''City'“显示geog_levellist维度的价值报告geog_levellist GEOG_LEVELLIST --------------所有国家国家所有地区Region-Provor City</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="OLADM1063"></a><a id="OLADM122"></a><div class="props_rev_3"><a id="GUID-960FA7B3-D459-47FA-9B04-8A8D259BDEC7" name="GUID-960FA7B3-D459-47FA-9B04-8A8D259BDEC7"></a><h5 id="OLADM-GUID-960FA7B3-D459-47FA-9B04-8A8D259BDEC7" class="sect5"><span class="enumeration_section">1.5.2.4</span> Hierlevels Valueset</h5>
                     <div>
                        <p>层级值集是层级维度的每个层次结构中包含的层级维度（通常从下到上排序）的值。</p>
                        <div class="example" id="GUID-960FA7B3-D459-47FA-9B04-8A8D259BDEC7__BABCCIGF">
                           <p class="titleinexample">示例1-5定义和填充名为geog_hierlevels的hierlevels Valueset</p>
                           <p>此示例说明了如何定义和填充此类型的值集。</p><pre class="oac_no_warn" dir="ltr">DEFINE geog_hierlevels VALUESET geog_levellist &lt;geog_hierlist&gt;“使用LIMIT使用每个层次结构的适当值填充值集LIMIT geog_hierlevels TO ALL</pre><pre class="oac_no_warn" dir="ltr">LIMIT geog_hierlevels（geog_hierlist'Resional_Geog'）TO'City''State-Prov''Country''On All Country'</pre><pre class="oac_no_warn" dir="ltr">LIMIT geog_hierlevels（geog_hierlist'Sales_Geog'）TO'City''State-Prov''Region''All Regions'“显示值集中的值REPORT W 22 geog_hierlevels GEOG_HIERLIST GEOG_HIERLEVELS ------------- -  ---------------------- Political_Geog City State-Prov Country All Country Sales_Geog City State-Prov Region所有地区</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="OLADM1064"></a><a id="OLADM1065"></a><a id="OLADM123"></a><div class="props_rev_3"><a id="GUID-3AEE9CB7-E70C-4D78-B02B-ECE81F012EE9" name="GUID-3AEE9CB7-E70C-4D78-B02B-ECE81F012EE9"></a><h5 id="OLADM-GUID-3AEE9CB7-E70C-4D78-B02B-ECE81F012EE9" class="sect5"><span class="enumeration_section">1.5.2.5</span> Inhier值集或变量</h5>
                     <div>
                        <p>inhier值集是每个层次结构中的inhier维度的值。</p>
                        <p>inhier变量是BOOLEAN变量，其由分层维度和hierlist维度标注。对于每个层次结构，它对于该层次结构中的每个维值都具有TRUE值。</p>
                        <div class="example" id="GUID-3AEE9CB7-E70C-4D78-B02B-ECE81F012EE9__BABIEFEG">
                           <p class="titleinexample">示例1-6定义和填充inhier值集名称geog_inhier</p>
                           <p>此示例说明了定义和填充inhier值集。</p><pre class="oac_no_warn" dir="ltr">“定义值集DEFINE geog_inhier VALUESET geog &lt;geog_hierlist&gt;”使用LIMIT命令，填充值集LIMIT geog_inhier（geog_hierlist'Resitical_Geog'）删除'东''西''所有区域'LIMIT geog_inhier（geog_hierlist'Sales_Geog'）删除'加拿大' 'USA''All Country'“显示值集中的值REPORT W 20 geog_inhier GEOG_HIERLIST GEOG_INHIER -------------- ---------------- ---- Political_Geog波士顿斯普林菲尔德哈特福德曼斯菲尔德蒙特利尔Walla Walla波特兰奥克兰圣地亚哥MA CT WA加拿大魁北克省美国加拿大所有国家销售_Geog波士顿斯普林菲尔德哈特福德曼斯菲尔德蒙特利尔Walla Walla波特兰奥克兰圣地亚哥MA CT WA CA魁北克东西所有区域</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-3AEE9CB7-E70C-4D78-B02B-ECE81F012EE9__BABGBCDG">
                           <p class="titleinexample">示例1-7定义和填充inhier变量命名为geog_inhiervar</p>
                           <p>此示例说明了定义和填充inhier变量值集。</p><pre class="oac_no_warn" dir="ltr">DEFINE geog_inhiervar VARIABLE BOOLEAN &lt;geog geog_hierlist&gt;“使用LIMIT命令和赋值语句，填充”变量LIMIT geog_hierlist TO ALL LIMIT geog_hierlist TO'Resitical_Geog'LIMIT geog TO'East''West''All Regions'geog_inhiervar = FALSE LIMIT geog COMPLEMENT geog_inhiervar = TRUE LIMIT geog_hierlist TO ALL LIMIT geog_hierlist TO'Main Sales_Geog'LIMIT geog TO ALL LIMIT geog TO'Canada''USA''All Country'geog_inhiervar = FALSE LIMIT geog COMPLEMENT geog_inhiervar = TRUE LIMIT geog TO ALL LIMIT geog_hierlist TO ALL“显示值变量REPORT DOWN geog geog_inhiervar --- GEOG_INHIERVAR ---- ---- GEOG_HIERLIST ---- Political_GEOG Geog Sales_Geog -------------- -------- -  ----------波士顿是的是斯普林菲尔德是的哈特福德是的曼斯菲尔德是的蒙特利尔是的是沃拉沃拉是的是波特兰是的奥克兰是的是圣地亚哥是的是的是的是是的是CT是的是是的WA是的是的CA是是魁北克是是东部没有是西部没有是所有地区没有是美国是没有可以ada是否所有国家是否</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="OLADM1066"></a><a id="OLADM124"></a><div class="props_rev_3"><a id="GUID-9CC46DC7-F8B4-417C-8094-493613FA8735" name="GUID-9CC46DC7-F8B4-417C-8094-493613FA8735"></a><h5 id="OLADM-GUID-9CC46DC7-F8B4-417C-8094-493613FA8735" class="sect5"><span class="enumeration_section">1.5.2.6</span>级别关系</h5>
                     <div>
                        <p>levelrel关系是levellist和hierlist维度之间的关系，它记录层次维度的每个成员的级别</p>
                        <div class="example" id="GUID-9CC46DC7-F8B4-417C-8094-493613FA8735__BABCJBFI">
                           <p class="titleinexample">示例1-8定义和填充名为geog_levelrel的levelrel关系</p>
                           <p>此示例说明了定义和填充此类关系。</p><pre class="oac_no_warn" dir="ltr">“定义关系DEFINE geog_levelrel RELATION geog_levellist &lt;geog geog_hierlist&gt;地理位置每个维度成员的LD级别”填充关系“此示例使用赋值语句与QDR填充geog_levelrel（geog_hierlist'Sales_Geog'geog'Boston'）='City'geog_levelrel （geog_hierlist'Sales_Geog'geog'Hartford'）='城市'geog_levelrel（geog_hierlist'Sales_Geog'geog'Springfield'）='城市'geog_levelrel（geog_hierlist'Sales_Geog'geog'Mansfield'）='城市'geog_levelrel（geog_hierlist'Drint_Geog' geog'蒙特利尔'）='城市'geog_levelrel（geog_hierlist'Sales_Geog'geog'Walla Walla'）='城市'geog_levelrel（geog_hierlist'Sales_Geog'geog'Portland'）='城市'geog_levelrel（geog_hierlist'Sales_Geog'geog'Oakland' ）='城市'geog_levelrel（geog_hierlist'Sales_Geog'geog'圣地亚哥'）='城市'geog_levelrel（geog_hierlist'Sales_Geog'geog'CT'）='State-Prov'geog_levelrel（geog_hierlist'Sales_Geog'geog'MA'）= 'State-Prov'geog_levelrel（geog_hierlist'S ales_Geog'geog'WA'）='State-Prov'geog_levelrel（geog_hierlist'Sales_Geog'geog'CA'）='State-Prov'geog_levelrel（geog_hierlist'Sales_Geog'geog'Cublin'）='State-Prov'geog_levelrel（geog_hierlist 'Sales_Geog'geog'East'）='地区'geog_levelrel（geog_hierlist'Sales_Geog'geog'West'）='地区'geog_levelrel（geog_hierlist'Sales_Geog'地理'所有地区'）='所有地区'geog_levelrel（geog_hierlist'Resional_Geog' geog'Boston'）='城市'geog_levelrel（geog_hierlist'Ederal_Geog'geog'Hartford'）='城市'geog_levelrel（geog_hierlist'Resional_Geog'geog'Springfield'）='城市'geog_levelrel（geog_hierlist'Estolge_Geog'geog'Mansfield'） ='City'geog_levelrel（geog_hierlist'Ederal_Geog'geog'Montite'）='City'geog_levelrel（geog_hierlist'Resional_Geog'geog'Walla Walla'）='City'geog_levelrel（geog_hierlist'Resional_Geog'geog'Tortland'）='City' geog_levelrel（geog_hierlist'Resional_Geog'geog'Oakland'）='City'geog_levelrel（geog_hierlist'Pol itical_Geog'geog'圣地亚哥'）='城市'geog_levelrel（geog_hierlist'Ederal_Geog'geog'CT'）='State-Prov'geog_levelrel（geog_hierlist'Resional_Geog'geog'MA'）='State-Prov'geog_levelrel（geog_hierlist' Political_Geog'geog'WA'）='State-Prov'geog_levelrel（geog_hierlist'Resitical_Geog'geog'CA'）='State-Prov'geog_levelrel（geog_hierlist'Resitical_Geog'geog'Cublin'）='State-Prov'geog_levelrel（geog_hierlist 'Political_Geog'geog'USA'）='Country'geog_levelrel（geog_hierlist'Ederal_Geog'geog'Canada'）='Country'geog_levelrel（geog_hierlist'Resitical_Geog'geog'All Country'）='All Country'“显示值REPORT DOWN geog W 20 geog_levelrel -------------- GEOG_LEVELREL -------------- -------------- GEOG_HIERLIST-- ------------ GEOG Political_Geog Sales_Geog -------------- --------------------  - -------------------波士顿市斯普林菲尔德市哈特福德市曼斯菲尔德市市蒙特利尔市沃拉沃拉市波特兰市奥克拉市城市圣地亚哥城市马萨诸塞州 - 弗朗西斯科州 - 弗朗索瓦州 - 弗朗西斯科州 - 普罗维登州 - 加利福尼亚州 - 弗朗索瓦州 - 魁北克省 - 弗朗索瓦州 - 东北地区西北地区所有地区NA所有地区美国国家NA加拿大国家NA所有国家所有国家NA</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="OLADM1067"></a><a id="OLADM125"></a><div class="props_rev_3"><a id="GUID-AFD82568-4D30-43B1-A193-AD553DB11A1C" name="GUID-AFD82568-4D30-43B1-A193-AD553DB11A1C"></a><h5 id="OLADM-GUID-AFD82568-4D30-43B1-A193-AD553DB11A1C" class="sect5"><span class="enumeration_section">1.5.2.7</span>家庭关系</h5>
                     <div>
                        <p>familyrel关系是层次维度与levellist和hierlist维度之间的关系，它提供层次结构中每个维度成员的完整父级。</p>
                        <div class="example" id="GUID-AFD82568-4D30-43B1-A193-AD553DB11A1C__BABJGJID">
                           <p class="titleinexample">示例1-9定义和填充名为geog_familyrel的familyrel关系</p>
                           <p>此示例说明了定义和填充此类关系。</p><pre class="oac_no_warn" dir="ltr">“定义关系DEFINE geog_familyrel RELATION geog &lt;geog geog_levellist geog_hierlist&gt; LD FEATURES族/祖先结构的地理维度”使用HIERHEIGHT命令填充关系HIERHEIGHT geog_parentrel INTO geog_familyrel使用geog_levelrel“显示familyrel关系的值”首先是值将显示Political_Geog层次结构“然后Sales_Geog层次结构的值REPORT DOWN geog W 12 geog_familyrel GEOG_HIERLIST：Political_Geog ---------------------------- --- GEOG_FAMILYREL -------------------------------- -------------- ----------------- GEOG_LEVELLIST -------------------------------- GEOG所有国家所有地区所在地区State-Prov City -------------- ------------ ------------- ----------- ------------ ------------ ------------波士顿全国美国NA NA MA波士顿斯普林菲尔德所有国家美国NA NA MA斯普林菲尔德哈特福德所有国家美国NA NA CT哈特福德曼斯菲尔德所有国家美国NA NA CT Mansfield蒙特利尔所有国家y加拿大NA NA魁北克省蒙特利尔Walla Walla所有国家美国NA NA WA Walla Walla波特兰所有国家美国NA NA WA波特兰奥克兰所有国家美国NA NA CA奥克兰圣地亚哥所有国家美国NA NA CA圣地亚哥MA所有国家美国NA NA MA NA CT所有国家美国NA NA CT NA WA所有国家美国NA NA WA NA CA所有国家美国NA NA CA NA魁北克省所有加拿大NA NA魁北克省NA国家East NA NA NA NA NA NA西NA NA NA NA NA NA所有地区NA NA NA NA NA NA美国所有国家美国NA NA NA NA加拿大所有国家加拿大NA NA NA NA所有国家所有国家NA NA NA NA NA GEOG_HIERLIST：Sales_Geog ------------------ ------------- GEOG_FAMILYREL -------------------------------- ---- --------------------------- GEOG_LEVELLIST ---------------------- ---------- GEOG所有国家所有地区所在地区State-Prov City -------------- ------------ --- --------- ------------ ------------ ------------ ----- -------波士顿NA NA所有地区East MA Boston Springfield NA NA所有地区East MA Springfield Hartford NA N. A所有地区East CT Hartford Mansfield NA NA所有地区East CT Mansfield Montreal NA NA所有地区East Quebec Montreal Walla Walla NA NA所有地区West WA Walla Walla波特兰NA NA所有地区West WA Portland Oakland NA NA所有地区West CA Oakland San Diego NA NA所有地区West CA San Diego MA NA NA所有地区East MA NA CT NA NA所有地区East CT NA WA NA NA所有地区West WA NA CA NA NA所有地区West CA NA魁北克省NA NA所有地区East Quebec NA East NA NA所有地区East NA NA West NA NA所有地区West NA NA所有地区NA NA所有地区NA NA NA美国NA NA NA NA NA NA加拿大NA NA NA NA NA NA所有国家NA NA NA NA NA NA</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="OLADM1068"></a><a id="OLADM126"></a><div class="props_rev_3"><a id="GUID-195094D6-3CD6-4E52-8161-06E5C3DE3E29" name="GUID-195094D6-3CD6-4E52-8161-06E5C3DE3E29"></a><h5 id="OLADM-GUID-195094D6-3CD6-4E52-8161-06E5C3DE3E29" class="sect5"><span class="enumeration_section">1.5.2.8</span> Gidrel关系</h5>
                     <div>
                        <p>gidrel关系是NUMBER维度，层次结构维度和hierlist维度之间的关系，该维度包含层次结构维度的每个层次结构中每个维度成员的分组ID。它还有一个$ GID_DEPTH属性，用于标识每个维度成员的层次结构中的深度。</p>
                        <div class="example" id="GUID-195094D6-3CD6-4E52-8161-06E5C3DE3E29__BABGADAH">
                           <p class="titleinexample">示例1-10定义和填充名为geog_gidrel的gidrel关系</p>
                           <p>此示例说明了定义和填充此类关系。</p><pre class="oac_no_warn" dir="ltr">“创建一个值为数字的维度DEFINE gid_dimension DIMENSION NUMBER（38,0）”向该维度添加值“此示例使用MAINTAIN ADD添加一些数字MAINTAIN gid_dimension ADD 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26“定义gidrel关系DEFINE geog_gidrel RELATION gid_dimension &lt;geog geog_hierlist&gt;”显示geog_gidrel关系的完整定义“请注意，它没有属性DEFINE GEOG_GIDREL RELATION GID_DIMENSION &lt;GEOG GEOG_HIERLIST&gt;“使用GROUPINGID命令填充gidrel关系GROUPINGID geog_parentrel INTO geog_gidrel使用geog_levelrel INHIERARCHY geog_inhier”显示geog_gidrel关系的值REPORT down geog w 20 geog_gidrel --------------- GEOG_GIDREL- -------------- -------------- GEOG_HIERLIST -------------- GEOG Political_Geog Sales_Geog ---- ---------- -------------------- -------------------- Boston 0 0 Springfield 0 0 Hartford 0 0 Mansfield 0 0 Montreal 0 0 Walla Wall a 0 0波特兰0 0奥克兰0 0圣地亚哥0 0 MA 1 1 CT 1 1 WA 1 1 CA 1 1魁北克1 1东NA 3西NA 3所有地区NA 7美国3 NA加拿大3 NA所有国家7 NA“显示geog_gidrel关系的完整定义“请注意，它现在有一个$ GID_DEPTH属性DEFINE GEOG_GIDREL RELATION GID_DIMENSION &lt;GEOG GEOG_HIERLIST&gt; PROPERTY'$ GID_DEPTH'4</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="OLADM127"></a><a id="olapdml_statements_apply_to_all_values"></a><div class="props_rev_3"><a id="GUID-D032BBB4-A0ED-41C1-80B7-D93CA5172FD6" name="GUID-D032BBB4-A0ED-41C1-80B7-D93CA5172FD6"></a><h3 id="OLADM-GUID-D032BBB4-A0ED-41C1-80B7-D93CA5172FD6" class="sect3"><span class="enumeration_section">1.6</span> OLAP DML语句适用于数据对象的所有值</h3>
               <div>
                  <p>OLAP DML是一种多维语言。因此，OLAP DML中的操作一次性应用于整个值集。同样，从概念上讲，您可以将这些操作视为应用于变量中所有单元格中的值;或者，在物理上，您可以将这些操作视为应用于作为变量的数组中的所有元素。因此，如果使用OLAP DML赋值语句（即<a href="olap-dml-commands-h-z.html#GUID-F6BA1626-650A-46D0-9C01-B2757981AA27">SET</a>或=），则不需要编写显式循环代码来为变量中的所有元素赋值。相反，当您针对具有一个或多个维度的对象发出语句时，该语句将循环遍历对象的每个维度的状态值并执行所请求的操作。
                  </p>
                  <p>例如，假设有一个名为<code class="codeph">prodid</code>的维度有三个值， <code class="codeph">Prod01</code> ， <code class="codeph">Prod02</code>和<code class="codeph">Prod03</code> ，并且您有一个名为<code class="codeph">quantity</code>的变量，其大小由prodid标注。如下面的代码片段所示，如果<code class="codeph">Prod01</code> ， <code class="codeph">Prod02</code>和<code class="codeph">Prod03</code>都处于状态，当您将值<code class="codeph">3</code>分配给数量时，Oracle OLAP会将值<code class="codeph">3</code>分配给数量中的<span class="italic">所有</span>元素。
                  </p><pre class="oac_no_warn" dir="ltr">数量= 3报告数量PRODID QUANTITY -------------- ---------- PROD01 3.00 PROD02 3.00 PROD03 3.00</pre><p>其他OLAP DML语句（例如，REPORT，ROW和FOR）在执行时也会遍历标注对象的所有in状态元素。</p>
               </div><a id="OLADM128"></a><div class="props_rev_3"><a id="GUID-F1D07FE2-8FE8-48F1-93D7-4F11B983538E" name="GUID-F1D07FE2-8FE8-48F1-93D7-4F11B983538E"></a><h4 id="OLADM-GUID-F1D07FE2-8FE8-48F1-93D7-4F11B983538E" class="sect4"><span class="enumeration_section">1.6.1</span>更改语句的默认循环行为</h4>
                  <div>
                     <p>默认情况下，语句使用对象定义中列出对象维度的顺序循环遍历标注对象的值。此外，当变量由复合体标注时，大多数循环语句循环遍历变量，就好像它没有由复合体标注尺寸，而是由复合体的基础尺寸标注尺寸。</p>
                     <p>OLAP DML提供了更改默认循环行为或显式请求循环的方法：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">ACROSS短语 - 一些</span>循环命令（例如用于分配值的赋值语句）具有一个ACROSS短语，可用于指定非默认循环行为。有关ACROSS短语的详细文档，请参阅<a href="olap-dml-commands-h-z.html#GUID-F6BA1626-650A-46D0-9C01-B2757981AA27">SET</a> （=）命令。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">ACROSS命令</span> - 当OLAP DML语句不是循环语句或不包含ACROSS短语时，可以通过将DML语句编码为<a href="olap-dml-commands-a-g.html#GUID-7B2FF0DE-2E38-4EEC-97CA-DA2D750EE322">ACROSS</a>命令的参数来请求循环行为。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="OLADM129"></a><a id="olapdml_status_etc"></a><div class="props_rev_3"><a id="GUID-8F7E0F9F-2533-4C6F-8868-F998E358A267" name="GUID-8F7E0F9F-2533-4C6F-8868-F998E358A267"></a><h3 id="OLADM-GUID-8F7E0F9F-2533-4C6F-8868-F998E358A267" class="sect3"><span class="enumeration_section">1.7</span>如何指定OLAP DML操作的数据集</h3>
               <div>
                  <p><a id="d9708e1799" class="indexterm-anchor"></a>对于每个定义的维度，Oracle OLAP使用名为<span class="bold">状态列表的列表</span>来跟踪用户可访问的维度值。
                  </p>
               </div><a id="OLADM130"></a><div class="props_rev_3"><a id="GUID-CF2461B3-CCB0-400F-A6EA-6E26C0548052" name="GUID-CF2461B3-CCB0-400F-A6EA-6E26C0548052"></a><h4 id="OLADM-GUID-CF2461B3-CCB0-400F-A6EA-6E26C0548052" class="sect4"><span class="enumeration_section">1.7.1</span>关于状态列表</h4>
                  <div>
                     <p>Oracle OLAP使用两种状态列表：默认状态列表和当前状态列表。分析工作空间中维度的当前状态列表中的值确定在任何给定时刻OLAP DML可用的数据集。</p>
                  </div><a id="OLADM131"></a><div class="props_rev_3"><a id="GUID-D8F4A4D7-492F-4C2C-A57F-668C3826695A" name="GUID-D8F4A4D7-492F-4C2C-A57F-668C3826695A"></a><h5 id="OLADM-GUID-D8F4A4D7-492F-4C2C-A57F-668C3826695A" class="sect5"><span class="enumeration_section">1.7.1.1</span>默认状态列表</h5>
                     <div>
                        <p><a id="d9708e1866" class="indexterm-anchor"></a>维度的<span class="bold">默认状态列表</span>是首次附加分析工作区时，按照存储值的顺序具有读取权限的维度的所有值的列表。您可以通过以下方式更改维度的默认状态列表：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>您可以使用MAINTAIN命令添加，删除，移动，合并和重命名维度中的值，或者以其他方式添加维值（例如，使用SQL FETCH语句）。</p>
                           </li>
                           <li>
                              <p>您可以使用PERMIT或PERMITRESET语句更改与维度关联的值的读取权限。</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="OLADM132"></a><div class="props_rev_3"><a id="GUID-8611903D-26D2-43AC-ABAF-B114DA927EC1" name="GUID-8611903D-26D2-43AC-ABAF-B114DA927EC1"></a><h5 id="OLADM-GUID-8611903D-26D2-43AC-ABAF-B114DA927EC1" class="sect5"><span class="enumeration_section">1.7.1.2</span>当前状态列表</h5>
                     <div>
                        <p><a id="d9708e1910" class="indexterm-anchor"></a>维度的<span class="bold">当前状态列表</span>是维度的当前可访问值的有序列表。维度的当前状态列表中的值被称为“处于状态”。首次附加分析工作区时，每个维的默认和当前状态列表都相同。
                        </p>
                        <p>维度的当前状态列表确定分析工作区中数据的可访问性：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>对于维度，只有当前状态列表中的维度值可见且可供OLAP DML表达式访问。</p>
                           </li>
                           <li>
                              <p>对于像变量这样的带尺寸对象，只有那些由当前状态列表中的维值索引的数据值才可见且可供OLAP DML表达式访问。当通过尺寸对象执行循环时，当前状态列表中的尺寸值的顺序用于确定访问对象的值的顺序。</p>
                           </li>
                        </ul>
                        <p>请注意，该维度的维度和任何代理共享相同的状态。设置维度代理的状态可设置其维度的状态，并设置维度的状态可设置任何维度代理的状态。除非另有说明，否则在本文档中，对尺寸的引用同样适用于尺寸代理。此外，复合材料不是尺寸，因此它们没有任何独立状态。处于状态的复合的值由复合的基本尺寸的状态确定。</p>
                        <div class="infoboxnote" id="GUID-8611903D-26D2-43AC-ABAF-B114DA927EC1__GUID-02E3FA02-F8BA-4C3C-B5F7-95404E47F7BC">
                           <p class="notep1">注意：</p>
                           <p>维度值是否处于状态仅限制OLAP DML在给定会话期间的值视图;它不会永久影响分析工作区中存储的值。</p>
                        </div>
                     </div>
                  </div>
               </div><a id="OLADM133"></a><div class="props_rev_3"><a id="GUID-7F0DD481-EEB1-4305-8460-D98A99BC2BCE" name="GUID-7F0DD481-EEB1-4305-8460-D98A99BC2BCE"></a><h4 id="OLADM-GUID-7F0DD481-EEB1-4305-8460-D98A99BC2BCE" class="sect4"><span class="enumeration_section">1.7.2</span>更改维度的当前状态以使用数据子集</h4>
                  <div>
                     <p>由于维度的当前状态列表决定了分析工作区中数据的可访问性，因此使用分析工作区数据子集的方法是更改一个或多个维度的当前状态列表。</p>
                     <p>您可以使用<a href="olap-dml-commands-h-z.html#GUID-C84F165D-930A-461C-976B-F4C28F6DCA14">LIMIT命令</a>更改维度的当前状态列表中的值和值的顺序。LIMIT命令是一个非常复杂的OLAP DML命令，它允许您通过使用关系明确或隐式指定值来指定当前状态列表中所需的值。在最简单的级别， <a href="olap-dml-commands-h-z.html#GUID-B10D483F-B956-4ABC-A323-23FB02110E59__CCHFGAHI">示例10-20</a>说明了如何使用LIMIT命令更改维度的当前状态列表，以便您可以使用数据子集。
                     </p>
                  </div>
               </div><a id="OLADM134"></a><div class="props_rev_3"><a id="GUID-AE796B68-935E-4A98-8523-89504E251A30" name="GUID-AE796B68-935E-4A98-8523-89504E251A30"></a><h4 id="OLADM-GUID-AE796B68-935E-4A98-8523-89504E251A30" class="sect4"><span class="enumeration_section">1.7.3</span>保存和恢复当前维度状态</h4>
                  <div>
                     <p>有几种不同的方法可以保存维度的当前状态。每种方式的范围都不同：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">任何会话</span> - 要保存当前状态以便在任何会话中使用，请创建具有该状态的命名值集。使用DEFINE VALUESET命令定义值集。使用LIMIT命令将值分配给值集。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">当前会话</span> - 要保存，访问或更新当前状态以在当前会话中使用，请使用命名上下文。使用CONTEXT命令定义上下文。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">当前程序</span> - 要保存当前状态以便在当前程序中使用，请使用PUSHLEVEL和PUSH命令。您可以使用POPLEVEL和POP命令恢复当前状态值。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="OLADM135"></a><div class="props_rev_3"><a id="GUID-A0C2E4F0-1D9F-430B-92A6-7984126C8D1E" name="GUID-A0C2E4F0-1D9F-430B-92A6-7984126C8D1E"></a><h4 id="OLADM-GUID-A0C2E4F0-1D9F-430B-92A6-7984126C8D1E" class="sect4"><span class="enumeration_section">1.7.4</span>在不改变状态的情况下使用数据子集</h4>
                  <div>
                     <p>有时，您希望单独的OLAP DML语句或表达式针对数据子集工作，而不实际更改维度的当前状态列表。为了满足此需求，一些OLAP DML语句允许您指定先前定义的值集对象的名称，而不是维度的名称。此外，您可以在运行中指定数据子集，而无需使用以下方法之一更改维度的当前状态列表：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="olap-dml-functions-a-k.html#GUID-59B502C1-5930-41D0-A183-22FD77BFA076">CHGDIMS</a>函数，在表达式评估期间，更改表达式的维度或更改维度状态。
                           </p>
                        </li>
                        <li>
                           <p><a href="olap-dml-functions-l-z.html#GUID-A47E3C53-1CC5-4546-80D0-FBE3B2F837C1">LIMIT函数</a> ，在表达式求值期间，返回由指定的LIMIT命令或指定的维度状态堆栈生成的维度或维度代理值。
                           </p>
                        </li>
                        <li>
                           <p>如果要在不更改当前状态的情况下指定数据对象的单个值，请使用限定数据引用（QDR），这是一种将表达式的一个或多个维限制为单个值的方法。</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="OLADM136"></a><a id="olapdml_pop_multi_hier_objs"></a><div class="props_rev_3"><a id="GUID-8BCDAF9F-95DC-4C49-9279-96E5D94F01AD" name="GUID-8BCDAF9F-95DC-4C49-9279-96E5D94F01AD"></a><h3 id="OLADM-GUID-8BCDAF9F-95DC-4C49-9279-96E5D94F01AD" class="sect3"><span class="enumeration_section">1.8</span>填充多维分层数据对象</h3>
               <div>
                  <p>通常，您首先从关系表或平面文件中填充变量的基值。然后，使用OLAP DML计算对象从这些基值计算其他值。例如，您可以定义聚合对象以聚合层次结构中较高的值。</p>
                  <p>您还可以使用赋值语句为变量，关系和维度代理分配值（请参阅<a href="olap-dml-commands-h-z.html#GUID-F6BA1626-650A-46D0-9C01-B2757981AA27">SET</a>和<a href="olap-dml-commands-h-z.html#GUID-4EB852D8-726D-4BC3-A0D6-5F631C3355AF">SET1</a> ），并使用<a href="olap-dml-commands-h-z.html#GUID-839F1B74-07B1-43E2-83C9-6B5C651F964E">MAINTAIN</a>语句向维度添加值。
                  </p>
                  <div class="infobox-tip" id="GUID-8BCDAF9F-95DC-4C49-9279-96E5D94F01AD__GUID-DA162434-7D47-4E65-9F04-AC893B62A5E8">
                     <p class="notep1">小费：</p>
                     <p><a href="formulas-models-aggregations-and-allocations.html#GUID-D261BFC7-B50F-45BE-92D6-5800E2627C5B">公式，模型，聚合和分配</a></p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="05930.working-with-labeled-data.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can manage labeled data, view that data of security attributes for a session, and change the value of session attributes."></meta>
      <meta name="description" content="You can manage labeled data, view that data of security attributes for a session, and change the value of session attributes."></meta>
      <title>使用标记数据</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Administrator&#39;s Guide"></meta>
      <meta property="og:description" content="You can manage labeled data, view that data of security attributes for a session, and change the value of session attributes."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Administrator&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="label-security-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-11T09:39:52-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2006, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96303-05"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="creating-an-oracle-label-security-policy.html" title="Previous" type="text/html"></link>
      <link rel="next" href="oracle-label-security-using-oracle-internet-directory.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Label Security Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="OLSAG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="creating-an-oracle-label-security-policy.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="oracle-label-security-using-oracle-internet-directory.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">管理员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part2.html" property="item" typeof="WebPage"><span property="name">使用Oracle Label Security功能</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用标记数据</li>
            </ol>
            <a id="GUID-75401780-723A-4EA5-AEDB-751E48AFC1DA" name="GUID-75401780-723A-4EA5-AEDB-751E48AFC1DA"></a><a id="OLSAG019"></a>
            
            <h2 id="OLSAG-GUID-75401780-723A-4EA5-AEDB-751E48AFC1DA" class="sect2"><span class="enumeration_chapter">6</span>使用标记数据</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以管理标记数据，查看会话的安全属性数据，以及更改会话属性的值。</p>
               <div class="infoboxnote" id="GUID-75401780-723A-4EA5-AEDB-751E48AFC1DA__GUID-FAD36A82-6D31-4FF4-964D-73738A8BB3DC">
                  <p class="notep1">注意：</p>
                  <p>本指南中的许多示例都使用<code class="codeph">HUMAN_RESOURCES</code>示例策略。其策略名称为<code class="codeph">HR</code> ，其策略标签<code class="codeph">HR_LABEL</code> 。除非另有说明，否则这些示例假定SQL语句是在用户授权范围内的行上执行的，并且实施了完整的Oracle Label Security策略实施。
                  </p>
               </div>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-2C84DF95-0A12-4BBA-94C8-4FF369C54128">策略标签列和标签标签的工作原理</a><br>您应该了解如何创建和填充表或模式中的策略标签列。
                  </li>
                  <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-74564599-9CF7-4ADC-9FB2-C6E8E271DA66">标签分配给数据行</a><br>对于现有数据行，可以通过您创建的标签功能分配标签。
                  </li>
                  <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-456D3AA7-1C21-428A-80B4-C1C3C41FD241">提出标签</a><br>检索标签时，不会自动获取字符串值。
                  </li>
                  <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-620518A2-9072-427C-9560-3F9F165F1247">使用标签过滤数据</a><br>处理SQL语句时，Oracle Label Security会通过create-and-apply过程调用数据库中定义的安全策略。
                  </li>
                  <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-ED5DA711-477C-42D9-B03C-866A909DDE23">插入标记数据</a><br>您可以在各种情况下插入带标签的数据。
                  </li>
                  <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-52C240C0-D5B3-4F9A-9C83-F8AA2FC360DF">更改会话和行标签</a><br>在会话期间，用户可以根据管理员设置的授权更改标签。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="part2.html" title="第II部分介绍了如何使用Oracle Label Security功能。">使用Oracle Label Security功能</a></p>
                  </div>
               </div>
            </div>
            <a id="OLSAG020"></a><div class="props_rev_3"><a id="GUID-2C84DF95-0A12-4BBA-94C8-4FF369C54128" name="GUID-2C84DF95-0A12-4BBA-94C8-4FF369C54128"></a><h3 id="OLSAG-GUID-2C84DF95-0A12-4BBA-94C8-4FF369C54128" class="sect3">策略标签列和标签标签的工作原理</h3>
               <div>
                  <p>您应该了解如何创建和填充表或模式中的策略标签列。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-79742979-FD64-4C78-ADCF-229D039D6777">政策标签栏</a><br>您应该了解如何使用策略标签列。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-C5D22293-2F11-4C83-B281-ADCA31D28D07">标签标签</a><br>您可以创建定义标签组件的标签标签，手动或自动生成标签标签。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-75401780-723A-4EA5-AEDB-751E48AFC1DA" title="您可以管理标记数据，查看会话的安全属性数据，以及更改会话属性的值。">使用标记数据</a></p>
                     </div>
                  </div>
               </div>
               <a id="OLSAG3143"></a><div class="props_rev_3"><a id="GUID-79742979-FD64-4C78-ADCF-229D039D6777" name="GUID-79742979-FD64-4C78-ADCF-229D039D6777"></a><h4 id="OLSAG-GUID-79742979-FD64-4C78-ADCF-229D039D6777" class="sect4">政策标签栏</h4>
                  <div>
                     <p>您应该了解如何使用策略标签列。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-AB80CDA9-7900-48B2-99C1-01AC3389C39B">关于策略标签列</a><br>应用于表的每个策略都会在数据库中创建一个列。
                        </li>
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-62D8E07A-EC69-4EF7-A0B4-5FC69B476152">隐藏策略标签列</a><br>您可以选择不显示表示策略的列。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-2C84DF95-0A12-4BBA-94C8-4FF369C54128" title="您应该了解如何创建和填充表或模式中的策略标签列。">策略标签列和标签标签的工作方式</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-AB80CDA9-7900-48B2-99C1-01AC3389C39B" name="GUID-AB80CDA9-7900-48B2-99C1-01AC3389C39B"></a><h5 id="OLSAG-GUID-AB80CDA9-7900-48B2-99C1-01AC3389C39B" class="sect5">关于策略标签列</h5>
                     <div>
                        <p>应用于表的每个策略都会在数据库中创建一个列。</p>
                        <p>默认情况下， <code class="codeph">NUMBER</code>的数据类型。</p>
                        <p>该策略的每一行标签由该列中的标记表示，使用字符串标签值的等效数字。创建标签时会自动生成label标签，除非管理员在此时手动指定标签。</p>
                        <p>自动标签生成遵循管理员在定义标签组件时建立的规则，如<a href="understanding-data-labels-and-user-labels.html#GUID-F29D48CE-EE9A-495E-A35B-55B38BAB1FDB" title="您应该了解数据标签和用户标签的基本概念。">了解数据标签和用户标签中所述</a> 。
                        </p>
                        <div class="infoboxnote" id="GUID-AB80CDA9-7900-48B2-99C1-01AC3389C39B__GUID-0DC50335-4B38-4BE8-8B20-0ABD890B475F">
                           <p class="notep1">注意：</p>
                           <p>创建策略的行为本身对表或模式没有任何影响。它仅将策略应用于表或模式。</p>
                        </div>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-79742979-FD64-4C78-ADCF-229D039D6777" title="您应该了解如何使用策略标签列。">策略标签列</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="OLSAG3776"></a><a id="OLSAG3777"></a><a id="OLSAG3144"></a><div class="props_rev_3"><a id="GUID-62D8E07A-EC69-4EF7-A0B4-5FC69B476152" name="GUID-62D8E07A-EC69-4EF7-A0B4-5FC69B476152"></a><h5 id="OLSAG-GUID-62D8E07A-EC69-4EF7-A0B4-5FC69B476152" class="sect5">隐藏策略标签列</h5>
                     <div>
                        <p>您可以选择不显示表示策略的列。</p>
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要隐藏列的显示，请将<code class="codeph">HIDE</code>选项应用于表。
                                 </p>
                              </li>
                           </ul>
                           <p>将使用<code class="codeph">HIDE</code>的策略应用于表后，执行<code class="codeph">SELECT *</code>或执行<code class="codeph">DESCRIBE</code>操作的用户将看不到策略标签列。如果未隐藏策略标签列，则标签标签将显示为数据类型<code class="codeph">NUMBER</code> 。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-62D8E07A-EC69-4EF7-A0B4-5FC69B476152__GUID-855983C6-9E44-4631-8A69-6D2452E1A3B0">示例1：数字列数据类型（NUMBER）</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">描述EMP;名字空？输入----------------------------------------- -------- -------- EMPNO NOT NULL NUMBER（4）ENAME CHAR（10）JOB CHAR（9）MGR NUMBER（4）SAL NUMBER（7,2）DEPTNO NOT NULL NUMBER（2）HR_LABEL NUMBER（10）</pre></div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-62D8E07A-EC69-4EF7-A0B4-5FC69B476152__BEIIGDED">
                           <p class="subhead3" id="GUID-62D8E07A-EC69-4EF7-A0B4-5FC69B476152__GUID-C97E7D03-D8F3-4A74-A047-B53DAA16E534">示例2：具有隐藏列的数字列数据类型</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>请注意，在此示例中， <span class="italic">不</span>显示<code class="codeph">HR_LABEL</code>列。
                           </p><pre class="oac_no_warn" dir="ltr">描述EMP;名字空？输入----------------------------------------- -------- -------- EMPNO NOT NULL NUMBER（4）ENAME CHAR（10）JOB CHAR（9）MGR NUMBER（4）SAL NUMBER（7,2）DEPTNO NOT NULL NUMBER（2）</pre></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="implementing-policy-enforcement-options-and-labeling-functions.html#GUID-26ABB868-ADB3-44D0-B5A0-3CAF9C5EC627" title="将Oracle Label Security策略列添加到表时，可以指定HIDE策略配置选项。">HIDE策略列选项的工作原理</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-79742979-FD64-4C78-ADCF-229D039D6777" title="您应该了解如何使用策略标签列。">策略标签列</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div><a id="OLSAG3147"></a><div class="props_rev_3"><a id="GUID-C5D22293-2F11-4C83-B281-ADCA31D28D07" name="GUID-C5D22293-2F11-4C83-B281-ADCA31D28D07"></a><h4 id="OLSAG-GUID-C5D22293-2F11-4C83-B281-ADCA31D28D07" class="sect4">标签标签</h4>
                  <div>
                     <p>您可以创建定义标签组件的标签标签，手动或自动生成标签标签。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-5E1035D0-A49E-4E64-BF18-D7BCF8B8BF0F">关于标签标签</a><br>管理员首先定义要在策略中使用的一组标签组件。
                        </li>
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-F440D44F-937B-4834-88EF-670CD4DAD4E8">手动定义标签以订购标签</a><br>通过手动定义标签标签，您可以实施一种数据操作策略，允许对标签进行有意义的排序和比较。
                        </li>
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-3EFA07B1-6338-46AA-BB10-98274B39C250">手动定义标签标签来操纵数据</a><br>管理定义的标签标签是引用完整标签字符串（即标签组件的组合）的便捷方式。
                        </li>
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-8243B357-8FEA-43CB-BF42-F7DFA7496865">自动生成的标签标签</a><br>动态生成的标签标签有10个数字，与分配给任何标签组件的数字无关。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-2C84DF95-0A12-4BBA-94C8-4FF369C54128" title="您应该了解如何创建和填充表或模式中的策略标签列。">策略标签列和标签标签的工作方式</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-5E1035D0-A49E-4E64-BF18-D7BCF8B8BF0F" name="GUID-5E1035D0-A49E-4E64-BF18-D7BCF8B8BF0F"></a><h5 id="OLSAG-GUID-5E1035D0-A49E-4E64-BF18-D7BCF8B8BF0F" class="sect5">关于标签标签</h5>
                     <div>
                        <p>管理员首先定义要在策略中使用的一组标签组件。</p>
                        <p>创建标签时，管理员指定可组成标签的组件的有效组合集，即可选择与一个或多个组或隔室组合的级别。</p>
                        <p>策略中的每个此类有效标签由管理员分配的关联数字标签唯一标识，或在首次使用时自动生成。手动定义的优点是允许管理员在对标签值进行排序或逻辑比较时控制标签值的排序。</p>
                        <p>但是，标签标记在数据库中的所有策略中必须是唯一的。在数据库中使用多个策略时，不能在不同的策略中使用相同的数字标签标记。请记住，每个标签标签唯一标识一个标签，该数字标签是存储在数据行中的标签，而不是标签的字符串表示。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-C5D22293-2F11-4C83-B281-ADCA31D28D07" title="您可以创建定义标签组件的标签标签，手动或自动生成标签标签。">标签标签</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="OLSAG3149"></a><a id="OLSAG3148"></a><div class="props_rev_3"><a id="GUID-F440D44F-937B-4834-88EF-670CD4DAD4E8" name="GUID-F440D44F-937B-4834-88EF-670CD4DAD4E8"></a><h5 id="OLSAG-GUID-F440D44F-937B-4834-88EF-670CD4DAD4E8" class="sect5">手动定义标签以订购标签</h5>
                     <div>
                        <p>通过手动定义标签标签，您可以实施一种数据操作策略，允许对标签进行有意义的排序和比较。</p>
                        <p>为此，您必须预定义与受保护数据关联的所有标签，并为每个标签分配有意义的标签标签值。手动分配的标签标签最多可包含八位数字。label标签的值必须大于零。</p>
                        <p>实现其中标签标签值与标签组件的数值相关的策略可能是有利的。通过这种方式，您可以使用标记以有意义的方式对数据行进行分组。但是，这种方法不是强制性的。优先考虑将灵敏度较高的标签的标签设置为比较低灵敏度标签的标签更高的数值。</p>
                        <p><a href="working-with-labeled-data.html#GUID-F440D44F-937B-4834-88EF-670CD4DAD4E8__G1014736" title="此表提供了示例标签标签和标签字符串，以帮助进行以下讨论。">表6-1</a>说明了已分配的一组标签标签。请注意，在此示例中，管理员已将标签标记值基于“ <a href="understanding-data-labels-and-user-labels.html#GUID-F29D48CE-EE9A-495E-A35B-55B38BAB1FDB" title="您应该了解数据标签和用户标签的基本概念。">了解数据标签和用户标签”</a>中讨论的级别，隔离专区和行的数字形式。
                        </p>
                        <div class="tblformal" id="GUID-F440D44F-937B-4834-88EF-670CD4DAD4E8__G1014736">
                           <p class="titleintable">表6-1管理定义的标签标签（示例）</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="行政定义的标签标签（示例）" width="100%" border="1" summary="This table provides example label tags and label strings to aid in the discussion that follows." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="30%" id="d25700e748">标签标签</th>
                                    <th align="left" valign="bottom" width="70%" id="d25700e751">标签字符串</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e756" headers="d25700e748 ">
                                       <p>10000</p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e756 d25700e751 ">
                                       <p>P</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e763" headers="d25700e748 ">
                                       <p>20000</p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e763 d25700e751 ">
                                       <p>C</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e770" headers="d25700e748 ">
                                       <p>21000</p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e770 d25700e751 ">
                                       <p>C：FNCL</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e777" headers="d25700e748 ">
                                       <p>21100</p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e777 d25700e751 ">
                                       <p>C：FNCL，OP</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e784" headers="d25700e748 ">
                                       <p>30000</p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e784 d25700e751 ">
                                       <p>小号</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e791" headers="d25700e748 ">
                                       <p>31110</p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e791 d25700e751 ">
                                       <p>S：OP：WR</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e798" headers="d25700e748 ">
                                       <p>40000</p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e798 d25700e751 ">
                                       <p>HS</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e805" headers="d25700e748 ">
                                       <p>42000</p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e805 d25700e751 ">
                                       <p>HS：OP</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>在此示例中，级别为<code class="codeph">PUBLIC</code>标签以“1”开头，级别为<code class="codeph">CONFIDENTIAL</code>标签以“2”开头，级别为<code class="codeph">SENSITIVE</code>标签以“3”开头，级别为<code class="codeph">HIGHLY_SENSITIVE</code>标签以“1”开头。 4" 。
                        </p>
                        <p>带有<code class="codeph">FINANCIAL</code>隔间的标签则在1000范围内，带有隔间<code class="codeph">OP</code>标签在1100范围内，依此类推。例如，十位用于表示组<code class="codeph">WR</code> 。
                        </p>
                        <p>另一种策略可能完全基于组，其中标签可能是3110,3120,3130等。</p>
                        <p>但请注意，标签标签标识<span class="italic">整个</span>标签，与为各个标签组件分配的数值无关。label标签用作整数，而不是一组单独评估的数字。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-C5D22293-2F11-4C83-B281-ADCA31D28D07" title="您可以创建定义标签组件的标签标签，手动或自动生成标签标签。">标签标签</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="OLSAG3150"></a><div class="props_rev_3"><a id="GUID-3EFA07B1-6338-46AA-BB10-98274B39C250" name="GUID-3EFA07B1-6338-46AA-BB10-98274B39C250"></a><h5 id="OLSAG-GUID-3EFA07B1-6338-46AA-BB10-98274B39C250" class="sect5">手动定义标签标签来操纵数据</h5>
                     <div>
                        <p>管理定义的标签标签是引用完整标签字符串（即标签组件的组合）的便捷方式。</p>
                        <p>例如，如<a href="working-with-labeled-data.html#GUID-F440D44F-937B-4834-88EF-670CD4DAD4E8__G1014736" title="此表提供了示例标签标签和标签字符串，以帮助进行以下讨论。">表6-1</a>所示，标签“31110”可代表完整的标签字符串“S：OP：WR”。
                        </p>
                        <p>标签标签可用作分区数据的便捷方式。例如，标签范围为1000  -  1999的所有数据都可以放在表空间A中，标签范围为2000  -  2999的所有数据都可以放在表空间B中，依此类推。</p>
                        <p>当标签数量有限且您需要对它们执行各种操作时，这种简化的表示法也会派上用场。考虑一个公司为许多其他公司提供人力资源系统的情况。假设来自Y公司的所有用户都具有标签“C：ALPHA：CY”，其标签“210”已被设置。要确定Y公司的应用程序用户总数，主机管理员可以输入：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM tab1 WHERE hr_label = 210;</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-C5D22293-2F11-4C83-B281-ADCA31D28D07" title="您可以创建定义标签组件的标签标签，手动或自动生成标签标签。">标签标签</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="OLSAG3152"></a><a id="OLSAG3151"></a><div class="props_rev_3"><a id="GUID-8243B357-8FEA-43CB-BF42-F7DFA7496865" name="GUID-8243B357-8FEA-43CB-BF42-F7DFA7496865"></a><h5 id="OLSAG-GUID-8243B357-8FEA-43CB-BF42-F7DFA7496865" class="sect5">自动生成的标签标签</h5>
                     <div>
                        <p>动态生成的标签标签有10个数字，与分配给任何标签组件的数字无关。</p>
                        <p>您无法按标签对数据进行分组。</p>
                        <p><a href="working-with-labeled-data.html#GUID-8243B357-8FEA-43CB-BF42-F7DFA7496865__G1014767" title="此表列出了示例标签标签和相关标签字符串，供以下讨论使用。">表6-2</a>说明了自动生成的标签标签的工作原理。
                        </p>
                        <div class="tblformal" id="GUID-8243B357-8FEA-43CB-BF42-F7DFA7496865__G1014767">
                           <p class="titleintable">表6-2生成的标签标签（示例）</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="生成的标签标签（示例）" width="100%" border="1" summary="This table lists example label tags and associated label strings for use in the discussion that follows." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="30%" id="d25700e1003">标签标签</th>
                                    <th align="left" valign="bottom" width="70%" id="d25700e1006">标签字符串</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e1011" headers="d25700e1003 ">
                                       <p><code class="codeph">100000020</code></p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e1011 d25700e1006 ">
                                       <p><code class="codeph">P</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e1020" headers="d25700e1003 ">
                                       <p><code class="codeph">100000052</code></p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e1020 d25700e1006 ">
                                       <p><code class="codeph">C</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e1029" headers="d25700e1003 ">
                                       <p><code class="codeph">100000503</code></p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e1029 d25700e1006 ">
                                       <p><code class="codeph">C：FNCL</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e1038" headers="d25700e1003 ">
                                       <p><code class="codeph">100000132</code></p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e1038 d25700e1006 ">
                                       <p><code class="codeph">C：FNCL，OP</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e1047" headers="d25700e1003 ">
                                       <p><code class="codeph">100000003</code></p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e1047 d25700e1006 ">
                                       <p><code class="codeph">小号</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e1056" headers="d25700e1003 ">
                                       <p><code class="codeph">100000780</code></p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e1056 d25700e1006 ">
                                       <p><code class="codeph">S：OP：WR</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e1065" headers="d25700e1003 ">
                                       <p><code class="codeph">100000035</code></p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e1065 d25700e1006 ">
                                       <p><code class="codeph">HS</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="30%" id="d25700e1074" headers="d25700e1003 ">
                                       <p><code class="codeph">100000036</code></p>
                                    </td>
                                    <td align="left" valign="top" width="70%" headers="d25700e1074 d25700e1006 ">
                                       <p><code class="codeph">HS：OP</code></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-C5D22293-2F11-4C83-B281-ADCA31D28D07" title="您可以创建定义标签组件的标签标签，手动或自动生成标签标签。">标签标签</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="OLSAG021"></a><div class="props_rev_3"><a id="GUID-74564599-9CF7-4ADC-9FB2-C6E8E271DA66" name="GUID-74564599-9CF7-4ADC-9FB2-C6E8E271DA66"></a><h3 id="OLSAG-GUID-74564599-9CF7-4ADC-9FB2-C6E8E271DA66" class="sect3">标签分配给数据行</h3>
               <div>
                  <p>对于现有数据行，可以通过您创建的标签功能分配标签。</p>
                  <p>在这样的函数中，您可以指定确定要插入的标签的确切表和行条件。可以在调用中将该函数命名为将策略应用于表或模式，或者由管理员在更新中应用。</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="working-with-labeled-data.html#GUID-ED5DA711-477C-42D9-B03C-866A909DDE23" title="您可以在各种情况下插入带标签的数据。">插入标记数据</a></li>
                        <li><a href="implementing-policy-enforcement-options-and-labeling-functions.html#GUID-EEAEF7F0-9454-4E00-BAB0-D74BB236CD5B" title="标记函数可以使用诸如上下文变量（例如，日期或用户名）和数据值之类的资源来计算和返回标签。">标签功能</a></li>
                        <li><a href="oracle-label-security-pl-sql-packages.html#GUID-5C1F501B-293A-436E-865D-51D34E3D0829" title="SA_POLICY_ADMIN.APPLY_TABLE_POLICY过程将指定的策略添加到表中。">SA_POLICY_ADMIN.APPLY_TABLE_POLICY</a></li>
                        <li><a href="oracle-label-security-pl-sql-packages.html#GUID-D9E721AB-14D0-4086-9C79-6D402349F85A" title="SA_POLICY_ADMIN.APPLY_SCHEMA_POLICY过程将策略应用于架构中的所有表，并为这些表启用策略。">SA_POLICY_ADMIN.APPLY_SCHEMA_POLICY</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-75401780-723A-4EA5-AEDB-751E48AFC1DA" title="您可以管理标记数据，查看会话的安全属性数据，以及更改会话属性的值。">使用标记数据</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="OLSAG022"></a><div class="props_rev_3"><a id="GUID-456D3AA7-1C21-428A-80B4-C1C3C41FD241" name="GUID-456D3AA7-1C21-428A-80B4-C1C3C41FD241"></a><h3 id="OLSAG-GUID-456D3AA7-1C21-428A-80B4-C1C3C41FD241" class="sect3">提出标签</h3>
               <div>
                  <p>检索标签时，不会自动获取字符串值。</p>
                  <p>默认情况下，返回标签标记值。两个标签操作函数使您可以将标签标签值转换为其字符串表示形式。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-4C4E227B-6BBA-47A7-B839-CE7893201505">使用CHAR_TO_LABEL将字符串转换为标签标记</a><br><code class="codeph">CHAR_TO_LABEL</code>函数将字符串转换为label标签，返回指定字符串的label标签。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-99E3502F-ED31-4A79-8722-E0C680C188F0">使用LABEL_TO_CHAR将标签标签转换为字符串</a><br>您可以将标签标签转换为字符串。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-75401780-723A-4EA5-AEDB-751E48AFC1DA" title="您可以管理标记数据，查看会话的安全属性数据，以及更改会话属性的值。">使用标记数据</a></p>
                     </div>
                  </div>
               </div>
               <a id="OLSAG3153"></a><div class="props_rev_3"><a id="GUID-4C4E227B-6BBA-47A7-B839-CE7893201505" name="GUID-4C4E227B-6BBA-47A7-B839-CE7893201505"></a><h4 id="OLSAG-GUID-4C4E227B-6BBA-47A7-B839-CE7893201505" class="sect4">使用CHAR_TO_LABEL将字符串转换为标签标记</h4>
                  <div>
                     <p><code class="codeph">CHAR_TO_LABEL</code>函数将字符串转换为label标签，返回指定字符串的label标签。
                     </p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要将字符串转换为标签选项卡，请对<code class="codeph">CHAR_TO_LABEL</code>函数使用以下语法：</p><pre class="oac_no_warn" dir="ltr">功能CHAR_TO_LABEL（policy_name IN VARCHAR2，label_string IN VARCHAR2）返回数字;</pre></li>
                        </ul>
                        <p>例如：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO emp（empno，hr_label）VALUES（999，CHAR_TO_LABEL（'HR'，'S：A，B：G5'）;</pre><p>这里， <code class="codeph">HR</code>是标签策略名称， <code class="codeph">S</code>是敏感度级别， <code class="codeph">A,B</code>隔间， <code class="codeph">G5</code>是组。
                        </p><pre class="oac_no_warn" dir="ltr">功能CHAR_TO_LABEL（policy_name IN VARCHAR2，label_string IN VARCHAR2）返回数字;</pre><p>这里， <code class="codeph">HR</code>是标签策略名称， <code class="codeph">S</code>是敏感度级别， <code class="codeph">A,B</code>隔间， <code class="codeph">G5</code>是组。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-456D3AA7-1C21-428A-80B4-C1C3C41FD241" title="检索标签时，不会自动获取字符串值。">显示标签</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="OLSAG3154"></a><div class="props_rev_3"><a id="GUID-99E3502F-ED31-4A79-8722-E0C680C188F0" name="GUID-99E3502F-ED31-4A79-8722-E0C680C188F0"></a><h4 id="OLSAG-GUID-99E3502F-ED31-4A79-8722-E0C680C188F0" class="sect4">使用LABEL_TO_CHAR将标签标签转换为字符串</h4>
                  <div>
                     <p>您可以将标签标签转换为字符串。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-8E8A8442-A6B6-462F-9AD5-C716FBF62733">使用LABEL_TO_CHAR将标签标签转换为字符串</a><br><code class="codeph">LABEL_TO_CHAR</code>函数在将label标签转换为字符串时返回<code class="codeph">VARCHAR2</code>字符串。
                        </li>
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-4F134FF5-2DF4-4976-AE7E-21BA4BE78C37">LABEL_TO_CHAR示例</a><br>Oracle提供了说明<code class="codeph">LABEL_TO_CHAR</code>用法的<code class="codeph">LABEL_TO_CHAR</code> 。</li>
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-7666C818-7291-4F46-B0FD-F7E634FCB51A">隐藏策略标签列时从表中检索所有列</a><br>如果隐藏了策略标签列，则在表上执行<code class="codeph">SELECT *</code>时不会自动返回该列。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-456D3AA7-1C21-428A-80B4-C1C3C41FD241" title="检索标签时，不会自动获取字符串值。">显示标签</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-8E8A8442-A6B6-462F-9AD5-C716FBF62733" name="GUID-8E8A8442-A6B6-462F-9AD5-C716FBF62733"></a><h5 id="OLSAG-GUID-8E8A8442-A6B6-462F-9AD5-C716FBF62733" class="sect5">使用LABEL_TO_CHAR将标签标签转换为字符串</h5>
                     <div>
                        <p><code class="codeph">LABEL_TO_CHAR</code>函数在将label标签转换为字符串时返回<code class="codeph">VARCHAR2</code>字符串。
                        </p>
                        <div class="section">
                           <p>查询表或视图时，将自动检索表或视图中满足查询限定条件的所有行，并由标签控制。如果未隐藏策略标签列，则显示每行的标签标签值。必须使用<code class="codeph">LABEL_TO_CHAR</code>函数来显示每个标签的字符串值。
                           </p>
                           <p>请注意，所有转化都必须明确。标签和字符串表示没有自动转换。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要将label标签转换为字符串，请对<code class="codeph">LABEL_TO_CHAR</code>函数使用以下语法：</p><pre class="oac_no_warn" dir="ltr">FUNCTION LABEL_TO_CHAR（标签IN NUMBER）RETURN VARCHAR2;</pre></li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-99E3502F-ED31-4A79-8722-E0C680C188F0" title="您可以将标签标签转换为字符串。">使用LABEL_TO_CHAR将标签标签转换为字符串</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="OLSAG3781"></a><a id="OLSAG3782"></a><a id="OLSAG3783"></a><a id="OLSAG3155"></a><div class="props_rev_3"><a id="GUID-4F134FF5-2DF4-4976-AE7E-21BA4BE78C37" name="GUID-4F134FF5-2DF4-4976-AE7E-21BA4BE78C37"></a><h5 id="OLSAG-GUID-4F134FF5-2DF4-4976-AE7E-21BA4BE78C37" class="sect5">LABEL_TO_CHAR示例</h5>
                     <div>
                        <p>Oracle提供了说明<code class="codeph">LABEL_TO_CHAR</code>用法的<code class="codeph">LABEL_TO_CHAR</code> 。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-4F134FF5-2DF4-4976-AE7E-21BA4BE78C37__GUID-4B51480F-C456-4513-AB0A-E380D532C166">示例：从表或视图中检索行标签</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>要从表或视图中检索行的标签，请在<code class="codeph">SELECT</code>语句中指定策略标签列。
                           </p>
                           <p>例如：</p><pre class="oac_no_warn" dir="ltr">SELECT label_to_char（hr_label）AS label，ename FROM tab1;在哪里ename ='RWRIGHT';</pre><p>该语句返回以下内容：</p><pre class="oac_no_warn" dir="ltr">LABEL ENAME ------------ ---------- S：A，B：G1 RWRIGHT</pre></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-4F134FF5-2DF4-4976-AE7E-21BA4BE78C37__GUID-C2F8B60D-97F1-4C38-892E-DC03C38E28BA">示例：检索策略标签列</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>您还可以在<code class="codeph">SELECT</code>语句的<code class="codeph">WHERE</code>子句中指定策略标签列。
                           </p>
                           <p>以下语句显示具有策略标签<code class="codeph">S:A,B:G1</code>所有行<code class="codeph">S:A,B:G1</code></p><pre class="oac_no_warn" dir="ltr">SELECT label_to_char（hr_label）AS label，ename FROM emp WHERE hr_label = char_to_label（'HR'，'S：A，B：G1'）;</pre><p>该语句返回以下内容：</p><pre class="oac_no_warn" dir="ltr">LABEL ENAME ------------- --------- S：A，B：G1 RWRIGHT S：A，B：G1 ESTANTON</pre><p>或者，您可以使用更灵活的语句在<code class="codeph">HR_LABEL</code>列的文本中的任何位置查找包含字符串“S：A，B：G1”的<code class="codeph">HR_LABEL</code> ：</p><pre class="oac_no_warn" dir="ltr">SELECT label_to_char（hr_label）AS label，ename FROM emp WHERE label_to_char（hr_label）like'％S：A，B：G1％';</pre><p>如果您不使用<code class="codeph">LABEL_TO_CHAR</code>函数，那么您将看到label标签。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-4F134FF5-2DF4-4976-AE7E-21BA4BE78C37__GUID-3839284F-2A78-4670-8257-89E0AAFA348F">示例：检索数字列数据类型</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>以下示例使用数字列数据类型（ <code class="codeph">NUMBER</code> ）和动态生成的标签标记，但不使用<code class="codeph">LABEL_TO_CHAR</code>函数。如果您不使用<code class="codeph">LABEL_TO_CHAR</code>函数，那么您将看到label标签。
                           </p><pre class="oac_no_warn" dir="ltr">SQL&gt; select empno，hr_label from emp where ename ='RWRIGHT'; EMPNO HR_LABEL ---------- ---------- 7839 1000000562</pre></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-99E3502F-ED31-4A79-8722-E0C680C188F0" title="您可以将标签标签转换为字符串。">使用LABEL_TO_CHAR将标签标签转换为字符串</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="OLSAG3160"></a><a id="OLSAG3159"></a><div class="props_rev_3"><a id="GUID-7666C818-7291-4F46-B0FD-F7E634FCB51A" name="GUID-7666C818-7291-4F46-B0FD-F7E634FCB51A"></a><h5 id="OLSAG-GUID-7666C818-7291-4F46-B0FD-F7E634FCB51A" class="sect5">隐藏策略标签列时从表中检索所有列</h5>
                     <div>
                        <p>如果隐藏了策略标签列，则在表上执行<code class="codeph">SELECT *</code>时不会自动返回该列。
                        </p>
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要明确指定要检索标签，请在<code class="codeph">SELECT</code>语句中使用<code class="codeph">LABEL_TO_CHAR</code>函数。
                                 </p>
                              </li>
                           </ul>
                           <p>例如，要从<code class="codeph">DEPT</code>表中检索所有列（包括其字符表示中的策略标签列），请输入以下内容：</p><pre class="oac_no_warn" dir="ltr">COLUMN LABEL FORMAT a10 SELECT LABEL_TO_CHAR（hr_label）AS LABEL，DEPT。* FROM DEPT;</pre><p>运行这些SQL语句将返回以下数据：</p>
                           <div class="tblformal" id="GUID-7666C818-7291-4F46-B0FD-F7E634FCB51A__GUID-9D61FE90-2017-494F-A108-B57A84DFD2C4">
                              <p class="titleintable">表6-3从隐藏列的示例SQL语句返回的数据</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="从示例SQL语句返回的数据重新隐藏列" width="100%" border="1" summary="This table shows the data returned from the query shown, listing the label, department number, distinguished name, and location." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="22%" id="d25700e1813">标签</th>
                                       <th align="left" valign="bottom" width="22%" id="d25700e1816">DEPTNO</th>
                                       <th align="left" valign="bottom" width="27%" id="d25700e1819">DNAME</th>
                                       <th align="left" valign="bottom" width="29%" id="d25700e1822">LOC</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="22%" id="d25700e1827" headers="d25700e1813 ">
                                          <p><code class="codeph">L1</code></p>
                                       </td>
                                       <td align="left" valign="top" width="22%" headers="d25700e1827 d25700e1816 ">
                                          <p><code class="codeph">10</code></p>
                                       </td>
                                       <td align="left" valign="top" width="27%" headers="d25700e1827 d25700e1819 ">
                                          <p><code class="codeph">会计</code></p>
                                       </td>
                                       <td align="left" valign="top" width="29%" headers="d25700e1827 d25700e1822 ">
                                          <p><code class="codeph">纽约</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="22%" id="d25700e1844" headers="d25700e1813 ">
                                          <p><code class="codeph">L1</code></p>
                                       </td>
                                       <td align="left" valign="top" width="22%" headers="d25700e1844 d25700e1816 ">
                                          <p><code class="codeph">20</code></p>
                                       </td>
                                       <td align="left" valign="top" width="27%" headers="d25700e1844 d25700e1819 ">
                                          <p><code class="codeph">研究</code></p>
                                       </td>
                                       <td align="left" valign="top" width="29%" headers="d25700e1844 d25700e1822 ">
                                          <p><code class="codeph">DALLAS</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="22%" id="d25700e1861" headers="d25700e1813 ">
                                          <p><code class="codeph">L1</code></p>
                                       </td>
                                       <td align="left" valign="top" width="22%" headers="d25700e1861 d25700e1816 ">
                                          <p><code class="codeph">三十</code></p>
                                       </td>
                                       <td align="left" valign="top" width="27%" headers="d25700e1861 d25700e1819 ">
                                          <p><code class="codeph">销售</code></p>
                                       </td>
                                       <td align="left" valign="top" width="29%" headers="d25700e1861 d25700e1822 ">
                                          <p><code class="codeph">芝加哥</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="22%" id="d25700e1878" headers="d25700e1813 ">
                                          <p><code class="codeph">L1</code></p>
                                       </td>
                                       <td align="left" valign="top" width="22%" headers="d25700e1878 d25700e1816 ">
                                          <p><code class="codeph">40</code></p>
                                       </td>
                                       <td align="left" valign="top" width="27%" headers="d25700e1878 d25700e1819 ">
                                          <p><code class="codeph">营运</code></p>
                                       </td>
                                       <td align="left" valign="top" width="29%" headers="d25700e1878 d25700e1822 ">
                                          <p><code class="codeph">波士顿</code></p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>相反，如果未明确指定<code class="codeph">HR_LABEL</code>列，则根本不显示标签。请注意，虽然策略列名称基于策略，但<code class="codeph">HIDE</code>选项是逐个表的。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="implementing-policy-enforcement-options-and-labeling-functions.html#GUID-26ABB868-ADB3-44D0-B5A0-3CAF9C5EC627" title="将Oracle Label Security策略列添加到表时，可以指定HIDE策略配置选项。">HIDE策略列选项的工作原理</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-99E3502F-ED31-4A79-8722-E0C680C188F0" title="您可以将标签标签转换为字符串。">使用LABEL_TO_CHAR将标签标签转换为字符串</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="OLSAG023"></a><div class="props_rev_3"><a id="GUID-620518A2-9072-427C-9560-3F9F165F1247" name="GUID-620518A2-9072-427C-9560-3F9F165F1247"></a><h3 id="OLSAG-GUID-620518A2-9072-427C-9560-3F9F165F1247" class="sect3">使用标签过滤数据</h3>
               <div>
                  <p>处理SQL语句时，Oracle Label Security会通过create-and-apply过程调用数据库中定义的安全策略。</p>
                  <p>对于<code class="codeph">SELECT</code>语句，策略筛选用户有权查看的数据行。对于<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>语句，Oracle Label Security根据用户的授权允许或拒绝所请求的操作。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-8FAFA06A-A0F1-443C-861E-1B9B62BFED3E">在WHERE子句中使用数字标签标签</a><br>在<code class="codeph">SELECT</code>语句的<code class="codeph">WHERE</code>子句中使用数字标签标签有不同的技巧。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-9D6DF3AA-C487-4FE0-8FB8-6D9173A23A93">订购标记数据行</a><br><code class="codeph">SELECT</code>语句的<code class="codeph">ORDER BY</code>子句可用于通过数字标签标记对行进行排序。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-49361ADF-A62F-412D-A59D-0226C069ECEC">按标签的字符表示排序</a><br><code class="codeph">LABEL_TO_CHAR</code>函数按标签的字符表示顺序<code class="codeph">LABEL_TO_CHAR</code>数据行。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-65D855D9-2DE3-4EB8-83CE-2B0D78E56F35">确定标签的上下界</a><br>Oracle Label Security提供的函数可确定两个或多个标签的最小上限或最大下限。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-204B41DF-86A4-47AE-92F5-E10EF60A194C">使用MERGE_LABEL函数合并标签</a><br><code class="codeph">MERGE_LABEL</code>函数将两个标签合并在一起。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-75401780-723A-4EA5-AEDB-751E48AFC1DA" title="您可以管理标记数据，查看会话的安全属性数据，以及更改会话属性的值。">使用标记数据</a></p>
                     </div>
                  </div>
               </div>
               <a id="OLSAG3161"></a><div class="props_rev_3"><a id="GUID-8FAFA06A-A0F1-443C-861E-1B9B62BFED3E" name="GUID-8FAFA06A-A0F1-443C-861E-1B9B62BFED3E"></a><h4 id="OLSAG-GUID-8FAFA06A-A0F1-443C-861E-1B9B62BFED3E" class="sect4">在WHERE子句中使用数字标签标签</h4>
                  <div>
                     <p>在<code class="codeph">SELECT</code>语句的<code class="codeph">WHERE</code>子句中使用数字标签标签有不同的技巧。
                     </p>
                     <p>使用<code class="codeph">NUMBER</code>格式的标签时，您可以设置标签，以便标签标签列表区分不同的级别。这些数字标签标签的比较可用于<code class="codeph">ORDER BY</code>处理，也可用于逻辑运算符。
                     </p>
                     <p>例如，如果已将所有<code class="codeph">UNCLASSIFIED</code>标签分配到1000范围，将所有<code class="codeph">SENSITIVE</code>标签分配到2000范围，将所有<code class="codeph">HIGHLY_SENSITIVE</code>标签分配到3000范围，则可以列出所有<code class="codeph">SENSITIVE</code>记录。
                     </p><pre class="oac_no_warn" dir="ltr">SELECT * FROM emp WHERE hr_label BETWEEN 2000和2999;</pre><p>要列出所有<code class="codeph">SENSITIVE</code>和<code class="codeph">UNCLASSIFIED</code>记录，您可以输入：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM emp WHERE hr_label &lt;3000;</pre><p>要列出所有<code class="codeph">HIGHLY_SENSITIVE</code>记录，您可以输入：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM emp WHERE hr_label = 3000;</pre><div class="infoboxnote" id="GUID-8FAFA06A-A0F1-443C-861E-1B9B62BFED3E__GUID-D3E4FAAE-5907-46A5-9FF5-B58753DD2024">
                        <p class="notep1">注意：</p>
                        <p>请记住，仅当管理员已将数字排序策略应用于他或她最初分配给标签的标签标签时，此类查询才有意义。通过这种方式，管理员可以提供方便的数据传播。但是，如果自动生成标签标签值，则标签的值与标签的顺序之间不存在内在关系。</p>
                     </div>
                     <p>或者，您可以使用支配关系来设置订购策略。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="advanced-topics-in-oracle-label-security.html#GUID-CD606D67-78AE-427D-B397-627C68E77B84" title="Oracle Label Security提供了控制优势的功能。">使用优势函数</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-620518A2-9072-427C-9560-3F9F165F1247" title="处理SQL语句时，Oracle Label Security会通过create-and-apply过程调用数据库中定义的安全策略。">使用标签过滤数据</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="OLSAG3162"></a><div class="props_rev_3"><a id="GUID-9D6DF3AA-C487-4FE0-8FB8-6D9173A23A93" name="GUID-9D6DF3AA-C487-4FE0-8FB8-6D9173A23A93"></a><h4 id="OLSAG-GUID-9D6DF3AA-C487-4FE0-8FB8-6D9173A23A93" class="sect4">订购标记数据行</h4>
                  <div>
                     <p><code class="codeph">SELECT</code>语句的<code class="codeph">ORDER BY</code>子句可用于通过数字标签标记对行进行排序。
                     </p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要执行<code class="codeph">ORDER BY</code>操作，请使用类似于以下内容的<code class="codeph">SELECT</code>语句：</p><pre class="oac_no_warn" dir="ltr">SELECT * from emp ORDER BY hr_label;</pre></li>
                        </ul>
                        <p>请注意，此声明中不需要任何函数。该声明使用了管理员设置的标签标签。</p>
                        <div class="infoboxnote" id="GUID-9D6DF3AA-C487-4FE0-8FB8-6D9173A23A93__GUID-6FF73DF3-62BB-4BBD-B09C-554E5CF43482">
                           <p class="notep1">注意：</p>
                           <p>同样，仅当管理员已将数字排序策略应用于最初分配给标签的标签标签时，此类查询才有意义。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-620518A2-9072-427C-9560-3F9F165F1247" title="处理SQL语句时，Oracle Label Security会通过create-and-apply过程调用数据库中定义的安全策略。">使用标签过滤数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="OLSAG3163"></a><div class="props_rev_3"><a id="GUID-49361ADF-A62F-412D-A59D-0226C069ECEC" name="GUID-49361ADF-A62F-412D-A59D-0226C069ECEC"></a><h4 id="OLSAG-GUID-49361ADF-A62F-412D-A59D-0226C069ECEC" class="sect4">按标签的字符表示排序</h4>
                  <div>
                     <p><code class="codeph">LABEL_TO_CHAR</code>函数按标签的字符表示顺序<code class="codeph">LABEL_TO_CHAR</code>数据行。
                     </p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要按标签的字符表示形式对数据行进行排序，请使用类似于以下内容的语句，该语句将返回按标签的文本顺序排序的所有行：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM emp ORDER BY label_to_char（hr_label）;</pre></li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-620518A2-9072-427C-9560-3F9F165F1247" title="处理SQL语句时，Oracle Label Security会通过create-and-apply过程调用数据库中定义的安全策略。">使用标签过滤数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="OLSAG3164"></a><div class="props_rev_3"><a id="GUID-65D855D9-2DE3-4EB8-83CE-2B0D78E56F35" name="GUID-65D855D9-2DE3-4EB8-83CE-2B0D78E56F35"></a><h4 id="OLSAG-GUID-65D855D9-2DE3-4EB8-83CE-2B0D78E56F35" class="sect4">确定标签的上下界</h4>
                  <div>
                     <p>Oracle Label Security提供的函数可确定两个或多个标签的最小上限或最大下限。</p>
                     <p>两个单行函数对查询返回的每一行进行操作。它们为每一行返回一个结果。</p>
                     <div class="infoboxnote" id="GUID-65D855D9-2DE3-4EB8-83CE-2B0D78E56F35__GUID-DBB20F65-4E3A-44F3-85E5-E24DD2CFE4FB">
                        <p class="notep1">注意：</p>
                        <p>在采用多个标签的所有功能中，标签必须全部属于同一策略。</p>
                     </div>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-041219B9-A9BC-449E-828C-627E167F3785">使用LEAST_UBOUND查找最小上限</a><br><code class="codeph">OLS_LEAST_UBOUND</code> （ <code class="codeph">OLS_LUBD</code> ）函数返回一个字符串标签，该标签是<span class="italic"><code class="codeph">label1</code></span>和<span class="italic"><code class="codeph">label2:</code></span>的最小上限<span class="italic"><code class="codeph">label2:</code></span> 。
                        </li>
                        <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-EF496648-2E08-4B63-9047-B0436274E77E">使用GREATEST_LBOUND查找最大下限</a><br><code class="codeph">OLS_GREATEST_LBOUND</code> （ <code class="codeph">OLS_GLBD</code> ）独立函数在给定两个不同标签的情况下确定操作中可能涉及的数据的最低标签。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-620518A2-9072-427C-9560-3F9F165F1247" title="处理SQL语句时，Oracle Label Security会通过create-and-apply过程调用数据库中定义的安全策略。">使用标签过滤数据</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="OLSAG3685"></a><a id="OLSAG3165"></a><div class="props_rev_3"><a id="GUID-041219B9-A9BC-449E-828C-627E167F3785" name="GUID-041219B9-A9BC-449E-828C-627E167F3785"></a><h5 id="OLSAG-GUID-041219B9-A9BC-449E-828C-627E167F3785" class="sect5">使用LEAST_UBOUND查找最小上限</h5>
                     <div>
                        <p><code class="codeph">OLS_LEAST_UBOUND</code> （ <code class="codeph">OLS_LUBD</code> ）函数返回一个字符串标签，该标签是<span class="italic"><code class="codeph">label1</code></span>和<span class="italic"><code class="codeph">label2:</code></span>的最小上限<span class="italic"><code class="codeph">label2:</code></span> 。
                        </p>
                        <div class="section">
                           <p>也就是说，这两个标签占主导地位。最小上限是最高级别，标签中隔室的并集以及标签中组的并集。</p>
                           <p>例如， <code class="codeph">HIGHLY_SENSITIVE:ALPHA</code>的最小上限<code class="codeph">HIGHLY_SENSITIVE:ALPHA</code>和<code class="codeph">SENSITIVE:BETA</code>是<code class="codeph">HIGHLY_SENSITIVE:ALPHA,BETA.</code> 
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要查找最小上限，请使用以下语法：</p><pre class="oac_no_warn" dir="ltr">FUNCTION OLS_LEAST_UBOUND（label1 IN NUMBER，label2 IN NUMBER）RETURN VARCHAR2;</pre></li>
                           </ul>
                           <p><code class="codeph">OLS_LEAST_UBOUND</code>函数在连接具有不同标签的行时非常有用，因为它为连接的行提供了高水位标记。
                           </p>
                           <p>以下查询将每个员工的标签与其部门的标签进行比较，并返回更高的标签，无论是在EMP表还是在DEPT表中。</p><pre class="oac_no_warn" dir="ltr">SELECT ename，dept.deptno，OLS_LEAST_UBOUND（emp.hr_label，dept.hr_label）作为标签FROM emp，dept WHERE emp.deptno = dept.deptno;</pre><p>此查询返回以下数据：</p>
                           <div class="tblformal" id="GUID-041219B9-A9BC-449E-828C-627E167F3785__GUID-29F09980-B199-4081-814E-65645C2FBAE5">
                              <p class="titleintable">表6-4 Least_UBound示例SQL语句返回的数据</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="从示例SQL语句返回的数据是Least_UBound" width="100%" border="1" summary="This table lists the rows returned from the query, showing each row’s employee name, department number, and label." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="33%" id="d25700e2561">ENAME</th>
                                       <th align="left" valign="bottom" width="33%" id="d25700e2564">DEPTNO</th>
                                       <th align="left" valign="bottom" width="33%" id="d25700e2567">标签</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d25700e2572" headers="d25700e2561 ">
                                          <p><code class="codeph">王</code></p>
                                       </td>
                                       <td align="left" valign="top" width="33%" headers="d25700e2572 d25700e2564 ">
                                          <p>10</p>
                                       </td>
                                       <td align="left" valign="top" width="33%" headers="d25700e2572 d25700e2567 ">
                                          <p>L3：M：D10</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d25700e2583" headers="d25700e2561 ">
                                          <p><code class="codeph">布莱克</code></p>
                                       </td>
                                       <td align="left" valign="top" width="33%" headers="d25700e2583 d25700e2564 ">
                                          <p>三十</p>
                                       </td>
                                       <td align="left" valign="top" width="33%" headers="d25700e2583 d25700e2567 ">
                                          <p>L3：M：D30</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d25700e2594" headers="d25700e2561 ">
                                          <p><code class="codeph">CLARK</code></p>
                                       </td>
                                       <td align="left" valign="top" width="33%" headers="d25700e2594 d25700e2564 ">
                                          <p>10</p>
                                       </td>
                                       <td align="left" valign="top" width="33%" headers="d25700e2594 d25700e2567 ">
                                          <p>L3：M：D10</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d25700e2605" headers="d25700e2561 ">
                                          <p><code class="codeph">JONES</code></p>
                                       </td>
                                       <td align="left" valign="top" width="33%" headers="d25700e2605 d25700e2564 ">
                                          <p>20</p>
                                       </td>
                                       <td align="left" valign="top" width="33%" headers="d25700e2605 d25700e2567 ">
                                          <p>L3：M：D20</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="33%" id="d25700e2616" headers="d25700e2561 ">
                                          <p><code class="codeph">MARTIN</code></p>
                                       </td>
                                       <td align="left" valign="top" width="33%" headers="d25700e2616 d25700e2564 ">
                                          <p>三十</p>
                                       </td>
                                       <td align="left" valign="top" width="33%" headers="d25700e2616 d25700e2567 ">
                                          <p>L2：E：D30</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <div class="infoboxnote" id="GUID-041219B9-A9BC-449E-828C-627E167F3785__GUID-78EC4B49-84E7-4E14-9E5C-47DF53BC13C6">
                              <p class="notep1">注意：</p>
                              <p>Oracle Database 12 <span class="italic">c第</span> 1版（12.1）中已弃用旧的OLS函数<code class="codeph">LEAST_UBOUND</code>和<code class="codeph">LUBD</code> 。
                              </p>
                              <p>您仍然可以使用此版本中的旧功能，但Oracle建议您改为使用<code class="codeph">OLS_LEAST_UBOUND</code>和<code class="codeph">OLS_LUBD</code>函数。使用新函数名称可避免与其他数据库组件发生潜在的名称冲突。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-65D855D9-2DE3-4EB8-83CE-2B0D78E56F35" title="Oracle Label Security提供的函数可确定两个或多个标签的最小上限或最大下限。">确定标签的上限和下限</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="OLSAG3167"></a><div class="props_rev_3"><a id="GUID-EF496648-2E08-4B63-9047-B0436274E77E" name="GUID-EF496648-2E08-4B63-9047-B0436274E77E"></a><h5 id="OLSAG-GUID-EF496648-2E08-4B63-9047-B0436274E77E" class="sect5">使用GREATEST_LBOUND查找最大下限</h5>
                     <div>
                        <p><code class="codeph">OLS_GREATEST_LBOUND</code> （ <code class="codeph">OLS_GLBD</code> ）独立函数在给定两个不同标签的情况下确定操作中可能涉及的数据的最低标签。
                        </p>
                        <div class="section">
                           <p>此函数返回一个字符串标签，该标签是<span class="italic"><code class="codeph">label1</code></span>和<span class="italic"><code class="codeph">label2.</code></span>的最大下限<span class="italic"><code class="codeph">label2.</code></span> 最大下限是最低级别，标签中的隔室与标签中的组的交集。例如， <code class="codeph">HIGHLY_SENSITIVE:ALPHA</code>的最大下限<code class="codeph">HIGHLY_SENSITIVE:ALPHA</code>和<code class="codeph">SENSITIVE</code>是<code class="codeph">SENSITIVE.</code> 
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要查找最大下限，请使用以下语法：</p><pre class="oac_no_warn" dir="ltr">FUNCTION OLS_GREATEST_LBOUND（label1 IN NUMBER，label2 IN NUMBER）RETURN VARCHAR2;</pre></li>
                           </ul>
                           <div class="infoboxnote" id="GUID-EF496648-2E08-4B63-9047-B0436274E77E__GUID-22B8A8B2-A3E2-436B-8682-BEAA81AD1403">
                              <p class="notep1">注意：</p>
                              <p>Oracle Database 12 <span class="italic">c第</span> 1版（12.1）中不推荐使用旧的OLS函数<code class="codeph">GREATEST_LBOUND</code>和<code class="codeph">GLBD</code> 。
                              </p>
                              <p>您仍然可以使用此版本中的旧功能，但Oracle建议您改为使用<code class="codeph">OLS_GREATEST_LBOUND</code>和<code class="codeph">OLS_GLBD</code>函数。使用新函数名称可避免与其他数据库组件发生潜在的名称冲突。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-65D855D9-2DE3-4EB8-83CE-2B0D78E56F35" title="Oracle Label Security提供的函数可确定两个或多个标签的最小上限或最大下限。">确定标签的上限和下限</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="OLSAG3169"></a><a id="OLSAG3168"></a><div class="props_rev_3"><a id="GUID-204B41DF-86A4-47AE-92F5-E10EF60A194C" name="GUID-204B41DF-86A4-47AE-92F5-E10EF60A194C"></a><h4 id="OLSAG-GUID-204B41DF-86A4-47AE-92F5-E10EF60A194C" class="sect4">使用MERGE_LABEL函数合并标签</h4>
                  <div>
                     <p><code class="codeph">MERGE_LABEL</code>函数将两个标签合并在一起。
                     </p>
                     <div class="section">
                        <p>它接受两个标签的字符串形式和合并格式的三字符规范。</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要合并标签，请使用以下语法：</p><pre class="oac_no_warn" dir="ltr">FUNCTION merge_label（label1 IN number，label2 IN number，merge_format IN VARCHAR2）RETURN number;</pre></li>
                        </ul>
                        <p>有效的合并格式使用三个字符的字符串指定：</p>
                        <p><span class="italic"><code class="codeph">&lt;最高级别或最低级别&gt; &lt;联合或隔离的交集&gt; &lt;联合或组的交集&gt;</code></span></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>第一个字符表示是使用两个标签的最高级别还是最低级别进行合并。</p>
                           </li>
                           <li>
                              <p>第二个字符表示是使用联合还是两个标签中的隔室的交集进行合并。</p>
                           </li>
                           <li>
                              <p>第三个字符表示是使用联合还是两个标签中的组的交集进行合并。</p>
                           </li>
                        </ul>
                        <p><a href="working-with-labeled-data.html#GUID-204B41DF-86A4-47AE-92F5-E10EF60A194C__BEIIFDCH" title="此表列出了MERGE_LABEL格式中使用的常量，为每个格式提供了格式规范，数据类型，constsant，含义以及使用它的位置。">表6-5</a>定义了<code class="codeph">MERGE_LABEL</code>格式常量。
                        </p>
                        <div class="tblformal" id="GUID-204B41DF-86A4-47AE-92F5-E10EF60A194C__BEIIFDCH">
                           <p class="titleintable">表6-5 MERGE_LABEL格式常量</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="MERGE_LABEL格式常量" width="100%" border="1" summary="This table lists the constants used in MERGE_LABEL formats, giving for each one the format specification, datatype, constsant, meaning, and position where it is used." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="23%" id="d25700e2892">格式规范</th>
                                    <th align="left" valign="bottom" width="25%" id="d25700e2895">数据类型</th>
                                    <th align="left" valign="bottom" width="11%" id="d25700e2898">不变</th>
                                    <th align="left" valign="bottom" width="22%" id="d25700e2901">含义</th>
                                    <th align="left" valign="bottom" width="20%" id="d25700e2904">使用格式的位置</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d25700e2909" headers="d25700e2892 ">
                                       <p><code class="codeph">max_lvl_fmt</code></p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d25700e2909 d25700e2895 ">
                                       <p><code class="codeph">CONSTANT</code> <code class="codeph">varchar2(1)</code></p>
                                    </td>
                                    <td align="left" valign="top" width="11%" headers="d25700e2909 d25700e2898 ">
                                       <p><code class="codeph">H</code></p>
                                    </td>
                                    <td align="left" valign="top" width="22%" headers="d25700e2909 d25700e2901 ">
                                       <p>最高水平</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25700e2909 d25700e2904 ">
                                       <p>第一级）</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d25700e2931" headers="d25700e2892 ">
                                       <p><code class="codeph">min_lvl_fmt</code></p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d25700e2931 d25700e2895 ">
                                       <p><code class="codeph">CONSTANT</code> <code class="codeph">varchar2(1)</code></p>
                                    </td>
                                    <td align="left" valign="top" width="11%" headers="d25700e2931 d25700e2898 ">
                                       <p><code class="codeph">大号</code></p>
                                    </td>
                                    <td align="left" valign="top" width="22%" headers="d25700e2931 d25700e2901 ">
                                       <p>最低水平</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25700e2931 d25700e2904 ">
                                       <p>第一级）</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d25700e2953" headers="d25700e2892 ">
                                       <p><code class="codeph">union_fmt</code></p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d25700e2953 d25700e2895 ">
                                       <p><code class="codeph">CONSTANT</code> <code class="codeph">varchar2(1)</code></p>
                                    </td>
                                    <td align="left" valign="top" width="11%" headers="d25700e2953 d25700e2898 ">
                                       <p><code class="codeph">ü</code></p>
                                    </td>
                                    <td align="left" valign="top" width="22%" headers="d25700e2953 d25700e2901 ">
                                       <p>联盟的两个标签</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25700e2953 d25700e2904 ">
                                       <p>第二（隔间）和第三（隔间）</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d25700e2975" headers="d25700e2892 ">
                                       <p><code class="codeph">inter_fmt</code></p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d25700e2975 d25700e2895 ">
                                       <p><code class="codeph">CONSTANT</code> <code class="codeph">varchar2(1)</code></p>
                                    </td>
                                    <td align="left" valign="top" width="11%" headers="d25700e2975 d25700e2898 ">
                                       <p><code class="codeph">一世</code></p>
                                    </td>
                                    <td align="left" valign="top" width="22%" headers="d25700e2975 d25700e2901 ">
                                       <p>两个标签的交叉点</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25700e2975 d25700e2904 ">
                                       <p>第二（隔间）和第三（隔间）</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d25700e2997" headers="d25700e2892 ">
                                       <p><code class="codeph">minus_fmt</code></p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d25700e2997 d25700e2895 ">
                                       <p><code class="codeph">CONSTANT</code> <code class="codeph">varchar2(1)</code></p>
                                    </td>
                                    <td align="left" valign="top" width="11%" headers="d25700e2997 d25700e2898 ">
                                       <p><code class="codeph">中号</code></p>
                                    </td>
                                    <td align="left" valign="top" width="22%" headers="d25700e2997 d25700e2901 ">
                                       <p>从第一个标签中删除第二个标签</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25700e2997 d25700e2904 ">
                                       <p>第二（隔间）和第三（隔间）</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="23%" id="d25700e3019" headers="d25700e2892 ">
                                       <p><code class="codeph">null_fmt</code></p>
                                    </td>
                                    <td align="left" valign="top" width="25%" headers="d25700e3019 d25700e2895 ">
                                       <p><code class="codeph">CONSTANT</code> <code class="codeph">varchar2(1)</code></p>
                                    </td>
                                    <td align="left" valign="top" width="11%" headers="d25700e3019 d25700e2898 ">
                                       <p><code class="codeph">ñ</code></p>
                                    </td>
                                    <td align="left" valign="top" width="22%" headers="d25700e3019 d25700e2901 ">
                                       <p>如果在隔离专区列中指定，则不返回隔离专区。如果在groups列中指定，则不返回任何组。</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25700e3019 d25700e2904 ">
                                       <p>第二（隔间）和第三（隔间）</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>例如， <code class="codeph">HUI</code>指定两个标签的最高级别，隔室的并集，组的交集。
                        </p>
                        <p>所述<code class="codeph">MERGE_LABEL</code>如果功能是特别有用的，以开发<code class="codeph">LEAST_UBOUND</code>功能不提供预期的结果。<code class="codeph">LEAST_UBOUND</code>函数与两个包含组的标签一起使用时，可能会导致数据标签的敏感度低于预期。<code class="codeph">MERGE_LABEL</code>函数使您可以计算组的交集，而不是<code class="codeph">LEAST_UBOUND</code>函数提供的组的并<code class="codeph">LEAST_UBOUND</code> 。
                        </p>
                        <p>例如，如果一个数据记录的标签包含组<code class="codeph">UNITED_STATES</code> ，而另一个数据记录的标签包含组<code class="codeph">UNITED_KINGDOM</code> ，并且<code class="codeph">LEAST_UBOUND</code>函数用于计算这两个标签的最小上限，则生成的标签将是授权给<code class="codeph">UNITED_STATES</code>或<code class="codeph">UNITED_KINGDOM</code>用户可以访问。</p>
                        <p>相反，如果<code class="codeph">MERGE_LABEL</code>函数与<code class="codeph">HUI</code>的format子句一起使用，则生成的标签将包含最高级别，分隔<code class="codeph">MERGE_LABEL</code>的并集，而不包含任何组。这是因为<code class="codeph">UNITED_STATES</code>和<code class="codeph">UNITED_KINGDOM</code>不相交。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-620518A2-9072-427C-9560-3F9F165F1247" title="处理SQL语句时，Oracle Label Security会通过create-and-apply过程调用数据库中定义的安全策略。">使用标签过滤数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="OLSAG024"></a><div class="props_rev_3"><a id="GUID-ED5DA711-477C-42D9-B03C-866A909DDE23" name="GUID-ED5DA711-477C-42D9-B03C-866A909DDE23"></a><h3 id="OLSAG-GUID-ED5DA711-477C-42D9-B03C-866A909DDE23" class="sect3">插入标记数据</h3>
               <div>
                  <p>您可以在各种情况下插入带标签的数据。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-A8AF35C5-B725-4243-BA49-29CBDE354BC6">关于插入标签数据</a><br>将数据插入受Oracle Label Security策略保护的表时，必须提供数字标签值标记。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-4B9212A1-889E-4E5C-81D8-2D09A1D15033">使用CHAR_TO_LABEL插入标签</a><br>要插入行标签，可以指定标签字符串，然后使用<code class="codeph">CHAR_TO_LABEL</code>函数将其转换为标签。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-6C57A3B3-0B9F-4D22-BA14-297150A6AE36">使用数字标签标签值插入标签</a><br>您可以使用标签的数字标签标签值插入数据，而不是使用<code class="codeph">CHAR_TO_LABEL</code>函数。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-9624056D-B307-4292-9FD1-756B83B8A5F1">在不指定标签的情况下插入数据</a><br>在两种情况下，您无需在<code class="codeph">INSERT</code>语句中指定标签。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-8F410DD6-01CA-4B15-8377-ECE81C87A8D6">隐藏策略标签列时插入数据</a><br>如果标签列被隐藏，则列的存在对于数据的插入是透明的。
                     </li>
                     <li class="ulchildlink"><a href="working-with-labeled-data.html#GUID-200BD865-1840-4A11-B179-D445A2342C21">使用TO_DATA_LABEL插入标签</a><br><code class="codeph">TO_DATA_LABEL</code>函数可以动态生成新标签。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-75401780-723A-4EA5-AEDB-751E48AFC1DA" title="您可以管理标记数据，查看会话的安全属性数据，以及更改会话属性的值。">使用标记数据</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-A8AF35C5-B725-4243-BA49-29CBDE354BC6" name="GUID-A8AF35C5-B725-4243-BA49-29CBDE354BC6"></a><h4 id="OLSAG-GUID-A8AF35C5-B725-4243-BA49-29CBDE354BC6" class="sect4">关于插入标签数据</h4>
                  <div>
                     <p>将数据插入受Oracle Label Security策略保护的表时，必须提供数字标签值标记。</p>
                     <p>通常，您可以在<code class="codeph">INSERT</code>语句本身中插入此值。
                     </p>
                     <p>为此，您必须显式指定所需标签的标签，或者将标签的字符串表示显式转换为正确的标签。请注意，这并不意味着生成新的标签标签，而是引用正确的标签。当Oracle Label Security使用Oracle Internet Directory时，唯一允许的标签（和相应的标签）是管理员预先定义的标签（已经在Oracle Internet Directory中）。</p>
                     <p><code class="codeph">INSERT</code>语句可能省略标签值的唯一情况是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果在应用策略时指定了<code class="codeph">LABEL_DEFAULT</code>强制选项，或者</p>
                        </li>
                        <li>
                           <p>如果在应用策略时未指定强制选项，则在创建策略时指定了<code class="codeph">LABEL_DEFAULT</code></p>
                        </li>
                        <li>
                           <p>如果声明应用该策略命名为标签功能。</p>
                        </li>
                     </ul>
                     <p>在前两种情况下，用户的会话默认行标签用作插入行的标签。在第三种情况下，插入行的标签由该标签功能创建。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="implementing-policy-enforcement-options-and-labeling-functions.html#GUID-EEAEF7F0-9454-4E00-BAB0-D74BB236CD5B" title="标记函数可以使用诸如上下文变量（例如，日期或用户名）和数据值之类的资源来计算和返回标签。">标签功能</a></li>
                           <li><a href="implementing-policy-enforcement-options-and-labeling-functions.html#GUID-74CD83CB-3398-439D-B791-7C08867EF645" title="您可以自定义Oracle Label Security策略的实施并实现标签功能。">实施政策执行选项和标签功能</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-ED5DA711-477C-42D9-B03C-866A909DDE23" title="您可以在各种情况下插入带标签的数据。">插入标签数据</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="OLSAG3170"></a><div class="props_rev_3"><a id="GUID-4B9212A1-889E-4E5C-81D8-2D09A1D15033" name="GUID-4B9212A1-889E-4E5C-81D8-2D09A1D15033"></a><h4 id="OLSAG-GUID-4B9212A1-889E-4E5C-81D8-2D09A1D15033" class="sect4">使用CHAR_TO_LABEL插入标签</h4>
                  <div>
                     <p>要插入行标签，可以指定标签字符串，然后使用<code class="codeph">CHAR_TO_LABEL</code>函数将其转换为标签。
                     </p>
                     <div class="section">
                        <p><code class="codeph">CHAR_TO_LABEL</code>函数自动创建有效的数据标签。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要插入标签，请使用<code class="codeph">INSERT INTO</code>语句。
                              </p>
                           </li>
                        </ul>
                        <p>使用表<code class="codeph">emp</code>的定义，以下示例显示如何使用显式标签插入数据：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO emp（ename，empno，hr_label）VALUES（'ESTANTON'，10，char_to_label（'HR'，'SENSITIVE'））;</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-ED5DA711-477C-42D9-B03C-866A909DDE23" title="您可以在各种情况下插入带标签的数据。">插入标签数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="OLSAG3171"></a><div class="props_rev_3"><a id="GUID-6C57A3B3-0B9F-4D22-BA14-297150A6AE36" name="GUID-6C57A3B3-0B9F-4D22-BA14-297150A6AE36"></a><h4 id="OLSAG-GUID-6C57A3B3-0B9F-4D22-BA14-297150A6AE36" class="sect4">使用数字标签标签值插入标签</h4>
                  <div>
                     <p>您可以使用标签的数字标签标签值插入数据，而不是使用<code class="codeph">CHAR_TO_LABEL</code>函数。
                     </p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要使用数字标签标记值插入标签，请使用<code class="codeph">INSERT INTO</code>语句。
                              </p>
                           </li>
                        </ul>
                        <p>例如，如果<code class="codeph">SENSITIVE</code>的数字标签标签为3000，则显示如下：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO emp（ename，empno，hr_label）VALUES（'ESTANTON'，10,3000）;</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-ED5DA711-477C-42D9-B03C-866A909DDE23" title="您可以在各种情况下插入带标签的数据。">插入标签数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="OLSAG3172"></a><div class="props_rev_3"><a id="GUID-9624056D-B307-4292-9FD1-756B83B8A5F1" name="GUID-9624056D-B307-4292-9FD1-756B83B8A5F1"></a><h4 id="OLSAG-GUID-9624056D-B307-4292-9FD1-756B83B8A5F1" class="sect4">在不指定标签的情况下插入数据</h4>
                  <div>
                     <p>在两种情况下，您无需在<code class="codeph">INSERT</code>语句中指定标签。
                     </p>
                     <div class="section">
                        <p>如果设置了<code class="codeph">LABEL_DEFAULT</code> ，或者如果对表应用了标签函数，则无需在<code class="codeph">INSERT</code>语句中指定标签。标签将自动提供。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要在不指定标签的情况下插入数据，请使用<code class="codeph">INSERT INTO</code>语句。
                              </p>
                           </li>
                        </ul>
                        <p>例如：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO emp（ename，empno）VALUES（'ESTANTON'，10）;</pre><p>生成的行标签根据默认值（或通过标签功能）设置。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-ED5DA711-477C-42D9-B03C-866A909DDE23" title="您可以在各种情况下插入带标签的数据。">插入标签数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="OLSAG3173"></a><div class="props_rev_3"><a id="GUID-8F410DD6-01CA-4B15-8377-ECE81C87A8D6" name="GUID-8F410DD6-01CA-4B15-8377-ECE81C87A8D6"></a><h4 id="OLSAG-GUID-8F410DD6-01CA-4B15-8377-ECE81C87A8D6" class="sect4">隐藏策略标签列时插入数据</h4>
                  <div>
                     <p>如果标签列被隐藏，则列的存在对于数据的插入是透明的。</p>
                     <div class="section">
                        <p>可以编写<code class="codeph">INSERT</code>语句，这些语句不显式列出表列，也不包含label列的值。
                        </p>
                        <p>会话的行标签用于标记数据，如果在将策略应用于表或模式时指定了标签函数，则使用标签函数。</p>
                        <p>只要为表中的每个非隐藏列指定值，就可以在不显式命名列的情况下插入表中。以下示例显示如何在<a href="working-with-labeled-data.html#GUID-62D8E07A-EC69-4EF7-A0B4-5FC69B476152__BEIIGDED">示例2</a>中描述的表中插入行<a href="working-with-labeled-data.html#GUID-62D8E07A-EC69-4EF7-A0B4-5FC69B476152__BEIIGDED">：带有隐藏列的数字列数据类型</a> ：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要在隐藏策略标签列时插入数据，请使用以下语法：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO VALUES（'196'，'ESTANTON'，技术员，RSTOUT，50000,10）;</pre></li>
                        </ul>
                        <p>它的标签将是以下三种可能之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>您指定的标签</p>
                           </li>
                           <li>
                              <p>由应用的策略的<code class="codeph">LABEL_DEFAULT</code>选项建立的标签</p>
                           </li>
                           <li>
                              <p>由应用的策略命名的标签功能创建的标签</p>
                              <div class="infoboxnote" id="GUID-8F410DD6-01CA-4B15-8377-ECE81C87A8D6__GUID-0F96A424-0E9F-4861-84DC-05266CC12700">
                                 <p class="notep1">注意：</p>
                                 <p>如果<span class="italic">未</span>隐藏策略标签列，则必须在<code class="codeph">INSERT</code>语句中显式包含标签值（可能为空，由逗号指示）。
                                 </p>
                              </div>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-ED5DA711-477C-42D9-B03C-866A909DDE23" title="您可以在各种情况下插入带标签的数据。">插入标签数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="OLSAG3174"></a><div class="props_rev_3"><a id="GUID-200BD865-1840-4A11-B179-D445A2342C21" name="GUID-200BD865-1840-4A11-B179-D445A2342C21"></a><h4 id="OLSAG-GUID-200BD865-1840-4A11-B179-D445A2342C21" class="sect4">使用TO_DATA_LABEL插入标签</h4>
                  <div>
                     <p><code class="codeph">TO_DATA_LABEL</code>函数可以动态生成新标签。
                     </p>
                     <div class="section">
                        <p>此方法可确保数据标签有效。但请注意，安装Oracle Label Security以使用Oracle Internet Directory时，不允许生成动态标签，因为使用<code class="codeph">olsadmintool</code>命令在Oracle Internet Directory中集中管理标签。因此，当Oracle Label Security启用目录时，此功能<code class="codeph">TO_DATA_LABEL</code>不可用，如果使用，将生成错误消息。
                        </p>
                        <ol>
                           <li>
                              <p>确保您对<code class="codeph">TO_DATA_LABEL</code>函数具有<code class="codeph">EXECUTE</code>特权。
                              </p>
                           </li>
                           <li>
                              <p>根据需要使用<code class="codeph">TO_DATA_LABEL</code> ，例如，在<code class="codeph">INSERT INTO</code>语句中。
                              </p>
                           </li>
                        </ol>
                        <p>例如：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO emp（ename，empno，hr_label）VALUES（'ESTANTON'，10，to_data_label（'HR'，'SENSITIVE'））;</pre><div class="infoboxnote" id="GUID-200BD865-1840-4A11-B179-D445A2342C21__GUID-3DC09E4E-7183-45DA-A3D5-53463AF49FC4">
                           <p class="notep1">注意：</p>
                           <p>必须将<code class="codeph">TO_DATA_LABEL</code>函数显式授予个人才能使用。它的使用应该严格控制。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="command-line-tools-for-label-security-using-oracle-internet-directory.html#GUID-CEBDC422-8872-46C1-8A3B-F1161539DD22" title="Oracle Label Security提供了使用Oracle Internet Directory的命令行工具。">使用Oracle Internet Directory进行标签安全的命令行工具</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-ED5DA711-477C-42D9-B03C-866A909DDE23" title="您可以在各种情况下插入带标签的数据。">插入标签数据</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="OLSAG3787"></a><div class="props_rev_3"><a id="GUID-52C240C0-D5B3-4F9A-9C83-F8AA2FC360DF" name="GUID-52C240C0-D5B3-4F9A-9C83-F8AA2FC360DF"></a><h3 id="OLSAG-GUID-52C240C0-D5B3-4F9A-9C83-F8AA2FC360DF" class="sect3">更改会话和行标签</h3>
               <div>
                  <p>在会话期间，用户可以根据管理员设置的授权更改标签。</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="oracle-label-security-pl-sql-packages.html#GUID-406E4A7D-EC93-4720-BE46-0553EA0B1BB7" title="SA_SESSION PL / SQL包管理用户授权的会话行为。">SA_SESSION会话管理PL / SQL包</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="working-with-labeled-data.html#GUID-75401780-723A-4EA5-AEDB-751E48AFC1DA" title="您可以管理标记数据，查看会话的安全属性数据，以及更改会话属性的值。">使用标记数据</a></p>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="01597.package-Range-API.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>XML C API的包范围</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="XML C API Reference"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="XML C API Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="xml-c-api-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T06:29:15-08:00"></meta>
      <meta name="dcterms.title" content="XML C API Reference"></meta>
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96478-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="package-Orastream-API.html" title="Previous" type="text/html"></link>
      <link rel="next" href="package-SAX-API.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CAXML"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="package-Orastream-API.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="package-SAX-API.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">XML C API参考</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">XML C API的包范围</li>
            </ol>
            <a id="GUID-A0B27F7E-D361-4CA6-993E-31B2FCF441A9" name="GUID-A0B27F7E-D361-4CA6-993E-31B2FCF441A9"></a><a id="CAXML01000"></a>
            
            <h2 id="CAXML-GUID-A0B27F7E-D361-4CA6-993E-31B2FCF441A9" class="sect2"><span class="enumeration_chapter">6</span> XML C API的包范围</h2>
         </header>
         <div class="ind">
            <div>
               <p>下表总结了通过<code class="codeph">Range</code>接口为XML C API提供的方法。</p>
               <div class="tblformal" id="GUID-A0B27F7E-D361-4CA6-993E-31B2FCF441A9__SUMMARYDOMRANGE">
                  <p class="titleintable">表6-1 XML C实现的范围方法摘要</p>
                  <table cellpadding="4" cellspacing="0" class="Formal" title="XML C实现的范围方法综述" width="100%" border="1" summary="First column lists interfaces; second column provides a brief description of these interfaces." frame="hsides" rules="rows">
                     <thead>
                        <tr align="left" valign="top">
                           <th align="left" valign="bottom" width="53%" id="d82768e53">功能</th>
                           <th align="left" valign="bottom" width="47%" id="d82768e56">摘要</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e61" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-9A232385-010C-48FE-B0CB-8129F6E696F8">XmlDomCreateRange（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e61 d82768e56 ">
                              <p>创建<code class="codeph">Range</code>对象。
                              </p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e73" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-FF338C12-B7D2-4F82-BEC6-065DC0B7E9E5">XmlDomRangeClone（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e73 d82768e56 ">
                              <p>克隆范围。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e82" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-5310C75C-8374-4DB7-BC90-CDC5704779C9">XmlDomRangeCloneContents（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e82 d82768e56 ">
                              <p>克隆范围选择的内容。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e91" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-4C345888-A6AA-46E3-A358-A8D582742D10">XmlDomRangeCollapse（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e91 d82768e56 ">
                              <p>折叠范围到起点或终点。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e100" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-361852E2-E8C6-4A81-8AC4-5BB492202960">XmlDomRangeCompareBoundaryPoints（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e100 d82768e56 ">
                              <p>比较两个范围的边界点。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e109" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-28431A21-CBB4-4786-99D4-4DD3AE143E8F">XmlDomRangeDeleteContents（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e109 d82768e56 ">
                              <p>删除范围选择的内容。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e118" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-4C7D7DD3-0AE7-4063-B927-C192BDF28B0C">XmlDomRangeDetach（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e118 d82768e56 ">
                              <p>分离范围。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e127" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-094B6FD6-BE91-4B68-9932-2A1878F4372F">XmlDomRangeExtractContents（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e127 d82768e56 ">
                              <p>提取范围选择的内容。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e136" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-073E5526-D059-4396-87AA-C033DE14D402">XmlDomRangeGetCollapsed（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e136 d82768e56 ">
                              <p>返回范围是否折叠。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e145" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-AB3CD220-743E-48BC-B8BE-8DDBB0970CD7">XmlDomRangeGetCommonAncestor（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e145 d82768e56 ">
                              <p>返回两个边界点最深的共同祖先节点。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e154" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-3885C797-531F-404A-9EC0-BEA8D29F2223">XmlDomRangeGetDetached（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e154 d82768e56 ">
                              <p>返回范围是否已分离。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e164" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-77EA2F79-2D9D-4A3C-8A81-F366F70EF264">XmlDomRangeGetEndContainer（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e164 d82768e56 ">
                              <p>返回范围结束容器节点。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e173" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-76A62733-E419-4032-A9CE-3F98AE448BB3">XmlDomRangeGetEndOffset（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e173 d82768e56 ">
                              <p>返回范围结束偏移量。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e182" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-09F660F0-0704-4D3C-BEF6-886DC706464F">XmlDomRangeGetStartContainer（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e182 d82768e56 ">
                              <p>返回范围启动容器节点。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e191" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-00795DE0-F24F-40F9-8BFA-7CCC06A00106">XmlDomRangeGetStartOffset（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e191 d82768e56 ">
                              <p>返回范围起始偏移量。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e200" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-A2897E98-5837-4E97-BD1C-52B7887A1158">XmlDomRangeIsConsistent（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e200 d82768e56 ">
                              <p>返回范围是否一致。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e209" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-CEAAB2E8-21DE-4DF5-ABC4-B302E5C0F1C6">XmlDomRangeSelectNode（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e209 d82768e56 ">
                              <p>选择一个节点作为范围。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e218" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-F9142058-3AF9-4302-BBF1-D8B1FDEC3568">XmlDomRangeSelectNodeContents（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e218 d82768e56 ">
                              <p>定义范围以选择节点内容。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e227" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-51026D4D-A425-4E38-824E-22E00337DD53">XmlDomRangeSetEnd（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e227 d82768e56 ">
                              <p>设置终点。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e236" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-FB3220A7-8CCB-4B33-9AAF-B05A0F2FAD3A">XmlDomRangeSetEndBefore（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e236 d82768e56 ">
                              <p>在节点之前设置结束点。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e245" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-C16961E4-6348-439C-8F89-B2FD34E07ED0">XmlDomRangeSetStart（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e245 d82768e56 ">
                              <p>设置起点。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e254" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-CABB2A67-B6AB-4E34-830F-8C7659554B55">XmlDomRangeSetStartAfter（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e254 d82768e56 ">
                              <p>设置节点后的起点。</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="53%" id="d82768e264" headers="d82768e53 ">
                              <p><a href="package-Range-API.html#GUID-E1CFF2BE-EE88-482C-92D0-A9CA67EF9ED7">XmlDomRangeSetStartBefore（）</a></p>
                           </td>
                           <td align="left" valign="top" width="47%" headers="d82768e264 d82768e56 ">
                              <p>设置节点之前的起点。</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <!-- class="inftblhruleinformal" -->
            </div><a id="CAXML5838"></a><a id="CAXML5839"></a><a id="CAXML5837"></a><div class="props_rev_3"><a id="GUID-9A232385-010C-48FE-B0CB-8129F6E696F8" name="GUID-9A232385-010C-48FE-B0CB-8129F6E696F8"></a><h3 id="CAXML-GUID-9A232385-010C-48FE-B0CB-8129F6E696F8" class="sect3">XmlDomCreateRange（）</h3>
               <div>
                  <div class="section">
                     <p><code class="codeph">DocumentRange</code>接口的唯一方法，用于创建<code class="codeph">Range</code>对象。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9A232385-010C-48FE-B0CB-8129F6E696F8__GUID-309E5867-D4E8-4925-9480-B5A747D3A1B1">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlrange * XmlDomCreateRange（xmlctx * xctx，xmlrange * range，xmldocnode * doc）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-9A232385-010C-48FE-B0CB-8129F6E696F8__GUID-EF41F8CD-1C4C-4399-A7EF-CA4BC5960CB7">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="23%" id="d82768e338">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e341">进出</th>
                              <th align="left" valign="bottom" width="65%" id="d82768e344">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d82768e349" headers="d82768e338 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e349 d82768e341 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="65%" headers="d82768e349 d82768e344 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d82768e359" headers="d82768e338 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e359 d82768e341 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="65%" headers="d82768e359 d82768e344 ">
                                 <p>现有的NodeIterator，或<code class="codeph">NULL</code>来分配新的</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d82768e372" headers="d82768e338 "><pre class="oac_no_warn" dir="ltr">DOC</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e372 d82768e341 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="65%" headers="d82768e372 d82768e344 ">
                                 <p>附加新<code class="codeph">Range</code>文档</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9A232385-010C-48FE-B0CB-8129F6E696F8__GUID-518EC015-BE70-4541-877E-070DC0B367BC">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlrange *)</code>原始或新的<code class="codeph">Range</code>对象。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5843"></a><a id="CAXML5844"></a><a id="CAXML5842"></a><div class="props_rev_3"><a id="GUID-FF338C12-B7D2-4F82-BEC6-065DC0B7E9E5" name="GUID-FF338C12-B7D2-4F82-BEC6-065DC0B7E9E5"></a><h3 id="CAXML-GUID-FF338C12-B7D2-4F82-BEC6-065DC0B7E9E5" class="sect3">XmlDomRangeClone（）</h3>
               <div>
                  <div class="section">
                     <p>克隆<code class="codeph">Range</code> 。克隆范围而不影响原始范围选择的内容。如果出错，则返回<code class="codeph">NULL</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-FF338C12-B7D2-4F82-BEC6-065DC0B7E9E5__GUID-B4A73E00-DB26-4DD3-86CA-1BBBF4087D86">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlrange * XmlDomRangeClone（xmlctx * xctx，xmlrange * range，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-FF338C12-B7D2-4F82-BEC6-065DC0B7E9E5__GUID-4A013E85-1EF7-4194-9FED-2A20B42A79CA">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="23%" id="d82768e461">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e464">进出</th>
                              <th align="left" valign="bottom" width="65%" id="d82768e467">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d82768e472" headers="d82768e461 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e472 d82768e464 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="65%" headers="d82768e472 d82768e467 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d82768e482" headers="d82768e461 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e482 d82768e464 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="65%" headers="d82768e482 d82768e467 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="23%" id="d82768e492" headers="d82768e461 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e492 d82768e464 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="65%" headers="d82768e492 d82768e467 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-FF338C12-B7D2-4F82-BEC6-065DC0B7E9E5__GUID-B8FD7481-AA55-480C-9C3C-7712F198BDCA">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlrange *)</code>克隆旧范围的新范围</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5846"></a><a id="CAXML5847"></a><a id="CAXML5845"></a><div class="props_rev_3"><a id="GUID-5310C75C-8374-4DB7-BC90-CDC5704779C9" name="GUID-5310C75C-8374-4DB7-BC90-CDC5704779C9"></a><h3 id="CAXML-GUID-5310C75C-8374-4DB7-BC90-CDC5704779C9" class="sect3">XmlDomRangeCloneContents（）</h3>
               <div>
                  <div class="section">
                     <p>克隆范围选择的内容。克隆但不删除范围选择的内容。执行范围一致性检查，并在出现错误时将<code class="codeph">retval</code>设置为错误代码。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-5310C75C-8374-4DB7-BC90-CDC5704779C9__GUID-7592B7EE-31A5-4E4D-9638-E6B3590AF1E0">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlnode * XmlDomRangeCloneContents（xmlctx * xctx，xmlrange * range，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-5310C75C-8374-4DB7-BC90-CDC5704779C9__GUID-37A49BD6-0D06-4C61-8328-3AD1FBC656A2">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e573">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e576">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e579">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e584" headers="d82768e573 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e584 d82768e576 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e584 d82768e579 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e594" headers="d82768e573 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e594 d82768e576 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e594 d82768e579 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e604" headers="d82768e573 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e604 d82768e576 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e604 d82768e579 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-5310C75C-8374-4DB7-BC90-CDC5704779C9__GUID-D853BA03-2614-47D1-9D2B-DE564BA1F44F">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlnode *)</code>克隆内容</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5849"></a><a id="CAXML5850"></a><a id="CAXML5848"></a><div class="props_rev_3"><a id="GUID-4C345888-A6AA-46E3-A358-A8D582742D10" name="GUID-4C345888-A6AA-46E3-A358-A8D582742D10"></a><h3 id="CAXML-GUID-4C345888-A6AA-46E3-A358-A8D582742D10" class="sect3">XmlDomRangeCollapse（）</h3>
               <div>
                  <div class="section">
                     <p>将范围折叠为起点或终点。它被折叠到的点被假定为附加该范围的文档中的有效点。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-4C345888-A6AA-46E3-A358-A8D582742D10__GUID-AE28FF0F-BC08-40DE-9815-855D8ED622EE">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlerr XmlDomRangeCollapse（xmlctx * xctx，xmlrange * range，boolean tostart）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-4C345888-A6AA-46E3-A358-A8D582742D10__GUID-4F268AE2-2C3C-4470-AF29-6B49428BE1C0">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e681">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e684">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e687">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e692" headers="d82768e681 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e692 d82768e684 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e692 d82768e687 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e702" headers="d82768e681 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e702 d82768e684 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e702 d82768e687 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e712" headers="d82768e681 "><pre class="oac_no_warn" dir="ltr">开始</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e712 d82768e684 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e712 d82768e687 ">
                                 <p>指示是要折叠以开始（ <code class="codeph">TRUE</code> ）还是结束（ <code class="codeph">FALSE</code> ）</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-4C345888-A6AA-46E3-A358-A8D582742D10__GUID-D246A41C-A184-456B-9EA9-5C8275C91872">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlerr)</code>数字返回码</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5852"></a><a id="CAXML5853"></a><a id="CAXML5851"></a><div class="props_rev_3"><a id="GUID-361852E2-E8C6-4A81-8AC4-5BB492202960" name="GUID-361852E2-E8C6-4A81-8AC4-5BB492202960"></a><h3 id="CAXML-GUID-361852E2-E8C6-4A81-8AC4-5BB492202960" class="sect3">XmlDomRangeCompareBoundaryPoints（）</h3>
               <div>
                  <div class="section">
                     <p>比较两个不同范围的两个边界点。返回<code class="codeph">-1,0,1</code>具体取决于范围（范围）的对应边界点是在第二个范围（ <code class="codeph">srange</code> ）的对应边界点之前，相等还是之后。如果两个范围附加到两个不同的文档或者其中一个文档被分离，则返回<code class="codeph">~(int)0</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-361852E2-E8C6-4A81-8AC4-5BB492202960__GUID-7B668696-DB47-4D2E-98D8-8AF5DBCB9326">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">sb4 XmlDomRangeCompareBoundaryPoints（xmlctx * xctx，xmlrange * range，xmlcmphow how，xmlrange * srange，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-361852E2-E8C6-4A81-8AC4-5BB492202960__GUID-4DEE606B-4913-40D6-9BF1-CAAB233C6E83">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e804">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e807">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e810">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e815" headers="d82768e804 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e815 d82768e807 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e815 d82768e810 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e825" headers="d82768e804 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e825 d82768e807 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e825 d82768e810 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e835" headers="d82768e804 "><pre class="oac_no_warn" dir="ltr">怎么样</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e835 d82768e807 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e835 d82768e810 ">
                                 <p><code class="codeph">xmlcmphow</code>值;怎么比较</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e847" headers="d82768e804 "><pre class="oac_no_warn" dir="ltr">srange</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e847 d82768e807 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e847 d82768e810 ">
                                 <p>范围对象，可与之比较</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e857" headers="d82768e804 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e857 d82768e807 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e857 d82768e810 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-361852E2-E8C6-4A81-8AC4-5BB492202960__GUID-BC112204-733E-410E-A8AD-174E2C6A5B4F">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(sb4)</code> <code class="codeph">strcmp</code>的比较结果</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5855"></a><a id="CAXML5856"></a><a id="CAXML5854"></a><div class="props_rev_3"><a id="GUID-28431A21-CBB4-4786-99D4-4DD3AE143E8F" name="GUID-28431A21-CBB4-4786-99D4-4DD3AE143E8F"></a><h3 id="CAXML-GUID-28431A21-CBB4-4786-99D4-4DD3AE143E8F" class="sect3">XmlDomRangeDeleteContents（）</h3>
               <div>
                  <div class="section">
                     <p>删除范围选择的内容。执行范围一致性检查，并在出现错误时将<code class="codeph">retval</code>设置为错误代码。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-28431A21-CBB4-4786-99D4-4DD3AE143E8F__GUID-3B6F570C-B070-4412-8850-021CCAB43300">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlerr XmlDomRangeDeleteContents（xmlctx * xctx，xmlrange * range）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-28431A21-CBB4-4786-99D4-4DD3AE143E8F__GUID-CDC474B2-4415-4B35-8720-2000BA209CB8">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e941">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e944">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e947">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e952" headers="d82768e941 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e952 d82768e944 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e952 d82768e947 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e962" headers="d82768e941 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e962 d82768e944 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e962 d82768e947 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-28431A21-CBB4-4786-99D4-4DD3AE143E8F__GUID-CCCD549E-704F-443D-8778-251012086938">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlerr)</code>数字返回码</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5858"></a><a id="CAXML5859"></a><a id="CAXML5857"></a><div class="props_rev_3"><a id="GUID-4C7D7DD3-0AE7-4063-B927-C192BDF28B0C" name="GUID-4C7D7DD3-0AE7-4063-B927-C192BDF28B0C"></a><h3 id="CAXML-GUID-4C7D7DD3-0AE7-4063-B927-C192BDF28B0C" class="sect3">XmlDomRangeDetach（）</h3>
               <div>
                  <div class="section">
                     <p>从文档中分离范围并将其（范围）置于无效状态。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-4C7D7DD3-0AE7-4063-B927-C192BDF28B0C__GUID-A73F26D0-FDA5-4C63-9565-2B530E554E39">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlerr XmlDomRangeDetach（xmlctx * xctx，xmlrange * range）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-4C7D7DD3-0AE7-4063-B927-C192BDF28B0C__GUID-6B1471CD-1424-4B72-BD28-D8AC83A4D013">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e1039">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e1042">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e1045">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1050" headers="d82768e1039 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1050 d82768e1042 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1050 d82768e1045 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1060" headers="d82768e1039 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1060 d82768e1042 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1060 d82768e1045 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-4C7D7DD3-0AE7-4063-B927-C192BDF28B0C__GUID-DFFBAFC2-F06E-413F-9E9F-3E387792A090">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlerr)</code>数字返回码</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5861"></a><a id="CAXML5862"></a><a id="CAXML5860"></a><div class="props_rev_3"><a id="GUID-094B6FD6-BE91-4B68-9932-2A1878F4372F" name="GUID-094B6FD6-BE91-4B68-9932-2A1878F4372F"></a><h3 id="CAXML-GUID-094B6FD6-BE91-4B68-9932-2A1878F4372F" class="sect3">XmlDomRangeExtractContents（）</h3>
               <div>
                  <div class="section">
                     <p>提取范围选择的内容。克隆并删除范围选择的内容。执行范围一致性检查，并在出现错误时将<code class="codeph">retval</code>设置为错误代码。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-094B6FD6-BE91-4B68-9932-2A1878F4372F__GUID-EA1520B0-C853-4BCB-99F5-5E89CC748EC3">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlnode * XmlDomRangeExtractContents（xmlctx * xctx，xmlrange * range，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-094B6FD6-BE91-4B68-9932-2A1878F4372F__GUID-9EB76661-4CA1-4DE1-B32F-AA18D362A4FA">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e1140">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e1143">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e1146">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1151" headers="d82768e1140 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1151 d82768e1143 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1151 d82768e1146 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1161" headers="d82768e1140 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1161 d82768e1143 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1161 d82768e1146 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1171" headers="d82768e1140 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1171 d82768e1143 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1171 d82768e1146 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-094B6FD6-BE91-4B68-9932-2A1878F4372F__GUID-3B053A48-27A6-4DE2-8A20-DF2BEF164FF7">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlnode *)</code>提取</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5864"></a><a id="CAXML5865"></a><a id="CAXML5863"></a><div class="props_rev_3"><a id="GUID-073E5526-D059-4396-87AA-C033DE14D402" name="GUID-073E5526-D059-4396-87AA-C033DE14D402"></a><h3 id="CAXML-GUID-073E5526-D059-4396-87AA-C033DE14D402" class="sect3">XmlDomRangeGetCollapsed（）</h3>
               <div>
                  <div class="section">
                     <p>返回<code class="codeph">TRUE</code>如果范围崩溃，不沾边，否则返回<code class="codeph">FALSE</code> 。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-073E5526-D059-4396-87AA-C033DE14D402__GUID-C6D749E1-0355-4809-AC93-A8C9259680AC">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">boolean XmlDomRangeGetCollapsed（xmlctx * xctx，xmlrange * range，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-073E5526-D059-4396-87AA-C033DE14D402__GUID-FD6C28F3-3BFB-4D65-85D5-978E51E8EC1C">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e1255">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e1258">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e1261">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1266" headers="d82768e1255 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1266 d82768e1258 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1266 d82768e1261 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1276" headers="d82768e1255 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1276 d82768e1258 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1276 d82768e1261 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1286" headers="d82768e1255 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1286 d82768e1258 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1286 d82768e1261 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-073E5526-D059-4396-87AA-C033DE14D402__GUID-59A521DB-D86F-4471-8EB1-CEB68824617A">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(boolean)</code>如果范围是折叠的则为<code class="codeph">TRUE</code> ，否则为<code class="codeph">FALSE</code></p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5867"></a><a id="CAXML5868"></a><a id="CAXML5866"></a><div class="props_rev_3"><a id="GUID-AB3CD220-743E-48BC-B8BE-8DDBB0970CD7" name="GUID-AB3CD220-743E-48BC-B8BE-8DDBB0970CD7"></a><h3 id="CAXML-GUID-AB3CD220-743E-48BC-B8BE-8DDBB0970CD7" class="sect3">XmlDomRangeGetCommonAncestor（）</h3>
               <div>
                  <div class="section">
                     <p>如果范围未分离，则返回范围的两个边界点的最深公共祖先节点，否则返回<code class="codeph">NULL</code> 。假设范围处于一致状态。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-AB3CD220-743E-48BC-B8BE-8DDBB0970CD7__GUID-97210527-94BF-40BD-8ED4-AB35007844A3">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlnode * XmlDomRangeGetCommonAncestor（xmlctx * xctx，xmlrange * range，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-AB3CD220-743E-48BC-B8BE-8DDBB0970CD7__GUID-2C8D46D4-A420-4E11-AD10-91A03CCAB709">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e1372">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e1375">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e1378">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1383" headers="d82768e1372 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1383 d82768e1375 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1383 d82768e1378 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1393" headers="d82768e1372 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1393 d82768e1375 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1393 d82768e1378 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1403" headers="d82768e1372 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1403 d82768e1375 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1403 d82768e1378 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-AB3CD220-743E-48BC-B8BE-8DDBB0970CD7__GUID-44C6790E-3486-4695-9D30-C87D1EF84388">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlnode *)</code>最深的共同祖先节点[或<code class="codeph">NULL</code> ]</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5870"></a><a id="CAXML5871"></a><a id="CAXML5869"></a><div class="props_rev_3"><a id="GUID-3885C797-531F-404A-9EC0-BEA8D29F2223" name="GUID-3885C797-531F-404A-9EC0-BEA8D29F2223"></a><h3 id="CAXML-GUID-3885C797-531F-404A-9EC0-BEA8D29F2223" class="sect3">XmlDomRangeGetDetached（）</h3>
               <div>
                  <div class="section">
                     <p>返回范围是否已分离。如果范围已分离且不为<code class="codeph">NULL</code> ，则返回<code class="codeph">TRUE</code> 。否则返回<code class="codeph">FALSE</code> 。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-3885C797-531F-404A-9EC0-BEA8D29F2223__GUID-A5968DF2-95B7-4982-9A22-F52ADAB65019">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">ub1 XmlDomRangeGetDetached（xmlctx * xctx，xmlrange * range）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-3885C797-531F-404A-9EC0-BEA8D29F2223__GUID-ABC9ADAB-FC37-4B95-9CD0-710B8F878528">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e1492">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e1495">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e1498">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1503" headers="d82768e1492 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1503 d82768e1495 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1503 d82768e1498 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1513" headers="d82768e1492 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1513 d82768e1495 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1513 d82768e1498 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-3885C797-531F-404A-9EC0-BEA8D29F2223__GUID-3BB34899-F0DE-4E23-A8E0-33D9E83A4918">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(ub1)</code>如果范围已分离<code class="codeph">(ub1)</code> <code class="codeph">TRUE</code> ，否则为<code class="codeph">FALSE</code></p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5873"></a><a id="CAXML5874"></a><a id="CAXML5872"></a><div class="props_rev_3"><a id="GUID-77EA2F79-2D9D-4A3C-8A81-F366F70EF264" name="GUID-77EA2F79-2D9D-4A3C-8A81-F366F70EF264"></a><h3 id="CAXML-GUID-77EA2F79-2D9D-4A3C-8A81-F366F70EF264" class="sect3">XmlDomRangeGetEndContainer（）</h3>
               <div>
                  <div class="section">
                     <p>如果范围未分离，则返回范围结束容器节点，否则返回<code class="codeph">NULL</code> 。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-77EA2F79-2D9D-4A3C-8A81-F366F70EF264__GUID-EA399348-92F0-4843-A3CE-7B69C140D460">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlnode * XmlDomRangeGetEndContainer（xmlctx * xctx，xmlrange * range，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-77EA2F79-2D9D-4A3C-8A81-F366F70EF264__GUID-29CA9F15-ED15-4DF0-BFD0-67163B218692">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e1600">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e1603">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e1606">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1611" headers="d82768e1600 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1611 d82768e1603 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1611 d82768e1606 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1621" headers="d82768e1600 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1621 d82768e1603 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1621 d82768e1606 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1631" headers="d82768e1600 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1631 d82768e1603 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1631 d82768e1606 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-77EA2F79-2D9D-4A3C-8A81-F366F70EF264__GUID-0B711B1D-7803-415C-A4E4-3DAE30DE416F">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlnode *)</code>范围结束容器节点[或<code class="codeph">NULL</code> ]</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5876"></a><a id="CAXML5877"></a><a id="CAXML5875"></a><div class="props_rev_3"><a id="GUID-76A62733-E419-4032-A9CE-3F98AE448BB3" name="GUID-76A62733-E419-4032-A9CE-3F98AE448BB3"></a><h3 id="CAXML-GUID-76A62733-E419-4032-A9CE-3F98AE448BB3" class="sect3">XmlDomRangeGetEndOffset（）</h3>
               <div>
                  <div class="section">
                     <p>如果范围未分离则返回范围结束偏移量，否则返回<code class="codeph">~(ub4)0</code> [最大<code class="codeph">ub4</code>值]。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-76A62733-E419-4032-A9CE-3F98AE448BB3__GUID-373574FD-593F-4F6C-9E87-10BD6284525C">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">ub4 XmlDomRangeGetEndOffset（xmlctx * xctx，xmlrange * range，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-76A62733-E419-4032-A9CE-3F98AE448BB3__GUID-F8413D97-E23D-47D2-999E-DA6B3ECAD0BB">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e1717">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e1720">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e1723">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1728" headers="d82768e1717 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1728 d82768e1720 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1728 d82768e1723 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1738" headers="d82768e1717 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1738 d82768e1720 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1738 d82768e1723 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1748" headers="d82768e1717 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1748 d82768e1720 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1748 d82768e1723 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-76A62733-E419-4032-A9CE-3F98AE448BB3__GUID-967F7F85-F87A-4386-BE04-4D07E462AFD2">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(ub4)</code>范围结束偏移[或<code class="codeph">ub4</code>最大]</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5879"></a><a id="CAXML5880"></a><a id="CAXML5878"></a><div class="props_rev_3"><a id="GUID-09F660F0-0704-4D3C-BEF6-886DC706464F" name="GUID-09F660F0-0704-4D3C-BEF6-886DC706464F"></a><h3 id="CAXML-GUID-09F660F0-0704-4D3C-BEF6-886DC706464F" class="sect3">XmlDomRangeGetStartContainer（）</h3>
               <div>
                  <div class="section">
                     <p>如果范围有效且未分离，则返回范围起始容器节点，否则返回<code class="codeph">NULL</code> 。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-09F660F0-0704-4D3C-BEF6-886DC706464F__GUID-7BFA83AB-78E2-4AE9-832B-FAE93B7548C8">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlnode * XmlDomRangeGetStartContainer（xmlctx * xctx，xmlrange * range，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-09F660F0-0704-4D3C-BEF6-886DC706464F__GUID-3683D126-99E0-4EC9-8952-51C011DA7BE6">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e1831">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e1834">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e1837">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1842" headers="d82768e1831 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1842 d82768e1834 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1842 d82768e1837 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1852" headers="d82768e1831 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1852 d82768e1834 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1852 d82768e1837 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1862" headers="d82768e1831 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1862 d82768e1834 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1862 d82768e1837 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-09F660F0-0704-4D3C-BEF6-886DC706464F__GUID-6F2DA6ED-CD68-412B-BCB6-7ADF759810B4">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlnode *)</code>范围启动容器节点</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5882"></a><a id="CAXML5883"></a><a id="CAXML5881"></a><div class="props_rev_3"><a id="GUID-00795DE0-F24F-40F9-8BFA-7CCC06A00106" name="GUID-00795DE0-F24F-40F9-8BFA-7CCC06A00106"></a><h3 id="CAXML-GUID-00795DE0-F24F-40F9-8BFA-7CCC06A00106" class="sect3">XmlDomRangeGetStartOffset（）</h3>
               <div>
                  <div class="section">
                     <p>如果范围未分离则返回范围起始偏移量，否则返回<code class="codeph">~(ub4)0</code> [最大<code class="codeph">ub4</code>值]。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-00795DE0-F24F-40F9-8BFA-7CCC06A00106__GUID-8C7B5A3D-3789-46C4-9E0A-B90B31CD156D">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">ub4 XmlDomRangeGetStartOffset（xmlctx * xctx，xmlrange * range，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-00795DE0-F24F-40F9-8BFA-7CCC06A00106__GUID-C36D00D1-C1B7-40EC-96F9-769BC6A8DDB5">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e1946">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e1949">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e1952">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1957" headers="d82768e1946 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1957 d82768e1949 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1957 d82768e1952 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1967" headers="d82768e1946 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1967 d82768e1949 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1967 d82768e1952 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e1977" headers="d82768e1946 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e1977 d82768e1949 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e1977 d82768e1952 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-00795DE0-F24F-40F9-8BFA-7CCC06A00106__GUID-E59F16E1-DAEF-48CD-ACCC-6FA9BE02FD7A">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(ub4)</code>范围起始偏移[或<code class="codeph">ub4</code>最大]</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5885"></a><a id="CAXML5886"></a><a id="CAXML5884"></a><div class="props_rev_3"><a id="GUID-A2897E98-5837-4E97-BD1C-52B7887A1158" name="GUID-A2897E98-5837-4E97-BD1C-52B7887A1158"></a><h3 id="CAXML-GUID-A2897E98-5837-4E97-BD1C-52B7887A1158" class="sect3">XmlDomRangeIsConsistent（）</h3>
               <div>
                  <div class="section">
                     <p>返回范围是否一致。如果范围一致，则返回<code class="codeph">TRUE</code> ：两个点都在同一个根下，起点在结束点之前或之前。否则返回<code class="codeph">FALSE</code> 。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-A2897E98-5837-4E97-BD1C-52B7887A1158__GUID-2E6354A0-401F-480C-9705-34DAF8F68E05">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">boolean XmlDomRangeIsConsistent（xmlctx * xctx，xmlrange * range，xmlerr * xerr）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-A2897E98-5837-4E97-BD1C-52B7887A1158__GUID-BFACEFAE-8B5E-4481-A758-72CB78378EBF">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e2063">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e2066">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e2069">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2074" headers="d82768e2063 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2074 d82768e2066 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2074 d82768e2069 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2084" headers="d82768e2063 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2084 d82768e2066 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2084 d82768e2069 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2094" headers="d82768e2063 "><pre class="oac_no_warn" dir="ltr">XERR</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2094 d82768e2066 "><pre class="oac_no_warn" dir="ltr">OUT</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2094 d82768e2069 ">
                                 <p>数字返回码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-A2897E98-5837-4E97-BD1C-52B7887A1158__GUID-40DAE87C-6B71-46DA-9151-5AAA142A8361">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(ub1)</code>如果范围一致<code class="codeph">(ub1)</code> <code class="codeph">TRUE</code> ，否则为<code class="codeph">FALSE</code></p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5888"></a><a id="CAXML5889"></a><a id="CAXML5887"></a><div class="props_rev_3"><a id="GUID-CEAAB2E8-21DE-4DF5-ABC4-B302E5C0F1C6" name="GUID-CEAAB2E8-21DE-4DF5-ABC4-B302E5C0F1C6"></a><h3 id="CAXML-GUID-CEAAB2E8-21DE-4DF5-ABC4-B302E5C0F1C6" class="sect3">XmlDomRangeSelectNode（）</h3>
               <div>
                  <div class="section">
                     <p>设置范围结束点和起始点，以便此节点的父节点成为容器节点，偏移量是此节点在其父节点的子节点之间的偏移量。范围变得崩溃。假设该节点是其文档的有效节点。如果分离范围，则忽略该范围，并附加范围。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-CEAAB2E8-21DE-4DF5-ABC4-B302E5C0F1C6__GUID-53A21BE0-EA9C-405E-B706-5624EEA9B966">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlerr XmlDomRangeSelectNode（xmlctx * xctx，xmlrange * range，xmlnode * node）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-CEAAB2E8-21DE-4DF5-ABC4-B302E5C0F1C6__GUID-5E62DD6E-E386-422B-96AB-DDAD3F5FE4AD">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e2177">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e2180">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e2183">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2188" headers="d82768e2177 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2188 d82768e2180 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2188 d82768e2183 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2198" headers="d82768e2177 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2198 d82768e2180 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2198 d82768e2183 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2208" headers="d82768e2177 "><pre class="oac_no_warn" dir="ltr">节点</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2208 d82768e2180 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2208 d82768e2183 ">
                                 <p>XML节点</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-CEAAB2E8-21DE-4DF5-ABC4-B302E5C0F1C6__GUID-0BB82648-34B8-43B6-B215-719611EE096A">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlerr)</code>数字返回码</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5891"></a><a id="CAXML5892"></a><a id="CAXML5890"></a><div class="props_rev_3"><a id="GUID-F9142058-3AF9-4302-BBF1-D8B1FDEC3568" name="GUID-F9142058-3AF9-4302-BBF1-D8B1FDEC3568"></a><h3 id="CAXML-GUID-F9142058-3AF9-4302-BBF1-D8B1FDEC3568" class="sect3">XmlDomRangeSelectNodeContents（）</h3>
               <div>
                  <div class="section">
                     <p>将范围起始点设置为节点内容的开始，将结束点设置为节点内容的结尾。假设该节点是有效的文档节点。如果分离范围，则忽略该范围，并附加范围。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F9142058-3AF9-4302-BBF1-D8B1FDEC3568__GUID-36701416-5C84-4127-985F-ADD3C6DEB4B1">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlerr XmlDomRangeSelectNodeContents（xmlctx * xctx，xmlrange * range，xmlnode * node）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-F9142058-3AF9-4302-BBF1-D8B1FDEC3568__GUID-8E478C37-DA14-4735-A22F-A82E1E23A5F4">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e2286">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e2289">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e2292">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2297" headers="d82768e2286 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2297 d82768e2289 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2297 d82768e2292 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2307" headers="d82768e2286 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2307 d82768e2289 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2307 d82768e2292 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2317" headers="d82768e2286 "><pre class="oac_no_warn" dir="ltr">节点</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2317 d82768e2289 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2317 d82768e2292 ">
                                 <p>XML节点</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F9142058-3AF9-4302-BBF1-D8B1FDEC3568__GUID-6055D2D6-7C6D-4B9E-B86D-E2D7686B75DE">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlerr)</code>数字返回码</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5894"></a><a id="CAXML5895"></a><a id="CAXML5893"></a><div class="props_rev_3"><a id="GUID-51026D4D-A425-4E38-824E-22E00337DD53" name="GUID-51026D4D-A425-4E38-824E-22E00337DD53"></a><h3 id="CAXML-GUID-51026D4D-A425-4E38-824E-22E00337DD53" class="sect3">XmlDomRangeSetEnd（）</h3>
               <div>
                  <div class="section">
                     <p>设置范围终点。如果它具有除当前范围之外的根容器，则范围将折叠到新位置。如果将结束设置为开始之前的位置，则范围将折叠到该位置。返回<code class="codeph">xmlerr</code>值。根据描述此类型的描述。假设范围的起点是有效的起点。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-51026D4D-A425-4E38-824E-22E00337DD53__GUID-B0AE530A-E086-4E82-9F89-B4CE858AA4CA">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlerr XmlDomRangeSetEnd（xmlctx * xctx，xmlrange * range，xmlnode * node，ub4 offset）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-51026D4D-A425-4E38-824E-22E00337DD53__GUID-A3EB6B0B-6F05-491B-A477-73D82E22B2BA">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e2397">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e2400">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e2403">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2408" headers="d82768e2397 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2408 d82768e2400 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2408 d82768e2403 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2418" headers="d82768e2397 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2418 d82768e2400 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2418 d82768e2403 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2428" headers="d82768e2397 "><pre class="oac_no_warn" dir="ltr">节点</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2428 d82768e2400 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2428 d82768e2403 ">
                                 <p>XML节点</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2438" headers="d82768e2397 "><pre class="oac_no_warn" dir="ltr">抵消</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2438 d82768e2400 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2438 d82768e2403 ">
                                 <p>结束偏移量</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-51026D4D-A425-4E38-824E-22E00337DD53__GUID-0E101512-828F-4115-846C-075CB17B628E">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlerr)</code>数字返回码</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5897"></a><a id="CAXML5898"></a><a id="CAXML5896"></a><div class="props_rev_3"><a id="GUID-FB3220A7-8CCB-4B33-9AAF-B05A0F2FAD3A" name="GUID-FB3220A7-8CCB-4B33-9AAF-B05A0F2FAD3A"></a><h3 id="CAXML-GUID-FB3220A7-8CCB-4B33-9AAF-B05A0F2FAD3A" class="sect3">XmlDomRangeSetEndBefore（）</h3>
               <div>
                  <div class="section">
                     <p>设置节点之前的范围结束点。如果它具有除当前范围之外的根容器，则范围将折叠到新位置。如果before节点将结束设置为开始之前的位置，则范围将折叠到新位置。根据定义此类型的描述返回xmlerr值。假设范围的起点是有效的起点。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-FB3220A7-8CCB-4B33-9AAF-B05A0F2FAD3A__GUID-0A0C3BD1-6B7E-44BE-AD4C-BE150C3646E2">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlerr XmlDomRangeSetEndBefore（xmlctx * xctx，xmlrange * range，xmlnode * node）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-FB3220A7-8CCB-4B33-9AAF-B05A0F2FAD3A__GUID-E1C3E1C3-5FEA-45DF-B4A5-D65B82C50D0C">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e2515">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e2518">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e2521">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2526" headers="d82768e2515 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2526 d82768e2518 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2526 d82768e2521 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2536" headers="d82768e2515 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2536 d82768e2518 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2536 d82768e2521 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2546" headers="d82768e2515 "><pre class="oac_no_warn" dir="ltr">节点</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2546 d82768e2518 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2546 d82768e2521 ">
                                 <p>XML节点</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-FB3220A7-8CCB-4B33-9AAF-B05A0F2FAD3A__GUID-FED0DF81-A1BC-4A69-8529-CFCF21097D78">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlerr)</code>数字返回码</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5900"></a><a id="CAXML5901"></a><a id="CAXML5899"></a><div class="props_rev_3"><a id="GUID-C16961E4-6348-439C-8F89-B2FD34E07ED0" name="GUID-C16961E4-6348-439C-8F89-B2FD34E07ED0"></a><h3 id="CAXML-GUID-C16961E4-6348-439C-8F89-B2FD34E07ED0" class="sect3">XmlDomRangeSetStart（）</h3>
               <div>
                  <div class="section">
                     <p>设置范围起始点。如果它具有除当前范围之外的根容器，则范围将折叠到新位置。如果将开始设置为结束后的位置，则范围将折叠到该位置。根据定义此类型的描述返回xmlerr值。假设范围的终点是有效的终点。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-C16961E4-6348-439C-8F89-B2FD34E07ED0__GUID-FDF3647A-B0AC-45AF-AE09-E11F4D8176A5">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlerr XmlDomRangeSetStart（xmlctx * xctx，xmlrange * range，xmlnode * node，ub4 offset）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-C16961E4-6348-439C-8F89-B2FD34E07ED0__GUID-0F223A37-3F0B-454F-9C98-69DDA17CBE85">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e2624">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e2627">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e2630">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2635" headers="d82768e2624 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2635 d82768e2627 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2635 d82768e2630 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2645" headers="d82768e2624 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2645 d82768e2627 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2645 d82768e2630 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2655" headers="d82768e2624 "><pre class="oac_no_warn" dir="ltr">节点</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2655 d82768e2627 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2655 d82768e2630 ">
                                 <p>XML节点</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2665" headers="d82768e2624 "><pre class="oac_no_warn" dir="ltr">抵消</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2665 d82768e2627 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2665 d82768e2630 ">
                                 <p>起始偏移</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-C16961E4-6348-439C-8F89-B2FD34E07ED0__GUID-2DE318F8-0B08-4A2B-B1DF-460861A62D75">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlerr)</code>数字返回码</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5903"></a><a id="CAXML5904"></a><a id="CAXML5902"></a><div class="props_rev_3"><a id="GUID-CABB2A67-B6AB-4E34-830F-8C7659554B55" name="GUID-CABB2A67-B6AB-4E34-830F-8C7659554B55"></a><h3 id="CAXML-GUID-CABB2A67-B6AB-4E34-830F-8C7659554B55" class="sect3">XmlDomRangeSetStartAfter（）</h3>
               <div>
                  <div class="section">
                     <p>设置节点后的范围起始点。如果它具有除当前根容器之外的根容器，则该范围将折叠到新位置。如果前一个节点在结束后设置了开始，则该范围将折叠到新位置。假设范围的终点是有效的终点。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-CABB2A67-B6AB-4E34-830F-8C7659554B55__GUID-B1E7D193-2353-4143-96FB-BFC5D68C21CF">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlerr XmlDomRangeSetStartAfter（xmlctx * xctx，xmlrange * range，xmlnode * node）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-CABB2A67-B6AB-4E34-830F-8C7659554B55__GUID-DA61299A-1E7C-44AE-8AFE-C5CCBCC526EC">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e2742">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e2745">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e2748">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2753" headers="d82768e2742 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2753 d82768e2745 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2753 d82768e2748 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2763" headers="d82768e2742 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2763 d82768e2745 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2763 d82768e2748 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2773" headers="d82768e2742 "><pre class="oac_no_warn" dir="ltr">节点</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2773 d82768e2745 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2773 d82768e2748 ">
                                 <p>XML节点</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-CABB2A67-B6AB-4E34-830F-8C7659554B55__GUID-B4D1242B-7242-42C6-AB57-27A7A8A86776">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlerr)</code>数字返回码</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="CAXML5906"></a><a id="CAXML5907"></a><a id="CAXML5905"></a><div class="props_rev_3"><a id="GUID-E1CFF2BE-EE88-482C-92D0-A9CA67EF9ED7" name="GUID-E1CFF2BE-EE88-482C-92D0-A9CA67EF9ED7"></a><h3 id="CAXML-GUID-E1CFF2BE-EE88-482C-92D0-A9CA67EF9ED7" class="sect3">XmlDomRangeSetStartBefore（）</h3>
               <div>
                  <div class="section">
                     <p>设置节点之前的范围起始点。如果它具有非当前容器的根容器，则范围将折叠到偏移量为<code class="codeph">0</code>的新位置。如果前一个节点在结束后设置了开始，则该范围将折叠到新位置。假设范围的终点是有效的终点。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-E1CFF2BE-EE88-482C-92D0-A9CA67EF9ED7__GUID-257B0C21-D233-4A39-A093-23FF6DE58197">句法</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section"><pre class="oac_no_warn" dir="ltr">xmlerr XmlDomRangeSetStartBefore（xmlctx * xctx，xmlrange * range，xmlnode * node）;</pre></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-E1CFF2BE-EE88-482C-92D0-A9CA67EF9ED7__GUID-38B83CF7-A81E-48F7-8BBC-0FEFA037FDDB">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Parameter Table; column 1 has parameters, column 2 has the binding (IN, OUT, or IN/OUT), and column 2 has the descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="19%" id="d82768e2853">参数</th>
                              <th align="left" valign="bottom" width="12%" id="d82768e2856">进出</th>
                              <th align="left" valign="bottom" width="69%" id="d82768e2859">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2864" headers="d82768e2853 "><pre class="oac_no_warn" dir="ltr">xctx</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2864 d82768e2856 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2864 d82768e2859 ">
                                 <p>XML上下文</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2874" headers="d82768e2853 "><pre class="oac_no_warn" dir="ltr">范围</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2874 d82768e2856 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2874 d82768e2859 ">
                                 <p>范围对象</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="19%" id="d82768e2884" headers="d82768e2853 "><pre class="oac_no_warn" dir="ltr">节点</pre></td>
                              <td align="left" valign="top" width="12%" headers="d82768e2884 d82768e2856 "><pre class="oac_no_warn" dir="ltr">在</pre></td>
                              <td align="left" valign="top" width="69%" headers="d82768e2884 d82768e2859 ">
                                 <p>XML节点</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-E1CFF2BE-EE88-482C-92D0-A9CA67EF9ED7__GUID-6D71F33E-8B0C-455D-87E5-00BA9434BFEF">返回</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">(xmlerr)</code>数字返回码</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="13099.monitoring-database-operations.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This chapter describes how to monitor SQL and PL/SQL."></meta>
      <meta name="description" content="This chapter describes how to monitor SQL and PL/SQL."></meta>
      <title>监控数据库操作</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="SQL Tuning Guide"></meta>
      <meta property="og:description" content="This chapter describes how to monitor SQL and PL/SQL."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="SQL Tuning Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="sql-tuning-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-31T14:57:08-08:00"></meta>
      <meta name="dcterms.title" content="SQL Tuning Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2013, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96095-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="monitoring-and-tracing-sql.html" title="Previous" type="text/html"></link>
      <link rel="next" href="performing-application-tracing.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TGSQL"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="monitoring-and-tracing-sql.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="performing-application-tracing.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL调优指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="monitoring-and-tracing-sql.html" property="item" typeof="WebPage"><span property="name">监视和跟踪SQL</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">监控数据库操作</li>
            </ol>
            <a id="GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF" name="GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF"></a>
            
            <h2 id="TGSQL-GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF" class="sect2"><span class="enumeration_chapter">21</span>监控数据库操作</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何监视SQL和PL / SQL。</p>
               <p>本章包含以下主题：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862">关于监控数据库操作</a><br>当<code class="codeph">STATISTICS_LEVEL</code>初始化参数设置为<code class="codeph">TYPICAL</code> （默认值）或<code class="codeph">ALL</code>时，默认情况下启用SQL监视功能。</li>
                  <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720">启用和禁用数据库操作监视</a><br>使用初始化参数启用或禁用监视。
                  </li>
                  <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444">定义复合数据库操作</a><br>定义数据库操作涉及提供名称并指定其开始和结束时间。
                  </li>
                  <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-4048D00E-2635-42C8-A37D-71EFAC619062">生成和访问SQL监视器报告</a><br>默认情况下，AWR会自动以XML格式捕获SQL监视报告。
                  </li>
                  <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-75DE088E-4CFA-47D9-8078-F3BE97A255F7">监控数据库操作：方案</a><br>在这些方案中，您将报告简单和复合数据库操作。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="monitoring-and-tracing-sql.html#GUID-CA494EFF-53D7-4345-9576-8FED65F35AAE" title="使用DBMS_MONITOR跟踪数据库操作，使用SQL Test Case Builder打包与性能问题相关的信息，使用SQL Trace生成问题SQL语句的诊断数据。">监视和跟踪SQL</a></p>
                  </div>
               </div>
            </div>
            <a id="TGSQL789"></a><a id="TGSQL790"></a><div class="props_rev_3"><a id="GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862" name="GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862"></a><h3 id="TGSQL-GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862" class="sect3"><span class="enumeration_section">21.1</span>关于监视数据库操作</h3>
               <div>
                  <p>当<code class="codeph">STATISTICS_LEVEL</code>初始化参数设置为<code class="codeph">TYPICAL</code> （默认值）或<code class="codeph">ALL</code>时，默认情况下启用SQL监视功能。</p>
                  <p>本节包含以下主题：</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-573B83E0-15D4-4132-9ABE-91FB5D398B9C">关于数据库操作</a><br>数据库操作是一组数据库任务。典型任务可能是批处理作业或提取，转换和加载（ETL）处理作业。
                     </li>
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-7E2A0A25-6EF1-4180-B16E-65B47039CEC7">监视数据库操作的目的</a><br>对于简单操作，实时SQL监视有助于确定语句花费时间的位置。
                     </li>
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807">数据库监控的工作原理</a><br>实时SQL监控是一种内置的数据库基础结构，可帮助您识别长时间运行的并行SQL语句的性能问题。
                     </li>
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690">用于数据库操作监视的用户界面</a><br>实时SQL监控是Oracle数据库调优包的一项功能。当<code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>初始化参数设置为<code class="codeph">DIAGNOSTIC+TUNING</code> （默认值）时，将启用数据库操作。
                     </li>
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-A11CCA38-7DD8-4B08-9311-29CC7ED92EE6">数据库操作监控中的基本任务</a><br>本节介绍数据库操作监视的基本任务。
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862__GUID-6DE945D9-2E81-4945-B526-D400CDB87B57">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../cncpt/process-architecture.html#CNCPT89228" target="_blank"><span><cite>Oracle数据库概念，</cite></span></a>用于简要概述数据库操作</p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF" title="本章介绍如何监视SQL和PL / SQL。">监视数据库操作</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-573B83E0-15D4-4132-9ABE-91FB5D398B9C" name="GUID-573B83E0-15D4-4132-9ABE-91FB5D398B9C"></a><h4 id="TGSQL-GUID-573B83E0-15D4-4132-9ABE-91FB5D398B9C" class="sect4"><span class="enumeration_section">21.1.1</span>关于数据库操作</h4>
                  <div>
                     <p>数据库操作是一组数据库任务。典型任务可能是批处理作业或提取，转换和加载（ETL）处理作业。</p>
                     <p>数据库操作要么简单，要么是复合操</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-573B83E0-15D4-4132-9ABE-91FB5D398B9C__GUID-4F5BE2BC-B1E4-4B17-8482-830BF4B1E7DB">简单数据库操作</p>
                        <p><strong class="term">简单的数据库操作</strong>是单个SQL语句或PL / SQL子程序。启用SQL监视器功能时，如果满足以下任一条件，数据库将自动监视简单的数据库操作：</p>
                        <ul id="GUID-573B83E0-15D4-4132-9ABE-91FB5D398B9C__UL_J1J_GM5_DGB" style="list-style-type:disc">
                           <li>
                              <p>SQL语句或PL / SQL子程序在单次执行中消耗了至少5秒的CPU或I / O时间。</p>
                           </li>
                           <li>
                              <p>SQL语句并行执行。</p>
                           </li>
                           <li>
                              <p>SQL语句指定<code class="codeph">/*+ MONITOR */</code>提示。
                              </p>
                           </li>
                           <li>
                              <div class="p">事件<code class="codeph">sql_monitor</code>指定要监视的语句的SQL ID列表。例如，以下语句强制实例级监视SQL ID <code class="codeph">5hc07qvt8v737</code>和<code class="codeph">9ht3ba3arrzt3</code> ：<pre class="pre codeblock"><code>ALTER SYSTEM SET EVENTS的sql_monitor [sql：5hc07qvt8v737 | sql：9ht3ba3arrzt3] force = true'</code></pre></div>
                           </li>
                        </ul>
                        <p>在SQL执行计划的每个步骤中，数据库按性能指标跟踪统计信息，例如已用时间，CPU时间，读写次数和I / O等待时间。这些度量标准位于称为SQL监视器活动报告的图形和交互式报告中。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-573B83E0-15D4-4132-9ABE-91FB5D398B9C__GUID-7025C4C3-5775-4263-AE41-46C74E8E6EB9">复合数据库操作</p>
                        <p><strong class="term">复合数据库操作</strong>由用户定义。它包括在数据库会话中执行的所有SQL语句或PL / SQL子程序，使用过程<code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code>和<code class="codeph">DBMS_SQL_MONITOR.END_OPERATION</code>定义起点和终点。复合数据库操作由其名称和执行ID唯一标识，并且可以多次执行。
                        </p>
                        <div class="infoboxnote" id="GUID-573B83E0-15D4-4132-9ABE-91FB5D398B9C__GUID-723837FE-1EC6-47E3-B3E5-0694A874EBF7">
                           <p class="notep1">注意：</p>
                           <p>数据库会话一次最多可以参与一个数据库操作。</p>
                        </div>
                        <p>当满足以下任一条件时，Oracle数据库会自动监视复合操作：</p>
                        <ul id="GUID-573B83E0-15D4-4132-9ABE-91FB5D398B9C__UL_K1J_GM5_DGB" style="list-style-type:disc">
                           <li>
                              <p>该操作消耗了至少5秒的CPU或I / O时间。</p>
                           </li>
                           <li>
                              <p>通过在<code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code> <code class="codeph">FORCED_TRACKING</code>设置为<code class="codeph">Y</code>来强制跟踪操作。</p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-573B83E0-15D4-4132-9ABE-91FB5D398B9C__GUID-32245893-1F1E-4445-A0F6-692482056340">
                           <p class="notep1">注意：</p>
                           <p><span class="q">“ <a href="https://sqlmaria.com/2017/08/01/getting-the-most-out-of-oracle-sql-monitor/" target="_blank">充分利用SQL监视器</a> ”</span>以<span class="q"><a href="https://sqlmaria.com/2017/08/01/getting-the-most-out-of-oracle-sql-monitor/" target="_blank">获取SQL监视器</a></span>的简要概述</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862" title="当STATISTICS_LEVEL初始化参数设置为TYPICAL（默认值）或ALL时，默认情况下启用SQL监视功能。">关于监视数据库操作</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL94583"></a><div class="props_rev_3"><a id="GUID-7E2A0A25-6EF1-4180-B16E-65B47039CEC7" name="GUID-7E2A0A25-6EF1-4180-B16E-65B47039CEC7"></a><h4 id="TGSQL-GUID-7E2A0A25-6EF1-4180-B16E-65B47039CEC7" class="sect4"><span class="enumeration_section">21.1.2</span>监视数据库操作的目的</h4>
                  <div>
                     <p>对于简单操作，实时SQL监视有助于确定语句花费时间的位置。</p>
                     <p>您还可以查看最近完成的语句的时间和资源使用情况。通过这种方式，您可以更好地确定特定操作为何昂贵。用于实时SQL监视的用例包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>经常执行的SQL语句执行速度比正常情况慢。您必须确定此问题的根本原因。</p>
                        </li>
                        <li>
                           <p>数据库会话正在经历性能下降。</p>
                        </li>
                        <li>
                           <p>并行SQL语句需要很长时间。您想确定服务器进程如何划分工作。</p>
                        </li>
                     </ul>
                     <p>在OLTP和数据仓库环境中，作业通常在逻辑上对相关的SQL语句进行分组。该作业可以跨多个并发会话。数据库操作通过使您能够将一组语句或过程视为已命名，唯一标识和可重新执行的单元来扩展实时SQL监视。用于监视操作的用例包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>包含许多SQL语句的定期批处理作业必须在特定的小时数内完成，但需要的时间比预期的要长。</p>
                        </li>
                        <li>
                           <p>数据库升级后，重要批处理作业的执行时间增加。要解决此问题，必须在升级之前和之后从批处理作业中收集足够的相关统计数据，比较两组数据，然后确定更改。</p>
                        </li>
                        <li>
                           <p>打包<a href="glossary.html#GUID-52FB0AE5-7346-44E5-BE92-3C09385B1DDC"><span class="xrefglossterm">SQL调优集（STS）的</span></a>时间远远超过预期。要诊断问题，您需要知道一段时间内正在执行的操作。由于此问题无法轻松复制，因此您需要在运行过程中监控该过程。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="monitoring-database-operations.html#GUID-4048D00E-2635-42C8-A37D-71EFAC619062" title="默认情况下，AWR会自动以XML格式捕获SQL监视报告。">生成和访问SQL监视器报告</a></li>
                           <li><a href="../admin/managing-resources-with-oracle-database-resource-manager.html#ADMIN-GUID-2BEF5482-CF97-4A85-BD90-9195E41E74EF" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-7E2A0A25-6EF1-4180-B16E-65B47039CEC7__GUID-B2196ADA-F11F-44D2-AD1F-E747AE7C69C1">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://www.youtube.com/watch?v=pEC5GdtzpRs" target="_blank">为什么使用SQL Monitor</a>来演示SQL Monitor的一些用途的视频</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862" title="当STATISTICS_LEVEL初始化参数设置为TYPICAL（默认值）或ALL时，默认情况下启用SQL监视功能。">关于监视数据库操作</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL94588"></a><a id="TGSQL94587"></a><div class="props_rev_3"><a id="GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807" name="GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807"></a><h4 id="TGSQL-GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807" class="sect4"><span class="enumeration_section">21.1.3</span>数据库监控的工作<span class="enumeration_section">原理</span></h4>
                  <div>
                     <p>实时SQL监控是一种内置的数据库基础结构，可帮助您识别长时间运行的并行SQL语句的性能问题。</p>
                     <p>下图概述了实时SQL监控的体系结构。</p>
                     <div class="figure" id="GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807__CHDIEDBG">
                        <p class="titleinfigure">图21-1数据库操作监视的体系结构</p><img src="img/tgsql_vm_033.png" alt="下面是图21-1的描述" title="下面是图21-1的描述" longdesc="img_text/tgsql_vm_033.html"><br><a href="img_text/tgsql_vm_033.html">“图21-1数据库操作监视的体系结构”的描述</a></div>
                     <!-- class="figure" -->
                     <p>如上图所示， <code class="codeph">DBMS_SQL_MONITOR</code>包定义了数据库操作。启动监视后，数据库将存储有关AWR中数据库操作的元数据以及AWR和ASH中的数据。当每个受监视的语句执行时，数据库会近乎实时地刷新监视统计信息，通常每秒一次。数据库将操作数据（语句和元数据）存储在SGA中。操作完成后，数据库会将SQL Monitor报告写入磁盘，可以使用<code class="codeph">DBA_HIST_REPORTS</code>视图查询该报告。
                     </p>
                     <p>每个受监视的数据库操作在<code class="codeph">V$SQL_MONITOR</code>视图中都有一个条目。此条目跟踪为执行收集的关键性能指标，包括已用时间，CPU时间，读写次数，I / O等待时间以及各种其他等待时间。<code class="codeph">V$SQL_PLAN_MONITOR</code>视图包括监视正在监视的SQL语句的执行计划中的每个操作的统计信息。您可以使用<code class="codeph">DBMS_SQL_MONITOR.REPORT_SQL_MONITOR</code> ，Oracle企业管理器云控制（云控制）或EM Express访问报告。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807__GUID-9866759A-4792-41B7-ACAE-61886EEAA495">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="monitoring-database-operations.html#GUID-4048D00E-2635-42C8-A37D-71EFAC619062" title="默认情况下，AWR会自动以XML格式捕获SQL监视报告。">生成和访问SQL监视器报告</a> ”</span></p>
                           </li>
                           <li>
                              <p><span><cite>Oracle数据库参考</cite></span> ，了解<a href="../refrn/V-SQL_MONITOR.html#GUID-79E97A84-9C27-4A5E-AC0D-C12CB3E748E6" target="_blank"><code class="codeph">V$SQL_MONITOR</code></a> ， <a href="../refrn/V-SQL_PLAN_MONITOR.html#GUID-85354ECB-7E2E-4D4B-AE78-243A4BB6E523" target="_blank"><code class="codeph">V$SQL_PLAN_MONITOR</code></a>和<a href="../refrn/CONTROL_MANAGEMENT_PACK_ACCESS.html#GUID-A5CA11BA-AE1F-4A2E-9C59-A98BA1F4E5C2" target="_blank"><code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code></a></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_SQL_MONITOR.html#ARPLS-GUID-13874A73-369E-42CD-9C43-A12F1B3BDEC6" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考，</cite></span></a>以了解<code class="codeph">DBMS_SQL_MONITOR</code>包</p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862" title="当STATISTICS_LEVEL初始化参数设置为TYPICAL（默认值）或ALL时，默认情况下启用SQL监视功能。">关于监视数据库操作</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL94592"></a><div class="props_rev_3"><a id="GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690" name="GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690"></a><h4 id="TGSQL-GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690" class="sect4"><span class="enumeration_section">21.1.4</span>数据库操作监视的用户界面</h4>
                  <div>
                     <p>实时SQL监控是Oracle数据库调优包的一项功能。当<code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>初始化参数设置为<code class="codeph">DIAGNOSTIC+TUNING</code> （默认值）时，将启用数据库操作。
                     </p>
                     <div class="section">
                        <p>本节包含以下主题：</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7">云控制中受监控的SQL执行页面</a><br>Cloud Control中的“受监视的SQL执行”页面（也称为SQL Monitor）显示SQL执行的详细信息。SQL Monitor是报告数据库操作的推荐接口。
                        </li>
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218">DBMS_SQL_MONITOR包</a><br><code class="codeph">DBMS_SQL_MONITOR</code>包定义复合数据库操作的开始和结束，并生成数据库操作的报告。
                        </li>
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-EC276737-148A-4ED7-AA7D-F125AD1B8859">复合数据库操作的属性</a><br><code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code>函数定义数据库操作。
                        </li>
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-19E0F73C-A959-41E4-A168-91E436DEE1F1">MONITOR和NO_MONITOR提示</a><br>您可以使用MONITOR和NO_MONITOR提示来控制各个语句的跟踪。
                        </li>
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-E471C229-5713-40E2-A95C-593EACB56AE7">监视和报告数据库操作的视图</a><br>您可以使用<code class="codeph">V$</code>和数据字典视图获取数据库操作的统计信息。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862" title="当STATISTICS_LEVEL初始化参数设置为TYPICAL（默认值）或ALL时，默认情况下启用SQL监视功能。">关于监视数据库操作</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="TGSQL94593"></a><div class="props_rev_3"><a id="GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7" name="GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7"></a><h5 id="TGSQL-GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7" class="sect5"><span class="enumeration_section">21.1.4.1</span> Cloud Control中的受监控SQL执行页面</h5>
                     <div>
                        <p>Cloud Control中的“受监视的SQL执行”页面（也称为SQL Monitor）显示SQL执行的详细信息。SQL Monitor是报告数据库操作的推荐接口。</p>
                        <div class="section">
                           <p>执行计划的每个步骤的统计信息由关键性能指标跟踪，包括已用时间，CPU时间，读写次数，I / O等待时间以及各种其他等待时间。这些指标使DBA能够深入分析SQL执行，并为受监控的SQL语句决定最合适的调优策略。</p>
                           <p>SQL Monitor Active Reports提供基于Flash的交互式报告，使您可以将数据保存在HTML文件中。您可以保存此文件并离线查看。</p>
                           <p>本节包含以下主题：</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530">访问受监视的SQL执行页面</a><br>“受监视的SQL执行”显示诸如SQL ID，数据库时间和I / O请求之类的信息。
                           </li>
                        </ul>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690" title="实时SQL监控是Oracle数据库调优包的一项功能。当CONTROL_MANAGEMENT_PACK_ACCESS初始化参数设置为DIAGNOSTIC + TUNING（默认值）时，将启用数据库操作。">数据库操作监视的用户界面</a></p>
                           </div>
                        </div>
                     </div>
                     <a id="TGSQL94594"></a><div class="props_rev_3"><a id="GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530" name="GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530"></a><h6 id="TGSQL-GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530" class="sect6"><span class="enumeration_section">21.1.4.1.1</span>访问受监控的SQL执行页面</h6>
                        <div>
                           <p>“受监视的SQL执行”显示诸如SQL ID，数据库时间和I / O请求之类的信息。</p>
                           <div class="section">
                              <p class="subhead3" id="GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530__GUID-D4218241-3368-4D61-A433-9FD7E7ACB1F2">要访问“受监视的SQL执行”页面：</p>
                              <ol>
                                 <li>
                                    <p>使用适当的凭据登录Cloud Control。</p>
                                 </li>
                                 <li>
                                    <p>在“ <span class="bold">目标”</span>菜单下，选择“ <span class="bold">数据库”</span> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>在数据库目标列表中，选择要管理的Oracle数据库实例的目标。</p>
                                 </li>
                                 <li>
                                    <p>如果系统提示您输入数据库凭据，请输入您要执行的任务所需的最低凭据。</p>
                                 </li>
                                 <li>
                                    <p>从“ <span class="bold">性能”</span>菜单中，选择“ <span class="bold">SQL监视”</span> 。
                                    </p>
                                    <p>将显示“监视的SQL执行”页面。</p>
                                    <div class="figure" id="GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530__GUID-055D4E03-F49D-4192-8FFF-37E44818608E">
                                       <p class="titleinfigure">图21-2受监控的SQL执行</p><img src="img/mon_sql_exec.jpg" alt="下面是图21-2的描述" title="下面是图21-2的描述" longdesc="img_text/mon_sql_exec.html"><br><a href="img_text/mon_sql_exec.html">“图21-2受监控的SQL执行”的说明</a></div>
                                    <!-- class="figure" -->
                                 </li>
                              </ol>
                           </div>
                           <!-- class="section" -->
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7" title="Cloud Control中的“受监视的SQL执行”页面（也称为SQL Monitor）显示SQL执行的详细信息。SQL Monitor是报告数据库操作的推荐接口。">Cloud Control中的受监控SQL执行页面</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div>
                  </div><a id="TGSQL94596"></a><a id="TGSQL94595"></a><div class="props_rev_3"><a id="GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218" name="GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218"></a><h5 id="TGSQL-GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218" class="sect5"><span class="enumeration_section">21.1.4.2</span> DBMS_SQL_MONITOR包</h5>
                     <div>
                        <p><code class="codeph">DBMS_SQL_MONITOR</code>包定义复合数据库操作的开始和结束，并生成数据库操作的报告。
                        </p>
                        <div class="tblformalwide" id="GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218__GUID-B2677E02-96F7-4C9E-BFDB-7B2AE810BBA6">
                           <p class="titleintable">表21-1 DBMS_SQL_MONITOR</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="DBMS_SQL_MONITOR" width="100%" border="1" summary="This 2 column table describes DBMS_SQL_MONITOR. Column 1 is the program unit. Column 2 describes that unit. " frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d105713e1520">子程序</th>
                                    <th align="left" valign="bottom" id="d105713e1523">描述</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d105713e1528" headers="d105713e1520 ">
                                       <p><code class="codeph">BEGIN_OPERATION</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d105713e1528 d105713e1523 ">
                                       <p><span>此函数在当前会话中启动数据库操作。</span></p>
                                       <p>此函数将会话与数据库操作相关联。从<span>Oracle Database 12c</span>第2版（12.2）开始，您可以使用<code class="codeph">session_id</code>和<code class="codeph">session_num</code>来指示开始监视的会话。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d105713e1548" headers="d105713e1520 ">
                                       <p><code class="codeph">END_OPERATION</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d105713e1548 d105713e1523 ">
                                       <p><span>此函数结束当前会话中的数据库操作。如果指定的数据库操作不存在，则此函数无效。</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d105713e1557" headers="d105713e1520 ">
                                       <p><code class="codeph">REPORT_SQL_MONITOR</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d105713e1557 d105713e1523 ">
                                       <p><span>此函数构建详细报告，其中包含SQL语句，PL / SQL块或数据库操作的监视信息。</span></p>
                                       <p>对于每个操作，它提供关键信息和相关的全局统计信息。使用此函数可获取数据库操作的详细监视信息。</p>
                                       <p>此报告的目标数据库操作可以是：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>Oracle数据库监控的最后一个数据库操作（默认情况下，无参数）。</p>
                                          </li>
                                          <li>
                                             <p>最后一个数据库操作在指定的会话中执行并由Oracle数据库监视。会话由其会话ID和可选的序列号（ <code class="codeph">-1</code>是当前会话）标识。
                                             </p>
                                          </li>
                                          <li>
                                             <p>最后一次执行由其<code class="codeph">sql_id</code>标识的特定数据库操作。
                                             </p>
                                          </li>
                                          <li>
                                             <p>由<code class="codeph">sql_id</code> ， <code class="codeph">sql_exec_start</code>和<code class="codeph">sql_exec_id</code>组合标识的数据库操作的特定执行。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">dbop_name</code>标识的特定数据库操作的最后一次执行。
                                             </p>
                                          </li>
                                          <li>
                                             <p>由<code class="codeph">dbop_name</code> ， <code class="codeph">dbop_exec_id</code>组合标识的数据库操作的特定执行。
                                             </p>
                                          </li>
                                       </ul>
                                       <p>使用<code class="codeph">type</code>参数指定输出类型： <code class="codeph">TEXT</code> （默认值）， <code class="codeph">HTML</code> ， <code class="codeph">ACTIVE</code>或<code class="codeph">XML</code> 。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d105713e1630" headers="d105713e1520 ">
                                       <p><code class="codeph">REPORT_SQL_MONITOR_XML</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d105713e1630 d105713e1523 ">
                                       <p><span>此函数与<code class="codeph">REPORT_SQL_MONITOR</code>函数相同，只是返回类型是<code class="codeph">XMLType</code> 。</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d105713e1645" headers="d105713e1520 ">
                                       <p><code class="codeph">REPORT_SQL_MONITOR_LIST</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d105713e1645 d105713e1523 ">
                                       <p><span>此函数为Oracle数据库监视的所有或部分数据库操作构建报告。</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d105713e1654" headers="d105713e1520 ">
                                       <p><code class="codeph">REPORT_SQL_MONITOR_LIST_XML</code></p>
                                    </td>
                                    <td align="left" valign="top" headers="d105713e1654 d105713e1523 ">
                                       <p><span>此函数与<code class="codeph">REPORT_SQL_MONITOR_LIST</code>函数相同，只是它返回<code class="codeph">XMLType</code> 。</span></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218__GUID-F4C2D356-6227-407F-96AA-A552D6AC39BB">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS74779" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考，</cite></span></a>以了解<code class="codeph">DBMS_SQL_MONITOR</code>包</p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690" title="实时SQL监控是Oracle数据库调优包的一项功能。当CONTROL_MANAGEMENT_PACK_ACCESS初始化参数设置为DIAGNOSTIC + TUNING（默认值）时，将启用数据库操作。">数据库操作监视的用户界面</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL94590"></a><div class="props_rev_3"><a id="GUID-EC276737-148A-4ED7-AA7D-F125AD1B8859" name="GUID-EC276737-148A-4ED7-AA7D-F125AD1B8859"></a><h5 id="TGSQL-GUID-EC276737-148A-4ED7-AA7D-F125AD1B8859" class="sect5"><span class="enumeration_section">21.1.4.3</span>复合数据库操作的属性</h5>
                     <div>
                        <p><code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code>函数定义数据库操作。
                        </p>
                        <p>通过以下信息唯一标识复合数据库操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>数据库操作名称</p>
                              <p>这是用户创建的名称，例如<code class="codeph">daily_sales_report</code> 。即使作业由不同的会话或不同的数据库同时执行，作业的操作名称也是相同的。数据库操作名称不驻留在不同的名称空间中。
                              </p>
                           </li>
                           <li>
                              <p>数据库操作执行ID</p>
                              <p>同一数据库操作的两次或多次出现可以同时运行，名称相同但执行ID不同。此数字ID唯一标识<span class="italic">同一</span>数据库操作的不同执行。
                              </p>
                              <p>开始数据库操作时，数据库会自动创建执行ID。您还可以指定用户创建的执行ID。</p>
                           </li>
                        </ul>
                        <p>（可选）您可以指定启动数据库操作的会话ID和会话序列号。因此，一个数据库会话可以启动在不同数据库会话中定义的数据库操作。</p>
                        <p>数据库使用以下三元组值来标识<code class="codeph">V$SQL_MONITOR</code>视图中监视的每个SQL和PL / SQL语句，无论该语句是否包含在数据库操作中：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>用于标识SQL语句的SQL标识符（ <code class="codeph">SQL_ID</code> ）</p>
                           </li>
                           <li>
                              <p>开始执行时间戳（ <code class="codeph">SQL_EXEC_START</code> ）</p>
                           </li>
                           <li>
                              <p>内部生成的标识符，用于确保此主键真正唯一（ <code class="codeph">SQL_EXEC_ID</code> ）</p>
                           </li>
                        </ul>
                        <p>您可以使用零个或多个其他属性来描述和标识复合数据库操作的特征。每个属性都有名称和值。例如，对于数据库操作<code class="codeph">daily_sales_report</code> ，您可以定义属性<code class="codeph">db_name</code>并为其指定值<code class="codeph">prod</code> 。
                        </p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../refrn/V-SQL_MONITOR.html#REFRN-GUID-79E97A84-9C27-4A5E-AC0D-C12CB3E748E6" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></li>
                              <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=ARPLS-GUID-25BE0E79-3A19-4303-9F66-2CFDB87C7F82" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690" title="实时SQL监控是Oracle数据库调优包的一项功能。当CONTROL_MANAGEMENT_PACK_ACCESS初始化参数设置为DIAGNOSTIC + TUNING（默认值）时，将启用数据库操作。">数据库操作监视的用户界面</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-19E0F73C-A959-41E4-A168-91E436DEE1F1" name="GUID-19E0F73C-A959-41E4-A168-91E436DEE1F1"></a><h5 id="TGSQL-GUID-19E0F73C-A959-41E4-A168-91E436DEE1F1" class="sect5"><span class="enumeration_section">21.1.4.4</span> MONITOR和NO_MONITOR提示</h5>
                     <div>
                        <p>您可以使用MONITOR和NO_MONITOR提示来控制各个语句的跟踪。</p>
                        <div class="section">
                           <p>即使语句没有长时间运行， <code class="codeph">MONITOR</code>提示也会强制对查询进行实时SQL监视。仅当参数<code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>设置为<code class="codeph">DIAGNOSTIC+TUNING</code>时，此提示才有效。以下查询强制SQL Monitor启用跟踪：</p><pre class="pre codeblock"><code>SELECT / * + MONITOR * / prod_id，AVG（amount_sold），AVG（quantity_sold）FROM sales GROUP BY prod_id ORDER BY prod_id;</code></pre><p>即使查询长时间运行， <code class="codeph">NO_MONITOR</code>提示<code class="codeph">NO_MONITOR</code>禁用查询的实时SQL监视。以下查询强制SQL Monitor禁用跟踪：</p><pre class="pre codeblock"><code>SELECT / * + NO_MONITOR * / prod_id，AVG（amount_sold），AVG（quantity_sold）FROM sales GROUP BY prod_id ORDER BY prod_id;</code></pre><div class="infoboxnote" id="GUID-19E0F73C-A959-41E4-A168-91E436DEE1F1__GUID-ABF01735-9EAA-4307-8BDA-088A51F31655">
                              <p class="notep1">注意：</p>
                              <p><a href="../sqlrf/Comments.html#GUID-CD628749-C7E0-4EBB-A989-E9C10325EDF7" target="_blank"><span><cite>Oracle数据库SQL语言参考，</cite></span></a>以了解<code class="codeph">MONITOR</code>和<code class="codeph">NO_MONITOR</code>提示</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690" title="实时SQL监控是Oracle数据库调优包的一项功能。当CONTROL_MANAGEMENT_PACK_ACCESS初始化参数设置为DIAGNOSTIC + TUNING（默认值）时，将启用数据库操作。">数据库操作监视的用户界面</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TGSQL94598"></a><a id="TGSQL94597"></a><div class="props_rev_3"><a id="GUID-E471C229-5713-40E2-A95C-593EACB56AE7" name="GUID-E471C229-5713-40E2-A95C-593EACB56AE7"></a><h5 id="TGSQL-GUID-E471C229-5713-40E2-A95C-593EACB56AE7" class="sect5"><span class="enumeration_section">21.1.4.5</span>监视和报告数据库操作的视图</h5>
                     <div>
                        <p>您可以使用<code class="codeph">V$</code>和数据字典视图获取数据库操作的统计信息。
                        </p>
                        <div class="section">
                           <p>下表总结了这些视图。</p>
                           <div class="tblformal" id="GUID-E471C229-5713-40E2-A95C-593EACB56AE7__CHDFEHFI">
                              <p class="titleintable">表21-2数据库操作监视视图</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="数据库操作监视的视图" width="100%" border="1" summary="This table describes views that you can use to monitor database operations." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d105713e2178">视图</th>
                                       <th align="left" valign="bottom" id="d105713e2181">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d105713e2186" headers="d105713e2178 ">
                                          <p><a href="../refrn/DBA_HIST_REPORTS.html#REFRN23881" target="_blank"><code class="codeph">DBA_HIST_REPORTS</code></a></p>
                                       </td>
                                       <td align="left" valign="top" headers="d105713e2186 d105713e2181 ">
                                          <p>此视图显示有关在自动工作负载存储库（AWR）中捕获的XML报告的元数据。每个XML报告都包含有关组件某些活动的详细信息。例如，SQL Monitor报告包含有关特定数据库操作的详细报告。</p>
                                          <p>重要的专栏包括：</p>
                                          <ul style="list-style-type:disc">
                                             <li>
                                                <p><code class="codeph">REPORT_SUMMARY</code>列包含报告摘要。
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">COMPONENT_NAME</code>列接受值<code class="codeph">sqlmonitor</code> 。
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">REPORT_ID</code>列提供报告的ID，您可以在生成报告时在<code class="codeph">DBMS_AUTO_REPORT.REPORT_REPOSITORY_DETAIL</code>的<code class="codeph">RID</code>参数中指定该ID。
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">KEY1</code>列是语句的SQL ID。
                                                </p>
                                             </li>
                                             <li>
                                                <p><code class="codeph">KEY2</code>列是语句的SQL执行ID</p>
                                             </li>
                                          </ul>
                                          <p>AWR控制SQL Monitor报告的保留期。<code class="codeph">DBA_HIST_REPORTS</code>每个SQL监视器报告都与AWR <code class="codeph">SNAP_ID</code>相关联。请注意，导出或导入相应的AWR数据时，不会导出或导入SQL监视器报告。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d105713e2246" headers="d105713e2178 ">
                                          <p><a href="../refrn/DBA_HIST_REPORTS_DETAILS.html#REFRN23882" target="_blank"><code class="codeph">DBA_HIST_REPORTS_DETAILS</code></a></p>
                                       </td>
                                       <td align="left" valign="top" headers="d105713e2246 d105713e2181 ">
                                          <p>此视图显示有关AWR中捕获的每个报告的详细信息。每个报告的元数据显示在<code class="codeph">DBA_HIST_REPORTS</code>视图中，而实际报告在<code class="codeph">DBA_HIST_REPORTS_DETAILS</code>视图中可用。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d105713e2262" headers="d105713e2178 ">
                                          <p><a href="../refrn/V-SQL_MONITOR.html#GUID-79E97A84-9C27-4A5E-AC0D-C12CB3E748E6" target="_blank"><code class="codeph">V $ SQL_MONITOR</code></a></p>
                                       </td>
                                       <td align="left" valign="top" headers="d105713e2262 d105713e2181 ">
                                          <p>此视图包含有关简单和复合数据库操作的全局高级信息。</p>
                                          <p>对于简单的数据库操作，监视统计信息不会累积在多次执行中。在这种情况下， <code class="codeph">V$SQL_MONITOR</code>一个条目专用于单个执行SQL语句。如果数据库监视同一SQL语句的两次执行，则每次执行在<code class="codeph">V$SQL_MONITOR</code>都有一个单独的条目。</p>
                                          <p>对于简单的数据库操作， <code class="codeph">V$SQL_MONITOR</code>有一个用于并行执行协调器进程的条目和一个用于每个并行执行服务器进程的条目。每个条目在<code class="codeph">V$SQL_PLAN_MONITOR</code>都有对应的条目。由于为并行执行SQL语句分配的进程正在协作执行相同的操作，因此这些条目共享相同的执行键（ <code class="codeph">SQL_ID</code> ， <code class="codeph">SQL_EXEC_START</code>和<code class="codeph">SQL_EXEC_ID</code>的组合）。
                                          </p>
                                          <p>对于复合数据库操作，每一行都包含一个操作，该操作的统计信息是在SQL语句和PL / SQL子程序中累积的，这些子程序在操作的同一会话中运行。主键是<code class="codeph">DBOP_NAME</code>和<code class="codeph">DBOP_EXEC_ID</code>列的组合。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d105713e2305" headers="d105713e2178 ">
                                          <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tgsql&amp;id=GUID-F1C68683-4048-44FD-8B7A-F30FDCB751CA" target="_blank"><code class="codeph">V $ SQL_MONITOR_SESSTAT</code></a></p>
                                       </td>
                                       <td align="left" valign="top" headers="d105713e2305 d105713e2181 ">
                                          <p>此视图包含数据库操作中涉及的所有会话的统计信息。</p>
                                          <p>大多数统计数据是累积的。数据库以XML格式存储统计信息，而不是为每个统计信息使用每列。此视图主要用于报告生成器。Oracle建议您使用<code class="codeph">V$SESSTAT</code>而不是<code class="codeph">V$SQL_MONITOR_SESSTAT</code> 。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d105713e2323" headers="d105713e2178 ">
                                          <p><a href="../refrn/V-SQL_PLAN_MONITOR.html#GUID-85354ECB-7E2E-4D4B-AE78-243A4BB6E523" target="_blank"><code class="codeph">V $ SQL_PLAN_MONITOR</code></a></p>
                                       </td>
                                       <td align="left" valign="top" headers="d105713e2323 d105713e2181 ">
                                          <p>此视图包含受监视SQL语句的执行计划中每个步骤的监视统计信息。</p>
                                          <p>在SQL语句执行时，数据库每秒更新<code class="codeph">V$SQL_PLAN_MONITOR</code>统计信息。对于每个受监视的SQL语句， <code class="codeph">V$SQL_PLAN_MONITOR</code>存在多个条目。每个条目对应于语句执行计划中的一个步骤。
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>您可以将以前的<code class="codeph">V$</code>视图与以下视图一起使用，以获取有关受监视执行的其他信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">V $ ACTIVE_SESSION_HISTORY</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">V $ SESSION</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">V $ SESSION_LONGOPS</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">V $ SQL</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">V $ SQL_PLAN</code></p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-E471C229-5713-40E2-A95C-593EACB56AE7__GUID-496AF598-73E7-4D1A-A61C-F6358276E7D7">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../refrn/dynamic-performance-views.html#GUID-8C5690B0-DE10-4460-86DF-80111869CF4C" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>了解数据库操作监视的<code class="codeph">V$</code>视图</p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690" title="实时SQL监控是Oracle数据库调优包的一项功能。当CONTROL_MANAGEMENT_PACK_ACCESS初始化参数设置为DIAGNOSTIC + TUNING（默认值）时，将启用数据库操作。">数据库操作监视的用户界面</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="TGSQL94599"></a><div class="props_rev_3"><a id="GUID-A11CCA38-7DD8-4B08-9311-29CC7ED92EE6" name="GUID-A11CCA38-7DD8-4B08-9311-29CC7ED92EE6"></a><h4 id="TGSQL-GUID-A11CCA38-7DD8-4B08-9311-29CC7ED92EE6" class="sect4"><span class="enumeration_section">21.1.5</span>数据库操作监控中的基本任务</h4>
                  <div>
                     <p>本节介绍数据库操作监视的基本任务。</p>
                     <p>基本任务如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="monitoring-database-operations.html#GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720" title="使用初始化参数启用或禁用监视。">启用和禁用数据库操作监视</a> ”</span></p>
                           <p>此任务说明如何在系统和语句级别启用数据库操作的自动监视。</p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="monitoring-database-operations.html#GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444" title="定义数据库操作涉及提供名称并指定其开始和结束时间。">定义复合数据库操作</a> ”</span></p>
                           <p>本节介绍如何使用PL / SQL定义数据库操作的开始和结束。</p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="monitoring-database-operations.html#GUID-4048D00E-2635-42C8-A37D-71EFAC619062" title="默认情况下，AWR会自动以XML格式捕获SQL监视报告。">生成和访问SQL监视器报告</a> ”</span></p>
                           <p>本节介绍如何生成和解释有关数据库操作的报告。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862" title="当STATISTICS_LEVEL初始化参数设置为TYPICAL（默认值）或ALL时，默认情况下启用SQL监视功能。">关于监视数据库操作</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL94600"></a><div class="props_rev_3"><a id="GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720" name="GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720"></a><h3 id="TGSQL-GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720" class="sect3"><span class="enumeration_section">21.2</span>启用和禁用数据库操作监视</h3>
               <div>
                  <p>使用初始化参数启用或禁用监视。</p>
                  <p>本节包含以下主题：</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7">在系统级启用数据库操作监视</a><br>当<code class="codeph">STATISTICS_LEVEL</code>初始化参数设置为<code class="codeph">TYPICAL</code> （默认值）或<code class="codeph">ALL</code>时，默认情况下启用SQL监视功能。对所有长时间运行的查询自动启动SQL监视。
                     </li>
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A">在语句级别启用和禁用数据库操作的监视</a><br>当<code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>初始化参数设置为<code class="codeph">DIAGNOSTIC+TUNING</code> ，您可以使用提示来启用或禁用特定SQL语句的监视。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF" title="本章介绍如何监视SQL和PL / SQL。">监视数据库操作</a></p>
                     </div>
                  </div>
               </div>
               <a id="TGSQL94954"></a><a id="TGSQL94602"></a><a id="TGSQL94601"></a><div class="props_rev_3"><a id="GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7" name="GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7"></a><h4 id="TGSQL-GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7" class="sect4"><span class="enumeration_section">21.2.1</span>在系统级启用数据库操作监视</h4>
                  <div>
                     <p>当<code class="codeph">STATISTICS_LEVEL</code>初始化参数设置为<code class="codeph">TYPICAL</code> （默认值）或<code class="codeph">ALL</code>时，默认情况下启用SQL监视功能。对所有长时间运行的查询自动启动SQL监视。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7__GUID-B6373CCB-58A2-4CD5-9C70-4FFB95DD88E7">先决条件</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>由于SQL监视是Oracle Database Tuning Pack的一项功能，因此<code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>初始化参数必须设置为<code class="codeph">DIAGNOSTIC+TUNING</code> （默认值）。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7__GUID-21932EF1-CD10-4A39-B5E8-E09950506505">假设</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>本教程假设以下内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">STATISTICS_LEVEL</code>初始化参数设置为<code class="codeph">BASIC</code> 。</p>
                           </li>
                           <li>
                              <p>您希望启用数据库操作的自动监视。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7__GUID-26D3AFA7-1D1A-4E3C-A2A1-B27983FF039C">要启用对数据库操作的监视：</p>
                        <ol>
                           <li>
                              <p>使用适当的权限将SQL * Plus连接到数据库，然后查询当前的数据库操作设置。</p>
                              <p>例如，运行以下SQL * Plus命令：</p><pre class="pre codeblock"><code>SQL&gt; SHOW PARAMETER statistics_level名称类型值----------------------------------- ------- ---- ----- statistics_level字符串BASIC</code></pre></li>
                           <li>
                              <p>将统计级别设置为<code class="codeph">TYPICAL</code> 。</p>
                              <p>例如，运行以下SQL语句：</p><pre class="pre codeblock"><code>SQL&gt; ALTER SYSTEM SET STATISTICS_LEVEL ='TYPICAL';</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7__GUID-7C076BE7-16E9-431B-932E-5E146D8896C7">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../refrn/OPTIMIZER_FEATURES_ENABLE.html#REFRN10141" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>了解<code class="codeph">STATISTICS_LEVEL</code>和<code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>初始化参数</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720" title="使用初始化参数启用或禁用监视。">启用和禁用数据库操作监视</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TGSQL94604"></a><a id="TGSQL94603"></a><div class="props_rev_3"><a id="GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A" name="GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A"></a><h4 id="TGSQL-GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A" class="sect4"><span class="enumeration_section">21.2.2</span>在语句级别启用和禁用数据库操作监视</h4>
                  <div>
                     <p>当<code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>初始化参数设置为<code class="codeph">DIAGNOSTIC+TUNING</code> ，您可以使用提示来启用或禁用特定SQL语句的监视。
                     </p>
                     <div class="section">
                        <p>当数据库在单次执行中消耗至少5秒的CPU或I / O时间时，它会自动监视SQL语句或PL / SQL子程序。<code class="codeph">MONITOR</code>提示对于强制监视不符合时间标准的语句或子程序很有用。
                        </p>
                        <p>有两个语句级提示可用于强制或阻止数据库监视SQL语句。要强制SQL监视，请使用<code class="codeph">MONITOR</code>提示：</p><pre class="pre codeblock"><code>SELECT / * + MONITOR * / SYSDATE FROM DUAL;</code></pre><p>仅当<code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code>参数设置为<code class="codeph">DIAGNOSTIC+TUNING</code>时，此提示才有效。要防止监视提示的SQL语句，请使用<code class="codeph">NO_MONITOR</code>反向提示。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A__GUID-7F6D5DCC-9AAC-4AF9-840D-ECF17BAD87F3">假设</p>
                        <p>本教程假设以下内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>数据库监控目前在系统级别启用。</p>
                           </li>
                           <li>
                              <p>您希望禁用语句<code class="codeph">SELECT * FROM sales ORDER BY time_id</code>自动监视。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A__GUID-39B3B05F-69A9-41D9-BD11-B829D351873F">要禁用对SQL语句的数据库操作的监视：</p>
                        <ol>
                           <li>
                              <p>使用<code class="codeph">NO_MONITOR</code>提示执行查询。
                              </p>
                              <p>例如，运行以下语句：</p><pre class="pre codeblock"><code>SQL&gt; SELECT * / * + NO_MONITOR * / FROM sales ORDER BY time_id;</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A__GUID-C701BEE2-D952-4C8F-B133-B98D80CD0A74">
                        <p class="notep1">也可以看看：</p>
                        <p>有关使用<code class="codeph">MONITOR</code>和<code class="codeph">NO_MONITOR</code>提示的信息，请<a href="../sqlrf/Comments.html#SQLRF00219" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720" title="使用初始化参数启用或禁用监视。">启用和禁用数据库操作监视</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TGSQL94606"></a><a id="TGSQL94605"></a><div class="props_rev_3"><a id="GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444" name="GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444"></a><h3 id="TGSQL-GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444" class="sect3"><span class="enumeration_section">21.3</span>定义复合数据库操作</h3>
               <div>
                  <p>定义数据库操作涉及提供名称并指定其开始和结束时间。</p>
                  <div class="section">
                     <p>使用<code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code>函数启动数据库操作，并使用<code class="codeph">DBMS_SQL_MONITOR.END_OPERATION</code>过程结束它。
                     </p>
                     <p>要在其他会话中开始操作，请指定<code class="codeph">session_id</code>和<code class="codeph">serial_num</code>的组合。<code class="codeph">BEGIN_OPERATION</code>函数返回数据库操作执行ID。如果<code class="codeph">dbop_exec_id</code>为null，则数据库将生成唯一值。
                     </p>
                     <p>数据库操作存在单个命名空间，这意味着名称冲突是可能的。Oracle建议使用以下命名约定： <code class="codeph"><span class="codeinlineitalic">component_name.subcomponent_name.operation name</span></code> 。对于数据库内的操作，Oracle建议使用<code class="codeph">ORA</code>作为组件名称。例如，物化视图刷新可以命名为<code class="codeph">ORA.MV.refresh</code> 。电子商务套件工资单功能可以命名为<code class="codeph">EBIZ.payroll</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444__GUID-038872A5-239F-4666-888C-13C032EF30D3">要在当前会话中创建数据库操作：</p>
                     <ol>
                        <li>
                           <p>在SQL * Plus或SQL Developer中，以具有必要权限的用户身份登录数据库。</p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code>启动操作。</p>
                           <p>此函数返回数据库操作执行ID。以下示例创建名为<code class="codeph">ORA.sales.agg</code>的操作，并将执行ID存储在SQL * Plus变量中：</p><pre class="pre codeblock"><code>VARIABLE exec_id NUMBER; BEGIN：exec_id：= DBMS_SQL_MONITOR.BEGIN_OPERATION（dbop_name =&gt;'ORA.sales.agg'）;结束; /</code></pre></li>
                        <li>
                           <p>执行要监视的SQL语句或PL / SQL程序。</p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">DBMS_SQL_MONITOR.END_OPERATION</code>结束操作。</p>
                           <p>以下示例结束操作<code class="codeph">ORA.sales.agg</code> ：</p><pre class="pre codeblock"><code>BEGIN DBMS_SQL_MONITOR.END_OPERATION（dbop_name =&gt;'ORA.sales.agg'，dbop_eid =&gt;：exec_id）;结束; /</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444__GUID-C76CA02B-67F5-4226-8F98-6A099F8BB010">
                     <p class="titleinexample">例21-1创建数据库操作</p>
                     <p>以下示例说明如何使用<code class="codeph">DBMS_SQL_MONITOR</code>程序包在不同的会话中开始和结束数据库操作。此示例假定以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您是管理员，希望监视用户<code class="codeph">sh</code>启动的会话中的语句。
                           </p>
                        </li>
                        <li>
                           <p>您想要监视<code class="codeph">sh.sales</code>表和<code class="codeph">sh.customers</code>表的查询。
                           </p>
                        </li>
                        <li>
                           <p>您希望将这两个查询作为名为<code class="codeph">sh_count</code>的数据库操作进行监视。
                           </p>
                        </li>
                     </ul>
                     <div class="tblformalwide" id="GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444__GUID-0A87E83A-AE66-49F4-B0B1-193FCA0010DD">
                        <p class="titleintable">表21-3创建数据库操作</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="创建数据库操作" width="100%" border="1" summary="This 2 column table illustrates how to begin and end a database operation. Column 1 is the SYSTEM session. Column 2 is the SH session. Column 3 describes each session. " frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d105713e3307">系统会话</th>
                                 <th align="left" valign="bottom" width="20%" id="d105713e3309">SH会议</th>
                                 <th align="left" valign="bottom" width="20%" id="d105713e3311">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d105713e3315" headers="d105713e3307 "><pre class="pre codeblock"><code>SQL&gt; CONNECT SYSTEM输入密码：*********已连接。
</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3315 d105713e3309 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3315 d105713e3311 ">
                                    <p>启动SQL * Plus并以具有管理员权限的用户身份进行连接。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d105713e3325" headers="d105713e3307 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3325 d105713e3309 "><pre class="pre codeblock"><code>SQL&gt; CONNECT sh输入密码：******已连接。
</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3325 d105713e3311 ">
                                    <p>在另一个终端中，启动SQL * Plus并以用户<code class="codeph">sh</code>身份以用户身份进行连接。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d105713e3338" headers="d105713e3307 "><pre class="pre codeblock"><code>SELECT SID，SERIAL＃FROM V $ SESSION WHERE USERNAME ='SH'; SID SERIAL＃---------- ---------- 121 13397</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3338 d105713e3309 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3338 d105713e3311 ">
                                    <p>在<code class="codeph">SYSTEM</code>会话中，查询<code class="codeph">sh</code>会话的会话ID和序列号。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d105713e3354" headers="d105713e3307 "><pre class="pre codeblock"><code>VARIABLE eid NUMBER BEGIN：eid：= DBMS_SQL_MONITOR.BEGIN_OPERATION（'sh_count'，null，null，null，'121'，'13397'）;结束; / PRINT eid EID ---------- 2</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3354 d105713e3309 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3354 d105713e3311 ">
                                    <p>在<code class="codeph">SYSTEM</code>会话中，开始数据库操作，指定<code class="codeph">sh</code>会话的会话ID和序列号。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d105713e3370" headers="d105713e3307 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3370 d105713e3309 "><pre class="pre codeblock"><code>SELECT count（*）FROM sh.sales; COUNT（*）---------- 918843 SELECT COUNT（*）FROM sh.customers; COUNT（*）---------- 55500</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3370 d105713e3311 ">
                                    <p>在<code class="codeph">sh</code>会话中，查询<code class="codeph">sales</code>和<code class="codeph">customers</code>表。这些SQL查询是<code class="codeph">sh_count</code>操作的一部分。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d105713e3392" headers="d105713e3307 "><pre class="pre codeblock"><code>BEGIN DBMS_SQL_MONITOR.END_OPERATION（'sh_count'，：eid）;结束; /</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3392 d105713e3309 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3392 d105713e3311 ">
                                    <p>通过指定操作名称和执行ID来结束数据库操作。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d105713e3402" headers="d105713e3307 "><pre class="pre codeblock"><code>COL DBOP_NAME FORMAT a10 COL STATUS FORMAT a10 COL ID FORMAT 999 SELECT DBOP_NAME，DBOP_EXEC_ID AS ID，STATUS，CPU_TIME，BUFFER_GETS FROM V $ SQL_MONITOR WHOP DBOP_NAME NOT NOT NULL ORDER BY DBOP_EXEC_ID; DBOP_NAME ID状态CPU_TIME GETS ----------  -  ---------- -------- ---- sh_count 1 EXECUTING 24997 65</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3402 d105713e3309 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3402 d105713e3311 ">
                                    <p>查询<code class="codeph">sh_count</code>数据库操作的元数据。操作的状态为<code class="codeph">EXECUTING</code>因为会话尚未获取新的会话状态。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d105713e3418" headers="d105713e3307 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3418 d105713e3309 "><pre class="pre codeblock"><code>SELECT SYSDATE FROM DUAL;</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3418 d105713e3311 ">
                                    <p>要收集更改的会话信息，请执行执行数据库往返的查询。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d105713e3428" headers="d105713e3307 "><pre class="pre codeblock"><code>COL DBOP_NAME FORMAT a10 COL STATUS FORMAT a10 COL ID FORMAT 999 SELECT DBOP_NAME，DBOP_EXEC_ID AS ID，STATUS，CPU_TIME，BUFFER_GETS FROM V $ SQL_MONITOR WHOP DBOP_NAME NOT NOT NULL ORDER BY DBOP_EXEC_ID; DBOP_NAME ID状态CPU_TIME GETS ----------  -  ---------- -------- ---- sh_count 1 DONE 24997 65</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3428 d105713e3309 ">
                                    <p>N / A</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d105713e3428 d105713e3311 ">
                                    <p>现在，操作状态已更新为<code class="codeph">DONE</code> 。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="../arpls/DBMS_SQL_MONITOR.html#ARPLS-GUID-13874A73-369E-42CD-9C43-A12F1B3BDEC6" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF" title="本章介绍如何监视SQL和PL / SQL。">监视数据库操作</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TGSQL94608"></a><a id="TGSQL94607"></a><div class="props_rev_3"><a id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062" name="GUID-4048D00E-2635-42C8-A37D-71EFAC619062"></a><h3 id="TGSQL-GUID-4048D00E-2635-42C8-A37D-71EFAC619062" class="sect3"><span class="enumeration_section">21.4</span>生成和访问SQL监视器报告</h3>
               <div>
                  <p>默认情况下，AWR会自动以XML格式捕获SQL监视报告。</p>
                  <div class="section">
                     <p>报告仅捕获未执行或排队的SQL语句，并且自上次捕获周期以来已完成执行。AWR仅根据已执行的执行时间捕获最昂贵语句的报告。SQL Monitor保留策略由AWR策略控制。您可以使用<code class="codeph">DBMS_WORKLOAD_REPOSITORY.MODIFY_SNAPSHOT_SETTINGS</code>过程更改保留策略。
                     </p>
                     <p>Enterprise Manager云控制（云控制）中的“受监控的SQL执行”页面汇总了受监控语句的活动。您可以使用此页面深入了解并获取有关特定语句的其他详细信息。“受监视的SQL执行详细信息”页面使用来自多个视图的数据，包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">GV $ SQL_MONITOR</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV $ SQL_PLAN_MONITOR</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV $ SQL_MONITOR_SESSTAT</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV $ SQL</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV $ SQL_PLAN</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV $ ACTIVE_SESSION_HISTORY</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV $ SESSION_LONGOPS</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_HIST_REPORTS</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_HIST_REPORTS_DETAILS</code></p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-FB49D556-06E8-4366-B846-6D4078342523">
                        <p class="notep1">注意：</p>
                        <p>从<span>Oracle Database 19c开始</span> ，Oracle数据库包括未记录的<code class="codeph">V$</code>视图，这些视图使<span class="italic">没有</span> <code class="codeph">SELECT_CATALOG_ROLE</code>的数据库用户能够查看会话中执行的简单数据库操作（单个SQL和PL / SQL语句）的计划和统计信息。没有<code class="codeph">SELECT_CATALOG_ROLE</code>用户无法查看其他用户的SQL执行统计信息和详细信息。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-DB68FCBA-FB2B-4C42-BF3E-E7157AA7E83C">假设</p>
                     <p>本教程假设以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>用户<code class="codeph">sh</code>正在执行以下对每个客户进行的销售的长期并行查询：</p><pre class="pre codeblock"><code>SELECT c.cust_id，c.cust_last_name，c.cust_first_name，s.prod_id，p.prod_name，s.time_id FROM sales s，customers c，products p WHERE s.cust_id = c.cust_id AND s.prod_id = p.prod_id ORDER BY c.cust_id，s.time_id;</code></pre></li>
                        <li>
                           <p>您希望确保前面的查询不会消耗过多的资源。在执行语句时，您需要确定有关数据库操作的基本统计信息，例如并行度，数据库总时间和I / O请求数。</p>
                        </li>
                        <li>
                           <p>您使用Cloud Control来监视语句执行。</p>
                           <div class="infoboxnote" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-4FC66F79-AC74-48FD-8C97-79FD7C410096">
                              <p class="notep1">注意：</p>
                              <p>要从命令行生成SQL监视器报告，请在<code class="codeph">DBMS_SQLTUNE</code>包中运行<code class="codeph">REPORT_SQL_MONITOR</code>函数，如以下示例SQL * Plus脚本中所示：</p><pre class="pre codeblock"><code>VARIABLE my_rept CLOB BEGIN：my_rept：= DBMS_SQLTUNE.REPORT_SQL_MONITOR（）;结束; / PRINT：my_rept</code></pre></div>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-23017E08-D734-4B8D-929C-C3EAC06AE90E">要监视SQL执行：</p>
                     <ol>
                        <li>
                           <p>访问“受监视的SQL执行”页面，如<span class="q">“ <a href="monitoring-database-operations.html#GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7" title="Cloud Control中的“受监视的SQL执行”页面（也称为SQL Monitor）显示SQL执行的详细信息。SQL Monitor是报告数据库操作的推荐接口。">云控制中的受监视的SQL执行页面</a> ”中所述</span> 。
                           </p>
                           <p>在下图中，顶行显示并行查询。</p>
                           <div class="figure" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-118F05FF-1AEA-4492-8212-FF8747B861EB"><img src="img/mon_sql_exec_main.jpg" alt="下面是mon_sql_exec_main.jpg的描述" title="下面是mon_sql_exec_main.jpg的描述" longdesc="img_text/mon_sql_exec_main.html"><br><a href="img_text/mon_sql_exec_main.html">mon_sql_exec_main.jpg插图的描述</a></div>
                           <!-- class="figure" -->
                           <p>在此示例中，查询已执行1.4分钟。</p>
                        </li>
                        <li>
                           <p>单击“SQL ID”列中的值以查看有关该语句的详细信息。</p>
                           <p>将显示“已监视的SQL详细信息”页</p>
                           <div class="figure" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-046EFC89-FAC0-44C0-B07A-CAFF7B5EC0C0"><img src="img/mon_sql_exec_details.gif" alt="mon_sql_exec_details.gif的描述如下" title="mon_sql_exec_details.gif的描述如下" longdesc="img_text/mon_sql_exec_details.html"><br><a href="img_text/mon_sql_exec_details.html">mon_sql_exec_details.gif插图的描述</a></div>
                           <!-- class="figure" -->
                           <p>上述报告显示了与语句执行相关的执行计划和统计信息。例如，“时间轴”列显示执行计划的每个步骤何时处于活动状态。显示相对于语句执行开始和结束的时间。Executions列显示操作执行的次数。</p>
                        </li>
                        <li>
                           <p>在“概述”部分中，单击SQL文本旁边的链接。</p>
                           <p>一条消息显示SQL语句的完整文本。</p>
                           <div class="figure" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-19D6EE8B-B387-49E7-9FF7-7BE8EEE8E517"><img src="img/sql_id_tooltip.gif" alt="下面是sql_id_tooltip.gif的描述" title="下面是sql_id_tooltip.gif的描述" longdesc="img_text/sql_id_tooltip.html"><br><a href="img_text/sql_id_tooltip.html">插图描述sql_id_tooltip.gif</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>在“时间和等待统计”部分中，在“数据库时间”旁边，将光标移动到条形图上的最大部分。</p>
                           <p>一条消息显示用户I / O占用了超过一半的数据库时间。</p>
                           <div class="figure" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-655F455D-5542-4CE7-9257-9AE2E98D56B7"><img src="img/time_stats.gif" alt="time_stats.gif的描述如下" title="time_stats.gif的描述如下" longdesc="img_text/time_stats.html"><br><a href="img_text/time_stats.html">插图描述time_stats.gif</a></div>
                           <!-- class="figure" -->
                           <p>“数据库时间”测量数据库处理此SQL语句所花费的时间。该值包括CPU和等待时间，例如I / O时间。条形图分为几个颜色编码部分，以突出显示CPU资源，用户I / O资源和其他资源。您可以将光标移动到任何部分以查看总计的百分比值。</p>
                        </li>
                        <li>
                           <p>在“详细信息”部分的“IO请求”列中，将光标移到“I / O请求”栏上以查看总计的百分比值。</p>
                           <p>出现一条消息。</p>
                           <div class="figure" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-81041CAC-A1AC-4A5A-A999-12173E8D95B4"><img src="img/io_requests.gif" alt="io_requests.gif的描述如下" title="io_requests.gif的描述如下" longdesc="img_text/io_requests.html"><br><a href="img_text/io_requests.html">插图说明io_requests.gif</a></div>
                           <!-- class="figure" -->
                           <p>在上图中，IO Requests消息显示受监控SQL发出的读取请求总数。该消息显示读取请求占总I / O请求的80％。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-9DC5EB17-AA69-419D-A78D-D50B69A7755F">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Cloud Control联机帮助，用于描述“受监视的SQL执行详细信息”页面上的元素，以及有关报告中所有统计信息的完整说明。</p>
                        </li>
                        <li>
                           <p><a href="../refrn/V-SQL_MONITOR.html#GUID-79E97A84-9C27-4A5E-AC0D-C12CB3E748E6" target="_blank"><span><cite>Oracle数据库参考</cite></span></a> ，了解<code class="codeph">V$SQL_MONITOR</code>以及数据库操作监视的相关视图</p>
                        </li>
                        <li>
                           <p><a href="https://www.youtube.com/watch?v=pEC5GdtzpRs" target="_blank">为什么使用SQL Monitor</a>来显示“受监控的SQL详细信息”报告的有用功能的视频</p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF" title="本章介绍如何监视SQL和PL / SQL。">监视数据库操作</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-75DE088E-4CFA-47D9-8078-F3BE97A255F7" name="GUID-75DE088E-4CFA-47D9-8078-F3BE97A255F7"></a><h3 id="TGSQL-GUID-75DE088E-4CFA-47D9-8078-F3BE97A255F7" class="sect3"><span class="enumeration_section">21.5</span>监控数据库操作：场景</h3>
               <div>
                  <p>在这些方案中，您将报告简单和复合数据库操作。</p>
                  <p>本节包含以下主题：</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-11748F62-BE24-4511-B77B-F28D5E443A0A">报告简单数据库操作：场景</a><br>在这种情况下，预计查询将在几秒钟内完成，但仍在继续执行。
                     </li>
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-47840D0F-55E2-433B-8B43-7C9942B91FFD">报告复合数据库操作：场景</a><br>此方案使用<code class="codeph">DBMS_SQL_MONITOR</code>定义数据库操作并生成活动报告。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF" title="本章介绍如何监视SQL和PL / SQL。">监视数据库操作</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-11748F62-BE24-4511-B77B-F28D5E443A0A" name="GUID-11748F62-BE24-4511-B77B-F28D5E443A0A"></a><h4 id="TGSQL-GUID-11748F62-BE24-4511-B77B-F28D5E443A0A" class="sect4"><span class="enumeration_section">21.5.1</span>报告简单数据库操作：场景</h4>
                  <div>
                     <p>在这种情况下，预计查询将在几秒钟内完成，但仍在继续执行。</p>
                     <div class="section">
                        <p>在此示例中，假设您以用户<code class="codeph">sh</code>身份登录到数据库，然后运行以下查询：</p><pre class="pre codeblock"><code>SELECT / * + MONITOR * / s.prod_id，c.cust_last_name FROM sales s，customers c ORDER BY prod_id</code></pre><p>查询未完成。从<span>Oracle Database 19c</span>开始， <code class="codeph">sh</code>等低权限用户可以在其会话中为简单数据库操作（单个SQL和PL / SQL语句）生成SQL Monitor报告。要确定问题的根源，请使用SQL Monitor进行诊断，如下所示：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-11748F62-BE24-4511-B77B-F28D5E443A0A__GUID-6DDCB57F-8103-49E8-A79D-8E72018CA995">
                        <ol>
                           <li>
                              <p>取消查询。</p>
                           </li>
                           <li>
                              <p>通过调用<code class="codeph">DBMS_SQL_MONITOR.REPORT_SQL_MONITOR</code>获取文本报告：</p><pre class="pre codeblock"><code>SET LONG 1000000 VARIABLE my_rept CLOB; BEGIN：my_rept：= DBMS_SQL_MONITOR.REPORT_SQL_MONITOR（report_level =&gt;'ALL'，TYPE =&gt;'text'）;结束; / PRINT：my_rept</code></pre><p>部分样本输出如下所示：</p><pre class="pre codeblock"><code>SQL Text ------------------------------ SELECT / * + MONITOR * / s.prod_id，c.cust_last_name FROM sales s，客户c ORDER BY prod_id全球信息------------------------------状态：DONE（ERROR）实例ID：1会话：SH （42：3617）SQL ID：d9w9dw5v007xp SQL执行ID：16777217执行开始日期：09/18/2018 14:08:13首次刷新时间：09/18/2018 14:08:13上次刷新时间：09/18/2018 14:08:34 MY_REPT -------------------------------------------- ------------------------------------持续时间：21s模块/动作：SQL * Plus /  - 服务： SYS $ USERS计划：sqlplus @ slc16iva（TNS V1-V3）取电话：1全球统计MY_REPT ----------------------------- -------------------------------------------------- -  |时间|时间|等待|电话|获取|要求|字节|要求|字节| ================================================== ============================== | 21 | 11 | 10 | 1 | 204 | 233 | 3MB | 4568 | 909MB | ================================================== ============================== SQL计划监控详细信息（计划哈希值= 2036849021）========= ================================================== ===================== MY_REPT ---------------------------- -------------------------------------------------- -  ================================================ ================================ ================== =============== | Id |操作|名称|行|成本|时间|开始|执行者|行|阅读|阅读|写|写| Mem | Tem p |活动|活动详情| | | | | （Estim）| |活动|有效| | （实际）|要求|字节|要求|字节| （最大）| （马x）| （％）| （#samples）| ================================================== ============================== ==================== ================================================== ========== ================================= MY_REPT ------ -------------------------------------------------- ------------------------ | 0 |选择声明| | | | 19 | +2 | 1 | 0 | | | | | 。| 。| | | | 1 |排序顺序| | 51G | 316M | 20 | +1 | 1 | 0 | | | 4496 | 908MB | 99MB | 909 MB | | | | 2 | MERGE加入笛卡尔| | 51G | 2M | 19 | +2 | 1 | 50M | | | | | 。| 。| | | | 3 |表访问完全|客户| 55500 | 414 | 20 | +2 | 1 | 54 | 3 | 120KB | | | 。| MY_REPT ------------------------------------------------- -------------------------------。| | | | 4 | BUFFER SORT | | 919K | 316M | 19 | +2 | 54 | 50M | | | | | 28MB | 。| | | | 5 | PARTITION RANGE ALL | | 919K | 29 | 1 | +2 | 1 | 919K | | | | | 。| 。| | | | 6 | BITMAP转换为ROWIDS | | 919K | 29 | 1 | +2 | 28 | 919K | | | | | 。| 。| | | | 7 | BITMAP INDEX FAST FULL SCAN | SALES_PROD_BIX | | | MY_REPT ------------------------------------------------- ------------------------------- 1 | +2 | 28 | 1074 | 32 | 512KB | | | 。| 。| | | ================================================== ============================== ==================== ================================================== ========== =================================</code></pre><p>由于格式化，前面的输出很难阅读。您决定创建一个活动的SQL监视器报告，该报告是图形化的。</p>
                           </li>
                           <li>
                              <p>创建包含以下命令的SQL脚本：</p><pre class="pre codeblock"><code>SET FEEDBACK OFF SET TERMOUT OFF SET TRIMSPOOL ON SET TRIM ON SET PAGES 0 SET LINESIZE 1000 SET LONG 1000000 SET LONGCHUNKSIZE 1000000 SPOOL /tmp/long_sql.htm SELECT DBMS_SQL_MONITOR.REPORT_SQL_MONITOR（report_level =&gt;'ALL'，TYPE =&gt;'active'）来自双重; SPOOL OFF</code></pre></li>
                           <li>
                              <p>在SQL * Plus中，运行您在上一步中创建的SQL脚本。</p>
                           </li>
                           <li>
                              <p>在浏览器中打开输出HTML文件，然后查看报告：</p>
                              <div class="figure" id="GUID-11748F62-BE24-4511-B77B-F28D5E443A0A__GUID-B66CDC1B-32A8-49BE-8081-112A4E8A5D63"><img src="img/cartesian.png" alt="下面是cartesian.png的描述" title="下面是cartesian.png的描述" longdesc="img_text/cartesian.html"><br><a href="img_text/cartesian.html">插图说明cartesian.png</a></div>
                              <!-- class="figure" -->
                              <p>性能问题的原因如第2行所示：笛卡尔连接。查询的作者无意中遗漏了<code class="codeph">WHERE</code>子句。该查询在取消之前返回了5000万行，而不是像<code class="codeph">sales</code>和<code class="codeph">customers</code>的内部联接那样返回大约100万行。对两个表中的联接数据进行排序占用了大部分数据库时间（第1行）。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-75DE088E-4CFA-47D9-8078-F3BE97A255F7" title="在这些方案中，您将报告简单和复合数据库操作。">监控数据库操作：方案</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-47840D0F-55E2-433B-8B43-7C9942B91FFD" name="GUID-47840D0F-55E2-433B-8B43-7C9942B91FFD"></a><h4 id="TGSQL-GUID-47840D0F-55E2-433B-8B43-7C9942B91FFD" class="sect4"><span class="enumeration_section">21.5.2</span>报告复合数据库操作：场景</h4>
                  <div>
                     <p>此方案使用<code class="codeph">DBMS_SQL_MONITOR</code>定义数据库操作并生成活动报告。
                     </p>
                     <div class="section">您的目标是将<code class="codeph">sh</code>模式中的表的四个查询分组到一个操作中，然后生成一个报告。
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-47840D0F-55E2-433B-8B43-7C9942B91FFD__GUID-C8FDF5A9-8194-4B32-8777-5DF0B53237DB">
                        <ol>
                           <li>
                              <p>在SQL * Plus中，以管理用户<code class="codeph">SAM</code>身份登录。开始一个名为<code class="codeph">SHOP</code>的操作（指定<code class="codeph">forced_tracking</code>以确保SQL Monitor跟踪SQL），运行四个查询，然后按如下方式结束操作：</p><pre class="pre codeblock"><code>VARIABLE exec_id NUMBER; BEGIN：exec_id：= DBMS_SQL_MONITOR.BEGIN_OPERATION（dbop_name =&gt;'SHOP'，forced_tracking =&gt;'Y'）;结束; / SELECT COUNT（*）FROM sh.sales; SELECT COUNT（*）FROM sh.customers; SELECT prod_id，cust_id FROM sh.sales WHERE prod_id &lt;26 ORDER BY prod_id; SELECT cust_id，cust_first_name，cust_last_name，cust_city FROM sh.customers WHERE cust_id &lt;30000 ORDER BY cust_id; BEGIN DBMS_SQL_MONITOR.END_OPERATION（dbop_name =&gt;'SHOP'，dbop_eid =&gt;：exec_id）;结束; /</code></pre></li>
                           <li>
                              <p>要获取有关操作的元数据（包括其状态和元数据），请查询<code class="codeph">V$SQL_MONITOR</code> （包括示例输出）：</p><pre class="pre codeblock"><code>COL STATUS FORMAT a10 COL DBOP_NAME FORMAT a10 COL CON_NAME FORMAT a5 SELECT STATUS，SQL_ID，DBOP_NAME，DBOP_EXEC_ID，TO_CHAR（ELAPSED_TIME / 1000000，'000.00'）AS ELA_SEC FROM V $ SQL_MONITOR WHERE DBOP_NAME ='SHOP'; STATUS SQL_ID DBOP_NAME DBOP_EXEC_ID ELA_SEC ---------- ------------- ---------- ------------ ------- DONE SHOP 3 001.34</code></pre></li>
                           <li>
                              <p>要获取有关SQL Monitor报告的元数据，请调用<code class="codeph">DBMS_SQL_MONITOR.REPORT_SQL_MONITOR</code> （包括样本输出）：</p><pre class="pre codeblock"><code>SET LONG 10000000 SET LONGCHUNKSIZE 10000000 SET PAGES 0 SELECT DBMS_SQL_MONITOR.REPORT_SQL_MONITOR（dbop_name =&gt;'SHOP'，type =&gt;'TEXT'，report_level =&gt;'ALL'）AS rpt FROM DUAL; SQL监控报告全局信息------------------------------状态：DONE实例ID：1会话：SAM（87：6406） DBOP名称：SHOP DBOP执行ID：3首次刷新时间：10/03/2017 07:33:32最后刷新时间：10/03/2017 07:34:24持续时间：52s模块/动作：sqlplus @ myhost（TNS V1 -V3）/  - 服务：MYSERVICE程序：sqlplus @ myhost（TNS V1-V3）全球统计数据============================= =========================== |经过了| Cpu | IO |缓冲区|阅读|阅读| |时间|时间|等待|获取|要求|字节| ================================================== ====== | 1.36 | 1.34 | 0.02 | 202 | 583 | 27MB | ================================================== ======</code></pre></li>
                           <li>
                              <p>要生成活动的HTML报告，请将操作的名称传递给<code class="codeph">DBMS_SQL_MONITOR.REPORT_SQL_MONITOR</code> ：</p><pre class="pre codeblock"><code>SET TRIMSPOOL ON SET TRIM ON SET PAGES 0 SET LINESIZE 1000 SET LONG 1000000 SET LONGCHUNKSIZE 1000000 SPOOL /tmp/shop.htm SELECT DBMS_SQL_MONITOR.REPORT_SQL_MONITOR（dbop_name =&gt;'SHOP'，report_level =&gt;'ALL'，TYPE =&gt;'active' ）FROM DUAL; SPOOL OFF</code></pre><p>下图显示了活动报告：</p>
                              <div class="figure" id="GUID-47840D0F-55E2-433B-8B43-7C9942B91FFD__GUID-A5290C34-90AE-40B0-A1E9-EDE266D75896">
                                 <p class="titleinfigure">图21-3 SQL监视器报告</p><img src="img/dbopactive.png" alt="下面是图21-3的描述" title="下面是图21-3的描述" longdesc="img_text/dbopactive.html"><br><a href="img_text/dbopactive.html">“图21-3 SQL监视器报告”的说明</a></div>
                              <!-- class="figure" -->
                           </li>
                        </ol>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-47840D0F-55E2-433B-8B43-7C9942B91FFD__GUID-C1F68F29-E6DC-42A8-B933-8D6E48313E5E">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../arpls/DBMS_SQL_MONITOR.html#ARPLS74779" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考，</cite></span></a>以了解有关<code class="codeph">DBMS_SQL_MONITOR</code>更多信息</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="monitoring-database-operations.html#GUID-75DE088E-4CFA-47D9-8078-F3BE97A255F7" title="在这些方案中，您将报告简单和复合数据库操作。">监控数据库操作：方案</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="01554.rman-recovery-advanced.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>执行RMAN恢复：高级方案</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96241-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="rman-block-media-recovery.html" title="Previous" type="text/html"></link>
      <link rel="next" href="performing-rman-tspitr.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="BRADV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rman-block-media-recovery.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="performing-rman-tspitr.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-diagnosing-responding-failures.html" property="item" typeof="WebPage"><span property="name">诊断和应对失败</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">执行RMAN恢复：高级方案</li>
            </ol>
            <a id="GUID-EA9DB3ED-2481-47DD-908B-A314D5C3F730" name="GUID-EA9DB3ED-2481-47DD-908B-A314D5C3F730"></a><a id="BRADV008"></a>
            
            <h2 id="BRADV-GUID-EA9DB3ED-2481-47DD-908B-A314D5C3F730" class="sect2"><span class="enumeration_chapter">20</span>执行RMAN恢复：高级方案</h2>
         </header>
         <div class="ind">
            <div>
               <p>“ <a href="part-diagnosing-responding-failures.html#GUID-ED89DC53-A816-450B-BFF4-A712D2694EEC">诊断和响应失败</a> ”的前几章涵盖了最基本的恢复方案，旨在尽可能通用。本章中的场景不太常见，或者比基本场景更复杂。
               </p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="rman-recovery-advanced.html#GUID-18DC642E-DA14-47A9-9547-02F385CA47EA" title="您可以通过应用增量备份对在NOARCHIVELOG模式下运行的数据库执行有限的恢复恢复。增量备份必须一致，就像在NOARCHIVELOG模式下运行的数据库的所有备份一样，因此在打开数据库时无法对数据库进行备份。">使用增量备份恢复NOARCHIVELOG数据库</a></p>
                  </li>
                  <li>
                     <p><a href="rman-recovery-advanced.html#GUID-2B93E1AF-5ED1-4FAE-91BB-63362CADF7AD" title="RMAN可以将丢失的服务器参数文件还原到其默认位置或您选择的位置。与丢失控制文件不同，丢失服务器参数文件不会导致实例立即停止。实例可能会继续运行，但您必须将其关闭并在还原服务器参数文件后重新启动它。">恢复服务器参数文件</a></p>
                  </li>
                  <li>
                     <p><a href="rman-recovery-advanced.html#GUID-77C2B092-4BEB-4BAC-91F9-7368EA16A2B6" title="当所有当前控制文件都丢失时，您必须还原备份控制文件。">使用备份控制文件执行恢复</a></p>
                  </li>
                  <li>
                     <p><a href="rman-recovery-advanced.html#GUID-195E30B2-6077-446D-A255-089D3341268A" title="灾难恢复包括在丢失整个目标数据库，恢复目录数据库，所有当前控制文件，所有联机重做日志文件和所有参数文件后恢复和恢复目标数据库。">执行灾难恢复</a></p>
                  </li>
                  <li>
                     <p><a href="rman-recovery-advanced.html#GUID-6B71E7DF-A2B6-44F5-A8D5-B184BB41A768" title="使用RESTORE和RECOVER命令还原新主机上的数据库。当您要执行灾难恢复过程的测试运行或将数据库永久移动到新主机时，在新主机上还原数据库非常有用。">在新主机上还原数据库</a></p>
                  </li>
                  <li>
                     <p><a href="rman-recovery-advanced.html#GUID-8E64485B-3788-4389-A892-8C560F12443F" title="RMAN使您可以通过网络连接到包含所需文件的物理备用数据库来还原或恢复文件。您可以还原整个数据库，数据文件，控制文件，服务器参数文件或表空间。在需要同步主数据库和备用数据库的情况下，通过网络还原文件非常有用。">通过网络恢复和恢复文件</a></p>
                  </li>
               </ul>
            </div><a id="BRADV362"></a><a id="BRADV89841"></a><div class="props_rev_3"><a id="GUID-18DC642E-DA14-47A9-9547-02F385CA47EA" name="GUID-18DC642E-DA14-47A9-9547-02F385CA47EA"></a><h3 id="BRADV-GUID-18DC642E-DA14-47A9-9547-02F385CA47EA" class="sect3"><span class="enumeration_section">20.1</span>使用增量备份恢复NOARCHIVELOG数据库</h3>
               <div>
                  <p>您可以通过应用增量备份对在<code class="codeph">NOARCHIVELOG</code>模式下运行的数据库执行有限的恢复恢复。增量备份必须一致，就像在<code class="codeph">NOARCHIVELOG</code>模式下运行的数据库的所有备份一样，因此在打开数据库时无法对数据库进行备份。
                  </p>
                  <div class="section">
                     <p>恢复在<code class="codeph">NOARCHIVELOG</code>模式下运行的数据库与在<code class="codeph">ARCHIVELOG</code>模式下恢复数据库类似。主要区别是：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在<code class="codeph">NOARCHIVELOG</code>模式下，只能使用一致的备份来恢复数据库。
                           </p>
                        </li>
                        <li>
                           <p>无法进行介质恢复，因为不存在归档重做日志。</p>
                        </li>
                     </ul>
                     <p>在恢复<code class="codeph">NOARCHIVELOG</code>数据库时，请在<code class="codeph">RECOVER</code>命令上指定<code class="codeph">NOREDO</code>选项，以指示RMAN不会尝试应用存档的重做日志。否则，RMAN返回错误。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><span class="bold">要使用增量备份恢复NOARCHIVELOG数据库：</span></p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>连接到目标数据库和恢复目录后，将数据库置于已装入状态：</span><div><pre class="oac_no_warn" dir="ltr">STARTUP FORCE MOUNT</pre></div>
                     </li>
                     <li class="stepexpand"><span>还原并恢复数据库。</span><div>
                           <p>例如，您可以使用以下命令执行不完全恢复：</p><pre class="oac_no_warn" dir="ltr">从TAG恢复数据库“consistent_whole_backup”; RECOVER DATABASE NOREDO;</pre></div>
                     </li>
                     <li class="stepexpand"><span>使用<code class="codeph">RESETLOGS</code>选项打开数据库。</span><div>
                           <p>例如，输入以下命令：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE OPEN RESETLOGS;</pre></div>
                     </li>
                  </ol>
               </div>
            </div><a id="BRADV363"></a><a id="BRADV85339"></a><div class="props_rev_3"><a id="GUID-2B93E1AF-5ED1-4FAE-91BB-63362CADF7AD" name="GUID-2B93E1AF-5ED1-4FAE-91BB-63362CADF7AD"></a><h3 id="BRADV-GUID-2B93E1AF-5ED1-4FAE-91BB-63362CADF7AD" class="sect3"><span class="enumeration_section">20.2</span>恢复服务器参数文件</h3>
               <div>
                  <p>RMAN可以将丢失的服务器参数文件还原到其默认位置或您选择的位置。与丢失控制文件不同，丢失服务器参数文件不会导致实例立即停止。实例可能会继续运行，但您必须将其关闭并在还原服务器参数文件后重新启动它。</p>
                  <div class="section">
                     <p>还原服务器参数文件时，请注意以下注意事项：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果实例已使用服务器参数文件启动，则无法覆盖现有服务器参数文件。</p>
                        </li>
                        <li>
                           <p>使用客户端初始化参数文件启动实例时，如果还原命令中未使用<code class="codeph">TO</code>子句，RMAN会将服务器参数文件还原到缺省位置。默认位置是特定于平台的，例如， <code class="codeph">?</code>Linux上的<code class="codeph">/dbs/spfile.ora</code> 。
                           </p>
                        </li>
                        <li>
                           <p>恢复目录简化了恢复过程，因为您可以避免记录和记住DBID。此过程假定您<span class="italic">没有</span>使用恢复目录。
                           </p>
                        </li>
                     </ul>
                     <p><span class="bold">从自动备份恢复服务器参数文件：</span></p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>启动RMAN并执行以下操作之一：</span><div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果在丢失服务器参数文件时启动数据库实例，则连接到目标数据库。</p>
                              </li>
                              <li>
                                 <p>如果在服务器参数文件丢失时未启动数据库实例，并且未使用恢复目录，则运行<code class="codeph">SET DBID</code>命令以设置目标数据库的DBID。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>关闭数据库实例并重新启动它而不安装数据库。</span><div>
                           <p>当服务器参数文件不可用时，RMAN使用虚拟参数文件启动实例。例如，输入以下命令：</p><pre class="oac_no_warn" dir="ltr">STARTUP FORCE NOMOUNT;</pre></div>
                     </li>
                     <li class="stepexpand"><span>执行<code class="codeph">RUN</code>命令以恢复服务器参数文件。</span><div>
                           <p>根据具体情况，您可能需要在<code class="codeph">RUN</code>命令中执行多个命令。请注意以下注意事项：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果从磁带恢复，则使用<code class="codeph">ALLOCATE CHANNEL</code>手动分配SBT通道。如果从磁盘还原，则RMAN使用默认磁盘通道。
                                 </p>
                              </li>
                              <li>
                                 <p>如果未使用默认格式（ <code class="codeph">%F</code> ）生成自动备份，则使用<code class="codeph">SET CONTROLFILE AUTOBACKUP FOR DEVICE TYPE</code>命令指定执行自动备份时生效的格式。
                                 </p>
                              </li>
                              <li>
                                 <p>如果今天未创建最新的自动备份，则使用<code class="codeph">SET UNTIL</code>指定开始搜索的日期。
                                 </p>
                              </li>
                              <li>
                                 <p>如果RMAN未连接到恢复目录，则使用<code class="codeph">SET DBID</code>设置目标数据库的DBID。
                                 </p>
                              </li>
                              <li>
                                 <p>要将服务器参数文件还原到非缺省位置，请在<code class="codeph">RESTORE SPFILE</code>命令上指定<code class="codeph">TO</code>子句或<code class="codeph">TO PFILE</code>子句。
                                 </p>
                              </li>
                              <li>
                                 <p>如果您知道RMAN每天不会生成超过<span class="italic">n次</span>自动备份，那么您可以设置<code class="codeph">RESTORE SPFILE FROM AUTOBACKUP ...MAXSEQ</code>参数为<span class="italic">n</span>减少搜索时间。<code class="codeph">MAXSEQ</code>默认设置为255， <code class="codeph">RESTORE</code>从<code class="codeph">MAXSEQ</code>向后计数以查找当天的最后一个备份。要在当天（或指定日期）找不到自动备份时终止还原操作，请在<code class="codeph">RESTORE</code>命令中设置<code class="codeph">MAXDAYS 1</code> 。
                                 </p>
                              </li>
                           </ul>
                           <p>以下示例说明了从磁带上的自动备份恢复服务器参数文件的<code class="codeph">RUN</code>命令：</p><pre class="oac_no_warn" dir="ltr">运行{ALLOCATE CHANNEL c1设备类型sbt PARMS ...;设置时间'SYSDATE-7';设备类型的SET CONTROLFILE AUTOBACKUP格式sbt为'/ disk1 / control_files / autobackup_％F'; SET DBID 123456789;从AUTOBACKUP MAXDAYS 10恢复SPFILE到'/tmp/spfileTEMP.ora'; }</pre></div>
                     </li>
                     <li class="stepexpand"><span>使用还原的文件重新启动数据库实例。</span><div>
                           <p>如果要在非缺省位置使用服务器参数文件重新启动RMAN，请使用行<code class="codeph">SPFILE=</code> <span class="italic"><code class="codeph">new_location</code></span>创建初始化参数文件，其中<span class="italic"><code class="codeph">new_location</code></span>是已还原服务器参数文件的路径名。然后，使用客户端初始化参数文件重新启动实例。
                           </p>
                           <p>例如，创建一个包含单行的文件<code class="codeph">/tmp/init.ora</code> ：</p><pre class="oac_no_warn" dir="ltr">SPFILE = / TMP / spfileTEMP.ora</pre><p>您可以使用以下RMAN命令使用还原的服务器参数文件重新启动实例：</p><pre class="oac_no_warn" dir="ltr">STARTUP FORCE PFILE = / tmp / init.ora;</pre></div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-2B93E1AF-5ED1-4FAE-91BB-63362CADF7AD__GUID-682AAC78-47F6-4F67-BA49-09F6BDD6D0B7">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="rman-complete-database-recovery.html#GUID-34BB2E4B-B2FC-4701-BB65-BFED027DB865" title="建议您记录数据库的DBID。">确定数据库的DBID</a> ”</span>以获取有关确定DBID的详细信息</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="BRADV364"></a><a id="BRADV89829"></a><div class="props_rev_3"><a id="GUID-8077F97F-76A7-49DC-8C1E-5FE8ADD0914F" name="GUID-8077F97F-76A7-49DC-8C1E-5FE8ADD0914F"></a><h4 id="BRADV-GUID-8077F97F-76A7-49DC-8C1E-5FE8ADD0914F" class="sect4"><span class="enumeration_section">20.2.1</span>从控制文件自动<span class="enumeration_section">备份</span>恢复服务器参数文件</h4>
                  <div>
                     <p>如果已配置控制文件自动备份，则只要执行自动备份，就会使用控制文件备份服务器参数文件。</p>
                     <div class="section">
                        <p><span class="bold">要从控制文件autobackup恢复服务器参数文件：</span></p>
                        <ol>
                           <li>
                              <p>设置数据库的DBID。</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">RESTORE SPFILE FROM AUTOBACKUP</code>命令。
                              </p>
                              <p>如果自动备份是非默认格式，则首先使用<code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code>命令指定格式。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-8077F97F-76A7-49DC-8C1E-5FE8ADD0914F__CHDCEIII">
                        <p class="titleinexample">示例20-1从控制文件自动备份恢复服务器参数文件</p>
                        <p>此示例设置DBID并从非默认位置的控制文件自动备份中恢复服务器参数文件。RMAN使用自动备份格式和DBID来搜索控制文件自动备份。如果找到控制文件自动备份，则RMAN将服务器参数文件从该备份还原到其默认位置。</p><pre class="oac_no_warn" dir="ltr">SET DBID 320066378;为设备类型磁盘运行{SET CONTROLFILE AUTOBACKUP格式为' <span class="italic">autobackup_format</span> ';从AUTOBACKUP恢复SPFILE; }</pre></div>
                     <!-- class="example" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-8077F97F-76A7-49DC-8C1E-5FE8ADD0914F__GUID-97387305-9495-4D48-823C-6E189A2F5018">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>“ <a href="../rcmrf/CONFIGURE.html#RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a> ”中<code class="codeph">CONFIGURE</code>命令条目中的<code class="codeph">CONFIGURE CONTROLFILE AUTOBACKUP FORMAT</code>说明，了解如何为<code class="codeph"><span class="codeinlineitalic">autobackup_format</span></code>确定正确的值</p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="rman-complete-database-recovery.html#GUID-34BB2E4B-B2FC-4701-BB65-BFED027DB865" title="建议您记录数据库的DBID。">确定数据库的DBID</a> ”</span>以获取有关如何确定DBID的详细信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89830"></a><div class="props_rev_3"><a id="GUID-AE7CD28F-3187-44DD-BEC2-E43839EC63E6" name="GUID-AE7CD28F-3187-44DD-BEC2-E43839EC63E6"></a><h4 id="BRADV-GUID-AE7CD28F-3187-44DD-BEC2-E43839EC63E6" class="sect4"><span class="enumeration_section">20.2.2</span>使用RMAN创建初始化参数文件</h4>
                  <div>
                     <p>您也可以恢复服务器参数文件作为与客户端的初始化参数文件<code class="codeph">TO PFILE ' <span class="codeinlineitalic">filename</span> '</code>的条款。
                     </p>
                     <div class="section">
                        <p>您指定的文件名必须位于可从运行RMAN客户端的主机访问的文件系统上。无需直接从运行实例的主机访问此文件。</p>
                        <p>以下RMAN命令在运行RMAN客户端的系统上创建名为<code class="codeph">/tmp/initTEMP.ora</code>的初始化参数文件：</p><pre class="oac_no_warn" dir="ltr">恢复SPFILE到PFILE'/tmp/initTEMP.ora';</pre><p>要使用初始化参数文件重新启动实例，请使用以下命令，再次在同一客户端主机上运行RMAN：</p><pre class="oac_no_warn" dir="ltr">STARTUP FORCE PFILE ='/ tmp / initTEMP.ora';</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV154"></a><div class="props_rev_3"><a id="GUID-77C2B092-4BEB-4BAC-91F9-7368EA16A2B6" name="GUID-77C2B092-4BEB-4BAC-91F9-7368EA16A2B6"></a><h3 id="BRADV-GUID-77C2B092-4BEB-4BAC-91F9-7368EA16A2B6" class="sect3"><span class="enumeration_section">20.3</span>使用备份控制文件执行恢复</h3>
               <div>
                  <p>当所有当前控制文件都丢失时，您必须还原备份控制文件。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="rman-recovery-advanced.html#GUID-7B78C0E8-423A-4BE0-88D5-AB903DB49608" title="如果当前控制文件的所有副本都丢失或损坏，则必须还原并装入备份控制文件。然后，您必须运行RECOVER命令，即使没有还原数据文件，也可以使用RESETLOGS选项打开数据库。">关于使用备份控制文件进行恢复</a></p>
                     </li>
                     <li>
                        <p><a href="rman-recovery-advanced.html#GUID-927C5614-DC12-4B58-B261-EBD5F08A4202" title="使用备份控制文件恢复数据库，如果未使用恢复目录，则需要从自动备份还原控制文件。">使用备份控制文件和无恢复目录执行恢复</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV89834"></a><div class="props_rev_3"><a id="GUID-7B78C0E8-423A-4BE0-88D5-AB903DB49608" name="GUID-7B78C0E8-423A-4BE0-88D5-AB903DB49608"></a><h4 id="BRADV-GUID-7B78C0E8-423A-4BE0-88D5-AB903DB49608" class="sect4"><span class="enumeration_section">20.3.1</span>关于使用备份控制文件进行恢复</h4>
                  <div>
                     <p>如果当前控制文件的所有副本都丢失或损坏，则必须还原并装入备份控制文件。然后，您必须运行<code class="codeph">RECOVER</code>命令，即使没有还原数据文件，也可以使用<code class="codeph">RESETLOGS</code>选项打开数据库。
                     </p>
                     <p>在恢复期间，RMAN会自动搜索未记录在RMAN存储库中的联机和归档日志，并对其找到的任何目录进行编目。RMAN尝试使用当前日志格式在任何当前归档目标中查找有效的归档重做日志。当前格式在用于启动实例的初始化参数文件（或Oracle RAC配置中的所有实例）中指定。同样，RMAN尝试使用控制文件中列出的文件名来查找联机重做日志。</p>
                     <p>如果在恢复期间更改了归档目标或格式，或者在备份控制文件后添加了新的联机日志成员，则RMAN可能无法自动编录所需的联机或归档日志。只要RMAN无法找到联机重做日志并且您未指定<code class="codeph">UNTIL</code>时间，RMAN就会报告类似于以下内容的错误：</p><pre class="oac_no_warn" dir="ltr">RMAN-00571：============================================== ============= RMAN-00569：===============错误信息堆栈跟踪============== = RMAN-00571：============================================= ============== RMAN-03002：恢复命令失败于08/29/2013 14:23:09 RMAN-06054：媒体恢复请求未知日志：thread 1 scn 86945</pre><p>在这种情况下，必须使用<code class="codeph">CATALOG</code>命令手动将所需的重做日志添加到存储库，以便可以继续进行恢复。
                     </p>
                     <div class="infoboxnote" id="GUID-7B78C0E8-423A-4BE0-88D5-AB903DB49608__GUID-4A57B8F8-D63B-41C6-8988-A530E79810CC">
                        <p class="notep1">注意：</p>
                        <p>但是，如果当前控制文件的某些副本可用，则可以按照<span class="q">“ <a href="user-managed-recovery-advanced.html#GUID-22AD5382-06ED-4FDF-BDD4-C8CD682F83E0">响应当前控制文件的子集丢失</a> ”中</span>的过程进行操作，并避免恢复和<code class="codeph">RESETLOGS</code>操作。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-7B78C0E8-423A-4BE0-88D5-AB903DB49608__GUID-7B4AEE7B-AFC2-4270-9FE2-89B78BD8312C">
                        <p class="notep1">也可以看看：</p>
                        <p>的讨论<code class="codeph">RESTORE CONTROLFILE</code>在<a href="../rcmrf/RESTORE.html#RCMRF149" target="_blank"><span><cite>Oracle数据库的备份和恢复参考</cite></span></a>有关使用限制的详细细节<code class="codeph">RESTORE CONTROLFILE</code>在不同的场景（例如，使用恢复目录时，或从一个特定的备份中恢复）</p>
                     </div>
                  </div><a id="BRADV89835"></a><div class="props_rev_3"><a id="GUID-64F583E8-2E1A-4F13-847B-5FCEFA9E008A" name="GUID-64F583E8-2E1A-4F13-847B-5FCEFA9E008A"></a><h5 id="BRADV-GUID-64F583E8-2E1A-4F13-847B-5FCEFA9E008A" class="sect5"><span class="enumeration_section">20.3.1.1</span>关于RMAN还原期间的控制文件位置</h5>
                     <div>
                        <p>还原控制文件时，默认目标是<code class="codeph">CONTROL_FILES</code>初始化参数中定义的所有位置。如果未设置<code class="codeph">CONTROL_FILES</code>初始化参数，则数据库使用相同的规则来确定在未设置<code class="codeph">CONTROL_FILES</code>参数时创建控制文件时它使用的还原控制文件的目标。
                        </p>
                        <p>将控制文件还原到一个或多个新位置的一种方法是更改<code class="codeph">CONTROL_FILES</code>初始化参数，然后使用不带参数的<code class="codeph">RESTORE CONTROLFILE</code>命令将控制文件还原到默认位置。例如，如果在磁盘发生故障后恢复控制文件，但某些但不是所有<code class="codeph">CONTROL_FILES</code>位置都不可用，则可以更改<code class="codeph">CONTROL_FILES</code>以使用指向另一个磁盘的路径名替换对故障磁盘的引用，然后运行不带参数的<code class="codeph">RESTORE CONTROLFILE</code> 。
                        </p>
                        <p>您还可以还原控制文件到您选择以外的任何位置<code class="codeph">CONTROL_FILES</code>位置，通过形式<code class="codeph">RESTORE CONTROLFILE TO ' <span class="codeinlineitalic">filename</span> '</code> ：</p><pre class="oac_no_warn" dir="ltr">将CONTROLFILE恢复为'/ tmp / my_controlfile';</pre><p>您可以在<code class="codeph">NOMOUNT</code> ， <code class="codeph">MOUNT</code>或<code class="codeph">OPEN</code>状态下对数据库执行此操作，因为您不会覆盖当前正在使用的任何控制文件。任何名为<code class="codeph">' <span class="codeinlineitalic">filename</span> '</code>现有文件都将被覆盖。将控制文件还原到新位置后，可以更新<code class="codeph">CONTROL_FILES</code>初始化参数以包含新位置。
                        </p>
                        <div class="infoboxnotealso" id="GUID-64F583E8-2E1A-4F13-847B-5FCEFA9E008A__GUID-D28E208B-1670-4B52-AFA2-6A4D9153A519">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>“ <a href="../sqlrf/CREATE-CONTROLFILE.html#SQLRF01203" target="_blank"><span><cite>Oracle数据库SQL语言参考”</cite></span></a>中的<code class="codeph">CREATE CONTROLFILE</code>语句的说明，用于确定已还原控制文件的目标的规则</p>
                              </li>
                              <li>
                                 <p>适用于<code class="codeph">RESTORE CONTROLFILE</code>语法的<a href="../rcmrf/RESTORE.html#RCMRF149" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="BRADV365"></a><a id="BRADV89836"></a><div class="props_rev_3"><a id="GUID-FE57B2EA-428A-4408-BBB5-D9392D6B0F8B" name="GUID-FE57B2EA-428A-4408-BBB5-D9392D6B0F8B"></a><h5 id="BRADV-GUID-FE57B2EA-428A-4408-BBB5-D9392D6B0F8B" class="sect5"><span class="enumeration_section">20.3.1.2</span>关于使用和不使用恢复目录的RMAN恢复</h5>
                     <div>
                        <p>恢复控制文件的过程取决于是否使用了恢复目录。</p>
                        <p>当RMAN连接到恢复目录时，具有备份控制文件的恢复过程与使用当前控制文件的恢复相同。备份控制文件中缺少的RMAN元数据可从恢复目录中获得。唯一的例外是数据库名称在目录中不唯一，在这种情况下，必须在还原控制文件之前使用<code class="codeph">SET DBID</code>命令。
                        </p>
                        <p>如果您没有使用恢复目录，则必须从自动备份恢复控制文件。要从自动备份还原控制文件，数据库必须处于<code class="codeph">NOMOUNT</code>状态。您必须首先为数据库设置DBID，然后使用<code class="codeph">RESTORE CONTROLFILE FROM AUTOBACKUP</code>命令。
                        </p>
                        <div class="example" id="GUID-FE57B2EA-428A-4408-BBB5-D9392D6B0F8B__CHDBHDJD">
                           <p class="titleinexample">示例20-2设置DBID并从自动备份恢复控制文件</p>
                           <p>在此示例中，RMAN使用自动备份格式和DBID来确定控制文件自动备份的位置。如果找到一个，RMAN会将控制文件还原到<code class="codeph">CONTROL_FILES</code>初始化参数中列出的所有控制文件位置。
                           </p><pre class="oac_no_warn" dir="ltr">SET DBID 320066378;为设备类型磁盘运行{SET CONTROLFILE AUTOBACKUP格式为' <span class="italic">autobackup_format</span> ';从AUTOBACKUP恢复CONTROLFILE; }</pre><div class="infoboxnotealso" id="GUID-FE57B2EA-428A-4408-BBB5-D9392D6B0F8B__GUID-32787659-7CD3-492F-9608-62A17F77338F">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="rman-complete-database-recovery.html#GUID-34BB2E4B-B2FC-4701-BB65-BFED027DB865" title="建议您记录数据库的DBID。">确定数据库的DBID</a> ”</span>以了解如何确定您的DBID</p>
                                 </li>
                                 <li>
                                    <p>“ <a href="../rcmrf/CONFIGURE.html#RCMRF113" target="_blank"><span><cite>Oracle数据库备份和恢复参考”中“</cite></span></a> <code class="codeph">CONFIGURE</code> ”条目中的“ <code class="codeph">CONFIGURE CONTROLFILE AUTOBACKUP FORMAT</code> ”说明，了解如何确定自动备份格式的正确值</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="BRADV89837"></a><div class="props_rev_3"><a id="GUID-918B5EE1-DBE9-464E-B8F9-454E1F94136A" name="GUID-918B5EE1-DBE9-464E-B8F9-454E1F94136A"></a><h5 id="BRADV-GUID-918B5EE1-DBE9-464E-B8F9-454E1F94136A" class="sect5"><span class="enumeration_section">20.3.1.3</span>使用快速恢复区时关于RMAN恢复</h5>
                     <div>
                        <p>无论数据库是否使用快速恢复区域，恢复控制文件的命令都是相同的。</p>
                        <p>如果数据库使用快速恢复区域，则RMAN会通过交叉检查控制文件中记录的所有基于磁盘的备份和映像副本来更新从备份还原的控制文件。RMAN会对恢复区中未记录的任何备份进行编目。因此，还原的控制文件可以完整准确地记录恢复区中的所有备份以及备份时控制文件已知的任何其他备份。</p>
                        <p>恢复控制文件后，RMAN不会自动交叉检查磁带备份。如果使用磁带备份，则可以还原并装入控制文件，并可选择交叉检查磁带上的备份，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">CROSSCHECK BACKUP DEVICE TYPE sbt;</pre></div>
                  </div>
               </div><a id="BRADV366"></a><a id="BRADV89838"></a><div class="props_rev_3"><a id="GUID-927C5614-DC12-4B58-B261-EBD5F08A4202" name="GUID-927C5614-DC12-4B58-B261-EBD5F08A4202"></a><h4 id="BRADV-GUID-927C5614-DC12-4B58-B261-EBD5F08A4202" class="sect4"><span class="enumeration_section">20.3.2</span>使用备份控制文件和无恢复目录执行恢复</h4>
                  <div>
                     <p>使用备份控制文件恢复数据库，如果未使用恢复目录，则需要从自动备份还原控制文件。</p>
                     <div class="section">
                        <p>本节假定您具有控制文件的RMAN备份，但不使用恢复目录。它还假定您为目标数据库启用了控制文件自动备份功能，并可以恢复控制文件的自动备份。</p>
                        <p>由于自动备份使用众所周知的格式，因此即使RMAN没有可用的列表可用备份的存储库，也可以将其还原。您可以将自动备份还原到默认位置或新位置。RMAN自动将控制文件复制到所有<code class="codeph">CONTROL_FILES</code>位置。
                        </p>
                        <div class="infoboxnote" id="GUID-927C5614-DC12-4B58-B261-EBD5F08A4202__GUID-8697184C-FD28-4DD8-AACE-EA08B73F576D">
                           <p class="notep1">注意：</p>
                           <p>如果您知道包含控制文件（例如，从媒体经理或因为一块是在磁盘上）的备份片的名字，那么你可以使用指定作品名称<code class="codeph">RESTORE CONTROLFILE FROM ' <span class="codeinlineitalic">filename</span> '</code>命令。数据库记录警报日志中每个自动备份的位置。
                           </p>
                        </div>
                        <p>由于您未连接到恢复目录，因此RMAN存储库仅包含有关控制文件备份时可用备份的信息。如果您知道其他可用备份集或映像副本的位置，请使用<code class="codeph">CATALOG</code>命令将它们添加到控制文件RMAN存储库中。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p><span class="bold">要在<code class="codeph">NOCATALOG</code>模式下使用控制文件自动<code class="codeph">NOCATALOG</code>恢复数据库：</span></p>
                        <ol>
                           <li>
                              <p>启动RMAN并连接到目标数据库，如<span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。">使用RMAN建立数据库连接</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>启动目标数据库实例而不安装数据库。例如：</p><pre class="oac_no_warn" dir="ltr">启动NOMOUNT;</pre></li>
                           <li>
                              <p>使用<code class="codeph">SET DBID</code>命令<code class="codeph">SET DBID</code>目标数据库的数据库标识符。
                              </p>
                              <p>每当连接到目标数据库时，RMAN都会显示DBID。您还可以通过检查已保存的RMAN日志文件，查询目录或查看控制文件自动备份的文件名来获取它。例如，运行：</p><pre class="oac_no_warn" dir="ltr">SET DBID 676549873;</pre></li>
                           <li>
                              <p>编写RMAN命令文件以还原自动备份控制文件并执行恢复。</p>
                              <p>命令文件包含以下步骤：</p>
                              <ol type="a">
                                 <li>
                                    <p>（可选）指定RMAN在搜索要还原的控制文件自动备份时可以使用的最新备份时间戳。</p>
                                 </li>
                                 <li>
                                    <p>如果在创建控制文件自动备份时知道其他控制文件自动备份格式有效，则为恢复控制文件指定非默认格式。</p>
                                 </li>
                                 <li id="GUID-927C5614-DC12-4B58-B261-EBD5F08A4202__CHDIDAIJ">
                                    <p>如果<a href="glossary.html#GUID-2E48CE71-9547-4196-B715-5CE59033262E"><span class="xrefglossterm">SBT</span></a>通道创建了控制文件自动备份，则分配一个或多个SBT通道。由于没有可用的恢复目录，因此无法使用预配置的通道。
                                    </p>
                                 </li>
                                 <li>
                                    <p>恢复控制文件的自动备份，可选择设置RMAN可以搜索的最大后退天数以及它在搜索第一天时使用的初始序列号。</p>
                                 </li>
                                 <li>
                                    <p>如果您知道控制文件包含有关在其余恢复过程中对您有用的已配置通道的信息，则可以退出RMAN以清除步骤<a href="rman-recovery-advanced.html#GUID-927C5614-DC12-4B58-B261-EBD5F08A4202__CHDIDAIJ">4.c中</a>手动分配的通道。
                                    </p>
                                    <p>如果重新启动RMAN客户端并装入数据库，则可以使用这些已配置的通道。如果您不关心使用控制文件中的已配置通道，则只需安装数据库即可。</p>
                                 </li>
                                 <li>
                                    <p>此步骤取决于联机重做日志是否可用。无论日志是否可用，使用备份控制文件恢复后，始终需要<code class="codeph">OPEN RESETLOGS</code>选项。
                                    </p>
                                    <p>如果联机重做日志可用，则RMAN可以查找并应用这些日志。按照<span class="q">“ <a href="rman-complete-database-recovery.html#GUID-5E09344A-76D0-4188-A39D-CBA07F0B5C25" title="在完全恢复期间，RMAN将还原一个或多个数据文件，然后应用还原备份后生成的所有重做。">执行完整数据库恢复</a> ”中的说明</span>执行完整的还原和恢复。
                                    </p>
                                    <p>如果联机重做日志不可用，则按<span class="q">“ <a href="rman-performing-flashback-dbpitr.html#GUID-7D3EE2F7-77A2-4264-8875-CC0AEC64ABE0" title="RMAN DBPITR在目标恢复时间之前从备份还原数据库，然后使用增量备份和重做将数据库前滚到目标时间。您可以恢复到SCN，时间，日志序列号或还原点。Oracle建议您在重要时间创建还原点，以便在必要时使时间点恢复更易于管理。">执行数据库时间点恢复</a> ”中的说明</span>执行DBPITR。需要<code class="codeph">UNTIL</code>子句来指定在线重做日志的第一个SCN之前的恢复的目标时间，SCN或日志序列号（否则，RMAN会发出<code class="codeph">RMAN-6054</code>错误）。
                                    </p>
                                    <p>使用备份控制文件执行DBPITR时，在使用<code class="codeph">RESETLOGS</code>打开数据库之前，可以使用SQL * Plus以只读方式打开数据库，并根据需要运行查询以验证逻辑损坏的影响是否已被撤消。如果您对结果满意，则可以使用<code class="codeph">RESETLOGS</code>打开数据库。</p>
                                    <div class="infoboxnote" id="GUID-927C5614-DC12-4B58-B261-EBD5F08A4202__GUID-96220562-6887-4750-ACD6-8DD4C0E8211B">
                                       <p class="notep1">注意：</p>
                                       <p>指定日志序列时，如果最后创建的归档重做日志具有序列<span class="italic">n</span> ，则指定<code class="codeph">UNTIL SEQUENCE <span class="codeinlineitalic">n</span> +1</code>以便RMAN应用<span class="italic">n</span>然后停止。
                                       </p>
                                    </div>
                                 </li>
                              </ol>
                              <p>在以下示例中，联机重做日志文件已丢失，最新的归档重做日志序列号为13243。此示例显示如何还原控制文件自动备份并通过最新日志进行恢复。</p><pre class="oac_no_warn" dir="ltr">RUN {＃或者，设置控制文件的合格时间戳上限＃backups＃SET UNTIL TIME '09 / 10/2017 13:45:00'; ＃仅在需要时指定非默认自动备份格式#SET CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK＃TO'？/oradata/%F.bck'; ALLOCATE CHANNEL c1设备类型sbt PARMS'...'; ＃手动分配RESTORE CONTROLFILE来自AUTOBACKUP MAXSEQ 100＃从序列100开始并倒计时MAXDAYS 180; ＃从UNTIL TIME开始并搜索6个月ALTER DATABASE MOUNT; }＃现在使用在恢复的控制文件中配置的自动通道RESTORE DATABASE UNTIL SEQUENCE 13244;恢复数据库直到序列13244;</pre></li>
                           <li>
                              <p>如果恢复成功，则打开数据库并重置联机日志：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE OPEN RESETLOGS;</pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV156"></a><div class="props_rev_3"><a id="GUID-195E30B2-6077-446D-A255-089D3341268A" name="GUID-195E30B2-6077-446D-A255-089D3341268A"></a><h3 id="BRADV-GUID-195E30B2-6077-446D-A255-089D3341268A" class="sect3"><span class="enumeration_section">20.4</span>执行灾难恢复</h3>
               <div>
                  <p>灾难恢复包括在丢失整个目标数据库，恢复目录数据库，所有当前控制文件，所有联机重做日志文件和所有参数文件后恢复和恢复目标数据库。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="rman-recovery-advanced.html#GUID-DC3C8F0E-403C-4AE4-BCD9-17A0812B9D13" title="在使用RMAN执行灾难恢复之前，必须满足某些先决条件。">灾难恢复的先决条件</a></p>
                     </li>
                     <li>
                        <p><a href="rman-recovery-advanced.html#GUID-8A4F7C00-AA51-48DB-BEF7-FA16B132E1D9" title="假设运行数据库的Linux服务器已经损坏，无法修复。幸运的是，您将数据库备份到Oracle Secure Backup并使磁带可用。您可以使用这些备份来恢复数据库。">灾难发生后恢复数据库</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV89839"></a><div class="props_rev_3"><a id="GUID-DC3C8F0E-403C-4AE4-BCD9-17A0812B9D13" name="GUID-DC3C8F0E-403C-4AE4-BCD9-17A0812B9D13"></a><h4 id="BRADV-GUID-DC3C8F0E-403C-4AE4-BCD9-17A0812B9D13" class="sect4"><span class="enumeration_section">20.4.1</span>灾难恢复的先决条件</h4>
                  <div>
                     <p>在使用RMAN执行灾难恢复之前，必须满足某些先决条件。</p>
                     <p>您必须具备以下条件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>备份所有数据文件</p>
                        </li>
                        <li>
                           <p>在您要恢复的最旧备份的创建时间之后生成的所有归档重做日志</p>
                        </li>
                        <li>
                           <p>至少一个控制文件自动备份</p>
                        </li>
                        <li>
                           <p>数据库的DBID记录</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV367"></a><a id="BRADV89840"></a><div class="props_rev_3"><a id="GUID-8A4F7C00-AA51-48DB-BEF7-FA16B132E1D9" name="GUID-8A4F7C00-AA51-48DB-BEF7-FA16B132E1D9"></a><h4 id="BRADV-GUID-8A4F7C00-AA51-48DB-BEF7-FA16B132E1D9" class="sect4"><span class="enumeration_section">20.4.2</span>灾难后恢复数据库</h4>
                  <div>
                     <p>假设运行数据库的Linux服务器已经损坏，无法修复。幸运的是，您将数据库备份到Oracle Secure Backup并使磁带可用。您可以使用这些备份来恢复数据库。</p>
                     <div class="section">
                        <p>灾难恢复的过程类似于在<code class="codeph">NOCATALOG</code>模式下使用备份控制文件恢复数据库的过程。如果要将数据库还原到新主机，请查看<span class="q">“ <a href="rman-recovery-advanced.html#GUID-6B71E7DF-A2B6-44F5-A8D5-B184BB41A768" title="使用RESTORE和RECOVER命令还原新主机上的数据库。当您要执行灾难恢复过程的测试运行或将数据库永久移动到新主机时，在新主机上还原数据库非常有用。">在新主机上还原数据库</a> ”中</span>描述的注意事项。
                        </p>
                        <p>。该方案假设如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>Oracle数据库安装在新主机上。</p>
                           </li>
                           <li>
                              <p>您正在将数据库还原到具有与旧主机相同的目录结构的新Linux主机。</p>
                           </li>
                           <li>
                              <p>您有一个磁带驱动器包含所有数据文件的备份和通过日志1124的归档重做日志，以及控制文件和服务器参数文件的自动备份。</p>
                           </li>
                           <li>
                              <p>您不对数据库使用恢复目录。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8A4F7C00-AA51-48DB-BEF7-FA16B132E1D9__GUID-B3CF5EEF-9D36-4EB0-93CE-B05EB8307F58">要在新主机上恢复数据库：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ol>
                           <li>
                              <p>确保满足<span class="q">“ <a href="rman-recovery-advanced.html#GUID-DC3C8F0E-403C-4AE4-BCD9-17A0812B9D13" title="Certain prerequisites must be met before you perform disaster recovery using RMAN.">灾难恢复</a></span>的先决条件”中描述的<span class="q"><a href="rman-recovery-advanced.html#GUID-DC3C8F0E-403C-4AE4-BCD9-17A0812B9D13" title="在使用RMAN执行灾难恢复之前，必须满足某些先决条件。">先决条件</a></span> 。
                              </p>
                           </li>
                           <li>
                              <p>如果可能，请还原或重新创建所有相关的网络文件，例如<code class="codeph">tnsnames.ora</code>和<code class="codeph">listener.ora</code>以及密码文件。
                              </p>
                           </li>
                           <li>
                              <p>启动RMAN并连接到目标数据库实例，如<span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。">使用RMAN建立数据库连接</a> ”中所述</span> 。
                              </p>
                              <p>在此阶段，不存在初始化参数文件。如果已设置<code class="codeph">ORACLE_SID</code>和<code class="codeph">ORACLE_HOME</code> ，则可以使用操作系统身份验证以<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>身份进行连接。</p>
                           </li>
                           <li>
                              <p>使用<code class="codeph">SET</code> <code class="codeph">DBID</code>命令指定目标数据库的<code class="codeph">DBID</code> ，如<span class="q">“ <a href="rman-recovery-advanced.html#GUID-2B93E1AF-5ED1-4FAE-91BB-63362CADF7AD" title="RMAN可以将丢失的服务器参数文件还原到其默认位置或您选择的位置。与丢失控制文件不同，丢失服务器参数文件不会导致实例立即停止。实例可能会继续运行，但您必须将其关闭并在还原服务器参数文件后重新启动它。">恢复服务器参数文件</a> ”中所述</span> 。
                              </p>
                              <p>例如，输入以下命令：</p><pre class="oac_no_warn" dir="ltr">SET DBID 676549873;</pre></li>
                           <li>
                              <p>运行<code class="codeph">STARTUP NOMOUNT</code>命令。
                              </p>
                              <p>当服务器参数文件不可用时，RMAN会尝试使用虚拟服务器参数文件启动实例。</p>
                           </li>
                           <li>
                              <p>将通道分配给介质管理器，然后从自动备份还原服务器参数文件。</p>
                              <p>例如，输入以下命令以从Oracle Secure Backup还原服务器参数文件：</p><pre class="oac_no_warn" dir="ltr">RUN {ALLOCATE CHANNEL c1 DEVICE TYPE sbt;从AUTOBACKUP恢复SPFILE; }</pre></li>
                           <li>
                              <p>使用还原的服务器参数文件重新启动实例。</p><pre class="oac_no_warn" dir="ltr">STARTUP FORCE NOMOUNT;</pre></li>
                           <li>
                              <p>编写命令文件以执行还原和恢复操作，然后执行命令文件。命令文件必须执行以下操作：</p>
                              <ol type="a">
                                 <li>
                                    <p>将频道分配给媒体管理器。</p>
                                 </li>
                                 <li>
                                    <p>还原控制文件自动备份（请参阅<span class="q">“ <a href="rman-recovery-advanced.html#GUID-927C5614-DC12-4B58-B261-EBD5F08A4202" title="使用备份控制文件恢复数据库，如果未使用恢复目录，则需要从自动备份还原控制文件。">使用备份控制文件和无恢复目录执行恢复</a> ”</span> ）。
                                    </p>
                                 </li>
                                 <li>
                                    <p>装入已还原的控制文件。</p>
                                 </li>
                                 <li>
                                    <p>使用<code class="codeph">CATALOG</code>命令编目未记录在存储库中的任何备份。
                                    </p>
                                 </li>
                                 <li>
                                    <p>将数据文件还原到其原始位置。如果卷名已更改，则在还原操作之前运行<code class="codeph">SET</code> <code class="codeph">NEWNAME</code>命令，并在还原操作后执行切换以使用数据文件的新位置更新控制文件，如以下示例所示。
                                    </p>
                                 </li>
                                 <li>
                                    <p>恢复数据文件。RMAN在达到指定的日志序列号时停止恢复。</p>
                                 </li>
                              </ol><pre class="oac_no_warn" dir="ltr">RMAN&gt; RUN {＃手动为媒体管理器分配一个频道ALLOCATE CHANNEL t1 DEVICE TYPE sbt; ＃恢复控制文件的自动备份。此示例假定您已接受＃自动备份名称的默认格式。从AUTOBACKUP恢复CONTROLFILE; ＃如果在最近的备份中数据库＃结构已更改，并且您希望＃recover恢复到该时间点，则使用set until命令。通过这种方式，RMAN将数据库＃恢复到数据库在指定时间具有的相同结构。ALTER DATABASE MOUNT;设置直到序列1124线程1; RESTORE DATABASE;恢复数据库; }</pre><p>以下<code class="codeph">RUN</code>命令示例显示了相同的方案，但恢复的数据文件的新文件名除外：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; RUN {＃如果您必须将文件恢复到新位置，＃使用SET NEWNAME命令：将DATAFILE 1的SET NEWNAME设置为'/ dev / vgd_1_0 / rlvt5_500M_1';将DATAFILE 2的NEWNAME设置为'/ dev / vgd_1_0 / rlvt5_500M_2';将DATAFILE 3的NEWNAME设置为'/ dev / vgd_1_0 / rlvt5_500M_3'; ALLOCATE CHANNEL t1 DEVICE TYPE sbt;从AUTOBACKUP恢复CONTROLFILE; ALTER DATABASE MOUNT; SET UNTIL SEQUENCE 124 THREAD 1; RESTORE DATABASE; SWITCH DATAFILE ALL; ＃使用数据文件的新位置更新控制文件。恢复数据库; }</pre></li>
                           <li>
                              <p>如果恢复成功，则打开数据库并重置联机日志：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE OPEN RESETLOGS;</pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV908"></a><div class="props_rev_3"><a id="GUID-6B71E7DF-A2B6-44F5-A8D5-B184BB41A768" name="GUID-6B71E7DF-A2B6-44F5-A8D5-B184BB41A768"></a><h3 id="BRADV-GUID-6B71E7DF-A2B6-44F5-A8D5-B184BB41A768" class="sect3"><span class="enumeration_section">20.5</span>在新主机上恢复数据库</h3>
               <div>
                  <p>使用<code class="codeph">RESTORE</code>和<code class="codeph">RECOVER</code>命令还原新主机上的数据库。当您要执行灾难恢复过程的测试运行或将数据库永久移动到新主机时，在新主机上还原数据库非常有用。
                  </p>
                  <p>如果使用本节中的过程，则还原的数据库的DBID与原始数据库的DBID相同。不要将以这种方式创建的测试数据库注册到与源数据库相同的恢复目录中。由于两个数据库的DBID相同，因此测试数据库的元数据可能会干扰RMAN恢复和恢复源数据库的能力。</p>
                  <p>如果您的目标是创建目标数据库的副本以便在新主机上继续使用，则使用RMAN <code class="codeph">DUPLICATE</code>命令而不是此过程。<code class="codeph">DUPLICATE</code>命令将新DBID分配给它创建的数据库，使其能够在与原始数据库相同的恢复目录中注册。
                  </p>
                  <p><span class="bold">要在新主机上还原数据库：</span></p>
                  <ol>
                     <li>
                        <p>完成还原数据库之前必须执行的步骤，如<span class="q">“ <a href="rman-recovery-advanced.html#GUID-0EE8068A-5D2F-41FF-BDB9-DEEC8CBCCDB9" title="必须执行某些步骤以准备在新主机上恢复数据库。">准备在新主机上还原数据库</a> ”中所述</span> 。
                        </p>
                     </li>
                     <li>
                        <p>将目标数据库备份传输到新主机并还原备份，如<span class="q">“将<a href="rman-recovery-advanced.html#GUID-6A176AA2-5E35-4F3D-A125-E7C32A1D672A" title="要使用磁盘上的数据文件副本或备份集将数据库移动到新主机，必须手动将文件传输到新主机。此过程假定RMAN正在使用恢复目录。">磁盘备份还原到新主机</a> ”中所述</span> 。
                        </p>
                     </li>
                  </ol>
                  <div class="infoboxnotealso" id="GUID-6B71E7DF-A2B6-44F5-A8D5-B184BB41A768__GUID-6FEE8087-73E4-4318-A4BC-5407AAE99C6E">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="rman-recovery-advanced.html#GUID-23B34A02-C9D0-4C83-A0C8-C9B5446D5555" title="建议您测试是否可以将数据库还原到新主机。">测试新主机上的数据库还原</a></p>
                  </div>
               </div><a id="BRADV89831"></a><div class="props_rev_3"><a id="GUID-0EE8068A-5D2F-41FF-BDB9-DEEC8CBCCDB9" name="GUID-0EE8068A-5D2F-41FF-BDB9-DEEC8CBCCDB9"></a><h4 id="BRADV-GUID-0EE8068A-5D2F-41FF-BDB9-DEEC8CBCCDB9" class="sect4"><span class="enumeration_section">20.5.1</span>准备在新主机上还原数据库</h4>
                  <div>
                     <p>必须执行某些步骤以准备在新主机上恢复数据库。</p>
                     <div class="section">
                        <p>步骤包括以下内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>记录源数据库的DBID。</p>
                           </li>
                           <li>
                              <p>使新数据库上的源数据库初始化参数文件可访问。使用操作系统实用程序将文件从旧主机复制到新主机。</p>
                           </li>
                           <li>
                              <p>如果仅执行测试还原操作，请确保RMAN <span class="italic">未</span>连接到恢复目录。否则，RMAN会在恢复目录中记录有关已还原数据文件的元数据。此元数据会干扰将来恢复和恢复主数据库的尝试。
                              </p>
                              <p>如果必须使用恢复目录，因为控制文件不够大，无法在必须还原的所有备份上包含RMAN存储库数据，请使用Oracle Data Pump导出目录并将其导入到其他模式或数据库中。然后，使用复制的恢复目录进行测试还原。否则，恢复目录会将已还原的数据库视为当前目标数据库。</p>
                           </li>
                           <li>
                              <p>确保可以在还原主机上访问用于还原操作的备份。例如，如果备份是使用介质管理器进行的，则验证磁带设备是否已连接到新主机。如果您使用的是磁盘副本，请使用以下部分中的过程。</p>
                           </li>
                           <li>
                              <p>如果要对生产数据库执行试验性还原，请在测试环境中还原数据库之前执行以下任一操作：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果测试数据库将使用与生产数据库使用的恢复区域物理上<span class="italic">不同</span>的快速恢复区域，则将测试数据库实例中的<code class="codeph">DB_RECOVERY_FILE_DEST</code>设置为新位置。
                                    </p>
                                 </li>
                                 <li>
                                    <p>如果测试数据库将使用与生产数据库使用的恢复区域在物理上<span class="italic">相同</span>的快速恢复区域，则将测试数据库实例中的<code class="codeph">DB_UNIQUE_NAME</code>设置为与生产数据库不同的名称。
                                    </p>
                                 </li>
                              </ul>
                              <p>如果您不执行上述任一操作，则RMAN会假定您正在还原生产数据库并从快速恢复区域中删除闪回日志，因为它们被视为不可用。</p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-0EE8068A-5D2F-41FF-BDB9-DEEC8CBCCDB9__GUID-F2C04D83-1034-4335-AB6E-C26BDF17E42A">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="rman-complete-database-recovery.html#GUID-34BB2E4B-B2FC-4701-BB65-BFED027DB865" title="建议您记录数据库的DBID。">确定数据库的DBID</a> ”</span>以了解如何确定数据库的DBID</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV368"></a><a id="BRADV89832"></a><div class="props_rev_3"><a id="GUID-6A176AA2-5E35-4F3D-A125-E7C32A1D672A" name="GUID-6A176AA2-5E35-4F3D-A125-E7C32A1D672A"></a><h4 id="BRADV-GUID-6A176AA2-5E35-4F3D-A125-E7C32A1D672A" class="sect4"><span class="enumeration_section">20.5.2将</span>磁盘备份还原到新主机</h4>
                  <div>
                     <p>要使用磁盘上的数据文件副本或备份集将数据库移动到新主机，必须手动将文件传输到新主机。此过程假定RMAN正在使用恢复目录。</p>
                     <div class="section">
                        <p><span class="bold">要将备份文件还原到新主机：</span></p>
                        <ol>
                           <li>
                              <p>启动RMAN并连接到目标数据库和恢复目录，如<span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。">使用RMAN建立数据库连接</a> ”中所述</span> 。
                              </p>
                           </li>
                           <li>
                              <p>运行<code class="codeph">LIST</code>命令以查看数据文件和控制文件自动备份的备份列表。
                              </p>
                              <p>例如，输入以下命令以查看数据文件副本：</p><pre class="oac_no_warn" dir="ltr">列表复制;</pre><p>例如，输入以下命令以查看控制文件备份：</p><pre class="oac_no_warn" dir="ltr">控制文件的列表备份;</pre><p>自动备份的片段名称必须使用<code class="codeph">%F</code>替换变量，因此自动备份片段名称包含字符串<code class="codeph">c-IIIIIIIIII-YYYYMMDD-QQ</code> ，其中<code class="codeph">IIIIIIIIII</code>代表DBID， <code class="codeph">YYYYMMDD</code>是当天格里高利历中的时间戳。生成备份， <code class="codeph">QQ</code>是十六进制的序列。
                              </p>
                           </li>
                           <li>
                              <p>使用操作系统实用程序将备份复制到新主机。</p>
                              <p>输入如下命令将所有数据文件副本复制到<code class="codeph">?新主机上的/oradata/trgt</code>目录：</p><pre class="oac_no_warn" dir="ltr">％cp -r / disk1 / * dbf / net / new_host / oracle / oradata / trgt</pre><p>输入如下命令将自动备份备份片段复制到新主机上的<code class="codeph">/tmp</code>目录：</p><pre class="oac_no_warn" dir="ltr">％cp -r / disk1 / auto_bkp_loc / c-1618370911-20130208-00 / net / new_host / tmp</pre><p>从非默认位置还原自动备份时，必须使用<code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code>命令。
                              </p>
                           </li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-6A176AA2-5E35-4F3D-A125-E7C32A1D672A__GUID-06AEB6F1-581E-4310-9B64-CCAEF078008C">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="rman-recovery-advanced.html#GUID-8077F97F-76A7-49DC-8C1E-5FE8ADD0914F" title="如果已配置控制文件自动备份，则只要执行自动备份，就会使用控制文件备份服务器参数文件。">从控制文件自动备份恢复服务器参数文件</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV369"></a><a id="BRADV89833"></a><div class="props_rev_3"><a id="GUID-23B34A02-C9D0-4C83-A0C8-C9B5446D5555" name="GUID-23B34A02-C9D0-4C83-A0C8-C9B5446D5555"></a><h4 id="BRADV-GUID-23B34A02-C9D0-4C83-A0C8-C9B5446D5555" class="sect4"><span class="enumeration_section">20.5.3</span>在新主机上测试数据库的还原</h4>
                  <div>
                     <p>建议您测试是否可以将数据库还原到新主机。</p>
                     <div class="section">
                        <p>在这种情况下，您有两个联网的Linux主机， <code class="codeph">hosta</code>和<code class="codeph">hostb</code> 。目标数据库命名<code class="codeph">trgta</code>是<code class="codeph">hosta</code> ，并在恢复目录中注册<code class="codeph">catdb</code> 。你想测试还原和恢复<code class="codeph">trgta</code>在<code class="codeph">hostb</code> ，同时保持数据库<code class="codeph">trgta</code>并运行<code class="codeph">hosta</code> 。
                        </p>
                        <p>现在，假设的目录结构<code class="codeph">hostb</code>是不同的<code class="codeph">hosta</code> 。目标数据库位于<code class="codeph">/net/hosta/dev3/oracle/dbs</code> ，但您希望将数据库还原到<code class="codeph">/net/hostb/oracle/oradata/test</code> 。您可以在两台主机均可访问的介质管理器上对数据文件，控制文件，归档重做日志和服务器参数文件进行磁带备份。<code class="codeph">TRGTA</code>数据库的<code class="codeph">ORACLE_SID</code>是<code class="codeph">TRGTA</code> ，并且不会更改已还原的数据库。
                        </p>
                        <div class="infoboxnote" id="GUID-23B34A02-C9D0-4C83-A0C8-C9B5446D5555__GUID-0049ABAB-7529-4C00-AAFB-F14052BFF244">
                           <p class="notep1">警告：</p>
                           <p>如果要还原数据库以进行测试，则<span class="italic">永远不要</span>将RMAN连接到测试数据库和恢复目录。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p><span class="bold">要在新主机上还原数据库：</span></p>
                        <ol>
                           <li>
                              <p>确保可以在新主机上访问目标数据库的备份。</p>
                              <p>要测试灾难恢复，您必须具有目标数据库的可恢复备份。准备灾难恢复策略时，请确保数据文件，控制文件和服务器参数文件的备份可在<code class="codeph">hostb</code>上恢复。因此，您必须配置媒体管理软件，以便<code class="codeph">hostb</code>是媒体管理器客户端，并且可以读取在<code class="codeph">hosta</code>创建的备份集。有关此问题的支持，请咨询媒体管理供应商。
                              </p>
                           </li>
                           <li>
                              <p>在<code class="codeph">hostb</code>上配置<code class="codeph">ORACLE_SID</code> 。
                              </p>
                              <p>此方案假定您要在<code class="codeph">hostb</code>上启动RMAN客户端并通过操作系统对自己进行身份验证。但是，您必须在本地或通过网络服务名称连接到<code class="codeph">hostb</code> 。
                              </p>
                              <p>以管理员权限登录<code class="codeph">hostb</code>后，编辑<code class="codeph">/etc/group</code>文件，以便包含在DBA组中：</p><pre class="oac_no_warn" dir="ltr">DBA：*：614：&lt;your_user_name&gt;</pre><p>设置<code class="codeph">ORACLE_SID</code>的环境变量<code class="codeph">hostb</code>就使用了相同的值<code class="codeph">hosta</code> ：</p><pre class="oac_no_warn" dir="ltr">％setenv ORACLE_SID trgta</pre></li>
                           <li>
                              <p>在<code class="codeph">hostb</code>上启动RMAN并连接到目标数据库， <span class="italic">而不</span>连接到恢复目录。
                              </p>
                              <p>例如，输入以下命令：</p><pre class="oac_no_warn" dir="ltr">％rman NOCATALOG RMAN&gt; CONNECT TARGET /</pre></li>
                           <li>
                              <p>设置DBID并启动数据库实例而不安装数据库。</p>
                              <p>例如，运行<code class="codeph">SET</code> <code class="codeph">DBID</code>来设置DBID，然后运行<code class="codeph">STARTUP</code> <code class="codeph">NOMOUNT</code> ：</p><pre class="oac_no_warn" dir="ltr">SET DBID 1340752057;启动NOMOUNT</pre><p>RMAN无法找到尚未还原的服务器参数文件，但是使用“虚拟”文件启动实例。示例输出如下：</p><pre class="oac_no_warn" dir="ltr">启动失败：ORA-01078：处理系统参数失败LRM-00109：无法打开参数文件'/net/hostb/oracle/dbs/inittrgta.ora'尝试启动没有参数文件的Oracle实例...Oracle实例启动了</pre></li>
                           <li>
                              <p>恢复并编辑服务器参数文件。</p>
                              <p>由于您在进行备份时启用了控制文件自动备份功能，因此服务器参数文件包含在备份中。如果要还原具有非默认格式的自动备份，请使用<code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code>命令指示格式。
                              </p>
                              <p>将通道分配给介质管理器，然后将服务器参数文件还原为客户端参数文件，并使用<code class="codeph">SET</code>命令指示自动备份的位置（在此示例中，自动备份位于<code class="codeph">/tmp</code> ）：</p><pre class="oac_no_warn" dir="ltr">运行{ALLOCATE CHANNEL c1设备类型sbt PARMS'...“;设备类型磁盘的SET CONTROLFILE AUTOBACKUP格式为'/ tmp /％F';恢复SPFILE到PFILE'？/oradata/test/inittrgta.ora'from AUTOBACKUP;关闭中止; }</pre></li>
                           <li>
                              <p>编辑已还原的初始化参数文件。</p>
                              <p>更改任何特定于位置的参数，例如，以<code class="codeph">_DEST</code>结尾的参数，以反映新的目录结构。例如，编辑以下参数：</p><pre class="oac_no_warn" dir="ltr">-  IFILE  -  LOG_ARCHIVE_DEST_1  -  CONTROL_FILES</pre></li>
                           <li>
                              <p>使用编辑的初始化参数文件重新启动实例。</p>
                              <p>例如，输入以下命令：</p><pre class="oac_no_warn" dir="ltr">STARTUP FORCE NOMOUNT PFILE ='？/oradata/test/inittrgta.ora';</pre></li>
                           <li>
                              <p>从自动备份还原控制文件，然后装入数据库。</p>
                              <p>例如，输入以下命令：</p><pre class="oac_no_warn" dir="ltr">运行{ALLOCATE CHANNEL c1设备类型sbt PARMS'...“;从AUTOBACKUP恢复CONTROLFILE; ALTER DATABASE MOUNT; }</pre><p>RMAN将控制文件还原到您在<code class="codeph">CONTROL_FILES</code>初始化参数中指定的任何位置。
                              </p>
                           </li>
                           <li>
                              <p>使用新文件名或<code class="codeph">CATALOG START</code> <code class="codeph">WITH</code>将您在<span class="q">“将<a href="rman-recovery-advanced.html#GUID-6A176AA2-5E35-4F3D-A125-E7C32A1D672A" title="要使用磁盘上的数据文件副本或备份集将数据库移动到新主机，必须手动将文件传输到新主机。此过程假定RMAN正在使用恢复目录。">磁盘备份还原到新主机</a> ”中</span>复制的数据文件副本编目（如果您知道所有文件都在具有公共前缀的目录中，可以使用<code class="codeph">CATALOG START WITH</code>命令轻松解决）。例如，运行：</p><pre class="oac_no_warn" dir="ltr">CATALOG START WITH'/ oracle / oradata / trgt /';</pre><p>如果要单独指定文件，则可以执行<code class="codeph">CATALOG</code>命令，如下所示：</p><pre class="oac_no_warn" dir="ltr">CATALOG DATAFILECOPY'/oracle/oradata/trgt/system01.dbf'，'/ oracle / oradata / strgt / undotbs01.dbf'，'/ oracle / oradata / trgt / cwmlite01.dbf'，'/ oracle / oradata / trgt / drsys01 .dbf'，'/ oracle / oradata / strgt / example01.dbf'，'/ oracle / oradata / strgt / indx01.dbf'，'/ oracle / oradata / trgt / tools01.dbf'，'/ oracle / oradata / trgt /users01.dbf';</pre></li>
                           <li>
                              <p>在新数据库上启动SQL * Plus会话，并查询控制文件中记录的数据库文件名。</p>
                              <p>由于控制文件来自<code class="codeph">trgta</code>数据库，因此录制的文件名使用原始的<code class="codeph">hosta</code>文件名。您可以查询<code class="codeph">V$</code>视图以获取此信息。在SQL * Plus中运行以下查询：</p><pre class="oac_no_warn" dir="ltr">列名称格式a60 SPOOL LOG'/ tmp / db_filenames.out'选择文件#AS“文件/ Grp＃”，名称来自V $ DATAFILE UNION SELECT GROUP＃，成员来自V $ LOGFILE; SPOOL OFF EXIT</pre></li>
                           <li>
                              <p>编写RMAN还原和恢复脚本。该脚本必须包含以下步骤：</p>
                              <ol type="a">
                                 <li>
                                    <p>对于还原到与源主机上的路径不同的目标主机上的每个数据文件，请使用<code class="codeph">SET</code> <code class="codeph">NEWNAME</code>命令在目标主机上指定新路径。如果目标系统上的文件系统设置为与源主机具有相同的路径，则不要将<code class="codeph">SET NEWNAME</code>用于恢复到与源主机上相同路径的文件。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于要在与源主机上的位置不同的位置创建的每个联机重做日志，请使用SQL <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">RENAME</code> <code class="codeph">FILE</code>命令指定目标主机上的路径名。如果目标系统上的文件系统设置为与源主机具有相同的路径，则不要将<code class="codeph">ALTER DATABASE RENAME FILE</code>用于恢复到与源主机上相同路径的文件。
                                    </p>
                                 </li>
                                 <li>
                                    <p>执行<code class="codeph">SET UNTIL</code>操作以将恢复限制到归档重做日志的末尾。如果未指定<code class="codeph">SET UNTIL</code>命令，则恢复将停止并显示错误。
                                    </p>
                                 </li>
                                 <li>
                                    <p>还原并恢复数据库。</p>
                                 </li>
                                 <li>
                                    <p>运行<code class="codeph">SWITCH DATAFILE ALL</code>命令，以便控制文件将新路径名识别为数据文件的官方新名称。
                                    </p>
                                 </li>
                              </ol>
                              <p>以下代码显示了可以执行还原和恢复操作的RMAN脚本<code class="codeph">reco_test.rman</code> 。
                              </p><pre class="oac_no_warn" dir="ltr">RUN {＃将通道分配给磁带设备ALLOCATE CHANNEL c1 DEVICE TYPE sbt PARMS'...“; ＃重命名数据文件和在线重做日志SET NEWNAME FOR DATAFILE 1 TO'？/oradata/test/system01.dbf';为数据文件2设置NEWNAME''？/oradata/test/undotbs01.dbf';为数据文件设置NEWNAME 3'？/oradata/test/cwmlite01.dbf';为数据文件设置NEWNAME 4'？/oradata/test/drsys01.dbf';为数据文件设置NEWNAME 5'？/oradata/test/example01.dbf';为数据文件设置NEWNAME 6到'？/oradata/test/indx01.dbf';设置数据文件7的NEWNAME到'？/oradata/test/tools01.dbf';设置数据文件8的NEWNAME到'？/oradata/test/users01.dbf'; ALTER DATABASE RENAME FILE'/dev3/oracle/dbs/redo01.log'TO'？/oradata/test/redo01.log'; ALTER DATABASE RENAME FILE'/dev3/oracle/dbs/redo02.log'TO'？/oradata/test/redo02.log'; ＃执行SET UNTIL以防止恢复在线日志SET UNTIL SCN 123456; ＃恢复数据库并切换数据文件名RESTORE DATABASE; SWITCH DATAFILE ALL; ＃recover数据库RECOVER DATABASE; } 出口</pre></li>
                           <li>
                              <p>执行上一步中创建的脚本。</p>
                              <p>例如，启动RMAN以连接到目标数据库并运行<code class="codeph">@</code>命令：</p><pre class="oac_no_warn" dir="ltr">％rman TARGET / NOCATALOG RMAN&gt; @ reco_test.rman</pre></li>
                           <li>
                              <p>使用<code class="codeph">RESETLOGS</code>选项打开已还原的数据库。
                              </p>
                              <p>在RMAN提示符下，使用<code class="codeph">RESETLOGS</code>选项打开数据库：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE OPEN RESETLOGS;</pre><div class="infoboxnote" id="GUID-23B34A02-C9D0-4C83-A0C8-C9B5446D5555__GUID-09A55798-F84C-496A-9832-AE6F616BD5C8">
                                 <p class="notep1">警告：</p>
                                 <p>在下一步中重新打开数据库时，请不要连接到恢复目录。否则，创建的新数据库化身将自动注册到恢复目录中，生产数据库的文件名将替换为脚本中指定的新文件名。</p>
                              </div>
                           </li>
                           <li>
                              <p>（可选）使用其所有文件删除测试数据库。</p>
                              <div class="infoboxnote" id="GUID-23B34A02-C9D0-4C83-A0C8-C9B5446D5555__GUID-1A519371-8FD3-4DC8-BFA0-03C3248C845C">
                                 <p class="notep1">注意：</p>
                                 <p>如果使用ASM磁盘组，则<code class="codeph">DROP DATABASE</code>命令是安全删除测试数据库文件的唯一方法。如果还原到非ASM存储，则还可以使用操作系统命令删除数据库。
                                 </p>
                              </div>
                              <p>使用<code class="codeph">DROP DATABASE</code>命令自动删除与数据库关联的所有文件。以下示例删除数据库文件：</p><pre class="oac_no_warn" dir="ltr">STARTUP FORCE NOMOUNT PFILE ='？/oradata/test/inittrgta.ora'; DROP DATABASE;</pre><p>由于在连接到恢复目录时未执行还原和恢复操作，因此恢复目录不包含任何已还原文件的记录或测试期间执行的过程。同样， <code class="codeph">trgta</code>数据库的控制文件完全不受测试的影响。</p>
                           </li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-23B34A02-C9D0-4C83-A0C8-C9B5446D5555__GUID-7C9C8A3D-E400-4A21-9E11-3BD91530C303">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。">使用RMAN建立数据库连接</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-759D9D57-D638-4557-BBCA-891E898CDC76" name="GUID-759D9D57-D638-4557-BBCA-891E898CDC76"></a><h3 id="BRADV-GUID-759D9D57-D638-4557-BBCA-891E898CDC76" class="sect3"><span class="enumeration_section">20.6</span>恢复使用较早版本的RMAN创建的备份</h3>
               <div>
                  <p>您可以还原使用旧版RMAN创建的备份，直至Oracle Database 9 <span class="italic">i</span> Release 2（9.2.0.8）。
                  </p>
                  <div class="section">在创建备份的Oracle数据库版本与要在其上运行还原的数据库的Oracle软件版本之间必须存在受支持的升级路径。</div>
                  <!-- class="section" -->
                  <div class="p">
                     <p>在此示例中，源数据库是Oracle Database <span class="italic">11g</span>第2版数据库，并配置为使用服务器参数文件（spfile）。数据库以<code class="codeph">ARCHIVELOG</code>模式运行，并使用快速恢复区域。还配置了控制文件自动备份。然后，您可以创建源数据库的RMAN备份，包括存档的重做日志。
                     </p>
                     <p>还原这些备份的目标主机安装了Oracle Database 12 <span class="italic">c</span>第1版。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-759D9D57-D638-4557-BBCA-891E898CDC76__GUID-97C91D3A-D4EA-4806-8F9E-27BB034EE661">要还原使用早于当前目标数据库版本的RMAN版本创建的RMAN备份：</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>验证从创建备份的数据库版本到计划还原数据库的Oracle服务器版本是否存在受支持的升级路径。</span><div>
                           <p>例如，如果您的RMAN备份是在Oracle Database 11g第2版（11.2.0.3）上创建的，并且您希望在Oracle Database 12 <span class="italic">c</span>第1版（12.1）上运行已还原的数据库，则必须验证是否存在受支持的升级路径从版本11.2.0.3到版本12.1。
                           </p>
                           <div class="infoboxnotealso" id="GUID-759D9D57-D638-4557-BBCA-891E898CDC76__GUID-43FDDB18-61A6-4F85-AFCB-79D3F2CF7F34">
                              <p class="notep1">也可以看看：</p>
                              <p>有关数据库升级路径的信息，请<a href="../upgrd/oracle-database-releases-that-support-direct-upgrade.html#UPGRD12358" target="_blank"><span class="italic">参见Oracle数据库升级指南</span></a></p>
                           </div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>确保源数据库备份在必须还原它们的目标主机上可用。</span><div>您可以使用操作系统实用程序将备份复制到目标主机，也可以将备份存储在目标主机可访问的共享位置。</div>
                     </li>
                     <li class="stepexpand"><span>关闭目标数据库。</span></li>
                     <li class="stepexpand"><span>在目标主机上，将<code class="codeph">ORACLE_SID</code>设置为源数据库上使用的相同值。</span><div><pre class="oac_no_warn" dir="ltr">％setenv ORACLE_SID db112</pre></div>
                     </li>
                     <li class="stepexpand"><span>在目标主机上启动RMAN，并使用操作系统身份验证和没有恢复目录连接到目标数据库。</span><div><pre class="oac_no_warn" dir="ltr">％rman目标/ NOCATALOG</pre></div>
                     </li>
                     <li class="stepexpand"><span>将DBID设置为与源数据库相同的值。</span><div>
                           <p>以下命令将DBID设置为699892390，这是正在还原其备份的源数据库的DBID。</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;设置DBID 699892390;</pre></div>
                     </li>
                     <li class="stepexpand"><span>以nomount模式启动目标数据库。</span><div><pre class="oac_no_warn" dir="ltr">RMAN&gt; startup nomount;</pre><p>RMAN无法找到尚未还原的服务器参数文件。但是，实例以“虚拟”文件启动，并显示以下输出：</p><pre class="oac_no_warn" dir="ltr">启动失败：ORA-01078：处理系统参数失败LRM-00109：无法打开参数文件'/oracle/dbs/inittrgta.ora'尝试启动没有参数文件的Oracle实例...Oracle实例启动了</pre></div>
                     </li>
                     <li class="stepexpand"><span>从源数据库自动备份还原服务器参数文件。</span><div>
                           <p>由于在源数据库中启用了控制文件自动备份，因此服务器参数文件包含在备份中。要还原具有非默认格式的自动备份，请使用<code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code>命令指示格式。
                           </p>
                           <p>以下示例设置自动备份格式，将源数据库中的spfile还原到pfile <code class="codeph">/dev3/oracle/network/init_db112.ora</code> ，然后关闭目标数据库。
                           </p><pre class="oac_no_warn" dir="ltr">运行{设备类型磁盘的设置控制文件自动备份格式为'/scratch/fra/cf/%F.bck';从自动备份恢复区'/ scratch / fra / cf'db_name'DB112'将spfile恢复到pfile'/dev3/oracle/network/init_db112.ora';关机中止; }</pre></div>
                     </li>
                     <li class="stepexpand"><span>编辑已还原的初始化参数文件并修改所需的初始化参数。</span><div>
                           <p>如果目标数据库的兼容性要求与源数据库中设置的兼容性要求不同，则包括<code class="codeph">COMPATIBLE</code>参数，以及目标数据库版本中不推荐使用的参数。还要更新任何特定于位置的参数，例如以<code class="codeph">_DEST</code>结尾的参数，以反映新的目录结构。
                           </p>
                           <p>在此示例中，您必须编辑位于<code>/dev3/oracle/network/init_db112.ora</code>的pfile。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>使用编辑的初始化参数文件重新启动实例。</span><div>
                           <p>以下命令使用编辑的参数文件以nomount模式启动数据库实例。</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; startup force nomount pfile ='/ dev3 / oracle / network / init_db112.ora';</pre></div>
                     </li>
                     <li class="stepexpand"><span>从自动备份还原控制文件，然后装入数据库。</span><div>
                           <p>以下示例设置控制文件自动备份的格式，从自动备份还原控制文件，然后装入数据库。</p><pre class="oac_no_warn" dir="ltr">运行{设备类型磁盘的设置控制文件自动备份格式为'/scratch/fra/cf/%F.bck';从自动备份恢复区'/ scratch / fra / cf'db_name'DB112'恢复控制文件; alter database mount; }</pre><p>控制文件将还原到已编辑的初始化参数文件中<code class="codeph">CONTROL_FILES</code>初始化参数中指定的位置。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>目标主机数据库的目录数据文件副本可供目标主机使用。</span><div>
                           <p>如果所有文件都在具有公共前缀的<code class="codeph">CATALOG START WITH</code> ，则使用<code class="codeph">CATALOG START WITH</code>命令。如果要单独指定文件名，请使用<code class="codeph">CATALOG DATAFILECOPY</code>命令。
                           </p>
                           <p>在以下示例中，所有数据文件副本都存储在单个文件夹<code>/scratch/fra/DB112/backupset</code> ，因此我们使用<code class="codeph">CATALOG START WITH</code>命令。
                           </p><pre class="oac_no_warn" dir="ltr">RMAN&gt;目录以'/ scratch / fra / DB112 / backupset'开头;</pre></div>
                     </li>
                     <li class="stepexpand"><span>还原并恢复源数据库。</span><div>
                           <p>如果数据文件还原到与源数据库上的路径不同的路径，则必须使用<code class="codeph">SET NEWNAME</code>命令在目标主机上指定新路径。如果要在与源数据库上的位置不同的位置创建联机重做日志，请使用<code class="codeph">ALTER DATABASE RENAME FILE</code>命令指定目标数据库上每个重做日志文件的位置。
                           </p>
                           <p>在此示例中， <code class="codeph">SET NEWNAME FOR DATABASE</code>命令用于指定所有已还原数据文件的新位置。使用<code class="codeph">ALTER DATABASE RENAME FILE</code>命令指定每个联机重做日志文件的新位置。执行恢复直到命令中指定的SCN。
                           </p><pre class="oac_no_warn" dir="ltr">运行{将数据库的新名称设置为'/ ade / b / 1885631999 / oracle / dbs /％Uf'; alter database将文件'/dev1/oracle/dbs/redo01.log'重命名为'/dev3/oracle/dbs/redo1.log'; alter database将文件'/dev1/oracle/dbs/redo02.log'重命名为'/dev3/oracle/dbs/redo2.log';一直到scn 1092435;恢复数据库;切换数据文件全部;恢复数据库; }</pre></div>
                     </li>
                     <li class="stepexpand"><span>使用<code class="codeph">RESETLOGS</code>和<code class="codeph">UPGRADE</code>选项打开已还原的数据库。</span><div><pre class="oac_no_warn" dir="ltr">RMAN&gt; alter database open resetlogs upgrade;已处理语句RMAN-06900：警告：无法生成V $ RMAN_STATUS或V $ RMAN_OUTPUT行RMAN-06901：警告：禁用目标数据库中V $ RMAN_STATUS和V $ RMAN_OUTPUT行ORACLE错误的更新：ORA-04023：对象SYS。 STANDARD无法验证或授权</pre><p>该错误是由需要在升级过程中重新验证的数据库包引起的。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>退出RMAN。</span></li>
                     <li class="stepexpand"><span>通过执行升级数据库所需的步骤，将目标数据库升级到所需的Oracle版本。</span><div>
                           <div class="infoboxnotealso" id="GUID-759D9D57-D638-4557-BBCA-891E898CDC76__GUID-E09568CA-36DC-4E93-9CC5-9246346692D5">
                              <p class="notep1">也可以看看：</p>
                              <p>有关升级数据库的信息，请参见<a href="../upgrd/oracle-database-releases-that-support-direct-upgrade.html#UPGRD12358" target="_blank"><span class="italic">Oracle数据库升级指南</span></a></p>
                           </div>
                        </div>
                     </li>
                  </ol>
               </div>
            </div><a id="BRADV680"></a><div class="props_rev_3"><a id="GUID-8E64485B-3788-4389-A892-8C560F12443F" name="GUID-8E64485B-3788-4389-A892-8C560F12443F"></a><h3 id="BRADV-GUID-8E64485B-3788-4389-A892-8C560F12443F" class="sect3"><span class="enumeration_section">20.7</span>通过网络恢复和恢复文件</h3>
               <div>
                  <p>RMAN使您可以通过网络连接到包含所需文件的物理备用数据库来还原或恢复文件。您可以还原整个数据库，数据文件，控制文件，服务器参数文件或表空间。在需要同步主数据库和备用数据库的情况下，通过网络还原文件非常有用。</p>
                  <p>备份集用于通过网络还原或恢复文件。因此，您可以使用多节备份，加密和压缩来提高备份和还原性能。</p>
                  <p>从Oracle Database 12 <span class="italic">c</span>第1版（12.1）开始，支持通过网络还原和恢复文件。
                  </p>
                  <p>本节包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="rman-recovery-advanced.html#GUID-DF586DC2-A0F0-4EFD-AF8A-FC6C0B553C31" title="RMAN使用RESTORE命令的FROM SERVICE子句从物理备用数据库通过网络还原数据库文件。">关于通过网络还原文件</a></p>
                     </li>
                     <li>
                        <p><a href="rman-recovery-advanced.html#GUID-2ABBC0FC-D01E-4A1E-8FD6-9F04880D4E3F" title="您可以通过网络从主数据库获取增量备份，然后将此增量备份应用于物理备用数据库来执行恢复。">关于通过网络恢复文件</a></p>
                     </li>
                     <li>
                        <p><a href="rman-recovery-advanced.html#GUID-8466262D-9F86-431B-AA34-A7002A5498A1" title="在某些情况下，通过网络连接到物理备用数据库来恢复文件非常有用。">通过网络还原和恢复文件的方案</a></p>
                     </li>
                     <li>
                        <p><a href="rman-recovery-advanced.html#GUID-43FF41E9-81D2-41A5-B2E6-8E2E2CE91EDB" title="使用RESTORE命令通过网络连接到主数据库或物理备用数据库来还原丢失或损坏的数据文件。">通过网络恢复数据文件</a></p>
                     </li>
                     <li>
                        <p><a href="rman-recovery-advanced.html#GUID-93C8F7F1-E1FB-485D-ABC7-860757B24A98" title="RMAN通过创建增量备份来转发物理备用数据库，该增量备份包含对主数据库的更改，通过网络将增量备份传输到物理备用数据库，然后将增量备份应用于物理备用数据库。主数据库上的数据文件的所有更改（从备用数据文件头中的SCN开始）都包含在增量备份中。">使用RECOVER命令前滚物理备用数据库</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV681"></a><div class="props_rev_3"><a id="GUID-DF586DC2-A0F0-4EFD-AF8A-FC6C0B553C31" name="GUID-DF586DC2-A0F0-4EFD-AF8A-FC6C0B553C31"></a><h4 id="BRADV-GUID-DF586DC2-A0F0-4EFD-AF8A-FC6C0B553C31" class="sect4"><span class="enumeration_section">20.7.1</span>关于通过网络恢复文件</h4>
                  <div>
                     <p>RMAN使用<code class="codeph">RESTORE</code>命令的<code class="codeph">FROM SERVICE</code>子句从物理备用数据库通过网络还原数据库文件。
                     </p>
                     <p><code class="codeph">FROM SERVICE</code>子句提供必须从中还原文件的物理备用数据库的服务名称。在还原操作期间，RMAN在物理备用数据库上创建需要还原的文件的备份集，然后通过网络将这些备份集传输到目标数据库。
                     </p>
                     <p>使用<code class="codeph">RESTORE</code>命令的<code class="codeph">SECTION SIZE</code>子句执行多节还原操作。要加密在物理备用数据库上创建的备份集，请在<code class="codeph">RESTORE</code>命令之前使用<code class="codeph">SET ENCRYPTION</code>命令指定使用的加密算法。
                     </p>
                     <p>要将文件从物理备用数据库作为压缩备份集传输，请使用<code class="codeph">RESTORE</code>命令中的<code class="codeph">USING COMPRESSED BACKUPSET</code>子句。默认情况下，RMAN使用RMAN配置中设置的算法压缩备份集。您可以在<code class="codeph">RESTORE</code>语句之前使用<code class="codeph">SET COMPRESSION ALGORITHM</code>命令覆盖默认值并设置不同的算法。
                     </p>
                  </div>
               </div><a id="BRADV682"></a><div class="props_rev_3"><a id="GUID-2ABBC0FC-D01E-4A1E-8FD6-9F04880D4E3F" name="GUID-2ABBC0FC-D01E-4A1E-8FD6-9F04880D4E3F"></a><h4 id="BRADV-GUID-2ABBC0FC-D01E-4A1E-8FD6-9F04880D4E3F" class="sect4"><span class="enumeration_section">20.7.2</span>关于通过网络恢复文件</h4>
                  <div>
                     <p>您可以通过网络从主数据库获取增量备份，然后将此增量备份应用于物理备用数据库来执行恢复。</p>
                     <p>RMAN作为<code class="codeph">TARGET</code>连接到物理备用数据库。通过仅恢复数据文件中使用的数据块来优化恢复过程。使用<code class="codeph">FROM SERVICE</code>子句指定必须从中提取增量备份的主数据库的服务名称。
                     </p>
                     <p>要在恢复过程中使用多节备份集，请在<code class="codeph">RECOVER</code>命令中指定<code class="codeph">SECTION SIZE</code>子句。要将所需文件作为加密备份集从主数据库传输，请在<code class="codeph">RESTORE</code>命令之前使用<code class="codeph">SET ENCRYPTION</code>命令指定用于创建备份集的加密算法。
                     </p>
                     <p>要压缩用于通过网络恢复文件的备份集，请使用<code class="codeph">USING COMPRESSED BACKUPSET</code> 。 RMAN在主数据库上创建备份集时会压缩备份集，然后将这些备份集传输到目标数据库。
                     </p>
                  </div>
               </div><a id="BRADV683"></a><div class="props_rev_3"><a id="GUID-8466262D-9F86-431B-AA34-A7002A5498A1" name="GUID-8466262D-9F86-431B-AA34-A7002A5498A1"></a><h4 id="BRADV-GUID-8466262D-9F86-431B-AA34-A7002A5498A1" class="sect4"><span class="enumeration_section">20.7.3</span>通过网络恢复和恢复文件的方案</h4>
                  <div>
                     <p>在某些情况下，通过网络连接到物理备用数据库来恢复文件非常有用。</p>
                     <p>这些方案包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您需要前滚物理备用数据库以使其与主数据库同步。</p>
                           <p>在主数据库上创建最新更改的增量备份后，可以使用增量备份还原物理备用数据库。</p>
                        </li>
                        <li>
                           <p>您希望使用物理备用数据库上的相应文件还原主数据库上丢失的数据文件，控制文件或表空间。您还可以使用主数据库还原物理备用数据库上的文件。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV684"></a><div class="props_rev_3"><a id="GUID-43FF41E9-81D2-41A5-B2E6-8E2E2CE91EDB" name="GUID-43FF41E9-81D2-41A5-B2E6-8E2E2CE91EDB"></a><h4 id="BRADV-GUID-43FF41E9-81D2-41A5-B2E6-8E2E2CE91EDB" class="sect4"><span class="enumeration_section">20.7.4</span>通过网络恢复数据文件</h4>
                  <div>
                     <p>使用<code class="codeph">RESTORE</code>命令通过网络连接到主数据库或物理备用数据库来还原丢失或损坏的数据文件。
                     </p>
                     <div class="section">
                        <p>在这个例子中， <code class="codeph">DB_UNIQUE_NAME</code>主数据库的是<code class="codeph">MAIN</code>和<code class="codeph">DB_UNIQUE_NAME</code>物理备用数据库的是<code class="codeph">STANDBY</code> 。主数据库上的数据文件<code class="codeph">sales.dbf</code>已丢失。您希望从物理备用数据库还原此数据文件。物理备用数据库的服务名称是<code class="codeph">standby_tns</code> 。使用<code class="codeph">FROM SERVICE</code>子句的<code class="codeph">RESTORE</code>命令可以使用物理备用数据库中的数据文件还原主数据库中的丢失数据文件。主数据库和物理备用数据库中的密码文件是相同的。
                        </p>
                        <p>使用物理备用数据库中的数据文件，使用以下步骤还原主数据库中的数据文件<code class="codeph">sales.dbf</code> ：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以具有<code class="codeph">SYSBACKUP</code>权限的用户身份连接到主数据库。</span><div><pre class="oac_no_warn" dir="ltr">％RMAN RMAN&gt; CONNECT TARGET“sbu @ main AS SYSBACKUP”;</pre><p>出现提示时输入<code class="codeph">sbu</code>用户的密码。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>指定必须使用AES128加密算法对备份集进行加密</span><div><pre class="oac_no_warn" dir="ltr">RMAN&gt; SET ENCRYPTION ALGORITHM'AES128';</pre></div>
                        </li>
                        <li class="stepexpand"><span>确保物理备用数据库中的<code class="codeph">tnsnames.ora</code>文件包含与主数据库对应的条目。还要确保主数据库和物理备用数据库上的密码文件相同。</span></li>
                        <li class="stepexpand"><span>使用物理备用数据库上的数据文件还原主数据库上的数据文件。以下命令创建多节备份集以执行还原操作。</span><div><pre class="oac_no_warn" dir="ltr">RESTORE DATAFILE'/oradata/datafiles/sales.dbf'FRN SERVICE standby_tns SECTION SIZE 120M;</pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="BRADV685"></a><div class="props_rev_3"><a id="GUID-93C8F7F1-E1FB-485D-ABC7-860757B24A98" name="GUID-93C8F7F1-E1FB-485D-ABC7-860757B24A98"></a><h4 id="BRADV-GUID-93C8F7F1-E1FB-485D-ABC7-860757B24A98" class="sect4"><span class="enumeration_section">20.7.5</span>使用RECOVER命令前滚物理备用数据库</h4>
                  <div>
                     <p>RMAN通过创建增量备份来转发物理备用数据库，该增量备份包含对主数据库的更改，通过网络将增量备份传输到物理备用数据库，然后将增量备份应用于物理备用数据库。主数据库上的数据文件的所有更改（从备用数据文件头中的SCN开始）都包含在增量备份中。</p>
                     <p>你可以使用<code class="codeph">RECOVER ...FROM SERVICE</code>命令用于将物理备用数据库上的数据文件与主数据库上的数据文件同步。此命令刷新备用数据文件并将它们前滚到与主数据库相同的时间点。但是，备用控制文件仍包含旧SCN值，这些值低于备用数据文件中的SCN值。因此，要完成物理备用数据库的同步，必须刷新备用控制文件，然后更新刷新的备用控制文件中的数据文件名，联机重做日志文件名和备用重做日志文件名。
                     </p>
                     <p>如果网络资源是约束，则可以使用<code class="codeph">BACKUP INCREMENTAL</code>命令在主数据库上创建增量备份，然后使用增量备份来前滚物理备用数据库。
                     </p>
                     <p><span class="q">“ <a href="rman-recovery-advanced.html#GUID-828A4953-3F7E-4975-ADA4-5469D6794BB0" title="Use the RECOVER STANDBY DATABASE command with the FROM SERVICE clause to refresh a physical standby database with changes that were made to the primary database.">使用对主数据库所做的更改来刷新物理备用数据库</a></span>的步骤<span class="q">”</span>描述了使用<code class="codeph">FROM SERVICE</code>子句刷新物理备用<span class="q"><a href="rman-recovery-advanced.html#GUID-828A4953-3F7E-4975-ADA4-5469D6794BB0" title="将RECOVER STANDBY DATABASE命令与FROM SERVICE子句一起使用，以使用对主数据库所做的更改来刷新物理备用数据库。">数据库</a></span>的步骤。
                     </p>
                     <div class="infoboxnotealso" id="GUID-93C8F7F1-E1FB-485D-ABC7-860757B24A98__GUID-C3DCC851-E53E-4C67-AD21-F42B5F93F146">
                        <p class="notep1">也可以看看：</p>
                        <p>有关使用<code class="codeph">BACKUP INCREMENTAL</code>命令前滚物理备用数据库的信息，请参阅<a href="../sbydb/managing-oracle-data-guard-physical-standby-databases.html#SBYDB-GUID-B140C38B-DE01-4252-8422-7154018DDFEC" target="_blank"><span><cite>Oracle Data Guard概念和管理</cite></span></a></p>
                     </div>
                  </div><a id="BRADV858"></a><div class="props_rev_3"><a id="GUID-828A4953-3F7E-4975-ADA4-5469D6794BB0" name="GUID-828A4953-3F7E-4975-ADA4-5469D6794BB0"></a><h5 id="BRADV-GUID-828A4953-3F7E-4975-ADA4-5469D6794BB0" class="sect5"><span class="enumeration_section">20.7.5.1</span>使用对主数据库所做的更改来刷新物理备用数据库的步骤</h5>
                     <div>
                        <p>将<code class="codeph">RECOVER STANDBY DATABASE</code>命令与<code class="codeph">FROM SERVICE</code>子句一起使用，以使用对主数据库所做的更改来刷新物理备用数据库。
                        </p>
                        <div class="section">
                           <p></p>
                           <p>此示例假定主数据库的<code class="codeph">DB_UNIQUE_NAME</code>是<code class="codeph">MAIN</code> ，其网络服务名称是<code class="codeph">primary_db</code> 。备用数据库的<code class="codeph">DB_UNIQUE_NAME</code>是<code class="codeph">STANDBY</code> ，其网络服务名称是<code class="codeph">standby_db</code> 。
                           </p>
                           <p><span class="bold">要使用对主数据库所做的更改来刷新物理备用数据库：</span></p>
                           <ol>
                              <li>
                                 <p>确保满足以下先决条件：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>在物理备用数据库和主数据库之间建立Oracle Net连接。</p>
                                       <p>您可以通过在物理备用数据库的<code class="codeph">tnsnames.ora</code>文件中添加与主数据库相对应的条目来完成此操作。
                                       </p>
                                    </li>
                                    <li>
                                       <p>主数据库和物理备用数据库上的密码文件是相同的。</p>
                                    </li>
                                    <li>
                                       <p>主数据库和物理备用数据库的初始化参数文件中的<code class="codeph">COMPATIBLE</code>参数设置为12.0。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>启动RMAN并将其作为目标连接到物理备用数据库。建议您还连接到恢复目录。</p>
                                 <p>以下命令作为<code class="codeph">TARGET</code>连接到物理备用数据库，并作为<code class="codeph">CATALOG</code>连接到恢复目录。使用已被授予<code class="codeph">SYSBACKUP</code>权限的<code class="codeph">sbu</code>用户建立与物理备用数据库的连接。物理备用数据库的网络服务名称是<code class="codeph">standby_db</code> ，恢复目录的网络服务名称是<code class="codeph">catdb</code> 。
                                 </p><pre class="oac_no_warn" dir="ltr">CONNECT TARGET“sbu @ standby_db AS SYSBACKUP”; CONNECT CATALOG rman @ catdb;</pre></li>
                              <li>
                                 <p>使用带有<code class="codeph">FROM SERVICE</code>子句的<code class="codeph">RECOVER STANDBY DATABASE</code>命令前滚物理备用数据库。
                                 </p>
                                 <p><code class="codeph">FROM SERVICE</code>子句指定必须使用物理备用数据库前滚的主数据库的服务名称。前滚操作后重新启动备用数据库。
                                 </p>
                                 <p>以下示例使用服务名称为<code class="codeph">primary_db</code>的主数据库前滚物理备用数据库。
                                 </p><pre class="pre codeblock"><code>从服务中恢复STANDBY数据库primary_db;</code></pre></li>
                              <li>
                                 <p>（仅适用于Active Data Guard）执行以下步骤以恢复重做数据并以只读模式打开物理备用数据库：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE RECOVER管理备用数据库直到一致; ALTER DATABASE OPEN READ ONLY;</pre></li>
                              <li>
                                 <p>在物理备用数据库上启动受管恢复进程。</p>
                                 <p>以下命令启动托管恢复过程：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE RECOVER管理备用数据库与会话断开连接;</pre><p>使用Data Guard Broker时，请使用以下命令启动托管恢复过程：</p><pre class="oac_no_warn" dir="ltr">DGMGRL&gt;编辑数据库standby_db set state ='APPLY-ON';</pre></li>
                           </ol>
                           <div class="infoboxnotealso" id="GUID-828A4953-3F7E-4975-ADA4-5469D6794BB0__GUID-30F15DA5-B540-41F4-BD7A-ED90E200DEB4">
                              <p class="notep1">也可以看看：</p>
                              <p>有关建立Oracle Net连接的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=NETAG177" target="_blank"><span><cite>“Oracle数据库网络服务管理员指南”</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="04342.translator-run-time-functionality.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>翻译和运行时功能</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="SQLJ Developer&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="SQLJ Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="sqlj-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T08:20:03-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96458-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="translator-command-line-and-options.html" title="Previous" type="text/html"></link>
      <link rel="next" href="performance-and-debugging.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQLJ Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="JSQLJ"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="translator-command-line-and-options.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="performance-and-debugging.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQLJ开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">翻译和运行时功能</li>
            </ol>
            <a id="GUID-19E43C02-712C-4CF7-BE74-C7A16665C1D2" name="GUID-19E43C02-712C-4CF7-BE74-C7A16665C1D2"></a><a id="JSQLJ700"></a>
            
            <h2 id="JSQLJ-GUID-19E43C02-712C-4CF7-BE74-C7A16665C1D2" class="sect2"><span class="enumeration_chapter">10</span>转换器和运行时功能</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章讨论Oracle SQLJ转换程序的内部操作和功能以及运行时。</p>
               <p>涵盖以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="translator-run-time-functionality.html#GUID-D48A9F0A-67FD-4B49-B219-7EC6FEE1F4E3">内部翻译操作</a></p>
                  </li>
                  <li>
                     <p><a href="translator-run-time-functionality.html#GUID-AEB9AFD5-5CE3-43AA-8883-A0A03D82A43D">译者错误的功能_消息_和退出代码</a></p>
                  </li>
                  <li>
                     <p><a href="translator-run-time-functionality.html#GUID-AFF5C519-028E-4554-98E8-B8FF103515D1">SQLJ运行时</a></p>
                  </li>
                  <li>
                     <p><a href="translator-run-time-functionality.html#GUID-50785BF7-712B-4BFC-BE22-0E86B626BBA6">翻译和运行时的全球化支持</a></p>
                  </li>
               </ul>
            </div><a id="JSQLJ701"></a><div class="props_rev_3"><a id="GUID-D48A9F0A-67FD-4B49-B219-7EC6FEE1F4E3" name="GUID-D48A9F0A-67FD-4B49-B219-7EC6FEE1F4E3"></a><h3 id="JSQLJ-GUID-D48A9F0A-67FD-4B49-B219-7EC6FEE1F4E3" class="sect3">内部翻译操作</h3>
               <div>
                  <p>以下主题总结了SQLJ翻译在翻译期间执行的操作：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-87DB4A97-BF52-4059-A64C-665733D75B62">Java和SQLJ代码解析和语法检查</a></p>
                     </li>
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-CD0DF951-697A-47E1-90B0-DAF8E2E58DB9">SQL语义 - 检查和脱机解析</a></p>
                     </li>
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D">代码生成</a></p>
                     </li>
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-9A0CD688-00C7-4DBB-9F76-1727E5C291C4">Java编译</a></p>
                     </li>
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-1C3E2732-1185-4961-BA6B-5BA97A35EA48">配置文件定制（ISO代码生成）</a></p>
                     </li>
                  </ul>
               </div><a id="JSQLJ702"></a><div class="props_rev_3"><a id="GUID-87DB4A97-BF52-4059-A64C-665733D75B62" name="GUID-87DB4A97-BF52-4059-A64C-665733D75B62"></a><h4 id="JSQLJ-GUID-87DB4A97-BF52-4059-A64C-665733D75B62" class="sect4">Java和SQLJ代码解析和语法检查</h4>
                  <div>
                     <p>在SQLJ转换的第一阶段，SQLJ解析器和Java解析器用于处理所有源代码和检查语法。当SQLJ转换器解析<code class="codeph">.sqlj</code>文件时，它会调用Java解析器来检查Java语句的语法，并调用SQLJ解析器来检查SQLJ结构的语法（以<code class="codeph">#sql</code>任何<code class="codeph">#sql</code> ）。SQLJ解析器还调用Java解析器来检查SQLJ可执行语句中Java主机变量和表达式的语法。
                     </p>
                     <p>SQLJ解析器根据SQLJ语言规范检查SQLJ构造的语法。但是，它<span class="italic">不</span>检查嵌入的SQL操作的语法。在语义检查或脱机解析步骤之前，不会检查SQL语法。
                     </p>
                     <p>此语法检查将查找错误，例如缺少分号，大括号不匹配以及明显的类型不匹配，例如将数字乘以字符串。如果解析器在此阶段发现任何语法错误或类型不匹配，则中止转换并将错误报告给用户。</p>
                  </div>
               </div><a id="JSQLJ703"></a><div class="props_rev_3"><a id="GUID-CD0DF951-697A-47E1-90B0-DAF8E2E58DB9" name="GUID-CD0DF951-697A-47E1-90B0-DAF8E2E58DB9"></a><h4 id="JSQLJ-GUID-CD0DF951-697A-47E1-90B0-DAF8E2E58DB9" class="sect4">SQL语义 - 检查和脱机解析</h4>
                  <div>
                     <p>一旦SQLJ和Java应用程序源代码被验证为语法正确，翻译器就会进入语义检查阶段，并根据SQLJ选项设置调用SQL语义检查器或SQL脱机解析器或两者。</p>
                     <p>设置<code class="codeph">-user</code>选项启用在线检查，并设置<code class="codeph">-password</code>和<code class="codeph">-url</code>选项指定的数据库连接，如果没有指定的密码和网址<code class="codeph">-user</code>选项。<code class="codeph">-offline</code>或<code class="codeph">-online</code>选项指定要使用的检查程序。默认值（通常是足够的）是一个名为<code class="codeph">OracleChecker</code>的检查程序前端，它根据您是否启用了在线检查以及您正在使用的Java数据库连接（JDBC）驱动程序来选择最合适的检查程序。
                     </p>
                     <p><code class="codeph">-parse</code>选项（默认为<code class="codeph">true</code> ）用于启用脱机解析器，它提供了一种方法来验证SQL和PL / SQL语法（但不是针对数据库列的数据类型），而无需在转换期间进行数据库连接。请注意， <code class="codeph">-parse</code>选项的某些设置将覆盖<code class="codeph">-user</code>选项并禁用在线检查。
                     </p>
                     <div class="infoboxnotealso" id="GUID-CD0DF951-697A-47E1-90B0-DAF8E2E58DB9__GUID-5FF88CB8-0C4B-4BA8-9CC7-DBAF8CFC121A">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="translator-command-line-and-options.html#GUID-E001FA35-824A-47A1-8973-AA5771B0DFE5">连接选项</a> ”</span>和<span class="q">“ <a href="translator-command-line-and-options.html#GUID-ED7DD3DE-CA91-4085-82B2-D07EC9B15FB6">语义 - 检查和脱机 - 解析选项</a> ”</span></p>
                     </div>
                     <div class="infoboxnote" id="GUID-CD0DF951-697A-47E1-90B0-DAF8E2E58DB9__GUID-70A54398-B084-4FF9-8159-DB44AB09B003">
                        <p class="notep1">注意：</p>
                        <p>对于ISO代码生成，也可以在先前执行SQLJ转换器期间生成的配置文件上执行语义检查。请参阅<span class="q">“ <a href="appendix.html#GUID-B0B2AAD4-3AE2-43F1-A38E-37D48343C353">SQLCheckerCustomizer for Profile Semantics-Checking</a> ”</span> 。
                        </p>
                     </div>
                     <p>无论在线检查或离线解析的状态如何，在语义检查期间始终执行以下任务：</p>
                     <ol>
                        <li>
                           <p>SQLJ分析SQLJ可执行语句中的Java表达式类型。</p>
                           <p>这包括检查要翻译的SQLJ源文件，在命令行上输入的任何<code class="codeph">.java</code>文件，以及可以通过类路径找到其<code class="codeph">.class</code>文件或<code class="codeph">.java</code>文件的任何导入的Java类。SQLJ检查是否以及如何在<code class="codeph">SELECT</code>或<code class="codeph">CAST</code>语句中使用流类型，在迭代器列或<code class="codeph">INTO</code>列表中使用哪些Java类型，将哪些Java类型用作输入主机变量，以及将哪些Java类型用作输出主机变量。
                           </p>
                           <p>SQLJ还在语法上处理<code class="codeph">FETCH</code> ， <code class="codeph">CAST</code> ， <code class="codeph">CALL</code> ， <code class="codeph">SET TRANSACTION</code> ， <code class="codeph">VALUES</code>和<code class="codeph">SET</code>语句。
                           </p>
                           <p>SQLJ可执行语句中的任何Java表达式都必须具有对给定情况和用法有效的Java类型。例如，请考虑以下语句：</p><pre class="oac_no_warn" dir="ltr">#sql [myCtx] {更新...};</pre><p><code class="codeph">myCtx</code>变量（可能用于为此语句指定连接上下文实例或执行上下文实例）必须实际解析为SQLJ连接上下文类型或执行上下文类型。
                           </p>
                           <p>现在考虑以下示例：</p><pre class="oac_no_warn" dir="ltr">#sql {UPDATE employees SET salary =：newSal};</pre><p>如果<code class="codeph">newSal</code>是一个变量，而不是字段，那么如果<code class="codeph">newSal</code>没有声明<code class="codeph">newSal</code> ，则会生成错误。在任何情况下，如果无法将其分配给有效的Java类型或者无法在SQL语句中使用其Java类型（例如， <code class="codeph">java.util. ，则会生成错误<code class="codeph">java.util.Vector</code> ）。
                           </p>
                           <div class="infoboxnote" id="GUID-CD0DF951-697A-47E1-90B0-DAF8E2E58DB9__GUID-7F8B9E22-CBA0-4FD9-88F6-73D99DC5AE28">
                              <p class="notep1">注意：</p>
                              <p>仅对SQLJ可执行语句中的Java表达式执行Java类型的语义检查。在Java编译器编译之前， <span class="italic">不会</span>检测标准Java语句中的此类错误。
                              </p>
                           </div>
                        </li>
                        <li>
                           <p>SQLJ尝试对嵌入式SQL操作进行分类。每个操作都必须具有可识别的关键字，例如<code class="codeph">SELECT</code>或<code class="codeph">INSERT</code> ，以便SQLJ知道它是什么类型的操作。例如，以下语句将生成错误：</p><pre class="oac_no_warn" dir="ltr">#sql {foo};</pre></li>
                        <li>
                           <p>如果启用了在线检查或脱机解析（或两者），则SQLJ会分析并验证嵌入式SQL和PL / SQL操作的语法。</p>
                        </li>
                        <li>
                           <p>如果启用了在线检查或脱机解析（或两者），则SQLJ将根据数据库中相应列的SQL类型和相应参数的SQL类型检查SQLJ可执行语句中的Java表达式类型，并返回存储过程和函数的变量。</p>
                           <p>在执行此操作的过程中，SQLJ会验证SQLJ可执行语句中使用的SQL实体（例如表，视图和存储过程）是否实际存在于数据库中。SQLJ还检查其数据被选择到Java原始类型的迭代器列的数据库列的可空性，这些列不能处理空数据。但是，不检查存储过程和函数输出参数和返回值的可为空性。</p>
                        </li>
                     </ol>
                  </div>
               </div><a id="JSQLJ705"></a><a id="JSQLJ706"></a><a id="JSQLJ707"></a><a id="JSQLJ708"></a><a id="JSQLJ709"></a><a id="JSQLJ704"></a><div class="props_rev_3"><a id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D" name="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D"></a><h4 id="JSQLJ-GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D" class="sect4">代码生成</h4>
                  <div>
                     <div class="section">
                        <p>对于<code class="codeph">.sqlj</code>应用程序源文件，SQLJ转换器生成<code class="codeph">.java</code>文件，并且对于ISO标准SQLJ代码生成，至少生成一个配置文件（在<code class="codeph">.ser</code>或<code class="codeph">.class</code>文件中）。<code class="codeph">.java</code>包含已翻译的应用程序源代码，您声明的任何私有迭代器和连接上下文的类定义，以及ISO代码，SQLJ内部生成和使用的profile-keys类定义。</p>
                        <div class="infoboxnote" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__GUID-F8D215D9-269A-41CE-BBF4-63606CE7AE80">
                           <p class="notep1">注意：</p>
                           <p>如果使用默认的Oracle特定代码生成模式，则不会生成任何profiles或profile-keys类。</p>
                           <p>使用ISO代码生成时，如果您不在代码中使用任何SQLJ可执行语句，则不会有profile或profile-keys类。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__GUID-B43AE7AB-ED82-462D-8800-A676B4DECEB5">在.java文件中生成应用程序代码</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>对于默认的Oracle特定代码生成，为应用程序生成的<code class="codeph">.java</code>文件包含对Oracle JDBC驱动程序的直接调用，而不是原始SQLJ可执行语句。还有一些特定于Oracle的SQLJ运行时调用。对于ISO标准SQLJ代码生成，SQLJ可执行语句被对SQLJ运行时的调用所取代，而SQLJ运行时又包含对JDBC驱动程序的调用。
                        </p>
                        <p>为方便起见，生成的<code class="codeph">.java</code>文件还包含每个<code class="codeph">#sql</code>语句的注释，完整地重复该语句以供参考。生成的<code class="codeph">.java</code>文件将具有与输入<code class="codeph">.sqlj</code>文件相同的基本名称，该文件将是<code class="codeph">.sqlj</code>文件中定义的公共类的名称，或者在没有公共类时定义的第一个类。例如， <code class="codeph">Foo.sqlj</code>定义了<code class="codeph">Foo</code>类。<code class="codeph">Foo.java</code>源文件将由翻译器生成。
                        </p>
                        <p>生成的<code class="codeph">.java</code>文件的位置取决于您是否以及如何设置SQLJ <code class="codeph">-dir</code>选项。默认情况下， <code class="codeph">.java</code>文件将放在<code class="codeph">.sqlj</code>输入文件的目录中。
                        </p>
                        <div class="infoboxnotealso" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__GUID-F0A38166-7B45-453C-BD30-B6849717B12B">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="translator-command-line-and-options.html#GUID-93FF52FC-8C29-488C-B82D-FFA8A6C5A03B">生成的.java文件的输出目录（-dir）</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__GUID-791FF0BD-C741-418E-A3B8-3F4B6AB0BCA0">.java文件中生成的配置文件密钥类（ISO代码生成）</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>如果使用ISO标准SQLJ代码生成，SQLJ会生成一个profile-keys类，它在运行时内部使用它来加载和访问序列化配置文件。此类包含已翻译应用程序中的SQLJ运行时调用与放置在序列化概要文件中的SQL操作之间的映射信息。它还包含访问序列化配置文件的方法。</p>
                        <div class="infoboxnote" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__GUID-3B4E9DB9-1B7B-4A31-BAB9-9C5279E12ACF">
                           <p class="notep1">注意：</p>
                           <p>如果使用默认的Oracle特定代码生成，则不会生成任何配置文件或配置文件密钥类。</p>
                        </div>
                        <p>profile-keys类在同一个<code class="codeph">.java</code>输出文件中定义，该文件包含已翻译的应用程序源代码，其类名基于<code class="codeph">.sqlj</code>源文件的基本名称，如下所示：</p><pre class="oac_no_warn" dir="ltr">Basename_SJProfileKeys</pre><p>例如，翻译<code class="codeph">Foo.sqlj</code>在生成的<code class="codeph">.java</code>文件中定义以下profile-keys类：</p><pre class="oac_no_warn" dir="ltr">Foo_SJProfileKeys</pre><p>如果您的应用程序在一个包中，则会相应地反映出来。例如，在<code class="codeph">ab</code>包中翻译<code class="codeph">Foo.sqlj</code>定义了以下类：</p><pre class="oac_no_warn" dir="ltr">ABFoo_SJProfileKeys</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__GUID-9CEFF778-6755-416A-A1D3-D0DE8DED144C">.ser或.class文件中生成的配置文件（ISO代码生成）</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>如果使用ISO标准SQLJ代码生成，SQLJ会生成用于存储有关在输入文件中找到的SQL操作的信息的配置文件。将为您在应用程序中使用的每个连接上下文类生成配置文件。它描述了使用关联连接上下文类的实例执行的操作，例如要执行的SQL操作，要访问的表以及要调用的存储过程和函数。</p>
                        <div class="infoboxnote" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__GUID-653119F0-7B9A-4A6B-A757-319F9A6E55BA">
                           <p class="notep1">注意：</p>
                           <p>如果使用默认的Oracle特定代码生成，那么有关SQL操作的信息将嵌入到生成的代码中，该代码直接调用Oracle JDBC驱动程序。在这种情况下，SQLJ不会生成配置文件。</p>
                        </div>
                        <p>配置文件在<code class="codeph">.ser</code>序列化资源文件中生成。但是，如果启用SQLJ <code class="codeph">-ser2class</code>选项，则配置文件将自动转换为<code class="codeph">.class</code>文件，作为转换的一部分。在这种情况下，不可能进一步定制配置文件。您必须删除<code class="codeph">.class</code>文件并重新运行SQLJ转换器以重新生成配置文件。
                        </p>
                        <p>与profile-keys类名称类似地生成配置文件基本名称。它们完全限定了包名，后跟<code class="codeph">.sqlj</code>文件基名，后跟字符串：</p><pre class="oac_no_warn" dir="ltr">_SJProfile <span class="italic">n</span>
</pre><p>其中<span class="italic"><code class="codeph">n</code></span>是为特定<code class="codeph">.sqlj</code>输入文件生成的每个配置文件的唯一编号，从0开始。
                        </p>
                        <p>再次使用<code class="codeph">Foo.sqlj</code>输入文件的示例，如果生成了两个配置文件，那么它们将具有以下基本名称（假设没有包）：</p><pre class="oac_no_warn" dir="ltr">Foo_SJProfile0 Foo_SJProfile1</pre><p>如果<code class="codeph">Foo.sqlj</code>在<code class="codeph">ab</code>包中，那么配置文件基名将是：</p><pre class="oac_no_warn" dir="ltr">ABFoo_SJProfile0 abFoo_SJProfile1</pre><p>物理上，配置文件作为资源文件中包含的Java序列化对象存在。包含配置文件的资源文件使用<code class="codeph">.ser</code>扩展名，并根据配置文件的基本名称命名（不包括软件包名称）。前面提到的两个配置文件的资源文件将命名如下：</p><pre class="oac_no_warn" dir="ltr">Foo_SJProfile0.ser Foo_SJProfile1.ser</pre><p>或者，如果启用<code class="codeph">-ser2class</code>选项，它们将被命名为<code class="codeph">Foo_SJProfile0.class</code>和<code class="codeph">Foo_SJProfile1.class</code> 。如果选择此选项，则会在自定义步骤<span class="italic">之后</span>转换为<code class="codeph">.class</code> 。
                        </p>
                        <div class="infoboxnotealso" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__GUID-C7583720-72AF-43CA-AA7A-72694117D17D">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="translator-command-line-and-options.html#GUID-18BBFFC9-9FA1-4AB9-B65F-D822D3B2A6C3">.ser文件转换为.class文件（-ser2class）</a> ”</span></p>
                        </div>
                        <p>这些文件的位置取决于SQLJ <code class="codeph">-d</code>选项的设置方式，它决定了所有生成的<code class="codeph">.ser</code>和<code class="codeph">.class</code>文件的放置位置。
                        </p>
                        <div class="infoboxnotealso" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__GUID-00B01D10-DD89-4602-BB77-42AE715B63CF">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="translator-command-line-and-options.html#GUID-93FF52FC-8C29-488C-B82D-FFA8A6C5A03B">生成的.ser和.class文件的输出目录（-d）</a> ”</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__GUID-ADFA0FDF-B071-4BFA-8F54-1375E8C8B441">有关生成的SQLJ运行时调用的更多信息</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>当通过调用JDBC驱动程序（用于Oracle特定代码生成）或SQLJ运行时（用于ISO标准SQLJ代码生成）替换<code class="codeph">#sql</code>语句时，这些调用将实现<a href="translator-run-time-functionality.html#GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__CHEFIGGA" title="摘要">表10-1中</a>的步骤。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D__CHEFIGGA">
                        <p class="titleintable">表10-1生成呼叫的步骤，ISO标准与Oracle特定</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="生成调用的步骤，ISO标准与Oracle特定" width="100%" border="1" summary="summary" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="50%" id="d61763e639">ISO标准代码生成的步骤</th>
                                 <th align="left" valign="bottom" width="50%" id="d61763e642">Oracle代码生成的步骤</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d61763e647" headers="d61763e639 ">
                                    <p>使用存储在关联的配置文件条目中的信息获取SQLJ语句对象。</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d61763e647 d61763e642 ">
                                    <p>获取Oracle JDBC语句对象。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d61763e654" headers="d61763e639 ">
                                    <p>使用语句对象的<code class="codeph">set</code> <span class="italic"><code class="codeph">XXX</code></span> <code class="codeph">()</code>方法将输入绑定到语句中。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d61763e654 d61763e642 ">
                                    <p>使用Oracle JDBC语句方法绑定输入，并在必要时注册输出参数。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d61763e669" headers="d61763e639 ">
                                    <p>使用语句对象的<code class="codeph">executeUpdate()</code>或<code class="codeph">executeQuery()</code>方法执行语句。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d61763e669 d61763e642 ">
                                    <p>执行Oracle语句。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d61763e682" headers="d61763e639 ">
                                    <p>如果适用，创建迭代器实例。</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d61763e682 d61763e642 ">
                                    <p>如果适用，创建迭代器实例。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d61763e689" headers="d61763e639 ">
                                    <p>使用语句对象的<code class="codeph">get</code> <span class="italic"><code class="codeph">XXX</code></span> <code class="codeph">()</code>方法从语句中检索输出。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d61763e689 d61763e642 ">
                                    <p>使用适当的JDBC getter方法从语句中检索输出。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d61763e704" headers="d61763e639 ">
                                    <p>关闭SQLJ语句对象（默认情况下，通过SQLJ语句高速缓存将其回收）。</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d61763e704 d61763e642 ">
                                    <p>关闭JDBC语句对象（默认情况下，通过JDBC语句高速缓存将其回收）。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p>SQLJ运行时使用与JDBC语句对象类似的SQLJ语句对象，尽管SQLJ的特定实现可能会也可能不会直接使用JDBC语句类。SQLJ语句类添加了特定于SQLJ的功能。例如：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果要将数据库中的空值输出到原始Java类型（如<code class="codeph">int</code>或<code class="codeph">float</code> ，标准SQLJ语句对象引发SQL异常，该类型不能采用空值。
                              </p>
                           </li>
                           <li>
                              <p>Oracle SQLJ语句对象允许将用户定义的对象和集合类型传递到Oracle数据库或从Oracle数据库中检索。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JSQLJ710"></a><div class="props_rev_3"><a id="GUID-9A0CD688-00C7-4DBB-9F76-1727E5C291C4" name="GUID-9A0CD688-00C7-4DBB-9F76-1727E5C291C4"></a><h4 id="JSQLJ-GUID-9A0CD688-00C7-4DBB-9F76-1727E5C291C4" class="sect4">Java编译</h4>
                  <div>
                     <p>代码生成后，SQLJ调用Java编译器来编译生成的<code class="codeph">.java</code>文件。这会为您在应用程序中定义的每个类生成一个<code class="codeph">.class</code>文件，包括迭代器和连接上下文声明，以及生成的profile-keys类的<code class="codeph">.class</code>文件，如果您使用ISO代码生成（并假设您的应用程序使用SQLJ可执行文件）语句）。您在SQLJ命令行上直接指定的任何<code class="codeph">.java</code>文件（例如，用于类型解析）也会在此时编译。
                     </p>
                     <p>在<span class="q">“ <a href="translator-run-time-functionality.html#GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D">代码生成</a> ”中</span>使用的示例中，将在相应的目录中<span class="q"><a href="translator-run-time-functionality.html#GUID-930ED5CD-CB40-488E-94D9-509DEB9C2A8D">生成</a></span>以下<code class="codeph">.class</code>文件（在源代码中给定包信息）：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">让Foo.class</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">Foo_SJProfileKeys.class</code> （仅限ISO代码生成）</p>
                        </li>
                        <li>
                           <p>您在<code class="codeph">Foo.sqlj</code>定义的每个附加类的<code class="codeph">.class</code>文件</p>
                        </li>
                        <li>
                           <p>您在<code class="codeph">Foo.sqlj</code>声明的每个迭代器和连接上下文类的<code class="codeph">.class</code>文件（无论是公共还是私有）</p>
                        </li>
                     </ul>
                     <p>为了确保<code class="codeph">.class</code>文件和配置文件（如果有的话，无论是<code class="codeph">.ser</code>还是<code class="codeph">.class</code> ）将位于同一目录中，SQLJ将其<code class="codeph">-d</code>选项传递给Java编译器。如果未设置<code class="codeph">-d</code>选项，则<code class="codeph">.class</code>文件和配置文件与生成的<code class="codeph">.java</code>文件放在同一目录中，该文件根据<code class="codeph">-dir</code>选项设置放置。
                     </p>
                     <p>此外，为了使SQLJ和Java编译器使用相同的编码，SQLJ将其<code class="codeph">-encoding</code>选项传递给Java编译器，除非关闭SQLJ <code class="codeph">-compiler-encoding-flag</code> 。如果未设置<code class="codeph">-encoding</code>选项，则SQLJ和编译器将使用Java虚拟机（JVM） <code class="codeph">file.encoding</code>属性中的设置。
                     </p>
                     <p>默认情况下，SQLJ调用Sun Microsystems Java Development Kit（JDK）的标准<code class="codeph">javac</code>编译器，但也可以使用其他编译器。您可以通过设置SQLJ <code class="codeph">-compiler-executable</code>选项来请求使用备用Java编译<code class="codeph">-compiler-executable</code> 。
                     </p>
                     <div class="infoboxnote" id="GUID-9A0CD688-00C7-4DBB-9F76-1727E5C291C4__GUID-519B5687-3A4D-4710-AAD2-91FEF1F40234">
                        <p class="notep1">注意：</p>
                        <p>如果您使用的是SQLJ <code class="codeph">-encoding</code>选项但使用的编译器没有<code class="codeph">-encoding</code>选项，请关闭SQLJ <code class="codeph">-compiler-encoding-flag</code> 。否则，SQLJ将尝试将<code class="codeph">-encoding</code>选项传递给编译器。
                        </p>
                     </div>
                  </div>
               </div><a id="JSQLJ711"></a><div class="props_rev_3"><a id="GUID-1C3E2732-1185-4961-BA6B-5BA97A35EA48" name="GUID-1C3E2732-1185-4961-BA6B-5BA97A35EA48"></a><h4 id="JSQLJ-GUID-1C3E2732-1185-4961-BA6B-5BA97A35EA48" class="sect4">配置文件定制（ISO代码生成）</h4>
                  <div>
                     <div class="section">
                        <p>在Java编译之后，如果您使用ISO标准代码生成，则会自定义包含有关嵌入式SQL指令信息的生成的配置文件，以便您的应用程序可以有效地与数据库一起使用并使用特定于供应商的扩展。</p>
                        <div class="infoboxnote" id="GUID-1C3E2732-1185-4961-BA6B-5BA97A35EA48__GUID-C2C785A9-8906-4F52-8821-C5E67E9D6E5A">
                           <p class="notep1">注意：</p>
                           <p>如果使用默认的Oracle特定代码生成，则SQLJ不会生成任何配置文件并跳过自定义步骤。您的代码将通过直接调用Oracle JDBC应用程序编程接口（API）来支持特定于Oracle的功能。</p>
                        </div>
                        <p>如果要检查已在自定义程序上设置的选项，则可以使用以下命令：</p><pre class="oac_no_warn" dir="ltr">％sqlj -P-print * .ser</pre><p>有关配置文件打印选项的更多信息，请参阅<span class="q">“ <a href="appendix.html#GUID-F5F49038-71D7-4C4C-A567-355FB0FFB99A">专业定制器：配置文件打印选项（打印）</a> ”</span> 。
                        </p>
                        <p>为了完成自定义，SQLJ调用称为自定义程序工具的前端，这是一个充当命令行实用程序的Java类。反过来，线束会调用特定的自定义程序，默认的Oracle自定义程序或通过SQLJ选项设置指定的自定义程序。</p>
                        <p>在自定义过程中，配置文件将通过以下方式更新：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使应用程序能够使用任何特定于供应商的数据库类型或功能（如果适用）</p>
                           </li>
                           <li>
                              <p>定制配置文件，以便在使用相关数据库环境的功能时尽可能高效地运行应用程序</p>
                           </li>
                        </ul>
                        <p>如果没有自定义，您只能访问和使用标准JDBC类型。</p>
                        <p>例如，Oracle定制程序可以更新配置文件以支持您定义的SQL <code class="codeph">PERSON</code>类型。然后，您可以像使用任何其他支持的数据类型一样使用<code class="codeph">PERSON</code> 。
                        </p>
                        <p>您还必须使用Oracle自定义程序进行自定义以使用任何<code class="codeph">oracle.sql</code>类型扩展。
                        </p>
                        <div class="infoboxnote" id="GUID-1C3E2732-1185-4961-BA6B-5BA97A35EA48__GUID-7044CFBD-5675-4EB8-B9E5-45E6BF843550">
                           <p class="notep1">注意：</p>
                           <p>请注意有关配置文件自定义的以下内容：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>每当您在翻译期间使用Oracle自定义程序时，您的应用程序都将需要Oracle SQLJ运行时和Oracle JDBC驱动程序，即使您未在代码中使用Oracle扩展。</p>
                              </li>
                              <li>
                                 <p>如果您的应用程序没有自定义项，或者没有适合连接的自定义项，则将使用通用SQLJ运行时。</p>
                              </li>
                              <li>
                                 <p>您可以通过在命令行上指定<code class="codeph">.ser</code>文件或包含<code class="codeph">.ser</code>文件的<code class="codeph">.jar</code>文件来自定义以前创建的配置文件。但是你不能在正在进行翻译的SQLJ运行中执行此操作。您可以指定要自定义的<code class="codeph">.ser</code> / <code class="codeph">.jar</code>文件或要转换，编译和自定义的<code class="codeph">.sqlj</code> / <code class="codeph">.java</code>文件，但不能指定这两个类别。有关如何使用<code class="codeph">.jar</code>文件的更多信息，请参阅<span class="q">“ <a href="appendix.html#GUID-337DCFDF-48AD-495F-918B-63B86CD71039">用于配置文件的JAR文件</a> ”</span> 。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="JSQLJ712"></a><div class="props_rev_3"><a id="GUID-AEB9AFD5-5CE3-43AA-8883-A0A03D82A43D" name="GUID-AEB9AFD5-5CE3-43AA-8883-A0A03D82A43D"></a><h3 id="JSQLJ-GUID-AEB9AFD5-5CE3-43AA-8883-A0A03D82A43D" class="sect3">转换器错误，消息和退出代码的功能</h3>
               <div>
                  <p>本节概述了SQLJ转换器消息和退出代码。它包括以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-FA67998B-E9A1-41C6-81F8-5F8677A6FDDD">翻译错误_警告_和信息消息</a></p>
                     </li>
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-A1E4272B-002E-4CD9-9B19-62EDB9EB1BC3">翻译状态消息</a></p>
                     </li>
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-17DEEF13-D43F-490A-8A8E-067311A77771">翻译退出代码</a></p>
                     </li>
                  </ul>
               </div><a id="JSQLJ714"></a><a id="JSQLJ713"></a><div class="props_rev_3"><a id="GUID-FA67998B-E9A1-41C6-81F8-5F8677A6FDDD" name="GUID-FA67998B-E9A1-41C6-81F8-5F8677A6FDDD"></a><h4 id="JSQLJ-GUID-FA67998B-E9A1-41C6-81F8-5F8677A6FDDD" class="sect4">转换程序错误，警告和信息消息</h4>
                  <div>
                     <div class="section">
                        <p>在翻译阶段您可能会遇到三种主要级别的SQLJ消息：错误，警告和信息。警告消息可以进一步细分为两个级别：不可抑制和可抑制。因此，有四种消息类别（按严重程度排序）：</p>
                        <ol>
                           <li>
                              <p>错误</p>
                           </li>
                           <li>
                              <p>不可抑制的警告</p>
                           </li>
                           <li>
                              <p>可抑制的警告</p>
                           </li>
                           <li>
                              <p>信息</p>
                           </li>
                        </ol>
                        <p>您可以使用SQLJ <code class="codeph">-warn</code>选项控制可抑制警告和信息。
                        </p>
                        <p>以<code class="codeph">Error:</code>为前缀的错误消息表示遇到以下情况之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>阻止编译的条件（例如，源文件包含名称与基本文件名不匹配的公共类）</p>
                           </li>
                           <li>
                              <p>如果执行代码将导致运行时错误的条件（例如，代码尝试将<code class="codeph">VARCHAR</code>提取到<code class="codeph">java.util.Vector</code> ，使用Oracle JDBC驱动程序）</p>
                           </li>
                        </ul>
                        <p>如果在SQLJ转换期间遇到错误，则不会生成任何输出，也不会执行编译和自定义。</p>
                        <p>不可抑制的警告消息（以<code class="codeph">Warning:</code>为前缀）表示遇到以下情况之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果执行代码可能（但不一定）导致运行时错误的条件（例如，其输出未分配给任何内容的<code class="codeph">SELECT</code>语句）</p>
                           </li>
                           <li>
                              <p>一种损害SQLJ验证源代码运行时方面的能力的条件（例如，无法连接到您为在线检查指定的数据库）</p>
                           </li>
                           <li>
                              <p>可能由编码错误或疏忽导致的情况</p>
                           </li>
                        </ul>
                        <p>如果遇到不可抑制的警告，SQLJ转换将完成，但您应该分析问题并确定在运行应用程序之前是否应该修复它。如果指定了在线检查但无法完成，则执行离线检查。</p>
                        <div class="infoboxnote" id="GUID-FA67998B-E9A1-41C6-81F8-5F8677A6FDDD__GUID-D6D26ED0-DED9-425C-BB43-40EA1C4AB949">
                           <p class="notep1">注意：</p>
                           <p>出于逻辑原因，SQLJ转换程序用于分析SQL操作的解析器与将在运行时使用的顶级SQL解析器不同。因此，在翻译期间偶尔会检测到错误，这些错误在应用程序运行时实际上不会导致问题。因此，这些错误被报告为不可抑制的警告，而不是致命的错误。</p>
                        </div>
                        <p>可抑制警告消息（也以<code class="codeph">Warning:</code>为前缀）表示应用程序的特定方面存在问题，例如可移植性。例如，使用特定于Oracle的类型，例如<code class="codeph">oracle.sql.NUMBER</code> ，读取或写入Oracle Database 12 <span class="italic">c</span>第1版（12.1）。
                        </p>
                        <p>以<code class="codeph">Info:</code>为前缀的<code class="codeph">Info:</code>或状态消息不表示错误情况。它们仅提供有关翻译阶段发生情况的其他信息。
                        </p>
                        <p>使用各种<code class="codeph">-warn</code>选项标志可以抑制可抑制的警告和状态消息：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">cast/nocast</code> ：当尝试将对象类型实例<code class="codeph">nocast</code>为子类型的实例时， <code class="codeph">nocast</code>设置会抑制有关可能的运行时错误的警告。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">precision/noprecision</code> ： <code class="codeph">noprecision</code>设置可抑制有关转换期间数据精度可能丢失的警告。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">nulls/nonulls</code> ： <code class="codeph">nonulls</code>设置抑制由于可为空的列或类型而导致的可能的运行时错误的警告。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">portable/noportable</code> ： <code class="codeph">noportable</code>设置禁止有关使用Oracle特定功能的SQLJ代码的警告，否则可能是非标准的，因此无法移植到其他环境。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">strict/nostrict</code> ：如果命名迭代器中的列少于填充迭代器的选定数据中的列，则<code class="codeph">nostrict</code>设置将禁止发出警告。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">verbose/noverbose</code> ： <code class="codeph">noverbose</code>设置抑制仅仅是信息性的状态消息，并不表示错误或警告条件。
                              </p>
                           </li>
                        </ul>
                        <p>如果您在SQLJ翻译期间收到警告，那么您可以尝试使用<code class="codeph">-warn=none</code>再次运行翻译器，以查看是否有任何警告更严重（不可抑制）。
                        </p>
                        <p>下表总结了SQLJ转换程序生成的错误和状态消息的类别。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-FA67998B-E9A1-41C6-81F8-5F8677A6FDDD__CHEFFDGC">
                        <p class="titleintable">表10-2 SQLJ转换程序错误消息类别</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="SQLJ转换程序错误消息类别" width="100%" border="1" summary="summary" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d61763e1225">消息类别</th>
                                 <th align="left" valign="bottom" width="16%" id="d61763e1228">字首</th>
                                 <th align="left" valign="bottom" width="35%" id="d61763e1231">指示</th>
                                 <th align="left" valign="bottom" width="24%" id="d61763e1234">抑制</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d61763e1239" headers="d61763e1225 ">
                                    <p>错误</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d61763e1239 d61763e1228 ">
                                    <p><code class="codeph">错误：</code></p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d61763e1239 d61763e1231 ">
                                    <p>导致编译失败或运行时失败的致命错误（转换中止）</p>
                                 </td>
                                 <td align="left" valign="top" width="24%" headers="d61763e1239 d61763e1234 ">
                                    <p>NA</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d61763e1253" headers="d61763e1225 ">
                                    <p>不可抑制的警告</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d61763e1253 d61763e1228 ">
                                    <p><code class="codeph">Warning</code> ：</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d61763e1253 d61763e1231 ">
                                    <p>阻止正常翻译或可能导致运行时故障的条件（已完成翻译）</p>
                                 </td>
                                 <td align="left" valign="top" width="24%" headers="d61763e1253 d61763e1234 ">
                                    <p>NA</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d61763e1268" headers="d61763e1225 ">
                                    <p>可抑制的警告</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d61763e1268 d61763e1228 ">
                                    <p><code class="codeph">Warning</code> ：</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d61763e1268 d61763e1231 ">
                                    <p>关于您的申请的特定方面的问题（翻译已完成）</p>
                                 </td>
                                 <td align="left" valign="top" width="24%" headers="d61763e1268 d61763e1234 ">
                                    <p><code class="codeph">-warn</code>选项标志： <code class="codeph">nocast noprecision nonulls noportable nostrict</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d61763e1297" headers="d61763e1225 ">
                                    <p>信息/状态消息</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d61763e1297 d61763e1228 ">
                                    <p><code class="codeph">Info</code> ：</p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d61763e1297 d61763e1231 ">
                                    <p>有关翻译过程的信息</p>
                                 </td>
                                 <td align="left" valign="top" width="24%" headers="d61763e1297 d61763e1234 ">
                                    <p><code class="codeph">-warn</code>选项标志： <code class="codeph">noverbose</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="JSQLJ715"></a><div class="props_rev_3"><a id="GUID-A1E4272B-002E-4CD9-9B19-62EDB9EB1BC3" name="GUID-A1E4272B-002E-4CD9-9B19-62EDB9EB1BC3"></a><h4 id="JSQLJ-GUID-A1E4272B-002E-4CD9-9B19-62EDB9EB1BC3" class="sect4">翻译状态消息</h4>
                  <div>
                     <p>除了错误，警告和信息消息之外，SQLJ还可以在SQLJ操作的所有阶段生成状态消息：转换，编译和自定义。在处理每个文件时以及在SQLJ操作的每个阶段生成状态消息。</p>
                     <p>您可以使用SQLJ <code class="codeph">-status</code>选项控制状态消息。
                     </p>
                     <div class="infoboxnotealso" id="GUID-A1E4272B-002E-4CD9-9B19-62EDB9EB1BC3__GUID-6CF1D5CF-3D84-4F19-81E9-ACE63F93E5AD">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="translator-command-line-and-options.html#GUID-6608C203-942D-4E92-8AA5-C523516449D1__I1007388">实时状态消息（-status）</a> ”</span></p>
                     </div>
                  </div>
               </div><a id="JSQLJ716"></a><div class="props_rev_3"><a id="GUID-17DEEF13-D43F-490A-8A8E-067311A77771" name="GUID-17DEEF13-D43F-490A-8A8E-067311A77771"></a><h4 id="JSQLJ-GUID-17DEEF13-D43F-490A-8A8E-067311A77771" class="sect4">翻译退出代码</h4>
                  <div>
                     <p>完成后，SQLJ转换器将以下退出代码返回给操作系统：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">0</code> ：执行时没有错误</p>
                        </li>
                        <li>
                           <p><code class="codeph">1</code> ：SQLJ执行出错</p>
                        </li>
                        <li>
                           <p><code class="codeph">2</code> ：Java编译出错</p>
                        </li>
                        <li>
                           <p><code class="codeph">3</code> ：配置文件自定义错误</p>
                        </li>
                        <li>
                           <p><code class="codeph">4</code> ：类检测中的错误，从<code class="codeph">.sqlj</code>源文件到生成的<code class="codeph">.class</code>文件的行号的可选映射</p>
                        </li>
                        <li>
                           <p><code class="codeph">5</code> ： <code class="codeph">ser2class</code>转换出错，可以将<code class="codeph">.ser</code>文件中的配置文件可选转换为<code class="codeph">.class</code>文件</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-17DEEF13-D43F-490A-8A8E-067311A77771__GUID-29C6215C-9F24-4380-A415-E9C3934B023D">
                        <p class="notep1">注意：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果发出<code class="codeph">-help</code>或<code class="codeph">-version</code>选项，则SQLJ退出代码为<code class="codeph">0</code> 。
                              </p>
                           </li>
                           <li>
                              <p>如果在未指定要处理的任何文件的情况下运行SQLJ，则SQLJ会发出帮助输出并返回退出代码<code class="codeph">1</code> 。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="JSQLJ717"></a><div class="props_rev_3"><a id="GUID-AFF5C519-028E-4554-98E8-B8FF103515D1" name="GUID-AFF5C519-028E-4554-98E8-B8FF103515D1"></a><h3 id="JSQLJ-GUID-AFF5C519-028E-4554-98E8-B8FF103515D1" class="sect3">SQLJ运行时</h3>
               <div>
                  <p>本节介绍有关Oracle SQLJ运行时的信息，该运行时是在JDBC驱动程序之上运行的纯Java代码的薄层。</p>
                  <p>如果使用默认的Oracle特定代码生成，则SQLJ运行时层变得更薄，运行时子集与Oracle JDBC驱动程序一起使用。大多数运行时功能都直接编译到Oracle JDBC调用中。您不能使用非Oracle JDBC驱动程序。</p>
                  <div class="infoboxnotealso" id="GUID-AFF5C519-028E-4554-98E8-B8FF103515D1__GUID-BE21A7F6-14D3-448A-9CBE-3939D169B8C4">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="key-programming-considerations.html#GUID-E0F0C310-400E-4F9C-8036-B44FB2A3E2FD">特定于Oracle的代码生成（无配置文件）</a> ”</span></p>
                  </div>
                  <p>当SQLJ使用ISO标准代码生成转换SQLJ源代码时，Java应用程序中的嵌入式SQL命令将被对SQLJ运行时的调用所取代。运行时类充当等效JDBC类的包装器，提供特殊的SQLJ功能。当最终用户运行应用程序时，SQLJ运行时充当中介，从配置文件中读取有关SQL操作的信息，并将指令传递给JDBC驱动程序。</p>
                  <p>但是，一般来说，可以实现SQLJ运行时以使用任何JDBC驱动程序或供应商专有的访问数据库的方法。Oracle SQLJ运行时需要JDBC驱动程序，但可以使用任何标准JDBC驱动程序。但是，要使用特定于Oracle的数据类型和功能，必须使用Oracle JDBC驱动程序。出于本文档的目的，通常假定您使用的是Oracle数据库和Oracle JDBC驱动程序之一。</p>
                  <div class="infoboxnote" id="GUID-AFF5C519-028E-4554-98E8-B8FF103515D1__GUID-4EAC28BE-FE04-4F1E-9FDD-FCE0556B495D">
                     <p class="notep1">注意：</p>
                     <p>对于ISO标准SQLJ代码生成，只要在转换期间使用Oracle自定义程序，您的应用程序就需要Oracle SQLJ运行时和Oracle JDBC驱动程序，即使您不在代码中使用Oracle扩展。如果您的应用程序没有自定义项，或者没有适合连接的自定义项，则将使用通用SQLJ运行时。</p>
                  </div>
               </div><a id="JSQLJ719"></a><a id="JSQLJ720"></a><a id="JSQLJ718"></a><div class="props_rev_3"><a id="GUID-7B13542C-1664-40CC-882A-C44361F817F0" name="GUID-7B13542C-1664-40CC-882A-C44361F817F0"></a><h4 id="JSQLJ-GUID-7B13542C-1664-40CC-882A-C44361F817F0" class="sect4">SQLJ运行时包</h4>
                  <div>
                     <p>Oracle SQLJ运行时包括您可能直接导入和使用的包，以及仅间接使用的其他包。</p>
                     <div class="infoboxnote" id="GUID-7B13542C-1664-40CC-882A-C44361F817F0__GUID-3D1FF1CA-E3FE-4CFA-B7FC-89D8CE366AEA">
                        <p class="notep1">注意：</p>
                        <p>这些包包含在运行时库<code class="codeph">runtime12</code> ， <code class="codeph">runtime12ee</code>和<code class="codeph">runtime</code> 。
                        </p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-7B13542C-1664-40CC-882A-C44361F817F0__GUID-A2D72335-C3EF-42A9-A922-CB3F495EA780">直接使用的包</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>包含可以在应用程序中直接导入和使用的类的包是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">sqlj.runtime</code></p>
                              <p>该软件包包括<code class="codeph">ExecutionContext</code>类， <code class="codeph">ConnectionContext</code>接口， <code class="codeph">ConnectionContextFactory</code>接口， <code class="codeph">ResultSetIterator</code>接口， <code class="codeph">ScrollableResultSetIterator</code>接口以及流的包装类（ <code class="codeph">BinaryStream</code>和<code class="codeph">CharacterStream</code> ，以及不推荐使用的<code class="codeph">AsciiStream</code>和<code class="codeph">UnicodeStream</code> ）。
                              </p>
                              <p>此包中的接口和抽象类由<code class="codeph">sqlj.runtime.ref</code>或<code class="codeph">oracle.sqlj.runtime</code>包中的类或SQLJ转换器生成的类实现。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">sqlj.runtime.ref</code></p>
                              <p>此包中的类实现了<code class="codeph">sqlj.runtime</code>包中的接口和抽象类。您可能会使用<code class="codeph">sqlj.runtime.ref.DefaultContext</code>类，用于指定默认连接并创建默认连接上下文实例。SQLJ在内部使用此包中的其他类在代码生成期间定义类，例如在SQLJ代码中声明的迭代器类和连接上下文类。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.sqlj.runtime</code></p>
                              <p>此包包含可用于实例化<code class="codeph">DefaultContext</code>类并建立默认连接的<code class="codeph">Oracle</code>类。它还包含Oracle实现SQLJ所使用的特定于Oracle的运行时类，包括与Oracle类型扩展进行转换的功能。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-7B13542C-1664-40CC-882A-C44361F817F0__GUID-C92F0F02-A7A6-4653-9414-ED4A6CB1DD25">
                           <p class="notep1">注意：</p>
                           <p>名称以<code class="codeph">oracle</code>开头的软件包用于特定于Oracle的SQLJ功能。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7B13542C-1664-40CC-882A-C44361F817F0__GUID-03F3C57E-F7AB-47A9-B606-07F9FA65EC82">间接使用的包</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>包含供SQLJ内部使用的类的包是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">sqlj.runtime.profile</code></p>
                              <p>此包包含定义SQLJ配置文件外观的接口和抽象类（仅适用于ISO标准代码生成）。这包括<code class="codeph">EntryInfo</code>和<code class="codeph">TypeInfo</code>类。配置文件中的每个条目都由<code class="codeph">EntryInfo</code>对象描述，其中配置文件条目对应于应用程序中的SQL操作。配置文件条目中的每个参数都由<code class="codeph">TypeInfo</code>对象描述。
                              </p>
                              <p>此包中的接口和类由<code class="codeph">sqlj.runtime.profile.ref</code>包中的类实现。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">sqlj.runtime.profile.ref</code></p>
                              <p>此包包含实现<code class="codeph">sqlj.runtime.profile</code>包的接口和抽象类的类，并由SQLJ转换器在定义概要文件时内部使用（仅适用于ISO标准代码生成）。它还提供默认的基于JDBC的运行时实现。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">sqlj.runtime.error</code></p>
                              <p>此包由SQLJ在内部使用，包含可由SQLJ转换器生成的所有通用（非特定于Oracle）错误消息的资源文件。</p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.sqlj.runtime.error</code></p>
                              <p>此包由SQLJ在内部使用，包含可由SQLJ转换器生成的所有特定于Oracle的错误消息的资源文件。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JSQLJ721"></a><div class="props_rev_3"><a id="GUID-6967B6B3-C5EC-4894-803A-31FBA18A3A6B" name="GUID-6967B6B3-C5EC-4894-803A-31FBA18A3A6B"></a><h4 id="JSQLJ-GUID-6967B6B3-C5EC-4894-803A-31FBA18A3A6B" class="sect4">运行时错误的类别</h4>
                  <div>
                     <p>可以通过以下任何方式生成运行时错误：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>SQLJ运行时</p>
                        </li>
                        <li>
                           <p>JDBC驱动程序</p>
                        </li>
                        <li>
                           <p>RDBMS</p>
                        </li>
                     </ul>
                     <p>在任何这些情况下，都会生成SQL异常作为<code class="codeph">java.sql.的实例<code class="codeph">java.sql.SQLException</code>类，或者作为子类，例如<code class="codeph">sqlj.runtime.SQLNullException</code> 。
                     </p>
                     <p>根据错误的来源，可以使用<code class="codeph">getSQLState()</code> ， <code class="codeph">getErrorCode()</code>和<code class="codeph">getMessage()</code>方法从异常中检索有意义的信息。例如，SQLJ错误包括有意义的SQL状态和消息。
                     </p>
                     <p>如果Oracle JDBC驱动程序或RDBMS在运行时生成错误，请查看前缀并查阅相应的文档：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../jjdbc/JDBC-error-messages.html#JJDBC-GUID-F3E50939-FCB2-4254-9B33-43024A0BD6F5" target="_blank"><span class="italic">Oracle数据库JDBC开发人员</span></a> JDBC错误<a href="../jjdbc/JDBC-error-messages.html#JJDBC-GUID-F3E50939-FCB2-4254-9B33-43024A0BD6F5" target="_blank"><span class="italic">指南</span></a></p>
                        </li>
                        <li>
                           <p>有关RDBMS错误的Oracle错误消息文档（请参阅<span class="q">“ <a href="preface.html#GUID-77D8845E-2F3A-4BF8-9501-561D66752F1B">相关文档</a> ”</span> ）</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="JSQLJ722"></a><div class="sect2"><a id="GUID-50785BF7-712B-4BFC-BE22-0E86B626BBA6" name="GUID-50785BF7-712B-4BFC-BE22-0E86B626BBA6"></a><h3 id="JSQLJ-GUID-50785BF7-712B-4BFC-BE22-0E86B626BBA6" class="sect3">翻译和运行时的全球化支持</h3>
               <div>
                  <p>Oracle SQLJ实现使用Java内置功能来支持全球化。本节讨论以下内容：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>SQLJ支持全球化和本地字符编码的基础知识，首先介绍了Oracle实现中字符编码和语言支持的一些实现细节的背景信息</p>
                     </li>
                     <li>
                        <p>通过SQLJ命令行可用的选项，使您可以调整Oracle全球化支持配置</p>
                     </li>
                     <li>
                        <p>扩展的Oracle全球化支持</p>
                     </li>
                     <li>
                        <p>SQLJ之外的相关操作用于全球化支持</p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-50785BF7-712B-4BFC-BE22-0E86B626BBA6__GUID-492C0B3C-7073-4B40-97A9-B04BE1CF98CE">
                     <p class="notep1">注意：</p>
                     <p>假定有一些Oracle全球化支持的先验知识，尤其是关于字符编码和语言环境的知识。有关信息，请参阅：</p><a href="../nlspg/choosing-character-set.html#NLSPG-GUID-1943C2FB-0438-45AD-A82B-D4090A3F4A94" target="_blank"><span><cite>Oracle数据库全球化支持指南</cite></span></a></div>
                  <p>本节包括以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-6AC46A6E-C8DD-4BD2-908E-76FAB9BA2027">字符编码和语言支持</a></p>
                     </li>
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-7C321BCC-133C-44AB-BEE0-02B418720E95">用于字符编码和语言支持的SQLJ和Java设置</a></p>
                     </li>
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077">SQLJ扩展全球化支持</a></p>
                     </li>
                     <li>
                        <p><a href="translator-run-time-functionality.html#GUID-6E2C17A1-CEE6-4BE7-B7AA-6EE2A9FC3BC3">用于全局化支持的SQLJ之外的操作</a></p>
                     </li>
                  </ul>
               </div><a id="JSQLJ724"></a><a id="JSQLJ725"></a><a id="JSQLJ726"></a><a id="JSQLJ723"></a><div class="props_rev_3"><a id="GUID-6AC46A6E-C8DD-4BD2-908E-76FAB9BA2027" name="GUID-6AC46A6E-C8DD-4BD2-908E-76FAB9BA2027"></a><h4 id="JSQLJ-GUID-6AC46A6E-C8DD-4BD2-908E-76FAB9BA2027" class="sect4">字符编码和语言支持</h4>
                  <div>
                     <p>SQLJ全球化支持有两个主要方面：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>字符编码</p>
                           <p>这有三个部分：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>用于在SQLJ转换期间读取和生成源文件的字符编码</p>
                              </li>
                              <li>
                                 <p>用于在SQLJ转换期间生成错误和状态消息的字符编码</p>
                              </li>
                              <li>
                                 <p>用于在应用程序运行时生成错误和状态消息的字符编码</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>语言支持</p>
                           <p>这决定了SQLJ在SQLJ转换期间或SQLJ运行时向用户输出消息时使用的错误和状态消息列表的转换。</p>
                        </li>
                     </ul>
                     <p>运行时的全球化支持对用户是透明的，假设您的SQLJ源代码和SQL字符数据仅使用数据库字符集中的字符。SQL字符数据透明地映射到Unicode和从Unicode中映射。</p>
                     <p>请注意，对于多语言应用程序，建议使用以下选项之一：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用其字符集支持Unicode的数据库。</p>
                        </li>
                        <li>
                           <p>即使数据库字符集不支持Unicode，也请指定国家语言字符集支持Unicode。（请参阅<a href="../nlspg/overview-of-globalization-support.html#NLSPG-GUID-4530259E-9CA6-4FC3-A024-3EB6C2D90DAE" target="_blank"><span><cite>Oracle数据库全球化支持指南</cite></span></a> 。）在这种情况下，您通常将使用<span class="q">“ <a href="translator-run-time-functionality.html#GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077">SQLJ扩展全球化支持</a> ”中</span>描述的SQLJ Unicode字符类型。
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-6AC46A6E-C8DD-4BD2-908E-76FAB9BA2027__GUID-65C74012-F53D-48E2-B2AE-D5AE254932B4">
                        <p class="notep1">注意：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>SQLJ转换器完全支持Unicode 2.0和Java Unicode转义序列。但是，SQLJ命令行实用程序不支持Unicode转义序列。您只能使用操作系统支持的本机字符。需要Unicode转义序列的命令行选项可以在SQLJ属性文件中输入，因为属性文件确实支持Unicode转义序列。</p>
                           </li>
                           <li>
                              <p>嵌入式SQL操作中的字符编码和转换以及读取或写入数据库的字符都由JDBC直接处理。SQLJ在这方面没有发挥作用。但是，如果在转换期间启用了在线语义检查，那么如果SQL数据操作语言（DML）操作的文本中可能无法转换为数据库字符集，则会发出警告。</p>
                           </li>
                           <li>
                              <p>有关JDBC全球化支持功能的信息，请参阅<a href="../jjdbc/globalization-support.html#JJDBC-GUID-CE02B998-DD6A-46FC-8ECF-AD2413F09A97" target="_blank"><span class="italic">Oracle数据库JDBC开发人员指南</span> <span><cite>Oracle数据库JDBC开发人员指南</cite></span></a> 。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-6AC46A6E-C8DD-4BD2-908E-76FAB9BA2027__GUID-102F5957-EA23-409B-A409-CBDB384F4D19">字符编码概述</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>源文件的字符编码设置告诉SQLJ两件事：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>源代码如何在<code class="codeph">.sqlj</code>和<code class="codeph">.java</code>输入文件中表示，SQLJ转换器必须读取这些文件</p>
                           </li>
                           <li>
                              <p>SQLJ应如何表示它生成的<code class="codeph">.java</code>输出文件中的源代码</p>
                           </li>
                        </ul>
                        <p>默认情况下，SQLJ使用JVM <code class="codeph">file.encoding</code>属性指示的编码。如果源文件使用其他编码，则必须将此指示给SQLJ，以便可以执行适当的转换。
                        </p>
                        <p>使用SQLJ <code class="codeph">-encoding</code>选项来完成此任务。SQLJ还将<code class="codeph">-encoding</code>设置传递给编译器，以便它用于读取<code class="codeph">.java</code>文件，除非SQLJ <code class="codeph">-compiler-encoding-flag</code>关闭。
                        </p>
                        <div class="infoboxnote" id="GUID-6AC46A6E-C8DD-4BD2-908E-76FAB9BA2027__GUID-FE482270-838A-4B55-8DDC-5981880D5C9A">
                           <p class="notep1">注意：</p>
                           <p>请勿更改<code class="codeph">file.encoding</code>系统属性以指定源文件的编码。这可能会影响Java操作的其他方面，并且可能仅提供有限数量的编码，具体取决于平台或操作系统注意事项。
                           </p>
                        </div>
                        <p>系统字符编码设置还确定在转换期间或最终用户运行应用程序的运行时期间输出给用户时SQLJ错误和状态消息的表示方式。这是根据<code class="codeph">file.encoding</code>属性设置的，不受SQLJ <code class="codeph">-encoding</code>选项的影响。
                        </p>
                        <p>对于源文件编码，你可以使用<code class="codeph">-encoding</code>选项来指定由您的Java环境支持的任何字符编码。如果您使用的是Sun Microsystems JDK，则可以在<code class="codeph">native2ascii</code>文档中列出这些文档，您可以在以下Web站点中找到它们：</p>
                        <p>https://docs.oracle.com/javase/8/docs/technotes/tools/windows/native2ascii.html</p>
                        <p>Sun Microsystems JDK支持数十种编码。这些包括<code class="codeph">8859_1</code>至<code class="codeph">8859_9</code> （ISO Latin-1至ISO Latin-9）， <code class="codeph">JIS</code> （日语）， <code class="codeph">SJIS</code> （shift-JIS，日语）和<code class="codeph">UTF8</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6AC46A6E-C8DD-4BD2-908E-76FAB9BA2027__GUID-029CAE8C-7E24-42D7-BD90-63C57C273B92">字符编码注释</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>请注意以下事项：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>对于消息或源文件使用的编码中无法表示的字符始终可以表示为Java Unicode转义序列。其形式为<code class="codeph">\uHHHH</code> ，其中每个H是十六进制数字。
                              </p>
                           </li>
                           <li>
                              <p>在转换期间读取和处理<code class="codeph">.sqlj</code>源文件时，错误消息根据输入编码中的字符位置（而不是字节位置）引用源位置。
                              </p>
                           </li>
                           <li>
                              <p>通过SQLJ <code class="codeph">-encoding</code>选项或Java <code class="codeph">file.encoding</code>设置设置的<code class="codeph">-encoding</code>设置不适用于Java属性文件，例如<code class="codeph">sqlj.properties</code>和<code class="codeph">connect.properties</code> 。属性文件始终使用编码<code class="codeph">8859_1</code> 。这是Java的一个特性，特别是SQLJ。但是，您可以在属性文件中使用Unicode转义序列。您可以使用<code class="codeph">native2ascii</code>实用程序来确定转义序列。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6AC46A6E-C8DD-4BD2-908E-76FAB9BA2027__GUID-102D475A-333F-428C-B2C8-C5412CD91BBB">语言支持概述</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>在转换期间或运行时期间，SQLJ错误和状态报告使用JVM <code class="codeph">user.language</code>属性中的Java语言环境设置。用户通常不必更改此设置。
                        </p>
                        <p>语言支持通过使用键/值对的消息资源实现。例如，在英语资源具有键/值对<code class="codeph">"OkKey", "Okay"</code> ，德语语言资源具有键/值对<code class="codeph">"OkKey", "Gut"</code> 。区域设置确定使用的消息资源。
                        </p>
                        <p>SQLJ支持<code class="codeph">en</code> （英语）， <code class="codeph">de</code> （德语）， <code class="codeph">fr</code> （法语）和<code class="codeph">ja</code> （日语）的语言环境设置。
                        </p>
                        <div class="infoboxnote" id="GUID-6AC46A6E-C8DD-4BD2-908E-76FAB9BA2027__GUID-0E66AB31-70FE-43CA-AA4D-2021374A40E4">
                           <p class="notep1">注意：</p>
                           <p>除语言扩展外，Java语言环境设置还可以支持国家/地区和变体扩展。例如，考虑<code class="codeph">ErrorMessages_de_CH_var1</code> ，其中<code class="codeph">CH</code>是德语的瑞士国家/地区扩展名， <code class="codeph">var1</code>是另一种变体。但是，SQLJ目前仅支持语言扩展（在本例中为<code class="codeph">de</code> ），忽略了国家和变体扩展。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JSQLJ728"></a><a id="JSQLJ729"></a><a id="JSQLJ730"></a><a id="JSQLJ727"></a><div class="sect3"><a id="GUID-7C321BCC-133C-44AB-BEE0-02B418720E95" name="GUID-7C321BCC-133C-44AB-BEE0-02B418720E95"></a><h4 id="JSQLJ-GUID-7C321BCC-133C-44AB-BEE0-02B418720E95" class="sect4">用于字符编码和语言支持的SQLJ和Java设置</h4>
                  <div>
                     <p>Oracle SQLJ实现提供了一些语法，使您可以设置以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>SQLJ转换程序和Java编译器在表示源代码时使用的字符编码</p>
                           <p>使用SQLJ <code class="codeph">-encoding</code>选项。
                           </p>
                        </li>
                        <li>
                           <p>SQLJ转换程序使用的字符编码和运行时表示错误和状态消息</p>
                           <p>使用SQLJ <code class="codeph">-J</code>前缀设置Java <code class="codeph">file.encoding</code>属性。
                           </p>
                        </li>
                        <li>
                           <p>SQLJ转换程序使用的语言环境以及错误和状态消息的运行时</p>
                           <p>使用SQLJ <code class="codeph">-J</code>前缀设置Java <code class="codeph">user.language</code>属性。
                           </p>
                        </li>
                     </ul>
                     <div class="section">
                        <p class="subhead3" id="GUID-7C321BCC-133C-44AB-BEE0-02B418720E95__GUID-083A5F6D-FE73-4173-BF42-BBAF7A20A49B">设置源代码的字符编码</p>
                     </div>
                     <!-- class="section" -->
                     <p>使用SQLJ <code class="codeph">-encoding</code>选项，以确定代表使用的字符编码<code class="codeph">.sqlj</code>翻译者读取文件， <code class="codeph">.java</code>通过翻译生成的文件和<code class="codeph">.java</code>文件编译器读取。除非SQLJ <code class="codeph">-compiler-encoding-flag</code>关闭，否则选项设置由SQLJ传递给编译<code class="codeph">-compiler-encoding-flag</code> 。
                     </p>
                     <p>可以在命令行或<code class="codeph">SQLJ_OPTIONS</code>环境变量上设置此选项，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">-encoding = SJIS</pre><p>或者，您可以在SQLJ属性文件中设置它，如下所示：</p><pre class="oac_no_warn" dir="ltr">sqlj.encoding = SJIS</pre><p>如果未设置编码选项，则转换程序和编译器将使用JVM <code class="codeph">file.encoding</code>属性中指定的编码。这也可以通过SQLJ命令行设置。
                     </p>
                     <div class="infoboxnotealso" id="GUID-7C321BCC-133C-44AB-BEE0-02B418720E95__GUID-A96C4CEA-17D8-4D6A-8033-5DCC853F1CA4">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="translator-command-line-and-options.html#GUID-93FF52FC-8C29-488C-B82D-FFA8A6C5A03B">输入和输出源文件的编码（-encoding）</a> ”</span>和<span class="q">“ <a href="translator-command-line-and-options.html#GUID-A0033E23-525B-4538-80FE-4BA1641EB245">编译器编码支持（-compiler-encoding-flag）</a> ”</span> <a href="translator-command-line-and-options.html#GUID-93FF52FC-8C29-488C-B82D-FFA8A6C5A03B">输入和输出源文件的编码（-encoding）</a></p>
                     </div>
                     <div class="infoboxnote" id="GUID-7C321BCC-133C-44AB-BEE0-02B418720E95__GUID-1948CD1C-346B-49C0-B0CF-458C5F80CDA3">
                        <p class="notep1">注意：</p>
                        <p>如果要将<code class="codeph">-encoding</code>常规设置为相同的值，则最方便在属性文件中指定它，如第二个示例中所示。
                        </p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-7C321BCC-133C-44AB-BEE0-02B418720E95__GUID-4738A92C-0A71-41EB-8C71-360AE15C0803">设置SQLJ消息的字符编码和区域设置</p>
                     </div>
                     <!-- class="section" -->
                     <p>在转换和运行时期间生成的SQLJ错误和状态消息的字符编码和语言环境由Java <code class="codeph">file.encoding</code>和<code class="codeph">user.language</code>属性决定。虽然通常不需要，但您可以使用SQLJ <code class="codeph">-J</code>前缀在SQLJ命令行中设置这些和其他JVM属性。标记为此前缀的选项将传递给JVM。</p>
                     <p>设置字符编码，如下例所示，它指定shift-JIS日语字符编码：</p><pre class="oac_no_warn" dir="ltr">-J-指定-Dfile.encoding = SJIS</pre><div class="infoboxnote" id="GUID-7C321BCC-133C-44AB-BEE0-02B418720E95__GUID-5C986A56-69B9-4088-9F84-315075C821FB">
                        <p class="notep1">注意：</p>
                        <p>根据平台或操作系统的考虑，可能只提供有限数量的编码。</p>
                     </div>
                     <p>设置语言环境，如以下示例所示（指定日语语言环境）：</p><pre class="oac_no_warn" dir="ltr">-J-Duser.language = JA</pre><p><code class="codeph">-J</code>前缀只能在命令行或<code class="codeph">SQLJ_OPTIONS</code>环境变量中使用。它不能在属性文件中使用，因为在调用JVM之后会读取属性文件。
                     </p>
                     <div class="infoboxnote" id="GUID-7C321BCC-133C-44AB-BEE0-02B418720E95__GUID-9EC673A6-05E7-49D4-BDEF-C0920C27EAFC">
                        <p class="notep1">注意：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果要将<code class="codeph">file.encoding</code> ， <code class="codeph">user.language</code>或任何其他Java属性定期设置为相同的值，则最方便的是在<code class="codeph">SQLJ_OPTIONS</code>环境变量中指定<code class="codeph">-J</code>设置。这样，您不必在命令行上重复指定它们。语法与命令行上的语法基本相同。有关更多信息，请参阅<span class="q">“ <a href="translator-command-line-and-options.html#GUID-599F34B4-58F0-45FD-ACCF-F2AA34508546">选项设置的SQLJ_OPTIONS环境变量</a> ”</span> 。
                              </p>
                           </li>
                           <li>
                              <p>请记住，如果未设置SQLJ <code class="codeph">-encoding</code>选项，则设置<code class="codeph">file.encoding</code>将影响源文件的编码以及错误和状态消息。
                              </p>
                           </li>
                           <li>
                              <p>请注意，更改<code class="codeph">file.encoding</code>属性可能会对Java操作的其他方面产生无法预料的后果。此外，任何新设置都必须与您的操作系统兼容。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-7C321BCC-133C-44AB-BEE0-02B418720E95__GUID-328B9DEE-83B9-4A3E-A12E-50B7EBCE837A">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="translator-command-line-and-options.html#GUID-763B9DED-7755-408F-9DD1-5679118979B2">命令行语法和操作</a> ”</span>和<span class="q">“ <a href="translator-command-line-and-options.html#GUID-A54F8576-478C-4A96-9B9E-EA8778FD91B0">传递给Java虚拟机的选项</a> ”</span></p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-7C321BCC-133C-44AB-BEE0-02B418720E95__GUID-B3113754-5A5F-40F8-A393-CA400940F270">SQLJ命令行示例：设置编码和区域设置</p>
                     </div>
                     <!-- class="section" -->
                     <p>以下是完整的SQLJ命令行，包括JVM <code class="codeph">file.encoding</code>和<code class="codeph">user.language</code>设置：</p><pre class="oac_no_warn" dir="ltr">％sqlj -encoding = 8859_1 -J-Dfile.encoding = SJIS -J-Duser.language = ja Foo.sqlj</pre><p>此示例使用SQLJ <code class="codeph">-encoding</code>选项指定<code class="codeph">8859_1</code> SQLJ翻译过程中的源代码表示（Latin-1的）。翻译器在读取<code class="codeph">.sqlj</code>输入文件和生成<code class="codeph">.java</code>输出文件时使用此编码。然后将编码传递给Java编译器，以用于读取生成的<code class="codeph">.java</code>文件。该<code class="codeph">-encoding</code>选项，指定时，总是传递给Java编译器，除非SQLJ <code class="codeph">-compiler-encoding-flag</code>被禁用。
                     </p>
                     <p>对于在<code class="codeph">Foo.sqlj</code>的转换期间输出的错误和状态消息，SQLJ转换器使用<code class="codeph">SJIS</code>编码和<code class="codeph">ja</code>语言环境。
                     </p>
                  </div>
               </div><a id="JSQLJ732"></a><a id="JSQLJ733"></a><a id="JSQLJ734"></a><a id="JSQLJ735"></a><a id="JSQLJ731"></a><div class="sect3"><a id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077" name="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077"></a><h4 id="JSQLJ-GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077" class="sect4">SQLJ扩展全球化支持</h4>
                  <div>
                     <p>Oracle SQLJ实现包括对从现有字符和流类型派生的Java类型（Unicode字符类型）的支持，这些类型传达了全球化的预期用法。在SQLJ中，不可能直接使用JDBC语句或结果集方法，否则这些方法将用于全球化支持。如果您对有关这些方法的信息感兴趣，请参阅<a href="../jjdbc/globalization-support.html#JJDBC-GUID-CE02B998-DD6A-46FC-8ECF-AD2413F09A97" target="_blank"><span class="italic">Oracle数据库JDBC开发人员指南</span></a></p>
                     <p>如果数据库本身支持Unicode，则不需要以下部分中描述的类型。在这种情况下，全球化支持将以透明方式处理。当数据库本身不支持Unicode，但具有支持Unicode的国家语言字符集时，通常会使用这些类型（对于使用本地语言字符集的列）。</p>
                     <div class="section" id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077__CHEBDEFG">
                        <p class="subhead3" id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077__GUID-07468B05-0A0D-4AA6-B59D-D359315FC6A6">全球化支持的Java类型</p>
                     </div>
                     <!-- class="section" -->
                     <p>Oracle SQLJ实现提供了许多用于全球化支持的Java类型。下表说明了这些全球化支持类型与通用JDBC和SQLJ字符和流类型之间的对应关系。除<code class="codeph">NString</code>之外，每个全球化支持类型都是其对应的JDBC或SQLJ类型的子类。
                     </p>
                     <div class="tblformal" id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077__CHEBEAGE">
                        <p class="titleintable">表10-3 JDBC和SQLJ类型以及相应的全球化类型</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="JDBC和SQLJ类型以及相应的全球化类型" width="100%" border="1" summary="This table describes the JDBC and SQLJ Types and the corresponding Globalization Types." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="43%" id="d61763e2473">JDBC和SQLJ类型</th>
                                 <th align="left" valign="bottom" width="57%" id="d61763e2476">全球化支持类型</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="43%" id="d61763e2486" headers="d61763e2473 ">
                                    <p><span class="bold">JDBC类型：</span></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d61763e2486 d61763e2476 ">
                                    <p> </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="43%" id="d61763e2494" headers="d61763e2473 ">
                                    <p><code class="codeph">oracle.sql。CHAR</code></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d61763e2494 d61763e2476 ">
                                    <p><code class="codeph">oracle.sql。NCHAR</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="43%" id="d61763e2503" headers="d61763e2473 ">
                                    <p><code class="codeph">java.lang中。串</code></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d61763e2503 d61763e2476 ">
                                    <p><code class="codeph">oracle.sql。NString</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="43%" id="d61763e2512" headers="d61763e2473 ">
                                    <p><code class="codeph">oracle.sql。CLOB</code></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d61763e2512 d61763e2476 ">
                                    <p><code class="codeph">oracle.sql。NCLOB</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="43%" id="d61763e2521" headers="d61763e2473 ">
                                    <p><span class="bold">SQLJ类型：</span></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d61763e2521 d61763e2476 ">
                                    <p> </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="43%" id="d61763e2529" headers="d61763e2473 ">
                                    <p><code class="codeph">sqlj.runtime。CharacterStream</code></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d61763e2529 d61763e2476 ">
                                    <p><code class="codeph">oracle.sqlj.runtime。NcharCharacterStream</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="43%" id="d61763e2538" headers="d61763e2473 ">
                                    <p><code class="codeph">sqlj.runtime。AsciiStream</code></p>
                                    <p>（已弃用;使用<code class="codeph">CharacterStream</code> 。）
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d61763e2538 d61763e2476 ">
                                    <p><code class="codeph">oracle.sqlj.runtime。NcharAsciiStream</code></p>
                                    <p>（不推荐使用;使用<code class="codeph">NcharCharacterStream</code> 。）
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="43%" id="d61763e2557" headers="d61763e2473 ">
                                    <p><code class="codeph">sqlj.runtime。UnicodeStream</code></p>
                                    <p>（已弃用;使用<code class="codeph">CharacterStream</code> 。）
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d61763e2557 d61763e2476 ">
                                    <p><code class="codeph">oracle.sqlj.runtime。NcharUnicodeStream</code></p>
                                    <p>（不推荐使用;使用<code class="codeph">NcharCharacterStream</code> 。）
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>在应用程序必须处理国家语言字符串的情况下，要么将它们插入或从国家语言字符集列中选择它们，请使用全球化支持类型而不是相应的通用类型。</p>
                     <div class="infoboxnote" id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077__GUID-73297022-6B89-4B71-AC27-C6B69D644137">
                        <p class="notep1">注意：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>所有全球化支持类型都为<code class="codeph">IN</code>和<code class="codeph">OUT</code>参数添加了预期用途的自动注册，但在使用方面与相应的JDBC或SQLJ类型（包括构造函数）相同。
                              </p>
                           </li>
                           <li>
                              <p>迭代器列中不需要使用全球化支持类型，因为底层网络协议隐式支持底层结果集的国家语言字符。</p>
                           </li>
                        </ul>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077__GUID-03FECBDD-202E-473C-9898-8BD6399E2F71">NString类用法和注释</p>
                     </div>
                     <!-- class="section" -->
                     <p><code class="codeph">oracle.sql.CHAR</code>类及其<code class="codeph">NCHAR</code>子类仅提供需要显式知道数据库字符集的构造函数。因此， <code class="codeph">oracle.sql.NString</code>类， <code class="codeph">java.lang.的包装器<code class="codeph">java.lang.String</code> ，在大多数情况下是优选的。<code class="codeph">NString</code>类提供更简单的构造函数，并确保使用JDBC驱动程序注册使用的国家语言字符形式。
                     </p>
                     <p>以下是关键的<code class="codeph">NString</code>方法：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">NString(String)</code> ：此构造函数从现有<code class="codeph">String</code>实例创建<code class="codeph">NString</code>实例。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">String toString()</code> ：此方法返回基础<code class="codeph">String</code>实例。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">String getString()</code> ：此方法还返回基础<code class="codeph">String</code>实例。
                           </p>
                        </li>
                     </ul>
                     <p><code class="codeph">toString()</code>方法使您可以在字符串连接表达式中使用<code class="codeph">NString</code>实例（例如<code class="codeph">"a"+b</code> ，其中<code class="codeph">b</code>是字符串）。<code class="codeph">CHAR</code>超类中提供的<code class="codeph">getString()</code>方法也支持一致性。此外， <code class="codeph">String</code>类的成员方法被转移到<code class="codeph">NString</code>包装器类，使您能够编写更简洁的代码。
                     </p>
                     <p>在SQLJ应用程序，用于Oracle以前版本数据库11 <span class="italic">克</span> ，则必须使用的主机变量<code class="codeph">NString</code>类型绑定列<code class="codeph">NCHAR</code>类型。例如，请考虑下表：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE Tbl1（ColA CHAR NColB NCHAR）</pre><p>要通过SQLJ应用程序在此表中插入行，请使用类似于以下内容的代码：</p><pre class="oac_no_warn" dir="ltr">...String v_a =“\ uFF5E”; NString v_nb =“\ uFF5E”; #sql {INSERT INTO Tbl1（ColA，NColB）VALUES（：v_a，：v_nb）}; ...
</pre><p>从Oracle Database <span class="italic">11g</span>第1版开始，SQLJ应用程序可以使用<code class="codeph">String</code>变量来绑定<code class="codeph">NCHAR</code>列。因此，前面的例子可以重写如下：</p><pre class="oac_no_warn" dir="ltr">...String v_a =“\ uFF5E”; String v_nb =“\ uFF5E”; #sql {INSERT INTO Tbl1（ColA，NColB）VALUES（：v_a，：v_nb）}; ...
</pre><p>但是，如果要使用<code class="codeph">String</code>主机变量绑定到<code class="codeph">NCHAR</code>列，则必须使用<code class="codeph">-ncharconv</code> SQLJ转换器选项转换SQLJ文件，如下所示：</p><pre class="oac_no_warn" dir="ltr">sqlj -ncharconv [ - <span class="italic">options</span> ] app.sqlj</pre><p>在上面的命令中， <span class="italic"><code class="codeph">options</code></span>可以是其他SQLJ选项， <code class="codeph">app.sqlj</code>是包含代码的SQLJ文件。
                     </p>
                     <p>使用此选项时， <a id="d61763e2729" class="indexterm-anchor"></a> <code class="codeph">setFormOfUse</code>字符列的所有绑定生成<code class="codeph">setFormOfUse</code>方法，即<code class="codeph">CHAR</code>或<code class="codeph">NCHAR</code>列。
                     </p>
                     <div class="infoboxnote" id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077__GUID-8BF3E3E9-0693-4800-B491-1F7307006EFE">
                        <p class="notep1">注意：</p>
                        <p>使用<code class="codeph">-ncharconv</code>选项编译SQLJ文件时， <code class="codeph">setFormOfUse</code>方法将在生成的<code class="codeph">setFormOfUse</code> <code class="codeph">codegen=oracle</code>代码中使用。对于<code class="codeph">codegen=iso</code> ，此选项信息将传递给Oracle SQLJ运行时，该运行时在运行时内部使用<code class="codeph">SetFormOfUse</code>进行绑定。
                        </p>
                     </div>
                     <p>SQLJ应用程序可以使用<code class="codeph">String</code>主机变量从服务器检索数据而不使用<code class="codeph">-ncharconv</code>选项，因为有关列类型的信息是在客户端获取的，而JDBC在内部设置适当列的表单。
                     </p>
                     <div class="infoboxnote" id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077__GUID-C088CCBF-FF10-416C-AA7A-9C051840498E">
                        <p class="notep1">注意：</p>
                        <p>使用<code class="codeph">-ncharconv</code>选项时，性能可能会有很小的差异，具体取决于数据库字符集和国家字符集以及表中的字符列数。
                        </p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077__GUID-3FB8EF78-3CAB-4AB4-93EC-951A4B0E23AB">全球化支持实例</p>
                     </div>
                     <!-- class="section" -->
                     <p>以下示例显示了<code class="codeph">NString</code>类的<code class="codeph">NString</code> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">NString</code>作为<code class="codeph">IN</code>参数</p>
                           <p>此示例使用<code class="codeph">NString</code>实例作为数据库的输入参数。
                           </p><pre class="oac_no_warn" dir="ltr">import oracle.sql。NString; ...NString nc_name = new NString（“带有奇怪字符的名字”）; #sql {update PEOPLE set city = :( new NString（“\ ufff2”）），name =：nc_name其中num =：n}; ...
</pre></li>
                        <li id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077__I1006452">
                           <p><code class="codeph">NString</code>作为<code class="codeph">OUT</code>参数</p>
                           <p>此示例使用<code class="codeph">NString</code>实例作为数据库的输出参数。
                           </p><pre class="oac_no_warn" dir="ltr">import oracle.sql。NString; ...NString nstr; #sql {call foo（：out nstr）}; System.out.println（“结果是：”+ nstr）; //或者，显式：System.out.println（“Result is：”+ nstr.toString（））; ...
</pre></li>
                        <li>
                           <p><code class="codeph">NString</code>作为<code class="codeph">Result Set</code>列</p>
                           <p>此示例将<code class="codeph">NString</code>类型用于迭代器列。这种用法是多余的，因为底层网络协议隐含地支持国家语言字符，但是无害。此示例还显示了一个<code class="codeph">String</code>方法<code class="codeph">substring()</code> ，该方法被转移到<code class="codeph">NString</code> 。
                           </p><pre class="oac_no_warn" dir="ltr">import oracle.sql。NString; import oracle.sql。NCLOB; ...#sql iterator NIter（NString title，NCLOB文章）;尼特; #sql nit = {SELECT article，title FROM page_table}; while（nit.next（））{System.out.println（“&lt;TITLE&gt;”+ nit.title（）+“&lt;/ TITLE&gt;”）; ...nit.article（）。substring（0,1000）; ...}</pre></li>
                     </ul>
                     <div class="infoboxnote" id="GUID-F5BA9A5C-E700-48F6-BEDC-0164574C0077__GUID-EFF353BC-AED4-428E-92F6-9001A0D2D051">
                        <p class="notep1">注意：</p>
                        <p>对于前面的示例，使用<code class="codeph">NCHAR</code>类型而不是<code class="codeph">NString</code>类型需要进行以下更改：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用适当的<code class="codeph">NCHAR</code>构造函数。<code class="codeph">NCHAR</code>构造函数镜像<code class="codeph">CHAR</code>构造函数，如下所示：</p><pre class="oac_no_warn" dir="ltr">NCHAR（String str，oracle.sql。CharacterSet charset）</pre></li>
                           <li>
                              <p>虽然您可以选择使用<code class="codeph">toString()</code>或<code class="codeph">getString()</code>从<code class="codeph">NString</code>实例检索基础<code class="codeph">String</code>实例，但对于<code class="codeph">NCHAR</code>实例，您必须使用<code class="codeph">getString()</code>方法。使用<code class="codeph">NString</code>类型时， <code class="codeph">toString()</code>方法将自动用于字符串连接。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="JSQLJ737"></a><a id="JSQLJ738"></a><a id="JSQLJ739"></a><a id="JSQLJ736"></a><div class="sect3"><a id="GUID-6E2C17A1-CEE6-4BE7-B7AA-6EE2A9FC3BC3" name="GUID-6E2C17A1-CEE6-4BE7-B7AA-6EE2A9FC3BC3"></a><h4 id="JSQLJ-GUID-6E2C17A1-CEE6-4BE7-B7AA-6EE2A9FC3BC3" class="sect4">用于全局化支持的SQLJ之外的操作</h4>
                  <div>
                     <p>本节讨论在SQLJ之外操作Oracle全球化支持配置的方法。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-6E2C17A1-CEE6-4BE7-B7AA-6EE2A9FC3BC3__GUID-20756741-CC60-4117-8883-CB0BFE7FAB28">在应用程序运行时设置编码和区域设置</p>
                     </div>
                     <!-- class="section" -->
                     <p>与运行任何Java应用程序的任何最终用户一样，运行SQLJ应用程序的用户可以在调用JVM来运行应用程序时直接指定JVM属性，例如<code class="codeph">file.encoding</code>和<code class="codeph">user.language</code> 。这将确定应用程序执行时用于消息输出的编码和语言环境。
                     </p>
                     <p>他们可以在以下示例中完成此操作：</p><pre class="oac_no_warn" dir="ltr">％java -Dfile.encoding = SJIS -Duser.language = ja Foo</pre><p>这将使用<code class="codeph">SJIS</code>编码和日语语言环境。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-6E2C17A1-CEE6-4BE7-B7AA-6EE2A9FC3BC3__GUID-DE10AD9B-F7C8-4F0C-97CB-D27B5148DCE3">使用API确定Java属性</p>
                     </div>
                     <!-- class="section" -->
                     <p>在Java代码中，您可以使用<code class="codeph">java.lang.确定Java属性的值<code class="codeph">java.lang.System.getProperty()</code>方法，指定适当的属性。例如：</p><pre class="oac_no_warn" dir="ltr">public class Settings {public static void main（String [] args）{System.out.println（“Encoding：”+ System.getProperty（“file.encoding”）+“，Language：”+ System.getProperty（“user。语言”））; }}</pre><p>您可以编译它并将其作为独立实用程序运行。</p>
                     <p>还有一个<code class="codeph">getProperties()</code>方法返回所有属性的值，但如果您尝试在服务器中运行的代码中使用它，则会引发安全性异常。
                     </p>
                     <div class="section" id="GUID-6E2C17A1-CEE6-4BE7-B7AA-6EE2A9FC3BC3__I1006518">
                        <p class="subhead3" id="GUID-6E2C17A1-CEE6-4BE7-B7AA-6EE2A9FC3BC3__GUID-AA921057-67A7-4DF5-9C3F-020081549102">使用native2ascii进行源文件编码</p>
                     </div>
                     <!-- class="section" -->
                     <p>如果您使用的是Sun Microsystems JDK，则可以使用SQLJ为源文件执行字符编码。您可以使用<code class="codeph">native2ascii</code>实用程序将具有本机编码的源转换为具有Unicode转义序列的7位ASCII源。
                     </p>
                     <div class="infoboxnote" id="GUID-6E2C17A1-CEE6-4BE7-B7AA-6EE2A9FC3BC3__GUID-000A9D95-130C-45EE-862F-25C0C8C93B12">
                        <p class="notep1">注意：</p>
                        <p>要使用SQLJ翻译<code class="codeph">native2ascii</code>创建的源，请确保调用SQLJ的JVM具有支持7位ASCII超集的<code class="codeph">file.encoding</code>设置。 EBCDIC或Unicode编码的设置不是这种情况。
                        </p>
                     </div>
                     <p>运行<code class="codeph">native2ascii</code>如下：</p><pre class="oac_no_warn" dir="ltr">％native2ascii &lt; <span class="italic">options</span> &gt; &lt; <span class="italic">inputfile</span> &gt; &lt; <span class="italic">outputfile</span> &gt;</pre><p>如果省略输入文件或输出文件，则使用标准输入或标准输出。支持两个选项：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">-reverse</code> （反转转换。从Latin-1或Unicode转换为本机编码）</p>
                        </li>
                        <li>
                           <p><span class="italic"><code class="codeph">encoding</code></span> <code class="codeph">-encoding &lt;</code> <span class="italic"><code class="codeph">encoding</code></span> <code class="codeph">&gt;</code></p>
                        </li>
                     </ul>
                     <p>例如：</p><pre class="oac_no_warn" dir="ltr">％native2ascii -encoding SJIS Foo.sqlj Temp.sqlj</pre><p>有关更多信息，请访问以下Web站点：</p>
                     <p>https://docs.oracle.com/javase/8/docs/technotes/tools/windows/native2ascii.html</p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>