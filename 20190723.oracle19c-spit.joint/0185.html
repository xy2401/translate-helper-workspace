<html id="04110.distributed-transactions.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>分布式事务</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="JDBC Developer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="JDBC Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="jdbc-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-13T13:20:37-08:00"></meta>
      <meta name="dcterms.title" content="JDBC Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96471-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="transaction-management.html" title="Previous" type="text/html"></link>
      <link rel="next" href="manageability.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="JJDBC"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="transaction-management.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="manageability.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JDBC开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="transaction-management.html" property="item" typeof="WebPage"><span property="name">交易管理</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">分布式事务</li>
            </ol>
            <a id="GUID-FD21627C-0183-4AF3-8719-8490F069A41E" name="GUID-FD21627C-0183-4AF3-8719-8490F069A41E"></a><a id="JJDBC28000"></a>
            
            <h2 id="JJDBC-GUID-FD21627C-0183-4AF3-8719-8490F069A41E" class="sect2"><span class="enumeration_chapter">33</span>分布式事务</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章讨论分布式事务的Oracle Java数据库连接（JDBC）实现。这些是多阶段事务，通常使用多个数据库，必须以协调的方式提交。对于分布式事务，还有一个相关的XA讨论，它是一个通用标准，而不是Java特有的。</p>
               <p>讨论了以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="distributed-transactions.html#GUID-78C5DAB6-46E5-44A4-9EC8-1149FDA176AB">关于分布式交易</a></p>
                  </li>
                  <li>
                     <p><a href="distributed-transactions.html#GUID-178456B8-4C4E-43BB-9097-DF2F269513CB">XA组件</a></p>
                  </li>
                  <li>
                     <p><a href="distributed-transactions.html#GUID-EAB7ACFA-5708-4608-B94D-0D9ECE391D67">错误处理和优化</a></p>
                  </li>
                  <li>
                     <p><a href="distributed-transactions.html#GUID-A1736524-8CB5-4965-89E3-C65C3861E784">关于实现分布式事务</a></p>
                  </li>
                  <li>
                     <p><a href="distributed-transactions.html#GUID-1EF2D070-305D-49D9-9124-16FFDF7CCF74">Oracle JDBC驱动程序中的Native-XA</a></p>
                  </li>
               </ul>
               <div class="infoboxnote" id="GUID-FD21627C-0183-4AF3-8719-8490F069A41E__GUID-91D5AE93-7677-4312-838E-BF70C3A367DE">
                  <p class="notep1">注意：</p>
                  <p>本章讨论JDBC 2.0可选包的功能，以前称为通过<code class="codeph">javax</code>包提供的JDBC 2.0标准扩展应用程序编程接口（API）。
                  </p>
               </div>
               <p>有关分布式事务的更多介绍性和一般信息，请参阅JDBC 2.0可选包和Java Transaction API（JTA）的规范。</p>
            </div><a id="JJDBC28843"></a><div class="props_rev_3"><a id="GUID-78C5DAB6-46E5-44A4-9EC8-1149FDA176AB" name="GUID-78C5DAB6-46E5-44A4-9EC8-1149FDA176AB"></a><h3 id="JJDBC-GUID-78C5DAB6-46E5-44A4-9EC8-1149FDA176AB" class="sect3"><span class="enumeration_section">33.1</span>关于分布式事务</h3>
               <div>
                  <p>该部分包括以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="distributed-transactions.html#GUID-ECD0D367-582D-40F1-99E9-D76ABA451B23">分布式事务概述</a></p>
                     </li>
                     <li>
                        <p><a href="distributed-transactions.html#GUID-1E5899A5-1977-4B25-A98A-B9AC0837EADF">分布式事务组件和方案</a></p>
                     </li>
                     <li>
                        <p><a href="distributed-transactions.html#GUID-D80FEF14-8360-4E0A-B950-AA5B56E98DE8">分布式事务概念</a></p>
                     </li>
                     <li>
                        <p><a href="distributed-transactions.html#GUID-C6290011-D20A-41BD-9FA5-FEDBCD9B4F17">关于在全局和本地事务之间切换</a></p>
                     </li>
                     <li>
                        <p><a href="distributed-transactions.html#GUID-B5EBFDDD-5A19-43C8-A2B7-6838F752800E">Oracle XA包</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-ECD0D367-582D-40F1-99E9-D76ABA451B23" name="GUID-ECD0D367-582D-40F1-99E9-D76ABA451B23"></a><h4 id="JJDBC-GUID-ECD0D367-582D-40F1-99E9-D76ABA451B23" class="sect4"><span class="enumeration_section">33.1.1</span>分布式事务概述</h4>
                  <div>
                     <p><span class="bold">分布式事务</span> （有时称为<span class="bold">全局事务</span> ）是一组必须以协调方式管理的两个或多个相关事务。构成分布式事务的事务可能位于同一数据库中，但更常见的是位于不同的数据库中，并且通常位于不同的位置。分布式事务的每个单独事务称为<span class="bold">事务分支</span> 。
                     </p>
                     <p>例如，分布式交易可能包括从一个银行的账户转移到另一个银行的账户的钱。您不希望任何事务提交，而不保证两者都将成功完成。</p>
                     <p>在JDBC中，分布式事务功能构建在连接池功能之上。此分布式事务功能也基于分布式事务的开放XA标准构建。X A是X / Open标准的一部分，并不是特定于Java的。
                     </p>
                     <p>JDBC用于连接数据库资源。但是，要在事务中包含对多个数据库的所有更改，必须在JTA全局事务中使用JDBC连接。在事务中包含数据库SQL更新的过程称为登记数据库资源。</p>
                  </div>
               </div><a id="JJDBC28844"></a><div class="props_rev_3"><a id="GUID-1E5899A5-1977-4B25-A98A-B9AC0837EADF" name="GUID-1E5899A5-1977-4B25-A98A-B9AC0837EADF"></a><h4 id="JJDBC-GUID-1E5899A5-1977-4B25-A98A-B9AC0837EADF" class="sect4"><span class="enumeration_section">33.1.2</span>分布式事务组件和方案</h4>
                  <div>
                     <div class="section">
                        <p>在阅读分布式事务部分的其余部分时，请牢记以下几点：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>分布式事务系统通常依赖于外部事务管理器，例如实现标准JTA功能的软件组件，以协调各个事务。
                              </p>
                              <p>许多供应商都提供符合XA标准的JTA模块，包括Oracle，其中包括Oracle9 <span class="italic">i</span> Application Server和Oracle Application Server 10 <span class="italic">g中的</span> JTA。
                              </p>
                           </li>
                           <li>
                              <p>XA功能通常与客户端应用程序隔离，而是在中间层环境（例如应用程序服务器）中实现。</p>
                              <p>在许多情况下，应用程序服务器和事务管理器将在中间层上，也可能与一些应用程序代码一起。</p>
                           </li>
                           <li>
                              <p>本节中的讨论主要针对中层开发人员。</p>
                           </li>
                           <li>
                              <p>术语资源管理器通常用于讨论分布式事务。资源管理器只是管理数据或其他类型资源的实体。无论在本章中使用哪个术语，它都指的是数据库。
                              </p>
                              <div class="infoboxnote" id="GUID-1E5899A5-1977-4B25-A98A-B9AC0837EADF__GUID-7B743D14-3A5F-4F39-9B41-EBBC30EBB2E5">
                                 <p class="notep1">注意：</p>
                                 <p>使用JTA功能需要<code class="codeph">jta.jar</code>位于<code class="codeph">CLASSPATH</code>环境变量中。该文件位于<span class="italic"><code class="codeph">ORACLE_HOME</code></span> <code class="codeph">/jlib</code> 。Oracle将此文件包含在JDBC产品中。
                                 </p>
                              </div>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28845"></a><div class="props_rev_3"><a id="GUID-D80FEF14-8360-4E0A-B950-AA5B56E98DE8" name="GUID-D80FEF14-8360-4E0A-B950-AA5B56E98DE8"></a><h4 id="JJDBC-GUID-D80FEF14-8360-4E0A-B950-AA5B56E98DE8" class="sect4"><span class="enumeration_section">33.1.3</span>分布式事务概念</h4>
                  <div>
                     <div class="section">
                        <p>使用XA功能时，事务管理器使用XA资源实例来准备和协调每个事务分支，然后适当地提交或回滚所有事务分支。</p>
                        <p>XA功能包括以下关键组件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>XA <a id="d80952e276" class="indexterm-anchor"></a>数据源</p>
                              <p>这些是连接池数据源和其他数据源的扩展，在概念和功能上类似。</p>
                              <p>将在分布式事务中使用的每个资源管理器将有一个XA数据源实例。您通常会在中间层软件中创建XA数据源实例。</p>
                              <p>XA数据源生成XA连接。</p>
                           </li>
                           <li>
                              <p>XA连接</p>
                              <p>这些是池化连接的扩展，在概念和功能上类似。XA连接封装了物理数据库连接。各个连接实例是这些物理连接的临时句柄。</p>
                              <p>XA连接实例对应于单个Oracle会话，尽管会话可以由多个逻辑连接实例按顺序使用，与池化连接实例一样。</p>
                              <p>您通常会从中间层软件中的XA数据源实例获取XA连接实例。如果分布式事务涉及同一数据库中的多个会话，则可以从单个XA数据源实例获取多个XA连接实例。</p>
                              <p>XA连接生成<code class="codeph">OracleXAResource</code>实例和JDBC连接实例。
                              </p>
                           </li>
                           <li>
                              <p>XA资源</p>
                              <p>这些由事务管理器用于协调分布式事务的事务分支。</p>
                              <p>您将从每个XA连接实例获得一个<code class="codeph">OracleXAResource</code>实例，通常在您的中间层软件中。<code class="codeph">OracleXAResource</code>实例与XA连接实例之间<code class="codeph">OracleXAResource</code>一对一的关联。同样， <code class="codeph">OracleXAResource</code>实例与Oracle会话之间<code class="codeph">OracleXAResource</code>一对一的关联。
                              </p>
                              <p>在典型情况下，中间层组件会将<code class="codeph">OracleXAResource</code>实例<code class="codeph">OracleXAResource</code>给事务管理器，以用于协调分布式事务。
                              </p>
                              <p>每个<code class="codeph">OracleXAResource</code>实例对应一个Oracle会话。因此，在任何给定时间，只能有一个与<code class="codeph">OracleXAResource</code>实例关联的活动事务分支。但是，可以有其他暂停的事务分支。
                              </p>
                              <p>每个<code class="codeph">OracleXAResource</code>实例都具有启动，结束，准备，提交或回滚与<code class="codeph">OracleXAResource</code>实例关联的会话中运行的事务分支的操作的功能。
                              </p>
                              <p>准备步骤是两阶段提交操作的第一步。事务管理器将为每个<code class="codeph">OracleXAResource</code>实例发出<code class="codeph">PREPARE</code> 。一旦事务管理器发现每个事务分支的操作已成功准备，它将向每个<code class="codeph">OracleXAResource</code>实例发出<code class="codeph">COMMIT</code>以提交所有更改。
                              </p>
                           </li>
                           <li>
                              <p>交易ID</p>
                              <p>这些用于标识事务分支。每个ID包括事务分支ID组件和分布式事务ID组件。这是分支与分布式事务关联的方式。与给定分布式事务关联的所有<code class="codeph">OracleXAResource</code>实例都将具有包含相同分布式事务ID组件的事务ID。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">OracleXAResource。ORATRANSLOOSE</code></p>
                              <p>使用事务ID <code class="codeph">xid</code>启动松散耦合的事务。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28847"></a><a id="JJDBC28848"></a><a id="JJDBC28846"></a><div class="props_rev_3"><a id="GUID-C6290011-D20A-41BD-9FA5-FEDBCD9B4F17" name="GUID-C6290011-D20A-41BD-9FA5-FEDBCD9B4F17"></a><h4 id="JJDBC-GUID-C6290011-D20A-41BD-9FA5-FEDBCD9B4F17" class="sect4"><span class="enumeration_section">33.1.4</span>关于全局和本地事务之间的切换</h4>
                  <div>
                     <div class="section">
                        <p><a id="d80952e408" class="indexterm-anchor"></a>应用程序可以共享本地和全局事务之间的连接应用程序还可以在本地事务和全局事务之间切换连接。
                        </p>
                        <p>连接始终处于以下模式之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">NO_TXN</code></p>
                              <p>没有事务正在使用此连接。</p>
                           </li>
                           <li>
                              <p><code class="codeph">LOCAL_TXN</code></p>
                              <p>关闭或禁用自动提交的本地事务正在使用此连接。</p>
                           </li>
                           <li>
                              <p><code class="codeph">GLOBAL_TXN</code></p>
                              <p>全局事务正在使用此连接。</p>
                           </li>
                        </ul>
                        <p>每个连接在这些模式之间自动切换，具体取决于连接上执行的操作。实例化时，连接始终处于<code class="codeph">NO_TXN</code>模式。
                        </p>
                        <div class="infoboxnote" id="GUID-C6290011-D20A-41BD-9FA5-FEDBCD9B4F17__GUID-51AEDDA8-8DFC-4A24-8C5C-79DE922987B7">
                           <p class="notep1">注意：</p>
                           <p>这些模式由JDBC驱动程序内部维护，与Oracle数据库相关联。</p>
                        </div>
                        <p><a href="distributed-transactions.html#GUID-C6290011-D20A-41BD-9FA5-FEDBCD9B4F17__CHDGEBDI" title="表">表33-1</a>介绍了连接模式转换规则。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-C6290011-D20A-41BD-9FA5-FEDBCD9B4F17__CHDGEBDI">
                        <p class="titleintable">表33-1连接模式转换</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="连接模式转换" width="100%" border="1" summary="table" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d80952e460">当前模式</th>
                                 <th align="left" valign="bottom" width="27%" id="d80952e463">切换到NO_TXN时</th>
                                 <th align="left" valign="bottom" width="25%" id="d80952e468">切换到LOCAL_TXN时</th>
                                 <th align="left" valign="bottom" width="28%" id="d80952e471">切换到GLOBAL_TXN时</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d80952e476" headers="d80952e460 ">
                                    <p><code class="codeph">NO_TXN</code></p>
                                 </td>
                                 <td align="left" valign="top" width="27%" headers="d80952e476 d80952e463 ">
                                    <p>NA</p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d80952e476 d80952e468 ">
                                    <p>自动提交模式为false，并运行Oracle数据操作语言（DML）语句。</p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d80952e476 d80952e471 ">
                                    <p>在从提供当前连接的<code class="codeph">XAconnection</code>获取的<code class="codeph">XAResource</code>上调用<code class="codeph">start</code>方法。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d80952e499" headers="d80952e460 ">
                                    <p><code class="codeph">LOCAL_TXN</code></p>
                                 </td>
                                 <td align="left" valign="top" width="27%" headers="d80952e499 d80952e463 ">
                                    <p>发生以下任何一种情况：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>运行Oracle数据定义语言（DDL）语句。</p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">commit</code>被调用。
                                          </p>
                                       </li>
                                       <li>
                                          <p>调用<code class="codeph">rollback</code> ，但没有参数。
                                          </p>
                                       </li>
                                    </ul>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d80952e499 d80952e468 ">
                                    <p>NA</p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d80952e499 d80952e471 ">
                                    <p>在从提供当前连接的<code class="codeph">XAconnection</code>获取的<code class="codeph">XAResource</code>上调用<code class="codeph">start</code>方法。从Oracle Database 12 <span class="italic">c</span>第1版（12.1.0.2）开始提供此功能。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d80952e539" headers="d80952e460 ">
                                    <p><code class="codeph">GLOBAL_TXN</code></p>
                                 </td>
                                 <td align="left" valign="top" width="27%" headers="d80952e539 d80952e463 ">
                                    <p>在此连接上打开的全局事务中，在从提供此连接的<code class="codeph">XAconnection</code>获取的<code class="codeph">XAResource</code>上调用<code class="codeph">end</code> 。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="25%" headers="d80952e539 d80952e468 ">
                                    <p>决不</p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d80952e539 d80952e471 ">
                                    <p>NA</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p>如果这些规则都不适用，则模式不会更改。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C6290011-D20A-41BD-9FA5-FEDBCD9B4F17__GUID-0BE039EC-D760-467A-9AAC-E900145458EA">操作的模式限制</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>当前连接模式限制哪些操作在事务中有效。</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在<code class="codeph">LOCAL_TXN</code>模式下，应用程序不得在<code class="codeph">XAResource</code>上调用<code class="codeph">prepare</code> ， <code class="codeph">commit</code> ， <code class="codeph">rollback</code> ， <code class="codeph">forget</code>或<code class="codeph">end</code> 。这样做会导致抛出<code class="codeph">XAException</code> 。
                              </p>
                           </li>
                           <li>
                              <p>在<code class="codeph">GLOBAL_TXN</code>模式下，应用程序不得在<code class="codeph">java.sql.上调用<code class="codeph">commit</code> ， <code class="codeph">rollback</code> ， <code class="codeph">rollback(Savepoint)</code> ， <code class="codeph">setAutoCommit(true)</code>或<code class="codeph">setSavepoint</code> <code class="codeph">java.sql.Connection</code> ，不得在<code class="codeph">oracle.jdbc.上调用<code class="codeph">OracleSetSavepoint</code>或<code class="codeph">oracleRollback</code> <code class="codeph">oracle.jdbc.OracleConnection</code> 。这样做会导致<code class="codeph">SQLException</code> 。
                              </p>
                              <div class="infoboxnote" id="GUID-C6290011-D20A-41BD-9FA5-FEDBCD9B4F17__GUID-B0E41C1E-FDAF-45F2-9BCE-0E5DB459BB89">
                                 <p class="notep1">注意：</p>
                                 <p>此模式限制错误检查是对事务和保存点API的标准错误检查的补充。</p>
                              </div>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28849"></a><div class="props_rev_3"><a id="GUID-B5EBFDDD-5A19-43C8-A2B7-6838F752800E" name="GUID-B5EBFDDD-5A19-43C8-A2B7-6838F752800E"></a><h4 id="JJDBC-GUID-B5EBFDDD-5A19-43C8-A2B7-6838F752800E" class="sect4"><span class="enumeration_section">33.1.5</span> Oracle XA包</h4>
                  <div>
                     <div class="section">
                        <p>Oracle提供以下三个包，这些包具有根据XA标准实现分布式事务功能的类：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">oracle.jdbc.xa</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.jdbc.xa.client</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.jdbc.xa.server</code></p>
                           </li>
                        </ul>
                        <p>XA数据源，XA连接和XA资源的类都在<code class="codeph">client</code>软件包和<code class="codeph">server</code>软件包中。每个的抽象类都在顶级包中。<code class="codeph">OracleXid</code>和<code class="codeph">OracleXAException</code>类位于顶级<code class="codeph">oracle.jdbc.xa</code>包中，因为它们的功能不依赖于代码的运行位置。
                        </p>
                        <p>在中间层方案中，您将导入<code class="codeph">OracleXid</code> ， <code class="codeph">OracleXAException</code>和<code class="codeph">oracle.jdbc.xa.client</code>包。
                        </p>
                        <p>但是，如果您打算在目标Oracle数据库中运行XA代码，则将导入<code class="codeph">oracle.jdbc.xa.server</code>包而不是<code class="codeph">client</code>包。
                        </p>
                        <p>如果将在目标数据库中运行的代码也必须访问远程数据库，则不要导入任何包。相反，您必须完全限定从<code class="codeph">client</code>程序包使用的任何类的名称以访问远程数据库或从<code class="codeph">server</code>程序包访问本地数据库。类名在这些包之间重复。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="JJDBC28850"></a><div class="props_rev_3"><a id="GUID-178456B8-4C4E-43BB-9097-DF2F269513CB" name="GUID-178456B8-4C4E-43BB-9097-DF2F269513CB"></a><h3 id="JJDBC-GUID-178456B8-4C4E-43BB-9097-DF2F269513CB" class="sect3"><span class="enumeration_section">33.2</span> XA组件</h3>
               <div>
                  <div class="section">
                     <p>本节讨论XA组件，即JDBC标准中指定的标准XA接口，以及实现它们的Oracle类。涵盖以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="distributed-transactions.html#GUID-0600DB23-5DBF-4729-AB20-EDBE71EC6CCB">XADatasource接口和Oracle实现</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-transactions.html#GUID-03941C0D-32EF-49E6-934B-6EB080C5A64D">XAConnection接口和Oracle实现</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-transactions.html#GUID-F7013AB7-8F57-4260-A0F6-E7EAEDFBC063">XAResource接口和Oracle实现</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-transactions.html#GUID-CD752E5A-309E-440A-A711-71083DD5B6A6">OracleXAResource方法功能和输入参数</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-transactions.html#GUID-4FE2BFF4-9F22-4752-B571-B44D6F220BDC">Xid接口和Oracle实现</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="JJDBC28851"></a><div class="props_rev_3"><a id="GUID-0600DB23-5DBF-4729-AB20-EDBE71EC6CCB" name="GUID-0600DB23-5DBF-4729-AB20-EDBE71EC6CCB"></a><h4 id="JJDBC-GUID-0600DB23-5DBF-4729-AB20-EDBE71EC6CCB" class="sect4"><span class="enumeration_section">33.2.1</span> XADatasource接口和Oracle实现</h4>
                  <div>
                     <div class="section">
                        <p><code class="codeph">javax.sql.XADataSource</code>接口概述了XA数据源的标准功能，XA数据源是XA连接的工厂。重载的<code class="codeph">getXAConnection</code>方法返回一个XA连接实例，并可选择将用户名和密码作为输入：</p><pre class="oac_no_warn" dir="ltr">公共接口XADataSource {XAConnection getXAConnection（）抛出SQLException; XAConnection getXAConnection（String user，String password）抛出SQLException; ...}</pre><p>Oracle JDBC使用<code class="codeph">OracleXADataSource</code>类实现<code class="codeph">XADataSource</code>接口，该类位于<code class="codeph">oracle.jdbc.xa.client package</code>和<code class="codeph">oracle.jdbc.xa.server</code>包中。
                        </p>
                        <p><code class="codeph">OracleXADataSource</code>类还扩展了<code class="codeph">OracleConnectionPoolDataSource</code>类，该类扩展了<code class="codeph">OracleDataSource</code>类，因此包括所有连接属性。
                        </p>
                        <p><code class="codeph">OracleXADataSource</code>类的<code class="codeph">getXAConnection</code>方法返回XA连接实例的Oracle实现，这些实例是<code class="codeph">OracleXAConnection</code>实例。
                        </p>
                        <div class="infoboxnote" id="GUID-0600DB23-5DBF-4729-AB20-EDBE71EC6CCB__GUID-2771AC67-E5A5-40E5-ACE1-A9EB2F90FFED">
                           <p class="notep1">注意：</p>
                           <p>您可以使用与前面讨论的非池化数据源相同的命名约定，在Java命名目录和接口（JNDI）中注册XA数据源。</p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-0600DB23-5DBF-4729-AB20-EDBE71EC6CCB__GUID-D7E220D5-B021-4FB3-958D-B83FC8FB2B97">
                           <p class="notep1">也可以看看：</p>
                           <p>有关快速连接故障转移的信息，请参阅<a href="../jjucp/fast-connection-failover.html#JJUCP08100" target="_blank"><span class="italic">“JDBC开发人员指南的Oracle通用连接池”</span></a> 。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28852"></a><div class="props_rev_3"><a id="GUID-03941C0D-32EF-49E6-934B-6EB080C5A64D" name="GUID-03941C0D-32EF-49E6-934B-6EB080C5A64D"></a><h4 id="JJDBC-GUID-03941C0D-32EF-49E6-934B-6EB080C5A64D" class="sect4"><span class="enumeration_section">33.2.2</span> XAConnection接口和Oracle实现</h4>
                  <div>
                     <div class="section">
                        <p>与池化连接实例一样，XA连接实例封装了与数据库的物理连接。这将是在生成XA连接实例的XA数据源实例的连接属性中指定的数据库。</p>
                        <p>每个XA连接实例还具有生成<code class="codeph">OracleXAResource</code>实例的功能，该实例将与其对应，以用于协调分布式事务。
                        </p>
                        <p>XA连接实例是实现标准<code class="codeph">javax.sql.的类的实例<code class="codeph">javax.sql.XAConnection</code>接口：</p><pre class="oac_no_warn" dir="ltr">公共接口XAConnection扩展了PooledConnection {javax.jta.xa。XAResource getXAResource（）抛出SQLException; }</pre><p>如您所见， <code class="codeph">XAConnection</code>接口扩展了<code class="codeph">javax.sql.PooledConnection</code>接口，因此它还包括<code class="codeph">getConnection</code> ， <code class="codeph">close</code> ， <code class="codeph">addConnectionEventListener</code>和<code class="codeph">removeConnectionEventListener</code>方法。
                        </p>
                        <p>Oracle JDBC使用<code class="codeph">OracleXAConnection</code>类实现<code class="codeph">XAConnection</code>接口，该类位于<code class="codeph">oracle.jdbc.xa.client package</code>和<code class="codeph">oracle.jdbc.xa.server</code>包中。
                        </p>
                        <p><code class="codeph">OracleXAConnection</code>类还扩展了<code class="codeph">OraclePooledConnection</code>类。
                        </p>
                        <p><code class="codeph">OracleXAConnection</code>类<code class="codeph">getXAResource</code>方法返回<code class="codeph">OracleXAResource</code>实例的Oracle实现，该实例是<code class="codeph">OracleXAResource</code>实例。<code class="codeph">getConnection</code>方法返回<code class="codeph">OracleConnection</code>实例。
                        </p>
                        <p>XA连接实例返回的JDBC连接实例充当物理连接的临时句柄，而不是封装物理连接。物理连接由XA连接实例封装。从<code class="codeph">XAConnection</code>对象获取的连接的行为与常规连接完全相同，直到它参与全局事务。那时，自动提交状态设置为<code class="codeph">false</code> 。全局事务结束后，自动提交状态将返回到全局事务之前的值。在Oracle Database <span class="italic">10g</span>之前的所有版本中，从<code class="codeph">XAConnection</code>获取的连接上的默认自动提交状态为<code class="codeph">false</code> 。从Oracle Database 10 <span class="italic">g开始</span> ，默认状态为<code class="codeph">true</code> 。
                        </p>
                        <p>每次调用XA连接实例<code class="codeph">getConnection</code>方法时，它都会返回一个展示默认行为的新连接实例，并关闭任何以前仍然存在且已由同一XA连接实例返回的连接实例。但是，建议在打开新连接实例之前显式关闭它。
                        </p>
                        <p>调用XA连接实例的<code class="codeph">close</code>方法会关闭与数据库的物理连接。这通常在中间层执行。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28853"></a><div class="props_rev_3"><a id="GUID-F7013AB7-8F57-4260-A0F6-E7EAEDFBC063" name="GUID-F7013AB7-8F57-4260-A0F6-E7EAEDFBC063"></a><h4 id="JJDBC-GUID-F7013AB7-8F57-4260-A0F6-E7EAEDFBC063" class="sect4"><span class="enumeration_section">33.2.3</span> XAResource接口和Oracle实现</h4>
                  <div>
                     <div class="section">
                        <p>事务管理器使用<code class="codeph">OracleXAResource</code>实例来协调构成分布式事务的所有事务分支。
                        </p>
                        <p>每个<code class="codeph">OracleXAResource</code>实例都提供以下关键功能，通常由事务管理器调用：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>它将分布式事务与在生成此<code class="codeph">OracleXAResource</code>实例的XA连接实例中操作的事务分支关联和取消关联。实质上，它将分布式事务与XA连接实例封装的物理连接或会话相关联。这是通过使用事务ID完成的。
                              </p>
                           </li>
                           <li>
                              <p>它执行分布式事务的两阶段提交功能，以确保在确保更改在所有事务分支中成功之前，不会在一个事务分支中提交更改。</p>
                              <div class="infoboxnote" id="GUID-F7013AB7-8F57-4260-A0F6-E7EAEDFBC063__GUID-DCCFBACE-2494-477B-9E5E-E0B6486C0B6C">
                                 <p class="notep1">注意：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>由于XA连接实例和<code class="codeph">OracleXAResource</code>实例之间必须始终存在一对一关联， <code class="codeph">OracleXAResource</code>关闭关联的XA连接实例时会隐式关闭<code class="codeph">OracleXAResource</code>实例。
                                       </p>
                                    </li>
                                    <li>
                                       <p>如果某个<code class="codeph">OracleXAResource</code>实例打开了一个事务，那么它也必须由同一个<code class="codeph">OracleXAResource</code>实例关闭。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                        </ul>
                        <p><code class="codeph">OracleXAResource</code>实例是实现标准<code class="codeph">javax.transaction.xa.的类的实例<code class="codeph">javax.transaction.xa.XAResource</code>接口。Oracle JDBC使用<code class="codeph">OracleXAResource</code>类实现<code class="codeph">XAResource</code>接口，该类位于<code class="codeph">oracle.jdbc.xa.client</code>包和<code class="codeph">oracle.jdbc.xa.server</code>包中。
                        </p>
                        <p>每当调用<code class="codeph">OracleXAConnection</code>类的<code class="codeph">getXAResource</code>方法时，Oracle JDBC驱动程序都会创建并返回<code class="codeph">OracleXAResource</code>实例，并且它是Oracle JDBC驱动程序， <code class="codeph">OracleXAResource</code>实例与连接实例相关联，并且通过该连接运行事务分支。
                        </p>
                        <p>此方法是<code class="codeph">OracleXAResource</code>实例与特定连接以及在该连接中运行的事务分支的关联方式。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28855"></a><a id="JJDBC28856"></a><a id="JJDBC28857"></a><a id="JJDBC28858"></a><a id="JJDBC28859"></a><a id="JJDBC28860"></a><a id="JJDBC28861"></a><a id="JJDBC28862"></a><a id="JJDBC28854"></a><div class="props_rev_3"><a id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6" name="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6"></a><h4 id="JJDBC-GUID-CD752E5A-309E-440A-A711-71083DD5B6A6" class="sect4"><span class="enumeration_section">33.2.4</span> OracleXAResource方法功能和输入参数</h4>
                  <div>
                     <div class="section">
                        <p><code class="codeph">OracleXAResource</code>类有几种方法可以将事务分支与与之关联的分布式事务进行协调。此功能通常涉及两阶段提交操作。
                        </p>
                        <p>从中间层组件（例如应用程序服务器）接收<code class="codeph">OracleXAResource</code>实例的事务管理器通常会调用此功能。
                        </p>
                        <p>这些方法中的每一个都以<code class="codeph">Xid</code>实例的形式将事务ID作为输入，其包括事务分支ID组件和分布式事务ID组件。每个事务分支都具有唯一的事务ID，但属于同一全局事务的事务分支具有相同的全局事务组件作为其事务ID的一部分。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-F66E0F1D-762E-4E76-BEF6-84C455709BB3">开始</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>代表事务分支开始工作，将事务分支与分布式事务相关联。</p><pre class="oac_no_warn" dir="ltr">void start（Xid xid，int flags）</pre><p><code class="codeph">flags</code>参数必须是以下一个或多个值：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">XA资源。TMNOFLAGS</code></p>
                              <p>标记新事务分支的开始，以便在与此XA资源实例关联的会话中进行后续操作。该分支将具有事务ID <code class="codeph">xid</code> ，它是由事务管理器创建的<code class="codeph">OracleXid</code>实例。这会将事务分支映射到适当的分布式事务。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">XA资源。TMJOIN</code></p>
                              <p>将与此XA资源实例关联的会话中的后续操作连接到<code class="codeph">xid</code>指定的现有事务分支。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">XA资源。TMRESUME</code></p>
                              <p>恢复<code class="codeph">xid</code>指定的事务分支。
                              </p>
                              <div class="infoboxnote" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-84C6551D-D36F-43CE-91F5-21444E0410AB">
                                 <p class="notep1">注意：</p>
                                 <p>事务分支只有在先前被挂起时才能恢复。</p>
                              </div>
                           </li>
                           <li>
                              <p><code class="codeph">OracleXAResource。TMPROMOTE</code></p>
                              <p>将本地事务提升为全局事务</p>
                           </li>
                           <li>
                              <p><code class="codeph">OracleXAResource。ORATMSERIALIZABLE</code></p>
                              <p>使用事务ID <code class="codeph">xid</code>启动可序列化事务。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">OracleXAResource。ORATMREADONLY</code></p>
                              <p>使用事务ID <code class="codeph">xid</code>启动只读事务。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">OracleXAResource。ORATMREADWRITE</code></p>
                              <p>使用事务ID <code class="codeph">xid</code>启动读/写事务。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">OracleXAResource。ORATRANSLOOSE</code></p>
                              <p>使用事务ID <code class="codeph">xid</code>启动松散耦合的事务。
                              </p>
                           </li>
                        </ul>
                        <p><code class="codeph">TMNOFLAGS</code> ， <code class="codeph">TMJOIN</code> ， <code class="codeph">TMRESUME</code> ， <code class="codeph">TMPROMOTE</code> ， <code class="codeph">ORATMSERIALIZABLE</code> ， <code class="codeph">ORATMREADONLY</code>和<code class="codeph">ORATMREADWRITE</code>被定义为<code class="codeph">XAResource</code>接口和<code class="codeph">OracleXAResource</code>类的<code class="codeph">static</code>成员。<code class="codeph">ORATMSERIALIZABLE</code> ， <code class="codeph">ORATMREADONLY</code>和<code class="codeph">ORATMREADWRITE</code>是隔离模式标志。默认隔离行为是<code class="codeph">READ COMMITTED</code> 。</p>
                        <div class="infoboxnote" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-A277F597-3D7F-4F04-B5B9-BB67F8AB14F6">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>事务管理器可以转换为<code class="codeph">OracleXAResource</code>并使用<code class="codeph">resume(Xid xid)</code>方法（Oracle扩展<code class="codeph">resume(Xid xid)</code> ，而不是使用<code class="codeph">TMRESUME</code>的<code class="codeph">start</code>方法。
                                 </p>
                              </li>
                              <li>
                                 <p>如果使用<code class="codeph">TMRESUME</code> ，则还必须使用<code class="codeph">TMNOMIGRATE</code> ，如<code class="codeph">start(xid, XAResource.TMRESUME | OracleXAResource。TMNOMIGRATE)</code> 。这可以防止应用程序收到错误<code class="codeph">ORA 1002: fetch out of sequence</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>如果错误地使用隔离模式标志，则会引发代码为<code class="codeph">XAER_INVAL</code>的异常。此外，在恢复全局事务时不能使用隔离模式标志，因为您无法设置现有事务的隔离级别。如果在恢复事务时尝试使用隔离模式标志，则会引发代码为ORA-24790的外部Oracle异常。
                                 </p>
                              </li>
                              <li>
                                 <p>为了避免<code class="codeph">Error ORA 1002: fetch out of sequence</code> ，请将<code class="codeph">TMNOMIGRATE</code>标志包含在<code class="codeph">start</code>方法的一部分中。例如：</p><pre class="oac_no_warn" dir="ltr">start（xid，XAResource。TMSUSPEND | OracleXAResource。TMNOMIGRATE）;</pre></li>
                              <li>
                                 <p><code class="codeph">OracleXAResource</code>中定义的所有标志都是Oracle扩展。在编写使用这些标志的事务管理器时，您应该注意这一点。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <p>请注意，要在启动事务分支时创建适当的事务ID，事务管理器必须知道事务分支属于哪个分布式事务。其中的机制在中间层和事务管理器之间处理。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-89F6688F-529A-4418-8FE7-A4B4772D7278">结束</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>结束代表<code class="codeph">xid</code>指定的事务分支工作，解除事务分支与其分布式事务的关联。
                        </p><pre class="oac_no_warn" dir="ltr">void end（Xid xid，int flags）</pre><p><code class="codeph">flags</code>参数可以具有以下值之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">XA资源。TMSUCCESS</code></p>
                              <p>这表示已知此事务分支已成功。</p>
                           </li>
                           <li>
                              <p><code class="codeph">XA资源。TMFAIL</code></p>
                              <p>这表示已知此事务分支已失败。</p>
                           </li>
                           <li>
                              <p><code class="codeph">XA资源。TMSUSPEND</code></p>
                              <p>这是暂停<code class="codeph">xid</code>指定的事务分支。通过挂起事务分支，您可以在单个会话中拥有多个事务分支。但是，在任何给定时间只能有一个活动。而且，就资源而言，这往往比拥有两个会话更昂贵。
                              </p>
                           </li>
                        </ul>
                        <p><code class="codeph">TMSUCCESS</code> ， <code class="codeph">TMFAIL</code>和<code class="codeph">TMSUSPEND</code>被定义为<code class="codeph">XAResource</code>接口和<code class="codeph">OracleXAResource</code>类的静态成员。
                        </p>
                        <div class="infoboxnote" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-07664836-6AA1-42DB-BDF1-6966841F53A5">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>事务管理器可以转换为<code class="codeph">OracleXAResource</code>并使用<code class="codeph">suspend(Xid xid)</code>方法（Oracle扩展<code class="codeph">suspend(Xid xid)</code> ，而不是将<code class="codeph">end</code>方法与<code class="codeph">TMSUSPEND</code> <code class="codeph">OracleXAResource</code>使用。
                                 </p>
                              </li>
                              <li>
                                 <p>这种挂起事务的XA功能提供了在单个JDBC连接中切换各种事务的方法。您可以使用XA类来完成此任务，即使您不在分布式事务环境中，也不需要XA类。</p>
                              </li>
                              <li>
                                 <p>如果您使用<code class="codeph">TMSUSPEND</code> ，那么您还必须使用<code class="codeph">TMNOMIGRATE</code> ，如<code class="codeph">end(xid, XAResource.TMSUSPEND | OracleXAResource。TMNOMIGRATE)</code> 。这可以防止应用程序收到错误<code class="codeph">ORA 1002: fetch out of sequence</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>为了避免<code class="codeph">Error ORA 1002: fetch out of sequence</code> ，请将<code class="codeph">TMNOMIGRATE</code>标志包含在end方法的一部分中。例如：</p><pre class="oac_no_warn" dir="ltr">结束（xid，XAResource。TMSUSPEND | OracleXAResource。TMNOMIGRATE）;</pre></li>
                              <li>
                                 <p><code class="codeph">OracleXAResource</code>中定义的所有标志都是Oracle扩展。任何使用这些标志的事务管理器都应该注意这一点。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-3C5E0195-77F6-4768-9B6C-1BECFA80B9C4">准备</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>准备在<code class="codeph">xid</code>指定的事务分支中执行的更改。这是两阶段提交操作的第一阶段，以确保可以访问数据库并且可以成功提交更改。
                        </p><pre class="oac_no_warn" dir="ltr">int prepare（Xid xid）</pre><p>此方法返回一个整数值，如下所示：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">XA资源。XA_RDONLY</code></p>
                              <p>如果事务分支仅运行<code class="codeph">SELECT</code>语句等只读操作，则返回此值。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">XA资源。XA_OK</code></p>
                              <p>如果事务分支运行全部准备且没有错误的更新，则返回此值。</p>
                           </li>
                        </ul>
                        <p><code class="codeph">XA_RDONLY</code>和<code class="codeph">XA_OK</code>被定义为<code class="codeph">XAResource</code>接口和<code class="codeph">OracleXAResource</code>类的<code class="codeph">static</code>成员。
                        </p>
                        <div class="infoboxnote" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-B871A921-D468-484E-9DA2-2392B7E1B6E4">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果事务分支运行更新并且其中任何一个在准备期间遇到错误，则<code class="codeph">prepare</code>方法有时不返回任何值。在这种情况下，抛出XA异常。
                                 </p>
                              </li>
                              <li>
                                 <p>在调用<code class="codeph">prepare</code>方法之前，始终在分支上调用<code class="codeph">end</code>方法。
                                 </p>
                              </li>
                              <li>
                                 <p>如果分布式事务中只有一个事务分支，则无需调用<code class="codeph">prepare</code>方法。您可以先调用<code class="codeph">OracleXAResource</code> <code class="codeph">commit</code>方法，而无需先做好准备。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-C52864D1-B662-4AD8-92C4-DA75B4A73D1C">承诺</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>在<code class="codeph">xid</code>指定的事务分支中提交准备好的更改。这是两阶段提交的第二阶段，仅在成功准备好所有事务分支后执行。
                        </p><pre class="oac_no_warn" dir="ltr">void commit（Xid xid，boolean onePhase）</pre><p>设置<code class="codeph">onePhase</code>参数如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">真正</code></p>
                              <p>这是在提交事务分支时使用单阶段而不是两阶段协议。如果分布式事务中只有一个事务分支，这是合适的。 <code class="codeph">prepare</code>步骤将被跳过。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">假</code></p>
                              <p>这是在提交事务分支时使用两阶段协议。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-22B85181-296C-4CDF-82F0-D796CCCCBC10">回滚</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>在<code class="codeph">xid</code>指定的事务分支中回滚准备好的更改。
                        </p><pre class="oac_no_warn" dir="ltr">void rollback（Xid xid）</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-84832424-E7A8-4BF3-B00D-A0758ADC8923">忘记</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>告诉资源管理器忘记启发式完成的事务分支。</p><pre class="oac_no_warn" dir="ltr">public void forget（Xid xid）</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-77BD844A-6E3F-4F07-A344-DDE7ECEB5D3C">恢复</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>事务管理器在恢复期间调用此方法以获取当前处于准备或启发式完成状态的事务分支列表。</p><pre class="oac_no_warn" dir="ltr">public Xid [] recover（int flag）</pre><div class="infoboxnote" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-4539DB7A-5DD5-4D48-BEC8-0BFC1B6DFB04">
                           <p class="notep1">注意：</p>
                           <p><code class="codeph">TMSTARTRSCAN</code> ， <code class="codeph">TMENDRSCAN</code>或<code class="codeph">TMNOFLAGS</code>以外的<code class="codeph">flag</code>值会引发异常，否则将忽略<code class="codeph">flag</code> 。
                           </p>
                        </div>
                        <p>资源管理器为当前处于准备或启发式完成状态的事务分支返回零个或多个<code class="codeph">Xid</code> 。如果在操作期间发生错误，则资源管理器将抛出相应的<code class="codeph">XAException</code> 。
                        </p>
                        <div class="infoboxnote" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-50CF2CD2-8A13-4C3B-BE63-4A069A6709D8">
                           <p class="notep1">注意：</p>
                           <p>该<code class="codeph">recover</code>方法需要在SELECT权限<code class="codeph">DBA_PENDING_TRANSACTIONS</code>并执行特权<code class="codeph">SYS.DBMS_XA</code>在Oracle数据库服务器。对于Oracle Database <span class="italic">11g</span>第1版之前的数据库版本，其中包含针对错误5945463的修补程序的Oracle修补程序不可用，或者对于特定应用程序方案应用修补程序是不可行的，则<code class="codeph">recover</code>方法需要<code class="codeph">SYSBDBA</code>权限。定期使用<code class="codeph">SYSDBA</code>权限是一种安全风险。因此，如果您需要使用<code class="codeph">recover</code>方法，Oracle强烈建议您升级数据库或应用错误5945463的修复程序。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CD752E5A-309E-440A-A711-71083DD5B6A6__GUID-CA19D762-2DEA-4B57-BD1B-83FD47477D66">isSameRM</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>要确定两个<code class="codeph">OracleXAResource</code>实例是否对应于同一资源管理器，请从一个<code class="codeph">OracleXAResource</code>实例调用<code class="codeph">isSameRM</code>方法，并将另一个<code class="codeph">OracleXAResource</code>实例指定为输入。在以下示例中，假设<code class="codeph">xares1</code>和<code class="codeph">xares2</code>是<code class="codeph">OracleXAResource</code>实例：</p><pre class="oac_no_warn" dir="ltr">boolean sameRM = xares1.isSameRM（xares2）;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28863"></a><div class="props_rev_3"><a id="GUID-4FE2BFF4-9F22-4752-B571-B44D6F220BDC" name="GUID-4FE2BFF4-9F22-4752-B571-B44D6F220BDC"></a><h4 id="JJDBC-GUID-4FE2BFF4-9F22-4752-B571-B44D6F220BDC" class="sect4"><span class="enumeration_section">33.2.5</span> Xid接口和Oracle实现</h4>
                  <div>
                     <div class="section">
                        <p>事务管理器创建事务ID实例，并在协调分布式事务的分支时使用它们。每个事务分支都分配有唯一的事务ID，其中包括以下信息：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>对于垫标识符</p>
                              <p>格式标识符指定Java事务管理器。例如，可能存在格式标识符<code class="codeph">orcl</code> 。该字段<span class="italic">不能</span>为空。格式标识符的大小为4个字节。
                              </p>
                           </li>
                           <li>
                              <p>Glo bal交易标识符</p>
                              <p>它也称为分布式事务ID组件。全局事务标识符的大小为64个字节。</p>
                           </li>
                           <li>
                              <p>Bra nch资格赛</p>
                              <p>它也称为事务分支ID组件。分支限定符的大小为64个字节。</p>
                           </li>
                        </ul>
                        <p>64字节的全局事务标识符值在属于同一分布式事务的所有事务分支的事务ID中是相同的。但是，整个事务ID对于每个事务分支都是唯一的。</p>
                        <p>XA事务ID实例是实现标准<code class="codeph">javax.transaction.xa.的类的实例<code class="codeph">javax.transaction.xa.Xid</code>接口，它是X / Open事务标识符XID结构的Java映射。
                        </p>
                        <p>Oracle使用<code class="codeph">oracle.jdbc.xa</code>包中的<code class="codeph">OracleXid</code>类实现此接口。<code class="codeph">OracleXid</code>实例仅在事务管理器中使用，对应用程序或应用程序服务器是透明的。
                        </p>
                        <div class="infoboxnote" id="GUID-4FE2BFF4-9F22-4752-B571-B44D6F220BDC__GUID-2AE19F6E-33F3-45F2-8F85-FF9631CC940B">
                           <p class="notep1">注意：</p>
                           <p>Oracle不要求使用<code class="codeph">OracleXid</code>进行<code class="codeph">OracleXAResource</code>调用。相反，使用任何实现<code class="codeph">javax.transaction.xa.类<code class="codeph">javax.transaction.xa.Xid</code>界面。
                           </p>
                        </div>
                        <p>事务管理器可以在创建<code class="codeph">OracleXid</code>实例时使用以下内容：</p><pre class="oac_no_warn" dir="ltr">public OracleXid（int fId，byte gId []，byte bId []）抛出XAException</pre><p><code class="codeph">fId</code>是格式标识符的整数值， <code class="codeph">gId[]</code>是全局事务标识符的字节数组， <code class="codeph">bId[]</code>是分支限定符的字节数组。
                        </p>
                        <p><code class="codeph">Xid</code>接口指定以下getter方法：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">public int getFormatId（）</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">public byte [] getGlobalTransactionId（）</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">public type [] getBranchQualifier（）</code></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="JJDBC28864"></a><div class="props_rev_3"><a id="GUID-EAB7ACFA-5708-4608-B94D-0D9ECE391D67" name="GUID-EAB7ACFA-5708-4608-B94D-0D9ECE391D67"></a><h3 id="JJDBC-GUID-EAB7ACFA-5708-4608-B94D-0D9ECE391D67" class="sect3"><span class="enumeration_section">33.3</span>错误处理和优化</h3>
               <div>
                  <div class="section">
                     <p>本节重点介绍XA异常和错误处理的功能以及XA实现中的Oracle优化。它包括以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="distributed-transactions.html#GUID-31804AB5-6CA2-45A4-AE4C-F58FCF86EB5D">XAException类和方法</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-transactions.html#GUID-57581BCF-85CE-4671-8323-CCAC62BA980A">Oracle错误与XA错误之间的映射</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-transactions.html#GUID-2C258328-7DFD-42ED-AA03-01959FFE924A">XA错误处理</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-transactions.html#GUID-FDF1F19F-7B5D-4BD8-AB6C-B26F47340C71">Oracle XA优化</a></p>
                        </li>
                     </ul>
                     <p>异常和错误处理讨论包括标准XA异常类和Oracle特定的XA异常类，以及特定的XA错误代码和错误处理技术。</p>
                  </div>
                  <!-- class="section" -->
               </div><a id="JJDBC28865"></a><div class="props_rev_3"><a id="GUID-31804AB5-6CA2-45A4-AE4C-F58FCF86EB5D" name="GUID-31804AB5-6CA2-45A4-AE4C-F58FCF86EB5D"></a><h4 id="JJDBC-GUID-31804AB5-6CA2-45A4-AE4C-F58FCF86EB5D" class="sect4"><span class="enumeration_section">33.3.1</span> XAException类和方法</h4>
                  <div>
                     <div class="section">
                        <p>XA方法抛出XA异常，而不是一般异常或<code class="codeph">SQLExceptions</code> 。XA异常是标准类<code class="codeph">javax.transaction.xa.一个实例<code class="codeph">javax.transaction.xa.XAException</code>或子类。
                        </p>
                        <p>Oracle XAException是一个由Oracle错误部分和XA错误部分组成的实例。Oracle提供了<code class="codeph">oracle.jdbc.xa.标准<code class="codeph">javax.transaction.xa. OracleXAException</code>子类<code class="codeph">javax.transaction.xa.XAException</code>类。使用以下构造函数之一构造<code class="codeph">OracleXAException</code>实例：</p><pre class="oac_no_warn" dir="ltr">public OracleXAException（）public OracleXAException（int error）</pre><p>错误值是一个错误代码，它结合了Oracle SQL错误值和XA错误值。JDBC驱动程序确切地确定如何组合Oracle和XA错误值。</p>
                        <p><code class="codeph">OracleXAException</code>类具有以下方法：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">public int getOracleError（）</code></p>
                              <p>此方法返回与异常有关的Oracle SQL错误代码，标准ORA错误号，如果没有Oracle SQL错误，则返回0。</p>
                           </li>
                           <li>
                              <p><code class="codeph">public int getXAError（）</code></p>
                              <p>此方法返回与异常有关的XA错误代码。XA错误值在<code class="codeph">javax.transaction.xa.中定义<code class="codeph">javax.transaction.xa.XAException</code>类。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28867"></a><a id="JJDBC28866"></a><div class="props_rev_3"><a id="GUID-57581BCF-85CE-4671-8323-CCAC62BA980A" name="GUID-57581BCF-85CE-4671-8323-CCAC62BA980A"></a><h4 id="JJDBC-GUID-57581BCF-85CE-4671-8323-CCAC62BA980A" class="sect4"><span class="enumeration_section">33.3.2</span> Oracle错误和XA错误之间的映射</h4>
                  <div>
                     <div class="section">
                        <p>Oracle错误对应于<code class="codeph">OracleXAException</code>实例中的XA错误，如<a href="distributed-transactions.html#GUID-57581BCF-85CE-4671-8323-CCAC62BA980A__CFHEEBFF" title="表">表33-2中所述</a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-57581BCF-85CE-4671-8323-CCAC62BA980A__CFHEEBFF">
                        <p class="titleintable">表33-2 Oracle-XA错误映射</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Oracle-XA错误映射" width="100%" border="1" summary="table" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="41%" id="d80952e2096">Oracle错误代码</th>
                                 <th align="left" valign="bottom" width="59%" id="d80952e2099">XA错误代码</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2104" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24756</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2104 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_NOTA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2113" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24764</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2113 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XA_HEURCOM</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2122" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24765</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2122 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XA_HEURRB</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2131" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24766</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2131 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XA_HEURMIX</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2140" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24767</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2140 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XA_RDONLY</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2149" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 25351</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2149 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XA_RETRY</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2158" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 30006</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2158 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XA_RETRY</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2167" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24763</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2167 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_PROTO</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2176" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24769</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2176 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_PROTO</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2185" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24770</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2185 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_PROTO</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2194" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24776</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2194 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_PROTO</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2204" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 2056</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2204 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_PROTO</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2213" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 17448</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2213 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_PROTO</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2222" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24768</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2222 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_PROTO</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2231" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24775</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2231 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_PROTO</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2240" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24761</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2240 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XA_RBROLLBACK</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2249" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 2091</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2249 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XA_RBROLLBACK</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2258" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 2092</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2258 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XA_RBROLLBACK</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2267" headers="d80952e2096 ">
                                    <p><code class="codeph">ORA 24780</code></p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2267 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_RMERR</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="41%" id="d80952e2276" headers="d80952e2096 ">
                                    <p>所有其他<code class="codeph">ORA</code>错误</p>
                                 </td>
                                 <td align="left" valign="top" width="59%" headers="d80952e2276 d80952e2099 ">
                                    <p><code class="codeph">的XAException。XAER_RMFAIL</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="JJDBC28868"></a><div class="props_rev_3"><a id="GUID-2C258328-7DFD-42ED-AA03-01959FFE924A" name="GUID-2C258328-7DFD-42ED-AA03-01959FFE924A"></a><h4 id="JJDBC-GUID-2C258328-7DFD-42ED-AA03-01959FFE924A" class="sect4"><span class="enumeration_section">33.3.3</span> XA错误处理</h4>
                  <div>
                     <div class="section">
                        <p>以下代码段使用<code class="codeph">OracleXAException</code>类来处理XA异常：</p><pre class="oac_no_warn" dir="ltr">尝试{......<span class="italic">执行XA操作</span> .........} catch（OracleXAException oxae）{int oraerr = oxae.getOracleError（）; System.out.println（“错误”+ oraerr）; } catch（XAException xae）{...<span class="italic">处理通用XA例外</span> ...}
</pre><p>如果XA操作没有抛出特定于Oracle的XA异常，则代码将逐步处理泛型XA异常。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28869"></a><div class="props_rev_3"><a id="GUID-FDF1F19F-7B5D-4BD8-AB6C-B26F47340C71" name="GUID-FDF1F19F-7B5D-4BD8-AB6C-B26F47340C71"></a><h4 id="JJDBC-GUID-FDF1F19F-7B5D-4BD8-AB6C-B26F47340C71" class="sect4"><span class="enumeration_section">33.3.4</span> Oracle XA优化</h4>
                  <div>
                     <div class="section">
                        <p>如果分布式事务的两个或多个分支使用相同的数据库实例，则Oracle JDBC具有提高性能的功能，这意味着与这些分支关联的<code class="codeph">OracleXAResource</code>实例与同一资源管理器相关联。
                        </p>
                        <p>在这种情况下，只有其中一个<code class="codeph">OracleXAResource</code>实例的<code class="codeph">prepare</code>方法将返回<code class="codeph">XA_OK</code>或将失败。其余的将返回<code class="codeph">XA_RDONLY</code> ，即使进行了更新。这允许事务管理器隐式加入所有事务分支，并在发生故障时通过返回<code class="codeph">XA_OK</code>或失败的<code class="codeph">OracleXAResource</code>实例提交或回滚加入的事务。
                        </p>
                        <p>事务管理器可以使用<code class="codeph">OracleXAResource</code>类<code class="codeph">isSameRM</code>方法来确定两个<code class="codeph">OracleXAResource</code>实例是否使用相同的资源管理器。这样它就可以解释<code class="codeph">XA_RDONLY</code>返回值的含义。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="JJDBC28870"></a><div class="props_rev_3"><a id="GUID-A1736524-8CB5-4965-89E3-C65C3861E784" name="GUID-A1736524-8CB5-4965-89E3-C65C3861E784"></a><h3 id="JJDBC-GUID-A1736524-8CB5-4965-89E3-C65C3861E784" class="sect3"><span class="enumeration_section">33.4</span>关于实现分布式事务</h3>
               <div>
                  <div class="section">
                     <p>本节提供了如何使用Oracle XA功能实现分布式事务的示例。本节包括以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="distributed-transactions.html#GUID-DE4E55A0-9798-4FB1-BF11-1B011607612B">Oracle XA导入摘要</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-transactions.html#GUID-1964042C-AA18-4E8B-8B43-5DE58BFE2610">Oracle XA代码示例</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="JJDBC28871"></a><div class="props_rev_3"><a id="GUID-DE4E55A0-9798-4FB1-BF11-1B011607612B" name="GUID-DE4E55A0-9798-4FB1-BF11-1B011607612B"></a><h4 id="JJDBC-GUID-DE4E55A0-9798-4FB1-BF11-1B011607612B" class="sect4"><span class="enumeration_section">33.4.1</span> Oracle XA的导入摘要</h4>
                  <div>
                     <div class="section">
                        <p>您必须为Oracle XA功能导入以下内容：</p><pre class="oac_no_warn" dir="ltr">import oracle.jdbc.xa。OracleXid; import oracle.jdbc.xa。OracleXAException; import oracle.jdbc.pool。*; import oracle.jdbc.xa.client。*; import javax.transaction.xa。*;</pre><p><code class="codeph">oracle.jdbc.pool</code>包具有用于连接池功能的类，其中一些包含与XA相关的类作为子类。
                        </p>
                        <p>或者，如果代码将在Oracle数据库中运行并访问该数据库以进行SQL操作，则必须导入<code class="codeph">oracle.jdbc.xa.server</code>而不是<code class="codeph">oracle.jdbc.xa.client</code> 。
                        </p><pre class="oac_no_warn" dir="ltr">import oracle.jdbc.xa.server。*;</pre><p>如果您的应用程序必须使用服务器端Thin驱动程序作为XA事务的一部分访问另一个Oracle数据库，那么您的代码可以使用<code class="codeph">oracle.xa.client</code>类的完全限定名称。
                        </p>
                        <p>每个<code class="codeph">client</code>和<code class="codeph">server</code>包都有<code class="codeph">OracleXADataSource</code> ， <code class="codeph">OracleXAConnection</code>和<code class="codeph">OracleXAResource</code>类的版本。这三个类的抽象版本位于顶级<code class="codeph">oracle.jdbc.xa</code>包中。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28872"></a><div class="props_rev_3"><a id="GUID-1964042C-AA18-4E8B-8B43-5DE58BFE2610" name="GUID-1964042C-AA18-4E8B-8B43-5DE58BFE2610"></a><h4 id="JJDBC-GUID-1964042C-AA18-4E8B-8B43-5DE58BFE2610" class="sect4"><span class="enumeration_section">33.4.2</span> Oracle XA代码示例</h4>
                  <div>
                     <div class="section">
                        <p>此示例使用具有两个事务分支的两阶段分布式事务，每个事务分支到一个单独的数据库。</p>
                        <p>请注意，为简单起见，此示例将通常位于中间层的代码与通常位于事务管理器中的代码（例如<code class="codeph">OracleXAResource</code>方法调用和事务ID的创建）组合<code class="codeph">OracleXAResource</code> 。
                        </p>
                        <p>为简洁起见，此处未显示创建事务ID和执行SQL操作的细节。完整的示例随产品一起提供。</p>
                        <p>此示例执行以下序列：</p>
                        <ol>
                           <li>
                              <p>启动事务分支＃1。</p>
                           </li>
                           <li>
                              <p>启动事务分支＃2。</p>
                           </li>
                           <li>
                              <p>在分支＃1上执行DML操作。</p>
                           </li>
                           <li>
                              <p>在分支＃2上执行DML操作。</p>
                           </li>
                           <li>
                              <p>结束交易分支＃1。</p>
                           </li>
                           <li>
                              <p>结束交易分支＃2。</p>
                           </li>
                           <li>
                              <p>准备分支＃1。</p>
                           </li>
                           <li>
                              <p>准备分支＃2。</p>
                           </li>
                           <li>
                              <p>提交分支＃1。</p>
                           </li>
                           <li>
                              <p>提交分支＃2。</p>
                           </li>
                        </ol><pre class="oac_no_warn" dir="ltr">//您需要导入java.sql包以使用JDBC import java.sql。*; import javax.sql。*; import oracle.jdbc。*; import oracle.jdbc.pool。*; import oracle.jdbc.xa。OracleXid; import oracle.jdbc.xa。OracleXAException; import oracle.jdbc.xa.client。*; import javax.transaction.xa。*; class XA4 {public static void main（String args []）抛出SQLException {try {String URL1 =“jdbc：oracle：oci：@”; //您可以在连接URL中的@符号后面添加数据库名称。 String URL2 =“jdbc：oracle：thin：@（description =（address =（host = localhost）（protocol = tcp）（port = 5521））（connect_data =（service_name = orcl）））”; //创建第一个DataSource并获取连接OracleDataSource ods1 = new OracleDataSource（）; ods1.setURL（URL1）; ods1.setUser（ “HR”）; ods1.setPassword（ “HR”）;连接conna = ods1.getConnection（）; //创建第二个DataSource并获取连接OracleDataSource ods2 = new OracleDataSource（）; ods2.setURL（URL2）; ods2.setUser（ “HR”）; ods2.setPassword（ “HR”）; Connection connb = ods2.getConnection（）; //准备一个语句来创建表语句stmta = conna.createStatement（）; //准备一个语句来创建表语句stmtb = connb.createStatement（）; try {//删除测试表stmta.execute（“drop table my_table”）; } catch（SQLException e）{//忽略这里的错误} try {//创建一个测试表stmta.execute（“create table my_table（col1 int）”）; } catch（SQLException e）{//此处也忽略错误} try {//删除测试表stmtb.execute（“drop table my_tab”）; } catch（SQLException e）{//在这里忽略错误} try {//创建一个测试表stmtb.execute（“create table my_tab（col1 char（30））”）; } catch（SQLException e）{//此处也忽略错误} //创建XADataSource实例并设置属性。OracleXADataSource oxds1 = new OracleXADataSource（）; oxds1.setURL（ “JDBC：预言：OCI：@”）; oxds1.setUser（ “HR”）; oxds1.setPassword（ “HR”）; OracleXADataSource oxds2 = new OracleXADataSource（）; oxds2.setURL（“jdbc：oracle：thin：@（description =（address =（host = localhost）（protocol = tcp）（port = 5521））（connect_data =（service_name = orcl）））”）; oxds2.setUser（ “HR”）; oxds2.setPassword（ “HR”）; //获取与底层数据源的XA连接XAConnection pc1 = oxds1.getXAConnection（）; XAConnection pc2 = oxds2.getXAConnection（）; //获取物理连接Connection conn1 = pc1.getConnection（）;连接conn2 = pc2.getConnection（）; //获取XA资源XAResource oxar1 = pc1.getXAResource（）; XAResource oxar2 = pc2.getXAResource（）; //创建具有相同全局ID的Xid Xid xid1 = createXid（1）; Xid xid2 = createXid（2）; //启动资源oxar1.start（xid1，XAResource。TMNOFLAGS）; oxar2.start（xid2，XAResource。TMNOFLAGS）; //使用conn1和conn2 doSomeWork1（conn1）执行SQL操作; doSomeWork2（conn2）; //结束两个分支 - 重要的是oxar1.end（xid1，XAResource。TMSUCCESS）; oxar2.end（xid2，XAResource。TMSUCCESS）; //准备RMs int prp1 = oxar1.prepare（xid1）; int prp2 = oxar2.prepare（xid2）; System.out.println（“准备1的返回值为”+ prp1）; System.out.println（“准备2的返回值为”+ prp2）; boolean do_commit = true; if（！（（prp1 == XAResource。XA_OK）|| （prp1 == XAResource。XA_RDONLY）））do_commit = false; if（！（（prp2 == XAResource。XA_OK）|| （prp2 == XAResource。XA_RDONLY）））do_commit = false; System.out.println（“do_commit is”+ do_commit）; System.out.println（“oxar1与oxar2相同？“+ oxar1.isSameRM（oxar2））; if（prp1 == XAResource。XA_OK）if（do_commit）oxar1.commit（xid1，false）; else oxar1.rollback（xid1）; if（prp2 == XAResource。XA_OK）if（do_commit）oxar2.commit（xid2，false）; else oxar2.rollback（xid2）; //关闭连接conn1.close（）; conn1 = null; conn2.close（）; conn2 = null; pc1.close（）; pc1 = null; pc2.close（）; pc2 = null; ResultSet rset = stmta.executeQuery（“从my_table中选择col1”）; while（rset.next（））System.out.println（“Col1 is”+ rset.getInt（1））; rset.close（）; rset = null; rset = stmtb.executeQuery（“从my_tab中选择col1”）; while（rset.next（））System.out.println（“Col1 is”+ rset.getString（1））; rset.close（）; rset = null; stmta.close（）; stmta = null; stmtb.close（）; stmtb = null; conna.close（）; conna = null; connb.close（）; connb = null; } catch（SQLException sqe）{sqe.printStackTrace（）; } catch（XAException xae）{if（xae instanceof OracleXAException）{System.out.println（“XA Error is”+（（OracleXAException）xae）.getXAError（））; System.out.println（“SQL Error is”+（（OracleXAException）xae）.getOracleError（））; static Xid createXid（int bids）抛出XAException {...<span class="italic">创建交易ID</span> ...}private static void doSomeWork1（Connection conn）抛出SQLException {...<span class="italic">执行SQL操作</span> ...}private static void doSomeWork2（Connection conn）抛出SQLException {...<span class="italic">执行SQL操作</span> ...}}</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="JJDBC28873"></a><div class="props_rev_3"><a id="GUID-1EF2D070-305D-49D9-9124-16FFDF7CCF74" name="GUID-1EF2D070-305D-49D9-9124-16FFDF7CCF74"></a><h3 id="JJDBC-GUID-1EF2D070-305D-49D9-9124-16FFDF7CCF74" class="sect3"><span class="enumeration_section">33.5</span> Oracle JDBC驱动程序中的Native-XA</h3>
               <div>
                  <div class="section">
                     <p>通常，XA命令可以通过以下方式发送到服务器：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>通过非本机API</p>
                        </li>
                        <li>
                           <p>通过本机API</p>
                        </li>
                     </ul>
                     <p>将XA命令发送到服务器的两种方法之间存在巨大的性能差异。与使用非本机API相比，使用本机API可以提高性能。</p>
                     <p>在Oracle Database <span class="italic">10g</span>之前，Thin驱动程序使用非本机API将XA命令发送到服务器，因为Thin本机API不可用。非本机API使用PL / SQL过程，因此它们具有以下缺点：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>它们需要在线路上发送不同的消息。</p>
                        </li>
                        <li>
                           <p>它们导致更多往返数据库。</p>
                        </li>
                        <li>
                           <p>它们会导致更多游标保持打开状态。</p>
                        </li>
                        <li>
                           <p>它们通过占用Statement Cache中的空间来破坏语句缓存。</p>
                        </li>
                     </ul>
                     <p>此外，非本机API的实现在服务器中。因此，为了解决发送XA命令的任何问题，它需要服务器补丁。这会产生一个主要问题，因为有时补丁需要重新启动服务器。</p>
                     <p>从Oracle数据库<span class="italic">10g开始</span> ，Thin本机API可用，默认情况下用于发送XA命令。原生API比非原生API快10倍以上。
                     </p>
                     <p>本节包括以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="distributed-transactions.html#GUID-C569E55B-4E1C-4DCF-88F4-05D831B69A55">OCI Native XA</a></p>
                        </li>
                        <li>
                           <p><a href="distributed-transactions.html#GUID-1F63D0AC-A68E-48D8-B07C-E4E04CC42609">瘦本机XA</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="JJDBC28875"></a><a id="JJDBC28876"></a><a id="JJDBC28877"></a><a id="JJDBC28874"></a><div class="props_rev_3"><a id="GUID-C569E55B-4E1C-4DCF-88F4-05D831B69A55" name="GUID-C569E55B-4E1C-4DCF-88F4-05D831B69A55"></a><h4 id="JJDBC-GUID-C569E55B-4E1C-4DCF-88F4-05D831B69A55" class="sect4"><span class="enumeration_section">33.5.1</span> OCI Native XA</h4>
                  <div>
                     <div class="section">
                        <p>通过使用<code class="codeph">OracleXADataSource</code>类的<code class="codeph">tnsEntry</code>和<code class="codeph">nativeXA</code>属性启用本机XA。
                        </p>
                        <div class="infoboxnote" id="GUID-C569E55B-4E1C-4DCF-88F4-05D831B69A55__GUID-23D64F4D-3959-4C2F-A0DE-04D49CDC7860">
                           <p class="notep1">注意：</p>
                           <p>目前，OCI Native XA在多线程环境中不起作用。OCI驱动程序使用Oracle的C / XA库来支持分布式事务，这要求在恢复全局事务之前为每个线程获取XAConnection。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C569E55B-4E1C-4DCF-88F4-05D831B69A55__GUID-8C43188C-0089-4528-B4E3-10915B30C471">配置和安装</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>在一个<a id="d80952e2716" class="indexterm-anchor"></a>在Solaris或Linux系统中，您需要<code class="codeph">libheteroxa11.so</code>共享库来启用Native XA功能。必须在搜索路径中安装此库并使其可用于本机XA功能才能正常工作。
                        </p>
                        <p>在Microsoft Windows系统上，您需要<code class="codeph">heteroxa11.dll</code>文件才能启用Native XA功能。必须在Windows DLL路径中安装此文件并使其可用，才能使Native XA功能正常工作。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C569E55B-4E1C-4DCF-88F4-05D831B69A55__GUID-728D08D0-2CD2-43CC-896C-0BB6ED8AE5B6">异常处理</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>在分布式事务中使用Native XA功能时，建议应用程序只检查<code class="codeph">XAException</code>或<code class="codeph">SQLException</code> ，而不是<code class="codeph">OracleXAException</code>或<code class="codeph">OracleSQLException</code> 。
                        </p>
                        <div class="infoboxnote" id="GUID-C569E55B-4E1C-4DCF-88F4-05D831B69A55__GUID-7EF7EE79-9165-4C84-A027-5970763BBBC6">
                           <p class="notep1">注意：</p>
                           <p>从SQL错误代码到标准XA错误代码的映射不适用于Native XA功能。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C569E55B-4E1C-4DCF-88F4-05D831B69A55__GUID-F625D2D5-ECD4-49F0-9724-AEBC8686CF50">原生XA代码示例</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>以下部分代码显示了如何启用Native XA功能：</p><pre class="oac_no_warn" dir="ltr">...//创建XADataSource实例OracleXADataSource oxds = new OracleXADataSource（）; oxds.setURL（URL）; //设置nativeXA属性以使用Native XA功能oxds.setNativeXA（true）; //根据需要将tnsEntry属性设置为较旧的数据库oxds.setTNSEntryName（“ora805”）; ...
</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="data-sources-and-URLs.html#GUID-088B1600-C6C2-4F19-A020-2DAF8FE1F1C3">数据源的特征和属性</a></li>
                           <li><a href="JDBC-error-messages.html#GUID-1F040951-2DB5-4A65-8027-8A737E34F6B3">本机XA消息</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="JJDBC28878"></a><div class="props_rev_3"><a id="GUID-1F63D0AC-A68E-48D8-B07C-E4E04CC42609" name="GUID-1F63D0AC-A68E-48D8-B07C-E4E04CC42609"></a><h4 id="JJDBC-GUID-1F63D0AC-A68E-48D8-B07C-E4E04CC42609" class="sect4"><span class="enumeration_section">33.5.2</span>瘦本机XA</h4>
                  <div>
                     <div class="section">
                        <p>与JDBC OCI驱动程序一样，JDBC Thin驱动程序也提供对Native XA的支持。但是，JDBC Thin驱动程序默认情况下为Native XA提供支持。这与JDBC OCI驱动程序的情况不同，在该驱动程序中，默认情况下不启用对Native XA的支持。</p>
                        <p>您可以通过在XA数据源上调用<code class="codeph">setNativeXA(false)</code>来禁用Native XA，如下所示：</p><pre class="oac_no_warn" dir="ltr">...//创建XADataSource实例OracleXADataSource oxds = new OracleXADataSource（）; ...//禁用Native XA oxds.setNativeXA（false）; ...
</pre><p>例如，您可能需要禁用Native XA作为Native XA代码中的错误的解决方法。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="01556.starting-interacting-with-rman-client.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>启动并与RMAN客户端交互</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96241-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="rman-architecture.html" title="Previous" type="text/html"></link>
      <link rel="next" href="configuring-rman-client-basic.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="BRADV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rman-architecture.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="configuring-rman-client-basic.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-starting-configuring-rman.html" property="item" typeof="WebPage"><span property="name">启动和配置RMAN和闪回数据库</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">启动并与RMAN客户端交互</li>
            </ol>
            <a id="GUID-E4E287F5-5F36-431A-B069-F360A5B4BC7C" name="GUID-E4E287F5-5F36-431A-B069-F360A5B4BC7C"></a><a id="BRADV005"></a>
            
            <h2 id="BRADV-GUID-E4E287F5-5F36-431A-B069-F360A5B4BC7C" class="sect2"><span class="enumeration_chapter">4</span>启动并与RMAN客户端交互</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍如何启动RMAN命令行界面并建立数据库连接。本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0" title="RMAN可执行文件随数据库自动安装，通常与其他数据库可执行文件位于同一目录中。例如，Linux上的RMAN客户端位于$ ORACLE_HOME / bin中。">启动和退出RMAN</a></p>
                  </li>
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。">使用RMAN建立数据库连接</a></p>
                  </li>
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD" title="默认情况下，RMAN将命令输出写入标准输出。要将输出重定向到日志文件，请在启动RMAN时在命令行上输入LOG参数。">指定RMAN输出的位置</a></p>
                  </li>
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-F600535A-D46A-4BB1-88FD-266396ECE795" title="在调用RMAN之前，设置NLS_DATE_FORMAT和NLS_LANG环境变量可能很有用。这些变量确定RMAN命令（如RESTORE，RECOVER和REPORT）中时间参数的格式。">为RMAN设置全球化支持环境变量</a></p>
                  </li>
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA" title="当RMAN客户端为命令做好准备时，它会显示命令提示符对于重复性任务，您可以创建包含RMAN命令的文本文件，并使用@参数启动RMAN客户端，然后使用文件名。RMAN中的注释字符是井号（＃）。从井号到行尾的所有文本都将被忽略。运行命令文件时，可以在USING子句中指定一个或多个值，以便在命令文件中的替换变量中使用。通过这种方式，您可以使命令文件动态化。您可以在不执行它们的情况下测试RMAN命令的语法正确性。使用命令行参数CHECKSYNTAX以一种模式启动RMAN客户端，在该模式下，它仅解析您输入的命令，并为不合法的RMAN语法的命令返回RMAN-00558错误。您可以交互式检查RMAN命令的语法，而无需实际执行命令。要在命令文件中测试命令，请使用CHECKSYNTAX参数启动RMAN，并使用@命令命名要传递的命令文件。">输入RMAN命令</a></p>
                  </li>
                  <li>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-2273E896-C08B-498F-B96C-55400CCD1A17" title="RMAN管道接口是向RMAN发出命令并从这些命令接收输出的另一种方法。使用此接口，可以将可移植的编程接口写入RMAN。">使用RMAN管道接口</a></p>
                  </li>
               </ul>
            </div><a id="BRADV8121"></a><div class="props_rev_3"><a id="GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0" name="GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0"></a><h3 id="BRADV-GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0" class="sect3"><span class="enumeration_section">4.1</span>启动和退出RMAN</h3>
               <div>
                  <p>RMAN可执行文件随数据库自动安装，通常与其他数据库可执行文件位于同一目录中。例如，Linux上的RMAN客户端位于<code class="codeph">$ORACLE_HOME/bin</code> 。
                  </p>
                  <div class="section">
                     <p>您有以下启动RMAN的基本选项：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在操作系统命令行中启动RMAN可执行文件，而不指定任何连接选项，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">％rman</pre><p>请参阅<span class="q">“ <span><a href="starting-interacting-with-rman-client.html#GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305" title="如果在操作系统命令行上启动没有连接字符串的RMAN，则必须在RMAN提示符下发出CONNECT TARGET命令以连接到目标数据库。">从RMAN提示符进行数据库连接</a></span> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>在操作系统命令行中启动RMAN可执行文件，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">％rman TARGET /％rman TARGET sbu @ prod NOCATALOG</pre><p>请参阅<span class="q">“ <span><a href="starting-interacting-with-rman-client.html#GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B" title="要从操作系统命令行连接到目标数据库，请输入rman命令，然后输入连接信息。您可以在显示RMAN提示后开始执行命令。">从操作系统命令行进行RMAN数据库连接</a></span> ”</span> 。
                           </p>
                        </li>
                     </ul>
                     <p>要退出RMAN并终止程序，请在RMAN提示符下输入<code class="codeph">EXIT</code>或<code class="codeph">QUIT</code> ：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;退出</pre><div class="infoboxnotealso" id="GUID-92CF0473-8B35-48A8-BA49-4DC52A7ECBC0__GUID-9283C17C-0D6E-407B-B7B7-55E7776BE872">
                        <p class="notep1">也可以看看：</p>
                        <p>适用于RMAN命令行语法的<span class="italic"><span><a href="../rcmrf/RMAN.html#RCMRF111" target="_blank">Oracle数据库备份和恢复参考</a></span></span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV8123"></a><div class="props_rev_3"><a id="GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" name="GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C"></a><h3 id="BRADV-GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" class="sect3"><span class="enumeration_section">4.2</span>使用RMAN建立数据库连接</h3>
               <div>
                  <p>您可以从RMAN客户端或操作系统命令行创建数据库连接。可以使用密码文件或操作系统身份验证对这些数据库连接进行身份验证。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C" title="要执行有用的工作，RMAN客户端必须连接到数据库。">关于RMAN数据库连接类型</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-BF676275-B5A4-46BE-8CDC-544906C416D2" title="与RMAN连接到目标或辅助数据库的用户需要SYSDBA或SYSBACKUP系统特权。">关于RMAN数据库连接的身份验证</a></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305" title="如果在操作系统命令行上启动没有连接字符串的RMAN，则必须在RMAN提示符下发出CONNECT TARGET命令以连接到目标数据库。">从RMAN提示符进行数据库连接</a></span></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B" title="要从操作系统命令行连接到目标数据库，请输入rman命令，然后输入连接信息。您可以在显示RMAN提示后开始执行命令。">从操作系统命令行进行RMAN数据库连接</a></span></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75" title="要使用DUPLICATE命令，必须连接到辅助实例。执行表空间时间点恢复（TSPITR）可能还需要连接到辅助实例。">将RMAN连接到辅助数据库</a></span></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" title="您可以将RMAN客户端连接到多租户容器数据库（CDB）和可插拔数据库（PDB）。">与CDB建立RMAN连接</a></span></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F" title="您可以通过创建包含CONNECT命令的RMAN命令文件来建立数据库连接。">在命令文件中建立RMAN数据库连接</a></span></p>
                     </li>
                     <li>
                        <p><span><a href="starting-interacting-with-rman-client.html#GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6" title="在诊断RMAN在连接目标，目录和辅助数据库时遇到的错误时，请考虑使用SQL * Plus直接连接到数据库。此操作可以揭示连接信息或数据库的潜在问题。">诊断RMAN连接问题</a></span></p>
                     </li>
                  </ul>
               </div><a id="BRADV151"></a><a id="BRADV89390"></a><div class="props_rev_3"><a id="GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C" name="GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C"></a><h4 id="BRADV-GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C" class="sect4"><span class="enumeration_section">4.2.1</span>关于RMAN数据库连接类型</h4>
                  <div>
                     <p>要执行有用的工作，RMAN客户端必须连接到数据库。</p>
                     <p><a href="starting-interacting-with-rman-client.html#GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C__CEGHGAFD" title="RMAN数据库连接的类型">表4-1</a>介绍了可以使用RMAN进行的数据库连接类型。</p>
                     <div class="tblformal" id="GUID-10B522E4-BA12-4B74-A77A-E189BFF6E59C__CEGHGAFD">
                        <p class="titleintable">表4-1 RMAN数据库连接概述</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="RMAN数据库连接概述" width="100%" border="1" summary="Types of RMAN database connections" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="29%" id="d19045e569">数据库连接的类型</th>
                                 <th align="left" valign="bottom" width="14%" id="d19045e572">关键词</th>
                                 <th align="left" valign="bottom" width="57%" id="d19045e575">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d19045e580" headers="d19045e569 ">
                                    <p><a href="glossary.html#GUID-272C4366-303F-4629-9679-1379AAC3FBC1"><span class="xrefglossterm">目标数据库</span></a></p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d19045e580 d19045e572 ">
                                    <p><code class="codeph">目标</code></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d19045e580 d19045e575 ">
                                    <p>RMAN备份或恢复的数据库</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d19045e593" headers="d19045e569 ">
                                    <p><a href="glossary.html#GUID-C54D9858-2461-412B-95FF-80FBACD58AB0"><span class="xrefglossterm">恢复目录数据库</span></a></p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d19045e593 d19045e572 ">
                                    <p><code class="codeph">目录</code></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d19045e593 d19045e575 ">
                                    <p>一种数据库，除控制文件外，还为RMAN存储库提供可选的备份存储。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d19045e606" headers="d19045e569 ">
                                    <p><a href="glossary.html#GUID-4B8BBEA0-2F0F-4C5E-AE69-F1EE4DBA1B46"><span class="xrefglossterm">辅助实例</span></a>或<a href="glossary.html#GUID-C179BB7F-F134-4D10-AADB-335526DB2BBA"><span class="xrefglossterm">辅助数据库</span></a></p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d19045e606 d19045e572 ">
                                    <p><code class="codeph">辅助</code></p>
                                 </td>
                                 <td align="left" valign="top" width="57%" headers="d19045e606 d19045e575 ">
                                    <p><a href="glossary.html#GUID-009B3F56-8C1E-4CF6-AF0F-A9D2C2E4B9C2"><span class="xrefglossterm">物理备用数据库</span></a>或为执行特定任务而创建的数据库实例，例如创建<a href="glossary.html#GUID-FFB6CFD5-300C-4290-B3C0-BFD930ACA30C"><span class="xrefglossterm">重复数据库</span></a> ，传输表空间或执行<a href="glossary.html#GUID-8A257409-B3DC-41FD-A2AF-D47560FF9F18"><span class="xrefglossterm">表空间时间点恢复（TSPITR）</span></a> 。
                                    </p>
                                    <p>对于使用辅助数据库的许多任务，RMAN会创建一个自动辅助实例，以便在任务期间使用，连接到它，执行任务，然后在任务完成时销毁它。您不提供任何显式命令来连接到自动辅助实例。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="BRADV89391"></a><div class="props_rev_3"><a id="GUID-BF676275-B5A4-46BE-8CDC-544906C416D2" name="GUID-BF676275-B5A4-46BE-8CDC-544906C416D2"></a><h4 id="BRADV-GUID-BF676275-B5A4-46BE-8CDC-544906C416D2" class="sect4"><span class="enumeration_section">4.2.2</span>关于RMAN数据库连接的身份验证</h4>
                  <div>
                     <p>与RMAN连接到目标或辅助数据库的用户需要<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>系统特权。
                     </p>
                     <p>连接到恢复目录时不需要这些权限。您必须将<code class="codeph">RECOVERY_CATALOG_OWNER</code>角色授予目录架构所有者。用户还可以使用恢复目录所有者创建的VPC凭据连接到恢复目录。
                     </p>
                     <p>RMAN提供了SQL * Plus可用的相同身份验证选项。使用目标数据库和辅助数据库进行身份验证的最常用方法是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>操作系统认证</p>
                           <p>用于使用操作系统认证连接的先决条件描述于<span class="q">“ <a href="starting-interacting-with-rman-client.html#GUID-703C639F-D05F-4130-8489-02E2BA6F1D26" title="可以使用操作系统身份验证来建立到目标或辅助数据库的RMAN连接。">验证使用操作系统</a> ”。</span>
                           </p>
                        </li>
                        <li>
                           <p>密码文件验证</p>
                           <p>使用密码文件认证连接的先决条件<span class="q">“</span>中描述<span class="q"><a href="starting-interacting-with-rman-client.html#GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D" title="使用密码文件进行本地或远程访问。如果数据库使用密码文件对管理用户进行身份验证，则RMAN可以使用密码进行连接。">的身份验证使用密码文件</a> ”。</span>
                           </p>
                        </li>
                     </ul>
                     <p>这两种方法都不需要打开数据库。操作系统身份验证仅用于本地连接。密码文件身份验证可用于本地或远程连接。</p>
                     <div class="infoboxnotealso" id="GUID-BF676275-B5A4-46BE-8CDC-544906C416D2__GUID-EA573EA5-7154-4ED5-8AFC-0CC60546C206">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../admin/getting-started-with-database-administration.html#ADMIN-GUID-7842AF72-DA25-4559-A8E7-9883D0C63BF2" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解使用SQL * Plus时的数据库连接选项</p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">SYSDBA</code>和<code class="codeph">SYSBACKUP</code>系统特权的详细信息，请参见“ <a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG785" target="_blank"><span><cite>Oracle数据库安全指南”</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV638"></a><a id="BRADV639"></a><a id="BRADV661"></a><a id="BRADV90309"></a><div class="props_rev_3"><a id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26" name="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26"></a><h5 id="BRADV-GUID-703C639F-D05F-4130-8489-02E2BA6F1D26" class="sect5"><span class="enumeration_section">4.2.2.1</span>使用操作系统进行身份验证</h5>
                     <div>
                        <p>可以使用操作系统身份验证来建立到目标或辅助数据库的RMAN连接。</p>
                        <div class="section">
                           <p>以下是使用操作系统身份验证（OS身份验证）连接到数据库的先决条件：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您必须设置<code class="codeph">ORACLE_SID</code>环境变量，指定数据库的系统标识符（SID）。
                                 </p>
                                 <p>例如，要在某些UNIX shell中将SID设置为<code class="codeph">prod</code> ，请输入：</p><pre class="oac_no_warn" dir="ltr">％ORACLE_SID = prod;导出ORACLE_SID</pre></li>
                              <li>
                                 <p>您必须是OSDBA操作系统组的成员才能连接<code class="codeph">SYSDBA</code>权限或OSBACKUPDBA操作系统组以连接<code class="codeph">SYSBACKUP</code>权限。
                                 </p>
                                 <p>在UNIX和Linux上，OSDBA组通常命名为<code class="codeph">dba</code> ，OSBACKUPDBA组通常命名为<code class="codeph">backupdba</code> 。在数据库安装期间分配这些名称。
                                 </p>
                              </li>
                           </ul>
                           <p>以下示例说明如何使用操作系统身份验证连接到目标数据库。</p>
                           <div class="infoboxnotealso" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-AF5076A7-EA39-4DD7-9B20-B49C2F43A924">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=ADMIN11053" target="_blank"><span class="italic">“Oracle数据库管理员指南”，</span></a>用于讨论操作系统组</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-51A530F9-E2B6-423C-B27A-35909FFB5502">
                           <p class="titleinexample">示例4-1具有SYSDBA权限的OS身份验证 - 显式</p><pre class="oac_no_warn" dir="ltr">％rman target'“/ as sysdba”'</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-E6DF9A7D-9BA1-4DD0-8A9B-7C6D27602294">
                           <p class="titleinexample">示例4-2使用SYSBACKUP权限的OS身份验证 - 显式</p><pre class="oac_no_warn" dir="ltr">％rman target'“/ as sysbackup”'</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-703C639F-D05F-4130-8489-02E2BA6F1D26__GUID-40F466F4-7510-4A7B-BDFF-545ADAD1B315">
                           <p class="titleinexample">示例4-3具有SYSDBA权限的OS身份验证 - 隐式</p><pre class="oac_no_warn" dir="ltr">rman目标/</pre><p>如果在连接字符串中既未指定<code class="codeph">AS SYSBACKUP</code>也未指定<code class="codeph">AS SYSDBA</code> ，则使用的默认值为<code class="codeph">AS SYSDBA</code> 。</p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="BRADV662"></a><a id="BRADV663"></a><a id="BRADV664"></a><a id="BRADV90306"></a><div class="props_rev_3"><a id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D" name="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D"></a><h5 id="BRADV-GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D" class="sect5"><span class="enumeration_section">4.2.2.2</span>使用密码文件进行身份验证</h5>
                     <div>
                        <p>使用密码文件进行本地或远程访问。如果数据库使用密码文件对管理用户进行身份验证，则RMAN可以使用密码进行连接。</p>
                        <div class="section">
                           <p>数据库必须使用<a href="glossary.html#GUID-AFB3C6E2-4C77-460F-A64D-A980EBF628EB"><span class="xrefglossterm">密码文件</span></a>才能使用网络服务名远程连接。
                           </p>
                           <div class="infoboxnote" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-DF96C77B-2DE4-4A80-A3D8-8DFF1AD61763">
                              <p class="notep1">警告：</p>
                              <p>良好的安全性要求不要在命令行上以纯文本形式输入密码。仅在RMAN提示请求时在RMAN中输入密码。请参阅<a href="../dbseg/configuring-authentication.html#DBSEG0032" target="_blank"><span class="italic">Oracle数据库安全指南</span></a>以了解密码保护。
                              </p>
                           </div>
                           <p>将<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限授予用户时，数据库会在密码文件中创建一个条目。然后，即使数据库未打开，您也可以以此用户身份连接到目标或辅助数据库。
                           </p>
                           <p>要支持通过密码文件与<code class="codeph">SYSBACKUP</code>权限进行连接，必须在Oracle Database 12 <span class="italic">c</span>第1版（12.1）或更高版本的格式中创建或升级密码文件。
                           </p>
                           <p>如果在连接字符串中既未指定<code class="codeph">AS SYSBACKUP</code>也未指定<code class="codeph">AS SYSDBA</code> ，则使用的默认值为<code class="codeph">AS SYSDBA</code> 。在这种情况下，不需要附上引号。
                           </p>
                           <div class="infoboxnotealso" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-34DE1A91-6906-4DDE-899F-EB7675F14886">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../admin/getting-started-with-database-administration.html#ADMIN11056" target="_blank"><span class="italic">Oracle数据库管理员指南</span></a> ，了解密码文件</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-DE1E5ADD-DDC7-43FD-B624-7DC03E5CDFAE">
                           <p class="titleinexample">示例4-4密码文件身份验证为SYSDBA  - 显式</p>
                           <p>在此示例中， <code class="codeph">sdba</code>用户已被授予<code class="codeph">SYSDBA</code>权限：</p><pre class="oac_no_warn" dir="ltr">％rman target'“sdba @ prod1 as sysdba”'target database密码：连接到目标数据库的<span class="italic">密码</span> ：PROD1（DBID = 39525561）</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-AC37F03B-9694-4441-A07C-DBFD69CE0C46">
                           <p class="titleinexample">示例4-5密码文件身份验证为SYSBACKUP  - 显式</p>
                           <p>在此示例中， <code class="codeph">sbu</code>用户在目标数据库中被授予<code class="codeph">SYSBACKUP</code>权限：</p><pre class="oac_no_warn" dir="ltr">％rman target'“sbu @ prod1 as sysbackup”'target database密码： <span class="italic">密码</span>连接到目标数据库：PROD1（DBID = 39525561）</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-45C00A07-B22E-4199-BCCA-91D02FCABF8D__GUID-30F46410-1428-470B-8E2D-F3311430D42F">
                           <p class="titleinexample">示例4-6密码文件身份验证为SYSDBA  - 隐式</p><pre class="oac_no_warn" dir="ltr">％rman target sbu @ prod1 target database密码：连接到目标数据库的<span class="italic">密码</span> ：PROD1（DBID = 39525561）</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="BRADV564"></a><a id="BRADV666"></a><a id="BRADV667"></a><a id="BRADV668"></a><a id="BRADV669"></a><a id="BRADV89393"></a><div class="props_rev_3"><a id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305" name="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305"></a><h4 id="BRADV-GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305" class="sect4"><span class="enumeration_section">4.2.3</span>从RMAN提示符进行数据库连接</h4>
                  <div>
                     <p>如果在操作系统命令行上启动没有连接字符串的RMAN，则必须在RMAN提示符下发出<code class="codeph">CONNECT TARGET</code>命令以连接到目标数据库。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-6E4997EF-B511-4B95-A710-5AD4E28CA842">要从RMAN提示符建立数据库连接：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在操作系统命令行上，启动RMAN客户端而不进行数据库连接。</span><div><pre class="oac_no_warn" dir="ltr">％rman RMAN&gt;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在RMAN提示符下，输入一个或多个<span><code class="codeph">CONNECT</code></span>命令。</span></li>
                     </ol>
                     <div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-9A4A3808-0461-4DC2-B2D0-D6E15E2D7FB8">
                        <p class="titleinexample">示例4-7使用OS身份验证进行连接 - 隐式</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;连接目标/</pre><p>由于未指定系统特权，因此假定为<span><code class="codeph">AS</code></span> <span><code class="codeph">SYSDBA</code></span> 。
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-897C3FAD-3098-41AC-98DF-2F460553C3FC">
                        <p class="titleinexample">示例4-8使用OS身份验证进行连接 - 显式</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;连接目标“/ as sysdba”</pre><p>包含系统特权时，需要带括号的引号（单引号或双引号）。</p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-C868A577-6A88-42E3-A4E1-DEA3416EC1CC">
                        <p class="titleinexample">示例4-9连接密码文件验证</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;连接目标“sbu @ prod AS SYSBACKUP”目标数据库密码：连接到目标数据库的密码：PROD（DBID = 39525561）</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-6BDE5844-E75F-465C-B068-3645DBAA2F40">
                        <p class="titleinexample">示例4-10连接到目标和恢复目录</p>
                        <p>在此示例中，目标连接使用操作系统身份验证，恢复目录数据库连接使用网络服务名称和密码文件身份验证。恢复目录所有者是用户<span><code class="codeph">rco</code></span> 。RMAN提示输入恢复目录用户的密码。
                        </p><pre class="oac_no_warn" dir="ltr">RMAN&gt;连接目标/ RMAN&gt;连接目录rco @ catdb恢复目录数据库密码：连接到恢复目录数据库的密码</pre></div>
                     <!-- class="example" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-E40A23BB-BE65-4665-B57D-F0D11FFDD305__GUID-64D3E2BC-1157-4B18-A852-4F36D6C6C4EF">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="italic"><span><a href="../rcmrf/CONNECT.html#RCMRF114" target="_blank">Oracle数据库备份和恢复参考</a></span></span>了解<span><code class="codeph">CONNECT</code></span>命令</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV153"></a><a id="BRADV563"></a><a id="BRADV155"></a><a id="BRADV89392"></a><div class="props_rev_3"><a id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B" name="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B"></a><h4 id="BRADV-GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B" class="sect4"><span class="enumeration_section">4.2.4</span>从操作系统命令行进行RMAN数据库连接</h4>
                  <div>
                     <p>要从操作系统命令行连接到目标数据库，请输入<code class="codeph">rman</code>命令，然后输入连接信息。您可以在显示RMAN提示后开始执行命令。
                     </p>
                     <div class="section">
                        <p>使用<code class="codeph">CATALOG</code>关键字连接到恢复目录。您也可以在不指定<code class="codeph">NOCATALOG</code>或<code class="codeph">CATALOG</code>情况下启动RMAN。如果未在命令行上指定<code class="codeph">NOCATALOG</code> ，并且在RMAN启动后未指定<a href="../rcmrf/CONNECT.html#RCMRF114" target="_blank"><code class="codeph">CONNECT CATALOG</code></a> ，则在第一次运行需要使用RMAN存储库的命令时，RMAN默认为<code class="codeph">NOCATALOG</code>模式。
                        </p>
                        <div class="infoboxnote" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__GUID-74F8AC49-CE11-4835-89D5-EB5B6B9692A8">
                           <p class="notep1">注意：</p>
                           <p>在<code class="codeph">NOCATALOG</code>模式下执行使用RMAN存储库的命令后，必须退出并重新启动RMAN才能连接到恢复目录。
                           </p>
                        </div>
                        <p>如果在操作系统命令行上连接到目标数据库，则可以在显示RMAN提示后开始执行命令。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__CHDHAFFI">
                        <p class="titleinexample">示例4-11从系统提示符连接到目标数据库</p>
                        <p>此示例说明了与使用操作系统身份验证的目标数据库的连接。<code class="codeph">NOCATALOG</code>选项表示会话中未使用恢复目录。
                        </p><pre class="oac_no_warn" dir="ltr">％rman TARGET / NOCATALOG连接到目标数据库：PROD（DBID = 39525561）使用目标数据库控制文件而不是恢复目录RMAN&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__CHDIGBFC">
                        <p class="titleinexample">示例4-12使用网络服务名称从系统提示符连接到目标数据库</p>
                        <p>此示例说明了与使用网络服务名称和密码文件身份验证的目标数据库的连接。RMAN提示输入密码。</p><pre class="oac_no_warn" dir="ltr">％rman TARGET sbu @ prod NOCATALOG目标数据库密码：连接到目标数据库的<span class="italic">密码</span> ：PROD（DBID = 39525561）RMAN&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-241D7D37-D905-4E52-99B6-3FD57AE1717B__BABJAFDA">
                        <p class="titleinexample">示例4-13从系统提示符连接到目标和恢复目录</p>
                        <p>此示例说明了对目标和恢复目录数据库使用Oracle Net身份验证的连接。在这两种情况下，RMAN都会提示输入密码。</p><pre class="oac_no_warn" dir="ltr">％rman TARGET sbu @ prod CATALOG rco @ catdb目标数据库密码：连接到目标数据库的<span class="italic">密码</span> ：PROD（DBID = 39525561）恢复目录数据库密码：连接到恢复目录数据库的<span class="italic">密码</span> RMAN&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="BRADV671"></a><div class="props_rev_3"><a id="GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" name="GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD"></a><h4 id="BRADV-GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" class="sect4"><span class="enumeration_section">4.2.5</span>与CDB建立RMAN连接</h4>
                  <div>
                     <p>您可以将RMAN客户端连接到多租户容器数据库（CDB）和可插拔数据库（PDB）。</p>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA" title="您可以在整个CDB，仅root用户或一个或多个PDB上执行RMAN操作。">关于在CDB和PDB上执行操作</a></p>
                        </li>
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA" title="直接连接到可插拔数据库（PDB）时，某些限制适用：">连接到PDB时的限制</a></p>
                        </li>
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D" title="有几种方法可以将目标连接到根目录。">作为目标连接到根</a></p>
                        </li>
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-E95C5C27-C036-4773-B77C-E4120526F422" title="您可以从RMAN提示符或操作系统命令行连接到PDB。">作为目标连接到PDB</a></p>
                        </li>
                     </ul>
                  </div><a id="BRADV672"></a><div class="props_rev_3"><a id="GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA" name="GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA"></a><h5 id="BRADV-GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA" class="sect5"><span class="enumeration_section">4.2.5.1</span>关于在CDB和PDB上执行操作</h5>
                     <div>
                        <p>您可以在整个CDB，仅root用户或一个或多个PDB上执行RMAN操作。</p>
                        <p>根据以下规则与CDB建立RMAN连接：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要在整个CDB上执行操作（例如，备份整个CDB），请将目标连接到根目录。</p>
                           </li>
                           <li>
                              <p>要仅对根执行操作（例如，备份根），请将目标连接到根目录。</p>
                           </li>
                           <li>
                              <p>要在单个PDB上执行操作，您可以将目标连接到根目录或直接连接到PDB。</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果连接到root，则必须在RMAN命令中使用<code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code>语法。例如，要备份PDB，请使用<code class="codeph">BACKUP</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code>命令。
                                    </p>
                                 </li>
                                 <li>
                                    <p>如果您直接连接到PDB，则可以使用连接到<a href="glossary.html#GUID-62A96A52-3B97-455A-A443-75B999DCAC94"><span class="xrefglossterm">非CDB</span></a>时使用的相同命令。例如，要备份PDB，可以使用<code class="codeph">BACKUP</code> <code class="codeph">DATABASE</code>命令。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>要使用单个命令对两个或多个PDB执行操作，请将目标连接到根目录。</p>
                              <p>例如，要备份<code class="codeph">sales</code>和<code class="codeph">hr</code> PDB，请连接到root并提交以下命令：</p><pre class="oac_no_warn" dir="ltr">BACKUP PLUGGABLE DATABASE销售额，小时;</pre></li>
                        </ul>
                        <div class="infoboxnote" id="GUID-01DF892F-FED5-4ADE-9152-9C3CF0921DBA__GUID-E1777870-69B4-4B2B-AE2C-FA5A1FC95E35">
                           <p class="notep1">注意：</p>
                           <p>如果使用操作系统身份验证将目标连接到CDB，则会连接到根目录。</p>
                        </div>
                     </div>
                  </div><a id="BRADV673"></a><div class="props_rev_3"><a id="GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA" name="GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA"></a><h5 id="BRADV-GUID-7CB295E4-C934-4C87-A08E-7E502C8AD9AA" class="sect5"><span class="enumeration_section">4.2.5.2</span>连接到PDB时的限制</h5>
                     <div>
                        <p>直接连接到可插拔数据库（PDB）时，某些限制适用：</p>
                        <p>将目标直接连接到PDB时，以下操作不可用：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>备份存档日志</p>
                           </li>
                           <li>
                              <p>删除存档日志</p>
                           </li>
                           <li>
                              <p>删除存档的日志备份</p>
                           </li>
                           <li>
                              <p>还原存档日志（RMAN会在介质恢复期间根据需要还原存档日志。）</p>
                           </li>
                           <li>
                              <p>使用共享撤消模式时的时间点恢复（PITR）</p>
                           </li>
                           <li>
                              <p>使用共享撤消模式时的TSPITR</p>
                           </li>
                           <li>
                              <p>使用共享撤消模式时的表恢复</p>
                           </li>
                           <li>
                              <p>使用共享撤消模式时重复数据库</p>
                           </li>
                           <li>
                              <p>使用共享撤消模式时的闪回操作</p>
                           </li>
                           <li>
                              <p>运行Data Recovery Advisor</p>
                           </li>
                           <li>
                              <p>报告/删除已过时</p>
                           </li>
                           <li>
                              <p>注册数据库</p>
                           </li>
                           <li>
                              <p>导入目录</p>
                           </li>
                           <li>
                              <p>重置数据库</p>
                           </li>
                           <li>
                              <p>配置RMAN环境（使用<code class="codeph">CONFIGURE</code>命令）</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="BRADV675"></a><a id="BRADV676"></a><a id="BRADV677"></a><a id="BRADV674"></a><div class="props_rev_3"><a id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D" name="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D"></a><h5 id="BRADV-GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D" class="sect5"><span class="enumeration_section">4.2.5.3</span>将目标连接到根目录</h5>
                     <div>
                        <p>有几种方法可以将目标连接到根目录。</p>
                        <div class="section">
                           <p>三种最常见的方式如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>作为普通用户在本地连接，如<a href="starting-interacting-with-rman-client.html#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGDEDBA">例4-14</a>所示</p>
                              </li>
                              <li>
                                 <p>连接操作系统认证，如<a href="starting-interacting-with-rman-client.html#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGEEBBD">例4-15</a>所示</p>
                              </li>
                              <li>
                                 <p>使用网络服务名称通过Oracle Net Services以普通用户身份连接，如<a href="starting-interacting-with-rman-client.html#GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGGHBDB">例4-16</a>所示</p>
                              </li>
                           </ul>
                           <p>在所有情况下，您必须以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的用户身份进行连接。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGDEDBA">
                           <p class="titleinexample">示例4-14本地连接到根</p>
                           <p>此示例使用<code class="codeph">SYS</code>用户本地连接到根， <code class="codeph">SYS</code>用户是普通用户。使用<code class="codeph">SYSDBA</code>权限建立连接。
                           </p><pre class="oac_no_warn" dir="ltr">rman target sys target database密码：连接到目标数据库的<span class="italic">密码</span> ：CDB（DBID = 659628168）</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGEEBBD">
                           <p class="titleinexample">示例4-15使用操作系统身份验证连接到根目录</p>
                           <p>此示例使用操作系统身份验证在本地连接到根。连接建立为具有<code class="codeph">SYSDBA</code>权限的<code class="codeph">SYS</code>用户。
                           </p><pre class="oac_no_warn" dir="ltr">rman目标/连接到目标数据库：CDB（DBID = 659628168）</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-43239E2D-0AFD-455D-89AB-87EDBC0E497D__CEGGHBDB">
                           <p class="titleinexample">示例4-16使用网络服务名称连接到根目录</p>
                           <p>此示例假定存在一个<code class="codeph">sales</code>网络服务名称，该名称解析为根目录的数据库服务，并且有一个名为<code class="codeph">c##bkuser</code>的公共用户具有<code class="codeph">SYSBACKUP</code>权限。
                           </p><pre class="oac_no_warn" dir="ltr">rman target c ## bkuser @ sales target database密码：连接到目标数据库的<span class="italic">密码</span> ：CDB（DBID = 659628168）</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="BRADV701"></a><a id="BRADV678"></a><div class="props_rev_3"><a id="GUID-E95C5C27-C036-4773-B77C-E4120526F422" name="GUID-E95C5C27-C036-4773-B77C-E4120526F422"></a><h5 id="BRADV-GUID-E95C5C27-C036-4773-B77C-E4120526F422" class="sect5"><span class="enumeration_section">4.2.5.4</span>作为目标连接到PDB</h5>
                     <div>
                        <p>您可以从RMAN提示符或操作系统命令行连接到PDB。</p>
                        <div class="p">
                           <p>要将目标连接到PDB，您必须：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用解析为该PDB的数据库服务的网络服务名称进行连接。</p>
                              </li>
                              <li>
                                 <p>使用<code class="codeph">SYSDBA</code>权限以<a href="glossary.html#GUID-43EA1A4C-E5EB-4926-99EC-1DDA0E74A07C"><span class="xrefglossterm">本地用户</span></a>或<a href="glossary.html#GUID-2B102186-15BD-443C-B375-8CB0D442CF5F"><span class="xrefglossterm">普通用户</span></a>身份进行连接。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-E95C5C27-C036-4773-B77C-E4120526F422__CEGDIEHF">
                           <p class="titleinexample">示例4-17将目标连接到PDB</p>
                           <p>此示例说明了与PDB的连接。它假设如下</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您希望在名为<code class="codeph">hrpdb</code>的PDB上执行RMAN操作。
                                 </p>
                              </li>
                              <li>
                                 <p>网络服务名称<code class="codeph">hrpdb</code>解析为<code class="codeph">hrpdb</code> PDB的数据库服务。</p>
                              </li>
                              <li>
                                 <p>本地用户<code class="codeph">hrbkup</code>是在<code class="codeph">hrpdb</code> PDB中创建的， <code class="codeph">hrpdb</code>授予<code class="codeph">SYSDBA</code>权限。
                                 </p>
                              </li>
                           </ul><pre class="oac_no_warn" dir="ltr">rman target hrbkup @hrpdb target database密码：连接到目标数据库的<span class="italic">密码</span> ：CDB（DBID = 659628168）</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E95C5C27-C036-4773-B77C-E4120526F422__GUID-A1D3D7A6-ADEB-4CF8-B011-D106678EEA38">
                           <p class="titleinexample">示例4-18连接到PDB和恢复目录</p>
                           <p></p>
                           <p>此示例说明了与PDB和恢复目录的连接。它假设如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您想要在名为<code class="codeph">salespdb</code>的PDB上执行操作。<code class="codeph">SYSBACKUP</code>用户用于连接PDB。</p>
                              </li>
                              <li>
                                 <p>网络服务名称<code class="codeph">salespdb</code>解析为<code class="codeph">salespdb</code> PDB的数据库服务。</p>
                              </li>
                              <li>
                                 <p>使用恢复目录所有者<code class="codeph">rco</code>创建与恢复目录的<code class="codeph">rco</code> 。恢复目录数据库的网络服务名称是<code class="codeph">catdb</code> 。
                                 </p>
                              </li>
                           </ul>
                           <p>出现提示时，输入<code class="codeph">sysbackup</code>和<code class="codeph">rco</code>用户的密码。
                           </p><pre class="pre codeblock"><code>RMAN&gt;连接目标“sys @ salespdb as sysdba”目标数据库密码：连接到目标数据库：DBMAIN：SALESPDB（DBID = 1661283172）RMAN&gt;连接目录rco @ catdb恢复目录数据库密码：连接到恢复目录数据库</code></pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="BRADV129"></a><div class="props_rev_3"><a id="GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F" name="GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F"></a><h4 id="BRADV-GUID-243F06D7-4CEC-4472-BA6B-79D8C9EEF07F" class="sect4"><span class="enumeration_section">4.2.6</span>在命令文件中建立RMAN数据库连接</h4>
                  <div>
                     <p>您可以通过创建包含<code class="codeph">CONNECT</code>命令的RMAN命令文件来建立数据库连接。
                     </p>
                     <div class="section">
                        <p>如果创建使用带有数据库级凭据（用户名和密码）的<a href="../rcmrf/CONNECT.html#RCMRF114" target="_blank"><code class="codeph">CONNECT</code></a>命令的RMAN命令文件，则对此文件具有读访问权限的任何人都可以学习密码。没有安全的方法将<code class="codeph">CONNECT</code>字符串与密码合并到命令文件中。
                        </p>
                        <p>如果创建使用<code class="codeph">CONNECT</code>命令的RMAN命令文件，则在使用<a href="../rcmrf/at-sign.html#RCMRF100" target="_blank"><code class="codeph">@</code></a>命令运行命令文件时，RMAN不会回显连接字符串。此行为可防止连接字符串出现在包含RMAN输出的任何日志文件中。例如，假设您创建命令文件<code class="codeph">listbkup.rman</code> ，如下所示：</p><pre class="oac_no_warn" dir="ltr">cat&gt; listbkup.rman &lt;&lt; EOF CONNECT TARGET / LIST BACKUP; EOF</pre><p>您可以通过使用<code class="codeph">@</code>命令行选项运行RMAN来执行此脚本，如下所示：</p><pre class="oac_no_warn" dir="ltr">％rman @ listbkup.rman</pre><p>执行命令文件时，RMAN用星号替换连接字符串，如以下输出所示：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET * 2&gt; LIST BACKUP; 3&gt;连接到目标数据库：RDBMS（DBID = 771530996）使用目标数据库控制文件而不是恢复目录备份集列表===================。 。 。</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV565"></a><a id="BRADV670"></a><a id="BRADV128"></a><div class="props_rev_3"><a id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75" name="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75"></a><h4 id="BRADV-GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75" class="sect4"><span class="enumeration_section">4.2.7</span>将RMAN连接到辅助数据库</h4>
                  <div>
                     <p>要使用<code class="codeph">DUPLICATE</code>命令，必须连接到辅助实例。执行表空间时间点恢复（TSPITR）可能还需要连接到辅助实例。
                     </p>
                     <div class="section">
                        <p>辅助连接的形式与目标数据库连接相同，只是您使用<code class="codeph">AUXILIARY</code>关键字而不是<code class="codeph">TARGET</code>关键字。
                        </p>
                        <div class="infoboxnote" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__GUID-B547AB32-C47E-4F95-A2D2-52C0371A79FA">
                           <p class="notep1">注意：</p>
                           <p>当你使用<code class="codeph">DUPLICATE ...FROM ACTIVE DATABASE</code>命令，需要一个网络服务名称。有关详细信息，请参阅<span class="q">“ <span><a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="有多种方法可用于创建启动辅助实例所需的初始化参数文件。">为辅助实例创建初始化参数文件</a></span> ”</span> 。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__GUID-3DFB19B7-3BD7-4AA5-B1B9-0953800D5575">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span><a href="rman-duplicating-databases.html#GUID-F31F9FCE-B610-49EB-B9DB-44B9AA4E838F" title="本章介绍如何使用DUPLICATE命令创建独立运行的数据库副本。">复制数据库</a></span>以获取有关使用<span><a href="../rcmrf/DUPLICATE.html#RCMRF126" target="_blank"><code class="codeph">DUPLICATE</code></a></span>命令的更多详细信息</p>
                              </li>
                              <li>
                                 <p><span><a href="performing-rman-tspitr.html#GUID-CAACDB53-7C3A-45B4-8249-C5D855D47571" title="要有效地使用RMAN表空间时间点恢复（TSPITR），了解它可以解决的问题类型，组件，RMAN在TSPITR期间所执行的操作以及对何时以及如何进行的各种限制和限制很有帮助。跑。本节介绍运行RMAN的基本概念，准备任务和运行模式TSPITR。恢复管理器（RMAN）TSPITR可以将数据库中的一个或多个表空间快速恢复到较早的时间，而不会影响数据库中的其余表空间和对象。了解RMAN TSPITR的概念，例如使用的术语和模式。本节定义了RMAN TSPITR使用的一些常见实体。有几种运行RMAN TSPITR的模式。各种操作模式之间的差异对应于您的环境中需要多少自动化与自定义。在执行完全自动化的RMAN TSPITR（默认）之前，从恢复集，辅助目标和目标时间中选择表空间。由于某些限制和限制，TSPITR无法解决某些数据库问题。在执行TSPITR时需要考虑一些限制。在TSPITR期间不使用恢复目录时要注意某些预防措施。准备执行TSPITR时必须完成某些步骤。为您选择正确的目标时间或SCN非常重要。 TSPITR。请注意，在TSPITR之后将表空间联机后，您不能在使表空间联机的时间之前使用任何备份。最初，恢复集包括要恢复的表空间的数据文件。但是，如果表空间中的对象需要与其他表空间中的对象建立关系（例如约束），则必须先考虑这些关系才能执行TSPITRRMAN TSPITR要求正在恢复的表空间是自包含的，并且没有SYS拥有的对象驻留在表空间中。在表空间上执行RMAN TSPITR时，在目标恢复时间之后创建的对象将丢失。您可以通过在TSPITR之前使用数据泵导出实用程序导出这些对象并在之后使用数据泵导入重新导入这些对象来保留这些对象。在默认模式下，RMAN在目标数据库上尽可能多地使用TSPITR的配置。您可以自定义RMAN TSPITR的某些方面，同时仍然主要执行完全自动化的RMAN TSPITR的过程。您可能不希望恢复集数据文件在其原始位置恢复和恢复。SET NEWNAME命令可用于指定新目标。为恢复集指定新目标时，RMAN不会删除表空间的原始数据文件。与通常存储在其原始位置的恢复集数据文件不同，辅助集数据文件不得覆盖目标数据库中的相应原始文件。如果未指定与其原始位置不同的辅助集文件位置，则TSPITR将失败。当RMAN尝试覆盖原始数据库中的相应文件并发现正在使用的文件时，会发生故障。辅助集数据文件可以在目标中具有Oracle管理文件（OMF），并且可以使用自动存储管理（ASM）或非ASM存储。当设置了DB_FILE_NAME_CONVERT初始化参数且OMF文件位于ASM或非ASM存储中时，TSPITR以不同方式执行名称转换。您可以使用辅助数据库的DB_FILE_NAME_CONVERT和LOG_FILE_NAME_CONVERT初始化参数来指定磁盘组的转换。RMAN使用该模式转换ASM磁盘组名称，并在转换后的磁盘组中生成有效的OMF文件名。有多种方法可用于重命名辅助数据库的OMF（非ASM）文件名。要为辅助集数据文件指定新名称，可以将RECOVER TABLESPACE包含在RUN命令中，并使用RUN块中的SET NEWNAME命令重命名该文件。如果您不想为所有辅助集数据文件使用辅助目标，但又不想单独命名每个文件，则可以在辅助数据库使用的初始化参数文件中包含DB_FILE_NAME_CONVERT初始化参数。临时文件被视为数据库辅助集的一部分。在实例化辅助数据库时，RMAN将重新创建目标数据库的临时表空间，并使用辅助数据文件名的常规规则生成其名称。通过重定向RMAN以使用恢复集和辅助集数据文件的现有映像副本，可以增强TSPITR性能。在这种情况下，RMAN不需要从备份还原数据文件。使用SET NEWNAME命令可以在使用映像副本执行TSPITR时指定映像副本的位置。CONFIGURE AUXNAME命令为辅助集数据文件映像副本设置持久备用位置，而SET NEWNAME命令为RUN命令的持续时间设置备用位置。使用映像副本执行TSPITR时，此过程使用CONFIGURE AUXNAME。自动辅助数据库使用一组默认初始化参数。如果需要，您可以添加其他参数。如果使用初始化参数文件，则可以使用CONTROL_FILES初始化参数为辅助数据库的控制文件指定自己的位置要在辅助数据库上恢复它们后对辅助和恢复集执行恢复，RMAN可能需要还原存档日志。使用辅助目标时，存档日志将还原到该位置。如果在辅助数据库参数文件中指定LOG_FILE_NAME_CONVERT初始化参数，并且参数成功转换目标的联机重做日志的名称，则此参数将确定联机重做日志位置。虽然Oracle建议您让RMAN管理辅助数据库的所有方面，但有时您可能必须创建和管理自己的辅助数据库。如果选择此模式，则负责设置，启动，停止和清理TSPITR中使用的辅助数据库。创建适合用作辅助数据库的Oracle实例需要执行一组步骤。有多种方法可以为辅助数据库创建密码文件。使用文本编辑器为目标数据库主机上的辅助数据库创建初始化参数文件。辅助数据库必须具有有效的网络服务名称。在继续之前，请使用SQL * Plus确保您可以与辅助数据库建立SYSBACKUP或SYSDBA连接。使用您自己的辅助实例执行TSPITR时，请记住某些准则。可以覆盖使用自己的辅助数据库进行TSPITR时通道的默认行为。您可能希望使用SET NEWNAME命令来引用辅助集文件的现有映像副本以提高TSPITR性能，或者为TSPITR之后的恢复集文件分配新名称。如有必要，请计划这些命令，并将它们添加到为TSPITR运行的命令序列中。完成先决条件，然后按照本节中的步骤使用您自己的辅助数据库执行TSPITR。在开始RMAN TSPITR之前，必须启动辅助数据库。由于辅助数据库还没有控制文件，因此只能以NOMOUNT模式启动实例。启动RMAN并连接到目标数据库和手动创建的辅助数据库。使用RECOVER TABLESPACE命令使用您自己的辅助实例执行TSPITR。此过程使用RECOVER TABLESPACE ...UNTIL命令执行TSPITR。各种问题都可能导致RMAN TSPITR失败。必须确定并修复问题。目标数据库中的文件，SET NEWNAME或CONFIGURE AUXNAME命令分配的文件名以及DB_FILE_NAME_CONVERT参数的效果生成的文件名之间可能会发生名称冲突。在TSPITR期间，RMAN需要有关哪些表空间在TSPITR目标时间具有还原段的信息。如果使用此信息，通常可在恢复目录中使用此信息。如果您正在管理自己的辅助数据库并且TSPITR失败，请不要尝试在不解决错误的情况下重新运行TSPITR。">执行RMAN表空间时间点恢复（TSPITR）</a></span>以获取有关执行TSPITR的更多详细信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__BABIABJA">
                        <p class="titleinexample">示例4-19从RMAN提示符连接到目标和辅助数据库</p>
                        <p>此示例说明使用操作系统身份验证连接到目标数据库，辅助数据库连接使用网络服务名称和密码文件身份验证。</p><pre class="oac_no_warn" dir="ltr">％rman RMAN&gt; CONNECT TARGET / RMAN&gt; CONNECT AUXILIARY sbu @ aux辅助数据库密码：连接到辅助数据库的<span class="italic">密码</span> ：AUX（DBID = 30472568）</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-067E6833-4A5B-46E4-89F0-D3C3B4FD1D75__CEGHDGEE">
                        <p class="titleinexample">示例4-20从系统提示符连接到目标和辅助数据库</p>
                        <p>此示例说明了从系统提示符到目标数据库和辅助数据库的连接。目标连接使用操作系统身份验证，辅助连接使用网络服务名称和密码文件身份验证。</p><pre class="oac_no_warn" dir="ltr">％rman目标/辅助sbu @ aux辅助数据库密码：连接到辅助数据库的<span class="italic">密码</span> ：AUX（DBID = 30472568）</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="BRADV89394"></a><div class="props_rev_3"><a id="GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6" name="GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6"></a><h4 id="BRADV-GUID-B7F7CDF4-3F34-4D20-AD36-10E2067DD7C6" class="sect4"><span class="enumeration_section">4.2.8</span>诊断RMAN连接问题</h4>
                  <div>
                     <p>在诊断RMAN在连接目标，目录和辅助数据库时遇到的错误时，请考虑使用SQL * Plus直接连接到数据库。此操作可以揭示连接信息或数据库的潜在问题。</p>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-E7230A40-996A-4D20-86E8-C636F85DA98E" title="RMAN使用SYSDBA或SYSBACKUP权限连接到目标数据库和辅助数据库。因此，当您使用SQL * Plus诊断目标或辅助数据库的连接问题时，请求SYSDBA或SYSBACKUP连接以重现RMAN行为。">诊断目标和辅助数据库连接问题</a></p>
                        </li>
                        <li>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B" title="使用SQL * Plus诊断恢复目录连接问题。">诊断恢复目录连接问题</a></p>
                        </li>
                     </ul>
                  </div><a id="BRADV89395"></a><div class="props_rev_3"><a id="GUID-E7230A40-996A-4D20-86E8-C636F85DA98E" name="GUID-E7230A40-996A-4D20-86E8-C636F85DA98E"></a><h5 id="BRADV-GUID-E7230A40-996A-4D20-86E8-C636F85DA98E" class="sect5"><span class="enumeration_section">4.2.8.1</span>诊断目标和辅助数据库连接问题</h5>
                     <div>
                        <p>RMAN使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限连接到目标数据库和辅助数据库。因此，当您使用SQL * Plus诊断目标或辅助数据库的连接问题时，请求<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>连接以重现RMAN行为。
                        </p>
                        <div class="section">
                           <p>例如，假设以下RMAN命令遇到连接错误：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET /</pre><p>您使用SQL * Plus命令重现前面的连接尝试，如下所示：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CONNECT / AS SYSBACKUP</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89396"></a><div class="props_rev_3"><a id="GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B" name="GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B"></a><h5 id="BRADV-GUID-88350C4F-36B9-4B8C-8F53-6320A6E7036B" class="sect5"><span class="enumeration_section">4.2.8.2</span>诊断恢复目录连接问题</h5>
                     <div>
                        <p>使用SQL * Plus诊断恢复目录连接问题。</p>
                        <div class="section">
                           <p>当RMAN连接到恢复目录数据库时，它不使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限。使用SQL * Plus诊断恢复目录数据库的连接问题时，必须输入与在RMAN中输入完全相同的数据库连接字符串。不要指定<code class="codeph">AS SYSBACKUP</code>或<code class="codeph">AS SYSDBA</code> 。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="BRADV89382"></a><div class="props_rev_3"><a id="GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD" name="GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD"></a><h3 id="BRADV-GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD" class="sect3"><span class="enumeration_section">4.3</span>指定RMAN输出的位置</h3>
               <div>
                  <p>默认情况下，RMAN将命令输出写入标准输出。要将输出重定向到日志文件，请在启动RMAN时在命令行上输入<code class="codeph">LOG</code>参数。</p>
                  <div class="section">
                     <p>以下示例将RMAN命令输出写入文件<code class="codeph">rman.log:</code></p><pre class="oac_no_warn" dir="ltr">％rman LOG /tmp/rman.log</pre><p>在这种情况下，RMAN显示命令输入但不显示RMAN输出。将RMAN输出发送到日志文件和标准输出的最简单方法是使用Linux <code class="codeph">tee</code>命令或其等效命令。例如，以下技术使输入和输出在RMAN命令行界面中可见：</p><pre class="oac_no_warn" dir="ltr">％rman | tee rman.log RMAN&gt;</pre><div class="infoboxnotealso" id="GUID-507D61EC-3D28-4C67-8013-BE724AD89FFD__GUID-06B4D6E7-E0B0-4B1F-803E-D8E42DFEA7B3">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../rcmrf/RMAN.html#RCMRF111" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a>了解RMAN命令行选项</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV8122"></a><div class="props_rev_3"><a id="GUID-F600535A-D46A-4BB1-88FD-266396ECE795" name="GUID-F600535A-D46A-4BB1-88FD-266396ECE795"></a><h3 id="BRADV-GUID-F600535A-D46A-4BB1-88FD-266396ECE795" class="sect3"><span class="enumeration_section">4.4</span>为RMAN设置全球化支持环境变量</h3>
               <div>
                  <p>在调用RMAN之前，设置<code class="codeph">NLS_DATE_FORMAT</code>和<code class="codeph">NLS_LANG</code>环境变量可能很有用。这些变量确定RMAN命令（如<code class="codeph">RESTORE</code> ， <code class="codeph">RECOVER</code>和<code class="codeph">REPORT</code>时间参数的格式。</p>
                  <div class="section">
                     <p>以下示例显示了典型的语言和日期格式设置：</p><pre class="oac_no_warn" dir="ltr">NLS_LANG =美国NLS_DATE_FORMAT ='Mon DD YYYY HH24：MI：SS'</pre><p>如果要使用RMAN连接到已卸载的数据库并在RMAN仍处于连接状态时安装数据库，则设置<code class="codeph">NLS_LANG</code>环境变量，以便它还指定数据库使用的字符集。
                     </p>
                     <p>未安装的数据库采用默认字符集，即<code class="codeph">US7ASCII</code> 。如果您的字符集与默认字符集不同，则RMAN会在装入数据库后返回错误。例如，如果字符集是<code class="codeph">WE8DEC</code> ，那么为了避免错误，您可以按如下方式设置<code class="codeph">NLS_LANG</code>变量：</p><pre class="oac_no_warn" dir="ltr">NLS_LANG = american_america.we8dec</pre><p>对于要应用的环境变量<a href="../refrn/NLS_DATE_FORMAT.html#REFRN10119" target="_blank"><code class="codeph">NLS_DATE_FORMAT</code></a>并覆盖服务器初始化文件中为服务器设置的缺省值，还必须设置环境变量<code class="codeph">NLS_LANG</code> 。
                     </p>
                     <div class="infoboxnotealso" id="GUID-F600535A-D46A-4BB1-88FD-266396ECE795__GUID-DBEF3432-12AB-4B27-93DF-BE054C10D710">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">NLS_LANG</code>和<code class="codeph">NLS_DATE_FORMAT</code>参数的详细信息，请<a href="../refrn/index.html" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="../nlspg/setting-up-globalization-support-environment.html#NLSPG003" target="_blank"><span class="italic">Oracle数据库全球化支持指南</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="BRADV89383"></a><div class="props_rev_3"><a id="GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA" name="GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA"></a><h3 id="BRADV-GUID-D7BEDDA1-26CF-47E0-B55F-85E3CA238ECA" class="sect3"><span class="enumeration_section">4.5</span>输入RMAN命令</h3>
               <div>
                  <p>您可以直接从RMAN提示输入RMAN命令，也可以从文本文件中读取它们。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4" title="当RMAN客户端准备好您的命令时，它会显示命令提示符">在RMAN提示符下输入RMAN命令</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535" title="对于重复性任务，您可以创建包含RMAN命令的文本文件，并使用@参数启动RMAN客户端，然后使用文件名。">将命令文件与RMAN一起使用</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC" title="RMAN中的注释字符是井号（＃）。从井号到行尾的所有文本都将被忽略。">在RMAN命令文件中输入注释</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD" title="运行命令文件时，可以在USING子句中指定一个或多个值，以便在命令文件中的替换变量中使用。通过这种方式，您可以使命令文件动态化。">在命令文件中使用替换变量</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-86BB8661-9779-4057-93A5-1ADC09C896CE" title="您可以在不执行它们的情况下测试RMAN命令的语法正确性。使用命令行参数CHECKSYNTAX以一种模式启动RMAN客户端，在该模式下，它仅解析您输入的命令，并为不合法的RMAN语法的命令返回RMAN-00558错误。">检查RMAN语法</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV89384"></a><div class="props_rev_3"><a id="GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4" name="GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4"></a><h4 id="BRADV-GUID-924C370B-C300-4FCF-A164-45EF1AAC4AE4" class="sect4"><span class="enumeration_section">4.5.1</span>在RMAN提示符下输入RMAN命令</h4>
                  <div>
                     <p>当RMAN客户端准备好您的命令时，它会显示命令提示符</p>
                     <div class="section">
                        <p>以下是RMAN命令提示符的示例：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;</pre><p>输入要执行的RMAN命令。例如：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET RMAN&gt; BACKUP DATABASE;</pre><p>大多数RMAN命令都有几个参数，必须以分号结尾。某些命令（如<a href="../rcmrf/STARTUP.html#RCMRF158" target="_blank"><code class="codeph">STARTUP</code></a> ， <a href="../rcmrf/SHUTDOWN.html#RCMRF155" target="_blank"><code class="codeph">SHUTDOWN</code></a>和<a href="../rcmrf/CONNECT.html#RCMRF114" target="_blank"><code class="codeph">CONNECT</code></a> ）可以使用或不使用分号。
                        </p>
                        <p>当您输入不是完整命令的文本行时，RMAN会提示输入带有行号的继续输入。例如：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; BACKUP DATABASE 2&gt; INCLUDE CURRENT 3&gt; CONTROLFILE 4&gt;;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89385"></a><div class="props_rev_3"><a id="GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535" name="GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535"></a><h4 id="BRADV-GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535" class="sect4"><span class="enumeration_section">4.5.2</span>在RMAN中使用命令文件</h4>
                  <div>
                     <p>对于重复性任务，您可以创建包含RMAN命令的文本文件，并使用<code class="codeph">@</code>参数启动RMAN客户端，然后使用文件名。
                     </p>
                     <div class="section">
                        <p>例如，在当前目录中创建一个包含一行文本的文本文件<code class="codeph">cmdfile1</code> ，如下所示：</p><pre class="oac_no_warn" dir="ltr">BACKUP DATABASE PLUS ARCHIVELOG;</pre><p>您可以从命令行运行此命令文件，如此示例所示，并执行其中包含的命令：</p><pre class="oac_no_warn" dir="ltr">％rman TARGET / @ cmdfile1</pre><p>命令完成后，RMAN退出。</p>
                        <p>您还可以在RMAN命令提示符下使用<a href="../rcmrf/at-sign.html#RCMRF100" target="_blank"><code class="codeph">@</code></a>命令在<a href="glossary.html#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN会话</span></a>期间执行命令文件的内容。RMAN读取文件并执行其中的命令。例如：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; @ cmdfile1</pre><p>执行命令文件内容后，RMAN显示以下消息：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; **文件结束**</pre><p>与从操作系统命令行执行命令文件的情况不同，RMAN不会退出。</p>
                        <div class="infoboxnotealso" id="GUID-5FF51A4E-BC27-41A9-AA83-FF6E761C2535__GUID-0EC863A4-0B8F-4A64-BE86-31E7B9FDFE78">
                           <p class="notep1">也可以看看：</p>
                           <p>适用于RMAN命令行语法的<a href="../rcmrf/RMAN.html#RCMRF111" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV99960"></a><div class="props_rev_3"><a id="GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC" name="GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC"></a><h4 id="BRADV-GUID-95DBA7A2-8D4F-428D-8ABC-A104FC064ABC" class="sect4"><span class="enumeration_section">4.5.3</span>在RMAN命令文件中输入注释</h4>
                  <div>
                     <p>RMAN中的注释字符是井号（ <code class="codeph">#</code> ）。从井号到行尾的所有文本都将被忽略。
                     </p>
                     <div class="section">
                        <p>例如，以下命令文件的内容备份数据库和归档重做日志文件并包含注释：</p><pre class="oac_no_warn" dir="ltr">＃命令文件名：mybackup.rman＃以下命令备份数据库BACKUP DATABASE; ＃以下命令备份存档的重做日志BACKUP ARCHIVELOG ALL;</pre><p>以下示例显示如何跨多行中断单个RMAN命令：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; BACKUP＃这是评论2&gt; SPFILE;</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV561"></a><a id="BRADV89386"></a><div class="props_rev_3"><a id="GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD" name="GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD"></a><h4 id="BRADV-GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD" class="sect4"><span class="enumeration_section">4.5.4</span>在命令文件中使用替换变量</h4>
                  <div>
                     <p>运行命令文件时，可以在<code class="codeph">USING</code>子句中指定一个或多个值，以便在命令文件中的替换变量中使用。通过这种方式，您可以使命令文件动态化。
                     </p>
                     <div class="section">
                        <p>与SQL * Plus一样， <code class="codeph">&amp;1</code>表示放置第一个值的位置， <code class="codeph">&amp;2</code>表示放置第二个值的位置，依此类推。替换变量语法是<code class="codeph">&amp;</code> <span class="italic"><code class="codeph">integer</code></span>后跟可选的句点，例如<code class="codeph">&amp;1.3</code> 。可选句点是变量的一部分，并替换为值，从而使替换文本后面紧跟另一个整数。例如，如果将值<code class="codeph">mybackup</code>传递给包含变量<code class="codeph">&amp;1.3</code>的命令文件，则替换的结果为<code class="codeph">mybackup3</code> 。
                        </p>
                        <p>以下过程说明如何创建和使用调用包含替换变量的命令文件的动态shell脚本。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD__GUID-4C8CDAD8-CFE9-47BE-A6DB-2347B4F9B16E">要创建和使用动态shell脚本：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>创建使用替换变量的RMAN命令文件。</span><div>
                              <p>以下示例显示了名为<code class="codeph">quarterly_backup.cmd</code>的命令文件的内容，该文件每季度运行一次。该脚本使用替换变量作为磁带集的名称， <code class="codeph">FORMAT</code>规范中的字符串以及要创建的还原点的名称。
                              </p><pre class="oac_no_warn" dir="ltr">#quartly_backup.cmd CONNECT TARGET / RUN {ALLOCATE CHANNEL c1 DEVICE TYPE sbt PARMS'ENV =（OB_MEDIA_FAMILY =＆1）'; BACKUP DATABASE TAG＆2 FORMAT'/disk2/bck/&amp;1%U.bck'KEEP FOREVER RESTORE POINT＆3; } 出口;</pre></div>
                        </li>
                        <li class="stepexpand"><span>创建可用于运行上一步中创建的RMAN命令文件的shell脚本。</span><div>
                              <p>以下示例创建名为<code class="codeph">runbackup.sh</code>的shell脚本。该示例为格式和还原点名称创建shell变量，并接受这些变量的值作为脚本的命令行参数。
                              </p><pre class="oac_no_warn" dir="ltr">＃！/ bin / tcsh #name：runbackup.sh＃usage：使用标签名称和副本数量作为参数设置media_family = $ argv [1] set format = $ argv [2] set restore_point = $ argv [3] rman @' /disk1/scripts/quarterly_backup.cmd'使用$ media_family $ format $ restore_point</pre></div>
                        </li>
                        <li class="stepexpand"><span>执行上一步中创建的shell脚本，在命令行上指定所需的参数。</span><div>
                              <p>以下示例运行<code class="codeph">runbackup.sh</code> shell脚本，并将<code class="codeph">archival_backup</code>作为媒体系列名称传递， <code class="codeph">bck0906</code>作为格式字符串，将<code class="codeph">FY06Q3</code>作为还原点名称<code class="codeph">FY06Q3</code> 。
                              </p><pre class="oac_no_warn" dir="ltr">％runbackup.sh archival_backup bck0906 FY06Q3</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-A9321B2D-6CFF-4616-B629-67960A8F87DD__GUID-AD3A08A6-E27C-4CF1-B619-696C0121BD52">
                           <p class="notep1">也可以看看：</p>
                           <p><code class="codeph">@</code>语法的<a href="../rcmrf/at-sign.html#RCMRF100" target="_blank"><span class="italic">Oracle数据库备份和恢复参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89387"></a><div class="props_rev_3"><a id="GUID-86BB8661-9779-4057-93A5-1ADC09C896CE" name="GUID-86BB8661-9779-4057-93A5-1ADC09C896CE"></a><h4 id="BRADV-GUID-86BB8661-9779-4057-93A5-1ADC09C896CE" class="sect4"><span class="enumeration_section">4.5.5</span>检查RMAN语法</h4>
                  <div>
                     <p>您可以在不执行它们的情况下测试RMAN命令的语法正确性。使用命令行参数<span><code class="codeph">CHECKSYNTAX</code></span>以一种模式启动RMAN客户端，在该模式下，它仅解析您输入的命令，并为不合法的RMAN语法的命令返回<span><code class="codeph">RMAN-00558</code></span>错误。
                     </p>
                     <p>您可以在命令行或命令文件中检查RMAN命令的语法。</p>
                     <div class="infoboxnotealso" id="GUID-86BB8661-9779-4057-93A5-1ADC09C896CE__GUID-9D5C4FCA-AFD7-4C80-873A-B4150D62D25D">
                        <p class="notep1">也可以看看：</p>
                        <p><span><a href="../rcmrf/RMAN.html#RCMRF111" target="_blank">Oracle数据库备份和恢复参考，</a></span>以了解<span><code class="codeph">CHECKSYNTAX</code></span>命令行选项</p>
                     </div>
                  </div><a id="BRADV562"></a><a id="BRADV89388"></a><div class="props_rev_3"><a id="GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19" name="GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19"></a><h5 id="BRADV-GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19" class="sect5"><span class="enumeration_section">4.5.5.1</span>在命令行中检查RMAN语法</h5>
                     <div>
                        <p>您可以交互式检查RMAN命令的语法，而无需实际执行命令。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-E7549936-0286-46EC-A6B2-EAC3B538AE19__GUID-C9332211-5DA6-4B83-8035-3A0707A2A756">要在命令行中检查RMAN语法：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>使用<code class="codeph">CHECKSYNTAX</code>参数启动RMAN：</span><div><pre class="oac_no_warn" dir="ltr">％rman CHECKSYNTAX</pre></div>
                           </li>
                           <li class="stepexpand"><span>输入要测试的RMAN命令。</span></li>
                        </ol>
                        <div class="section">
                           <p>以下示例显示了一个示例交互式会话，用户输入的文本以粗体显示。</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; <span class="bold">运行[备份数据库; ]</span> RMAN-00571：============================================= ============== RMAN-00569：===============错误信息堆栈跟踪============= == RMAN-00571：============================================ =============== RMAN-00558：解析输入命令时遇到错误RMAN-01006：在解析RMAN-02001期间发出错误信号：无法识别的标点符号“[”RMAN&gt; <span class="bold">运行{备份数据库; }</span>该命令没有语法错误RMAN&gt;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV149"></a><a id="BRADV150"></a><a id="BRADV89389"></a><div class="props_rev_3"><a id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E" name="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E"></a><h5 id="BRADV-GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E" class="sect5"><span class="enumeration_section">4.5.5.2</span>检查命令文件中的RMAN语法</h5>
                     <div>
                        <p>要在命令文件中测试命令，请使用<code class="codeph">CHECKSYNTAX</code>参数启动RMAN，并使用<code class="codeph">@</code>命令命名要传递的命令文件。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E__GUID-DE8A51DC-7837-4366-B992-AC0E1EA25339">要在命令文件中测试命令：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>使用文本编辑器创建命令文件。</span><div>
                                 <p>假设您使用以下内容创建<code class="codeph">/tmp/goodcmdfile</code> ：</p><pre class="oac_no_warn" dir="ltr">＃命令文件，包含合法语法RESTORE DATABASE;恢复数据库;</pre><p>假设您使用以下内容创建另一个命令文件<code class="codeph">/tmp/badcmdfile</code> ：</p><pre class="oac_no_warn" dir="ltr">＃命令文件包含错误的语法命令RESTORE DATABASE RECOVER DATABASE</pre></div>
                           </li>
                           <li class="stepexpand"><span>以下列格式从RMAN提示符运行命令文件，其中<span class="italic"><code class="codeph">filename</code></span>是命令文件的名称：</span><div><pre class="oac_no_warn" dir="ltr">％rman CHECKSYNTAX @ <span class="italic">filename</span>
</pre></div>
                           </li>
                        </ol>
                        <div class="example" id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E__BABCBGJD">
                           <p class="titleinexample">示例4-21使用正确的语法检查命令文件的语法</p>
                           <p>此示例显示使用<code class="codeph">CHECKSYNTAX</code>运行<code class="codeph">/tmp/goodcmdfile</code>时的<code class="codeph">CHECKSYNTAX</code> ：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt;＃命令文件，具有合法语法2&gt;恢复数据库; 3&gt;恢复数据库; 4&gt; cmdfile没有语法错误Recovery Manager完成。
</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E__GUID-3074D89B-6848-4047-9E46-EB62A1684FA7">
                           <p class="titleinexample">示例4-22检查语法错误的命令文件语法</p>
                           <p>此示例显示使用<span><code class="codeph">CHECKSYNTAX</code></span>运行<span><code class="codeph">/tmp/badcmdfile</code></span>时的<span><code class="codeph">CHECKSYNTAX</code></span> ：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; #command文件，语法错误2&gt;恢复数据库3&gt;恢复RMAN-00571：=============================== ============================ RMAN-00569：=============== ERROR MESSAGE STACK跟随=============== RMAN-00571：============================== ============================= RMAN-00558：解析输入命令时遇到错误RMAN-01005：语法错误：找到“recover” ：期待以下之一：“archivelog，channel，check，controlfile，clone，database，datafile，device，from，force，high，（，preview，;，skip，spfile，standby，tablespace，until，validate”）RMAN-01007：在第3行第1列文件：/ tmp / badcmdfile</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-F8ADDD5A-CAB0-4128-8DDD-9B8FD524362E__GUID-088542B2-E796-447D-B4F9-3ABAAA2EEBB3">
                           <p class="titleinexample">示例4-23检查包含替换变量的命令文件的语法</p>
                           <p>通过包含替换变量，可以使命令文件动态化。检查包含替换变量的命令文件的语法时，RMAN会提示您输入值。此示例说明了在检查动态命令文件的语法时输入无效值时会发生什么。粗体文本表示在提示符下输入的文本。</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; CONNECT TARGET * 2&gt; BACKUP TAG输入值1： <span class="bold">mybackup</span> abc COPIES输入值2： <span class="bold">mybackup</span> abc RMAN-00571：====================== ===================================== RMAN-00569：========= ======错误信息堆栈跟踪=============== RMAN-00571：===================== ====================================== RMAN-00558：解析输入命令时遇到错误RMAN- 01009：语法错误：找到“identifier”：期望以下之一：“integer”RMAN-01008：错误标识符为：mybackup RMAN-01007：第2行第25列文件：/tmp/whole_db.cmd</pre><p>RMAN表示语法错误，因为字符串<span><code class="codeph">mybackup</code></span>不是<span><code class="codeph">COPIES</code></span>的有效参数。</p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="BRADV1130"></a><div class="props_rev_3"><a id="GUID-2273E896-C08B-498F-B96C-55400CCD1A17" name="GUID-2273E896-C08B-498F-B96C-55400CCD1A17"></a><h3 id="BRADV-GUID-2273E896-C08B-498F-B96C-55400CCD1A17" class="sect3"><span class="enumeration_section">4.6</span>使用RMAN管道接口</h3>
               <div>
                  <p>RMAN管道接口是向RMAN发出命令并从这些命令接收输出的另一种方法。使用此接口，可以将可移植的编程接口写入RMAN。</p>
                  <p>通过管道接口，RMAN使用<code class="codeph">DBMS_PIPE</code> PL / SQL包而不是操作系统shell获取命令并发送输出。通过使用RMAN客户端的<code class="codeph">PIPE</code>命令行参数来调用管道接口。RMAN使用两个私有管道：一个用于接收命令，另一个用于发送输出。管道的名称是从<code class="codeph">PIPE</code>参数的值派生的。例如，您可以使用以下命令调用RMAN：</p><pre class="oac_no_warn" dir="ltr">％rman PIPE abc TARGET /</pre><p>RMAN打开目标数据库中的两个管道： <code class="codeph">ORA$RMAN_ABC_IN</code> （RMAN用于接收用户命令）和<code class="codeph">ORA$RMAN_ABC_OUT</code> （RMAN用于将所有输出发送回RMAN）。输入和输出管道上的所有消息都是<code class="codeph">VARCHAR2</code>类型。
                  </p>
                  <p>RMAN不允许管道接口与公共管道一起使用，因为它们是潜在的安全问题。使用公共管道，任何知道管道名称的用户都可以向RMAN发送命令并拦截其输出。</p>
                  <p>如果管道未初始化，则RMAN将它们创建为专用管道。如果要在启动RMAN之前将命令放在输入管道上，则必须首先通过调用<code class="codeph">DBMS_PIPE.CREATE_PIPE</code>创建管道。每当未明确将管道创建为专用管道时，对管道的第一次访问会自动将其创建为公共管道，如果告知管道使用公共管道，则RMAN会返回错误。
                  </p>
                  <div class="infoboxnote" id="GUID-2273E896-C08B-498F-B96C-55400CCD1A17__GUID-0CDC83B2-0F0E-49A9-AE04-5813A686F0A0">
                     <p class="notep1">注意：</p>
                     <p>如果可以针对目标数据库运行多个RMAN会话，则必须为每个<a href="glossary.html#GUID-01D29658-41E1-4D45-9C7F-A761D56885B9"><span class="xrefglossterm">RMAN会话</span></a>使用唯一的管道名称。<code class="codeph">DBMS_PIPE.UNIQUE_SESSION_NAME</code>函数是一种可用于生成唯一管道名称的方法。
                     </p>
                  </div>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4" title="此示例假定控制RMAN的应用程序想要连续运行多个命令。在每个命令沿管道发送并执行并返回输出后，RMAN暂停并等待下一个命令。">通过管道连续执行多个RMAN命令：示例</a></p>
                     </li>
                     <li>
                        <p><a href="starting-interacting-with-rman-client.html#GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F" title="此示例假定控制RMAN的应用程序想要将一个或多个命令作为单个作业运行。运行管道上的命令后，RMAN退出。">通过管道在单个作业中执行RMAN命令：示例</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV158"></a><a id="BRADV89397"></a><div class="props_rev_3"><a id="GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4" name="GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4"></a><h4 id="BRADV-GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4" class="sect4"><span class="enumeration_section">4.6.1</span>通过管道连续执行多个RMAN命令：示例</h4>
                  <div>
                     <p>此示例假定控制RMAN的应用程序想要连续运行多个命令。在每个命令沿管道发送并执行并返回输出后，RMAN暂停并等待下一个命令。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-2C7C92ED-41ED-4A51-848E-34E695B107D4__GUID-D9DFD470-F56B-4D68-BBF7-07E6ABF3155A">要通过管道执行RMAN命令：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>通过连接到目标数据库（必需）并指定<code class="codeph">PIPE</code>选项来启动RMAN。例如，输入：</span><div><pre class="oac_no_warn" dir="ltr">％rman PIPE abc TARGET /</pre><p>您还可以指定<code class="codeph">TIMEOUT</code>选项，如果在指定的秒数内没有从输入管道接收任何输入，则强制RMAN自动退出。例如，输入：</p><pre class="oac_no_warn" dir="ltr">％rman PIPE abc TARGET / TIMEOUT 60</pre></div>
                        </li>
                        <li class="stepexpand"><span>连接到目标数据库，并使用<code class="codeph">DBMS_PIPE.PACK_MESSAGE</code>和<code class="codeph">DBMS_PIPE.SEND_MESSAGE</code>将所需命令放在输入管道上。在管道模式下，RMAN在准备好接受输入而不是显示标准RMAN提示时发出消息<code class="codeph">RMAN-00572</code> 。</span></li>
                        <li class="stepexpand"><span>使用<code class="codeph">DBMS_PIPE.RECEIVE_MESSAGE</code>和<code class="codeph">DBMS_PIPE.UNPACK_MESSAGE</code>从输出管道读取RMAN输出。</span></li>
                        <li class="stepexpand"><span>重复步骤2和3，使用在步骤1中启动的相同RMAN实例执行更多命令。</span></li>
                        <li class="stepexpand"><span>如果在启动RMAN时使用了<code class="codeph">TIMEOUT</code>选项，则RMAN会在指定的时间长度内未收到任何输入后自动终止。要强制RMAN立即终止，请发送<code class="codeph">EXIT</code>命令。</span></li>
                     </ol>
                  </div>
               </div><a id="BRADV159"></a><a id="BRADV89398"></a><div class="props_rev_3"><a id="GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F" name="GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F"></a><h4 id="BRADV-GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F" class="sect4"><span class="enumeration_section">4.6.2</span>通过管道在单个作业中执行RMAN命令：示例</h4>
                  <div>
                     <p>此示例假定控制RMAN的应用程序想要将一个或多个命令作为单个作业运行。运行管道上的命令后，RMAN退出。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F__GUID-ED0EBBD3-A129-4760-8F8E-45856EE2457D">要通过管道在单个作业中执行RMAN命令：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>连接到目标数据库后，创建一个管道（如果它在名称<code class="codeph">ORA$RMAN_</code> <span class="italic">pipe</span> <code class="codeph">_IN</code>下不存在）。</span></li>
                        <li class="stepexpand"><span>将所需命令放在输入管道上。在管道模式下，RMAN在准备好接受输入而不是显示标准RMAN提示时发出消息<code class="codeph">RMAN-00572</code> 。</span></li>
                        <li class="stepexpand"><span>使用<code class="codeph">PIPE</code>选项启动RMAN，并指定<code class="codeph">TIMEOUT</code> <code class="codeph">0</code> 。例如，输入：</span><div><pre class="oac_no_warn" dir="ltr">％rman PIPE abc TARGET / TIMEOUT 0</pre></div>
                        </li>
                        <li class="stepexpand"><span>RMAN读取放在管道上的命令，并使用<code class="codeph">DBMS_PIPE.PACK_MESSAGE</code>和<code class="codeph">DBMS_PIPE.SEND_MESSAGE</code>执行它们。当它已经耗尽输入管道时，RMAN立即退出。</span></li>
                        <li class="stepexpand"><span>使用<code class="codeph">DBMS_PIPE.RECEIVE_MESSAGE</code>和<code class="codeph">DBMS_PIPE.UNPACK_MESSAGE</code>从输出管道读取RMAN输出。</span><div>
                              <div class="infoboxnotealso" id="GUID-5C6E3722-C0EC-4F1E-9D21-8205C5804C1F__GUID-DD748A83-B525-4264-A5BD-0BCFA09C1636">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关<code class="codeph">DBMS_PIPE</code>包的文档，请<code class="codeph">DBMS_PIPE</code> <a href="../arpls/DBMS_PIPE.html#ARPLS038" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="04041.xml-formats-map-visualizer.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This appendix describes the XML format for defining style, themes, and base maps using the map visualization component metadata views."></meta>
      <meta name="description" content="This appendix describes the XML format for defining style, themes, and base maps using the map visualization component metadata views."></meta>
      <title>样式，主题，基本地图和地图图块层的XML格式</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Map Visualization Developer&#39;s Guide "></meta>
      <meta property="og:description" content="This appendix describes the XML format for defining style, themes, and base maps using the map visualization component metadata views."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Map Visualization Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="spatial-and-graph-map-visualization-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T11:37:22-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E94797-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="oracle-map-builder-tool.html" title="Previous" type="text/html"></link>
      <link rel="next" href="creating-registering-custom-spatial-data-provider.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Spatial and Graph Map Visualization Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="JIMPV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-map-builder-tool.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="creating-registering-custom-spatial-data-provider.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">地图可视化开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">样式，主题，基本地图和地图图块层的XML格式</li>
            </ol>
            <a id="GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" name="GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5"></a><a id="JIMPV9000"></a>
            
            <h2 id="JIMPV-GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" class="sect2">对于样式，主题，基本地图和地图图块层<span class="enumeration_chapter">XML</span>格式</h2>
         </header>
         <div class="ind">
            <div>
               <p>本附录描述了使用地图可视化组件元数据视图定义样式，主题和基本地图的XML格式。</p>
               <p>这些元数据视图在<a href="map-visualization-concepts.html#GUID-565BF7E3-C504-4CDC-88B0-E1ACC67300E5" title="描述基本映射，主题和样式的映射元数据存储在由MDSYS拥有的全局表SDO_MAPS_TABLE，SDO_THEMES_TABLE和SDO_STYLES_TABLE中。">Map Visualizer元</a>数据视图中描述。
               </p>
               <p>地图可视化组件样式（USER_SDO_STYLES和相关视图）的元数据视图包含名为DEFINITION的列。对于每种样式，DEFINITION列包含一个XML文档，用于定义呈现引擎的样式。</p>
               <p>每种样式都使用类似于SVG（可缩放矢量图形）的语法定义。在地图可视化组件语法中，每个样式的XML文档必须包含单个<code class="codeph">&lt;g&gt;</code>元素，该元素必须具有指示样式的类型或类的<code class="codeph">class</code>属性。例如，以下定义了具有填充颜色组件的颜色样式：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;desc&gt; red &lt;/ desc&gt; <span class="bold">&lt;g class =“color”style =“fill：#ff1100”/&gt;</span> &lt;/ svg&gt;</pre><p>地图可视化组件XML解析器仅查找样式定义中的<code class="codeph">&lt;g&gt;</code>元素;其他属性（如<code class="codeph">&lt;desc&gt;</code>元素）仅仅是信息性的，会被忽略。
               </p>
               <div class="infoboxnote" id="GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5__GUID-7258F581-6770-49D1-AEB2-DB56D5C0B0B8">
                  <p class="notep1">注意：</p>
                  <p>您可以通过指定默认像素（ <code class="codeph">px</code> ）以外的单位来使样式的大小可缩放 - 例如， <code class="codeph">width:15.0km</code>或<code class="codeph">stroke-width:10.0m</code> 。有关使用可缩放样式的信息，请参阅<a href="map-visualization-concepts.html#GUID-C61A80D2-0B3A-4B5C-BA2A-B3B2202585DF">缩放</a>样式<a href="map-visualization-concepts.html#GUID-C61A80D2-0B3A-4B5C-BA2A-B3B2202585DF">的大小（可缩放样式）</a> 。
                  </p>
               </div>
               <p>地图可视化组件主题（USER_SDO_THEMES和相关视图）的元数据视图包含名为STYLING_RULES的列。对于这些视图中的每个主题，STYLING_RULES列包含一个XML文档（CLOB值），用于定义主题的样式规则。</p>
               <p><a id="d29258e103" class="indexterm-anchor"></a> MapViewer基本映射（USER_SDO_MAPS和相关视图）的元数据视图包含名为DEFINITION的列。对于这些视图中的每个基本映射，DEFINITION列包含定义基本映射的XML文档（CLOB值）。
               </p>
               <p>以下部分描述了每种映射元数据的XML语法。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-744D05FA-B031-4977-A701-AA5FEE57F8EC">颜色样式</a><br>颜色样式具有填充颜色，笔触颜色或两者。
                  </li>
                  <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-2A02333E-6396-4631-87EA-AC610DC1AC87">标记样式</a><br>标记样式表示要放置在点要素上或区域和线性要素的标注点上的标记。
                  </li>
                  <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-D4DB1B78-BE81-4F70-B5B7-B7A689B2AAF5">线条样式</a><br>线条样式仅适用于线性要素，例如道路，铁路轨道或政治边界。
                  </li>
                  <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-57E89E1B-B6B8-4B9C-94A6-3918DCBAEAC5">区域风格</a><br>区域样式定义用于填充区域要素的图案。
                  </li>
                  <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-DB68D830-A04C-43F5-80D0-1CEF5071A9A3">文字样式</a><br>文本样式定义用于标记空间要素的字体和颜色。
                  </li>
                  <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-8B0BF578-A3FC-4A81-A462-284ED667707B">高级样式</a><br>高级样式是由简单样式制成的结构化样式。
                  </li>
                  <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-45D7DCB4-5218-4469-9712-5F8AC338088B">主题：样式规则</a><br>主题定义包含一个<code class="codeph">&lt;styling_rules&gt;</code>元素，根据主题类型，该元素可能包含多个其他元素。
                  </li>
                  <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-C783909C-3637-4A18-9DDD-625A094E5DE2">基地图</a><br>基本地图定义由一个或多个主题组成。
                  </li>
                  <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-8B972AAC-B614-459B-91E2-18ADA5EF234F">地图图层</a><br>Oracle Maps地图图块层，用于从地图图块服务器组装并显示预生成的地图图像图块，</li>
               </ul>
            </div>
            <a id="JIMPV9829"></a><div class="props_rev_3"><a id="GUID-744D05FA-B031-4977-A701-AA5FEE57F8EC" name="GUID-744D05FA-B031-4977-A701-AA5FEE57F8EC"></a><h3 id="JIMPV-GUID-744D05FA-B031-4977-A701-AA5FEE57F8EC" class="sect3"><span class="enumeration_section">A.1</span>颜色样式</h3>
               <div>
                  <p>颜色样式具有填充颜色，笔触颜色或两者。</p>
                  <p>应用于形状或几何体时，填充颜色（如果存在）用于填充形状的内部，并且笔触颜色（如果存在）用于绘制形状的边界。两种颜色都可以具有alpha值，该值控制该颜色的透明度。</p>
                  <p>对于颜色样式， <code class="codeph">&lt;g&gt;</code>元素的<code class="codeph">class</code>属性必须设置为<code class="codeph">"color"</code> 。<code class="codeph">&lt;g&gt;</code>元素必须具有<code class="codeph">style</code>属性，该属性指定颜色组件及其可选的alpha值。例如：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">&lt;g class="color" style="fill:#ff0000"&gt;</code>指定仅具有填充颜色的颜色样式（其RGB值为＃ff0000）。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">&lt;g class="color" style="fill:#ff0000;stroke:blue"&gt;</code>指定具有填充颜色和笔触颜色（蓝色）的颜色样式。
                        </p>
                     </li>
                  </ul>
                  <p>您可以使用十六进制字符串（例如＃00ff00）或以下列表中的颜色名称指定颜色值：黑色，蓝色，青色，darkGray，灰色，绿色，浅灰色，品红色，橙色，粉红色，红色，白色，黄色。</p>
                  <p>要指定颜色样式<code class="codeph">fill-opacity</code> ，可以指定从0（完全透明）到255（不透明）的<code class="codeph">fill-opacity</code>和<code class="codeph">stroke-opacity</code>值。以下示例指定具有半透明度的填充组件：</p><pre class="oac_no_warn" dir="ltr">&lt;g class =“color”style =“fill：#fffff; fill-opacity：128”&gt;</pre><p>以下示例指定笔触和填充不透明度：</p><pre class="oac_no_warn" dir="ltr">&lt;g class =“color”style =“stroke：red; stroke-opacity：70; fill：＃ff00aa; fill-opacity：129”&gt;</pre><p><code class="codeph">style</code>属性的语法是由一个或多个由分号分隔的<code class="codeph">name:value</code>对组成的字符串。（这个基本语法也用于其他类型的样式。）
                  </p>
                  <p>对于笔触颜色，您可以定义笔触宽度。绘制形状边界时的默认笔触宽度为1像素。要更改它，请将<code class="codeph">stroke-width:</code> <span class="italic"><code class="codeph">value</code></span>对添加到<code class="codeph">style</code>属性字符串。以下示例指定3个像素的笔触宽度：</p><pre class="oac_no_warn" dir="ltr">&lt;g class =“color”style =“stroke：red; stroke-width：3”&gt;</pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" title="本附录描述了使用地图可视化组件元数据视图定义样式，主题和基本地图的XML格式。">样式，主题，基本映射和地图图层的XML格式</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="JIMPV9830"></a><div class="props_rev_3"><a id="GUID-2A02333E-6396-4631-87EA-AC610DC1AC87" name="GUID-2A02333E-6396-4631-87EA-AC610DC1AC87"></a><h3 id="JIMPV-GUID-2A02333E-6396-4631-87EA-AC610DC1AC87" class="sect3"><span class="enumeration_section">A.2</span>标记样式</h3>
               <div>
                  <p>标记样式表示要放置在点要素上或区域和线性要素的标注点上的标记。</p>
                  <p>标记可以是矢量标记或栅格图像标记。标记还可以具有可选的符号文本。对于矢量标记，必须在其XML文档中定义矢量元素的坐标。对于基于栅格图像的标记，样式的XML文档表示该样式基于外部图像。</p>
                  <p>标记XML文档指定首选显示大小：首选宽度和高度由<code class="codeph">&lt;g&gt;</code>元素的<code class="codeph">style</code>属性中的<code class="codeph">width:</code> <span class="italic"><code class="codeph">value</code></span> <code class="codeph">;height:</code> <span class="italic"><code class="codeph">value</code></span>对定义。<code class="codeph">class</code>属性必须设置为<code class="codeph">"marker"</code> 。某些标记必须覆盖一些符号文本，例如美国州际高速公路盾牌标记，在渲染时，还必须在其顶部绘制路线编号。这种符号文本的样式是具有以下一个或多个名称 - 值对的样式属性： <code class="codeph">font-family:</code> <span class="italic"><code class="codeph">value</code></span> ， <code class="codeph">font-style:</code> <span class="italic"><code class="codeph">value</code></span> ， <code class="codeph">font-size:</code> <span class="italic"><code class="codeph">value</code></span>和<code class="codeph">font-weight:</code> <span class="italic"><code class="codeph">value</code></span> 。
                  </p>
                  <p>以下示例定义了一个基于图像的标记，该标记为可以在标记顶部绘制的任何标签文本指定字体属性（以粗体显示）：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;desc&gt; &lt;/ desc&gt; &lt;g class =“marker”style =“width：20; height：18; <span class="bold">font-family：sans-serif; font-size ：9pt;填充：#ffffff</span> “&gt; &lt;image x =”0“y =”0“width =”9999“height =”9999“type =”gif“href =”dummy.gif“/&gt; &lt;/ g&gt; &lt; / SVG&gt;</pre><p>在前面的示例中，当标记应用于带有标签文本的点要素时，标签文本将使用指定的字体系列和大小以及填充颜色（在本例中为白色）绘制在标记顶部的中心。作为文本前景。“ <a href="xml-formats-map-visualizer.html#GUID-70115DCE-093E-4029-B67E-7FC9E952B680">使用行</a>上的<a href="xml-formats-map-visualizer.html#GUID-70115DCE-093E-4029-B67E-7FC9E952B680">标记样式”</a>中<a href="xml-formats-map-visualizer.html#GUID-70115DCE-093E-4029-B67E-7FC9E952B680__CHDFHJJG">图A-1</a>中的标签文本（ <code class="codeph">495</code> ）具有此示例中指定的文本属性。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-97109BE6-18C3-4062-B035-CD7C234A8E36">矢量标记样式</a><br></li>
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-62D1AD16-BCAE-4B47-8F23-631BD3385ABA">图像标记样式</a><br></li>
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-372280A6-B4CE-4F11-80F7-B626C50640B0">TrueType基于字体的标记样式</a><br></li>
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-70115DCE-093E-4029-B67E-7FC9E952B680">在线上使用标记样式</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" title="本附录描述了使用地图可视化组件元数据视图定义样式，主题和基本地图的XML格式。">样式，主题，基本映射和地图图层的XML格式</a></p>
                     </div>
                  </div>
               </div>
               <a id="JIMPV9831"></a><div class="props_rev_3"><a id="GUID-97109BE6-18C3-4062-B035-CD7C234A8E36" name="GUID-97109BE6-18C3-4062-B035-CD7C234A8E36"></a><h4 id="JIMPV-GUID-97109BE6-18C3-4062-B035-CD7C234A8E36" class="sect4"><span class="enumeration_section">A.2.1</span>矢量标记样式</h4>
                  <div>
                     <p>矢量标记可以是简单的多边形，优化的矩形（使用两个点定义），单个折线或圆形，但不能是它们的任何组合。对于每种类型的矢量标记，其<code class="codeph">&lt;g&gt;</code>元素必须包含指定几何信息的相应子元素（多边形的坐标，优化的矩形或折线，或圆的半径）：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>多边形定义使用带有<code class="codeph">points</code>属性的<code class="codeph">&lt;polygon&gt;</code>元素，该属性指定逗号分隔坐标列表。例如：</p><pre class="oac_no_warn" dir="ltr">&lt;g class =“marker”&gt; &lt;polygon points =“100,20,40,50,60,80,100,20”/&gt; &lt;/ g&gt;</pre></li>
                        <li>
                           <p>优化的矩形定义使用带有<code class="codeph">points</code>属性的<code class="codeph">&lt;rect&gt;</code>元素，该属性指定逗号分隔的坐标列表。例如：</p><pre class="oac_no_warn" dir="ltr">&lt;g class =“marker”&gt; &lt;rect points =“0,0,120,120”/&gt; &lt;/ g&gt;</pre></li>
                        <li>
                           <p>折线定义使用带有<code class="codeph">points</code>属性的<code class="codeph">&lt;polyline&gt;</code>元素，该属性指定逗号分隔坐标列表。例如：</p><pre class="oac_no_warn" dir="ltr">&lt;g class =“marker”&gt; &lt;折线点=“100,20,40,50,60,80”/&gt; &lt;/ g&gt;</pre></li>
                        <li>
                           <p>圆定义使用带有<code class="codeph">r</code>属性的<code class="codeph">&lt;circle&gt;</code>元素，该属性指定圆的半径。例如：</p><pre class="oac_no_warn" dir="ltr">&lt;g class =“marker”&gt; &lt;circle r =“50”/&gt; &lt;/ g&gt;</pre></li>
                     </ul>
                     <p>您可以为任何基于矢量的标记指定笔触或填充颜色或两者。语法与颜色样式的style属性相同。以下示例定义了一个三角形标记，该标记具有黑色边框并且填充了半透明的黄色：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;g class =“marker”style =“stroke：＃000000; fill：#ffff0000; fill-opacity：128”&gt; &lt;polygon points =“201.0,200.0， 0.0,200.0,101.0,0.0“/&gt; &lt;/ g&gt; &lt;/ svg&gt;</pre><p>如果标记是可缩放的，则可以使用<code class="codeph">max_size_in_px</code>属性在地图上设置标记的最大大小（以像素为单位）。将此属性设置为适当的值将阻止标记变得太大，以至于在用户放大以查看精细地图详细信息时阻止其他地图要素。以下示例将标记的最大大小设置为64像素：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;g class =“marker”max_size_in_px =“64”style =“stroke：＃0000BB; fill：＃0033FF; width：3.0mile; height：3.0mile; font -family：Dialog; font-size：12; font-fill：＃FF0000“&gt; &lt;polygon points =”0.0,0.0,0.0,100.0,100.0,100.0,100.0,0.0,0.0,0.0“/&gt; &lt;/ g&gt; &lt;/ SVG&gt;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-2A02333E-6396-4631-87EA-AC610DC1AC87" title="标记样式表示要放置在点要素上或区域和线性要素的标注点上的标记。">标记样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV9832"></a><div class="props_rev_3"><a id="GUID-62D1AD16-BCAE-4B47-8F23-631BD3385ABA" name="GUID-62D1AD16-BCAE-4B47-8F23-631BD3385ABA"></a><h4 id="JIMPV-GUID-62D1AD16-BCAE-4B47-8F23-631BD3385ABA" class="sect4"><span class="enumeration_section">A.2.2</span>图像标记样式</h4>
                  <div>
                     <p>对于图像标记，其XML文档包含<code class="codeph">&lt;image&gt;</code>元素，该元素根据图像标识标记。图像必须采用GIF格式，并存储在样式元数据视图的IMAGE列中。
                     </p>
                     <p>以下示例是图像标记的XML文档：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg&gt; &lt;g class =“marker”style =“width：20; height：18; font-family：sansserif; font-size：9pt”&gt; &lt;image x =“0”y =“0”width =“ 9999“height =”9999“type =”gif“href =”dummy.gif“/&gt; &lt;/ g&gt; &lt;/ svg&gt;</pre><p>请注意，在前面的示例中，可以将<code class="codeph">&lt;image&gt;</code>元素保留为空（即<code class="codeph">&lt;image/&gt;</code> ）以创建有效的定义，并在以后指定图像。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-2A02333E-6396-4631-87EA-AC610DC1AC87" title="标记样式表示要放置在点要素上或区域和线性要素的标注点上的标记。">标记样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV9833"></a><div class="props_rev_3"><a id="GUID-372280A6-B4CE-4F11-80F7-B626C50640B0" name="GUID-372280A6-B4CE-4F11-80F7-B626C50640B0"></a><h4 id="JIMPV-GUID-372280A6-B4CE-4F11-80F7-B626C50640B0" class="sect4"><span class="enumeration_section">A.2.3</span> TrueType基于字体的标记样式</h4>
                  <div>
                     <p>对于TrueType基于字体的标记，其标记符号存储在TrueType字体文件中，该文件具有.ttf文件扩展名，通常包含许多单独的符号或字形。许多GIS软件包附带TrueType字体文件，其中包含对映射有用的符号。</p>
                     <p>在地图可视化组件可以在TrueType字体文件中使用符号之前，您必须执行以下操作：</p>
                     <ol>
                        <li>
                           <p>将TrueType字体文件导入数据库，最好使用Map Builder工具（在<a href="oracle-map-builder-tool.html#GUID-17324FF4-9AA2-4182-93B7-B7999737FA67" title="本章简要介绍了地图可视化组件Map Builder工具，也称为Oracle Map Builder。它不提供有关工具界面的详细信息;为此，您应该使用Oracle Map Builder时可以使用的在线帮助。">Oracle Map Builder工具中</a>描述），这会导致字体文件中的符号插入系统视图USER_SDO_STYLES中的单个行。在这个新行中，TYPE列包含字符串TTF，IMAGE列包含TrueType字体文件的内容。导入操作后，您可以使用Map Builder工具查看TrueType字体文件中包含的所有字形或符号。此外，由于字体文件现在物理存储在数据库中，因此可以由所有地图可视化组件用户共享。
                           </p>
                        </li>
                        <li>
                           <p>基于导入的TrueType字体内的字形或符号创建地图可视化组件标记样式，最好使用Map Builder工具。</p>
                        </li>
                     </ol>
                     <p>以下示例显示了使用TrueType基于字体的标记（使用粗体的TrueType特定材质）：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;g class =“marker”style =“fill：#ff0000; width：25; height：25”&gt; <span class="bold">&lt;ttfSymbol fontName =“ERS_INCIDENTS”charCode =“118” /&gt;</span> &lt;/ g&gt; &lt;/ svg&gt;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-2A02333E-6396-4631-87EA-AC610DC1AC87" title="标记样式表示要放置在点要素上或区域和线性要素的标注点上的标记。">标记样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV9835"></a><a id="JIMPV9834"></a><div class="props_rev_3"><a id="GUID-70115DCE-093E-4029-B67E-7FC9E952B680" name="GUID-70115DCE-093E-4029-B67E-7FC9E952B680"></a><h4 id="JIMPV-GUID-70115DCE-093E-4029-B67E-7FC9E952B680" class="sect4"><span class="enumeration_section">A.2.4在线上</span>使用标记样式</h4>
                  <div>
                     <p>标记样式通常应用于点要素，在这种情况下，标记样式将在表示要素的点位置上呈现。但是，对于诸如高速公路之类的线（线串）功能，标记必须放置在沿线的某个点处，以表示有关该特征的一些信息，例如其路径编号。例如，在美国的地图上，屏蔽符号通常放在高速公路的顶部，符号内有路径编号， <a href="xml-formats-map-visualizer.html#GUID-70115DCE-093E-4029-B67E-7FC9E952B680__CHDFHJJG">如图A-1中的</a> 495号路线<a href="xml-formats-map-visualizer.html#GUID-70115DCE-093E-4029-B67E-7FC9E952B680__CHDFHJJG">所示</a> 。
                     </p>
                     <div class="figure" id="GUID-70115DCE-093E-4029-B67E-7FC9E952B680__CHDFHJJG">
                        <p class="titleinfigure">图A-1高速公路的盾牌符号标记</p><img src="img/shield.gif" alt="下面是图A-1的描述" title="下面是图A-1的描述" longdesc="img_text/shield.html"><br><a href="img_text/shield.html">“图A-1高速公路盾牌符号标记”的描述</a></div>
                     <!-- class="figure" -->
                     <p>要获得<a href="xml-formats-map-visualizer.html#GUID-70115DCE-093E-4029-B67E-7FC9E952B680__CHDFHJJG">图A-1中</a>显示的结果，您必须执行以下操作：</p>
                     <ol>
                        <li>
                           <p>选择标记样式，然后添加文本样式定义（字体系列，字体大小，填充颜色等），如<a href="xml-formats-map-visualizer.html#GUID-2A02333E-6396-4631-87EA-AC610DC1AC87" title="标记样式表示要放置在点要素上或区域和线性要素的标注点上的标记。">标记样式</a>中的示例所示。
                           </p>
                        </li>
                        <li>
                           <p>在主题的样式规则中将标记样式指定为标注样式。以下示例显示了XML文档，其中包含用于显示高速公路的主题的样式规则。指定了标记样式（在示例中以粗体显示）。标签文本（ <a href="xml-formats-map-visualizer.html#GUID-70115DCE-093E-4029-B67E-7FC9E952B680__CHDFHJJG">图A-1中的</a> <code class="codeph">495</code> ）是标签列中的值，在此示例中名为LABEL。
                           </p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;styling_rules theme_type =“political”&gt; &lt;rule&gt; &lt;features style =“L.PH”&gt;（name_class ='I'和TOLL = 0）&lt;/ features&gt; &lt;label column =“label” <span class="bold">style =“M.SHIELD1 “</span> &gt; 1 &lt;/ label&gt; &lt;/ rule&gt; &lt;styling_rules&gt;</pre></li>
                     </ol>
                     <p>地图可视化组件自动确定线上的最佳位置以放置标记样式（在此示例中为屏蔽）。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-2A02333E-6396-4631-87EA-AC610DC1AC87" title="标记样式表示要放置在点要素上或区域和线性要素的标注点上的标记。">标记样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="JIMPV9836"></a><div class="props_rev_3"><a id="GUID-D4DB1B78-BE81-4F70-B5B7-B7A689B2AAF5" name="GUID-D4DB1B78-BE81-4F70-B5B7-B7A689B2AAF5"></a><h3 id="JIMPV-GUID-D4DB1B78-BE81-4F70-B5B7-B7A689B2AAF5" class="sect3"><span class="enumeration_section">A.3</span>线型</h3>
               <div>
                  <p>线条样式仅适用于线性要素，例如道路，铁路轨道或政治边界。</p>
                  <p>换句话说，线条样式只能应用于Oracle Spatial和Graph几何，其SDO_GTYPE值以2（行）或6（多行）结尾。（有关SDO_GEOMETRY对象类型和SDO_GTYPE值的信息，请参阅<a href="../spatl/spatial-datatypes-metadata.html#SPATL489" target="_blank"><span class="italic">Oracle Spatial and Graph Developer's Guide</span></a> 。）
                  </p>
                  <p>当地图可视化组件绘制线性要素时，线条样式会告知渲染引擎要使用的颜色，虚线图案和笔触宽度。线条样式可以具有基线元素，如果定义，则该元素与原始线性几何形状重合。它还可以定义与基线平行的两条边。平行线元素可以有自己的颜色，虚线图案和笔触宽度。如果使用平行线，则它们必须位于基线的每一侧，并具有相等的偏移。</p>
                  <p>要绘制类似铁路的线，您需要在称为<span class="italic">hashmark</span>的线型中定义第三种线元素。对于类<code class="codeph">hashmark</code>的<code class="codeph">&lt;line&gt;</code>元素，dash数组中的第一个值表示两个哈希标记之间的间隙，第二个值表示该行的任一侧的哈希标记的长度。以下示例定义了一个哈希标记行，其间隙为8.5个屏幕单位，基线每侧的长度为3个屏幕单位：</p><pre class="oac_no_warn" dir="ltr">&lt;line class =“hashmark”style =“fill：＃003333”dash =“8.5,3.0”/&gt;</pre><p>以下示例定义完整的线条样式。</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;g class =“line”style =“fill：#ffff0000; stroke-width：5”&gt; &lt;line class =“parallel”style =“fill：#ff0000 ; stroke-width：1.0“/&gt; &lt;line class =”base“style =”fill：black; stroke-width：1.0“dash =”10.0,4.0“/&gt; &lt;/ g&gt; &lt;/ svg&gt;</pre><p>在前面的示例中， <code class="codeph">class="line"</code>将样式标识为线条样式。整体填充颜色（#ffff00）用于填充平行线和基线之间的任何空间。整体线宽（5像素）限制了样式可以占用的最大宽度（包括平行线的宽度）。
                  </p>
                  <p>前面示例中的线条样式包含基线和平行线元素。并行线元素（ <code class="codeph">class="parallel"</code> ）由第一个<code class="codeph">&lt;line&gt;</code>元素定义，该元素定义其颜色和宽度。（因为定义不提供虚线图案，所以平行线或边缘将是实心的。）基线元素（ <code class="codeph">class="base"</code> ）由第二个<code class="codeph">&lt;line&gt;</code>元素定义，该元素定义其颜色，宽度和虚线模式。
                  </p>
                  <p>可以为线型定义标记（例如方向标记）。<code class="codeph">marker-name</code>参数指定标记样式的名称， <code class="codeph">marker-position</code>参数指定沿着从放置标记的起始点开始的线的距离的比例（从0到1），以及<code class="codeph">marker-size</code>参数指定标记大小的显示单位数。标记方向遵循放置标记的线段的方向。
                  </p>
                  <p>以下示例使用方向标记定义线型：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;g class =“line”style =“fill：＃33a9ff; stroke-width：4; marker-name：M.IMAGE105_BW; marker-position：0.15; marker -size = 8“&gt; &lt;line class =”parallel“style =”fill：red; stroke-width：1.0“/&gt; &lt;/ g&gt; &lt;/ svg&gt;</pre><p>要获取多个标记，请将<code class="codeph">multiple-marker</code>属性添加到样式定义中。在这种情况下，标记位置将定义第一标记的位置和标记之间的空间。以下示例定义了一种线条样式，其方向标记从位置0.15开始，并且在每次出现之间连续重复，间隔为0.15。
                  </p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;g class =“line”style =“fill：＃33a9ff; stroke-width：4; marker-name：M.IMAGE105_BW; marker-position：0.15; marker -size = 8; <span class="bold">multiple-marker = true</span> “&gt; &lt;line class =”parallel“style =”fill：red; stroke-width：1.0“/&gt; &lt;/ g&gt; &lt;/ svg&gt;</pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" title="本附录描述了使用地图可视化组件元数据视图定义样式，主题和基本地图的XML格式。">样式，主题，基本映射和地图图层的XML格式</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="JIMPV9837"></a><div class="props_rev_3"><a id="GUID-57E89E1B-B6B8-4B9C-94A6-3918DCBAEAC5" name="GUID-57E89E1B-B6B8-4B9C-94A6-3918DCBAEAC5"></a><h3 id="JIMPV-GUID-57E89E1B-B6B8-4B9C-94A6-3918DCBAEAC5" class="sect3"><span class="enumeration_section">A.4</span>区域样式</h3>
               <div>
                  <p>区域样式定义用于填充区域要素的图案。</p>
                  <p>在当前版本中，区域样式必须基于图像。也就是说，将区域样式应用于几何体时，将重复绘制定义样式的图像，直到完全填充几何体。</p>
                  <p>的面积定义式类似于的图像标记样式，其描述在<a href="xml-formats-map-visualizer.html#GUID-62D1AD16-BCAE-4B47-8F23-631BD3385ABA">图像标记样式</a> 。
                  </p>
                  <p>以下示例定义了区域样式：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;g class =“area”style =“stroke：＃000000”&gt; &lt;image /&gt; &lt;/ g&gt; &lt;/ svg&gt;</pre><p>在前面的示例中， <code class="codeph">class="area"</code>将样式标识为区域样式。笔触颜色（ <code class="codeph">style="stroke:#000000"</code> ）是用于绘制几何边界的颜色。如果未定义笔触颜色，则几何体没有可见边界，尽管其内部填充了图案图像。
                  </p>
                  <p>您还可以指定任何线条样式以用作区域样式的边界。以下区域样式定义使用<code class="codeph">line-style</code>关键字（在示例中以粗体显示）来指定要用于要素边框的线型：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;g class =“area”style =“ <span class="bold">line-style</span> ：L.DPH”&gt; &lt;image x =“0”y =“0”width =“9999” height =“9999”type =“gif”href =“dummy.gif”/&gt; &lt;/ g&gt; &lt;/ svg&gt;</pre><p>与图像标记样式一样，区域样式的图像必须存储在单独的列中（在USER_SDO_STYLES和ALL_SDO_STYLES元数据视图的IMAGE列中标识，这些视图在<a href="map-visualization-concepts.html#GUID-818EC731-8296-4594-9327-F573E930F56B">xxx_SDO_STYLES视图</a>中描述）。
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" title="本附录描述了使用地图可视化组件元数据视图定义样式，主题和基本地图的XML格式。">样式，主题，基本映射和地图图层的XML格式</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="JIMPV9839"></a><a id="JIMPV9838"></a><div class="props_rev_3"><a id="GUID-DB68D830-A04C-43F5-80D0-1CEF5071A9A3" name="GUID-DB68D830-A04C-43F5-80D0-1CEF5071A9A3"></a><h3 id="JIMPV-GUID-DB68D830-A04C-43F5-80D0-1CEF5071A9A3" class="sect3"><span class="enumeration_section">A.5</span>文本样式</h3>
               <div>
                  <p>文本样式定义用于标记空间要素的字体和颜色。</p>
                  <p><code class="codeph">class</code>属性必须具有值<code class="codeph">"text"</code> 。对于字体，您可以指定其样式（纯色，斜体等），字体系列，大小和重量。要指定前景色，请使用<code class="codeph">fill</code>属性。
                  </p>
                  <p>以下示例定义文本样式：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;g class =“text”style =“font-style：plain; font-family：Dialog; font-size：14pt; font-weight：bold; fill： ＃0000ff“&gt; Hello World！&lt;/ g&gt; &lt;/ svg&gt;</pre><p>在前面的示例中，文本“Hello World！“仅在样式创建工具（例如Map Builder工具）中预览样式本身时才会显示”。将样式应用于地图时，始终为其提供地图可视化组件从主题获取的实际文本标签。</p>
                  <p>文本样式可以在渲染文本周围提供浮动白色背景，以使标签更易于在具有许多功能的地图上阅读。<a href="xml-formats-map-visualizer.html#GUID-DB68D830-A04C-43F5-80D0-1CEF5071A9A3__CHDFIEEH">图A-2</a>显示了标签Vallejo，白色背景紧紧围绕字母。
                  </p>
                  <div class="figure" id="GUID-DB68D830-A04C-43F5-80D0-1CEF5071A9A3__CHDFIEEH">
                     <p class="titleinfigure">图A-2文本样式有白色背景</p><img src="img/halotext.jpg" alt="下面是图A-2的描述" title="下面是图A-2的描述" longdesc="img_text/halotext.html"><br><a href="img_text/halotext.html">“图A-2白色背景文字样式”的说明</a></div>
                  <!-- class="figure" -->
                  <p>要获得<a href="xml-formats-map-visualizer.html#GUID-DB68D830-A04C-43F5-80D0-1CEF5071A9A3__CHDFIEEH">图A-2</a>中<a href="xml-formats-map-visualizer.html#GUID-DB68D830-A04C-43F5-80D0-1CEF5071A9A3__CHDFIEEH">所示</a>的结果，必须在文本样式定义的<code class="codeph">&lt;g&gt;</code>元素中指定<code class="codeph">float-width</code>属性。以下示例使用<code class="codeph">float-width</code>属性（在示例中以粗体显示）指定从每个字母的边界延伸3.5像素的白色背景。（Hello World！将样式应用于标签显示时，将忽略文本。）
                  </p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;svg width =“1in”height =“1in”&gt; &lt;desc&gt; &lt;/ desc&gt; &lt;g class =“text” <span class="bold">float-width =“3.5”</span> style =“font-style：plain; font-family：Dialog; font-size：12pt; font-weight：bold;填充：＃000000“&gt; Hello World！&lt;/ g&gt; &lt;/ svg&gt;</pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" title="本附录描述了使用地图可视化组件元数据视图定义样式，主题和基本地图的XML格式。">样式，主题，基本映射和地图图层的XML格式</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="JIMPV9840"></a><div class="props_rev_3"><a id="GUID-8B0BF578-A3FC-4A81-A462-284ED667707B" name="GUID-8B0BF578-A3FC-4A81-A462-284ED667707B"></a><h3 id="JIMPV-GUID-8B0BF578-A3FC-4A81-A462-284ED667707B" class="sect3"><span class="enumeration_section">A.6</span>高级样式</h3>
               <div>
                  <p>高级样式是由简单样式制成的结构化样式。</p>
                  <p>高级样式主要用于专题制图。核心高级风格是桶式（ <code class="codeph">BucketStyle</code> ），每种高级风格都是桶式的一种形式。存储桶样式是一组基本样式和一组存储桶之间的一对一映射。每个存储桶包含要绘制的要素的一个或多个属性值。对于每个功能，其中一个属性用于确定它属于或包含在哪个存储桶中，然后将分配给该存储桶的样式应用于该功能。
                  </p>
                  <p>还提供了两种特殊类型的桶样式：颜色方案（在<a href="xml-formats-map-visualizer.html#GUID-577FABC2-FFA1-458C-9C0B-2E93D21EA1A3">颜色方案样式中</a>描述）和可变（渐变）标记（在<a href="xml-formats-map-visualizer.html#GUID-3AA7E47E-8C54-4382-AC5A-42D5ED73856A">可变标记样式中</a>描述）。
                  </p>
                  <p>其他高级样式是点密度（在<a href="xml-formats-map-visualizer.html#GUID-64F7BB3E-94E3-433C-AF2C-F6C3D51B2A56">点密度标记样式中</a>描述），条形图（在<a href="xml-formats-map-visualizer.html#GUID-F878EE21-DBCE-47C3-A842-CF69DEA0F92C">条形图标记样式中</a>描述），集合（在<a href="xml-formats-map-visualizer.html#GUID-786D9C05-C3C2-4A90-B5DE-6B5718DC792E">集合样式中</a>描述）和可变饼图（在<a href="xml-formats-map-visualizer.html#GUID-4F10A15B-88D4-4941-8063-834932D4F481">可变饼图样式中</a>描述）。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-85FE8BC7-DA9E-4264-8045-D8B3C54050AF">斗式样</a><br></li>
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-577FABC2-FFA1-458C-9C0B-2E93D21EA1A3">配色方案样式</a><br></li>
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-3AA7E47E-8C54-4382-AC5A-42D5ED73856A">可变标记样式</a><br></li>
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-64F7BB3E-94E3-433C-AF2C-F6C3D51B2A56">点密度标记样式</a><br></li>
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-F878EE21-DBCE-47C3-A842-CF69DEA0F92C">条形图标记样式</a><br></li>
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-786D9C05-C3C2-4A90-B5DE-6B5718DC792E">收集样式</a><br></li>
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-4F10A15B-88D4-4941-8063-834932D4F481">可变饼图样式</a><br></li>
                     <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-751BB8F1-237A-4688-A0DA-229225771FDF">热图样式</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" title="本附录描述了使用地图可视化组件元数据视图定义样式，主题和基本地图的XML格式。">样式，主题，基本映射和地图图层的XML格式</a></p>
                     </div>
                  </div>
               </div>
               <a id="JIMPV9841"></a><div class="props_rev_3"><a id="GUID-85FE8BC7-DA9E-4264-8045-D8B3C54050AF" name="GUID-85FE8BC7-DA9E-4264-8045-D8B3C54050AF"></a><h4 id="JIMPV-GUID-85FE8BC7-DA9E-4264-8045-D8B3C54050AF" class="sect4"><span class="enumeration_section">A.6.1</span>铲斗样式</h4>
                  <div>
                     <p>存储桶样式定义了一组存储桶，并为每个存储桶分配一种基本样式。存储桶的内容可以是以下任一种：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>离散值的集合（例如，飓风风险代码为1或2的所有县的桶，飓风风险代码为3的所有县的桶，等等）。</p>
                        </li>
                        <li>
                           <p>连续的价值范围（例如，所有县的平均家庭收入低于30,000美元的桶，所有县的桶，平均家庭收入从30,000美元到39,999美元，等等）。在这种情况下，可以单独定义一系列桶的范围（每个桶由上限值和下限值定义）或在主范围内等分。</p>
                        </li>
                     </ul>
                     <p>以下代码摘录显示了存储桶样式的基本格式：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; &lt;BucketStyle&gt; &lt;Buckets&gt;。 。 。&lt;/ Buckets&gt; &lt;/ BucketStyle&gt; &lt;/ AdvancedStyle&gt;</pre><p>与其他（原始）样式相比，高级样式始终具有由<code class="codeph">&lt;AdvancedStyle&gt;</code>标记标识的根元素。
                     </p>
                     <p>对于存储桶样式， <code class="codeph">&lt;BucketStyle&gt;</code>元素是<code class="codeph">&lt;AdvancedStyle&gt;</code>元素的唯一子元素。每个<code class="codeph">&lt;BucketStyle&gt;</code>元素都有一个或多个<code class="codeph">&lt;Buckets&gt;</code>子元素，其内容根据桶的类型而变化。
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-5DDA98E4-1DBD-443D-B537-9C73AA29708B">具有离散值的基于集合的桶</a><br></li>
                        <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-3DEE62C7-780A-429D-B21F-CC79D43B0ACB">单个基于范围的铲斗</a><br></li>
                        <li class="ulchildlink"><a href="xml-formats-map-visualizer.html#GUID-1B0D577A-184D-4349-B05D-4B589C3830B2">等距铲斗</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-8B0BF578-A3FC-4A81-A462-284ED667707B" title="高级样式是由简单样式制成的结构化样式。">高级样式</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="JIMPV9842"></a><div class="props_rev_3"><a id="GUID-5DDA98E4-1DBD-443D-B537-9C73AA29708B" name="GUID-5DDA98E4-1DBD-443D-B537-9C73AA29708B"></a><h5 id="JIMPV-GUID-5DDA98E4-1DBD-443D-B537-9C73AA29708B" class="sect5"><span class="enumeration_section">A.6.1.1</span>具有离散值的基于集合的桶</h5>
                     <div>
                        <p>如果桶样式的每个桶包含离散值的集合，请使用<code class="codeph">&lt;CollectionBucket&gt;</code>元素表示每个桶。每个存储桶包含一个或多个值。每个存储桶的值都列为<code class="codeph">&lt;CollectionBucket&gt;</code>元素的内容，其中多个值以逗号分隔。以下示例定义了三个存储桶。
                        </p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; &lt;BucketStyle&gt; &lt;Buckets&gt; &lt;CollectionBucket seq =“0”label =“commercial”style =“10015”&gt; commercial &lt;/ CollectionBucket&gt; &lt;CollectionBucket seq =“1”label =“residential”style =“10031” &gt;住宅，农村&lt;/ CollectionBucket&gt; &lt;CollectionBucket seq =“2”label =“industrial”style =“10045”&gt;工业，采矿，农业&lt;/ CollectionBucket&gt; &lt;/ Buckets&gt; &lt;/ BucketStyle&gt; &lt;/ AdvancedStyle&gt;</pre><p>在前面的示例中：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>每个桶的值是一个或多个字符串;但是，值也可以是数字。</p>
                           </li>
                           <li>
                              <p>给出了与每个桶关联的样式的名称。</p>
                           </li>
                           <li>
                              <p>每个<code class="codeph">&lt;CollectionBucket&gt;</code>元素（ <span class="italic">商业</span> ， <span class="italic">住宅</span>或<span class="italic">工业</span> ）的label属性仅用于为高级样式编译的标签。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">&lt;CollectionBucket&gt;</code>元素的顺序非常重要。但是， <code class="codeph">seq</code> （序列）属性中的值仅供参考;地图可视化组件仅根据元素在定义中出现的顺序来确定序列。
                              </p>
                           </li>
                        </ul>
                        <p>虽然在此示例中未显示，但如果您想要所有其他值的存储桶（如果可能存在任何其他值），则可以使用<code class="codeph">#DEFAULT#</code>作为其属性值创建<code class="codeph">&lt;CollectionBucket&gt;</code>元素。它应该放在所有其他<code class="codeph">&lt;CollectionBucket&gt;</code>元素之后，以便最后呈现它的样式。
                        </p>
                        <p>要将标签样式应用于具有离散值的基于集合的存储桶，请参阅为存储桶<a href="map-visualization-concepts.html#GUID-DF9FFE30-7ACB-4E9A-A3E5-40EC4E32E1CB">指定标签样式</a> 。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-85FE8BC7-DA9E-4264-8045-D8B3C54050AF">Bucket Styles</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV9843"></a><div class="props_rev_3"><a id="GUID-3DEE62C7-780A-429D-B21F-CC79D43B0ACB" name="GUID-3DEE62C7-780A-429D-B21F-CC79D43B0ACB"></a><h5 id="JIMPV-GUID-3DEE62C7-780A-429D-B21F-CC79D43B0ACB" class="sect5"><span class="enumeration_section">A.6.1.2</span>单个基于范围的桶</h5>
                     <div>
                        <p>如果存储桶样式的每个存储桶包含由两个值定义的值范围，请使用<code class="codeph">&lt;RangedBucket&gt;</code>元素表示每个存储桶。每个存储桶包含一系列值。以下示例定义了四个存储桶。
                        </p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; &lt;BucketStyle&gt; &lt;Buckets&gt; &lt;RangedBucket high =“10”style =“10015”/&gt; &lt;RangedBucket low =“10”high =“40”style =“10024”/&gt; &lt;RangedBucket low =“40” high =“50”style =“10025”/&gt; &lt;RangedBucket low =“50”style =“10029”/&gt; &lt;/ Buckets&gt; &lt;/ BucketStyle&gt; &lt;/ AdvancedStyle&gt;</pre><p>对于单个基于范围的桶，下限值是包含的，而上限值是独占的（除了具有大于其他范围中的任何值的值的范围;其上限值是包含的）。不允许范围具有与其他范围中的值重叠的值范围。</p>
                        <p>例如，此示例中的第二个存储桶（ <code class="codeph">low="10" high="40"</code> ）将包含任何正好为10的值，以及最多但不包括40的值（例如39和39.99）。任何正好为40的值都将包含在第三个桶中。
                        </p>
                        <p>与<code class="codeph">&lt;CollectionBucket&gt;</code>元素一样，与每个<code class="codeph">&lt;RangedBucket&gt;</code>元素关联的样式被指定为属性。
                        </p>
                        <p>要将标签样式应用于各个基于范围的存储桶，请参阅为存储桶<a href="map-visualization-concepts.html#GUID-DF9FFE30-7ACB-4E9A-A3E5-40EC4E32E1CB">指定标签样式</a> 。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-85FE8BC7-DA9E-4264-8045-D8B3C54050AF">Bucket Styles</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="JIMPV9844"></a><div class="props_rev_3"><a id="GUID-1B0D577A-184D-4349-B05D-4B589C3830B2" name="GUID-1B0D577A-184D-4349-B05D-4B589C3830B2"></a><h5 id="JIMPV-GUID-1B0D577A-184D-4349-B05D-4B589C3830B2" class="sect5"><span class="enumeration_section">A.6.1.3等距</span>铲斗</h5>
                     <div>
                        <p>如果存储桶样式包含一系列包含等分范围的主范围的存储桶，则可以省略<code class="codeph">&lt;RangedBucket&gt;</code>元素的使用，而是在<code class="codeph">&lt;Buckets&gt;</code>元素中指定主上限值和下限值整个范围的值，划分范围的桶的数量，以及样式名称列表（每个桶有一个）。以下示例定义了0到29之间相等范围的五个存储桶（ <code class="codeph">nbuckets=5</code> ）：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; &lt;BucketStyle&gt; &lt;Buckets low =“0”high =“29”nbuckets =“5”styles =“10015,10017,10019,10021,10023”/&gt; &lt;/ BucketStyle&gt; &lt;/ AdvancedStyle&gt;</pre><p>在前面的示例中：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果所有值都是整数，则五个桶包含以下范围内的值：0到5,6到11,12到17,18到23和24到29。</p>
                           </li>
                           <li>
                              <p>第一个桶与名为<code class="codeph">10015</code>的样式相关联，第二个桶与名为<code class="codeph">10017</code>的样式相关联，依此类推。
                              </p>
                           </li>
                        </ul>
                        <p>指定的样式名称数必须与<code class="codeph">nbuckets</code>属性的值相同。存储桶按升序排列，并且样式按指定的顺序分配给每个存储桶。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-85FE8BC7-DA9E-4264-8045-D8B3C54050AF">Bucket Styles</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="JIMPV9845"></a><div class="props_rev_3"><a id="GUID-577FABC2-FFA1-458C-9C0B-2E93D21EA1A3" name="GUID-577FABC2-FFA1-458C-9C0B-2E93D21EA1A3"></a><h4 id="JIMPV-GUID-577FABC2-FFA1-458C-9C0B-2E93D21EA1A3" class="sect4"><span class="enumeration_section">A.6.2</span>配色方案样式</h4>
                  <div>
                     <p>颜色方案样式基于基色自动为每个桶生成不同亮度的单独颜色样式。亮度在全亮度和完全黑暗之间等间隔。通常，第一个桶分配最亮的基色，最后一个桶分配最暗的色调。</p>
                     <p>您可以包含每个桶的颜色样式使用的笔触颜色。笔触颜色不是亮度计算的一部分。因此，例如，如果使用颜色方案样式渲染一组多边形要素，则每个多边形的内部将填充每个相应桶的颜色（基色的阴影），但所有多边形的边界都使用相同的笔触颜色。</p>
                     <p>可以包括的不透明度值（0到255，为透明到不透明），用于基色（使用<code class="codeph">basecolor_opacity</code>属性）和用于笔划颜色（使用<code class="codeph">strokecolor_opacity</code>属性）。
                     </p>
                     <p>以下示例定义了具有黑色笔触颜色的颜色方案样式和与蓝色基色的不同阴影相关联的四个桶。</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; &lt;ColorSchemeStyle basecolor =“blue”strokecolor =“black”&gt; &lt;Buckets&gt; &lt;RangedBucket label =“＆lt; 10”high =“10”/&gt; &lt;RangedBucket label =“10  -  20”low =“10” high =“20”/&gt; &lt;RangedBucket label =“20  -  30”low =“20”high =“30”/&gt; &lt;RangedBucket label =“＆gt; = 30”low =“30”/&gt; &lt;/ Buckets&gt; &lt; / ColorSchemeStyle&gt; &lt;/ AdvancedStyle&gt;</pre><div class="infoboxnote" id="GUID-577FABC2-FFA1-458C-9C0B-2E93D21EA1A3__GUID-D4A91C61-6D65-4175-9DC5-86821F54A498">
                        <p class="notep1">注意：</p>
                        <p>对于以下特殊字符，请改用转义序列。</p>
                        <p>对于<code class="codeph">&lt;</code> ，请使用： <code class="codeph">&amp;lt</code></p>
                        <p>对于<code class="codeph">&gt;</code> ，请使用： <code class="codeph">&amp;gt;</code></p>
                        <p>对于<code class="codeph">&amp;</code> ，使用： <code class="codeph">&amp;amp;</code></p>
                     </div>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-8B0BF578-A3FC-4A81-A462-284ED667707B" title="高级样式是由简单样式制成的结构化样式。">高级样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV9846"></a><div class="props_rev_3"><a id="GUID-3AA7E47E-8C54-4382-AC5A-42D5ED73856A" name="GUID-3AA7E47E-8C54-4382-AC5A-42D5ED73856A"></a><h4 id="JIMPV-GUID-3AA7E47E-8C54-4382-AC5A-42D5ED73856A" class="sect4"><span class="enumeration_section">A.6.3</span>可变标记样式</h4>
                  <div>
                     <p>变量标记样式为每个桶生成一系列不同大小的标记样式。您可以指定存储桶的数量，标记的起始（最小）大小以及两个连续标记之间的大小增量。</p>
                     <p>可变标记样式在概念上类似于颜色方案样式，因为两个基本桶在来自共同对象的变体上：使用颜色方案样式，基色的亮度变化，并且使用可变标记样式，标记的大小变化。</p>
                     <p>以下示例创建一个带有四个存储桶的变量标记样式，每个存储桶与标记（ <code class="codeph">m.circle</code> ）的不同大小（以4为增量）相关联。第一个桶的标记半径为10个显示单位，第二个桶的标记半径为14个显示单位，依此类推。此示例假定已定义名为<code class="codeph">m.circle</code>的标记。
                     </p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; &lt;VariableMarkerStyle basemarker =“m.circle”startsize =“10”increment =“4”&gt; &lt;Buckets&gt; &lt;RangedBucket label =“＆lt; 10”high =“10”/&gt; &lt;RangedBucket label =“10  - 20“low =”10“high =”20“/&gt; &lt;RangedBucket label =”20  -  30“low =”20“high =”30“/&gt; &lt;RangedBucket label =”＆gt; = 30“low =”30“ /&gt; &lt;/ Buckets&gt; &lt;/ VariableMarkerStyle&gt; &lt;/ AdvancedStyle&gt;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-8B0BF578-A3FC-4A81-A462-284ED667707B" title="高级样式是由简单样式制成的结构化样式。">高级样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV9847"></a><div class="props_rev_3"><a id="GUID-64F7BB3E-94E3-433C-AF2C-F6C3D51B2A56" name="GUID-64F7BB3E-94E3-433C-AF2C-F6C3D51B2A56"></a><h4 id="JIMPV-GUID-64F7BB3E-94E3-433C-AF2C-F6C3D51B2A56" class="sect4"><span class="enumeration_section">A.6.4</span>点密度标记样式</h4>
                  <div>
                     <p>点密度高级标记样式应用于状态或县等区域要素时，会在该区域内随机绘制一组点。每个区域内绘制的点数由与该区域相关联的计数值确定。定义点密度样式时，必须指定将用于每个点的标记样式。</p>
                     <p>以下示例显示了简单点密度样式的XML定义：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; &lt;DotDensityStyle MarkerStyle =“M.STAR”DotWidth =“8”DotHeight =“8”&gt; &lt;/ DotDensityStyle&gt; &lt;/ AdvancedStyle&gt;</pre><p>在前面的示例中，标记样式M.STAR用于每个点，每个点的大小为8像素宽和高。</p>
                     <p>使用点密度样式时，应将计数值“缩放”到适当的范围。例如，如果要根据每个县的人口计数应用点密度样式，则不希望直接使用人口计数（每个人一个点），因为这将导致不可接受的绘制点数（例如，如果一个县有15,000人）。而是在定义主题的样式规则时提供缩小的值或表达式，例如<code class="codeph">population/1000</code> 。（地图可视化组件不会在内部执行任何缩减，因此您必须在SQL查询级别执行此操作。）
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-8B0BF578-A3FC-4A81-A462-284ED667707B" title="高级样式是由简单样式制成的结构化样式。">高级样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV9848"></a><div class="props_rev_3"><a id="GUID-F878EE21-DBCE-47C3-A842-CF69DEA0F92C" name="GUID-F878EE21-DBCE-47C3-A842-CF69DEA0F92C"></a><h4 id="JIMPV-GUID-F878EE21-DBCE-47C3-A842-CF69DEA0F92C" class="sect4"><span class="enumeration_section">A.6.5</span>条形图标记样式</h4>
                  <div>
                     <p>条形图高级标记样式类似于饼图样式，不同之处在于它为应用它的每个要素绘制条形图。以下示例显示条形图样式的XML定义：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; &lt;BarChartStyle width =“30”height =“25”show_x_axis =“true”&gt; &lt;Bar name =“1990”color =“＃FF0000”/&gt; &lt;Bar name =“1995”color =“＃FFC800” /&gt; &lt;Bar name =“1998”color =“＃0000FF”/&gt; &lt;Bar name =“2000”color =“＃00FF00”/&gt; &lt;Bar name =“2002”color =“＃00FFFF”/&gt; &lt;/ BarChartStyle &gt; &lt;/ AdvancedStyle&gt;</pre><p>在前面的示例中，width和height指定条形图的整体大小，包括其中的所有个体条。</p>
                     <p>当基于与该特征相关联的一组值在特征上绘制条形图时，每个条的高度可以通过两种方法中的任一种来确定：局部缩放或全局缩放。局部缩放条形图仅根据该要素的关联值确定每个条形的高度;因此，例如，您无法将一个图表的第二个条形与同一主题的另一个图表上的第二个条形图进行比较。全局缩放条形图对地图上的所有图表使用相同的条形图;因此，例如，您可以将一个图表的第二个条形图与同一主题的另一个图表上的第二个条形图形进行比较。</p>
                     <p>因此，如果您想比较同一图表中的条形图，以及地图上显示的所有图表中的条形图，则必须通过在条形图样式的定义中指定<code class="codeph">share_scale="true"</code>来使用全局缩放条形图样式，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; &lt;BarChartStyle width =“40”height =“30” <span class="bold">share_scale =“true”</span> min_value =“0.0”max_value =“100”&gt; &lt;Bar name =“1990”color =“＃FF0000”/&gt; &lt;Bar name =“1995”color =“＃FFC800”/&gt; &lt;Bar name =“1998”color =“＃0000FF”/&gt; &lt;Bar name =“2000”color =“＃00FF00”/&gt; &lt;Bar name =“2002”color =“＃00FFFF”/&gt; &lt;/ BarChartStyle&gt; &lt;/ AdvancedStyle&gt;</pre><p>当前面示例中的条形图样式应用于主题时，地图可视化组件会考虑该主题中所有要素的全局值范围，然后根据特定值在全局中的位置确定每个柱的高度范围从最小值到最大值。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-8B0BF578-A3FC-4A81-A462-284ED667707B" title="高级样式是由简单样式制成的结构化样式。">高级样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV9849"></a><div class="props_rev_3"><a id="GUID-786D9C05-C3C2-4A90-B5DE-6B5718DC792E" name="GUID-786D9C05-C3C2-4A90-B5DE-6B5718DC792E"></a><h4 id="JIMPV-GUID-786D9C05-C3C2-4A90-B5DE-6B5718DC792E" class="sect4"><span class="enumeration_section">A.6.6</span>收集样式</h4>
                  <div>
                     <p>集合高级样式只是一组应用于特征的其他类型样式的集合。与使用基于不同样式的多个主题相比，这可以导致更快地呈现集合主题。</p>
                     <p>例如，条形图样式在应用于县时，仅绘制县内某处的条形图，但不绘制县本身（其边界和内部区域）。但是，您可能希望查看县的基本边界，以查看哪个条形图属于哪个县。要在没有集合样式的情况下执行此操作，您必须定义第二个主题，其中每个县与颜色或区域样式相关联。对于基本上相同的一组特征，这种方法将导致两个渲染过程（因为涉及两个主题）。</p>
                     <p>但是，通过在此示例中使用集合样式，您可以定义引用条形图和颜色或区域样式的单个样式，然后将集合样式应用于县的主题。当由地图可视化组件渲染时，此主题将在地图上显示条形图和边界。</p>
                     <p>集合样式的另一种典型用法是渲染集合类型拓扑特征，每个特征都可以包含多种类型的几何，例如多边形（区域），点和线。在这种情况下，集合样式可以包括最适合集合拓扑功能中每种几何类型的样式。</p>
                     <p>以下示例显示了集合样式的XML定义：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;AdvancedStyle&gt; &lt;CollectionStyle&gt; &lt;style name =“C.COUNTIES”shape =“polygon”/&gt; &lt;style name =“L.PH”shape =“line”/&gt; &lt;style name =“M.CIRCLE”shape = “point”/&gt; &lt;/ CollectionStyle&gt; &lt;/ AdvancedStyle&gt;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-8B0BF578-A3FC-4A81-A462-284ED667707B" title="高级样式是由简单样式制成的结构化样式。">高级样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV9850"></a><div class="props_rev_3"><a id="GUID-4F10A15B-88D4-4941-8063-834932D4F481" name="GUID-4F10A15B-88D4-4941-8063-834932D4F481"></a><h4 id="JIMPV-GUID-4F10A15B-88D4-4941-8063-834932D4F481" class="sect4"><span class="enumeration_section">A.6.7</span>可变饼图样式</h4>
                  <div>
                     <p>可变饼图为每个桶生成一系列不同大小的饼圈。您可以指定饼图切片信息，饼图圆的起始（最小）半径大小以及两个连续圆之间的半径大小增量。</p>
                     <p>可变饼图样式在概念上类似于可变标记样式。使用可变标记样式时，基本标记大小会发生变化，而使用可变饼图样式时，圆半径会发生变化。</p>
                     <p>以下示例为具有四个存储桶的变量饼图样式创建定义，每个存储桶与一个起始半径为5的圆的不同大小（以4为增量）相关联。第一个桶的圆半径半径为5个显示单位，第二个桶的圆半径为9个显示单位，依此类推。</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; &lt; <span class="bold">VariablePieChartStyle startradius =“5”increment =“4”</span> &gt; &lt;PieSlice name =“WHITE”color =“＃FFFFFF”/&gt; &lt;PieSlice name =“BLACK”color =“＃000000”/&gt; &lt;PieSlice name =“HISPANIC”color =“＃FF0000”/&gt; &lt;Buckets&gt; &lt;RangedBucket seq =“0”label =“0  -  6194757.2”low =“0”high =“6194757.2”/&gt; &lt;RangedBucket seq =“1”label = “6194757.2  -  1.23895144E7”low =“6194757.2”high =“1.23895144E7”/&gt; &lt;RangedBucket seq =“2”label =“1.23895144E7  -  1.85842716E7”low =“1.23895144E7”high =“1.85842716E7”/&gt; &lt; RangedBucket seq =“3”label =“1.85842716E7  -  2.47790288E7”low =“1.85842716E7”high =“2.47790288E7”/&gt; &lt;RangedBucket seq =“4”label =“2.47790288E7  -  3.0973786E7”low =“2.47790288E7 “high =”3.0973786E7“/&gt; &lt;/ Buckets&gt; &lt;/ VariablePieChartStyle&gt; &lt;/ AdvancedStyle&gt;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-8B0BF578-A3FC-4A81-A462-284ED667707B" title="高级样式是由简单样式制成的结构化样式。">高级样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV9852"></a><a id="JIMPV9851"></a><div class="props_rev_3"><a id="GUID-751BB8F1-237A-4688-A0DA-229225771FDF" name="GUID-751BB8F1-237A-4688-A0DA-229225771FDF"></a><h4 id="JIMPV-GUID-751BB8F1-237A-4688-A0DA-229225771FDF" class="sect4"><span class="enumeration_section">A.6.8</span>热图样式</h4>
                  <div>
                     <p>热图样式可用于生成任何点类型数据集的二维（2D）颜色图。颜色代表整个区域的点或事件的分布密度或模式。在内部，地图可视化组件创建2D矩阵，并基于针对点数据集运行的距离加权算法的结果为每个网格单元分配值。</p>
                     <p>您可以使用“地图生成器”工具创建热图样式，并将其指定为点类型几何主题的渲染样式。然后，您可以将此主题添加到基本地图，或将其作为基于主题的FOI图层添加到交互式Oracle Maps应用程序。<a href="xml-formats-map-visualizer.html#GUID-751BB8F1-237A-4688-A0DA-229225771FDF__BABJDEDG">图A-3</a>显示了使用基于热图样式的主题显示的地图。这张地图显示了比萨饼店的浓度：红色区域的比萨餐馆集中度最高，橙色，黄色，深绿色，浅绿色，淡绿色和白色区域的浓度逐渐降低。
                     </p>
                     <div class="figure" id="GUID-751BB8F1-237A-4688-A0DA-229225771FDF__BABJDEDG">
                        <p class="titleinfigure">图A-3显示比萨餐馆集中的热图</p><img src="img/heat_map.gif" alt="下面是图A-3的描述" title="下面是图A-3的描述" longdesc="img_text/heat_map.html"><br><a href="img_text/heat_map.html">“图A-3热图显示比萨餐厅浓度”的描述</a></div>
                     <!-- class="figure" -->
                     <p>以下示例为热图样式创建定义。</p><pre class="oac_no_warn" dir="ltr">&lt;？xml版本=“1.0”？&gt; &lt;AdvancedStyle&gt; <span class="bold">&lt;HeatMapStyle&gt;</span> &lt;color_stops num_steps =“200”alpha =“128”&gt; FFFFFF，00FF00，FFC800，FF0000 &lt;/ color_stops&gt; &lt;spot_light_radius&gt; 75.0mile &lt;/ spot_light_radius&gt; &lt;grid_sample_factor&gt; 2.5 &lt;/ grid_sample_factor&gt; &lt;container_theme &gt; THEME_DEMO_STATES &lt;/ container_theme&gt; &lt;/ HeatMapStyle&gt; &lt;/ AdvancedStyle&gt;</pre><p>前面的例子定义了热图的这些基本方面：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">颜色停止</span> 。色标用于生成颜色渐变。在此示例中，颜色渐变将从白色（映射到具有零值的网格单元格）变为绿色，橙色，最后变为全红色（映射到具有最高值的网格单元格）。渐变将有200种颜色，跨越这4个颜色停止。所有颜色的alpha值都是128（半透明，其中0表示完全透明，255表示不透明）。
                           </p>
                        </li>
                        <li>
                           <p><a id="d29258e1942" class="indexterm-anchor"></a> <span class="bold">聚光半径</span> 。聚光灯半径定义每个网格单元周围的半径，其中该半径内的事件或点将对该单元的最终聚合值起作用。每个点的贡献随着其距离单元中心的距离的增加而减小，并且在该半径之外变为零。
                           </p>
                           <p>您可以指定半径（以像素为单位）或以实际地面单位（例如<code class="codeph">mile</code>为单位。指定半径（以像素为单位）时（如果未指定单位，则为默认值），从颜色渐变到网格单元格的映射将随着用户在地图上放大和缩小而变化。发生这种情况是因为随着用户放大和缩小，落入半径内的点数不断变化。无论地图比例如何，要获得固定的热图，必须在地面单位（如<code class="codeph">meter</code> ， <code class="codeph">km</code>或<code class="codeph">mile</code>指定聚光灯半径。前面的示例使用<code class="codeph">mile</code> 。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">网格样本因子</span> 。网格样本因子用于在为热图计算创建内部矩阵或网格时对当前地图窗口大小进行采样。例如，样本因子为4意味着内部热图网格将是实际地图窗口大小的四分之一（0.25）。因此，如果地图为1000x1000像素，则内部热图网格为250x250。因此，网格样本因子值越低，内部热图网格就越大;值越高，内部热图网格越小。
                           </p>
                           <p>网格样本因子值可能比任何其他属性对热图渲染性能的影响更大，因为大的内部热图网格（由低网格样本因子值产生）将显着增加总体计算时间。一个好的一般准则是指定足够高的网格样本因子值，以便内部热图网格为512x512像素或更小。</p>
                        </li>
                        <li>
                           <p><span class="bold">容器主题名称</span> 。容器主题名称指定主题的名称（同一数据库模式中的预定义几何主题），用于定义热图主题的地图边界。例如，如果要为遍布整个美利坚合众国的点数据集生成热图，请选择表示美国国界的主题或所有状态作为其容器主题。
                           </p>
                           <p>指定的容器主题不会影响热图本身的计算方式（仅基于点分布和聚光灯半径）。相反，容器主题它掩盖了研究区域边界之外的所有有色单元格。这有助于确保热图的“干净”外观。</p>
                        </li>
                     </ul>
                     <p>创建热图样式后，可以为点数据创建主题，并将新的热图样式指定为主题的呈现样式。</p>
                     <p>与其他类型的高级样式不同，热图样式不需要任何属性或值列。</p>
                     <p>使用热图样式呈现的主题不支持标签。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-8B0BF578-A3FC-4A81-A462-284ED667707B" title="高级样式是由简单样式制成的结构化样式。">高级样式</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="JIMPV9853"></a><div class="props_rev_3"><a id="GUID-45D7DCB4-5218-4469-9712-5F8AC338088B" name="GUID-45D7DCB4-5218-4469-9712-5F8AC338088B"></a><h3 id="JIMPV-GUID-45D7DCB4-5218-4469-9712-5F8AC338088B" class="sect3"><span class="enumeration_section">A.7</span>主题：样式规则</h3>
               <div>
                  <p>主题定义包含一个<code class="codeph">&lt;styling_rules&gt;</code>元素，根据主题类型，该元素可能包含多个其他元素。
                  </p>
                  <p>此<code class="codeph">&lt;styling_rules&gt;</code>元素在USER_SDO_THEMES元数据视图的STYLING_RULES列中指定，使用以下DTD：</p><pre class="oac_no_warn" dir="ltr">&lt;！ELEMENT styling_rules（规则+，hidden_info？，join_table？，join_columns？，operations？，bitmap_masks ?,参数？）&gt; &lt;！ATTLIST styling_rules theme_type CDATA #IMPLIED key_column CDATA #IMPLIED caching CDATA #IMPLIED“NORMAL”image_format CDATA #IMPLIED image_column CDATA #IMPLIED image_resolution CDATA #IMPLIED image_unit CDATA #IMPLIED raster_id CDATA #IMPLIED raster_table CDATA #IMPLIED raster_pyramid CDATA #IMPLIED raster_bands CDATA #IMPLIED polygon_mask CDATA #IMPLIED transparent_nodata CDATA #IMPLIED network_name CDATA #IMPLIED network_level CDATA #IMPLIED topology_name CDATA #IMPLIED service_url CDATA #IMPLIED srs CDATA #IMPLIED feature_ids CDATA #IMPLIED provider_id CDATA #IMPLIED srid CDATA #IMPLIED&gt; &lt;！ELEMENT规则（功能，标签？，渲染？）&gt; &lt;！ATTLIST规则列CDATA #IMPLIED&gt; &lt;！ELEMENT功能（#PCDATA？，链接？，节点？，路径？）&gt; &lt;！ATTLIST的风格CDATA #REQUIRED&gt; &lt;！ELEMENT标签（#PCDATA？，链接？，节点？，路径？）&gt; &lt;！ATTLIST标签栏CDATA #REQUIRED样式CDATA #REQUIRED&gt; &lt;！ELEMENT链接（#PCDATA）&gt; &lt;！ATTLIST链接样式CDATA #REQUIRED direction_style CDATA #IMPLIED direction_position CDATA #IMPLIED direction_markersize CDATA #IMPLIED列CDATA #REQUIRED&gt; &lt;！ELEMENT节点（#PCDATA）&gt; &lt;！ATTLIST节点样式CDATA #REQUIRED标记化CDATA #IMPLIED列CDATA #REQUIRED&gt; &lt;！ELEMENT路径（#PCDATA）&gt; &lt;！ATTLIST路径ID CDATA #REQUIRED样式CDATA #REQUIRED样式CDATA #REQUIRED列CDATA #REQUIRED&gt; &lt;！ELEMENT hidden_info（字段+）&gt; &lt;！ELEMENT字段（#PCDATA）&gt; &lt;！ATTLIST字段列CDATA #REQUIRED名称CDATA #IMPLIED&gt; &lt;！ELEMENT join_table EMPTY&gt; &lt;！ATTLIST join_table名称CDATA #REQUIRED start_measure CDATA #IMPLIED end_measure CDATA #IMPLIED measure CDATA #IMPLIED&gt; &lt;！ELEMENT join_columns EMPTY&gt; &lt;！ATTLIST列lrs_table_column CDATA #REQUIRED join_table_column CDATA #REQUIRED&gt; &lt;！ELEMENT渲染（样式+）&gt; &lt;！ELEMENT风格（subyle？）&gt; &lt;！ATTLIST样式名称CDATA #REQUIRED value_columns CDATA #IMPLIED&gt; &lt;！ELEMENT subyle（#PCDATA）&gt; &lt;！ATTLIST子类名称CDATA #REQUIRED value_columns CDATA #REQUIRED更改CDATA #IMPLIED&gt; &lt;！ELEMENT操作（操作？）&gt; &lt;！ELEMENT操作（参数？）&gt; &lt;！ATTLIST操作名称CDATA #REQUIRED&gt; &lt;！ELEMENT参数（参数？）&gt; &lt;！ELEMENT参数（#PCDATA）&gt; &lt;！ATTLIST参数名称CDATA #REQUIRED值DATA #REQUIRED&gt; &lt;！ELEMENT bitmap_masks（mask +）&gt; &lt;！ELEMENT面具（#PCDATA）&gt; &lt;！ATTLIST掩码raster_id CDATA #REQUIRED raster_table CDATA #REQUIRED层CDATA #REQUIRED zeromapping CDATA #IMPLIED onemapping CDATA #IMPLIED&gt;</pre><p><a id="d29258e2040" class="indexterm-anchor"></a><a id="d29258e2044" class="indexterm-anchor"></a><a id="d29258e2048" class="indexterm-anchor"></a>该<a id="d29258e2053" class="indexterm-anchor"></a><a id="d29258e2057" class="indexterm-anchor"></a> <code class="codeph">&lt;styling_rules&gt;</code> <a id="d29258e2065" class="indexterm-anchor"></a> <a id="d29258e2071" class="indexterm-anchor"></a><a id="d29258e2078" class="indexterm-anchor"></a><a id="d29258e2084" class="indexterm-anchor"></a> element可以有一个<code class="codeph">theme_type</code>属性，主要用于某些类型的预定义主题。（默认的<code class="codeph">theme_type</code>属性值是<code class="codeph">geometry</code> ，表示主题基于空间几何。）这些特殊类型的预定义主题的<code class="codeph">theme_type</code>属性值如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">annotation</code>指定注释文本主题。注释文本主题在<a href="map-visualization-concepts.html#GUID-00E4F995-9956-4444-ACA8-7FAD04CAE6D9">注释文本主题中</a>进行了解释。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">geom_custom</code>指定自定义几何主题。您还必须指定<code class="codeph">provider_id</code>和<code class="codeph">srid</code>属性。自定义几何主题在<a href="map-visualization-concepts.html#GUID-583B47AE-76C2-4E23-9202-2055D7C3AE42">自</a>定义几何主题中进行了说明。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">georaster</code>指定GeoRaster主题。要使用指定的GeoRaster数据（但如果使用查询条件检索GeoRaster数据，则不能使用），还必须指定<code class="codeph">raster_id</code>和<code class="codeph">raster_table</code>属性。您还可以指定<code class="codeph">raster_pyramid</code> ， <code class="codeph">raster_bands</code> ， <code class="codeph">polygon_mask</code>和<code class="codeph">transparent_nodata</code>属性。GeoRaster主题在<a href="map-visualization-concepts.html#GUID-BAC98AAC-B274-42F3-AB60-54C73E4E4297">GeoRaster主题中</a>进行了解释。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">image</code>指定图像主题。您还必须指定<code class="codeph">image_format</code>和<code class="codeph">image_column</code>属性，并且可以指定<code class="codeph">image_resolution</code>和<code class="codeph">image_unit</code>属性。图像主题在<a href="map-visualization-concepts.html#GUID-1F285D16-1E1B-40B1-BB4D-EFF8886A2575">图像主题中</a>进行了解释。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">network</code>指定网络主题。您还必须指定<code class="codeph">network_name</code>属性。您可以指定<code class="codeph">network_level</code>属性，但默认值（1）是当前支持的唯一值。网络主题在<a href="map-visualization-concepts.html#GUID-BE69B5B4-06B2-4378-A24B-455DF943B2F9">网络主题中</a>进行了解释。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">topology</code>指定拓扑主题。您还必须指定<code class="codeph">topology_name</code>属性。拓扑主题在<a href="map-visualization-concepts.html#GUID-5A7910EC-68E5-4310-A816-217FCD1E4460">拓扑主题中</a>进行了解释。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">wfs</code>指定WFS主题。您还必须指定<code class="codeph">service_url</code>和<code class="codeph">srs</code>属性。WFS主题在<a href="map-visualization-concepts.html#GUID-C0538735-A453-4161-BADF-1FB8BA628B26">WFS主题中</a>进行了解释。
                        </p>
                     </li>
                  </ul>
                  <p><a id="d29258e2213" class="indexterm-anchor"></a><a id="d29258e2217" class="indexterm-anchor"></a><a id="d29258e2221" class="indexterm-anchor"></a> <code class="codeph">&lt;styling_rules&gt;</code>元素可以具有<code class="codeph">key_column</code>属性。仅当在连接视图（从多个表创建的视图）上定义主题时，才需要此属性。在这种情况下，您必须在视图中指定一列作为键列，以唯一标识该视图中的几何或图像。如果没有此键列信息，地图可视化组件将无法在连接视图中缓存几何图形或图像。
                  </p>
                  <p><a id="d29258e2233" class="indexterm-anchor"></a> <code class="codeph">&lt;styling_rules&gt;</code>元素可以具有<code class="codeph">caching</code>属性，该属性指定每个预定义主题的缓存方案。<code class="codeph">caching</code>属性可以具有以下值之一： <code class="codeph">NORMAL</code> （默认值）， <code class="codeph">NONE</code>或<code class="codeph">ALL</code> 。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">NORMAL</code>使地图可视化组件尝试缓存刚查看过的几何数据，以避免在需要重用几何时重复昂贵的unpickling过程。始终从数据库中提取几何图形，但如果未标记的版本已在缓存中，则不会使用它们。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">NONE</code>表示不会缓存此主题中的任何几何。当您经常编辑主题的数据并且需要在编辑时显示数据时，此值很有用。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">ALL</code>会导致地图可视化组件在任何查看请求之前将此主题的所有几何数据完全固定在缓存中。与<code class="codeph">NORMAL</code>的默认值相比， <code class="codeph">ALL</code>的值在第一次查看主题时缓存基表中的所有几何，并且随后不会从数据库中提取几何。
                        </p>
                     </li>
                  </ul>
                  <p>有关预定义主题的缓存的详细信息，请参阅<a href="map-visualization-concepts.html#GUID-E0D0A87C-0A93-46B1-85D3-1E6DD4E281AB">预定义主题的缓存</a> 。
                  </p>
                  <p>每个<code class="codeph">&lt;rule&gt;</code>元素必须具有<code class="codeph">&lt;features&gt;</code>元素，并且可以具有<code class="codeph">&lt;label&gt;</code>元素和<code class="codeph">&lt;rendering&gt;</code>元素。<code class="codeph">&lt;rendering&gt;</code>元素可用于定义多个渲染样式，在这种情况下， <code class="codeph">&lt;features&gt;</code>元素中的渲染样式可能未定义。如果定义了<code class="codeph">&lt;features&gt;</code>元素中的渲染样式并且还定义了<code class="codeph">&lt;rendering&gt;</code>元素，则地图可视化组件将首先在<code class="codeph">&lt;features&gt;</code>元素中渲染样式，然后在<code class="codeph">&lt;rendering&gt;</code>元素中渲染样式。（ <code class="codeph">&lt;rendering&gt;</code>元素将在本节后面介绍。）
                  </p>
                  <p><code class="codeph">&lt;rule&gt;</code>元素的可选<code class="codeph">column</code>属性指定基表中的一个或多个属性列（在逗号分隔的列表中），以放入由地图可视化组件生成的查询的SELECT列表中。此类列的值通常由此主题的高级样式处理。以下示例显示了column属性的用法：</p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;styling_rules&gt; &lt;rule column =“TOTPOP”&gt; &lt;features style =“V.COUNTY_POP_DENSITY”&gt; &lt;/ features&gt; &lt;/ rule&gt; &lt;/ styling_rules&gt;</pre><p>在前面的示例中，将使用名为<code class="codeph">V.COUNTY_POP_DENSITY</code>的高级样式呈现主题的几何<code class="codeph">V.COUNTY_POP_DENSITY</code> 。此样式将通过在此主题的基表中的名为TOTPOP的列中查找数值来确定填充县几何的颜色。
                  </p>
                  <p>网络主题的每个<code class="codeph">&lt;features&gt;</code>元素必须具有<code class="codeph">&lt;link&gt;</code> ， <code class="codeph">&lt;node&gt;</code>或<code class="codeph">&lt;path&gt;</code>元素，或它们的某种组合。（该<code class="codeph">&lt;link&gt;</code> ， <code class="codeph">&lt;node&gt;</code> ，和<code class="codeph">&lt;path&gt;</code>元素仅适用于网络的主题，其在说明<a href="map-visualization-concepts.html#GUID-BE69B5B4-06B2-4378-A24B-455DF943B2F9">网络的主题</a> ）。以下示例显示了用于呈现链接和节点的网络主题的样式规则。
                  </p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;styling_rules theme_type =“network”network_name =“LRS_TEST”network_level =“1”&gt; &lt;rule&gt; &lt;features&gt; &lt;link style =“C.RED”direction_style =“M.IMAGE105_BW”direction_position =“0.85”direction_markersize =“8 “&gt; &lt;/ link&gt; &lt;node style =”M.CIRCLE“markersize =”5“&gt; &lt;/ node&gt; &lt;/ features&gt; &lt;/ rule&gt; &lt;/ styling_rules&gt;</pre><p><code class="codeph">&lt;label&gt;</code>元素必须具有SQL表达式作为其元素值，以确定是否将标签应用于要素。<code class="codeph">column</code>属性指定用于标记要素的文本值的SQL表达式， <code class="codeph">style</code>属性指定用于呈现标注的文本样式。
                  </p>
                  <p><code class="codeph">&lt;rendering&gt;</code>元素可用于定义多种呈现样式。样式按它们出现的顺序呈现。<code class="codeph">&lt;rendering&gt;</code>元素中的每个样式都由<code class="codeph">&lt;style&gt;</code>元素定义，该元素必须指定<code class="codeph">name</code>属性并可以指定<code class="codeph">value_columns</code>属性。（ <code class="codeph">value_columns</code>属性与高级样式一起使用，列名称将添加到<code class="codeph">&lt;rule&gt;</code>元素的<code class="codeph">column</code>属性中定义的属性列表中。）
                  </p>
                  <p>在<code class="codeph">&lt;rendering&gt;</code>元素中，每个<code class="codeph">&lt;style&gt;</code>元素都可以有一个<code class="codeph">&lt;substyle&gt;</code>元素，用于定义填充特征的属性。<code class="codeph">&lt;substyle&gt;</code>元素必须指定<code class="codeph">name</code>属性，并可以指定<code class="codeph">value_columns</code>并<code class="codeph">changes</code>属性。对于<code class="codeph">changes</code>属性，仅支持<code class="codeph">FILL_COLOR</code>值。
                  </p>
                  <p>以下示例使用<code class="codeph">&lt;rendering&gt;</code>元素显示几何主题的样式规则。它定义了一个名为<code class="codeph">V.POIVMK</code>的高级样式来渲染要素形状和一个名为<code class="codeph">V.POIBKT</code>的高级子<code class="codeph">V.POIBKT</code>来填充要素形状。
                  </p><pre class="oac_no_warn" dir="ltr">&lt;？xml version =“1.0”standalone =“yes”？&gt; &lt;styling_rules&gt; &lt;rule&gt; &lt;features&gt; &lt;/ features&gt; &lt;label column =“NAME”style =“T.STREET2”&gt; 1 &lt;/ label&gt; &lt;rendering&gt; &lt;style name =“V.POIVMK”value_columns =“FEATURE_CODE “&gt; &lt;substyle name =”V.POIVBKT“value_columns =”POINT_ID“changes =”FILL_COLOR“/&gt; &lt;/ style&gt; &lt;/ rendering&gt; &lt;/ rule&gt; &lt;/ styling_rules&gt;</pre><p>有关使用&lt;rendering&gt;元素在单个样式规则中<a href="map-visualization-concepts.html#GUID-7C2040AC-5A09-4303-8AAE-B0772BB4EBAB">应用多个呈现样式的</a>详细信息，请参阅在单个样式规则中<a href="map-visualization-concepts.html#GUID-7C2040AC-5A09-4303-8AAE-B0772BB4EBAB">应用多个呈现样式</a> 。
                  </p>
                  <p><a id="d29258e2452" class="indexterm-anchor"></a><a id="d29258e2456" class="indexterm-anchor"></a> <code class="codeph">&lt;hidden_info&gt;</code>元素指定当用户将鼠标移动到主题的要素上时要显示的基表中的属性列表。属性由<code class="codeph">&lt;field&gt;</code>元素列表指定。
                  </p>
                  <p><a id="d29258e2466" class="indexterm-anchor"></a>每个<code class="codeph">&lt;field&gt;</code>元素必须具有<code class="codeph">column</code>属性，该属性指定基表中列的名称，并且它可以具有<code class="codeph">name</code>属性，该属性指定列的显示名称。（如果要显示除列名以外的文本字符串，则<code class="codeph">name</code>属性很有用。）
                  </p>
                  <p><code class="codeph">&lt;join_table&gt;</code>元素指定表名及其测量的一列或两列。它可能包含一个用于点类型特征的度量列或两个用于线串类型特征的度量列。当与具有LRS几何列的LRS表连接时，一个或多个度量列用于线性参考过程。
                  </p>
                  <p><code class="codeph">&lt;join_columns&gt;</code>元素指定LRS表的一列（具有LRS几何列），以及连接表中的一列（具有一个或两个度量列）。这两列用于连接LRS表和连接表。
                  </p>
                  <p><code class="codeph">&lt;operations&gt;</code>元素指定要应用于GeoRaster主题的图像处理操作列表。操作由<code class="codeph">&lt;operation&gt;</code>元素列表指定。
                  </p>
                  <p><code class="codeph">&lt;operation&gt;</code>元素指定要在GeoRaster主题上应用的图像处理运算符及其参数。每个<code class="codeph">&lt;operation&gt;</code>元素可以包含<code class="codeph">&lt;parameters&gt;</code>元素的列表。
                  </p>
                  <p><code class="codeph">&lt;parameters&gt;</code>元素定义了要在特定任务上使用的参数列表。参数由<code class="codeph">&lt;parameter&gt;</code>元素列表指定。
                  </p>
                  <p><code class="codeph">&lt;parameter&gt;</code>元素必须定义<code class="codeph">name</code>和<code class="codeph">value</code>属性。
                  </p>
                  <p><code class="codeph">&lt;bitmap_masks&gt;</code>元素定义要与GeoRaster主题一起使用的图像蒙版属性。位图掩码由<code class="codeph">&lt;mask&gt;</code>元素列表指定。
                  </p>
                  <p><code class="codeph">&lt;mask&gt;</code>元素指定要应用于GeoRaster对象的位图蒙版。必须定义<code class="codeph">raster_id</code> ， <code class="codeph">raster_table</code>和<code class="codeph">layers</code>属性，而<code class="codeph">zeromapping</code>和<code class="codeph">onemapping</code>属性是可选的。
                  </p>
                  <p>有关样式规则和示例的详细信息，请参阅<a href="map-visualization-concepts.html#GUID-1A5A976B-8E3F-42DD-AB10-A35ED02385DD">预定义空间几何主题</a>中的样式规则。
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" title="本附录描述了使用地图可视化组件元数据视图定义样式，主题和基本地图的XML格式。">样式，主题，基本映射和地图图层的XML格式</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="JIMPV9854"></a><div class="props_rev_3"><a id="GUID-C783909C-3637-4A18-9DDD-625A094E5DE2" name="GUID-C783909C-3637-4A18-9DDD-625A094E5DE2"></a><h3 id="JIMPV-GUID-C783909C-3637-4A18-9DDD-625A094E5DE2" class="sect3"><span class="enumeration_section">A.8</span>基本地图</h3>
               <div>
                  <p>基本地图定义由一个或多个主题组成。</p>
                  <p>使用以下DTD在USER_SDO_MAPS元数据视图的DEFINITION列中指定基本映射的XML定义：</p><pre class="oac_no_warn" dir="ltr">&lt;！ELEMENT map_definition（主题+）&gt; &lt;！ELEMENT主题EMPTY&gt; &lt;！ATTLIST主题名称CDATA #REQUIRED名称CDATA #REQUIRED数据源CDATA #IMPLIED template_theme CDATA #IMPLIED max_scale CDATA #IMPLIED min_scale CDATA #IMPLIED label_always_on（TRUE | FALSE）“FALSE”fast_unpickle（TRUE | FALSE）“TRUE”模式CDATA #IMPLIED min_dist CDATA #IMPLIED fixed_svglabel（TRUE | FALSE）“FALSE”visible_in_svg（TRUE | FALSE）“TRUE”selectable_in_svg（TRUE | FALSE）“FALSE”part_of_basemap（TRUE | FALSE）“FALSE”simplify_shapes（TRUE | FALSE）“TRUE”透明度CDATA＃ IMPLIED minimum_pixels CDATA #IMPLIED onclick CDATA #IMPLIED onmousemove CDATA #IMPLIED onmouseover CDATA #IMPLIED onmouseout CDATA #IMPLIED workspace_name CDATA #IMPLIED workspace_savepoint CDATA #IMPLIED workspace_date CDATA #IMPLIED workspace_date_format CDATA #IMPLIED fetch_size CDATA #IMPLIED timeout CDATA #IMPLIED&gt;</pre><p><code class="codeph">&lt;map_definition&gt;</code>元素包含一个或多个<code class="codeph">&lt;theme&gt;</code>元素。主题在地图上呈现在彼此之上，按照在定义中指定的顺序。
                  </p>
                  <p>有关定义基本地图和示例的详细信息，请参阅<a href="map-visualization-concepts.html#GUID-B39C38B9-8852-4085-A4B0-7454557A5C95" title="地图可以包含元素和属性的组合。">地图</a> 。
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" title="本附录描述了使用地图可视化组件元数据视图定义样式，主题和基本地图的XML格式。">样式，主题，基本映射和地图图层的XML格式</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="JIMPV9855"></a><div class="props_rev_3"><a id="GUID-8B972AAC-B614-459B-91E2-18ADA5EF234F" name="GUID-8B972AAC-B614-459B-91E2-18ADA5EF234F"></a><h3 id="JIMPV-GUID-8B972AAC-B614-459B-91E2-18ADA5EF234F" class="sect3"><span class="enumeration_section">A.9</span>地图图块层</h3>
               <div>
                  <p>Oracle Maps地图图块层，用于从地图图块服务器组装并显示预生成的地图图像图块，</p>
                  <p>在<a href="map-visualization-servers.html#GUID-5CF7DC08-0B32-4C72-B9D0-F3762A7E6171">Map Tile Layer Configuration中</a>描述了Tis rpocess。使用以下DTD定义地图图块层的XML配置设置：</p><pre class="oac_no_warn" dir="ltr">&lt;！ELEMENT map_tile_layer（（internal_map_source | external_map_source），tile_storage，coordinate_system，tile_image，tile_dpi？，tile_meters_per_unit？，zoom_levels，auto_update？，themes？）&gt; &lt;！ATTLIST map_tile_layer名称CDATA #REQUIRED image_format CDATA #IMPLIED http_header_expires CDATA #IMPLIED utfgrid（TRUE | FALSE）“FALSE”utfgrid_resolution CDATA #IMPLIED concurrent_fetching_threads CDATA #IMPLIED fetch_larger_tile（TRUE | FALSE）“TRUE”persistent_tiles（TRUE | FALSE）“TRUE”&gt; &lt;！ELEMENT internal_map_source EMPTY&gt; &lt;！ATTLIST internal_map_source data_source CDATA #REQUIRED base_map CDATA #REQUIRED bgcolor CDATA #IMPLIED out_of_bounds_color CDATA #IMPLIED antialias（TRUE | FALSE）“TRUE”&gt; &lt;！ELEMENT external_map_source（属性？）&gt; &lt;！ATTLIST external_map_source url CDATA #REQUIRED request_method CDATA #REQUIRED timeout CDATA #IMPLIED adapter_class CDATA #REQUIRED proxy_host CDATA #IMPLIED proxy_port CDATA #IMPLIED clipping_buffer CDATA #IMPLIED&gt; &lt;！ELEMENT属性（property +）&gt; &lt;！ELEMENT属性EMPTY&gt; &lt;！ATTLIST属性名称CDATA #REQUIRED值CDATA #REQUIRED&gt; &lt;！ELEMENT tile_storage EMPTY&gt; &lt;！ATTLIST tile_storage root_path CDATA #REQUIRED xyz_storage_scheme（TRUE | FALSE）“FALSE”&gt; &lt;！ELEMENT coordinate_system EMPTY&gt; &lt;！ATTLIST coordinate_system srid CDATA #REQUIRED minX CDATA #REQUIRED minY CDATA #REQUIRED maxX CDATA #REQUIRED maxY CDATA #REQUIRED&gt; &lt;！ELEMENT tile_bound（coordinates）&gt; &lt;！ELEMENT坐标（#PCDATA）&gt; &lt;！ELEMENT tile_image EMPTY&gt; &lt;！ATTLIST tile_image宽度CDATA #REQUIRED高度CDATA #REQUIRED&gt; &lt;！ELEMENT tile_dpi EMPTY&gt; &lt;！ATTLIST tile_dpi值CDATA #REQUIRED&gt; &lt;！ELEMENT tile_meters_per_unit EMPTY&gt; &lt;！ATTLIST tile_meters_per_unit值CDATA #REQUIRED&gt; &lt;！ELEMENT zoom_levels（zoom_level +）&gt; &lt;！ATTLIST zoom_levels level CDATA #REQUIRED min_scale CDATA #IMPLIED max_scale CDATA #IMPLIED min_tile_width CDATA #IMPLIED min_tile_height CDATA #IMPLIED&gt; &lt;！ELEMENT zoom_level（tile_bound？）&gt; &lt;！ATTLIST zoom_level level CDATA #REQUIRED level_name CDATA #IMPLIED description CDATA #IMPLIED scale CDATA #REQUIRED tile_width CDATA #REQUIRED tile_height CDATA #REQUIRED&gt; &lt;！ELEMENT auto_update（dirty_mbr_table_name，logtable_name）&gt; &lt;！ATTLIST auto_update finest_level_to_refresh CDATA #REQUIRED dirty_mbr_batch CDATA #REQUIRED dirty_mbr_cap CDATA #REQUIRED&gt; &lt;！ELEMENT dirty_mbr_table_name EMPTY&gt; &lt;！ATTLIST dirty_mbr_table_name名称CDATA #REQUIRED&gt; &lt;！ELEMENT logtable_name EMPTY&gt; &lt;！ATTLIST logtable_name name CDATA #REQUIRED&gt; &lt;！ELEMENT主题（主题）&gt; &lt;！ATTLIST auto_update finest_level_to_refresh CDATA #REQUIRED dirty_mbr_batch CDATA #REQUIRED dirty_mbr_cap CDATA #REQUIRED&gt; &lt;！ELEMENT主题EMPTY&gt; &lt;！ATTLIST主题名称CDATA #REQUIRED from_level CDATA #REQUIRED to_level CDATA #REQUIRED&gt;</pre></div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xml-formats-map-visualizer.html#GUID-40C2D442-B6C8-4C29-97C8-9A5335DB09E5" title="本附录描述了使用地图可视化组件元数据视图定义样式，主题和基本地图的XML格式。">样式，主题，基本映射和地图图层的XML格式</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html><html id="09659.using-DBMS_ROLLING-to-perform-rolling-upgrade.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="The Rolling Upgrade Using Oracle Active Data Guard feature provides a streamlined method of performing rolling upgrades."></meta>
      <meta name="description" content="The Rolling Upgrade Using Oracle Active Data Guard feature provides a streamlined method of performing rolling upgrades."></meta>
      <title>使用DBMS_ROLLING执行滚动升级</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Concepts and Administration "></meta>
      <meta property="og:description" content="The Rolling Upgrade Using Oracle Active Data Guard feature provides a streamlined method of performing rolling upgrades."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Concepts and Administration"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-guard-concepts-and-administration.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T10:50:21-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96244-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="using-sql-apply-to-perform-rolling-upgrade.html" title="Previous" type="text/html"></link>
      <link rel="next" href="examples-of-using-oracle-data-guard.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Guard Concepts and Administration"></meta>
    <meta name="dcterms.isVersionOf" content="SBYDB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-sql-apply-to-perform-rolling-upgrade.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="examples-of-using-oracle-data-guard.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">概念和管理</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-data-guard-concepts.html" property="item" typeof="WebPage"><span property="name">概念和管理</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用DBMS_ROLLING执行滚动升级</li>
            </ol>
            <a id="GUID-70C09F5B-90BE-4C8C-96A5-45A52E05D380" name="GUID-70C09F5B-90BE-4C8C-96A5-45A52E05D380"></a><a id="SBYDB5214"></a>
            
            <h2 id="SBYDB-GUID-70C09F5B-90BE-4C8C-96A5-45A52E05D380" class="sect2"><span class="enumeration_chapter">14</span>使用DBMS_ROLLING执行滚动升级</h2>
         </header>
         <div class="ind">
            <div>
               <p>滚动升级使用Oracle Active Data Guard功能提供了一种简化的滚动升级方法。</p>
               <p>它使用<code class="codeph">DBMS_ROLLING</code> PL / SQL包实现，该包使您能够以滚动方式升级Oracle Data Guard配置中的数据库软件。使用Oracle Active Data Guard功能进行滚动升级需要Oracle Active Data Guard选件的许可证。
               </p>
               <p>您可以使用此功能从Oracle Database 12 <span class="italic">c</span>的第一个补丁集开始执行数据库版本升级。您不能使用它从早于第一个Oracle Database 12 <span class="italic">c</span>补丁集的任何版本升级。这意味着从Oracle数据库<span class="italic">11克</span>升级到Oracle Database12 <span class="italic">c</span>当<span class="italic">，</span>或从最初的Oracle数据库12 <span class="italic">c</span>释放升级到Oracle数据库<span class="italic">12c</span>的第一补丁集时必须仍然被用于手动临时逻辑备用的升级步骤。
               </p>
               <p><code class="codeph">DBMS_ROLLING</code>包执行Oracle Data Guard切换以最小化主数据库服务的停机时间。在使用<code class="codeph">DBMS_ROLLING</code>之前，必须正确配置Oracle Data Guard环境以适应切换。设置要求因Oracle Data Guard代理在执行<code class="codeph">DBMS_ROLLING</code>期间是否处于活动状态而<code class="codeph">DBMS_ROLLING</code> ：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p>如果代理在<code class="codeph">DBMS_ROLLING</code>期间将处于活动状态，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=DGBKR-GUID-AC6A6D2B-1112-422B-8A41-02FAC40E2078" target="_blank"><span><cite>Oracle Data Guard Broker</cite></span></a>以获取有关为切换设置<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=DGBKR-GUID-AC6A6D2B-1112-422B-8A41-02FAC40E2078" target="_blank"><span><cite>代理</cite></span></a>的信息。
                     </p>
                  </li>
                  <li>
                     <p>如果代理在<code class="codeph">DBMS_ROLLING</code>期间不会处于活动状态，则请参阅<a href="managing-oracle-data-guard-role-transitions.html#GUID-CE785178-FD22-4A81-9248-DF5ED8E91635" title="角色转换步骤因您执行切换还是故障转移而异。">涉及逻辑备用数据库的角色转换</a> 。缺少Oracle Data Guard代理意味着必须在目标主数据库上正确配置<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="variable" translate="no">n</span>参数，以便在切换后重新开始重做。
                     </p>
                  </li>
               </ul>
               <p>此外，您可以立即将此功能用于从Oracle Database 12 <span class="italic">c</span>第1版（12.1）开始的其他数据库维护任务。执行维护的数据库必须至少在Oracle 12.1上运行。此类维护任务包括：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p>将分区添加到非分区表</p>
                  </li>
                  <li>
                     <p>将BasicFiles LOB更改为SecureFiles LOB</p>
                  </li>
                  <li>
                     <p>将存储为<code class="codeph">CLOB</code> <code class="codeph">XMLType</code>更改为存储为二进制XML的<code class="codeph">XMLtype</code></p>
                  </li>
                  <li>
                     <p>将表更改为OLTP压缩</p>
                  </li>
               </ul>
               <p>请参阅以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-647FF758-5B53-44AE-BB80-B6FA506F09C7" title="要以滚动方式升级Oracle Data Guard配置中的数据库软件，首先要将物理备用数据库指定为未来的主数据库。">滚动升级新概念</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-BC4E1CA8-4431-4FC0-8437-106C934E88EA" title="在多租户容器数据库（CDB）上使用DBMS_ROLLING执行滚动升级的步骤与非CDB环境没有区别，但还有其他要求和注意事项。">DBMS_ROLLING升级和CDB</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-D42FC23B-C6F4-44D1-A46A-202AB845BB80" title="使用DBMS_ROLLING PL / SQL包进行滚动升级过程分为三个阶段：规范，编译和执行。">使用DBMS_ROLLING概述</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE" title="规划滚动升级对于成功升级体验至关重要。在规划阶段，您可以指定各种升级参数并构建升级计划。">规划滚动升级</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-5652ED69-A95F-454A-9208-E2483B9A9BA6" title="按照以下步骤使用DBMS_ROLLING PL / SQL包执行滚动升级。">执行滚动升级</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-A1348F5A-AFBC-4090-822F-23DF87CE7D3C" title="您可以查询几个视图，以获取有关滚动升级所涉及的数据库的信息。">监控滚动升级</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-5B34621B-FABE-4C50-A2C0-ED249844934D" title="要回滚滚动升级过程，可以调用DBMS_ROLLING.ROLLBACK_PLAN过程。">回滚滚动升级</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-1019E58C-1370-48A6-BC67-FA42074C0351" title="如果出现滚动升级的情况，并且您需要在转存完成之前在Oracle Data Guard配置中执行故障转移，则只能在这些情况下执行此操作。">处理滚动升级期间发生的角色更改</a></p>
                  </li>
                  <li>
                     <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9" title="这些示例显示了各种滚动升级方案。">滚动升级的例子</a></p>
                  </li>
               </ul>
            </div><a id="SBYDB5406"></a><a id="SBYDB5431"></a><div class="props_rev_3"><a id="GUID-647FF758-5B53-44AE-BB80-B6FA506F09C7" name="GUID-647FF758-5B53-44AE-BB80-B6FA506F09C7"></a><h3 id="SBYDB-GUID-647FF758-5B53-44AE-BB80-B6FA506F09C7" class="sect3"><span class="enumeration_section">14.1</span>滚动升级新概念</h3>
               <div>
                  <p>要以滚动方式升级Oracle Data Guard配置中的数据库软件，首先要将物理备用数据库指定为未来的主数据库。</p>
                  <p>从概念上讲，滚动升级过程将Oracle Data Guard配置分为两组：前导组（LG）和尾随组（TG）。</p>
                  <p>领先组中的数据库首先升级;因此成为领导小组的名称。前导组包含指定的未来主数据库，以及可以配置以保护指定的未来主数据库的物理备用数据库。将来的主数据库首先转换为逻辑备用数据库，然后在其上安装新的数据库软件并运行升级过程。领先组中的其他备用数据库也必须在此时升级其软件。</p>
                  <p>尾随组包含原始主数据库和备用数据库，这些数据库在滚动升级过程中保护原始主数据库。虽然领先组中的数据库正在进行升级过程，但用户应用程序仍可以连接到原始主数据库并进行更改。尾随组数据库继续运行旧数据库软件，直到领导组中的所有数据库都已升级，并且未来主数据库通过应用在升级窗口期间在原始主数据库中生成的更改来赶上原始主数据库。此时，进行切换以将主角色转移到指定的未来主数据库，并将用户应用程序切换到新的主数据库。然后，在作为尾随组的一部分的数据库上安装新软件，并将它们恢复为配置，作为新主数据库的备用。</p>
                  <p>各组中的备用证称为领导小组备用（LGS）和尾随小组备用（TGS）。除指定的未来小学外，领导小组中的所有其他备用小组只能是实际备用小组。尾随组可以包含物理和逻辑备用数据库;在需要区分备用类型的情况下，它们被称为尾随组物理（TGP）和尾随组逻辑（TGL）。指定的未来主要也称为领导组主（LGM），原始主数据库称为尾随组主（TGM）。</p>
                  <p><code class="codeph">DBMS_ROLLING</code>包增加了滚动升级过程的稳健性，如下所示：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>它可以在滚动升级过程中处理故障。原始主数据库或TGM数据库可能会失败。您可以对尾随组中的任何其他物理备用数据库启动常规故障转移操作，然后将新主数据库指定为TGM。</p>
                     </li>
                     <li>
                        <p>它允许在滚动升级过程中对LGM（指定的未来主数据库）进行数据保护。您可以为LGM数据库设置物理备用数据库，从而在升级过程中保护它，并在升级后实现零数据丢失。LGM成功升级后，可以通过故障转移到任何物理备用数据库来解决LGM故障。然后，您可以指定故障转移目标数据库以接管LGM的角色。</p>
                     </li>
                  </ul>
                  <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-647FF758-5B53-44AE-BB80-B6FA506F09C7__CJAFAAHA" title="此表描述了Trailing Group Physical备用数据库和Leading Group Physical备用数据库之间的区别。有4列和2行，不包括标题行。">表14-1</a>比较了切换操作前后TGP备用数据库与LGP备用数据库的特性。
                  </p>
                  <div class="tblformalwide" id="GUID-647FF758-5B53-44AE-BB80-B6FA506F09C7__CJAFAAHA">
                     <p class="titleintable">表14-1尾随组物理（TGP）与领先组物理（LGP）</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="尾随团体物理（TGP）与领先团体物理（LGP）" width="100%" border="1" summary="This table describes the difference between Trailing Group Physical standbys and Leading Group Physical standbys. There are 4 columns and two rows, excluding the header row." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d36675e367">待机类型</th>
                              <th align="left" valign="bottom" width="23%" id="d36675e370">切换前</th>
                              <th align="left" valign="bottom" width="23%" id="d36675e373">切换后</th>
                              <th align="left" valign="bottom" width="29%" id="d36675e376">笔记</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d36675e381" headers="d36675e367 ">
                                 <p>尾随组物理（TGP）</p>
                              </td>
                              <td align="left" valign="top" width="23%" headers="d36675e381 d36675e370 ">
                                 <p>应用滞后率低</p>
                                 <p>降低数据丢失风险</p>
                              </td>
                              <td align="left" valign="top" width="23%" headers="d36675e381 d36675e373 ">
                                 <p>高应用滞后</p>
                                 <p>更高的数据丢失风险</p>
                              </td>
                              <td align="left" valign="top" width="29%" headers="d36675e381 d36675e376 ">
                                 <p>可以故障转移到主要角色</p>
                                 <p>必须像原始主要一样闪回</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d36675e400" headers="d36675e367 ">
                                 <p>领导小组物理（LGP）</p>
                              </td>
                              <td align="left" valign="top" width="23%" headers="d36675e400 d36675e370 ">
                                 <p>高应用滞后</p>
                                 <p>更高的数据丢失风险</p>
                              </td>
                              <td align="left" valign="top" width="23%" headers="d36675e400 d36675e373 ">
                                 <p>应用滞后率低</p>
                                 <p>降低数据丢失风险</p>
                              </td>
                              <td align="left" valign="top" width="29%" headers="d36675e400 d36675e376 ">
                                 <p>可以故障转移到临时逻辑备用角色</p>
                                 <p>不必像原来的主要闪回一样</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="infoboxnotealso" id="GUID-647FF758-5B53-44AE-BB80-B6FA506F09C7__GUID-83F26596-3D2D-4304-93D7-2F74735BCBEF">
                     <p class="notep1">也可以看看：</p>
                     <p></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ARPLS73534" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a> ，以获取<code class="codeph">DBMS_ROLLING</code> PL / SQL包的描述</p>
                        </li>
                        <li>
                           <p><a href="data-type-ddl-support-on-logical-standby-databases.html#GUID-13DDE926-B175-488D-9037-F707A4D2256D" title="在执行滚动升级之前，请确定所涉及的任何表是否包含逻辑备用数据库上不支持的数据类型。">滚动升级期间不支持的表</a>有关如何确定升级中涉及的任何表是否包含使用<code class="codeph">DBMS_ROLLING</code> PL / SQL程序包执行升级时不支持的数据类型的信息</p>
                        </li>
                        <li>
                           <p><a href="data-type-ddl-support-on-logical-standby-databases.html#GUID-F54904C7-F666-4CC3-B1CB-493525476D2F" title="某些软件包的复制仅在使用DBMS_ROLLING软件包执行的滚动升级的上下文中可用。">仅在DBMS_ROLLING上下文中可用的附加PL / SQL程序包支持升级，</a>以获取仅在<code class="codeph">DBMS_ROLLING</code>升级的上下文中支持的PL / SQL程序包的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-5DDF9197-33A4-4279-8058-46B3B8C0FAE4" name="GUID-5DDF9197-33A4-4279-8058-46B3B8C0FAE4"></a><h4 id="SBYDB-GUID-5DDF9197-33A4-4279-8058-46B3B8C0FAE4" class="sect4"><span class="enumeration_section">14.1.1</span> Data Guard Broker支持DBMS_ROLLING升级</h4>
                  <div>
                     <p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2.0.1）开始，Data Guard代理可以在<code class="codeph">DBMS_ROLLING</code>滚动升级期间保持打开状态;不再需要禁用它。
                     </p>
                     <p>有关Data Guard代理对<code class="codeph">DBMS_ROLLING</code>升级的支持，请记住以下<code class="codeph">DBMS_ROLLING</code> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果在调用时启用了代理，则在执行<code class="codeph">DBMS_ROLLING.BUILD_PLAN</code>过程期间默认启用代理支持。启用代理支持后，代理会根据需要从原始主数据库以及滚动升级目标设置重做传输目标。
                           </p>
                        </li>
                        <li>
                           <p>在开始<code class="codeph">DBMS_ROLLING</code>升级之前，必须禁用快速启动故障转移功能。
                           </p>
                        </li>
                        <li>
                           <p>任何在滚动升级过程中启用快速启动故障转移的尝试都将被拒绝。</p>
                        </li>
                        <li>
                           <p>正在进行滚动升级时，只允许对保护当前主数据库的备用数据库进行角色更改。代理在<code class="codeph">SHOW CONFIGURATION</code>命令期间将滚动升级目标的角色报告为<code class="codeph">Transient Logical Standby</code> ，并将配置状态报告为<code class="codeph">ROLLING DATABASE MAINTENANCE IS IN PROGRESS</code> 。如果存在保护原始主目标和升级目标的备用数据库，则在从当前主节点和升级目标（在它接管为主数据库之前）发出<code class="codeph">SHOW CONFIGURATION</code>命令时，将反映此拓扑。
                           </p>
                        </li>
                        <li>
                           <p>代理阻止角色更改为不保护当前主节点的备用节点。这样可以确保在切换阶段之前允许对尾随组备用的角色更改，并且在切换阶段之后，角色更改仅允许进入领导组备用。</p>
                        </li>
                        <li>
                           <p>在升级过程开始期间，如果升级目标是Oracle RAC数据库，则代理会自动将目标备用数据库减少到一个实例，并允许升级继续。如果没有代理，如果发现目标有多个实例正在运行，则会拒绝升级的开始。</p>
                        </li>
                        <li>
                           <p>代理在滚动升级过程中适当地通知Oracle Clusterware和全局数据服务。</p>
                        </li>
                        <li>
                           <p>尽管通常使用代理执行角色转换，但仍应使用<code class="codeph">DBMS_ROLLING.SWITCHOVER</code>过程继续执行滚动升级中的切换步骤。
                           </p>
                        </li>
                        <li>
                           <p>有关使用PL / SQL包<code class="codeph">DBMS_ROLLING</code>完成滚动升级状态的信息显示在代理命令<code class="codeph">SHOW CONFIGURATION</code>和<code class="codeph">SHOW DATABASE</code>的输出中。</p>
                           <p><code class="codeph">SHOW CONFIGURATION</code>命令将Transient逻辑备用数据库显示为升级目标的角色，并将<code class="codeph">ROLLING DATABASE MAINTENANCE IN PROGRESS</code>为配置状态。此输出的示例如下：</p><pre class="pre codeblock"><code>配置 -  DRSolution保护模式：MaxPerformance成员：North_Sales  - 主数据库South_Sales  - 瞬态逻辑备用数据库快速启动故障转移：禁用配置状态：正在进行的滚动数据库维护</code></pre><p><code class="codeph">SHOW DATABASE</code>命令显示<code class="codeph">WARNING</code>其中包含升级目标和尾随或前导备用<code class="codeph">SHOW DATABASE</code>的相应<code class="codeph">ORA</code>错误，具体取决于当前的滚动升级进度。此输出的示例如下：</p><pre class="pre codeblock"><code>数据库 -  South_Sales角色：物理备用数据库预期状态：APPLY-ON传输延迟：***应用滞后：***平均应用率：***实时查询：关闭实例：南数据库警告： ORA-16866：数据库转换为临时逻辑备用数据库，用于滚动数据库维护数据库状态：警告</code></pre></li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-5DDF9197-33A4-4279-8058-46B3B8C0FAE4__GUID-F6B759E1-5CC1-4C99-847C-4A47F6539563">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../arpls/DBMS_ROLLING.html#ARPLS-GUID-097F1B39-E623-43B5-BA30-DF377BFE05CF" target="_blank">DBMS_ROLLING</a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=DGBKR-GUID-1A5D2697-D931-4A48-B54C-CAE223B37733" target="_blank">显示配置</a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=DGBKR-GUID-9293F2C8-A7D2-442E-B147-A05A54DDE20E" target="_blank">显示数据库</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-BC4E1CA8-4431-4FC0-8437-106C934E88EA" name="GUID-BC4E1CA8-4431-4FC0-8437-106C934E88EA"></a><h3 id="SBYDB-GUID-BC4E1CA8-4431-4FC0-8437-106C934E88EA" class="sect3"><span class="enumeration_section">14.2</span> DBMS_ROLLING升级和CDB</h3>
               <div>
                  <p>在多租户容器数据库（CDB）上使用<code class="codeph">DBMS_ROLLING</code>执行滚动升级的步骤与非CDB环境没有区别，但还有其他要求和注意事项。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-BC4E1CA8-4431-4FC0-8437-106C934E88EA__GUID-D7110B13-4AD6-4485-8C57-8A10D1DEAB59">特定于DBMS_ROLLING CDB上的升级</p>
                     <p>使用<code class="codeph">DBMS_ROLLING</code>在CDB上执行滚动升级时的其他要求如下。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">LOG_ARCHIVE_DEST_n</code>参数中引用的TNS服务必须是解析为目标数据库的根容器的服务。协助<code class="codeph">DBMS_ROLLING</code>的进程执行许多只能从根容器执行的操作。
                           </p>
                        </li>
                        <li>
                           <p>在调用<code class="codeph">DBMS_ROLLING.SWITCHOVER</code>之前，必须插入并打开瞬态逻辑备用数据库上的所有容器数据库。这消除了逻辑备用应用引擎停止的可能性，因为它不能应用于给定的PDB。</p>
                        </li>
                     </ul>
                     <p>有关使用<code class="codeph">DBMS_ROLLING</code>滚动升级的示例，请参见<a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAFHDDH">示例14-5</a> 。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-BC4E1CA8-4431-4FC0-8437-106C934E88EA__GUID-681E40B4-CFCD-4BF1-A716-41EDD73E71E4">DBMS_ROLLING在CDB上升级的其他注意事项</p>
                     <p>正在进行<code class="codeph">DBMS_ROLLING</code>升级时，不支持安装，升级或修补安装在应用程序容器中的应用程序。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果在执行<code class="codeph">DBMS_ROLLING</code>升级时执行DDL以启动应用程序容器的安装，升级或修补，则会返回错误。（ <code class="codeph">DBMS_ROLLING</code>升级继续。）
                           </p>
                        </li>
                        <li>
                           <p>如果正在升级到应用程序容器，则尝试启动<code class="codeph">DBMS_ROLLING</code>升级会导致错误。（应用程序容器升级继续。）
                           </p>
                        </li>
                        <li>
                           <p>如果执行<code class="codeph">DBMS_ROLLING</code>升级并且数据库兼容性设置为12.2或更高，则支持复制应用程序容器。除<code class="codeph">DBMS_ROLLING</code>升级外，逻辑备用数据库不提供对应用程序容器的任何支持;跳过此类容器，并将一条消息写入警报日志，指示正在跳过应用程序容器。
                           </p>
                        </li>
                        <li>
                           <p>使用<code class="codeph">DBMS_ROLLING</code>升级的CDB可以包含具有不同字符集的可插拔数据库（PDB）。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="SBYDB5432"></a><div class="props_rev_3"><a id="GUID-D42FC23B-C6F4-44D1-A46A-202AB845BB80" name="GUID-D42FC23B-C6F4-44D1-A46A-202AB845BB80"></a><h3 id="SBYDB-GUID-D42FC23B-C6F4-44D1-A46A-202AB845BB80" class="sect3"><span class="enumeration_section">14.3</span>使用DBMS_ROLLING概述</h3>
               <div>
                  <p>使用<code class="codeph">DBMS_ROLLING</code> PL / SQL包进行滚动升级过程分为三个阶段：规范，编译和执行。
                  </p>
                  <p></p>
                  <ol>
                     <li>
                        <p><span class="bold">规范</span> ：首先指定您希望如何实现滚动升级过程。您必须指定未来的主数据库。此行为在概念上创建了前导组和尾随组。此时，领导组仅包含LGM。您可以选择指定其他备用数据库来保护LGM。</p>
                        <p>在规范阶段使用以下过程：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">DBMS_ROLLING.INIT_PLAN</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBMS_ROLLING.SET_PARAMETER</code></p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p><span class="bold">编译</span> ：这是通过调用<code class="codeph">DBMS_ROLLING.BUILD_PLAN</code>过程启动的。<code class="codeph">BUILD_PLAN</code>过程与参与滚动升级的所有数据库通信，并组装滚动升级计划。还调用<code class="codeph">BUILD_PLAN</code>过程来更改现有的滚动升级计划。更改<code class="codeph">DBMS_ROLLING</code>参数后以及由于故障转移而更改拓扑后，必须进行更改。在执行<code class="codeph">BUILD_PLAN</code>过程期间，必须可以访问所有参与的数据库，因为需要大量验证才能确保滚动升级成功。
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">执行</span> ：滚动升级的执行有五个阶段。
                        </p>
                        <p><span class="bold">阶段1：</span> <code class="codeph">DBMS_ROLLING.START_PLAN</code>过程开始执行滚动升级。这会将LGM数据库转换为逻辑备用数据库，并在LGM启动SQL Apply进程。</p>
                        <p><span class="bold">阶段2：</span>您在属于领导组的数据库中升级数据库软件。您还可以在LGM上运行升级脚本。完成此操作后，您必须在LGM数据库中重新启动SQL Apply进程。（有关升级脚本的信息，请参阅“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=UPGRD-GUID-99E10023-B2E5-4B35-BD01-E21D5B912D50" target="_blank"><span class="italic">Oracle数据库升级指南”</span></a> 。）在此阶段，通过使用更高版本的二进制文件重新安装它们，也可以解决领先的群组物理备用问题。通过从LGM恢复重做来升级这些数据库。</p>
                        <p><span class="bold">阶段3：</span>应用延迟达到给定阈值（默认设置为10分钟，但可以在规范阶段配置）后， <code class="codeph">DBMS_ROLLING.SWITCHOVER</code>过程继续进行切换操作。切换完成后，LGM将成为主数据库。
                        </p>
                        <p><span class="bold">阶段4：</span> LGM现在是运行新数据库软件的主数据库，领先组中的数据库正在保护它。安装了TGM，尾随组中的数据库仍在运行旧版本的数据库软件。您必须通过升级数据库软件并在较高版本的二进制文件上重新安装数据库来准备TGM和TGS数据库以进行升级。（有关升级脚本的信息，请参阅“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=UPGRD-GUID-99E10023-B2E5-4B35-BD01-E21D5B912D50" target="_blank"><span class="italic">Oracle数据库升级指南”</span></a> 。）
                        </p>
                        <p><span class="bold">阶段5：</span>在当前主数据库（最初是LGM）上执行<code class="codeph">DBMS_ROLLING.FINISH_PLAN</code>过程。它会恢复尾随组中的所有数据库，以成为当前主数据库的备用数据库，并重新启动应用程序进程。<code class="codeph">FINISH_PLAN</code>过程等待尾随组中的所有数据库升级到新版本（尽管尾随组数据库的数据库软件已在第4阶段中更改，即尾随组数据库的数据字典，除了任何逻辑备用数据库尾随组，基于LGM数据库升级期间生成的重做的媒体恢复进行更新。
                        </p>
                     </li>
                  </ol>
                  <p>成功执行滚动升级后，可以通过调用<code class="codeph">DBMS_ROLLING.DESTROY_PLAN</code>过程来删除滚动升级规范。
                  </p>
               </div>
            </div><a id="SBYDB5222"></a><a id="SBYDB5223"></a><a id="SBYDB5224"></a><a id="SBYDB5225"></a><a id="SBYDB5216"></a><div class="props_rev_3"><a id="GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE" name="GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE"></a><h3 id="SBYDB-GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE" class="sect3"><span class="enumeration_section">14.4</span>规划滚动升级</h3>
               <div>
                  <p>规划滚动升级对于成功升级体验至关重要。在规划阶段，您可以指定各种升级参数并构建升级计划。</p>
                  <div class="section">
                     <p>参数和升级计划会预测环境特有的所有操作详细信息。升级计划执行特定于站点的验证，以提醒您可能会破坏滚动升级的配置和资源问题。</p>
                     <p>定义升级参数和构建升级计划所需的任务如下：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>初始化升级参数</p>
                        </li>
                        <li>
                           <p>查看当前的升级参数值</p>
                        </li>
                        <li>
                           <p>根据需要修改升级参数值</p>
                        </li>
                        <li>
                           <p>制定升级计划</p>
                        </li>
                        <li>
                           <p>查看当前的升级计划</p>
                        </li>
                        <li>
                           <p>必要时修改升级计划</p>
                        </li>
                     </ul>
                     <p>本节的其余部分将详细介绍每个步骤。必须按照提供的顺序执行。</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>必须先将计划参数初始化为系统生成的默认值，然后才能对其进行自定义。要初始化计划参数，请调用<code class="codeph">DBMS_ROLLING.INIT_PLAN</code>过程。此过程标识未来主数据库（前导组主服务器或LGM）的<code class="codeph">DB_UNIQUE_NAME</code> 。作为<code class="codeph">START_PLAN</code>过程调用的一部分，LGM将转换为逻辑备用数据库。以下是对<code class="codeph">INIT_PLAN</code>过程的示例调用，其中<code class="codeph">boston</code>被标识为未来的主数据库：</span><div><pre class="oac_no_warn" dir="ltr">DBMS_ROLLING.INIT_PLAN（future_primary =&gt; '波士顿'）;</pre><p><code class="codeph">INIT_PLAN</code>过程返回一组初始的系统生成的计划参数。它将<code class="codeph">DG_CONFIG</code> init.ora参数中指定的每个物理和逻辑备用数据库添加为滚动升级的参与者。其他数据库（例如服务GoldenGate下游部署或快照备用数据库的下游数据库）将自动排除。
                           </p>
                           <p>缺省情况下，未来主数据库以外的备用数据库配置为保护主数据库，并配置为滚动升级中的必需参与者。</p>
                           <p>一旦定义了与数据库相关的参数， <code class="codeph">INIT_PLAN</code>过程就会定义具有系统提供的默认值的操作参数。在大多数情况下，计划参数已准备好进行计划验证，但为确保满足您的需求，请务必查看每个参数。
                           </p>
                           <p>计划参数将保留在数据库中，直到您调用<code class="codeph">DESTROY_PLAN</code>过程以删除与滚动升级相关的所有状态。
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span><code class="codeph">INIT_PLAN</code>过程完成后，您可以查询<code class="codeph">DBA_ROLLING_PARAMETERS</code>视图以查看计划参数及其当前值。计划参数在全局或本地范围内。全局参数是整个滚动升级的属性，并且独立于数据库参与者。全局参数在<code class="codeph">SCOPE</code>列中具有<code class="codeph">NULL</code>值。本地参数在<code class="codeph">SCOPE</code>列中具有特定的数据库名称，并与它们相关联。以下是示例查询：</span><div><pre class="pre codeblock"><code>SQL&gt;按范围，名称从dba_rolling_parameters顺序选择范围，名称，curval; SCOPE NAME CURVAL -------------- ------------------------ --------- ---------------------西雅图参与完整的西雅图会员没有波士顿参与全波士顿会员跟踪奥克兰参与完整的奥克兰会员跟踪亚特兰大参与完整亚特兰大会员领导ACTIVE_SESSIONS_TIMEOUT 3600 ACTIVE_SESSIONS_WAIT 0 BACKUP_CONTROLFILE rolling_change_backup.f DGBROKER 0 DICTIONARY_LOAD_TIMEOUT 3600 DICTIONARY_LOAD_WAIT 0 DICTIONARY_PLS_WAIT_INIT 300 DICTIONARY_PLS_WAIT_TIMEOUT 3600 EVENT_RECORDS 10000 FAILOVER 0 GRP_PREFIX DBMSRU_ IGNORE_BUILD_WARNINGS 0 IGNORE_LAST_ERROR 0 LAD_ENABLED_TIMEOUT 600 LOG_LEVEL INFO READY_LGM_LAG_TIME 600 READY_LGM_LAG_TIMEOUT 60 READY_LGM_LAG_WAIT 0 SWITCH_LGM_LAG_TIME 600 SWITCH_LGM_LAG_TIMEOUT 60 SWITCH_LGM_LAG_WAIT 1 SWITCH_LGS_LAG_TIME 60 SWITCH_LGS_LAG_TIMEOUT 60 SWITCH_LGS_LAG_WAIT 0 UPDATED_LGS_TIMEOUT 10800 UPDATED_LGS_WAIT 1 UPDATED_TGS_TIMEOUT 10800 UPDATED_TGS_WAIT选择了35行。</code></pre><p>在样本输出中，数据库<code class="codeph">atlanta</code> ， <code class="codeph">boston</code> ， <code class="codeph">oakland</code>和<code class="codeph">seattle</code>都是通过<code class="codeph">DG_CONFIG</code>发现的，并在当前计划中分配了参数。
                           </p>
                           <div class="infoboxnotealso" id="GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE__GUID-02D62122-F280-46AC-B0EF-1462BC58B288">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">DBA_ROLLING_PARAMETERS</code>视图的更多信息，请<code class="codeph">DBA_ROLLING_PARAMETERS</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN23889" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>要修改任何现有的滚动升级参数，请使用<code class="codeph">DBMS_ROLLING.SET_PARAMETER</code> PL / SQL过程。以下是使用<code class="codeph">SET_PARAMETER</code>过程的示例：</span><div><pre class="oac_no_warn" dir="ltr">DBMS_ROLLING.SET_PARAMETER（范围IN VARCHAR2，名称IN VARCHAR2，值IN VARCHAR2）;</pre><p>范围标识本地参数的<code class="codeph">DB_UNIQUE_NAME</code>值或全局参数的<code class="codeph">NULL</code> 。没有必要为不是特定于数据库的参数提供<code class="codeph">NULL</code>范围。
                           </p>
                           <p>名称是要修改的参数的名称。</p>
                           <p>该值标识指定参数的值。值NULL将参数恢复为系统提供的默认值（如果存在）。</p>
                           <div class="infoboxnotealso" id="GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE__GUID-F4EF7787-5C33-4E59-9750-17609C87C212">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ARPLS74605" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a> ，以获取所有可用滚动升级参数的完整列表</p>
                                 </li>
                              </ul>
                           </div>
                           <p>以下示例说明了一些滚动升级参数的示例用法。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>指定所有必需参数后，您将构建升级计划。升级计划是一组自定义生成的指令，可通过滚动升级指导您的Oracle Data Guard配置。（生成的计划根据配置是否由Data Guard代理管理而有所不同。）</span><div>
                           <p>要构建升级计划，请使用<code class="codeph">DBA_ROLLING.BUILD_PLAN</code> PL / SQL过程。此过程要求配置完全如计划参数所述，所有实例均已启动并可通过网络访问。
                           </p>
                           <p>该过程调用如下：</p><pre class="oac_no_warn" dir="ltr">DBMS_ROLLING.BUILD_PLAN;</pre><p>没有要指定的参数，因为该过程从<code class="codeph">DBA_ROLLING_PARAMETERS</code>视图获取其所有输入。该过程验证计划参数并执行特定于站点的资源验证，例如日志传输和闪回恢复区域设置。通常，不符合最佳实践值标准的配置设置将被视为警告并记录在<code class="codeph">DBA_ROLLING_EVENTS</code>视图中。默认情况下， <code class="codeph">IGNORE_BUILD_WARNINGS</code>参数设置为<code class="codeph">1</code> ，这意味着警告不会阻止升级计划达到可用状态。您可以将此参数设置为<code class="codeph">0</code>以便在构建计划时更严格地执行规则。
                           </p>
                           <div class="infoboxnote" id="GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE__GUID-010705B4-E3C8-4152-92ED-0EB9395C15C1">
                              <p class="notep1">注意：</p>
                              <p>计划生成期间执行的验证特定于滚动升级。它们不能替代运行升级前信息工具以评估升级准备情况的建议做法。</p>
                           </div>
                           <p>生成计划后，继续执行以下步骤以查看计划，诊断任何问题，并在必要时进行修改。</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>成功返回<code class="codeph">BUILD_PLAN</code>过程后，可在<code class="codeph">DBA_ROLLING_PLAN</code>视图中查看完整的升级计划。视图中的每条记录都标识了一个计划执行的特定指令。</span><div>
                           <p>以下输出是滚动升级计划如何显示的示例：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT instid，target，phase，description FROM DBA_ROLLING_PLAN; INSTID TARGET阶段描述------ ------------ ------- --------------------- -------------------------------- 1个西雅图START验证数据库是主要的2个西雅图开始验证MAXIMUM PROTECTION被禁用3个波士顿START验证数据库是物理备用4波士顿START验证物理备用已挂载5 oakland START验证数据库是否为物理备用6启动验证物理备用已安装7 atlanta START验证数据库是否为物理备用8 atlanta START验证物理备用已挂载9西雅图START验证服务器参数文件是否存在且可修改10波士顿START验证服务器参数文件是否存在且可修改11 oakland START验证服务器参数文件是否存在且可修改12 atlanta START验证服务器参数文件是否存在且可修改13西雅图START验证Data Guard Broker配置已禁用14波士顿START验证Data Guard Broker配置已禁用15 oakland START验证Data Guard Broker配置i已禁用16 atlanta START验证Data Guard Broker配置已禁用17西雅图START启用验证闪回数据库已启用18西雅图START确认可用的闪回还原点19波士顿START验证闪回数据库已启用20波士顿START验证可用的闪回还原点21 oakland START验证闪回数据库已启用22 oakland START验证可用的闪回恢复点23 atlanta START验证闪回数据库是否已启用24 atlanta START验证可用的闪回恢复点25波士顿START扫描LAD是否存在atlanta目的地26波士顿START测试是否可以使用配置的TNS服务27波士顿到达亚特兰大START停止介质恢复28 oakland START停止介质恢复29 atlanta START停止介质恢复30波士顿START保证还原点DBMSRU_INITIAL 31波士顿START创建保证还原点DBMSRU_INITIAL 32 oakland START保证还原点DBMSRU_INITIAL 33 oakland START创建保证休息矿点DBMSRU_INITIAL 34 atlanta START保证恢复点DBMSRU_INITIAL 35 atlanta START创建保证恢复点DBMSRU_INITIAL 36西雅图START保证恢复点DBMSRU_INITIAL 37西雅图START创建保证恢复点DBMSRU_INITIAL INSTID目标阶段描述------ ----- ------- ------- ------------------------------------ ---------------------- 38波士顿START开始媒体恢复39波士顿START确认介质恢复正在运行40 oakland START启动介质恢复41 oakland START验证介质恢复是否正在运行42 atlanta START启动介质恢复43 atlanta START验证介质恢复正在运行44西雅图START确认已指定user_dump_dest 45西雅图START备份控制文件到rolling_change_backup.f 46 boston START验证user_dump_dest已指定47 boston START备份控制文件到rolling_change_backup.f 48 oakland START验证user_dump_dest已指定49 oakland START备份控制文件到ro lling_change_backup.f 50 atlanta START验证user_dump_dest已被指定51 atlanta START备份控制文件到rolling_change_backup.f 52 seattle START获取主数据库的当前重做分支53波士顿START等待主要重做分支上的恢复处于活动状态54波士顿START停止媒体恢复55西雅图START执行dbms_logstdby.build 56波士顿START转换为瞬态逻辑备用57波士顿START打开数据库58波士顿START配置逻辑备用参数59波士顿START启动逻辑备用应用60波士顿START获取瞬态逻辑备用的重做分支61波士顿START获取暂时逻辑重做分支的重置scn atlanta START停止介质恢复63 atlanta START闪回数据库64 seattle START禁用日志文件存档到atlanta 65 boston START启用日志文件存档到atlanta 66 boston START等待日志归档目的地到atlanta达到有效state 67 atlanta START等到瞬态逻辑重做分支出现注册68亚特兰大START开始媒体恢复69亚特兰大START等到v $ dataguard_stats已初始化70 atlanta START等待直到恢复已开始在瞬态重做分支71西雅图START登录预切换指令到事件表72波士顿START记录开始用户升级波士顿73波士顿SWITCH验证数据库处于OPENRW模式74波士顿SWITCH完成用户升级波士顿INSTID目标阶段描述------ ------------ ------ -  ------------------------------------------------- -------- 75波士顿SWITCH扫描LADs是否存在西雅图目的地76波士顿SWITCH扫描LAD是否存在奥克兰目的地77波士顿SWITCH扫描LAD是否存在亚特兰大目的地78波士顿SWITCH测试是否可以使用配置的TNS服务访问西雅图79波士顿开关测试是否使用配置的TNS服务可以到达奥克兰80波士顿开关测试是否使用配置的TNS服务可以到达亚特兰大81西雅图SWITCH启用日志文件存档波士顿82波士顿SWITCH启用日志文件存档到亚特兰大83波士顿SWITCH启动逻辑待机应用84 atlanta SWITCH启动媒体恢复85 atlanta SWITCH等到升级重做完全恢复86波士顿SWITCH等到应用延迟低于600秒87西雅图SWITCH将事后切换指令发送到事件表88西雅图SWITCH切换数据库到逻辑备用数据库89波士顿SWITCH等待直到重做结束已应用90 oakland SWITCH等待直到重做结束已应用91 seattle SWITCH禁用日志文件归档到奥克兰92波士顿SWITCH切换数据库到主要93奥克兰SWITCH停止媒体恢复94西雅图SWITCH同步计划与新的主要95西雅图FINISH验证只有一个实例是活动96西雅图FINISH验证数据库已安装97西雅图FINISH闪回数据库98西雅图FINISH转换成物理备用99奥克兰FINISH验证数据库已安装100奥克兰FINISH闪回数据库101波士顿FINI SH验证数据库是否打开102波士顿FINISH保存新主要的DBID 103波士顿FINISH保存logminer会话start scn 104 seattle FINISH等到瞬态逻辑重做分支已注册105 oakland FINISH等到瞬态逻辑重做分支已注册106西雅图FINISH开始媒体恢复107奥克兰FINISH开始媒体恢复108西雅图FINISH等待瞬态分支上的应用/恢复开始109奥克兰完成等待瞬态分支上的应用/恢复已开始110西雅图FINISH等待升级重做已完全恢复INSTID目标阶段描述------ ------------ ------- ---------------------- -------------------------- 111 oakland FINISH等到升级重做完全恢复112西雅图FINISH掉落保证恢复点DBMSRU_INITIAL 113波士顿FINISH掉落保证恢复点DBMSRU_INITIAL 114 oakland FINISH降落保证还原点DBMSRU_INITIAL 115 atlanta FINISH Drop guaran teed还原点DBMSRU_INITIAL选择了115行。SQL&gt;</pre><p>此视图中的列显示以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">INSTID</code> - 指令ID，它是指令的执行顺序。说明通常以组的形式执行。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">PHASE</code> - 升级计划中的每条指令都与特定阶段相关联。阶段是指令的逻辑分组，由<code class="codeph">DBMS_ROLLING</code> PL / SQL包中的过程执行。调用<code class="codeph">DBMS_ROLLING</code>过程时，将执行该阶段的升级计划中的所有相关指令。可能的阶段如下：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">START</code> ：包含与设置相关的活动，例如获取还原点，实例化瞬态逻辑备用数据库以及配置LGS数据库。调用<code class="codeph">DBMS_ROLLING.START_PLAN</code>过程时，将启动此阶段中的活动。请参阅<span class="q">“ <a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-5652ED69-A95F-454A-9208-E2483B9A9BA6" title="按照以下步骤使用DBMS_ROLLING PL / SQL包执行滚动升级。">执行滚动升级</a> ”中的</span>步骤1。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">SWITCH</code> ：包含与将瞬态逻辑备用数据库切换到新主数据库相关的活动。当您调用<code class="codeph">DBMS_ROLLING.SWITCHOVER</code>过程时，将启动此阶段中的活动。请参阅<span class="q">“ <a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-5652ED69-A95F-454A-9208-E2483B9A9BA6" title="按照以下步骤使用DBMS_ROLLING PL / SQL包执行滚动升级。">执行滚动升级</a> ”中的</span>步骤3</p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">FINISH</code> ：包含与配置备用数据库以恢复升级重做相关的活动。当您调用<code class="codeph">DBMS_ROLLING.FINISH_PLAN</code>过程时，将启动此阶段中的活动。请参阅<span class="q">“ <a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-5652ED69-A95F-454A-9208-E2483B9A9BA6" title="按照以下步骤使用DBMS_ROLLING PL / SQL包执行滚动升级。">执行滚动升级</a> ”中的</span>步骤5。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p><code class="codeph">EXEC_STATUS</code> - 指令的总体状态。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">PROGRESS</code> - 指令执行的进度。值<code class="codeph">REQUESTING</code>表示正在将指令发送到目标数据库以供执行。<code class="codeph">EXECUTING</code>值表示指令正在被执行。<code class="codeph">REPLYING</code>的值表示正在返回完成信息。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">DESCRIPTION</code> - 计划执行的特定操作。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">TARGET</code> - 执行给定指令的站点。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">EXEC_INFO</code> - 与指令相关的其他上下文信息。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE__GUID-E78DC6AB-57E7-4525-8F7A-DCA6991A14E0">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">DBA_ROLLING_PLAN</code>视图的详细信息，请<code class="codeph">DBA_ROLLING_PLAN</code> <a href="../refrn/DBA_ROLLING_PLAN.html#REFRN23890" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>在对滚动升级或数据库配置进行任何更改后，需要修改升级计划。配置更改可能包括以下任何内容：</span><div>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>init.ora参数文件在参与滚动升级的任何数据库中发生更改</p>
                              </li>
                              <li>
                                 <p>故障转移事件导致数据库角色更改</p>
                              </li>
                              <li>
                                 <p>滚动升级参数更改</p>
                              </li>
                           </ul>
                           <p>要修改活动升级计划，请再次调用<code class="codeph">BUILD_PLAN</code>过程。在某些情况下，如果无法接受给定的更改， <code class="codeph">BUILD_PLAN</code>过程可能会引发错误。例如，如果已经发生切换，则设置<code class="codeph">ACTIVE_SESSIONS_WAIT</code>参数无效。
                           </p>
                           <p>建议您调用<code class="codeph">BUILD_PLAN</code>过程来处理一组参数更改，而不是单独处理参数。
                           </p>
                        </div>
                     </li>
                  </ol>
                  <div class="example" id="GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE__GUID-EB36DF19-3847-4FB0-B963-49ADCCBF73BC">
                     <p class="titleinexample">示例14-1设置切换以强制应用延迟要求</p>
                     <p>以下示例演示如何配置计划以等待应用延迟降至60秒以下，然后切换到将来的主要：</p><pre class="oac_no_warn" dir="ltr">DBMS_ROLLING.SET_PARAMETER（'SWITCH_LGM_LAG_WAIT'，'1'）; DBMS_ROLLING.SET_PARAMETER（'SWITCH_LGM_LAG_TIME'，'60'）;</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE__GUID-1A958C1B-1109-4A3C-8E52-E5B891761274">
                     <p class="titleinexample">示例14-2将日志记录重置为其默认值</p>
                     <p>以下示例演示如何将<code class="codeph">LOG_LEVEL</code>全局参数重置为其默认值。
                     </p><pre class="oac_no_warn" dir="ltr">DBMS_ROLLING.SET_PARAMETER（name =&gt;'LOG_LEVEL'，value =&gt; NULL）;</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE__GUID-65A16C53-05A8-4B54-B177-56AB5DB90545">
                     <p class="titleinexample">示例14-3将数据库指定为可选参与者</p>
                     <p>以下示例演示如何设置数据库<code class="codeph">atlanta</code>的<code class="codeph">INVOLVEMENT</code>本地参数，以指示数据库中遇到的错误不应妨碍整体滚动升级。
                     </p><pre class="oac_no_warn" dir="ltr">DBMS_ROLLING.SET_PARAMETER（scope =&gt;'atlanta'，name =&gt;'involvement'，value =&gt;'optional'）;</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE__GUID-B3C2737F-A5E2-4B78-9CDA-C7FF7D401FF6">
                     <p class="titleinexample">示例14-4设置数据库以保护瞬态逻辑备用</p>
                     <p>以下示例演示如何设置数据库<code class="codeph">atlanta</code>的<code class="codeph">MEMBER</code>本地参数，以指示它应在滚动升级期间保护瞬态逻辑备用数据库。
                     </p><pre class="oac_no_warn" dir="ltr">DBMS_ROLLING.SET_PARAMETER（scope =&gt;'atlanta'，name =&gt;'member'，value =&gt;'leading'）;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="SBYDB5231"></a><a id="SBYDB5230"></a><div class="props_rev_3"><a id="GUID-5652ED69-A95F-454A-9208-E2483B9A9BA6" name="GUID-5652ED69-A95F-454A-9208-E2483B9A9BA6"></a><h3 id="SBYDB-GUID-5652ED69-A95F-454A-9208-E2483B9A9BA6" class="sect3"><span class="enumeration_section">14.5</span>执行滚动升级</h3>
               <div>
                  <p>按照以下步骤使用<code class="codeph">DBMS_ROLLING</code> PL / SQL包执行滚动升级。
                  </p>
                  <div class="section">
                     <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-5652ED69-A95F-454A-9208-E2483B9A9BA6__CJAJCACI" title="此3列表列出了执行滚动升级的步骤。第1列是步骤编号。第2列是步骤说明。第3列是阶段。">表14-2</a>提供了这些步骤的摘要。这些步骤假定您首先成功构建了升级计划，如<span class="q">“ <a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-CD45406F-0A0F-4C9E-95FF-42C908BE62BE" title="规划滚动升级对于成功升级体验至关重要。在规划阶段，您可以指定各种升级参数并构建升级计划。">规划滚动升级</a> ”中所述</span> 。
                     </p>
                     <div class="tblformal" id="GUID-5652ED69-A95F-454A-9208-E2483B9A9BA6__CJAJCACI">
                        <p class="titleintable">表14-2使用DBMS_ROLLING执行滚动升级的步骤</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="使用DBMS_ROLLING执行滚动升级的步骤" width="100%" border="1" summary="This 3 column table lists the steps to perform rolling upgrade. Column 1 is the step number. Column 2 is a step description. Column 3 is the phase. " frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="9%" id="d36675e1532">步</th>
                                 <th align="left" valign="bottom" width="72%" id="d36675e1535">描述</th>
                                 <th align="left" valign="bottom" width="19%" id="d36675e1538">相</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d36675e1543" headers="d36675e1532 ">
                                    <p>步骤1</p>
                                 </td>
                                 <td align="left" valign="top" width="72%" headers="d36675e1543 d36675e1535 ">
                                    <p>调用<code class="codeph">DBMS_ROLLING.START_PLAN</code>过程以配置指定用于保护未来主数据库的未来主要和物理备用数据库。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36675e1543 d36675e1538 ">
                                    <p>开始</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d36675e1556" headers="d36675e1532 ">
                                    <p>第2步</p>
                                 </td>
                                 <td align="left" valign="top" width="72%" headers="d36675e1556 d36675e1535 ">
                                    <p>在未来的主数据库和备用数据库上备份Oracle数据库软件。</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36675e1556 d36675e1538 ">
                                    <p>开关待定</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d36675e1566" headers="d36675e1532 ">
                                    <p>第3步</p>
                                 </td>
                                 <td align="left" valign="top" width="72%" headers="d36675e1566 d36675e1535 ">
                                    <p>调用<code class="codeph">DBMS_ROLLING.SWITCHOVER</code>过程以在当前和未来主数据库之间切换角色。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36675e1566 d36675e1538 ">
                                    <p>开关</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d36675e1579" headers="d36675e1532 ">
                                    <p>第4步</p>
                                 </td>
                                 <td align="left" valign="top" width="72%" headers="d36675e1579 d36675e1535 ">
                                    <p>在较高版本的Oracle数据库上手动重新启动以前的主数据库和剩余的备用数据库。</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36675e1579 d36675e1538 ">
                                    <p>完成待定</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="9%" id="d36675e1589" headers="d36675e1532 ">
                                    <p>第5步</p>
                                 </td>
                                 <td align="left" valign="top" width="72%" headers="d36675e1589 d36675e1535 ">
                                    <p>调用<code class="codeph">DBMS_ROLLING.FINISH_PLAN</code>过程将前一主数据库转换为物理备用数据库，并配置剩余的备用数据库以恢复升级重做。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36675e1589 d36675e1538 ">
                                    <p>完</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>每个步骤中发生的活动属于滚动升级的特定阶段，如<a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-5652ED69-A95F-454A-9208-E2483B9A9BA6__CJAJCACI" title="此3列表列出了执行滚动升级的步骤。第1列是步骤编号。第2列是步骤说明。第3列是阶段。">表14-2</a>中的PHASE列所示。滚动升级操作在任何给定时间都处于单一阶段。滚动升级的当前阶段在<code class="codeph">DBA_ROLLING_STATUS</code>视图的<code class="codeph">PHASE</code>列中报告。
                     </p>
                     <p>本节的其余部分将详细介绍每个升级步骤。</p>
                     <ol>
                        <li>
                           <p>调用<code class="codeph">DBMS_ROLLING.START_PLAN</code>过程以配置指定用于保护未来主数据库的未来主要和物理备用数据库。
                           </p>
                           <p><code class="codeph">DBMS_ROLLING.START_PLAN</code>过程是滚动升级的正式开始。<code class="codeph">START_PLAN</code>过程的目标是配置临时逻辑备用数据库和已指定用于保护它的任何物理备用数据库。调用时， <code class="codeph">START_PLAN</code>过程将执行升级计划中的所有指令，其<code class="codeph">PHASE</code>值为<code class="codeph">START_PLAN</code> 。执行的指令类型包括：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>将每个数据库的控制文件备份到跟踪文件</p>
                              </li>
                              <li>
                                 <p>创建闪回数据库保证还原点</p>
                              </li>
                              <li>
                                 <p>在主数据库中构建LogMiner字典</p>
                              </li>
                              <li>
                                 <p>将指定的物理备用数据库恢复为临时逻辑备用数据库</p>
                              </li>
                              <li>
                                 <p>将LogMiner字典加载到逻辑备用数据库中</p>
                              </li>
                              <li>
                                 <p>使用临时逻辑备用数据库配置LGS数据库</p>
                              </li>
                           </ul>
                           <p>按如下方式调用<code class="codeph">START_PLAN</code>过程（不需要参数）：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.START_PLAN;</pre></li>
                        <li>
                           <p>在未来的主数据库和备用数据库上备份Oracle数据库软件。</p>
                           <p><code class="codeph">START_PLAN</code>过程完成后，您必须在将来的主数据库和备用数据库上手动升级Oracle数据库软件，以保护未来的主数据库。这涉及以下步骤：</p>
                           <ol type="a">
                              <li>
                                 <p>升级瞬态逻辑（LGM）和领导组备用（LGS）的Oracle数据库软件。</p>
                              </li>
                              <li>
                                 <p>在LGS数据库上启动介质恢复。</p>
                              </li>
                              <li>
                                 <p>手动或使用数据库升级助手（DBUA）升级临时逻辑备用数据库。</p>
                              </li>
                              <li>
                                 <p>在读/写模式下重新打开瞬态逻辑备用。</p>
                              </li>
                           </ol>
                           <p>瞬态逻辑备用数据库和LGS数据库是一个功能组。在升级瞬态逻辑备用数据库之前，必须在主动运行介质恢复的较高版本上重新启动LGS数据库。如果未首先配置LGS数据库，则不会保护瞬态逻辑的升级。在此步骤结束时，瞬态逻辑的升级完成，并且所有LGS数据库上都运行介质恢复。</p>
                           <p>建议您在执行切换之前等待所有LGS数据库完全升级。当<code class="codeph">DBA_ROLLING_DATABASES</code>视图中的关联记录在<code class="codeph">UPDATED</code>列中报告值为<code class="codeph">YES</code>时，LGS数据库将完全升级。
                           </p>
                        </li>
                        <li>
                           <p>调用<code class="codeph">DBMS_ROLLING.SWITCHOVER</code>过程以在当前和未来主数据库之间切换角色。
                           </p>
                           <p><code class="codeph">SWITCHOVER</code>过程在当前和未来的主数据库之间切换角色。当应用延迟最小时，该过程将切换发生，从而最小化主服务的中断时间。<code class="codeph">SWITCHOVER</code>过程执行升级计划中的所有指令，其<code class="codeph">PHASE</code>值为<code class="codeph">SWITCHOVER</code> 。执行的指令类型包括：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>等待当前处于暂态逻辑备用状态的领导组主（LGM）的应用延迟低于阈值</p>
                              </li>
                              <li>
                                 <p>等待LGS数据库的应用延迟低于阈值</p>
                              </li>
                              <li>
                                 <p>将主服务器切换到逻辑备用服务器角色</p>
                              </li>
                              <li>
                                 <p>将当前为逻辑备用的Leading Group Master（LGM）切换为主要角色</p>
                              </li>
                              <li>
                                 <p>在领导组主服务器（LGM）成为新主服务器之后启用日志存档目标</p>
                              </li>
                           </ul>
                           <p>按如下方式调用<code class="codeph">SWITCHOVER</code>过程（不需要参数）：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SWITCHOVER;</pre><p>如果在切换到主角色到备用角色之后但在瞬态逻辑可以成功转换为主角色之前发生切换错误，则继续执行前主站点上的<code class="codeph">SWITCHOVER</code>过程，直到成功完成。
                           </p>
                        </li>
                        <li>
                           <p>此时，您必须手动重新启动并在较高版本的Oracle数据库上装载以前的主数据库和剩余备用数据库。挂载备用数据库尤其重要，因为<code class="codeph">DBMS_ROLLING</code>包需要与备用数据库通信才能继续滚动升级。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">FINISH_PLAN</code>过程的总体目标是将以前的主要和TGP备用数据库配置为通过升级重做进行恢复的物理备用数据库。调用时， <code class="codeph">FINISH_PLAN</code>过程将执行升级计划中的所有指令，其<code class="codeph">PHASE</code>值为<code class="codeph">FINISH</code> 。执行的指令类型包括：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>前主要和TGP备用的闪回</p>
                              </li>
                              <li>
                                 <p>将前主数据库转换为物理备用数据库</p>
                              </li>
                              <li>
                                 <p>在新的重做分支上启动介质恢复</p>
                              </li>
                           </ul>
                           <p>按如下方式调用<code class="codeph">FINISH_PLAN</code>过程（不需要参数）：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.FINISH_PLAN;</pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="SBYDB5237"></a><div class="props_rev_3"><a id="GUID-A1348F5A-AFBC-4090-822F-23DF87CE7D3C" name="GUID-A1348F5A-AFBC-4090-822F-23DF87CE7D3C"></a><h3 id="SBYDB-GUID-A1348F5A-AFBC-4090-822F-23DF87CE7D3C" class="sect3"><span class="enumeration_section">14.6</span>监控滚动升级</h3>
               <div>
                  <p>您可以查询几个视图，以获取有关滚动升级所涉及的数据库的信息。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">DBA_ROLLING_STATUS</code></p>
                        <p>提供有关升级总体状态的信息。</p>
                     </li>
                     <li>
                        <p><code class="codeph">DBA_ROLLING_DATABASES</code></p>
                        <p>提供有关滚动升级中涉及的每个数据库的角色，保护和恢复状态的信息。</p>
                     </li>
                     <li>
                        <p><code class="codeph">DBA_ROLLING_STATISTICS</code></p>
                        <p>提供统计信息，例如开始和结束时间，服务脱机的时间等。</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-A1348F5A-AFBC-4090-822F-23DF87CE7D3C__GUID-408EC045-7E42-4C98-A440-84EE640E038F">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../refrn/about-static-data-dictionary-views.html#REFRN002" target="_blank"><span class="italic">Oracle Database Reference，</span></a>用于描述这些视图</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="SBYDB5238"></a><div class="props_rev_3"><a id="GUID-5B34621B-FABE-4C50-A2C0-ED249844934D" name="GUID-5B34621B-FABE-4C50-A2C0-ED249844934D"></a><h3 id="SBYDB-GUID-5B34621B-FABE-4C50-A2C0-ED249844934D" class="sect3"><span class="enumeration_section">14.7</span>回滚滚动升级</h3>
               <div>
                  <p>要回滚滚动升级过程，可以调用<code class="codeph">DBMS_ROLLING.ROLLBACK_PLAN</code>过程。
                  </p>
                  <div class="section">
                     <p>该过程调用如下：</p><pre class="oac_no_warn" dir="ltr">DBMS_ROLLING.ROLLBACK_PLAN;</pre><p><code class="codeph">ROLLBACK_PLAN</code>过程具有以下要求：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>只有先前未调用<code class="codeph">DBMS_ROLLING.SWITCHOVER</code>过程时，才能调用<code class="codeph">ROLLBACK_PLAN</code>过程。
                           </p>
                        </li>
                        <li>
                           <p>在使用<code class="codeph">ROLLBACK_PLAN</code>过程之前，必须将临时逻辑备用数据库设置回挂载状态，因为闪回数据库即将发生。
                           </p>
                        </li>
                        <li>
                           <p>如果Oracle数据库软件已升级，则必须在旧版本上重新启动生成的物理备用数据库，然后启动介质恢复。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="SBYDB5239"></a><div class="props_rev_3"><a id="GUID-1019E58C-1370-48A6-BC67-FA42074C0351" name="GUID-1019E58C-1370-48A6-BC67-FA42074C0351"></a><h3 id="SBYDB-GUID-1019E58C-1370-48A6-BC67-FA42074C0351" class="sect3"><span class="enumeration_section">14.8</span>处理滚动升级期间发生的角色更改</h3>
               <div>
                  <p>如果出现滚动升级的情况，并且您需要在转存完成之前在Oracle Data Guard配置中执行故障转移，则只能在这些情况下执行此操作。</p>
                  <p></p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">DBMS_ROLLING</code>过程正在进行时未执行故障转移。
                        </p>
                     </li>
                     <li>
                        <p>故障转移是在主数据库和物理备用数据库之间进行的，并且是无数据丢失的故障转移。</p>
                     </li>
                     <li>
                        <p>故障转移是在临时逻辑备用数据库和临时逻辑备用数据库的物理备用数据库之间进行的。</p>
                     </li>
                  </ul>
                  <p>角色更改是一个重大事件，它不可避免地使升级计划中的指令无效，升级计划是针对不同的配置而定制的。要恢复滚动升级，必须创建新计划。您必须设置<code class="codeph">FAILOVER</code>参数以指示配置已更改。在下次调用<code class="codeph">BUILD_PLAN</code>过程时检测此参数，并相应地修改现有计划。
                  </p>
                  <p>修改后的计划构建完成后，您可以恢复滚动升级。</p>
               </div>
            </div><a id="SBYDB5241"></a><a id="SBYDB5242"></a><a id="SBYDB5243"></a><a id="SBYDB5244"></a><a id="SBYDB5245"></a><a id="SBYDB5246"></a><a id="SBYDB5248"></a><a id="SBYDB5249"></a><a id="SBYDB5240"></a><div class="props_rev_3"><a id="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9" name="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9"></a><h3 id="SBYDB-GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9" class="sect3"><span class="enumeration_section">14.9</span>滚动升级的例子</h3>
               <div>
                  <p>这些示例显示了各种滚动升级方案。</p>
                  <p>在所有方案中的某些时刻，使用相同的基本滚动升级步骤。这些步骤如<a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAFHDDH">例14-5</a>所示。其余的示例在适当的情况下返回到此示例，而不是重复相同的步骤。
                  </p>
                  <p>本节中的一些示例指示您恢复滚动升级，这意味着您应该从上次停止的地方继续。恢复滚动升级涉及识别滚动升级的当前阶段并重新执行与阶段相关的PL / SQL过程或与阶段相关的活动。滚动升级的当前阶段显示在<code class="codeph">DBA_ROLLING_STATUS</code>视图的<code class="codeph">PHASE</code>列中。
                  </p>
                  <div class="infoboxnote" id="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__GUID-F3429155-7A78-4212-AE2D-2A53FDF36403">
                     <p class="notep1">注意：</p>
                     <p>本节中提供的方案仅用于假设示例。您可以使用滚动升级使用Oracle Active Data Guard功能从第一个Oracle Database 12 <span class="italic">c</span>补丁集开始执行数据库升级。
                     </p>
                  </div>
                  <div class="example" id="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAFHDDH">
                     <p class="titleinexample">示例14-5基本滚动升级步骤</p>
                     <ol>
                        <li>
                           <p>开始滚动升级：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.START_PLAN;</pre></li>
                        <li>
                           <p>升级瞬态逻辑备用数据库及其保护备用数据库。</p>
                           <ol type="a">
                              <li>
                                 <p>使用更高的Oracle数据库软件版本安装LGP备用数据库。</p>
                              </li>
                              <li>
                                 <p>在Leading Group Physicals（LGP）上启动媒体恢复。</p>
                              </li>
                              <li>
                                 <p>使用更高的Oracle数据库软件版本在升级模式下打开Leading Group Master（LGM），它是瞬态逻辑备用数据库。</p>
                              </li>
                              <li>
                                 <p>升级领先组主服务器（LGM），它是临时逻辑备用数据库，可手动或使用数据库升级助手（DBUA）。</p>
                              </li>
                              <li>
                                 <p>在读/写模式下重新启动Leading Group Master（LGM），它是瞬态逻辑备用。</p>
                              </li>
                           </ol>
                        </li>
                        <li>
                           <p>切换到领导组长（LGM）：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SWITCHOVER;</pre></li>
                        <li>
                           <p>重新启动尾随组中的数据库。这包括原始主数据库及其在尾随组（TGP）中的所有保护备用数据库。</p>
                           <ol type="a">
                              <li>
                                 <p>使用较高的Oracle数据库版本挂载前一个主数据库。</p>
                              </li>
                              <li>
                                 <p>使用更高的Oracle数据库版本安装以前主服务器的物理备用数据库。</p>
                              </li>
                           </ol>
                        </li>
                        <li>
                           <p>完成滚动升级：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.FINISH_PLAN;</pre></li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAEIFEB">
                     <p class="titleinexample">示例14-6两个数据库之间的滚动升级</p>
                     <p>以下示例演示了对包含主数据库和物理备用数据库的双站点配置的滚动升级。在这个例子中， <code class="codeph">seattle</code>是当前的主要，而<code class="codeph">boston</code>是未来的主要。<code class="codeph">seattle</code>数据库自动被选为尾随组主（TGM）并参与该操作。默认情况下，不需要为<code class="codeph">seattle</code>设置任何内容。
                     </p>
                     <ol>
                        <li>
                           <p>初始化升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.INIT_PLAN（future_primary =&gt;'boston'）;</pre></li>
                        <li>
                           <p>制定升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.BUILD_PLAN;</pre></li>
                        <li>
                           <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAFHDDH">按例14-5中</a>所述执行滚动升级。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJADBHHG">
                     <p class="titleinexample">示例14-7三个数据库之间的滚动升级</p>
                     <p>以下示例演示了对包含主数据库和两个物理备用数据库的三站点配置的滚动升级。在这个例子中， <code class="codeph">seattle</code>是主要的， <code class="codeph">boston</code>是未来的主要， <code class="codeph">oakland</code>是<code class="codeph">seattle</code>的物理待命。
                     </p>
                     <ol>
                        <li>
                           <p>初始化升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.INIT_PLAN（future_primary =&gt;'boston'）;</pre></li>
                        <li>
                           <p>制定升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.BUILD_PLAN;</pre></li>
                        <li>
                           <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAFHDDH">按例14-5中</a>所述执行滚动升级。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJABJIEI">
                     <p class="titleinexample">示例14-8四个数据库之间的滚动升级</p>
                     <p>以下示例演示了对包含主数据库和三个物理备用数据库的四站点配置的滚动升级。在这个例子中， <code class="codeph">seattle</code>是主要的数据库， <code class="codeph">boston</code>是未来的主要数据库， <code class="codeph">oakland</code>是<code class="codeph">seattle</code>的物理待命， <code class="codeph">atlanta</code>是<code class="codeph">boston</code>的物理待命。
                     </p>
                     <ol>
                        <li>
                           <p>初始化升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.INIT_PLAN（future_primary =&gt;'boston'）;</pre></li>
                        <li>
                           <p>将<code class="codeph">atlanta</code>配置为领导组中的备用数据库：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SET_PARAMETER（scope =&gt;'atlanta'，name =&gt;'member'，value =&gt;'leading'）;</pre></li>
                        <li>
                           <p>制定升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.BUILD_PLAN;</pre></li>
                        <li>
                           <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAFHDDH">按例14-5中</a>所述执行滚动升级。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAJFJDE">
                     <p class="titleinexample">示例14-9 Reader Farm上的滚动升级</p>
                     <p>以下示例演示了由一个主数据库和九个物理备用数据库组成的阅读器服务器场配置的滚动升级。在此示例中，八个物理备用数据库分为两组，每组四个，以便在切换之前和之后作为Oracle Active Data Guard备用数据库提供物理备用数据库。在这个例子中， <code class="codeph">seattle</code>是主要的， <code class="codeph">boston</code>是未来的主要，数据库<code class="codeph">rf[ad]</code>是<code class="codeph">seattle</code>实际备用数据库，数据库<code class="codeph">rf[eh]</code>是<code class="codeph">boston</code>实际备用数据库。已配置滚动升级，以便切换到新主服务器等待，直到未来主数据库的读取器服务器组之间的应用延迟小于60秒。
                     </p>
                     <ol>
                        <li>
                           <p>初始化升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.INIT_PLAN（future_primary =&gt;'boston'）;</pre></li>
                        <li>
                           <p>配置读取器场组以保护未来的主要组：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SET_PARAMETER（scope =&gt;'rfe'，name =&gt;'member'，value =&gt;'leading'）;</pre><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SET_PARAMETER（scope =&gt;'rff'，name =&gt;'member'，value =&gt;'leading'）;</pre><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SET_PARAMETER（scope =&gt;'rfg'，name =&gt;'member'，value =&gt;'leading'）;</pre><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SET_PARAMETER（scope =&gt;'rfh'，name =&gt;'member'，value =&gt;'leading'）;</pre></li>
                        <li>
                           <p>在未来的主要读者服务器场上设置最大允许应用延迟60秒：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SET_PARAMETER（name =&gt;'SWITCH_LGS_LAG_WAIT'，value =&gt;'1'）;</pre></li>
                        <li>
                           <p>制定升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.BUILD_PLAN;</pre></li>
                        <li>
                           <p><a href="using-DBMS_ROLLING-to-perform-rolling-upgrade.html#GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAFHDDH">按例14-5中</a>所述执行滚动升级。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAHAJDD">
                     <p class="titleinexample">示例14-10应用程序测试的滚动升级</p>
                     <p>以下示例演示如何在四站点配置上使用滚动升级来配置临时逻辑备用数据库和瞬态逻辑备用数据库的物理数据库，以验证更高版本数据库上的应用程序。主要数据库是<code class="codeph">seattle</code> ， <code class="codeph">boston</code>是未来的主要数据库， <code class="codeph">oakland</code>是<code class="codeph">seattle</code>的物理待命， <code class="codeph">atlanta</code>是<code class="codeph">boston</code>物理待命。所以在这个例子中， <code class="codeph">seattle</code>和<code class="codeph">oakland</code>组成了尾随组，而<code class="codeph">boston</code>和<code class="codeph">atlanta</code>组成了领先组。在测试结束时， <code class="codeph">boston</code>和<code class="codeph">atlanta</code>恢复到原来的物理待命角色，以恢复对<code class="codeph">seattle</code>保护。
                     </p>
                     <ol>
                        <li>
                           <p>初始化升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.INIT_PLAN（future_primary =&gt;'boston'）;</pre></li>
                        <li>
                           <p>配置<code class="codeph">atlanta</code>以保护未来的主要：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SET_PARAMETER（scope =&gt;'atlanta'，name =&gt;'member'，value =&gt;'leading'）;</pre></li>
                        <li>
                           <p>制定升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.BUILD_PLAN;</pre></li>
                        <li>
                           <p>开始滚动升级：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.START_PLAN;</pre></li>
                        <li>
                           <p>升级<code class="codeph">boston</code>和<code class="codeph">atlanta</code> ：</p>
                           <ol type="a">
                              <li>
                                 <p>使用更高的数据库版本安装<code class="codeph">atlanta</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>在<code class="codeph">atlanta</code>开始恢复媒体。
                                 </p>
                              </li>
                              <li>
                                 <p>使用更高的数据库版本在升级模式下打开<code class="codeph">boston</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>手动或使用数据库升级助手（DBUA）升级数据库<code class="codeph">boston</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>以读/写模式重新启动<code class="codeph">boston</code> 。
                                 </p>
                              </li>
                           </ol>
                        </li>
                        <li>
                           <p>必要时测试应用程序。</p>
                        </li>
                        <li>
                           <p>回滚配置：</p>
                           <ol type="a">
                              <li>
                                 <p>以挂载模式重启<code class="codeph">boston</code></p>
                              </li>
                              <li>
                                 <p>回滚升级：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.ROLLBACK_PLAN;</pre></li>
                           </ol>
                        </li>
                        <li>
                           <p>使用旧版数据库版本在<code class="codeph">boston</code>和<code class="codeph">atlanta</code>上启动媒体恢复：</p>
                           <ol type="a">
                              <li>
                                 <p>使用较低的数据库版本安装<code class="codeph">boston</code>和<code class="codeph">atlanta</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>在<code class="codeph">boston</code>和<code class="codeph">atlanta</code>开始恢复媒体。
                                 </p>
                              </li>
                           </ol>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAEDBEF">
                     <p class="titleinexample">示例14-11故障转移到新主节点后恢复滚动升级</p>
                     <p>以下示例演示了物理备机到主要角色的无数据丢失故障转移，然后是在三站点配置上重新配置滚动升级计划。在这个例子中， <code class="codeph">seattle</code>是主要的， <code class="codeph">boston</code>是未来的主要， <code class="codeph">oakland</code>是<code class="codeph">seattle</code>的物理待命。数据库<code class="codeph">oakland</code>失败了成为新的主要。（尾随组是（ <code class="codeph">seattle</code> ， <code class="codeph">oakland</code> ），领导小组是<code class="codeph">boston</code> 。）
                     </p>
                     <p></p>
                     <ol>
                        <li>
                           <p>恢复<code class="codeph">oakland</code>剩余重做，并故障转移到新的主要角色：</p><pre class="pre codeblock"><code>SQL&gt; ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL; SQL&gt; ALTER DATABASE RECOVER MANAGED STANDBY FINISH; SQL&gt; ALTER DATABASE FAILOVER TO OAKLAND; SQL&gt; ALTER DATABASE OPEN;</code></pre></li>
                        <li>
                           <p>根据需要在<code class="codeph">oakland</code>上配置日志归档目标：</p><pre class="pre codeblock"><code>SQL&gt; ALTER SYSTEM SET LOG_ARCHIVE_DEST_2 ='service =“boston”reopen = 5 2 LGWR ASYNC NET_TIMEOUT = 180 valid_for =（ONLINE_LOGFILE，PRIMARY_ROLE）3 DB_UNIQUE_NAME =“oakland”';</code></pre><pre class="pre codeblock"><code>SQL&gt; ALTER SYSTEM ARCHIVE LOG CURRENT;</code></pre></li>
                        <li>
                           <p>设置一个参数以指示发生故障转移：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SET_PARAMETER（name =&gt;'failover'，value =&gt;'1'）;</pre></li>
                        <li>
                           <p>修改升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.BUILD_PLAN;</pre></li>
                        <li>
                           <p>恢复滚动升级。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-3D3BDB04-0981-4E3A-88FD-B1C0B9BDD0E9__CJAHBCBH">
                     <p class="titleinexample">示例14-12故障转移到新的瞬态逻辑后恢复滚动升级</p>
                     <p>以下示例演示了物理备用数据库故障转移到临时逻辑角色，然后在五站点配置上重新配置滚动升级计划。在这个例子中， <code class="codeph">seattle</code>是主， <code class="codeph">boston</code>是未来伯， <code class="codeph">oakland</code>是物理备用<code class="codeph">seattle</code> ，和<code class="codeph">atlanta</code>和<code class="codeph">miami</code>是物理备用<code class="codeph">boston</code> 。数据库<code class="codeph">atlanta</code>故障转移成为新的瞬态逻辑备用数据库。
                     </p>
                     <ol>
                        <li>
                           <p>回收残留在重做<code class="codeph">atlanta</code>和故障转移到新的临时逻辑的作用：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE RECOVER MANAGED STANDBY FINISH; SQL&gt; ALTER DATABASE ACTIVATE STANDBY DATABASE; SQL&gt; ALTER DATABASE OPEN;</pre></li>
                        <li>
                           <p>根据需要在<code class="codeph">atlanta</code>上配置日志归档目标：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter system set log_archive_dest_2 ='service =“seattle”reopen = 5 2 LGWR ASYNC NET_TIMEOUT = 180 valid_for =（ONLINE_LOGFILE，PRIMARY_ROLE）3 DB_UNIQUE_NAME =“atlanta”'; SQL&gt; alter system set log_archive_dest_3 ='service =“oakland”reopen = 5 2 LGWR ASYNC NET_TIMEOUT = 180 valid_for =（ONLINE_LOGFILE，PRIMARY_ROLE）3 DB_UNIQUE_NAME =“atlanta”'; SQL&gt; alter system set log_archive_dest_4 ='service =“miami”reopen = 5 2 LGWR ASYNC NET_TIMEOUT = 180 valid_for =（ONLINE_LOGFILE，ALL_ROLES）3 DB_UNIQUE_NAME =“atlanta”';</pre></li>
                        <li>
                           <p>将<code class="codeph">atlanta</code>指定为新的临时逻辑备用数据库：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.SET_PARAMETER（name =&gt;'failover'，value =&gt;'1'）;</pre></li>
                        <li>
                           <p>修改升级计划：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE DBMS_ROLLING.BUILD_PLAN;</pre></li>
                        <li>
                           <p>恢复滚动升级。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="example" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="04102.client-side-security.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>JDBC客户端安全功能</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="JDBC Developer&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="JDBC Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="jdbc-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-13T13:20:37-08:00"></meta>
      <meta name="dcterms.title" content="JDBC Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96471-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="data-sources-and-URLs.html" title="Previous" type="text/html"></link>
      <link rel="next" href="proxy-authentication.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="JJDBC"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="data-sources-and-URLs.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="proxy-authentication.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JDBC开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="connection-and-security.html" property="item" typeof="WebPage"><span property="name">连接和安全</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">JDBC客户端安全功能</li>
            </ol>
            <a id="GUID-45DF369A-3C7E-4D4F-8432-B8A44961DC58" name="GUID-45DF369A-3C7E-4D4F-8432-B8A44961DC58"></a><a id="JJDBC28295"></a>
            
            <h2 id="JJDBC-GUID-45DF369A-3C7E-4D4F-8432-B8A44961DC58" class="sect2"><span class="enumeration_chapter">9</span> JDBC客户端安全功能</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章讨论Oracle Java数据库连接（JDBC）Oracle调用接口（OCI）和JDBC Thin驱动程序中的支持，用于登录身份验证，数据加密和数据完整性，特别是有关Oracle Advanced Security选项功能的支持。</p>
               <div class="infoboxnote" id="GUID-45DF369A-3C7E-4D4F-8432-B8A44961DC58__GUID-217B2316-B4E6-4926-81DB-22DD13AE7804">
                  <p class="notep1">注意：</p>
                  <p>此讨论与服务器端内部驱动程序无关，因为通过服务器端内部驱动程序的所有通信都完全在服务器内部。</p>
               </div>
               <p>Oracle Advanced Security（以前称为高级网络选件（ANO）或高级安全选件（ASO））提供基于行业标准的数据加密，数据完整性，第三方身份验证，单点登录和访问授权。从Oracle Database <span class="italic">11g</span>第1版开始，JDBC OCI和JDBC Thin驱动程序都支持所有Oracle Advanced Security功能。
               </p>
               <div class="infoboxnote" id="GUID-45DF369A-3C7E-4D4F-8432-B8A44961DC58__GUID-6A1D5CA2-12E4-4B6F-85C2-6ECB259413D6">
                  <p class="notep1">注意：</p>
                  <p>如果要使用JDBC <code class="codeph">ojdbc.policy</code>的安全策略文件，则可以从以下链接下载该文件：</p>
                  <p><a href="http://www.oracle.com/technetwork/index.html" target="_blank">http://www.oracle.com/technetwork/index.html</a></p>
                  <p><code class="codeph">ojdbc.policy</code>文件包含在Java安全管理器的控制环境中运行应用程序所需的已授予权限。您可以将此文件本身用作Java策略文件，也可以从此文件获取内容并在Java策略文件中添加内容。此文件包含以下权限：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>一些始终需要的强制权限，例如，权限<code class="codeph">java.util.PropertyPermission“user.name”，“read”;</code></p>
                     </li>
                     <li>
                        <p>一些特定于驱动程序的权限，例如，JDBC OCI驱动程序需要权限<code class="codeph">java.lang.RuntimePermission“loadLibrary.ocijdbc12”;</code></p>
                     </li>
                     <li>
                        <p>一些基于功能的权限，例如，与XA，XDB，FCF等相关的权限</p>
                     </li>
                  </ul>
                  <p>您可以根据需要设置文件中提到的系统属性或权限的直接值。</p>
               </div>
               <p>本章包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="client-side-security.html#GUID-8010464D-A3E9-49AC-98FD-F588A0C2EE9B">支持Oracle Advanced Security</a></p>
                  </li>
                  <li>
                     <p><a href="client-side-security.html#GUID-14F188F6-C9EA-4B4C-A8A4-2C4FDFD94F35">支持登录验证</a></p>
                  </li>
                  <li>
                     <p><a href="client-side-security.html#GUID-6EB42556-EEB8-44BD-AB74-A37778C02B0F">支持强身份验证</a></p>
                  </li>
                  <li>
                     <p><a href="client-side-security.html#GUID-42C16CD9-62D3-4141-BB38-015627A49079">支持数据加密和完整性</a></p>
                  </li>
                  <li>
                     <p><a href="client-side-security.html#GUID-2BD2F189-A58C-4A85-8524-CFD9BB9AC575">支持SSL</a></p>
                  </li>
                  <li>
                     <p><a href="client-side-security.html#GUID-97E88D18-B590-4313-87B8-EE422DA644B3">支持Kerberos</a></p>
                  </li>
                  <li>
                     <p><a href="client-side-security.html#GUID-5748543A-EA85-4263-93C8-A79B2D5DBB8C">支持RADIUS</a></p>
                  </li>
                  <li>
                     <p><a href="client-side-security.html#GUID-4DED9706-6735-4786-B70C-4D35C8DFE9E5">关于安全外部密码存储</a></p>
                  </li>
               </ul>
            </div><a id="JJDBC28296"></a><div class="props_rev_3"><a id="GUID-8010464D-A3E9-49AC-98FD-F588A0C2EE9B" name="GUID-8010464D-A3E9-49AC-98FD-F588A0C2EE9B"></a><h3 id="JJDBC-GUID-8010464D-A3E9-49AC-98FD-F588A0C2EE9B" class="sect3"><span class="enumeration_section">9.1</span>支持Oracle Advanced Security</h3>
               <div>
                  <p>本节介绍以下概念：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="client-side-security.html#GUID-66534F91-8FDB-4572-A9C4-DD61BB985E04">Oracle Advanced Security概述</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-25BFBE7B-E808-4DB3-87F5-EEA9B94D8068">JDBC OCI驱动程序支持Oracle Advanced Security</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-A534B437-7F9F-488E-B8D6-51334294FB3F">JDBC精简驱动程序支持Oracle Advanced Security</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-66534F91-8FDB-4572-A9C4-DD61BB985E04" name="GUID-66534F91-8FDB-4572-A9C4-DD61BB985E04"></a><h4 id="JJDBC-GUID-66534F91-8FDB-4572-A9C4-DD61BB985E04" class="sect4"><span class="enumeration_section">9.1.1</span> Oracle Advanced Security概述</h4>
                  <div>
                     <p>Oracle Advanced Security提供以下安全功能：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>数据加密</p>
                           <p>通过使用加密算法可以保护通过企业网络和因特网传送的敏感信息，加密算法将信息转换为只能用解密密钥解密的形式。一些支持的加密算法是RC4，DES，3DES和AES。</p>
                           <p>为确保传输过程中的数据完整性，Oracle Advanced Security会生成加密安全的消息摘要。从Oracle Database <span class="italic">12c</span>第1版（12.1）开始，还支持SHA-2散列算法列表，Oracle Advanced Security使用以下散列算法生成安全消息摘要，并将其包含在通过网络发送的每条消息中。
                           </p>
                           <p>这可以保护传输的数据免受攻击，例如数据修改，删除的数据包和重放攻击。</p>
                           <p>以下代码段显示了如何使用前面提到的任何算法计算校验和：</p><pre class="oac_no_warn" dir="ltr">prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_CHECKSUM_TYPES，“（SHA1）”）; prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_CHECKSUM_LEVEL，“REQUIRED”）;</pre></li>
                        <li>
                           <p>强认证</p>
                           <p>为确保分布式环境中的网络安全，必须对用户进行身份验证并检查其凭据。密码验证是最常用的验证方式。Oracle数据库支持对Oracle身份验证适配器进行强身份验证，后者支持各种第三方身份验证服务，包括带有数字证书的SSL。Oracle数据库支持以下行业标准身份验证方法：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>Kerberos的</p>
                              </li>
                              <li>
                                 <p>远程身份验证拨入用户服务（RADIUS）</p>
                              </li>
                              <li>
                                 <p>安全套接字层（SSL）</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-66534F91-8FDB-4572-A9C4-DD61BB985E04__GUID-D9CB3DC4-A47A-4F4D-AECB-90D1C873BF2D">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../dbseg/introduction-to-oracle-database-security.html#DBSEG001" target="_blank"><span class="italic">Oracle数据库安全指南</span></a></p>
                     </div>
                  </div>
               </div><a id="JJDBC28301"></a><a id="JJDBC28299"></a><div class="props_rev_3"><a id="GUID-25BFBE7B-E808-4DB3-87F5-EEA9B94D8068" name="GUID-25BFBE7B-E808-4DB3-87F5-EEA9B94D8068"></a><h4 id="JJDBC-GUID-25BFBE7B-E808-4DB3-87F5-EEA9B94D8068" class="sect4"><span class="enumeration_section">9.1.2</span> Oracle OCI驱动程序支持Oracle Advanced Security</h4>
                  <div>
                     <div class="section">
                        <p>如果您使用的是JDBC OCI驱动程序（假设您从安装了Oracle客户端的计算机上运行），那么对Oracle Advanced Security和所包含的第三方功能的支持与任何Oracle客户端情况下提供的支持非常相似。您对高级安全性功能的使用由客户端计算机上<code class="codeph">sqlnet.ora</code>文件中的相关设置决定。
                        </p>
                        <div class="infoboxnote" id="GUID-25BFBE7B-E808-4DB3-87F5-EEA9B94D8068__GUID-549895DA-B7B7-48F3-8728-A624309275AD">
                           <p class="notep1">注意：</p>
                           <p>从Oracle Database 12 <span class="italic">c</span>第1版（12.1）开始，Oracle建议您使用新XML配置文件<code class="codeph">oraaccess.xml</code>中的配置参数，而不是<code class="codeph">sqlnet.ora</code>文件中存在的OCI特定配置参数。但是，仍支持<code class="codeph">sqlnet.ora</code>文件中存在的配置参数。
                           </p>
                        </div>
                        <p>从Oracle Database <span class="italic">11g</span>第1版开始，如果尝试在不提供密码的情况下连接到数据库，则JDBC OCI驱动程序会尝试使用外部身份验证。以下是使用JDBC OCI驱动程序连接到数据库而不提供密码的一些示例：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-25BFBE7B-E808-4DB3-87F5-EEA9B94D8068__GUID-BE8916EC-CAE7-41C5-8750-7B9AC8473277">SSL身份验证</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>以下代码段显示了如何使用SSL身份验证连接到数据库：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-25BFBE7B-E808-4DB3-87F5-EEA9B94D8068__CIHDEFCI">
                        <p class="titleinexample">示例9-1使用SSL身份验证连接到数据库</p><pre class="oac_no_warn" dir="ltr">import java.sql。*; import java.util。性能; public class test {public static void main（String [] args）throws Exception {String url =“jdbc：oracle：oci：@”+“（DESCRIPTION =（ADDRESS =（PROTOCOL = tcps）（HOST = localhost）（PORT = 5221））“+”（CONNECT_DATA =（SERVICE_NAME = orcl）））“;驱动程序驱动程序=新的oracle.jdbc。一个OracleDriver（）;属性props = new Properties（）; Connection conn = driver.connect（url，props）; conn.close（）; }}</pre></div>
                     <!-- class="example" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-25BFBE7B-E808-4DB3-87F5-EEA9B94D8068__GUID-1707D98A-0931-4D04-B502-C8FCF0EF56E5">使用数据源</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>以下代码段显示了如何使用数据源连接到数据库：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-25BFBE7B-E808-4DB3-87F5-EEA9B94D8068__CIHHIJEA">
                        <p class="titleinexample">示例9-2使用数据源连接到数据库</p><pre class="oac_no_warn" dir="ltr">import java.sql。*; import javax.sql。*; import java.util。性能; import oracle.jdbc.pool。*; public class testpool {public static void main（String args）throws Exception {String url =“jdbc：oracle：oci：@”+“（DESCRIPTION =（ADDRESS =（PROTOCOL = tcps）（HOST = localhost）（PORT = 5221） ）“+”（CONNECT_DATA =（SERVICE_NAME = orcl）））“; OracleConnectionPoolDataSource ocpds = new OracleConnectionPoolDataSource（）; ocpds.setURL（URL）; PooledConnection pc = ocpds.getPooledConnection（）;连接conn = pc.getConnection（）; }}</pre></div>
                     <!-- class="example" -->
                     <div class="section">
                        <div class="infoboxnote" id="GUID-25BFBE7B-E808-4DB3-87F5-EEA9B94D8068__GUID-9F5ABDDE-FC93-4A2F-8AB0-AFCC1BADD0F8">
                           <p class="notep1">注意：</p>
                           <p>前面关于Java的关键例外是，只有在应用程序中使用本机线程时，Oracle JDBC OCI驱动程序才支持安全套接字层（SSL）协议。这需要特别注意，因为绿色线程通常是默认的。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-A534B437-7F9F-488E-B8D6-51334294FB3F" name="GUID-A534B437-7F9F-488E-B8D6-51334294FB3F"></a><h4 id="JJDBC-GUID-A534B437-7F9F-488E-B8D6-51334294FB3F" class="sect4"><span class="enumeration_section">9.1.3</span>对Oracle Advanced Security的JDBC瘦驱动程序支持</h4>
                  <div>
                     <div class="section">
                        <p>JDBC Thin驱动程序不能假定存在Oracle客户端安装或存在<code class="codeph">sqlnet.ora</code>文件。因此，它使用Java方法来支持Oracle Advanced Security。实现Oracle Advanced Security的Java类包含在<code class="codeph">ojdbc6.jar</code>和<code class="codeph">ojdbc7.jar</code>文件中。通常在<code class="codeph">sqlnet.ora</code>文件中设置的加密和完整性的安全性参数是使用Java <code class="codeph">Properties</code>对象或系统属性设置的。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="JJDBC28303"></a><div class="props_rev_3"><a id="GUID-14F188F6-C9EA-4B4C-A8A4-2C4FDFD94F35" name="GUID-14F188F6-C9EA-4B4C-A8A4-2C4FDFD94F35"></a><h3 id="JJDBC-GUID-14F188F6-C9EA-4B4C-A8A4-2C4FDFD94F35" class="sect3"><span class="enumeration_section">9.2</span>支持登录验证</h3>
               <div>
                  <p>通过JDBC进行的基本登录验证由用户名和密码组成，与登录Oracle服务器的任何其他方式一样。通过Java属性对象或直接通过<code class="codeph">getConnection</code>方法调用指定用户名和密码。无论您使用哪个客户端Oracle JDBC驱动程序，这都适用，但如果您使用服务器端内部驱动程序（使用特殊的直接连接并且不需要用户名或密码）则无关紧要。
                  </p>
                  <p>从Oracle Database 12 <span class="italic">c</span>第1版（12.1.0.2）开始，当您使用JDK（例如支持<code class="codeph">PBKDF2-SHA2</code>算法的JDK）运行应用程序时，Oracle JDBC Thin驱动程序支持<code class="codeph">O7L_MR</code>客户端功能。如果您使用JDK 7运行应用程序，则必须添加支持<code class="codeph">PBKDF2-SHA2</code>算法的第三方安全提供程序，否则驱动程序将不支持需要<code class="codeph">O7L_MR</code>客户端功能的新<code class="codeph">12a</code>密码验证程序。
                  </p>
                  <p>如果您使用Oracle Database 12 <span class="italic">c</span>第1版（12.1.0.2）并将<code class="codeph">SQLNET.ALLOWED_LOGON_VERSION_SERVER</code>参数设置为<code class="codeph">12a</code> ，那么请记住以下几点：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>您还必须将12.1.0.2 Oracle JDBC Thin驱动程序和JDK 8或JDK 7与支持<code class="codeph">PBKDF2-SHA2</code>算法的第三方安全提供程序一起使用</p>
                     </li>
                     <li>
                        <p>如果使用早期版本的Oracle JDBC Thin驱动程序，则会出现以下错误：</p><pre class="oac_no_warn" dir="ltr">ORA-28040：没有匹配的身份验证协议</pre></li>
                     <li>
                        <p>如果您将12.1.0.2 Oracle JDBC Thin驱动程序与JDK 7一起使用，那么如果您不添加支持<code class="codeph">PBKDF2-SHA2</code>算法的第三方安全提供程序，您也会收到相同的错误。
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="JJDBC28304"></a><div class="props_rev_3"><a id="GUID-6EB42556-EEB8-44BD-AB74-A37778C02B0F" name="GUID-6EB42556-EEB8-44BD-AB74-A37778C02B0F"></a><h3 id="JJDBC-GUID-6EB42556-EEB8-44BD-AB74-A37778C02B0F" class="sect3"><span class="enumeration_section">9.3</span>支持强身份验证</h3>
               <div>
                  <p>Oracle Advanced Security使Oracle数据库用户能够在外部进行身份验证。外部身份验证可以使用RADIUS，Kerberos，基于证书的身份验证，令牌卡和智能卡。这称为强身份验证。Oracle JDBC驱动程序支持以下强身份验证方法：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Kerberos的</p>
                     </li>
                     <li>
                        <p>半径</p>
                     </li>
                     <li>
                        <p>SSL（基于证书的身份验证）</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-6EB42556-EEB8-44BD-AB74-A37778C02B0F__GUID-7DAE99B2-C4B5-4678-A29D-22A3C6C46C74">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../netrf/index.html" target="_blank"><span><cite>Oracle数据库网络服务参考</cite></span></a></p>
                  </div>
               </div>
            </div><a id="JJDBC28309"></a><div class="props_rev_3"><a id="GUID-42C16CD9-62D3-4141-BB38-015627A49079" name="GUID-42C16CD9-62D3-4141-BB38-015627A49079"></a><h3 id="JJDBC-GUID-42C16CD9-62D3-4141-BB38-015627A49079" class="sect3"><span class="enumeration_section">9.4</span>支持数据加密和完整性</h3>
               <div>
                  <p>本节介绍以下概念：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="client-side-security.html#GUID-1E6AF182-44C3-4CFE-8DA9-2735A651E4B3">JDBC支持数据加密和完整性概述</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-DA1DB155-D904-4D6D-9376-C499BF6EFC61">JDBC OCI驱动程序支持加密和完整性</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-D04ABE6D-2529-4C60-9EDD-3A966B43ECFB">JDBC瘦驱动程序支持加密和完整性</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-0B53FC61-E77F-4CE3-BF27-17B249A1CD7B">在Java中设置加密和完整性参数</a></p>
                     </li>
                  </ul>
               </div><a id="JJDBC28310"></a><div class="props_rev_3"><a id="GUID-1E6AF182-44C3-4CFE-8DA9-2735A651E4B3" name="GUID-1E6AF182-44C3-4CFE-8DA9-2735A651E4B3"></a><h4 id="JJDBC-GUID-1E6AF182-44C3-4CFE-8DA9-2735A651E4B3" class="sect4"><span class="enumeration_section">9.4.1</span>数据加密和完整性的JDBC支持概述</h4>
                  <div>
                     <p>您可以在Java数据库应用程序中使用Oracle数据库和Oracle Advanced Security数据加密和完整性功能，具体取决于服务器中的相关设置。使用JDBC OCI驱动程序时，请像在任何Oracle客户端情况中一样设置参数。使用Thin驱动程序时，请通过Java属性对象设置参数。</p>
                     <p>基于客户端加密级别设置和服务器端加密级别设置的组合启用或禁用加密。同样，基于客户端完整性级别设置和服务器端完整性级别设置的组合，启用或禁用完整性。</p>
                     <p>加密和完整性支持相同的设置级别， <code class="codeph">REJECTED</code> ， <code class="codeph">ACCEPTED</code> ， <code class="codeph">REQUESTED</code>和<code class="codeph">REQUIRED</code> 。 <a href="client-side-security.html#GUID-1E6AF182-44C3-4CFE-8DA9-2735A651E4B3__G1029740" title="表">表9-1</a>显示了客户端和服务器端的这些可能设置如何组合以启用或禁用该功能。默认情况下，出于安全原因，在数据库中禁用远程OS身份验证（通过TCP）。
                     </p>
                     <div class="tblformal" id="GUID-1E6AF182-44C3-4CFE-8DA9-2735A651E4B3__G1029740">
                        <p class="titleintable">表9-1加密或完整性的客户端/服务器协商</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="加密或完整性的客户端/服务器协商" width="100%" border="1" summary="table" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="25%" id="d36818e580">客户端/服务器设置矩阵</th>
                                 <th align="left" valign="bottom" width="19%" id="d36818e582">客户拒绝</th>
                                 <th align="left" valign="bottom" width="19%" id="d36818e585">客户接受（默认）</th>
                                 <th align="left" valign="bottom" width="19%" id="d36818e588">客户要求</th>
                                 <th align="left" valign="bottom" width="19%" id="d36818e591">客户要求</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d36818e596" headers="d36818e580 ">
                                    <p><span class="bold">服务器被拒绝</span></p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e596 d36818e582 ">
                                    <p>关闭</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e596 d36818e585 ">
                                    <p>关闭</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e596 d36818e588 ">
                                    <p>关闭</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e596 d36818e591 ">
                                    <p>连接失败</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d36818e613" headers="d36818e580 ">
                                    <p><span class="bold">服务器已接受（默认）</span></p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e613 d36818e582 ">
                                    <p>关闭</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e613 d36818e585 ">
                                    <p>关闭</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e613 d36818e588 ">
                                    <p>上</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e613 d36818e591 ">
                                    <p>上</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d36818e630" headers="d36818e580 ">
                                    <p><span class="bold">服务器请求</span></p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e630 d36818e582 ">
                                    <p>关闭</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e630 d36818e585 ">
                                    <p>上</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e630 d36818e588 ">
                                    <p>上</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e630 d36818e591 ">
                                    <p>上</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="25%" id="d36818e647" headers="d36818e580 ">
                                    <p><span class="bold">服务器必需</span></p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e647 d36818e582 ">
                                    <p>连接失败</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e647 d36818e585 ">
                                    <p>上</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e647 d36818e588 ">
                                    <p>上</p>
                                 </td>
                                 <td align="left" valign="top" width="19%" headers="d36818e647 d36818e591 ">
                                    <p>上</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>例如， <a href="client-side-security.html#GUID-1E6AF182-44C3-4CFE-8DA9-2735A651E4B3__G1029740" title="表">表9-1</a>显示，如果客户端请求加密但服务器拒绝加密，则会禁用加密。诚信也是如此。作为另一个示例，如果客户端接受加密并且服务器请求加密，则启用加密。诚信也是如此。
                     </p>
                     <div class="infoboxnotealso" id="GUID-1E6AF182-44C3-4CFE-8DA9-2735A651E4B3__GUID-ECD5B2DB-CECF-4527-A5E7-CB9BF44D4372">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关透明数据加密（TDE）的详细信息，请参见<a href="../asoag/asopart1.html#ASOAG600" target="_blank"><span class="italic">“Oracle数据库高级安全指南”</span></a></p>
                           </li>
                           <li>
                              <p>有关数据加密和完整性功能的更多信息，请参阅<a href="../dbseg/manually-encrypting-data.html#DBSEG008" target="_blank"><span class="italic">“Oracle数据库安全指南”</span></a> ，TDE除外</p>
                           </li>
                        </ul>
                     </div>
                     <div class="infoboxnote" id="GUID-1E6AF182-44C3-4CFE-8DA9-2735A651E4B3__GUID-E130A8E2-9145-449D-BA38-DFD28912EE2B">
                        <p class="notep1">注意：</p>
                        <p>术语校验和仍显示在完整性参数名称中，但不再使用。对于所有意图和目的，校验和和完整性是同义词。</p>
                     </div>
                  </div>
               </div><a id="JJDBC28312"></a><a id="JJDBC28311"></a><div class="props_rev_3"><a id="GUID-DA1DB155-D904-4D6D-9376-C499BF6EFC61" name="GUID-DA1DB155-D904-4D6D-9376-C499BF6EFC61"></a><h4 id="JJDBC-GUID-DA1DB155-D904-4D6D-9376-C499BF6EFC61" class="sect4"><span class="enumeration_section">9.4.2</span> JDBC OCI驱动程序支持加密和完整性</h4>
                  <div>
                     <div class="section">
                        <p>如果您正在使用JDBC OCI驱动程序（假设Oracle客户端设置与Oracle客户端安装），那么您可以通过<code class="codeph">sqlnet.ora</code>设置启用或禁用数据加密或完整性并设置相关参数，就像在任何Oracle客户端情况中一样客户端上的<code class="codeph">sqlnet.ora</code>文件。
                        </p>
                        <div class="infoboxnote" id="GUID-DA1DB155-D904-4D6D-9376-C499BF6EFC61__GUID-2A6EC828-983A-45F9-9D64-73A0626089B7">
                           <p class="notep1">注意：</p>
                           <p>从Oracle Database 12 <span class="italic">c</span>第1版（12.1）开始，Oracle建议您使用新XML配置文件<code class="codeph">oraaccess.xml</code>中的配置参数，而不是<code class="codeph">sqlnet.ora</code>文件中存在的OCI特定配置参数。但是，仍支持<code class="codeph">sqlnet.ora</code>文件中存在的配置参数。
                           </p>
                        </div>
                        <p>总而言之，客户端参数如<a href="client-side-security.html#GUID-DA1DB155-D904-4D6D-9376-C499BF6EFC61__G1029876" title="表">表9-2</a>所示：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformalwide" id="GUID-DA1DB155-D904-4D6D-9376-C499BF6EFC61__G1029876">
                        <p class="titleintable">表9-2加密和完整性的OCI驱动程序客户端参数</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="用于加密和完整性的OCI驱动程序客户端参数" width="100%" border="1" summary="table" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="29%" id="d36818e764">参数说明</th>
                                 <th align="left" valign="bottom" width="51%" id="d36818e767">参数名称</th>
                                 <th align="left" valign="bottom" width="21%" id="d36818e770">可能的设置</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d36818e775" headers="d36818e764 ">
                                    <p>客户端加密级别</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d36818e775 d36818e767 ">
                                    <p><code class="codeph">SQLNET.ENCRYPTION_CLIENT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d36818e775 d36818e770 ">
                                    <p><code class="codeph">被拒绝被要求接受请求</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d36818e793" headers="d36818e764 ">
                                    <p>客户端加密选择列表</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d36818e793 d36818e767 ">
                                    <p><code class="codeph">SQLNET.ENCRYPTION_TYPES_CLIENT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d36818e793 d36818e770 ">
                                    <p><code class="codeph">RC4_40</code> ， <code class="codeph">RC4_56</code> ， <code class="codeph">DES</code> ， <code class="codeph">DES40</code> ， <code class="codeph">AES128</code> ， <code class="codeph">AES192</code> ， <code class="codeph">AES256</code> ， <code class="codeph">3DES112</code> ， <code class="codeph">3DES168</code> 
                                    </p>
                                    <p>（见说明）</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d36818e833" headers="d36818e764 ">
                                    <p>客户完整性级别</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d36818e833 d36818e767 ">
                                    <p><code class="codeph">SQLNET.CRYPTO_CHECKSUM_CLIENT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d36818e833 d36818e770 ">
                                    <p><code class="codeph">被拒绝被要求接受请求</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d36818e851" headers="d36818e764 ">
                                    <p>客户端完整性选择列表</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d36818e851 d36818e767 ">
                                    <p><code class="codeph">SQLNET.CRYPTO_CHECKSUM_TYPES_CLIENT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d36818e851 d36818e770 ">
                                    <p><code class="codeph">MD5</code> ， <code class="codeph">SHA-1</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <div class="infoboxnote" id="GUID-DA1DB155-D904-4D6D-9376-C499BF6EFC61__GUID-93D4A5D2-C7DC-4BF3-AD71-66F47041B692">
                           <p class="notep1">注意：</p>
                           <p>仅对于Oracle Advanced Security国内版，也可以设置<code class="codeph">RC4_128</code>和<code class="codeph">RC4_256</code> 。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28314"></a><a id="JJDBC28313"></a><div class="props_rev_3"><a id="GUID-D04ABE6D-2529-4C60-9EDD-3A966B43ECFB" name="GUID-D04ABE6D-2529-4C60-9EDD-3A966B43ECFB"></a><h4 id="JJDBC-GUID-D04ABE6D-2529-4C60-9EDD-3A966B43ECFB" class="sect4"><span class="enumeration_section">9.4.3</span> JDBC瘦驱动程序支持加密和完整性</h4>
                  <div>
                     <div class="section">
                        <p>JDBC Thin驱动程序对数据加密和完整性参数设置的支持与前一节中讨论的JDBC OCI驱动程序支持相似。您可以通过在打开数据库连接时可以使用的Java属性对象来设置相应的参数。</p>
                        <p>服务器端和客户端的加密和完整性级别的默认值为<code class="codeph">ACCEPTED</code> 。这使您可以通过仅配置连接的一端（服务器端或客户端）来实现连接对的所需安全级别。这样可以提高程序的效率，因为如果有多个Oracle客户端连接到Oracle Server，则需要在服务器端的<code class="codeph">sqlnet.ora</code>文件中将加密和完整性级别更改为<code class="codeph">REQUESTED</code> ，以启用加密或完整性所有的联系。这样可以节省时间和精力，因为您无需单独更改每个客户端的设置。
                        </p>
                        <p>表9-3列出了JDBC Thin驱动程序的参数信息。这些参数在<code class="codeph">oracle.jdbc.中定义<code class="codeph">oracle.jdbc.OracleConnection</code>接口。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformalwide" id="GUID-D04ABE6D-2529-4C60-9EDD-3A966B43ECFB__G1029900">
                        <p class="titleintable">表9-3加密和完整性的精简驱动程序客户端参数</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="用于加密和完整性的瘦驱动程序客户端参数" width="100%" border="1" summary="This table describes JDBC Thin Driver Client parameters for encryption and integrity." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="53%" id="d36818e943">参数名称</th>
                                 <th align="left" valign="bottom" width="12%" id="d36818e946">参数类型</th>
                                 <th align="left" valign="bottom" width="35%" id="d36818e949">可能的设置</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="53%" id="d36818e954" headers="d36818e943 ">
                                    <p><code class="codeph">CONNECTION_PROPERTY_THIN_NET_ENCRYPTION_LEVEL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d36818e954 d36818e946 ">
                                    <p><code class="codeph">串</code></p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d36818e954 d36818e949 ">
                                    <p><code class="codeph">被拒绝被要求接受请求</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="53%" id="d36818e973" headers="d36818e943 ">
                                    <p><code class="codeph">CONNECTION_PROPERTY_THIN_NET_ENCRYPTION_TYPES</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d36818e973 d36818e946 ">
                                    <p><code class="codeph">串</code></p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d36818e973 d36818e949 ">
                                    <p><code class="codeph">AES256</code> ， <code class="codeph">AES192</code> ， <code class="codeph">AES128</code> ， <code class="codeph">3DES168</code> ， <code class="codeph">3DES112</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="53%" id="d36818e998" headers="d36818e943 ">
                                    <p><code class="codeph">CONNECTION_PROPERTY_THIN_NET_CHECKSUM_LEVEL</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d36818e998 d36818e946 ">
                                    <p><code class="codeph">串</code></p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d36818e998 d36818e949 ">
                                    <p><code class="codeph">被拒绝被要求接受请求</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="53%" id="d36818e1017" headers="d36818e943 ">
                                    <p><code class="codeph">CONNECTION_PROPERTY_THIN_NET_CHECKSUM_TYPES</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d36818e1017 d36818e946 ">
                                    <p><code class="codeph">串</code></p>
                                 </td>
                                 <td align="left" valign="top" width="35%" headers="d36818e1017 d36818e949 ">
                                    <p><code class="codeph">SHA1</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <div class="infoboxnote" id="GUID-D04ABE6D-2529-4C60-9EDD-3A966B43ECFB__GUID-7CB2BD75-88C5-46E2-951E-0A912FB469A2">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>对Thin驱动程序的Oracle Advanced Security支持直接合并到JDBC类JAR文件中。因此，国内和出口版本没有单独的版本。只能使用适合导出版本的参数设置。</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28316"></a><a id="JJDBC28317"></a><a id="JJDBC28315"></a><div class="props_rev_3"><a id="GUID-0B53FC61-E77F-4CE3-BF27-17B249A1CD7B" name="GUID-0B53FC61-E77F-4CE3-BF27-17B249A1CD7B"></a><h4 id="JJDBC-GUID-0B53FC61-E77F-4CE3-BF27-17B249A1CD7B" class="sect4"><span class="enumeration_section">9.4.4</span>在Java中设置加密和完整性参数</h4>
                  <div>
                     <div class="section">
                        <p>使用Java属性对象，即<code class="codeph">java.util.的实例<code class="codeph">java.util.Properties</code> ，用于设置JDBC Thin驱动程序支持的数据加密和完整性参数。
                        </p>
                        <p>以下示例实例化Java属性对象，使用它来设置表9-3中的每个参数，然后在打开与数据库的连接时使用properties对象：</p><pre class="oac_no_warn" dir="ltr">...属性prop = new Properties（）; prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_ENCRYPTION_LEVEL，“REQUIRED”）; prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_ENCRYPTION_TYPES，“（AES256）”）; prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_CHECKSUM_LEVEL，“REQUESTED”）; prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_CHECKSUM_TYPES，“（SHA1）”）; OracleDataSource ods = new OracleDataSource（）; ods.setProperties（丙）; ods.setURL（ “JDBC：预言：瘦：@localhost：5221：主”）; Connection conn = ods.getConnection（）; ...
</pre><p>值加密类型和校验和类型周围的括号允许值列表。当提供多个值时，服务器和客户端协商以确定实际使用哪个值。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0B53FC61-E77F-4CE3-BF27-17B249A1CD7B__GUID-21EB66C0-A47A-4861-8FAB-BCE5620C03A9">例</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>示例9-3是一个完整的类，它在连接到数据库以执行查询之前设置数据加密和完整性参数。</p>
                        <div class="infoboxnote" id="GUID-0B53FC61-E77F-4CE3-BF27-17B249A1CD7B__GUID-26DCA914-3F4F-48AB-A2B1-E1BDE652D9FD">
                           <p class="notep1">注意：</p>
                           <p>在该示例中，通过<code class="codeph">AnoServices</code>和<code class="codeph">Service</code>类的功能动态检索字符串<code class="codeph">REQUIRED</code> 。您可以选择以这种方式检索字符串，也可以将它们包含在软件代码中，如前面的示例所示</p>
                        </div>
                        <p>在运行此示例之前，必须在<code class="codeph">sqlnet.ora</code>文件中启用加密。例如，以下行将为加密启用AES256，AES192和AES128，为校验和启用SHA1：</p><pre class="oac_no_warn" dir="ltr">SQLNET.ENCRYPTION_SERVER = ACCEPTED SQLNET.CRYPTO_CHECKSUM_SERVER = ACCEPTED SQLNET.CRYPTO_CHECKSUM_TYPES_SERVER =（SHA1）SQLNET.ENCRYPTION_TYPES_SERVER =（AES256，AES192，AES128）SQLNET.CRYPTO_SEED = 2z0hslkdharUJCFtkwbjOLbgwsj7vkqt3bGoUylihnvkhgkdsbdskkKGhdk</pre></div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-0B53FC61-E77F-4CE3-BF27-17B249A1CD7B__BABGGGEC">
                        <p class="titleinexample">示例9-3设置数据加密和完整性参数</p><pre class="oac_no_warn" dir="ltr">import java.sql。*; import java.util。性能; import oracle.net.ano。AnoServices; import oracle.jdbc。*; public class DemoAESAndSHA1 {static final String USERNAME =“HR”; static final String PASSWORD =“hr”; static final String URL =“jdbc：oracle：thin：@（DESCRIPTION =（ADDRESS =（PROTOCOL = tcp）（HOST = localhost）（PORT = 5221））”+“（CONNECT_DATA =（SERVICE_NAME = orcl）））”; public static final void main（String [] argv）{DemoAESAndSHA1 demo = new DemoAESAndSHA1（）;试试{demo.run（）; } catch（SQLException ex）{ex.printStackTrace（）; void run（）抛出SQLException {OracleDriver dr = new OracleDriver（）;属性prop = new Properties（）; //我们要求使用AES256或AES192加密连接。//如果数据库不接受这样的安全级别，则连接尝试将失败。prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_ENCRYPTION_LEVEL，AnoServices。ANO_REQUIRED）; prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_ENCRYPTION_TYPES，“（”+ AnoServices。ENCRYPTION_AES256 +“，”+ AnoServices。ENCRYPTION_AES192 +“）”）; //我们还需要使用SHA1算法进行数据完整性检查。prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_CHECKSUM_LEVEL，AnoServices。ANO_REQUIRED）; prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_CHECKSUM_TYPES，“（”+ AnoServices。CHECKSUM_SHA1 +“）”）; prop.setProperty（ “用户”，DemoAESAndSHA1。用户名）; prop.setProperty（ “密码”，DemoAESAndSHA1。密码）; OracleConnection oraConn =（OracleConnection）dr.connect（DemoAESAndSHA1。URL，道具）; System.out.println（“连接已创建！加密算法是：“+ oraConn.getEncryptionAlgorithmName（）+”，数据完整性算法是：“+ oraConn.getDataIntegrityAlgorithmName（））; oraConn.close（）;}}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="JJDBC28318"></a><div class="props_rev_3"><a id="GUID-2BD2F189-A58C-4A85-8524-CFD9BB9AC575" name="GUID-2BD2F189-A58C-4A85-8524-CFD9BB9AC575"></a><h3 id="JJDBC-GUID-2BD2F189-A58C-4A85-8524-CFD9BB9AC575" class="sect3"><span class="enumeration_section">9.5</span>支持SSL</h3>
               <div>
                  <p></p>
                  <p>本节介绍以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="client-side-security.html#GUID-6AC4159F-9A89-4DE7-B2F8-6E8AC67109CD">SSL的JDBC支持概述</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-A0F5D4B2-C3DE-4DE6-A759-A3BF48450031">关于管理证书和钱包</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-92124E19-B017-4500-B72B-608C513FA5BE">关于密钥和证书容器</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-89D2363B-DE5E-4FD6-8689-4A069302C076">使用JDBC Thin和JKS的TLS版本1.2上的数据库连接</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-0D5B5CBE-A693-41EC-B671-4F2802FEEF49">自动SSL连接配置</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-2562DF85-18E7-4B36-8326-0C6FD4FBFFE6">支持密钥存储服务</a></p>
                     </li>
                  </ul>
               </div><a id="JJDBC28320"></a><a id="JJDBC28319"></a><div class="props_rev_3"><a id="GUID-6AC4159F-9A89-4DE7-B2F8-6E8AC67109CD" name="GUID-6AC4159F-9A89-4DE7-B2F8-6E8AC67109CD"></a><h4 id="JJDBC-GUID-6AC4159F-9A89-4DE7-B2F8-6E8AC67109CD" class="sect4"><span class="enumeration_section">9.5.1</span> SSL的JDBC支持概述</h4>
                  <div>
                     <p></p>
                     <p>Oracle Database 19c提供对安全套接字层（SSL）协议的支持。SSL是一种广泛使用的行业标准协议，可通过网络提供安全通信。SSL提供身份验证，数据加密和数据完整性。它为标准TCP / IP协议提供了安全增强，用于Internet通信。</p>
                     <p>SSL使用符合X.509v3标准的数字证书进行身份验证，使用公钥和私钥对进行加密。SSL还使用密钥加密和数字签名来确保数据的隐私性和完整性。启动SSL上的网络连接时，客户端和服务器执行SSL握手，其中包括以下步骤：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>客户端和服务器协商要使用的密码套件。这包括决定用于数据传输的加密算法。</p>
                        </li>
                        <li>
                           <p>服务器将其证书发送到客户端，客户端验证证书是否由受信任的证书颁发机构（CA）签名。此步骤验证服务器的标识。</p>
                        </li>
                        <li>
                           <p>如果需要客户端身份验证，客户端会将自己的证书发送到服务器，服务器会验证证书是否由受信任的CA签名。</p>
                        </li>
                        <li>
                           <p>客户端和服务器使用公钥加密技术交换密钥信息。基于该信息，每个都生成会话密钥。客户端和服务器之间的所有后续通信都使用这组会话密钥和协商的密码套件进行加密和解密。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-6AC4159F-9A89-4DE7-B2F8-6E8AC67109CD__GUID-F7500150-F5BC-460C-A63E-57749685A0BC">
                        <p class="notep1">注意：</p>在Oracle Database <span class="italic">11g</span>第1版（11.1）中，瘦驱动程序支持SSL身份验证。因此，如果使用SSL身份验证，则无需提供用户名/密码对。
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-6AC4159F-9A89-4DE7-B2F8-6E8AC67109CD__GUID-ED2FDF21-4FF0-4B5E-9406-F5F9BD9B09C8">SSL术语</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>SSL上下文中通常使用以下术语：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">证书</span> ：证书是一种数字签名文档，用于将公钥与实体绑定。证书可用于验证公钥是否属于该个人。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">证书颁发机构</span> ：证书颁发机构（CA），也称为证书颁发机构，是颁发数字签名证书以供其他方使用的实体。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">密码套件</span> ：密码套件是一组加密算法和密钥大小，用于加密通过启用SSL的网络发送的数据。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">私钥</span> ：私钥是一个秘密密钥，永远不会通过网络传输。私钥用于解密使用相应公钥加密的消息。它还用于签署证书。使用相应的公钥验证证书。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">公钥</span> ：公钥是一种加密密钥，可以通过普通方式（如电子邮件）公开或发送。公钥用于加密通过SSL发送的消息。它还用于验证由相应私钥签名的证书。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">密钥库或钱包</span> ：钱包是受密码保护的容器，用于存储身份验证和签名凭据，包括SSL所需的私钥，证书和可信证书。</p>
                           </li>
                           <li>
                              <p><span class="bold">安全提供程序</span> ：一种Java实现，提供与安全性相关的一些功能。提供者负责解码密钥库文件。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">密钥库服务（KSS）</span> ：Oracle Platform Security服务的一个组件。KSS允许将密钥库引用为具有<code class="codeph">kss://</code>方案的URI（而不是文件名）。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6AC4159F-9A89-4DE7-B2F8-6E8AC67109CD__GUID-888B877C-B167-48FC-B233-DE6F63013070">Java版的SSL</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Java安全套接字扩展（JSSE）为Java版本的SSL和TLS协议提供框架和实现。JSSE为数据加密，服务器和客户端身份验证以及消息完整性提供支持。它抽象了复杂的安全算法和握手机制，并通过为应用程序开发人员提供构建块来简化应用程序开发，他们可以直接将这些构建块集成到他们的应用程序中。JSSE已集成到Java Development Kit（JDK）1.4及更高版本中，并支持SSL版本2.0和3.0。</p>
                        <p>Oracle强烈建议您在Oracle JDBC驱动程序中使用SSL之前清楚地了解JavaTM安全套接字扩展（JSSE）框架。</p>
                        <p>JSSE标准应用程序编程接口（API）可在<code class="codeph">javax.net</code> ， <code class="codeph">javax.net.ssl</code>和<code class="codeph">javax.security.cert</code>包中找到。这些包提供用于创建和配置套接字，服务器套接字，SSL套接字和SSL服务器套接字的类。这些包还提供了一个用于安全HTTP连接的类，一个与基于JDK1.1的平台兼容的公钥证书API，以及用于密钥和信任管理器的接口。
                        </p>
                        <p>SSL的工作方式与Oracle Database 18c中的任何网络环境相同。</p>
                        <div class="infoboxnote" id="GUID-6AC4159F-9A89-4DE7-B2F8-6E8AC67109CD__GUID-7D376D61-04A3-4AEF-A7AB-F960C8B136F5">
                           <p class="notep1">注意：</p>为了在程序中使用JSSE，您必须清楚地了解JavaTM安全套接字扩展（JSSE）框架。
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28321"></a><div class="props_rev_3"><a id="GUID-A0F5D4B2-C3DE-4DE6-A759-A3BF48450031" name="GUID-A0F5D4B2-C3DE-4DE6-A759-A3BF48450031"></a><h4 id="JJDBC-GUID-A0F5D4B2-C3DE-4DE6-A759-A3BF48450031" class="sect4"><span class="enumeration_section">9.5.2</span>关于管理证书和钱包</h4>
                  <div>
                     <p>要与JDBC客户端Thin或OCI建立SSL连接，Oracle数据库服务器会发送其证书，该证书存储在其钱包中。客户端可能需要也可能不需要证书或钱包，具体取决于服务器配置。</p>
                     <p>Oracle JDBC Thin驱动程序使用JSSE框架来创建SSL连接。它使用默认提供程序（ <span class="italic">SunJSSE</span> ）来创建SSL上下文。但是，您可以提供自己的提供商。
                     </p>
                     <p>除非在服务器上设置了<code class="codeph">SSL_CLIENT_AUTHENTICATION</code>参数，否则您不需要客户端的证书。
                     </p>
                  </div>
               </div><a id="JJDBC28328"></a><div class="props_rev_3"><a id="GUID-92124E19-B017-4500-B72B-608C513FA5BE" name="GUID-92124E19-B017-4500-B72B-608C513FA5BE"></a><h4 id="JJDBC-GUID-92124E19-B017-4500-B72B-608C513FA5BE" class="sect4"><span class="enumeration_section">9.5.3</span>关于密钥和证书容器</h4>
                  <div>
                     <div class="section">
                        <p>只要提供者可用，Java客户端就可以使用多种类型的容器，例如Oracle钱包，JKS，PKCS12等。对于Oracle钱包<span class="italic">，OraclePKI</span>供应商必须使用，因为<span class="italic">SunJSSE</span>提供商提供的PKCS12支持不支持PKCS12的所有功能。要使用<span class="italic">OraclePKI</span>提供程序，需要以下JAR：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">oraclepki.jar</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">osdt_cert.jar</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">osdt_core.jar</code></p>
                           </li>
                        </ul>
                        <p>所有这些JAR文件都应位于<code class="codeph">$ORACLE_HOME/jlib directory</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-89D2363B-DE5E-4FD6-8689-4A069302C076" name="GUID-89D2363B-DE5E-4FD6-8689-4A069302C076"></a><h4 id="JJDBC-GUID-89D2363B-DE5E-4FD6-8689-4A069302C076" class="sect4"><span class="enumeration_section">9.5.4</span>使用JDBC Thin和JKS在TLS 1.2版上建立数据库连接</h4>
                  <div>
                     <p></p>
                     <p>执行以下步骤以配置Oracle JDBC瘦驱动程序以使用TLS 1.2版连接到数据库：</p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>始终使用JDK的最新更新</p>
                              <p>使用JDK 7或JDK 8的最新更新，因为更新的版本包含使用SSL 1.2版所需的错误修复。</p>
                           </li>
                           <li>
                              <p>安装JCE文件</p>
                              <p>安装Java加密扩展（JCE）无限强度管辖区域策略文件，因为无论您使用<code class="codeph">TLS_RSA_WITH_AES_256_CBC_SHA256</code> JDK版本，都不会启用强密码套件（例如<code class="codeph">TLS_RSA_WITH_AES_256_CBC_SHA256</code> ）。您可以从以下页面下载这些文件：</p>
                              <p><a href="http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html" target="_blank">http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html</a></p>
                              <p>此外，如果您使用的是JDK 7，则必须明确启用强密码套件。例如，如果您使用强密码套件（如<code class="codeph">TLS_RSA_WITH_AES_256_CBC_SHA256</code>和JDK 7），则必须通过<code class="codeph">oracle.net.ssl_cipher_suites</code>连接属性启用它。
                              </p>
                           </li>
                           <li>
                              <p>使用JKS文件或钱包</p>
                              <div class="infoboxnote" id="GUID-89D2363B-DE5E-4FD6-8689-4A069302C076__GUID-71D93B80-D58D-4DC5-90BA-87A0D63B600E">
                                 <p class="notep1">注意：</p>
                                 <p>从Oracle Database Release 18c开始，您可以在名为<code class="codeph">ojdbc.properties</code>的新配置文件中指定TLS配置属性。使用此文件可简化与云上数据库服务的连接。
                                 </p>
                              </div>
                              <div class="infoboxnotealso" id="GUID-89D2363B-DE5E-4FD6-8689-4A069302C076__GUID-7B28660A-567E-461D-9A87-A8C61FA9388F">
                                 <p class="notep1">也可以看看：</p><a href="../jajdb/index.html" target="_blank"><span><cite>Oracle数据库JDBC Java API参考</cite></span></a></div>
                           </li>
                        </ul>
                        <p>执行上述所有步骤后，如果遇到更多问题，则可以使用 - <code class="codeph">Djavax.net.debug=all</code>选项启用跟踪来诊断问题。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0D5B5CBE-A693-41EC-B671-4F2802FEEF49" name="GUID-0D5B5CBE-A693-41EC-B671-4F2802FEEF49"></a><h4 id="JJDBC-GUID-0D5B5CBE-A693-41EC-B671-4F2802FEEF49" class="sect4"><span class="enumeration_section">9.5.5</span>自动SSL连接配置</h4>
                  <div>
                     <p></p>
                     <p>从Oracle Database Release 18c开始，您可以使用默认值或编程逻辑来解析连接配置值，而无需手动添加或更新安全提供程序。您可以通过以下两种方式解析配置值：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="client-side-security.html#GUID-277F9F26-771F-413B-86BF-2BD4C05AF72A">供应商决议</a></p>
                        </li>
                        <li>
                           <p><a href="client-side-security.html#GUID-71648EE2-C4C5-46EA-9C27-D351E7D62CA8">自动密钥库类型（KSS）分辨率</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="sect4"><a id="GUID-277F9F26-771F-413B-86BF-2BD4C05AF72A" name="GUID-277F9F26-771F-413B-86BF-2BD4C05AF72A"></a><h5 id="JJDBC-GUID-277F9F26-771F-413B-86BF-2BD4C05AF72A" class="sect5"><span class="enumeration_section">9.5.5.1</span>提供商解决方案</h5>
                     <div>
                        <p></p>
                        <p>对于某些密钥库类型，JDBC驱动程序可以解析用于加载密钥库的提供程序实现。对于这些类型，没有必要使用Java安全性注册提供程序。只要提供程序实现在<code class="codeph">CLASSPATH</code> ，驱动程序就可以实例化安全提供程序。
                        </p>
                        <p>以下密钥库类型映射到已知提供程序：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">SSO：</span> <code class="codeph">oracle.security.pki.OraclePKIProvider</code></p>
                           </li>
                           <li>
                              <p><span class="bold">KSS：</span> <code class="codeph">oracle.security.jps.internal.keystore.provider.FarmKeyStoreProvider</code></p>
                           </li>
                        </ul>
                        <p>仅当没有为指定类型注册的提供程序时，驱动程序才会尝试解析提供程序。</p>
                        <p>如果<code class="codeph">oraclepki.jar</code>文件位于CLASSPATH上，则驱动程序可以通过以下方式自动加载Oracle PKI Provider：</p><pre class="pre codeblock"><code>java -cp oraclepki.jar：ojdbc8.jar -D javax.net.ssl.keyStore = / path / to / wallet / cwallet.sso MyApp</code></pre><p>同样，对于<code class="codeph">oracle.net.wallet_location</code>连接属性的指定值，驱动程序可以通过以下方式自动加载Oracle PKI Provider：</p><pre class="pre codeblock"><code>java -cp .: oraclepki.jar：ojdbc8.jar -D oracle.net.wallet_location = file：/path/to/wallet/cwallet.sso MyApp</code></pre><div class="infoboxnote" id="GUID-277F9F26-771F-413B-86BF-2BD4C05AF72A__GUID-2C1EAB1B-6BA2-41E1-9314-81FEAB4825D2">
                           <p class="notep1">注意：</p>
                           <p>对于由orapki工具（ <code class="codeph">ewallet.p12</code>文件）创建的PKCS12类型，您可能仍需要使用Java安全性注册<code class="codeph">OraclePKIProvider</code> ，因为orapki工具创建的PKCS12文件包含ASN1 <span class="italic">Key Bag</span>元素（类型代码：1.2.840.113549。 1.12.10.1.1）。Sun PKCS12实现不支持<span class="italic">Key Bag</span>类型，并在尝试读取<code class="codeph">ewallet.p12</code>文件时抛出错误。对于HotSpot和Open JDK用户，Sun Provider捆绑为PKCS12提供程序。这意味着PKCS12提供程序已经有一个已注册的提供程序，驱动程序将不会尝试覆盖它。
                           </p>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-71648EE2-C4C5-46EA-9C27-D351E7D62CA8" name="GUID-71648EE2-C4C5-46EA-9C27-D351E7D62CA8"></a><h5 id="JJDBC-GUID-71648EE2-C4C5-46EA-9C27-D351E7D62CA8" class="sect5"><span class="enumeration_section">9.5.5.2</span>自动密钥存储类型（KSS）解析</h5>
                     <div>
                        <p></p>
                        <p>JDBC驱动程序可以根据<code class="codeph">javax.net.ssl.keyStore</code>和<code class="codeph">javax.net.ssl.trustStore</code>属性的值来解析公共密钥库类型，从而无需使用这些属性指定类型。
                        </p>
                        <p><span class="bold">具有已识别文件扩展名的密钥库或信任存储</span></p>
                        <p>具有可识别文件扩展名的密钥库或信任库映射到以下类型：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>文件扩展名<code class="codeph">.jks</code>解析为<code class="codeph">javax.net.ssl.keyStoreType</code>为JKS：</p><pre class="pre codeblock"><code>java -cp ojdbc8.jar -D javax.net.ssl.keyStore = / path / to / keystore / keystore.jks MyApp</code></pre></li>
                           <li>
                              <p>文件扩展名<code class="codeph">.sso</code>解析为<code class="codeph">javax.net.ssl.keyStoreType</code>为SSO：</p><pre class="pre codeblock"><code>java -cp ojdbc8.jar -D javax.net.ssl.keyStore = / path / to / keystore / keystore.sso MyApp</code></pre></li>
                           <li>
                              <p>文件扩展名<code class="codeph">.p12</code>解析为<code class="codeph">javax.net.ssl.keyStoreType</code>为PKCS12：</p><pre class="pre codeblock"><code>java -cp ojdbc8.jar -D javax.net.ssl.keyStore = / path / to / keystore / keystore.p12 MyApp</code></pre></li>
                           <li>
                              <p>文件扩展名<code class="codeph">.pfx</code>解析为<code class="codeph">javax.net.ssl.keyStoreType</code>为PKCS12：</p><pre class="pre codeblock"><code>java -cp ojdbc8.jar -D javax.net.ssl.keyStore = / path / to / keystore / keystore.pfx MyApp</code></pre></li>
                        </ul>
                        <p><span class="bold">带有URI的密钥库或信任库</span></p>
                        <p>如果密钥库或信任库是具有<code class="codeph">kss://</code>方案的URI，则映射到KSS类型：</p><pre class="pre codeblock"><code>java -cp ojdbc8.jar -D javax.net.ssl.keyStore = kss：// MyStripe / MyKeyStore MyApp</code></pre><div class="infoboxnote" id="GUID-71648EE2-C4C5-46EA-9C27-D351E7D62CA8__GUID-67AF48A2-51C0-440B-BEBE-998A868A28B5">
                           <p class="notep1">注意：</p>
                           <p>您可以设置<code class="codeph">javax.net.ssl.trustStoreType</code>和<code class="codeph">javax.net.ssl.keyStoreType</code>属性以覆盖默认类型解析。
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-001069BE-E6B9-49CA-8218-F79B4FA47D62" name="GUID-001069BE-E6B9-49CA-8218-F79B4FA47D62"></a><h4 id="JJDBC-GUID-001069BE-E6B9-49CA-8218-F79B4FA47D62" class="sect4"><span class="enumeration_section">9.5.6</span>支持默认SSL上下文</h4>
                  <div>
                     <p></p>
                     <p>对于需要更好地控制了TLS配置应用程序，您可以配置JDBC驱动程序才能使用<code class="codeph">SSLContext</code>用返回<code class="codeph">SSLContext.getDefault</code>方法。使用以下方法之一让驱动程序使用默认<code class="codeph">SSLContext</code> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">javax.net.ssl.keyStore = NONE</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">javax.net.ssl.trustStore中= NONE</code></p>
                        </li>
                     </ul>
                     <p>您可以使用默认<code class="codeph">SSLContext</code>来支持非基于文件的密钥库类型。这种密钥存储类型的常见示例包括基于硬件的智能卡。需要以编程方式调用<code class="codeph">load(KeyStore.密钥库类型<code class="codeph">load(KeyStore.LoadStoreParameter)</code>方法也属于这一类。
                     </p>
                     <div class="infoboxnotealso" id="GUID-001069BE-E6B9-49CA-8218-F79B4FA47D62__GUID-B72E8A3C-140D-4667-A4D2-F009BC7BA6D7">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://docs.oracle.com/javase/8/docs/api/javax/net/ssl/SSLContext.html#getDefault--" target="_blank">https://docs.oracle.com/javase/8/docs/api/javax/net/ssl/SSLContext.html#getDefault--</a></p>
                           </li>
                           <li>
                              <p><a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyStore.html#load-java.security.KeyStore.LoadStoreParameter-" target="_blank">https://docs.oracle.com/javase/8/docs/api/java/security/KeyStore.html#load-java.security.KeyStore.LoadStoreParameter-</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-2562DF85-18E7-4B36-8326-0C6FD4FBFFE6" name="GUID-2562DF85-18E7-4B36-8326-0C6FD4FBFFE6"></a><h4 id="JJDBC-GUID-2562DF85-18E7-4B36-8326-0C6FD4FBFFE6" class="sect4"><span class="enumeration_section">9.5.7</span>支持密钥存储服务</h4>
                  <div>
                     <p></p>
                     <p>此版本的Oracle数据库在JDBC驱动程序中引入了对密钥库服务（KSS）的支持。因此，如果您已在WebLogic服务器中配置密钥存储服务，则JDBC应用程序现在可以与现有的密钥存储服务配置集成。</p>
                     <p>驱动程序可以加载由密钥存储区服务管理的密钥库。如果<code class="codeph">javax.net.ssl.keyStore</code>属性或<code class="codeph">javax.net.ssl.trustStore</code>属性的值是具有<code class="codeph">kss://</code> scheme的URI，则驱动程序将从Key Store Service加载密钥库。
                     </p>
                     <p>对于基于权限的保护，必须为ojdbc JAR文件授予以下权限：</p><pre class="pre codeblock"><code>权限KeyStoreAccessPermission“stripeName = *，keystoreName = *，alias = *”，“read”;</code></pre><p>此权限授予对每个密钥库的访问权限。要限制访问范围，可以使用特定应用程序条带和密钥库名称替换星号通配符（*）。驱动程序不会将密钥库加载为特权操作，这意味着还必须将<code class="codeph">KeyStoreAccessPermission</code>授予应用程序代码库。
                     </p>
                  </div>
               </div>
            </div><a id="JJDBC28339"></a><div class="props_rev_3"><a id="GUID-97E88D18-B590-4313-87B8-EE422DA644B3" name="GUID-97E88D18-B590-4313-87B8-EE422DA644B3"></a><h3 id="JJDBC-GUID-97E88D18-B590-4313-87B8-EE422DA644B3" class="sect3"><span class="enumeration_section">9.6</span>支持Kerberos</h3>
               <div>
                  <p>本节讨论以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="client-side-security.html#GUID-768A8F69-1DAD-4C4C-8E5F-DC463ED65393">Kerberos的JDBC支持概述</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-2111EA95-5338-45B5-907B-A6B96F5A19E3">配置Windows以使用Kerberos</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-A27B26BE-82F3-4BA1-95B6-E09A789D532B">配置Oracle数据库以使用Kerberos</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-991705F7-C2C5-4BA9-85D1-32749AE2FF64">使用Kerberos的代码示例</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-768A8F69-1DAD-4C4C-8E5F-DC463ED65393" name="GUID-768A8F69-1DAD-4C4C-8E5F-DC463ED65393"></a><h4 id="JJDBC-GUID-768A8F69-1DAD-4C4C-8E5F-DC463ED65393" class="sect4"><span class="enumeration_section">9.6.1</span> Kerberos的JDBC支持概述</h4>
                  <div>
                     <p>Kerberos是一种网络身份验证协议，可通过网络提供身份验证和强加密的工具。Kerberos通过使用密钥加密技术帮助您保护整个企业的信息系统。Kerberos协议使用强加密技术，以便客户端或服务器可以通过不安全的网络连接向其服务器或客户端证明其身份。在客户端和服务器使用Kerberos证明其身份后，他们还可以加密所有通信，以确保在业务开展时的隐私和数据完整性。</p>
                     <p>Kerberos体系结构以称为密钥分发中心（KDC）的受信任身份验证服务为中心。 Kerberos环境中的用户和服务称为主体;每个委托人与KDC共享一个秘密，例如密码。主体可以是诸如<code class="codeph">HR</code>或数据库服务器实例之类的用户。
                     </p>
                     <p>从12c版本1开始，Oracle数据库还支持Kerberos的跨域认证。如果在kerberos配置文件的<code class="codeph">domain_realms</code>部分中正确添加引用的<code class="codeph">domain_realms</code> ，然后在一个特定<code class="codeph">domain_realms</code> ，则可以访问另一个域的服务。
                     </p>
                  </div>
               </div><a id="JJDBC28342"></a><div class="props_rev_3"><a id="GUID-2111EA95-5338-45B5-907B-A6B96F5A19E3" name="GUID-2111EA95-5338-45B5-907B-A6B96F5A19E3"></a><h4 id="JJDBC-GUID-2111EA95-5338-45B5-907B-A6B96F5A19E3" class="sect4"><span class="enumeration_section">9.6.2</span>配置Windows以使用Kerberos</h4>
                  <div>
                     <div class="section">
                        <p>可以在以下链接中找到提供<code class="codeph">klist, kinit,</code>和其他工具的优秀Kerberos客户端：</p><pre class="oac_no_warn" dir="ltr"><a href="http://web.mit.edu/kerberos/dist/index.html" target="_blank"><code class="codeph">http://web.mit.edu/kerberos/dist/index.html</code></a>
</pre><p>此客户端还提供了一个很好的GUI。</p>
                        <p>您需要进行以下更改才能在Windows计算机上配置Kerberos：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span>右键单击桌面上的“ <span class="bold">我的电脑”</span>图标。</span></li>
                        <li><span>选择<span class="bold">属性</span> 。系统弹出“系统属性”对话框。</span></li>
                        <li><span>选择“ <span class="bold">高级”</span>选项卡。</span></li>
                        <li><span>单击“ <span class="bold">环境变量”</span> 。将显示“环境变量”对话框。</span></li>
                        <li><span>单击“ <span class="bold">新建”</span>以添加新的用户变量。将显示“新建用户变量”对话框。</span></li>
                        <li><span>在“变量名称”字段中输入<code class="codeph">KRB5CCNAME</code> 。</span></li>
                        <li><span>在“变量值”字段中输入<code class="codeph">FILE:C:\Documents and Settings\</code> <span class="italic"><code class="codeph">&lt;user_name&gt;</code></span> <code class="codeph">\krb5cc</code> 。</span></li>
                        <li><span>单击“ <span class="bold">确定”</span>关闭“新建用户变量”对话框。</span></li>
                        <li><span>单击“ <span class="bold">确定”</span>关闭“环境变量”对话框。</span></li>
                        <li><span>单击“ <span class="bold">确定”</span>关闭“系统属性”对话框。</span></li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-2111EA95-5338-45B5-907B-A6B96F5A19E3__GUID-D1C52111-C90C-4D3E-BF8E-4A25CDB64C3C">
                           <p class="notep1">注意：</p>
                           <p><code class="codeph">C:\WINDOWS\krb5.ini</code>文件与<code class="codeph">krb5.conf</code>文件具有相同的内容。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28343"></a><div class="props_rev_3"><a id="GUID-A27B26BE-82F3-4BA1-95B6-E09A789D532B" name="GUID-A27B26BE-82F3-4BA1-95B6-E09A789D532B"></a><h4 id="JJDBC-GUID-A27B26BE-82F3-4BA1-95B6-E09A789D532B" class="sect4"><span class="enumeration_section">9.6.3</span>配置Oracle数据库以使用Kerberos</h4>
                  <div>
                     <div class="section">
                        <p>执行以下步骤以配置Oracle数据库以使用Kerberos：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>使用以下命令连接到数据库：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; connect system输入密码： <span class="italic">密码</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令创建外部标识的用户<code class="codeph">CLIENT@US.ORACLE.COM</code> ：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt;创建用户“CLIENT@US.ORACLE.COM”外部识别; SQL&gt;将创建会话授予“CLIENT@US.ORACLE.COM”;</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令以<code class="codeph">sysdba</code>身份连接到数据库并卸载它：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; connect / as sysdba SQL&gt; shutdown immediate;</pre></div>
                        </li>
                        <li class="stepexpand"><span><code class="codeph">$T_WORK/t_init1.ora</code>添加到<code class="codeph">$T_WORK/t_init1.ora</code>文件中：</span><div><pre class="oac_no_warn" dir="ltr">OS_AUTHENT_PREFIX = “”</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令重新启动数据库：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; startup pfile = t_init1.ora</pre></div>
                        </li>
                        <li class="stepexpand"><span>修改<code class="codeph">sqlnet.ora</code>文件以包含以下行：</span><div><pre class="oac_no_warn" dir="ltr">names.directory_path =（tnsnames）#Kerberos sqlnet.authentication_services =（beq，kerberos5）sqlnet.authentication_kerberos5_service = dbji sqlnet.kerberos5_conf = /home/Jdbc/Security/kerberos/krb5.conf sqlnet.kerberos5_keytab = / home / Jdbc / Security / kerberos / dbji.oracleserver sqlnet.kerberos5_conf_mit = true sqlnet.kerberos_cc_name = / tmp / krb5cc_5088 #logging（可选）：trace_level_server = 16 trace_directory_server = / scratch / sqlnet /</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令验证您是否可以通过SQL * Plus进行连接：</span><div><pre class="oac_no_warn" dir="ltr"><span class="bold">&gt; kinit客户端</span> <span class="bold">&gt; klist</span>票证缓存：文件：/ tmp / krb5cc_5088默认主体：client@US.ORACLE.COM有效开始Expires服务主体06/22/06 07:13:29 06/22/06 17:13:29 krbtgt /US.ORACLE.COM@US.ORACLE.COM Kerberos 4票证缓存：/ tmp / tkt5088 klist：您没有缓存票证&gt; <span class="bold">sqlplus</span> <span class="bold">'/@(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=oracleserver.mydomain） .com）（PORT = 5221））</span> <span class="bold">（CONNECT_DATA =（SERVICE_NAME = orcl）））'</span>
</pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="JJDBC28345"></a><a id="JJDBC28344"></a><div class="props_rev_3"><a id="GUID-991705F7-C2C5-4BA9-85D1-32749AE2FF64" name="GUID-991705F7-C2C5-4BA9-85D1-32749AE2FF64"></a><h4 id="JJDBC-GUID-991705F7-C2C5-4BA9-85D1-32749AE2FF64" class="sect4"><span class="enumeration_section">9.6.4</span>使用Kerberos的代码示例</h4>
                  <div>
                     <div class="section">
                        <p>以下示例演示了新的Kerberos身份验证功能，该功能是Oracle Database 12 <span class="italic">c</span>第1版（12.1）JDBC瘦驱动程序的一部分。该演示包括两个场景：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在第一个方案中，操作系统维护用户名和凭据。凭据存储在缓存中，驱动程序在尝试向服务器进行身份验证之前检索凭据。此方案位于模块<code class="codeph">connectWithDefaultUser()</code> 。
                              </p>
                              <div class="infoboxnote" id="GUID-991705F7-C2C5-4BA9-85D1-32749AE2FF64__GUID-10CEC8C2-632B-429F-8B13-FC4CD7F078C5">
                                 <p class="notep1">注意：</p>
                                 <ol>
                                    <li>
                                       <p>在运行演示的这一部分之前，请使用以下命令验证您是否具有有效凭据：</p><pre class="oac_no_warn" dir="ltr">&gt; / usr / kerberos / bin / kinit client在哪里， <span class="italic">欢迎</span>使用密码。</pre></li>
                                    <li>
                                       <p>使用以下命令列出您的票证：</p><pre class="oac_no_warn" dir="ltr">&gt; / usr / kerberos / bin / klist</pre></li>
                                 </ol>
                              </div>
                           </li>
                           <li>
                              <p>第二种情况包括应用程序想要控制用户凭据的情况。这是应用程序服务器的情况，其中多个Web用户具有自己的凭据。此方案位于模块<code class="codeph">connectWithSpecificUser().</code></p>
                              <div class="infoboxnote" id="GUID-991705F7-C2C5-4BA9-85D1-32749AE2FF64__GUID-265EA54A-355B-4BEC-993C-93B6F1695A68">
                                 <p class="notep1">注意：</p>
                                 <p>要运行此演示，您需要有一个正常工作的设置，即启动并运行Kerberos服务器，以及配置为使用Kerberos身份验证的Oracle数据库服务器。然后，您需要更改示例中使用的URL以进行编译和运行。</p>
                              </div>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-991705F7-C2C5-4BA9-85D1-32749AE2FF64__GUID-AF4FB9E1-FBFC-4288-B6D2-5FDA35CD5082">
                        <p class="titleinexample">示例9-4使用Kerberos身份验证连接到数据库</p><pre class="oac_no_warn" dir="ltr">import com.sun.security.auth.module。Krb5LoginModule; import java.io.IOException异常; import java.security。的PrivilegedExceptionAction; import java.sql。连接; import java.sql。ResultSet的; import java.sql。的SQLException; import java.sql。声明; import java.util。HashMap的; import java.util。性能; import javax.security.auth。学科; import javax.security.auth.callback。打回来; import javax.security.auth.callback。的CallbackHandler; import javax.security.auth.callback。PasswordCallback; import javax.security.auth.callback。UnsupportedCallbackException在; import oracle.jdbc。的OracleConnection; import oracle.jdbc。一个OracleDriver; import oracle.net.ano。AnoServices;公共类KerberosJdbcDemo {String url =“jdbc：oracle：thin：@（DESCRIPTION =（ADDRESS =（PROTOCOL = tcp）”+“（HOST = oracleserver.mydomain.com）（PORT = 5221））（CONNECT_DATA =”+“ （SERVICE_NAME = ORCL）））“; public static void main（String [] arv）{/ *如果你看到以下错误信息[机制级别：无法加载*配置文件c：\ winnt \ krb5.ini（系统找不到指定的路径*）这是因为JVM无法找到您的kerberos配置文件。*您必须提供文件的位置。例如，在Windows上，* MIT Kerberos客户端使用配置文件：C \ WINDOWS \ krb5.ini：* / // System.setProperty（“java.security.krb5.conf”，“C：\\ WINDOWS \\” krb5.ini“）; System.setProperty（ “java.security.krb5.conf”， “/家庭/ JDBC /安全/ Kerberos的/ krb5.conf的”）; KerberosJdbcDemo kerberosDemo = new KerberosJdbcDemo（）;尝试{System.out.println（“尝试连接默认用户：”）; kerberosDemo.connectWithDefaultUser（）; } catch（Exception e）{e.printStackTrace（）; } try {System.out.println（“尝试与特定用户连接：”）; kerberosDemo.connectWithSpecificUser（）; } catch（Exception e）{e.printStackTrace（）; void connectWithDefaultUser（）抛出SQLException {OracleDriver driver = new OracleDriver（）;属性prop = new Properties（）; prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_AUTHENTICATION_SERVICES，“（”+ AnoServices。AUTHENTICATION_KERBEROS5 + “）”）; prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_AUTHENTICATION_KRB5_MUTUAL，“true”）; / *如果您收到以下错误[无法获取*身份验证的Princpal名称]虽然您知道您的*凭据缓存中有正确的TGT，但这可能是因为JVM无法找到您的*缓存。</pre><pre class="oac_no_warn" dir="ltr">* *请注意，Windows上的默认位置是“C：\ Documents and Settings \ krb5cc_username”。* / // prop.setProperty（OracleConnection。CONNECTION_PROPERTY_THIN_NET_AUTHENTICATION_KRB5_CC_NAME，</pre><pre class="oac_no_warn" dir="ltr">/ *在linux上：&gt; kinit / usr / kerberos / bin / kinit&gt; ls -l /etc/krb5.conf lrwxrwxrwx 1 root root 47 Jun 22 06:56 /etc/krb5.conf  - &gt; / home / Jdbc / Security /kerberos/krb5.conf&gt; kinit client密码client@US.ORACLE.COM：&gt; klist票证缓存：FILE：/ tmp / krb5cc_5088默认主体：client@US.ORACLE.COM有效开始Expires服务主体11/02/06 09:25:11 11/02/06 19:25:11 krbtgt/US.ORACLE.COM@US.ORACLE.COM Kerberos 4票证缓存：/ tmp / tkt5088 klist：你没有票证缓存* / prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_AUTHENTICATION_KRB5_CC_NAME，“/ tmp / krb5cc_5088”）; Connection conn = driver.connect（url，prop）; String auth =（（OracleConnection）conn）。getAuthenticationAdaptorName（）; System.out.println（“Authentication adapter =”+ auth）; printUserName（conn）;在conn.close（）; void connectWithSpecificUser（）throws Exception {Subject specificSubject = new Subject（）; //这个第一部分对于这个演示来说并没有多大意义。在//真实场景中，您有一个有效的“specificSubject”主题//表示具有有效Kerberos凭据的Web用户。Krb5LoginModule krb5Module = new Krb5LoginModule（）; HashMap sharedState = new HashMap（）; HashMap options = new HashMap（）; options.put（ “doNotPrompt”， “假”）; options.put（ “useTicketCache”， “假”）; options.put（ “主”， “client@US.ORACLE.COM”）; krb5Module.initialize（specificSubject，newKrbCallbackHandler（），对sharedState，选项）; boolean retLogin = krb5Module.login（）; krb5Module.commit（）;如果（！retLogin）抛出新的异常（“Kerberos5适配器无法从缓存中检索凭证（TGT）”）; //使用来自cache：// options.put（“useTicketCache”，“true”）的TGT; // options.put（“doNotPrompt”，“true”）; // options.put（“ticketCache”，“C：\\ Documents and Settings \\ user \\ krb5cc”）; // krb5Module.initialize（specificSubject，null，sharedState，options）; //现在我们有一个有Kerberos凭据的有效主题。第二个场景//真正从这里开始：//代表Subject'compactSubject'执行driver.connect（...）：Connection conn =（Connection）Subject.doAs（specificSubject，new PrivilegedExceptionAction（）{public Object run（ ）{Connection con = null; Properties prop = new Properties（）; prop.setProperty（AnoServices。AUTHENTICATION_PROPERTY_SERVICES，“（”+ AnoServices。AUTHENTICATION_KERBEROS5 +“）”）;尝试{OracleDriver driver = new OracleDriver（）; con = driver.connect（url，prop）; } catch（Exception除外）{except.printStackTrace（）; } return con; }}; String auth =（（OracleConnection）conn）。getAuthenticationAdaptorName（）; System.out.println（“Authentication adapter =”+ auth）; printUserName（conn）;在conn.close（）; void printUserName（Connection conn）throws SQLException {Statement stmt = null; try {stmt = conn.createStatement（）; ResultSet rs = stmt.executeQuery（“select user from dual”）; while（rs.next（））System.out.println（“User is：”+ rs.getString（1））; rs.close（）;终于{if（stmt！）= null）stmt.close（）;类KrbCallbackHandler实现CallbackHandler {public void handle（Callback [] callbacks）抛出IOException，UnsupportedCallbackException {for（int i = 0; i &lt;callbacks.length; i ++）{if（callbacks [i] instanceof PasswordCallback）{PasswordCallback pc =（PasswordCallback）callbacks [i]; System.out.println（“将密码设置为'welcome'”）; pc.setPassword（（new String（“welcome”））。toCharArray（））; } else {throw new UnsupportedCallbackException（callbacks [i]，“Unrecognized Callback”）; }}}}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="JJDBC28346"></a><div class="props_rev_3"><a id="GUID-5748543A-EA85-4263-93C8-A79B2D5DBB8C" name="GUID-5748543A-EA85-4263-93C8-A79B2D5DBB8C"></a><h3 id="JJDBC-GUID-5748543A-EA85-4263-93C8-A79B2D5DBB8C" class="sect3"><span class="enumeration_section">9.7</span>支持RADIUS</h3>
               <div>
                  <p>本节介绍以下概念：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="client-side-security.html#GUID-9D0D86AD-35E4-4289-A6EA-4052A9FD9927">RADIUS支持的JDBC支持概述</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-08248FD5-DD26-4D07-B1C7-0DBDFA3FC970">配置Oracle数据库以使用RADIUS</a></p>
                     </li>
                     <li>
                        <p><a href="client-side-security.html#GUID-E8CEB076-4DD7-49EB-86D3-82F503E34A02">使用RADIUS的代码示例</a></p>
                     </li>
                  </ul>
               </div>
               <div class="props_rev_3"><a id="GUID-9D0D86AD-35E4-4289-A6EA-4052A9FD9927" name="GUID-9D0D86AD-35E4-4289-A6EA-4052A9FD9927"></a><h4 id="JJDBC-GUID-9D0D86AD-35E4-4289-A6EA-4052A9FD9927" class="sect4"><span class="enumeration_section">9.7.1</span> RADIUS的JDBC支持概述</h4>
                  <div>
                     <p>Oracle Database <span class="italic">11g</span>第1版引入了对远程身份验证拨入用户服务（RADIUS）的支持。RADIUS是一种客户端/服务器安全协议，最广为人知的是启用远程身份验证和访问。Oracle Advanced Security在客户端/服务器网络环境中使用此标准，以支持使用支持RADIUS协议的任何身份验证方法。RADIUS可以与各种身份验证机制一起使用，包括令牌卡和智能卡。
                     </p>
                  </div>
               </div><a id="JJDBC28348"></a><div class="props_rev_3"><a id="GUID-08248FD5-DD26-4D07-B1C7-0DBDFA3FC970" name="GUID-08248FD5-DD26-4D07-B1C7-0DBDFA3FC970"></a><h4 id="JJDBC-GUID-08248FD5-DD26-4D07-B1C7-0DBDFA3FC970" class="sect4"><span class="enumeration_section">9.7.2</span>配置Oracle数据库以使用RADIUS</h4>
                  <div>
                     <div class="section">
                        <p>执行以下步骤以配置Oracle数据库以使用RADIUS：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>使用以下命令连接到数据库：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; connect system输入密码： <span class="italic">密码</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令从数据库中创建新用户<code class="codeph">aso</code> ：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt;创建外部标识的用户aso; SQL&gt;将创建会话授予aso;</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令以<code class="codeph">sysdba</code>身份连接到数据库并卸载它：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; connect / as sysdba SQL&gt; shutdown immediate;</pre></div>
                        </li>
                        <li class="stepexpand"><span><code class="codeph">t_init1.ora</code>添加到<code class="codeph">t_init1.ora</code>文件：</span><div><pre class="oac_no_warn" dir="ltr">os_authent_prefix =“”</pre><div class="infoboxnote" id="GUID-08248FD5-DD26-4D07-B1C7-0DBDFA3FC970__GUID-BCF97DBF-65ED-41FF-B692-DDFD1F29674C">
                                 <p class="notep1">注意：</p>
                                 <p>测试结束后，您需要还原对t_init1.ora文件所做的更改。</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令重新启动数据库：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; startup pfile =？/work/t_init1.ora</pre></div>
                        </li>
                        <li class="stepexpand"><span>修改<code class="codeph">sqlnet.ora</code>文件，使其仅包含以下行：</span><div><pre class="oac_no_warn" dir="ltr">sqlnet.authentication_services =（beq，radius）sqlnet.radius_authentication = &lt;RADUIUS_SERVER_HOST_NAME&gt; sqlnet.radius_authentication_port = 1812 sqlnet.radius_authentication_timeout = 120 sqlnet.radius_secret = / home / Jdbc / Security / radius / radius_key #logging（可选）：trace_level_server = 16 trace_directory_server = /刮伤/ SQLNET /</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令验证您是否可以通过SQL * Plus进行连接：</span><div><pre class="oac_no_warn" dir="ltr">&gt; sqlplus'aso / 1234 @（DESCRIPTION =（ADDRESS =（PROTOCOL = tcp）（HOST = oracleserver.mydomain.com）（PORT = 5221））（CONNECT_DATA =（SERVICE_NAME = orcl）））'</pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="JJDBC28350"></a><a id="JJDBC28349"></a><div class="props_rev_3"><a id="GUID-E8CEB076-4DD7-49EB-86D3-82F503E34A02" name="GUID-E8CEB076-4DD7-49EB-86D3-82F503E34A02"></a><h4 id="JJDBC-GUID-E8CEB076-4DD7-49EB-86D3-82F503E34A02" class="sect4"><span class="enumeration_section">9.7.3</span>使用RADIUS的代码示例</h4>
                  <div>
                     <div class="section">
                        <p>此示例演示了新的RADIUS身份验证功能，该功能是Oracle Database 12 <span class="italic">c</span>第1版（12.1）JDBC瘦驱动程序的一部分。您需要有一个正常工作的设置，即启动并运行RADIUS服务器，以及配置为使用RADIUS身份验证的Oracle数据库服务器。然后，您需要更改示例中给出的URL以进行编译和运行。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-E8CEB076-4DD7-49EB-86D3-82F503E34A02__GUID-0778E14A-A747-4223-AB03-5EC61A17B2EB">
                        <p class="titleinexample">示例9-5使用RADIUS身份验证连接到数据库</p><pre class="oac_no_warn" dir="ltr">import java.sql。连接; import java.sql。ResultSet的; import java.sql。的SQLException; import java.sql。声明; import java.util。性能; import oracle.jdbc。的OracleConnection; import oracle.jdbc。一个OracleDriver; import oracle.net.ano。AnoServices; public class RadiusJdbcDemo {String url =“jdbc：oracle：thin：@（DESCRIPTION =（ADDRESS =（PROTOCOL = tcp）”+“（HOST = oracleserver.mydomain.com）（PORT = 5221））（CONNECT_DATA =”+“ （SERVICE_NAME = ORCL）））“; public static void main（String [] arv）{RadiusJdbcDemo radiusDemo = new RadiusJdbcDemo（）;试试{radiusDemo.connect（）; } catch（Exception e）{e.printStackTrace（）;此方法尝试使用RADIUS *身份验证协议登录数据库。* *它应该将以下输出打印到stdout：* -------------------------------------- --------------- *身份验证适配器= RADIUS *用户是：ASO * ------------------------ ----------------------------- * / void connect（）抛出SQLException {OracleDriver driver = new OracleDriver（）;属性prop = new Properties（）; prop.setProperty（的OracleConnection。CONNECTION_PROPERTY_THIN_NET_AUTHENTICATION_SERVICES，“（”+ AnoServices。AUTHENTICATION_RADIUS + “）”）; //需要使用密码“1234”在radius服务器上正确设置用户“aso”。prop.setProperty（ “用户”， “ASO”）; prop.setProperty（ “密码”， “1234”）; Connection conn = driver.connect（url，prop）; String auth =（（OracleConnection）conn）。getAuthenticationAdaptorName（）; System.out.println（“Authentication adapter =”+ auth）; printUserName（conn）;在conn.close（）; void printUserName（Connection conn）throws SQLException {Statement stmt = null; try {stmt = conn.createStatement（）; ResultSet rs = stmt.executeQuery（“select user from dual”）; while（rs.next（））System.out.println（“User is：”+ rs.getString（1））; rs.close（）;终于{if（stmt！）= null）stmt.close（）; }}}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="JJDBC28351"></a><div class="props_rev_3"><a id="GUID-4DED9706-6735-4786-B70C-4D35C8DFE9E5" name="GUID-4DED9706-6735-4786-B70C-4D35C8DFE9E5"></a><h3 id="JJDBC-GUID-4DED9706-6735-4786-B70C-4D35C8DFE9E5" class="sect3"><span class="enumeration_section">9.8</span>关于安全外部密码存储</h3>
               <div>
                  <p>作为应用程序使用密码凭据连接到数据库的大规模部署的替代方法，可以将此类凭据存储在客户端Oracle钱包中。Oracle钱包是一个安全的软件容器，用于存储身份验证和签名凭据。</p>
                  <p>在客户端Oracle钱包中存储数据库密码凭证消除了在应用程序代码中嵌入用户名和密码的需要， <a id="d36818e2362" class="indexterm-anchor"></a>批量作业，或<a id="d36818e2365" class="indexterm-anchor"></a>脚本。这样可以降低在脚本和应用程序代码中暴露密码的风险，并简化维护工作，因为每次用户名和密码更改时都不需要更改代码。此外，如果您不必更改应用程序代码，那么为这些用户帐户强制实施密码管理策略也变得更加容易。
                  </p>
                  <p>您可以设置<code class="codeph">oracle.net.wallet_location</code>连接属性以指定钱包位置。然后，JDBC驱动程序可以从此钱包中检索用户名和密码对。
                  </p>
                  <div class="infoboxnotealso" id="GUID-4DED9706-6735-4786-B70C-4D35C8DFE9E5__GUID-CEA776CE-6F6D-42B3-A42A-D458090252C1">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关配置客户端以使用安全外部密码存储的详细信息，以及有关管理其中的凭据的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/jjdbc&amp;id=ADMIN11133" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                        </li>
                        <li>
                           <p>有关管理密码凭据的安全外部密码存储库的详细信息，请参见“ <a href="../dbseg/configuring-authentication.html#DBSEG99815" target="_blank"><span class="italic">Oracle数据库安全指南</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="09631.creating-oracle-data-guard-physical-standby.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can manually create a physical standby database in maximum performance mode using asynchronous redo transport and real-time apply, the default Oracle Data Guard configuration."></meta>
      <meta name="description" content="You can manually create a physical standby database in maximum performance mode using asynchronous redo transport and real-time apply, the default Oracle Data Guard configuration."></meta>
      <title>创建物理备用数据库</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Concepts and Administration "></meta>
      <meta property="og:description" content="You can manually create a physical standby database in maximum performance mode using asynchronous redo transport and real-time apply, the default Oracle Data Guard configuration."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Concepts and Administration"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-guard-concepts-and-administration.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T10:50:21-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96244-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="getting-started-with-oracle-data-guard.html" title="Previous" type="text/html"></link>
      <link rel="next" href="creating-oracle-data-guard-logical-standby.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Guard Concepts and Administration"></meta>
    <meta name="dcterms.isVersionOf" content="SBYDB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="getting-started-with-oracle-data-guard.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="creating-oracle-data-guard-logical-standby.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">概念和管理</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-data-guard-concepts.html" property="item" typeof="WebPage"><span property="name">概念和管理</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">创建物理备用数据库</li>
            </ol>
            <a id="GUID-B511FB6E-E3E7-436D-94B5-071C37550170" name="GUID-B511FB6E-E3E7-436D-94B5-071C37550170"></a><a id="SBYDB00200"></a>
            
            <h2 id="SBYDB-GUID-B511FB6E-E3E7-436D-94B5-071C37550170" class="sect2"><span class="enumeration_chapter">3</span>创建物理备用数据库</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以使用异步重做传输和实时应用（默认的Oracle Data Guard配置）以最高性能模式手动创建物理备用数据库。</p>
               <p>请参阅以下主要主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-3DA747A3-1976-4A70-A96A-56281872D4D9" title="在创建备用数据库之前，必须首先确保已正确配置主数据库。">准备主数据库以创建备用数据库</a></p>
                  </li>
                  <li>
                     <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-A86D403B-B3F5-4B05-9255-5BADD513F9CF" title="这些是您创建物理备用数据库时执行的任务。">创建物理备用数据库的逐步说明</a></p>
                  </li>
                  <li>
                     <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-3A0F8F9C-EF69-4BE4-9F7B-98AED4BEC4AC" title="物理备用数据库运行后，可以升级数据保护模式，也可以启用闪回数据库。">创作后的步骤</a></p>
                  </li>
                  <li>
                     <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-7C55FE8A-50C3-4601-9ADA-98BE6D65F1DD" title="Database Configuration Assistant（DBCA）还可以用作创建Oracle Data Guard物理备用数据库的简单命令行方法。">使用DBCA创建Data Guard待机</a></p>
                  </li>
                  <li>
                     <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-D5F0EB8F-8534-462A-911C-216E6DC7CE69" title="您可以创建多租户容器数据库（CDB）的物理备用数据库，就像创建常规主数据库的物理备用数据库一样。">创建CDB的物理备用</a></p>
                  </li>
                  <li>
                     <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-20D2DEAC-0355-4FBB-ADB8-37BF5F4328E2" title="在Oracle Data Guard配置中，主数据库上的可插拔数据库（PDB）的创建方式与创建常规数据库上的PDB的方式相同。">在主数据库中创建PDB</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-B511FB6E-E3E7-436D-94B5-071C37550170__GUID-A18BD0A2-FB8D-4195-9C26-DA4AEC6CFBE1">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ADMIN11117" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a> ，了解有关创建和使用服务器参数文件的信息</p>
                     </li>
                     <li>
                        <p>企业管理器联机帮助系统，用于获取有关使用Oracle Data Guard代理图形用户界面（GUI）自动创建物理备用数据库的信息</p>
                     </li>
                     <li>
                        <p><a href="creating-data-guard-standby-database-using-RMAN.html#GUID-82731D59-A20F-45DD-A235-267B3B0E38C5" title="这些主题描述了如何使用Oracle Recovery Manager创建备用数据库。">使用Recovery Manager创建备用数据库，</a>以获取有关创建物理备用数据库的备用方法的信息，该数据库通过使用Oracle Recovery Manager（RMAN）以及基于备份的复制或通过网络进行主动复制来自动执行大部分过程</p>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=DGBKR090" target="_blank"><span class="italic">Oracle数据卫士代理</span></a>有关配置数据库，以便它可以由Oracle Data Guard的经纪人管理信息</p>
                     </li>
                  </ul>
               </div>
               <div class="infoboxnote" id="GUID-B511FB6E-E3E7-436D-94B5-071C37550170__GUID-A2C04D1E-5EB6-4CF9-BE44-43505962F4E0">
                  <p class="notep1">注意：</p>
                  <p>如果您在多租户容器数据库（CDB）环境中工作，请参阅<a href="creating-oracle-data-guard-physical-standby.html#GUID-D5F0EB8F-8534-462A-911C-216E6DC7CE69" title="您可以创建多租户容器数据库（CDB）的物理备用数据库，就像创建常规主数据库的物理备用数据库一样。">创建CDB的物理备用，</a>以获取有关非CDB环境的行为差异的信息。例如，在CDB环境中，许多DBA视图都有类似的CDB视图，您应该使用它们。
                  </p>
               </div>
            </div><a id="SBYDB5015"></a><a id="SBYDB4718"></a><div class="props_rev_3"><a id="GUID-3DA747A3-1976-4A70-A96A-56281872D4D9" name="GUID-3DA747A3-1976-4A70-A96A-56281872D4D9"></a><h3 id="SBYDB-GUID-3DA747A3-1976-4A70-A96A-56281872D4D9" class="sect3"><span class="enumeration_section">3.1</span>为备用数据库创建准备主数据库</h3>
               <div>
                  <p>在创建备用数据库之前，必须首先确保已正确配置主数据库。</p>
                  <div class="section">
                     <p>在主数据库上执行以下任务以准备物理备用数据库创建：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-AE2B1237-57A1-4745-A04C-4246A831A963" title="作为准备备用数据库创建的主数据库的一部分，您必须启用适合您计划使用Data Guard配置的方式的日志记录模式。">启用适当的日志记录模式</a></p>
                        </li>
                        <li>
                           <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-0DC30726-3471-4588-BFE0-9CA0736328E2" title="Oracle Data Guard使用Oracle Net会话在Oracle Data Guard配置的成员之间传输重做数据和控制消息。">配置重做传输身份验证</a></p>
                        </li>
                        <li>
                           <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-CA9076B9-3360-4A36-87AF-3390B391CEFF" title="如果这是第一次将备用数据库添加到配置中，则最佳做法是将主数据库配置为接收重做。">配置主数据库以接收重做数据</a></p>
                        </li>
                        <li>
                           <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-0FD317D6-1A49-4DB3-A141-D00CB3089E84" title="在主数据库上，您可以定义在数据库处于主要角色时控制重做传输服务的初始化参数。">设置主数据库初始化参数</a></p>
                        </li>
                        <li>
                           <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-0379019D-0995-4EB7-8861-B07B708C7B4C" title="如果未启用存档，则必须将主数据库置于ARCHIVELOG模式并启用自动存档。">启用存档</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-3DA747A3-1976-4A70-A96A-56281872D4D9__GUID-2C0A3837-59E6-42CA-BA31-6F891FA30F5E">
                        <p class="notep1">注意：</p>
                        <p>仅执行一次这些准备任务。完成这些步骤后，数据库将准备充当一个或多个备用数据库的主数据库。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="SBYDB4719"></a><div class="props_rev_3"><a id="GUID-AE2B1237-57A1-4745-A04C-4246A831A963" name="GUID-AE2B1237-57A1-4745-A04C-4246A831A963"></a><h4 id="SBYDB-GUID-AE2B1237-57A1-4745-A04C-4246A831A963" class="sect4"><span class="enumeration_section">3.1.1</span>启用适当的日志记录模式</h4>
                  <div>
                     <p>作为准备备用数据库创建的主数据库的一部分，您必须启用适合您计划使用Data Guard配置的方式的日志记录模式。</p>
                     <div class="section">
                        <p>不属于Data Guard配置的数据库的默认日志记录模式允许以非日志方式执行某些数据加载操作。此默认模式不适用于具有备用数据库的数据库，因为它会导致备用数据库中缺少已加载的数据，这需要手动干预才能进行修复。除了默认日志记录模式外，还有其他三种适用于主数据库的模式：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <div class="p"><code class="codeph">FORCE LOGGING</code>模式可防止以非记录方式执行任何加载操作。这会降低加载过程的速度，因为必须将加载的数据复制到重做日志中。使用以下命令启用<code class="codeph">FORCE LOGGING</code>模式：<pre class="pre codeblock"><code>SQL&gt; ALTER DATABASE FORCE LOGGING;</code></pre></div>
                           </li>
                           <li>
                              <div class="p"><code class="codeph">STANDBY NOLOGGING FOR DATA AVAILABILITY</code>模式使加载操作通过其自身与备用数据库的连接将加载的数据发送到每个备用数据库。提交会延迟，直到所有备用数据库都将数据应用为Active Data Guard环境中运行托管恢复的一部分。使用以下命令启用它：<pre class="pre codeblock"><code>SQL&gt; ALTER DATABASE SET STANDBY NOLOGGING FOR DATA AVAILABILITY;</code></pre></div>
                           </li>
                           <li>
                              <div class="p"><code class="codeph">STANDBY NOLOGGING FOR LOAD PERFORMANCE</code>类型与先前的模式类似，不同之处在于，如果网络无法跟上数据加载到主数据库的速度，则加载过程可以停止将数据发送到备用数据库。在此模式下，备用数据库可能缺少数据，但每个备用数据库都会自动从主数据库中提取数据，这是Active Data Guard环境中运行的受管恢复的正常部分。使用以下命令启用它：<pre class="pre codeblock"><code>SQL&gt; ALTER DATABASE设置备用负载性能;</code></pre></div>
                           </li>
                        </ul>
                        <p>当您发出任何这些语句时，必须至少安装主数据库（并且它也可以打开）。该语句可能需要相当长的时间才能完成，因为它等待所有未记录的直接写入I / O完成。</p>
                        <p></p>
                        <div class="infoboxnote" id="GUID-AE2B1237-57A1-4745-A04C-4246A831A963__GUID-733F7367-B8B7-4B2E-B22D-3C3E9EB3BD16">
                           <p class="notep1">注意：</p>
                           <p>当您在主数据库上启用<code class="codeph">STANDBY NOLOGGING FOR DATA AVAILABILITY</code>或<code class="codeph">STANDBY NOLOGGING FOR LOAD PERFORMANCE</code>时，任何使用多实例重做应用功能的备用数据库将停止应用带有错误ORA-10892的重做。您必须首先重新启动重做应用并允许受影响的备用数据库超过NOLOGGING操作期，然后启用多实例重做应用。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-AE2B1237-57A1-4745-A04C-4246A831A963__GUID-5584756B-129C-46A1-97A2-63718104B4AA">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关指定<code class="codeph">FORCE</code> <code class="codeph">LOGGING</code>模式的后果的详细信息，请参见<a href="../admin/creating-and-configuring-an-oracle-database.html#ADMIN11096" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB00424"></a><div class="props_rev_3"><a id="GUID-0DC30726-3471-4588-BFE0-9CA0736328E2" name="GUID-0DC30726-3471-4588-BFE0-9CA0736328E2"></a><h4 id="SBYDB-GUID-0DC30726-3471-4588-BFE0-9CA0736328E2" class="sect4"><span class="enumeration_section">3.1.2</span>配置重做传输认证</h4>
                  <div>
                     <p>Oracle Data Guard使用Oracle Net会话在Oracle Data Guard配置的成员之间传输重做数据和控制消息。</p>
                     <p>这些重做传输会话使用安全套接字层（SSL）协议或远程登录密码文件进行身份验证。</p>
                     <p>在以下情况下，SSL用于验证两个数据库之间的重做传输会话：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>这些数据库是同一Oracle Internet Directory（OID）企业域的成员，它允许使用当前的用户数据库链接</p>
                        </li>
                        <li>
                           <p>与数据库对应的<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>和<code class="codeph">FAL_SERVER</code>数据库初始化参数使用为SSL配置的Oracle Net连接描述符</p>
                        </li>
                        <li>
                           <p>每个数据库都有一个Oracle钱包或支持的硬件安全模块，其中包含一个用户证书，其可分辨名称（DN）与数据库的OID条目中的DN相匹配</p>
                        </li>
                     </ul>
                     <p>如果不满足SSL身份验证要求，则必须将Oracle Data Guard配置的每个成员配置为使用远程登录密码文件，并且配置中的每个物理备用数据库都必须具有来自的密码文件的最新副本。主数据库。</p>
                     <div class="infoboxnote" id="GUID-0DC30726-3471-4588-BFE0-9CA0736328E2__GUID-386E79D8-99A8-47C6-9721-53DED3AEB1CD">
                        <p class="notep1">注意：</p>
                        <p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2.0.1）开始，在主数据库上完成的密码文件更改会自动传播到备用数据库。唯一的例外是远同步实例。更新的密码文件仍必须手动复制到远程同步实例，因为远程同步实例会接收重做，但不会应用它。在远程同步实例中密码文件是最新的后，重做会自动传播到任何备用数据库，这些数据库设置为从该远程同步实例接收重做日志。应用重做时，备用数据库上的密码文件会更新。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-0DC30726-3471-4588-BFE0-9CA0736328E2__GUID-8FF931DF-1863-4243-9387-3D63161690E9">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关远程登录密码文件的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10184" target="_blank"><span class="italic">参见</span></a> <a href="../admin/getting-started-with-database-administration.html#ADMIN-GUID-26EC8D1B-7A2F-4F0A-9588-D92CBD610858" target="_blank"><span class="italic">Oracle数据库管理员指南</span></a>和<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10184" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                           </li>
                           <li>
                              <p>有关SSL的更多信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=DBSEG070" target="_blank"><span class="italic">Oracle数据库安全指南</span></a></p>
                           </li>
                           <li>
                              <p>有关Oracle Net Services的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=NETAG001" target="_blank"><span class="italic">“Oracle数据库网络服务管理员指南”</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="SBYDB00426"></a><div class="props_rev_3"><a id="GUID-CA9076B9-3360-4A36-87AF-3390B391CEFF" name="GUID-CA9076B9-3360-4A36-87AF-3390B391CEFF"></a><h4 id="SBYDB-GUID-CA9076B9-3360-4A36-87AF-3390B391CEFF" class="sect4"><span class="enumeration_section">3.1.3</span>配置主数据库以接收重做数据</h4>
                  <div>
                     <p>如果这是第一次将备用数据库添加到配置中，则最佳做法是将主数据库配置为接收重做。</p>
                     <p>如有必要，主数据库可以快速转换到备用角色并开始接收重做数据。</p>
                     <p>要创建备用重做日志，请使用SQL <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">ADD</code> <code class="codeph">STANDBY</code> <code class="codeph">LOGFILE</code>语句。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE添加STANDBY LOGFILE（'/ oracle / dbs / slog1.rdo'）SIZE 500M; SQL&gt; ALTER DATABASE添加STANDBY LOGFILE（'/ oracle / dbs / slog2.rdo'）SIZE 500M;</pre><p>有关如何确定每个日志文件的大小和日志组的数量以及有关管理备用重做日志的其他背景信息的讨论，请参阅<a href="oracle-data-guard-redo-transport-services.html#GUID-AF64C4FE-2D16-4197-953A-25930F36CFA8" title="必须将重做传输目标配置为从重做源数据库接收和归档重做数据。">配置Oracle数据库以接收重做数据</a> 。
                     </p>
                  </div>
               </div><a id="SBYDB4720"></a><div class="props_rev_3"><a id="GUID-0FD317D6-1A49-4DB3-A141-D00CB3089E84" name="GUID-0FD317D6-1A49-4DB3-A141-D00CB3089E84"></a><h4 id="SBYDB-GUID-0FD317D6-1A49-4DB3-A141-D00CB3089E84" class="sect4"><span class="enumeration_section">3.1.4</span>设置主数据库初始化参数</h4>
                  <div>
                     <p>在主数据库上，您可以定义在数据库处于主要角色时控制重做传输服务的初始化参数。</p>
                     <p>您需要添加其他参数来控制重做数据的接收，并在主数据库转换为备用角色时应用服务。</p>
                     <p>以下示例显示了您在主数据库上维护的主要角色初始化参数。此示例表示Oracle Data Guard配置，其中包含位于Chicago的主数据库和位于Boston的一个物理备用数据库。当该数据库在主数据库角色或备用数据库角色中运行时，此示例中显示的参数对于Chicago数据库有效。配置示例使用下表中显示的名称：</p>
                     <div class="tblformal" id="GUID-0FD317D6-1A49-4DB3-A141-D00CB3089E84__GUID-CA398D21-3C1C-442B-829B-22477670CEAE">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This 3 column tables shows the DB_UNIQUE_NAME and Oracle Net service names that are used in this chapters examples. Column 1 is the database, Column 2 is the DB_UNIQUE_NAME. Column 3 is the Oracle Net Service Name . " frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d7102e744">数据库</th>
                                 <th align="left" valign="bottom" width="31%" id="d7102e747">DB_UNIQUE_NAME</th>
                                 <th align="left" valign="bottom" width="38%" id="d7102e750">Oracle Net服务名称</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d7102e755" headers="d7102e744 ">
                                    <p>主</p>
                                 </td>
                                 <td align="left" valign="top" width="31%" headers="d7102e755 d7102e747 ">
                                    <p>芝加哥</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d7102e755 d7102e750 ">
                                    <p>芝加哥</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d7102e765" headers="d7102e744 ">
                                    <p>物理待机</p>
                                 </td>
                                 <td align="left" valign="top" width="31%" headers="d7102e765 d7102e747 ">
                                    <p>波士顿</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d7102e765 d7102e750 ">
                                    <p>波士顿</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" --><pre class="oac_no_warn" dir="ltr">DB_NAME =芝加哥DB_UNIQUE_NAME =芝加哥<a id="d7102e776" class="indexterm-anchor"></a> LOG_ARCHIVE_CONFIG ='DG_CONFIG =（芝加哥，芝加哥）'CONTROL_FILES ='/ arch1 / chicago / control1.ctl'，'/ arch2 / chicago / control2.ctl'LOG_ARCHIVE_DEST_1 ='LOCATION = USE_DB_RECOVERY_FILE_DEST VALID_FOR =（ALL_LOGFILES，ALL_ROLES）DB_UNIQUE_NAME =芝加哥'LOG_ARCHIVE_DEST_2 ='SERVICE = boston ASYNC VALID_FOR =（ONLINE_LOGFILES，PRIMARY_ROLE）DB_UNIQUE_NAME = boston'REMOTE_LOGIN_PASSWORDFILE = EXCLUSIVE LOG_ARCHIVE_FORMAT =％t_％s_％r.arc</pre><p>这些参数控制重做传输服务如何将重做数据传输到备用系统以及在本地文件系统上存档重做数据。请注意，该示例指定异步（ <code class="codeph">ASYNC</code> ）网络传输以在<code class="codeph">LOG_ARCHIVE_DEST_2</code>初始化参数上传输重做数据。这些是推荐的设置，需要备用重做日志文件（请参阅<a href="creating-oracle-data-guard-physical-standby.html#GUID-CA9076B9-3360-4A36-87AF-3390B391CEFF" title="如果这是第一次将备用数据库添加到配置中，则最佳做法是将主数据库配置为接收重做。">配置主数据库以接收重做数据</a> ）。
                     </p>
                     <p>以下显示主数据库上的其他备用角色初始化参数。这些参数在主数据库转换为备用角色时生效。</p><pre class="oac_no_warn" dir="ltr">FAL_SERVER = boston DB_FILE_NAME_CONVERT ='/ boston /'，'/ chicago /'LOG_FILE_NAME_CONVERT ='/ boston /'，'/ chicago /'STANDBY_FILE_MANAGEMENT = AUTO</pre><p>指定上面显示的初始化参数将设置主数据库以解决间隙，从新的主数据库转换新数据文件和日志文件路径名，并在此数据库处于备用角色时归档传入的重做数据。使用如上所述设置的主角色和备用角色的初始化参数，角色转换后不需要更改任何参数。</p>
                     <p>下表提供了前两个示例中显示的每个参数设置的简要说明。</p>
                     <div class="tblformalwide" id="GUID-0FD317D6-1A49-4DB3-A141-D00CB3089E84__GUID-AD33B23C-C22E-4924-9029-1D06B2983132">
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Briefly explains each initialization parameter that was set in Examples 3-1 and 3-2." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="30%" id="d7102e810">参数</th>
                                 <th align="left" valign="bottom" width="70%" id="d7102e813">推荐设置</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e818" headers="d7102e810 ">
                                    <p><a href="../refrn/DB_NAME.html#REFRN10041" target="_blank"><code class="codeph">DB_NAME</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e818 d7102e813 ">
                                    <p>在主数据库上，指定创建数据库时使用的名称。在物理备用数据库上，使用主数据库的<code class="codeph">DB_NAME</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e831" headers="d7102e810 ">
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10242" target="_blank"><code class="codeph">DB_UNIQUE_NAME</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e831 d7102e813 ">
                                    <p>为每个数据库指定唯一的名称。即使主数据库和备用数据库反向角色，此名称仍保留在数据库中，并且不会更改。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e841" headers="d7102e810 ">
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10237" target="_blank"><code class="codeph">LOG_ARCHIVE_CONFIG</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e841 d7102e813 ">
                                    <p>必须在Oracle Data Guard配置中的每个数据库上显式设置此参数的<code class="codeph">DG_CONFIG</code>属性，以启用完整的Oracle Data Guard功能。将<code class="codeph">DG_CONFIG</code>设置为包含配置中每个数据库的<code class="codeph">DB_UNIQUE_NAME</code>的文本字符串，此列表中的每个名称用逗号分隔。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e860" headers="d7102e810 ">
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10021" target="_blank"><code class="codeph">CONTROL_FILES</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e860 d7102e813 ">
                                    <p>指定主数据库上控制文件的路径名。建议控制文件的第二个副本可用，以便在将良好的控制文件复制到错误控制文件的位置后可以轻松地重新启动实例。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e870" headers="d7102e810 ">
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10086" target="_blank"><code class="codeph">的LOG_ARCHIVE_DEST_n</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e870 d7102e813 ">
                                    <p>指定在主系统和备用系统上归档重做数据的位置。</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><code class="codeph">LOG_ARCHIVE_DEST_1</code>将主数据库生成的重做数据从本地联机重做日志文件归档到/ arch1 / chicago /中的本地归档重做日志文件。
                                          </p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">LOG_ARCHIVE_DEST_2</code>仅对主要角色有效。该目的地将重做数据发送到远程物理备用目的地<code class="codeph">boston</code> 。
                                          </p>
                                       </li>
                                    </ul>
                                    <p><span class="bold">注意：</span>如果配置了快速恢复区域（使用<code class="codeph">DB_RECOVERY_FILE_DEST</code>初始化参数）并且尚未使用<code class="codeph">LOCATION</code>属性显式配置本地归档目标，则Oracle Data Guard会自动使用<code class="codeph">LOG_ARCHIVE_DEST_1</code>初始化参数（如果尚未设置）本地存档的默认目标。另外，请参阅<a href="LOG_ARCHIVE_DEST_n-parameter-attributes.html#GUID-B04FC22C-F0B0-440F-BAF4-182EE547FCC1" title="这是LOG_ARCHIVE_DEST_n初始化参数的属性列表（其中n是1到31之间的整数）。">LOG_ARCHIVE_DEST_n参数属性</a>以获取完整的<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>信息。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e933" headers="d7102e810 ">
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10184" target="_blank"><code class="codeph">REMOTE_LOGIN_PASSWORDFILE</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e933 d7102e813 ">
                                    <p>如果使用远程登录密码文件对管理用户或重做传输会话进行身份验证，则必须将此参数设置为<code class="codeph">EXCLUSIVE</code>或<code class="codeph">SHARED</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e949" headers="d7102e810 ">
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10089" target="_blank"><code class="codeph">LOG_ARCHIVE_FORMAT</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e949 d7102e813 ">
                                    <p>使用线程（％t），序列号（％s）和resetlogs ID（％r）指定归档重做日志文件的格式。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e959" headers="d7102e810 ">
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10056" target="_blank"><code class="codeph">FAL_SERVER</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e959 d7102e813 ">
                                    <p>指定FAL服务器的Oracle Net服务名称（通常这是以主角色运行的数据库）。当Chicago数据库以备用角色运行时，如果Boston无法自动发送丢失的日志文件，它将使用Boston数据库作为FAL服务器从中获取（请求）丢失的归档重做日志文件。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e969" headers="d7102e810 ">
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10038" target="_blank"><code class="codeph">DB_FILE_NAME_CONVERT</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e969 d7102e813 ">
                                    <p>指定备用数据库数据文件的路径名和文件名位置，后跟主要位置。此参数将主数据库数据文件的路径名转换为备用数据文件路径名。此参数仅用于转换物理备用数据库的路径名。此参数可以指定多对路径。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e979" headers="d7102e810 ">
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10098" target="_blank"><code class="codeph">LOG_FILE_NAME_CONVERT</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e979 d7102e813 ">
                                    <p>指定备用数据库联机重做日志文件的位置，后跟主要位置。此参数将主数据库日志文件的路径名转换为备用数据库上的路径名。此参数可以指定多对路径。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="30%" id="d7102e989" headers="d7102e810 ">
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10212" target="_blank"><code class="codeph">STANDBY_FILE_MANAGEMENT</code></a></p>
                                 </td>
                                 <td align="left" valign="top" width="70%" headers="d7102e989 d7102e813 ">
                                    <p>设置为<code class="codeph">AUTO</code>以便在向主数据库添加或删除数据文件时，会自动对备用数据库进行相应的更改。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p></p>
                     <div class="infoboxnote" id="GUID-0FD317D6-1A49-4DB3-A141-D00CB3089E84__GUID-34E39F48-BBFC-4943-A3C9-01C2DF0DDC91">
                        <p class="notep1">注意：</p>
                        <p>查看初始化参数文件以获取可能需要修改的其他参数。例如，如果备用数据库上的目录位置与主数据库上指定的目录位置不同，则可能需要修改转储目标参数。</p>
                     </div>
                  </div>
               </div><a id="SBYDB4721"></a><div class="props_rev_3"><a id="GUID-0379019D-0995-4EB7-8861-B07B708C7B4C" name="GUID-0379019D-0995-4EB7-8861-B07B708C7B4C"></a><h4 id="SBYDB-GUID-0379019D-0995-4EB7-8861-B07B708C7B4C" class="sect4"><span class="enumeration_section">3.1.5</span>启用存档</h4>
                  <div>
                     <p>如果未启用存档，则必须将主数据库置于<code class="codeph">ARCHIVELOG</code>模式并启用自动存档。
                     </p>
                     <div class="section">
                        <p>发出以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SHUTDOWN IMMEDIATE; SQL&gt; STARTUP MOUNT; SQL&gt; ALTER DATABASE ARCHIVELOG; SQL&gt; ALTER DATABASE OPEN;</pre><div class="infoboxnote" id="GUID-0379019D-0995-4EB7-8861-B07B708C7B4C__GUID-796FE0BE-43FE-49DC-8BDF-FF34AFC890A9">
                           <p class="notep1">注意：</p>备用数据库必须处于<code class="codeph">ARCHIVELOG</code>模式才能执行备用重做日志存档。
                        </div>
                        <p>有关存档的信息，请参见“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ADMIN008" target="_blank"><span class="italic">Oracle数据库管理员指南”</span></a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="SBYDB5018"></a><a id="SBYDB00210"></a><div class="props_rev_3"><a id="GUID-A86D403B-B3F5-4B05-9255-5BADD513F9CF" name="GUID-A86D403B-B3F5-4B05-9255-5BADD513F9CF"></a><h3 id="SBYDB-GUID-A86D403B-B3F5-4B05-9255-5BADD513F9CF" class="sect3"><span class="enumeration_section">3.2</span>创建物理备用数据库的逐步说明</h3>
               <div>
                  <p>这些是您创建物理备用数据库时执行的任务。</p>
                  <p>本主题中的信息是以详细程度编写的，要求您已经全面了解以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>数据库管理员验证</p>
                     </li>
                     <li>
                        <p>数据库初始化参数</p>
                     </li>
                     <li>
                        <p>管理重做日志，数据文件和控制文件</p>
                     </li>
                     <li>
                        <p>管理归档重做日志</p>
                     </li>
                     <li>
                        <p>快速恢复区</p>
                     </li>
                     <li>
                        <p>Oracle Net配置</p>
                     </li>
                  </ul>
                  <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-A86D403B-B3F5-4B05-9255-5BADD513F9CF__BACHCEHE" title="这是一个面向任务的2列表，它提供了本章中描述如何创建物理备用数据库的部分的链接。第1列是任务。第2列是数据库。">表3-1</a>提供了创建物理备用数据库以及执行每项任务的数据库所执行的任务的核对表。
                  </p>
                  <div class="tblformalwide" id="GUID-A86D403B-B3F5-4B05-9255-5BADD513F9CF__BACHCEHE">
                     <p class="titleintable">表3-1创建物理备用数据库</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="创建物理备用数据库" width="100%" border="1" summary="This is a task-oriented 2 column table that provides a link to sections in the chapter that describe how to create a physical standby database. Column 1 is the task. Column 2 is the database. " frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="50%" id="d7102e1226">任务</th>
                              <th align="left" valign="bottom" width="50%" id="d7102e1229">数据库</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d7102e1234" headers="d7102e1226 ">
                                 <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-C40DD1FB-1DB5-4674-839D-D17ECA99FB93" title="只要拥有必要的归档重做日志文件以完全恢复数据库，就可以使用主数据库的任何备份副本来创建物理备用数据库。">创建主数据库数据文件的备份副本</a></p>
                              </td>
                              <td align="left" valign="top" width="50%" headers="d7102e1234 d7102e1229 ">
                                 <p>主</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d7102e1246" headers="d7102e1226 ">
                                 <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-B471D788-AFD3-48B3-9709-D63C34DBC269" title="为备用数据库创建控制文件（主数据库不必打开，但必须至少安装它）。">为备用数据库创建控制文件</a></p>
                              </td>
                              <td align="left" valign="top" width="50%" headers="d7102e1246 d7102e1229 ">
                                 <p>主</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d7102e1258" headers="d7102e1226 ">
                                 <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA" title="从主数据库使用的服务器参数文件（SPFILE）创建参数文件（PFILE）。">为备用数据库创建参数文件</a></p>
                              </td>
                              <td align="left" valign="top" width="50%" headers="d7102e1258 d7102e1229 ">
                                 <p>主</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d7102e1270" headers="d7102e1226 ">
                                 <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-4834C26E-6493-4C5A-91F7-680FD43FADF7" title="确保已创建所有必需的目录。使用操作系统复制实用程序将二进制文件从主系统复制到备用系统上的正确位置。">将文件从主系统复制到备用系统</a></p>
                              </td>
                              <td align="left" valign="top" width="50%" headers="d7102e1270 d7102e1229 ">
                                 <p>主</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d7102e1282" headers="d7102e1226 ">
                                 <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-2FD8DBAB-C439-4F03-9A94-01C6FEF33392" title="通过创建基于Windows的服务，密码文件和SPFILE以及设置Oracle Net环境来设置环境。">设置环境以支持备用数据库</a></p>
                              </td>
                              <td align="left" valign="top" width="50%" headers="d7102e1282 d7102e1229 ">
                                 <p>支持</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d7102e1294" headers="d7102e1226 ">
                                 <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-3D65210D-9FE5-490E-938E-57FC2E07A569" title="这些是启动物理备用数据库和重做应用的步骤。">启动物理备用数据库</a></p>
                              </td>
                              <td align="left" valign="top" width="50%" headers="d7102e1294 d7102e1229 ">
                                 <p>支持</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d7102e1306" headers="d7102e1226 ">
                                 <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-AAA6D97B-A345-4825-A320-B662BB16E2ED" title="创建物理备用数据库并设置重做传输服务后，您可能希望验证数据库修改是否已成功从主数据库传输到备用数据库。">验证物理备用数据库是否正常运行</a></p>
                              </td>
                              <td align="left" valign="top" width="50%" headers="d7102e1306 d7102e1229 ">
                                 <p>支持</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="SBYDB4722"></a><div class="props_rev_3"><a id="GUID-C40DD1FB-1DB5-4674-839D-D17ECA99FB93" name="GUID-C40DD1FB-1DB5-4674-839D-D17ECA99FB93"></a><h4 id="SBYDB-GUID-C40DD1FB-1DB5-4674-839D-D17ECA99FB93" class="sect4"><span class="enumeration_section">3.2.1</span>创建物理备用任务1：创建主数据库数据文件的备份副本</h4>
                  <div>
                     <p>只要拥有必要的归档重做日志文件以完全恢复数据库，就可以使用主数据库的任何备份副本来创建物理备用数据库。</p>
                     <div class="section">
                        <p>只要拥有必要的归档重做日志文件以完全恢复数据库，就可以使用主数据库的任何备份副本来创建物理备用数据库。Oracle建议您使用Recovery Manager实用程序（RMAN）。</p>
                        <p>有关执行数据库备份操作的信息，请参见“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV191" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”</span></a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4723"></a><div class="props_rev_3"><a id="GUID-B471D788-AFD3-48B3-9709-D63C34DBC269" name="GUID-B471D788-AFD3-48B3-9709-D63C34DBC269"></a><h4 id="SBYDB-GUID-B471D788-AFD3-48B3-9709-D63C34DBC269" class="sect4"><span class="enumeration_section">3.2.2</span>创建物理备用任务2：为备用数据库创建控制文件</h4>
                  <div>
                     <p>为备用数据库创建控制文件（主数据库不必打开，但必须至少安装它）。</p>
                     <div class="section">
                        <p>以下是为备用数据库创建控制文件的示例：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; <a id="d7102e1483" class="indexterm-anchor"></a><a id="d7102e1487" class="indexterm-anchor"></a> ALTER DATABASE将STANDBY CONTROLFILE创建为'/tmp/boston.ctl';</pre><p><code class="codeph">ALTER DATABASE</code>命令指定要在备用角色中运行的数据库;在这种情况下，一个名为<code class="codeph">boston</code>的数据库。
                        </p>
                        <p>您不能将单个控制文件用于主数据库和备用数据库。他们每个人都必须拥有自己的文件。</p>
                        <div class="infoboxnote" id="GUID-B471D788-AFD3-48B3-9709-D63C34DBC269__GUID-F79A72B2-361F-4CF6-B59F-1C56B77ACDB4">
                           <p class="notep1">注意：</p>
                           <p>如果在主服务器上进行控制文件备份并在备用服务器上进行恢复（反之亦然），则将已还原系统上的快照控制文件的位置配置为默认值。（快照控制文件名的默认值是特定于平台的，并且取决于Oracle主目录。）使用RMAN <code class="codeph">CONFIGURE SNAPSHOT CONTROLFILE</code>命令手动将其重新配置为正确的值。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB5019"></a><a id="SBYDB4724"></a><div class="props_rev_3"><a id="GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA" name="GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA"></a><h4 id="SBYDB-GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA" class="sect4"><span class="enumeration_section">3.2.3</span>创建物理备用任务3：为备用数据库创建参数文件</h4>
                  <div>
                     <p>从主数据库使用的服务器参数文件（SPFILE）创建参数文件（PFILE）。</p>
                     <div class="section">
                        <p>执行以下步骤：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>发出如下SQL语句：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE PFILE ='/ tmp / initboston.ora'FROM SPFILE;</pre><p>在“ <a href="creating-oracle-data-guard-physical-standby.html#GUID-2FD8DBAB-C439-4F03-9A94-01C6FEF33392" title="通过创建基于Windows的服务，密码文件和SPFILE以及设置Oracle Net环境来设置环境。">设置环境以支持备用数据库”中</a> ，然后在修改该参数文件以包含适合在物理备用数据库中使用的参数值之后，从该参数文件创建服务器参数文件。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>修改上一步中创建的参数文件中的参数值。</span><div>
                              <p>虽然参数文件中的大多数初始化参数设置也适用于物理备用数据库，但必须进行一些修改。</p>
                              <p><a href="creating-oracle-data-guard-physical-standby.html#GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA__I70559">示例3-1</a>以粗体字显示了先前在主服务器上创建的必须更改的参数。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="example" id="GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA__I70559">
                        <p class="titleinexample">示例3-1修改物理备用数据库的初始化参数</p><pre class="oac_no_warn" dir="ltr">。。。DB_NAME =芝加哥<span class="bold">DB_UNIQUE_NAME = boston</span> LOG_ARCHIVE_CONFIG <a id="d7102e1617" class="indexterm-anchor"></a> = 'DG_CONFIG =（芝加哥，波士顿）' <span class="bold">CONTROL_FILES = '/ arch1 /波士顿/ control1.ctl'，</span> <span class="bold">'/arch2/boston/control2.ctl'</span> <span class="bold">DB_FILE_NAME_CONVERT =</span> <span class="bold">'/芝加哥/'， '/波士顿/'</span> <span class="bold">LOG_FILE_NAME_CONVERT ='/ chicago /'，'/ boston /'</span> LOG_ARCHIVE_FORMAT = log％t_％s_％r.arc <span class="bold">LOG_ARCHIVE_DEST_1 =</span> 'LOCATION = USE_DB_RECOVERY_FILE_DEST <span class="bold">VALID_FOR =（ALL_LOGFILES，ALL_ROLES）</span> <span class="bold">DB_UNIQUE_NAME =</span> <span class="bold">boston'LOG_ARCHIVE_DEST_2</span> <span class="bold">=</span> <span class="bold">'SERVICE =芝加哥</span> <span class="bold">ASYNC</span> <span class="bold">VALID_FOR =（ONLINE_LOGFILES，PRIMARY_ROLE ）</span> <span class="bold">DB_UNIQUE_NAME =芝加哥'</span> REMOTE_LOGIN_PASSWORDFILE = EXCLUSIVE STANDBY_FILE_MANAGEMENT = AUTO <span class="bold">FAL_SERVER =芝加哥</span> 。。。</pre></div>
                     <!-- class="example" -->
                     <div class="section">
                        <p>确保<code class="codeph">COMPATIBLE</code>初始化参数在主数据库和备用数据库上都设置为相同的值。如果值不同，则重做传输服务可能无法将重做数据从主数据库传输到备用数据库。
                        </p>
                        <p>使用<code class="codeph">SHOW PARAMETERS</code>命令验证不需要更改其他参数始终是一个好习惯。
                        </p>
                        <p>下表提供了有关<a href="creating-oracle-data-guard-physical-standby.html#GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA__I70559">示例3-1</a>中显示的参数设置的简要说明，这些参数设置与主数据库具有不同的设置。
                        </p>
                        <div class="tblformalwide" id="GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA__GUID-72D11A33-652F-4E6D-BC0C-07DB98F40D62">
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="This 2 column table describes each initialization parameter that was set in Example 3-3." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="34%" id="d7102e1685">参数</th>
                                    <th align="left" valign="bottom" width="66%" id="d7102e1688">推荐设置</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="34%" id="d7102e1693" headers="d7102e1685 ">
                                       <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10242" target="_blank"><code class="codeph">DB_UNIQUE_NAME</code></a></p>
                                    </td>
                                    <td align="left" valign="top" width="66%" headers="d7102e1693 d7102e1688 ">
                                       <p>为此数据库指定唯一名称。此名称保留在数据库中，即使主数据库和备用数据库反向角色也不会更改。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="34%" id="d7102e1703" headers="d7102e1685 ">
                                       <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10021" target="_blank"><code class="codeph">CONTROL_FILES</code></a></p>
                                    </td>
                                    <td align="left" valign="top" width="66%" headers="d7102e1703 d7102e1688 ">
                                       <p>在备用数据库上指定控制文件的路径名。<a href="creating-oracle-data-guard-physical-standby.html#GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA__I70559">例3-1</a>显示了如何为两个控制文件执行此操作。建议控制文件的第二个副本可用，以便在将良好的控制文件复制到错误控制文件的位置后可以轻松地重新启动实例。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="34%" id="d7102e1715" headers="d7102e1685 ">
                                       <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10038" target="_blank"><code class="codeph">DB_FILE_NAME_CONVERT</code></a><a id="d7102e1721" class="indexterm-anchor"></a><a id="d7102e1725" class="indexterm-anchor"></a></p>
                                    </td>
                                    <td align="left" valign="top" width="66%" headers="d7102e1715 d7102e1688 ">
                                       <p>指定主数据库数据文件的路径名和文件名位置，后跟备用位置。此参数将主数据库数据文件的路径名转换为备用数据文件路径名。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="34%" id="d7102e1733" headers="d7102e1685 ">
                                       <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10098" target="_blank"><code class="codeph">LOG_FILE_NAME_CONVERT</code></a><a id="d7102e1739" class="indexterm-anchor"></a><a id="d7102e1743" class="indexterm-anchor"></a></p>
                                    </td>
                                    <td align="left" valign="top" width="66%" headers="d7102e1733 d7102e1688 ">
                                       <p>指定主数据库联机重做日志文件的位置，后跟备用位置。此参数将主数据库日志文件的路径名转换为备用数据库上的路径名。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="34%" id="d7102e1751" headers="d7102e1685 ">
                                       <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10086" target="_blank"><code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span></a></p>
                                    </td>
                                    <td align="left" valign="top" width="66%" headers="d7102e1751 d7102e1688 ">
                                       <p>指定要归档重做数据的位置。在<a href="creating-oracle-data-guard-physical-standby.html#GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA__I70559">例3-1中</a> ：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p><code class="codeph">LOG_ARCHIVE_DEST_1</code>将从主数据库接收的重做数据归档到/ arch1 / boston /中的归档重做日志文件。
                                             </p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">LOG_ARCHIVE_DEST_2</code>当前被忽略，因为此目标仅对主角色有效。如果发生切换并且此实例成为主数据库，则它会将重做数据传输到远程芝加哥目的地。
                                             </p>
                                          </li>
                                       </ul>
                                       <p><span class="bold">注意：</span>如果配置了快速恢复区域（使用<code class="codeph">DB_RECOVERY_FILE_DEST</code>初始化参数）并且您尚未使用<code class="codeph">LOCATION</code>属性显式配置本地归档目标，则Oracle Data Guard会自动使用<code class="codeph">LOG_ARCHIVE_DEST_1</code>初始化参数（如果尚未设置）作为本地存档的默认目标。另请参阅<a href="LOG_ARCHIVE_DEST_n-parameter-attributes.html#GUID-B04FC22C-F0B0-440F-BAF4-182EE547FCC1" title="这是LOG_ARCHIVE_DEST_n初始化参数的属性列表（其中n是1到31之间的整数）。">LOG_ARCHIVE_DEST_n参数属性</a>以获取有关<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>完整信息。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="34%" id="d7102e1816" headers="d7102e1685 ">
                                       <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10056" target="_blank"><code class="codeph">FAL_SERVER</code></a></p>
                                    </td>
                                    <td align="left" valign="top" width="66%" headers="d7102e1816 d7102e1688 ">
                                       <p>指定FAL服务器的Oracle Net服务名称（通常这是以主角色运行的数据库）。当Boston数据库以备用角色运行时，它使用Chicago数据库作为FAL服务器，如果Chicago无法自动发送丢失的日志文件，则从该服务器获取（请求）丢失的归档重做日志文件。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnote" id="GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA__GUID-99208921-F8CD-49ED-A89B-06CAC7F8004F">
                           <p class="notep1">注意：</p>
                           <p>查看初始化参数文件以获取可能需要修改的其他参数。例如，如果备用数据库上的目录位置与主数据库上指定的目录位置不同，则可能需要修改转储目标参数。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4725"></a><div class="props_rev_3"><a id="GUID-4834C26E-6493-4C5A-91F7-680FD43FADF7" name="GUID-4834C26E-6493-4C5A-91F7-680FD43FADF7"></a><h4 id="SBYDB-GUID-4834C26E-6493-4C5A-91F7-680FD43FADF7" class="sect4"><span class="enumeration_section">3.2.4</span>创建物理备用任务4：将文件从主系统复制到备用系统</h4>
                  <div>
                     <p>确保已创建所有必需的目录。使用操作系统复制实用程序将二进制文件从主系统复制到备用系统上的正确位置。</p>
                     <div class="section">
                        <p>要复制的二进制文件如下：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在<a href="creating-oracle-data-guard-physical-standby.html#GUID-C40DD1FB-1DB5-4674-839D-D17ECA99FB93" title="You can use any backup copy of the primary database to create the physical standby database, as long as you have the necessary archived redo log files to completely recover the database.">创建主数据库数据文件的备份副本</a>中<a href="creating-oracle-data-guard-physical-standby.html#GUID-C40DD1FB-1DB5-4674-839D-D17ECA99FB93" title="只要拥有必要的归档重做日志文件以完全恢复数据库，就可以使用主数据库的任何备份副本来创建物理备用数据库。">创建的</a>数据库备份 
                              </p>
                           </li>
                           <li>
                              <p>在<a href="creating-oracle-data-guard-physical-standby.html#GUID-B471D788-AFD3-48B3-9709-D63C34DBC269" title="Create the control file for the standby database (the primary database does not have to be open, but it must at least be mounted).">为备用数据库创建</a>控制文件中<a href="creating-oracle-data-guard-physical-standby.html#GUID-B471D788-AFD3-48B3-9709-D63C34DBC269" title="为备用数据库创建控制文件（主数据库不必打开，但必须至少安装它）。">创建的</a> Stan dby控制文件</p>
                           </li>
                           <li>
                              <p>在<a href="creating-oracle-data-guard-physical-standby.html#GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA" title="Create a parameter file (PFILE) from the server parameter file (SPFILE) used by the primary database.">为备用数据库创建</a>参数文件中<a href="creating-oracle-data-guard-physical-standby.html#GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA" title="从主数据库使用的服务器参数文件（SPFILE）创建参数文件（PFILE）。">创建的</a>初始化参数文件</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4726"></a><div class="props_rev_3"><a id="GUID-2FD8DBAB-C439-4F03-9A94-01C6FEF33392" name="GUID-2FD8DBAB-C439-4F03-9A94-01C6FEF33392"></a><h4 id="SBYDB-GUID-2FD8DBAB-C439-4F03-9A94-01C6FEF33392" class="sect4"><span class="enumeration_section">3.2.5</span>创建物理备用任务5：设置环境以支持备用数据库</h4>
                  <div>
                     <p>通过创建基于Windows的服务，密码文件和SPFILE以及设置Oracle Net环境来设置环境。</p>
                     <div class="section">
                        <p>执行以下步骤：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>如果备用数据库将托管在Windows系统上，则使用ORADIM实用程序创建Windows服务。例如：</span><div><pre class="oac_no_warn" dir="ltr">oradim -NEW -SID波士顿-STARTMODE手册</pre><p>ORADIM实用程序自动确定应为其创建此服务的用户名，并提示输入该用户名的密码（如果该用户名需要密码）。有关使用ORADIM实用程序的详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=NTQRF05011" target="_blank"><span class="italic">适用于Microsoft Windows的Oracle数据库平台指南</span></a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将远程登录密码文件从主数据库系统复制到备用数据库系统。</span><div>
                              <p>如果操作系统身份验证用于管理用户，并且SSL用于重做传输身份验证，则此步骤是可选的。如果没有，则将远程登录密码文件从主数据库复制到物理备用数据库系统上的相应目录。</p>
                              <p>主服务器上对密码文件的任何后续更改都会自动传播到备用服务器。对密码文件的更改可以包括授予或撤消管理权限（ <code class="codeph">SYSDG</code> ， <code class="codeph">SYSOPER</code> ， <code class="codeph">SYSDBA</code>等）的时间，以及更改具有管理权限的任何用户的密码的时间。更新的密码文件仍必须手动复制到远程同步实例，因为远程同步实例会接收重做，但不会应用它。在远程同步实例中密码文件是最新的后，主服务器上包含密码更新的重做会自动传播到任何备用数据库，这些数据库设置为从该远程同步实例接收重做。应用重做时，备用数据库上的密码文件会更新。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果尚未配置，则在备用系统上配置并启动侦听器。</span><div>
                              <p>请参见“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=NETAG010" target="_blank"><span class="italic">Oracle数据库网络服务管理员指南”。</span></a></p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>创建Oracle Net服务名称。</span><div>
                              <p>在主系统和备用系统上，使用Oracle Net Manager为重做传输服务使用的主数据库和备用数据库创建网络服务名称。此示例中的网络服务名称是<code class="codeph">chicago</code>和<code class="codeph">boston</code> 。
                              </p>
                              <p>Oracle Net服务名称必须解析为使用您为主数据库和备用数据库配置侦听器时指定的相同协议，主机地址，端口和服务的连接描述符。连接描述符还必须指定使用专用服务器。</p>
                              <p>有关服务名称的详细信息，请参阅“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=NETAG175" target="_blank"><span class="italic">Oracle数据库网络服务管理员指南”</span></a> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在空闲备用数据库上，使用SQL <code class="codeph">CREATE</code>语句从任务3中编辑的文本初始化参数文件为备用数据库创建服务器参数文件。例如：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE SPFILE FROM PFILE ='initboston.ora';</pre></div>
                        </li>
                        <li class="stepexpand"><span>如果主数据库具有数据库加密钱包，则将其复制到备用数据库系统并配置备用数据库以使用此钱包。</span><div>
                              <div class="infoboxnote" id="GUID-2FD8DBAB-C439-4F03-9A94-01C6FEF33392__GUID-F01449D9-4D5B-4578-8D7B-AF51FFD8DF1C">
                                 <p class="notep1">注意：</p>
                                 <p>每当更新主加密密钥时，必须将数据库加密钱包从主数据库系统复制到每个备用数据库系统。</p>
                                 <p>除非备用数据库配置为指向包含主数据库中当前主加密密钥的数据库加密钱包或硬件安全模块，否则无法访问备用数据库中的加密数据。</p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="SBYDB4727"></a><div class="props_rev_3"><a id="GUID-3D65210D-9FE5-490E-938E-57FC2E07A569" name="GUID-3D65210D-9FE5-490E-938E-57FC2E07A569"></a><h4 id="SBYDB-GUID-3D65210D-9FE5-490E-938E-57FC2E07A569" class="sect4"><span class="enumeration_section">3.2.6</span>创建物理备用任务6：启动物理备用数据库</h4>
                  <div>
                     <p>这些是启动物理备用数据库和重做应用的步骤。</p>
                     <ol>
                        <li class="stepexpand"><span>在备用数据库上，发出以下SQL语句以启动并装入数据库：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; STARTUP MOUNT;</pre></div>
                        </li>
                        <li class="stepexpand"><span>恢复在<a href="creating-oracle-data-guard-physical-standby.html#GUID-C40DD1FB-1DB5-4674-839D-D17ECA99FB93" title="You can use any backup copy of the primary database to create the physical standby database, as long as you have the necessary archived redo log files to completely recover the database.">创建主数据库数据文件的备份副本中</a>获取的数据文件<a href="creating-oracle-data-guard-physical-standby.html#GUID-C40DD1FB-1DB5-4674-839D-D17ECA99FB93" title="只要拥有必要的归档重做日志文件以完全恢复数据库，就可以使用主数据库的任何备份副本来创建物理备用数据库。">的备份，</a>并将其复制<a href="creating-oracle-data-guard-physical-standby.html#GUID-4834C26E-6493-4C5A-91F7-680FD43FADF7" title="Ensure that all required directories are created. Use an operating system copy utility to copy binary files from the primary system to their correct locations on the standby system.">到主系统</a>中的<a href="creating-oracle-data-guard-physical-standby.html#GUID-4834C26E-6493-4C5A-91F7-680FD43FADF7" title="确保已创建所有必需的目录。使用操作系统复制实用程序将二进制文件从主系统复制到备用系统上的正确位置。">复制文件中，并备份到备用系统</a>上的备用系统。</span></li>
                        <li class="stepexpand"><span>在备用数据库上，发出以下命令以启动重做应用：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE RECOVER MANAGED STANDBY DATABASE  - &gt;从会话断开连接;</pre><p>该语句包括<code class="codeph">DISCONNECT FROM SESSION</code>选项，以便Redo Apply在后台会话中运行。
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="SBYDB4728"></a><div class="props_rev_3"><a id="GUID-AAA6D97B-A345-4825-A320-B662BB16E2ED" name="GUID-AAA6D97B-A345-4825-A320-B662BB16E2ED"></a><h4 id="SBYDB-GUID-AAA6D97B-A345-4825-A320-B662BB16E2ED" class="sect4"><span class="enumeration_section">3.2.7</span>创建物理备用任务7：验证物理备用数据库是否正常运行</h4>
                  <div>
                     <p>创建物理备用数据库并设置重做传输服务后，您可能希望验证数据库修改是否已成功从主数据库传输到备用数据库。</p>
                     <div class="section">
                        <p>在备用数据库上，查询<code class="codeph">V$DATAGUARD_PROCESS</code>视图以验证是否正在从主数据库传输重做并将其应用于备用数据库。
                        </p><pre class="pre codeblock"><code>SQL&gt; SELECT ROLE，THREAD＃，SEQUENCE＃，来自V $ DATAGUARD_PROCESS的行动;角色＃SEQUENCE＃ACTION ------------------------ ---------- ---------- ------------ RFS ping 1 9 IDLE恢复应用slave 0 0 IDLE恢复应用slave 0 0 IDLE managed recovery 0 0 IDLE recovery logmerger 1 9 APPLYING_LOG RFS archive 0 0 IDLE RFS async 1 9 IDLE</code></pre><p><code class="codeph">recovery logmerger</code>角色显示正在备用数据库中应用重做。
                        </p>
                        <div class="infoboxnote" id="GUID-AAA6D97B-A345-4825-A320-B662BB16E2ED__GUID-06BE2ED0-AC7E-44B3-9009-CEDDBB1D1F3F">
                           <p class="notep1">注意：</p>
                           <p>Oracle建议您使用<code class="codeph">V$DATAGUARD_PROCESS</code>视图而不是<code class="codeph">V$MANAGED_STANDBY</code>视图，该视图自Oracle Database 12 <span class="italic">c</span>第2版（12.2.0.1）起不再使用，并且可能在将来的发行版中被禁用。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="SBYDB4729"></a><div class="props_rev_3"><a id="GUID-3A0F8F9C-EF69-4BE4-9F7B-98AED4BEC4AC" name="GUID-3A0F8F9C-EF69-4BE4-9F7B-98AED4BEC4AC"></a><h3 id="SBYDB-GUID-3A0F8F9C-EF69-4BE4-9F7B-98AED4BEC4AC" class="sect3"><span class="enumeration_section">3.3</span>创建物理备用：创建后步骤</h3>
               <div>
                  <p>物理备用数据库运行后，可以升级数据保护模式，也可以启用闪回数据库。</p>
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>升级数据保护模式</p>
                           <p><a href="oracle-data-guard-protection-modes.html#GUID-16298839-9B8A-4E58-8EC9-27912E57F1CE" title="Oracle Data Guard允许您设置不同的数据保护模式。">Oracle Data Guard保护模式</a>提供有关配置不同数据保护模式的信息。
                           </p>
                        </li>
                        <li>
                           <p>启用闪回数据库</p>
                           <p>闪回数据库无需在故障转移后重新创建主数据库。闪回数据库使您能够在最近的某个时间将数据库返回到其状态，这比传统的时间点恢复快得多，因为它不需要从备份恢复数据文件，也不需要重做数据的广泛应用。您可以在主数据库，备用数据库或两者上启用闪回数据库。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-3A0F8F9C-EF69-4BE4-9F7B-98AED4BEC4AC__GUID-8F0493AE-E67B-4CEE-8C3F-3F33CCE172C6">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="examples-of-using-oracle-data-guard.html#GUID-1163448F-6B18-4A44-AA8D-7CDF0D1360FB" title="After a failover occurs, the original primary database can no longer participate in the Oracle Data Guard configuration until it is repaired and established as a standby database in the new configuration.">使用闪回数据库</a>和<a href="examples-of-using-oracle-data-guard.html#GUID-BAA5ED38-29A0-4E8D-8435-AA083D19C13E" title="If an error occurrs on the primary database in an Oracle Data Guard configuration in which the standby database is using real-time apply, then the same error is applied on the standby database. if Flashback Database is enabled, you can revert the primary and standby databases back to their pre-error condition.">使用闪回数据库</a> <a href="examples-of-using-oracle-data-guard.html#GUID-1163448F-6B18-4A44-AA8D-7CDF0D1360FB" title="发生故障转移后，原始主数据库无法再参与Oracle Data Guard配置，直到在新配置中将其修复并建立为备用数据库。">将失败的主数据库转换为备用数据库</a> <a href="examples-of-using-oracle-data-guard.html#GUID-BAA5ED38-29A0-4E8D-8435-AA083D19C13E" title="如果备用数据库使用实时应用的Oracle Data Guard配置中的主数据库发生错误，则在备用数据库上应用相同的错误。如果启用了闪回数据库，则可以将主数据库和备用数据库还原为其错误前的状态。">发布Open Resetlogs语句后</a> ，显示如何在Oracle Data Guard环境中使用闪回数据库的方案</p>
                           </li>
                           <li>
                              <p>有关闪回数据库的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV71000" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-7C55FE8A-50C3-4601-9ADA-98BE6D65F1DD" name="GUID-7C55FE8A-50C3-4601-9ADA-98BE6D65F1DD"></a><h3 id="SBYDB-GUID-7C55FE8A-50C3-4601-9ADA-98BE6D65F1DD" class="sect3"><span class="enumeration_section">3.4</span>使用DBCA创建Data Guard待机</h3>
               <div>
                  <p>Database Configuration Assistant（DBCA）还可以用作创建Oracle Data Guard物理备用数据库的简单命令行方法。</p>
                  <div class="section">用于创建物理备用数据库的DBCA命令限定符是<code class="codeph">createDuplicateDB</code> 。
                     <p>DBCA只能用于为非多租户主数据库创建备用数据库。此外，此功能仅创建单实例备用数据库，而不是Oracle Real Application Clusters（Oracle RAC）数据库。如果需要，可以手动或使用Oracle Enterprise Manager Cloud Control将备用数据库转换为Oracle RAC备用数据库。</p>
                     <p>基本的<code class="codeph">createDuplicateDB</code>命令具有以下语法：</p><pre class="pre codeblock"><code>dbca -createDuplicateDB -gdbName global_database_name -primaryDBConnectionString easy_connect_string_to_primary -sid database_system_identifier [-createAsStandby [-dbUniqueName db_unique_name_for_standby]] [-customScripts scripts_list]</code></pre><p>有关<code class="codeph">createDuplicateDB</code>选项的更多信息，包括使用自定义脚本，请参阅“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ADMIN-GUID-7F4B1A64-5B08-425A-A62E-854542B3FD4E" target="_blank"><span><cite>Oracle数据库管理员指南”</cite></span></a> 。
                     </p>
                     <p>在以下两个示例中，主数据库是<code class="codeph">chicago</code> ，它位于主系统<code class="codeph">myprimary.domain</code> 。每个示例都在执行命令的系统上创建物理备用数据库， <code class="codeph">boston</code> 。在示例中使用<code class="codeph">initParams</code>参数来说明如何在备用创建命令中使用其他DBCA参数。在这些示例中， <code class="codeph">initParams</code>用于显式设置备用数据库的<code class="codeph">INSTANCE_NAME</code>以匹配<code class="codeph">DB_UNIQUE_NAME</code> ， <code class="codeph">boston</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>第一个示例创建备用数据库，之后不执行任何自定义脚本。</p><pre class="pre codeblock"><code>dbca -silent -createDuplicateDB -primaryDBConnectionString myprimary.domain：1523 / chicago.domain -gdbName chicago.domain -sid boston -initParams instance_name = boston -createAsStandby</code></pre><pre class="pre codeblock"><code>输入SYS用户密码：监听器配置步骤33％完成辅助实例创建66％完成RMAN重复100％完成查看日志文件“/u01/app/oracle/product/12.2.0/dbhome_1/cfgtoollogs/dbca/chicago/chicago .log“了解更多详情。
</code></pre><p>以下示例与上一示例完全相同，不同之处在于它运行名为<code class="codeph">/tmp/test.sql</code>的SQL脚本，该脚本可用于执行创建后操作。
                     </p><pre class="pre codeblock"><code>dbca -silent -createDuplicateDB -primaryDBConnectionString myprimary.domain：1523 / chicago.domain -gdbName chicago.domain -sid boston -initParams instance_name = boston -createAsStandby -customScripts /tmp/test.sql</code></pre><pre class="pre codeblock"><code>输入SYS用户密码：监听器配置步骤25％完成辅助实例创建50％完成RMAN重复75％完成运行自定义脚本100％完成查看日志文件“/u01/app/oracle/product/12.2.0/dbhome_1/cfgtoollogs /dbca/chicago/chicago.log“了解更多详情。</code></pre><div class="infoboxnote" id="GUID-7C55FE8A-50C3-4601-9ADA-98BE6D65F1DD__GUID-63C5A9DB-F02C-4A57-B495-D843724CE629">
                        <p class="notep1">注意：</p>即使需要在物理备用系统上运行侦听器，也不必为任一系统上的数据库配置Oracle Net服务名称来执行这些命令。在这些示例中，Easy Connect命名方法用于创建与主数据库<code class="codeph">Chicago</code>的连接，以完成备用数据库<code class="codeph">Boston</code>创建。在将新备用数据库添加到Data Guard配置之前，首先要在两个系统上配置Oracle Net服务名称描述符，如<a href="creating-oracle-data-guard-physical-standby.html#GUID-2FD8DBAB-C439-4F03-9A94-01C6FEF33392" title="Set up the environment by creating a Windows-based service, a password file and an SPFILE, and setting up the Oracle Net environment.">创建物理备用任务5：设置环境以支持备用数据库</a>中的步骤4 <a href="creating-oracle-data-guard-physical-standby.html#GUID-2FD8DBAB-C439-4F03-9A94-01C6FEF33392" title="通过创建基于Windows的服务，密码文件和SPFILE以及设置Oracle Net环境来设置环境。">所述</a> 。
                     </div>
                     <p>当这些命令完成且没有任何错误时，物理备用<code class="codeph">Boston</code>就可以添加到Data Guard配置中。作为添加它的一部分，您需要在<code class="codeph">Chicago</code>和<code class="codeph">Boston</code>定义Data Guard参数，如<a href="creating-oracle-data-guard-physical-standby.html#GUID-06FDC24C-6E90-420B-BB63-3B6BAC4D8AFA" title="从主数据库使用的服务器参数文件（SPFILE）创建参数文件（PFILE）。">创建物理备用任务3：为备用数据库创建参数文件中所示</a> 。（可选）如果您具有Oracle Data Guard代理配置，则可以使用代理<code class="codeph">ADD DATABASE</code>命令将新备用<code class="codeph">ADD DATABASE</code>添加到您的配置中（请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=DGBKR-GUID-EA723918-2509-4BBC-871B-163885DE3C73" target="_blank"><span><cite>Oracle Data Guard Broker</cite></span></a> ）。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="SBYDB5213"></a><div class="props_rev_3"><a id="GUID-D5F0EB8F-8534-462A-911C-216E6DC7CE69" name="GUID-D5F0EB8F-8534-462A-911C-216E6DC7CE69"></a><h3 id="SBYDB-GUID-D5F0EB8F-8534-462A-911C-216E6DC7CE69" class="sect3"><span class="enumeration_section">3.5</span>创建CDB的物理备用</h3>
               <div>
                  <p>您可以创建多租户容器数据库（CDB）的物理备用数据库，就像创建常规主数据库的物理备用数据库一样。</p>
                  <p>以下是在创建和使用CDB的物理备用时要注意的一些行为差异：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果执行切换或故障转移操作，则整个CDB将进行角色更改。如果您使用了<code class="codeph">ENABLED_PDBS_ON_STANDBY</code>初始化参数，那么请注意主数据库和备用数据库中不存在每个PDB的可能性。
                        </p>
                     </li>
                     <li>
                        <p>数据库角色在CDB级别定义，而不是在单个容器级别定义。</p>
                     </li>
                     <li>
                        <p>任何与角色更改相关的DDL都必须在根容器中执行，因为角色与整个CDB相关联。各个可插拔数据库（PDB）没有自己的角色。</p>
                     </li>
                     <li>
                        <p>在CDB的物理备用数据库中，SQL语句的语法通常与非容器数据库的语法相同。但是，某些声明（包括以下声明）的效果可能会有所不同：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">ALTER DATABASE RECOVER MANAGED STANDBY</code>仅在根容器中<code class="codeph">ALTER DATABASE RECOVER MANAGED STANDBY</code>函数;它不允许在PDB中使用。</p>
                           </li>
                           <li>
                              <p>角色与整个CDB相关联;个人PDB没有自己的角色。因此，以下角色更改与物理备用数据库关联的DDL会影响整个CDB：</p>
                              <p><code class="codeph">ALTER DATABASE SWITCHOVER到target_db_name</code></p>
                              <p><code class="codeph">ALTER DATABASE激活物理备用</code> 
                              </p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>如果您已经打开了根容器，则备用数据库支持<code class="codeph">ALTER PLUGGABLE DATABASE [OPEN|CLOSE]</code> SQL语句。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">ALTER PLUGGABLE DATABASE RECOVER</code>不支持<code class="codeph">ALTER PLUGGABLE DATABASE RECOVER</code>语句。（待机恢复始终处于CDB级别。）
                        </p>
                     </li>
                     <li>
                        <p>要管理多租户环境，您必须具有<code class="codeph">CDB_DBA</code>角色。
                        </p>
                     </li>
                     <li>
                        <p>Oracle建议备用数据库有自己的密钥库。</p>
                     </li>
                     <li>
                        <p>在多租户环境中，必须将重做传送到备用数据库的根容器。</p>
                        <p>以下是如何确定是否将重做发送到根容器的示例。假设您的主数据库具有以下设置：</p><pre class="oac_no_warn" dir="ltr">LOG_ARCHIVE_DEST_2 ='SERVICE = boston ASYNC VALID_FOR =（ONLINE_LOGFILES，PRIMARY_ROLE）DB_UNIQUE_NAME = boston'</pre><p>Redo正被运往<code class="codeph">boston</code> 。根容器的容器ID（ <code class="codeph">CON_ID</code> ）始终为1，因此您必须确保服务<code class="codeph">boston</code>的<code class="codeph">CON_ID</code>为1。为此，请检查<code class="codeph">tnsnames.ora</code>文件中的服务名称。例如：</p><pre class="oac_no_warn" dir="ltr">boston =（DESCRIPTION =（ADDRESS =（PROTOCOL = tcp）（HOST = boston-server）（PORT = 1521））（CONNECT_DATA =（SERVICE_NAME = boston.us.example.com））</pre><p><code class="codeph">boston</code>的服务名称是<code class="codeph">boston.us.example.com</code> 。
                        </p>
                        <p>在备用数据库上，查询<code class="codeph">CDB_SERVICES</code>视图以确定<code class="codeph">CON_ID</code> 。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT NAME，CON_ID FROM CDB_SERVICES; NAME CON_ID --------------------------------------------- boston.us .example.com 1</pre><p>查询结果显示<code class="codeph">boston</code>的<code class="codeph">CON_ID</code>为1。
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-D5F0EB8F-8534-462A-911C-216E6DC7CE69__GUID-729D8B44-38CE-4544-8064-CB5B4464B758">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关CDB的更多信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=CNCPT89249" target="_blank"><span class="italic">Oracle数据库概念</span></a></p>
                        </li>
                        <li>
                           <p>有关创建密钥库的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ASOAG10284" target="_blank"><span class="italic">“Oracle数据库高级安全性指南</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="SBYDB5260"></a><div class="props_rev_3"><a id="GUID-20D2DEAC-0355-4FBB-ADB8-37BF5F4328E2" name="GUID-20D2DEAC-0355-4FBB-ADB8-37BF5F4328E2"></a><h3 id="SBYDB-GUID-20D2DEAC-0355-4FBB-ADB8-37BF5F4328E2" class="sect3"><span class="enumeration_section">3.6</span>在主数据库中创建PDB</h3>
               <div>
                  <p>在Oracle Data Guard配置中，主数据库上的可插拔数据库（PDB）的创建方式与创建常规数据库上的PDB的方式相同。</p>
                  <p>本主题列出了在执行任何类型的PDB创建时Data Guard和Oracle Multitenant选项如何交互的关键点。有关详细信息和示例，请参阅<a href="http://support.oracle.com" target="_blank"><code class="codeph">http://support.oracle.com</code></a> My Oracle Support说明2049127.1。</p>
                  <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=MULTI-GUID-C95E8613-C556-4818-BE64-B2129AC2F8A2" target="_blank"><span class="italic">Oracle Multitenant管理员指南</span></a>中介绍了在常规数据库上创建PDB的步骤。在执行这些步骤之前，请务必阅读以下内容：</p>
                  <p></p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>您可以指定要在多租户容器数据库（CDB）的物理备用数据库上复制的PDB子集。为此，请使用<code class="codeph">ENABLED_PDBS_ON_STANDBY</code>初始化参数指定PDB列表或在<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句中使用<code class="codeph">STANDBYS</code>子句，或两者都使用。
                        </p>
                        <p><code class="codeph">ENABLED_PDBS_ON_STANDBY</code>参数（请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN-GUID-A2EC2381-D9C0-4612-87C9-A225C7BCE8C4" target="_blank">ENABLED_PDBS_ON_STANDBY</a> ）仅在物理备用数据库上有效;它被主数据库忽略。（如果该数据库成为备用数据库，则可以在主数据库上设置它。）它可用于指定在物理备用数据库上应该或不应该启用哪些PDB。如果未指定参数，则除非使用<code class="codeph">STANDBYS</code>子句，否则将在备用数据库上创建CDB中的所有PDB。
                        </p>
                        <p><code class="codeph">STANDBYS</code>子句对以后是启用还是禁用恢复没有影响。SQL <code class="codeph">CREATE PLUGGABLE DATABASE</code>语句的<code class="codeph">STANDBYS</code>子句具有以下语法：</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE ... STANDBYS = {（ <span class="variable" translate="no">'cdb_name', 'cdb_name', ...</span> ）|没有| ALL [ <span class="variable" translate="no">'cdb_name', 'cdb_name', ...</span> （ <span class="variable" translate="no">'cdb_name', 'cdb_name', ...</span> ）]}</code></pre><ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph"><span class="codeinlineitalic">cdb_name</span></code>是要包含PDB的物理备用<code class="codeph"><span class="codeinlineitalic">cdb_name</span></code>的<code class="codeph">DB_UNIQUE_NAME</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">NONE</code>排除在任何备用CDB中创建PDB。当PDB从所有备用CDB中排除时，PDB的数据文件处于脱机状态，并在所有备用CDB上标记为未命名。在创建PDB之后实例化的任何新备用CDB必须禁用PDB以进行明确恢复，以将其从备用CDB中排除。在备用CDB上排除PDB之后，可以在备用CDB上启用PDB。</p>
                           </li>
                           <li>
                              <p><code class="codeph">ALL</code> （默认值）包括在所有备用CDB中创建的PDB。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">EXCEPT <span class="codeinlineitalic">cdb_name</span></code>包括在所有备用CDB中创建的PDB，但<code class="codeph">DB_UNIQUE_NAME</code>中此子句中列出的CDB除外。</p>
                           </li>
                        </ul>
                        <p>当在<code class="codeph">STANDBYS</code>子句中提供CDB名称列表时，列表必须括在括号中，并且每个名称必须用单引号括起来。<code class="codeph">DB_UNIQUE_NAME</code>的值最多为30个字符，不区分大小写。以下字符在数据库名称中有效：字母数字字符，下划线（_），数字符号（＃）和美元符号（$）。
                        </p>
                        <p>列表中的备用数据库必须预先填充所需的文件，除非从种子创建PDB，或者备用数据库运行Active Data Guard的本地克隆，或使用<code class="codeph">STANDBY_PDB_SOURCE_FILE_DBLINK</code>参数的远程克隆。
                        </p>
                        <p></p>
                     </li>
                     <li>
                        <div class="p">当您从另一个PDB或同一主CDB中的种子PDB创建PDB作为本地克隆时，请注意以下事项：<ul style="list-style-type:disc">
                              <li>
                                 <p>从种子创建新的PDB时，备用数据库会自动实例化文件。</p>
                              </li>
                              <li>
                                 <p>在Active Data Guard环境中，当PDB克隆在同一CDB中时，Data Guard会自动实例化文件。</p>
                              </li>
                              <li>
                                 <p>在非Active Data Guard环境中，当PDB克隆在同一CDB中时，请在<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句中使用<code class="codeph">STANDBYS</code>子句，并在以后启用恢复。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <p></p>
                     </li>
                     <li>
                        <div class="p">要在执行PDB远程克隆或插件时自动维护备用数据库，请使用以下初始化参数：<ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">STANDBY_PDB_SOURCE_FILE_DBLINK</code> - 用于远程克隆。指定用于在主服务器上克隆PDB的数据库链接的名称。当在备用数据库上应用PDB克隆操作的重做时，它使用该数据库链接连接到源数据库，以将克隆进程重复到目标备用数据库。此参数仅在Active Data Guard中可用，因为它访问数据库字典以获取有关链接的特定信息。
                                 </p>
                                 <p>克隆操作的源PDB必须处于只读模式，持续时间为克隆到主服务器和克隆到备用服务器。</p>
                                 <p>在<span class="italic">不</span>使用<code class="codeph">STANDBY_PDB_SOURCE_FILE_DBLINK</code>参数的远程克隆上，用于创建PDB的SQL <code class="codeph">CREATE PLUGGABLE DATABASE</code>语句必须使用<code class="codeph">STANDBYS=NONE</code>子句。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">STANDBY_PDB_SOURCE_FILE_DIRECTORY</code> - 用于插件。指定存储用于重复插件的PDB文件的目录位置。当在备用数据库中应用PDB插件操作的重做时，它会在目录位置搜索数据文件，找到它们后，将它们复制到备用数据库要求它们基于<code class="codeph">DB_CREATE_FILE_DEST</code>和<code class="codeph">DB_FILE_NAME_CONVERT</code>参数设置的<code class="codeph">DB_CREATE_FILE_DEST</code> 。
                                 </p>
                                 <div class="infoboxnote" id="GUID-20D2DEAC-0355-4FBB-ADB8-37BF5F4328E2__GUID-A55C24FE-9EC1-4E74-81B4-D761B10ED658">
                                    <p class="notep1">注意：</p>这些文件必须是源PDB数据文件的映像副本。应在为源PDB创建清单XML文件后创建副本。</div>
                              </li>
                           </ul>
                        </div>
                        <p>这些参数应在使用后重置，不再需要。设置和重置这些参数不会对运行时产生影响，因为这样做不需要重新启动实例。</p>
                        <p>有关使用这些参数的详细信息，请参阅<a href="http://support.oracle.com" target="_blank"><code class="codeph">http://support.oracle.com</code></a> My Oracle Support说明2274735.1。
                        </p>
                     </li>
                     <li>
                        <p>要从XML文件创建PDB，请将XML文件中指定的数据文件复制到备用数据库。</p>
                        <p>当PDB从XML文件插入主数据库时，必须允许配置中的所有备用数据库访问源PDB的文件。（唯一的例外是通过使用<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句中的<code class="codeph">STANDBYS</code>子句或<code class="codeph">ENABLED_PDBS_ON_STANDBY</code>初始化参数来延迟恢复的<code class="codeph">CREATE PLUGGABLE DATABASE</code> 。）
                        </p>
                        <p>要在配置中提供可访问源PDB文件的备用数据库，请使用<code class="codeph">STANDBY_PDB_SOURCE_FILE_DIRECTORY</code>初始化参数或将源PDB的文件复制到备用站点，通常是要插入主数据库的同一组PDB文件。在主数据库执行插件操作之前，应将文件复制到备用数据库，以最大限度地减少对托管备用数据库恢复的中断。确保将文件复制到备用数据库中适当的位置，托管备用数据库恢复可以在其中找到它们，如下所示：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果数据文件驻留在标准操作系统文件系统中，则备用数据库中文件的位置基于<code class="codeph">DB_FILE_NAME_CONVERT</code>参数的值。有关设置主数据库初始化参数的更多详细信息，请参阅<a href="creating-oracle-data-guard-physical-standby.html#GUID-0FD317D6-1A49-4DB3-A141-D00CB3089E84" title="在主数据库上，您可以定义在数据库处于主要角色时控制重做传输服务的初始化参数。">设置主数据库初始化参数</a></p>
                           </li>
                           <li>
                              <p>如果数据文件驻留在ASM中，则使用ASMCMD实用程序将文件复制到备用数据库中的以下位置：</p><pre class="oac_no_warn" dir="ltr"><code class="codeph"><span class="codeinlineitalic">db_create_file_dest</span></code> / <code class="codeph"><span class="codeinlineitalic">db_unique_name</span></code> / <code class="codeph"><span class="codeinlineitalic">GUID</span></code> / datafile</pre><p><code class="codeph">GUID</code>参数是分配给PDB的全局唯一标识符;一旦分配，它不会改变。要查找<code class="codeph">GUID</code>参数的值，请在从原始源容器中拔出PDB之前查询<code class="codeph">V$CONTAINERS</code>视图。以下示例显示如何查找源容器中PDB容器ID为<code class="codeph">3</code>的PDB的<code class="codeph">GUID</code>参数值：</p><pre class="oac_no_warn" dir="ltr">SELECT guid FROM V $ CONTAINERS WHERE con_id = 3; GUID D98C12257A951FC4E043B623F00A7AF5</pre><p>在此示例中，如果<code class="codeph">DB_CREATE_FILE_DEST</code>参数的值为<code class="codeph">+DATAFILE</code>且<code class="codeph">DB_UNIQUE_NAME</code>参数的值为<code class="codeph">BOSTON</code> ，则数据文件将复制到：</p><pre class="oac_no_warn" dir="ltr">+ DATAFILE / BOSTON / D98C12257A951FC4E043B623F00A7AF5 /数据文件</pre></li>
                        </ul>
                     </li>
                  </ul>
                  <p>除非在<code class="codeph">DB_FILE_NAME_CONVERT</code>数据库上配置了<code class="codeph">DB_FILE_NAME_CONVERT</code>数据库初始化参数，否则备用数据库上的数据文件的路径名必须与在主数据库上创建PDB时的结果路径名相同。在这种情况下，备用数据库上的数据文件的路径名是应用了<code class="codeph">DB_FILE_NAME_CONVERT</code>的主数据库上的路径名。
                  </p>
                  <div class="infoboxnotealso" id="GUID-20D2DEAC-0355-4FBB-ADB8-37BF5F4328E2__GUID-2E301C1C-F712-488E-90EB-68248F5D0901">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关SQL语句<code class="codeph">CREATE</code> <code class="codeph">PLUGGABLE</code> <code class="codeph">DATABASE</code>详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=SQLRF55686" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="13251.database-gateway-teradata-initialization-parameters.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>初始化参数</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="User&#39;s Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-gateway-teradata-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-16T14:59:05-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96407-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="database-gateway-teradata-data-dictionary.html" title="Previous" type="text/html"></link>
      <link rel="next" href="book-index.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Gateway for Teradata User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="TGTEU"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="database-gateway-teradata-data-dictionary.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="book-index.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">用户指导</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">初始化参数</li>
            </ol>
            <a id="GUID-56B7E4D7-1AC9-4131-9C57-99FCD84CF6FA" name="GUID-56B7E4D7-1AC9-4131-9C57-99FCD84CF6FA"></a><a id="TGTEU700"></a>
            
            <h2 id="TGTEU-GUID-56B7E4D7-1AC9-4131-9C57-99FCD84CF6FA" class="sect2"><span class="enumeration_appendix">D</span>初始化参数</h2>
         </header>
         <div class="ind">
            <div>
               <p><code class="codeph">init.ora</code>文件中的Oracle数据库初始化参数与网关初始化参数不同。使用特定于代理的机制在初始化参数文件中设置网关参数，或使用<code class="codeph">DBMS_HS</code>包在Oracle数据字典中设置它们。<a id="d50028e36" class="indexterm-anchor"></a>网关启动时，网关初始化参数文件必须可用。
               </p>
               <p>以下主题包含可以为每个网关及其描述设置的网关初始化参数的列表。主题还描述了初始化参数文件语法：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-C38B911C-9727-432D-8F47-C5E9B51EDE8D">初始化参数文件语法</a></p>
                  </li>
                  <li>
                     <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-2F38FD5A-1B90-4044-9B57-0F8E76A4E9B1">用于Teradata初始化参数的Oracle数据库网关</a></p>
                  </li>
               </ul>
            </div><a id="TGTEU777"></a><div class="props_rev_3"><a id="GUID-C38B911C-9727-432D-8F47-C5E9B51EDE8D" name="GUID-C38B911C-9727-432D-8F47-C5E9B51EDE8D"></a><h3 id="TGTEU-GUID-C38B911C-9727-432D-8F47-C5E9B51EDE8D" class="sect3">初始化参数文件语法</h3>
               <div>
                  <p>初始化参数文件的语法如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>该文件是一系列命令。</p>
                     </li>
                     <li>
                        <p>每个命令应该从单独的一行开始。</p>
                     </li>
                     <li>
                        <p>行尾被视为命令终止符（除非使用反斜杠进行转义）。</p>
                     </li>
                     <li>
                        <p>如果初始化参数文件中存在语法错误，则所有设置都不会生效。</p>
                     </li>
                     <li>
                        <p>设置参数值如下：</p><pre class="oac_no_warn" dir="ltr">[SET] [PRIVATE] <span class="italic">参数</span> = <span class="italic">值</span>
</pre><p>哪里：</p>
                        <p><span class="italic"><code class="codeph">parameter</code></span>是初始化参数名称。它是一个以字母开头的字符串，由字母，数字和下划线组成。初始化参数名称区分大小写。
                        </p>
                        <p><span class="italic"><code class="codeph">value</code></span>是初始化参数值。它区分大小写。初始化参数值是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>一串不包含任何反斜杠，空格或双引号的字符（“）</p>
                           </li>
                           <li>
                              <p>带引号的字符串，以双引号开头，以双引号结尾。以下内容可以在带引号的字符串中使用：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>反斜杠（\）是转义字符</p>
                                 </li>
                                 <li>
                                    <p>\ n插入一个新行</p>
                                 </li>
                                 <li>
                                    <p>\ t插入一个标签</p>
                                 </li>
                                 <li>
                                    <p>\“插入双引号</p>
                                 </li>
                                 <li>
                                    <p>\\插入一个反斜杠</p>
                                 </li>
                              </ul>
                              <p>该行末尾的反斜杠继续下一行的字符串。如果反斜杠在任何其他字符之前，则忽略反斜杠。</p>
                           </li>
                        </ul>
                        <p>例如，要为代理启用跟踪，请按如下所示设置<code class="codeph">HS_FDS_TRACE_LEVEL</code>初始化参数：</p><pre class="oac_no_warn" dir="ltr"><a id="d50028e153" class="indexterm-anchor"></a> HS_FDS_TRACE_LEVEL = ON</pre><p><code class="codeph">SET</code>和<code class="codeph">PRIVATE</code>是可选关键字。您不能将它们用作初始化参数名称。大多数参数仅作为初始化参数需要，因此您通常不需要使用<code class="codeph">SET</code>或<code class="codeph">PRIVATE</code>关键字。如果未指定<code class="codeph">SET</code>或<code class="codeph">PRIVATE</code> ，则该参数仅用作代理的初始化参数。
                        </p>
                        <p><code class="codeph">SET</code>指定除了用作初始化参数之外，还将参数值设置为代理进程的环境变量。将<code class="codeph">SET</code>用于驱动程序或非Oracle系统需要的参数值作为环境变量。
                        </p>
                        <p><code class="codeph">PRIVATE</code>指定初始化参数应该是代理的私有参数，不应上载到Oracle数据库。大多数初始化参数不应该是私有的。但是，如果您在初始化参数文件中存储密码等敏感信息，则可能不希望将其上载到服务器，因为上载时初始化参数和值未加密。将初始化参数设置为私有可防止上载发生，并且它们不会出现在动态性能视图中。仅当参数值包含敏感信息（如用户名或密码）时，才使用<code class="codeph">PRIVATE</code>作为初始化参数。
                        </p>
                        <p><code class="codeph">SET PRIVATE</code>指定将参数值设置为代理进程的环境变量，并且也是私有的（不会传输到Oracle数据库，不会出现在动态性能视图或图形用户界面中）。
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="TGTEU778"></a><div class="props_rev_3"><a id="GUID-2F38FD5A-1B90-4044-9B57-0F8E76A4E9B1" name="GUID-2F38FD5A-1B90-4044-9B57-0F8E76A4E9B1"></a><h3 id="TGTEU-GUID-2F38FD5A-1B90-4044-9B57-0F8E76A4E9B1" class="sect3">用于Teradata初始化参数的Oracle数据库网关</h3>
               <div>
                  <p>可以为Oracle数据库网关为Teradata设置的初始化文件参数如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-ABAF13CE-4EB3-4BD2-A4B1-A03433CDD7D8">HS_DB_DOMAIN</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-EDD14959-11CA-473A-BCC4-2B125AC2B3A8">HS_DB_INTERNAL_NAME</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-D08290CB-791C-4B95-A3F9-3D66D156708D">HS_DB_NAME</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-013E889E-EA7B-46C0-BD7D-FC80679DFCF0">HS_DESCRIBE_CACHE_HWM</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-E4826893-8171-4FB4-A19E-A5A8FD5D769E">HS_LANGUAGE</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-7CA4F700-4539-40D7-A4E1-44FB03C62742">HS_LONG_PIECE_TRANSFER_SIZE</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-ACF3083C-C719-4632-8753-FAFA81314EF4">HS_FDS_TRANSACTION_ISOLATION</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-4503E5A3-67B1-47F8-A80E-907DD7E0F1EB">HS_OPEN_CURSORS</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-6C54CEAF-9567-4A87-8E85-16F4B6A36AF8">HS_RPC_FETCH_REBLOCKING</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-DF8C9A6B-13DB-4B12-8611-6CA2EF8705B8">HS_RPC_FETCH_SIZE</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-510BDC6E-C5B8-4B72-9C23-29FD8157ACB0">HS_TIME_ZONE</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-BB426A9A-18C4-42FC-8B63-00A8C74FB0BD">HS_TRANSACTION_MODEL</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-A53E8406-90F0-40C6-88AA-F90EC9294FAA">IFILE</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-DBA98566-83BE-4F75-8414-421AF53D97CC">HS_FDS_TIMESTAMP_MAPPING</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-542C4567-401B-4179-B65E-8F5115E018D3">HS_FDS_DATE_MAPPING</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-92DD5A68-BB68-4F6A-A827-269736BE9A71">HS_FDS_CONNECT_INFO</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-633870AE-C406-4F7A-88DF-FA57268B218E">HS_FDS_DEFAULT_OWNER</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-0AD6E23D-5A44-4271-AA76-01502C8C1D77">HS_FDS_PROC_IS_FUNC</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-92E85665-F297-49F7-A890-2D7E082047E7">HS_FDS_RECOVERY_ACCOUNT</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-D5824757-5962-4390-AAE9-6DD0F5D0A625">HS_FDS_RECOVERY_PWD</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-3A22053F-B192-4BF3-9B59-37AF55D510C0">HS_FDS_TRACE_LEVEL</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-60678D9A-1FEB-4E00-BD58-2C12344F8616">HS_FDS_TRANSACTION_LOG</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-B8749B60-A732-47BD-80B0-D2403B78BBF6">HS_FDS_FETCH_ROWS</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-30EC3A94-A763-41B5-9A94-E409C460D280">HS_IDLE_TIMEOUT</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-A65591F1-CACC-4F49-B470-EEB1F7C119F6">HS_NLS_LENGTH_SEMANTICS</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-37029C90-769B-4F2A-8017-1AB7301D95E4">HS_KEEP_REMOTE_COLUMN_SIZE</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-752C716A-AA41-4C56-8780-A9236F064B73">HS_FDS_REMOTE_DB_CHARSET</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-825C590C-2B22-4FAA-A648-383395F98CB1">HS_FDS_SUPPORT_STATISTICS</a></p>
                     </li>
                     <li>
                        <p><a href="database-gateway-teradata-initialization-parameters.html#GUID-0DC5EDD6-E86E-4CBC-BFB0-DAB851B213E1">HS_FDS_ARRAY_EXEC</a></p>
                     </li>
                  </ul>
               </div>
            </div><a id="TGTEU780"></a><div class="props_rev_3"><a id="GUID-ABAF13CE-4EB3-4BD2-A4B1-A03433CDD7D8" name="GUID-ABAF13CE-4EB3-4BD2-A4B1-A03433CDD7D8"></a><h3 id="TGTEU-GUID-ABAF13CE-4EB3-4BD2-A4B1-A03433CDD7D8" class="sect3">HS_DB_DOMAIN</h3>
               <div>
                  <div class="tblformal" id="GUID-ABAF13CE-4EB3-4BD2-A4B1-A03433CDD7D8__GUID-C816800F-DA05-4208-84F6-DC8305E9F32E">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e414">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e417">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e422" headers="d50028e414 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e422 d50028e417 ">
                                 <p><code class="codeph">世界</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e430" headers="d50028e414 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e430 d50028e417 ">
                                 <p><code class="codeph">1</code>到<code class="codeph">199</code>字符</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>为非Oracle系统指定唯一的网络子地址。<code class="codeph">HS_DB_DOMAIN</code>初始化参数类似于<a href="../refrn/PARALLEL_MIN_PERCENT.html#REFRN10159" target="_blank"><span class="variable" translate="no">Oracle Database Reference</span></a>描述的<code class="codeph">DB_DOMAIN</code>初始化参数。如果使用Oracle Names服务器，则需要<code class="codeph">HS_DB_DOMAIN</code>初始化参数。<code class="codeph">HS_DB_NAME</code>和<code class="codeph">HS_DB_DOMAIN</code>初始化参数定义非Oracle系统的全局名称。
                     </p>
                     <div class="infoboxnote" id="GUID-ABAF13CE-4EB3-4BD2-A4B1-A03433CDD7D8__GUID-F2E10B3B-931B-44E1-8A2C-6A5227B8241D">
                        <p class="notep1">注意：</p>
                        <p><code class="codeph">HS_DB_NAME</code>和<code class="codeph">HS_DB_DOMAIN</code>初始化参数必须组合以在协作服务器环境中形成唯一地址。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU781"></a><div class="props_rev_3"><a id="GUID-EDD14959-11CA-473A-BCC4-2B125AC2B3A8" name="GUID-EDD14959-11CA-473A-BCC4-2B125AC2B3A8"></a><h3 id="TGTEU-GUID-EDD14959-11CA-473A-BCC4-2B125AC2B3A8" class="sect3">HS_DB_INTERNAL_NAME</h3>
               <div>
                  <div class="tblformal" id="GUID-EDD14959-11CA-473A-BCC4-2B125AC2B3A8__GUID-835FB35D-655B-4421-8ABC-2C3A605884CC">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e512">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e515">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e520" headers="d50028e512 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e520 d50028e515 ">
                                 <p><code class="codeph">01010101</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e528" headers="d50028e512 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e528 d50028e515 ">
                                 <p><code class="codeph">1</code>到<code class="codeph">16</code>十六进制字符</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>指定标识异构服务代理连接到的实例的唯一十六进制数。激活全局名称服务时，此参数的值将用作事务ID的一部分。当事务需要两阶段提交恢复操作时，指定非唯一编号可能会导致问题。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU782"></a><div class="props_rev_3"><a id="GUID-D08290CB-791C-4B95-A3F9-3D66D156708D" name="GUID-D08290CB-791C-4B95-A3F9-3D66D156708D"></a><h3 id="TGTEU-GUID-D08290CB-791C-4B95-A3F9-3D66D156708D" class="sect3">HS_DB_NAME</h3>
               <div>
                  <div class="tblformal" id="GUID-D08290CB-791C-4B95-A3F9-3D66D156708D__GUID-51009491-8240-43FB-8E23-3D8813B345F6">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e580">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e583">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e588" headers="d50028e580 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e588 d50028e583 ">
                                 <p><code class="codeph">HO</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e596" headers="d50028e580 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e596 d50028e583 ">
                                 <p><code class="codeph">1</code>至<code class="codeph">8</code>字符</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>为给予非Oracle系统的数据存储指定唯一的字母数字名称。这个名字标识了<a id="d50028e610" class="indexterm-anchor"></a><a id="d50028e614" class="indexterm-anchor"></a>协作服务器环境中的非Oracle系统。<code class="codeph">HS_DB_NAME</code>和<code class="codeph">HS_DB_DOMAIN</code>初始化参数定义非Oracle系统的全局名称。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU783"></a><div class="props_rev_3"><a id="GUID-013E889E-EA7B-46C0-BD7D-FC80679DFCF0" name="GUID-013E889E-EA7B-46C0-BD7D-FC80679DFCF0"></a><h3 id="TGTEU-GUID-013E889E-EA7B-46C0-BD7D-FC80679DFCF0" class="sect3">HS_DESCRIBE_CACHE_HWM</h3>
               <div>
                  <div class="tblformal" id="GUID-013E889E-EA7B-46C0-BD7D-FC80679DFCF0__GUID-B6D77669-DDD4-4F03-A8F6-E25C45CB765F">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e662">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e665">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e670" headers="d50028e662 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e670 d50028e665 ">
                                 <p><code class="codeph">100</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e678" headers="d50028e662 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e678 d50028e665 ">
                                 <p><code class="codeph">1</code>到<code class="codeph">4000</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p><a id="d50028e690" class="indexterm-anchor"></a><a id="d50028e692" class="indexterm-anchor"></a>指定异构服务使用的描述高速缓存中的最大条目数。这个限制被称为<a id="d50028e697" class="indexterm-anchor"></a>描述缓存高水位线。缓存包含异构服务重用的映射表的描述，因此它不必重新访问非Oracle数据存储。
                     </p>
                     <p>如果要访问许多映射表，请增加高水位标记以提高性能。增加高水位标记会以内存使用为代价提高性能。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU784"></a><div class="props_rev_3"><a id="GUID-E4826893-8171-4FB4-A19E-A5A8FD5D769E" name="GUID-E4826893-8171-4FB4-A19E-A5A8FD5D769E"></a><h3 id="TGTEU-GUID-E4826893-8171-4FB4-A19E-A5A8FD5D769E" class="sect3">HS_LANGUAGE</h3>
               <div>
                  <div class="tblformal" id="GUID-E4826893-8171-4FB4-A19E-A5A8FD5D769E__GUID-023EF1DC-9692-4BE0-B7D5-823EC59594C9">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e750">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e753">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e758" headers="d50028e750 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e758 d50028e753 ">
                                 <p>系统专用</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e765" headers="d50028e750 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e765 d50028e753 ">
                                 <p>任何有效的语言名称（最多<code class="codeph">255</code>字符）</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>为异构服务提供非Oracle数据源的字符集，语言和区域信息。该值必须使用以下格式：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">语言</span> [_ <span class="italic">领土</span> 。 <span class="italic">character_set</span> ]</pre><div class="infoboxnote" id="GUID-E4826893-8171-4FB4-A19E-A5A8FD5D769E__GUID-DE9E4D86-11F4-4F1A-95F7-DF8ED07F362F">
                        <p class="notep1">注意：</p>
                        <p>全球化支持初始化参数会影响错误消息，SQL Service的数据以及分布式外部过程中的参数。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="TGTEU785"></a><div class="props_rev_3"><a id="GUID-B2C592D9-A9DE-4128-9D91-C6E0673C4F41" name="GUID-B2C592D9-A9DE-4128-9D91-C6E0673C4F41"></a><h4 id="TGTEU-GUID-B2C592D9-A9DE-4128-9D91-C6E0673C4F41" class="sect4">字符集</h4>
                  <div>
                     <p>理想情况下，Oracle数据库和非Oracle数据源的字符集是相同的。在几乎所有情况下， <code class="codeph">HS_LANGUAGE</code>应设置为与Oracle数据库字符集完全相同，以实现最佳字符集映射和性能。如果它们不相同，则异构服务会尝试将非Oracle数据源的字符集转换为Oracle数据库字符集，然后再返回。翻译会降低性能。在某些情况下，异构服务无法将字符从一个字符集转换为另一个字符集。
                     </p>
                     <div class="infoboxnote" id="GUID-B2C592D9-A9DE-4128-9D91-C6E0673C4F41__GUID-301EF4EC-6849-4BEF-A604-7F9F6EA892DC">
                        <p class="notep1">注意：</p>
                        <p>指定的字符集必须是安装代理程序的平台上的操作系统字符集的超集。</p>
                     </div>
                     <p>由于更多Oracle数据库和非Oracle数据库使用Unicode作为数据库字符集，因此最好还以Unicode字符集运行网关。为此，您必须设置<code class="codeph">HS_LANGUAGE=AL32UTF8</code> 。但是，当网关在Windows上运行时，Microsoft ODBC驱动程序管理器界面只能以双字节字符集UCS2交换数据。这导致所述缓冲液和柱尺寸的额外比率扩展。有关如何调整到正确尺寸的说明，请参阅<a href="database-gateway-teradata-initialization-parameters.html#GUID-752C716A-AA41-4C56-8780-A9236F064B73">HS_FDS_REMOTE_DB_CHARSET</a> 。
                     </p>
                  </div>
               </div><a id="TGTEU786"></a><div class="props_rev_3"><a id="GUID-8064217F-5D86-4DF0-9716-9F207F091703" name="GUID-8064217F-5D86-4DF0-9716-9F207F091703"></a><h4 id="TGTEU-GUID-8064217F-5D86-4DF0-9716-9F207F091703" class="sect4">语言</h4>
                  <div>
                     <p><code class="codeph">HS_LANGUAGE</code>初始化参数的语言组件确定：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>日期的日期和月份名称</p>
                        </li>
                        <li>
                           <p>日期和时间的AD，BC，PM和AM符号</p>
                        </li>
                        <li>
                           <p>默认排序机制</p>
                        </li>
                     </ul>
                     <p>请注意，Oracle不确定通用异构服务消息（ <code class="codeph">ORA-25000</code>到<code class="codeph">ORA-28000</code> ）的错误消息的语言。它们由Oracle数据库中的会话设置控制。
                     </p>
                  </div>
               </div><a id="TGTEU787"></a><div class="props_rev_3"><a id="GUID-9252A16E-0BE5-4CB6-AA65-6E0D64A1413E" name="GUID-9252A16E-0BE5-4CB6-AA65-6E0D64A1413E"></a><h4 id="TGTEU-GUID-9252A16E-0BE5-4CB6-AA65-6E0D64A1413E" class="sect4">领土</h4>
                  <div>
                     <p>territory子句指定日期和星期编号的约定，默认日期格式，十进制字符和组分隔符以及ISO和本地货币符号。请注意，Oracle数据库与非Oracle数据源之间的全球化支持级别取决于网关的实现方式。</p>
                  </div>
               </div>
            </div><a id="TGTEU788"></a><div class="props_rev_3"><a id="GUID-7CA4F700-4539-40D7-A4E1-44FB03C62742" name="GUID-7CA4F700-4539-40D7-A4E1-44FB03C62742"></a><h3 id="TGTEU-GUID-7CA4F700-4539-40D7-A4E1-44FB03C62742" class="sect3">HS_LONG_PIECE_TRANSFER_SIZE</h3>
               <div>
                  <div class="tblformal" id="GUID-7CA4F700-4539-40D7-A4E1-44FB03C62742__GUID-254E46F2-A9B3-45B6-8FD4-623EA25D7DF9">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e975">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e978">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e983" headers="d50028e975 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e983 d50028e978 ">
                                 <p><code class="codeph">64 KB</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e991" headers="d50028e975 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e991 d50028e978 ">
                                 <p>任何值最多<code class="codeph">2 GB</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>设置要传输的<code class="codeph">LONG</code>数据的大小。较小的块大小意味着更少的内存需求，但更多的往返来获取所有数据。较大的单件尺寸意味着更少的往返次数，但更多的内存需要在内部存储中间件。因此，初始化参数可用于调整系统以获得最佳性能，在往返和内存要求之间以及网络延迟或响应时间之间进行最佳权衡。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU789"></a><div class="props_rev_3"><a id="GUID-4503E5A3-67B1-47F8-A80E-907DD7E0F1EB" name="GUID-4503E5A3-67B1-47F8-A80E-907DD7E0F1EB"></a><h3 id="TGTEU-GUID-4503E5A3-67B1-47F8-A80E-907DD7E0F1EB" class="sect3">HS_OPEN_CURSORS</h3>
               <div>
                  <div class="tblformal" id="GUID-4503E5A3-67B1-47F8-A80E-907DD7E0F1EB__GUID-2EA506E0-211A-49FD-94D6-E0E2701B7AAF">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e1052">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e1055">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e1060" headers="d50028e1052 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e1060 d50028e1055 ">
                                 <p><code class="codeph">50</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e1068" headers="d50028e1052 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e1068 d50028e1055 ">
                                 <p><code class="codeph">1</code>到Oracle的<code class="codeph">OPEN_CURSORS</code>初始化参数的值</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>定义在与非Oracle系统实例的一个连接上可以打开的最大游标数。</p>
                     <p>该值永远不会超过Oracle数据库中打开游标的数量。因此，建议在Oracle数据库中设置与<code class="codeph">OPEN_CURSORS</code>初始化参数相同的值。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU790"></a><div class="props_rev_3"><a id="GUID-6C54CEAF-9567-4A87-8E85-16F4B6A36AF8" name="GUID-6C54CEAF-9567-4A87-8E85-16F4B6A36AF8"></a><h3 id="TGTEU-GUID-6C54CEAF-9567-4A87-8E85-16F4B6A36AF8" class="sect3">HS_RPC_FETCH_REBLOCKING</h3>
               <div>
                  <div class="tblformal" id="GUID-6C54CEAF-9567-4A87-8E85-16F4B6A36AF8__GUID-9244E1DB-F65D-4479-B558-CA613999382A">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e1133">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e1136">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e1141" headers="d50028e1133 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e1141 d50028e1136 ">
                                 <p><code class="codeph">上</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e1149" headers="d50028e1133 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e1149 d50028e1136 ">
                                 <p><code class="codeph">OFF</code>或<code class="codeph">ON</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>控制异构服务是否尝试优化Oracle数据库与连接到非Oracle数据存储的异构服务代理之间的数据传输性能。</p>
                     <p>可能的值如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">OFF</code>禁用对已获取数据的重新锁定，以便立即将数据从代理发送到服务器。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">ON</code>启用重新锁定，这意味着从非Oracle系统获取的数据将缓冲在代理中，并且在获取的数据量等于或高于<code class="codeph">HS_RPC_FETCH_SIZE</code>初始化参数的值之前不会发送到Oracle数据库。但是，当提取指示不存在更多数据或非Oracle系统报告错误时，将立即返回任何缓冲数据。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU791"></a><div class="props_rev_3"><a id="GUID-DF8C9A6B-13DB-4B12-8611-6CA2EF8705B8" name="GUID-DF8C9A6B-13DB-4B12-8611-6CA2EF8705B8"></a><h3 id="TGTEU-GUID-DF8C9A6B-13DB-4B12-8611-6CA2EF8705B8" class="sect3">HS_RPC_FETCH_SIZE</h3>
               <div>
                  <div class="tblformal" id="GUID-DF8C9A6B-13DB-4B12-8611-6CA2EF8705B8__GUID-F97DCE12-9C47-43F1-9774-9197F3B40EAB">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table desdribes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e1224">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e1227">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e1232" headers="d50028e1224 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e1232 d50028e1227 ">
                                 <p><code class="codeph">50000</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e1240" headers="d50028e1224 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e1240 d50028e1227 ">
                                 <p><code class="codeph">1</code>到<code class="codeph">10000000</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>调整内部数据缓冲以优化服务器和代理进程之间的数据传输速率。</p>
                     <p>增加该值可以减少传输给定数量的数据所需的网络往返次数，但是也倾向于增加数据带宽并减少在发出查询和完成查询的所有提取之间所测量的等待时间。然而，增加提取大小会增加查询的初始提取结果的延迟，因为在其他数据可用之前不会传输第一次提取结果。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU792"></a><div class="props_rev_3"><a id="GUID-510BDC6E-C5B8-4B72-9C23-29FD8157ACB0" name="GUID-510BDC6E-C5B8-4B72-9C23-29FD8157ACB0"></a><h3 id="TGTEU-GUID-510BDC6E-C5B8-4B72-9C23-29FD8157ACB0" class="sect3">HS_TIME_ZONE</h3>
               <div>
                  <div class="tblformal" id="GUID-510BDC6E-C5B8-4B72-9C23-29FD8157ACB0__GUID-07318951-41E3-4ED5-8817-D8F8FCD4551D">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e1298">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e1301">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e1306" headers="d50028e1298 ">
                                 <p>'[+ |  - ] hh：mm'的默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e1306 d50028e1301 ">
                                 <p>派生自<code class="codeph">NLS_TERRITORY</code>初始化参数</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e1316" headers="d50028e1298 ">
                                 <p>'[+ |  - ] hh：mm'的值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e1316 d50028e1301 ">
                                 <p>任何有效的日期时间格式掩码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>指定当前SQL会话的默认本地时区位移。格式掩码[+ |  - ] hh：mm，用于指示UTC之前或之后的小时和分钟（协调世界时 - 以前的格林威治标准时间）。例如：</p><pre class="oac_no_warn" dir="ltr">HS_TIME_ZONE = [+ | - ] hh：mm</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU793"></a><div class="props_rev_3"><a id="GUID-BB426A9A-18C4-42FC-8B63-00A8C74FB0BD" name="GUID-BB426A9A-18C4-42FC-8B63-00A8C74FB0BD"></a><h3 id="TGTEU-GUID-BB426A9A-18C4-42FC-8B63-00A8C74FB0BD" class="sect3">HS_TRANSACTION_MODEL</h3>
               <div>
                  <div class="tblformal" id="GUID-BB426A9A-18C4-42FC-8B63-00A8C74FB0BD__GUID-493C9A94-E3D3-4111-A187-B30C4AC21A6D">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="HS_FDS_TRANSACTION_MODEL" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d50028e1365">属性</th>
                              <th align="left" valign="bottom" width="67%" id="d50028e1368">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1373" headers="d50028e1365 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1373 d50028e1368 ">
                                 <p><code class="codeph">COMMIT_CONFIRM</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1381" headers="d50028e1365 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1381 d50028e1368 ">
                                 <p><code class="codeph">COMMIT_CONFIRM</code> ， <code class="codeph">READ_ONLY</code> ， <code class="codeph">SINGLE_SITE</code> ， <code class="codeph">READ_ONLY_AUTOCOMMIT</code> ， <code class="codeph">SINGLE_SITE_AUTOCOMMIT</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>指定事务更新非Oracle数据库时使用的事务模型的类型。</p>
                     <p>可能的值如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">COMMIT_CONFIRM</code>提供对非Oracle数据库的读写访问，并允许网关成为分布式更新的一部分。要使用commit-confirm模型，必须在非Oracle数据库中创建以下项：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>事务日志表。默认表名称为<code class="codeph">HS_TRANSACTION_LOG</code> 。可以使用<code class="codeph">HS_FDS_TRANSACTION_LOG</code>参数设置不同的名称。必须将事务日志表授予设置为public的<code class="codeph">SELECT</code> ， <code class="codeph">DELETE</code>和<code class="codeph">INSERT</code>权限。
                                 </p>
                              </li>
                              <li>
                                 <p>恢复帐户。帐户名称分配有<code class="codeph">HS_FDS_RECOVERY_ACCOUNT</code>参数。
                                 </p>
                              </li>
                              <li>
                                 <p>恢复帐户密码。密码分配有<code class="codeph">HS_FDS_RECOVERY_PWD</code>参数。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p><code class="codeph">READ_ONLY</code>提供对非Oracle数据库的读访问权限。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">SINGLE_SITE</code>提供对非Oracle数据库的读写访问。但是，网关无法参与分布式更新。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">READ_ONLY_AUTOCOMMIT</code>提供对不使用日志记录的非Oracle数据库的只读访问权限。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">SINGLE_SITE_AUTOCOMMIT</code>提供对非Oracle数据库的读写访问，无需记录。网关无法参与分布式更新。此外，立即提交对非Oracle数据库的任何更新。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU794"></a><div class="props_rev_3"><a id="GUID-A53E8406-90F0-40C6-88AA-F90EC9294FAA" name="GUID-A53E8406-90F0-40C6-88AA-F90EC9294FAA"></a><h3 id="TGTEU-GUID-A53E8406-90F0-40C6-88AA-F90EC9294FAA" class="sect3">IFILE</h3>
               <div>
                  <div class="tblformal" id="GUID-A53E8406-90F0-40C6-88AA-F90EC9294FAA__GUID-5D92FB65-E46A-4B19-8119-0844BD54E8F9">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes a parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d50028e1504">属性</th>
                              <th align="left" valign="bottom" width="74%" id="d50028e1507">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e1512" headers="d50028e1504 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e1512 d50028e1507 ">
                                 <p>没有</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d50028e1519" headers="d50028e1504 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="74%" headers="d50028e1519 d50028e1507 ">
                                 <p>有效参数文件名</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>使用<code class="codeph">IFILE</code>初始化参数在当前初始化文件中嵌入另一个初始化文件。该值应该是绝对路径，不应包含环境变量。嵌套限制的三个级别不适用。
                     </p>
                     <div class="infoboxnotealso" id="GUID-A53E8406-90F0-40C6-88AA-F90EC9294FAA__GUID-732B53BA-9ABC-4A43-8485-C9B34B257621">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../refrn/IFILE.html#REFRN10070" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU865"></a><div class="props_rev_3"><a id="GUID-DBA98566-83BE-4F75-8414-421AF53D97CC" name="GUID-DBA98566-83BE-4F75-8414-421AF53D97CC"></a><h3 id="TGTEU-GUID-DBA98566-83BE-4F75-8414-421AF53D97CC" class="sect3">HS_FDS_TIMESTAMP_MAPPING</h3>
               <div>
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-DBA98566-83BE-4F75-8414-421AF53D97CC__GUID-3AC17F41-9D0A-4AD1-AA42-41C214DD9B2E">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="initialization parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d50028e1577">属性</th>
                              <th align="left" valign="bottom" width="67%" id="d50028e1580">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1585" headers="d50028e1577 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1585 d50028e1580 ">
                                 <p><code class="codeph">日期</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1593" headers="d50028e1577 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1593 d50028e1580 ">
                                 <p><code class="codeph">CHAR</code> | <code class="codeph">DATE</code> | <code class="codeph">TIMESTAMP</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1607" headers="d50028e1577 ">
                                 <p>句法</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1607 d50028e1580 ">
                                 <p><code class="codeph">HS_FDS_TIMESTAMP_MAPPING={</code> <span class="italic"><code class="codeph">CHAR|DATE|TIMESTAMP}</code></span></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>如果设置为<code class="codeph">CHAR</code> ，则非Oracle目标时间戳将映射到<code class="codeph">CHAR(26)</code> 。如果设置为<code class="codeph">DATE</code> （默认值），则非Oracle目标时间戳将映射到Oracle <code class="codeph">DATE</code> 。如果设置为<code class="codeph">TIMESTAMP</code> ，则非Oracle目标时间戳将映射到Oracle <code class="codeph">TIMESTAMP</code> 。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU866"></a><div class="props_rev_3"><a id="GUID-542C4567-401B-4179-B65E-8F5115E018D3" name="GUID-542C4567-401B-4179-B65E-8F5115E018D3"></a><h3 id="TGTEU-GUID-542C4567-401B-4179-B65E-8F5115E018D3" class="sect3">HS_FDS_DATE_MAPPING</h3>
               <div>
                  <div class="tblformal" id="GUID-542C4567-401B-4179-B65E-8F5115E018D3__GUID-B9E275A0-FA77-4D07-824B-37D6752D8797">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="DRDA parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d50028e1677">属性</th>
                              <th align="left" valign="bottom" width="67%" id="d50028e1680">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1685" headers="d50028e1677 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1685 d50028e1680 ">
                                 <p><code class="codeph">日期</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1693" headers="d50028e1677 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1693 d50028e1680 ">
                                 <p><code class="codeph">DATE</code> | <code class="codeph">CHAR</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1704" headers="d50028e1677 ">
                                 <p>句法</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1704 d50028e1680 ">
                                 <p><code class="codeph">HS_FDS_DATE_MAPPING={</code> <span class="italic"><code class="codeph">DATE|CHAR}</code></span></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>如果设置为<code class="codeph">CHAR</code> ，则非oracle目标日期将映射到<code class="codeph">CHAR(10)</code> 。如果设置为<code class="codeph">DATE</code> ，则非Oracle目标日期将映射到Oracle日期。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU795"></a><div class="props_rev_3"><a id="GUID-92DD5A68-BB68-4F6A-A827-269736BE9A71" name="GUID-92DD5A68-BB68-4F6A-A827-269736BE9A71"></a><h3 id="TGTEU-GUID-92DD5A68-BB68-4F6A-A827-269736BE9A71" class="sect3">HS_FDS_CONNECT_INFO</h3>
               <div>
                  <div class="tblformal" id="GUID-92DD5A68-BB68-4F6A-A827-269736BE9A71__GUID-6737FFC7-AAE6-453F-98B9-35B499636154">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="HS_FDS_CONNECT_INFO" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d50028e1768">属性</th>
                              <th align="left" valign="bottom" width="75%" id="d50028e1771">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e1776" headers="d50028e1768 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e1776 d50028e1771 ">
                                 <p>没有</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e1783" headers="d50028e1768 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e1783 d50028e1771 ">
                                 <p>不适用</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p><code class="codeph">HS_FDS_CONNECT_INFO</code> ，描述与非Oracle系统的连接。
                     </p>
                     <p>默认初始化参数文件已有此参数的条目。网关的<code class="codeph">HS_FDS_CONNECT_INFO</code>语法如下：</p><pre class="oac_no_warn" dir="ltr">HS_FDS_CONNECT_INFO = <span class="italic">host_alias</span> ： <span class="italic">port_number</span> [/ <span class="italic">database_name</span> ]</pre><p>其中， <span class="italic"><code class="codeph">host_alias</code></span>是托管Teradata数据库的计算机的主机别名或IP地址， <span class="italic"><code class="codeph">port_number</code></span>是Teradata数据库服务器的端口号， <span class="italic"><code class="codeph">database_name</code></span>是Teradata数据库名称。<span class="italic"><code class="codeph">database_name</code></span>变量是可选的。
                     </p>
                     <p>此版本支持IPv6格式，因此您可以输入IPv6格式来代替<code class="codeph">hostname</code> ，但是您需要在IPv6规范中包含方括号。
                     </p>
                     <p>例如，</p><pre class="oac_no_warn" dir="ltr">HS_FDS_CONNECT_INFO = [2001：将0db8：20C：f1ff：fec6：38af]：端口号/ ...</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU796"></a><div class="props_rev_3"><a id="GUID-633870AE-C406-4F7A-88DF-FA57268B218E" name="GUID-633870AE-C406-4F7A-88DF-FA57268B218E"></a><h3 id="TGTEU-GUID-633870AE-C406-4F7A-88DF-FA57268B218E" class="sect3">HS_FDS_DEFAULT_OWNER</h3>
               <div>
                  <div class="tblformal" id="GUID-633870AE-C406-4F7A-88DF-FA57268B218E__GUID-05BCD51D-1E29-4DB3-ACA5-8231577C5C01">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="HS_FDS_DEFAULT_OWNER" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d50028e1880">属性</th>
                              <th align="left" valign="bottom" width="75%" id="d50028e1883">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e1888" headers="d50028e1880 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e1888 d50028e1883 ">
                                 <p>没有</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e1895" headers="d50028e1880 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e1895 d50028e1883 ">
                                 <p>不适用</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>如果未在SQL语句中指定所有者，则用于非Oracle数据库表的表所有者的名称。</p>
                     <div class="infoboxnote" id="GUID-633870AE-C406-4F7A-88DF-FA57268B218E__GUID-E2B96A96-0E93-4220-A5B5-25D0421C4E8C">
                        <p class="notep1">注意：</p>
                        <p>如果未指定此参数且未在SQL语句中显式指定所有者，则使用Oracle用户的用户名或创建数据库链接时指定的用户名。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-ACF3083C-C719-4632-8753-FAFA81314EF4" name="GUID-ACF3083C-C719-4632-8753-FAFA81314EF4"></a><h3 id="TGTEU-GUID-ACF3083C-C719-4632-8753-FAFA81314EF4" class="sect3">HS_FDS_TRANSACTION_ISOLATION</h3>
               <div>
                  <div class="tblformal" id="GUID-ACF3083C-C719-4632-8753-FAFA81314EF4__GUID-65FD204B-8290-4DA9-9CD5-689A08A577D9">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="DRDA parameter properties and descriptions." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d50028e1964">属性</th>
                              <th align="left" valign="bottom" width="67%" id="d50028e1967">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1972" headers="d50028e1964 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1972 d50028e1967 ">
                                 <p><code class="codeph">SERIALIZABLE</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1980" headers="d50028e1964 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1980 d50028e1967 ">
                                 <p>{ <code class="codeph">READ_UNCOMMITTED READ_COMMITTED REPEATABLE_READ SERIALIZABLE</code> }</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e1990" headers="d50028e1964 ">
                                 <p>句法</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e1990 d50028e1967 ">
                                 <p><code class="codeph">HS_FDS_ISOLATION_LEVEL = {{READ_UNCOMMITTED | READ_COMMITTED | REPEATABLE_READ | SERIALIZABLE}</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p><code class="codeph">HS_FDS_TRANSACTION_ISOLATION</code>指定用于网关在非Oracle数据库上打开的事务的隔离级别。
                     </p>
                     <p><code class="codeph">READ_UNCOMMITTED</code> ， <code class="codeph">READ_COMMITTED</code> ， <code class="codeph">REPEATABLE_READ</code>和<code class="codeph">SERIALIZABLE</code>的隔离级别是SQL标准中定义的四个隔离级别，由ANSI和ISO / IEC采用。有关它们的其他信息，请参阅<a href="../cncpt/data-concurrency-and-consistency.html#CNCPT-GUID-7F2C6927-5482-4144-B43B-5E90EF4E055B" target="_blank"><span><cite>Oracle数据库概念</cite></span></a> 。
                     </p>
                     <p>在指定低于所使用的Oracle事务隔离级别的隔离级别时要小心，因为网关事务将具有与Oracle数据库事务中发生的不同的可预防读取现象。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU862"></a><div class="props_rev_3"><a id="GUID-0AD6E23D-5A44-4271-AA76-01502C8C1D77" name="GUID-0AD6E23D-5A44-4271-AA76-01502C8C1D77"></a><h3 id="TGTEU-GUID-0AD6E23D-5A44-4271-AA76-01502C8C1D77" class="sect3">HS_FDS_PROC_IS_FUNC</h3>
               <div>
                  <div class="tblformal" id="GUID-0AD6E23D-5A44-4271-AA76-01502C8C1D77__GUID-5F78B8ED-9D4B-40AD-8983-BB97DB28E572">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="HS_FDS_PROC_IS_FUNC" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d50028e2066">属性</th>
                              <th align="left" valign="bottom" width="75%" id="d50028e2069">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2074" headers="d50028e2066 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2074 d50028e2069 ">
                                 <p><code class="codeph">假</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2082" headers="d50028e2066 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2082 d50028e2069 ">
                                 <p><code class="codeph">TRUE</code> ， <code class="codeph">FALSE</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>启用函数的返回值。默认情况下，所有存储过程和函数都不会向用户返回返回值。</p>
                     <div class="infoboxnote" id="GUID-0AD6E23D-5A44-4271-AA76-01502C8C1D77__GUID-8167E179-7DA2-4A8F-9423-8401479EE524">
                        <p class="notep1">注意：</p>
                        <p>如果设置此初始化参数，则必须更改所有现有存储过程的过程execute语句的语法以处理返回值。</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU797"></a><div class="props_rev_3"><a id="GUID-92E85665-F297-49F7-A890-2D7E082047E7" name="GUID-92E85665-F297-49F7-A890-2D7E082047E7"></a><h3 id="TGTEU-GUID-92E85665-F297-49F7-A890-2D7E082047E7" class="sect3">HS_FDS_RECOVERY_ACCOUNT</h3>
               <div>
                  <div class="tblformal" id="GUID-92E85665-F297-49F7-A890-2D7E082047E7__GUID-75D65518-66D0-441C-9308-BE9DDE63996D">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="HS_FDS_RECOVERY_ACCOUNT" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d50028e2137">属性</th>
                              <th align="left" valign="bottom" width="75%" id="d50028e2140">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2145" headers="d50028e2137 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2145 d50028e2140 ">
                                 <p><code class="codeph">恢复</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2153" headers="d50028e2137 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2153 d50028e2140 ">
                                 <p>任何有效的用户ID</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>指定用于commit-confirm事务模型的恢复帐户的名称。必须在非Oracle系统上设置具有用户名和密码的帐户。有关commit-confirm模型的更多信息，请参阅<code class="codeph">HS_TRANSACTION_MODEL</code>参数。
                     </p>
                     <p>恢复帐户的名称区分大小写。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU798"></a><div class="props_rev_3"><a id="GUID-D5824757-5962-4390-AAE9-6DD0F5D0A625" name="GUID-D5824757-5962-4390-AAE9-6DD0F5D0A625"></a><h3 id="TGTEU-GUID-D5824757-5962-4390-AAE9-6DD0F5D0A625" class="sect3">HS_FDS_RECOVERY_PWD</h3>
               <div>
                  <div class="tblformal" id="GUID-D5824757-5962-4390-AAE9-6DD0F5D0A625__GUID-549BDD7D-6ABD-4951-87D8-A455931F8023">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="HS_FDS_RECOVERY_PWD" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d50028e2205">属性</th>
                              <th align="left" valign="bottom" width="75%" id="d50028e2208">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2213" headers="d50028e2205 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2213 d50028e2208 ">
                                 <p><code class="codeph">恢复</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2221" headers="d50028e2205 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2221 d50028e2208 ">
                                 <p>任何有效的密码</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>指定用于在非Oracle系统上设置的提交确认事务模型的恢复帐户的密码。有关commit-confirm模型的更多信息，请参阅<code class="codeph">HS_TRANSACTION_MODEL</code>参数。
                     </p>
                     <p>恢复帐户的密码名称区分大小写。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU799"></a><div class="props_rev_3"><a id="GUID-3A22053F-B192-4BF3-9B59-37AF55D510C0" name="GUID-3A22053F-B192-4BF3-9B59-37AF55D510C0"></a><h3 id="TGTEU-GUID-3A22053F-B192-4BF3-9B59-37AF55D510C0" class="sect3">HS_FDS_TRACE_LEVEL</h3>
               <div>
                  <div class="tblformal" id="GUID-3A22053F-B192-4BF3-9B59-37AF55D510C0__GUID-92BAE638-2A0E-4B7B-8D9C-8F5843A31D1E">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="HS_FDS_RECOVERY_ACCOUNT" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d50028e2277">属性</th>
                              <th align="left" valign="bottom" width="75%" id="d50028e2280">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2285" headers="d50028e2277 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2285 d50028e2280 ">
                                 <p><code class="codeph">关闭</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2293" headers="d50028e2277 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2293 d50028e2280 ">
                                 <p><code class="codeph">OFF</code> ， <code class="codeph">ON</code> ， <code class="codeph">DEBUG</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>指定是否<a id="d50028e2309" class="indexterm-anchor"></a>为网关连接打开或关闭错误跟踪。
                     </p>
                     <p>以下值有效：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">OFF</code>禁用跟踪错误消息。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">ON</code>可以跟踪遇到问题时出现的错误消息。结果默认写入安装网关的LOG目录中的网关日志文件。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DEBUG</code>允许跟踪可用于调试的详细错误消息。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU800"></a><div class="props_rev_3"><a id="GUID-60678D9A-1FEB-4E00-BD58-2C12344F8616" name="GUID-60678D9A-1FEB-4E00-BD58-2C12344F8616"></a><h3 id="TGTEU-GUID-60678D9A-1FEB-4E00-BD58-2C12344F8616" class="sect3">HS_FDS_TRANSACTION_LOG</h3>
               <div>
                  <div class="tblformal" id="GUID-60678D9A-1FEB-4E00-BD58-2C12344F8616__GUID-4C9F1904-0278-4533-B815-D8E88D767EE4">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="HS_FDS_TRANSACTION_LOG" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d50028e2375">属性</th>
                              <th align="left" valign="bottom" width="67%" id="d50028e2378">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2383" headers="d50028e2375 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2383 d50028e2378 ">
                                 <p><code class="codeph">HS_TRANSACTION_LOG</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2391" headers="d50028e2375 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2391 d50028e2378 ">
                                 <p>任何有效的表名</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>指定在非Oracle系统中为记录事务创建的表的名称。有关事务模型的更多信息，请参阅<code class="codeph">HS_TRANSACTION_MODEL</code>参数。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU854"></a><div class="props_rev_3"><a id="GUID-B8749B60-A732-47BD-80B0-D2403B78BBF6" name="GUID-B8749B60-A732-47BD-80B0-D2403B78BBF6"></a><h3 id="TGTEU-GUID-B8749B60-A732-47BD-80B0-D2403B78BBF6" class="sect3">HS_FDS_FETCH_ROWS</h3>
               <div>
                  <div class="tblformal" id="GUID-B8749B60-A732-47BD-80B0-D2403B78BBF6__GUID-1369ED39-0825-4CB5-A15F-92DAEDC8ED48">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="DRDA parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d50028e2451">属性</th>
                              <th align="left" valign="bottom" width="67%" id="d50028e2454">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2459" headers="d50028e2451 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2459 d50028e2454 ">
                                 <p><code class="codeph">100</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2467" headers="d50028e2451 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2467 d50028e2454 ">
                                 <p><code class="codeph">1</code>到<code class="codeph">1000</code>之间的任何整数</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2479" headers="d50028e2451 ">
                                 <p>句法</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2479 d50028e2454 ">
                                 <p><code class="codeph">HS_FDS_FETCH_ROWS=</code> <span class="italic"><code class="codeph">num</code></span></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p><code class="codeph">HS_FDS_FETCH_ROWS</code>指定<a id="d50028e2494" class="indexterm-anchor"></a>获取数组大小。这是从非Oracle数据库中提取并一次返回Oracle数据库的行数。该参数将受<code class="codeph">HS_RPC_FETCH_SIZE</code>和<code class="codeph">HS_RPC_FETCH_REBLOCKING</code>参数的影响。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU853"></a><div class="props_rev_3"><a id="GUID-30EC3A94-A763-41B5-9A94-E409C460D280" name="GUID-30EC3A94-A763-41B5-9A94-E409C460D280"></a><h3 id="TGTEU-GUID-30EC3A94-A763-41B5-9A94-E409C460D280" class="sect3">HS_IDLE_TIMEOUT</h3>
               <div>
                  <div class="tblformal" id="GUID-30EC3A94-A763-41B5-9A94-E409C460D280__GUID-899B8C9D-CFE2-4376-B95E-DFC0C2646512">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Teradata parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d50028e2541">属性</th>
                              <th align="left" valign="bottom" width="67%" id="d50028e2544">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2549" headers="d50028e2541 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2549 d50028e2544 ">
                                 <p>0（没有超时）</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2556" headers="d50028e2541 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2556 d50028e2544 ">
                                 <p>0-9999（分钟）</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2563" headers="d50028e2541 ">
                                 <p>句法</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2563 d50028e2544 ">
                                 <p><code class="codeph">HS_IDLE_TIMEOUT=</code> <span class="italic"><code class="codeph">num</code></span></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p><a id="d50028e2575" class="indexterm-anchor"></a>此功能仅适用于Oracle Net TCP协议。如果在指定的时间段内没有连接的网关会话的活动，网关会话将自动终止，同时回滚挂起的更新（如果有）。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU855"></a><div class="props_rev_3"><a id="GUID-A65591F1-CACC-4F49-B470-EEB1F7C119F6" name="GUID-A65591F1-CACC-4F49-B470-EEB1F7C119F6"></a><h3 id="TGTEU-GUID-A65591F1-CACC-4F49-B470-EEB1F7C119F6" class="sect3">HS_NLS_LENGTH_SEMANTICS</h3>
               <div>
                  <div class="tblformal" id="GUID-A65591F1-CACC-4F49-B470-EEB1F7C119F6__GUID-B7F15754-A52C-4410-9301-DBE93491ADC6">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Teradata parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d50028e2617">属性</th>
                              <th align="left" valign="bottom" width="67%" id="d50028e2620">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2625" headers="d50028e2617 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2625 d50028e2620 ">
                                 <p><code class="codeph">字节</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2633" headers="d50028e2617 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2633 d50028e2620 ">
                                 <p><code class="codeph">BYTE | CHAR</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2641" headers="d50028e2617 ">
                                 <p>句法</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2641 d50028e2620 ">
                                 <p><code class="codeph">HS_NLS_LENGTH_SEMANTICS = {BYTE | CHAR}</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p><a id="d50028e2650" class="indexterm-anchor"></a>此版本的网关具有与Oracle数据库字符语义等效的字符语义功能，即<code class="codeph">NLS_LENGTH_SEMANTICS</code> 。当<code class="codeph">HS_NLS_LENGTH_SEMANTICS</code>设置为<code class="codeph">CHAR</code> ，Teradata的<code class="codeph">(VAR)CHAR</code>列将被解释为具有<code class="codeph">CHAR</code>语义。网关不遵守<code class="codeph">HS_NLS_LENGTH_SEMANTICS=CHAR</code>设置的唯一情况是Oracle数据库和网关都在同一个多字节字符集上</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU856"></a><div class="props_rev_3"><a id="GUID-37029C90-769B-4F2A-8017-1AB7301D95E4" name="GUID-37029C90-769B-4F2A-8017-1AB7301D95E4"></a><h3 id="TGTEU-GUID-37029C90-769B-4F2A-8017-1AB7301D95E4" class="sect3">HS_KEEP_REMOTE_COLUMN_SIZE</h3>
               <div>
                  <div class="tblformal" id="GUID-37029C90-769B-4F2A-8017-1AB7301D95E4__GUID-0C123D16-FC47-444C-81AD-D69ADBC5EDA1">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="Teradata parameter" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="33%" id="d50028e2710">属性</th>
                              <th align="left" valign="bottom" width="67%" id="d50028e2713">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2718" headers="d50028e2710 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2718 d50028e2713 ">
                                 <p><code class="codeph">关闭</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2726" headers="d50028e2710 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2726 d50028e2713 ">
                                 <p><code class="codeph">关闭| LOCAL | REMOTE | ALL</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2734" headers="d50028e2710 ">
                                 <p>句法</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2734 d50028e2713 ">
                                 <p><code class="codeph">HS_KEEP_REMOTE_COLUMN_SIZE = OFF | LOCAL | REMOTE |所有</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="33%" id="d50028e2742" headers="d50028e2710 ">
                                 <p>参数类型</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d50028e2742 d50028e2713 ">
                                 <p>串</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p><a id="d50028e2750" class="indexterm-anchor"></a> <code class="codeph">HS_KEEP_REMOTE_COLUMN_SIZE</code>指定在从非Oracle数据库到网关，然后到Oracle数据库的数据转换期间计算<code class="codeph">(VAR)CHAR</code>数据类型的长度时是否抑制比率扩展。当它设置为<code class="codeph">REMOTE</code> ，将禁止非Oracle数据库和网关之间的扩展。当它设置为<code class="codeph">LOCAL</code> ，网关和Oracle数据库之间的扩展将被抑制。当它设置为<code class="codeph">ALL</code> ，将扩展从非Oracle数据库抑制到Oracle数据库。
                     </p>
                     <p>设置参数后，在报告远程列大小，计算隐式生成的缓冲区大小以及在本地Oracle数据库中实例化时，将禁止扩展。这仅对从非Oracle数据库到Oracle数据库的远程列大小有效。如果网关在Windows上运行且<code class="codeph">HS_LANGUAGE=AL32UTF8</code> ，则不能指定此参数，因为它会影响其他与比率相关的参数操作。在<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code>期间，它对通过网关从Oracle数据库移动到非Oracle数据库的数据的比率没有影响。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU850"></a><div class="props_rev_3"><a id="GUID-752C716A-AA41-4C56-8780-A9236F064B73" name="GUID-752C716A-AA41-4C56-8780-A9236F064B73"></a><h3 id="TGTEU-GUID-752C716A-AA41-4C56-8780-A9236F064B73" class="sect3">HS_FDS_REMOTE_DB_CHARSET</h3>
               <div>
                  <div class="tblformal" id="GUID-752C716A-AA41-4C56-8780-A9236F064B73__GUID-B7D39876-250F-41C8-BE26-90BCBB3B068E">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="initparam" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d50028e2819">属性</th>
                              <th align="left" valign="bottom" width="75%" id="d50028e2822">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2827" headers="d50028e2819 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2827 d50028e2822 ">
                                 <p>没有</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2834" headers="d50028e2819 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2834 d50028e2822 ">
                                 <p>不适用</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2841" headers="d50028e2819 ">
                                 <p>句法</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2841 d50028e2822 ">
                                 <p><code class="codeph">HS_FDS_REMOTE_DB_CHARSET</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>仅当<code class="codeph">HS_LANGUAGE</code>设置为<code class="codeph">AL32UTF8</code>且网关在Windows上运行时，此参数才有效。由于更多Oracle数据库和非Oracle数据库使用Unicode作为数据库字符集，因此最好还以Unicode字符集运行网关。为此，您必须设置<code class="codeph">HS_LANGUAGE=AL32UTF8</code> 。但是，当网关在Windows上运行时，Microsoft ODBC驱动程序管理器界面只能以双字节字符集UCS2交换数据。这导致所述缓冲液和柱尺寸的额外比率扩展。为了补偿，如果<code class="codeph">HS_FDS_REMOTE_DB_CHARSET</code>设置为相应的非Oracle数据库字符集，则网关可以重新调整列大小。例如， <code class="codeph">HS_FDS_REMOTE_DB_CHARSET=KO16KSC5601</code> 。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU851"></a><div class="props_rev_3"><a id="GUID-825C590C-2B22-4FAA-A648-383395F98CB1" name="GUID-825C590C-2B22-4FAA-A648-383395F98CB1"></a><h3 id="TGTEU-GUID-825C590C-2B22-4FAA-A648-383395F98CB1" class="sect3">HS_FDS_SUPPORT_STATISTICS</h3>
               <div>
                  <div class="tblformal" id="GUID-825C590C-2B22-4FAA-A648-383395F98CB1__GUID-B98F3ABC-C0CD-496D-8B96-4672B0A7E4B3">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="init param" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d50028e2905">属性</th>
                              <th align="left" valign="bottom" width="75%" id="d50028e2908">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2913" headers="d50028e2905 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2913 d50028e2908 ">
                                 <p><code class="codeph">真正</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2921" headers="d50028e2905 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2921 d50028e2908 ">
                                 <p><code class="codeph">{TRUE | FALSE}</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2929" headers="d50028e2905 ">
                                 <p>句法</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2929 d50028e2908 ">
                                 <p><code class="codeph">HS_FDS_SUPPORT_STATISTICS = {TRUE | FALSE}</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>我们默认从非Oracle数据库收集统计信息。您可以通过将<code class="codeph">HS_FDS_SUPPORT_STATISTICS</code>参数设置为<code class="codeph">FALSE</code>来选择禁用远程数据库统计信息的收集。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="TGTEU867"></a><div class="props_rev_3"><a id="GUID-0DC5EDD6-E86E-4CBC-BFB0-DAB851B213E1" name="GUID-0DC5EDD6-E86E-4CBC-BFB0-DAB851B213E1"></a><h3 id="TGTEU-GUID-0DC5EDD6-E86E-4CBC-BFB0-DAB851B213E1" class="sect3">HS_FDS_ARRAY_EXEC</h3>
               <div>
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-0DC5EDD6-E86E-4CBC-BFB0-DAB851B213E1__GUID-408B48B3-7917-4D4F-A546-55ED23383ECE">
                     <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="init param" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="25%" id="d50028e2984">属性</th>
                              <th align="left" valign="bottom" width="75%" id="d50028e2987">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e2992" headers="d50028e2984 ">
                                 <p>默认值</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e2992 d50028e2987 ">
                                 <p><code class="codeph">真正</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e3000" headers="d50028e2984 ">
                                 <p>价值范围</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e3000 d50028e2987 ">
                                 <p><code class="codeph">{TRUE | FALSE}</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="25%" id="d50028e3008" headers="d50028e2984 ">
                                 <p>句法</p>
                              </td>
                              <td align="left" valign="top" width="75%" headers="d50028e3008 d50028e2987 ">
                                 <p><code class="codeph">HS_FDS_ARRAY_EXEC = {TRUE | FALSE}</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>如果设置为<code class="codeph">TRUE</code> ，则网关将对包含针对远程数据源的绑定的insert，update，delete语句使用数组操作。数组大小由<code class="codeph">HS_FDS_FETCH_ROWS</code> init参数的值确定。
                     </p>
                     <p>如果设置为<code class="codeph">FALSE</code> ，则网关不会对insert，update和delete语句使用数组操作。相反，将为每个值发出一个语句。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="05486.introduction-to-the-multitenant-architecture.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Become familiar with the Oracle Multitenant option."></meta>
      <meta name="description" content="Become familiar with the Oracle Multitenant option."></meta>
      <title>多租户架构简介</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Administrator’s Guide "></meta>
      <meta property="og:description" content="Become familiar with the Oracle Multitenant option."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Administrator’s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="multitenant-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-20T09:59:22-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96136-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="multitenant-architecture.html" title="Previous" type="text/html"></link>
      <link rel="next" href="overview-of-the-multitenant-architecture.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Multitenant Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="MULTI"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="multitenant-architecture.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="overview-of-the-multitenant-architecture.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">管理员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="multitenant-architecture.html" property="item" typeof="WebPage"><span property="name">多租户架构</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">多租户架构简介</li>
            </ol>
            <a id="GUID-267F7D12-D33F-4AC9-AA45-E9CD671B6F22" name="GUID-267F7D12-D33F-4AC9-AA45-E9CD671B6F22"></a><a id="CNCPT89234"></a>
            
            <h2 id="MULTI-GUID-267F7D12-D33F-4AC9-AA45-E9CD671B6F22" class="sect2"><span class="enumeration_chapter">1</span>多租户架构简介</h2>
         </header>
         <div class="ind">
            <div>
               <p>熟悉<span class="bold">Oracle Multitenant</span>选项。
               </p>
               <p>本章包含以下主题：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-C5B0AF7D-ABE8-4F69-9552-F4DAF40281F1">关于多租户架构</a><br><strong class="term">多租户架构</strong>使Oracle数据库可用作多租户容器数据库（CDB）。
                  </li>
                  <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-31CE5970-4A53-44E0-AEA0-D2F7AE09D7E7">多租户架构的好处</a><br>多租户架构解决了传统非CDB架构带来的几个问题。
                  </li>
                  <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-FDCD109B-1199-4250-802A-0F345D24F816">数据库整合的路径</a><br>在其存在的持续时间内，数据库是CDB或非CDB。</li>
                  <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-345CDAD9-3D12-475F-82EC-FED2790F504A">多租户环境文档路线图</a><br>本主题列出了理解和使用CDB的最重要主题，并包括对相应文档的交叉引用。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="multitenant-architecture.html#GUID-BBAD3448-8A5A-4397-BD3A-F05D945DB7F8" title="多租户架构使Oracle数据库可用作多租户容器数据库（CDB）。">多租户架构</a></p>
                  </div>
               </div>
            </div>
            <a id="CNCPT89235"></a><div class="props_rev_3"><a id="GUID-C5B0AF7D-ABE8-4F69-9552-F4DAF40281F1" name="GUID-C5B0AF7D-ABE8-4F69-9552-F4DAF40281F1"></a><h3 id="MULTI-GUID-C5B0AF7D-ABE8-4F69-9552-F4DAF40281F1" class="sect3"><span class="enumeration_section">1.1</span>关于多租户架构</h3>
               <div>
                  <p><strong class="term">多租户架构</strong>使Oracle数据库可用作多租户容器数据库（CDB）。
                  </p>
                  <p><a href="glossary.html#GUID-135FF536-DE9B-40CF-9F42-C246762BD77F"><span class="xrefglossterm">CDB</span></a>包括零个，一个或多个客户创建的可插拔数据库（PDB）。<a href="glossary.html#GUID-D6932E25-775E-4FF1-BB08-F8999629093C"><span class="xrefglossterm">PDB</span></a>是模式，模式对象和非模式对象的可移植集合，在Oracle Net客户端中显示<a href="glossary.html#GUID-B2710CAA-8F00-40B3-97AB-4521D2147EE8"><span class="xrefglossterm">为非CDB</span></a> 。 Oracle数据库之前，所有Oracle数据库<span class="italic">12c的</span>是非的CDB。
                  </p>
                  <p>
                     </p><div class="video-box">
                        <div id="11539" class="video-container"></div>
                     </div>
                  
                  <p>本节包含以下主题：</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-FC2EB562-ED31-49EF-8707-C766B6FE66B8">关于CDB中的容器</a><br><strong class="term">容器</strong>是多租户架构内的数据或元数据的逻辑集合。
                     </li>
                     <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-6A039F5C-7221-4A38-9BDA-2E6F73B8DA06">关于多租户架构的用户界面</a><br>您可以对CDB和非CDB使用相同的管理工具。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-267F7D12-D33F-4AC9-AA45-E9CD671B6F22" title="熟悉Oracle Multitenant选项。">多租户架构简介</a></p>
                     </div>
                  </div>
               </div>
               <a id="CNCPT89236"></a><div class="props_rev_3"><a id="GUID-FC2EB562-ED31-49EF-8707-C766B6FE66B8" name="GUID-FC2EB562-ED31-49EF-8707-C766B6FE66B8"></a><h4 id="MULTI-GUID-FC2EB562-ED31-49EF-8707-C766B6FE66B8" class="sect4"><span class="enumeration_section">1.1.1</span>关于CDB中的容器</h4>
                  <div>
                     <p><strong class="term">容器</strong>是多租户架构内的数据或元数据的逻辑集合。
                     </p>
                     <p>下图表示CDB中可能的容器。</p>
                     <div class="figure" id="GUID-FC2EB562-ED31-49EF-8707-C766B6FE66B8__GUID-AC59A46D-EA55-420A-A148-32DE8A14F955">
                        <p class="titleinfigure">图1-1 CDB中的容器</p><img src="img/admin112.png" alt="下面是图1-1的描述" title="下面是图1-1的描述" longdesc="img_text/admin112.html"><br><a href="img_text/admin112.html">“图1-1 CDB中的容器”的描述</a></div>
                     <!-- class="figure" -->
                     <p>每个CDB都有以下容器：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>恰好一个CDB根容器（也简称<span class="italic">为root</span> ）</p>
                           <p><a href="glossary.html#GUID-1C63428A-905A-4918-95AA-F3BBA3D2B825"><span class="xrefglossterm">CDB根</span></a>是所有PDB所属的模式，模式对象和非模式对象的集合（请参阅<span class="q">“ <a href="overview-of-the-multitenant-architecture.html#GUID-5C339A60-2163-4ECE-B7A9-4D67D3D894FB" title="容器是多租户容器数据库（CDB）中的模式，对象和相关结构的集合。在CDB中，每个容器都有唯一的ID和名称。">CDB中的容器概述</a> ”</span> ）。根存储Oracle提供的元数据和普通用户。元数据的一个示例是Oracle提供的PL / SQL包的源代码（请参阅<span class="q">“ <a href="overview-of-the-multitenant-architecture.html#GUID-A356382A-413A-4A42-98DC-6C2464808202" title="从用户和应用程序的角度来看，CDB中每个容器中的数据字典是独立的，就像它在非CDB中一样。">CDB中的数据字典体系结构</a> ”</span> ）。普通用户是每个容器中已知的数据库用户（请参阅<span class="q">“ <a href="overview-of-the-multitenant-architecture.html#GUID-19337B94-645B-45E8-842C-762BBC544B13" title="在系统容器（CDB）或应用程序容器的上下文中，公共用户是在根容器中以及此容器内的每个现有和将来的PDB中具有相同标识的数据库用户。">CDB中的常见用户</a> ”</span> ）。根容器名为<code class="codeph">CDB$ROOT</code> 。</p>
                        </li>
                        <li>
                           <p>恰好是一个系统容器</p>
                           <p><a href="glossary.html#GUID-0E3286DF-A941-47D6-A2C8-333D9B4644B3"><span class="xrefglossterm">系统容器</span></a>包括根CDB和CDB中的所有PDB。因此，系统容器是CDB本身的逻辑容器。
                           </p>
                        </li>
                        <li>
                           <p>零个或多个应用程序容器</p>
                           <p><a href="glossary.html#GUID-F939B8E5-8DCE-4831-9B81-224C1D6DC1AA"><span class="xrefglossterm">应用程序容器只</span></a>包含一个<a href="glossary.html#GUID-66EC71A6-6AC1-4BC2-B30A-A0DCA68AEE28"><span class="xrefglossterm">应用程序根目录</span></a> ，以及插入此根目录的PDB。系统容器包含CDB根和CDB中的<span class="italic">所有</span> PDB，而应用程序容器仅包括插入应用程序根目录的PDB。应用程序根目录属于CDB根目录，不属于其他容器。
                           </p>
                        </li>
                        <li>
                           <p>零个或多个用户创建的PDB</p>
                           <p>PDB包含特定功能集所需的数据和代码（请参阅<span class="q">“ <a href="overview-of-the-multitenant-architecture.html#GUID-49C0C90D-5A72-4131-8C3D-B07341C75CB2" title="PDB是用户创建的一组模式，对象和相关结构，它们作为单独的数据库逻辑地显示在客户端应用程序中。">PDB</a> ”</span> ）。例如，PDB可以支持特定应用程序，例如人力资源或销售应用程序。创建CDB时不存在PDB。您可以根据业务需求添加PDB。
                           </p>
                           <p>PDB恰好属于零或一个应用程序容器。如果PDB属于应用程序容器，则它是<a href="glossary.html#GUID-E9DA1D6D-DBFC-41C5-B24E-F508B671BF06"><span class="xrefglossterm">应用程序PDB</span></a> 。例如， <code class="codeph">cust1_pdb</code>和<code class="codeph">cust2_pdb</code>应用程序PDB可能属于<code class="codeph">saas_sales_ac</code>应用程序容器，在这种情况下，它们不属于其他应用程序容器。<a href="glossary.html#GUID-BCC6BCFA-FFA1-4C84-8804-1CC13BF86350"><span class="xrefglossterm">应用程序种子</span></a>是一个可选的应用程序PDB，它充当用户创建的PDB模板，使您能够快速创建新的应用程序PDB。
                           </p>
                        </li>
                        <li>
                           <p>正好一粒<a href="glossary.html#GUID-D05C6A55-5452-4C82-942C-59DB245671BE"><span class="xrefglossterm">种子PDB</span></a></p>
                           <p>种子PDB是系统提供的模板，CDB可以使用该模板来创建新的PDB。种子PDB命名为<code class="codeph">PDB$SEED</code> 。您无法在<code class="codeph">PDB$SEED</code>添加或修改对象。</p>
                        </li>
                     </ul>
                     <div class="example" id="GUID-FC2EB562-ED31-49EF-8707-C766B6FE66B8__GUID-25C018A5-70BF-4952-80A4-F70AD9F2E330">
                        <p class="titleinexample">示例1-1没有应用程序容器的CDB</p>
                        <p>此示例显示了一个包含五个容器的简单CDB：系统容器（整个CDB），CDB根，PDB种子（ <code class="codeph">PDB$SEED</code> ）和两个PDB。每个PDB都有自己的专用应用程序。不同的PDB管理员管理每个PDB。 CDB上存在具有单个标识的<a href="glossary.html#GUID-879D936A-45FE-4E4D-8099-5060F3F55353"><span class="xrefglossterm">普通用户</span></a> 。在此示例中，普通用户<code class="codeph">SYS</code>可以管理根和每个PDB。在物理层面，此CDB具有数据库实例和数据库文件，就像非CDB一样。
                        </p>
                        <div class="figure" id="GUID-FC2EB562-ED31-49EF-8707-C766B6FE66B8__GUID-3ADA7980-F8BB-46D9-BF16-36ABB465248B">
                           <p class="titleinfigure">图1-2没有应用程序容器的CDB</p><img src="img/cncpt345.png" width="454" alt="下面是图1-2的描述" title="下面是图1-2的描述" longdesc="img_text/cncpt345.html"><br><a href="img_text/cncpt345.html">“图1-2没有应用程序容器的CDB”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-FC2EB562-ED31-49EF-8707-C766B6FE66B8__GUID-0E7CAEAB-EC02-4BBB-995A-53BFBAE99C30">
                        <p class="titleinexample">示例1-2带有应用程序容器的CDB</p>
                        <p>在此变体中，CDB包含名为<code class="codeph">saas_sales_ac</code>的应用程序容器。在应用程序容器中，应用程序PDB <code class="codeph">cust1_pdb</code>支持一个客户的应用程序，而应用程序PDB <code class="codeph">cust2_pdb</code>支持另一个客户的应用程序。CDB还包含名为<code class="codeph">hrpdb</code>的PDB，它支持HR应用程序，但不属于应用程序容器。
                        </p>
                        <div class="figure" id="GUID-FC2EB562-ED31-49EF-8707-C766B6FE66B8__GUID-FF9047D2-87E5-4A1A-9633-DC286570D838">
                           <p class="titleinfigure">图1-3带有应用程序容器的CDB</p><img src="img/cncpt383.png" alt="下面是图1-3的描述" title="下面是图1-3的描述" longdesc="img_text/cncpt383.html"><br><a href="img_text/cncpt383.html">“图1-3带有应用程序容器的CDB”的描述</a></div>
                        <!-- class="figure" -->
                        <p>在此示例中，多个DBA管理CDB环境：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>CDB管理员管理CDB本身。</p>
                           </li>
                           <li>
                              <p>应用程序容器管理员管理<code class="codeph">saas_sales_ac</code>容器，包括应用程序安装和升级。
                              </p>
                           </li>
                           <li>
                              <p>应用程序PDB管理员管理<code class="codeph">saas_sales_ac</code>容器中的两个PDB： <code class="codeph">cust1_pdb</code>和<code class="codeph">cust2_pdb</code> 。
                              </p>
                           </li>
                           <li>
                              <p>PDB管理员管理<code class="codeph">hrpdb</code> 。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-FC2EB562-ED31-49EF-8707-C766B6FE66B8__GUID-BFB5760F-679B-44FC-A51B-51ACB21529B8">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="overview-of-managing-a-multitenant-environment.html#GUID-528FBE02-2B84-4E97-BD87-36AEF9EA524D" title="熟悉与配置和管理多租户环境相关的基本概念。">配置和管理多租户环境概述</a> ”</span></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-C5B0AF7D-ABE8-4F69-9552-F4DAF40281F1" title="多租户架构使Oracle数据库可用作多租户容器数据库（CDB）。">关于多租户架构</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="CNCPT89237"></a><div class="props_rev_3"><a id="GUID-6A039F5C-7221-4A38-9BDA-2E6F73B8DA06" name="GUID-6A039F5C-7221-4A38-9BDA-2E6F73B8DA06"></a><h4 id="MULTI-GUID-6A039F5C-7221-4A38-9BDA-2E6F73B8DA06" class="sect4"><span class="enumeration_section">1.1.2</span>关于多租户架构的用户界面</h4>
                  <div>
                     <p>您可以对CDB和非CDB使用相同的管理工具。</p>
                     <div class="tblformal" id="GUID-6A039F5C-7221-4A38-9BDA-2E6F73B8DA06__GUID-60D995EC-6021-4F34-966F-7E78D2789728">
                        <p class="titleintable">表1-1多租户环境中的工具</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="多租户环境中的工具" border="1" summary="This table describes the tools that you can use in a multitenant environment." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d5997e682">接口</th>
                                 <th align="left" valign="bottom" width="20%" id="d5997e684">描述</th>
                                 <th align="left" valign="bottom" width="20%" id="d5997e686">也可以看看</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d5997e690" headers="d5997e682 ">
                                    <p>SQL * Plus和SQL Developer用于命令行访问</p> 
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d5997e690 d5997e684 ">
                                    <p>SQL * Plus是随Oracle Database一起安装的交互式批处理查询工具。</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d5997e690 d5997e686 ">
                                    <p><a href="../sqpug/SQL-Plus-quick-start.html#SQPUG-GUID-BF1995BD-EF9B-4EA2-9B32-7BFACDEB79DA" target="_blank"><span><cite>SQL * Plus用户指南和参考</cite></span></a></p> 
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d5997e706" headers="d5997e682 ">
                                    <p>Oracle企业管理器云控制（云控制）</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d5997e706 d5997e684 ">
                                    <p>Cloud Control是一个Oracle数据库管理工具，提供图形用户界面（GUI）。Cloud Control支持<span>Oracle Database 12c</span>目标，包括PDB，CDB和非CDB。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d5997e706 d5997e686 ">Cloud Control在线帮助</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d5997e718" headers="d5997e682 ">
                                    <p>Oracle Enterprise Manager Database Express（EM Express）</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d5997e718 d5997e684 ">
                                    <p>EM Express是内置于Oracle数据库中的基于Web的管理产品。EM Express使您可以配置和管理PDB，包括以下操作：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>创建和删除PDB</p>
                                       </li>
                                       <li>
                                          <p>插入和拔出PDB</p>
                                       </li>
                                       <li>
                                          <p>克隆PDB</p>
                                       </li>
                                       <li>
                                          <p>设置PDB的资源限制</p>
                                       </li>
                                    </ul>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d5997e718 d5997e686 ">
                                    <p><a href="../admqs/managing-pdbs-with-em-express.html#ADMQS12495" target="_blank"><span><cite>Oracle数据库性能调整指南</cite></span></a> ，了解有关使用EM Express管理CDB和PDB的更多信息</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d5997e746" headers="d5997e682 ">
                                    <p>Oracle数据库配置助手（DBCA）</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d5997e746 d5997e684 ">
                                    <p>DBCA是一个具有图形用户界面的实用程序，可用于创建和复制CDB。它还使您能够创建，重定位，克隆，插入和拔出PDB。</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d5997e746 d5997e686 ">
                                    <p>有关DBCA的详细信息，请参见<a href="../admqs/installing-oracle-database-creating-database.html#ADMQS023" target="_blank"><span><cite>“Oracle数据库性能调整指南”</cite></span></a>和“ <a href="../admin/creating-and-configuring-an-oracle-database.html#ADMIN12479" target="_blank"><span><cite>Oracle数据库管理员指南”</cite></span></a></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-6A039F5C-7221-4A38-9BDA-2E6F73B8DA06__GUID-F1AF27FC-8001-4632-A7E8-7F766B63F1FC">
                        <p class="notep1">也可以看看：</p>
                        <p>有关数据库管理员工具的更多信息，请参阅<a href="../cncpt/concepts-for-database-administrators.html#CNCPT-GUID-FA659979-25B7-4611-AA8D-48B5404301FE" target="_blank"><span><cite>Oracle数据库概</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-C5B0AF7D-ABE8-4F69-9552-F4DAF40281F1" title="多租户架构使Oracle数据库可用作多租户容器数据库（CDB）。">关于多租户架构</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="CNCPT89239"></a><a id="CNCPT89238"></a><div class="props_rev_3"><a id="GUID-31CE5970-4A53-44E0-AEA0-D2F7AE09D7E7" name="GUID-31CE5970-4A53-44E0-AEA0-D2F7AE09D7E7"></a><h3 id="MULTI-GUID-31CE5970-4A53-44E0-AEA0-D2F7AE09D7E7" class="sect3"><span class="enumeration_section">1.2</span>多租户架构的好处</h3>
               <div>
                  <p>多租户架构解决了传统非CDB架构带来的几个问题。</p>
                  <p>本节包含以下主题：</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-DCE7F725-450E-4B58-ADBC-F51BED0637DE">非CDB架构面临的挑战</a><br>大型企业可能使用数百或数千个数据库。这些数据库通常在多个物理服务器上的不同平台上运行
                     </li>
                     <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-22C7512B-024B-423B-8C29-73CB396A1D31">多租户架构对数据库整合的好处</a><br><strong class="term">数据库整合</strong>是将来自多个数据库的数据合并到一台计算机上的一个数据库中的过程。Oracle Multitenant选项使您可以合并数据和代码， <span class="italic">而无需更改现有模式或应用程序</span> 。
                     </li>
                     <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-1531D374-BF2B-4F6F-A1E5-11B167B7C604">多租户架构对可管理性的好处</a><br>多租户架构具有数据库整合之外的优势。这些好处源于将PDB中特定于PDB的数据<span class="italic">和</span>元数据存储在PDB本身中，而不是将所有字典元数据存储在一个位置。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-267F7D12-D33F-4AC9-AA45-E9CD671B6F22" title="熟悉Oracle Multitenant选项。">多租户架构简介</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-DCE7F725-450E-4B58-ADBC-F51BED0637DE" name="GUID-DCE7F725-450E-4B58-ADBC-F51BED0637DE"></a><h4 id="MULTI-GUID-DCE7F725-450E-4B58-ADBC-F51BED0637DE" class="sect4"><span class="enumeration_section">1.2.1</span>非CDB架构面临的挑战</h4>
                  <div>
                     <p>大型企业可能使用数百或数千个数据库。这些数据库通常在多个物理服务器上的不同平台上运行</p>
                     <p>由于硬件技术的改进，特别是CPU数量的增加，服务器可以处理比以前更重的工作负载。数据库可能只使用服务器硬件容量的一小部分。这种方法浪费了硬件和人力资源。</p>
                     <p>例如，100个服务器可能每个都有一个数据库，每个数据库使用10％的硬件资源和10％的管理员时间。DBA团队必须分别管理每个数据库的SGA，数据库文件，帐户，安全性等，而系统管理员必须维护100台不同的计算机。</p>
                     <p>为了以缩小的比例显示问题， <a href="introduction-to-the-multitenant-architecture.html#GUID-DCE7F725-450E-4B58-ADBC-F51BED0637DE__CEGBJAHC">图1-4</a>描绘了11个数据库，每个数据库都有自己的应用程序和服务器。负责DBA的团队负责监督由四个DBA组成的团队，每个DBA负责两个或三个数据库。
                     </p>
                     <div class="figure" id="GUID-DCE7F725-450E-4B58-ADBC-F51BED0637DE__CEGBJAHC">
                        <p class="titleinfigure">图1-4数据库合并前的数据库环境</p><img src="img/cncpt346.png" alt="下面是图1-4的描述" title="下面是图1-4的描述" longdesc="img_text/cncpt346.html"><br><a href="img_text/cncpt346.html">“图1-4数据库合并前的数据库环境”的说明</a></div>
                     <!-- class="figure" -->
                     <p>典型的回应包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用虚拟机（VM）。</p>
                           <p>在此模型中，您将在虚拟机中复制物理服务器操作系统和数据库的操作基础结构。虚拟机很灵活，但使用技术资源效率低下，需要单独管理。虚拟蔓延，管理起来同样昂贵，取代了现有的物理蔓延。</p>
                        </li>
                        <li>
                           <p>在每台服务器上放置多个数据库</p>
                           <p>单独的数据库消除了操作系统复制，但不共享后台进程，系统和进程内存或Oracle元数据。数据库需要个人管理。</p>
                        </li>
                        <li>
                           <p>将数据逻辑分离为模式或虚拟专用数据库（VPD）。</p>
                           <p>该技术有效地使用技术资源。您可以将多个模式或VPD作为一个进行管理。但是，这种模式的灵活性低于其替代方案，需要更多的工作来管理，保护和传输。此外，逻辑模型通常需要进行大量的应用程序更改，这会阻碍采用。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-31CE5970-4A53-44E0-AEA0-D2F7AE09D7E7" title="多租户架构解决了传统非CDB架构带来的几个问题。">多租户架构的优点</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="CNCPT89241"></a><a id="CNCPT89240"></a><div class="props_rev_3"><a id="GUID-22C7512B-024B-423B-8C29-73CB396A1D31" name="GUID-22C7512B-024B-423B-8C29-73CB396A1D31"></a><h4 id="MULTI-GUID-22C7512B-024B-423B-8C29-73CB396A1D31" class="sect4"><span class="enumeration_section">1.2.2</span>多租户架构对数据库整合的好处</h4>
                  <div>
                     <p><strong class="term">数据库整合</strong>是将来自多个数据库的数据合并到一台计算机上的一个数据库中的过程。Oracle Multitenant选项使您可以合并数据和代码， <span class="italic">而无需更改现有模式或应用程序</span> 。
                     </p>
                     <p><a href="glossary.html#GUID-53C76478-67F0-4835-A325-F62258856D2A"><span class="xrefglossterm">PDB /非CDB兼容性保证</span></a>意味着从与Oracle Net连接的客户端看，PDB的行为与非CDB相同。针对非CDB运行的应用程序定义（例如，表和PL / SQL包）的安装方案对PDB运行相同并产生相同的结果。此外，连接到包含应用程序定义的PDB的客户端代码的运行时行为与连接到包含此应用程序定义的非CDB的客户端代码的行为相同。
                     </p>
                     <p>作用于整个非CDB的操作在整个CDB上以相同的方式起作用，例如，在使用Oracle Data Guard和数据库备份和恢复时。因此，非CDB的用户，管理员和开发人员在合并数据库之后具有基本相同的体验。</p>
                     <p>下图描绘了合并到一台计算机后<a href="introduction-to-the-multitenant-architecture.html#GUID-DCE7F725-450E-4B58-ADBC-F51BED0637DE__CEGBJAHC">图1-4中</a>的数据库。DBA团队从五个减少到三个，一个CDB管理员管理CDB，而两个PDB管理员分离PDB管理。
                     </p>
                     <div class="figure" id="GUID-22C7512B-024B-423B-8C29-73CB396A1D31__CEGIACBD">
                        <p class="titleinfigure">图1-5单CDB</p><img src="img/cncpt347.png" width="489" alt="下面是图1-5的描述" title="下面是图1-5的描述" longdesc="img_text/cncpt347.html"><br><a href="img_text/cncpt347.html">“图1-5单CDB”的描述</a></div>
                     <!-- class="figure" -->
                     <p>从<span>Oracle Database 12c</span>第2版（12.2）开始，您可以创建包含应用程序PDB的应用程序容器。此方法使您可以在此容器中创建和管理应用程序。适用于合并到CDB的大多数好处也适用于应用程序容器内的合并。
                     </p>
                     <p>使用多租户架构进行数据库整合具有以下优势：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>降低成本</p>
                           <p>通过将硬件和数据库基础架构整合到一组后台进程中，并有效地共享计算和内存资源，您可以降低硬件和维护成本。例如，单个服务器上的100个PDB共享一个数据库实例。</p>
                        </li>
                        <li>
                           <p>更轻松，更快速地移动数据和代码</p>
                           <p>通过设计，您可以快速将PDB插入CDB，从CDB中拔出PDB，然后将此PDB插入另一个CDB。您还可以在PDB保持可用时进行克隆。您可以使用任何字符集插入PDB，并在不进行字符集转换的情况下访问它。如果CDB的字符集是AL32UTF8，则具有不同数据库字符集的PDB可以存在于同一CDB中。</p>
                        </li>
                        <li>
                           <p>更轻松地管理和监控物理数据库</p>
                           <p><a href="glossary.html#GUID-24233CA1-CF2F-4E02-B202-83DB0571DDB9"><span class="xrefglossterm">CDB管理员</span></a>可以通过对所有托管租户和CDB根执行单个操作（例如修补或执行RMAN备份）来将环境作为聚合进行管理。简化了备份策略和灾难恢复。
                           </p>
                        </li>
                        <li>
                           <p>分离数据和代码</p>
                           <p>虽然PDB合并为单个物理数据库，但PDB模仿非CDB的行为。例如，如果用户错误丢失关键数据，则PDB管理员可以使用Oracle闪回或时间点恢复来检索丢失的数据，而不会影响其他PDB。</p>
                        </li>
                        <li>
                           <p>安全分离行政职责</p>
                           <div class="p"><a href="glossary.html#GUID-879D936A-45FE-4E4D-8099-5060F3F55353"><span class="xrefglossterm">普通用户</span></a>可以连接到具有足够权限的任何容器，而<a href="glossary.html#GUID-03248AD7-8E10-4FA0-8D33-8D2EC59B1905"><span class="xrefglossterm">本地用户</span></a>仅限于特定PDB。管理员可以按如下方式划分职责：<ul style="list-style-type:disc">
                                 <li>
                                    <p>管理员使用公共帐户来管理CDB或应用程序容器。由于权限包含在授予它的容器中，因此一个PDB上的本地用户不具有同一CDB中其他PDB的权限。</p>
                                    <p></p>
                                 </li>
                                 <li>
                                    <p>管理员使用本地帐户管理单个PDB。</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p>易于性能调整</p>
                           <p>收集单个数据库的性能指标比处理多个数据库更容易。一个SGA的大小比100个SGA更容易。</p>
                        </li>
                        <li>
                           <p>更少的数据库补丁和升级</p>
                           <p>将修补程序应用于一个数据库而不是100个数据库，升级一个数据库比升级100个数据库更容易。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-22C7512B-024B-423B-8C29-73CB396A1D31__GUID-9BF11D9D-C9F8-480D-954B-2FBA19359D3C">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="overview-of-managing-a-multitenant-environment.html#GUID-528FBE02-2B84-4E97-BD87-36AEF9EA524D" title="熟悉与配置和管理多租户环境相关的基本概念。">配置和管理多租户环境概述</a> ”</span></p>
                           </li>
                           <li><a href="../dbseg/managing-security-for-oracle-database-users.html#DBSEG580" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a>了解常见用户</li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-31CE5970-4A53-44E0-AEA0-D2F7AE09D7E7" title="多租户架构解决了传统非CDB架构带来的几个问题。">多租户架构的优点</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="CNCPT89242"></a><div class="props_rev_3"><a id="GUID-1531D374-BF2B-4F6F-A1E5-11B167B7C604" name="GUID-1531D374-BF2B-4F6F-A1E5-11B167B7C604"></a><h4 id="MULTI-GUID-1531D374-BF2B-4F6F-A1E5-11B167B7C604" class="sect4"><span class="enumeration_section">1.2.3</span>多租户架构对可管理性的好处</h4>
                  <div>
                     <p>多租户架构具有数据库整合之外的优势。这些好处源于将PDB中特定于PDB的数据<span class="italic">和</span>元数据存储在PDB本身中，而不是将所有字典元数据存储在一个位置。
                     </p>
                     <p>通过存储其自己的字典元数据，PDB变得更容易作为独立单元进行管理。即使只有一个PDB驻留在CDB中，也会产生这种好处。将PDB分组到单独管理的应用程序容器中可进一步提高可管理性。</p>
                     <p>在CDB中，数据字典元数据在根和PDB之间分开。数据字典分离的好处包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>更轻松地升级数据和代码</p>
                           <p>例如，您可以从现有CDB快速拔出PDB，然后将其从更高版本插入新创建的CDB，而不是将CDB从一个数据库版本升级到另一个数据库版本。</p>
                        </li>
                        <li>
                           <p>服务器之间的迁移更容易</p>
                           <p>要执行负载平衡或满足SLA，您可以将应用程序数据库从内部部署数据中心迁移到云，或者迁移到同一环境中的两台服务器之间。</p>
                        </li>
                        <li>
                           <p>防止PDB中的数据损坏</p>
                           <p>您可以将PDB闪回到SCN或PDB特定的还原点，而不会影响其他PDB。此功能类似于非CDB的闪回数据库功能。</p>
                        </li>
                        <li>
                           <p>能够在一个位置安装，管理和升级特定于应用程序的数据和元数据</p>
                           <p>您可以将一组特定于应用程序的PDB定义为单个组件，称为<a href="glossary.html#GUID-F939B8E5-8DCE-4831-9B81-224C1D6DC1AA"><span class="xrefglossterm">应用程序容器</span></a> 。然后，您可以在此容器中定义一个或多个应用程序。每个应用程序都是在此应用程序容器中共享的命名的，版本化的公共元数据和数据集。
                           </p>
                           <p>例如，SaaS供应商的每个客户都可以拥有自己的<a href="glossary.html#GUID-E9DA1D6D-DBFC-41C5-B24E-F508B671BF06"><span class="xrefglossterm">应用程序PDB</span></a> 。每个应用程序PDB可能具有相同定义的名为<code class="codeph">sales_mlt</code>表，每个PDB中具有不同的数据。 PDB可以共享名为<code class="codeph">countries_olt</code>的<a href="glossary.html#GUID-AC86D2B2-13FB-4FF5-B272-41FF0C6254CB"><span class="xrefglossterm">数据链接公共对象</span></a> ，该<a href="glossary.html#GUID-AC86D2B2-13FB-4FF5-B272-41FF0C6254CB"><span class="xrefglossterm">对象</span></a>在每个PDB中具有相同的数据。作为应用程序管理员，您可以管理主应用程序定义，以便每个新客户获得具有相同对象的PDB，以及对现有模式的每个更改（例如，添加新表或更改定义表）适用于共享应用程序定义的所有PDB。
                           </p>
                        </li>
                        <li>
                           <p>与Oracle数据库资源管理器集成</p>
                           <p>在多租户环境中，一个问题是在同一服务器上运行的PDB之间争用系统资源。另一个问题是限制资源使用以获得更一致，可预测的性能。要解决此类资源争用，使用和监视问题，请使用Oracle数据库资源管理器。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-1531D374-BF2B-4F6F-A1E5-11B167B7C604__GUID-2D8492A3-FA6B-4F78-9758-F476F8DE98BD">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p> <span class="q">“ <a href="overview-of-the-multitenant-architecture.html#GUID-EFAD745A-D76B-4218-AC5F-3B72F4D4C277" title="使用Oracle Resource Manager（资源管理器），您可以创建CDB资源计划并设置初始化参数以将资源分配给PDB。">CDB中Oracle资源管理器概述</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="overview-of-the-multitenant-architecture.html#GUID-A356382A-413A-4A42-98DC-6C2464808202" title="从用户和应用程序的角度来看，CDB中每个容器中的数据字典是独立的，就像它在非CDB中一样。">CDB中的数据字典架构</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="administering-application-containers-with-sql-plus.html#GUID-1AFD0268-6A2B-4F84-BB4D-4D36976DE53B" title="您可以管理应用程序容器，包括应用程序根和应用程序PDB。您还可以管理应用程序容器中安装的应用程序。">管理应用程序容器</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-31CE5970-4A53-44E0-AEA0-D2F7AE09D7E7" title="多租户架构解决了传统非CDB架构带来的几个问题。">多租户架构的优点</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="CNCPT89243"></a><div class="props_rev_3"><a id="GUID-FDCD109B-1199-4250-802A-0F345D24F816" name="GUID-FDCD109B-1199-4250-802A-0F345D24F816"></a><h3 id="MULTI-GUID-FDCD109B-1199-4250-802A-0F345D24F816" class="sect3"><span class="enumeration_section">1.3</span>数据库整合的途径</h3>
               <div>
                  <p>在其存在的持续时间内，数据库是CDB或非CDB。</p>
                  <p>您必须在创建时将数据库定义为CDB，然后在此CDB中创建PDB和应用程序容器。您以后不能将非CDB转换为CDB，或将CDB转换为非CDB。</p>
                  <p>本节包含以下主题：</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-AFB8F415-A423-4049-8658-A93CDFD960DA">创建CDB</a><br><code class="codeph">CREATE DATABASE ...ENABLE PLUGGABLE DATABASE</code> SQL语句创建一个新的CDB。</li>
                     <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-92AF2E16-5215-4DB4-977E-BB08E6A65546">创建PDB</a><br><code class="codeph">CREATE PLUGGABLE DATABASE</code> SQL语句创建一个PDB。</li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-267F7D12-D33F-4AC9-AA45-E9CD671B6F22" title="熟悉Oracle Multitenant选项。">多租户架构简介</a></p>
                     </div>
                  </div>
               </div>
               <a id="CNCPT89339"></a><a id="CNCPT89244"></a><div class="props_rev_3"><a id="GUID-AFB8F415-A423-4049-8658-A93CDFD960DA" name="GUID-AFB8F415-A423-4049-8658-A93CDFD960DA"></a><h4 id="MULTI-GUID-AFB8F415-A423-4049-8658-A93CDFD960DA" class="sect4"><span class="enumeration_section">1.3.1</span>创建CDB</h4>
                  <div>
                     <p><code class="codeph">CREATE DATABASE ...ENABLE PLUGGABLE DATABASE</code> SQL语句创建一个新的CDB。</p>
                     <p>如果未指定<code class="codeph">ENABLE PLUGGABLE DATABASE</code>子句，则新创建的数据库是非CDB。在这种情况下，非CDB永远不能包含PDB。
                     </p>
                     <p>创建CDB时，Oracle数据库会自动创建根容器（ <code class="codeph">CDB$ROOT</code> ）和种子PDB（ <code class="codeph">PDB$SEED</code> ）。下图显示了新创建的CDB：</p>
                     <div class="figure" id="GUID-AFB8F415-A423-4049-8658-A93CDFD960DA__GUID-43D4A66D-308E-4FC0-AA1D-1D407714166D">
                        <p class="titleinfigure">图1-6带有种子PDB的CDB</p><img src="img/admin095.png" alt="下面描述图1-6" title="下面描述图1-6" longdesc="img_text/admin095.html"><br><a href="img_text/admin095.html">“图1-6带有种子PDB的CDB”的描述</a></div>
                     <!-- class="figure" -->
                     <div class="example" id="GUID-AFB8F415-A423-4049-8658-A93CDFD960DA__CEGFCHCJ">
                        <p class="titleinexample">示例1-3确定数据库是否为CDB</p>
                        <p>以下简单查询确定管理用户当前连接的数据库是非CDB还是CDB中的容器：</p><pre class="pre codeblock"><code>SQL&gt; SELECT NAME，CDB，CON_ID FROM V $ DATABASE;姓名CDB CON_ID --------- --- ---------- CDB1是0</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-AFB8F415-A423-4049-8658-A93CDFD960DA__GUID-018B49C8-2EA9-4BC0-8474-7018E7F7734F">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="creating-and-configuring-a-cdb.html#GUID-77D4BBA7-2A64-46D9-A2B8-C56060772215" title="创建和配置多租户容器数据库（CDB）包括计划，创建CDB和可选配置EM Express等任务。">创建和配置CDB</a> ”</span></p>
                           </li>
                           <li>
                              <p>有关为<code class="codeph">CREATE DATABASE</code>语句指定子句和参数值的详细信息，请<a href="../sqlrf/CREATE-DATABASE.html#SQLRF01204" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-FDCD109B-1199-4250-802A-0F345D24F816" title="在其存在的持续时间内，数据库是CDB或非CDB。">数据库合并的路径</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="CNCPT89245"></a><div class="props_rev_3"><a id="GUID-92AF2E16-5215-4DB4-977E-BB08E6A65546" name="GUID-92AF2E16-5215-4DB4-977E-BB08E6A65546"></a><h4 id="MULTI-GUID-92AF2E16-5215-4DB4-977E-BB08E6A65546" class="sect4"><span class="enumeration_section">1.3.2</span>创建PDB</h4>
                  <div>
                     <p><code class="codeph">CREATE PLUGGABLE DATABASE</code> SQL语句创建一个PDB。</p>
                     <p>创建的PDB自动包括完整数据字典，包括元数据和CDB根目录中系统提供的对象的内部链接。您必须从单个根定义每个PDB： <a href="glossary.html#GUID-1C63428A-905A-4918-95AA-F3BBA3D2B825"><span class="xrefglossterm">CDB根</span></a>或<a href="glossary.html#GUID-66EC71A6-6AC1-4BC2-B30A-A0DCA68AEE28"><span class="xrefglossterm">应用程序根</span></a> 。
                     </p>
                     <p>每个PDB都有一个全局唯一标识符（GUID）。PDB GUID主要用于为存储PDB文件的目录生成名称，包括Oracle Managed Files目录和非Oracle Managed Files目录。</p>
                     <p>本节包含以下主题：</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-1CB3617F-8B18-441D-96B3-3E7767A5ED1D">通过克隆创建PDB</a><br>创建PDB的一种技术称为<span class="italic">克隆</span> 。
                        </li>
                        <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-2D57C40D-5CB1-41B0-9A08-F58D5B7C533D">通过插入创建PDB</a><br>您可以通过插入未插入的PDB或将非CDB作为PDB插入来创建PDB。</li>
                        <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-D84C3A7F-A1B3-4651-B99B-9F76E7331F83">通过重新定位创建PDB</a><br>要将PDB从一个CDB重新定位到另一个CDB，请使用<code class="codeph">CREATE PLUGGABLE DATABASE ...RELOCATE</code>语句或DBCA。</li>
                        <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-53820A0C-E88A-40C0-AAE0-01A6371A146B">创建PDB作为代理PDB</a><br><strong class="term">代理PDB</strong>提供对远程CDB中不同PDB的访问，称为<strong class="term">引用的PDB</strong> 。</li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-92AF2E16-5215-4DB4-977E-BB08E6A65546__GUID-17B555A6-9848-473D-B9CC-D631E76B4840">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="creating-pdbs.html#GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413" title="您可以使用各种技术创建PDB，应用程序容器和应用程序种子。">创建和删除PDB和应用程序容器</a> ”</span></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-FDCD109B-1199-4250-802A-0F345D24F816" title="在其存在的持续时间内，数据库是CDB或非CDB。">数据库合并的路径</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="sect4"><a id="GUID-1CB3617F-8B18-441D-96B3-3E7767A5ED1D" name="GUID-1CB3617F-8B18-441D-96B3-3E7767A5ED1D"></a><h5 id="MULTI-GUID-1CB3617F-8B18-441D-96B3-3E7767A5ED1D" class="sect5"><span class="enumeration_section">1.3.2.1</span>通过克隆创建PDB</h5>
                     <div>
                        <p>创建PDB的一种技术称为<span class="italic">克隆</span> 。
                        </p>
                        <p>您可以从<code class="codeph">PDB$SEED</code> ，应用程序种子，远程或本地PDB或非CDB克隆PDB。本节包含以下主题：</p>
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-FC58D7C8-6C5E-49E7-9D99-A83D0B58B16D">从种子创建PDB</a><br>您可以使用<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句从种子创建PDB。
                           </li>
                           <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-179F941D-B0AE-4BBC-AA59-430652B809B5">通过克隆PDB或非CDB来创建PDB</a><br>要克隆PDB或非CDB，请使用带有<code class="codeph">FROM</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句。
                           </li>
                        </ul>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-92AF2E16-5215-4DB4-977E-BB08E6A65546" title="CREATE PLUGGABLE DATABASE SQL语句创建一个PDB。">创建PDB</a></p>
                           </div>
                        </div>
                     </div>
                     <a id="CNCPT89340"></a><div class="props_rev_3"><a id="GUID-FC58D7C8-6C5E-49E7-9D99-A83D0B58B16D" name="GUID-FC58D7C8-6C5E-49E7-9D99-A83D0B58B16D"></a><h6 id="MULTI-GUID-FC58D7C8-6C5E-49E7-9D99-A83D0B58B16D" class="sect6"><span class="enumeration_section">1.3.2.1.1</span>从种子创建PDB</h6>
                        <div>
                           <p>您可以使用<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句从种子创建PDB。
                           </p>
                           <p>种子是PDB，用作创建另一个PDB的模板。从种子创建PDB会复制PDB的部分或全部内容，然后分配新的唯一标识符。</p>
                           <p>种子PDB是以下任何一种：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>PDB种子（ <code class="codeph">PDB$SEED</code> ），它是用于创建PDB的系统提供的模板</p>
                                 <p>每个CDB只有一个<code class="codeph">PDB$SEED</code> ，不能修改或删除。
                                 </p>
                              </li>
                              <li>
                                 <p><a href="glossary.html#GUID-BCC6BCFA-FFA1-4C84-8804-1CC13BF86350"><span class="xrefglossterm">应用程序种子</span></a> ，是用户为指定<a href="glossary.html#GUID-66EC71A6-6AC1-4BC2-B30A-A0DCA68AEE28"><span class="xrefglossterm">应用程序根</span></a>创建的PDB</p>
                                 <p>在<a href="glossary.html#GUID-F939B8E5-8DCE-4831-9B81-224C1D6DC1AA"><span class="xrefglossterm">应用程序容器中</span></a> ，您可以使用<code class="codeph">CREATE PLUGGABLE DATABASE AS SEED</code>语句创建应用程序种子，然后可以使用该语句来加速新应用程序PDB的创建。
                                 </p>
                              </li>
                           </ul>
                           <div class="figure" id="GUID-FC58D7C8-6C5E-49E7-9D99-A83D0B58B16D__GUID-EC1F2054-90AD-48B3-8599-9E7B2E0953F2">
                              <p class="titleinfigure">图1-7从PDB $ SEED创建</p><img src="img/admin089.png" alt="下面是图1-7的描述" title="下面是图1-7的描述" longdesc="img_text/admin089.html"><br><a href="img_text/admin089.html">“图1-7从PDB $ SEED创建”的描述</a></div>
                           <!-- class="figure" -->
                           <div class="example" id="GUID-FC58D7C8-6C5E-49E7-9D99-A83D0B58B16D__GUID-ECBDCCF1-FA16-4ECB-A889-BECBFCCF0177">
                              <p class="titleinexample">示例1-4从PDB $ SEED创建PDB</p>
                              <p>以下SQL语句使用Oracle Managed Files从<code class="codeph">PDB$SEED</code>创建名为<code class="codeph">hrpdb</code>的<code class="codeph">PDB$SEED</code> ：</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE hrpdb ADMIN USER dba1 IDENTIFIED BY <span class="italic">password</span> ;</code></pre></div>
                           <!-- class="example" -->
                        </div>
                        <div>
                           <div class="infoboxnotealso" id="GUID-FC58D7C8-6C5E-49E7-9D99-A83D0B58B16D__GUID-E98AA63E-3B87-4AF3-A827-CBA315E100C0">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="creating-a-pdb-from-scratch.html#GUID-CCA938BD-52BE-422C-86AF-576D3E02B96B" title="使用CREATE PLUGGABLE DATABASE语句使用PDB种子（PDB $ SEED）的文件在CDB中创建PDB。">从头开始创建PDB</a> ”</span></p>
                           </div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-1CB3617F-8B18-441D-96B3-3E7767A5ED1D" title="创建PDB的一种技术称为克隆。">通过克隆创建PDB</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="CNCPT89341"></a><div class="props_rev_3"><a id="GUID-179F941D-B0AE-4BBC-AA59-430652B809B5" name="GUID-179F941D-B0AE-4BBC-AA59-430652B809B5"></a><h6 id="MULTI-GUID-179F941D-B0AE-4BBC-AA59-430652B809B5" class="sect6"><span class="enumeration_section">1.3.2.1.2</span>通过克隆PDB或非CDB创建PDB</h6>
                        <div>
                           <p>要克隆PDB或非CDB，请使用带有<code class="codeph">FROM</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句。
                           </p>
                           <p>在该技术中，源是非CDB，或本地或远程CDB中的PDB。目标是从源复制的PDB。克隆操作将与源关联的文件复制到新位置，然后分配新GUID以创建PDB。</p>
                           <p>此技术对于快速创建用于测试和开发的PDB非常有用。例如，您可以在生产PDB中部署应用程序之前，在克隆的PDB上测试新的或已修改的应用程序。如果PDB处于<a href="glossary.html#GUID-0E68809A-AB48-4DAD-BFBD-8ACC23656C4B"><span class="xrefglossterm">本地撤销模式</span></a> ，则源PDB可以在操作期间以读/写模式打开，称为<a href="glossary.html#GUID-A6C7E446-333C-42B1-A6BD-277029EE2E36"><span class="xrefglossterm">热克隆</span></a> 。
                           </p>
                           <div class="infoboxnote" id="GUID-179F941D-B0AE-4BBC-AA59-430652B809B5__GUID-B4682557-5476-44A0-B847-8C8D28521277">
                              <p class="notep1">注意：</p>
                              <p>如果从远程CDB克隆PDB，则必须使用数据库链接。</p>
                           </div>
                           <p>如果在应用程序根目录中运行<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句，则会在应用程序容器中创建克隆的PDB。在这种情况下，源PDB的应用程序名称和版本必须与应用程序名称和应用程序容器的版本兼容。
                           </p>
                           <p>下图说明了当源和目标位于同一CDB时克隆PDB。</p>
                           <div class="figure" id="GUID-179F941D-B0AE-4BBC-AA59-430652B809B5__GUID-BFC03230-794F-4C64-BF0A-AF23507A5C20">
                              <p class="titleinfigure">图1-8克隆PDB</p><img src="img/admin091.png" alt="下面是图1-8的描述" title="下面是图1-8的描述" longdesc="img_text/admin091.html"><br><a href="img_text/admin091.html">“图1-8克隆PDB”的描述</a></div>
                           <!-- class="figure" -->
                           <p>从<span>Oracle Database 19c开始</span> ，您可以使用DBCA克隆远程PDB。</p>
                           <div class="example" id="GUID-179F941D-B0AE-4BBC-AA59-430652B809B5__GUID-6ACA143C-3984-4BA0-B531-DD43E3BE3BBF">
                              <p class="titleinexample">实施例1-5克隆PDB</p>
                              <p>下面的SQL语句克隆一个名为PDB <code class="codeph">salespdb</code>从插入的PDB命名<code class="codeph">hrpdb</code> ：</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE salespdb FROM hrpdb;</code></pre><p>本节包含以下主题：</p>
                           </div>
                           <!-- class="example" -->
                        </div>
                        <div>
                           <ul class="ullinks">
                              <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-47847140-8DE4-4C4E-8C93-4E9C197D1402">PDB快照</a><br><span><strong class="term">PDB快照</strong>是<strong class="term">PDB</strong>的时间点副本。</span></li>
                              <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-06CEC476-EF10-4516-88D4-F398640A1137">快照复制PDB</a><br><strong class="term">快照复制PDB</strong>是基于存储管理（非数据库管理）快照的PDB。PDB不包含源数据文件的完整副本。
                              </li>
                              <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-D5AE0EBD-76CA-4E7C-8637-1D6B56597021">可刷新的克隆PDB</a><br><span><strong class="term">可刷新克隆PDB</strong>是<span>只读克隆，可以定期与其源PDB同步。</span></span> 
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-179F941D-B0AE-4BBC-AA59-430652B809B5__GUID-1579E930-9B9E-4050-B193-CC461205D5D8">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="cloning-a-pdb.html#GUID-05702CEB-A43C-452C-8081-4CA68DDA8007" title="您可以通过克隆本地PDB，远程PDB或非CDB来创建PDB。">克隆PDB或非CDB</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="overview-of-the-multitenant-architecture.html#GUID-5902ABDC-40BE-4CF4-9917-A5D7F4C396F1" title="CDB具有与非CDB相同的结构，除了每个PDB和应用程序根都有自己的一组表空间，包括它自己的SYSTEM，SYSAUX和undo表空间。">CDB中的表空间和数据库文件概述</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="overview-of-the-multitenant-architecture.html#GUID-9327F698-36F7-45CC-9964-4685D48FF254" title="在此上下文中，应用程序维护是指安装，卸载，升级或修补应用程序。">应用程序维护</a> ”</span></p>
                                 </li>
                              </ul>
                           </div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-1CB3617F-8B18-441D-96B3-3E7767A5ED1D" title="创建PDB的一种技术称为克隆。">通过克隆创建PDB</a></p>
                              </div>
                           </div>
                        </div>
                        
                        <div class="sect6"><a id="GUID-47847140-8DE4-4C4E-8C93-4E9C197D1402" name="GUID-47847140-8DE4-4C4E-8C93-4E9C197D1402"></a><h6 id="MULTI-GUID-47847140-8DE4-4C4E-8C93-4E9C197D1402" class="sect6"><span class="enumeration_section">1.3.2.1.2.1</span> PDB快照</h6>
                           <div>
                              <p><span><strong class="term">PDB快照</strong>是<strong class="term">PDB</strong>的时间点副本。</span></p>
                              <p>您可以使用PDB快照根据时间点快照克隆PDB。克隆PDB在开发测试中很有用。</p>
                              <p>您可以使用<code class="codeph">CREATE PLUGGABLE DATABASE</code> （或<code class="codeph">ALTER PLUGGABLE DATABASE</code> ）的<code class="codeph">SNAPSHOT</code>子句手动创建快照，也可以使用<code class="codeph">EVERY <span class="codeinlineitalic">interval</span></code>子句自动创建快照。以下DDL语句创建名为<code class="codeph">pdb1_wed_4_1201</code>的PDB快照：</p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE SNAPSHOT pdb1_wed_4_1201;</code></pre><p>从<span>Oracle Database 19c开始</span> ，您可以在读/写模式下创建源PDB的快照。PDB快照的内容取决于创建快照时<code class="codeph">CLONEDB</code>初始化参数的设置。当<code class="codeph">CLONEDB</code>为<code class="codeph">TRUE</code> ，快照是PDB数据文件的稀疏副本。当<code class="codeph">CLONEDB</code>为<code class="codeph">FALSE</code> ，快照是PDB文件的完整副本。
                              </p>
                              <p><code class="codeph">CREATE PLUGGABLE DATABASE</code>语句的<code class="codeph">USING SNAPSHOT</code>子句从PDB快照创建快照克隆PDB。例如，下面的语句克隆一个名为PDB <code class="codeph">pdb1_copy</code>从PDB快照命名<code class="codeph">pdb1_wed_4_1201</code> ：</p><pre class="pre codeblock"><code>从pdb1创建可插入的数据库pdb1_copy使用SNAPSHOT pdb1_wed_4_1201;</code></pre></div>
                           <div>
                              <div class="infoboxnotealso" id="GUID-47847140-8DE4-4C4E-8C93-4E9C197D1402__GUID-2FFC8633-8544-4BB0-9755-9BF6E0FDD169">
                                 <p class="notep1">也可以看看：</p>
                                 <ul id="GUID-47847140-8DE4-4C4E-8C93-4E9C197D1402__UL_JKB_T5S_YFB" style="list-style-type:disc">
                                    <li>
                                       <p><span class="q">“ <a href="cloning-a-pdb.html#GUID-F6F105E1-AB69-4DD0-9A70-51EDD4B2426D" title="PDB快照是PDB的数据库管理的时间点副本。快照克隆PDB是从快照创建的PDB。">关于从PDB快照克隆PDB</a> ”</span></p>
                                    </li>
                                    <li>
                                       <p><span><a href="../dblic/Licensing-Information.html#DBLIC-GUID-0F9EB85D-4610-4EDF-89C2-4916A0E7AC87" target="_blank"><span><cite>“Oracle数据库许可信息用户手册”</cite></span></a> ，了解不同版本和服务支持哪些功能的详细信息</span></p>
                                    </li>
                                 </ul>
                              </div>
                              <div class="familylinks">
                                 <div class="parentlink">
                                    <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-179F941D-B0AE-4BBC-AA59-430652B809B5" title="要克隆PDB或非CDB，请使用带有FROM子句的CREATE PLUGGABLE DATABASE语句。">通过克隆PDB或非CDB创建PDB</a></p>
                                 </div>
                              </div>
                           </div>
                           
                        </div>
                        <div class="sect6"><a id="GUID-06CEC476-EF10-4516-88D4-F398640A1137" name="GUID-06CEC476-EF10-4516-88D4-F398640A1137"></a><h6 id="MULTI-GUID-06CEC476-EF10-4516-88D4-F398640A1137" class="sect6"><span class="enumeration_section">1.3.2.1.2.2</span>快照复制PDB</h6>
                           <div>
                              <p><strong class="term">快照复制PDB</strong>是基于存储管理（非数据库管理）快照的PDB。PDB不包含源数据文件的完整副本。
                              </p>
                              <p>如果文件系统支持存储快照，则可以通过指定<code class="codeph">SNAPSHOT COPY</code>子句几乎立即克隆PDB。在这种情况下，Oracle数据库会创建基础文件系统的存储托管快照，然后使用存储快照创建PDB克隆。快照复制PDB包含稀疏文件。
                              </p>
                              <p>与标准克隆PDB不同，无法从CDB根目录或应用程序根目录中拔出快照复制PDB。此外，如果存在快照克隆，则无法删除或拔出生成克隆的源PDB。</p>
                              <div class="infoboxnote" id="GUID-06CEC476-EF10-4516-88D4-F398640A1137__GUID-BEBD1F22-704D-4505-AF0D-467EC55E520B">
                                 <p class="notep1">注意：</p>
                                 <p><span class="q">“ <a href="cloning-a-pdb.html#GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B" title="克隆意味着从源PDB或非CDB创建新的PDB。">关于克隆PDB或非CDB</a> ”</span>以了解如何使用<code class="codeph">SNAPSHOT COPY</code>子句克隆PDB</p>
                              </div>
                           </div>
                           <div>
                              <div class="familylinks">
                                 <div class="parentlink">
                                    <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-179F941D-B0AE-4BBC-AA59-430652B809B5" title="要克隆PDB或非CDB，请使用带有FROM子句的CREATE PLUGGABLE DATABASE语句。">通过克隆PDB或非CDB创建PDB</a></p>
                                 </div>
                              </div>
                           </div>
                           
                        </div>
                        <div class="sect6"><a id="GUID-D5AE0EBD-76CA-4E7C-8637-1D6B56597021" name="GUID-D5AE0EBD-76CA-4E7C-8637-1D6B56597021"></a><h6 id="MULTI-GUID-D5AE0EBD-76CA-4E7C-8637-1D6B56597021" class="sect6"><span class="enumeration_section">1.3.2.1.2.3可</span>刷新克隆PDB</h6>
                           <div>
                              <p><span><strong class="term">可刷新克隆PDB</strong>是<span id="d163e422">只读克隆，可以定期与其源PDB同步。</span></span> 
                              </p>
                              <p>根据<code class="codeph">REFRESH MODE</code>子句中指定的值，自动或手动进行同步。例如，如果<code class="codeph">hrpdb_re_clone</code>是克隆<code class="codeph">hrpdb</code> ，那么每个月你可以手动刷新<code class="codeph">hrpdb_re_clone</code>与变化<code class="codeph">hrpdb</code> 。或者，您可以将<code class="codeph">hrpdb</code>配置为每24小时自动将更改传播到<code class="codeph">hrpdb_re_clone</code> 。
                              </p>
                              <p>您可以切换源PDB及其可刷新克隆的角色。此切换对于CDB之间的负载平衡以及源PDB出现故障时非常有用。</p>
                              <div class="infoboxnote" id="GUID-D5AE0EBD-76CA-4E7C-8637-1D6B56597021__GUID-4DC22A09-9331-4A0C-A5CB-F2BE67844496">
                                 <p class="notep1">注意：</p>
                                 <p><span class="q">“ <a href="cloning-a-pdb.html#GUID-8A6287A1-14E5-4B45-972F-FC2FB3CDCF8B" title="克隆意味着从源PDB或非CDB创建新的PDB。">关于克隆PDB或非CDB</a> ”</span>以了解如何使用<code class="codeph">REFRESH MODE</code>子句克隆PDB</p>
                              </div>
                           </div>
                           <div>
                              <div class="familylinks">
                                 <div class="parentlink">
                                    <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-179F941D-B0AE-4BBC-AA59-430652B809B5" title="要克隆PDB或非CDB，请使用带有FROM子句的CREATE PLUGGABLE DATABASE语句。">通过克隆PDB或非CDB创建PDB</a></p>
                                 </div>
                              </div>
                           </div>
                           
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-2D57C40D-5CB1-41B0-9A08-F58D5B7C533D" name="GUID-2D57C40D-5CB1-41B0-9A08-F58D5B7C533D"></a><h5 id="MULTI-GUID-2D57C40D-5CB1-41B0-9A08-F58D5B7C533D" class="sect5"><span class="enumeration_section">1.3.2.2</span>通过插入创建PDB</h5>
                     <div>
                        <p>您可以通过插入未插入的PDB或将非CDB作为PDB插入来创建PDB。</p>
                        <p>本节包含以下主题：</p>
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-E199F91F-6FC8-422B-AC28-FBFB141CD6F6">通过插入未插入的PDB来创建PDB</a><br><span class="bold">未插入的PDB</span>是一组自包含的数据文件，以及指定PDB文件位置的XML元数据文件。要插入未插入的PDB，请使用带有<code class="codeph">USING</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句。
                           </li>
                           <li class="ulchildlink"><a href="introduction-to-the-multitenant-architecture.html#GUID-D67CAB03-AB86-4761-BCF3-F91CA648B315">从非CDB创建PDB</a><br>您可以将非CDB移动到PDB中。</li>
                        </ul>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-92AF2E16-5215-4DB4-977E-BB08E6A65546" title="CREATE PLUGGABLE DATABASE SQL语句创建一个PDB。">创建PDB</a></p>
                           </div>
                        </div>
                     </div>
                     <a id="CNCPT89342"></a><div class="props_rev_3"><a id="GUID-E199F91F-6FC8-422B-AC28-FBFB141CD6F6" name="GUID-E199F91F-6FC8-422B-AC28-FBFB141CD6F6"></a><h6 id="MULTI-GUID-E199F91F-6FC8-422B-AC28-FBFB141CD6F6" class="sect6"><span class="enumeration_section">1.3.2.2.1</span>通过插入未插入的PDB创建PDB</h6>
                        <div>
                           <p><span class="bold">未插入的PDB</span>是一组自包含的数据文件，以及指定PDB文件位置的XML元数据文件。要插入未插入的PDB，请使用带有<code class="codeph">USING</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句。
                           </p>
                           <p>插入未插入的PDB时，您有以下选择：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>指定描述PDB的XML元数据文件以及与PDB关联的文件。</p>
                              </li>
                              <li>
                                 <p>指定<a href="glossary.html#GUID-EE60F679-BD3D-47C1-84A1-AF5E4279D52C"><span class="xrefglossterm">PDB存档文件</span></a> ，该文件是包含XML文件和PDB数据文件的压缩文件。您可以通过指定存档文件来创建PDB，从而避免单独复制XML文件和数据文件。
                                 </p>
                              </li>
                           </ul>
                           <p>下图说明了使用XML文件插入未插入的PDB。</p>
                           <div class="figure" id="GUID-E199F91F-6FC8-422B-AC28-FBFB141CD6F6__GUID-4BD2515A-968A-4FFF-B4FC-99E72363A076">
                              <p class="titleinfigure">图1-9插入未插入的PDB</p><img src="img/admin090.png" alt="下面是图1-9的描述" title="下面是图1-9的描述" longdesc="img_text/admin090.html"><br><a href="img_text/admin090.html">“图1-9插入未插入的PDB”的描述</a></div>
                           <!-- class="figure" -->
                           <div class="example" id="GUID-E199F91F-6FC8-422B-AC28-FBFB141CD6F6__GUID-22B62F31-F0CB-4ED5-858E-28495F4F2D7B">
                              <p class="titleinexample">例1-6插入PDB</p>
                              <p>以下SQL语句根据存储在指定XML文件中的元数据插入名为<code class="codeph">salespdb</code>的PDB，并指定<code class="codeph">NOCOPY</code>因为不需要将未插入的PDB的文件移动到新位置：</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE salespdb使用'/disk1/usr/salespdb.xml'NOCOPY;</code></pre></div>
                           <!-- class="example" -->
                        </div>
                        <div>
                           <div class="infoboxnotealso" id="GUID-E199F91F-6FC8-422B-AC28-FBFB141CD6F6__GUID-BDFC7025-9A2D-4094-B27B-F76E405A4157">
                              <p class="notep1">也可以看看：</p>
                              <p><span class="q">“ <a href="plugging-in-a-pdb.html#GUID-3132C4E5-8734-458B-8B0C-EFC77A45FFA3" title="您可以通过将未插入的PDB插入CDB来创建PDB。">插入一个不插电的PDB</a> ”</span></p>
                           </div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-2D57C40D-5CB1-41B0-9A08-F58D5B7C533D" title="您可以通过插入未插入的PDB或将非CDB作为PDB插入来创建PDB。">通过插入创建PDB</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="CNCPT89343"></a><div class="props_rev_3"><a id="GUID-D67CAB03-AB86-4761-BCF3-F91CA648B315" name="GUID-D67CAB03-AB86-4761-BCF3-F91CA648B315"></a><h6 id="MULTI-GUID-D67CAB03-AB86-4761-BCF3-F91CA648B315" class="sect6"><span class="enumeration_section">1.3.2.2.2</span>从非CDB创建PDB</h6>
                        <div>
                           <p>您可以将非CDB移动到PDB中。</p>
                           <p>您可以通过以下方式完成此任务：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>在<span>Oracle Database 12c中</span>的非CDB上执行<code class="codeph">DBMS_PDB.DESCRIBE</code></p>
                                 <p>将非CDB置于事务一致状态，然后运行<code class="codeph">DBMS_PDB.DESCRIBE</code>函数以生成有关此数据库的XML元数据。连接到CDB中的根时，执行<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句以从现有的非CDB创建PDB。最后，要将PDB数据字典中的定义转换为<code class="codeph">CDB$ROOT</code>对象的引用，请登录PDB并运行<code class="codeph">noncdb_to_pdb.sql</code>脚本。
                                 </p>
                              </li>
                              <li>
                                 <p>使用带有或不带可传输表空间的Oracle Data Pump</p>
                                 <p>您可以使用Oracle Data Pump在非CDB上定义数据集。此非CDB可以位于当前或以前的Oracle数据库版本中，例如Oracle Database 10g。您在现有CDB中创建一个空PDB，然后使用Oracle Data Pump将数据集导入PDB。</p>
                                 <p>使用Oracle Data Pump的完全可传输导出会导出创建数据库完整副本所需的所有对象和数据。Oracle Data Pump使用直接路径卸载和外部表导出对象，然后使用直接路径<code class="codeph">INSERT</code>和外部表导入对象。完全可传输转储文件包含数据库中的所有对象，而不仅仅是与表相关的对象。从Oracle Database 11g第2版（11.2.0.3）开始提供完全可传输导出，以便导入<span>Oracle Database 12c</span>及更高版本。
                                 </p>
                              </li>
                              <li>
                                 <p>使用Oracle GoldenGate复制</p>
                                 <p>您将数据从非CDB复制到PDB。当PDB与非CDB成为当前状态时，切换到PDB。</p>
                              </li>
                           </ul>
                           <p>下图说明了在非CDB上运行<code class="codeph">DBMS_PDB.DESCRIBE</code>函数，然后使用非CDB文件创建PDB。
                           </p>
                           <div class="figure" id="GUID-D67CAB03-AB86-4761-BCF3-F91CA648B315__GUID-A2DA1720-6816-4F1E-96D5-1A8CA48885E9">
                              <p class="titleinfigure">图1-10从非CDB创建PDB</p><img src="img/admin098.png" alt="下面是图1-10的描述" title="下面是图1-10的描述" longdesc="img_text/admin098.html"><br><a href="img_text/admin098.html">“图1-10从非CDB创建PDB”的描述</a></div>
                           <!-- class="figure" -->
                        </div>
                        <div>
                           <div class="infoboxnotealso" id="GUID-D67CAB03-AB86-4761-BCF3-F91CA648B315__GUID-4B1D3863-F37E-4863-A3D2-30BF81E9705A">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="overview-of-pdb-creation.html#GUID-F68E6FE9-919B-4665-95F7-785E69E07264" title="您有多个选项可以将非CDB移动到PDB中。">从非CDB创建PDB的选项</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p>有关Oracle GoldenGate的信息，请参见<a href="../cncpt/topics-for-database-administrators-and-developers.html#CNCPT-GUID-8DC5DC69-0749-4027-9DFE-3390A20CACD2" target="_blank"><span><cite>Oracle数据库概念</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-2D57C40D-5CB1-41B0-9A08-F58D5B7C533D" title="您可以通过插入未插入的PDB或将非CDB作为PDB插入来创建PDB。">通过插入创建PDB</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-D84C3A7F-A1B3-4651-B99B-9F76E7331F83" name="GUID-D84C3A7F-A1B3-4651-B99B-9F76E7331F83"></a><h5 id="MULTI-GUID-D84C3A7F-A1B3-4651-B99B-9F76E7331F83" class="sect5"><span class="enumeration_section">1.3.2.3</span>通过重新安置创建PDB</h5>
                     <div>
                        <p>要将PDB从一个CDB重新定位到另一个CDB，请使用<code class="codeph">CREATE PLUGGABLE DATABASE ...RELOCATE</code>语句或DBCA。</p>
                        <p>该技术具有以下优点：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>重定位发生的停机时间最短。</p>
                           </li>
                           <li>
                              <p>该技术使PDB在重定位期间以读/写模式重新定位，然后将PDB联机到其新位置。</p>
                              <p></p>
                           </li>
                        </ul>
                        <p>您必须在目标CDB上创建数据库链接，该CDB将包含重定位的PDB。此外，源PDB必须使用本地撤消数据。</p>
                        <p>下图描绘了PDB重定位。</p>
                        <div class="figure" id="GUID-D84C3A7F-A1B3-4651-B99B-9F76E7331F83__GUID-A7094F3F-9F02-4093-A0FE-64132E822194">
                           <p class="titleinfigure">图1-11重新定位PDB</p><img src="img/admin109.png" alt="下面是图1-11的描述" title="下面是图1-11的描述" longdesc="img_text/admin109.html"><br><a href="img_text/admin109.html">“图1-11重新定位PDB”的描述</a></div>
                        <!-- class="figure" -->
                        <p>从<span>Oracle Database 19c开始</span> ，您可以使用DBCA以静默方式重定位远程PDB。
                        </p>
                        <div class="example" id="GUID-D84C3A7F-A1B3-4651-B99B-9F76E7331F83__GUID-89B50393-872F-4298-846A-E2DAE4421B07">
                           <p class="titleinexample">例1-7 PDB重定位</p>
                           <p>以下语句在目标CDB上发布，将<code class="codeph">hrpdb</code>从源CDB重定位到目标CDB：</p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE hrpdb FROM hrpdb @ lnk_to_source RELOCATE;</code></pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-D84C3A7F-A1B3-4651-B99B-9F76E7331F83__GUID-7367C498-52DB-4786-A29F-38F76DB7FC82">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="overview-of-the-multitenant-architecture.html#GUID-5902ABDC-40BE-4CF4-9917-A5D7F4C396F1" title="CDB具有与非CDB相同的结构，除了每个PDB和应用程序根都有自己的一组表空间，包括它自己的SYSTEM，SYSAUX和undo表空间。">CDB中的表空间和数据库文件概述</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="relocating-a-pdb.html#GUID-75519361-3DA2-4558-A7E5-64BC16FAFC7D" title="您可以将PDB移动到其他CDB或应用程序容器。">重新安置PDB</a> ”</span></p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-92AF2E16-5215-4DB4-977E-BB08E6A65546" title="CREATE PLUGGABLE DATABASE SQL语句创建一个PDB。">创建PDB</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-53820A0C-E88A-40C0-AAE0-01A6371A146B" name="GUID-53820A0C-E88A-40C0-AAE0-01A6371A146B"></a><h5 id="MULTI-GUID-53820A0C-E88A-40C0-AAE0-01A6371A146B" class="sect5"><span class="enumeration_section">1.3.2.4</span>创建PDB作为代理PDB</h5>
                     <div>
                        <p><strong class="term">代理PDB</strong>提供对远程CDB中不同PDB的访问，称为<strong class="term">引用的PDB</strong> 。</p>
                        <p>代理PDB使您可以聚合来自多个源的数据。提交在代理PDB中执行的SQL语句在引用的PDB中执行。</p>
                        <p>典型的用例是引用应用程序根副本的代理PDB。如果多个CDB具有相同的应用程序定义（例如，相同的表和PL / SQL包），则可以在主应用程序根的应用程序容器中创建代理PDB。代理PDB的引用PDB是不同CDB中的应用程序根。通过在主根目录中运行安装脚本，其他CDB中的应用程序根目录将成为主应用程序根目录的副本。</p>
                        <p>要创建代理PDB，请使用带有<code class="codeph">FROM</code>子句的<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句，该子句必须指定远程CDB中引用的PDB的数据库链接以及<code class="codeph">AS PROXY</code>子句。
                        </p>
                        <div class="infoboxnote" id="GUID-53820A0C-E88A-40C0-AAE0-01A6371A146B__GUID-F680C28D-30C2-4015-A1DC-5D6927A71EB5">
                           <p class="notep1">注意：</p>
                           <p>如果将代理PDB直接插入<code class="codeph">CDB$ROOT</code> ，则必须在<code class="codeph">CDB$ROOT</code>创建代理。应用程序PDB的代理必须都插入应用程序根目录。
                           </p>
                        </div>
                        <div class="p">下图显示了创建引用远程CDB中的PDB的代理PDB。<div class="figure" id="GUID-53820A0C-E88A-40C0-AAE0-01A6371A146B__GUID-172643BD-6FC8-408C-B206-8B9B89FB78C9">
                              <p class="titleinfigure">图1-12创建代理PDB</p><img src="img/admin110.png" alt="下面是图1-12的描述" title="下面是图1-12的描述" longdesc="img_text/admin110.html"><br><a href="img_text/admin110.html">“图1-12创建代理PDB”的描述</a></div>
                           <!-- class="figure" -->
                        </div>
                        <div class="example" id="GUID-53820A0C-E88A-40C0-AAE0-01A6371A146B__GUID-2A9849D2-F3BF-4AE6-82FF-91EE5F9CD645">
                           <p class="titleinexample">例1-8创建代理PDB</p>
                           <p>此示例创建名为<code class="codeph">pdb1</code>的代理PDB。引用的PDB使用数据库链接指定。
                           </p><pre class="pre codeblock"><code>从pdb1 @ pdb1_link创建可插入数据库pdb1 AS PROXY;</code></pre><div class="infoboxnote" id="GUID-53820A0C-E88A-40C0-AAE0-01A6371A146B__GUID-18E89D35-78D4-40F1-A632-F3299F52DA94">
                              <p class="notep1">注意：</p>
                              <p><span class="q">“ <a href="creating-a-proxy-pdb.html#GUID-7C23D560-5AD5-4AF2-93B4-F4FDC6DE768C" title="您可以通过在远程CDB中引用PDB来创建PDB作为代理PDB。">将PDB创建为代理PDB</a> ”</span></p>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-92AF2E16-5215-4DB4-977E-BB08E6A65546" title="CREATE PLUGGABLE DATABASE SQL语句创建一个PDB。">创建PDB</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="CNCPT89344"></a><a id="CNCPT89247"></a><div class="props_rev_3"><a id="GUID-345CDAD9-3D12-475F-82EC-FED2790F504A" name="GUID-345CDAD9-3D12-475F-82EC-FED2790F504A"></a><h3 id="MULTI-GUID-345CDAD9-3D12-475F-82EC-FED2790F504A" class="sect3"><span class="enumeration_section">1.4</span>多租户环境文档路线图</h3>
               <div>
                  <p>本主题列出了理解和使用CDB的最重要主题，并包括对相应文档的交叉引用。</p>
                  <div class="tblformal" id="GUID-345CDAD9-3D12-475F-82EC-FED2790F504A__ROADMAPFORTHEMULTITENANTARCHITECTUR-1BF8D2EF">
                     <p class="titleintable">表1-2多租户架构文档的路线图</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="多租户架构文档的路线图" width="100%" border="1" summary="This table lists a road map for Pluggable Databases documentation" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d5997e3588">类别</th>
                              <th align="left" valign="bottom" width="20%" id="d5997e3591">话题</th>
                              <th align="left" valign="bottom" width="20%" id="d5997e3594">文档</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3599" headers="d5997e3588 ">
                                 <p>概念</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3599 d5997e3591 ">
                                 <p>CDB和PDB概述</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3599 d5997e3594 ">
                                 <p><span class="q">“ <a href="overview-of-the-multitenant-architecture.html#GUID-7F629DD8-D4DE-4FD7-9C35-38AC016DDCDC" title="本章介绍了多租户架构中最重要的组件。">多租户架构概述</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3614" headers="d5997e3588 ">
                                 <p>管理</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3614 d5997e3591 ">
                                 <p>创建和配置CDB</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3614 d5997e3594 ">
                                 <p><span class="q">“ <a href="creating-and-configuring-a-cdb.html#GUID-77D4BBA7-2A64-46D9-A2B8-C56060772215" title="创建和配置多租户容器数据库（CDB）包括计划，创建CDB和可选配置EM Express等任务。">创建和配置CDB</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3629" headers="d5997e3588 ">
                                 <p>管理</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3629 d5997e3591 ">
                                 <p>管理CDB</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3629 d5997e3594 ">
                                 <p><span class="q">“ <a href="administering-a-cdb-with-sql-plus.html#GUID-2E5025EE-BED3-45A4-9EAA-B05C8DA66F97" title="管理多租户容器数据库（CDB）包括访问容器，修改CDB，执行DDL语句以及运行Oracle提供的SQL脚本等任务。">管理CDB</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3644" headers="d5997e3588 ">
                                 <p>管理</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3644 d5997e3591 ">
                                 <p>创建和配置PDB</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3644 d5997e3594 ">
                                 <p><span class="q">“ <a href="creating-pdbs.html#GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413" title="您可以使用各种技术创建PDB，应用程序容器和应用程序种子。">创建和删除PDB和应用程序容器</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3659" headers="d5997e3588 ">
                                 <p>管理</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3659 d5997e3591 ">
                                 <p>管理PDB</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3659 d5997e3594 ">
                                 <p><span class="q">“ <a href="administering-pdbs-with-sql-plus.html#GUID-702231AB-ABDA-42F4-918C-4539BF8135D6" title="管理PDB包括诸如连接到PDB，修改PDB以及管理与PDB相关联的服务之类的任务。">管理PDB</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3674" headers="d5997e3588 ">
                                 <p>管理</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3674 d5997e3591 ">
                                 <p>创建和删除应用程序容器</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3674 d5997e3594 ">
                                 <p><span class="q">“ <a href="creating-removing-application-containers-seeds-with-sql-plus.html#GUID-065649AC-18ED-4858-ACC5-36F011362A83" title="您可以通过多种不同方式创建应用程序容器，包括使用PDB种子，克隆现有PDB或非CDB，以及插入未插入的PDB。您还可以从CDB中删除应用程序容器。">创建和删除应用程序容器</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3689" headers="d5997e3588 ">
                                 <p>管理</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3689 d5997e3591 ">
                                 <p>管理应用程序容器</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3689 d5997e3594 ">
                                 <p><span class="q">“ <a href="administering-application-containers-with-sql-plus.html#GUID-1AFD0268-6A2B-4F84-BB4D-4D36976DE53B" title="您可以管理应用程序容器，包括应用程序根和应用程序PDB。您还可以管理应用程序容器中安装的应用程序。">管理应用程序容器</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3704" headers="d5997e3588 ">
                                 <p>性能</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3704 d5997e3591 ">
                                 <p>PDB故障排除</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3704 d5997e3594 ">
                                 <p><a href="../tgdba/gathering-database-statistics.html#GUID-D64AEB01-18FF-47EF-BB5C-A0611117D180" target="_blank"><span><cite>Oracle数据库性能调整指南</cite></span></a></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3718" headers="d5997e3588 ">
                                 <p>监控</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3718 d5997e3591 ">
                                 <p>查看有关CDB和PDB的信息</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3718 d5997e3594 ">
                                 <p><span class="q">“ <a href="viewing-information-about-cdbs-and-pdbs-with-sql-plus.html#GUID-208C0C35-D105-443B-B788-381F090B1D11" title="您可以使用SQL * Plus或SQL Developer查看有关CDB和PDB的信息。">监控CDB和PDB</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3733" headers="d5997e3588 ">
                                 <p>备份和恢复</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3733 d5997e3591 ">
                                 <p>在CDB中执行备份和恢复</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3733 d5997e3594 ">
                                 <p><a href="../bradv/backing-up-database.html#BRADV428" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3747" headers="d5997e3588 ">
                                 <p>安全</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3747 d5997e3591 ">
                                 <p>管理CDB中的常见用户，角色和权限</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3747 d5997e3594 ">
                                 <p><a href="../dbseg/managing-security-for-oracle-database-users.html#DBSEG573" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d5997e3762" headers="d5997e3588 ">
                                 <p>杂</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3762 d5997e3591 ">
                                 <p>与管理CDB或PDB相关的所有其他任务，包括Oracle RAC，资源管理，数据传输等</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d5997e3762 d5997e3594 ">
                                 <p>本指南是用于管理CDB的主要面向任务的中间和高级文档。本指南还包含参见涵盖不同CDB主题的书籍的链接。例如， <a href="../sutil/oracle-data-pump-overview.html#SUTIL4334" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a>解释了使用Oracle Data Pump时特定于PDB的概念和任务。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="introduction-to-the-multitenant-architecture.html#GUID-267F7D12-D33F-4AC9-AA45-E9CD671B6F22" title="熟悉Oracle Multitenant选项。">多租户架构简介</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>