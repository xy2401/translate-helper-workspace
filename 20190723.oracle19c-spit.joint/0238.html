<html id="09641.managing-oracle-data-guard-physical-standby-databases.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This chapter discusses the various ways that physical and snapshot standby databases need to be managed."></meta>
      <meta name="description" content="This chapter discusses the various ways that physical and snapshot standby databases need to be managed."></meta>
      <title>管理物理和快照备用数据库</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Concepts and Administration "></meta>
      <meta property="og:description" content="This chapter discusses the various ways that physical and snapshot standby databases need to be managed."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Concepts and Administration"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-guard-concepts-and-administration.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T10:50:21-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96244-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="managing-oracle-data-guard-role-transitions.html" title="Previous" type="text/html"></link>
      <link rel="next" href="managing-oracle-data-guard-logical-standby-databases.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Guard Concepts and Administration"></meta>
    <meta name="dcterms.isVersionOf" content="SBYDB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="managing-oracle-data-guard-role-transitions.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="managing-oracle-data-guard-logical-standby-databases.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">概念和管理</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-data-guard-concepts.html" property="item" typeof="WebPage"><span property="name">概念和管理</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">管理物理和快照备用数据库</li>
            </ol>
            <a id="GUID-B140C38B-DE01-4252-8422-7154018DDFEC" name="GUID-B140C38B-DE01-4252-8422-7154018DDFEC"></a><a id="SBYDB00700"></a>
            
            <h2 id="SBYDB-GUID-B140C38B-DE01-4252-8422-7154018DDFEC" class="sect2"><span class="enumeration_chapter">10</span>管理物理和快照备用数据库</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章讨论了需要管理物理和快照备用数据库的各种方法。</p>
               <p>请参阅以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-D7026A24-78EF-4C0D-84E5-41D767516565" title="本节介绍如何启动和关闭物理备用数据库。">启动和关闭物理备用数据库</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-D5FB88EC-799D-40E7-80E1-19474E3167E4" title="可以打开物理备用数据库以进行只读访问，并用于从主数据库卸载查询。">打开物理备用数据库</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-62007456-DD41-431D-B0E7-56C99FEB2277" title="对主数据库进行的大多数结构更改都会自动通过重做数据传播到物理备用数据库，但是有一些更改需要手动干预。">在物理待机中需要手动干预的主要数据库更改</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-02218512-31A6-461E-96B4-0B9997DCFC4A" title="在使用RESETLOGS选项打开主数据库之后，Oracle Data Guard允许在物理备用数据库上进行恢复。">通过OPEN RESETLOGS声明恢复</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-0682EE24-B495-48E8-9E1F-52AC0E6FE486" title="此表汇总了常见的主数据库管理操作以及在何处查找与这些操作相关的信息。">监控主要，物理备用和快照备用数据库</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-45D7D60E-ED0F-4B3E-9D32-EB5394196CAF" title="在主数据库上创建的还原点会自动复制到备用数据库。在备用数据库上创建的还原点称为复制还原点。无论主数据库上的还原点是保证还原点还是正常还原点，相应的复制还原点始终是正常还原点。">将还原点从主节点复制到备用节点</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-EEDAC95A-828F-4117-AF57-D8ABA702D42D" title="Oracle白皮书可用于描述如何优化Redo Apply和介质恢复性能。">调整重做应用</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-2FF52A94-828C-4BF1-A5D0-C70A05A8198A" title="在Active Data Guard环境中，SQL Tuning Advisor可以调整主数据库上的备用工作负载。">使用SQL Tuning Advisor在Active Data Guard环境中调整数据库</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-1E2A26E3-B0E2-4ED1-A50D-891505C86E7D" title="Oracle Diagnostic Pack可与以只读模式打开的Oracle Active Data Guard备用数据库一起使用。">使用Oracle Diagnostic Pack调整Oracle Active Data Guard Standbys</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-CE30E2D6-5B53-4389-8B02-FC0F341C8C1A" title="快照备用数据库是完全可更新的备用数据库。它从主数据库接收和归档重做数据，但不应用它。">管理快照备用数据库</a></p>
                  </li>
               </ul>
               <p>请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=DGBKR001" target="_blank"><span class="italic">Oracle Data Guard Broker</span></a>以了解Oracle Data Guard代理如何简化物理和快照备用数据库的管理。
               </p>
            </div><a id="SBYDB00705"></a><div class="props_rev_3"><a id="GUID-D7026A24-78EF-4C0D-84E5-41D767516565" name="GUID-D7026A24-78EF-4C0D-84E5-41D767516565"></a><h3 id="SBYDB-GUID-D7026A24-78EF-4C0D-84E5-41D767516565" class="sect3"><span class="enumeration_section">10.1</span>启动和关闭物理备用数据库</h3>
               <div>
                  <p>本节介绍如何启动和关闭物理备用数据库。</p>
                  <p></p>
               </div><a id="SBYDB4776"></a><div class="props_rev_3"><a id="GUID-76930886-6460-45AE-86CA-84DCB41E5BE5" name="GUID-76930886-6460-45AE-86CA-84DCB41E5BE5"></a><h4 id="SBYDB-GUID-76930886-6460-45AE-86CA-84DCB41E5BE5" class="sect4"><span class="enumeration_section">10.1.1</span>启动物理备用数据库</h4>
                  <div>
                     <p>使用SQL * Plus <code class="codeph">STARTUP</code>命令启动物理备用数据库。
                     </p>
                     <div class="section">
                        <p>在没有任何参数的情况下调用时，SQL * Plus <code class="codeph">STARTUP</code>命令以只读模式启动，装入和打开物理备用数据库。
                        </p>
                        <p>安装或打开后，物理备用数据库可以从主数据库接收重做数据。</p>
                        <p>有关重做应用和<a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-D5FB88EC-799D-40E7-80E1-19474E3167E4" title="A physical standby database can be opened for read-only access and used to offload queries from a primary database.">打开物理备用数据库</a>的信息，请参阅<a href="oracle-data-guard-redo-apply-services.html#GUID-2B839172-947E-48A4-9FFD-33CC6907809F" title="执行重做应用时，物理备用数据库可以使用实时应用功能直接从备用重做日志文件应用重做，因为它们是由远程文件服务器（RFS）进程写入的。">将重做数据应用于物理备用数据库，</a>以获取有关以只读模式<a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-D5FB88EC-799D-40E7-80E1-19474E3167E4" title="可以打开物理备用数据库以进行只读访问，并用于从主数据库卸载查询。">打开物理备用数据库</a>的信息。
                        </p>
                        <div class="infoboxnote" id="GUID-76930886-6460-45AE-86CA-84DCB41E5BE5__GUID-E95C72E7-083B-4FA4-8FE5-E6C437931071">
                           <p class="notep1">注意：</p>
                           <p>在尚未从主数据库接收重做数据的物理备用数据库上启动重做应用时，可能会返回<code class="codeph">ORA-01112</code>消息。这表示重做应用无法确定介质恢复的起始序列号。如果发生这种情况，请从主数据库中手动检索存档的重做日志文件并将其注册到备用数据库，或者在启动重做应用之前等待重做传输开始。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4777"></a><div class="props_rev_3"><a id="GUID-B51873F4-F50C-4757-9DF9-D43635BFAD7F" name="GUID-B51873F4-F50C-4757-9DF9-D43635BFAD7F"></a><h4 id="SBYDB-GUID-B51873F4-F50C-4757-9DF9-D43635BFAD7F" class="sect4"><span class="enumeration_section">10.1.2</span>关闭物理备用数据库</h4>
                  <div>
                     <p>使用SQL * Plus <code class="codeph">SHUTDOWN</code>命令停止Redo Apply并关闭物理备用数据库。
                     </p>
                     <div class="section">
                        <p>在关闭完成之前，控制不会返回到启动数据库关闭的会话。</p>
                        <p>如果主数据库已启动并正在运行，请在关闭物理备用数据库之前，将主数据库上的备用目标推迟并执行日志切换。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="SBYDB00706"></a><div class="props_rev_3"><a id="GUID-D5FB88EC-799D-40E7-80E1-19474E3167E4" name="GUID-D5FB88EC-799D-40E7-80E1-19474E3167E4"></a><h3 id="SBYDB-GUID-D5FB88EC-799D-40E7-80E1-19474E3167E4" class="sect3"><span class="enumeration_section">10.2</span>打开物理备用数据库</h3>
               <div>
                  <p>可以打开物理备用数据库以进行只读访问，并用于从主数据库卸载查询。</p>
                  <div class="infoboxnote" id="GUID-D5FB88EC-799D-40E7-80E1-19474E3167E4__GUID-E5C2C62C-70A8-4E75-A692-8E904A25EB63">
                     <p class="notep1">注意：</p>
                     <p>以只读模式打开的物理备用数据库受限于与以只读模式打开的任何其他Oracle数据库相同的限制。有关更多信息，请参见“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ADMIN11154" target="_blank"><span class="italic">Oracle数据库管理员指南”</span></a> 。
                     </p>
                  </div>
                  <p>如果是Oracle Active Data Guard的许可证<a id="d21041e550" class="indexterm-anchor"></a>已购买选项，在物理备用数据库打开时，Redo Apply可以处于活动状态，从而允许查询返回与从主数据库返回的结果相同的结果。此功能称为实时查询<a id="d21041e555" class="indexterm-anchor"></a>特征。 <a id="d21041e558" class="indexterm-anchor"></a> 有关更多详细信息，请参阅<a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-07CB190C-C248-4FF5-AB64-EAA9C6D42677" title="必须将COMPATIBLE数据库初始化参数设置为11.0或更高才能使用Oracle Active Data Guard选项的实时查询功能。">实时查询</a> 。
                  </p>
                  <p>如果尚未购买Oracle Active Data Guard选项的许可证，则在重做应用处于活动状态时无法打开物理备用数据库，因此在打开物理备用数据库实例或启动重做应用时必须遵循以下规则：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>必须在打开任何物理备用数据库实例之前停止重做应用。</p>
                     </li>
                     <li>
                        <p>如果打开了一个或多个物理备用实例，则必须在启动重做应用之前在挂载状态下停止或重新启动这些实例。</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-D5FB88EC-799D-40E7-80E1-19474E3167E4__GUID-9E51DA30-348A-4DF3-ACB6-03447C2541ED">
                     <p class="notep1">也可以看看：</p>
                     <p></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关Oracle Active Data Guard的更多信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=DBLIC-GUID-AB56CEE3-955E-4E56-8B44-6075E889C283" target="_blank"><span class="italic">Oracle数据库许可信息</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="SBYDB5039"></a><a id="SBYDB00707"></a><div class="props_rev_3"><a id="GUID-07CB190C-C248-4FF5-AB64-EAA9C6D42677" name="GUID-07CB190C-C248-4FF5-AB64-EAA9C6D42677"></a><h4 id="SBYDB-GUID-07CB190C-C248-4FF5-AB64-EAA9C6D42677" class="sect4"><span class="enumeration_section">10.2.1</span>实时查询</h4>
                  <div>
                     <p>必须将<code class="codeph">COMPATIBLE</code>数据库初始化参数设置为11.0或更高才能使用Oracle Active Data Guard选项的实时查询功能。
                     </p>
                     <div class="section">
                        <p>如果Redo Apply在该数据库的已装载实例上处于活动状态，则无法打开物理备用数据库实例。使用以下SQL语句停止重做应用，以只读方式打开备用实例，然后重新启动重做应用：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL; SQL&gt; ALTER DATABASE OPEN; SQL&gt; ALTER DATABASE RECOVER MANAGED STANDBY DATABASE DISCONNECT;</pre><div class="infoboxnote" id="GUID-07CB190C-C248-4FF5-AB64-EAA9C6D42677__GUID-D6192E36-A702-488C-9501-E869F2DEEA6E">
                           <p class="notep1">注意：</p>
                           <p>如果重做应用在打开的实例上处于活动状态，则可以打开其他实例而无需停止重做应用。</p>
                        </div>
                        <p>如果已打开该数据库的任何实例，则无法在已装入的物理备用实例上启动重做应用。必须先打开实例，然后再启动Redo Apply。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-07CB190C-C248-4FF5-AB64-EAA9C6D42677__GUID-D2019BDB-8414-471D-88BB-506786F06C6D">示例：查询V $ DATABASE以检查待机的打开模式</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>此示例显示在实时查询模式下打开物理备用<code class="codeph">V$DATABASE.OPEN_MODE</code>时<code class="codeph">V$DATABASE.OPEN_MODE</code>列的值如何更改。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>启动并打开物理备用实例，并执行以下SQL查询以显示数据库以只读模式打开：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT open_mode FROM V $ DATABASE; OPEN_MODE --------------------只读</pre></div>
                        </li>
                        <li class="stepexpand"><span>发出以下SQL语句以启动Redo Apply：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE RECOVER MANAGED STANDBY DATABASE DISCONNECT;数据库改变了
</pre></div>
                        </li>
                        <li class="stepexpand"><span>既然备用数据库处于实时查询模式（备用数据库以只读模式打开并且重做应用处于活动状态），则<code class="codeph">V$DATABASE.OPEN_MODE</code>列将更改为指示以下内容：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT open_mode FROM V $ DATABASE; OPEN_MODE --------------------只读应用</pre></div>
                        </li>
                     </ol>
                  </div><a id="SBYDB4778"></a><div class="props_rev_3"><a id="GUID-C225DCBC-E9FB-4E86-9D19-A5D20C3A8AA5" name="GUID-C225DCBC-E9FB-4E86-9D19-A5D20C3A8AA5"></a><h5 id="SBYDB-GUID-C225DCBC-E9FB-4E86-9D19-A5D20C3A8AA5" class="sect5"><span class="enumeration_section">10.2.1.1</span>在实时查询环境中监控应用延迟</h5>
                     <div>
                        <p>如果使用实时查询将查询从主数据库卸载到物理备用数据库，则可以监视应用延迟以确保它在可接受的限制范围内。</p>
                        <div class="section">
                           <p>当前应用延迟是在最后一次应用的更改在备用数据库上变为可见时以及在主数据库上首次显示相同更改之间的经过时间之间的差异。此度量标准计算为最接近的秒。</p>
                           <p>要获取应用延迟，请查询<code class="codeph">V$DATAGUARD_STATS</code>视图。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT name，value，datum_time，time_computed FROM V $ DATAGUARD_STATS  - &gt; WHERE名称如'apply lag'; NAME VALUE DATUM_TIME TIME_COMPUTED --------- ------------- ------------------- ----- -------------- apply lag +00 00:00:00 05/27/2009 08:54:16 05/27/2009 08:54:17</pre><p><code class="codeph">apply</code> <code class="codeph">lag</code>度量使用从主数据库定期接收的数据计算。<code class="codeph">DATUM_TIME</code>列包含备用数据库上次接收此数据的时间戳。<code class="codeph">TIME_COMPUTED</code>列包含计算<code class="codeph">apply</code> <code class="codeph">lag</code>指标时的时间戳。这些列中的值之间的差异应小于30秒。如果差异大于此值，则<code class="codeph">apply</code> <code class="codeph">lag</code>度量可能不准确。
                           </p>
                           <p>要获取显示自上次启动备用实例以来应用延迟值历史记录的直方图，请查询<code class="codeph">V$STANDBY_EVENT_HISTOGRAM</code>视图。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM V $ STANDBY_EVENT_HISTOGRAM WHERE NAME ='apply lag' - &gt; AND COUNT&gt; 0;名称时间单位COUNT LAST_TIME_UPDATED --------- --------- -------- ----------- -------- ---------------- apply lag 0秒79681 06/18/2009 10:05:00 apply lag 1秒1006 06/18/2009 10:03:56 apply lag 2秒96 06/18/2009 09:51:06应用延迟3秒4 06/18/2009 04:12:32应用延迟4秒1 06/17/2009 11:43:51应用延迟5秒1 06/17 / 2009 11:43:52选择了6行</pre><p>要评估一段时间内的应用延迟，请在该时间段开始时拍摄<code class="codeph">V$STANDBY_EVENT_HISTOGRAM</code>的快照，并将该快照与该时间段结束时拍摄的快照进行比较。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="SBYDB4779"></a><div class="props_rev_3"><a id="GUID-622B6596-54F7-4736-8A8B-0C5E308AC3F5" name="GUID-622B6596-54F7-4736-8A8B-0C5E308AC3F5"></a><h5 id="SBYDB-GUID-622B6596-54F7-4736-8A8B-0C5E308AC3F5" class="sect5"><span class="enumeration_section">10.2.1.2</span>在实时查询环境中配置应用滞后容差</h5>
                     <div>
                        <p><code class="codeph">STANDBY_MAX_DATA_DELAY</code>会话参数可用于为非管理用户向处于实时查询模式的物理备用数据库发出的查询指定特定于会话的应用延迟容差（以秒为单位）。
                        </p>
                        <p>此功能允许将查询从主数据库安全地卸载到物理备用数据库，因为可以检测备用数据库是否已变得无法接受。</p>
                        <p>如果<code class="codeph">STANDBY_MAX_DATA_DELAY</code>设置为默认值<code class="codeph">NONE</code> ，则执行发出到物理备用数据库的查询，而不管该数据库的应用延迟如何。
                        </p>
                        <p>如果<code class="codeph">STANDBY_MAX_DATA_DELAY</code>设置为非零值，则仅当应用延迟小于或等于<code class="codeph">STANDBY_MAX_DATA_DELAY</code>才会执行发送到物理备用数据库的查询。否则，将返回<code class="codeph">ORA-3172</code>错误以警告客户端应用延迟太大。
                        </p>
                        <p>如果<code class="codeph">STANDBY_MAX_DATA_DELAY</code>设置为0，则发送到物理备用数据库的查询将保证返回与在主数据库上发出查询完全相同的结果，除非备用数据库滞后于主数据库，在这种情况下是<code class="codeph">ORA-3172</code>返回<code class="codeph">ORA-3172</code>错误。
                        </p>
                        <p>使用<code class="codeph">ALTER SESSION</code> SQL语句设置<code class="codeph">STANDBY_MAX_DATA_DELAY</code> 。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER SESSION SET STANDBY_MAX_DATA_DELAY = 2</pre></div>
                  </div><a id="SBYDB4780"></a><div class="props_rev_3"><a id="GUID-194B1448-84FB-4357-A6AD-72A77701F918" name="GUID-194B1448-84FB-4357-A6AD-72A77701F918"></a><h5 id="SBYDB-GUID-194B1448-84FB-4357-A6AD-72A77701F918" class="sect5"><span class="enumeration_section">10.2.1.3</span>在实时查询环境中强制重做应用同步</h5>
                     <div>
                        <p>要确保从主数据库接收的所有重做数据都已应用于物理备用数据库，可以使用SQL <code class="codeph">ALTER SESSION</code>语句。
                        </p>
                        <div class="section">
                           <p>发出以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER SESSION SYNC with PRIMARY;</pre><p>此语句将阻塞，直到发出此命令时备用数据库收到的所有重做数据都已应用于物理备用数据库。如果备用数据库中的重做传输状态不是<code class="codeph">SYNCHRONIZED</code>或重做应用未激活，则会立即返回<code class="codeph">ORA-3173</code>错误，并且不会发生<code class="codeph">SYNCHRONIZED</code> 。
                           </p>
                           <p>要确保在特定情况下发生重做应用同步，请使用<code class="codeph">SYS_CONTEXT('USERENV','DATABASE_ROLE')</code>函数创建仅备用触发器（在主服务器上启用但仅在备用服务器上运行时才执行某些操作） 。例如，您可以创建以下触发器，该触发器将在登录时为特定用户连接执行<code class="codeph">ALTER SESSION SYNC WITH PRIMARY</code>语句：</p><pre class="oac_no_warn" dir="ltr">创建触发器adg_logon_sync_trigger登录后，user.schema开始if（SYS_CONTEXT（'USERENV'，'DATABASE_ROLE'）IN（'PHYSICAL STANDBY'））然后立即执行'alter session sync with primary';万一;结束;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="SBYDB4781"></a><div class="props_rev_3"><a id="GUID-25EF4F01-3DF0-4F21-99B8-95178CA003BE" name="GUID-25EF4F01-3DF0-4F21-99B8-95178CA003BE"></a><h5 id="SBYDB-GUID-25EF4F01-3DF0-4F21-99B8-95178CA003BE" class="sect5"><span class="enumeration_section">10.2.1.4</span>实时查询限制</h5>
                     <div>
                        <p>此列表讨论与实时查询模式相关的限制。</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>上述应用延迟控制和重做应用同步机制要求连接客户端并向处于实时查询模式的物理备用数据库发出查询。</p>
                           </li>
                           <li>
                              <p>如果<code class="codeph">STANDBY_MAX_DATA_DELAY</code>设置为0或者使用<code class="codeph">ALTER SESSION SYNC WITH PRIMARY</code> SQL语句，则以下附加限制适用：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>备用数据库必须通过SYNC传输接收重做数据。</p>
                                 </li>
                                 <li>
                                    <p>备用数据库的重做传输状态必须为SYNCHRONIZED，并且主数据库必须以最大保护模式或最大可用性模式运行。</p>
                                 </li>
                                 <li>
                                    <p>必须启用实时应用。</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Oracle Active Data Guard通过使用缓存融合在Oracle RAC环境中实现了高性能的实时查询。这允许Oracle Data Guard应用实例和查询在缓存之外工作，而不会因磁盘I / O限制而减慢速度。这样做的结果是，应用实例的意外故障会使缓冲区在所有打开的Oracle RAC实例中处于不一致状态。为确保数据一致性和完整性，Oracle Data Guard将关闭Oracle RAC配置中的所有其他打开实例，并将其置于已装入状态。您必须手动重新打开实例 - 此时数据会自动保持一致，然后在其中一个实例上重新启动重做应用。在Oracle Data Guard代理配置中，将自动重新打开实例，并在其中一个实例上自动重新启动重做应用。</p>
                              <div class="infoboxnotealso" id="GUID-25EF4F01-3DF0-4F21-99B8-95178CA003BE__GUID-D6506452-9378-4275-B7D3-F3F93BD6D220">
                                 <p class="notep1">也可以看看：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>有关代理如何处理应用实例故障的更多信息，请参阅<a href="../dgbkr/managing-oracle-data-guard-broker-configuration-members.html#DGBKR260" target="_blank"><span class="italic">Oracle Data Guard Broker</span></a></p>
                                    </li>
                                    <li>
                                       <p>有关在Oracle Active Data Guard Oracle RAC备用数据库中应用实例故障的其他信息，请访问<a href="http://support.oracle.com" target="_blank"><code class="codeph">http://support.oracle.com</code></a>的My Oracle Support说明1357597.1</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                        </ul>
                     </div>
                  </div><a id="SBYDB5255"></a><a id="SBYDB5256"></a><a id="SBYDB5257"></a><a id="SBYDB4782"></a><div class="props_rev_3"><a id="GUID-67B644A3-161B-4A83-A0B2-923BF51AD932" name="GUID-67B644A3-161B-4A83-A0B2-923BF51AD932"></a><h5 id="SBYDB-GUID-67B644A3-161B-4A83-A0B2-923BF51AD932" class="sect5"><span class="enumeration_section">10.2.1.5</span>自动块介质恢复</h5>
                     <div>
                        <p>如果在访问数据库时遇到损坏的数据块，则可以使用这些块的未损坏副本自动替换它们。</p>
                        <p>这需要以下条件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>物理备用数据库必须以实时查询模式运行，这需要Oracle Active Data Guard许可证。</p>
                           </li>
                           <li>
                              <p>物理备用数据库必须运行实时应用。</p>
                           </li>
                        </ul>
                        <p>自动块介质恢复在两个方向上工作，具体取决于在主数据库还是备用数据库上遇到损坏的块。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-67B644A3-161B-4A83-A0B2-923BF51AD932__GUID-7F4A0316-2277-4EAC-943A-960BB5FF84E2">主要损坏的块</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>如果在主数据库中遇到损坏的数据块，则主数据库会自动在备用数据库上搜索这些块的正确副本，如果找到它们，则将它们运回主数据库。</p>
                           <p>主数据库仅需要<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>到备用数据库（物理备用数据库，级联物理备用数据库或远程同步实例）。主数据库不需要<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>到任何终端目的地;它能够自动确定他们的服务名称。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-67B644A3-161B-4A83-A0B2-923BF51AD932__GUID-6EEE6907-6330-46D4-98F4-08A75BD88516">在待机状态下损坏的块</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>如果在备用数据库中遇到损坏的数据块，则备用数据库会自动启动与主数据库的通信，并请求这些数据块的未损坏副本。要使主数据库能够将未损坏的块传送到备用数据库，必须在备用数据库上配置以下数据库初始化参数。即使主服务器不直接为备用服务器提供服务（例如，在级联配置中），也是如此。</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">LOG_ARCHIVE_CONFIG</code>参数配置了<code class="codeph">DG_CONFIG</code>列表，并为主数据库配置了<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>参数。
                                 </p>
                                 <p><span class="bold">要么</span></p>
                              </li>
                              <li>
                                 <p>已配置<code class="codeph">FAL_SERVER</code>参数，其值包含主数据库的Oracle Net服务名称。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-67B644A3-161B-4A83-A0B2-923BF51AD932__GUID-CE4B5D92-2CEF-499F-B348-FEE58E79C148">其他自动块介质修复注意事项</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>任何Oracle Data Guard保护模式都支持自动修复。但是，使用来自备用数据库的块的非损坏版本修复主数据库中的损坏块的有效性取决于备用数据库与主数据库生成的重做同步的程度。</p>
                              </li>
                              <li>
                                 <p>执行自动块修复后，会将消息写入数据库警报日志。</p>
                              </li>
                              <li>
                                 <p>如果无法进行自动块修复，则会返回<code class="codeph">ORA-1578</code>错误。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="SBYDB4783"></a><div class="props_rev_3"><a id="GUID-B2A61261-304D-4C14-AEF3-DA6E1B4368B3" name="GUID-B2A61261-304D-4C14-AEF3-DA6E1B4368B3"></a><h5 id="SBYDB-GUID-B2A61261-304D-4C14-AEF3-DA6E1B4368B3" class="sect5"><span class="enumeration_section">10.2.1.6</span>手动阻止介质恢复</h5>
                     <div>
                        <p>RMAN <code class="codeph">RECOVER BLOCK</code>命令用于手动修复损坏的数据块。
                        </p>
                        <p>此命令在多个位置搜索数据块的未损坏副本。默认情况下，其中一个位置是以实时查询模式运行的任何可用物理备用数据库。RMAN <code class="codeph">RECOVER BLOCK</code>命令的<code class="codeph">EXCLUDE STANDBY</code>选项可用于将物理备用数据库排除为替换块的源。
                        </p>
                        <div class="infoboxnotealso" id="GUID-B2A61261-304D-4C14-AEF3-DA6E1B4368B3__GUID-090667F6-3ABD-4DAE-8931-CF344DD71EDB">
                           <p class="notep1">也可以看看：</p>
                           <p>有关RMAN <code class="codeph">RECOVER BLOCK</code>命令的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=RCMRF140" target="_blank"><span class="italic">参见Oracle数据库备份和恢复参考</span></a></p>
                        </div>
                     </div>
                  </div><a id="SBYDB5463"></a><a id="SBYDB5130"></a><div class="props_rev_3"><a id="GUID-12950D5A-FE9F-4444-A6DE-26FCC5653225" name="GUID-12950D5A-FE9F-4444-A6DE-26FCC5653225"></a><h5 id="SBYDB-GUID-12950D5A-FE9F-4444-A6DE-26FCC5653225" class="sect5"><span class="enumeration_section">10.2.1.7</span>在物理备用数据库<span class="enumeration_section">上调</span>优查询</h5>
                     <div>
                        <p>可以调整物理备用数据库上的查询以获得最佳性能。</p>
                        <p>有关调优查询的详细信息，请参阅Oracle最高可用性体系结构（MAA）主页上提供的<span class="italic">Active Data Guard最佳实践</span>白皮书：</p>
                        <p><a href="http://www.oracle.com/goto/maa" target="_blank"><code class="codeph">http://www.oracle.com/goto/maa</code></a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-12950D5A-FE9F-4444-A6DE-26FCC5653225__GUID-53657E7D-DAAE-4E23-BC98-BC89657BE300">强制完全数据库缓存模式</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>使用强制完全数据库缓存模式可以潜在地提高性能，因为查询执行得更快。</p>
                           <p>启用和禁用强制完全数据库缓存模式<a id="d21041e1549" class="indexterm-anchor"></a><a id="d21041e1553" class="indexterm-anchor"></a>不以重做方式记录，因此内存缓存的状态在Data Guard配置的所有成员上不一定相同。
                           </p>
                           <p>有关Force Full Database In-Memory Caching功能的详细信息，包括有关如何以及何时启用和禁用它的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=TGDBA95384" target="_blank"><span class="italic">指南</span></a> ，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=TGDBA95384" target="_blank"><span class="italic">Oracle Database Performance Tuning Guide</span></a> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="SBYDB5446"></a><div class="props_rev_3"><a id="GUID-40A7D7C1-72B8-4397-B61B-446028102E2D" name="GUID-40A7D7C1-72B8-4397-B61B-446028102E2D"></a><h5 id="SBYDB-GUID-40A7D7C1-72B8-4397-B61B-446028102E2D" class="sect5"><span class="enumeration_section">10.2.1.8</span>将Temp文件添加到物理备用</h5>
                     <div>
                        <p>如果使用备用数据库从主数据库卸载查询，则必须使用至少一个临时数据文件的最小临时表空间配置备用数据库。</p>
                        <div class="section">
                           <p>如果工作负载的性质需要比首次创建备用数据库时自动创建的更多临时表空间，则可能需要手动添加其他空间。</p>
                           <p>要将临时文件添加到物理备用数据库，请执行以下任务：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>标识包含临时文件的表空间。通过在备用数据库上输入以下命令来执行此操作：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT TABLESPACE_NAME FROM DBA_TABLESPACES 2&gt; WHERE CONTENTS ='TEMPORARY'; TABLESPACE_NAME -------------------------------- TEMP1 TEMP2</pre></div>
                           </li>
                           <li class="stepexpand"><span>对于上一个查询中标识的每个表空间，将新的临时文件添加到备用数据库。以下示例添加一个名为<code class="codeph">TEMP1</code>的新临时文件，其大小和重用特性与主数据库临时文件匹配：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER TABLESPACE TEMP1 ADD TEMPFILE 2&gt;'/ arch1 / Boston / temp01.dbf'3&gt; SIZE 40M REUSE;</pre></div>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B1C66720-3EA6-45A3-986E-6E510381EC79" name="GUID-B1C66720-3EA6-45A3-986E-6E510381EC79"></a><h4 id="SBYDB-GUID-B1C66720-3EA6-45A3-986E-6E510381EC79" class="sect4"><span class="enumeration_section">10.2.2</span>在Active Data Guard Standbys上使用SQL和PL / SQL</h4>
                  <p>从Oracle Database Release 19c开始，您可以在Active Data Guard备用数据库中执行SQL和PL / SQL操作。</p>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-8AAD002C-ED06-4349-8BB5-EC8DB30B2628" title="您可以在Active Data Guard备用数据库上运行DML操作。这使您可以在备用数据库上运行读取主要应用程序，这些应用程序偶尔会执行DML。">在Active Data Guard备用数据库上执行DML操作</a></li>
                           <li><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-143121BA-3F4C-4953-B0E7-68BE9EE700C9" title="如果主数据库中不包含绑定变量，则可以将在Active Data Guard备用数据库上运行的PL / SQL块重定向到主数据库并在主数据库上运行。">在Active Data Guard备用数据库上运行顶级PL / SQL操作</a></li>
                           <li><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-21156FB5-6BBF-4D0B-B914-D69DC3C61A2C" title="如果它们无效，则可以重新编译在备用实例上运行的PL / SQL对象。">修改后的PL / SQL对象的自动重新编译</a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-8AAD002C-ED06-4349-8BB5-EC8DB30B2628" name="GUID-8AAD002C-ED06-4349-8BB5-EC8DB30B2628"></a><h5 id="SBYDB-GUID-8AAD002C-ED06-4349-8BB5-EC8DB30B2628" class="sect5"><span class="enumeration_section">10.2.2.1</span>在Active Data Guard备用数据库上执行DML操作</h5>
                     <div>
                        <p>您可以在Active Data Guard备用数据库上运行DML操作。这使您可以在备用数据库上运行读取主要应用程序，这些应用程序偶尔会执行DML。</p>
                        <div class="section">
                           <p></p>
                           <p>备用数据库上的DML操作可以透明地重定向到主数据库并在主数据库上运行。这包括作为PL / SQL块一部分的DML语句。Active Data Guard会话将等待，直到相应的更改发送到Active Data Guard备用数据库并应用于Active Data Guard备用数据库。在DML操作期间保持读取一致性，运行DML的备用数据库可以查看其未提交的更改。但是，所有其他备用数据库实例只能在提交事务后才能查看这些更改。</p>
                           <div class="infoboxnote" id="GUID-8AAD002C-ED06-4349-8BB5-EC8DB30B2628__GUID-D1283418-DE83-43DC-982E-6CF146559B32">
                              <p class="notep1">注意：</p>
                              <p>避免在Active Data Guard备用数据库上运行DML操作。由于操作实际上是在主数据库上执行的，因此过多的DML可能会影响主数据库的性能。</p>
                           </div>
                           <p>可以在系统级别或会话级别配置DML操作到主服务器的自动重定向。会话级别设置将覆盖系统级别设置。</p>
                           <p>要为Active Data Guard环境中的所有备用会话配置DML操作的自动重定向，请执行以下操作：</p>
                           <ul id="GUID-8AAD002C-ED06-4349-8BB5-EC8DB30B2628__UL_A3D_RPG_QFB" style="list-style-type:disc">
                              <li>将<code class="codeph">ADG_REDIRECT_DML</code>初始化参数设置为<code class="codeph">TRUE</code> 。</li>
                           </ul>
                           <p>要为当前会话配置DML操作的自动重定向，请使用以下命令：</p>
                        </div>
                        <!-- class="section" -->
                        <ul id="GUID-8AAD002C-ED06-4349-8BB5-EC8DB30B2628__STEPS-UNORDERED_LLN_HLG_QFB">
                           <li><span><code class="codeph">ALTER SESSION ENABLE ADG_REDIRECT_DML;</code></span></li>
                        </ul>
                        <div class="example" id="GUID-8AAD002C-ED06-4349-8BB5-EC8DB30B2628__GUID-BB2CBC75-84E5-4D7F-A7BF-00BB61BC4CA8">
                           <p class="titleinexample">示例10-1在物理备用数据库上执行DML操作</p>
                           <p>Active Data Guard安装程序中的物理备用数据库包含名为<code class="codeph">employees</code>的表。您可以通过在Active Data Guard环境中的物理备用数据库上运行DML来将行插入此表。
                           </p>
                           <p>在备用数据库上，为当前会话启用DML重定向：</p><pre class="pre codeblock"><code>SQL&gt; ALTER SESSION ENABLE ADG_REDIRECT_DML;</code></pre><p>使用以下命令在<code class="codeph">employees</code>表中添加一行：</p><pre class="pre codeblock"><code>SQL&gt; INSERT INTO员工VALUES（.......）;</code></pre><p>此时，更改的数据仅对运行该命令的备用数据库可见。在主数据库上提交插入操作后，更改将重新发送并应用于所有备用数据库。</p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-143121BA-3F4C-4953-B0E7-68BE9EE700C9" name="GUID-143121BA-3F4C-4953-B0E7-68BE9EE700C9"></a><h5 id="SBYDB-GUID-143121BA-3F4C-4953-B0E7-68BE9EE700C9" class="sect5"><span class="enumeration_section">10.2.2.2</span>在Active Data Guard备用数据库上运行顶级PL / SQL操作</h5>
                     <div>
                        <p>如果主数据库中不包含绑定变量，则可以将在Active Data Guard备用数据库上运行的PL / SQL块重定向到主数据库并在主数据库上运行。</p>
                        <div class="section">
                           <p></p>
                           <p>要将在备用数据库上运行的PL / SQL操作重定向到主数据库，请在备用数据库上使用以下命令配置自动重定向：</p>
                        </div>
                        <!-- class="section" -->
                        <ul id="GUID-143121BA-3F4C-4953-B0E7-68BE9EE700C9__STEPS-UNORDERED_DK5_23G_QFB">
                           <li><span><code class="codeph">ALTER SESSION ENABLE ADG_REDIRECT_PLSQL;</code></span></li>
                        </ul>
                        <div class="section">
                           <p>您只能在会话级别为PL / SQL操作配置自动重定向。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-21156FB5-6BBF-4D0B-B914-D69DC3C61A2C" name="GUID-21156FB5-6BBF-4D0B-B914-D69DC3C61A2C"></a><h5 id="SBYDB-GUID-21156FB5-6BBF-4D0B-B914-D69DC3C61A2C" class="sect5"><span class="enumeration_section">10.2.2.3</span>修改的PL / SQL对象的自动重新编译</h5>
                     <div>
                        <p>如果它们无效，则可以重新编译在备用实例上运行的PL / SQL对象。</p>
                        <p></p>
                        <p>PL / SQL对象在修改或删除其依赖对象时变为无效。从Oracle Database Release 19c开始，可以通过将<code class="codeph">ADG_REDIRECT_DML</code>初始化参数设置为<code class="codeph">TRUE</code>来自动重新编译在备用数据库上运行的无效PL / SQL对象。与这些PL / SQL对象相对应的DDL被重定向到主数据库并在主数据库上执行。备用会话等待操作完成。
                        </p>
                        <div class="example" id="GUID-21156FB5-6BBF-4D0B-B914-D69DC3C61A2C__GUID-00B02E09-1008-4DE2-8C06-CEC3E8E4B831">
                           <p class="titleinexample">示例10-2自动重新编译已修改的PL / SQL对象</p>
                           <p>在Active DataGuard环境中的主数据库上，将创建名为<code class="codeph">insert_empl</code>的过程。此过程用于更新<code class="codeph">employees</code>表。
                           </p><pre class="pre codeblock"><code>创建或替换程序update_sal（emp_id IN NUMBER，sal IN NUMBER）AS BEGIN UPDATE employees SET salary = sal WHERE employee_id = emp_id）;结束;</code></pre><p>随后使用<code class="codeph">ALTER TABLE</code>命令修改<code class="codeph">employees</code>表的结构。这使<code class="codeph">update_sal</code>过程无效。
                           </p>
                           <p>在Active DataGuard环境中的备用数据库上，您希望使用<code class="codeph">update_sal</code>过程来更新员工的薪水。在物理备用服务器上运行以下命令：</p><pre class="pre codeblock"><code>SQL&gt; ALTER SESSION ENABLE ADG_REDIRECT_DML; SQL&gt; exec update_sal（105,6000）;</code></pre><p>运行这些命令的用户已被授予执行<code class="codeph">update_sal</code>过程的权限。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-A182664E-59F7-4C96-953F-406D0FB6573D" name="GUID-A182664E-59F7-4C96-953F-406D0FB6573D"></a><h4 id="SBYDB-GUID-A182664E-59F7-4C96-953F-406D0FB6573D" class="sect4"><span class="enumeration_section">10.2.3</span>在Active Data Guard实例上使用临时表</h4>
                  <div>
                     <p>您可以在Active Data Guard实例上创建全局临时表和专用临时表。</p>
                     <p>临时表包含仅在事务或会话期间存在的数据。临时表中的数据对会话是私有的。每个会话只能查看和修改自己的数据。</p>
                     <div class="infoboxnotealso" id="GUID-A182664E-59F7-4C96-953F-406D0FB6573D__GUID-BE3A3838-AF27-4C53-8B3E-6EBA5EE9F382">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../cncpt/tables-and-table-clusters.html#CNCPT-GUID-23B23DCF-7482-4585-9C63-AC073C5DE224" target="_blank"><span><cite>Oracle数据库概念，</cite></span></a>用于描述全局临时表，私有临时表以及它们之间的差异</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="SBYDB5426"></a><a id="SBYDB5163"></a><div class="props_rev_3"><a id="GUID-DAF341CA-69C9-497D-A50C-FDC89ED9C1D8" name="GUID-DAF341CA-69C9-497D-A50C-FDC89ED9C1D8"></a><h5 id="SBYDB-GUID-DAF341CA-69C9-497D-A50C-FDC89ED9C1D8" class="sect5"><span class="enumeration_section">10.2.3.1</span> Active Data Guard实例上的全局临时表</h5>
                     <div>
                        <p>Oracle Active Data Guard实例上的临时表允许DML和DDL操作。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-DAF341CA-69C9-497D-A50C-FDC89ED9C1D8__GUID-58E7CC53-3BAE-45BC-B72B-2B4D119DB96B">DML操作</p>
                           <p>当DML操作更改全局临时表时，更改本身不会生成重做，因为它只是一个临时表。但是为更改生成的撤消反过来会生成重做。不允许在只读数据库（例如Active Data Guard备用数据库）上生成重做。但是，Oracle Active Data Guard备用数据库上允许对全局临时表执行DML操作，因为临时撤消功能允许将撤消对全局临时表的更改存储在临时表空间中而不是撤消表空间。并且存储在临时表空间中的undo不会生成重做。</p>
                           <p>此功能通过以下方式使Oracle Data Guard受益：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用全局临时表存储临时数据的大多数报告应用程序可以卸载到Oracle Active Data Guard实例。</p>
                              </li>
                              <li>
                                 <p>在主数据库上启用临时撤消时，重做中不会记录撤消对全局临时表的更改，因此主数据库生成的重做次数较少。因此，Oracle Data Guard必须向备用数据库发送的重做次数也会减少，从而减少网络带宽消耗和存储消耗。</p>
                              </li>
                           </ul>
                           <p>要在主数据库上启用临时撤消，请使用<code class="codeph">TEMP_UNDO_ENABLED</code>初始化参数。在Oracle Active Data Guard备用数据库上，默认情况下始终启用临时撤消，因此<code class="codeph">TEMP_UNDO_ENABLED</code>参数无效。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-DAF341CA-69C9-497D-A50C-FDC89ED9C1D8__GUID-D2F33C5A-30B5-4B21-9836-A0203FC2A238">限制</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>临时撤消功能要求将数据库初始化参数<code class="codeph">COMPATIBLE</code>设置为12.0.0或更高。
                                 </p>
                              </li>
                              <li>
                                 <p>Oracle Active Data Guard实例上的临时撤消功能不支持临时<code class="codeph">BLOB</code>或临时<code class="codeph">CLOB</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>如果Oracle Active Data Guard实例涉及对本地对象的更改，则不允许这些事务在Oracle Active Data Guard实例上进行。例如，您不能提交修改Oracle Active Data Guard实例上的全局临时表的事务，也不能使用数据库链接更新另一个数据库上的远程表。在发出远程DML操作之前，必须将任何未完成的DML操作提交或回滚到Active Data Guard实例上的全局临时表，反之亦然。这还包括对诸如<code class="codeph">EXPLAIN PLAN</code>语句之类的操作所做的全局临时表的隐式写入。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-DAF341CA-69C9-497D-A50C-FDC89ED9C1D8__GUID-C350D6EB-2ABB-4570-B776-39050B90966A">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ADMIN13740" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a> ，了解有关临时撤消的更多信息</p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">TEMP_UNDO_ENABLED</code>初始化参数的详细信息，请<code class="codeph">TEMP_UNDO_ENABLED</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN10326" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-DAF341CA-69C9-497D-A50C-FDC89ED9C1D8__GUID-9FE9963A-4B8C-4ECA-9B85-11F6BA1BB3E4">DDL操作</p>
                           <p>可以在Active Data Guard备用数据库上创建全局临时表，也可以从中删除全局临时表。这些操作的DDL透明地重定向到主数据库。然后，Active Data Guard会话将等待，直到相应的更改发送并应用于Active Data Guard备用数据库。以下是创建全局临时表的示例：</p><pre class="pre codeblock"><code>SQL&gt; CREATE GLOBAL TEMPORARY TABLE tab2（c1 number，c2 varchar（10））ON COMMIT PRESERVE ROWS;表创建。SQL&gt;</code></pre><div class="infoboxnote" id="GUID-DAF341CA-69C9-497D-A50C-FDC89ED9C1D8__GUID-1B188DD7-8D61-40CE-871C-C02E58A7442E">
                              <p class="notep1">注意：</p>
                              <p>要使DDL重定向成功，必须使用实时应用选项启动Active Data Guard备用数据库上的受管备份恢复，并且Active Data Guard备用数据库必须与主数据库同步。</p>
                           </div>
                           <div class="infoboxnote" id="GUID-DAF341CA-69C9-497D-A50C-FDC89ED9C1D8__GUID-00B568A5-6D36-4154-813B-761B500997A7">
                              <p class="notep1">注意：</p>
                              <p>仍然可以从主数据库发出对全局临时表（例如， <code class="codeph">CREATE</code>和<code class="codeph">DROP</code> ）的数据定义语言（DDL）操作。当备份数据库赶上主数据库时，备用数据库上的DDL更改可见。
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-92A71AA4-BEEB-4C2B-B663-FC6641059E39" name="GUID-92A71AA4-BEEB-4C2B-B663-FC6641059E39"></a><h5 id="SBYDB-GUID-92A71AA4-BEEB-4C2B-B663-FC6641059E39" class="sect5"><span class="enumeration_section">10.2.3.2</span> Active Data Guard实例上的专用临时表</h5>
                     <div>
                        <p>您可以在Oracle Active Data Guard实例上创建专用临时表，即使它们是只读的。</p>
                        <p>可以在只读数据库中创建私有临时表的原因是它们的元数据存储在内存中，而不是存储在磁盘上。私有临时表的生存期仅在创建它的会话期间，并在会话结束时自动删除。此功能允许报告应用程序在Active Data Guard备用数据库上运行。</p>
                        <div class="infoboxnote" id="GUID-92A71AA4-BEEB-4C2B-B663-FC6641059E39__GUID-DB6EECEA-F094-4A91-9F0B-122F7477CFD7">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>有关创建专用临时表的信息，请参见<a href="../admin/managing-tables.html#ADMIN-GUID-9B373086-0760-4B18-9688-BACFF07EC74B" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-9796284E-DF94-4F88-8CF6-7F966830D3AA" name="GUID-9796284E-DF94-4F88-8CF6-7F966830D3AA"></a><h4 id="SBYDB-GUID-9796284E-DF94-4F88-8CF6-7F966830D3AA" class="sect4"><span class="enumeration_section">10.2.4</span> IM列存储在Active Data Guard环境中</h4>
                  <div>
                     <p>如Oracle数据库12的<span class="italic">c</span>解除2（12.2.0.1），Oracle数据库内存中的列存储（IM列存储）被支撑在活动数据卫士（ADG）环境中的备用数据库上。
                     </p>
                     <p>在Active Data Guard备用数据库上执行的报告工作负载可以使用IM列存储。使用IM列存储可以提高工作负载的执行性能，因为它可以充分利用内存中压缩列式格式的数据访问。此外，可以在主数据库和备用数据库上的IM列存储中填充完全不同的数据集，从而有效地使应用程序可用的IM列存储的大小加倍。要使用多实例重做应用启用IM列存储支持，请将初始化参数<code class="codeph">enable_imc_with_mira</code>设置为TRUE。</p>
                     <p>请注意以下限制：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>仅基于在主数据库上执行的查询捕获内存中表达式。</p>
                        </li>
                        <li>
                           <p>基于访问标准的内存中信息生命周期管理（ILM）策略仅基于主数据库上记录的访问来触发。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-9796284E-DF94-4F88-8CF6-7F966830D3AA__GUID-B2C9D607-EEEC-40A1-8461-1B4C7377BC16">
                        <p class="notep1">注意：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>ADG环境中的备用数据库不支持In-Memory FastStart。</p>
                           </li>
                           <li>
                              <p>ADG环境中的备用数据库不支持内存中的加入组。</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=INMEM-GUID-1B891BD1-66E8-40CD-BCE0-C3532FC36222" target="_blank"><span><cite>Oracle数据库内存指南</cite></span></a></li>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN-GUID-124E6841-C552-4DA8-96D4-83CE16B6B6AB" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-37A7C87D-61C3-4C8C-A592-1C5B42BE021A" name="GUID-37A7C87D-61C3-4C8C-A592-1C5B42BE021A"></a><h4 id="SBYDB-GUID-37A7C87D-61C3-4C8C-A592-1C5B42BE021A" class="sect4"><span class="enumeration_section">10.2.5</span> Active Data Guard环境中的内存外部表</h4>
                  <div>
                     <p>Oracle Active Data Guard支持内存外部表。</p>
                     <p></p>
                     <p>主数据库和备用数据库中的内存外部表是并行加载的。在Active Data Guard环境中运行的查询使用具有并行查询的内存中外部表段。使用<code class="codeph">INMEMORY</code>或<code class="codeph">NO INMEMORY</code>导致释放活动备用数据库上的内存中外部表段。
                     </p>
                     <div class="infoboxnote" id="GUID-37A7C87D-61C3-4C8C-A592-1C5B42BE021A__GUID-35086871-B4F6-4831-924D-29C80EF5577E">
                        <p class="notep1">注意：</p>
                        <p>使用<code class="codeph">INMEMORY...的<code class="codeph">FOR SERVICE</code>子条款<code class="codeph">INMEMORY...在主数据库，备用数据库或两者中不支持在IM列存储中填充<code class="codeph">INMEMORY</code>对象时的DISTRIBUTE</code>子句。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-37A7C87D-61C3-4C8C-A592-1C5B42BE021A__GUID-2434019F-8802-4495-BB82-21AAF3BC9321">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=INMEM-GUID-37E2E218-33A2-490E-891D-B627906DE16B#GUID-37E2E218-33A2-490E-891D-B627906DE16B" target="_blank"><span><cite>Oracle数据库内存指南</cite></span></a></p>
                     </div>
                  </div>
               </div><a id="SBYDB5427"></a><a id="SBYDB5166"></a><a id="SBYDB5164"></a><div class="props_rev_3"><a id="GUID-DFDC929C-7446-413B-A25B-7F11284D900F" name="GUID-DFDC929C-7446-413B-A25B-7F11284D900F"></a><h4 id="SBYDB-GUID-DFDC929C-7446-413B-A25B-7F11284D900F" class="sect4"><span class="enumeration_section">10.2.6</span>在Oracle Active Data Guard中使用序列</h4>
                  <div>
                     <p>在Oracle Active Data Guard环境中，也可以从备用数据库访问由主数据库创建的具有默认<code class="codeph">CACHE</code>和<code class="codeph">NOORDER</code>选项的序列。
                     </p>
                     <div class="section">
                        <p>当备用数据库第一次访问这样的序列时，它请求主数据库分配一系列序列号。范围基于创建序列时指定的高速缓存大小和其他序列属性。然后，主数据库通过调整数据字典中的相应序列条目，将这些序列号分配给请求备用数据库。当备用数据库使用了该范围内的所有数字时，它会请求另一个数字范围。</p>
                        <p>主数据库确保来自备用数据库的每个范围请求都获得一系列序列号，这些序列号与先前为主数据库和备用数据库分配的序列号不重叠。这会在整个Oracle Data Guard配置中生成唯一的序列号流。</p>
                        <p>由于备用数据库对一系列序列的请求涉及到主数据包的往返，因此在创建要在Oracle Active Data Guard备用数据库上使用的序列时，请确保为<code class="codeph">CACHE</code>关键字指定足够大的值。否则，性能可能会受到影响
                        </p>
                        <p>此外，请确保终端备用数据库已定义<code class="codeph">LOG_ARCHIVE_DEST_</code> <span class="italic"><code class="codeph">n</code></span>参数，该参数指向主数据库。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-DFDC929C-7446-413B-A25B-7F11284D900F__GUID-0950CBDF-EA36-442A-B27E-DA085114D354">示例：在多备用配置中分配一系列序列值</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>此示例显示了如何在第一次引用序列上的<code class="codeph">NEXTVAL</code>时或在它用完所有先前分配的序列值后，可以将一系列序列值分配给数据库。在此示例中，有两个备用数据库。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在主数据库上，发出以下SQL语句以创建名为<code class="codeph">gtt</code>的全局临时表，以及名为<code class="codeph">g</code>且缓存大小为10的序列：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE GLOBAL TEMPORARY TABLE gtt（一个int）;表创建。SQL&gt; CREATE SEQUENCE g CACHE 10;顺序创建。
</pre></div>
                        </li>
                        <li class="stepexpand"><span>在第一个备用数据库上，发出以下SQL语句：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO gtt VALUES（g。NEXTVAL）;已创建1行。SQL&gt; INSERT INTO gtt VALUES（g。NEXTVAL）;已创建1行。SQL&gt; SELECT * FROM gtt; A ---------- 1 2</pre><p>因为序列高速缓存大小设置为10（在步骤1中）并且因为这是第一次访问序列，所以<code class="codeph">SELECT</code>语句的结果显示第一个备用数据库被分配了序列号1到10。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在主数据库上，发出以下SQL语句：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT g。NEXTVAL来自双重; NEXTVAL ---------- 11 SQL&gt; SELECT g。NEXTVAL来自双重; NEXTVAL ---------- 12</pre><p><code class="codeph">SELECT</code>语句的结果显示主数据库被分配了下一个序列值范围11-20。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在第二个备用数据库上，发出以下SQL语句：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO gtt VALUES（g。NEXTVAL）;已创建1行。SQL&gt; INSERT INTO gtt VALUES（g。NEXTVAL）;已创建1行。SQL&gt; SELECT * FROM gtt; A ---------- 21 22</pre><p><code class="codeph">SELECT</code>语句的结果显示第二个备用数据库被分配了下一个序列值范围21-30。
                              </p>
                              <div class="infoboxnote" id="GUID-DFDC929C-7446-413B-A25B-7F11284D900F__GUID-F133EE4A-28A9-4E00-9A1C-293F1396C0EA">
                                 <p class="notep1">注意：</p>在Oracle Active Data Guard备用数据库上无法访问使用<code class="codeph">ORDER</code>或<code class="codeph">NOCACHE</code>选项创建的序列。
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div><a id="SBYDB5169"></a><a id="SBYDB5428"></a><a id="SBYDB5168"></a><div class="props_rev_3"><a id="GUID-8A73B0A3-D77D-4CF6-ABCB-6293BB26B6D1" name="GUID-8A73B0A3-D77D-4CF6-ABCB-6293BB26B6D1"></a><h5 id="SBYDB-GUID-8A73B0A3-D77D-4CF6-ABCB-6293BB26B6D1" class="sect5"><span class="enumeration_section">10.2.6.1</span>会话序列</h5>
                     <div>
                        <p>会话序列是一种特殊类型的序列，专门设计用于具有会话可见性的全局临时表。</p>
                        <div class="section">
                           <p>与现有的常规序列（为了进行比较而称为“全局”序列）不同，会话序列仅在会话内返回唯一的序列号范围，而不是跨会话。另一个区别是会话序列不是持久的。如果会话消失，则会话期间访问的会话序列的状态也会消失。</p>
                           <p>会话序列支持定义序列时指定的大多数序列属性。但是， <code class="codeph">CACHE</code> / <code class="codeph">NOCACHE</code>和<code class="codeph">ORDER</code> / <code class="codeph">NOORDER</code>选项与会话序列无关并被忽略。
                           </p>
                           <p>会话序列必须由读/写数据库创建，但可以在任何读/写或只读数据库（常规数据库临时打开只读或备用数据库）上访问。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-8A73B0A3-D77D-4CF6-ABCB-6293BB26B6D1__GUID-95A4E004-A2E4-4452-A5A2-93184EC5D6D6">创建和更改会话序列</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>要创建会话序列，请发出以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE SEQUENCE ... SESSION;</pre><p>要将现有会话序列更改为常规（“全局”）序列，请发出以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER SEQUENCE ... GLOBAL;</pre><p>要将常规序列更改为会话序列，请发出以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER SEQUENCE ... SESSION;</pre></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-8A73B0A3-D77D-4CF6-ABCB-6293BB26B6D1__GUID-DC57A256-8345-470C-A435-06792CE0C803">示例：使用会话序列</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>此示例显示会话序列值对每个数据库会话的唯一性。</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>在主数据库上，发出以下SQL语句以创建名为<code class="codeph">gtt</code>的全局临时表和名为<code class="codeph">s</code>的会话序列：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE GLOBAL TEMPORARY TABLE gtt（一个int）;表创建。SQL&gt; CREATE SEQUENCE s SESSION;顺序创建。
</pre></div>
                           </li>
                           <li class="stepexpand"><span>在备用数据库上，发出以下SQL语句：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO gtt VALUES（s。NEXTVAL）;已创建1行。SQL&gt; INSERT INTO gtt VALUES（s。NEXTVAL）;已创建1行。SQL&gt; SELECT * FROM gtt; A ---------- 1 2</pre></div>
                           </li>
                           <li class="stepexpand"><span>从同一备用数据库的另一个会话中，发出以下SQL语句：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO gtt VALUES（s。NEXTVAL）;已创建1行。SQL&gt; INSERT INTO gtt VALUES（s。NEXTVAL）;已创建1行。SQL&gt; SELECT * FROM gtt; A ---------- 1 2</pre><p><code class="codeph">SELECT</code>语句的结果显示分配的序列值与上一步中为第一个会话分配的序列值相同。这是因为序列值对于每个数据库会话都是唯一的。
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div>
            </div><a id="SBYDB5040"></a><a id="SBYDB4784"></a><div class="props_rev_3"><a id="GUID-62007456-DD41-431D-B0E7-56C99FEB2277" name="GUID-62007456-DD41-431D-B0E7-56C99FEB2277"></a><h3 id="SBYDB-GUID-62007456-DD41-431D-B0E7-56C99FEB2277" class="sect3"><span class="enumeration_section">10.3</span>需要在物理备用时手动干预的主要数据库更改</h3>
               <div>
                  <p>对主数据库进行的大多数结构更改都会自动通过重做数据传播到物理备用数据库，但是有一些更改需要手动干预。</p>
                  <div class="section">
                     <p>下表列出了需要在物理备用数据库上进行手动干预的主数据库结构和配置更改。</p>
                     <div class="tblformalwide" id="GUID-62007456-DD41-431D-B0E7-56C99FEB2277__G1041883">
                        <p class="titleintable">表10-1需要在物理备用时手动干预的主要数据库更改</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="在物理待机中需要手动干预的主要数据库更改" width="100%" border="1" summary="When you change the primary database, it often requires that you take a similar action on the standby database. This 2 column table lists the administrative tasks that require you perform some action on the standby database." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="47%" id="d21041e3051">主数据库更改</th>
                                 <th align="left" valign="bottom" width="53%" id="d21041e3054">物理备用数据库所需的操作</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d21041e3059" headers="d21041e3051 ">
                                    <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-C60E4DB4-F424-454D-B4DF-7A97B2F09540" title="STANDBY_FILE_MANAGEMENT数据库初始化参数控制是否将数据文件添加到主数据库自动传播到物理备用数据库。">添加数据文件或创建表空间</a></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d21041e3059 d21041e3054 ">
                                    <p>如果<code class="codeph">STANDBY_FILE_MANAGEMENT</code>数据库初始化参数设置为<code class="codeph">AUTO</code>则无需任何操作。如果此参数设置为<code class="codeph">MANUAL</code> ，则必须将新数据文件复制到物理备用数据库。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d21041e3083" headers="d21041e3051 ">
                                    <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-76C5E1AD-2A05-4BC8-AB26-5C68E2AB991D" title="删除表空间或从主数据库中删除数据文件时，必须从物理备用数据库中删除相应的数据文件。">删除表空间和删除数据文件</a></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d21041e3083 d21041e3054 ">
                                    <p>将包含<code class="codeph">DROP</code>或<code class="codeph">DELETE</code>命令的重做数据应用于物理备用数据库后，从主数据库和物理备用数据库中删除数据文件。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d21041e3101" headers="d21041e3051 ">
                                    <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-88158C9B-51FB-4F13-93FC-97D737C86BF0" title="您可以使用Oracle可传输表空间功能移动Oracle数据库的子集并将其插入另一个Oracle数据库，从而在数据库之间移动表空间。">将可传输表空间与物理备用数据库一起使用</a></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d21041e3101 d21041e3054 ">
                                    <p>在主数据库和物理备用数据库之间移动表空间。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d21041e3113" headers="d21041e3051 ">
                                    <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-2D3E5488-237C-467A-AB8B-7C09B6E43CE0" title="重命名主数据库中的一个或多个数据文件时，更改不会传播到备用数据库。必须手动完成。">重命名主数据库中的数据文件</a></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d21041e3113 d21041e3054 ">
                                    <p>重命名物理备用数据库上的数据文件。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d21041e3125" headers="d21041e3051 ">
                                    <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-64E46731-490D-4228-AC87-A07CDE3C75FE" title="在主数据库上添加或删除日志文件组后，应重新评估和调整物理备用数据库上的重做日志和备用重做日志的配置。">添加或删除重做日志文件组</a></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d21041e3125 d21041e3054 ">
                                    <p>评估物理备用数据库上的重做日志和备用重做日志的配置，并根据需要进行调整。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d21041e3137" headers="d21041e3051 ">
                                    <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-3A0E6CB4-EE5B-4D16-BCFE-40236BC312D7" title="使用NOLOGGING或UNRECOVERABLE子句执行DML或DDL操作时，备用数据库上的块可能会被标记为无效（也称为非打印块）。">NOLOGGING或不可恢复的操作</a></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d21041e3137 d21041e3054 ">
                                    <p>使用RMAN命令<code class="codeph">RECOVER ...NONLOGGED BLOCK</code>用来NONLOGGED BLOCK</code>的已更改块替换备用服务器上的无效块。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d21041e3158" headers="d21041e3051 ">
                                    <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-FB7AFCB2-8CB3-4F43-B664-261BAFD5B07B" title="如果REMOTE_LOGIN_PASSWORDFILE数据库初始化参数设置为SHARED或EXCLUSIVE，则物理备用数据库上的密码文件将自动替换为主数据库中的新副本。">刷新密码文件</a></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d21041e3158 d21041e3054 ">
                                    <p>如Oracle数据库12的<span class="italic">c</span>解除2（12.2.0.1），在主数据库上进行密码文件的变化将自动传播到备用数据库。唯一的例外是远同步实例。更新的密码文件仍必须手动复制到远程同步实例，因为远程同步实例会接收重做，但不会应用它。在远程同步实例的密码文件是最新的后，主服务器上包含密码更新的重做会自动传播到任何备用数据库，这些数据库设置为从该远程同步实例接收重做。应用重做时，备用数据库上的密码文件会更新。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d21041e3182" headers="d21041e3051 ">
                                    <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-B9B956BC-885F-49AF-A4FF-E900998109ED" title="每当在主数据库上重置TDE主加密密钥时，必须使用主数据库中的数据库加密钱包的新副本替换物理备用数据库上的数据库加密钱包。">重置TDE主加密密钥</a></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d21041e3182 d21041e3054 ">
                                    <p>使用主数据库中的数据库加密钱包的新副本替换物理备用数据库上的数据库加密钱包。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="47%" id="d21041e3194" headers="d21041e3051 ">
                                    <p><a href="oracle-initialization-parameters-used-by-oracle-data-guard.html#GUID-A1CF9B00-F0F5-4F3B-A0E0-9D6ABF775EC9" title="这是您为Data Guard环境设置的初始化参数的字母顺序列表。它指示参数是为主角色还是备用角色设置的，还提供了设置每个参数的提示。">初始化参数</a></p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d21041e3194 d21041e3054 ">
                                    <p>评估是否必须对物理备用数据库上的初始化参数进行相应的更改。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
               </div><a id="SBYDB4785"></a><div class="props_rev_3"><a id="GUID-C60E4DB4-F424-454D-B4DF-7A97B2F09540" name="GUID-C60E4DB4-F424-454D-B4DF-7A97B2F09540"></a><h4 id="SBYDB-GUID-C60E4DB4-F424-454D-B4DF-7A97B2F09540" class="sect4"><span class="enumeration_section">10.3.1</span>添加数据文件或创建表空间</h4>
                  <div>
                     <p><code class="codeph">STANDBY_FILE_MANAGEMENT</code>数据库初始化参数控制是否将数据文件添加到主数据库自动传播到物理备用数据库。
                     </p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果物理备用数据库上的<code class="codeph">STANDBY_FILE_MANAGEMENT</code>数据库参数设置为<code class="codeph">AUTO</code> ，则会在物理备用数据库上自动创建在主数据库上创建的所有新数据文件。
                              </p>
                           </li>
                           <li>
                              <p>如果物理备用数据库上的<code class="codeph">STANDBY_FILE_MANAGEMENT</code>数据库参数设置为<code class="codeph">MANUAL</code> ，则必须在将新数据文件添加到主数据库后将其从主数据库手动复制到物理备用数据库。
                              </p>
                              <div class="infoboxnote" id="GUID-C60E4DB4-F424-454D-B4DF-7A97B2F09540__GUID-DB48701A-D02D-411B-ADE6-12D6B95010D8">
                                 <p class="notep1">注意：</p>
                                 <p>在已启用Oracle Active Data Guard选项的物理备用数据库上，您无法使用手动复制方法。相反，您必须在备用数据库上执行以下SQL语句以创建空数据文件：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE CREATE DATAFILE [filename | filenumber]  -  AS [NEW | <span class="italic">new_filename</span> ];</pre><p>您必须指定要重命名的<code class="codeph">filename</code> ： <code class="codeph">filename</code>或<code class="codeph">filename</code> <code class="codeph">filenumber</code> 。
                                 </p>
                                 <p>同时指定新文件名或<code class="codeph">NEW</code> 。如果启用了Oracle Managed Files（OMF），则<code class="codeph">NEW</code>关键字允许Oracle自动选择名称。
                                 </p>
                              </div>
                           </li>
                        </ul>
                        <p>如果将来自其他数据库的现有数据文件复制到主数据库，则还必须将其复制到备用数据库，并且必须重新创建备用控制文件，而不管<code class="codeph">STANDBY_FILE_MANAGEMENT</code>参数的设置如何。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4788"></a><div class="props_rev_3"><a id="GUID-76C5E1AD-2A05-4BC8-AB26-5C68E2AB991D" name="GUID-76C5E1AD-2A05-4BC8-AB26-5C68E2AB991D"></a><h4 id="SBYDB-GUID-76C5E1AD-2A05-4BC8-AB26-5C68E2AB991D" class="sect4"><span class="enumeration_section">10.3.2</span>删除表空间和删除数据文件</h4>
                  <div>
                     <p>删除表空间或从主数据库中删除数据文件时，必须从物理备用数据库中删除相应的数据文件。</p>
                     <div class="section">
                        <p>以下示例显示如何删除表空间：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; DROP TABLESPACE tbs_4; SQL&gt; ALTER SYSTEM SWITCH LOGFILE;</pre><p>要验证已删除的数据文件不再是数据库的一部分，请查询<code class="codeph">V$DATAFILE</code>视图。
                        </p>
                        <p>将包含先前更改的重做数据应用于备用数据库后，删除备用系统上的相应数据文件。例如：</p><pre class="oac_no_warn" dir="ltr">％rm /disk1/oracle/oradata/payroll/s2tbs_4.dbf</pre><p>在主数据库上，确保备用数据库应用已删除表空间的重做信息后，可以删除表空间的数据文件。例如：</p><pre class="oac_no_warn" dir="ltr">％rm /disk1/oracle/oradata/payroll/tbs_4.dbf</pre></div>
                     <!-- class="section" -->
                  </div><a id="SBYDB4789"></a><div class="props_rev_3"><a id="GUID-10EE6961-A52F-4101-A911-B8692636CC37" name="GUID-10EE6961-A52F-4101-A911-B8692636CC37"></a><h5 id="SBYDB-GUID-10EE6961-A52F-4101-A911-B8692636CC37" class="sect5"><span class="enumeration_section">10.3.2.1</span>使用DROP TABLESPACE包括内容和数据文件</h5>
                     <div>
                        <p>您可以在主数据库上发出SQL <code class="codeph">DROP TABLESPACE INCLUDING CONTENTS AND DATAFILES</code>语句，以删除主数据库和备用数据库上的数据文件。
                        </p>
                        <div class="section">
                           <p>要使用此语句，必须将<code class="codeph">STANDBY_FILE_MANAGEMENT</code>初始化参数设置为<code class="codeph">AUTO</code> 。例如，要删除主站点上的表空间：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; DROP TABLESPACE tbs_4包括内容和数据文件; SQL&gt; ALTER SYSTEM SWITCH LOGFILE;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="SBYDB4790"></a><div class="props_rev_3"><a id="GUID-88158C9B-51FB-4F13-93FC-97D737C86BF0" name="GUID-88158C9B-51FB-4F13-93FC-97D737C86BF0"></a><h4 id="SBYDB-GUID-88158C9B-51FB-4F13-93FC-97D737C86BF0" class="sect4"><span class="enumeration_section">10.3.3</span>将可传输表空间与物理备用数据库一起使用</h4>
                  <div>
                     <p>您可以使用Oracle可传输表空间功能移动Oracle数据库的子集并将其插入另一个Oracle数据库，从而在数据库之间移动表空间。</p>
                     <div class="section">
                        <p>要在使用物理备用数据库时将一组表空间移动或复制到主数据库，请执行以下步骤：</p>
                        <ol>
                           <li>
                              <p>生成可传输的表空间集，该表集空间集由正在传输的表空间集的数据文件和包含该表空间集的结构信息的导出文件组成。</p>
                           </li>
                           <li>
                              <p>传输表空间集：</p>
                              <ol type="a">
                                 <li>
                                    <p>将数据文件和导出文件复制到主数据库。</p>
                                 </li>
                                 <li>
                                    <p>将数据文件复制到备用数据库。</p>
                                 </li>
                              </ol>
                              <p>除非已配置<code class="codeph">DB_FILE_NAME_CONVERT</code>数据库初始化参数，否则数据文件在主数据库和备用数据库上必须具有相同的路径名。如果<code class="codeph">DB_FILE_NAME_CONVERT</code> <span class="italic">尚未</span>配置和数据文件的路径名不是在主数据库和备用数据库一样，发出<code class="codeph">ALTER DATABASE RENAME FILE</code>语句来重命名数据文件。在Redo Apply无法应用通过将表空间插入主数据库生成的重做之后执行此操作。在重命名数据文件之前，必须将<code class="codeph">STANDBY_FILE_MANAGEMENT</code>初始化参数设置为<code class="codeph">MANUAL</code>然后在重命名数据文件后重置为先前的值。
                              </p>
                           </li>
                           <li>
                              <p>插入表空间。</p>
                              <p>调用<a id="d21041e3667" class="indexterm-anchor"></a> Data Pump实用程序将表空间集插入主数据库。生成重做数据并在备用站点应用，以将表空间插入备用数据库。
                              </p>
                           </li>
                        </ol>
                        <p>有关可传输表空间的更多信息，请参见“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ADMIN11394" target="_blank"><span class="italic">Oracle数据库管理员指南”。</span></a></p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4791"></a><div class="props_rev_3"><a id="GUID-2D3E5488-237C-467A-AB8B-7C09B6E43CE0" name="GUID-2D3E5488-237C-467A-AB8B-7C09B6E43CE0"></a><h4 id="SBYDB-GUID-2D3E5488-237C-467A-AB8B-7C09B6E43CE0" class="sect4"><span class="enumeration_section">10.3.4</span>重命名主数据库中的数据文件</h4>
                  <div>
                     <p>重命名主数据库中的一个或多个数据文件时，更改不会传播到备用数据库。必须手动完成。</p>
                     <div class="section">
                        <p>要在备用数据库上重命名相同的数据文件，必须在备用数据库上手动进行等效修改，因为即使<code class="codeph">STANDBY_FILE_MANAGEMENT</code>初始化参数设置为<code class="codeph">AUTO</code> ，也不会自动执行修改。</p>
                        <p>以下步骤描述如何在主数据库中重命名数据文件并手动将更改传播到备用数据库。</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>至<a id="d21041e3777" class="indexterm-anchor"></a><a id="d21041e3779" class="indexterm-anchor"></a><a id="d21041e3785" class="indexterm-anchor"></a>重命名主数据库中的数据文件，使表空间脱机：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER TABLESPACE tbs_4 OFFLINE;</pre></div>
                        </li>
                        <li class="stepexpand"><span>退出SQL提示符并发出操作系统命令（例如以下UNIX <code class="codeph">mv</code>命令）以重命名主系统上的数据文件：</span><div><pre class="oac_no_warn" dir="ltr">％mv /disk1/oracle/oradata/payroll/tbs_4.dbf /disk1/oracle/oradata/payroll/tbs_x.dbf</pre></div>
                        </li>
                        <li class="stepexpand"><span>重命名主数据库中的数据文件并使表空间重新联机：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER TABLESPACE tbs_4 RENAME DATAFILE  - &gt;'/disk1/oracle/oradata/payroll/tbs_4.dbf' - &gt; TO'/disk1/oracle/oradata/payroll/tbs_x.dbf'; SQL&gt; ALTER TABLESPACE tbs_4 ONLINE;</pre><div class="infoboxnote" id="GUID-2D3E5488-237C-467A-AB8B-7C09B6E43CE0__GUID-26370FC4-39E3-48F0-B680-D2AC913C2739">
                                 <p class="notep1">注意：</p>
                                 <p>前三个步骤的替代方法是使用<code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">MOVE</code> <code class="codeph">DATAFILE</code>命令重命名数据文件。此命令允许您重命名数据文件，同时允许对数据文件进行读/写访问。足够的存储区域是移动数据文件的先决条件，因为在执行<code class="codeph">MOVE</code> <code class="codeph">DATAFILE</code>命令期间，数据库将原始数据文件和重命名的数据文件维护为两个单独的文件。有关更多信息，请参阅<a href="getting-started-with-oracle-data-guard.html#GUID-8DA7295A-53C7-4B52-9E0A-8A513640D265" title="在数据库主动访问文件时，您可以将在线数据文件的位置从一个物理文件移动到另一个物理文件。">移动在线数据文件的位置</a> 。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>连接到备用数据库并停止重做应用：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;</pre></div>
                        </li>
                        <li class="stepexpand"><span>关闭备用数据库：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; SHUTDOWN;</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用操作系统命令（例如UNIX <code class="codeph">mv</code>命令）在备用站点重命名数据文件：</span><div><pre class="oac_no_warn" dir="ltr">％mv /disk1/oracle/oradata/payroll/tbs_4.dbf /disk1/oracle/oradata/payroll/tbs_x.dbf</pre></div>
                        </li>
                        <li class="stepexpand"><span>启动并挂载备用数据库：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; STARTUP MOUNT;</pre></div>
                        </li>
                        <li class="stepexpand"><span>重命名备用控制文件中的数据文件。要重命名数据文件，必须将<code class="codeph">STANDBY_FILE_MANAGEMENT</code>数据库初始化参数设置为<code class="codeph">MANUAL</code> 。然后，您可以在重命名数据文件后将参数重置为其先前的值。</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE RENAME FILE'/disk1/oracle/oradata/payroll/tbs_4.dbf' - &gt; TO'/disk1/oracle/oradata/payroll/tbs_x.dbf';</pre></div>
                        </li>
                        <li class="stepexpand"><span>在备用数据库上，重新启动重做应用：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE RECOVER MANAGED STANDBY DATABASE  - &gt;从会话断开连接;</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>如果不在备用系统上重命名相应的数据文件，然后尝试刷新备用数据库控制文件，则备用数据库会尝试使用重命名的数据文件，但不会找到它。类似于以下内容的错误消息将写入警报日志：</p><pre class="oac_no_warn" dir="ltr">ORA-00283：由于错误而取消恢复会话ORA-01157：无法识别/锁定数据文件4  - 请参阅DBWR跟踪文件ORA-01110：datafile 4：'/ Disk1 / oracle /oradata / payroll / tbs_x.dbf'</pre><div class="infoboxnote" id="GUID-2D3E5488-237C-467A-AB8B-7C09B6E43CE0__GUID-A068D73D-D9CD-4007-A233-AA593CD21798">
                           <p class="notep1">注意：</p>
                           <p>步骤4-9的替代方法是使用<code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">MOVE</code> <code class="codeph">DATAFILE</code>命令在备用<code class="codeph">DATABASE</code>中重命名数据文件。有关更多信息，请参阅<a href="getting-started-with-oracle-data-guard.html#GUID-8DA7295A-53C7-4B52-9E0A-8A513640D265" title="在数据库主动访问文件时，您可以将在线数据文件的位置从一个物理文件移动到另一个物理文件。">移动在线数据文件的位置</a> 。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4792"></a><div class="props_rev_3"><a id="GUID-64E46731-490D-4228-AC87-A07CDE3C75FE" name="GUID-64E46731-490D-4228-AC87-A07CDE3C75FE"></a><h4 id="SBYDB-GUID-64E46731-490D-4228-AC87-A07CDE3C75FE" class="sect4"><span class="enumeration_section">10.3.5</span>添加或删除重做日志文件组</h4>
                  <div>
                     <p>在主数据库上添加或删除日志文件组后，应重新评估和调整物理备用数据库上的重做日志和备用重做日志的配置。</p>
                     <div class="section">
                        <p>执行以下步骤以在物理备用数据库上添加或删除日志文件组或备用日志文件组：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>停止重做申请。</span></li>
                        <li class="stepexpand"><span>如果<code class="codeph">STANDBY_FILE_MANAGEMENT</code>初始化参数设置为<code class="codeph">AUTO</code> ，则将值更改为<code class="codeph">MANUAL</code> 。</span></li>
                        <li class="stepexpand"><span>添加或删除日志文件组。</span><div>
                              <div class="infoboxnote" id="GUID-64E46731-490D-4228-AC87-A07CDE3C75FE__GUID-E53A3CB4-2637-495D-9674-BDC1B6BC6259">
                                 <p class="notep1">注意：</p>
                                 <p>必须始终手动清除联机日志文件组，然后才能从物理备用数据库中删除该组。例如：</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE CLEAR LOGFILE GROUP 3;</pre><p>无法从物理备用数据库中删除状态为<code class="codeph">CURRENT</code>或<code class="codeph">CLEARING_CURRENT</code>的联机日志文件组。在角色转换后，可以删除具有此状态的联机日志文件组。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>将<code class="codeph">STANDBY_FILE_MANAGEMENT</code>初始化参数和重做应用选项恢复为其原始状态。</span></li>
                        <li class="stepexpand"><span>重新启动重做应用。</span></li>
                     </ol>
                     <div class="section">
                        <p>在Oracle RAC环境中，请记住以下几点：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将联机重做日志组添加到主数据库时，必须手动将联机重做日志组添加到备用数据库。它不是自动完成的。</p>
                           </li>
                           <li>
                              <p>将新的重做线程添加到主数据库时，会自动将新的重做线程添加到备用数据库。默认情况下，新线程配置有2个日志组，每个日志组100 MB。这不能更改或覆盖。</p>
                           </li>
                           <li>
                              <p>将新日志组添加到现有重做线程时，新日志组不会自动添加到其现有线程中。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB00206"></a><div class="props_rev_3"><a id="GUID-3A0E6CB4-EE5B-4D16-BCFE-40236BC312D7" name="GUID-3A0E6CB4-EE5B-4D16-BCFE-40236BC312D7"></a><h4 id="SBYDB-GUID-3A0E6CB4-EE5B-4D16-BCFE-40236BC312D7" class="sect4"><span class="enumeration_section">10.3.6</span>纳入或不可恢复的操作</h4>
                  <div>
                     <p>使用<code class="codeph">NOLOGGING</code>或<code class="codeph">UNRECOVERABLE</code>子句执行DML或DDL操作时，备用数据库上的块可能会被标记为无效（也称为非打印块）。
                     </p>
                     <p>有关何时以非记录方式实际执行操作的详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ADMIN-GUID-27E9B63B-03E4-43E5-BA59-AB0EDDDE5CE6" target="_blank">FORCE LOGGING设置的优先顺序</a> 。
                     </p>
                     <p>有关<a href="examples-of-using-oracle-data-guard.html#GUID-BD9E85AB-D812-4659-9C85-26CDFF115A8A" title="Some SQL statements allow you to specify a NOLOGGING clause so that the operation is not logged in the online redo log file.">在使用NOLOGGING子句后恢复的</a>信息，请参阅<a href="examples-of-using-oracle-data-guard.html#GUID-BD9E85AB-D812-4659-9C85-26CDFF115A8A" title="某些SQL语句允许您指定NOLOGGING子句，以便在联机重做日志文件中不记录该操作。">指定</a> <code class="codeph">NOLOGGING</code>子句后的恢复。
                     </p>
                     <p>请参见“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ADMIN11096" target="_blank"><span class="italic">Oracle数据库管理员指南”。</span></a>有关指定<code class="codeph">FORCE LOGGING</code>模式的信息。
                     </p>
                  </div>
               </div><a id="SBYDB4793"></a><div class="props_rev_3"><a id="GUID-FB7AFCB2-8CB3-4F43-B664-261BAFD5B07B" name="GUID-FB7AFCB2-8CB3-4F43-B664-261BAFD5B07B"></a><h4 id="SBYDB-GUID-FB7AFCB2-8CB3-4F43-B664-261BAFD5B07B" class="sect4"><span class="enumeration_section">10.3.7</span>刷新密码文件</h4>
                  <div>
                     <p>如果<code class="codeph">REMOTE_LOGIN_PASSWORDFILE</code>数据库初始化参数设置为<code class="codeph">SHARED</code>或<code class="codeph">EXCLUSIVE</code> ，则物理备用数据库上的密码文件将自动替换为主数据库中的新副本。
                     </p>
                     <p>授予或撤消管理权限后，将替换该文件，或者更改具有管理权限的用户的密码。唯一的例外是远同步实例。更新的密码文件仍必须手动复制到远程同步实例，因为远程同步实例会接收重做，但不会应用它。在远程同步实例上手动更新密码文件时，包含来自主数据库的相同密码更改的重做会自动传播到设置为从该远程同步实例接收重做的任何备用数据库。应用重做时，备用数据库上的密码文件会更新。</p>
                  </div>
               </div><a id="SBYDB4794"></a><div class="props_rev_3"><a id="GUID-B9B956BC-885F-49AF-A4FF-E900998109ED" name="GUID-B9B956BC-885F-49AF-A4FF-E900998109ED"></a><h4 id="SBYDB-GUID-B9B956BC-885F-49AF-A4FF-E900998109ED" class="sect4"><span class="enumeration_section">10.3.8</span>重置TDE主加密密钥</h4>
                  <div>
                     <p>每当在主数据库上重置TDE主加密密钥时，必须使用主数据库中的数据库加密钱包的新副本替换物理备用数据库上的数据库加密钱包。</p>
                     <p>如果无法刷新物理备用数据库上的数据库加密钱包，则会阻止访问在主数据库上重置主加密密钥后修改的物理备用数据库上的加密列。</p>
                     <p>对于联机表空间和数据库，从Oracle Database 12 <span class="italic">c</span>第2版（12.2.0.1）开始，您可以在Oracle Data Guard环境中加密，解密和重新键入新的和现有的表空间以及现有的数据库。
                     </p>
                     <p>对于脱机表空间和数据库，从Oracle Database 12 <span class="italic">c</span>第2版（12.2.0.1）开始，您可以加密和解密新的和现有的表空间以及Oracle Data Guard环境中的现有数据库。
                     </p>
                     <p>在在线转换中，在主服务器上执行加密，解密或重新键入后，将自动执行加密，解密或重新键入。无法在备用数据库上直接执行在线加密，解密或重新键入。</p>
                     <p>在脱机转换中，必须在主数据库和备用数据库上手动执行加密或解密。脱机转换仅影响特定主数据库或备用数据库上的数据文件。主数据库和物理备用数据库都应保持相同的状态。您可以通过首先加密（或解密）备用数据库上的表空间，切换到主数据库，然后加密（或解密）主数据库上的表空间来最大限度地减少停机时间。</p>
                     <div class="infoboxnotealso" id="GUID-B9B956BC-885F-49AF-A4FF-E900998109ED__GUID-57CF9A15-CE74-449E-905D-5B351939FAA0">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ASOAG-GUID-79072DFC-4DC6-4920-9B2A-D649123D15C7" target="_blank"><span><cite>Oracle数据库高级安全性指南</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="SBYDB4795"></a><div class="props_rev_3"><a id="GUID-02218512-31A6-461E-96B4-0B9997DCFC4A" name="GUID-02218512-31A6-461E-96B4-0B9997DCFC4A"></a><h3 id="SBYDB-GUID-02218512-31A6-461E-96B4-0B9997DCFC4A" class="sect3"><span class="enumeration_section">10.4</span>通过OPEN RESETLOGS声明恢复</h3>
               <div>
                  <p>在使用<code class="codeph">RESETLOGS</code>选项打开主数据库之后，Oracle Data Guard允许在物理备用数据库上进行恢复。
                  </p>
                  <p>在主数据库上发出<code class="codeph">ALTER DATABASE OPEN RESETLOGS</code>语句时，数据库的变化会发生变化，从而创建重做数据的新分支。
                  </p>
                  <p>当物理备用数据库收到重做数据的新分支时，Redo Apply会自动获取重做数据的新分支。对于物理备用数据库，如果备用数据库未通过新的重置日志SCN（超过重做数据的新分支的开始）应用重做数据，则不需要手动干预。下表描述了如何将备用数据库与主数据库分支重新同步。</p>
                  <div class="tblformalwide" id="GUID-02218512-31A6-461E-96B4-0B9997DCFC4A__GUID-27F52F1F-0D19-408D-AB18-716276A768A9">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="This 3 column table describes how to resynchronize the standby database with the primary database branch. Each row of the table provides a solution that is dependent upon how much redo data the standby database has applied and whether or not Flashback Database is enabled." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="34%" id="d21041e4514">如果是备用数据库。 。 。</th>
                              <th align="left" valign="bottom" width="32%" id="d21041e4517">然后。 。 。</th>
                              <th align="left" valign="bottom" width="34%" id="d21041e4520">执行这些步骤。 。 。</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="34%" id="d21041e4525" headers="d21041e4514 ">
                                 <p>尚未将重做数据应用于新的重置日志SCN（超过重做数据的新分支的开始），并且<code class="codeph">OPEN RESETLOGS</code>的新重做分支已在备用数据库中注册</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4525 d21041e4517 ">
                                 <p>重做应用自动采用重做的新分支。</p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d21041e4525 d21041e4520 ">
                                 <p>无需人工干预。托管重做进程（MRP）自动将备用数据库与重做数据的新分支重新同步。</p>
                                 <p>注意：要检查新的重做分支是否已在备用数据库中注册，请在主服务器和备用服务器上执行以下查询，并验证结果是否匹配：</p><pre class="oac_no_warn" dir="ltr">SELECT resetlogs_id，resetlogs_change＃FROM V $ DATABASE_INCARNATION WHERE status ='CURRENT'</pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="34%" id="d21041e4542" headers="d21041e4514 ">
                                 <p>已经将重做数据应用于新的重置日志SCN（通过重做数据的新分支的开始）并且在备用数据库上启用了闪回数据库</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4542 d21041e4517 ">
                                 <p>备用数据库将<span class="italic">在</span>重做数据的新分支<span class="italic">的未来</span>中恢复。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d21041e4542 d21041e4520 ">
                                 <ol>
                                    <li>
                                       <p>按照将<a href="examples-of-using-oracle-data-guard.html#GUID-09129494-CD98-44B6-821F-A4C2CB5AEE08" title="这些步骤描述了在主数据库上发出OPEN RESETLOGS语句后如何避免重新创建物理备用数据库。">物理备用数据库闪回到特定时间点的过程，</a>以闪回物理备用数据库。
                                       </p>
                                    </li>
                                    <li>
                                       <p>重新启动重做应用以继续将重做数据应用到新的重置日志分支。</p>
                                    </li>
                                 </ol>
                                 <p>托管重做进程（MRP）自动将备用数据库与新分支重新同步。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="34%" id="d21041e4572" headers="d21041e4514 ">
                                 <p>已将重做数据应用于新的重置日志SCN（通过重做数据的新分支的开始）并且备用数据库上未启用闪回数据库</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4572 d21041e4517 ">
                                 <p>主数据库已在指定的主数据库分支上与备用数据库分离。</p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d21041e4572 d21041e4520 ">
                                 <p>按照创建物理备用数据库中的过程重新<a href="creating-oracle-data-guard-physical-standby.html#GUID-B511FB6E-E3E7-436D-94B5-071C37550170" title="您可以使用异步重做传输和实时应用（默认的Oracle Data Guard配置）以最高性能模式手动创建物理备用数据库。">创建物理备用数据库</a> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="34%" id="d21041e4589" headers="d21041e4514 ">
                                 <p>缺少重做数据的新分支中介入的归档重做日志文件</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4589 d21041e4517 ">
                                 <p>在检索到丢失的日志文件之前，MRP无法继续。</p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d21041e4589 d21041e4520 ">
                                 <p>从每个分支中找到并注册缺少的归档重做日志文件。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="34%" id="d21041e4599" headers="d21041e4514 ">
                                 <p>缺少从上一个重做数据分支末尾的归档重做日志文件。</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4599 d21041e4517 ">
                                 <p>在检索到丢失的日志文件之前，MRP无法继续。</p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d21041e4599 d21041e4520 ">
                                 <p>从上一个分支中找到并注册缺少的归档重做日志文件。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>有关数据库化身，通过<code class="codeph">OPEN RESETLOGS</code>操作进行恢复以及闪回数据库的详细信息，请参阅“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=BRADV89752" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”</span></a> 。
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-252097AC-3070-43B6-88D8-919AE27F97AD" name="GUID-252097AC-3070-43B6-88D8-919AE27F97AD"></a><h3 id="SBYDB-GUID-252097AC-3070-43B6-88D8-919AE27F97AD" class="sect3"><span class="enumeration_section">10.5</span>主RESETLOGS操作后自动闪回备用备用</h3>
               <div>
                  <p>处于挂载状态的备用数据库可以在主数据库上执行<code class="codeph">RESETLOGS</code>操作后自动跟随主数据库。这在主服务器上执行<code class="codeph">RESETLOGS</code>操作后简化了备用管理。
                  </p>
                  <p></p>
                  <p>在主数据库或主数据库中的PDB上执行闪回或时间点恢复时，主数据库或PDB将移至先前的时间点，然后使用<code class="codeph">RESETLOGS</code>选项打开主数据库。创建主要的初始化身或初级PDB。要使备用数据库自动跟随主数据库，MRP将执行以下操作：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>检测新的化身</p>
                     </li>
                     <li>
                        <p>将备用数据库或备用数据库上的PDB闪回到与主数据库或主数据库上的PDB相同的时间点</p>
                     </li>
                     <li>
                        <p>重新启动备用恢复并将备用数据库移动到重做的新分支</p>
                     </li>
                  </ul>
                  <p>仅当备用数据库具有足够的闪回数据时，闪回操作才会成功。</p>
                  <p>如果您不希望备用数据库自动跟随主数据库，请将备用数据库保持在<code class="codeph">OPEN</code>模式或停止备用数据库上的MRP进程。
                  </p>
                  <p>如果备用数据库以只读模式打开，则相应的错误消息将记录在警报日志中。关闭物理备用数据库后重新启动MRP时，恢复过程会自动闪回备用数据库并继续应用重做的新分支。</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="examples-of-using-oracle-data-guard.html#GUID-8D948A24-A3B7-4E4F-917A-00B047CF3CAF" title="在主服务器上执行PDB PITR或PDB闪回后，您可以还原PDB或闪回备用服务器上的PDB以使备用服务器跟随主服务器。">主PDB上的PDB PITR或PDB闪回后待机所需的操作</a></li>
                        <li><a href="examples-of-using-oracle-data-guard.html#GUID-09129494-CD98-44B6-821F-A4C2CB5AEE08" title="这些步骤描述了在主数据库上发出OPEN RESETLOGS语句后如何避免重新创建物理备用数据库。">将物理备用数据库闪回到特定时间点</a></li>
                     </ul>
                  </div>
               </div>
            </div><a id="SBYDB5041"></a><a id="SBYDB00710"></a><div class="props_rev_3"><a id="GUID-0682EE24-B495-48E8-9E1F-52AC0E6FE486" name="GUID-0682EE24-B495-48E8-9E1F-52AC0E6FE486"></a><h3 id="SBYDB-GUID-0682EE24-B495-48E8-9E1F-52AC0E6FE486" class="sect3"><span class="enumeration_section">10.6</span>监控主备用，物理备用和快照备用数据库</h3>
               <div>
                  <p>此表汇总了常见的主数据库管理操作以及在何处查找与这些操作相关的信息。</p>
                  <div class="tblformalwide" id="GUID-0682EE24-B495-48E8-9E1F-52AC0E6FE486__G1041815">
                     <p class="titleintable">表10-2有关公共主数据库管理操作的信息源</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="有关常见主数据库管理操作的信息来源" width="100%" border="1" summary="This 3 column table summarizes the common events that occur on the primary database and pointers to the files and view where you can monitor these events on the primary and standby sites." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="35%" id="d21041e4835">主要数据库操作</th>
                              <th align="left" valign="bottom" width="32%" id="d21041e4838">主要站点信息</th>
                              <th align="left" valign="bottom" width="33%" id="d21041e4841">备用站点信息</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e4846" headers="d21041e4835 ">
                                 <p>启用或禁用重做线程</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4846 d21041e4838 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">V $ THREAD</code></p>
                                    </li>
                                 </ul>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e4846 d21041e4841 ">
                                 <p>警报日志</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e4862" headers="d21041e4835 ">
                                 <p>显示数据库角色，保护模式，保护级别，切换状态，快速启动故障切换<a id="d21041e4865" class="indexterm-anchor"></a><a id="d21041e4869" class="indexterm-anchor"></a><a id="d21041e4873" class="indexterm-anchor"></a><a id="d21041e4877" class="indexterm-anchor"></a><a id="d21041e4881" class="indexterm-anchor"></a>信息，等等</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4862 d21041e4838 ">
                                 <p><code class="codeph">V $ DATABASE</code></p>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e4862 d21041e4841 ">
                                 <p><code class="codeph">V $ DATABASE</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e4895" headers="d21041e4835 ">
                                 <p>添加或删除重做日志文件组</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4895 d21041e4838 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">V $ LOG</code> 
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">V$LOGFILE</code> <code class="codeph">STATUS</code>列</p>
                                    </li>
                                 </ul>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e4895 d21041e4841 ">
                                 <p>警报日志</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e4919" headers="d21041e4835 ">
                                 <p><code class="codeph">创建CONTROLFILE</code></p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4919 d21041e4838 ">
                                 <p>警报日志</p>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e4919 d21041e4841 ">
                                 <p>警报日志</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e4930" headers="d21041e4835 ">
                                 <p>监控重做申请</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4930 d21041e4838 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">V $ ARCHIVE_DEST_STATUS</code></p>
                                    </li>
                                 </ul>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e4930 d21041e4841 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">V $ ARCHIVED_LOG</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">V $ LOG_HISTORY</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">V $ MANAGED_STANDBY</code></p>
                                    </li>
                                 </ul>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e4960" headers="d21041e4835 ">
                                 <p><a id="d21041e4962" class="indexterm-anchor"></a><a id="d21041e4966" class="indexterm-anchor"></a><a id="d21041e4970" class="indexterm-anchor"></a>更改表空间状态</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4960 d21041e4838 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">V $ RECOVER_FILE</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">DBA_TABLESPACES</code></p>
                                    </li>
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                 </ul>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e4960 d21041e4841 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">V $ RECOVER_FILE</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">DBA_TABLESPACES</code></p>
                                    </li>
                                 </ul>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e4997" headers="d21041e4835 ">
                                 <p><a id="d21041e4999" class="indexterm-anchor"></a>添加或删除数据文件或表空间</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e4997 d21041e4838 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">DBA_DATA_FILES</code> 
                                       </p>
                                    </li>
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                 </ul>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e4997 d21041e4841 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">V $ DATAFILE</code></p>
                                    </li>
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                 </ul>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e5024" headers="d21041e4835 ">
                                 <p>重命名数据文件</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e5024 d21041e4838 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">V $ DATAFILE</code></p>
                                    </li>
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                 </ul>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e5024 d21041e4841 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">V $ DATAFILE</code></p>
                                    </li>
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                 </ul>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e5046" headers="d21041e4835 ">
                                 <p>未记录或不可恢复的操作</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e5046 d21041e4838 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">V $ DATAFILE</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">V $ DATABASE</code> 
                                       </p>
                                    </li>
                                 </ul>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e5046 d21041e4841 ">
                                 <p>警报日志</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e5064" headers="d21041e4835 ">
                                 <p>监控重做传输</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e5064 d21041e4838 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">V $ ARCHIVE_DEST_STATUS</code> 
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">V $ ARCHIVED_LOG</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">V $ ARCHIVE_DEST</code></p>
                                    </li>
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                 </ul>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e5064 d21041e4841 ">
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">V $ ARCHIVED_LOG</code></p>
                                    </li>
                                    <li>
                                       <p>警报日志</p>
                                    </li>
                                 </ul>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e5095" headers="d21041e4835 ">
                                 <p>发出<code class="codeph">OPEN RESETLOGS</code>或<code class="codeph">CLEAR UNARCHIVED LOGFILES</code>语句</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e5095 d21041e4838 ">
                                 <p>警报日志</p>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e5095 d21041e4841 ">
                                 <p>警报日志</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="35%" id="d21041e5112" headers="d21041e4835 ">
                                 <p>更改初始化参数</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d21041e5112 d21041e4838 ">
                                 <p>警报日志</p>
                              </td>
                              <td align="left" valign="top" width="33%" headers="d21041e5112 d21041e4841 ">
                                 <p>警报日志</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="SBYDB00555"></a><div class="props_rev_3"><a id="GUID-567E9883-B1BE-431D-86E9-872BAB6A899F" name="GUID-567E9883-B1BE-431D-86E9-872BAB6A899F"></a><h4 id="SBYDB-GUID-567E9883-B1BE-431D-86E9-872BAB6A899F" class="sect4"><span class="enumeration_section">10.6.1</span>使用视图监控主，物理和快照备用数据库</h4>
                  <div>
                     <p>您可以使用动态性能视图来监视主数据库，物理备用数据库和快照备用数据库。</p>
                     <p></p>
                     <p>讨论了以下动态性能视图：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-BCAA4A5D-8A26-434D-B2E9-291BF7FC147D" title="您可以使用V $ DATABASE视图显示有关数据保护，切换状态和快速启动故障切换状态的信息。">V $ DATABASE</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-31B49D22-414F-4802-9A48-8D8C55CD8CB6" title="您可以使用V $ MANAGED_STANDBY视图查询物理备用数据库上的重做应用和重做传输状态。">V $ MANAGED_STANDBY</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-E97EB4D8-48E0-4355-A878-9CA3E80C0AE8" title="您可以使用V $ ARCHIVED_LOG视图查询有关物理或快照备用数据库从主数据库接收的归档重做日志文件的信息。">V $ ARCHIVED_LOG</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-6FF2CE1A-C0D8-4821-BF75-B219F9AA283A" title="您可以使用V $ LOG_HISTORY视图查询存档的日志历史信息。">V $ LOG_HISTORY</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-F60AAF04-10FE-4568-BA5E-792D150FEA28" title="您可以使用V $ DATAGUARD_STATUS视图显示由Oracle Data Guard事件生成的消息，这些消息会将消息写入警报日志或服务器进程跟踪文件。">V $ DATAGUARD_STATUS</a> 
                           </p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-physical-standby-databases.html#GUID-0DA8663E-65C4-47EB-8D47-4712F8201646" title="您可以查询V $ ARCHIVE_DEST视图以显示每个重做传输目标的状态，以及作为备用数据库的重做传输目标，查询在该备用数据库上应用的最后一个主数据库重做的SCN。">V $ ARCHIVE_DEST</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-567E9883-B1BE-431D-86E9-872BAB6A899F__GUID-3E3D74E6-09CE-4E23-A3F6-E79BD9A8CB73">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=REFRN003" target="_blank"><span class="italic">Oracle数据库参考</span></a>有关视图的完整参考信息</p>
                     </div>
                  </div><a id="SBYDB4796"></a><div class="props_rev_3"><a id="GUID-BCAA4A5D-8A26-434D-B2E9-291BF7FC147D" name="GUID-BCAA4A5D-8A26-434D-B2E9-291BF7FC147D"></a><h5 id="SBYDB-GUID-BCAA4A5D-8A26-434D-B2E9-291BF7FC147D" class="sect5"><span class="enumeration_section">10.6.1.1</span> V $ DATABASE</h5>
                     <div>
                        <p>您可以使用<code class="codeph">V$DATABASE</code>视图显示有关数据保护，切换状态和快速启动故障切换状态的信息。
                        </p>
                        <div class="section">
                           <p>以下查询显示主，物理备用数据库或快照备用数据库的数据保护模式，数据保护级别，数据库角色和切换状态：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT PROTECTION_MODE，PROTECTION_LEVEL， - &gt; DATABASE_ROLE ROLE，SWITCHOVER_STATUS  - &gt; FROM V $ DATABASE;</pre><p>以下查询显示快速启动故障转移状态：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT FS_FAILOVER_STATUS“FSFO STATUS”， - &gt; FS_FAILOVER_CURRENT_TARGET TARGET， - &gt; FS_FAILOVER_THRESHOLD THRESHOLD， - &gt; FS_FAILOVER_OBSERVER_PRESENT“OBSERVER PRESENT” - &gt; FROM V $ DATABASE;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-3B82374E-5646-4029-8AD3-94BAE5FCB17D" name="GUID-3B82374E-5646-4029-8AD3-94BAE5FCB17D"></a><h5 id="SBYDB-GUID-3B82374E-5646-4029-8AD3-94BAE5FCB17D" class="sect5"><span class="enumeration_section">10.6.1.2</span> V $ DATAGUARD_PROCESS</h5>
                     <div>
                        <p><code class="codeph">V$DATAGUARD_PROCESS</code>视图为当前正在运行的每个Oracle Data Guard进程显示一行。
                        </p>
                        <div class="section">
                           <p><code class="codeph">V$DATAGUARD_PROCESS</code>视图替换了自Oracle Database 12 <span class="italic">c</span>第2版（12.2.0.1）以来不推荐使用的<code class="codeph">V$MANAGED_STANDBY</code>视图，并且可能在将来的版本中被取消支持。
                           </p>
                           <p>以下是此视图的示例查询：</p><pre class="pre codeblock"><code>SQL&gt; SELECT ROLE，THREAD＃，SEQUENCE＃，来自V $ DATAGUARD_PROCESS的行动;角色＃SEQUENCE＃ACTION ------------------------ ---------- ---------- ------------ RFS ping 1 9 IDLE恢复应用slave 0 0 IDLE恢复应用slave 0 0 IDLE managed recovery 0 0 IDLE recovery logmerger 1 9 APPLYING_LOG RFS archive 0 0 IDLE RFS async 1 9 IDLE</code></pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="SBYDB4797"></a><div class="props_rev_3"><a id="GUID-31B49D22-414F-4802-9A48-8D8C55CD8CB6" name="GUID-31B49D22-414F-4802-9A48-8D8C55CD8CB6"></a><h5 id="SBYDB-GUID-31B49D22-414F-4802-9A48-8D8C55CD8CB6" class="sect5"><span class="enumeration_section">10.6.1.3</span> V $ MANAGED_STANDBY</h5>
                     <div>
                        <p>您可以使用<code class="codeph">V$MANAGED_STANDBY</code>视图查询物理备用数据库上的重做应用和重做传输状态。
                        </p>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-31B49D22-414F-4802-9A48-8D8C55CD8CB6__GUID-B0B998B8-1652-41E3-A45D-8694F2AE5279">
                              <p class="notep1">注意：</p>从Oracle Database 12 <span class="italic">c</span>第2版（12.2.0.1）开始，不推荐使用此视图，并且可能在将来的版本中不支持该视图。应该使用<code class="codeph">V$DATAGUARD_PROCESS</code>视图。
                           </div>
                           <p>以下是<code class="codeph">V$MANAGED_STANDBY</code>视图的示例查询：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT PROCESS，STATUS，THREAD＃，SEQUENCE＃， - &gt; BLOCK＃，BLOCKS FROM V $ MANAGED_STANDBY; PROCESS STATUS THREAD＃SEQUENCE＃BLOCK＃BLOCKS ------- ------------ ---------- ----------- -------- ---------- RFS ATTACHED 1 947 72 72 MRP0 APPLYING_LOG 1 946 10 72</pre><p>示例输出显示远程文件服务器（RFS）进程已完成归档序列号为947的重做日志文件，并且Redo Apply正在主动应用序列号为946的归档重做日志文件。Redo Apply当前正在恢复72块存档重做日志文件的第10块。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="SBYDB4798"></a><div class="props_rev_3"><a id="GUID-E97EB4D8-48E0-4355-A878-9CA3E80C0AE8" name="GUID-E97EB4D8-48E0-4355-A878-9CA3E80C0AE8"></a><h5 id="SBYDB-GUID-E97EB4D8-48E0-4355-A878-9CA3E80C0AE8" class="sect5"><span class="enumeration_section">10.6.1.4</span> V $ ARCHIVED_LOG</h5>
                     <div>
                        <p>您可以使用<code class="codeph">V$ARCHIVED_LOG</code>视图查询有关物理或快照备用数据库从主数据库接收的归档重做日志文件的信息。
                        </p>
                        <div class="section">
                           <p>例如，发出以下查询：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT THREAD＃，SEQUENCE＃，FIRST_CHANGE＃， - &gt; NEXT_CHANGE＃FROM V $ ARCHIVED_LOG; THREAD＃SEQUENCE＃FIRST_CHANGE＃NEXT_CHANGE＃---------- ---------- ------------- --------- --- 1 945 74651 74739 1 946 74739 74772 1 947 74772 74795</pre><p>示例输出显示已从主数据库接收到三个归档重做日志文件。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="SBYDB4799"></a><div class="props_rev_3"><a id="GUID-6FF2CE1A-C0D8-4821-BF75-B219F9AA283A" name="GUID-6FF2CE1A-C0D8-4821-BF75-B219F9AA283A"></a><h5 id="SBYDB-GUID-6FF2CE1A-C0D8-4821-BF75-B219F9AA283A" class="sect5"><span class="enumeration_section">10.6.1.5</span> V $ LOG_HISTORY</h5>
                     <div>
                        <p>您可以使用<code class="codeph">V$LOG_HISTORY</code>视图查询存档的日志历史信息。
                        </p>
                        <div class="section">
                           <p>例如，发出以下查询：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT THREAD＃，SEQUENCE＃，FIRST_CHANGE＃， - &gt; NEXT_CHANGE＃FROM V $ LOG_HISTORY;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="SBYDB4800"></a><div class="props_rev_3"><a id="GUID-F60AAF04-10FE-4568-BA5E-792D150FEA28" name="GUID-F60AAF04-10FE-4568-BA5E-792D150FEA28"></a><h5 id="SBYDB-GUID-F60AAF04-10FE-4568-BA5E-792D150FEA28" class="sect5"><span class="enumeration_section">10.6.1.6</span> V $ DATAGUARD_STATUS</h5>
                     <div>
                        <p>您可以使用<code class="codeph">V$DATAGUARD_STATUS</code>视图显示由Oracle Data Guard事件生成的消息，这些消息会将消息写入警报日志或服务器进程跟踪文件。
                        </p>
                        <div class="section">
                           <p>例如，发出以下查询：</p><pre class="oac_no_warn" dir="ltr">SQL&gt;从V $ DATAGUARD_STATUS中选择消息;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="SBYDB5131"></a><div class="props_rev_3"><a id="GUID-0DA8663E-65C4-47EB-8D47-4712F8201646" name="GUID-0DA8663E-65C4-47EB-8D47-4712F8201646"></a><h5 id="SBYDB-GUID-0DA8663E-65C4-47EB-8D47-4712F8201646" class="sect5"><span class="enumeration_section">10.6.1.7</span> V $ ARCHIVE_DEST</h5>
                     <div>
                        <p>您可以查询<code class="codeph">V$ARCHIVE_DEST</code>视图以显示每个重做传输目标的状态，以及作为备用数据库的重做传输目标，查询在该备用数据库上应用的最后一个主数据库重做的SCN。
                        </p>
                        <div class="section">
                           <p>例如，发出以下查询：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT DEST_ID，STATUS，APPLIED_SCN来自V $ ARCHIVE_DEST WHERE TARGET ='STANDBY'; DEST_ID状态APPLIED_SCN ---------- --------- ----------- 2有效439054 3有效439054</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-45D7D60E-ED0F-4B3E-9D32-EB5394196CAF" name="GUID-45D7D60E-ED0F-4B3E-9D32-EB5394196CAF"></a><h3 id="SBYDB-GUID-45D7D60E-ED0F-4B3E-9D32-EB5394196CAF" class="sect3"><span class="enumeration_section">10.7</span>将还原点从主节点复制到备用节点</h3>
               <div>
                  <p>在主数据库上创建的还原点会自动复制到备用数据库。在备用数据库上创建的还原点称为<span class="italic">复制还原点</span> 。无论主数据库上的还原点是保证还原点还是正常还原点，相应的复制还原点始终是正常还原点。
                  </p>
                  <div class="section">
                     <p></p>
                     <p>满足以下条件时，Oracle数据库会自动将还原点从主数据库复制到备用数据库：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>主数据库和备用数据库的<code class="codeph">COMPATIBLE</code>初始化参数设置为19.0.0或更高</p>
                        </li>
                        <li>
                           <p>主数据库已打开</p>
                           <p>不复制主数据库处于装载模式时在主数据库上创建的还原点。此限制是因为通过重做复制还原点信息。</p>
                        </li>
                     </ul>
                     <p>复制还原点的命名约定使用后缀为<code class="codeph">_PRIMARY</code>的主数据库上的还原点的名称。如果备用数据库上存在具有相同名称的复制还原点，则不会创建复制还原点。例如，在主数据库上创建名为<code class="codeph">PRE_MYTBS</code>的还原点时，复制的还原点名为<code class="codeph">PRE_MYTBS_PRIMARY</code> 。删除主服务器上的还原点时，也会删除备用服务器上相应的复制还原点。
                     </p>
                     <p>托管重做进程（MRP）管理复制还原点的创建和维护。如果在MRP未运行时在主数据库上创建还原点，则在MRP启动后，这些还原点将复制到备用数据库。</p>
                     <p>要确定是否自动复制还原点，请查询<code class="codeph">V$RESTORE_POINT</code>视图。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="SBYDB00580"></a><div class="props_rev_3"><a id="GUID-EEDAC95A-828F-4117-AF57-D8ABA702D42D" name="GUID-EEDAC95A-828F-4117-AF57-D8ABA702D42D"></a><h3 id="SBYDB-GUID-EEDAC95A-828F-4117-AF57-D8ABA702D42D" class="sect3"><span class="enumeration_section">10.8</span>调整重做应用</h3>
               <div>
                  <p>Oracle白皮书可用于描述如何优化Redo Apply和介质恢复性能。</p>
                  <div class="section">
                     <p>特别是，请参阅<span class="italic">Active Data Guard 11g最佳实践（包括重做应用的最佳实践</span> ）。本文可在Oracle最高可用性架构（MAA）主页上找到：</p>
                     <p><a href="http://www.oracle.com/goto/maa" target="_blank"><code class="codeph">http://www.oracle.com/goto/maa</code></a></p>
                     <div class="infoboxnotealso" id="GUID-EEDAC95A-828F-4117-AF57-D8ABA702D42D__GUID-2E8E7259-7176-41AE-BE0D-634D21CF95F9">
                        <p class="notep1">也可以看看：</p>
                        <p>有关安装和使用备用Statspack的信息，请访问<a href="http://support.oracle.com" target="_blank"><code class="codeph">http://support.oracle.com</code></a> My Oracle Support说明454848.1，该备用Statspack可用于从物理备用数据库收集重做应用性能数据</p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-2FF52A94-828C-4BF1-A5D0-C70A05A8198A" name="GUID-2FF52A94-828C-4BF1-A5D0-C70A05A8198A"></a><h3 id="SBYDB-GUID-2FF52A94-828C-4BF1-A5D0-C70A05A8198A" class="sect3"><span class="enumeration_section">10.9</span>使用SQL Tuning Advisor在Active Data Guard环境中调整数据库</h3>
               <div>
                  <p>在Active Data Guard环境中，SQL Tuning Advisor可以调整主数据库上的备用工作负载。</p>
                  <p>使用数据库链接，您可以在一个数据库上发出SQL Tuning Advisor语句，但在不同的数据库上执行这些语句。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-2FF52A94-828C-4BF1-A5D0-C70A05A8198A__GUID-4B558346-AB4D-443C-BDC3-CA745378A8CE">调整主数据库上的备用数据库工作负载</p>
                     <p>在某些情况下，备用数据库除了具有数据保护角色外，还可以承担报告角色。备用数据库可以有自己的查询工作负载，其中一些可能需要调优。在此方案中，您通过在备用数据库上发出每个调优语句来调整备用数据库工作负载，但SQL Tuning Advisor通过使用备用数据库到主数据库链接在主数据库上执行其分析。</p>
                     <p>以下是调整主数据库上的备用数据库工作负载必须执行的任务。必须使用<code class="codeph">DBMS_SQLTUNE</code> PL / SQL包以给定的顺序在备用数据库中执行任务：</p>
                     <ol>
                        <li>
                           <p>执行<code class="codeph">DBMS_SQLTUNE.CREATE_TUNING_TASK</code>语句以从创建任务所需的主数据库中获取数据。由于备用数据库是只读数据库，因此有关该任务的数据将远程写入主数据库。此步骤中需要数据库链接参数才能写入主数据库。（数据库链接参数在后续步骤中是可选的，因为它与此步骤中创建的任务相关联。）
                           </p>
                        </li>
                        <li>
                           <p>执行<code class="codeph">DBMS_SQLTUNE.EXECUTE_TUNING_TASK</code>语句。最初，从远程主数据库获取执行任务所需的数据。执行调整分析过程以找到可能的建议。由于备用数据库是只读数据库，因此当结果可用时，它们将远程存储在主数据库中。
                           </p>
                        </li>
                        <li>
                           <p>执行<code class="codeph">DBMS_SQLTUNE.REPORT_TUNING_TASK</code>语句。构建报告所需的数据远程存储在主数据库中。数据从主数据库远程获取，并在备用数据库本地构建。
                           </p>
                        </li>
                        <li>
                           <p>执行<code class="codeph">DBMS_SQLTUNE.ACCEPT_SQL_PROFILE</code>语句。配置文件数据将写入远程主数据库，因为备用数据库是只读的。
                           </p>
                        </li>
                        <li>
                           <p>使用重做应用可在备用数据库中使用SQL配置文件。</p>
                        </li>
                     </ol>
                     <div class="infoboxnotealso" id="GUID-2FF52A94-828C-4BF1-A5D0-C70A05A8198A__ORACLEDATABASEPLSQLPACKAGESANDTYPES-306A7537">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">DBMS_SQLTUNE</code>包的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=ARPLS-GUID-421606DC-588B-4BCD-8ED8-192F8B93C070" target="_blank"><span><cite>参见Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关本地和远程SQL调优的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sbydb&amp;id=TGSQL-GUID-642877C5-40BE-4736-8302-17F849933038" target="_blank"><span><cite>参见“Oracle数据库SQL调优指南”</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-1E2A26E3-B0E2-4ED1-A50D-891505C86E7D" name="GUID-1E2A26E3-B0E2-4ED1-A50D-891505C86E7D"></a><h3 id="SBYDB-GUID-1E2A26E3-B0E2-4ED1-A50D-891505C86E7D" class="sect3"><span class="enumeration_section">10.10</span>使用Oracle Diagnostic Pack调整Oracle Active Data Guard Standbys</h3>
               <div>
                  <p>Oracle Diagnostic Pack可与以只读模式打开的Oracle Active Data Guard备用数据库一起使用。</p>
                  <p>这使您可以将性能数据捕获到Oracle Active Data Guard备用数据库的自动工作负载存储库（AWR），并对AWR数据运行自动数据库诊断监视器（ADDM）分析。有关如何执行这些操作的详细信息，请参见“ <a href="../tgdba/gathering-database-statistics.html#TGDBA-GUID-309C107F-DC42-4119-9904-9504E9748B84" target="_blank"><span><cite>Oracle数据库性能调整指南”</cite></span></a> 。
                  </p>
               </div>
            </div><a id="SBYDB4801"></a><div class="props_rev_3"><a id="GUID-CE30E2D6-5B53-4389-8B02-FC0F341C8C1A" name="GUID-CE30E2D6-5B53-4389-8B02-FC0F341C8C1A"></a><h3 id="SBYDB-GUID-CE30E2D6-5B53-4389-8B02-FC0F341C8C1A" class="sect3"><span class="enumeration_section">10.11</span>管理快照备用数据库</h3>
               <div>
                  <p>快照备用数据库是完全可更新的备用数据库。它从主数据库接收和归档重做数据，但不应用它。</p>
                  <p>在丢弃对快照备用数据库的所有本地更新之后，将快照备用数据库转换回物理备用数据库时，将应用从主数据库接收的重做数据。</p>
                  <p>快照备用数据库通常会随着时间的推移而偏离其主数据库，因为主数据库中的重做数据在接收时未应用。快照备用数据库的本地更新会导致其他分歧。但是，主数据库中的数据受到完全保护，因为可以随时将快照备用数据库转换回物理备用数据库，然后应用从主数据库接收的重做数据。</p>
                  <p>快照备用数据库提供与物理备用数据库类似的灾难恢复和数据保护优势。快照备用数据库最适用于具有主数据库的临时可更新快照的好处证明增加从主数据库故障中恢复的时间的情况。</p>
               </div><a id="SBYDB00708"></a><div class="props_rev_3"><a id="GUID-63245504-B67C-4DF2-B8E5-752C0A67FEE7" name="GUID-63245504-B67C-4DF2-B8E5-752C0A67FEE7"></a><h4 id="SBYDB-GUID-63245504-B67C-4DF2-B8E5-752C0A67FEE7" class="sect4"><span class="enumeration_section">10.11.1</span>将物理备用数据库转换为快照备用数据库</h4>
                  <div>
                     <p>这些步骤描述了如何将物理备用数据库转换为快照备用数据库。</p>
                     <ol>
                        <li class="stepexpand"><span>停止重做应用，如果它处于活动状态。</span></li>
                        <li class="stepexpand"><span>确保已装入数据库，但未打开。</span></li>
                        <li class="stepexpand"><span>确保已配置快速恢复区域。闪回数据库不必启用。</span></li>
                        <li class="stepexpand"><span>发出以下SQL语句以执行转换：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE CONVERT TO SNAPSHOT STANDBY;</pre></div>
                        </li>
                        <li class="stepexpand"><span>通过发出以下SQL语句以读/写模式打开快照备用数据库：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE OPEN READ WRITE;</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-63245504-B67C-4DF2-B8E5-752C0A67FEE7__GUID-FF284DA9-3522-4C06-B43A-BC3DAEC9D610">
                           <p class="notep1">注意：</p>
                           <p>可以使用DGMGRL或Oracle Enterprise Manager云控制将Oracle Data Guard代理管理的物理备用数据库转换为快照备用数据库。有关更多详细信息，请参阅<a href="../dgbkr/examples-using-data-guard-broker-DGMGRL-utility.html#DGBKR3432" target="_blank"><span class="italic">Oracle Data Guard Broker</span></a> 。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="SBYDB4802"></a><div class="props_rev_3"><a id="GUID-C1C48B71-88F5-4006-9CAE-0FD040888FAE" name="GUID-C1C48B71-88F5-4006-9CAE-0FD040888FAE"></a><h4 id="SBYDB-GUID-C1C48B71-88F5-4006-9CAE-0FD040888FAE" class="sect4"><span class="enumeration_section">10.11.2</span>使用快照备用数据库</h4>
                  <div>
                     <p>快照备用数据库可以在读写模式下打开，并且可以完全更新。</p>
                     <p>快照备用数据库具有以下特征：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>快照备用数据库不能成为切换或故障转移的目标。在执行角色转换之前，必须首先将快照备用数据库转换回物理备用数据库。</p>
                        </li>
                        <li>
                           <p>快照备用数据库不能是Maximum Protection Oracle Data Guard配置中的唯一备用数据库。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-C1C48B71-88F5-4006-9CAE-0FD040888FAE__GUID-F3C6A814-7DDC-483D-A89D-D14D70BC5C37">
                        <p class="notep1">注意：</p>
                        <p>闪回数据库用于将快照备用数据库转换回物理备用数据库。使用闪回数据库技术无法撤消的任何操作都会阻止快照备用数据库转换回物理备用数据库。</p>
                        <p>有关闪回数据库的某些限制的信息，请参阅“ <a href="../bradv/using-flasback-database-restore-points.html#BRADV543" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南”</span></a> 。
                        </p>
                     </div>
                  </div>
               </div><a id="SBYDB4803"></a><div class="props_rev_3"><a id="GUID-36B87563-A971-43B4-8320-52BBA27EE749" name="GUID-36B87563-A971-43B4-8320-52BBA27EE749"></a><h4 id="SBYDB-GUID-36B87563-A971-43B4-8320-52BBA27EE749" class="sect4"><span class="enumeration_section">10.11.3</span>将快照备用数据库转换为物理备用数据库</h4>
                  <div>
                     <p>这些步骤描述了如何将快照备用数据库转换为物理备用数据库。</p>
                     <ol>
                        <li class="stepexpand"><span>在Oracle Real Applications Cluster（Oracle RAC）数据库上，关闭除一个实例之外的所有实例。</span></li>
                        <li class="stepexpand"><span>确保已装入数据库，但未打开。</span></li>
                        <li class="stepexpand"><span>发出以下SQL语句以执行转换：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DATABASE CONVERT TO PHYSICAL STANDBY;</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>启动Redo Apply时，将自动应用数据库为快照备用数据库时收到的重做数据。</p>
                        <div class="infoboxnote" id="GUID-36B87563-A971-43B4-8320-52BBA27EE749__GUID-5BA3A087-383B-437B-8A12-B8FE1DD9CAE1">
                           <p class="notep1">注意：</p>
                           <p>快照备用数据库必须至少以读写模式打开一次，然后才能转换为物理备用数据库。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="12674.oracle-data-pump-overview.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Oracle Data Pump technology enables very high-speed movement of data and metadata from one database to another."></meta>
      <meta name="description" content="Oracle Data Pump technology enables very high-speed movement of data and metadata from one database to another."></meta>
      <title>Oracle Data Pump概述</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Utilities "></meta>
      <meta property="og:description" content="Oracle Data Pump technology enables very high-speed movement of data and metadata from one database to another."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Utilities"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-utilities.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-23T19:07:17-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96081-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="oracle-data-pump.html" title="Previous" type="text/html"></link>
      <link rel="next" href="oracle-data-pump-export-utility.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Utilities"></meta>
    <meta name="dcterms.isVersionOf" content="SUTIL"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-data-pump.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="oracle-data-pump-export-utility.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">公用事业</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-data-pump.html" property="item" typeof="WebPage"><span property="name">Oracle Data Pump</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle Data Pump概述</li>
            </ol>
            <a id="GUID-17FAE261-0972-4220-A2E4-44D479F519D4" name="GUID-17FAE261-0972-4220-A2E4-44D479F519D4"></a><a id="SUTIL100"></a>
            
            <h2 id="SUTIL-GUID-17FAE261-0972-4220-A2E4-44D479F519D4" class="sect2"><span class="enumeration_chapter">1</span> Oracle Data Pump概述</h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。</p>
               <p>了解以下主题可帮助您最大限度地成功使用Oracle Data Pump：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-47B26B0B-3C95-4182-ACDF-2EEDD577FC9E">Oracle数据泵组件</a><br>Oracle Data Pump由三个不同的组件组成：命令行客户端， <code class="codeph">expdp</code>和<code class="codeph">impdp</code> ; <code class="codeph">DBMS_DATAPUMP</code> PL / SQL包（也称为Data Pump API）;和<code class="codeph">DBMS_METADATA</code> PL / SQL包（也称为Metadata API）。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-3F418F02-5FE2-455A-B5AD-C1910DB3B5E0">数据泵如何移动数据？</a><br>您可以使用多种Oracle Data Pump方法将数据移入和移出数据库。您可以选择最适合您的用例的方法。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-45B17B65-20F2-4128-9A39-B1B0F5E323BB">使用带有CDB的Oracle数据泵</a><br>Oracle Data Pump可以将数据库的全部或部分从非CDB迁移到PDB，在相同或不同CDB中的PDB之间，以及从PDB迁移到非CDB。</li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-8B6975D3-3BEC-4584-B416-280125EEC57E">数据泵导出和导入操作所需的角色</a><br>许多数据泵导出和导入操作要求用户具有<code class="codeph">DATAPUMP_EXP_FULL_DATABASE</code>角色或<code class="codeph">DATAPUMP_IMP_FULL_DATABASE</code>角色，或两者都具有。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-6BDC1CC8-8596-402D-B016-602985B97AB6">在执行Oracle数据泵作业期间会发生什么？</a><br>Oracle Data Pump作业使用主表，主进程和工作进程来执行工作并跟踪进度。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-E365D74E-12CD-495C-BA23-5A55F679C7E7">监控工作状态</a><br>Oracle Data Pump导出和导入客户端实用程序可以以日志记录模式或交互式命令模式附加到作业。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-A4C5E6C1-28DE-45AF-B90C-B7FEEFF62069">监控执行工作的进度</a><br>要监视表数据传输，可以使用<code class="codeph">V$SESSION_LONGOPS</code>动态性能视图来监视Oracle Data Pump作业。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-FE7E746D-A343-463E-A4E2-A6AD1349FE4B">文件分配</a><br>Oracle Data Pump管理几种不同类型的文件。您可以在交互模式下使用命令来修改OracleData Pump分配和处理这些文件的方式。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-BAA3B679-A758-4D55-9820-432D9EB83C68">在不同的Oracle数据库版本之间导出和导入</a><br>您可以使用Oracle Data Pump在不同版本的数据库软件之间迁移Oracle数据库的全部或任何部分。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-9030BC32-193B-4455-8DBB-4271DD44FA7A">SecureFiles LOB注意事项</a><br>使用Oracle Data Pump Export导出SecureFiles LOB时，导出行为取决于多种因素，包括Export <code class="codeph">VERSION</code>参数值，是否存在ContentType，以及是否存档LOB以及是否缓存数据。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-34D0DEE7-3530-42DC-BE01-C2588CC73CE5">Oracle Data Pump退出代码</a><br>您可以在日志文件和进程退出代码中查看Oracle Data Pump导出和导入操作结果。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-4443B80B-0446-4010-B8CA-2524659516BC">审核数据泵作业</a><br>要监视和记录特定的用户数据库操作，请使用统一审计对Data Pump作业执行审计。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-7EE60BAB-0D3D-46EB-8E11-4FDDA68EF14E">数据泵如何处理时间戳数据？</a><br>本节介绍可能影响成功完成导出和导入作业的因素，这些作业涉及时间戳数据类型<code class="codeph">TIMESTAMP WITH TIMEZONE</code>和<code class="codeph">TIMESTAMP WITH LOCAL TIMEZONE</code> 。</li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-72F01BF0-61F5-4775-8C7B-4E227F244866">字符集和全球化支持注意事项</a><br>数据泵导出和导入的全球化支持行为。
                  </li>
                  <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-B1A6BBA2-0269-48CC-8A0E-8E3955A231C0">具有数据绑定排序规则的Oracle数据泵行为</a><br>Oracle Data Pump支持数据绑定归类（DBC）。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="oracle-data-pump.html#GUID-501A9908-BCC5-434C-8853-9A6096766B5A">Oracle Data Pump</a></p>
                  </div>
               </div>
            </div>
            <a id="SUTIL801"></a><div class="props_rev_3"><a id="GUID-47B26B0B-3C95-4182-ACDF-2EEDD577FC9E" name="GUID-47B26B0B-3C95-4182-ACDF-2EEDD577FC9E"></a><h3 id="SUTIL-GUID-47B26B0B-3C95-4182-ACDF-2EEDD577FC9E" class="sect3"><span class="enumeration_section">1.1</span> Oracle数据泵组件</h3>
               <div>
                  <p>Oracle Data Pump由三个不同的组件组成：命令行客户端， <code class="codeph">expdp</code>和<code class="codeph">impdp</code> ; <code class="codeph">DBMS_DATAPUMP</code> PL / SQL包（也称为Data Pump API）;和<code class="codeph">DBMS_METADATA</code> PL / SQL包（也称为Metadata API）。
                  </p>
                  <p>Oracle Data Pump客户端<code class="codeph">expdp</code>和<code class="codeph">impdp</code>启动Oracle Data Pump Export实用程序和Oracle Data Pump Import实用程序。
                  </p>
                  <p><code class="codeph">expdp</code>和<code class="codeph">impdp</code>客户端使用<code class="codeph">DBMS_DATAPUMP</code> PL / SQL包中提供的过程，使用在命令行输入的参数执行导出和导入命令。这些参数支持导出和导入完整数据库或数据库子集的数据和元数据。
                  </p>
                  <p>移动元数据时，Data Pump使用<code class="codeph">DBMS_METADATA</code> PL / SQL包提供的功能。<code class="codeph">DBMS_METADATA</code>包为字典元数据的提取，操作和重新创建提供了集中的工具。
                  </p>
                  <p><code class="codeph">DBMS_DATAPUMP</code>和<code class="codeph">DBMS_METADATA</code> PL / SQL包可以独立于Data Pump客户端使用。
                  </p>
                  <div class="infoboxnote" id="GUID-47B26B0B-3C95-4182-ACDF-2EEDD577FC9E__GUID-F0F71B60-F143-4EE4-B5BF-40FD1CD1A594">
                     <p class="notep1">注意：</p>
                     <p>所有Oracle Data Pump导出和导入处理（包括读取和写入转储文件）都在由指定数据库连接字符串选择的系统（服务器）上完成。<span class="bold">这意味着对于非特权用户，数据库管理员（DBA）必须为在该服务器文件系统上读取和写入的数据泵文件创建目录对象。</span> （出于安全原因，DBA必须确保只允许经过批准的用户访问目录对象。）对于特权用户，可以使用默认目录对象。
                     </p>
                  </div>
                  <p>从Oracle Database 18c开始，您可以使用Oracle Data Pump在完整或部分导出和导入操作中包含统一审计跟踪。用户界面没有变化。执行数据库的导出或导入操作时，统一审计跟踪将自动包含在Oracle Data Pump转储文件中。有关<code class="codeph">DBMS_DATAPUMP</code>和<code class="codeph">DBMS_METADATA</code>包的说明，请参见<cite>Oracle Database PL / SQL包和类型参考</cite> 。有关使用Oracle Data Pump导出和导入统一审计跟踪的信息，请参见“ <cite>Oracle数据库安全指南”</cite> 。
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="oracle-data-pump-overview.html#GUID-EEB32B50-8A00-40B0-8787-CC2C8BA05DC5" title="Data Pump是基于服务器而不是基于客户端的。相对于基于服务器的目录路径，访问转储文件，日志文件和SQL文件。">了解转储，日志和SQL文件默认位置</a></li>
                        <li><a href="../arpls/DBMS_DATAPUMP.html#ARPLS356" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a></li>
                        <li><a href="../dbseg/administering-the-audit-trail.html#DBSEG-GUID-8140CCBF-77EE-4F86-A055-B9F9AB8B4573" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="SUTIL802"></a><div class="props_rev_3"><a id="GUID-3F418F02-5FE2-455A-B5AD-C1910DB3B5E0" name="GUID-3F418F02-5FE2-455A-B5AD-C1910DB3B5E0"></a><h3 id="SUTIL-GUID-3F418F02-5FE2-455A-B5AD-C1910DB3B5E0" class="sect3"><span class="enumeration_section">1.2</span>数据泵如何移动数据？
               </h3>
               <div>
                  <p>您可以使用多种Oracle Data Pump方法将数据移入和移出数据库。您可以选择最适合您的用例的方法。</p>
                  <div class="infoboxnote" id="GUID-3F418F02-5FE2-455A-B5AD-C1910DB3B5E0__GUID-B77A4D96-BC67-431E-9C68-09DF5865A7C4">
                     <p class="notep1">注意：</p>
                     <p>Data Pump不会加载具有禁用的唯一索引的表。要将数据加载到表中，必须删除索引或重新启用索引。</p>
                  </div>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-06B2DF71-2A66-498F-B659-1EF5859B1648">使用数据文件复制移动数据</a><br>移动数据的最快方法是将数据库数据文件复制到目标数据库，而无需解释或更改数据。使用此方法，Data Pump Export用于仅将结构信息（元数据）卸载到转储文件中。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-F5790243-15A3-4932-9258-1A466985964D">使用直接路径移动数据</a><br>数据文件复制后，直接路径是移动数据的最快方法。在此方法中，绕过数据库的SQL层，并且只使用最少的解释将行移入和转出转储文件。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-EDB0DFE2-A20A-4FF6-B584-1D31583054AB">使用外部表移动数据</a><br>如果不选择数据文件复制，并且无法使用直接路径移动数据，则可以使用外部表机制。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-C746E643-C199-4746-AD16-13334734778F">使用传统路径移动数据</a><br>在存在冲突表属性的情况下，Oracle Data Pump使用传统路径来移动数据。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-3E1D4B46-E856-4ABE-ACC5-977A898BB0F1">使用网络链接导入移动数据</a><br>使用Import <code class="codeph">NETWORK_LINK</code>参数为导入操作指定网络链接时，默认使用直接路径方法。查看支持的数据库链接类型
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               <a id="SUTIL803"></a><div class="props_rev_3"><a id="GUID-06B2DF71-2A66-498F-B659-1EF5859B1648" name="GUID-06B2DF71-2A66-498F-B659-1EF5859B1648"></a><h4 id="SUTIL-GUID-06B2DF71-2A66-498F-B659-1EF5859B1648" class="sect4"><span class="enumeration_section">1.2.1</span>使用数据文件复制移动数据</h4>
                  <div>
                     <p>移动数据的最快方法是将数据库数据文件复制到目标数据库，而无需解释或更改数据。使用此方法，Data Pump Export用于仅将结构信息（元数据）卸载到转储文件中。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">TRANSPORT_TABLESPACES</code>参数用于指定可传输的表空间导出。仅导出指定表空间的元数据。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">TRANSPORTABLE=ALWAYS</code>参数在表模式导出（使用<code class="codeph">TABLES</code>参数指定）或完整模式导出（使用<code class="codeph">FULL</code>参数指定）或完整模式网络导入（使用<code class="codeph">FULL</code>和<code class="codeph">NETWORK_LINK</code>参数指定）上提供。
                           </p>
                        </li>
                     </ul>
                     <p>当导出操作使用数据文件复制时，相应的导入作业也始终使用数据文件复制。在随后的导入操作期间，必须加载数据文件和导出转储文件。</p>
                     <div class="infoboxnote" id="GUID-06B2DF71-2A66-498F-B659-1EF5859B1648__GUID-79DBB18B-5A11-4880-85B9-AA9894400F69">
                        <p class="notep1">注意：</p>
                        <p>在可传输导入期间，表空间暂时进行读/写，然后再设置为只读。Oracle Database 12 <span class="italic">c</span>第1版（12.1.0.2）引入了临时设置更改以提高性能。但请注意，此行为还会导致导入作业数据文件的SCN发生更改。更改数据文件的SCN可能会在将来可传输的这些文件导入过程中出现问题。
                        </p>
                        <p>例如，如果在表空间读/写后（即使它们现在是只读的），可传输表空间导入在任何时候都失败，那么数据文件就会损坏。<span class="italic">他们无法恢复。</span></p>
                        <p>由于可传输作业无法重新启动，因此必须从头开始重新启动失败的作业。您必须删除损坏的数据文件，并将新版本复制到目标目标。</p>
                        <p>执行可传输作业时，最佳做法是在源系统上保留数据文件的副本，直到在目标系统上成功完成导入作业。如果导入作业由于某种原因失败，则保留副本可确保您可以拥有未损坏的数据文件副本。</p>
                     </div>
                     <p>使用数据文件复制移动数据时，源数据库和目标数据库之间的字符集兼容性存在一些限制。</p>
                     <p>如果源平台和目标平台具有不同的字节顺序，则必须转换正在传输的数据，使其采用目标平台的格式。您可以使用<code class="codeph">DBMS_FILE_TRANSFER</code> PL / SQL包或<code class="codeph">RMAN</code> <code class="codeph">CONVERT</code>命令来转换数据。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-06B2DF71-2A66-498F-B659-1EF5859B1648__GUID-55F4DEF3-2F9E-4FB5-B565-39500D43E464">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关RMAN <code class="codeph">CONVERT</code>命令的信息<a href="../rcmrf/CONVERT.html#RCMRF192" target="_blank"><span><cite>，请参见Oracle数据库备份和恢复参考</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sutil&amp;id=ADMIN10140" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a> ，了解在数据库之间传输表空间的描述和示例（包括如何转换数据）</p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-3F418F02-5FE2-455A-B5AD-C1910DB3B5E0" title="您可以使用多种Oracle Data Pump方法将数据移入和移出数据库。您可以选择最适合您的用例的方法。">数据泵如何移动数据？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL2878"></a><a id="SUTIL2879"></a><a id="SUTIL804"></a><div class="props_rev_3"><a id="GUID-F5790243-15A3-4932-9258-1A466985964D" name="GUID-F5790243-15A3-4932-9258-1A466985964D"></a><h4 id="SUTIL-GUID-F5790243-15A3-4932-9258-1A466985964D" class="sect4"><span class="enumeration_section">1.2.2</span>使用直接路径移动数据</h4>
                  <div>
                     <p>数据文件复制后，直接路径是移动数据的最快方法。在此方法中，绕过数据库的SQL层，并且只使用最少的解释将行移入和转出转储文件。</p>
                     <p>除非表的结构不允许，否则Data Pump会自动使用直接路径方法来加载和卸载数据。例如，如果表包含<code class="codeph">BFILE</code>类型的列，则不能使用直接路径来加载该表，而是使用外部表。
                     </p>
                     <p>以下部分描述了直接路径不能用于加载和卸载的情况。</p>
                     <div class="section" id="GUID-F5790243-15A3-4932-9258-1A466985964D__CJAJJJBH">
                        <p class="subhead3" id="GUID-F5790243-15A3-4932-9258-1A466985964D__GUID-828E0A7A-B1DE-4F6B-8074-9B3DEE67D4B7">不使用直接路径加载的情况</p>
                        <p>如果表存在以下任何条件，则Data Pump使用外部表加载该表的数据，而不是直接路径：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>LOB列存在不是<code class="codeph">CONTEXT</code>类型索引的域索引。
                              </p>
                           </li>
                           <li>
                              <p>单分区加载期间存在多分区表的全局索引。这种情况包括分区的对象表。</p>
                           </li>
                           <li>
                              <p>表位于群集中。</p>
                           </li>
                           <li>
                              <p>在预先存在的表上有一个活动触发器。</p>
                           </li>
                           <li>
                              <p>在预先存在的表上以插入模式启用细粒度访问控制。</p>
                           </li>
                           <li>
                              <p>表包含<code class="codeph">BFILE</code>列或不透明类型的列。
                              </p>
                           </li>
                           <li>
                              <p>参考完整性约束存在于预先存在的表中。</p>
                           </li>
                           <li>
                              <p>表包含具有嵌入式opaque类型的<code class="codeph">VARRAY</code>列。
                              </p>
                           </li>
                           <li>
                              <p>该表有加密列。</p>
                           </li>
                           <li>
                              <p>导入数据的表是预先存在的表，并且至少存在以下条件之一：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有一个主动触发器</p>
                                 </li>
                                 <li>
                                    <p>该表是分区的</p>
                                 </li>
                                 <li>
                                    <p>细粒度访问控制处于插入模式</p>
                                 </li>
                                 <li>
                                    <p>存在参照完整性约束</p>
                                 </li>
                                 <li>
                                    <p>存在唯一索引</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>启用补充日志记录，并且该表至少有一个LOB列。</p>
                           </li>
                           <li>
                              <p>指定表的Data Pump命令使用<code class="codeph">QUERY</code> ， <code class="codeph">SAMPLE</code>或<code class="codeph">REMAP_DATA</code>参数。
                              </p>
                           </li>
                           <li>
                              <p>表包含具有<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据类型的列（包括<code class="codeph">VARRAY</code>列），并且导出和导入系统之间的时区数据文件的版本不同。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-F5790243-15A3-4932-9258-1A466985964D__CJAEGFIF">
                        <p class="subhead3" id="GUID-F5790243-15A3-4932-9258-1A466985964D__GUID-5936D5A5-9682-49E5-AD0F-76447AB4F3CC">不使用直接路径卸载的情况</p>
                        <p>如果表存在以下任何条件，则Data Pump使用外部表而不是直接路径来卸载数据：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>启用了<code class="codeph">SELECT</code>的细粒度访问控制。
                              </p>
                           </li>
                           <li>
                              <p>该表是一个队列表。</p>
                           </li>
                           <li>
                              <p>该表包含一个或多个<code class="codeph">BFILE</code>或opaque类型的列，或包含不透明列的对象类型。
                              </p>
                           </li>
                           <li>
                              <p>该表包含加密列。</p>
                           </li>
                           <li>
                              <p>该表包含需要升级的演进类型的列。</p>
                           </li>
                           <li>
                              <p>指定表的Data Pump命令使用<code class="codeph">QUERY</code> ， <code class="codeph">SAMPLE</code>或<code class="codeph">REMAP_DATA</code>参数。
                              </p>
                           </li>
                           <li>
                              <p>在卸载操作之前，表被更改为包含非NULL的列，并且还指定了默认值。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-3F418F02-5FE2-455A-B5AD-C1910DB3B5E0" title="您可以使用多种Oracle Data Pump方法将数据移入和移出数据库。您可以选择最适合您的用例的方法。">数据泵如何移动数据？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL805"></a><div class="props_rev_3"><a id="GUID-EDB0DFE2-A20A-4FF6-B584-1D31583054AB" name="GUID-EDB0DFE2-A20A-4FF6-B584-1D31583054AB"></a><h4 id="SUTIL-GUID-EDB0DFE2-A20A-4FF6-B584-1D31583054AB" class="sect4"><span class="enumeration_section">1.2.3</span>使用外部表移动数据</h4>
                  <div>
                     <p>如果不选择数据文件复制，并且无法使用直接路径移动数据，则可以使用外部表机制。</p>
                     <p>外部表机制创建一个外部表，该表映射到数据库表的转储文件数据。然后使用SQL引擎移动数据。如果可能，请在导入时使用<code class="codeph">APPEND</code>提示来加速将数据复制到数据库中。直接路径数据和外部表数据的数据表示在转储文件中是相同的。因为它们是相同的，Oracle Data Pump可以在导出时使用直接路径机制，但在将数据导入目标数据库时使用外部表。同样，Oracle Data Pump可以使用外部表进行导出，但使用直接路径进行导入。
                     </p>
                     <p>特别是，Oracle Data Pump可以在以下情况下使用外部表：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在有利于使用并行SQL功能的情况下加载和卸载非常大的表和分区</p>
                        </li>
                        <li>
                           <p>加载在其上定义全局或域索引的表，包括分区对象表</p>
                        </li>
                        <li>
                           <p>使用活动触发器或群集表加载表</p>
                        </li>
                        <li>
                           <p>使用加密列加载和卸载表</p>
                        </li>
                        <li>
                           <p>加载具有细粒度访问控制的表以启用插入</p>
                        </li>
                        <li>
                           <p>加载非导入操作创建的表（导入开始前表存在）</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-EDB0DFE2-A20A-4FF6-B584-1D31583054AB__GUID-A53E13CA-BB76-4558-8618-B6CC3A49F7A0">
                        <p class="notep1">注意：</p>
                        <p>当Oracle Data Pump使用外部表作为数据访问机制时，它使用<code class="codeph">ORACLE_DATAPUMP</code>访问驱动程序。但是，请注意Data Pump在使用外部表时创建的文件与使用SQL <code class="codeph">CREATE TABLE ...手动创建外部表时创建的文件不兼容<code class="codeph">CREATE TABLE ...ORGANIZATION EXTERNAL</code>声明。
                        </p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="oracle_datapump-access-driver.html#GUID-084DC623-9656-499C-885B-D8180C07704B" title="ORACLE_DATAPUMP访问驱动程序提供一组访问参数，这些参数对于ORACLE_DATAPUMP类型的外部表是唯一的。">ORACLE_DATAPUMP访问驱动程序</a></li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-EDB0DFE2-A20A-4FF6-B584-1D31583054AB__GUID-55AC5DAD-8AF7-4DC7-9AB9-60B967F73049">
                        <p class="notep1">也可以看看：</p>
                        <p>有关使用<code class="codeph">APPEND</code>提示的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sutil&amp;id=SQLRF50901" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-3F418F02-5FE2-455A-B5AD-C1910DB3B5E0" title="您可以使用多种Oracle Data Pump方法将数据移入和移出数据库。您可以选择最适合您的用例的方法。">数据泵如何移动数据？</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="SUTIL2880"></a><div class="props_rev_3"><a id="GUID-C746E643-C199-4746-AD16-13334734778F" name="GUID-C746E643-C199-4746-AD16-13334734778F"></a><h4 id="SUTIL-GUID-C746E643-C199-4746-AD16-13334734778F" class="sect4"><span class="enumeration_section">1.2.4</span>使用传统路径移动数据</h4>
                  <div>
                     <p>在存在冲突表属性的情况下，Oracle Data Pump使用传统路径来移动数据。</p>
                     <p>在存在冲突表属性的情况下，Oracle Data Pump无法使用直接路径表或外部表将数据加载到表中。在这种情况下，使用传统路径，这会影响性能。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-3F418F02-5FE2-455A-B5AD-C1910DB3B5E0" title="您可以使用多种Oracle Data Pump方法将数据移入和移出数据库。您可以选择最适合您的用例的方法。">数据泵如何移动数据？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL2881"></a><a id="SUTIL2882"></a><a id="SUTIL806"></a><div class="props_rev_3"><a id="GUID-3E1D4B46-E856-4ABE-ACC5-977A898BB0F1" name="GUID-3E1D4B46-E856-4ABE-ACC5-977A898BB0F1"></a><h4 id="SUTIL-GUID-3E1D4B46-E856-4ABE-ACC5-977A898BB0F1" class="sect4"><span class="enumeration_section">1.2.5</span>使用网络链接导入移动数据</h4>
                  <div>
                     <p>使用Import <code class="codeph">NETWORK_LINK</code>参数为导入操作指定网络链接时，默认使用直接路径方法。查看支持的数据库链接类型
                     </p>
                     <p>如果不能使用直接路径（例如，因为其中一列是<code class="codeph">BFILE</code> ），则使用SQL来使用<code class="codeph">INSERT SELECT</code>语句移动数据。（在Oracle Database 12 <span class="italic">c</span>第2版（12.2.0.1）之前，缺省情况是使用<code class="codeph">INSERT SELECT</code>语句。）<code class="codeph">SELECT</code>子句通过网络链接从远程数据库中检索数据。<code class="codeph">INSERT</code>子句使用SQL将数据插入目标数据库。没有涉及转储文件。
                     </p>
                     <p>使用Export <code class="codeph">NETWORK_LINK</code>参数为导出操作指定网络链接时，来自远程数据库的数据将写入目标数据库上的转储文件。（请注意，要从只读数据库导出，需要<code class="codeph">NETWORK_LINK</code>参数。）
                     </p>
                     <p>由于链接可以识别远程网络数据库，因此术语数据库链接和网络链接可互换使用。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-3E1D4B46-E856-4ABE-ACC5-977A898BB0F1__GUID-EB393636-DC5C-492B-879E-7FD63D84292F">支持的链接类型</p>
                        <p>支持以下类型的数据库链接与数据泵导出和导入一起使用：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>公共固定用户</p>
                           </li>
                           <li>
                              <p>公共连接用户</p>
                           </li>
                           <li>
                              <p>公共共享用户（仅在链接所有者使用时）</p>
                           </li>
                           <li>
                              <p>私人共享用户（仅在链接所有者使用时）</p>
                           </li>
                           <li>
                              <p>私人固定用户（仅在链接所有者使用时）</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3E1D4B46-E856-4ABE-ACC5-977A898BB0F1__GUID-8181A476-E862-44D4-8DEE-EE496E7C411E">不支持的链接类型</p>
                        <p>数据泵导出和导入不支持以下类型的数据库链接：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>私人连接用户</p>
                           </li>
                           <li>
                              <p>当前用户</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-3E1D4B46-E856-4ABE-ACC5-977A898BB0F1__GUID-143DC5B2-FD38-4980-BC29-6CE34E65D953">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>导出<a href="oracle-data-pump-export-utility.html#GUID-23E58D59-A477-4A87-BD0E-C82447581D0A" title="Data Pump Export命令行实用程序NETWORK_LINK参数允许从由有效数据库链接标识的（源）数据库导出。源数据库实例中的数据将写入已连接数据库实例上的转储文件集。">NETWORK_LINK</a>参数以获取有关通过数据库链接执行导出的信息</p>
                           </li>
                           <li>
                              <p>有关通过数据库链接执行导入的信息，请导入<a href="datapump-import-utility.html#GUID-0871E56B-07EB-43B3-91DA-D1F457CF6182" title="数据泵导入命令行模式NETWORK_LINK参数允许从由有效数据库链接标识的（源）数据库导入/">NETWORK_LINK</a>参数</p>
                           </li>
                           <li>
                              <p>有关创建数据库链接和不同类型链接的信息，请参见<a href="../admin/managing-a-distributed-database.html#ADMIN12150" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-3F418F02-5FE2-455A-B5AD-C1910DB3B5E0" title="您可以使用多种Oracle Data Pump方法将数据移入和移出数据库。您可以选择最适合您的用例的方法。">数据泵如何移动数据？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="SUTIL4334"></a><div class="props_rev_3"><a id="GUID-45B17B65-20F2-4128-9A39-B1B0F5E323BB" name="GUID-45B17B65-20F2-4128-9A39-B1B0F5E323BB"></a><h3 id="SUTIL-GUID-45B17B65-20F2-4128-9A39-B1B0F5E323BB" class="sect3"><span class="enumeration_section">1.3</span>使用带有CDB的Oracle数据泵</h3>
               <div>
                  <p>Oracle Data Pump可以将数据库的全部或部分从非CDB迁移到PDB，在相同或不同CDB中的PDB之间，以及从PDB迁移到非CDB。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-BD76463C-0867-477E-983F-4329610EC458">关于在多租户环境中使用数据泵</a><br>通常，将数据泵与PDB一起使用与使用非CDB的数据泵相同。</li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71">使用数据泵将数据移入CDB</a><br>创建空PDB后，可以使用Oracle Data Pump全模式导出和导入操作将数据移动到PDB中。</li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-C1578FB6-216F-473E-A6D5-18453D4F9021">使用数据泵在CDB内或之间移动PDB</a><br>PDB上的数据泵导出和导入操作与非CDB上的数据泵导出和导入操作相同，但常见用户的处理方式除外。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-BD76463C-0867-477E-983F-4329610EC458" name="GUID-BD76463C-0867-477E-983F-4329610EC458"></a><h4 id="SUTIL-GUID-BD76463C-0867-477E-983F-4329610EC458" class="sect4"><span class="enumeration_section">1.3.1</span>关于在多租户环境中使用数据泵</h4>
                  <div>
                     <p>通常，将数据泵与PDB一起使用与使用非CDB的数据泵相同。</p>
                     <p>多租户容器数据库（CDB）是一个Oracle数据库，包括零个，一个或多个用户创建的可插拔数据库（PDB）。PDB是一组可移植的模式，模式对象和非模式对象，它们在Oracle Net客户端中显示为非CDB。非CDB是不是CDB的Oracle数据库。</p>
                     <p>在以下方案中，您可以使用Data Pump迁移全部或部分数据库：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>从非CDB到PDB</p>
                        </li>
                        <li>
                           <p>在相同或不同CDB内的PDB之间</p>
                        </li>
                        <li>
                           <p>从PDB到非CDB</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-BD76463C-0867-477E-983F-4329610EC458__GUID-140B9CD4-E02E-4A16-9410-B036E8310254">
                        <p class="notep1">注意：</p>
                        <p>Data Pump不支持任何CDB范围的操作。如果您连接到CDB的根数据库或种子数据库，则Data Pump会发出以下警告：</p><pre class="pre codeblock"><code>ORA-39357：警告：连接到容器数据库的根目录或种子时，通常不需要Oracle Data Pump操作。</code></pre></div>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-45B17B65-20F2-4128-9A39-B1B0F5E323BB" title="Oracle Data Pump可以将数据库的全部或部分从非CDB迁移到PDB，在相同或不同CDB中的PDB之间，以及从PDB迁移到非CDB。">将Oracle Data Pump与CDB一起使用</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL4335"></a><div class="props_rev_3"><a id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71" name="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71"></a><h4 id="SUTIL-GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71" class="sect4"><span class="enumeration_section">1.3.2</span>使用数据泵将数据移入CDB</h4>
                  <div>
                     <p>创建空PDB后，可以使用Oracle Data Pump全模式导出和导入操作将数据移动到PDB中。</p>
                     <p>您可以使用或不使用transportable选项导入数据。如果在完整模式导出或导入时使用可传输选项，则将其称为完全可传输导出/导入。</p>
                     <p>使用可传输选项时，导出和导入使用可传输的表空间数据移动和传统的数据移动;后者用于驻留在非可传输表空间（如<code class="codeph">SYSTEM</code>和<code class="codeph">SYSAUX</code>那些表。使用transportable选项可以减少导出时间，尤其是导入时间，因为不需要卸载和重新加载表数据，也不需要重新创建用户表空间中的索引结构。
                     </p>
                     <p>使用Data Pump将数据移动到CDB时，请注意以下要求：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>要管理多租户环境，您必须具有<code class="codeph">CDB_DBA</code>角色。
                           </p>
                        </li>
                        <li>
                           <p>可以将Oracle Database 11.2.0.2及更早版本的完整数据库导出导入Oracle Database 12c（CDB或非CDB）。但是，Oracle建议您首先将源数据库升级到Oracle Database 11g第2版（11.2.0.3或更高版本），以便导出中包含有关已注册选项和组件的信息。</p>
                        </li>
                        <li>
                           <p>使用完整数据库导出或完全可传输数据库导出将Oracle Database 11g第2版（11.2.0.3或更高版本）迁移到CDB（或非CDB）时，必须将数据泵导出参数<code class="codeph">VERSION=12</code>为生成一个准备导入Oracle Database 12c的转储文件。如果未设置<code class="codeph">VERSION=12</code> ，则生成的导出文件不包含有关已注册数据库选项和组件的完整信息。
                           </p>
                        </li>
                        <li>
                           <p>基于网络的完全可传输导入需要使用<code class="codeph">FULL=YES</code> ， <code class="codeph">TRANSPORTABLE=ALWAYS</code>和<code class="codeph">TRANSPORT_DATAFILES= <span class="variable" translate="no">datafile_name</span></code>参数。当源数据库是Oracle Database 11g 11.2.0.3或更高版本，但早于Oracle Database 12c第1版（12.1）时，还需要<code class="codeph">VERSION=12</code>参数。
                           </p>
                        </li>
                        <li>
                           <p>基于文件的完全可传输导入仅需要使用<code class="codeph">TRANSPORT_DATAFILES= <span class="variable" translate="no">datafile_name</span></code>参数。数据泵导入推断出<code class="codeph">TRANSPORTABLE=ALWAYS</code>和<code class="codeph">FULL=YES</code>参数的存在。
                           </p>
                        </li>
                        <li>
                           <p>从Oracle Database 12c第2版（12.2）开始，在多租户容器数据库（CDB）环境中，默认数据泵目录对象<code class="codeph">DATA_PUMP_DIR</code>被定义为CDB中每个PDB的唯一路径。定义此唯一路径是定义<code class="codeph">CREATE PLUGGABLE DATABASE</code>语句的<code class="codeph">PATH_PREFIX</code>子句还是未定义相对路径。
                           </p>
                        </li>
                        <li>
                           <p>从Oracle Database 19c开始， <code class="codeph">impdp</code>的<code class="codeph">credential</code>参数指定凭证对象的名称，该凭证对象包含访问对象存储桶所需的用户名和密码。您还可以使用名为<code class="codeph">DEFAULT_CREDENTIAL</code>的PDB属性指定默认凭据。使用当时的默认凭据运行<code class="codeph">impdb</code>时，使用<code class="codeph">DEFAULT_CREDENTIAL:</code>为转储文件名添加前缀<code class="codeph">DEFAULT_CREDENTIAL:</code>并且不指定<code class="codeph">credential</code>参数。
                           </p>
                        </li>
                     </ul>
                     <div class="example" id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__GUID-13F8CE65-B6F4-4A75-AB27-5F6268C39C84">
                        <p class="titleinexample">示例1-1将表导入PDB</p>
                        <p>要为导出/导入操作指定特定PDB，请在启动Data Pump时在连接字符串中提供连接标识符。例如，要将数据导入名为<code class="codeph">pdb1</code>的PDB，可以在Data Pump命令行中输入以下内容：</p><pre class="pre codeblock"><code>impdp hr @ pdb1 DIRECTORY = dpump_dir1 DUMPFILE = hr.dmp TABLES =员工</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__GUID-30BBDAEB-AC3A-4672-BC72-09052CFBFB35">
                        <p class="titleinexample">示例1-2导入数据时指定凭据</p>
                        <p>此示例假定您使用<code class="codeph">DBMS_CREDENTIAL.CREATE_CREDENTIAL</code>创建了名为<code class="codeph">HR_CRED</code>的凭据，如下所示：</p><pre class="pre codeblock"><code>BEGIN DBMS_CLOUD.CREATE_CREDENTIAL（credential_name =&gt;'HR_CRED'，用户名=&gt;'atpc_user@oracle.com'，密码=&gt;' <span class="italic">密码</span> '）;结束; /</code></pre><p>以下命令指定凭证<code class="codeph">HR_CRED</code> ，并指定存储在对象库中的文件。该文件的URL是<code class="codeph">https://example.com/ostore/dnfs/myt.dmp</code> 。</p><pre class="pre codeblock"><code>impdp hr @ pdb1 \ table_exists_action = replace \ credential = HR_CRED \ parallel = 16 \ dumpfile = https://example.com/ostore/dnfs/myt.dmp</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__GUID-73EF3BB4-46CA-44E4-B67C-1DD09FC48DA3">
                        <p class="titleinexample">示例1-3使用默认凭据导入数据</p>
                        <ol id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__OL_D5V_NX3_QFB">
                           <li>
                              <p>您可以使用<code class="codeph">DBMS_CREDENTIAL.CREATE_CREDENTIAL</code>创建名为<code class="codeph">HR_CRED</code>的凭证，如下所示：</p><pre class="pre codeblock"><code>BEGIN DBMS_CLOUD.CREATE_CREDENTIAL（credential_name =&gt;'HR_CRED'，用户名=&gt;'atpc_user@oracle.com'，密码=&gt;' <span class="italic">密码</span> '）;结束; /</code></pre></li>
                           <li>
                              <p>您可以按如下方式设置PDB属性<code class="codeph">DEFAULT_CREDENTIAL</code> ：</p><pre class="pre codeblock"><code>ALTER DATABASE PROPERTY SET DEFAULT_CREDENTIAL ='ADMIN.HR_CRED'</code></pre></li>
                           <li>
                              <p>以下命令将默认凭据指定为转储文件位置的前缀<code class="codeph">https://example.com/ostore/dnfs/myt.dmp</code> ：</p><pre class="pre codeblock"><code>impdp hr @ pdb1 \ table_exists_action = replace \ parallel = 16 \ dumpfile = default_credential：https：//example.com/ostore/dnfs/myt.dmp</code></pre><p>请注意，未指定<code class="codeph">credential</code>参数。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__GUID-3144C863-B387-49F4-AEDF-010D15E4D2B1">
                        <p class="notep1">也可以看看：</p>
                        <ul id="GUID-49A847B1-3193-4C45-B7F3-B7F514B75C71__UL_BYJ_FW3_QFB" style="list-style-type:disc">
                           <li>
                              <p><a href="../dbseg/configuring-secure-sockets-layer-authentication.html#DBSEG-GUID-6AD89576-526F-4D6B-A539-ADF4B840819F" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a> ，了解如何配置SSL身份验证，这是对象存储访问所必需的</p>
                           </li>
                           <li>
                              <p><a href="datapump-import-utility.html#SUTIL-GUID-D11E340E-14C6-43B8-AB09-6335F0C1F71B" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a> ，了解如何使用Data Pump Import将文件加载到对象库</p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-45B17B65-20F2-4128-9A39-B1B0F5E323BB" title="Oracle Data Pump可以将数据库的全部或部分从非CDB迁移到PDB，在相同或不同CDB中的PDB之间，以及从PDB迁移到非CDB。">将Oracle Data Pump与CDB一起使用</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL4336"></a><div class="props_rev_3"><a id="GUID-C1578FB6-216F-473E-A6D5-18453D4F9021" name="GUID-C1578FB6-216F-473E-A6D5-18453D4F9021"></a><h4 id="SUTIL-GUID-C1578FB6-216F-473E-A6D5-18453D4F9021" class="sect4"><span class="enumeration_section">1.3.3</span>使用数据泵在CDB内或之间移动PDB</h4>
                  <div>
                     <p>PDB上的数据泵导出和导入操作与非CDB上的数据泵导出和导入操作相同，但常见用户的处理方式除外。</p>
                     <div class="section">
                        <p>如果您在CDB中创建了一个公共用户，那么该用户从CDB中的任何PDB中导出的完整数据库或特权架构将导致在导入时执行标准的<code class="codeph">CREATE USER C##common name</code> DDL语句。由于用户名上的公共用户前缀<code class="codeph">C##</code> ，该语句将失败。将返回以下错误消息：</p><pre class="pre codeblock"><code>ORA-65094：无效的本地用户或角色名称</code></pre><p>在导出的PDB中，如果已在该用户的架构中创建了本地对象并且要导入它们，则要么确保目标CDB实例中已存在同名的公共用户，要么使用数据泵导入<code class="codeph">REMAP_SCHEMA</code>参数<code class="codeph">impdp</code>命令，如下：</p><pre class="pre codeblock"><code>REMAP_SCHEMA = C ## <span class="variable" translate="no">common name:local user name</span>
</code></pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="oracle-data-pump-export-utility.html#GUID-079769D8-40F4-432F-88AD-E7264D7A2E2D" title="您可以使用数据泵通过使用FULL参数执行完整数据库导出。">完整模式</a></li>
                           <li><a href="datapump-import-utility.html#GUID-E27D2DC9-A6D8-4F0B-AB72-6BF526B3AA18" title="使用FULL参数指定完全导入。">完全导入模式</a></li>
                           <li><a href="oracle-original-export-utility.html#GUID-1EAD5074-652B-46AB-9F4B-B9902E3F2BDE" title="描述在网络上使用“导出”时要考虑的因素。">网络注意事项</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-45B17B65-20F2-4128-9A39-B1B0F5E323BB" title="Oracle Data Pump可以将数据库的全部或部分从非CDB迁移到PDB，在相同或不同CDB中的PDB之间，以及从PDB迁移到非CDB。">将Oracle Data Pump与CDB一起使用</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="SUTIL807"></a><div class="props_rev_3"><a id="GUID-8B6975D3-3BEC-4584-B416-280125EEC57E" name="GUID-8B6975D3-3BEC-4584-B416-280125EEC57E"></a><h3 id="SUTIL-GUID-8B6975D3-3BEC-4584-B416-280125EEC57E" class="sect3"><span class="enumeration_section">1.4</span>数据泵导出和导入操作所需的角色</h3>
               <div>
                  <p>许多数据泵导出和导入操作要求用户具有<code class="codeph">DATAPUMP_EXP_FULL_DATABASE</code>角色或<code class="codeph">DATAPUMP_IMP_FULL_DATABASE</code>角色，或两者都具有。
                  </p>
                  <p>运行作为数据库创建一部分的标准脚本时，将自动为Oracle数据库定义这些角色。（请注意，虽然这些角色的名称包含单词FULL，但这些角色实际上适用于任何导出或导入模式下的任何特权操作，而不仅仅是完整模式。）</p>
                  <p><code class="codeph">DATAPUMP_EXP_FULL_DATABASE</code>角色仅影响导出操作。<code class="codeph">DATAPUMP_IMP_FULL_DATABASE</code>角色影响使用Import <code class="codeph">SQLFILE</code>参数的导入操作和操作。这些角色允许用户执行导出和导入以执行以下操作：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在其架构范围之外执行操作</p>
                     </li>
                     <li>
                        <p>监视由其他用户启动的作业</p>
                     </li>
                     <li>
                        <p>导出无特权用户无法引用的对象（如表空间定义）和导入对象（如目录定义）</p>
                     </li>
                  </ul>
                  <p>这些都是强大的角色。在向用户授予这些角色时，数据库管理员应谨慎使用。</p>
                  <p>尽管<code class="codeph">SYS</code>模式没有为其分配这些角色，但Data Pump执行的所有需要这些角色的安全检查也会授予对<code class="codeph">SYS</code>模式的访问权限。
                  </p>
                  <div class="infoboxnote" id="GUID-8B6975D3-3BEC-4584-B416-280125EEC57E__GUID-51ABDCC3-9DC6-44B6-882E-7344F314E00D">
                     <p class="notep1">注意：</p>
                     <p>如果您收到<code class="codeph">ORA-39181: Only Partial Data Exported Due to Fine Grain Access Control</code>错误消息，请参阅My Oracle Support说明422480.1，以获取有关在导出具有细粒度访问控制策略的表数据导出期间的安全性的信息：</p>
                     <p><a href="https://support.oracle.com/rs?type=doc&amp;id=422480.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=422480.1</a></p>
                  </div>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-8B6975D3-3BEC-4584-B416-280125EEC57E__GUID-75AB188A-BC01-4230-9879-B9F91687A311">
                     <p class="notep1">也可以看看：</p>
                     <p>有关Oracle数据库安装中预定义角色的更多信息，请参见<a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG4414" target="_blank"><span><cite>“Oracle数据库安全指南</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="SUTIL808"></a><div class="props_rev_3"><a id="GUID-6BDC1CC8-8596-402D-B016-602985B97AB6" name="GUID-6BDC1CC8-8596-402D-B016-602985B97AB6"></a><h3 id="SUTIL-GUID-6BDC1CC8-8596-402D-B016-602985B97AB6" class="sect3"><span class="enumeration_section">1.5</span>执行Oracle数据泵作业时会发生什么？
               </h3>
               <p>Oracle Data Pump作业使用主表，主进程和工作进程来执行工作并跟踪进度。</p>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-E4F373D6-0D0C-4FBD-AEC1-FDC91F46BD28">协调工作</a><br>创建主进程以协调每个数据泵导出和数据泵导入作业。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-B9A676E5-B3CB-417B-BC97-65FE33448C2F">跟踪工作中的进度</a><br>在传输数据和元数据时，主表用于跟踪作业内的进度。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-DB178A4E-36D4-4ECF-932A-6DE26FE2C2EF">在作业期间过滤数据和元数据</a><br>您可以使用<code class="codeph">EXCLUDE</code>和<code class="codeph">INCLUDE</code>参数来过滤导出和导入的对象类型。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-15CF2160-0F2C-49D4-9FCC-8B60BD111331">在工作期间转换元数据</a><br>可以使用数据泵导入参数<code class="codeph">REMAP_DATAFILE</code> ， <code class="codeph">REMAP_SCHEMA</code> ， <code class="codeph">REMAP_TABLE,REMAP_TABLESPACE</code> ， <code class="codeph">TRANSFORM,</code>和<code class="codeph">PARTITION_OPTIONS</code>完成元数据的<code class="codeph">TRANSFORM,</code> 。</li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-AE83786E-EFC9-4552-BF79-AC72CE063EB6">最大化工作绩效</a><br>Data Pump可以使用多个并行运行的工作进程来提高作业性能。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-31DA185F-92E9-49F7-8431-B10354199C5A">加载和卸载数据</a><br>工作进程卸载并加载元数据和表数据。对于导出，除了使用可传输表空间的作业外，所有元数据和数据都是并行卸载的。对于导入，必须以正确的依赖关系顺序创建对象。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               <a id="SUTIL809"></a><div class="props_rev_3"><a id="GUID-E4F373D6-0D0C-4FBD-AEC1-FDC91F46BD28" name="GUID-E4F373D6-0D0C-4FBD-AEC1-FDC91F46BD28"></a><h4 id="SUTIL-GUID-E4F373D6-0D0C-4FBD-AEC1-FDC91F46BD28" class="sect4"><span class="enumeration_section">1.5.1</span>协调工作</h4>
                  <div>
                     <p>创建主进程以协调每个数据泵导出和数据泵导入作业。</p>
                     <p>主进程控制整个作业，包括与客户端通信，创建和控制工作进程池以及执行日志记录操作。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-6BDC1CC8-8596-402D-B016-602985B97AB6" title="Oracle Data Pump作业使用主表，主进程和工作进程来执行工作并跟踪进度。">执行Oracle Data Pump作业期间会发生什么？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL810"></a><div class="props_rev_3"><a id="GUID-B9A676E5-B3CB-417B-BC97-65FE33448C2F" name="GUID-B9A676E5-B3CB-417B-BC97-65FE33448C2F"></a><h4 id="SUTIL-GUID-B9A676E5-B3CB-417B-BC97-65FE33448C2F" class="sect4"><span class="enumeration_section">1.5.2</span>跟踪工作进度</h4>
                  <div>
                     <p>在传输数据和元数据时，主表用于跟踪作业内的进度。</p>
                     <p>主表实现为数据库中的用户表。主表的导出和导入作业的具体功能如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>对于导出作业，主表记录转储文件集中数据库对象的位置。导出在作业持续时间内构建和维护主表。在导出作业结束时，主表的内容将写入转储文件集中的文件。</p>
                        </li>
                        <li>
                           <p>对于导入作业，主表从转储文件集加载，用于控制用于查找需要导入目标数据库的对象的操作序列。</p>
                        </li>
                     </ul>
                     <p>主表在执行导出或导入操作的当前用户的模式中创建。因此，该用户必须具有<code class="codeph">CREATE TABLE</code>系统特权和足够的表空间配额才能创建主表。主表的名称与创建它的作业的名称相同。因此，您无法显式地为数据泵作业提供与预先存在的表或视图相同的名称。
                     </p>
                     <p>对于所有操作，主表中的信息用于重新启动作业。（请注意，可传输作业无法重新启动。）</p>
                     <p>根据具体情况保留或删除主表，如下所示：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>成功完成作业后，将删除主表。您可以通过为作业设置Data Pump <code class="codeph">KEEP_MASTER=YES</code>参数来覆盖它。
                           </p>
                        </li>
                        <li>
                           <p>对于未成功完成的作业，将自动保留主表。</p>
                        </li>
                        <li>
                           <p>如果使用<code class="codeph">STOP_JOB</code>交互式命令停止作业，则保留主表以用于重新启动作业。
                           </p>
                        </li>
                        <li>
                           <p>如果使用<code class="codeph">KILL_JOB</code>交互式命令<code class="codeph">KILL_JOB</code>作业，则会删除主表，并且无法重新启动作业。
                           </p>
                        </li>
                        <li>
                           <p>如果作业意外终止，则保留主表。如果您不打算重新启动作业，可以将其删除。</p>
                        </li>
                        <li>
                           <p>如果作业在开始运行之前停止（即，在复制任何数据库对象之前），则删除主表。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B9A676E5-B3CB-417B-BC97-65FE33448C2F__GUID-D903556B-4797-4296-B374-182932E81663">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="oracle-data-pump-export-utility.html#GUID-C146E99F-CBAB-43B4-A802-A8D5AD5898AE" title="Data Pump Export命令行实用程序JOB_NAME参数标识后续操作中的导出作业，例如使用ATTACH附加到作业时，或使用DBA_DATAPUMP_JOBS或USER_DATAPUMP_JOBS视图标识作业。">JOB_NAME</a> ，了解有关如何形成作业名称的更多信息</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-6BDC1CC8-8596-402D-B016-602985B97AB6" title="Oracle Data Pump作业使用主表，主进程和工作进程来执行工作并跟踪进度。">执行Oracle Data Pump作业期间会发生什么？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL811"></a><div class="props_rev_3"><a id="GUID-DB178A4E-36D4-4ECF-932A-6DE26FE2C2EF" name="GUID-DB178A4E-36D4-4ECF-932A-6DE26FE2C2EF"></a><h4 id="SUTIL-GUID-DB178A4E-36D4-4ECF-932A-6DE26FE2C2EF" class="sect4"><span class="enumeration_section">1.5.3</span>在作业期间过滤数据和元数据</h4>
                  <div>
                     <p>您可以使用<code class="codeph">EXCLUDE</code>和<code class="codeph">INCLUDE</code>参数来过滤导出和导入的对象类型。
                     </p>
                     <p>在主表中，为特定对象分配名称或拥有模式等属性。对象也属于一类对象（例如<code class="codeph">TABLE</code> ， <code class="codeph">INDEX,</code>或<code class="codeph">DIRECTORY</code> ）。对象的类称为其对象类型。您可以使用<code class="codeph">EXCLUDE</code>和<code class="codeph">INCLUDE</code>参数来限制导出和导入的对象类型。对象可以基于对象的名称或拥有该对象的模式的名称。您还可以指定特定于数据的筛选器以限制导出和导入的行。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-DB178A4E-36D4-4ECF-932A-6DE26FE2C2EF__GUID-64C90897-556D-466A-AA03-C040A8D9340F">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="oracle-data-pump-export-utility.html#GUID-1F85C939-E439-4436-BFEF-6DC7E167C912" title="Data Pump Export提供数据和元数据过滤功能。此功能可帮助您限制导出的信息类型。">在导出操作期间过滤</a></p>
                           </li>
                           <li>
                              <p><a href="datapump-import-utility.html#GUID-107CA775-350C-4CCE-9601-E1E810589B40" title="Data Pump Import提供数据和元数据过滤功能，可以帮助您限制导入的信息类型。">导入操作期间过滤</a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-6BDC1CC8-8596-402D-B016-602985B97AB6" title="Oracle Data Pump作业使用主表，主进程和工作进程来执行工作并跟踪进度。">执行Oracle Data Pump作业期间会发生什么？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL812"></a><div class="props_rev_3"><a id="GUID-15CF2160-0F2C-49D4-9FCC-8B60BD111331" name="GUID-15CF2160-0F2C-49D4-9FCC-8B60BD111331"></a><h4 id="SUTIL-GUID-15CF2160-0F2C-49D4-9FCC-8B60BD111331" class="sect4"><span class="enumeration_section">1.5.4</span>在作业期间转换元数据</h4>
                  <div>
                     <p>可以使用数据泵导入参数<code class="codeph">REMAP_DATAFILE</code> ， <code class="codeph">REMAP_SCHEMA</code> ， <code class="codeph">REMAP_TABLE,REMAP_TABLESPACE</code> ， <code class="codeph">TRANSFORM,</code>和<code class="codeph">PARTITION_OPTIONS</code>完成元数据的<code class="codeph">TRANSFORM,</code> 。</p>
                     <p>当您将数据从一个数据库移动到另一个数据库时，对元数据执行转换以在表空间之间重新映射存储或重新定义特定对象集的所有者通常很有用。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-6BDC1CC8-8596-402D-B016-602985B97AB6" title="Oracle Data Pump作业使用主表，主进程和工作进程来执行工作并跟踪进度。">执行Oracle Data Pump作业期间会发生什么？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL813"></a><div class="props_rev_3"><a id="GUID-AE83786E-EFC9-4552-BF79-AC72CE063EB6" name="GUID-AE83786E-EFC9-4552-BF79-AC72CE063EB6"></a><h4 id="SUTIL-GUID-AE83786E-EFC9-4552-BF79-AC72CE063EB6" class="sect4"><span class="enumeration_section">1.5.5</span>最大化工作绩效</h4>
                  <div>
                     <p>Data Pump可以使用多个并行运行的工作进程来提高作业性能。</p>
                     <p>使用<code class="codeph">PARALLEL</code>参数设置最大程度利用当前条件的并行度。例如，要限制作业对生产系统的影响，数据库管理员（DBA）可能希望限制并行性。可以在作业期间的任何时间重置并行度。例如， <code class="codeph">PARALLEL</code>可以在生产时间设置为2，以将特定作业限制为仅两个并行度，并且在非生产时间内可以将其重置为8。并行性设置由主进程强制执行，主进程将要执行的工作分配给在操作中执行数据和元数据处理的工作进程。这些工作进程并行运行。有关设置并行度的建议，请参阅“导出PARALLEL”和“导入PARALLEL”参数说明。
                     </p>
                     <div class="infoboxnote" id="GUID-AE83786E-EFC9-4552-BF79-AC72CE063EB6__GUID-75136923-D9BA-4537-871A-CE2DD6CBC98F">
                        <p class="notep1">注意：</p>
                        <p>调整并行度的功能仅在Oracle数据库企业版中可用。</p>
                     </div>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-AE83786E-EFC9-4552-BF79-AC72CE063EB6__GUID-A1A74F5D-703D-4D0E-B093-E37DBDC419BA">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="oracle-data-pump-export-utility.html#GUID-55E6AC71-5CDE-410E-AB02-798AEC54F411__CIHGACIA">在Oracle RAC环境中导出期间使用PARALLEL</a></p>
                           </li>
                           <li>
                              <p><a href="datapump-import-utility.html#GUID-3081A258-0C23-40B0-8487-9C7A0D248E23__CIHFEFCD">在Oracle RAC环境中导入期间使用PARALLEL</a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-6BDC1CC8-8596-402D-B016-602985B97AB6" title="Oracle Data Pump作业使用主表，主进程和工作进程来执行工作并跟踪进度。">执行Oracle Data Pump作业期间会发生什么？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL814"></a><div class="props_rev_3"><a id="GUID-31DA185F-92E9-49F7-8431-B10354199C5A" name="GUID-31DA185F-92E9-49F7-8431-B10354199C5A"></a><h4 id="SUTIL-GUID-31DA185F-92E9-49F7-8431-B10354199C5A" class="sect4"><span class="enumeration_section">1.5.6</span>加载和卸载数据</h4>
                  <div>
                     <p>工作进程卸载并加载元数据和表数据。对于导出，除了使用可传输表空间的作业外，所有元数据和数据都是并行卸载的。对于导入，必须以正确的依赖关系顺序创建对象。</p>
                     <p>如果有足够多的相同类型的对象来使用多个工作程序，那么这些对象将由多个工作进程导入。某些元数据对象具有相互依赖性，这需要一个工作进程以串行方式创建它们以满足这些依赖性。根据需要创建工作进程，直到工作进程数等于为<code class="codeph">PARALLEL</code>命令行参数提供的值。可以在作业的整个生命周期中重置活动工作进程的数量。可以在Oracle Real Application Clusters（Oracle RAC）环境中的不同节点上启动工作进程。
                     </p>
                     <div class="infoboxnote" id="GUID-31DA185F-92E9-49F7-8431-B10354199C5A__GUID-4DF1D2B5-224A-4302-A8D3-50A4A8043CF7">
                        <p class="notep1">注意：</p>
                        <p>在Oracle数据库标准版中， <code class="codeph">PARALLEL</code>的值限制为1。
                        </p>
                     </div>
                     <p>当为工作进程分配加载或卸载非常大的表或分区的任务时，它可以选择使用外部表访问方法来最大限度地使用并行执行。在这种情况下，工作进程成为并行执行协调器。实际的加载和卸载工作分为从Oracle RAC环境中的可用进程池分配的一些并行I / O执行进程（有时称为从属）。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="oracle-data-pump-export-utility.html#GUID-55E6AC71-5CDE-410E-AB02-798AEC54F411">平行</a></li>
                           <li><a href="datapump-import-utility.html#GUID-3081A258-0C23-40B0-8487-9C7A0D248E23">平行</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-6BDC1CC8-8596-402D-B016-602985B97AB6" title="Oracle Data Pump作业使用主表，主进程和工作进程来执行工作并跟踪进度。">执行Oracle Data Pump作业期间会发生什么？</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="SUTIL815"></a><div class="props_rev_3"><a id="GUID-E365D74E-12CD-495C-BA23-5A55F679C7E7" name="GUID-E365D74E-12CD-495C-BA23-5A55F679C7E7"></a><h3 id="SUTIL-GUID-E365D74E-12CD-495C-BA23-5A55F679C7E7" class="sect3"><span class="enumeration_section">1.6</span>监控工作状态</h3>
               <div>
                  <p>Oracle Data Pump导出和导入客户端实用程序可以以日志记录模式或交互式命令模式附加到作业。</p>
                  <p>在记录模式下，在作业执行期间会自动显示有关作业的实时详细状态。显示的信息可包括作业和参数描述，要处理的数据量的估计，当前操作或正在处理的项目的描述，作业期间使用的文件，遇到的任何错误以及最终作业状态（已停止）或已完成）。</p>
                  <p>在交互式命令模式下，可以根据请求显示作业状态。显示的信息可以包括作业描述和状态，当前操作或正在处理的项目的描述，正在写入的文件以及累积状态。</p>
                  <p>您还可以在执行作业期间写入日志文件。日志文件汇总了作业的进度，列出了在执行作业期间遇到的任何错误，并记录了作业的完成状态。</p>
                  <p>作为替代，以确定作业状态或有关Oracle数据泵作业等信息，您可以查询<code class="codeph">DBA_DATAPUMP_JOBS</code> ， <code class="codeph">USER_DATAPUMP_JOBS</code> ，或<code class="codeph">DBA_DATAPUMP_SESSIONS</code>意见。有关更多信息，请参阅<cite>Oracle数据库参考</cite> 。
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="../refrn/DBA_DATAPUMP_JOBS.html#REFRN23338" target="_blank"><span><cite>Oracle数据库参考</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="SUTIL816"></a><div class="props_rev_3"><a id="GUID-A4C5E6C1-28DE-45AF-B90C-B7FEEFF62069" name="GUID-A4C5E6C1-28DE-45AF-B90C-B7FEEFF62069"></a><h3 id="SUTIL-GUID-A4C5E6C1-28DE-45AF-B90C-B7FEEFF62069" class="sect3"><span class="enumeration_section">1.7</span>监督执行工作的进度</h3>
               <div>
                  <p>要监视表数据传输，可以使用<code class="codeph">V$SESSION_LONGOPS</code>动态性能视图来监视Oracle Data Pump作业。
                  </p>
                  <p>传输表数据（导出和导入）的Oracle Data Pump操作在<code class="codeph">V$SESSION_LONGOPS</code>动态性能视图中维护一个条目，指示作业进度（以兆字节为单位传输的表数据）。该条目包含估计的传输大小，并定期更新以反映传输的实际数据量。
                  </p>
                  <p>使用<code class="codeph">COMPRESSION</code> ， <code class="codeph">ENCRYPTION</code> ， <code class="codeph">ENCRYPTION_ALGORITHM</code> ， <code class="codeph">ENCRYPTION_MODE</code> ， <code class="codeph">ENCRYPTION_PASSWORD</code> ， <code class="codeph">QUERY</code>和<code class="codeph">REMAP_DATA</code>参数不会反映在估计值的确定中。
                  </p>
                  <p>出口业务估计值的有用性取决于启动业务时所要求的估计类型，如果超过实际转移金额，则按要求更新。进口业务的估计值是准确的。</p>
                  <p>与数据泵作业相关的<code class="codeph">V$SESSION_LONGOPS</code>列如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">USERNAME</code> ：工作所有者</p>
                     </li>
                     <li>
                        <p><code class="codeph">OPNAME</code> ：工作名称</p>
                     </li>
                     <li>
                        <p><code class="codeph">TARGET_DESC</code> ：工作操作</p>
                     </li>
                     <li>
                        <p><code class="codeph">SOFAR</code> ：在工作期间转移到目前为止的兆字节</p>
                     </li>
                     <li>
                        <p><code class="codeph">TOTALWORK</code>估算作业中的兆字节数</p>
                     </li>
                     <li>
                        <p><code class="codeph">UNITS</code> ：兆字节（MB）</p>
                     </li>
                     <li>
                        <p><code class="codeph">MESSAGE</code> ：格式化的状态消息，使用以下格式：</p><pre class="pre codeblock"><code>' <span class="variable" translate="no">job_name</span> ： <span class="variable" translate="no">operation_name</span> ： <span class="variable" translate="no">nnn</span> out of <span class="variable" translate="no">mmm</span> MB done'</code></pre></li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="SUTIL817"></a><div class="props_rev_3"><a id="GUID-FE7E746D-A343-463E-A4E2-A6AD1349FE4B" name="GUID-FE7E746D-A343-463E-A4E2-A6AD1349FE4B"></a><h3 id="SUTIL-GUID-FE7E746D-A343-463E-A4E2-A6AD1349FE4B" class="sect3"><span class="enumeration_section">1.8</span>文件分配</h3>
               <div>
                  <p>Oracle Data Pump管理几种不同类型的文件。您可以在交互模式下使用命令来修改OracleData Pump分配和处理这些文件的方式。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-29E88FEC-5F68-4841-B1B2-D4CD8B2880EE">了解数据泵中的文件分配</a><br>了解Data Pump如何分配和处理文件将帮助您充分利用导出和导入。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-8C1CD0EA-F6F8-4627-867E-956ABCB984F0">指定文件和添加其他转储文件</a><br>对于导出操作，您可以在定义作业时指定转储文件，也可以在操作期间的稍后时间指定转储文件。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-02A2E765-03BA-4097-B3A3-67B006C749AC">转储，日志和SQL文件的默认位置</a><br>查看这些主题以了解Oracle Data Pump的默认文件位置，并了解在使用Oracle RAC，Oracle自动存储管理和多租户架构时这些位置的影响。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-6F532CA9-CE90-47D6-84ED-AD10F1E18056">使用替换变量</a><br>除了列出特定文件名之外，您可以在导出操作期间使用<code class="codeph">DUMPFILE</code>参数指定多个转储文件，方法是使用文件名中的替换变量。这称为转储文件模板。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-29E88FEC-5F68-4841-B1B2-D4CD8B2880EE" name="GUID-29E88FEC-5F68-4841-B1B2-D4CD8B2880EE"></a><h4 id="SUTIL-GUID-29E88FEC-5F68-4841-B1B2-D4CD8B2880EE" class="sect4"><span class="enumeration_section">1.8.1</span>了解数据泵中的文件分配</h4>
                  <div>
                     <p>了解Data Pump如何分配和处理文件将帮助您充分利用导出和导入。</p>
                     <p>Data Pump作业管理以下类型的文件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>转储文件以包含正在移动的数据和元数据。</p>
                        </li>
                        <li>
                           <p>记录文件以记录与操作关联的消息。</p>
                        </li>
                        <li>
                           <p>用于记录SQLFILE操作输出的SQL文件。使用Data Pump Import <code class="codeph">SQLFILE</code>参数启动SQLFILE操作，并根据写入SQL文件的其他参数生成Import将执行的所有SQL DDL。
                           </p>
                        </li>
                        <li>
                           <p>在可传输导入期间由<code class="codeph">DATA_FILES</code>参数指定的文件。
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-29E88FEC-5F68-4841-B1B2-D4CD8B2880EE__GUID-4FD8114C-E2B6-4B7A-B39E-A59B26BD5E28">
                        <p class="notep1">注意：</p>
                        <p>如果数据泵作业生成与网络文件存储（NFS）相关的错误，请参阅所用平台的安装指南以确定正确的NFS安装设置。</p>
                     </div>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-FE7E746D-A343-463E-A4E2-A6AD1349FE4B" title="Oracle Data Pump管理几种不同类型的文件。您可以在交互模式下使用命令来修改OracleData Pump分配和处理这些文件的方式。">文件分配</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL818"></a><div class="props_rev_3"><a id="GUID-8C1CD0EA-F6F8-4627-867E-956ABCB984F0" name="GUID-8C1CD0EA-F6F8-4627-867E-956ABCB984F0"></a><h4 id="SUTIL-GUID-8C1CD0EA-F6F8-4627-867E-956ABCB984F0" class="sect4"><span class="enumeration_section">1.8.2</span>指定文件并添加其他转储文件</h4>
                  <div>
                     <p>对于导出操作，您可以在定义作业时指定转储文件，也可以在操作期间的稍后时间指定转储文件。</p>
                     <p>如果在导出操作期间发现空间不足，则可以在交互模式下使用“数据泵导出<code class="codeph">ADD_FILE</code>命令添加其他转储文件。
                     </p>
                     <p>对于导入操作，必须在定义作业时指定所有转储文件。</p>
                     <p>日志文件和SQL文件会覆盖以前存在的文件。对于转储文件，可以使用Export <code class="codeph">REUSE_DUMPFILES</code>参数指定是否覆盖预先存在的转储文件。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-FE7E746D-A343-463E-A4E2-A6AD1349FE4B" title="Oracle Data Pump管理几种不同类型的文件。您可以在交互模式下使用命令来修改OracleData Pump分配和处理这些文件的方式。">文件分配</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-02A2E765-03BA-4097-B3A3-67B006C749AC" name="GUID-02A2E765-03BA-4097-B3A3-67B006C749AC"></a><h4 id="SUTIL-GUID-02A2E765-03BA-4097-B3A3-67B006C749AC" class="sect4"><span class="enumeration_section">1.8.3</span>转储，日志和SQL文件的默认位置</h4>
                  <div>
                     <p>查看这些主题以了解Oracle Data Pump的默认文件位置，并了解在使用Oracle RAC，Oracle自动存储管理和多租户架构时这些位置的影响。</p>
                     <p></p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-EEB32B50-8A00-40B0-8787-CC2C8BA05DC5">了解转储，日志和SQL文件默认位置</a><br>Data Pump是基于服务器而不是基于客户端的。相对于基于服务器的目录路径，访问转储文件，日志文件和SQL文件。
                        </li>
                        <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-8E63A90B-8E72-4E94-B2F4-41CF0603293E">了解如何在Oracle RAC中使用Oracle Data Pump</a><br>在Oracle Real Application Clusters（Oracle RAC）环境中使用Oracle Data Pump需要您执行一些检查以确保您可以使集群成员节点可用。
                        </li>
                        <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-1A269231-3365-4A3B-B838-649AAC2766CB">启用Oracle自动存储管理时使用目录对象</a><br>您可以使用Data Pump Export或Import with Oracle Automatic Storage Management（Oracle ASM）。您必须定义用于转储文件的目录对象，以便使用Oracle ASM磁盘组名称，而不是操作系统目录路径。
                        </li>
                        <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-BB478188-0F26-44E3-99E6-C161ED5A2473">DATA_PUMP_DIR目录对象和可插拔数据库</a><br>默认的数据泵目录对象<code class="codeph">DATA_PUMP_DIR</code>被定义为CDB中每个PDB的唯一路径。</li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-FE7E746D-A343-463E-A4E2-A6AD1349FE4B" title="Oracle Data Pump管理几种不同类型的文件。您可以在交互模式下使用命令来修改OracleData Pump分配和处理这些文件的方式。">文件分配</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="SUTIL819"></a><div class="props_rev_3"><a id="GUID-EEB32B50-8A00-40B0-8787-CC2C8BA05DC5" name="GUID-EEB32B50-8A00-40B0-8787-CC2C8BA05DC5"></a><h5 id="SUTIL-GUID-EEB32B50-8A00-40B0-8787-CC2C8BA05DC5" class="sect5"><span class="enumeration_section">1.8.3.1</span>了解转储，日志和SQL文件默认位置</h5>
                     <div>
                        <p>Data Pump是基于服务器而不是基于客户端的。相对于基于服务器的目录路径，访问转储文件，日志文件和SQL文件。</p>
                        <p>Data Pump要求将目录路径指定为目录对象。目录对象将名称映射到文件系统上的目录路径。DBA必须确保只允许经过批准的用户访问与目录路径关联的目录对象。</p>
                        <p>以下示例显示了一个SQL语句，该语句创建名为<code class="codeph">dpump_dir1</code>的目录对象，该对象映射到位于<code class="codeph">/usr/apps/datafiles.</code></p><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE DIRECTORY dpump_dir1 AS'/ usr / apps / datafiles';</pre><p>需要目录对象的原因是为了确保数据安全性和完整性。例如：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果允许您为输入文件指定目录路径位置，那么您可能能够读取服务器可以访问但不应该访问的数据。</p>
                           </li>
                           <li>
                              <p>如果允许您为输出文件指定目录路径位置，则服务器可能会覆盖您通常无权删除的文件。</p>
                           </li>
                        </ul>
                        <p>在UNIX和Windows操作系统上，默认目录对象<code class="codeph">DATA_PUMP_DIR</code>是在创建数据库时或每当升级数据库字典时创建的。默认情况下，它仅适用于特权用户。（默认情况下，用户<code class="codeph">SYSTEM</code>具有对<code class="codeph">DATA_PUMP_DIR</code>目录的读写权限。）在升级期间或应用修补程序时，Oracle可能会更改<code class="codeph">DATA_PUMP_DIR</code>目录的定义。
                        </p>
                        <p>如果您不是特权用户，则在运行Data Pump Export或Data Pump Import之前，必须由数据库管理员（DBA）或具有<code class="codeph">CREATE</code> <code class="codeph">ANY</code> <code class="codeph">DIRECTORY</code>权限的任何用户<code class="codeph">CREATE</code> <code class="codeph">DIRECTORY</code> 。
                        </p>
                        <p>创建目录后，创建目录对象的用户必须将该目录的<code class="codeph">READ</code>或<code class="codeph">WRITE</code>权限授予其他用户。例如，要允许Oracle数据库代表用户<code class="codeph">hr</code>在<code class="codeph">dpump_dir1</code>指定的目录中读取和写入文件，DBA必须执行以下命令：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; GRANT READ，WRITE ON DIRECTORY dpump_dir1 TO hr;</pre><p>请注意，对目录对象的<code class="codeph">READ</code>或<code class="codeph">WRITE</code>权限仅表示Oracle数据库可以代表您读取或写入相应目录中的文件。除非您具有相应的操作系统权限，否则不能直接访问Oracle数据库之外的那些文件。同样，Oracle数据库需要操作系统的许可才能读取和写入目录中的文件。
                        </p>
                        <p>数据泵导出和导入使用以下优先顺序来确定文件的位置：</p>
                        <ol>
                           <li>
                              <p>如果将目录对象指定为文件规范的一部分，则使用该目录对象指定的位置。（目录对象必须用冒号与文件名分开。）</p>
                           </li>
                           <li>
                              <p>如果未将目录对象指定为文件规范的一部分，则使用<code class="codeph">DIRECTORY</code>参数指定的目录对象。
                              </p>
                           </li>
                           <li>
                              <p>如果未将目录对象指定为文件规范的一部分，并且如果<code class="codeph">DIRECTORY</code>参数未指定目录对象，则使用环境变量<code class="codeph">DATA_PUMP_DIR</code>的值。此环境变量是使用运行数据泵导出和导入实用程序的客户端系统上的操作系统命令定义的。分配给此基于客户机的环境变量的值必须是基于服务器的目录对象的名称，该目标对象必须首先由DBA在服务器系统上创建。例如，以下SQL语句在服务器系统上创建目录对象。目录对象的名称是<code class="codeph">DUMP_FILES1</code> ，它位于<code class="codeph">'/usr/apps/dumpfiles1'</code> 。
                              </p><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE DIRECTORY DUMP_FILES1 AS'/ usr / apps / dumpfiles1';</pre><p>然后，使用<code class="codeph">csh</code>的基于UNIX的客户端系统上的用户可以将值<code class="codeph">DUMP_FILES1</code>分配给环境变量<code class="codeph">DATA_PUMP_DIR</code> 。然后可以从命令行中省略<code class="codeph">DIRECTORY</code>参数。转储文件<code class="codeph">employees.dmp</code>和日志文件<code class="codeph">export.log</code>将写入<code class="codeph">'/usr/apps/dumpfiles1'</code> 。
                              </p><pre class="oac_no_warn" dir="ltr">％setenv DATA_PUMP_DIR DUMP_FILES1％expdp hr TABLES = employees DUMPFILE = employees.dmp</pre></li>
                           <li>
                              <p>如果前三个条件都不生成目录对象且您是特权用户，则Data Pump会尝试使用默认的基于服务器的目录对象<code class="codeph">DATA_PUMP_DIR</code> 。在创建数据库时或升级数据库字典时会自动创建此目录对象。您可以使用以下SQL查询来查看<code class="codeph">DATA_PUMP_DIR</code>的路径定义：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT directory_name，directory_path FROM dba_directories 2 WHERE directory_name ='DATA_PUMP_DIR';</pre><p>如果您不是特权用户，则必须<code class="codeph">DATA_PUMP_DIR</code> DBA授予对<code class="codeph">DATA_PUMP_DIR</code>目录对象的访问权限。</p>
                              <p>不要将默认的<code class="codeph">DATA_PUMP_DIR</code>目录对象与同名的基于客户端的环境变量混淆。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-02A2E765-03BA-4097-B3A3-67B006C749AC" title="查看这些主题以了解Oracle Data Pump的默认文件位置，并了解在使用Oracle RAC，Oracle自动存储管理和多租户架构时这些位置的影响。">转储，日志和SQL文件的默认位置</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="SUTIL3755"></a><div class="props_rev_3"><a id="GUID-8E63A90B-8E72-4E94-B2F4-41CF0603293E" name="GUID-8E63A90B-8E72-4E94-B2F4-41CF0603293E"></a><h5 id="SUTIL-GUID-8E63A90B-8E72-4E94-B2F4-41CF0603293E" class="sect5"><span class="enumeration_section">1.8.3.2</span>了解如何在Oracle RAC中使用Oracle Data Pump</h5>
                     <div>
                        <p>在Oracle Real Application Clusters（Oracle RAC）环境中使用Oracle Data Pump需要您执行一些检查以确保您可以使集群成员节点可用。</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要在Oracle RAC配置中使用Data Pump或外部表，必须确保目录对象路径位于群集范围的文件系统上。</p>
                              <p>目录对象必须指向可以运行Data Pump和/或外部表进程的所有实例可见并可从中访问的共享物理存储。</p>
                           </li>
                           <li>
                              <p>默认的数据泵行为是工作进程可以在Oracle RAC配置中的任何实例上运行。因此，这些Oracle RAC实例上的工作人员必须具有对目录对象定义的位置的物理访问权限，例如共享存储介质。如果配置没有用于此目的的共享存储，但仍需要并行性，则可以使用<code class="codeph">CLUSTER=NO</code>参数将所有工作进程约束到启动Data Pump作业的实例。
                              </p>
                           </li>
                           <li>
                              <p>在某些情况下，Data Pump使用并行查询从服务器来加载或卸载数据。在Oracle RAC环境中，Data Pump不控制这些从站的运行位置。因此，无论为数据泵作业的<code class="codeph">CLUSTER</code>和<code class="codeph">SERVICE_NAME</code>指定了哪个实例，这些从属服务器都可以在群集中的其他群集成员节点上运行。并行查询操作的控件独立于Data Pump。当并行查询从属服务器作为数据泵作业的一部分在其他实例上运行时，它们还需要访问转储文件集的物理存储。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-02A2E765-03BA-4097-B3A3-67B006C749AC" title="查看这些主题以了解Oracle Data Pump的默认文件位置，并了解在使用Oracle RAC，Oracle自动存储管理和多租户架构时这些位置的影响。">转储，日志和SQL文件的默认位置</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="SUTIL820"></a><div class="props_rev_3"><a id="GUID-1A269231-3365-4A3B-B838-649AAC2766CB" name="GUID-1A269231-3365-4A3B-B838-649AAC2766CB"></a><h5 id="SUTIL-GUID-1A269231-3365-4A3B-B838-649AAC2766CB" class="sect5"><span class="enumeration_section">1.8.3.3</span>启用Oracle自动存储管理时使用目录对象</h5>
                     <div>
                        <p>您可以使用Data Pump Export或Import with Oracle Automatic Storage Management（Oracle ASM）。您必须定义用于转储文件的目录对象，以便使用Oracle ASM磁盘组名称，而不是操作系统目录路径。</p>
                        <div class="section">
                           <p>对于日志文件，请使用指向操作系统目录路径的单独目录对象。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-1A269231-3365-4A3B-B838-649AAC2766CB__GUID-AEC0C77B-9277-446A-A2F7-AF942E0B3BAE">
                           <p>例如，您可以使用此过程为Oracle ASM转储文件创建目录对象。</p><pre class="pre codeblock"><code>SQL&gt; CREATE或REPLACE DIRECTORY dpump_dir为'+ DATAFILES /';</code></pre><p>创建目录对象后，然后为日志文件创建单独的目录对象：</p><pre class="pre codeblock"><code>SQL&gt; CREATE或REPLACE DIRECTORY dpump_log为'/ homedir / user1 /';</code></pre><p>要使用户<code class="codeph">hr</code>能够访问这些目录对象，请为该用户分配必要的权限：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; GRANT READ，WRITE ON DIRECTORY dpump_dir TO hr; SQL&gt; GRANT READ，WRITE ON DIRECTORY dpump_log TO hr;</pre><p>最后，您可以使用以下Data Pump Export命令：</p><pre class="pre codeblock"><code>&gt; expdp hr DIRECTORY = dpump_dir DUMPFILE = hr.dmp LOGFILE = dpump_log：hr.log</code></pre><p>在执行命令之前，系统会提示您输入密码。</p>
                           <div class="infoboxnote" id="GUID-1A269231-3365-4A3B-B838-649AAC2766CB__GUID-8DF266E3-743D-4012-B2D4-42EA45D19979">
                              <p class="notep1">注意：</p>
                              <p>如果您只想在ASM和磁盘目录之间复制Data Pump转储文件，则可以使用<code class="codeph">DBMS_FILE_TRANSFER</code> PL / SQL包。
                              </p>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../sqlrf/CREATE-DIRECTORY.html#SQLRF01207" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></li>
                              <li><a href="../arpls/DBMS_FILE_TRANSFER.html#ARPLS095" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-02A2E765-03BA-4097-B3A3-67B006C749AC" title="查看这些主题以了解Oracle Data Pump的默认文件位置，并了解在使用Oracle RAC，Oracle自动存储管理和多租户架构时这些位置的影响。">转储，日志和SQL文件的默认位置</a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="SUTIL4337"></a><div class="props_rev_3"><a id="GUID-BB478188-0F26-44E3-99E6-C161ED5A2473" name="GUID-BB478188-0F26-44E3-99E6-C161ED5A2473"></a><h5 id="SUTIL-GUID-BB478188-0F26-44E3-99E6-C161ED5A2473" class="sect5"><span class="enumeration_section">1.8.3.4</span> DATA_PUMP_DIR目录对象和可插拔数据库</h5>
                     <div>
                        <p>默认的数据泵目录对象<code class="codeph">DATA_PUMP_DIR</code>被定义为CDB中每个PDB的唯一路径。</p>
                        <p>从Oracle Database 12 <code class="codeph">c</code> 2版（12.2）开始，在多租户容器数据库（CDB）环境中，默认数据泵目录对象<code class="codeph">DATA_PUMP_DIR</code>被定义为CDB中每个PDB的唯一路径，无论<code class="codeph">PATH_PREFIX</code>子句是否<code class="codeph">PATH_PREFIX</code> <code class="codeph">CREATE PLUGGABLE DATABASE</code>语句的定义是针对相对路径定义的。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-02A2E765-03BA-4097-B3A3-67B006C749AC" title="查看这些主题以了解Oracle Data Pump的默认文件位置，并了解在使用Oracle RAC，Oracle自动存储管理和多租户架构时这些位置的影响。">转储，日志和SQL文件的默认位置</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="SUTIL822"></a><div class="props_rev_3"><a id="GUID-6F532CA9-CE90-47D6-84ED-AD10F1E18056" name="GUID-6F532CA9-CE90-47D6-84ED-AD10F1E18056"></a><h4 id="SUTIL-GUID-6F532CA9-CE90-47D6-84ED-AD10F1E18056" class="sect4"><span class="enumeration_section">1.8.4</span>使用替换变量</h4>
                  <div>
                     <p>除了列出特定文件名之外，您可以在导出操作期间使用<code class="codeph">DUMPFILE</code>参数指定多个转储文件，方法是使用文件名中的替换变量。这称为转储文件模板。
                     </p>
                     <div class="infoboxnote" id="GUID-6F532CA9-CE90-47D6-84ED-AD10F1E18056__GUID-80197391-6DE8-4FF7-90F0-C472D3D11095">
                        <p class="notep1">注意：</p>本节使用％U来解释Data Pump如何使用替换变量。有关其他可用替换变量的信息，请参阅Data Pump Export <a href="oracle-data-pump-export-utility.html#GUID-A6300021-419F-4C1D-AFF1-38FE1123326B" title="Data Pump Export命令行实用程序DUMPFILE参数指定导出作业的转储文件的名称和（可选）目录对象。">DUMPFILE</a>参数和Data Pump Import <a href="datapump-import-utility.html#GUID-DE156692-2955-4D5B-A327-C421F9E45FEB" title="Data Pump Import命令行模式DUMPFILE参数指定Export创建的转储文件集的名称和（可选）目录对象。">DUMPFILE</a>参数。
                     </div>
                     <p>根据需要创建新的转储文件。例如，如果您使用的替代变量％U，然后是根据需要用开始创建新的转储文件<code class="codeph">01</code>的<code class="codeph">%U</code> ，然后用<code class="codeph">02</code> ， <code class="codeph">03</code> ，等等。创建足够的转储文件以允许<code class="codeph">PARALLEL</code>参数的当前设置指定的所有进程处于活动状态。如果其中一个转储文件因其大小已达到<code class="codeph">FILESIZE</code>参数指定的最大大小而变满，则会关闭该文件，并创建一个新的转储文件（使用新生成的名称）来取代它。
                     </p>
                     <p>如果提供了多个转储文件模板，则它们用于以循环方式生成转储文件。例如，如果为并行度为6的作业指定了<code class="codeph">expa%U</code> ， <code class="codeph">expb%U,</code>和<code class="codeph">expc%U</code> ，则创建的初始转储文件将为<code class="codeph">expa01</code> 。 <code class="codeph">dmp</code> ， <code class="codeph">expb01</code> 。 <code class="codeph">dmp</code> ， <code class="codeph">expc01</code> 。 <code class="codeph">dmp</code> ， <code class="codeph">expa02</code> 。 <code class="codeph">dmp</code> ， <code class="codeph">expb02</code> 。 <code class="codeph">dmp</code>和<code class="codeph">expc02</code> 。 <code class="codeph">dmp</code> 。
                     </p>
                     <p>对于import和SQLFILE操作，如果指定了转储文件规范<code class="codeph">expa%U</code> ， <code class="codeph">expb%U,</code>和<code class="codeph">expc%U</code> ，则操作首先尝试打开转储文件<code class="codeph">expa01</code> 。 <code class="codeph">dmp</code> ， <code class="codeph">expb01</code> 。 <code class="codeph">dmp</code>和<code class="codeph">expc01</code> 。 <code class="codeph">dmp</code> 。这是可能的主表跨越多个转储文件，所以直到主表的所有作品中发现，转储文件将继续被打开，通过增加替代变量和查找新的文件名（例如， <code class="codeph">expa02</code> 。 <code class="codeph">dmp</code> ， <code class="codeph">expb02</code> ， <code class="codeph">dmp</code> ，并<code class="codeph">expc02</code> 。 <code class="codeph">dmp</code> ）。如果转储文件不存在，则操作将停止为出错的转储文件规范递增替换变量。例如，如果是<code class="codeph">expb01</code> 。 <code class="codeph">dmp</code>和<code class="codeph">expb02</code> 。找到<code class="codeph">dmp</code>但是<code class="codeph">expb03</code> 。找不到<code class="codeph">dmp</code> ，然后使用<code class="codeph">expb%U</code>规范搜索不再有文件。找到整个主表后，它将用于确定是否已找到转储文件集中的所有转储文件。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-FE7E746D-A343-463E-A4E2-A6AD1349FE4B" title="Oracle Data Pump管理几种不同类型的文件。您可以在交互模式下使用命令来修改OracleData Pump分配和处理这些文件的方式。">文件分配</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="SUTIL110"></a><div class="props_rev_3"><a id="GUID-BAA3B679-A758-4D55-9820-432D9EB83C68" name="GUID-BAA3B679-A758-4D55-9820-432D9EB83C68"></a><h3 id="SUTIL-GUID-BAA3B679-A758-4D55-9820-432D9EB83C68" class="sect3"><span class="enumeration_section">1.9</span>在不同的Oracle数据库版本之间导出和导入</h3>
               <div>
                  <p>您可以使用Oracle Data Pump在不同版本的数据库软件之间迁移Oracle数据库的全部或任何部分。</p>
                  <p>通常，您使用Oracle Data Pump Export <code class="codeph">VERSION</code>参数在数据库版本之间进行迁移。使用<code class="codeph">VERSION</code>生成与指定版本兼容的Oracle Data Pump转储文件集。
                  </p>
                  <p><code class="codeph">VERSION</code>的默认值是<code class="codeph">COMPATIBLE</code> 。此值指示导出的数据库对象定义与为<code class="codeph">COMPATIBLE</code>初始化参数指定的发行版<code class="codeph">COMPATIBLE</code> 。
                  </p>
                  <p>在升级情况下，当基于Oracle Data Pump的目标版本的迁移高于源时，通常不必指定<code class="codeph">VERSION</code>参数。当目标版本高于源时，源数据库中的所有对象都与较高目标版本兼容。但是，例外情况是导出整个Oracle Database 11g（版本11.2.0.3或更高版本）以准备导入Oracle Database 12c第1版（12.1.0.1）或更高版本。在这种情况下，要包含一整套Oracle数据库内部组件元数据，请使用<code class="codeph">FULL=YES</code>显式指定<code class="codeph">VERSION=12</code> 。</p>
                  <p>在降级情况下，当基于Oracle Data Pump的目标版本的迁移低于源时，请将<code class="codeph">VERSION</code>参数值设置为与目标版本相同的版本。目标发行版本与源系统上<code class="codeph">COMPATIBLE</code>初始化参数的值相同时例外。在这种情况下，您不需要指定<code class="codeph">VERSION</code> 。但是，一般情况下，除非明确指定<code class="codeph">VERSION</code>参数，否则Oracle Data Pump导入无法读取由当前版本更新的Oracle数据库版本创建的转储文件集。
                  </p>
                  <p>在不同数据库版本之间导出和导入时，请记住以下信息：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在Oracle Data Pump导出中，如果指定的数据库版本早于当前数据库版本，则会创建一个转储文件集，您可以将其导入到该旧版本的数据库中。例如，如果您运行的是Oracle Database 12c第1版（12.1.0.2），并且在导出时指定了<code class="codeph">VERSION=11.2</code> ，则可以将创建的转储文件集导入Oracle Database 11g（版本11.2）数据库。
                        </p>
                        <div class="infoboxnote" id="GUID-BAA3B679-A758-4D55-9820-432D9EB83C68__GUID-CEF899D4-95B6-4A14-8992-944B04D1CFA8">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>仅在Oracle Database 12c第1版（12.1.0.2）及更高版本中有效的数据库权限（例如，对表，视图，物化视图和同义词的<code class="codeph">READ</code>权限）无法导入Oracle Database 12c第1版（12.1.0.1） ）或更早。如果尝试这样做，则Import会将其报告为错误，并继续导入操作。
                                 </p>
                              </li>
                              <li>
                                 <p>导出到早于Oracle Database 12c第2版（12.2.0.1）的发行版时，Oracle Data Pump不会过滤掉超过30个字节的对象名称。导出对象。在导入时，如果您尝试创建名称长度超过30个字节的对象，则会返回错误。</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li>
                        <p>如果指定的Oracle数据库版本早于当前的Oracle数据库版本，则某些功能和数据类型可能不可用。例如，如果还为作业指定了数据压缩，则指定<code class="codeph">VERSION=10.1</code>会导致错误，因为Oracle Database 10g第1版（10.1）中不支持压缩。另一个示例：如果源Oracle数据库发行版中的用户定义类型或Oracle提供的类型是比目标Oracle数据库发行版中的类型更高的版本，则不会加载该类型，因为它与任何版本的键入目标数据库。
                        </p>
                     </li>
                     <li>
                        <p>Oracle Data Pump Import始终可以读取旧版Oracle数据库版本创建的Oracle Data Pump转储文件集。</p>
                     </li>
                     <li>
                        <p>通过网络链接进行操作时，Oracle Data Pump要求源数据库和目标Oracle数据库版本的差异不超过两个版本。</p>
                        <p>例如，如果一个数据库是Oracle Database 12c，则另一个Oracle Database版本必须是12c，11g或10g。Oracle Data Pump仅检查主要版本号（例如，10g，11g，12c），而不检查特定的Oracle数据库版本号（例如，12.2,12.1,11.1,11.2,10.1或10.2）。</p>
                     </li>
                     <li>
                        <p>将包含表统计信息的Oracle Database 11g转储文件导入Oracle Database 12c第1版（12.1）或更高版本的Oracle数据库版本可能会导致Oracle ORA-39346错误。发生此错误的原因是Oracle Database 11g转储文件包含表统计信息作为元数据。Oracle Database 12c第1版（12.1）及更高版本要求将表统计信息显示为表数据。解决方法是在导入操作期间忽略错误。导入操作完成后，重新收集表统计信息。</p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="oracle-data-pump-export-utility.html#GUID-2877B4DB-0082-438F-AC9B-18D1686F5DDC">版</a></li>
                        <li><a href="datapump-import-utility.html#GUID-A5B19146-2CAA-47E7-8AE5-57A05E3347F6">版</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-BAA3B679-A758-4D55-9820-432D9EB83C68__GUID-DFB580D8-F11A-43A4-BCE7-74AFC99CE772">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<code class="codeph">READ</code>和<code class="codeph">READ ANY TABLE</code>权限的更多信息，请<code class="codeph">READ</code> <a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG992" target="_blank"><span class="italic">“Oracle数据库安全指南”</span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="SUTIL2883"></a><div class="props_rev_3"><a id="GUID-9030BC32-193B-4455-8DBB-4271DD44FA7A" name="GUID-9030BC32-193B-4455-8DBB-4271DD44FA7A"></a><h3 id="SUTIL-GUID-9030BC32-193B-4455-8DBB-4271DD44FA7A" class="sect3"><span class="enumeration_section">1.10</span> SecureFiles LOB注意事项</h3>
               <div>
                  <p>使用Oracle Data Pump Export导出SecureFiles LOB时，导出行为取决于多种因素，包括Export <code class="codeph">VERSION</code>参数值，是否存在ContentType，以及是否存档LOB以及是否缓存数据。
                  </p>
                  <p></p>
                  <p>以下方案涵盖了这些变量的不同组合：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果表包含具有ContentType的SecureFiles LOB且Export <code class="codeph">VERSION</code>参数设置为早于<code class="codeph">11.2.0.0.0</code>的值，则不会导出ContentType。
                        </p>
                     </li>
                     <li>
                        <p>如果表包含具有ContentType的SecureFiles LOB且Export <code class="codeph">VERSION</code>参数设置为值<code class="codeph">11.2.0.0.0</code>或更高版本，则会在后续导入时导出和还原ContentType。
                        </p>
                     </li>
                     <li>
                        <p>如果表包含当前已归档的SecureFiles LOB并且数据已缓存，并且Export <code class="codeph">VERSION</code>参数设置为早于<code class="codeph">11.2.0.0.0</code>的值，则会导出SecureFiles LOB数据并删除归档元数据。在这种情况下，如果<code class="codeph">VERSION</code>设置为<code class="codeph">11.1</code>或更高版本，则SecureFiles LOB将成为一个vanilla SecureFiles LOB。但是如果将<code class="codeph">VERSION</code>设置为早于<code class="codeph">11.1</code>的值，则SecureFiles LOB将成为BasicFiles LOB。</p>
                     </li>
                     <li>
                        <p>如果表包含当前已存档但未缓存数据的SecureFiles LOB，并且Export <code class="codeph">VERSION</code>参数设置为早于<code class="codeph">11.2.0.0.0</code>的值，则会返回ORA-45001错误。
                        </p>
                     </li>
                     <li>
                        <p>如果表包含当前已归档的SecureFiles LOB并且数据已缓存，并且Export <code class="codeph">VERSION</code>参数设置为值<code class="codeph">11.2.0.0.0</code>或更高版本，则将导出缓存数据和归档元数据。
                        </p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-9030BC32-193B-4455-8DBB-4271DD44FA7A__GUID-327BEFAE-B5E2-437C-B9AF-01911E9AE56D">
                     <p class="notep1">也可以看看：</p>
                     <p>有关SecureFiles的更多信息，请参见<a href="../adlob/using-oracle-LOBs-storage.html#ADLOB4444" target="_blank"><span><cite>Oracle Database SecureFiles和Large Objects Developer's Guide</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="SUTIL3835"></a><a id="SUTIL3834"></a><div class="props_rev_3"><a id="GUID-34D0DEE7-3530-42DC-BE01-C2588CC73CE5" name="GUID-34D0DEE7-3530-42DC-BE01-C2588CC73CE5"></a><h3 id="SUTIL-GUID-34D0DEE7-3530-42DC-BE01-C2588CC73CE5" class="sect3"><span class="enumeration_section">1.11</span> Oracle数据泵退出代码</h3>
               <div>
                  <p>您可以在日志文件和进程退出代码中查看Oracle Data Pump导出和导入操作结果。</p>
                  <div class="section">
                     <p>Oracle Data Pump在完成后立即提供导出和导入操作的结果。除了将结果记录在日志文件中之外，Oracle Data Pump还可以在流程退出代码中报告结果。使用Oracle Data Pump退出代码从命令行或脚本检查Oracle Data Pump作业的结果：</p>
                     <div class="tblformalwide" id="GUID-34D0DEE7-3530-42DC-BE01-C2588CC73CE5__BABICAEC">
                        <p class="titleintable">表1-1数据泵退出代码</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="数据泵退出代码" width="100%" border="1" summary="Data Pump Exit Codes for Linux, Unix, and Windows" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="29%" id="d10392e3670">退出代码</th>
                                 <th align="left" valign="bottom" width="71%" id="d10392e3673">含义</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d10392e3678" headers="d10392e3670 ">
                                    <p><code class="codeph">EX_SUCC 0</code></p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d10392e3678 d10392e3673 ">
                                    <p>导出或导入作业成功完成。没有错误显示在输出设备上或记录在日志文件中（如果有）。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d10392e3686" headers="d10392e3670 ">
                                    <p><code class="codeph">EX_SUCC_ERR 5</code></p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d10392e3686 d10392e3673 ">
                                    <p>导出或导入作业成功完成，但在作业期间遇到错误。错误将显示在输出设备上，并记录在日志文件中（如果有）。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d10392e3694" headers="d10392e3670 ">
                                    <p><code class="codeph">EX_FAIL 1</code></p>
                                 </td>
                                 <td align="left" valign="top" width="71%" headers="d10392e3694 d10392e3673 ">
                                    <p>导出或导入作业遇到一个或多个致命错误，包括以下内容：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>命令行或命令语法中的错误</p>
                                       </li>
                                       <li>
                                          <p>导出或导入无法恢复的Oracle数据库错误</p>
                                       </li>
                                       <li>
                                          <p>操作系统错误（例如malloc）</p>
                                       </li>
                                       <li>
                                          <p>阻止作业启动的无效参数值（例如， <code class="codeph">DIRECTORY</code>参数中指定的无效目录对象）</p>
                                       </li>
                                    </ul>
                                    <p>输出设备显示致命错误，但可能未记录在日志文件中。是否记录在日志文件中可能取决于几个因素，包括：</p>
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p>是否在作业开始时指定了日志文件？</p>
                                       </li>
                                       <li>
                                          <p>作业的处理是否足以打开日志文件？</p>
                                       </li>
                                    </ul>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="SUTIL4280"></a><div class="props_rev_3"><a id="GUID-4443B80B-0446-4010-B8CA-2524659516BC" name="GUID-4443B80B-0446-4010-B8CA-2524659516BC"></a><h3 id="SUTIL-GUID-4443B80B-0446-4010-B8CA-2524659516BC" class="sect3"><span class="enumeration_section">1.12</span>审核数据泵作业</h3>
               <div>
                  <p>要监视和记录特定的用户数据库操作，请使用统一审计对Data Pump作业执行审计。</p>
                  <div class="section">
                     <p>您可以对Data Pump作业执行审核，以监视和记录特定的用户数据库操作。Data Pump使用统一审计，其中所有审计记录集中在一个地方。</p>
                     <p>要设置统一审核，请创建统一审核策略或更改现有策略。审核策略是一组命名的审核设置，使您可以审核数据库中用户行为的特定方面。要创建策略，请使用SQL <code class="codeph">CREATE AUDIT POLICY</code>语句。
                     </p>
                     <p>创建审核策略后，分别使用<code class="codeph">AUDIT</code>和<code class="codeph">NOAUDIT</code> SQL语句启用和禁用策略。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-4443B80B-0446-4010-B8CA-2524659516BC__GUID-9E9A3DDD-CFA5-4F37-A0BA-B204B344120B">
                     <p class="notep1">也可以看看：</p>
                     <p></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关SQL <code class="codeph">CREATE AUDIT POLICY,ALTER AUDIT POLICY, AUDIT,</code>和<code class="codeph">NOAUDIT</code>语句的更多信息，请<a href="../sqlrf/CREATE-AUDIT-POLICY-Unified-Auditing.html#SQLRF56055" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关在Oracle数据库中使用审计的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/sutil&amp;id=DBSEG006" target="_blank"><span><cite>“Oracle数据库安全指南”</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="SUTIL4292"></a><div class="props_rev_3"><a id="GUID-7EE60BAB-0D3D-46EB-8E11-4FDDA68EF14E" name="GUID-7EE60BAB-0D3D-46EB-8E11-4FDDA68EF14E"></a><h3 id="SUTIL-GUID-7EE60BAB-0D3D-46EB-8E11-4FDDA68EF14E" class="sect3"><span class="enumeration_section">1.13</span>数据泵如何处理时间戳数据？
               </h3>
               <div>
                  <p>本节介绍可能影响成功完成导出和导入作业的因素，这些作业涉及时间戳数据类型<code class="codeph">TIMESTAMP WITH TIMEZONE</code>和<code class="codeph">TIMESTAMP WITH LOCAL TIMEZONE</code> 。</p>
                  <div class="infoboxnote" id="GUID-7EE60BAB-0D3D-46EB-8E11-4FDDA68EF14E__GUID-65C5A862-FA8A-4237-9D33-07B06BEAD85D">
                     <p class="notep1">注意：</p>
                     <p>本节中的信息仅适用于在Oracle Database <span class="italic">12c</span>及更高版本上运行的Oracle Data Pump。
                     </p>
                  </div>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-9B6C92EE-860E-43DD-9728-735B17B9DA89">TIMESTAMP与TIMEZONE限制</a><br>具有<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据的导出和导入作业受到限制。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-D8443A5E-BF6D-4329-AF11-8E5899356C64">TIMESTAMP与当地时区限制</a><br>使用可传输模式移动表受到限制。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-9B6C92EE-860E-43DD-9728-735B17B9DA89" name="GUID-9B6C92EE-860E-43DD-9728-735B17B9DA89"></a><h4 id="SUTIL-GUID-9B6C92EE-860E-43DD-9728-735B17B9DA89" class="sect4"><span class="enumeration_section">1.13.1具有</span> TIMEZONE限制的TIMESTAMP</h4>
                  <div>
                     <p>具有<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据的导出和导入作业受到限制。
                     </p>
                     <p></p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-02A6F03E-7754-41B5-A579-93A6E171A61C">了解TIMESTAMP与时区限制</a><br>执行具有<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据的导出和导入作业需要了解有关时区文件数据和Oracle数据库版本的信息。
                        </li>
                        <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-EF3AF1D8-716B-4C3E-931D-52937A5175F1">具有时区数据的TIMESTAMP的数据泵支持</a><br>Data Pump在不同的导出和导入模式（如非可传输模式，可传输表空间和可传输表模式以及完全可传输模式）期间支持<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据。
                        </li>
                        <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-4DABDB38-BEAA-471B-9026-F91CD22FD5C4">源和目标上的时区文件版本</a><br>成功完成作业可能取决于源和目标时区文件版本是否匹配。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-7EE60BAB-0D3D-46EB-8E11-4FDDA68EF14E" title="本节介绍可能影响成功完成导出和导入作业的因素，这些作业涉及时间戳数据类型TIMESTAMP WITH TIMEZONE和TIMESTAMP WITH LOCAL TIMEZONE。">数据泵如何处理时间戳数据？</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="SUTIL4320"></a><div class="props_rev_3"><a id="GUID-02A6F03E-7754-41B5-A579-93A6E171A61C" name="GUID-02A6F03E-7754-41B5-A579-93A6E171A61C"></a><h5 id="SUTIL-GUID-02A6F03E-7754-41B5-A579-93A6E171A61C" class="sect5"><span class="enumeration_section">1.13.1.1</span>了解TIMESTAMP与时区限制</h5>
                     <div>
                        <p>执行具有<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据的导出和导入作业需要了解有关时区文件数据和Oracle数据库版本的信息。
                        </p>
                        <div class="section">
                           <p>成功完成工作取决于以下因素：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>源数据库和目标数据库上的Oracle数据库时区文件的版本。</p>
                              </li>
                              <li>
                                 <p>导出/导入模式以及所使用的数据泵版本是否支持<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据。（Data Pump 11.2.0.1及更高版本为<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据提供支持。）
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-02A6F03E-7754-41B5-A579-93A6E171A61C__GUID-BFCD545C-EDE5-4280-9C2B-4B3A0638781F">
                           <p>要标识数据库的时区文件版本，可以执行以下SQL语句：</p><pre class="pre codeblock"><code>SQL&gt; SELECT VERSION FROM V $ TIMEZONE_FILE;</code></pre></div>
                        <!-- class="example" -->
                        <div class="section">有关时区文件的详细信息，请参阅“ <cite>Oracle数据库全球化支持指南”</cite> 。
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../nlspg/datetime-data-types-and-time-zone-support.html#NLSPG258" target="_blank"><span><cite>Oracle数据库全球化支持指南</cite></span></a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-9B6C92EE-860E-43DD-9728-735B17B9DA89" title="具有TIMESTAMP WITH TIME ZONE数据的导出和导入作业受到限制。">TIMESTAMP WITH TIMEZONE限制</a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="SUTIL4323"></a><a id="SUTIL4324"></a><a id="SUTIL4325"></a><a id="SUTIL4322"></a><div class="props_rev_3"><a id="GUID-EF3AF1D8-716B-4C3E-931D-52937A5175F1" name="GUID-EF3AF1D8-716B-4C3E-931D-52937A5175F1"></a><h5 id="SUTIL-GUID-EF3AF1D8-716B-4C3E-931D-52937A5175F1" class="sect5"><span class="enumeration_section">1.13.1.2带</span>时区数据的TIMESTAMP的数据泵支持</h5>
                     <div>
                        <p>Data Pump在不同的导出和导入模式（如非可传输模式，可传输表空间和可传输表模式以及完全可传输模式）期间支持<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据。
                        </p>
                        <p>本节介绍在源数据库和目标数据库上Oracle数据库时区文件的版本不同时，在不同的导出和导入模式下， <code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据的数据泵支持。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-EF3AF1D8-716B-4C3E-931D-52937A5175F1__GUID-B6D7D52C-5A63-4479-B732-8433BC8B155B">不可运输的模式</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果使用支持<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据（11.2.0.1或更高版本）的数据泵版本创建转储文件，则导出系统的时区文件版本将记录在转储文件中。Data Pump使用该信息来确定是否需要进行数据转换。如果目标数据库知道源时区版本，但实际上使用的是更高版本，则数据将转换为更高版本。<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据无法降级，因此如果您尝试导入使用时区文件的早期版本而非使用的源的目标，则导入将失败。
                                 </p>
                              </li>
                              <li>
                                 <p>如果使用Oracle Database <span class="italic">11g第</span> 2版（11.2.0.1）之前的数据泵版本创建转储文件，则不支持<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据，因此不会进行转换并可能发生损坏。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-EF3AF1D8-716B-4C3E-931D-52937A5175F1__GUID-306AD66A-A9D1-4035-ABBD-336770ADE243">可传输表空间和可传输表模式</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>在可传输表空间和可传输表模式中，如果源和目标具有不同的时区文件版本，则不会创建具有<code class="codeph">TIMESTAMP WITH TIME ZONE</code>列的表。作业开头会显示一条警告，显示源和目标数据库时区文件版本。还会为每个未创建的表显示一条消息。即使用于创建转储文件的数据泵版本支持<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据，也是如此。（版本11.2.0.1及更高版本支持<code class="codeph">TIMESTAMP WITH TIMEZONE</code>数据。）
                                 </p>
                              </li>
                              <li>
                                 <p>如果源早于Oracle Database <span class="italic">11g第</span> 2版（11.2.0.1），则所有可传输作业的源和目标数据库上的时区文件版本必须相同，无论可传输集是否使用<code class="codeph">TIMESTAMP WITH TIME ZONE</code>列。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-EF3AF1D8-716B-4C3E-931D-52937A5175F1__GUID-4E60A499-6C75-4F94-9CA0-13B1FF70243A">完全可移动模式</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>当源数据库至少是Oracle Database <span class="italic">11g第</span> 2版（11.2.0.3）且目标是Oracle Database 12c第1版（12.1）或更高版本时，支持完全可传输的导出和导入。
                           </p>
                           <p>Data Pump 11.2.0.1及更高版本为<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据提供支持。因此，在完全可传输的操作中，将创建具有<code class="codeph">TIMESTAMP WITH TIME ZONE</code>列的表。如果源和目标数据库具有不同的时区文件版本，则源中的<code class="codeph">TIMESTAMP WITH TIME ZONE</code>列将转换为目标的时区文件版本。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-EF3AF1D8-716B-4C3E-931D-52937A5175F1__GUID-91544DBB-B246-4082-9F94-304D109C167D">
                           <p class="notep1">也可以看看：</p>
                           <p></p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关可传输表空间的详细信息，请参见<a href="../admin/transporting-data.html#ADMIN10140" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a></p>
                              </li>
                              <li>
                                 <p><a href="oracle-data-pump-export-utility.html#GUID-079769D8-40F4-432F-88AD-E7264D7A2E2D__BEHFFGJG">在完整模式导出期间使用可传输选项</a>以获取有关完全可传输导出的更多信息</p>
                              </li>
                              <li>
                                 <p><a href="datapump-import-utility.html#GUID-E27D2DC9-A6D8-4F0B-AB72-6BF526B3AA18__BEHFEGFI">在完整模式下使用可传输选项导入</a>有关完全可传输导入的更多信息</p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-9B6C92EE-860E-43DD-9728-735B17B9DA89" title="具有TIMESTAMP WITH TIME ZONE数据的导出和导入作业受到限制。">TIMESTAMP WITH TIMEZONE限制</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="SUTIL4321"></a><div class="props_rev_3"><a id="GUID-4DABDB38-BEAA-471B-9026-F91CD22FD5C4" name="GUID-4DABDB38-BEAA-471B-9026-F91CD22FD5C4"></a><h5 id="SUTIL-GUID-4DABDB38-BEAA-471B-9026-F91CD22FD5C4" class="sect5"><span class="enumeration_section">1.13.1.3</span>源和目标上的时区文件版本</h5>
                     <div>
                        <p>成功完成作业可能取决于源和目标时区文件版本是否匹配。</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果源数据库和目标数据库上的Oracle数据库时区文件版本相同，则无需转换<code class="codeph">TIMESTAMP WITH TIME ZONE</code>数据。导出/导入作业应该成功完成。
                              </p>
                              <p>例外情况是使用早于11.2.0.1的数据泵版本执行的可传输表空间或可传输表导出。在这种情况下，即使源和目标上的时区文件版本相同，也不会在导入时创建转储文件中具有<code class="codeph">TIMESTAMP WITH TIME ZONE</code>列的表。
                              </p>
                           </li>
                           <li>
                              <p>如果目标数据库上的源时区文件版本不可用，则作业将失败。源上的时区文件版本可能在目标上不可用，因为源可能已将其时区文件更新为更高版本但目标尚未更新。例如，如果导出是在Oracle Database <span class="italic">11g第</span> 2版（11.2.0.2）上完成的，时区文件版本为17，并且导入是在11.2.0.2上完成的，只有16个时区文件可用，那么工作失败。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-9B6C92EE-860E-43DD-9728-735B17B9DA89" title="具有TIMESTAMP WITH TIME ZONE数据的导出和导入作业受到限制。">TIMESTAMP WITH TIMEZONE限制</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="SUTIL4326"></a><div class="props_rev_3"><a id="GUID-D8443A5E-BF6D-4329-AF11-8E5899356C64" name="GUID-D8443A5E-BF6D-4329-AF11-8E5899356C64"></a><h4 id="SUTIL-GUID-D8443A5E-BF6D-4329-AF11-8E5899356C64" class="sect4"><span class="enumeration_section">1.13.2具有</span>当地时区的TIMESTAMP限制</h4>
                  <div>
                     <p>使用可传输模式移动表受到限制。</p>
                     <p>如果使用可传输模式（可传输表，可传输表空间或完全可传输）移动表，并且存在以下条件，则会发出警告并且不会创建表：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>源数据库和目标数据库具有不同的数据库时区。</p>
                        </li>
                        <li>
                           <p>该表包含<code class="codeph">TIMESTAMP WITH LOCAL TIME ZONE</code>数据类型。
                           </p>
                        </li>
                     </ul>
                     <p>若要成功移动由于这些条件而未创建的表，请使用不可传输的导出和导入模式。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-7EE60BAB-0D3D-46EB-8E11-4FDDA68EF14E" title="本节介绍可能影响成功完成导出和导入作业的因素，这些作业涉及时间戳数据类型TIMESTAMP WITH TIMEZONE和TIMESTAMP WITH LOCAL TIMEZONE。">数据泵如何处理时间戳数据？</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="SUTIL4307"></a><div class="props_rev_3"><a id="GUID-72F01BF0-61F5-4775-8C7B-4E227F244866" name="GUID-72F01BF0-61F5-4775-8C7B-4E227F244866"></a><h3 id="SUTIL-GUID-72F01BF0-61F5-4775-8C7B-4E227F244866" class="sect3"><span class="enumeration_section">1.14</span>字符集和全球化支持注意事项</h3>
               <div>
                  <p>数据泵导出和导入的全球化支持行为。</p>
                  <p>这些部分描述了数据泵导出和导入的全球化支持行为，涉及用户数据和数据定义语言（DDL）的字符集转换。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-7B94D834-313B-4BA7-80F2-A29C1870DF27">数据定义语言（DDL）</a><br>导出实用程序使用导出系统的数据库字符集写入转储文件。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-A786A4B1-A913-4765-81F9-C877A6566F9C">单字节字符集和导出导入</a><br>确保导出数据库和导入数据库使用相同的字符集。
                     </li>
                     <li class="ulchildlink"><a href="oracle-data-pump-overview.html#GUID-5F23F5CF-82F0-4254-B865-20ED68F4AE31">多字节字符集和导出和导入</a><br>在字符集转换期间，导出文件中导入数据库字符集中没有等效项的任何字符都将替换为默认字符。导入数据库字符集定义默认字符。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               <a id="SUTIL4310"></a><div class="props_rev_3"><a id="GUID-7B94D834-313B-4BA7-80F2-A29C1870DF27" name="GUID-7B94D834-313B-4BA7-80F2-A29C1870DF27"></a><h4 id="SUTIL-GUID-7B94D834-313B-4BA7-80F2-A29C1870DF27" class="sect4"><span class="enumeration_section">1.14.1</span>数据定义语言（DDL）</h4>
                  <div>
                     <p>导出实用程序使用导出系统的数据库字符集写入转储文件。</p>
                     <p>导入转储文件时，仅当导入系统的数据库字符集与导出系统的数据库字符集不同时，才需要对DDL进行字符集转换。</p>
                     <p>若要最大限度地减少由于字符集转换而导致的数据丢失，请确保导入数据库字符集是导出数据库字符集的超集。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-72F01BF0-61F5-4775-8C7B-4E227F244866" title="数据泵导出和导入的全球化支持行为。">字符集和全球化支持注意事项</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL4311"></a><div class="props_rev_3"><a id="GUID-A786A4B1-A913-4765-81F9-C877A6566F9C" name="GUID-A786A4B1-A913-4765-81F9-C877A6566F9C"></a><h4 id="SUTIL-GUID-A786A4B1-A913-4765-81F9-C877A6566F9C" class="sect4"><span class="enumeration_section">1.14.2</span>单字节字符集和导出导入</h4>
                  <div>
                     <p>确保导出数据库和导入数据库使用相同的字符集。</p>
                     <p>如果进行导入的系统使用7位字符集，并导入8位字符集转储文件，则某些8位字符可能会转换为7位等效字符。发生这种情况的迹象是重音字符失去重音标记。</p>
                     <p>要避免此不需要的转换，请确保导出数据库和导入数据库使用相同的字符集。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-72F01BF0-61F5-4775-8C7B-4E227F244866" title="数据泵导出和导入的全球化支持行为。">字符集和全球化支持注意事项</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SUTIL4312"></a><div class="props_rev_3"><a id="GUID-5F23F5CF-82F0-4254-B865-20ED68F4AE31" name="GUID-5F23F5CF-82F0-4254-B865-20ED68F4AE31"></a><h4 id="SUTIL-GUID-5F23F5CF-82F0-4254-B865-20ED68F4AE31" class="sect4"><span class="enumeration_section">1.14.3</span>多字节字符集以及导出和导入</h4>
                  <div>
                     <p>在字符集转换期间，导出文件中导入数据库字符集中没有等效项的任何字符都将替换为默认字符。导入数据库字符集定义默认字符。</p>
                     <p>如果导入系统在转换DDL时必须使用替换字符，则会显示警告消息，系统会尝试加载已转换的DDL。</p>
                     <p>如果导入系统在转换用户数据时必须使用替换字符，则默认行为是加载转换后的数据。但是，可以指示导入系统拒绝使用替换字符转换的用户数据行。有关详细信息，请参阅导入<code class="codeph">DATA OPTIONS</code>参数。
                     </p>
                     <p>为了保证100％转换，导入数据库字符集必须是用于生成导出文件的字符集的超集（或等效）。</p>
                     <div class="infoboxnote" id="GUID-5F23F5CF-82F0-4254-B865-20ED68F4AE31__GUID-47BCA3F7-50F1-444B-BEDE-CFABB6000811">
                        <p class="notep1">警告：</p>
                        <p>当导出系统的数据库字符集与导入系统的数据库字符集不同时，导入系统会在作业开始时显示信息性消息，以显示数据库字符集的内容。</p>
                        <p>如果导入数据库字符集不是用于生成导出文件的字符集的超集，则导入系统会显示一条警告，指出由于字符集转换可能会丢失数据。</p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="datapump-import-utility.html#GUID-5FFA128D-B7F5-41D0-A72C-EB2CE384765D">DATA_OPTIONS</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-72F01BF0-61F5-4775-8C7B-4E227F244866" title="数据泵导出和导入的全球化支持行为。">字符集和全球化支持注意事项</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-B1A6BBA2-0269-48CC-8A0E-8E3955A231C0" name="GUID-B1A6BBA2-0269-48CC-8A0E-8E3955A231C0"></a><h3 id="SUTIL-GUID-B1A6BBA2-0269-48CC-8A0E-8E3955A231C0" class="sect3"><span class="enumeration_section">1.15</span>具有数据绑定排序规则的Oracle数据泵行为</h3>
               <div>
                  <p>Oracle Data Pump支持数据绑定归类（DBC）。</p>
                  <div class="p">Data Pump Export始终将所有可用的归类元数据包含到创建的转储文件中。这包括：<ul style="list-style-type:disc">
                        <li>
                           <p>导出的用户模式的当前默认排序规则</p>
                        </li>
                        <li>
                           <p>导出的表，视图，物化视图和PL / SQL单元（包括用户定义的类型）的当前默认排序规则</p>
                        </li>
                        <li>
                           <p>声明了所有表和集群字符数据类型列的归类</p>
                        </li>
                     </ul>
                  </div>
                  <p>导入从Oracle Database 12 <span class="italic">c</span> Release 2（12.2）数据库导出的转储文件时，Data Pump Import的行为取决于导入时Data Pump <code class="codeph">VERSION</code>参数的有效值以及数据绑定排序规则（DBC）功能已在目标数据库中启用。<code class="codeph">VERSION</code>参数的有效值由其指定方式决定。参数可以指定如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">VERSION= <span class="codeinlineitalic">n</span></code> ，表示有效值是特定版本号<code class="codeph"><span class="codeinlineitalic">n</span></code> ，例如， <code class="codeph">VERSION=12.2</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">VERSION=LATEST</code> ，表示有效值是当前正在运行的数据库版本</p>
                     </li>
                     <li>
                        <p><code class="codeph">VERSION=COMPATIBLE</code> ，表示有效值与数据库初始化参数<code class="codeph">COMPATIBLE</code>的值相同。如果没有为<code class="codeph">VERSION</code>指定值，也是如此。</p>
                     </li>
                  </ul>
                  <p>要在数据库中启用DBC功能，必须将初始化参数<code class="codeph">COMPATIBLE</code>设置为12.2或更高，并且必须将初始化参数<code class="codeph">MAX_STRING_SIZE</code>设置为<code class="codeph">EXTENDED</code> 。</p>
                  <p>如果Data Pump Import <code class="codeph">VERSION</code>参数的有效值为12.2且在目标数据库中启用了DBC，则Data Pump Import将生成DDL语句，其中collation子句引用转储文件中的collation元数据。使用源数据库中的原始排序规则元数据创建导出的对象。
                  </p>
                  <p>如果禁用DBC或将数据泵导入<code class="codeph">VERSION</code>参数设置为低于12.2的值，则不会生成排序规则语法。
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-data-pump-overview.html#GUID-17FAE261-0972-4220-A2E4-44D479F519D4" title="Oracle Data Pump技术可以将数据和元数据从一个数据库高速移动到另一个数据库。">Oracle Data Pump概述</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html><html id="13348.downgrading-oracle-db-after-upgrade.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="For supported releases of Oracle Database, you can downgrade a database to the release from which you last upgraded."></meta>
      <meta name="description" content="For supported releases of Oracle Database, you can downgrade a database to the release from which you last upgraded."></meta>
      <title>将Oracle数据库降级为早期版本</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Upgrade Guide"></meta>
      <meta property="og:description" content="For supported releases of Oracle Database, you can downgrade a database to the release from which you last upgraded."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Upgrade Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-upgrade-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-25T08:26:31-07:00"></meta>
      <meta name="dcterms.title" content="Database Upgrade Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96252-05"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="upgrading-oracle-forms-oracle-developer-applications.html" title="Previous" type="text/html"></link>
      <link rel="next" href="migrating-data-after-upgrade-oracle.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="UPGRD"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="upgrading-oracle-forms-oracle-developer-applications.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="migrating-data-after-upgrade-oracle.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库升级指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">将Oracle数据库降级为早期版本</li>
            </ol>
            <a id="GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" name="GUID-CAD9888A-2E6E-48F8-938C-B3E861738606"></a><a id="UPGRD007"></a>
            
            <h2 id="UPGRD-GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" class="sect2"><span class="enumeration_chapter">7将</span> Oracle数据库降级为早期版本</h2>
         </header>
         <div class="ind">
            <div>
               <p>对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。</p>
               <p>例如，如果您最近升级了Oracle Database 12c版本1（12.1.0.2（发布版本为19c，并且未将兼容初始化参数更改为19.1.0，则可以降级到版本12.1.0.2）。</p>
               <p>话题：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F">支持降级Oracle数据库的版本</a><br>您可以根据升级数据库的原始Oracle数据库版本降级主要版本并发布更新或补丁集版本。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010">降级Oracle数据库时检查不兼容性</a><br>要查看数据库是否存在可能阻止您降级的不兼容性，请检查数据库的兼容级别。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-FFECBDB5-6FA3-4A32-B817-BCBCE4C93C4B">在降级Oracle数据库之前执行完全备份</a><br>Oracle强烈建议您在降级到受支持的早期版本之前执行新Oracle数据库发行版的完整备份。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73">执行Oracle数据库所需的预迁移步骤</a><br>在将Oracle数据库降级到升级的早期版本之前，请完成此处所述的必需准备步骤。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E">使用脚本降级CDB或非CDB Oracle数据库</a><br>为了自动降级，从Oracle Database 19c开始，Oracle提供了<code class="codeph">dbdowngrade</code>实用程序脚本。必要时，您还可以继续手动运行<code class="codeph">catdwgrd.sql</code> ，与以前的版本一样。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-F1FB354D-8C53-4E80-A4C9-A6366055028C">关于具有组件状态选项关闭的降级和无效对象</a><br>从降级版本的Oracle数据库标准版到带有CDB和PDBS的Oracle Database 12c标准版的降级包含更高版本后发布的无效对象。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F">降级单个可插拔Oracle数据库（PDB）</a><br>如果您要降级Oracle数据库，则可以降级一个PDB而不降级整个CDB。</li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-EEC355DD-AA56-4972-9EB3-139CEC457D65">降级包含Oracle Application Express的PDB</a><br>在降级包含Oracle Application Express的PDB时，请使用此过程来避免APEX_050000错误导致的INVALID OBJECTS。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5">Oracle数据库降级后降级任务降级</a><br>由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。
                  </li>
                  <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA">对Oracle数据库降级进行故障排除</a><br>使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。
                  </li>
               </ul>
            </div>
            <a id="UPGRD00710"></a><div class="props_rev_3"><a id="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F" name="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F"></a><h3 id="UPGRD-GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F" class="sect3">支持降级Oracle数据库的版本</h3>
               <div>
                  <p>您可以根据升级数据库的原始Oracle数据库版本降级主要版本并发布更新或补丁集版本。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F__GUID-7580F70A-93C8-4024-82C2-53847CE00E09">降级支持的版本</p>
                     <p>您可以将非CDB Oracle数据库从Oracle Database 19c降级到Oracle Database 18c，Oracle Database 12c和Oracle Database 11g 11.2.0.4版。</p>
                     <p>您可以将PDB或CDB从Oracle Database 19c降级到Oracle Database 18c或Oracle Database 12c Release 2（12.2.0.1）</p>
                     <p>您可以将PDB或CDB降级到Oracle数据库18c，Oracle Database 12c版本12.2和Oracle Database 12c版本12.1.0.2。</p>
                     <div class="infoboxnote" id="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F__GUID-36FA6D07-0897-417C-9C5A-E686B44E8613">
                        <p class="notep1">注意：</p>
                        <p>从Oracle Database 12c第1版（12.1）开始，不推荐使用非CDB体系结构。它可以在将来的版本中得到支持。</p>
                     </div>
                     <p>下表提供了有关降级支持的版本的其他信息。使用此表时，还请阅读“在降级Oracle数据库时检查不兼容性”中的兼容性。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F__CACGDDHC">
                     <p class="titleintable">表7-1降级支持的版本和版本</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="降级支持的版本和版本" width="100%" border="1" summary="Column 1 indicates if a release is supported for upgrade. Column 2 indicates if you can downgrade to the release specified in column 1. Column 3 provides further information about each release." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d51852e254">Oracle数据库发行版或版本</th>
                              <th align="left" valign="bottom" width="21%" id="d51852e257">可降级（是/否）</th>
                              <th align="left" valign="bottom" width="59%" id="d51852e260">笔记</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d51852e265" headers="d51852e254 ">
                                 <p>18</p>
                              </td>
                              <td align="left" valign="top" width="21%" headers="d51852e265 d51852e257 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="59%" headers="d51852e265 d51852e260 ">
                                 <p>目前没有其他信息。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d51852e275" headers="d51852e254 ">
                                 <p>12.2.0.1和12.1.0.2</p>
                              </td>
                              <td align="left" valign="top" width="21%" headers="d51852e275 d51852e257 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="59%" headers="d51852e275 d51852e260 ">
                                 <p>将兼容的初始化参数设置为12.1.0.2后，无法降级数据库。</p>
                                 <p>您可以将非CDB从19降级到18，或12.2降级到12.1.0.2或11.2.0.4（所有支持的升级版本）。</p>
                                 <p>在降级CDB之前，或在拔出和降级PDB之前，请安装最新的版本更新，版本修订，捆绑补丁或补丁集更新（BP或PSU）。可以在My Oracle Support上下载修补程序。请参阅My Oracle Support说明756671.1以获取最新的补丁集。</p>
                                 <p>您无法降级到早于新Oracle Database发行版的最低兼容性设置的版本。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d51852e291" headers="d51852e254 ">
                                 <p>Oracle企业管理器</p>
                              </td>
                              <td align="left" valign="top" width="21%" headers="d51852e291 d51852e257 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="59%" headers="d51852e291 d51852e260 ">
                                 <p>如果降级到早期支持的版本，则必须重新配置Oracle Enterprise Manager控件。</p>
                                 <p>在开始升级之前，必须使用<code>emdwgrd</code>实用程序来保存数据库控制文件和数据，以便在降级后还原Oracle Enterprise Manager数据库控制（数据库控制）。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d51852e306" headers="d51852e254 ">
                                 <p>Oracle数据库快捷版</p>
                              </td>
                              <td align="left" valign="top" width="21%" headers="d51852e306 d51852e257 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="59%" headers="d51852e306 d51852e260 ">
                                 <p>您无法降级从Oracle Database Express Edition升级的数据库。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-59F92E2A-DC4D-46A3-9AC9-63F47BE4A86F__GUID-006B7A89-4476-43AD-B026-5AFC731765B8">降级前的审核建议</p>
                     <p>针对早期支持的版本的以下建议会影响Oracle数据库的降级：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>多租户架构为多租户容器数据库（CDB）和可插拔数据库（PDB）提供架构功能。如果要升级到多租户体系结构，并且在升级到此版本后将兼容的初始化参数设置为最高级别，则升级后无法降级数据库。</p>
                        </li>
                        <li>
                           <p>除了<code class="codeph">SELECT</code>之外，此版本还包含一个新的对象权限<code class="codeph">READ</code> 。降级后，请注意此对象权限的以下含义：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果您具有<code class="codeph">SELECT</code>和<code class="codeph">READ</code>对象权限，则删除<code class="codeph">READ</code>权限。
                                 </p>
                              </li>
                              <li>
                                 <p>如果以前只具有<code class="codeph">READ</code>对象权限，则<code class="codeph">READ</code>对象权限将转换为<code class="codeph">SELECT</code>对象权限。
                                 </p>
                              </li>
                           </ul>
                           <p>有关READ和SELECT对象权限的更多信息，请参阅Oracle数据库安全指南。</p>
                        </li>
                        <li>
                           <p>如果在升级的数据库中未安装Oracle XML DB，则在降级期间，将卸载Oracle XML DB。例如，如果未在Oracle Database 11g第2版（11.2）中安装Oracle XML DB，则Oracle XML DB随Oracle Database 12c一起安装。如果降级数据库，则会在降级过程中卸载Oracle XML DB。Oracle Database DB默认包含在Oracle Database 12c第1版（12.1）及更高版本中。</p>
                        </li>
                        <li>
                           <p>在升级到Oracle Database 12c期间，将删除数据库（DB）控制存储库。如果降级到早期版本，则必须重新配置数据库（DB）控件以在降级后使用它。</p>
                        </li>
                        <li>
                           <p>Oracle Enterprise Manager不支持降级。如果降级到早期支持的版本，则必须重新配置Oracle Enterprise Manager控件。</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="https://support.oracle.com/rs?type=doc&amp;id=756671.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=756671.1</a></li>
                        <li><a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG992" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
            </div><a id="UPGRD12554"></a><div class="props_rev_3"><a id="GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010" name="GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010"></a><h3 id="UPGRD-GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010" class="sect3">降级Oracle数据库时检查不兼容性</h3>
               <div>
                  <p>要查看数据库是否存在可能阻止您降级的不兼容性，请检查数据库的兼容级别。</p>
                  <p>如果Oracle Database 12 <span class="italic">c</span>数据库的兼容级别为<code class="codeph">12.1.0</code> ，则无法降级。
                  </p>
                  <p>如果要降级到Oracle Database <span class="italic">11g第</span> 2版，则将<code class="codeph">COMPATIBLE</code>初始化参数设置为<code class="codeph">11.2.0</code>或更低。
                  </p>
                  <div class="infoboxnote" id="GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010__GUID-FBB1C572-0428-4DDF-A91B-C8254E2AA0F7">
                     <p class="notep1">注意：</p>
                     <p>对于Oracle ASM磁盘组，如果在升级数据库时将磁盘组兼容性更改为12.1.0.0.0，则在降级到早期版本时，无法装入Oracle ASM磁盘组。</p>
                     <p>在降级之前，必须手动恢复Oracle ASM磁盘组的兼容性。否则，实例无法在降级后装入磁盘组。</p>
                  </div>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-16E57DCD-0136-4E2D-8EB8-CE5572FCB010__GUID-CD3BD861-78B5-4A28-A46F-8B9CF766AC98">
                     <p class="notep1">也可以看看：</p>
                     <p>有关Oracle ASM磁盘组兼容性的信息，请参见<a href="../ostmg/diskgroup-compatibility.html#OSTMG02700" target="_blank"><span class="italic">“Oracle自动存储管理管理员指南”</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD12555"></a><div class="props_rev_3"><a id="GUID-FFECBDB5-6FA3-4A32-B817-BCBCE4C93C4B" name="GUID-FFECBDB5-6FA3-4A32-B817-BCBCE4C93C4B"></a><h3 id="UPGRD-GUID-FFECBDB5-6FA3-4A32-B817-BCBCE4C93C4B" class="sect3">在降级Oracle数据库之前执行完全备份</h3>
               <div>
                  <p>Oracle强烈建议您在降级到受支持的早期版本之前执行新Oracle数据库发行版的完整备份。</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-FFECBDB5-6FA3-4A32-B817-BCBCE4C93C4B__GUID-7B294ABB-E676-4E24-8DEE-D1A2073F56BC">
                     <p class="notep1">也可以看看：</p>
                     <p>有关执行RMAN备份的信息，请参见<a href="../bradv/backing-up-database.html#BRADV8003" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD60142"></a><div class="props_rev_3"><a id="GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73" name="GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73"></a><h3 id="UPGRD-GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73" class="sect3">执行Oracle数据库所需的预迁移步骤</h3>
               <div>
                  <p>在将Oracle数据库降级到升级的早期版本之前，请完成此处所述的必需准备步骤。</p>
                  <p>在开始降级之前，必须解决数据库版本之间的不兼容问题。例如，确定在开始降级之前是否必须禁用数据库中的组件。</p>
                  <ol>
                     <li>
                        <p>如果要降级CDB或拔出并降级Oracle数据库中的PDB，则必须先应用最新的季度版本更新（更新），版本更新版本（修订版），捆绑补丁或补丁集更新（BP或PSU）。在My Oracle Support Note 756671.1上应用任何必需的其他修补程序：</p>
                        <p><a href="https://support.oracle.com/rs?type=doc&amp;id=756671.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=756671.1</a></p>
                     </li>
                     <li>
                        <p>如果已在数据库上启用Oracle Database Vault，则在降级数据库之前禁用Oracle Database Vault。</p>
                        <p>使用DBA_DV_STATUS查明是否启用了Oracle Database Vault：</p><pre class="pre codeblock"><code>SQL&gt; SELECT * FROM DBA_DV_STATUS;</code></pre><p>如果输出为<samp class="sysout">TRUE</samp> ，则启用Oracle Database Vault，因此必须禁用它。
                        </p>
                        <p>在多租户架构Oracle数据库系统上，使用CDB $ ROOT上的CDB_DV_STATUS查找插入CDB的所有PDB上的Oracle Database Vault状态：</p><pre class="pre codeblock"><code>SQL&gt; SELECT * FROM CDB_DV_STATUS;</code></pre></li>
                     <li>
                        <p>如果您的数据库使用Oracle Label Security，并且您要降级到版本11.2，则在新的Oracle Database 12 <span class="italic">c</span> Oracle主目录中运行Oracle Label Security（OLS）预处理降级<code>olspredowngrade.sql</code>脚本。
                        </p>
                        <div class="infoboxnote" id="GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73__GUID-DB90FA0E-7DD8-49FC-8AB7-2208F617E001">
                           <p class="notep1">警告：</p>
                           <p>对于使用Oracle Label Security和Oracle Database Vault的数据库，在从Oracle Database 12 <span class="italic">c</span>降级到数据库版本11.2之前运行<code>olspredowngrade.sql</code> 。
                           </p>
                        </div>
                        <ol type="a">
                           <li>
                              <p>查询<code class="codeph">V$OPTION</code>动态视图。确定是否已启用Oracle Label Security。例如：</p><pre class="pre codeblock"><code>SQL&gt; SELECT VALUE FROM V $ OPTION WHERE PARAMETER ='Oracle Label Security';</code></pre></li>
                           <li>
                              <p>运行<code>olspredowngrade.sql</code>脚本：</p><pre class="pre codeblock"><code>SQL&gt; @ <span class="variable" translate="no">ORACLE_HOME</span> /rdbms/admin/olspredowngrade.sql</code></pre></li>
                        </ol>
                     </li>
                     <li>
                        <p>如果已启用统一审核，则可以选择备份和清除统一审核跟踪：</p>
                        <ol type="a">
                           <li>
                              <p>查找是否存在统一审计记录。</p><pre class="pre codeblock"><code>SQL&gt; SELECT COUNT（*）FROM UNIFIED_AUDIT_TRAIL;</code></pre></li>
                           <li>
                              <p>将现有审计数据备份到表中。例如：</p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE UA_DATA AS（SELECT * FROM UNIFIED_AUDIT_TRAIL）;</code></pre></li>
                           <li>
                              <p>清理审计跟踪。</p><pre class="pre codeblock"><code>EXEC DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL（audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED，use_last_arch_timestamp =&gt; FALSE）;</code></pre></li>
                        </ol>
                     </li>
                     <li>
                        <p>在降级之前，请确保降级数据库的目标Oracle Home包含数据库正在使用的时区文件的版本。</p>
                        <p>要查找数据库当前使用的时区文件版本，请使用以下命令查询<code class="codeph">V$TIMEZONE_FILE</code> ：</p><pre class="pre codeblock"><code>SQL&gt; select * from V $ TIMEZONE_FILE;</code></pre><p>例如：</p>
                        <p>如果查询在<code class="codeph">V$TIMEZONE_FILE.FILENAME</code>列中返回<code class="codeph">timezlrg_18.dat</code> ，则检查该文件是否存在于目标Oracle Home中：</p>
                        <p>Linux和UNIX</p><pre class="pre codeblock"><code>$ ORACLE_HOME / oracore / zoneinfo中/ timezlrg_18.dat</code></pre><p>视窗</p><pre class="pre codeblock"><code>％ORACLE_HOME％\ oracore \区信息\ timezlrg_18.dat</code></pre><p>如果目标Oracle Home中缺少所需的时区文件，请执行以下操作之一：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果您将当前版本的时区文件安装为修补程序，并且仍然知道修补程序编号，则使用相同的修补程序编号从My Oracle Support网站下载目标版本的相应时区文件。</p>
                           </li>
                           <li>
                              <p>使用My Oracle Support网站修补程序搜索功能找到正确的修补程序。输入以下搜索条件：“产品是'Oracle数据库'”，“发布是' <span class="variable" translate="no">target release</span> '”，“描述包含'DST'”。
                              </p>
                           </li>
                           <li>
                              <p>如果您无法在My Oracle Support网站上找到该修补程序，请使用Oracle Support记录服务请求。</p>
                           </li>
                        </ul>
                        <p>找到并下载所需的修补程序后，将其安装在目标Oracle主目录中。</p>
                     </li>
                     <li>
                        <p>如果您基于固定对象创建了对象，则删除这些对象以避免可能的<samp class="sysout">ORA-00600</samp>错误。您可以在降级后重新创建这些对象。
                        </p>
                     </li>
                     <li>
                        <p>如果在数据库中配置了Oracle Enterprise Manager，则删除企业管理器用户：</p><pre class="pre codeblock"><code>DROP USER sysman CASCADE;</code></pre><div class="infoboxnote" id="GUID-FC6DF99A-F32B-4258-8E5B-2DB5D7AD2A73__GUID-F8A87770-0FB2-4E6A-8DE3-B0DCE168DE9A">
                           <p class="notep1">注意：</p>
                           <p>删除企业管理器用户后，您会发现<code class="codeph">MGMT*</code>同义词无效。您必须重新配置Oracle Enterprise Manager以使用降级数据库中的任何Oracle Enterprise Manager控件。
                           </p>
                        </div>
                     </li>
                     <li>
                        <p>如果您要降级到已应用JSON捆绑补丁且使用简单Oracle文档访问（SODA）的Oracle Database 12 <span class="italic">c第</span> 1版（12.1.0.2），请确保应用JSON捆绑补丁（JSON补丁捆绑包1或JSON Patch Bundle 2）到Oracle Database 12.1.0.2二进制文件。有关更多信息，请查看以下My Oracle Support说明：</p>
                        <p><a href="https://support.oracle.com/rs?type=doc&amp;id=1992767.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=1992767.1</a></p>
                     </li>
                     <li>
                        <p>从为您的版本列出的PSE获取适用于您的服务器操作系统的ARU。在开始降级之前，请下载并安装为早期版本列出的所有补丁：</p>
                        <ol type="a">
                           <li>
                              <p>登录My Oracle Support：</p>
                              <p><a href="https://support.oracle.com" target="_blank">https://support.oracle.com</a></p>
                           </li>
                           <li>
                              <p>选择<span class="uicontrol bold">修补程序和更新</span> 。在“ <span class="wintitle">修补程序搜索”</span>框中，提供为您的版本列出的错误编号，并为您的服务器提供平台。
                              </p>
                           </li>
                           <li>
                              <p>下载并安装补丁</p>
                           </li>
                           <li>
                              <p>重复操作，直到为服务器安装了所有必需的修补程序。</p>
                           </li>
                        </ol>
                        <p>获取适用于您的版本的补丁：</p>
                        <p>从18c降级到12.2</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>2414935.1：在将Oracle GI和DB升级到18c之前要应用的修补程序</p>
                           </li>
                           <li>
                              <p>2118136.2：助手：下载Oracle数据库/ GI更新，版本，PSU，SPU（CPU），软件包补丁，补丁集和基本版本的参考</p>
                           </li>
                        </ul>
                        <p>用CDB和PDB从18c降级到12.1.0.2.0</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>25755742：数据库补丁设置更新12.1.0.2.170718或最新的12.1.0.2.0数据库补丁集更新</p>
                           </li>
                           <li>
                              <p>24438034：CDB_UPG：12101 CDB UPGRADE LEFT OBJECT CDB_JAVA_POLICY INVALID</p>
                           </li>
                           <li>
                              <p>20348910：使用创建或替换类型替换PRVTAQJI.SQL中的ALTER TYPE替换</p>
                           </li>
                           <li>
                              <p>20958816：从12.2.0.1降至12.1.0.2之后的无效对象</p>
                           </li>
                        </ul>
                        <p>非CDB从18c降至12.1.0.2.0</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>25755742：数据库补丁设置更新12.1.0.2.170718或最新的12.1.0.2.0数据库补丁集更新</p>
                           </li>
                           <li>
                              <p>24438034：CDB_UPG：12101 CDB UPGRADE LEFT OBJECT CDB_JAVA_POLICY INVALID</p>
                           </li>
                           <li>
                              <p>20348910：使用创建或替换类型替换PRVTAQJI.SQL中的ALTER TYPE替换</p>
                           </li>
                           <li>
                              <p>20958816：从12.2.0.1降至12.1.0.2之后的无效对象</p>
                           </li>
                           <li>
                              <p>21856522：升级12.1到12.2导致XOQ组件无效</p>
                           </li>
                        </ul>
                        <p>从18c降级到11.2.0.4.0</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>23054359：数据库补丁设置更新11.2.0.4</p>
                           </li>
                           <li>
                              <p>20898997：XMLTYPESUP：QCTOXSNLB不应检查快照尺寸</p>
                           </li>
                           <li>
                              <p>20348910：使用创建或替换类型替换PRVTAQJI.SQL中的ALTER TYPE替换</p>
                           </li>
                        </ul>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="../olsag/performing-dba-functions-under-oracle-label-security.html#OLSAG3416" target="_blank"><span><cite>Oracle Label Security管理员指南</cite></span></a></li>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=NLSPG004" target="_blank"><span><cite>Oracle数据库全球化支持指南</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E" name="GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E"></a><h3 id="UPGRD-GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E" class="sect3">使用脚本降级CDB或非CDB Oracle数据库</h3>
               <div>
                  <p>为了自动降级，从Oracle Database 19c开始，Oracle提供了<code class="codeph">dbdowngrade</code>实用程序脚本。必要时，您还可以继续手动运行<code class="codeph">catdwgrd.sql</code> ，与以前的版本一样。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-EAF290FD-5F22-4FEE-829D-B3587168471F">使用Dbdowngrade降级CDB和非CDB Oracle数据库</a><br>要将Oracle数据库降级到早期支持的主要版本或更早版本更新，Oracle建议您运行降级脚本<code class="codeph">dbdowngrade</code> 。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-0227D321-577E-47C5-A8C0-36991B8D0357">使用catdwgrd.sql手动降级CDB或非CDB Oracle数据库</a><br>您可以运行手动<code class="codeph">catdwgrd.sql</code>脚本以将Oracle数据库降级到较早的受支持主要版本或早期版本更新，您可能希望运行手动脚本，或者希望避免过多的线程问题。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F" name="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F"></a><h4 id="UPGRD-GUID-EAF290FD-5F22-4FEE-829D-B3587168471F" class="sect4">使用Dbdowngrade降级CDB和非CDB Oracle数据库</h4>
                  <div>
                     <p>要将Oracle数据库降级到早期支持的主要版本或更早版本更新，Oracle建议您运行降级脚本<code class="codeph">dbdowngrade</code> 。
                     </p>
                     <div class="section">
                        <p>从Oracle Database 19c开始，Oracle提供了降级实用程序脚本<code class="codeph">dbdowngrade</code> 。当您使用dbdowngrade实用程序时，它会为降级设置适当的值，并简化您开始降级的方式。具体来说，它确保对<code class="codeph">catcon.pl</code>的底层调用使用建议值，从而减少由于生成过多线程而导致的潜在错误。此功能对于多租户架构（CDB）数据库的降级特别有价值。当存在过多线程的可能性时，您可以通过手动运行<code class="codeph">catdwgrd.sql</code>脚本来继续降级，就像在以前的版本中一样。
                        </p>
                        <p><code class="codeph">dbdowngrade</code> shell命令位于Linux和Unix上的文件路径<code class="codeph">$ORACLE_HOME/bin</code> ，以及基于Microsoft Windows的系统上的<code class="codeph">%ORACLE_HOME%\bin</code> 。如果要降级CDB，则可以将包含列表作为脚本的参数提供。
                        </p>
                        <p>当您降级多租户架构数据库（CDB）时， <code class="codeph">dbdowngrade</code>脚本有两种行为，具体取决于您是否使用包含列表。
                        </p>
                        <ul id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F__UL_BW3_4YD_CGB" style="list-style-type:disc">
                           <li>
                              <p><span class="bold">没有包含列表</span> 。降级将在CDB（PDB和CDB）中打开的所有容器上运行。
                              </p>
                              <p>如果要降级整个CDB，请运行不带包含列表的降级。在这种情况下，所有打开的容器都会降级。在启动<code class="codeph">dbdowngrade</code>脚本之前，必须手动打开CDB中的所有PDB。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">包含列表</span> 。降级仅在包含列表中的PDB上运行，并且在降级操作期间CDB $ ROOT不会降级。
                              </p>
                              <p>如果只想降级包含列表中列出的PDB集，请使用包含列表运行降级。在此方案中，您要使用拔出和插件升级，只会降低您在包含列表中列出的一组PDB。不在包含列表中的CDB和PDB仍然升级到更高版本。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="p">
                        <p>先决条件：</p>
                        <ul id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F__UL_ZKW_RZD_CGB" style="list-style-type:disc">
                           <li>
                              <p>如果要从Oracle Database 19c降级到Oracle Database 18c，Oracle Database 12.2或Oracle Database 12.1，则可以降级多租户容器数据库（CDB）中的所有数据库或CDB中的一个可插拔数据库（PDB）。早于Oracle Database 12c的Oracle数据库版本不使用多租户架构。</p>
                           </li>
                           <li>如果在没有包含列表的情况下降级，则必须在运行<code class="codeph">dbdowngrade</code>脚本之前打开所有PDB容器。
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>将ORACLE_HOME环境变量设置为已升级的Oracle数据库版本的Oracle主目录</span></li>
                        <li class="stepexpand"><span>将ORACLE_SID环境变量设置为要降级的Oracle数据库。</span></li>
                        <li class="stepexpand"><span>使用默认值或包含列表启动<code class="codeph">dbdowngrade</code>脚本。</span><div>
                              <p>如果您使用包含列表，则CDB $ ROOT不得在您的包含列表中。</p>
                           </div>
                           <div>
                              <p>例如：</p><code>使用默认值运行</code><p>Linux和Unix</p><pre class="pre codeblock"><code>$ cd $ ORACLE_HOME / bin $。/ dbdowngrade</code></pre><p>微软Windows</p><pre class="pre codeblock"><code>$ cd％ORACLE_HOME％\ bin $ dbdowngrade.cmd</code></pre><code>与CDB的包含列表一起运行</code><p>Linux和Unix</p><pre class="pre codeblock"><code>$ cd $ ORACLE_HOME / bin $。/ dbdowngrade -c'PDB1 PDB2 PDBN'</code></pre><p>微软Windows</p><pre class="pre codeblock"><code>$ cd％ORACLE_HOME％\ bin $ dbdowngrade.cmd -c“PDB1 PDB2 PDBN”</code></pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>运行<code class="codeph">dbdowngrade</code>脚本后，该实用程序将运行<code class="codeph">catdwgrd</code>和<code class="codeph">catcon.pl</code> 。这些脚本使用您要降级的版本的建议值来执行降级。由降级脚本生成的日志文件放在这三个选项之一的第一个目录下，按顺序排列：</p>
                        <ul id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F__UL_YDR_3PJ_CGB" style="list-style-type:disc">
                           <li>
                              <p>由<code class="codeph">orabasehome</code>命令标识的Oracle基础主<code class="codeph">orabasehome</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">orabase</code>命令标识的Oracle基础主<code class="codeph">orabase</code></p>
                           </li>
                           <li>
                              <p>由<code class="codeph">oracle_home</code>命令标识的Oracle主目录</p>
                           </li>
                        </ul>
                        <div class="p">例如：<pre class="pre codeblock"><code>$ $ ORACLE_HOME / bin / orabasehome /u01/app/oracle/product/19.0.0/dbhome_1</code></pre>在此示例中，$ ORACLE_BASE目录为<code class="codeph">/u01/app/oracle/product/19.0.0/dbhome_1</code> ，日志位于<code class="codeph">/u01/app/oracle/product/19.0.0/dbhome_1/cfgtoollogs/downgrade</code> 。在目录中，日志文件以字符串<code class="codeph">catdwgrd</code>为前缀。
                        </div>
                        <div class="infoboxnote" id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F__GUID-0799D96A-CE03-4F8C-BA04-517CAE3272D6">
                           <p class="notep1">注意：</p>
                           <ul id="GUID-EAF290FD-5F22-4FEE-829D-B3587168471F__UL_ODW_TJJ_CGB" style="list-style-type:disc">
                              <li>
                                 <p>读写Oracle家庭：命令<code class="codeph">orabaseconfig</code>和<code class="codeph">orabasehome</code>都返回ORACLE_HOME的环境设置。</p>
                              </li>
                              <li>
                                 <p>只读Oracle主目录：命令<code class="codeph">orabaseconfig</code>在路径<code class="codeph">$ORACLE_BASE/homes</code>返回Oracle基础的只读路径配置。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E" title="为了自动降级，从Oracle Database 19c开始，Oracle提供了dbdowngrade实用程序脚本。必要时，您还可以继续手动运行catdwgrd.sql，与以前的版本一样。">使用脚本降级CDB或非CDB Oracle数据库</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357" name="GUID-0227D321-577E-47C5-A8C0-36991B8D0357"></a><h4 id="UPGRD-GUID-0227D321-577E-47C5-A8C0-36991B8D0357" class="sect4">使用catdwgrd.sql手动降级CDB或非CDB Oracle数据库</h4>
                  <div>
                     <p>您可以运行手动<code class="codeph">catdwgrd.sql</code>脚本以将Oracle数据库降级到较早的受支持主要版本或早期版本更新，您可能希望运行手动脚本，或者希望避免过多的线程问题。
                     </p>
                     <div class="section">
                        <p>如果要从Oracle Database 19c降级到Oracle Database 18c，Oracle Database 12.2或Oracle Database 12.1，则可以降级多租户容器数据库（CDB）中的所有数据库或CDB中的一个可插拔数据库（PDB）。早于Oracle Database 12c的Oracle数据库版本不使用多租户架构。</p>
                        <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-33208AE2-97CD-4E76-A3AE-A709BEE94AE6">
                           <p class="notep1">注意：</p>
                           <p>从Oracle Database 12c第1版（12.1）开始，不推荐使用非CDB体系结构。它可以在将来的版本中得到支持。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以Oracle Database Oracle主目录的所有者身份登录系统。</span></li>
                        <li class="stepexpand"><span>在系统提示符下，切换到目录<code class="codeph"><span class="variable" translate="no">ORACLE_HOME</span> /rdbms/admin</code> ，其中<code class="codeph"><span class="variable" translate="no">ORACLE_HOME</span></code>是系统上的Oracle主目录。</span><div>
                              <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-A7F329F3-06E7-469E-A4F1-10C2BA6EF7E4">
                                 <p class="notep1">注意：</p>
                                 <p>如果要降级群集数据库，请完全关闭数据库，并将初始化参数<code class="codeph">CLUSTER_DATABASE</code>的值更改为<code class="codeph">FALSE</code> 。降级后，将此参数设置为<code class="codeph">TRUE</code> 。</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用SQL * Plus，以具有<code class="codeph">SYSDBA</code>权限的用户身份连接到数据库实例：</span><div><pre class="pre codeblock"><code>sqlplus sys as sysdba输入密码： <span class="variable" translate="no">password</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>以新Oracle数据库发行版Oracle主目录的Oracle用户（所有者）身份登录系统。</span></li>
                        <li class="stepexpand"><span>将目录更改为<code class="codeph"><span class="variable" translate="no">ORACLE_HOME</span> /rdbms/admin</code> ，然后启动SQL * Plus。</span></li>
                        <li class="stepexpand"><span>使用具有DBA权限的帐户连接到要升级的数据库：</span><div><pre class="pre codeblock"><code>CONNECT / AS SYSDBA</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>通过为Oracle数据库实例类型发出以下SQL * Plus命令，以降级模式启动实例。您可能需要使用<code class="codeph">PFILE</code>选项指定初始化参数文件的位置。</span><ul>
                              <li>
                                 <p>非CDB实例：</p><pre class="pre codeblock"><code>SQL&gt; startup downgrade pfile = <span class="variable" translate="no">pfile_name</span>
</code></pre></li>
                              <li>
                                 <p>CDB实例：</p><pre class="pre codeblock"><code>SQL&gt; startup downgrade pfile = <span class="variable" translate="no">pfile_name</span> SQL&gt; alter pluggable database all open downgrade;</code></pre></li>
                           </ul>
                           <div>
                              <p>指定初始化参数文件<code class="codeph">PFILE</code>的位置。</p>
                              <div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-072F0FC7-6B87-4CC6-B0F0-B6CB3FD90EA0">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关在启动时指定初始化参数和初始化参数文件的信息，请参见<a href="../admin/starting-up-and-shutting-down.html#ADMIN12825" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>（可选）如果要降级非CDB，则可以将系统设置为将结果假脱机到日志文件，以便跟踪更改和问题。</span><div>
                              <p>如果要降级CDB，则无需执行此步骤。CDB自动将输出假脱机到<code class="codeph">catcon_logs</code> 。
                              </p>
                              <p>在非CDB上，输入以下命令将结果假脱机到日志文件，其中<code class="codeph">downgrade.log</code>是日志文件的名称：</p>
                           </div>
                           <div><pre class="pre codeblock"><code>SQL&gt; SPOOL downgrade.log</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>使用以下命令启动降级，具体取决于您的配置：</span><ul>
                              <li>
                                 <p>非国开行：</p><pre class="pre codeblock"><code>SQL&gt; @ catdwgrd.sql</code></pre></li>
                              <li>
                                 <p>CDB：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -d $ ORACLE_HOME / rdbms / admin -e -b catdwgrd -l <span class="variable" translate="no">output directory</span> -r catdwgrd.sql</code></pre></li>
                           </ul>
                           <div>
                              <p>在CDB示例中， <code>catdwgrd.sql</code>使用<code>catcon.pl</code>在容器上运行。要使用<code>catcon.pl</code>实用程序运行命令，首先要启动Perl。<code class="codeph">-d</code>参数告诉<code>catcon.pl</code>在哪里找到<code>catdwgrd</code> 。<code class="codeph">-l</code>参数指定日志文件的输出目录（而不是写入<code>rdbms/admin</code>目录）。指定<code class="codeph">-r</code>参数会导致<code>catdwgrd</code>首先在PDB上运行，第二个在CDB_ROOT上运行。</p>
                              <p>降级CDB时使用<code class="codeph">-r</code>参数运行<code>catdwgrd</code> 。 <code class="codeph">–r</code>参数更改脚本运行的默认顺序，以便脚本在所有PDB中运行，然后在CDB_ROOT中运行。</p>
                              <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-EAB6D4C4-8286-41DC-8F60-DB0BE0F702B6">
                                 <p class="notep1">注意：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>使用新Oracle数据库发行版附带的<code class="codeph">catdwgrd.sql</code>脚本的版本。
                                       </p>
                                    </li>
                                    <li>
                                       <p>降级CDB时使用<code class="codeph">-r</code>参数运行<code class="codeph">catdwgrd</code> 。</p>
                                    </li>
                                    <li>
                                       <p>在新的Oracle数据库发行版环境中运行<code class="codeph">catdwgrd.sql</code> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">catdwgrd.sql</code>脚本将数据库中的所有Oracle数据库组件降级到升级的版本。降级要么是升级后支持的主要版本，要么是升级后的补丁版本。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                              <p>如果要降级多租户环境数据库，并且<code>catdwgrd.sql</code>命令遇到故障，请查看错误消息。在继续之前，请检查<code class="codeph">CDB$ROOT</code>或PDB中存在哪些问题。查看“排除Oracle数据库降级故障”部分。修复错误中陈述的问题。解决错误后，使用<code>catcon.pl</code> ， <code class="codeph">catcon.pl -c 'cdb,pdb' -r</code>语法，使用<code>catcon.pl</code>实用程序重新运行<code>catdgwrd.sq</code> 。
                              </p>
                              <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-6AE4C9D3-07D5-427F-8F28-4105F9DD12FD">
                                 <p class="notep1">警告：</p>
                                 <p>如果组件的降级失败，则会显示<code class="codeph">ORA-39709</code>错误。SQL * Plus会话终止而不降级Oracle数据库数据字典。在降级Oracle数据库数据字典之前，必须成功降级所有组件。在重新运行<code>catdwgrd.sql</code>脚本之前确定并修复问题。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>仅对于非CDB，如果您打开了假脱机，则关闭脚本结果的假脱机到日志文件：</span><div><pre class="pre codeblock"><code>SQL&gt; SPOOL OFF</code></pre><p>检查假脱机文件，并确认在降级期间没有发生错误。您在步骤8中命名了假脱机文件，建议的名称为<code class="codeph">downgrade.log</code> 。纠正在此文件中找到的任何问题。如有必要，请重新运行降级脚本。
                              </p>
                           </div>
                           <div>
                              <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-D93C480D-DF41-4A5D-B0F1-6561EA414026">
                                 <p class="notep1">注意：</p>
                                 <p>保存第一次运行降级脚本时的结果。在重新运行降级脚本之前，请将文件<code class="codeph">downgrade.log</code>重命名为其他名称，以便在重新运行脚本时不会覆盖该名称。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>关闭实例：</span><div><pre class="pre codeblock"><code>SQL&gt; SHUTDOWN IMMEDIATE</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>退出SQL * Plus。</span></li>
                        <li class="stepexpand"><span>如果您的操作系统是Linux或UNIX，则更改以下环境变量以指向要降级的版本的目录：</span><ul>
                              <li>
                                 <p>Linux和UNIX系统</p>
                                 <p>更改以下环境变量以指向要降级的版本的目录：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">ORACLE_HOME</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">路径</code></p>
                                    </li>
                                 </ul>
                                 <p>还要检查<code class="codeph">oratab</code>文件以及设置<code class="codeph">ORACLE_HOME</code>值的任何客户端脚本是否指向降级的Oracle主目录。
                                 </p>
                                 <div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-1D10C9D2-23C9-4C0D-A855-57266297E589">
                                    <p class="notep1">也可以看看：</p>
                                    <p>适用于您的操作系统的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=GINST" target="_blank"><span><cite>Oracle数据库安装指南</cite></span></a> ，以获取有关在操作系统上设置其他重要环境变量的信</p>
                                 </div>
                              </li>
                              <li>
                                 <p>Microsoft Windows系统</p>
                                 <ol type="a">
                                    <li>
                                       <p>停止所有Oracle服务，包括Oracle Database 12c数据库的<code class="codeph">OracleService <span class="variable" translate="no">SID</span></code> Oracle服务，其中<code class="codeph"><span class="variable" translate="no">SID</span></code>是实例名称。
                                       </p>
                                       <p>例如，如果您的<span class="variable" translate="no">SID</span>是<code class="codeph">ORCL</code> ，则在命令提示符处输入以下内容：</p><pre class="pre codeblock"><code>C：\&gt; NET STOP OracleServiceORCL</code></pre><div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-21EBB256-7F58-4846-BC96-E9A64F3C24D2">
                                          <p class="notep1">也可以看看：</p>
                                          <p>有关在Windows上停止Oracle服务的详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=NTQRF206" target="_blank"><span><cite>适用于Microsoft Windows的Oracle数据库管理员参考</cite></span></a></p>
                                       </div>
                                    </li>
                                    <li>
                                       <p>通过发出命令<code class="codeph">ORADIM</code>在命令提示符处删除Oracle服务。</p>
                                       <p>例如，如果您的<span class="variable" translate="no">SID</span>是<code class="codeph">ORCL</code> ，则输入以下命令：</p><pre class="pre codeblock"><code>C：\&gt; ORADIM -DELETE -SID ORCL</code></pre><p>使用命令<code class="codeph">ORADIM</code>在命令提示符下创建要降级的数据库的Oracle服务：</p><pre class="pre codeblock"><code>C：\&gt; ORADIM -NEW -SID <span class="variable" translate="no">SID</span> -INTPWD <span class="variable" translate="no">PASSWORD</span> -MAXUSERS <span class="variable" translate="no">USERS</span> -STARTMODE MANUAL -PFILE <span class="variable" translate="no">ORACLE_HOME</span> \ DATABASE \ INIT <span class="variable" translate="no">SID</span> .ORA</code></pre><p><code class="codeph">ORADIM</code>的语法包括以下变量：</p>
                                       <div class="tblformal" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-6ECD3048-96E0-4F39-8437-1C8AEA8F171A">
                                          <table cellpadding="4" cellspacing="0" class="Formal" title="" width="90%" border="1" summary="Syntax and variables for ORADIM, listing the variable, and listing the description" frame="hsides" rules="rows">
                                             <thead>
                                                <tr align="left" valign="top">
                                                   <th align="left" valign="bottom" width="21%" id="d51852e1837">变量</th>
                                                   <th align="left" valign="bottom" width="79%" id="d51852e1840">描述</th>
                                                </tr>
                                             </thead>
                                             <tbody>
                                                <tr align="left" valign="top">
                                                   <td align="left" valign="top" width="21%" id="d51852e1845" headers="d51852e1837 ">
                                                      <p><span class="variable" translate="no">SID</span></p>
                                                   </td>
                                                   <td align="left" valign="top" width="79%" headers="d51852e1845 d51852e1840 ">
                                                      <p>与要降级的数据库的SID相同的系统标识符（SID）名称。</p>
                                                   </td>
                                                </tr>
                                                <tr align="left" valign="top">
                                                   <td align="left" valign="top" width="21%" id="d51852e1853" headers="d51852e1837 ">
                                                      <p><span class="variable" translate="no">密码</span></p>
                                                   </td>
                                                   <td align="left" valign="top" width="79%" headers="d51852e1853 d51852e1840 ">
                                                      <p>数据库实例的密码。此密码是与<code class="codeph">SYSDBA</code>权限关联的用户的密码。<code class="codeph">-INTPWD</code>选项不是必需的。如果系统提示您输入密码，请使用此Windows平台的标准用户帐户的密码。
                                                      </p>
                                                   </td>
                                                </tr>
                                                <tr align="left" valign="top">
                                                   <td align="left" valign="top" width="21%" id="d51852e1867" headers="d51852e1837 ">
                                                      <p><span class="variable" translate="no">USERS</span></p>
                                                   </td>
                                                   <td align="left" valign="top" width="79%" headers="d51852e1867 d51852e1840 ">
                                                      <p>可授予<code class="codeph">SYSDBA</code>和<code class="codeph">SYSOPER</code>权限的最大用户数。
                                                      </p>
                                                   </td>
                                                </tr>
                                                <tr align="left" valign="top">
                                                   <td align="left" valign="top" width="21%" id="d51852e1881" headers="d51852e1837 ">
                                                      <p><span class="variable" translate="no">ORACLE_HOME</span></p>
                                                   </td>
                                                   <td align="left" valign="top" width="79%" headers="d51852e1881 d51852e1840 ">
                                                      <p>要降级的数据库的Oracle主目录。确保使用选项<code class="codeph">-PFILE</code>指定完整路径名，包括安装Oracle主目录的驱动器号。
                                                      </p>
                                                      <p>有关在启动时指定初始化参数的信息，以及有关初始化参数文件的信息，请参见“ <cite>Oracle数据库管理员指南”</cite> 。
                                                      </p>
                                                   </td>
                                                </tr>
                                             </tbody>
                                          </table>
                                       </div>
                                       <!-- class="inftblhruleinformal" -->
                                       <p>例如，如果您的<span class="variable" translate="no">SID</span>是<code class="codeph">ORCL</code> ，则您的<span class="variable" translate="no">PASSWORD</span>是<code class="codeph">TWxy5791</code> ， <span class="variable" translate="no">USERS</span>的最大数量是<code class="codeph">10</code> ， <span class="variable" translate="no">ORACLE_HOME</span>目录是<code class="codeph">C:\ORANT</code> ，然后输入以下命令：</p><pre class="oac_no_warn" dir="ltr">C：\&gt; ORADIM -NEW -SID ORCL -INTPWD TWxy5791 -MAXUSERS 10 -STARTMODE AUTO -PFILE C：\ ORANT \ DATABASE \ INITORCL.ORA</pre><div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-D5D20E7F-36CB-4F3F-8E13-B6136C350F36">
                                          <p class="notep1">注意：</p>
                                          <p><code class="codeph">ORADIM</code>命令提示您输入Oracle主用户帐户的密码。您可以使用<code class="codeph">ORADIM</code>指定其他选项。</p>
                                          <p>降级数据库时，不需要更改任何Windows注册表设置。<code class="codeph">ORADIM</code>实用程序自动进行所有必要的更改。
                                          </p>
                                       </div>
                                       <div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-18E83A45-EFE2-4D0B-92B5-7706D851759E">
                                          <p class="notep1">也可以看看：</p>
                                          <p>有关使用<code class="codeph">ORADIM</code>管理Oracle数据库实例的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=NTQRF05011" target="_blank"><span><cite>Microsoft Windows的Oracle数据库管理员参考</cite></span></a></p>
                                       </div>
                                    </li>
                                 </ol>
                              </li>
                           </ul>
                        </li>
                        <li class="stepexpand"><span>恢复要降级的版本的配置文件（例如，参数文件，密码文件等）。</span><div>
                              <p>如果数据库是Oracle RAC数据库，则运行以下命令将数据库返回到单实例模式：</p><pre class="pre codeblock"><code>SET CLUSTER_DATABASE = FALSE</code></pre><div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-4C04E65D-B393-4841-88D5-2405CD35AE55">
                                 <p class="notep1">注意：</p>
                                 <p>如果要降级群集数据库，请在此群集数据库已配置实例的所有节点上执行此步骤。将初始化参数<code class="codeph">CLUSTER_DATABASE</code>的值设置为<code class="codeph">FALSE</code> 。降级后，将此初始化参数设置回<code class="codeph">TRUE</code> 。</p>
                              </div>
                              <div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-978244AA-F04B-48DD-8369-4E69713FFD5F">
                                 <p class="notep1">也可以看看：</p>
                                 <p><a href="../racad/administering-database-instances-and-cluster-databases.html#RACAD017" target="_blank"><span><cite>“Oracle Real Application Clusters管理和部署指南”，</cite></span></a>以获取有关Oracle RAC中初始化参数使用的信息</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在系统提示符下，切换到要降级的早期版本的Oracle主目录中的<code class="codeph">admin</code>目录。（ <code><span class="variable" translate="no">ORACLE_HOME</span> /rdbms/admin</code> ，其中<code class="codeph"><span class="variable" translate="no">ORACLE_HOME</span></code>是早期版本Oracle主目录的路径。）</span></li>
                        <li class="stepexpand"><span>启动SQL * Plus，并以具有SYSDBA权限的用户身份连接到数据库实例。</span><ul>
                              <li>
                                 <p>对于非CDB：</p><pre class="pre codeblock"><code>SQL&gt; CONNECT / AS SYSDBA SQL&gt;启动升级</code></pre></li>
                              <li>
                                 <p>对于CDB：</p><pre class="pre codeblock"><code>connect / as sysdba startup upgrade; alter pluggable database全部开放升级;</code></pre></li>
                           </ul>
                        </li>
                        <li class="stepexpand"><span>（可选）对于非CDB，将系统设置为将结果假脱机到日志文件以跟踪更改和问题。CDB不需要此步骤。</span><div><pre class="pre codeblock"><code>SQL&gt; SPOOL reload.log</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>运行<code>catrelod.sql</code>非CDB数据库，或使用<code>catcon.pl</code>运行<code>utlrp.sql</code>的CDB数据库。</span><ul>
                              <li>
                                 <p>对于非CDB：</p><pre class="pre codeblock"><code>SQL&gt; $ ORACLE_HOME / rdbms / admin / catrelod.sql</code></pre></li>
                              <li>
                                 <p>对于CDB：</p><pre class="oac_no_warn" dir="ltr">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -n 1 -e -b catrelod -d $ ORACLE_HOME / rdbms / admin catrelod.sql</pre></li>
                           </ul>
                           <div>
                              <p>此命令为降级的数据库中的每个数据库组件重新加载适当的版本。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果为非CDB打开假脱机，则关闭脚本结果假脱机到日志文件：</span><div><pre class="pre codeblock"><code>SQL&gt; SPOOL OFF</code></pre><p>检查假脱机文件，并验证是否已成功编译包和过程。更正在此日志文件中找到的任何问题，并在必要时重新运行相应的脚本。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>关闭并重新启动实例以进行正常操作：</span><div><pre class="pre codeblock"><code>SQL&gt; SHUTDOWN IMMEDIATE SQL&gt; STARTUP</code></pre></div>
                           <div>
                              <p>您可能需要使用<code class="codeph">PFILE</code>选项指定初始化参数文件的位置。
                              </p>
                              <div class="infoboxnotealso" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-CCEBC3D1-9DE2-47F8-82E2-1BC60D12E229">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关在启动时和初始化参数文件中指定初始化参数的信息，请参见“ <a href="../admin/starting-up-and-shutting-down.html#ADMIN12825" target="_blank"><span><cite>Oracle数据库管理员指南”</cite></span></a></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>如果您将数据库配置为使用Oracle Label Security，请完成此步骤。如果未将数据库配置为使用Oracle Label Security，请继续执行下一步。</span><ol type="a">
                              <li class="substepexpand"><span>脚本复制<code class="codeph">olstrig.sql</code>从Oracle主<span class="italic">12c的</span> Oracle数据库下发行数量的Oracle主到要降级的数据库。</span></li>
                              <li class="substepexpand"><span>在降级版本的Oracle主目录中，运行<code class="codeph">olstrig.sql</code>以使用Oracle Label Security策略在表上重新创建DML触发器：</span><div><pre class="pre codeblock"><code>SQL&gt; @ olstrig.sql</code></pre></div>
                              </li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>（可选）对于非CDB，将系统设置为将结果假脱机到日志文件以跟踪更改和问题。CDB不需要此步骤。</span><div>
                              <p>例：</p><pre class="pre codeblock"><code>SQL&gt; SPOOL utlrp.log</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>运行<code class="codeph">utlrp.sql</code>脚本以重新编译任何剩余的存储的PL / SQL和Java代码。使用您的配置过程：</span><ul>
                              <li>
                                 <p>非国开行：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; $ ORACLE_HOME / rdbms / admin / utlrp.sql</pre></li>
                              <li>
                                 <p>CDB：</p><pre class="oac_no_warn" dir="ltr">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -n 1 -e -b utlrp -d $ ORACLE_HOME / rdbms / admin utlrp.sql</pre><p><code class="codeph">utlrp.sql</code>脚本重新编译以前处于<code class="codeph">INVALID</code>状态的所有现有PL / SQL模块，例如包，过程，类型等。生成日志文件<code class="codeph">utlrp0.log</code> 。该日志文件列出了重新编译结果。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li class="stepexpand"><span>如果在运行<code class="codeph">utlrp.sql</code>时打开非CDB的假脱机，则关闭脚本结果的假脱机到日志文件：</span><div><pre class="pre codeblock"><code>SQL&gt; SPOOL OFF</code></pre><p>检查假脱机文件，并验证是否已成功编译包和过程。更正在此日志文件中找到的任何问题。如有必要，请重新运行相应的脚本。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>退出SQL * Plus。</span></li>
                        <li class="stepexpand"><span>如果要降级群集数据库，则必须运行以下命令以降级Oracle Clusterware数据库配置：</span><div><pre class="pre codeblock"><code>$ srvctl降级数据库-d <span class="variable" translate="no">db-unique-name</span> -o <span class="variable" translate="no">oraclehome</span> -t <span class="variable" translate="no">to_version</span>
</code></pre></div>
                           <div>
                              <p>将此语法示例中的变量替换为系统的值：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph"><span class="variable" translate="no">db-unique-name</span></code>是数据库名称（不是实例名称）。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph"><span class="variable" translate="no">oraclehome</span></code>是降级数据库的旧Oracle主目录的位置。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph"><span class="variable" translate="no">to_version</span></code>是数据库降级的数据库版本。（例如：12.1.0.2.0。）
                                    </p>
                                 </li>
                              </ul>
                              <div class="infoboxnote" id="GUID-0227D321-577E-47C5-A8C0-36991B8D0357__GUID-DFEFB115-42A3-42B4-86CC-E2109E326FA3">
                                 <p class="notep1">注意：</p>
                                 <p>从新版本的Oracle主目录运行此命令，而不是从数据库降级到的Oracle主目录运行。</p>
                              </div>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>完成此过程后，您的数据库将降级。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA">对Oracle数据库降级进行故障排除</a></li>
                           <li><a href="../admin/starting-up-and-shutting-down.html#ADMIN12825" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-EF4B784F-BF90-48B5-80B5-3D4E209F8F8E" title="为了自动降级，从Oracle Database 19c开始，Oracle提供了dbdowngrade实用程序脚本。必要时，您还可以继续手动运行catdwgrd.sql，与以前的版本一样。">使用脚本降级CDB或非CDB Oracle数据库</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-F1FB354D-8C53-4E80-A4C9-A6366055028C" name="GUID-F1FB354D-8C53-4E80-A4C9-A6366055028C"></a><h3 id="UPGRD-GUID-F1FB354D-8C53-4E80-A4C9-A6366055028C" class="sect3">关于具有组件状态选项关闭的降级和无效对象</h3>
               <div>
                  <p>从降级版本的Oracle数据库标准版到带有CDB和PDBS的Oracle Database 12c标准版的降级包含更高版本后发布的无效对象。</p>
                  <p>随着Oracle数据库版本12c（12.2或12.1）的发布，将数据库版本降级到Oracle数据库版本12c（12.2或12.1），预计会在降级数据库中找到更高版本的无效对象，其中Oracle Database Release 12c数据库将这些对象设置为FALSE。降级到Oracle Database Release 18c（18.1.0）和更高版本的Oracle数据库版本时，不存在此问题。</p>
                  <div class="example" id="GUID-F1FB354D-8C53-4E80-A4C9-A6366055028C__GUID-4ECE04D0-86FB-474A-9C18-ACAAC5BD0D4F">
                     <p>例如：</p>
                     <p>在从Oracle Database 19c标准版降级到Oracle Database 12c第2版（12.2.0.1）标准版期间，您将OLAP和Spatial组件升级到19c版本，但它们设置为FALSE。降级后，OLAP和Spatial组件仍然不可用，但它们不会重新加载到12.2.0.1版本中。然后，您可以在DBA注册表中看到此结果，您可以在12.2注册表中找到后续发布的对象：</p><pre class="pre codeblock"><code>OLAP分析工作区选项关闭19.1.0 Oracle OLAP API选项关闭19.1.0</code></pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <p>此结果是从Oracle Database 18c及更高版本降级到Oracle Database 12c的预期行为。预期此行为的原因是因为Standard Edition数据库中这些选项的选项设置为FALSE。在升级期间，即使将它们设置为<code class="codeph">FALSE</code> ，也会升级所有选项。在<code class="codeph">catrelod.sql</code>运行期间，重新加载脚本不会运行以使用早期版本替换这些对象。因此，降级到标准版会使许多OLAP和Spatial对象处于其后续版本中。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F" name="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F"></a><h3 id="UPGRD-GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F" class="sect3">降级单个可插拔Oracle数据库（PDB）</h3>
               <div>
                  <p>如果您要降级Oracle数据库，则可以降级一个PDB而不降级整个CDB。</p>
                  <p>在Oracle Database 12c第2版（12.2）之后的Oracle数据库发行版中，您可以降级各个PDB。例如，您可以从升级后的CDB中拔出PDB，降级PDB，然后将其插入早期版本的CDB，或者可以将PDB数据库转换为独立数据库。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F__GUID-FDBE5EE1-9702-4F3C-AAAF-AB864443A5E2">降级PDB</p>
                     <p>在此过程示例中，您将PDB降级到版本12.1.0.2：</p>
                     <ol>
                        <li>
                           <p>在DOWNGRADE模式下启动PDB。执行此操作时，CDB可以处于正常模式。</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter pluggable database CDB1_PDB1 open downgrade;</pre></li>
                        <li>
                           <p>，无论是通过使用降级PDB <code class="codeph">dbdowngrade</code>效用，或通过运行<code class="codeph">catdwgrd</code>手动，使用<code class="codeph">catcon.pl</code> 。
                           </p>
                           <p>在每个选项中，您要降级的PDB是<code class="codeph">PDB1</code> 。
                           </p>
                           <ul id="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F__UL_UWJ_LB2_CGB" style="list-style-type:disc">
                              <li>
                                 <p>使用<code class="codeph">dbdowngrade</code>实用程序降级。
                                 </p>
                                 <p>使用dbdowngrade脚本降级PDB，如下所示：</p><pre class="pre codeblock"><code>cd $ ORACLE_HOME / bin ./dbdowngrade -c'PDB1'</code></pre></li>
                              <li>
                                 <p>与手动降级<code class="codeph">catdwgrd</code> ，使用<code class="codeph">catcon.p.</code></p>
                                 <p>运行<code class="codeph">catdwgrd</code>如下：</p><pre class="oac_no_warn" dir="ltr">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -d $ ORACLE_HOME / rdbms / admin -n 1 -l &lt;输出目录&gt; -e -b catdwgrd -c'PDB1'catdwgrd.sql</pre><p>在示例中， <code>catdwgrd</code>与<code>catcon.pl</code> <code>catdwgrd</code>运行。<code class="codeph">-d</code>参数告诉<code>catcon.pl</code>在哪里找到<code>catdwgrd</code> 。<code class="codeph">-l</code>参数指定日志文件的输出目录，而不是写入<code class="codeph">rdbms/admin</code>目录。必须使用<code class="codeph">-r</code>参数同时运行两个脚本。
                                 </p>
                                 <p>降级的日志文件放在Oracle基本主目录中（由命令<code class="codeph">orabasehome</code>或<code class="codeph">orabase</code>标识的Oracle基础，或由命令<code class="codeph">oracle_home</code>标识的Oracle主<code class="codeph">orabasehome</code> ， <code class="codeph">orabase</code>顺序排列）。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>关闭PDB。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F__GUID-201A7D9B-2D52-44EE-BC23-2408393DF7AF">从CDB上拔下PDB</p>
                     <p>在此步骤中，从版本12.2.0.1 CDB中拔出降级的PDB：</p>
                     <ol>
                        <li>
                           <p>连接到升级后的CDB。</p>
                        </li>
                        <li>
                           <p>关闭要拔出的PDB。</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter pluggable database PDB1 close;</pre></li>
                        <li>
                           <p>拔下降级的12.1.0.2 PDB，用系统上的路径替换变量<code class="codeph"><span class="variable" translate="no">path</span></code> ：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter pluggable database PDB1拔出' <span class="variable" translate="no">path</span> /pdb1.xml';</pre><p>拔出完成后，您会收到以下响应：</p><pre class="oac_no_warn" dir="ltr">可插拔数据库已更改</pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-66560D5D-A5C8-4ACC-82C0-46315465E77F__GUID-217DD5FD-30A1-4796-A0C4-3CBAB107CAA0">插入降级的12.1.0.2 PDB</p>
                     <p>在此步骤中，将降级的12.1.0.2 PDB插入12.1.0.2 CDB。为此，您必须在此CDB中创建PDB。以下示例显示如何创建名为PDB1的可插拔数据库：</p>
                     <ol>
                        <li>
                           <p>连接到12.1.0.2 CDB。</p>
                        </li>
                        <li>
                           <p>插入12.1.0.2 PDB。</p><pre class="oac_no_warn" dir="ltr">SQL&gt;使用' <span class="variable" translate="no">path</span> /pdb1.xml'创建可插拔数据库PDB1;</pre><p>此命令返回已<code class="codeph">Pluggable database created</code> 。
                           </p>
                        </li>
                        <li>
                           <p>在升级模式下打开PDB：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter pluggable database PDB1 open upgrade;</pre></li>
                        <li>
                           <p>连接到PDB：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; alter session set container = PDB1;</pre></li>
                        <li>
                           <p>在PDB中运行<code class="codeph">catrelod</code> ：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; @ $ ORACLE_HOME / rdbms / admin / catrelod.sql</pre><p><code class="codeph">catrelod.sql</code>脚本为降级的数据库中的每个数据库组件重新加载适当的版本。
                           </p>
                        </li>
                        <li>
                           <p>在PDB中运行<code class="codeph">utlrp</code> ：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; @ $ ORACLE_HOME / rdbms / admin / utlrp.sql</pre><p><code class="codeph">utlrp.sql</code>脚本重新编译以前处于<code class="codeph">INVALID</code>状态的所有现有PL / SQL模块，例如包，过程，类型等。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-EEC355DD-AA56-4972-9EB3-139CEC457D65" name="GUID-EEC355DD-AA56-4972-9EB3-139CEC457D65"></a><h3 id="UPGRD-GUID-EEC355DD-AA56-4972-9EB3-139CEC457D65" class="sect3">降级包含Oracle Application Express的PDB</h3>
               <div>
                  <p>在降级包含Oracle Application Express的PDB时，请使用此过程来避免APEX_050000错误导致的INVALID OBJECTS。</p>
                  <div class="section">
                     <p>将PDB降级到早期版本后，输入类似于以下内容的SQL语句以删除Oracle Application Express用户：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-EEC355DD-AA56-4972-9EB3-139CEC457D65__ORACLE_HOMEPERLBINPERLORACLE_HOMERD-50050B17"><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -b drop_apex5 -c'PDB1' -  --x'drop user apex_050000 cascade'</code></pre><p>在此示例中，PDB名称为<code class="codeph">'PDB1'</code> 。
                     </p>
                  </div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD12557"></a><div class="props_rev_3"><a id="GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" name="GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5"></a><h3 id="UPGRD-GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" class="sect3">Oracle数据库降级后降级任务降级</h3>
               <div>
                  <p>由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-2C4D727B-48E3-4AD2-852D-D3A54C838322">Oracle数据库降级的Oracle XML DB身份验证建议</a><br>从12.1之前的版本升级会导致禁用摘要式身份验证。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-5C696750-2055-4FB2-8EB6-83E5139B1EA2">降级后重新应用发布更新和其他补丁</a><br>运行降级并且<code class="codeph">catrelod.sql</code>成功完成后，如果在升级后但在降级之前在原始Oracle主目录中安装了新修补程序，请确保应用已安装的任何修补程序。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-B8C9E95E-AC37-48F0-945F-4A17E111E7D5">降级Oracle数据库后重新启用Oracle Database Vault</a><br>如果在降级期间指示您禁用Oracle Database Vault，则必须执行此操作。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-67714F0E-0CE4-4527-86AF-8918914DACAF">恢复Oracle Clusterware的配置</a><br>要还原配置，必须还原要升级的版本。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD">降级Oracle数据库后恢复Oracle Enterprise Manager</a><br>仅当您执行降级并且在主机上配置了Oracle Enterprise Manager时，才需要执行本节中描述的还原任务。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-593D396B-A1C2-4453-BBDA-8C4455000CA0">将Oracle Application Express还原到早期版本</a><br>降级后，如果在升级Oracle数据库的同时升级了Oracle Application Express，则必须完成恢复到早期Oracle Application Express版本的步骤。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-6B972762-122D-4CFF-B910-6F93409DAC5F">降级后收集字典统计</a><br>为降低降级后的性能，请使用此过程收集字典统计信息。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506">降级后重新收集固定对象统计数据</a><br>降级后，在Oracle数据库上运行代表性工作负载，并重新收集固定对象统计信息。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-3B34038A-2C85-4B77-B91D-BB9665883B21">降级后重新收集陈旧的CBO统计数据</a><br>Oracle建议您在完成Oracle数据库降级后重新收集Oracle基于成本的优化程序（CBO）统计信息。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               <a id="UPGRD52884"></a><div class="props_rev_3"><a id="GUID-2C4D727B-48E3-4AD2-852D-D3A54C838322" name="GUID-2C4D727B-48E3-4AD2-852D-D3A54C838322"></a><h4 id="UPGRD-GUID-2C4D727B-48E3-4AD2-852D-D3A54C838322" class="sect4">Oracle数据库降级的Oracle XML DB身份验证建议</h4>
                  <div>
                     <p>从12.1之前的版本升级会导致禁用摘要式身份验证。</p>
                     <p>如果降级到版本比Oracle数据库<span class="italic">12c的</span>前面，其中摘要认证，不支持，摘要式身份验证被禁用，做出认证选择不可用。这会影响Oracle XML DB Repository的HTTP身份验证。如果您没有利用摘要式身份验证而是使用默认配置，则无需进一步操作。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-2C4D727B-48E3-4AD2-852D-D3A54C838322__GUID-9E98738F-8B58-4827-BB7C-722CA5BED224">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../adxdb/administration-of-XML-DB.html#ADXDB6110" target="_blank"><span class="italic">Oracle XML DB Developer's Guide</span></a> ，了解有关使用Oracle XML DB进行数据库安装，升级和降级的身份验证的信息</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-5C696750-2055-4FB2-8EB6-83E5139B1EA2" name="GUID-5C696750-2055-4FB2-8EB6-83E5139B1EA2"></a><h4 id="UPGRD-GUID-5C696750-2055-4FB2-8EB6-83E5139B1EA2" class="sect4">降级后重新应用发布更新和其他补丁</h4>
                  <div>
                     <p>运行降级并且<code class="codeph">catrelod.sql</code>成功完成后，如果在升级后但在降级之前在原始Oracle主目录中安装了新修补程序，请确保应用已安装的任何修补程序。
                     </p>
                     <p>如果你安装了新的补丁程序，然后运行<code class="codeph">datapatch</code>工具，这些补丁应用到降级的数据库。如果在升级后未更改Oracle Home中的二进制文件和文件，则无需在运行<code class="codeph">datapatch</code>后运行<code class="codeph">catrelod.sql</code> 。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD12559"></a><div class="props_rev_3"><a id="GUID-B8C9E95E-AC37-48F0-945F-4A17E111E7D5" name="GUID-B8C9E95E-AC37-48F0-945F-4A17E111E7D5"></a><h4 id="UPGRD-GUID-B8C9E95E-AC37-48F0-945F-4A17E111E7D5" class="sect4">降级Oracle数据库后重新启用Oracle Database Vault</h4>
                  <div>
                     <p>如果在降级期间指示您禁用Oracle Database Vault，则必须执行此操作。</p>
                     <p>如果您使用Oracle Database Vault，则可能已指示您在降级数据库之前禁用它。要在降级后使用Oracle Database Vault，必须重新启用它。</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B8C9E95E-AC37-48F0-945F-4A17E111E7D5__GUID-93351A50-7410-4292-A0C0-237F8265FC6F">
                        <p class="notep1">也可以看看：</p>
                        <p>有关重新启用Oracle Database Vault的过程的<a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM30031" target="_blank"><span class="italic">Oracle Database Vault管理员指南</span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD52664"></a><div class="props_rev_3"><a id="GUID-67714F0E-0CE4-4527-86AF-8918914DACAF" name="GUID-67714F0E-0CE4-4527-86AF-8918914DACAF"></a><h4 id="UPGRD-GUID-67714F0E-0CE4-4527-86AF-8918914DACAF" class="sect4">恢复Oracle Clusterware的配置</h4>
                  <div>
                     <p>要还原配置，必须还原要升级的版本。</p>
                     <p>您可以将Oracle Clusterware配置还原到Oracle Clusterware 12 <span class="italic">c</span>第2版（12.2）升级之前的状态。您在Oracle Database 12 <span class="italic">c</span>升级过程中或之后执行的任何配置更改都将被删除，并且无法恢复。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-67714F0E-0CE4-4527-86AF-8918914DACAF__GUID-22CCA6B5-57DE-4E14-930B-5E0DFE5405FF">
                        <p class="notep1">也可以看看：</p>
                        <p>适用于您的平台的<a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure安装和升级指南</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD60106"></a><div class="props_rev_3"><a id="GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD" name="GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD"></a><h4 id="UPGRD-GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD" class="sect4">降级Oracle数据库后恢复Oracle Enterprise Manager</h4>
                  <div>
                     <p>仅当您执行降级并且在主机上配置了Oracle Enterprise Manager时，才需要执行本节中描述的还原任务。</p>
                     <p>要还原Oracle Enterprise Manager，首先运行Oracle Enterprise Manager配置助手（EMCA），然后运行<code class="codeph">emdwgrd</code>实用程序。
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-648BBBCF-0F0E-43CB-ACF7-B8F15882F422">降级后恢复Oracle企业管理器的要求</a><br>升级之前必须完成这些要求才能在降级到12.1之前的版本后还原Oracle Enterprise Manager</li>
                        <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0">降级后运行EMCA以还原Oracle企业管理器</a><br>查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。
                        </li>
                        <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-A97C04EC-BD77-4075-A354-03788DBCB74D">运行emdwgrd实用程序以还原企业管理器数据库控制</a><br>运行<kbd class="userinput">emca -restore</kbd>后，可以使用<code>emdwgrd</code>实用程序还原Oracle Enterprise Manager数据库控件和数据。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-648BBBCF-0F0E-43CB-ACF7-B8F15882F422" name="GUID-648BBBCF-0F0E-43CB-ACF7-B8F15882F422"></a><h5 id="UPGRD-GUID-648BBBCF-0F0E-43CB-ACF7-B8F15882F422" class="sect5">降级后恢复Oracle企业管理器的要求</h5>
                     <div>
                        <p>升级之前必须完成这些要求才能在降级到12.1之前的版本后还原Oracle Enterprise Manager</p>
                        <p>要使用<code class="codeph">emca -restore</code>将Oracle Enterprise Manager还原到以前的状态，必须满足以下条件：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在升级之前，您保存了Oracle Enterprise Manager配置文件和数据的备份</p>
                           </li>
                           <li>
                              <p>您运行位于Oracle数据库12 <span class="italic">c</span> Oracle主目录中的<code class="codeph">emca</code>二进制文件以执行此过程</p>
                           </li>
                        </ul>
                        <p>在Oracle Clusterware系统上，要在Oracle RAC数据库上还原Oracle Enterprise Manager，必须在运行<code class="codeph">emca -restore</code>之前使用<code class="codeph">srvctl</code>注册数据库。您必须从数据库降级的早期Oracle数据库发行版的<code><span class="variable" translate="no">ORACLE_HOME</span> /bin</code>目录运行<code class="codeph">emca -restore</code> 。
                        </p>
                        <p>运行带有相应选项的<code class="codeph">emca -restore</code>命令，以将Oracle Enterprise Manager数据库控制或网格控制还原到旧的Oracle主目录。
                        </p>
                        <p>指定不同的<code>emca</code>选项，具体取决于要降级的数据库是单实例数据库，Oracle RAC数据库还是Oracle ASM数据库。
                        </p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="../cwadd/server-control-command-reference.html#CWADD-GUID-803F603E-8638-4946-84D4-CB24D21C893C" target="_blank"><span><cite>“Oracle Clusterware管理和部署指南”</cite></span></a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD" title="仅当您执行降级并且在主机上配置了Oracle Enterprise Manager时，才需要执行本节中描述的还原任务。">降级Oracle数据库后还原Oracle Enterprise Manager</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" name="GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0"></a><h5 id="UPGRD-GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" class="sect5">降级后运行EMCA以还原Oracle企业管理器</h5>
                     <div>
                        <p>查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。</p>
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-C2AC0068-9BB8-4CE5-B15D-5603E5613167">在没有Oracle ASM的单实例Oracle数据库上运行emca</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库。
                           </li>
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-5E91C301-67ED-4C35-BAE6-2A533E84829B">在没有Oracle ASM的Oracle RAC数据库上运行EMCA</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库：</li>
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-5F8A1676-8ACF-4D19-879A-72524BB7AF6A">在单实例Oracle ASM实例上运行EMCA</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </li>
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-2F275E58-A811-41F9-9AF5-0D8E400F7F02">在Oracle RAC实例上的Oracle ASM上运行emca</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </li>
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-3F8EFEF3-1410-4983-87DA-042A9DD69601">使用Oracle ASM在单实例Oracle数据库上运行emca</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </li>
                           <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-A1DDA4D7-7EC2-4D1C-89E3-A1C8D9CC142E">在Oracle RAC数据库和Oracle ASM实例上运行emca</a><br>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </li>
                        </ul>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD" title="仅当您执行降级并且在主机上配置了Oracle Enterprise Manager时，才需要执行本节中描述的还原任务。">降级Oracle数据库后还原Oracle Enterprise Manager</a></p>
                           </div>
                        </div>
                     </div>
                     <a id="UPGRD60107"></a><div class="props_rev_3"><a id="GUID-C2AC0068-9BB8-4CE5-B15D-5603E5613167" name="GUID-C2AC0068-9BB8-4CE5-B15D-5603E5613167"></a><h6 id="UPGRD-GUID-C2AC0068-9BB8-4CE5-B15D-5603E5613167" class="sect6">在没有Oracle ASM的单实例Oracle数据库上运行emca</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库。
                           </p>
                           <p>使用此命令可以运行Enterprise Manager Configuration Assistant。</p><pre class="oac_no_warn" dir="ltr">ORACLE_HOME / bin / emca -restore db</pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>数据库SID</p>
                              </li>
                              <li>
                                 <p>侦听器端口号</p>
                              </li>
                           </ul>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="UPGRD60108"></a><div class="props_rev_3"><a id="GUID-5E91C301-67ED-4C35-BAE6-2A533E84829B" name="GUID-5E91C301-67ED-4C35-BAE6-2A533E84829B"></a><h6 id="UPGRD-GUID-5E91C301-67ED-4C35-BAE6-2A533E84829B" class="sect6">在没有Oracle ASM的Oracle RAC数据库上运行EMCA</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库：</p>
                           <p>使用此过程运行企业管理器配置助手：</p><pre class="pre codeblock"><code>ORACLE_HOME / bin / emca -restore db -cluster</code></pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>数据库唯一名称</p>
                              </li>
                              <li>
                                 <p>侦听器端口号</p>
                              </li>
                           </ul>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="UPGRD60109"></a><div class="props_rev_3"><a id="GUID-5F8A1676-8ACF-4D19-879A-72524BB7AF6A" name="GUID-5F8A1676-8ACF-4D19-879A-72524BB7AF6A"></a><h6 id="UPGRD-GUID-5F8A1676-8ACF-4D19-879A-72524BB7AF6A" class="sect6">在单实例Oracle ASM实例上运行EMCA</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </p>
                           <p>使用此命令可以运行Enterprise Manager Configuration Assistant。</p><pre class="pre codeblock"><code>ORACLE_HOME / bin / emca -restore asm</code></pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>Oracle ASM端口</p>
                              </li>
                              <li>
                                 <p>Oracle ASM SID</p>
                              </li>
                           </ul>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="UPGRD60110"></a><div class="props_rev_3"><a id="GUID-2F275E58-A811-41F9-9AF5-0D8E400F7F02" name="GUID-2F275E58-A811-41F9-9AF5-0D8E400F7F02"></a><h6 id="UPGRD-GUID-2F275E58-A811-41F9-9AF5-0D8E400F7F02" class="sect6">在Oracle RAC实例上的Oracle ASM上运行emca</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </p>
                           <p>使用此命令可以运行Enterprise Manager Configuration Assistant。</p><pre class="pre codeblock"><code>ORACLE_HOME / bin / emca -restore asm -cluster</code></pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>Oracle ASM端口</p>
                              </li>
                           </ul>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="UPGRD60111"></a><div class="props_rev_3"><a id="GUID-3F8EFEF3-1410-4983-87DA-042A9DD69601" name="GUID-3F8EFEF3-1410-4983-87DA-042A9DD69601"></a><h6 id="UPGRD-GUID-3F8EFEF3-1410-4983-87DA-042A9DD69601" class="sect6">使用Oracle ASM在单实例Oracle数据库上运行emca</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </p>
                           <p>使用此命令可以运行Enterprise Manager Configuration Assistant。</p><pre class="pre codeblock"><code>ORACLE_HOME / bin / emca -restore db_asm</code></pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的Oracle数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>数据库SID</p>
                              </li>
                              <li>
                                 <p>侦听器端口号</p>
                              </li>
                              <li>
                                 <p>Oracle ASM端口</p>
                              </li>
                              <li>
                                 <p>Oracle ASM主页</p>
                              </li>
                              <li>
                                 <p>Oracle ASM SID [+ ASM]</p>
                              </li>
                           </ul>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div><a id="UPGRD60112"></a><div class="props_rev_3"><a id="GUID-A1DDA4D7-7EC2-4D1C-89E3-A1C8D9CC142E" name="GUID-A1DDA4D7-7EC2-4D1C-89E3-A1C8D9CC142E"></a><h6 id="UPGRD-GUID-A1DDA4D7-7EC2-4D1C-89E3-A1C8D9CC142E" class="sect6">在Oracle RAC数据库和Oracle ASM实例上运行emca</h6>
                        <div>
                           <p>使用Enterprise Manager Configuration Assistant（ <code>emca</code> ）管理数据库和存储。
                           </p>
                           <p>使用此命令运行企业管理器配置助手：</p><pre class="oac_no_warn" dir="ltr">ORACLE_HOME / bin / emca -restore db_asm -cluster</pre><p>系统会提示您输入以下信息：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>要恢复的数据库的Oracle主目录</p>
                              </li>
                              <li>
                                 <p>数据库唯一名称</p>
                              </li>
                              <li>
                                 <p>侦听器端口号</p>
                              </li>
                              <li>
                                 <p>Oracle ASM端口</p>
                              </li>
                              <li>
                                 <p>Oracle ASM Oracle主页</p>
                              </li>
                              <li>
                                 <p>Oracle ASM SID [+ ASM]</p>
                              </li>
                           </ul>
                           <p><code>emca</code>的输出根据您指定的选项和您在提示中输入的值而有所不同。在Oracle RAC环境中，必须在所有Oracle RAC集群成员节点上重复此步骤。
                           </p>
                           <p>您现在必须运行<code>emdwgrd</code>实用程序以还原Oracle Enterprise Manager数据库控制和数据。
                           </p>
                        </div>
                        <div>
                           <div class="familylinks">
                              <div class="parentlink">
                                 <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-2EEC4E63-0F98-4EC8-8630-46F69A5A1FB0" title="查看这些主题并选择还原方案，以在降级后还原Oracle Enterprise Manager。">在降级后运行EMCA以还原Oracle Enterprise Manager</a></p>
                              </div>
                           </div>
                        </div>
                        
                     </div>
                  </div><a id="UPGRD60113"></a><div class="props_rev_3"><a id="GUID-A97C04EC-BD77-4075-A354-03788DBCB74D" name="GUID-A97C04EC-BD77-4075-A354-03788DBCB74D"></a><h5 id="UPGRD-GUID-A97C04EC-BD77-4075-A354-03788DBCB74D" class="sect5">运行emdwgrd实用程序以还原企业管理器数据库控制</h5>
                     <div>
                        <p>运行<kbd class="userinput">emca -restore</kbd>后，可以使用<code>emdwgrd</code>实用程序还原Oracle Enterprise Manager数据库控件和数据。
                        </p>
                        <p>要使用<code>emdwgrd</code> ，您必须执行以下操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将<span class="variable" translate="no">ORACLE_HOME</span>和其他环境变量设置为指向最初进行升级的Oracle主目录。
                              </p>
                           </li>
                           <li>
                              <p>从Oracle Database 12 <span class="italic">c</span> home运行<code>emdwgrd</code>实用程序</p>
                           </li>
                        </ul>
                        <p>以下过程适用于Linux和UNIX。要在Windows上运行它， <code>emdwgrd.bat</code> <code>emdwgrd</code>替换为<code>emdwgrd</code> 。
                        </p>
                        <ol>
                           <li>
                              <p>将<span class="variable" translate="no">ORACLE_HOME</span>设置为最初进行数据库升级的Oracle主目录。
                              </p>
                           </li>
                           <li>
                              <p>将<span class="variable" translate="no">ORACLE_SID</span>设置为已升级然后降级的数据库的SID。
                              </p>
                           </li>
                           <li>
                              <p>将<span class="variable" translate="no">PATH</span> ， <span class="variable" translate="no">LD_LIBRARY_PATH</span>和<span class="variable" translate="no">SHLIB_PATH</span>为指向最初进行数据库升级的Oracle主目录。
                              </p>
                           </li>
                           <li>
                              <p>转到Oracle数据库12 <span class="italic">c</span> Oracle主页：</p><pre class="pre codeblock"><code>cd $ ORACLE_HOME / bin</code></pre><pre class="oac_no_warn" dir="ltr"></pre></li>
                           <li>
                              <p>使用以下过程之一运行<code>emdwgrd</code> ：</p>
                              <ol type="a">
                                 <li>
                                    <p>对于单实例数据库，请运行以下命令，其中<code class="codeph"><span class="variable" translate="no">SID</span></code>是已升级然后降级的数据库的SID， <code class="codeph"><span class="variable" translate="no">save_directory</span></code>是保存数据库控制文件和数据时所选存储位置的路径：</p><pre class="pre codeblock"><code>emdwgrd -restore -sid <span class="variable" translate="no">SID</span> -path <span class="variable" translate="no">save_directory</span> -tempTablespace TEMP</code></pre><pre class="oac_no_warn" dir="ltr"></pre></li>
                                 <li>
                                    <p>对于Oracle RAC数据库，跨群集节点需要远程复制。定义环境变量以指示配置了哪个远程副本。例如：</p><pre class="pre codeblock"><code>setenv EM_REMCP / usr / bin / scp</code></pre><p>然后，使用以下选项运行<kbd class="userinput">emdwgrd -restore</kbd> ：</p><pre class="pre codeblock"><code>emdwgrd -restore -tempTablespace TEMP -cluster -sid <span class="variable" translate="no">SID_OldHome</span> -path <span class="variable" translate="no">save_directory</span>
</code></pre><p>如果Oracle home是一个共享设备上，再加入<kbd class="userinput">-shared</kbd>到<code>emdwgrd</code>命令选项。
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>当提示输入SYS和SYSMAN密码<code>emdwgrd</code> 。
                              </p>
                           </li>
                           <li>
                              <p>当<code>emdwgrd</code>完成时，Oracle Enterprise Manager Database Control将降级到旧的Oracle主目录。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-C2C793F4-67A1-4F10-88DB-EE09D7C3B4CD" title="仅当您执行降级并且在主机上配置了Oracle Enterprise Manager时，才需要执行本节中描述的还原任务。">降级Oracle数据库后还原Oracle Enterprise Manager</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-593D396B-A1C2-4453-BBDA-8C4455000CA0" name="GUID-593D396B-A1C2-4453-BBDA-8C4455000CA0"></a><h4 id="UPGRD-GUID-593D396B-A1C2-4453-BBDA-8C4455000CA0" class="sect4">将Oracle Application Express还原到早期版本</h4>
                  <div>
                     <p>降级后，如果在升级Oracle数据库的同时升级了Oracle Application Express，则必须完成恢复到早期Oracle Application Express版本的步骤。</p>
                     <p>要在数据库降级后完成Oracle Application Express的降级，请完成“ <cite>Oracle Application Express安装指南”中</cite>列出的所有步骤，以将Oracle Application Express版本还原到早期版本。根据您的体系结构是非CDB还是多租户体系结构（CDB）Oracle数据库，还原的步骤是不同的。
                     </p>
                     <div class="infoboxnote" id="GUID-593D396B-A1C2-4453-BBDA-8C4455000CA0__GUID-7CF0A9E9-5C05-4F0C-8E7B-4C64408AA2EB">
                        <p class="notep1">注意：</p>
                        <p>如果在升级数据库的同时升级了Oracle Application Express，则只需完成这些步骤。</p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/upgrd&amp;id=HTMIG266" target="_blank"><span><cite>“Oracle Application Express安装指南”</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-6B972762-122D-4CFF-B910-6F93409DAC5F" name="GUID-6B972762-122D-4CFF-B910-6F93409DAC5F"></a><h4 id="UPGRD-GUID-6B972762-122D-4CFF-B910-6F93409DAC5F" class="sect4">降级后收集字典统计</h4>
                  <div>
                     <p>为降低降级后的性能，请使用此过程收集字典统计信息。</p>
                     <div class="section">
                        <p>Oracle建议您在降级数据库后收集字典统计信息，以便为降级的版本数据字典表收集统计信息。</p>
                        <div class="infoboxnote" id="GUID-6B972762-122D-4CFF-B910-6F93409DAC5F__GUID-1185D203-0BC8-4290-8C80-1DE6DB2F3FF1">
                           <p class="notep1">注意：</p>
                           <p>在降级过程之后，请注意数据字典可以在降级的字典中保留更改。这些变化微不足道。降级的数据字典在功能上等同于早期版本的数据字典。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-6B972762-122D-4CFF-B910-6F93409DAC5F__GUID-89186456-922B-4682-AB96-4154AF51FF98">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>非CDB Oracle数据库：Oracle建议您使用<code class="codeph">DBMS_STATS.GATHER_DICTIONARY_STATS</code>过程来收集这些统计信息。例如，输入以下SQL语句：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; EXEC DBMS_STATS.GATHER_DICTIONARY_STATS;</pre></li>
                           <li>
                              <p>CDB（多租户架构）Oracle数据库：Oracle建议您使用<code>catcon</code>在整个多租户架构中收集数据字典统计信息。
                              </p>
                              <p>要收集容器数据库中所有PDB的字典统计信息，请使用以下语法：</p>
                              <p><code class="codeph">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -l / tmp -b gatherstats  -  --x“exec dbms_stats.gather_dictionary_stats”</code></p>
                              <p>要收集特定PDB上的字典统计信息，请使用类似于以下内容的语法：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -l / tmp -c'SALES1'-b gatherstats  -  --x“exec dbms_stats.gather_dictionary_stats”</code></pre><p>在前面的示例中， <code class="codeph">-c SALES1</code>选项为您运行的命令指定PDB包含列表，指定名为<code class="codeph">SALES1</code>的数据库。选项<code class="codeph">-b gatherstats</code>指定日志的基本名称。选项<code class="codeph">--x</code>指定要执行的SQL命令。SQL命令本身在引号内。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../arpls/DBMS_STATS.html#ARPLS-GUID-867989C7-ADFC-4464-8981-437CEA7F331E" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506" name="GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506"></a><h4 id="UPGRD-GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506" class="sect4">降级后重新收集固定对象统计数据</h4>
                  <div>
                     <p>降级后，在Oracle数据库上运行代表性工作负载，并重新收集固定对象统计信息。</p>
                     <div class="section">
                        <p>固定对象是X $表及其索引。V $性能视图通过X $表定义。降级后，重新收集固定对象统计信息以确保已还原数据库的优化程序可以生成良好的执行计划。这些执行计划可以提高数据库性能。未能获得具有代表性的统计数据可能会导致执行计划不理想，从而导致性能问题</p>
                        <p>使用<code class="codeph">DBMS_STATS.GATHER_FIXED_OBJECTS_STATS</code> PL / SQL过程收集固定对象统计信息。<code class="codeph">DBMS_STATS.GATHER_FIXED_OBJECTS_STATS</code>还显示有关从<code class="codeph">init.ora</code>和<code class="codeph">SPFILE</code>删除所有隐藏或下划线参数和事件的建议。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506__GUID-9570A561-DA47-4A64-AA78-DCB20ABDAFA8">
                        <p>要收集固定对象的统计信息，请运行以下PL / SQL过程：</p><pre class="pre codeblock"><code>SQL&gt; execute dbms_stats.gather_fixed_objects_stats;</code></pre><div class="infoboxnotealso" id="GUID-42DB61B8-ADA7-426D-B9E6-24365BDE0506__GUID-6952400C-259E-4561-A653-3EBAB6B3CF58">
                           <p class="notep1">也可以看看：</p>
                           <p>有关使用<code class="codeph">GATHER_FIXED_OBJECTS_STATS</code>过程的更多信息，请<a href="../arpls/DBMS_STATS.html#ARPLS-GUID-EAD4C693-4F03-45DE-9704-1466C8E35232" target="_blank"><span class="italic">参见Oracle Database PL / SQL包和类型参考</span></a></p>
                        </div><pre class="pre codeblock"><code></code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-3B34038A-2C85-4B77-B91D-BB9665883B21" name="GUID-3B34038A-2C85-4B77-B91D-BB9665883B21"></a><h4 id="UPGRD-GUID-3B34038A-2C85-4B77-B91D-BB9665883B21" class="sect4">降级后重新收集陈旧的CBO统计数据</h4>
                  <div>
                     <p>Oracle建议您在完成Oracle数据库降级后重新收集Oracle基于成本的优化程序（CBO）统计信息。</p>
                     <div class="section">
                        <p>升级Oracle数据库并收集新的CBO统计信息时，已升级的数据库具有新的数据库统计信息。升级后的数据库还可以包含新的直方图类型。因此，在降级数据库时，为新版本收集的统计信息可能与先前版本不同。此问题适用于数据字典表和常规用户表。</p>
                        <p>通过使用GATHER_DATABASE_STATS或使用通常用于更新字典和应用程序模式中陈旧统计信息的收集命令来重新过时的统计信息。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-3B34038A-2C85-4B77-B91D-BB9665883B21__DJWREGATHERSTALE2.4.2GATHERIN-36BE6E15">
                        <p>例如：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>非CDB Oracle数据库：为了重新收集统计信息，Oracle建议您使用<code class="codeph">GATHER_DATABASE_STATS</code>过程，并选择<code class="codeph">'GATHER STALE'</code>选项。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; execute dbms_stats.gather_database_stats（options =&gt;'GATHER STALE'）;</pre></li>
                           <li>
                              <p>CDB（多租户架构）Oracle数据库：为了在整个多租户架构中<code>catcon</code>数据字典统计信息，Oracle建议您使用<code>catcon</code> 。
                              </p>
                              <p>要重新收集容器数据库中所有PDB的陈旧字典统计信息，请使用以下语法：</p>
                              <p><code class="codeph">$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -l / tmp -b gatherstats  -  --x“exec dbms_stats.gather_database_stats（options =&gt;'GATHER STALE'）”</code></p>
                              <p>要收集特定PDB上的字典统计信息，请使用类似于以下内容的语法：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -l / tmp -c'SALES1'-b gatherstats  -  --x“exec dbms_stats.gather_database_stats（options =&gt;'GATHER STALE'）”</code></pre><p>在前面的示例中， <code class="codeph">-c SALES1</code>选项为您运行的命令指定PDB包含列表，指定名为<code class="codeph">SALES1</code>的数据库。选项<code class="codeph">-b gatherstats</code>指定日志的基本名称。选项<code class="codeph">--x</code>指定要执行的SQL命令。SQL命令本身在引号内。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../arpls/DBMS_STATS.html#ARPLS-GUID-867989C7-ADFC-4464-8981-437CEA7F331E" target="_blank"><span><cite>Oracle数据库PL / SQL包和类型参考</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-5DF45F07-90FB-4AE2-9814-4956D60726E5" title="由于影响兼容性，组件和支持的协议的更改，在降级Oracle数据库之后可能需要执行其他任务。">Oracle数据库降级的降级后任务</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="UPGRD52750"></a><div class="props_rev_3"><a id="GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" name="GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA"></a><h3 id="UPGRD-GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" class="sect3">对Oracle数据库降级进行故障排除</h3>
               <div>
                  <p>使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。</p>
                  <p>本节包含降级期间可能发生的已知错误，以及解决这些错误的解决方法。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-B34BCFE6-C55F-4D69-BA59-FCC883CD3EA1">错误使用catdwgrd.sql脚本降级Oracle数据库组件</a><br>在降级期间运行<code class="codeph">catdwgrd.sql</code>脚本时，使用此部分可以解决错误，例如<code class="codeph">ORA-20001</code> ：降级无法继续。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-627D70F7-D0B2-442C-B520-06BEBDEBF59C">Oracle Multimedia降级和imrelod.sql脚本错误</a><br>检查是否遇到ORA-20000：注册表中的Oracle ORDIM组件状态为：DOWNGRADED。</li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-DC657D49-A972-4F3F-9D39-D59860133BF8">Oracle Database Vault和dvrelod.sql脚本错误</a><br>检查是否遇到ORA-31011：XML解析失败。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-4B6D5991-6336-4FCC-A8B3-6DA35F4D4C91">升级成功或失败后降级Oracle Grid Infrastructure（Oracle Restart）</a><br>要降级Oracle Restart，必须取消配置，然后重新安装Oracle Grid Infrastructure。然后，您可以添加数据库和服务。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-865ED278-8D25-4D79-8C8F-70343C4535F1">Oracle ACFS和Oracle Grid Infrastructure降级至11g第2版（11.2）</a><br>在尝试启动软件堆栈之前，必须运行<code>acfsroot install</code> 。
                     </li>
                     <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA">降级Oracle Database 11g第1版（11.1）后的数据库链接密码</a><br>重置在版本11.2或12.1中创建的任何数据库链接的密码。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：将</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-CAD9888A-2E6E-48F8-938C-B3E861738606" title="对于受支持的Oracle数据库版本，您可以将数据库降级到上次升级的版本。">Oracle数据库降级为早期版本</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-B34BCFE6-C55F-4D69-BA59-FCC883CD3EA1" name="GUID-B34BCFE6-C55F-4D69-BA59-FCC883CD3EA1"></a><h4 id="UPGRD-GUID-B34BCFE6-C55F-4D69-BA59-FCC883CD3EA1" class="sect4">错误使用catdwgrd.sql脚本降级Oracle数据库组件</h4>
                  <div>
                     <p>在降级期间运行<code class="codeph">catdwgrd.sql</code>脚本时，使用此部分可以解决错误，例如<code class="codeph">ORA-20001</code> ：降级无法继续。
                     </p>
                     <p><code>catdwgrd.sql</code>脚本将数据库中的所有Oracle数据库组件降级到最初升级的主要版本。必须在可以降级数据字典之前运行此脚本。如果在运行脚本时遇到任何问题，请更正问题的原因，然后重新运行脚本。
                     </p>
                     <p>您可以看到的错误包括<code class="codeph">ORA-39709</code> ：不完整的组件降级; string downgrade aborted， <code class="codeph">ORA-06512</code> 。发生这些错误时，降级无法继续。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">原因</span> ：在继续进行数据字典降级之前必须降级的一个或多个组件未降级。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">操作</span> ：查看日志文件以确定在<code class="codeph">catdwgrd.sql</code>脚本暂停之前发生了哪些错误，并且已停止降级。
                           </p>
                        </li>
                     </ul>
                     <p>查看这些示例以了解如何更正此问题。</p>
                     <p>错误通常描述了您必须采取的措施来解决阻止降级完成的问题。按照错误消息中的说明进行操作。修复错误原因后，重新运行<code>catdwgrd.sql</code>脚本。
                     </p>
                     <p>例如，如果由于检查而在降级CDB $ ROOT期间CDB降级失败，请按照错误消息中的说明修复条件错误。在修复错误，重新运行<code>catdwgrd.sql</code>与<code class="codeph">catcon.pl</code> 。使用<code class="codeph">-c</code>选项运行包含列表<code class="codeph">'CDB$ROOT PDB1'</code> 。使用<code class="codeph">-r</code>选项首先在PDB上运行命令，然后在CDB $ ROOT上运行。例如：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -d $ ORACLE_HOME / rdbms / admin -e -b catdwgrd -l / scratch / rac / downgradeLogs -c'CDB $ ROOT，PDB1，PDB2' -r catdwgrd.sql</code></pre><div class="example" id="GUID-B34BCFE6-C55F-4D69-BA59-FCC883CD3EA1__GUID-4AE6D301-0665-463A-9C28-7079B1B1265B">
                        <p class="titleinexample">例7-1由ORA-06512引起的ORA-20001错误</p>
                        <p>你的降级停止了。查看日志文件时，您会发现<code>catdwgrd.sql</code>终止此错误：</p><pre class="pre codeblock"><code>第1行的DECLARE * ERROR：ORA-20001：降级无法继续 - 存在Unified Audit Trail数据。请先使用DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL清理数据。 ORA-06512：第65行ORA-06512：第42行</code></pre><p>您必须在<code class="codeph">CDB$ROOT</code>和所有PDB上清除统一审核试验。
                        </p>
                        <div class="p">例如：<ol>
                              <li>
                                 <p>寻找统一审计线索的存在：</p><pre class="pre codeblock"><code>SQL&gt; SELECT COUNT（*）FROM UNIFIED_AUDIT_TRAIL; COUNT（*）---------- 4538</code></pre></li>
                              <li>
                                 <p>清除审计跟踪。在国家开发银行。</p>
                                 <p>例如，审计跟踪类型为<code class="codeph">DBMS_AUDIT.MGMT.AUDIT</code> ：</p><pre class="pre codeblock"><code>EXEC DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL DBMS_AUDIT_MGMT.AUDIT</code></pre></li>
                              <li>
                                 <p>在<code class="codeph">CDB$ROOT</code>上运行<code class="codeph">catdwngrd.sql</code> 。如果PDB仍具有统一的审计数据，则脚本将因ORA20001而失败：</p><pre class="pre codeblock"><code>62执行立即63'从audsys中选择计数（*）。'|''''|| tab_name ||'“'进入no_rows; 64 65  - 如果审计跟踪有一些数据，则提高应用程序错误66如果no_rows&gt; 0那么67 RAISE_APPLICATION_ERROR（-20001，ErrMsg）; 68结束IF; 69结束IF; 70结束IF; 71例外72当NO_DATA_FOUND那么73 NULL; 74当其他75岁升起时; 76结束; 77 / DECLARE *错误在第1行：ORA-20001：降级无法继续 - 存在Unified Audit Trail数据。请先使用DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL清理数据。 ORA-06512：第75行</code></pre></li>
                              <li>
                                 <p>连接到各个PDB，并查找它们是否具有统一的审计跟踪。清除所有PDB的统一审计跟踪。例如，名为PDB1的PDB具有统一的审计跟踪：</p><pre class="pre codeblock"><code>ALTER SESSION SET container = PDB1; SQL&gt; SELECT COUNT（*）FROM UNIFIED_AUDIT_TRAIL; COUNT（*）---------- 1330</code></pre></li>
                              <li>
                                 <p>确定统一的审计跟踪：</p><pre class="pre codeblock"><code>SQL&gt; CREATE TABLE UA_DATA AS（SELECT * FROM UNIFIED_AUDIT_TRAIL）;</code></pre></li>
                              <li>
                                 <p>清除审计跟踪。</p>
                                 <p>在此示例中，审计跟踪类型为<code class="codeph">DBMS_AUDIT_MGMT.AAUDIT_TRAIL_UNIFIED</code> ， <code class="codeph">USE_LAST_ARCH_TIMESTAMP</code>值设置为<code class="codeph">FALSE</code> ，以便删除所有审计记录，而不考虑上次存档时间戳，并将<code class="codeph">CONTAINER</code>值设置为<code class="codeph">DBMS_AUDIT_MGMT.CONTAINER_ALL</code> ，以便审计记录清除所有PDB。
                                 </p><pre class="pre codeblock"><code>BEGIN DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL（AUDIT_TRAIL_TYPE =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_UNIFIED，USE_LAST_ARCH_TIMESTAMP =&gt; FALSE，CONTAINER =&gt; DBMS_AUDIT_MGMT.CONTAINER_ALL END; /</code></pre></li>
                              <li>
                                 <p>在PDB和CDB级别重新运行<code class="codeph">catdwngrd.sql</code> 。例如：</p><pre class="pre codeblock"><code>$ ORACLE_HOME / perl / bin / perl $ ORACLE_HOME / rdbms / admin / catcon.pl -c'CDB $ ROOT，PDB1'-d $ ORACLE_HOME / rdbms / admin -e -b catdwgrd -l /u01/oracle/product/19.0 .0 / downgrade_logs -r catdwgrd.sql</code></pre></li>
                              <li>
                                 <p>重复查找和清除审计跟踪的过程并运行<code class="codeph">catdwgrd.sql</code>直到脚本在CDB和PDB上成功完成，并且您不再在日志中看到<code class="codeph">ORA-20001</code>错误</p>
                              </li>
                           </ol> 
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="../dbseg/administering-the-audit-trail.html#DBSEG-GUID-7D2E55CE-2820-47E3-A989-5F7AAB19CD76" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="UPGRD60114"></a><div class="props_rev_3"><a id="GUID-627D70F7-D0B2-442C-B520-06BEBDEBF59C" name="GUID-627D70F7-D0B2-442C-B520-06BEBDEBF59C"></a><h4 id="UPGRD-GUID-627D70F7-D0B2-442C-B520-06BEBDEBF59C" class="sect4">Oracle Multimedia降级和imrelod.sql脚本错误</h4>
                  <div>
                     <p>检查是否遇到ORA-20000：注册表中的Oracle ORDIM组件状态为：DOWNGRADED。</p>
                     <p>将Oracle数据库从版本12.1降级到版本11.2.0.2时，可能会从版本11.2.0.2中包含的<code class="codeph">imrelod.sql</code>脚本引发错误。
                     </p>
                     <p><code class="codeph">ORA-20000：注册表中的Oracle ORDIM组件状态为：DOWNGRADED。在Oracle Multimedia升级，降级或修补之前，必须安装Oracle ORDIM并使其有效。</code></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">原因</span> <code class="codeph">imrelod.sql</code>脚本引发此错误，因为它不知道ORDIM的状态。</p>
                        </li>
                        <li>
                           <p><span class="bold">行动</span>没有行动。您可以忽略此错误。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD60115"></a><div class="props_rev_3"><a id="GUID-DC657D49-A972-4F3F-9D39-D59860133BF8" name="GUID-DC657D49-A972-4F3F-9D39-D59860133BF8"></a><h4 id="UPGRD-GUID-DC657D49-A972-4F3F-9D39-D59860133BF8" class="sect4">Oracle Database Vault和dvrelod.sql脚本错误</h4>
                  <div>
                     <p>检查是否遇到ORA-31011：XML解析失败。</p>
                     <p>将Oracle数据库从版本12.1降级到版本11.2.0.3时，使用Oracle Database Vault的数据库可能会遇到以下错误，这是由版本11.2.0.3中包含的<code class="codeph">dvrelod.sql</code>脚本引起的：</p><pre class="pre codeblock"><code>ORA-31011：XML解析失败; Oracle Database Vault降级到版本11.2.0.3</code></pre><ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">原因</span> <code class="codeph">dvrelod.sql</code>脚本不知道XML解析的状态。
                           </p>
                           <p><span class="bold">行动</span>没有行动。您可以忽略此消息。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD60143"></a><div class="props_rev_3"><a id="GUID-4B6D5991-6336-4FCC-A8B3-6DA35F4D4C91" name="GUID-4B6D5991-6336-4FCC-A8B3-6DA35F4D4C91"></a><h4 id="UPGRD-GUID-4B6D5991-6336-4FCC-A8B3-6DA35F4D4C91" class="sect4">升级成功或失败后降级Oracle Grid Infrastructure（Oracle Restart）</h4>
                  <div>
                     <p>要降级Oracle Restart，必须取消配置，然后重新安装Oracle Grid Infrastructure。然后，您可以添加数据库和服务。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="https://support.oracle.com/rs?type=doc&amp;id=1364412.1" target="_blank">https://support.oracle.com/rs?type=doc&amp;id=1364412.1</a></li>
                           <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Grid Infrastructure安装和升级指南</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="UPGRD60116"></a><div class="props_rev_3"><a id="GUID-865ED278-8D25-4D79-8C8F-70343C4535F1" name="GUID-865ED278-8D25-4D79-8C8F-70343C4535F1"></a><h4 id="UPGRD-GUID-865ED278-8D25-4D79-8C8F-70343C4535F1" class="sect4">Oracle ACFS和Oracle Grid Infrastructure降级至11g第2版（11.2）</h4>
                  <div>
                     <p>在尝试启动软件堆栈之前，必须运行<code>acfsroot install</code> 。
                     </p>
                     <p>如果您使用Oracle ASM集群文件系统（Oracle ACFS），并升级到Oracle Grid Infrastructure 12c，无论是集群还是Oracle Restart独立服务器，您选择降级到Oracle Grid Infrastructure 11g第2版（11.2），然后在尝试启动11.2版软件堆栈之前，必须从版本11.2 Oracle Grid Infrastructure Oracle home（Grid home）运行命令<code class="codeph">acfsroot install</code> 。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="UPGRD60144"></a><div class="props_rev_3"><a id="GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA" name="GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA"></a><h4 id="UPGRD-GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA" class="sect4">降级Oracle Database <span class="italic">11g</span>第1版（11.1）后的数据库链接密码</h4>
                  <div>
                     <p>重置在版本11.2或12.1中创建的任何数据库链接的密码。</p>
                     <p>降级到Oracle数据库版本11.1后，您需要重置在版本11.2或12.1中创建的任何数据库链接的密码。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-339D0338-A80C-4B5C-8406-57E7ABEC8121">降级到Oracle Database 11.1第1版后，数据库链接密码出现ORA-00600错误</a><br>如果您不重置数据库链接密码可能会发生此错误。
                        </li>
                        <li class="ulchildlink"><a href="downgrading-oracle-db-after-upgrade.html#GUID-EB0943DA-C2C5-4CC9-93B5-9B2675BCD496">使用Oracle Data Pump导出创建包含所有现有数据库链接的转储文件</a><br>在执行降级之前，请使用此Oracle Data Pump导出过程创建包含所有现有数据库链接的转储文件。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F3DAC69A-A5D0-4998-A14D-DCC8599AD3FA" title="使用此故障排除信息可以解决降级Oracle数据库时可能出现的问题。">对Oracle数据库降级进行故障排除</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-339D0338-A80C-4B5C-8406-57E7ABEC8121" name="GUID-339D0338-A80C-4B5C-8406-57E7ABEC8121"></a><h5 id="UPGRD-GUID-339D0338-A80C-4B5C-8406-57E7ABEC8121" class="sect5">降级到Oracle Database 11.1第1版后，数据库链接密码出现ORA-00600错误</h5>
                     <div>
                        <p>如果您不重置数据库链接密码可能会发生此错误。</p>
                        <div class="p">如果不重置数据库链接密码，则当有人试图使用数据库链接时，将显示内部错误。作为参考，当Oracle服务器无法检索数据库链接的密码时，这是Oracle跟踪文件中报告的内部错误：<pre class="pre codeblock"><code>ORA-00600：[kzdlk_zt2错误]，[18446744073709551601]</code></pre></div>
                        <p>要在降级到版本11.1后重置数据库链接的密码，请使用<code>ALTER DATABASE LINK</code>命令通过在IDENTIFIED BY子句中指定原始密码将密码更改回原始密码。
                        </p>
                        <p>要在运行没有此密码问题的Oracle Database 11.2或12.1版本时创建新的数据库链接，请与Oracle支持部门联系，以获取有关如何使用<code>CREATE DATABASE LINK</code>命令的IDENTIFIED BY VALUES子句的信息。
                        </p>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-339D0338-A80C-4B5C-8406-57E7ABEC8121__GUID-E8A3F122-7431-4AAC-B9E4-B28A8BC43490">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> <code class="codeph">LINK</code>信息，请<a href="../sqlrf/ALTER-DATABASE-LINK.html#SQLRF30050" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                           <p> </p>
                           <p><a href="../admin/developing-applications-for-a-distributed-database-system.html#ADMIN12194" target="_blank"><span class="italic">“Oracle数据库管理员指南”</span></a> ，了解有关控制数据库链接建立的连接的信息</p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA" title="重置在版本11.2或12.1中创建的任何数据库链接的密码。">降级Oracle Database 11g第1版（11.1）后的数据库链接密码</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="UPGRD60145"></a><div class="props_rev_3"><a id="GUID-EB0943DA-C2C5-4CC9-93B5-9B2675BCD496" name="GUID-EB0943DA-C2C5-4CC9-93B5-9B2675BCD496"></a><h5 id="UPGRD-GUID-EB0943DA-C2C5-4CC9-93B5-9B2675BCD496" class="sect5">使用Oracle Data Pump导出创建包含所有现有数据库链接的转储文件</h5>
                     <div>
                        <p>在执行降级之前，请使用此Oracle Data Pump导出过程创建包含所有现有数据库链接的转储文件。</p>
                        <p></p>
                        <p>您创建的转储文件包括任何新创建的数据库链接。该过程使用带有<code>expdp</code>命令的<span class="parmname" translate="no">FULL=Y</span>和<span class="parmname" translate="no">INCLUDE=DB_LINK</span>参数。
                        </p>
                        <ol>
                           <li>
                              <p>登录SQL * Plus。</p>
                              <p>例如：</p><pre class="pre codeblock"><code>sqlplus系统/经理</code></pre></li>
                           <li>
                              <p>删除转储目录以防万一存在。</p>
                              <p>例如：</p><pre class="pre codeblock"><code>SQL&gt; DROP DIRECTORY dpump_dir; SQL&gt; CREATE DIRECTORY dpump_dir AS'/ location_to_write_datapump_dump_file';</code></pre></li>
                           <li>
                              <p>导出数据库链接。</p>
                              <p>例如：</p><pre class="pre codeblock"><code>$ expdp system / manager FULL = Y directory = dpump_dir dumpfile = saved_dblinks.dmp INCLUDE = DB_LINK;</code></pre></li>
                           <li>
                              <p>降级后，如果任何降级的数据库链接无法正常工作，则删除这些链接，并从转储文件中导入它们：</p><pre class="pre codeblock"><code>$ impdp system / manager directory = dpump_dir dumpfile = saved_dblinks.dmp;</code></pre><p>例如，如果您发现链接显示内部错误ORA-00600，则从转储文件中删除和导入链接应该使这些链接按预期工作。</p>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="downgrading-oracle-db-after-upgrade.html#GUID-F5278C79-EB57-4E68-BE58-758F7A9F22FA" title="重置在版本11.2或12.1中创建的任何数据库链接的密码。">降级Oracle Database 11g第1版（11.1）后的数据库链接密码</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="00823.using-xquery-processor-for-Java.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="An explanation is given of how to use the Oracle XML Developer&#39;s Kit (XDK) XQuery processor for Java."></meta>
      <meta name="description" content="An explanation is given of how to use the Oracle XML Developer&#39;s Kit (XDK) XQuery processor for Java."></meta>
      <title>使用XQuery Processor for Java</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide"></meta>
      <meta property="og:description" content="An explanation is given of how to use the Oracle XML Developer&#39;s Kit (XDK) XQuery processor for Java."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="xml-developers-kit-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T05:58:48-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96292-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="using-XSLT-processor-for-Java.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-xquery-API-for-Java-to-access-XML-DB.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML Developers Kit Programmers Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADXDK"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-XSLT-processor-for-Java.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-xquery-API-for-Java-to-access-XML-DB.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XDK-for-Java.html" property="item" typeof="WebPage"><span property="name">Oracle XML Developer's Kit for Java</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用XQuery Processor for Java</li>
            </ol>
            <a id="GUID-9E6570F0-37BB-4690-BFF6-A2052B5B57E8" name="GUID-9E6570F0-37BB-4690-BFF6-A2052B5B57E8"></a><a id="ADXDK991"></a><a id="ADXDK99930"></a>
            
            <h2 id="ADXDK-GUID-9E6570F0-37BB-4690-BFF6-A2052B5B57E8" class="sect2"><span class="enumeration_chapter">15</span>使用XQuery Processor for Java</h2>
         </header>
         <div class="ind">
            <div>
               <p>解释了如何使用Oracle XML Developer Kit（XDK）XQuery处理器来实现Java。</p>
               <div class="section"> </div>
               <!-- class="section" -->
            </div><a id="ADXDK114"></a><a id="ADXDK99995"></a><div class="props_rev_3"><a id="GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA" name="GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA"></a><h3 id="ADXDK-GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA" class="sect3">Java的XQuery处理器简介</h3>
               <div>
                  <p>XDK提供独立的XQuery处理器供Java应用程序使用。XQuery是可扩展标记语言（XML）的万维网联盟（W3C）标准查询语言。使用XQuery在Java应用程序中处理XML可以提高开发人员的工作效率和应用程序性能。</p>
                  <p>使用XQuery编写的应用程序通常需要的代码更少，运行速度更快，并且使用的内存比使用Java编写的应用程序少。</p>
                  <p>JSR 225：XQuery API for Java（XQJ）定义了如何从Java应用程序执行查询。要使用XQJ，您的应用程序必须使用Java 1.6版运行。此外，这些JAR文件是必需的：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">jlib / oxquery.jar</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">jlib / xqjapi.jar</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">jlib / orai18n-mapping.jar</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">LIB / xmlparserv2.jar</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">XDK / jlib /阿帕奇-xmlbeans.jar</code></p>
                     </li>
                  </ul>
                  <p>这些Java Archive（JAR）文件的目录路径相对于Oracle Database安装的<code class="codeph">ORACLE_HOME</code>目录。
                  </p>
                  <p><a href="using-xquery-processor-for-Java.html#GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA__BAJCCHIC">例15-1</a>显示了如何使用XQuery API for Java（XQJ）执行简单的“Hello World”查询。由于XQuery处理器直接在Java虚拟机（JVM）中运行，因此您无需运行此示例的数据库或服务器。该示例打印输出<code class="codeph">&lt;hello-world&gt;2&lt;/hello-world&gt;</code> 。
                  </p>
                  <p>本章介绍特定于XQuery的Oracle实现的功能和扩展。有关XQuery和XQJ的一般信息记录在本文档之外。</p>
                  <div class="infoboxnotealso" id="GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA__GUID-77A75716-1BC7-4010-9469-D56F11AA3588">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a> ， <code class="codeph">XQuery Packages</code> ，用于相关的API文档</p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=jcp_org_jsr225" target="_blank"><span class="italic">JSR-000225用于Java的XQuery API</span></a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquery_30" target="_blank"><span class="italic">XQuery 3.0：XML查询语言</span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="infoboxnote" id="GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA__GUID-B3707335-F147-4DA1-9F43-DFB701A6152C">
                     <p class="notep1">注意：</p>
                     <p>Oracle还将XQuery和XQJ实现为Oracle XML DB的一部分。有关<a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-DDFFD115-A115-4B6C-805C-350AF78281EB" title="An explanation is given of how to use the XQuery API for Java (XQJ) to access Oracle XML DB.">Oracle XML DB</a>的详细信息，请参阅<a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-DDFFD115-A115-4B6C-805C-350AF78281EB" title="解释了如何使用XQuery API for Java（XQJ）来访问Oracle XML DB。">使用XQuery API for Java访问</a> Oracle XML DB。</p>
                  </div>
                  <div class="example" id="GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA__BAJCCHIC">
                     <p class="titleinexample">例15-1使用XQJ进行简单查询</p><pre class="oac_no_warn" dir="ltr">import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。XQSequence都; import oracle.xml.xquery。OXQDataSource; public class HelloWorld {public static void main（String [] args）throws XQException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; String query =“&lt;hello-world&gt; {1 + 1} &lt;/ hello-world&gt;”; XQPreparedExpression expr = con.prepareExpression（query）; XQSequence result = expr.executeQuery（）; //打印“ <code class="codeph">&lt;hello-world&gt;2&lt;/hello-world&gt;</code> ”System.out.println（result.getSequenceAsString（null））; result.close（）; expr.close（）; con.close（）; }}</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK115"></a><div class="props_rev_3"><a id="GUID-5E83610F-647D-4AE5-801B-878244FB6949" name="GUID-5E83610F-647D-4AE5-801B-878244FB6949"></a><h3 id="ADXDK-GUID-5E83610F-647D-4AE5-801B-878244FB6949" class="sect3">XQJ实体解决方案</h3>
               <div>
                  <p>XDK使用实体解析器框架扩展XQJ，以控制在查询处理期间如何获取文档，模式，模块，排序规则和外部函数。本节中的示例显示如何将实体解析器用于多种类型的实体。</p>
                  <p>请参阅类<code class="codeph">oracle.xml.xquery.<a href="../jaxml/index.html" target="_blank"><span><cite>Oracle数据库XML Java API参考</cite></span></a>中的OXQEntity</code> ，以获取查询处理器可以请求的实体类型的完整列表。</p>
               </div><a id="ADXDK116"></a><a id="ADXDK117"></a><a id="ADXDK118"></a><a id="ADXDK112"></a><div class="props_rev_3"><a id="GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2" name="GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2"></a><h4 id="ADXDK-GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2" class="sect4">解决fn：doc的文件</h4>
                  <div>
                     <p>本节中的示例显示了如何使用实体解析器来确定XQuery函数<code class="codeph">fn:doc</code>返回的<code class="codeph">fn:doc</code> 。
                     </p>
                     <div class="section">
                        <p><a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJEEDAJ">例15-2</a>显示了<code class="codeph">books.xml</code>的内容。
                        </p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFFCBB">例15-3</a>显示<code class="codeph">books.xq</code>的内容。
                        </p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFDEDF">示例15-4</a>显示了如何使用自定义实体解析程序执行查询<code class="codeph">books.xq</code> 。
                        </p>
                        <p><code class="codeph">MyEntityResolver</code>的实例通过在连接上设置它来传递给XQuery处理器。XQuery处理器在查询处理期间调用实体解析器以获取<code class="codeph">fn:doc</code>函数返回的<code class="codeph">fn:doc</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJEEDAJ">
                        <p class="titleinexample">例15-2 books.xml</p><pre class="oac_no_warn" dir="ltr">&lt;books&gt; &lt;book&gt; &lt;title&gt;权力的游戏&lt;/ title&gt; &lt;author&gt; &lt;first&gt; George &lt;/ first&gt; &lt;last&gt; Martin &lt;/ last&gt; &lt;/ author&gt; &lt;price&gt; 10.99 &lt;/ price&gt; &lt;/书&gt; &lt;书&gt; &lt;title&gt;地球的支柱&lt;/ title&gt; &lt;author&gt; &lt;first&gt; Ken &lt;/ first&gt; &lt;last&gt; Follett &lt;/ last&gt; &lt;/ author&gt; &lt;price&gt; 7.99 &lt;/ price&gt; &lt;/书&gt; &lt;/ books&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFFCBB">
                        <p class="titleinexample">例15-3 books.xq</p><pre class="oac_no_warn" dir="ltr">for fn：doc（'books.xml'）/ books / book其中xs：decimal（$ book / price）gt 10.00返回$ book / title</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFDEDF">
                        <p class="titleinexample">示例15-4使用自定义实体解析程序执行查询</p><pre class="oac_no_warn" dir="ltr">import java.io.文件; import java.io.的FileInputStream; import java.io.IOException异常; import java.net。URI; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。XQSequence都; import javax.xml.xquery。了XQStaticContext; import oracle.xml.xquery。OXQConnection; import oracle.xml.xquery。OXQDataSource; import oracle.xml.xquery。OXQEntity; import oracle.xml.xquery。OXQEntityKind; import oracle.xml.xquery。OXQEntityLocator; import oracle.xml.xquery。OXQEntityResolver; import oracle.xml.xquery。OXQEntityResolverRequestOptions; import oracle.xml.xquery。OXQView; public class ResolveDocument {private static class MyEntityResolver extends OXQEntityResolver {@Override public OXQEntity resolveEntity（OXQEntityKind kind，OXQEntityLocator locator，OXQEntityResolverRequestOptions options）抛出IOException {if（kind == OXQEntityKind。DOCUMENT）{URI systemId = locator.getSystemIdAsURI（）; if（“file”.equals（systemId.getScheme（）））{File file = new File（systemId）; FileInputStream input = new FileInputStream（file）; OXQEntity结果=新的OXQEntity（输入）; result.enlistCloseable（输入）;返回结果;返回null; public static void main（String [] args）抛出XQException，IOException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; // OXQView用于访问XQJ对象上的Oracle扩展。OXQConnection ocon = OXQView.getConnection（con）; ocon.setEntityResolver（new MyEntityResolver（））;文件查询=新文件（“books.xq”）; //在调用实体解析器之前，将针对基URI解析相对URI。//将根据此URI解析查询中使用的相对URI“books.xml”。 XQStaticContext ctx = con.getStaticContext（）; ctx.setBaseURI（query.toURI（）的toString（））; FileInputStream queryInput = new FileInputStream（query）; XQPreparedExpression expr = con.prepareExpression（queryInput，ctx）; queryInput.close（）; XQSequence result = expr.executeQuery（）; //打印“ <code class="codeph">&lt;title&gt;A Game of Thrones&lt;/title&gt;</code> ”System.out.println（result.getSequenceAsString（null））; result.close（）; expr.close（）; con.close（）; }}</pre><p>该示例生成此输出：</p><pre class="oac_no_warn" dir="ltr">&lt;title&gt;权力的游戏&lt;/ title&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK188"></a><a id="ADXDK189"></a><a id="ADXDK108"></a><a id="ADXDK187"></a><div class="props_rev_3"><a id="GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF" name="GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF"></a><h4 id="ADXDK-GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF" class="sect4">外部XQuery函数的解析</h4>
                  <div>
                     <p>您可以使用实体解析程序来定义XQuery外部函数的实现。</p>
                     <div class="section">
                        <p>对于在查询中声明的每个外部XQuery函数，使用实体类<code class="codeph">oracle.xml.xquery.调用实体解析器<code class="codeph">oracle.xml.xquery.OXQEntityKind。EXTERNAL_FUNCTION</code> 。 <code class="codeph">oracle.xml.xquery.在对实体解析器的调用中传递的OXQEntityLocator</code>实例提供XQuery函数的名称及其参数类型。然后，实体解析器可以返回任何扩展<code class="codeph">oracle.xml.xquery.类<code class="codeph">oracle.xml.xquery.OXQFunctionEvaluator</code>并具有公共构造函数。然后，XQuery处理器实例化返回的类。在计算XQuery外部函数调用时，调用方法<code class="codeph">evaluate()</code> 。
                        </p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJIFHBB">例15-5</a>显示了一个XQuery查询，它是文件<code class="codeph">trim.xq</code>的内容。
                        </p>
                        <p>外部XQuery函数<code class="codeph">util:trim</code>从字符串值的开头和结尾删除空格。此函数在Java中实现，并在查询中调用。
                        </p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJFAIFJ">例15-6</a>使用了<code class="codeph">trim.xq</code>并展示了如何定义外部XQuery函数的实现。此示例中的实体解析程序返回一个扩展<code class="codeph">OXQFunctionEvaluator</code>的类。
                        </p>
                        <p>在某些情况下，返回Java静态方法而不是类更方便。返回静态方法时，查询处理器会自动将方法参数和返回值映射到XQuery数据模型，如XQJ规范所定义。</p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJEJAGB">例15-7</a>也运行<code class="codeph">trim.xq</code> ，但在这种情况下，外部函数绑定到Java静态方法。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJIFHBB">
                        <p class="titleinexample">例15-5 trim.xq</p><pre class="oac_no_warn" dir="ltr">declare namespace util =“http://example.com/util”;声明函数util：trim（$ arg as xs：string）as xs：string external; （：带有周围空白区域的字符串:)声明变量$ input：=“John Doe”; &lt;结果&gt; {UTIL：修剪（$输入）} &lt;/结果&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJFAIFJ">
                        <p class="titleinexample">例15-6定义外部XQuery函数的实现</p><pre class="oac_no_warn" dir="ltr">import java.io.的FileInputStream; import java.io.IOException异常; import java.util。集合; import javax.xml.namespace。QName的; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。XQSequence都; import oracle.xml.xquery。OXQConnection; import oracle.xml.xquery。OXQDataSource; import oracle.xml.xquery。OXQEntity; import oracle.xml.xquery。OXQEntityKind; import oracle.xml.xquery。OXQEntityLocator; import oracle.xml.xquery。OXQEntityResolver; import oracle.xml.xquery。OXQEntityResolverRequestOptions; import oracle.xml.xquery。OXQFunctionContext; import oracle.xml.xquery。OXQFunctionEvaluator; import oracle.xml.xquery。OXQFunctionMetaData; import oracle.xml.xquery。OXQView; public class ResolveExternalFunction {public static class TrimFunction extends OXQFunctionEvaluator {@Override public XQSequence evaluate（OXQFunctionContext context，XQSequence [] params）throws XQException {XQConnection con = context.getConnection（）; XQSequence arg = params [0]; String value = arg.getSequenceAsString（null）; String trimmed = value.trim（）; return con.createSequence（Collections.singleton（trimmed）.iterator（））;私有静态类MyEntityResolver扩展OXQEntityResolver {@Override public OXQEntity resolveEntity（OXQEntityKind kind，OXQEntityLocator locator，OXQEntityResolverRequestOptions选项）抛出XQException，IOException {if（kind == OXQEntityKind。EXTERNAL_FUNCTION）{OXQFunctionMetaData metaData =（OXQFunctionMetaData）locator.getExtension（）; QName name = metaData.getName（）; int arity = metaData.getParameterTypes（）。length; if（“http://example.com/util”.equals（name.getNamespaceURI（））&amp;&amp;“trim”.equals（name.getLocalPart（））&amp;&amp; arity == 1）{return new OXQEntity（TrimFunction.class） ;返回null; public static void main（String [] args）抛出IOException，XQException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; OXQConnection ocon = OXQView.getConnection（con）; ocon.setEntityResolver（new MyEntityResolver（））; FileInputStream query = new FileInputStream（“trim.xq”）; XQPreparedExpression expr = con.prepareExpression（query）; query.close（）; XQSequence result = expr.executeQuery（）;的System.out.println（result.getSequenceAsString（空））; result.close（）; expr.close（）; con.close（）; }}</pre><p>该示例打印此输出： <code class="codeph">&lt;result&gt;John Doe&lt;/result&gt;</code> 。
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJEJAGB">
                        <p class="titleinexample">示例15-7将外部函数绑定到Java静态方法</p><pre class="oac_no_warn" dir="ltr">import java.io.的FileInputStream; import java.io.IOException异常; import java.lang.reflect。方法; import javax.xml.namespace。QName的; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。XQSequence都; import oracle.xml.xquery。OXQConnection; import oracle.xml.xquery。OXQDataSource; import oracle.xml.xquery。OXQEntity; import oracle.xml.xquery。OXQEntityKind; import oracle.xml.xquery。OXQEntityLocator; import oracle.xml.xquery。OXQEntityResolver; import oracle.xml.xquery。OXQEntityResolverRequestOptions; import oracle.xml.xquery。OXQFunctionMetaData; import oracle.xml.xquery。OXQView; public class ResolveExternalFunction2 {public static String trim（String value）{return value.trim（）; private static class MyEntityResolver extends OXQEntityResolver {@Override public OXQEntity resolveEntity（OXQEntityKind kind，OXQEntityLocator locator，OXQEntityResolverRequestOptions options）抛出XQException，IOException {if（kind == OXQEntityKind。EXTERNAL_FUNCTION）{OXQFunctionMetaData metaData =（OXQFunctionMetaData）locator.getExtension（）; QName name = metaData.getName（）; int arity = metaData.getParameterTypes（）。length; if（“http://example.com/util”.equals（name.getNamespaceURI（））&amp;&amp;“trim”.equals（name.getLocalPart（））&amp;&amp; arity == 1）{Method staticMethod = null; try {staticMethod = ResolveExternalFunction2.class.getMethod（“trim”，String.class）; } catch（NoSuchMethodException e）{throw new IllegalStateException（e）; } return new OXQEntity（staticMethod）;返回null; public static void main（String [] args）抛出IOException，XQException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; OXQConnection ocon = OXQView.getConnection（con）; ocon.setEntityResolver（new MyEntityResolver（））; FileInputStream query = new FileInputStream（“trim.xq”）; XQPreparedExpression expr = con.prepareExpression（query）; query.close（）; XQSequence result = expr.executeQuery（）; //打印“&lt;result&gt; John Doe &lt;/ result&gt;”System.out.println（result.getSequenceAsString（null））; result.close（）; expr.close（）; con.close（）; }}</pre><p>该示例打印与<a href="using-xquery-processor-for-Java.html#GUID-4B1AD5F7-FAF2-44C3-B577-5A5CF44B5AFF__BAJFAIFJ">示例15-6</a>相同的输出： <code class="codeph">&lt;result&gt;John Doe&lt;/result&gt;</code> 。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK110"></a><a id="ADXDK111"></a><a id="ADXDK113"></a><a id="ADXDK109"></a><div class="props_rev_3"><a id="GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0" name="GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0"></a><h4 id="ADXDK-GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0" class="sect4">解决导入的XQuery模块</h4>
                  <div>
                     <p>实体解析器可以找到XQuery库模块导入的XQuery模块。</p>
                     <p>XQuery库模块提供可由其他模块导入的函数和变量。对于每个导入的模块，使用实体类型<code class="codeph">oracle.xml.xquery.调用实体解析器<code class="codeph">oracle.xml.xquery.OXQEntityKind。MODULE</code> 。使用<code class="codeph">oracle.xml.xquery.OXQEntityLocator</code>实例中，您可以调用<code class="codeph">getSystemId()</code>方法来获取正在导入的模块的位置。如果模块导入中未提供任何位置，则可以调用方法<code class="codeph">getNamespace()</code>以获取模块的目标命名空间。然后，实体解析器可以返回相应的库模块。
                     </p>
                     <p>本节中的示例显示了如何使用实体解析程序来控制XQuery库模块的分辨率。</p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJHBFFI">例15-8</a>显示了<code class="codeph">math.xq</code>的内容。
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJDCFCE">例15-9</a>显示了<code class="codeph">main.xq</code>的内容。
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJDGAIF">示例15-10</a>显示了如何执行导入库模块的查询。
                     </p>
                     <p>查询<code class="codeph">main.xq</code>导入库模块<code class="codeph">math.xq</code> ，然后调用函数<code class="codeph">math:circumference</code>来计算圆周长。
                     </p>
                     <div class="example" id="GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJHBFFI">
                        <p class="titleinexample">例15-8 math.xq</p><pre class="oac_no_warn" dir="ltr">module namespace math =“http://example.com/math”;声明变量$ math：pi as xs：decimal：= 3.14159265;声明函数math：circumference（$ diameter as xs：decimal）{$ math：pi * $ diameter};</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJDCFCE">
                        <p class="titleinexample">例15-9 main.xq</p><pre class="oac_no_warn" dir="ltr">“math.xq”中的import module namespace math =“http://example.com/math”;数学：周长（6.54）</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-ED851251-5829-4A8A-B4CD-3D9DF43232C0__BAJDGAIF">
                        <p class="titleinexample">示例15-10执行导入库模块的查询</p><pre class="oac_no_warn" dir="ltr">import java.io.文件; import java.io.的FileInputStream; import java.io.IOException异常; import java.net。URI; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。XQSequence都; import javax.xml.xquery。了XQStaticContext; import oracle.xml.xquery。OXQConnection; import oracle.xml.xquery。OXQDataSource; import oracle.xml.xquery。OXQEntity; import oracle.xml.xquery。OXQEntityKind; import oracle.xml.xquery。OXQEntityLocator; import oracle.xml.xquery。OXQEntityResolver; import oracle.xml.xquery。OXQEntityResolverRequestOptions; import oracle.xml.xquery。OXQView; public class ResolveLibraryModule {private static class MyEntityResolver extends OXQEntityResolver {@Override public OXQEntity resolveEntity（OXQEntityKind kind，OXQEntityLocator locator，OXQEntityResolverRequestOptions options）抛出IOException {if（kind == OXQEntityKind。MODULE）{URI systemId = locator.getSystemIdAsURI（）; if（systemId！= null &amp;&amp;“file”.equals（systemId.getScheme（）））{File file = new File（systemId）; FileInputStream input = new FileInputStream（file）; OXQEntity结果=新的OXQEntity（输入）; result.enlistCloseable（输入）;返回结果;返回null; public static void main（String [] args）抛出XQException，IOException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; // OXQView用于访问XQJ对象上的Oracle扩展。OXQConnection ocon = OXQView.getConnection（con）; ocon.setEntityResolver（new MyEntityResolver（））;文件查询=新文件（“main.xq”）; //在调用实体解析器之前，将针对基URI解析相对URI。//将根据此URI解析查询中使用的相对URI“math.xq”。 XQStaticContext ctx = con.getStaticContext（）; ctx.setBaseURI（query.toURI（）的toString（））; FileInputStream queryInput = new FileInputStream（query）; XQPreparedExpression expr = con.prepareExpression（queryInput，ctx）; queryInput.close（）; XQSequence result = expr.executeQuery（）; //打印结果：“20.546015931”System.out.println（result.getSequenceAsString（null））; result.close（）; expr.close（）; con.close（）; }}</pre><p>该示例生成此输出：</p><pre class="oac_no_warn" dir="ltr">20.546015931</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK102"></a><a id="ADXDK103"></a><a id="ADXDK104"></a><a id="ADXDK101"></a><div class="props_rev_3"><a id="GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935" name="GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935"></a><h4 id="ADXDK-GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935" class="sect4">解决由XQuery查询导入的XML模式</h4>
                  <div>
                     <p>您可以使用实体解析程序来控制XQuery查询导入的XML架构。</p>
                     <p>XQuery模式导入从XML模式导入元素定义和元素和属性的声明。您可以在查询中使用导入的声明和定义来验证和测试数据实例。</p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJBFCBH">例15-11</a>显示了XML模式文件<code class="codeph">size.xsd</code>的内容。
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJIDADH">例15-12</a>显示了XQuery文件<code class="codeph">size.xq</code>的内容。
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJBEEGC">示例15-13</a>显示了如何执行导入架构的查询。
                     </p>
                     <p><code class="codeph">size.xq</code>使用类型<code class="codeph">shirt-size</code>所限定<code class="codeph">size.xsd</code>测试值的列表。
                     </p>
                     <div class="example" id="GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJBFCBH">
                        <p class="titleinexample">例15-11 size.xsd</p><pre class="oac_no_warn" dir="ltr">&lt;xs：schema xmlns：xs =“http://www.w3.org/2001/XMLSchema”targetNamespace =“http://example.com/size”&gt; &lt;xs：simpleType name =“shirt-size”&gt; &lt; xs：restriction base =“xs：string”&gt; &lt;xs：enumeration value =“XS”/&gt; &lt;xs：enumeration value =“S”/&gt; &lt;xs：enumeration value =“M”/&gt; &lt;xs：enumeration value = “L”/&gt; &lt;xs：枚举值=“XL”/&gt; &lt;/ xs：restriction&gt; &lt;/ xs：simpleType&gt; &lt;/ xs：schema&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJIDADH">
                        <p class="titleinexample">例15-12 size.xq</p><pre class="oac_no_warn" dir="ltr">在“size.xsd”处导入架构名称空间ns =“http://example.com/size”;对于$ size（“S”，“big”，“XL”，42）返回if（$ size castable as ns：shirt-size）然后ns：shirt-size（$ size）else concat（“INVALID：”， $大小）</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-E03FFCF3-0A2E-4764-A2CF-429D0A828935__BAJBEEGC">
                        <p class="titleinexample">示例15-13执行导入XML架构的XQuery查询</p><pre class="oac_no_warn" dir="ltr">import java.io.文件; import java.io.的FileInputStream; import java.io.IOException异常; import java.net。URI; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。XQSequence都; import javax.xml.xquery。了XQStaticContext; import oracle.xml.xquery。OXQConnection; import oracle.xml.xquery。OXQDataSource; import oracle.xml.xquery。OXQEntity; import oracle.xml.xquery。OXQEntityKind; import oracle.xml.xquery。OXQEntityLocator; import oracle.xml.xquery。OXQEntityResolver; import oracle.xml.xquery。OXQEntityResolverRequestOptions; import oracle.xml.xquery。OXQView; public class ResolveSchema {private static class MyEntityResolver extends OXQEntityResolver {@Override public OXQEntity resolveEntity（OXQEntityKind kind，OXQEntityLocator locator，OXQEntityResolverRequestOptions options）抛出IOException {if（kind == OXQEntityKind。SCHEMA）{URI systemId = locator.getSystemIdAsURI（）; if（systemId！= null &amp;&amp;“file”.equals（systemId.getScheme（）））{File file = new File（systemId）; FileInputStream input = new FileInputStream（file）; OXQEntity结果=新的OXQEntity（输入）; result.enlistCloseable（输入）;返回结果;返回null; public static void main（String [] args）抛出XQException，IOException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; // OXQView用于访问XQJ对象上的Oracle扩展。OXQConnection ocon = OXQView.getConnection（con）; ocon.setEntityResolver（new MyEntityResolver（））;文件查询=新文件（“size.xq”）; //在调用实体解析器之前，将针对基URI解析相对URI。//将根据此URI解析查询中使用的相对URI“math.xq”。 XQStaticContext ctx = con.getStaticContext（）; ctx.setBaseURI（query.toURI（）的toString（））; FileInputStream queryInput = new FileInputStream（query）; XQPreparedExpression expr = con.prepareExpression（queryInput，ctx）; queryInput.close（）; XQSequence result = expr.executeQuery（）; //打印“S INVALID：big XL INVALID：42”System.out.println（result.getSequenceAsString（null））; result.close（）; expr.close（）; con.close（）; }}</pre><p>该示例打印此输出： <code class="codeph">S INVALID:big XL INVALID:42</code> 。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK107"></a><a id="ADXDK106"></a><div class="props_rev_3"><a id="GUID-93E92988-81E7-4591-9F18-631525C86F1B" name="GUID-93E92988-81E7-4591-9F18-631525C86F1B"></a><h4 id="ADXDK-GUID-93E92988-81E7-4591-9F18-631525C86F1B" class="sect4">XQuery的预制实体解析器</h4>
                  <div>
                     <p>XDK包含多个<code class="codeph">OXQEntityResolver</code>实现，可用于常见任务，如文件系统和HTTP解析。这有时可以节省您需要实现自己的实体解析器。
                     </p>
                     <div class="section">
                        <p><a href="using-xquery-processor-for-Java.html#GUID-93E92988-81E7-4591-9F18-631525C86F1B__BAJBBBBH">例15-14</a>显示了如何使用预制文件解析器在<a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFFCBB">例15-3中</a>运行查询。
                        </p>
                        <p>工厂<code class="codeph">oracle.xml.xquery.一个实例<code class="codeph">oracle.xml.xquery.OXQFileResolverFactory</code>是从连接创建的。然后，此工厂用于创建实体解析程序，该解析程序根据文件系统解析模式，模块和文档。与此示例相反， <a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFDEDF">示例15-4</a>使用自定义实体解析程序<code class="codeph">MyEntityResolver</code>仅解析文件系统的文档。
                        </p>
                        <p>XDK提供这些实体解析器工厂：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">oracle.xml.xquery。OXQFileResolverFactory</code> ：创建一个实体解析器，解析模式，模块和文档位置的'file：'URI。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.xml.xquery。OXQHttpResolverFactory</code> ：创建一个实体解析器，用于解析模式，模块和文档位置的“http：”URI。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.xml.xquery。OXQCompositeResolverFactory</code> ：创建一个实体解析器，将请求委托给其他实体解析器。对于任何类型的请求，解析器返回从其中一个委托解析器接收的第一个非空结果。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oracle.xml.xquery。OXQJavaResolverFactory</code> ：创建一个实体解析器，将外部函数和模块解析为Java静态方法或类。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-93E92988-81E7-4591-9F18-631525C86F1B__GUID-37F46B28-93FE-4626-9687-3CE8D39A4AD7">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API Reference</cite></span></a> ，包<code class="codeph">oracle.xml.xquery</code> ，用于获取有关这些工厂接口的API信息</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-93E92988-81E7-4591-9F18-631525C86F1B__BAJBBBBH">
                        <p class="titleinexample">示例15-14使用预制文件解析程序执行查询</p><pre class="oac_no_warn" dir="ltr">import java.io.文件; import java.io.的FileInputStream; import java.io.IOException异常; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。XQSequence都; import javax.xml.xquery。了XQStaticContext; import oracle.xml.xquery。OXQConnection; import oracle.xml.xquery。OXQDataSource; import oracle.xml.xquery。OXQFileResolverFactory; import oracle.xml.xquery。OXQView; public class ResolverFactory {public static void main（String [] args）抛出XQException，IOException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; // OXQView用于访问XQJ对象上的Oracle扩展。OXQConnection ocon = OXQView.getConnection（con）; OXQFileResolverFactory factory = ocon.createEntityResolverFactory（OXQFileResolverFactory.class）; ocon.setEntityResolver（factory.createResolver（））;文件查询=新文件（“books.xq”）; //在调用实体解析器之前，将针对基URI解析相对URI。//将根据此URI解析查询中使用的相对URI“books.xml”。 XQStaticContext ctx = con.getStaticContext（）; ctx.setBaseURI（query.toURI（）的toString（））; FileInputStream queryInput = new FileInputStream（query）; XQPreparedExpression expr = con.prepareExpression（queryInput，ctx）; queryInput.close（）; XQSequence result = expr.executeQuery（）; //打印“&lt;title&gt;权力的游戏&lt;/ title&gt;”System.out.println（result.getSequenceAsString（null））; result.close（）; expr.close（）; con.close（）; }}</pre><p>该示例打印此输出： <code class="codeph">&lt;title&gt;A Game of Thrones&lt;/title&gt;</code> 。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-05361BD0-575E-4021-A099-86AB7DF83A2B" name="GUID-05361BD0-575E-4021-A099-86AB7DF83A2B"></a><h4 id="ADXDK-GUID-05361BD0-575E-4021-A099-86AB7DF83A2B" class="sect4">解决其他类型的实体</h4>
                  <div>
                     <p>除了文档，模式，模块和外部函数之外，您还可以使用XQJ实体解析程序来获取其他实体。</p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-05361BD0-575E-4021-A099-86AB7DF83A2B__GUID-08201187-0EB8-4C60-9998-4DDCBB022AA6" title="描述各种类型的实体。">表15-1</a>描述了这些其他实体。
                     </p>
                     <div class="tblformal" id="GUID-05361BD0-575E-4021-A099-86AB7DF83A2B__GUID-08201187-0EB8-4C60-9998-4DDCBB022AA6">
                        <p class="titleintable">表15-1各种实体的描述</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="各种实体的描述" border="1" summary="Describes various types of entity." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d53703e1158">OXQEntityKind</th>
                                 <th align="left" valign="bottom" width="20%" id="d53703e1160">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1164" headers="d53703e1158 "><code class="codeph">文本</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1164 d53703e1160 "><code class="codeph">fn:unparsed-text</code>和<code class="codeph">fn:unparsed-text-lines</code> 。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1176" headers="d53703e1158 "><code class="codeph">ENVIRONMENT_VARIABLE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1176 d53703e1160 "><code class="codeph">fn:available-environment-variables</code>和<code class="codeph">fn:environment-variable</code> 。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1188" headers="d53703e1158 "><code class="codeph">DOCUMENT_TYPE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1188 d53703e1160 ">函数<code class="codeph">fn:doc</code>静态类型。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1197" headers="d53703e1158 "><code class="codeph">采集</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1197 d53703e1160 "><code class="codeph">fn:collection</code>返回的文档。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1206" headers="d53703e1158 "><code class="codeph">URI_COLLECTION</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1206 d53703e1160 "><code class="codeph">fn:uri-collection</code>返回的<code class="codeph">fn:uri-collection</code> 。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1215" headers="d53703e1158 "><code class="codeph">XML_PARSER_FACTORY</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1215 d53703e1160 ">用于解析XML数据的StAX实现。</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1221" headers="d53703e1158 "><code class="codeph">XML_ENTITY</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1221 d53703e1160 ">在StAX解析器需要解析外部XML资源时使用。</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1227" headers="d53703e1158 "><code class="codeph">UPD_PUT</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1227 d53703e1160 ">控制<code class="codeph">fn:put</code>的行为。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53703e1236" headers="d53703e1158 "><code class="codeph">整理</code></td>
                                 <td align="left" valign="top" width="20%" headers="d53703e1236 d53703e1160 ">控制归类URI的行为。</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>有关如何使用这些实体类型的详细信息，请参阅类<code class="codeph">oracle.xml.xquery.<a href="../jaxml/index.html" target="_blank"><span><cite>Oracle数据库XML Java API参考中的</cite></span></a> OXQEntity</code> 。
                     </p>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535" name="GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535"></a><h3 id="ADXDK-GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535" class="sect3">XQuery输出声明</h3>
               <div>
                  <p>XQuery 3.0定义了输出声明，您可以使用它来设置查询中的序列化参数值。</p>
                  <p>输出声明是名称空间<code class="codeph">http://www.w3.org/2010/xslt-xquery-serialization</code>的选项声明。您可以在查询中使用它来声明和设置静态上下文中的序列化参数。
                  </p>
                  <p>默认情况下，忽略这些静态上下文序列化参数，但可以使用XQJ方法<code class="codeph">OXQPreparedExpression#getExpressionStaticContext()</code>和<code class="codeph">OXQStaticContext#getSerializationParameters()</code>来访问它们。
                  </p>
                  <p><a href="using-xquery-processor-for-Java.html#GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__ACCESSINGTHEVALUESOFOPTIONDECLARATI-AB3FDA80">例15-15</a>显示了如何访问选项声明的值。
                  </p>
                  <p>您还可以在序列化查询结果时使用选项声明。<a href="using-xquery-processor-for-Java.html#GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__USINGOPTIONDECLARATIONSWHENSERIALIZ-AB3FD4F9">示例15-16</a>与<a href="using-xquery-processor-for-Java.html#GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__ACCESSINGTHEVALUESOFOPTIONDECLARATI-AB3FDA80">示例15-15</a>类似，但它在序列化查询结果时使用静态上下文序列化参数。
                  </p>
                  <div class="infoboxnote" id="GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__GUID-451D1906-2A81-45B0-9E55-4C838105C0C1">
                     <p class="notep1">注意：</p>选项<code class="codeph">output:parameter-document</code>的URI值<code class="codeph">output:parameter-document</code>文档使用实体解析器<code class="codeph">OXQEntityResolver</code>和实体类型<code class="codeph">OXQEntityKind#DOCUMENT</code> <a href="using-xquery-processor-for-Java.html#GUID-05361BD0-575E-4021-A099-86AB7DF83A2B" title="You can use the XQJ entity resolver to obtain other entities, besides documents, schemas, modules, and external functions.">解析为</a> <code class="codeph">OXQEntityKind#DOCUMENT</code> - 请参阅<a href="using-xquery-processor-for-Java.html#GUID-05361BD0-575E-4021-A099-86AB7DF83A2B" title="除了文档，模式，模块和外部函数之外，您还可以使用XQJ实体解析程序来获取其他实体。">其他实体类型的解析</a> 。
                  </div>
                  <div class="example" id="GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__ACCESSINGTHEVALUESOFOPTIONDECLARATI-AB3FDA80">
                     <p class="titleinexample">示例15-15访问选项声明的值</p><pre class="pre codeblock"><code>import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。了XQStaticContext; import oracle.xml.xquery。OXQDataSource; import oracle.xml.xquery。OXQPreparedExpression; import oracle.xml.xquery。OXQSerializationParameters; import oracle.xml.xquery。OXQStaticContext; import oracle.xml.xquery。OXQView; public class OptionDeclarations1 {public static void main（String [] args）throws XQException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; String query =“declare option output：indent'yes'; \ n”+“declare option output：encoding'UTF-16'; \ n”+“&lt;person&gt; &lt;first&gt; John &lt;/ first&gt; &lt;last&gt; Doe &lt; /最后&gt; &lt;/人&gt;“; XQPreparedExpression expr = con.prepareExpression（query）; OXQPreparedExpression oexpr = OXQView.getPreparedExpression（expr）; XQStaticContext ctx = oexpr.getExpressionStaticContext（）; OXQStaticContext octx = OXQView.getStaticContext（ctx）; OXQSerializationParameters params = octx.getSerializationParameters（）; System.out.println（“indent =”+ params.isIndent（））; System.out.println（“encoding =”+ params.getEncoding（））; expr.close（）; con.close（）; }}</code></pre><p>这会产生以下输出：</p><pre class="pre codeblock"><code>indent = true encoding = UTF-16</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-1BFF8A32-CC6F-403C-8C36-16D4FFF41535__USINGOPTIONDECLARATIONSWHENSERIALIZ-AB3FD4F9">
                     <p class="titleinexample">示例15-16序列化查询结果时使用选项声明</p><pre class="pre codeblock"><code>package oracle.xml.xquery.examples.published; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。XQResultSequence; import javax.xml.xquery。了XQStaticContext; import oracle.xml.xquery。OXQDataSource; import oracle.xml.xquery。OXQPreparedExpression; import oracle.xml.xquery。OXQSerializationParameters; import oracle.xml.xquery。OXQStaticContext; import oracle.xml.xquery。OXQView; public class OptionDeclarations2 {public static void main（String [] args）throws XQException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; String query =“declare option output：indent'yes'; \ n”+“declare option output：omit-xml-declaration'no'; \ n”+“&lt;person&gt; &lt;first&gt; John &lt;/ first&gt; &lt;last&gt; DOE &lt;/最后&gt; &lt;/人&gt;“; XQPreparedExpression expr = con.prepareExpression（query）; OXQPreparedExpression oexpr = OXQView.getPreparedExpression（expr）; XQStaticContext ctx = oexpr.getExpressionStaticContext（）; OXQStaticContext octx = OXQView.getStaticContext（ctx）; OXQSerializationParameters params = octx.getSerializationParameters（）; XQResultSequence result = expr.executeQuery（）; result.writeSequence（System.out，params.createProperties（））; result.close（）; expr.close（）; con.close（）; }}</code></pre><p>这会产生以下输出：</p><pre class="pre codeblock"><code>&lt;？xml version =“1.0”encoding =“UTF-8”？&gt; &lt;person&gt; &lt;first&gt; John &lt;/ first&gt; &lt;last&gt; Doe &lt;/ last&gt; &lt;/ person&gt;</code></pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK119"></a><div class="props_rev_3"><a id="GUID-2F04CC88-EDFF-4449-9F3B-E797285A5879" name="GUID-2F04CC88-EDFF-4449-9F3B-E797285A5879"></a><h3 id="ADXDK-GUID-2F04CC88-EDFF-4449-9F3B-E797285A5879" class="sect3">使用XQuery提高应用程序性能和可伸缩性</h3>
               <div>
                  <p>XDK XQuery处理器提供了多种功能，可以提高应用程序的性能和可伸缩性。</p>
                  <div class="section"> </div>
                  <!-- class="section" -->
               </div><a id="ADXDK120"></a><a id="ADXDK121"></a><a id="ADXDK190"></a><div class="props_rev_3"><a id="GUID-80E29834-C423-41F9-BE6D-D34388E15A98" name="GUID-80E29834-C423-41F9-BE6D-D34388E15A98"></a><h4 id="ADXDK-GUID-80E29834-C423-41F9-BE6D-D34388E15A98" class="sect4">流式查询评估</h4>
                  <div>
                     <p>用于Java的XDK XQuery处理器支持许多类型的查询的流式评估。即使输入XML非常大，流式评估也需要少量主内存。</p>
                     <div class="section">
                        <p>为便于进行流式传输评估，建议采取以下措施：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将静态上下文的绑定模式设置为延迟模式（请参阅方法<code class="codeph">javax.xml.xquery.<a href="../jaxml/index.html" target="_blank"><span><cite>Oracle数据库XML Java API参考中的</cite></span></a> XQStaticContext.setBindingMode(int)</code> ）。如果未延迟绑定模式，则绑定时输入XML将完全实现。
                              </p>
                           </li>
                           <li>
                              <p>提供输入XML作为<code class="codeph">java.io.的实例。InputStream</code> ， <code class="codeph">java.io.Reader</code>或<code class="codeph">javax.xml.stream.XMLStreamReader</code> 。输入XML通过将其绑定到表达式或通过从实体解析器返回来提供给查询处理器。
                              </p>
                           </li>
                           <li>
                              <p>确保<code class="codeph">javax.xml.xquery.XQSequence</code>实例以不需要实现的方式使用：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>字符串序列化方法<code class="codeph">getSequenceAsString(...)</code>和<code class="codeph">getItemAsString(...)</code>将数据生成为保存在内存中的字符串。而是使用<code class="codeph">writeSequence(...)</code>或<code class="codeph">writeItem(...)</code>方法序列化序列。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">getNode()</code>方法构建一个保存在内存中的文档对象模型（DOM）节点。相反，请考虑使用<code class="codeph">getSequenceAsStream()</code>或<code class="codeph">getItemAsStream()</code>方法来获取XML（StAX）流的Streaming API。
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">getItem()</code>方法复制并具体化内存中的当前项。而是直接在<code class="codeph">java.xml.xquery.上使用方法<code class="codeph">java.xml.xquery.XQSequence</code>实例访问当前项（请参阅接口<code class="codeph">javax.xml.xquery.<a href="../jaxml/index.html" target="_blank"><span><cite>Oracle数据库XML Java API参考中的</cite></span></a> XQItemAccessor</code> ）。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                        <p>本节中显示的代码以不阻止流式评估的方式使用XQJ调用查询。</p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-80E29834-C423-41F9-BE6D-D34388E15A98__BAJCBHAA">例15-17</a>显示<code class="codeph">books2.xq</code>的内容。
                        </p>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-80E29834-C423-41F9-BE6D-D34388E15A98__BAJFEHHJ">例15-18</a>设置查询以启用流评估。该示例将此输出写入文件<code class="codeph">results.xml</code> ： <code class="codeph">&lt;title&gt;A Game of Thrones&lt;/title&gt;</code> 。
                        </p>
                        <p>绑定模式设置为值<code class="codeph">BINDING_MODE_DEFERRED</code>以避免在绑定到准备好的表达式时实现<code class="codeph">books.xml</code> 。同样，结果将写入输出流，并且不会实现。
                        </p>
                        <p>为了简化示例，输入文件<code class="codeph">books.xml</code>很小。即使此文件包含数百万本书，评估查询也只需要很小的最大堆大小，因为一次只有一个book元素保存在内存中。与<a href="using-xquery-processor-for-Java.html#GUID-74123D7F-5491-4F5D-BDA5-B2CC2F3B33C2__BAJFFCBB">示例15-3中</a>显示的query <code class="codeph">books.xq</code> ，查询<code class="codeph">books2.xq</code>不需要您定义实体解析器。两个示例（ <code class="codeph">books.xq</code>和<code class="codeph">books2.xq</code> ）都是可流式的。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-80E29834-C423-41F9-BE6D-D34388E15A98__BAJCBHAA">
                        <p class="titleinexample">例15-17 books2.xq</p><pre class="oac_no_warn" dir="ltr">声明变量$ doc external; $ book / books / book中的$ book：xs：decimal（$ book / price）gt 10.00返回$ book / title</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-80E29834-C423-41F9-BE6D-D34388E15A98__BAJFEHHJ">
                        <p class="titleinexample">例15-18促进流媒体评估</p><pre class="oac_no_warn" dir="ltr">import java.io.的FileInputStream; import java.io.FileOutputStream中; import java.io.IOException异常; import javax.xml.namespace。QName的; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQConstants; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。XQSequence都; import javax.xml.xquery。了XQStaticContext; import oracle.xml.xquery。OXQDataSource; public class Streaming {public static void main（String [] args）抛出XQException，IOException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; XQStaticContext ctx = con.getStaticContext（）; ctx.setBindingMode（XQConstants。BINDING_MODE_DEFERRED）; con.setStaticContext（CTX）; FileInputStream input = new FileInputStream（“books.xml”）; FileInputStream query = new FileInputStream（“books2.xq”）; FileOutputStream output = new FileOutputStream（“result.xml”）; XQPreparedExpression expr = con.prepareExpression（query）; query.close（）; expr.bindDocument（new QName（“doc”），input，null，null）; XQSequence result = expr.executeQuery（）; //将“&lt;title&gt;权力的游戏&lt;/ title&gt;”写入文件results.xml result.writeSequence（output，null）; result.close（）; input.close（）; output.close（）; expr.close（）; con.close（）; }}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK122"></a><a id="ADXDK191"></a><div class="props_rev_3"><a id="GUID-C36470F9-CC26-4169-8C50-78852EC74583" name="GUID-C36470F9-CC26-4169-8C50-78852EC74583"></a><h4 id="ADXDK-GUID-C36470F9-CC26-4169-8C50-78852EC74583" class="sect4">外部存储</h4>
                  <div>
                     <p>根据查询，处理器可能必须在查询评估期间将部分输入XML存储在主内存中。</p>
                     <div class="section">
                        <p>例如，在以下情况下可能会出现这种情况：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>序列已排序。</p>
                           </li>
                           <li>
                              <p>绑定到变量的值多次使用。</p>
                           </li>
                           <li>
                              <p>路径表达式使用反转轴步骤。</p>
                           </li>
                        </ul>
                        <p>要在这种情况下减少内存使用，可以将XQuery处理器配置为使用外部存储来实现XML，而不是主内存。要启用外部存储，请设置数据源属性<code class="codeph">OXQConstants.USE_EXTERNAL_STORAGE</code>为<code class="codeph">true</code> ，并设置USE_EXTERNAL_STORAGE</code> <code class="codeph">oracle.xml.scalable.动态上下文中的PageManager</code>实例。
                        </p>
                        <div class="infoboxnote" id="GUID-C36470F9-CC26-4169-8C50-78852EC74583__GUID-72A836B5-2C2C-491E-92C3-BEDE32CDD73A">
                           <p class="notep1">注意：</p>
                           <p>使用外部存储可以显着减少查询处理期间消耗的主内存量。但是，它也会降低性能。</p>
                        </div>
                        <p><a href="using-xquery-processor-for-Java.html#GUID-C36470F9-CC26-4169-8C50-78852EC74583__BAJHJDID">例15-19</a>显示了在实现XML时如何使XQuery处理器使用基于磁盘的存储而不是主存储器。该示例将此输出写入文件<code class="codeph">results.xml</code> ： <code class="codeph">&lt;title&gt;A Game of Thrones&lt;/title&gt;</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-C36470F9-CC26-4169-8C50-78852EC74583__BAJHJDID">
                        <p class="titleinexample">示例15-19配置XQuery处理器以使用外部存储</p><pre class="oac_no_warn" dir="ltr">import java.io.文件; import java.io.的FileInputStream; import java.io.FileOutputStream中; import java.io.IOException异常; import javax.xml.namespace。QName的; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQConstants; import javax.xml.xquery。XQException; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。XQSequence都; import javax.xml.xquery。了XQStaticContext; import oracle.xml.scalable。FilePageManager; import oracle.xml.xquery。OXQDataSource; import oracle.xml.xquery。OXQPreparedExpression; import oracle.xml.xquery。OXQView; public class ExternalStorage {public static void main（String [] args）抛出XQException，IOException {OXQDataSource ds = new OXQDataSource（）; ds.setProperty（OXQDataSource。USE_EXTERNAL_STORAGE，“true”）; XQConnection con = ds.getConnection（）; XQStaticContext ctx = con.getStaticContext（）; ctx.setBindingMode（XQConstants。BINDING_MODE_DEFERRED）; con.setStaticContext（CTX）; FileInputStream input = new FileInputStream（“books.xml”）; FileInputStream query = new FileInputStream（“books2.xq”）; FileOutputStream output = new FileOutputStream（“results.xml”）; XQPreparedExpression expr = con.prepareExpression（query）; query.close（）; expr.bindDocument（new QName（“doc”），input，null，null）; //如果需要实现XML，则设置将由XQuery处理器使用的页面管理器OXQPreparedExpression oexpr = OXQView.getPreparedExpression（expr）;文件temporaryFile = File.createTempFile（“books”，“。pagefile”）; temporaryFile.deleteOnExit（）; oexpr.setPageManager（new FilePageManager（temporaryFile.getAbsolutePath（）））; XQSequence result = expr.executeQuery（）; //写入文件results.xml：“&lt;title&gt;权力的游戏&lt;/ title&gt;”result.writeSequence（output，null）; result.close（）; input.close（）; output.close（）; expr.close（）; con.close（）; }}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDK192"></a><div class="props_rev_3"><a id="GUID-729BCBC6-A03A-4397-BE61-6E0AB9B43A6D" name="GUID-729BCBC6-A03A-4397-BE61-6E0AB9B43A6D"></a><h4 id="ADXDK-GUID-729BCBC6-A03A-4397-BE61-6E0AB9B43A6D" class="sect4">XQJ的线程安全</h4>
                  <div>
                     <p>XQJ的Oracle实现不是线程安全的。例如， <code class="codeph">javax.xml.xquery.一个实例<code class="codeph">javax.xml.xquery.XQSequence</code>只能由一个线程访问。但是，支持受限形式的线程安全性来管理<code class="codeph">javax.xml.xquery.实例<code class="codeph">javax.xml.xquery.XQConnection</code> 。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">XQConnection</code>一个实例用作创建<code class="codeph">XQExpression</code> ， <code class="codeph">XQPreparedExpression</code> ， <code class="codeph">XQItem</code> ， <code class="codeph">XQSequence</code> ， <code class="codeph">XQItemType</code>和<code class="codeph">XQSequenceType</code>实例的工厂。一个线程可以管理这些对象的创建以供其他线程使用。例如，可以在其他线程中使用由同一连接在一个线程中创建的<code class="codeph">XQPreparedExpression</code>实例。但是，每个<code class="codeph">XQPreparedExpression</code>实例只能由一个线程执行。任何用户定义的<code class="codeph">oracle.xml.xquery.实现<code class="codeph">oracle.xml.xquery.当同时评估来自同一连接的表达式时，指定的OXQEntityResolver</code>必须是线程安全的。
                           </p>
                        </li>
                        <li>
                           <p>方法<code class="codeph">XQConnection.close()</code>关闭从连接获取的所有<code class="codeph">XQExpression</code>和<code class="codeph">XQPreparedExpression</code>实例。关闭这些实例将关闭从表达式获取的所有<code class="codeph">XQResultSequence</code>和<code class="codeph">XQResultItem</code>实例。方法<code class="codeph">XQConnection.close()</code>可以在从其他线程中处理从连接获得的表达式时调用。在这种情况下，表达式所拥有的所有注册资源（例如<code class="codeph">java.io.InputStream</code>和<code class="codeph">java.io.Reader</code> ）已关闭。本合同假定所有注册资源都支持线程安全关闭方法。例如，许多JDK实现<code class="codeph">java.io.Closeable</code>满足这一要求。但是， <code class="codeph">javax.xml.stream.许多实现<code class="codeph">javax.xml.stream.XMLStreamReader</code>不提供线程安全的close方法。没有这种支持的实现如果在第二个线程仍在读取时关闭它们会产生不可预测的结果（请参阅接口<code class="codeph">oracle.xml.xquery.<a href="../jaxml/index.html" target="_blank"><span><cite>Oracle数据库XML Java API参考中的</cite></span></a> OXQCloseable</code> ）。
                           </p>
                           <div class="infoboxnotealso" id="GUID-729BCBC6-A03A-4397-BE61-6E0AB9B43A6D__GUID-D41CBF61-90B5-4E84-99F7-23D92B3B1E12">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API参考</cite></span></a> ，方法<code class="codeph">oracle.xml.xquery.OXQConnection.copyExpression（XQPreparedExpression）</code></p>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADXDK183"></a><a id="ADXDK184"></a><a id="ADXDK185"></a><a id="ADXDK186"></a><a id="ADXDK182"></a><div class="props_rev_3"><a id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9" name="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9"></a><h3 id="ADXDK-GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9" class="sect3">执行更新</h3>
               <div>
                  <p>XDK扩展了XQJ，可以执行更新查询。XML文档可以作为<code class="codeph">javax.xml.xquery.的实例读取<code class="codeph">javax.xml.xquery.XQItem</code> ，然后使用XQuery Update Facility扩展进行修改。
                  </p>
                  <div class="section">
                     <p>默认情况下禁用此功能。您可以通过将动态上下文的更新模式设置为<code class="codeph">oracle.xml.xquery.来启用它<code class="codeph">oracle.xml.xquery.OXQConstants。UPDATE_MODE_ENABLED</code> 。</p>
                     <p>要更新的文档必须以延迟模式绑定（请参阅方法<code class="codeph">javax.xml.xquery.<a href="../jaxml/index.html" target="_blank"><span><cite>Oracle数据库XML Java API参考中的</cite></span></a> XQStaticContext.setBindingMode(int)</code> ）。如果绑定模式未设置为延迟，则在查询执行之前复制输入绑定。因此，仅更新副本。
                     </p>
                     <p>本节中的示例显示了如何使用XQuery Update Facility修改XML文档。</p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJFCJCC">例15-20</a>显示了<code class="codeph">configuration.xml</code>的内容。
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJICABB">例15-21</a>显示了<code class="codeph">update.xq</code>的内容。
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJGJHDJ">示例15-22</a>显示更新后<code class="codeph">configuration.xml</code>的内容。
                     </p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJCDIFI">例15-23</a>显示了如何执行查询<code class="codeph">update.xq</code> 。
                     </p>
                     <p>在示例中，这些操作发生：</p>
                     <ol>
                        <li>
                           <p>XML文件<code class="codeph">configuration.xml</code>将作为<code class="codeph">javax.xml.xquery.的实例读取<code class="codeph">javax.xml.xquery.XQItem</code> 。
                           </p>
                        </li>
                        <li>
                           <p>该项绑定到查询<code class="codeph">update.xq</code>的准备表达式。
                           </p>
                        </li>
                        <li>
                           <p>执行查询<code class="codeph">update.xq</code> 。
                           </p>
                        </li>
                        <li>
                           <p>修改后的文档将写入文件<code class="codeph">configuration.xml</code> 。
                           </p>
                        </li>
                     </ol>
                     <div class="infoboxnotealso" id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__GUID-9703B030-1DA9-4353-8A2D-6DDBDC23C543">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_tr_xquery_update10" target="_blank"><span class="italic">XQuery Update Facility 1.0</span></a></p>
                           </li>
                           <li>
                              <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API参考</cite></span></a> ，接口<code class="codeph">oracle.xml.xquery.OXQDynamicContext</code></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJFCJCC">
                     <p class="titleinexample">例15-20 configuration.xml</p><pre class="oac_no_warn" dir="ltr">&lt;configuration&gt; &lt;property&gt; &lt;name&gt; hostname &lt;/ name&gt; &lt;value&gt; example.com &lt;/ value&gt; &lt;/ property&gt; &lt;property&gt; &lt;name&gt; timeout &lt;/ name&gt; &lt;value&gt; 1000 &lt;/ value&gt; &lt;/ property &gt; &lt;/ configuration&gt;</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJICABB">
                     <p class="titleinexample">例15-21 update.xq</p><pre class="oac_no_warn" dir="ltr">声明变量$ doc external; let $ timeout：= $ doc / configuration / property [name eq“timeout”]返回node $ timeout / value的替换值2 * xs：integer（$ timeout / value）</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJGJHDJ">
                     <p class="titleinexample">示例15-22更新了文件configuration.xml</p><pre class="oac_no_warn" dir="ltr">&lt;configuration&gt; &lt;property&gt; &lt;name&gt; hostname &lt;/ name&gt; &lt;value&gt; example.com &lt;/ value&gt; &lt;/ property&gt; &lt;property&gt; &lt;name&gt; timeout &lt;/ name&gt; &lt;value&gt; 2000 &lt;/ value&gt; &lt;/ property &gt; &lt;/ configuration&gt;</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-16E26F1C-DA32-4D6A-BBE0-84EAFBA96EB9__BAJCDIFI">
                     <p class="titleinexample">示例15-23执行更新查询update.xq</p><pre class="oac_no_warn" dir="ltr">import java.io.的FileInputStream; import java.io.IOException异常; import java.io.FileOutputStream中; import javax.xml.namespace。QName的; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQConstants; import javax.xml.xquery。XQException; import javax.xml.xquery。了XQItem; import javax.xml.xquery。XQPreparedExpression; import javax.xml.xquery。了XQStaticContext; import oracle.xml.xquery。OXQConstants; import oracle.xml.xquery。OXQDataSource; import oracle.xml.xquery。OXQView; public class UpdateDocument {public static void main（String [] args）抛出XQException，IOException {OXQDataSource ds = new OXQDataSource（）; XQConnection con = ds.getConnection（）; XQStaticContext ctx = con.getStaticContext（）; //将绑定模式设置为延迟，以便绑定时不复制文档//项目。ctx.setBindingMode（XQConstants。BINDING_MODE_DEFERRED）; con.setStaticContext（CTX）; FileInputStream input = new FileInputStream（“configuration.xml”）; XQItem doc = con.createItemFromDocument（input，null，null）; input.close（）; System.out.println（“更新前：\ n”+ doc.getItemAsString（null））; FileInputStream query = new FileInputStream（“update.xq”）; XQPreparedExpression expr = con.prepareExpression（query）; query.close（）; expr.bindItem（new QName（“doc”），doc）; //启用更新（默认情况下禁用）OXQView.getDynamicContext（expr）.setUpdateMode（OXQConstants。UPDATE_MODE_ENABLED）; expr.executeQuery（）; System.out.println（“更新后：\ n”+ doc.getItemAsString（null））; //将修改后的文档写回文件FileOutputStream out = new FileOutputStream（“configuration.xml”）; doc.writeItem（out，null）; expr.close（）; con.close（）; }}</pre></div>
                  <!-- class="example" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-19382C4B-0797-444D-9770-3620525E8978" name="GUID-19382C4B-0797-444D-9770-3620525E8978"></a><h3 id="ADXDK-GUID-19382C4B-0797-444D-9770-3620525E8978" class="sect3">Oracle XQuery函数和操作符</h3>
               <div>
                  <p>Oracle支持标准的XQuery函数和运算符，以及一些特定于Oracle的函数。</p>
                  <p>特定于Oracle的XQuery函数使用命名空间<code class="codeph">http://xmlns.oracle.com/xdk/xquery/function</code> 。命名空间前缀<code class="codeph">ora-fn</code>是预先声明的，并且模块会自动导入。
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="using-xquery-processor-for-Java.html#GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0" title="列出了适用于Java的XDK XQuery处理器符合的标准和规范。">适用于Java的XQuery处理器的标准和规范</a></li>
                     </ul>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-65FBF15D-D1FA-4648-89E4-C613295F2787" name="GUID-65FBF15D-D1FA-4648-89E4-C613295F2787"></a><h4 id="ADXDK-GUID-65FBF15D-D1FA-4648-89E4-C613295F2787" class="sect4">适用于持续时间，日期和时间的Oracle XQuery函数</h4>
                  <div>
                     <p>您可以使用Oracle XQuery函数在XQuery中操作持续时间，日期和时间。</p>
                     <p>Oracle XQuery函数位于命名空间<code class="codeph">http://xmlns.oracle.com/xdk/xquery/function</code> 。命名空间前缀<code class="codeph">ora-fn</code>是预先声明的，并且模块会自动导入。
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317" name="GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317"></a><h5 id="ADXDK-GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317" class="sect5">ORA-FN：日期从-字符串与格式</h5>
                     <div>
                        <p>此Oracle XQuery函数根据给定模式从字符串返回新的日期值。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317__GUID-D0426020-8ED3-4A70-8E74-08F2EC4798DE">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：date-from-string-with-format（$ format as xs：string？，$ dateString as xs：string？，$ locale as xs：string *）as xs：date？ora-fn：date-from-string-with-format（$ format as xs：string？，$ dateString as xs：string？）作为xs：date？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317__GUID-0938493F-5CA4-4F91-98C2-CBB038543205">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code> ：模式;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="$ format参数标识组成日期或时间值的各个字段。">格式参数</a></p>
                        <p><code class="codeph">$dateString</code> ：表示日期的输入字符串</p>
                        <p><code class="codeph">$locale</code> ：表示区域设置的一到三个字段值;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="$ locale代表特定的地理，政治或文化区域。">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-DCB091E4-0DC4-4F1A-977F-2F3E165C6317__GUID-3B95294E-D0F5-4380-BACD-BDF13E0F49F4">例</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例返回当前时区中的指定日期：</p><pre class="oac_no_warn" dir="ltr">ora-fn：date-from-string-with-format（“yyyy-MM-dd G”，“2013-06-22 AD”）</pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-44910E87-C56D-4F83-857F-412A08B0234A" name="GUID-44910E87-C56D-4F83-857F-412A08B0234A"></a><h5 id="ADXDK-GUID-44910E87-C56D-4F83-857F-412A08B0234A" class="sect5">ORA-FN：日期到字符串与格式</h5>
                     <div>
                        <p>此Oracle XQuery函数返回具有给定模式的日期字符串。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-44910E87-C56D-4F83-857F-412A08B0234A__GUID-9CA1AFED-6BD7-4684-9535-0CD674D1F915">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：date-to-string-with-format（$ format as xs：string？，$ date as xs：date？，* $ locale as xs：string？）作为xs：string？ora-fn：date-to-string-with-format（$ format as xs：string？，$ date as xs：date？）作为xs：string？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-44910E87-C56D-4F83-857F-412A08B0234A__GUID-6AA4B590-E391-464E-855F-8ED5323DDD7F">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code> ：模式;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="$ format参数标识组成日期或时间值的各个字段。">格式参数</a></p>
                        <p><code class="codeph">$date</code> ：日期</p>
                        <p><code class="codeph">$locale</code> ：表示区域设置的一到三个字段值;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="$ locale代表特定的地理，政治或文化区域。">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-44910E87-C56D-4F83-857F-412A08B0234A__GUID-1A4CDB10-0773-47AF-9B7E-3949538E2BE9">例</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例返回字符串<code class="codeph">2013-07-15</code> ：</p><pre class="oac_no_warn" dir="ltr">ora-fn：date-to-string-with-format（“yyyy-mm-dd”，xs：date（“2013-07-15”））</pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39" name="GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39"></a><h5 id="ADXDK-GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39" class="sect5">ORA-FN：日期时间 - 从 - 字符串与格式</h5>
                     <div>
                        <p>此Oracle XQuery函数根据给定模式从输入字符串返回新的日期时间值。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39__GUID-9583F604-CA13-42D6-933D-8ED70CE5DF1C">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：dateTime-from-string-with-format（$ format as xs：string？，$ dateTimeString as xs：string？，$ locale as xs：string？）作为xs：dateTime？ora-fn：dateTime-from-string-with-format（$ format as xs：string？，$ dateTimeString as xs：string？）作为xs：dateTime？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39__GUID-C6C1828A-640E-4309-B4C4-D18191E4A06C">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code> ：模式;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="$ format参数标识组成日期或时间值的各个字段。">格式参数</a></p>
                        <p><code class="codeph">$dateTimeString</code> ：日期和时间</p>
                        <p><code class="codeph">$locale</code> ：表示区域设置的一到三个字段值;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="$ locale代表特定的地理，政治或文化区域。">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-9B138783-D1C1-4635-B5FC-EB8051B9FB39__GUID-C5D7690A-733D-4CE4-A655-03EDC25C7369">例子</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例返回当前时区中的指定日期和11:04:00 AM：</p><pre class="pre codeblock"><code>ora-fn：dateTime-from-string-with-format（“yyyy-MM-dd”at'hh：mm“，”2013-06-22 at 11:04“）</code></pre><p>下一个示例返回当前时区中的指定日期和12:00:00 AM：</p><pre class="pre codeblock"><code>ora-fn：dateTime-from-string-with-format（“yyyy-MM-dd G”，“2013-06-22 AD”）</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E" name="GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E"></a><h5 id="ADXDK-GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E" class="sect5">ORA-FN：日期时间到字符串与格式</h5>
                     <div>
                        <p>此Oracle XQuery函数返回具有给定模式的日期和时间字符串。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E__GUID-CA66F25E-532E-4D3F-8A4C-7795F8ADF837">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：dateTime-to-string-with-format（$ format as xs：string？，$ dateTime as xs：dateTime？，$ locale as xs：string？）作为xs：string？ora-fn：dateTime-to-string-with-format（$ format as xs：string？，$ dateTime as xs：dateTime？）作为xs：string？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E__GUID-15ECD024-8DEC-4F87-8BBF-00127A9B8363">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code> ：模式;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="$ format参数标识组成日期或时间值的各个字段。">格式参数</a></p>
                        <p><code class="codeph">$dateTime</code> ：日期和时间</p>
                        <p><code class="codeph">$locale</code> ：表示区域设置的一到三个字段值;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="$ locale代表特定的地理，政治或文化区域。">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-D70AE8F0-23CA-4B2D-AE40-F2F2C011E30E__GUID-4B1EE99A-0FBF-4AB0-A2A5-3738BBD47665">例子</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例返回字符串<code class="codeph">07 JAN 2013 10:09 PM AD</code> ：</p><pre class="oac_no_warn" dir="ltr">ora-fn：dateTime-to-string-with-format（“dd MMM yyyy hh：mm a G”，xs：dateTime（“2013-01-07T22：09：44”））</pre><p>下一个示例返回字符串“01-07-2013”：</p><pre class="oac_no_warn" dir="ltr">ora-fn：dateTime-to-string-with-format（“MM-dd-yyyy”，xs：dateTime（“2013-01-07T22：09：44”））</pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E" name="GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E"></a><h5 id="ADXDK-GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E" class="sect5">ORA-FN：时间从-字符串与格式</h5>
                     <div>
                        <p>此Oracle XQuery函数根据给定模式从输入字符串返回新的时间值。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E__GUID-EB82FFB7-EC29-4958-8877-1AFB91FF5496">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：time-from-string-with-format（$ format as xs：string？，$ timeString as xs：string？，$ locale as xs：string？）作为xs：时间？ora-fn：time-from-string-with-format（$ format as xs：string？，$ timeString as xs：string？）作为xs：时间？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E__GUID-3D5945FF-FF4C-4B33-9018-6BFBB77F07DD">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code> ：模式;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="$ format参数标识组成日期或时间值的各个字段。">格式参数</a></p>
                        <p><code class="codeph">$timeString</code> ：时间</p>
                        <p><code class="codeph">$locale</code> ：表示区域设置的一到三个字段值;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="$ locale代表特定的地理，政治或文化区域。">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-2F0C19D0-F2A5-49EF-A5C5-DE29CE26DF0E__GUID-E64FD76A-2FEA-4BA0-8B9E-29EE0A4CEBFF">例</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例返回当前时区的9:45:22 PM：</p><pre class="pre codeblock"><code>ora-fn：来自字符串格式的时间（“HH.mm.ss”，“21.45.22”）</code></pre><p>下一个示例返回当前时区的8:07:22 PM：</p><pre class="pre codeblock"><code>fn-bea：来自字符串格式的时间（“hh：mm：ss a”，“8:07:22 PM”）</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E" name="GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E"></a><h5 id="ADXDK-GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E" class="sect5">ORA-FN：时间到字符串与格式</h5>
                     <div>
                        <p>此Oracle XQuery函数返回具有给定模式的时间字符串。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E__GUID-BFC5D2B8-4F57-4F9F-B9F2-64CC4A9394A4">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：格式化字符串的时间（$格式为xs：string ?, $ time为xs：time？，$ locale为xs：string？）作为xs：string？ora-fn：格式化字符串的时间（$格式为xs：string ?, $ time为xs：time？）作为xs：string？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E__GUID-33F606FA-3F63-4D01-BB50-3B34EF68D130">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$format</code> ：模式;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" title="$ format参数标识组成日期或时间值的各个字段。">格式参数</a></p>
                        <p><code class="codeph">$time</code> ：时间</p>
                        <p><code class="codeph">$locale</code> ：表示区域设置的一到三个字段值;请参阅<a href="using-xquery-processor-for-Java.html#GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" title="$ locale代表特定的地理，政治或文化区域。">Locale Argument</a></p>
                        <div class="section">
                           <p class="subhead3" id="GUID-8E822A4B-489B-46E1-8DA8-553C31B81F1E__GUID-14473823-9B73-4CEE-8CA1-8E5C9E425DA3">例子</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例返回字符串“10:09 PM”：</p><pre class="pre codeblock"><code>ora-fn：时间到字符串格式（“hh：mm a”，xs：time（“22:09:44”））</code></pre><p>下一个示例返回字符串“22:09 PM”：</p><pre class="pre codeblock"><code>ora-fn：格式化时间（“HH：mm a”，xs：time（“22:09:44”））</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" name="GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346"></a><h5 id="ADXDK-GUID-0209668E-BBE9-4ADE-A4BB-ABDA3B4B3346" class="sect5">格式参数</h5>
                     <p><code class="codeph">$format</code>参数标识组成日期或时间值的各个字段。
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" name="GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B"></a><h5 id="ADXDK-GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B" class="sect5">Locale Argument</h5>
                     <div>
                        <p><code class="codeph">$locale</code>代表特定的地理，政治或文化区域。
                        </p>
                        <p>它最多由三个字段定义：</p>
                        <ol>
                           <li>
                              <p><span class="bold">语言代码</span> ：ISO 639 alpha-2或alpha-3语言代码，或最多八个字母的注册语言子标签。例如， <code class="codeph">en</code>表示英语， <code class="codeph">ja</code>表示日语。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">国家/地区代码</span> ：ISO 3166 alpha-2国家/地区代码或UN M.49数字-3区号。例如， <code class="codeph">US</code>为美国， <code class="codeph">029</code>为加勒比海。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">变体</span> ：表示区域设置的变体，例如特定方言。按重要性顺序排序多个值，并用下划线（_）分隔它们。这些值区分大小写。
                              </p>
                           </li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-0F2E2FD8-D9BA-4EA8-B452-5BA5B2AC350B__GUID-7FFDC7E5-E939-4F3D-9BAF-8102FEDEB172">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><cite>Java Standard Edition 7参考中的</cite> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=javase7_util_locale" target="_blank">类语言环境</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-F8F59CE8-C172-4C5E-BBC9-208332B96CC2" name="GUID-F8F59CE8-C172-4C5E-BBC9-208332B96CC2"></a><h4 id="ADXDK-GUID-F8F59CE8-C172-4C5E-BBC9-208332B96CC2" class="sect4">用于字符串的Oracle XQuery函数</h4>
                  <div>
                     <p>您可以使用Oracle XQuery函数在XQuery中操作字符串。</p>
                     <p>Oracle XQuery函数位于命名空间<code class="codeph">http://xmlns.oracle.com/xdk/xquery/function</code> 。命名空间前缀<code class="codeph">ora-fn</code>是预先声明的，并且模块会自动导入。
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194" name="GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194"></a><h5 id="ADXDK-GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194" class="sect5">ORA-FN：垫左</h5>
                     <div>
                        <p>在字符串的左侧添加填充字符以创建固定长度的字符串。如果输入字符串超出指定的大小，则会截断它以返回指定长度的子字符串。默认填充字符是空格（ASCII 32）。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194__GUID-3AD17F46-E2B4-431C-BD96-C648E1383B6E">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：pad-left（$ str as xs：string？，$ size as xs：integer？，$ pad as xs：string？）作为xs：string？ora-fn：pad-left（$ str as xs：string？，$ size as xs：integer？）作为xs：string？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194__GUID-4F78678D-EEFA-4B9B-9326-161670A78C06">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$str</code> ：输入字符串</p>
                        <p><code class="codeph">$size</code> ：所需的固定长度，通过向<code class="codeph">$str</code>添加填充字符获得</p>
                        <p><code class="codeph">$pad</code> ：填充字符</p>
                        <p>如果任一参数是空序列，则该函数返回空序列。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-7DB5EB9D-A95C-42F4-AED7-3CF6208E8194__GUID-C255127C-3534-4ACC-B80E-76CE134A7650">例子</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例将<code class="codeph">"01</code> ”前缀为输入字符串，最多为六个字符。返回的字符串是“ <code class="codeph">010abc</code> ”。该函数返回一个完整的和一个部分填充字符。
                        </p><pre class="pre codeblock"><code>ora-fn：pad-left（“abc”，6，“01”）</code></pre><p>该示例仅返回“ <code class="codeph">ab</code> ”，因为输入字符串超出了指定的固定长度：</p><pre class="pre codeblock"><code>ora-fn：pad-left（“abcd”，2，“01”）</code></pre><p>此示例将空格前缀为字符串，最多为指定的最多六个字符。返回的字符串有两个空格的前缀：“ <code class="codeph">abcd</code> ”：</p><pre class="oac_no_warn" dir="ltr">ora-fn：pad-left（“abcd”，6）</pre><p>下一个示例仅返回“ <code class="codeph">ab</code> ”，因为输入字符串超出了指定的固定长度：</p><pre class="oac_no_warn" dir="ltr">ora-fn：pad-left（“abcd”，2）</pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0" name="GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0"></a><h5 id="ADXDK-GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0" class="sect5">ORA-FN：垫右</h5>
                     <div>
                        <p>在字符串的右侧添加填充字符以创建固定长度的字符串。如果输入字符串超出指定的大小，则会截断它以返回指定长度的子字符串。默认填充字符是空格（ASCII 32）。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0__GUID-F7AD140B-8363-4264-B496-C447957B80F6">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：pad-right（$ str as xs：string？，$ size as xs：integer？，$ pad as xs：string？）作为xs：string？ora-fn：pad-right（$ str as xs：string？，$ size as xs：integer？）作为xs：string？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0__GUID-531EEE67-8599-44DA-AE67-6C9061D1BA5C">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$str</code> ：输入字符串</p>
                        <p><code class="codeph">$size</code> ：所需的固定长度，通过向<code class="codeph">$str</code>添加填充字符获得</p>
                        <p><code class="codeph">$pad</code> ：填充字符</p>
                        <p>如果任一参数是空序列，则该函数返回空序列。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-5D2BE1DE-5EA6-4E2D-ADD5-44D028899DC0__GUID-90633DBA-E9C9-4412-A4FE-1FA366E9CCFF">例子</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例将“ <code class="codeph">01</code> ”附加到输入字符串，最多六个字符。返回的字符串是“ <code class="codeph">abc010</code> ”。该函数返回一个完整的和一个部分填充字符。
                        </p><pre class="pre codeblock"><code>ora-fn：pad-right（“abc”，6，“01”）</code></pre><p>此示例仅返回“ <code class="codeph">ab</code> ”，因为输入字符串超出指定的固定长度：</p><pre class="pre codeblock"><code>ora-fn：pad-right（“abcd”，2，“01”）</code></pre><p>此示例将字符串追加到指定的最多六个字符的字符串。返回的字符串后缀为两个空格：“ <code class="codeph">abcd</code> ”：</p><pre class="pre codeblock"><code>ora-fn：pad-right（“abcd”，6）</code></pre><p>下一个示例仅返回“ <code class="codeph">ab</code> ”，因为输入字符串超出了指定的固定长度：</p><pre class="pre codeblock"><code>ora-fn：pad-right（“abcd”，2）</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7" name="GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7"></a><h5 id="ADXDK-GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7" class="sect5">ORA-FN：修剪</h5>
                     <div>
                        <p>从字符串中删除任何前导或尾随空格。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7__GUID-71EA4AD3-9527-4814-B27A-B2DBC907E01B">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：trim（$输入为xs：string？）作为xs：string？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7__GUID-5EBA07EE-1A98-4040-BBFC-1BF78061B1DA">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$input</code> ：要修剪的字符串。如果<code class="codeph">$input</code>是一个空序列，则该函数返回一个空序列。其他数据类型会触发错误。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-9C664B13-A1C4-4DDA-87E0-720379FF1BD7__GUID-91596001-D79D-4865-A7F5-EAC729D3B2F3">例</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例返回字符串“ <code class="codeph">abc</code> ”：</p><pre class="pre codeblock"><code>ora-fn：trim（“abc”）</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80" name="GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80"></a><h5 id="ADXDK-GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80" class="sect5">ORA-FN：修剪左</h5>
                     <div>
                        <p>删除任何前导空格。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80__GUID-BBE9C459-9FF3-489C-9975-E8803D05D852">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：trim-left（$ input为xs：string？）作为xs：string？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80__GUID-B6D41FD5-514C-47D3-A6F5-18BF291950AA">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$input</code> ：要修剪的字符串。如果<code class="codeph">$input</code>是一个空序列，则该函数返回一个空序列。其他数据类型会触发错误。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-09B54A7A-F2D1-4717-BEE7-C6E4BD852F80__GUID-279F233D-9F1A-49D4-92EC-1DDE09C06F46">例</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例删除前导空格并返回字符串“ <code class="codeph">abc</code> ”：</p><pre class="pre codeblock"><code>ora-fn：trim-left（“abc”）</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92" name="GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92"></a><h5 id="ADXDK-GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92" class="sect5">ORA-FN：修剪右</h5>
                     <div>
                        <p>删除任何尾随空白区域。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92__GUID-53BC7949-5ED4-49DE-83A2-D8615CD6CA26">签名</p>
                        </div>
                        <!-- class="section" --><pre class="pre codeblock"><code>ora-fn：trim-right（$输入为xs：string？）作为xs：string？</code></pre><div class="section">
                           <p class="subhead3" id="GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92__GUID-33F98649-53B9-46A4-BCA7-9508E7461482">参数</p>
                        </div>
                        <!-- class="section" -->
                        <p><code class="codeph">$input</code> ：要修剪的字符串。如果<code class="codeph">$input</code>是一个空序列，则该函数返回一个空序列。其他数据类型会触发错误。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-99D161E3-CDBE-489C-8AD2-93370FD0DD92__GUID-64E1BB38-95AC-48A0-9F9C-CB480C527417">例</p>
                        </div>
                        <!-- class="section" -->
                        <p>此示例删除尾随空格并返回字符串“ <code class="codeph">abc</code> ”：</p><pre class="pre codeblock"><code>ora-fn：trim-left（“abc”）</code></pre></div>
                  </div>
               </div>
            </div><a id="ADXDK99996"></a><div class="props_rev_3"><a id="GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0" name="GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0"></a><h3 id="ADXDK-GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0" class="sect3">适用于Java的XQuery处理器的标准和规范</h3>
               <div>
                  <p>列出了适用于Java的XDK XQuery处理器符合的标准和规范。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquery_30" target="_blank"><span class="italic">XQuery 3.0：XML查询语言</span></a></p>
                        <div class="infoboxnote" id="GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0__GUID-BD352653-E22D-451D-AD74-88E1515EDB8D">
                           <p class="notep1">注意：</p>支持所有XQuery 1.0级别功能。除以下内容外，支持XQuery 3.0级别功能：FLWOR窗口子句，FLWOR计数子句，名称空间构造函数，十进制格式声明， <code class="codeph">fn:format-number</code> ， <code class="codeph">fn:format-integer</code> ， <code class="codeph">fn:format-date</code> ， <code class="codeph">fn:format-time</code> ， <code class="codeph">fn:path</code>和更高阶的XQuery函数。
                        </div>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_tr_xquery_update10" target="_blank"><span class="italic">XQuery Update Facility 1.0</span></a></p>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xqueryx_30" target="_blank"><span class="italic">XQueryX 3.0</span></a> ，XQuery 3.0的XML语法</p>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=jcp_org_jsr225" target="_blank"><span class="italic">JSR-000225用于Java的XQuery API</span></a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-7A47349F-CFFD-43FA-A5E4-FADC49BD75C0__GUID-40808998-C99E-40AE-BCD8-CF1CDC2DCD22">
                     <p class="notep1">注意：</p>
                     <p>用于Java的XDK XQuery处理器无法与其他XQJ实现互操作，包括Oracle XML DB的Oracle XQJ实现。 （有关<span class="italic">可互操作</span>的含义，请参阅JSR-225：Java的XQuery API。）
                     </p>
                  </div>
               </div><a id="ADXDK99968"></a><a id="ADXDK99967"></a><div class="props_rev_3"><a id="GUID-19038D1D-9BB6-4973-BD8A-6C885A1300E0" name="GUID-19038D1D-9BB6-4973-BD8A-6C885A1300E0"></a><h4 id="ADXDK-GUID-19038D1D-9BB6-4973-BD8A-6C885A1300E0" class="sect4">可选的XQuery功能</h4>
                  <div>
                     <p>XQuery规范将某些功能定义为可选。链接提供给指定XDK支持的标准。</p>
                     <p>这些是XDK支持的可选功能：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xqueryschemaimport" target="_blank">架构导入</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xqueryschemavalid" target="_blank">验证表达式</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquerystatictyping" target="_blank">静态打字</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquerystaticupdate" target="_blank">静态类型更新</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquery_modules" target="_blank">模块</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=w3_org_xquery_serial8n" target="_blank">序列化</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADXDK124"></a><a id="ADXDK125"></a><a id="ADXDK126"></a><a id="ADXDK127"></a><a id="ADXDK123"></a><div class="props_rev_3"><a id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53" name="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53"></a><h4 id="ADXDK-GUID-64686275-A3CA-4C60-934C-CA8CC6636E53" class="sect4">实施定义的项目</h4>
                  <div>
                     <p>XQJ和XQuery规范将某些方面的定义留给实现。简要描述了XDK的实现定义项。</p>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJHHFGH" title="xqj支持表">表15-2</a>总结了XQJ实现定义的项目。
                     </p>
                     <div class="tblformalwide" id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJHHFGH">
                        <p class="titleintable">表15-2 XQJ实现定义的项目</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="XQJ实现定义的项目" width="100%" border="1" summary="table of xqj support" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="50%" id="d53703e4388">描述</th>
                                 <th align="left" valign="bottom" width="50%" id="d53703e4391">行为</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4396" headers="d53703e4388 ">
                                    <p><code class="codeph">XQDataSource</code>实现的类名</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4396 d53703e4391 ">
                                    <p><code class="codeph">oracle.xml.xquery。OXQDataSource</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4408" headers="d53703e4388 ">
                                    <p>在<code class="codeph">OXQDataSource</code>定义的属性</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4408 d53703e4391 ">
                                    <p>没有。用户名和密码将被忽略。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4417" headers="d53703e4388 ">
                                    <p>JDBC连接支持</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4417 d53703e4391 ">
                                    <p>不支持JDBC连接。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4424" headers="d53703e4388 ">
                                    <p>命令</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4424 d53703e4391 ">
                                    <p>不支持。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4431" headers="d53703e4388 ">
                                    <p>使用方法<code class="codeph">XQPreparedExpression.cancel()</code>取消查询执行</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4431 d53703e4391 ">
                                    <p>是。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4440" headers="d53703e4388 ">
                                    <p>序列化</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4440 d53703e4391 ">
                                    <p>是。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4447" headers="d53703e4388 ">
                                    <p>其他StAX或SAX事件</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4447 d53703e4391 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4454" headers="d53703e4388 ">
                                    <p>用户定义的模式类型</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4454 d53703e4391 ">
                                    <p>是。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4461" headers="d53703e4388 ">
                                    <p>节点绑定到外部变量时的节点标识，文档顺序和全节点上下文保留</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4461 d53703e4391 ">
                                    <p>没有保留。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4468" headers="d53703e4388 ">
                                    <p>登录超时</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4468 d53703e4391 ">
                                    <p>不支持。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4475" headers="d53703e4388 ">
                                    <p>交易</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4475 d53703e4391 ">
                                    <p>不支持。如果调用事务方法，则抛出异常。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4483" headers="d53703e4388 ">
                                    <p>如果输入节点不是文档节点， <code class="codeph">XQItemAccessor.getNodeUri()</code>方法行为</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4483 d53703e4391 ">
                                    <p>例外。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4492" headers="d53703e4388 ">
                                    <p>匿名类型的<code class="codeph">XQItemType.getTypeName()</code>方法</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4492 d53703e4391 ">
                                    <p>一个独特的名字。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4501" headers="d53703e4388 ">
                                    <p><code class="codeph">XQItemType.getSchemaURI()</code>方法</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4501 d53703e4391 ">
                                    <p>从XQJ创建类型时返回模式URI。不，否则。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4510" headers="d53703e4388 ">
                                    <p>如果输入不是格式良好的XML文档， <code class="codeph">bindDocument()</code> <code class="codeph">XQDataFactory.createItemFromDocument()</code>和<code class="codeph">bindDocument()</code>方法</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4510 d53703e4391 ">
                                    <p>例外。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4522" headers="d53703e4388 ">
                                    <p>类<code class="codeph">XQQueryException</code>返回的其他错误代码</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4522 d53703e4391 ">
                                    <p>特定于Oracle的错误代码的限定名称位于命名空间<code class="codeph">http://xmlns.oracle.com/xdk/xquery/errors</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4534" headers="d53703e4388 ">
                                    <p><code class="codeph">ConnectionPoolXQDataSource</code> ， <code class="codeph">PooledXQConnection</code> ， <code class="codeph">XQConnectionEvent</code> ， <code class="codeph">XQConnectionEventListener</code>接口</p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4534 d53703e4391 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4552" headers="d53703e4388 ">
                                    <p><code class="codeph">XQDataSource.getConnection（java.sql中。连接）</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4552 d53703e4391 ">
                                    <p>不支持JDBC连接。如果调用此方法，则抛出异常。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="50%" id="d53703e4560" headers="d53703e4388 ">
                                    <p><code class="codeph">XQDataSource.getConnection（java.lang中。String，java.lang。串）</code></p>
                                 </td>
                                 <td align="left" valign="top" width="50%" headers="d53703e4560 d53703e4391 ">
                                    <p>与<code class="codeph">getConnection()</code>相同。参数被忽略。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="infoboxnote" id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__GUID-025084F3-A4A8-44A1-9CF2-5F1CA576DEF0">
                        <p class="notep1">注意：</p>
                        <p>XDK对<a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJHHFGH" title="xqj支持表">表15-2中</a>的功能的支持与Oracle XML DB对它们的支持不同。
                        </p>
                     </div>
                     <p><a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJBDCIH" title="实现定义的项目表">表15-3</a>总结了XQuery实现定义的项目。
                     </p>
                     <div class="tblformalwide" id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJBDCIH">
                        <p class="titleintable">表15-3 XQuery实现定义的项目</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="XQuery实现定义的项目" width="100%" border="1" summary="Table of implementation-defined items" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="49%" id="d53703e4594">项目</th>
                                 <th align="left" valign="bottom" width="51%" id="d53703e4597">行为</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4602" headers="d53703e4594 ">
                                    <p>用于构造表达式的Unicode版本</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4602 d53703e4597 ">
                                    <p>取决于使用的Java版本。不同的Java版本支持不同版本的Unicode。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4609" headers="d53703e4594 ">
                                    <p>静态着名的排序规则</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4609 d53703e4597 ">
                                    <p>从类<code class="codeph">java.text.派生的Unicode代码点排序规则和排序规则<code class="codeph">java.text.Collator</code>或<code class="codeph">oracle.i18n.text.OraCollator</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4622" headers="d53703e4594 ">
                                    <p>隐含时区。</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4622 d53703e4597 ">
                                    <p>使用默认时区，由方法<code class="codeph">java.util.确定<code class="codeph">java.util.Calendar.getInstance()</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4632" headers="d53703e4594 ">
                                    <p>提出警告的情况以及处理警告的方式</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4632 d53703e4597 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4639" headers="d53703e4594 ">
                                    <p>将错误报告给外部处理环境的方法</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4639 d53703e4597 ">
                                    <p>例外<code class="codeph">javax.xml.xquery.XQException</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4649" headers="d53703e4594 ">
                                    <p>实现是基于XML 1.0和XML名称的规则，还是基于XML 1.1和XML Names 1.1的规则</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4649 d53703e4597 ">
                                    <p>1.0。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4656" headers="d53703e4594 ">
                                    <p>静态上下文或动态上下文的任何组件，由实现覆盖或扩充</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4656 d53703e4597 ">
                                    <p><a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJGHGHD" title="默认上下文属性值的定义表">见表15-5</a> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4668" headers="d53703e4594 ">
                                    <p>如果不支持全轴功能，则实现支持哪些可选轴</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4668 d53703e4597 ">
                                    <p>全力支持。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4675" headers="d53703e4594 ">
                                    <p>订单键（sortspec）在order by子句中返回的空序列的默认处理（空最小或空最大）</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4675 d53703e4597 ">
                                    <p><code class="codeph">least</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4684" headers="d53703e4594 ">
                                    <p>实现识别的任何扩展表达式（pragma）的名称和语义</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4684 d53703e4597 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4691" headers="d53703e4594 ">
                                    <p>实现识别的任何选项声明的名称和语义</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4691 d53703e4597 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4699" headers="d53703e4594 ">
                                    <p>可以将参数传递给外部函数的协议（如果有），并且函数的结果可以返回到调用查询</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4699 d53703e4597 ">
                                    <p>由XQJ定义。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4706" headers="d53703e4594 ">
                                    <p>如果支持模块功能，则识别模块导入导入的特定模块的过程（包括处理位置提示，如果有的话）</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4706 d53703e4597 ">
                                    <p>实体解析器。请参阅<a href="using-xquery-processor-for-Java.html#GUID-5E83610F-647D-4AE5-801B-878244FB6949" title="XDK使用实体解析器框架扩展XQJ，以控制在查询处理期间如何获取文档，模式，模块，排序规则和外部函数。本节中的示例显示如何将实体解析器用于多种类型的实体。">XQJ实体解决方案</a> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4719" headers="d53703e4594 ">
                                    <p>如果支持静态类型功能，则实现支持的任何静态类型扩展</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4719 d53703e4597 ">
                                    <p>严格模式（基于子类型）和乐观模式（基于类型交集）。乐观模式是默认模式。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4726" headers="d53703e4594 ">
                                    <p>如果支持序列化功能，则调用序列化的方法</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4726 d53703e4597 ">
                                    <p>由XQJ定义。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4733" headers="d53703e4594 ">
                                    <p>如果支持序列化功能，则<code class="codeph">byte-order-mark</code> ， <code class="codeph">encoding</code> ， <code class="codeph">media-type</code> ， <code class="codeph">normalization-form</code> ， <code class="codeph">omit-xml-declaration</code> ， <code class="codeph">standalone</code>和<code class="codeph">version</code>参数的默认值</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4733 d53703e4597 ">
                                    <p>请参阅<code class="codeph">oracle.xml.xquery.接口<code class="codeph">oracle.xml.xquery.<a href="../jaxml/index.html" target="_blank"><span><cite>Oracle数据库XML Java API参考中的</cite></span></a> OXQSerializationParameters</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4771" headers="d53703e4594 ">
                                    <p>限制各种数据类型的值范围。</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4771 d53703e4597 ">
                                    <p>十进制和整数值具有任意精度。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4778" headers="d53703e4594 ">
                                    <p>由实现或通过实现定义的API提供的函数的签名（参见XQuery标准，第2.1.1节， <span class="italic">静态上下文</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4778 d53703e4597 ">
                                    <p>请参阅<a href="using-xquery-processor-for-Java.html#GUID-19382C4B-0797-444D-9770-3620525E8978" title="Oracle支持标准的XQuery函数和运算符，以及一些特定于Oracle的函数。">Oracle XQuery函数和操作符</a> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4794" headers="d53703e4594 ">
                                    <p>实现提供的任何环境变量。</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4794 d53703e4597 ">
                                    <p>实体解析器。请参阅<a href="using-xquery-processor-for-Java.html#GUID-5E83610F-647D-4AE5-801B-878244FB6949" title="XDK使用实体解析器框架扩展XQJ，以控制在查询处理期间如何获取文档，模式，模块，排序规则和外部函数。本节中的示例显示如何将实体解析器用于多种类型的实体。">XQJ实体解决方案</a> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4807" headers="d53703e4594 ">
                                    <p>用于静态类型的任何规则（参见XQuery标准，第2.2.3.1节， <span class="italic">静态分析阶段</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4807 d53703e4597 ">
                                    <p>默认为乐观，悲观可配置。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4817" headers="d53703e4594 ">
                                    <p>实现提供的任何序列化参数（参见XQuery标准，2.2.4 <span class="italic">序列化</span>部分）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4817 d53703e4597 ">
                                    <p>请参阅<code class="codeph">OXQSerializationParameters</code> 。请参阅<a href="../jaxml/index.html" target="_blank"><span><cite>Oracle数据库XML Java API参考</cite></span></a> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4836" headers="d53703e4594 ">
                                    <p>序列化参数文档的位置提示标识相应XDM实例的方法（请参阅XQuery标准，第2.2.4节， <span class="italic">序列化</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4836 d53703e4597 ">
                                    <p>实体解析器， <code class="codeph">OXQEntityKind.DOCUMENT</code> 。请参阅<a href="using-xquery-processor-for-Java.html#GUID-5E83610F-647D-4AE5-801B-878244FB6949" title="XDK使用实体解析器框架扩展XQJ，以控制在查询处理期间如何获取文档，模式，模块，排序规则和外部函数。本节中的示例显示如何将实体解析器用于多种类型的实体。">XQJ实体解决方案</a> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4856" headers="d53703e4594 ">
                                    <p>如果外部函数的实现没有返回声明的结果类型，则返回什么错误（如果有的话）（参见XQuery标准，第2.2.5节， <span class="italic">一致性约束</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4856 d53703e4597 ">
                                    <p> <code class="codeph">XPTY0004</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4869" headers="d53703e4594 ">
                                    <p>实现定义的任何注释及其相关行为（请参阅XQuery标准，第4.15节， <span class="italic">注释</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4869 d53703e4597 ">
                                    <p>您可以使用<code class="codeph">%ora-fn:context-item</code>来允许函数调用者的上下文项作为函数的第一个参数隐式传递。
                                    </p>
                                    <p>例如，此查询的计算结果为<code class="codeph">e</code> ， <code class="codeph">f</code> ， <code class="codeph">g</code> ：</p><pre class="pre codeblock"><code>declare％ora-fn：context-item function local：foo（$ arg as node（））{node-name（$ arg）}; （&lt;e /&gt;，&lt;f /&gt;）/ local：foo（），local：foo（&lt;g /&gt;）</code></pre></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4895" headers="d53703e4594 ">
                                    <p>由实现定义的任何函数断言。</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4895 d53703e4597 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4902" headers="d53703e4594 ">
                                    <p>函数断言的影响可以通过第2.5.6.3节的实现来理解。判断子类型断言（AnnotationsA，AnnotationsB）。</p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4902 d53703e4597 ">
                                    <p>不适用。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4909" headers="d53703e4594 ">
                                    <p>由实现定义的任何实现定义的变量。 （参见XQuery标准，第3.1.2节， <span class="italic">变量引用</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4909 d53703e4597 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4919" headers="d53703e4594 ">
                                    <p>与<code class="codeph">fn:unordered</code>相关的排序<code class="codeph">fn:unordered</code>在实现中<code class="codeph">fn:unordered</code> （参见XQuery标准，第3.11节， <span class="italic">有序和无序表达式</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4919 d53703e4597 ">
                                    <p>它不会改变输入序列的顺序。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4932" headers="d53703e4594 ">
                                    <p>通过变量<code class="codeph">err:additional</code>提供的<code class="codeph">try</code> / <code class="codeph">catch</code>的任何其他信息（参见XQuery标准，第3.15节， <span class="italic">Try / Catch表达式</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4932 d53703e4597 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4951" headers="d53703e4594 ">
                                    <p>默认的边界空间策略（参见XQuery标准，第4.3节， <span class="italic">边界空间声明</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4951 d53703e4597 ">
                                    <p><code class="codeph">strip</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4963" headers="d53703e4594 ">
                                    <p>默认排序规则（请参阅XQuery标准，第4.4节， <span class="italic">默认排序规则声明</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4963 d53703e4597 ">
                                    <p>Unicode格式。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="49%" id="d53703e4973" headers="d53703e4594 ">
                                    <p>默认基URI（请参阅XQuery标准，第4.5节， <span class="italic">基本URI声明</span> ）。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="51%" headers="d53703e4973 d53703e4597 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p><a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJEADJF" title="实现定义的XQUF项目表">表15-4</a>总结了XQuery Update Facility实现定义的项目。
                     </p>
                     <div class="tblformalwide" id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJEADJF">
                        <p class="titleintable">表15-4 XQuery更新工具实现定义的项目</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="XQuery更新工具实现定义的项目" width="100%" border="1" summary="Table of implementation-defined XQUF items" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="37%" id="d53703e4998">项目</th>
                                 <th align="left" valign="bottom" width="63%" id="d53703e5001">行为</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d53703e5006" headers="d53703e4998 ">
                                    <p>此实现支持的重新验证模式。</p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d53703e5006 d53703e5001 ">
                                    <p><code class="codeph">skip</code>
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d53703e5015" headers="d53703e4998 ">
                                    <p>此实现的默认重新验证模式。</p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d53703e5015 d53703e5001 ">
                                    <p><code class="codeph">skip</code>
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d53703e5024" headers="d53703e4998 ">
                                    <p>外部函数可以通过其向调用查询返回XDM实例或挂起的更新列表或两者的机制（如果有）。</p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d53703e5024 d53703e5001 ">
                                    <p>不支持从外部函数返回挂起的更新列表。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d53703e5031" headers="d53703e4998 ">
                                    <p><code class="codeph">fn:put()</code>的语义，包括由此函数接受为操作数的节点种类。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d53703e5031 d53703e5001 ">
                                    <p>接受任何节点类型。节点的存储由实体解析器确定。请参阅类<code class="codeph">oracle.xml.xquery.OXQEntity</code>在<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=JAXML" target="_blank"><span><cite>Oracle数据库XML的Java API参考</cite></span></a> ，专门为实体的文档类<code class="codeph">UPD_PUT</code> 。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p><a href="using-xquery-processor-for-Java.html#GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJGHGHD" title="默认上下文属性值的定义表">表15-5</a>总结了静态上下文的默认初始值。
                     </p>
                     <div class="tblformalwide" id="GUID-64686275-A3CA-4C60-934C-CA8CC6636E53__BAJGHGHD">
                        <p class="titleintable">表15-5静态上下文的缺省初始值</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="静态上下文的默认初始值" width="100%" border="1" summary="Table of definitions for default context property values" frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="35%" id="d53703e5068">上下文组件</th>
                                 <th align="left" valign="bottom" width="65%" id="d53703e5071">默认值</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5076" headers="d53703e5068 ">
                                    <p>静态名称空间</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5076 d53703e5071 ">
                                    <p><code class="codeph">err</code> = <code class="codeph">http://w3.org/2005/xqt-errors</code></p>
                                    <p><code class="codeph">fn</code> = <code class="codeph">http://www.w3.org/2005/xpath-functions</code></p>
                                    <p><code class="codeph">local</code> = <code class="codeph">http://www.w3.org/2005/xquery-local-functions</code></p>
                                    <p><code class="codeph">math</code> = <code class="codeph">http://www.w3.org/2005/xpath-functions/math</code></p>
                                    <p><code class="codeph">ora-ext</code> = <code class="codeph">http://xmlns.oracle.com/xdk/xquery/extension</code></p>
                                    <p><code class="codeph">ora-java</code> = <code class="codeph">http://xmlns.oracle.com/xdk/xquery/java</code></p>
                                    <p><code class="codeph">ora-xml</code> = <code class="codeph">http://xmlns.oracle.com/xdk/xquery/xml</code></p>
                                    <p><code class="codeph">ora-fn</code> = <code class="codeph">http://xmlns.oracle.com/xdk/xquery/function</code></p>
                                    <p><code class="codeph">output</code> = <code class="codeph">http://www.w3.org/2010/xslt-xquery-serialization</code></p>
                                    <p><code class="codeph">xml</code> = <code class="codeph">http://www.w3.org/XML/1998/namespace</code></p>
                                    <p><code class="codeph">xs</code> = <code class="codeph">http://www.w3.org/2001/XMLSchema</code></p>
                                    <p><code class="codeph">xsi</code> = <code class="codeph">http://www.w3.org/2001/XMLSchema-instance</code></p>
                                    <p>以<code class="codeph">ora-</code>开头的前缀保留供Oracle使用。以<code class="codeph">ora-</code>开头的其他前缀可能会添加到将来版本中的默认静态名称空间中。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5162" headers="d53703e5068 ">
                                    <p>默认元素/类型命名空间</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5162 d53703e5071 ">
                                    <p>没有命名空间</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5169" headers="d53703e5068 ">
                                    <p>默认函数名称空间</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5169 d53703e5071 ">
                                    <p><code class="codeph">fn</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5178" headers="d53703e5068 ">
                                    <p>范围内模式类型</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5178 d53703e5071 ">
                                    <p><code class="codeph">xs</code>内置类型。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5188" headers="d53703e5068 ">
                                    <p>范围内元素声明</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5188 d53703e5071 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5195" headers="d53703e5068 ">
                                    <p>范围内属性声明</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5195 d53703e5071 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5202" headers="d53703e5068 ">
                                    <p>范围内变量</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5202 d53703e5071 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5209" headers="d53703e5068 ">
                                    <p>上下文项静态类型</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5209 d53703e5071 ">
                                    <p><code class="codeph">item()</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5218" headers="d53703e5068 ">
                                    <p>功能签名</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5218 d53703e5071 ">
                                    <p>命名空间<code class="codeph">fn</code>函数和内置原子类型的构造函数。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5228" headers="d53703e5068 ">
                                    <p>静态知名的排序规则</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5228 d53703e5071 ">
                                    <p>从类<code class="codeph">java.text.派生的Unicode代码点排序规则和排序规则<code class="codeph">java.text.Collator</code>或<code class="codeph">oracle.i18n.text.OraCollator</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5241" headers="d53703e5068 ">
                                    <p>默认排序规则</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5241 d53703e5071 ">
                                    <p>Unicode代码点排序规则：</p>
                                    <p><code class="codeph">http://www.w3.org/2005/xpath-functions/collation/codepoint</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5253" headers="d53703e5068 ">
                                    <p>施工方式</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5253 d53703e5071 ">
                                    <p><code class="codeph">preserve</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5262" headers="d53703e5068 ">
                                    <p>订购模式</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5262 d53703e5071 ">
                                    <p><code class="codeph">ordered</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5271" headers="d53703e5068 ">
                                    <p>空序列的默认顺序</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5271 d53703e5071 ">
                                    <p><code class="codeph">least</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5280" headers="d53703e5068 ">
                                    <p>边界空间政策</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5280 d53703e5071 ">
                                    <p><code class="codeph">strip</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5289" headers="d53703e5068 ">
                                    <p>复制命名空间模式</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5289 d53703e5071 ">
                                    <p><code class="codeph">preserve</code> ， <code class="codeph">no-inherit</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5301" headers="d53703e5068 ">
                                    <p>基本URI</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5301 d53703e5071 ">
                                    <p>如标准中所定义。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5308" headers="d53703e5068 ">
                                    <p>静态知名文件</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5308 d53703e5071 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5315" headers="d53703e5068 ">
                                    <p>静态知名的收藏品</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5315 d53703e5071 ">
                                    <p>没有。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5322" headers="d53703e5068 ">
                                    <p>静态已知的默认集合类型</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5322 d53703e5071 ">
                                    <p><code class="codeph">node()*</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="35%" id="d53703e5331" headers="d53703e5068 ">
                                    <p>序列化参数</p>
                                 </td>
                                 <td align="left" valign="top" width="65%" headers="d53703e5331 d53703e5071 ">
                                    <p>与<code class="codeph">OXQSerializationParameters</code>的默认值相同。请参阅<a href="../jaxml/index.html" target="_blank"><span><cite>Oracle数据库XML Java API参考</cite></span></a> 。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html><html id="01698.concepts-for-database-administrators.html" dir="ltr"></html><html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This part describes the duties, tools, and essential knowledge for database administrators."></meta>
      <meta name="description" content="This part describes the duties, tools, and essential knowledge for database administrators."></meta>
      <title>数据库管理员的概念</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Concepts"></meta>
      <meta property="og:description" content="This part describes the duties, tools, and essential knowledge for database administrators."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Concepts"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-concepts.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T07:47:16-08:00"></meta>
      <meta name="dcterms.title" content="Database Concepts"></meta>
      <meta name="dcterms.dateCopyrighted" content="1993, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96138-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="topics-for-database-administrators-and-developers.html" title="Previous" type="text/html"></link>
      <link rel="next" href="concepts-for-database-developers.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CNCPT"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="topics-for-database-administrators-and-developers.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="concepts-for-database-developers.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库概念</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-database-administration-and-application-development.html" property="item" typeof="WebPage"><span property="name">Oracle数据库管理和应用程序开发</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">数据库管理员的概念</li>
            </ol>
            <a id="GUID-8ED4D6B3-BF1D-4095-9BCD-6E5CCFDBE27C" name="GUID-8ED4D6B3-BF1D-4095-9BCD-6E5CCFDBE27C"></a><a id="CNCPT827"></a>
            
            <h2 id="CNCPT-GUID-8ED4D6B3-BF1D-4095-9BCD-6E5CCFDBE27C" class="sect2"><span class="enumeration_chapter">18</span>数据库管理员的概念</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='concepts-for-database-administrators'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>本部分介绍数据库管理员的职责，工具和基本知识。</p>
               <p>本章包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="concepts-for-database-administrators.html#GUID-18D90D4B-35EE-45C7-B00D-CDA6ECAD5D89" title="数据库管理员（DBA）的主要职责是使其用户可以使用企业数据。">数据库管理员的职责</a></p>
                  </li>
                  <li>
                     <p><a href="concepts-for-database-administrators.html#GUID-FA659979-25B7-4611-AA8D-48B5404301FE" title="Oracle提供了几种用于管理数据库的工具。">数据库管理员工具</a></p>
                  </li>
                  <li>
                     <p><a href="concepts-for-database-administrators.html#GUID-C12266D6-81D4-4637-83EC-A8D7E6430A3B" title="本节介绍对DBA最重要的主题，以及手册中未讨论过的主题。">数据库管理员主题</a></p>
                  </li>
               </ul>
            </div><a id="CNCPT828"></a><div class="props_rev_3"><a id="GUID-18D90D4B-35EE-45C7-B00D-CDA6ECAD5D89" name="GUID-18D90D4B-35EE-45C7-B00D-CDA6ECAD5D89"></a><h3 id="CNCPT-GUID-18D90D4B-35EE-45C7-B00D-CDA6ECAD5D89" class="sect3">数据库管理员的职责</h3>
               <div>
                  <p>数据库管理员（DBA）的主要职责是使其用户可以使用企业数据。</p>
                  <p>DBA必须与开发人员密切合作，以确保他们的应用程序有效地使用数据库，并与系统管理员一起确保物理资源充足并有效使用。</p>
                  <p>Oracle DBA负责了解Oracle数据库体系结构以及数据库的工作方式。DBA可以执行以下任务：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>安装，升级和修补Oracle数据库软件</p>
                     </li>
                     <li>
                        <p>设计数据库，包括识别需求，创建逻辑设计（概念模型）和物理数据库设计</p>
                     </li>
                     <li>
                        <p>创建Oracle数据库</p>
                     </li>
                     <li>
                        <p>开发和测试备份和恢复策略，定期备份Oracle数据库，并在发生故障时恢复它们</p>
                     </li>
                     <li>
                        <p>配置网络环境以使客户端能够连接到数据库</p>
                     </li>
                     <li>
                        <p>启动和关闭数据库</p>
                     </li>
                     <li>
                        <p>管理数据库的存储</p>
                     </li>
                     <li>
                        <p>管理用户和安全性</p>
                     </li>
                     <li>
                        <p>管理数据库对象，例如表，索引和视图</p>
                     </li>
                     <li>
                        <p>监视和调整数据库性能</p>
                     </li>
                     <li>
                        <p>调查，收集数据并向Oracle支持服务部门报告任何关键数据库错误</p>
                     </li>
                     <li>
                        <p>评估和测试新的数据库功能</p>
                     </li>
                  </ul>
                  <p>用户类型及其角色和职责取决于数据库环境。一个小型数据库可能有一个DBA。一个非常大的数据库可能会将DBA职责划分给几个专家，例如安全人员，备份操作员和应用程序管理员。</p>
                  <div class="infoboxnotealso" id="GUID-18D90D4B-35EE-45C7-B00D-CDA6ECAD5D89__GUID-2238F9D3-2671-4011-AD4E-02579B113FBD">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../admqs/getting-started-with-database-administration.html#ADMQS037" target="_blank"><span><cite>Oracle Database 2 Day DBA，</cite></span></a>用于介绍DBA任务</p>
                        </li>
                        <li>
                           <p><a href="../admqs/getting-started-with-database-administration.html#ADMQS037" target="_blank"><span><cite>Oracle数据库管理员指南，</cite></span></a>用于更深入地介绍DBA概念和任务</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="CNCPT829"></a><div class="props_rev_3"><a id="GUID-FA659979-25B7-4611-AA8D-48B5404301FE" name="GUID-FA659979-25B7-4611-AA8D-48B5404301FE"></a><h3 id="CNCPT-GUID-FA659979-25B7-4611-AA8D-48B5404301FE" class="sect3">数据库管理员工具</h3>
               <div>
                  <p>Oracle提供了几种用于管理数据库的工具。</p>
                  <p>本节介绍一些常用工具：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="concepts-for-database-administrators.html#GUID-BE08A8FA-501A-418E-AD32-3E42AE762026" title="Oracle Enterprise Manager（企业管理器）是一个基于Web的系统管理工具，可以管理Oracle数据库，Exadata数据库计算机，融合中间件，Oracle应用程序，服务器，存储以及非Oracle硬件和软件。">Oracle企业管理器</a></p>
                     </li>
                     <li>
                        <p><a href="concepts-for-database-administrators.html#GUID-6959296B-A487-4806-9BF6-564AE05C6D01" title="SQL * Plus是每个Oracle数据库安装中包含的交互式批处理查询工具。">在SQL * Plus</a></p>
                     </li>
                     <li>
                        <p><a href="concepts-for-database-administrators.html#GUID-87ACF317-FEBC-418C-9BE6-253F2C43F482" title="Oracle提供了多种工具来简化安装和配置Oracle数据库软件的任务。">数据库安装和配置工具</a></p>
                     </li>
                     <li>
                        <p><a href="concepts-for-database-administrators.html#GUID-74CB09E3-EEAA-4FF5-8563-88015FD2439C" title="Oracle Net Services在分布式异构计算环境中提供企业级连接解决方案。Oracle Net是Oracle Net Services的一个组件，支持从客户端应用程序到数据库的网络会话。">用于Oracle Net配置和管理的工具</a></p>
                     </li>
                     <li>
                        <p><a href="concepts-for-database-administrators.html#GUID-70A70ABD-02A4-41F8-9DDD-16B7F6937035" title="Oracle数据库包括几个用于协助数据移动和分析的实用程序。">数据移动和分析工具</a></p>
                     </li>
                  </ul>
               </div><a id="CNCPT830"></a><div class="props_rev_3"><a id="GUID-BE08A8FA-501A-418E-AD32-3E42AE762026" name="GUID-BE08A8FA-501A-418E-AD32-3E42AE762026"></a><h4 id="CNCPT-GUID-BE08A8FA-501A-418E-AD32-3E42AE762026" class="sect4">Oracle企业管理器</h4>
                  <div>
                     <p><strong class="term">Oracle Enterprise Manager</strong> （企业管理器）是一个基于Web的系统管理工具，可以管理Oracle数据库，Exadata数据库计算机，融合中间件，Oracle应用程序，服务器，存储以及非Oracle硬件和软件。
                     </p>
                  </div><a id="CNCPT89318"></a><div class="props_rev_3"><a id="GUID-B4C3D937-347B-4E33-B5BE-48153F8C9AC6" name="GUID-B4C3D937-347B-4E33-B5BE-48153F8C9AC6"></a><h5 id="CNCPT-GUID-B4C3D937-347B-4E33-B5BE-48153F8C9AC6" class="sect5">Oracle企业管理器云控制</h5>
                     <div>
                        <p>Oracle企业管理器云控制（云控制）是一个基于Web的界面，可为管理员提供跨Oracle技术堆栈和非Oracle组件的完整监控。</p>
                        <p>有时，快速应用程序通知（FAN）的组件可能变得不可用或遇到性能问题。在这种情况下，Cloud Control会显示自动生成的警报，以便管理员可以执行相应的恢复操作。</p>
                        <p>Cloud Control的组件包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>Oracle管理服务（OMS）</p>
                              <p>OMS功能是一组J2EE应用程序，它们为Cloud Control提供接口，与所有Oracle管理代理一起处理监视信息，并使用Enterprise Manager存储库作为其持久数据存储。</p>
                           </li>
                           <li>
                              <p>Oracle管理代理</p>
                              <p>这些代理程序是部署在每个受监视主机上的进程，用于监视主机上的所有目标，将此信息传递给OMS，以及维护主机及其目标。</p>
                           </li>
                           <li>
                              <p>Oracle Management Repository</p>
                              <p>存储库是Oracle数据库中的模式，其中包含有关由Cloud Control管理的管理员，目标和应用程序的所有可用信息。</p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-B4C3D937-347B-4E33-B5BE-48153F8C9AC6__GUID-754DF1A4-F3CF-4469-95CB-95F530489B0E">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../admin/distributed-database-concepts.html#ADMIN12110" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何使用Cloud Control管理数据库</p>
                              </li>
                              <li>
                                 <p>云控制的在线帮助</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT89317"></a><div class="props_rev_3"><a id="GUID-9EB727BA-83E4-4F03-89CD-E2A22FE348A3" name="GUID-9EB727BA-83E4-4F03-89CD-E2A22FE348A3"></a><h5 id="CNCPT-GUID-9EB727BA-83E4-4F03-89CD-E2A22FE348A3" class="sect5">Oracle Enterprise Manager Database Express 12c</h5>
                     <div>
                        <p>Oracle Enterprise Manager Database Express（EM Express）是内置于Oracle数据库中的Web管理产品。它不需要特殊的安装或管理。</p>
                        <p>EM Express包含Cloud Control中的关键性能管理和基本管理页面。这些页面包括以下内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>数据库主页</p>
                           </li>
                           <li>
                              <p>实时SQL监控</p>
                           </li>
                           <li>
                              <p>ASH Analytics</p>
                           </li>
                        </ul>
                        <p>您可以通过EM Express控制台在线访问这些功能，也可以通过Active Reports技术离线访问这些功能从体系结构的角度来看，EM Express没有中间层或中间件组件，确保其在数据库服务器上的开销可以忽略不计。</p>
                        <p>使用EM Express，您可以执行管理任务，例如管理用户安全性以及管理数据库内存和存储。您还可以查看有关数据库的性能和状态信息。</p>
                        <div class="infoboxnotealso" id="GUID-9EB727BA-83E4-4F03-89CD-E2A22FE348A3__GUID-00D596E0-30A0-4586-9101-FACDDB06246D">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../admqs/getting-started-with-database-administration.html#ADMQS031" target="_blank"><span><cite>Oracle Database 2 Day +性能调优指南</cite></span></a> ，了解如何使用EM Express管理数据库</p>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT831"></a><div class="props_rev_3"><a id="GUID-6959296B-A487-4806-9BF6-564AE05C6D01" name="GUID-6959296B-A487-4806-9BF6-564AE05C6D01"></a><h4 id="CNCPT-GUID-6959296B-A487-4806-9BF6-564AE05C6D01" class="sect4">在SQL * Plus</h4>
                  <div>
                     <p><strong class="term">SQL * Plus</strong>是每个Oracle数据库安装中包含的交互式批处理查询工具。
                     </p>
                     <p>它有一个命令行用户界面，在连接到数据库时充当客户端。SQL * Plus有自己的命令和环境。它使您能够输入和执行SQL，PL / SQL，SQL * Plus和操作系统命令来执行以下任务：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>从查询结果格式化，执行计算，存储和打印</p>
                        </li>
                        <li>
                           <p>检查表和对象定义</p>
                        </li>
                        <li>
                           <p>开发和运行批处理脚本</p>
                        </li>
                        <li>
                           <p>管理数据库</p>
                        </li>
                     </ul>
                     <p>您可以使用SQL * Plus以交互方式生成报告，以批处理方式生成报告，并将结果输出到文本文件，屏幕或HTML文件以便在Internet上浏览。您可以使用HTML输出工具动态生成报告。</p>
                     <div class="infoboxnotealso" id="GUID-6959296B-A487-4806-9BF6-564AE05C6D01__GUID-89B8791F-95FA-4993-952E-2C522D19967A">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../sqpug/SQL-Plus-quick-start.html#SQPUG002" target="_blank"><span><cite>SQL * Plus用户指南和参考，</cite></span></a>以了解有关SQL * Plus的更多信息</p>
                     </div>
                  </div>
               </div><a id="CNCPT832"></a><div class="props_rev_3"><a id="GUID-87ACF317-FEBC-418C-9BE6-253F2C43F482" name="GUID-87ACF317-FEBC-418C-9BE6-253F2C43F482"></a><h4 id="CNCPT-GUID-87ACF317-FEBC-418C-9BE6-253F2C43F482" class="sect4">数据库安装和配置工具</h4>
                  <div>
                     <p>Oracle提供了多种工具来简化安装和配置Oracle数据库软件的任务。</p>
                     <p>下表介绍了支持的工具。</p>
                     <div class="tblformal" id="GUID-87ACF317-FEBC-418C-9BE6-253F2C43F482__GUID-1D57FF58-A526-4E41-8640-D78FB4792FFF">
                        <p class="titleintable">表18-1数据库安装和配置工具</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="数据库安装和配置工具" border="1" summary="This table describes tools for database installation and configuration." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d92580e2376">工具</th>
                                 <th align="left" valign="bottom" id="d92580e2378">描述</th>
                                 <th align="left" valign="bottom" id="d92580e2380">了解更多</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d92580e2384" headers="d92580e2376 ">
                                    <p>Oracle Universal Installer（OUI）</p>
                                 </td>
                                 <td align="left" valign="top" headers="d92580e2384 d92580e2378 ">
                                    <p>OUI是一个GUI实用程序，使您可以查看，安装和卸载Oracle数据库软件。在线帮助可指导您完成安装。</p>
                                 </td>
                                 <td align="left" valign="top" headers="d92580e2384 d92580e2380 ">
                                    <p>在线帮助指导您完成安装</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d92580e2394" headers="d92580e2376 ">
                                    <p>数据库升级助手（DBUA）</p>
                                 </td>
                                 <td align="left" valign="top" headers="d92580e2394 d92580e2378 ">
                                    <p>DBUA以交互方式指导您完成数据库升级并为新版本配置数据库。DBUA通过执行通常手动执行的所有任务来自动执行升级。DBUA为表空间和<a href="glossary.html#GUID-2A8BC112-AB70-4B06-9F85-FE975861CEE0"><span class="xrefglossterm">联机重做日志</span></a>等配置选项提供建议。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" headers="d92580e2394 d92580e2380 ">
                                    <p><a href="../admqs/managing-oracle-database-software.html#ADMQS024" target="_blank"><span><cite>Oracle Database 2 Day DBA</cite></span></a>学习如何使用DBUA升级数据库</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d92580e2412" headers="d92580e2376 ">
                                    <p>数据库配置助手（DBCA）</p>
                                 </td>
                                 <td align="left" valign="top" headers="d92580e2412 d92580e2378 ">
                                    <p>DBCA提供了用于创建和配置数据库的图形界面和指导工作流程。此工具使您可以从Oracle提供的模板创建数据库，或创建自己的数据库和模板。</p>
                                 </td>
                                 <td align="left" valign="top" headers="d92580e2412 d92580e2380 ">
                                    <p><a href="../admin/creating-and-configuring-an-oracle-database.html#ADMIN12479" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何使用DBCA创建数据库</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="CNCPT64545"></a><div class="props_rev_3"><a id="GUID-74CB09E3-EEAA-4FF5-8563-88015FD2439C" name="GUID-74CB09E3-EEAA-4FF5-8563-88015FD2439C"></a><h4 id="CNCPT-GUID-74CB09E3-EEAA-4FF5-8563-88015FD2439C" class="sect4">用于Oracle Net配置和管理的工具</h4>
                  <div>
                     <p><span class="bold">Oracle Net Services</span>在分布式异构计算环境中提供企业级连接解决方案。Oracle Net是Oracle Net Services的一个组件，支持从客户端应用程序到数据库的网络会话。
                     </p>
                     <p>您可以使用以下工具配置和管理Oracle Net Services：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Oracle Net Manager</p>
                           <p>使用此工具，您可以在本地客户端或服务器主机上为Oracle主目录配置Oracle Net Services。您可以使用Oracle Net Manager配置命名，命名方法，配置文件和侦听器。您可以使用Oracle Enterprise Manager控制台或作为独立应用程序启动Oracle Net Manager。</p>
                        </li>
                        <li>
                           <p>Oracle Net Configuration Assistant</p>
                           <p>此工具在软件安装期间自动运行。通过Assistant，您可以在安装期间配置基本网络组件，包括侦听器名称和协议地址，命名方法， <code class="codeph">tnsnames.ora</code>文件中的网络服务名称以及目录服务器使用情况。
                           </p>
                        </li>
                        <li>
                           <p>监听器控制实用程序</p>
                           <p>Listener Control实用程序使您可以配置侦听器以接收客户端连接。您可以通过Enterprise Manager或作为独立的命令行应用程序访问该实用程序。</p>
                        </li>
                        <li>
                           <p>Oracle Connection Manager控制实用程序</p>
                           <p>此命令行实用程序使您可以管理<a href="glossary.html#GUID-403DE106-1DB5-4A06-ACFD-BE1E348955C8"><span class="xrefglossterm">Oracle连接管理器</span></a> ，该<a href="glossary.html#GUID-403DE106-1DB5-4A06-ACFD-BE1E348955C8"><span class="xrefglossterm">连接管理器</span></a>是一个路由器，通过该路由器可以将客户端连接请求发送到其下一个跃点或直接发送到数据库。您可以使用实用程序命令在一个或多个Oracle Connection Manager上执行基本管理功能。此外，您还可以查看和更改参数设置。
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-74CB09E3-EEAA-4FF5-8563-88015FD2439C__GUID-E490A01F-29D0-4F94-8646-6A48ECCA3D0E">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p> <span class="q">“ <a href="application-and-networking-architecture.html#GUID-D6E2465E-E8E6-4B95-95D3-B9581E264ED1" title="Oracle Net Listener（侦听器）是一个服务器端进程，它侦听传入的客户端连接请求并管理数据库的流量。当数据库实例启动时，以及在其生命周期的不同时间，实例联系侦听器并建立与此实例的通信路径。">Oracle Net Listener</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="application-and-networking-architecture.html#GUID-136C7637-89B5-4C5A-B186-E06F86CE2359" title="Oracle Net Services是一套网络组件，可在分布式异构计算环境中提供企业级连接解决方案。">Oracle网络服务架构概述</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../netag/managing-oracle-net-services.html#NETAG005" target="_blank"><span><cite>Oracle Database Net Services管理员指南</cite></span></a> ，了解有关Oracle Net Services工具的更多信息</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT1276"></a><div class="props_rev_3"><a id="GUID-70A70ABD-02A4-41F8-9DDD-16B7F6937035" name="GUID-70A70ABD-02A4-41F8-9DDD-16B7F6937035"></a><h4 id="CNCPT-GUID-70A70ABD-02A4-41F8-9DDD-16B7F6937035" class="sect4">数据移动和分析工具</h4>
                  <div>
                     <p>Oracle数据库包括几个用于协助数据移动和分析的实用程序。</p>
                     <p>例如，您可以使用数据库实用程序：</p>
                     <div class="tblformal" id="GUID-70A70ABD-02A4-41F8-9DDD-16B7F6937035__GUID-3A5E0DE5-D063-463A-85D6-47C8816DD674">
                        <p class="titleintable">表18-2数据移动和分析任务</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="数据移动和分析任务" border="1" summary="This table describes possible data movement and analysis tasks." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d92580e3042">任务</th>
                                 <th align="left" valign="bottom" width="20%" id="d92580e3044">了解更多</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d92580e3048" headers="d92580e3042 ">
                                    <p>从操作系统文件将数据加载到Oracle数据库表中</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d92580e3048 d92580e3044 ">
                                    <p><span class="q">“ <a href="concepts-for-database-administrators.html#GUID-A6BF29E2-70E6-46F8-8BF9-E321113A3670" title="SQL * Loader将来自外部文件的数据（称为数据文件（不要与内部数据库数据文件混淆））加载到数据库表中。它具有强大的数据解析引擎，对数据文件中的数据格式几乎没有限制。">SQL * Loader</a> ”</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d92580e3063" headers="d92580e3042 ">
                                    <p>将数据和元数据从一个数据库移动到另一个数据库</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d92580e3063 d92580e3044 ">
                                    <p><span class="q">“ <a href="concepts-for-database-administrators.html#GUID-DCDD0FBF-0AD2-45E1-B723-21CC72ADDCD6" title="Oracle Data Pump支持从一个数据库到另一个数据库的高速数据和元数据移动。">Oracle数据泵导出和导入</a> ”</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d92580e3075" headers="d92580e3042 ">
                                    <p>通过SQL接口查询重做日志文件</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d92580e3075 d92580e3044 ">
                                    <p><span class="q">“ <a href="concepts-for-database-administrators.html#GUID-D2E36A56-0571-4857-8D41-BBCC833403E5" title="Oracle LogMiner使您可以通过SQL接口查询重做日志文件。">Oracle LogMiner</a> ”</span></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d92580e3087" headers="d92580e3042 ">
                                    <p>管理Oracle数据库数据</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d92580e3087 d92580e3044 ">
                                    <p><span class="q">“ <a href="concepts-for-database-administrators.html#GUID-3F5B1954-D81A-43A1-8BB8-E7ECBA8FAC40" title="ADRCI是一个命令行实用程序，使您可以调查问题，查看运行状况检查报告，以及将首次故障数据打包并上载到Oracle Support。">ADR指挥口译员（ADRCI）</a> ”</span></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>其他任务包括使用DBVERIFY对脱机数据库或数据文件执行物理数据结构完整性检查，或使用DBNEWID实用程序更改操作数据库的数据库标识符（DBID）或数据库名称。</p>
                     <div class="infoboxnote" id="GUID-70A70ABD-02A4-41F8-9DDD-16B7F6937035__GUID-1D404AC0-897A-443A-8194-427D08C6D481">
                        <p class="notep1">注意：</p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-70A70ABD-02A4-41F8-9DDD-16B7F6937035__GUID-2AD311BB-D9E1-4A8E-8993-05D711BC9EFF">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="concepts-for-database-administrators.html#GUID-DCE361D9-B486-43B4-B4FD-5722A93203F0" title="备份和恢复是保护数据库免受介质故障或用户错误导致的数据丢失所涉及的一组概念，过程和策略。通常，备份和恢复策略的目的是保护数据库免受数据丢失和重建丢失的数据。">备份和恢复</a> ”</span>以了解与备份和恢复相关的工具</p>
                           </li>
                           <li>
                              <p><a href="../sutil/oracle-dbverify-utility.html#SUTIL013" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a>可以了解DBVERIFY和DBNEWID</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="CNCPT89399"></a><a id="CNCPT1282"></a><div class="props_rev_3"><a id="GUID-A6BF29E2-70E6-46F8-8BF9-E321113A3670" name="GUID-A6BF29E2-70E6-46F8-8BF9-E321113A3670"></a><h5 id="CNCPT-GUID-A6BF29E2-70E6-46F8-8BF9-E321113A3670" class="sect5">使用SQL * Loader</h5>
                     <div>
                        <p>SQL * Loader将来自外部文件的<span class="italic">数据</span> （称为<span class="italic">数据文件</span> （不要与内部数据库数据文件混淆））加载到数据库表中。它具有强大的数据解析引擎，对数据文件中的数据格式几乎没有限制。
                        </p>
                        <p>您可以使用SQL * Loader执行以下操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>将多个数据文件中的数据加载到多个表中</p>
                              <p>您将要加载的数据存储在SQL * Loader数据文件中。SQL * Loader控制文件是一个文本文件，其中包含SQL * Loader用于确定在何处查找数据，如何解析和解释数据，在何处插入数据等的<a href="glossary.html#GUID-64F19D78-A73F-44A5-AA2E-60EBC800CB22"><span class="xrefglossterm">DDL</span></a>指令。
                              </p>
                              <div class="infoboxnote" id="GUID-A6BF29E2-70E6-46F8-8BF9-E321113A3670__GUID-12D1313E-1118-425E-AB8D-5CEC8ACFA7F8">
                                 <p class="notep1">注意：</p>
                                 <p>SQL * Loader数据文件和控制文件与Oracle数据库数据文件和控制文件无关。</p>
                              </div>
                           </li>
                           <li>
                              <p>控制加载操作的各个方面</p>
                              <p>例如，您可以选择性地加载数据，指定数据字符集，使用SQL函数操作数据，在指定列中生成唯一的顺序键值等。您还可以生成复杂的错误报告。</p>
                           </li>
                           <li>
                              <p>使用传统路径，直接路径或外部表负载</p>
                              <p>传统的路径加载执行SQL <code class="codeph">INSERT</code>语句来填充表。相反， <a href="glossary.html#GUID-73D6FDFE-E38D-49F2-A5A5-B6BDB2FD297C"><span class="xrefglossterm">直接路径INSERT</span></a>通过格式化数据块并将它们直接写入数据文件来消除大部分数据库开销。直接写入操作高于<a href="glossary.html#GUID-F3F5ACB2-94C8-483F-B427-1981836D0609"><span class="xrefglossterm">高水位线（HWM）的</span></a>块，并直接写入磁盘，绕过<a href="glossary.html#GUID-7913177D-8183-4CC5-8F59-816FE66DA363"><span class="xrefglossterm">数据库缓冲区高速缓存</span></a> 。直接读取直接从磁盘读取到<a href="glossary.html#GUID-19927E75-4983-4D59-A03D-C630E9908897"><span class="xrefglossterm">PGA</span></a> ，再次绕过缓冲区缓存。
                              </p>
                              <p>外部表加载为数据文件中包含的数据创建<a href="glossary.html#GUID-1B18B978-29DD-4961-BD39-86838CB5F7D0"><span class="xrefglossterm">外部表</span></a> 。加载执行<code class="codeph">INSERT</code>语句以将数据从数据文件插入目标表。
                              </p>
                           </li>
                        </ul>
                        <p>典型的SQL * Loader会话将SQL * Loader控制文件和一个或多个数据文件作为输入。输出是Oracle数据库，日志文件，错误文件以及可能的丢弃文件。下图说明了典型SQL * Loader会话的流程。</p>
                        <div class="figure" id="GUID-A6BF29E2-70E6-46F8-8BF9-E321113A3670__BGBGJDHI">
                           <p class="titleinfigure">图18-1 SQL * Loader会话</p><img src="img/cncpt271.gif" alt="下面是图18-1的描述" title="下面是图18-1的描述" longdesc="img_text/cncpt271.html"><br><a href="img_text/cncpt271.html">“图18-1 SQL *加载器会话”的说明</a></div>
                        <!-- class="figure" -->
                        <p>您还可以使用SQL * Loader express模式，该模式在SQL * Loader命令中指定<code class="codeph">table</code>参数时激活，如以下示例所示：</p><pre class="pre codeblock"><code>％sqlldr hr table = employees</code></pre><p>不允许使用控制文件，这使得SQL * Loader更易于使用。SQL * Loader不使用解析控制文件，而是使用表列定义来确定输入数据类型。SQL * Loader有几个默认假设，包括字符集，字段分隔符以及数据，日志和坏文件的名称。您可以使用命令行参数覆盖许多默认值。</p>
                        <div class="infoboxnotealso" id="GUID-A6BF29E2-70E6-46F8-8BF9-E321113A3670__GUID-25B5624B-3EAE-47D2-993F-9858FEC3DED3">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="tables-and-table-clusters.html#GUID-97FC9DFF-A6CF-46CD-9F6F-D88A37C0E79C" title="外部表访问外部源中的数据，就好像此数据位于数据库中的表中一样。">外部表概述</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-57374356-61C4-45B1-8A05-3353FD034202" title="全球化支持的一个关键组成部分是字符集，它是一种用于在计算机屏幕上显示字符的编码方案。">字符集</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../sutil/oracle-sql-loader-concepts.html#SUTIL003" target="_blank"><span><cite>Oracle数据库实用程序，</cite></span></a>以了解SQL * Loader</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT89113"></a><a id="CNCPT1277"></a><div class="props_rev_3"><a id="GUID-DCDD0FBF-0AD2-45E1-B723-21CC72ADDCD6" name="GUID-DCDD0FBF-0AD2-45E1-B723-21CC72ADDCD6"></a><h5 id="CNCPT-GUID-DCDD0FBF-0AD2-45E1-B723-21CC72ADDCD6" class="sect5">Oracle Data Pump导出和导入</h5>
                     <div>
                        <p>Oracle Data Pump支持从一个数据库到另一个数据库的高速数据和元数据移动。</p>
                        <p>此技术是以下Oracle数据库数据移动实用程序的基础：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>数据泵导出（导出）</p>
                              <p>Export是一个实用程序，用于将数据和元数据卸载到一组称为<span class="italic">转储文件集</span>的操作系统<span class="italic">文件中</span> 。转储文件集由一个或多个包含表数据，数据库对象元数据和控制信息的二进制文件组成。
                              </p>
                           </li>
                           <li>
                              <p>数据泵导入（导入）</p>
                              <p>Import是一个用于将导出转储文件集加载到数据库中的实用程序。您还可以使用“导入”直接从源数据库加载目标数据库而不插入任何文件，这允许导出和导入操作同时运行，从而最大限度地减少总耗用时间。</p>
                           </li>
                        </ul>
                        <p>Oracle Data Pump由以下不同部分组成：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>命令行客户端<code class="codeph">expdp</code>和<code class="codeph">impdp</code></p>
                              <p>这些客户端调用<code class="codeph">DBMS_DATAPUMP</code>包来执行Oracle Data Pump操作。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBMS_DATAPUMP</code> PL / SQL包，也称为Data Pump API</p>
                              <p>此API提供高速导入和导出功能。</p>
                           </li>
                           <li>
                              <p><code class="codeph">DBMS_METADATA</code> PL / SQL包，也称为<span class="bold">Metadata API</span></p>
                              <p>加载和卸载元数据的所有进程都使用此API，该API以XML格式存储对象定义。</p>
                           </li>
                        </ul>
                        <p>下图显示了Oracle Data Pump如何与SQL * Loader和外部表集成。如图所示，SQL * Loader与外部表API和数据泵API集成，以将数据加载到外部表中。Oracle Enterprise Manager云控制（云控制）和可传输表空间等客户端可以使用Oracle Data Pump基础架构。</p>
                        <div class="figure" id="GUID-DCDD0FBF-0AD2-45E1-B723-21CC72ADDCD6__CHDIBCJD">
                           <p class="titleinfigure">图18-2 Oracle数据泵体系结构</p><img src="img/cncpt261.png" alt="下面是图18-2的描述" title="下面是图18-2的描述" longdesc="img_text/cncpt261.html"><br><a href="img_text/cncpt261.html">“图18-2 Oracle数据泵体系结构”的说明</a></div>
                        <!-- class="figure" -->
                        <div class="infoboxnotealso" id="GUID-DCDD0FBF-0AD2-45E1-B723-21CC72ADDCD6__GUID-432A312F-1E2F-4047-8502-D65FDA4C9410">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="tables-and-table-clusters.html#GUID-97FC9DFF-A6CF-46CD-9F6F-D88A37C0E79C" title="外部表访问外部源中的数据，就好像此数据位于数据库中的表中一样。">外部表概述</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="server-side-programming.html#GUID-87FA8137-A449-4542-8869-441C63810C63" title="PL / SQL包是一组相关的子程序，以及它们使用的游标和变量，它们一起存储在数据库中以便作为一个单元继续使用。应用程序或用户可以显式调用打包的子程序。">PL / SQL包</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../sutil/oracle-data-pump-overview.html#SUTIL100" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a> ，概述了Oracle Data Pump</p>
                              </li>
                              <li>
                                 <p><a href="../arpls/DBMS_DATAPUMP.html#ARPLS356" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a> ，以<code class="codeph">DBMS_DATAPUMP</code>和<code class="codeph">DBMS_METADATA</code>的描述</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT1284"></a><div class="props_rev_3"><a id="GUID-D2E36A56-0571-4857-8D41-BBCC833403E5" name="GUID-D2E36A56-0571-4857-8D41-BBCC833403E5"></a><h5 id="CNCPT-GUID-D2E36A56-0571-4857-8D41-BBCC833403E5" class="sect5">Oracle LogMiner</h5>
                     <div>
                        <p>Oracle LogMiner使您可以通过SQL接口查询重做日志文件。</p>
                        <p>重做日志文件中包含的数据的潜在用途包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>精确定位数据库的逻辑损坏（例如在应用程序级别发生的错误）可能已经开始</p>
                           </li>
                           <li>
                              <p>检测用户错误</p>
                           </li>
                           <li>
                              <p>确定在事务级别执行细粒度恢复时必须采取的操作</p>
                           </li>
                           <li>
                              <p>使用趋势分析确定哪些表获得最多更新和插入</p>
                           </li>
                           <li>
                              <p>通过LogMiner综合关系接口分析系统行为和审核数据库使用，以重做日志文件</p>
                           </li>
                        </ul>
                        <p>LogMiner可通过命令行界面或Oracle LogMiner Viewer GUI访问，该GUI是Enterprise Manager的一部分。</p>
                        <div class="infoboxnotealso" id="GUID-D2E36A56-0571-4857-8D41-BBCC833403E5__GUID-81976897-D9C5-42AB-84C7-2CA3097F3E3C">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../sutil/oracle-logminer-utility.html#SUTIL1553" target="_blank"><span><cite>Oracle数据库实用程序，</cite></span></a>以了解有关LogMiner的更多信息</p>
                        </div>
                     </div>
                  </div><a id="CNCPT1287"></a><div class="props_rev_3"><a id="GUID-3F5B1954-D81A-43A1-8BB8-E7ECBA8FAC40" name="GUID-3F5B1954-D81A-43A1-8BB8-E7ECBA8FAC40"></a><h5 id="CNCPT-GUID-3F5B1954-D81A-43A1-8BB8-E7ECBA8FAC40" class="sect5">ADR命令解释器（ADRCI）</h5>
                     <div>
                        <p><span class="bold">ADRCI</span>是一个命令行实用程序，使您可以调查问题，查看运行状况检查报告，以及将首次故障数据打包并上载到Oracle Support。
                        </p>
                        <p>您还可以使用该实用程序在<a href="glossary.html#GUID-C46C2565-A02E-4512-8E47-CB7CCB25425D"><span class="xrefglossterm">自动诊断信息库（ADR）</span></a>中查看跟踪文件的名称，并查看<a href="glossary.html#GUID-ACC7727F-41AE-47B1-AADB-2585EE828792"><span class="xrefglossterm">警报日志</span></a> 。ADRCI具有丰富的命令集，您可以交互使用或在脚本中使用。
                        </p>
                        <div class="infoboxnotealso" id="GUID-3F5B1954-D81A-43A1-8BB8-E7ECBA8FAC40__GUID-0CD2AF0D-853E-4715-94D9-BA8F930AB3C9">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="oracle-database-instance.html#GUID-8E4BC033-4704-4FF5-A459-0E1EBF2D35B8" title="自动诊断存储库（ADR）是一个基于文件的存储库，用于存储数据库诊断数据，如跟踪文件，警报日志，DDL日志和Health Monitor报告。">自动诊断存储库</a> ”</span></p>
                              </li>
                              <li>
                                 <p>有关ADR和ADRCI的详细信息，请参见<a href="../admin/diagnosing-and-resolving-problems.html#ADMIN11257" target="_blank"><span><cite>“</cite></span></a> <a href="../sutil/oracle-adr-command-interpreter-adrci.html#SUTIL700" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a>和<a href="../admin/diagnosing-and-resolving-problems.html#ADMIN11257" target="_blank"><span><cite>Oracle数据库管理员指南”</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT834"></a><div class="props_rev_3"><a id="GUID-C12266D6-81D4-4637-83EC-A8D7E6430A3B" name="GUID-C12266D6-81D4-4637-83EC-A8D7E6430A3B"></a><h3 id="CNCPT-GUID-C12266D6-81D4-4637-83EC-A8D7E6430A3B" class="sect3">数据库管理员主题</h3>
               <div>
                  <p>本节介绍对DBA最重要的主题，以及手册中未讨论过的主题。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="concepts-for-database-administrators.html#GUID-DCE361D9-B486-43B4-B4FD-5722A93203F0" title="备份和恢复是保护数据库免受介质故障或用户错误导致的数据丢失所涉及的一组概念，过程和策略。通常，备份和恢复策略的目的是保护数据库免受数据丢失和重建丢失的数据。">备份和恢复</a></p>
                     </li>
                     <li>
                        <p><a href="concepts-for-database-administrators.html#GUID-D39DB708-CC94-4EE6-ACDA-ACED36DA4DA5" title="内存管理涉及在数据库更改需求时保持Oracle实例内存结构的最佳大小。初始化参数设置确定如何管理SGA和实例PGA内存。">内存管理</a></p>
                     </li>
                     <li>
                        <p><a href="concepts-for-database-administrators.html#GUID-EB2AB7CA-8F3A-4A2B-AA0A-8E9D138D8B75" title="Oracle数据库提供了一些工具来帮助您管理资源，并提供计划任务以减少对用户的影响。">资源管理和任务调度</a></p>
                     </li>
                     <li>
                        <p><a href="concepts-for-database-administrators.html#GUID-045B9963-F53D-427C-87B7-04858B22D4D8" title="作为DBA，您负责Oracle数据库的性能。通常，性能问题是由不可接受的响应时间引起的，响应时间是完成指定工作负载的时间，或吞吐量，即可在指定时间内完成的工作量。">性能和调优</a></p>
                     </li>
                  </ul>
               </div><a id="CNCPT031"></a><div class="props_rev_3"><a id="GUID-DCE361D9-B486-43B4-B4FD-5722A93203F0" name="GUID-DCE361D9-B486-43B4-B4FD-5722A93203F0"></a><h4 id="CNCPT-GUID-DCE361D9-B486-43B4-B4FD-5722A93203F0" class="sect4">备份和恢复</h4>
                  <div>
                     <p>备份和恢复是保护数据库免受介质故障或用户错误导致的数据丢失所涉及的一组概念，过程和策略。通常，备份和恢复策略的目的是保护数据库免受数据丢失和重建丢失的数据。</p>
                     <p><a href="glossary.html#GUID-3E8FA828-167D-4C7F-A7A3-36A80F34546C"><span class="xrefglossterm">备份</span></a>是数据的副本。备份可以包括数据库的关键部分，例如数据文件， <a href="glossary.html#GUID-D068D7A7-ECF5-49F2-A055-B6F668E96D0C"><span class="xrefglossterm">服务器参数文件</span></a>和控制文件。示例备份和恢复方案是导致丢失数据文件的故障磁盘驱动器。如果存在丢失文件的备份，则可以还原并恢复它。将数据恢复到丢失之前的状态所涉及的操作称为<a href="glossary.html#GUID-938A3E7D-CC65-496C-9DB3-3CFC45AFA8DD"><span class="xrefglossterm">介质恢复</span></a> 。
                     </p>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="concepts-for-database-administrators.html#GUID-71AC5772-3143-40C4-86EC-93367FB85B2A" title="您可以使用Recovery Manager或用户管理的技术来备份，还原和恢复Oracle数据库。">备份和恢复技术</a></p>
                        </li>
                        <li>
                           <p><a href="concepts-for-database-administrators.html#GUID-7E046FF6-AD1E-4A05-B55F-5049EBCD6427" title="可以从命令行和Enterprise Manager云控制（云控制）访问RMAN和Oracle Secure Backup。">Recovery Manager体系结构</a></p>
                        </li>
                        <li>
                           <p><a href="concepts-for-database-administrators.html#GUID-27DFFB35-0A8E-4435-97B1-726A48419DC6" title="数据库备份可以是物理备份或逻辑备份。">数据库备份</a></p>
                        </li>
                        <li>
                           <p><a href="concepts-for-database-administrators.html#GUID-BCE6455B-0E49-4835-B9AB-2BC70F673F88" title="虽然有几个问题可以阻止数据库的正常运行或影响I / O操作，但只有一些问题需要DBA干预和数据修复。">数据修复</a></p>
                        </li>
                        <li>
                           <p><a href="concepts-for-database-administrators.html#GUID-89C1FA97-474D-412E-905E-59D08E26BBBF" title="云规模的零数据丢失恢复设备（通常称为恢复设备）是一个工程化系统，可显着减少企业中所有Oracle数据库的数据丢失和备份开销。">零数据丢失恢复设备</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-DCE361D9-B486-43B4-B4FD-5722A93203F0__GUID-E0B0A8BD-F74A-453F-934C-8043C7240856">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../bradv/introduction-backup-recovery.html#BRADV8001" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南，</span></a>用于备份和恢复概念和任务</p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=NTQRF285" target="_blank"><span class="italic">适用于Microsoft Windows的Oracle数据库平台指南，</span></a>了解如何使用卷影复制服务（VSS）应用程序在Microsoft Windows上备份和恢复数据库</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="CNCPT835"></a><div class="props_rev_3"><a id="GUID-71AC5772-3143-40C4-86EC-93367FB85B2A" name="GUID-71AC5772-3143-40C4-86EC-93367FB85B2A"></a><h5 id="CNCPT-GUID-71AC5772-3143-40C4-86EC-93367FB85B2A" class="sect5">备份和恢复技术</h5>
                     <div>
                        <p>您可以使用Recovery Manager或用户管理的技术来备份，还原和恢复Oracle数据库。</p>
                        <p>两种方法的主要区别如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="glossary.html#GUID-C93A3B47-4AE8-4AB7-A370-C8395A7B42AA"><span class="xrefglossterm">恢复管理器（RMAN）</span></a></p>
                              <p>RMAN是一个Oracle数据库实用程序，它与Oracle数据库集成以执行备份和恢复活动，包括在其备份的每个数据库的控制文件中维护历史备份元数据的存储库。RMAN还可以在另一个数据库中维护一个称为<a href="glossary.html#GUID-2366988A-C3CA-4B75-B59F-69AC00678629"><span class="xrefglossterm">恢复目录</span></a>的集中式备份存储库。RMAN是Oracle数据库功能，不需要单独安装。
                              </p>
                              <p>RMAN与Oracle Secure Backup集成，后者提供可靠，集中的磁带备份管理，保护文件系统数据和Oracle数据库文件。通过Oracle Secure Backup SBT界面，您可以使用RMAN从磁带和基于Internet的Web服务（如Amazon S3）备份和还原数据库文件。Oracle Secure Backup几乎支持SAN和SCSI环境中的每个磁带驱动器和磁带库。</p>
                           </li>
                           <li>
                              <p>用户管理的技术</p>
                              <p>作为RMAN的替代方案，您可以使用操作系统命令（如Linux <code class="codeph">dd</code>备份和还原文件，使用SQL * Plus <code class="codeph">RECOVER</code>命令进行介质恢复。Oracle完全支持用户管理的备份和恢复，但建议使用RMAN，因为它与Oracle数据库集成并简化了管理。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-71AC5772-3143-40C4-86EC-93367FB85B2A__GUID-D8159317-624A-466E-94AC-962EFCB3B650">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../bradv/introduction-backup-recovery.html#BRADV89341" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a> ，了解备份和恢复解决方案的概述</p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=OBADM-GUID-8823172F-5367-4255-A209-83975273C3B3" target="_blank"><span><cite>Oracle Secure Backup管理员指南</cite></span></a> ，概述了Oracle Secure Backup</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT89383"></a><a id="CNCPT89382"></a><div class="props_rev_3"><a id="GUID-7E046FF6-AD1E-4A05-B55F-5049EBCD6427" name="GUID-7E046FF6-AD1E-4A05-B55F-5049EBCD6427"></a><h5 id="CNCPT-GUID-7E046FF6-AD1E-4A05-B55F-5049EBCD6427" class="sect5">Recovery Manager体系结构</h5>
                     <div>
                        <p>可以从命令行和Enterprise Manager云控制（云控制）访问RMAN和Oracle Secure Backup。</p>
                        <p>Cloud Control为RMAN提供图形前端和调度工具。输入作业参数，然后指定作业计划。Cloud Control在指定时间或指定的重复间隔运行RMAN以执行备份和恢复操作。Cloud Control通过一组向导提供对RMAN的访问。这些向导将根据您对数据库，可用备份和数据恢复目标的分析，引导您完成各种恢复过程。</p>
                        <p>通过使用Cloud Control，您可以执行本文档中概述的更简单的还原和恢复方案。您还可以使用更复杂的还原和恢复技术，例如时间点恢复和Oracle闪回操作，从而有效修复介质故障和用户错误。使用Cloud Control通常比RMAN命令行客户端更简单。</p>
                        <p>下图显示了RMAN体系结构示例。可通过Cloud Control访问的RMAN客户端使用目标数据库上的服务器会话将数据备份到磁盘或磁带。RMAN可以使用备份元数据更新外部恢复目录。</p>
                        <div class="figure" id="GUID-7E046FF6-AD1E-4A05-B55F-5049EBCD6427__BGBHFEDE">
                           <p class="titleinfigure">图18-3 RMAN架构</p><img src="img/cncpt318.gif" alt="下面是图18-3的描述" title="下面是图18-3的描述" longdesc="img_text/cncpt318.html"><br><a href="img_text/cncpt318.html">“图18-3 RMAN架构”的描述</a></div>
                        <!-- class="figure" -->
                        <p>无论您使用哪种备份和恢复技术，Oracle都建议您配置<a href="glossary.html#GUID-0F4B1B3D-4831-42FA-A53B-E34BA9D1BBB0"><span class="xrefglossterm">快速恢复区域</span></a> 。此数据库管理的目录，文件系统或<a href="glossary.html#GUID-85D5EEA3-5127-4F08-AC1C-A2C660F21D92"><span class="xrefglossterm">Oracle ASM磁盘组</span></a>集中了备份和恢复文件，包括活动控制文件，联机和归档重做日志文件以及备份。Oracle数据库恢复组件与快速恢复区域交互以确保数据库可恢复性。
                        </p>
                        <div class="infoboxnotealso" id="GUID-7E046FF6-AD1E-4A05-B55F-5049EBCD6427__GUID-958200FC-496B-476D-882D-D5E8BCC71FDE">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../admqs/performing-backup-and-recovery.html#ADMQS009" target="_blank"><span><cite>Oracle Database 2 Day DBA</cite></span></a> ，了解如何使用Recovery Manager执行备份和恢复</p>
                              </li>
                              <li>
                                 <p>有关如何设置和管理快速恢复区域的信息，请参见<a href="../admin/creating-and-configuring-an-oracle-database.html#ADMIN11103" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT1424"></a><div class="props_rev_3"><a id="GUID-27DFFB35-0A8E-4435-97B1-726A48419DC6" name="GUID-27DFFB35-0A8E-4435-97B1-726A48419DC6"></a><h5 id="CNCPT-GUID-27DFFB35-0A8E-4435-97B1-726A48419DC6" class="sect5">数据库备份</h5>
                     <div>
                        <p>数据库备份可以是物理备份或逻辑备份。</p>
                        <p>物理备份是备份和恢复策略中的主要关注点，是物理数据库文件的副本。您可以使用RMAN或操作系统实用程序进行物理备份。</p>
                        <p>相反，逻辑备份包含表，存储过程和其他逻辑数据。您可以使用Oracle数据库实用程序（如Data Pump Export）提取逻辑数据，并将其存储在二进制文件中。逻辑备份可以补充物理备份。</p>
                        <p>物理备份具有较大的粒度和有限的可传输性，但速度非常快。逻辑备份具有精细的粒度和完整的可传输性，但比物理备份慢。</p>
                        <div class="infoboxnotealso" id="GUID-27DFFB35-0A8E-4435-97B1-726A48419DC6__GUID-D1DC8B9A-166F-4446-97C0-0A5EA802A622">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../bradv/introduction-backup-recovery.html#BRADV89335" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a> ，了解物理和逻辑备份</p>
                        </div>
                     </div><a id="CNCPT1426"></a><div class="props_rev_3"><a id="GUID-B90A67DD-FF6C-4539-B530-B944E964D789" name="GUID-B90A67DD-FF6C-4539-B530-B944E964D789"></a><h6 id="CNCPT-GUID-B90A67DD-FF6C-4539-B530-B944E964D789" class="sect6">整个和部分数据库备份</h6>
                        <div>
                           <p><span class="bold">整个数据库备份</span>是<span class="bold">数据库</span>中每个数据文件的备份，以及控制文件。整个数据库备份是最常见的备份类型。
                           </p>
                           <p>部分数据库备份包括数据库的子集：单个表空间或数据文件。表空间备份是表空间或多个表空间中所有数据文件的备份。表空间备份（无论是一致还是不一致）仅在数据库以<code class="codeph">ARCHIVELOG</code>模式运行时才有效，因为需要<code class="codeph">ARCHIVELOG</code>重做来使还原的表空间与数据库的其余部分保持一致。
                           </p>
                        </div>
                     </div><a id="CNCPT1427"></a><div class="props_rev_3"><a id="GUID-46F3DC5D-B20D-45DC-9381-D2EA084290C7" name="GUID-46F3DC5D-B20D-45DC-9381-D2EA084290C7"></a><h6 id="CNCPT-GUID-46F3DC5D-B20D-45DC-9381-D2EA084290C7" class="sect6">一致且不一致的备份</h6>
                        <div>
                           <p>整个数据库备份要么一致，要么不一致。</p>
                           <p>在<a href="glossary.html#GUID-9758D2DA-4550-4F4F-8965-12A8AE13FFCD"><span class="xrefglossterm">一致的备份中</span></a> ，所有读/写数据文件和控制文件都具有相同的<a href="glossary.html#GUID-95DBDA37-4C57-444F-B660-D52B4A99D919"><span class="xrefglossterm">检查点</span></a> <a href="glossary.html#GUID-4B14A746-A8B3-4123-A02A-3FC1C293042C"><span class="xrefglossterm">SCN</span></a> ，从而保证这些文件包含此SCN之前的所有更改。恢复后，此类备份不需要恢复。
                           </p>
                           <p>只有在一致关闭后才能对数据库进行一致的备份，并且这是在<code class="codeph">NOARCHIVELOG</code>模式下运行的数据库的唯一有效备份选项。其他备份选项需要介质恢复才能保持一致性，这在不应用归档重做日志文件的情况下是不可能的。
                           </p>
                           <div class="infoboxnote" id="GUID-46F3DC5D-B20D-45DC-9381-D2EA084290C7__GUID-FBC6C8F8-ABDA-4E32-8372-E71D286438C2">
                              <p class="notep1">注意：</p>
                              <p>如果在不应用重做的情况下还原一致的整个数据库备份，则会丢失备份后进行的所有事务。</p>
                           </div>
                           <p>在<a href="glossary.html#GUID-AE098906-D0EA-4E45-B6E6-C5794E460114"><span class="xrefglossterm">不一致的备份中</span></a> ，不保证读/写数据文件和控制文件具有相同的检查点SCN，因此可能会丢失更改。所有在线备份都必然不一致，因为可以在备份时修改数据文件。
                           </p>
                           <p>不一致的备份提供了卓越的可用性，因为您不必关闭数据库来进行完全保护数据库的备份。如果数据库以<code class="codeph">ARCHIVELOG</code>模式运行，并且备份存档的重做日志和数据文件，则不一致的备份可以作为完善的备份和恢复策略的基础。
                           </p>
                           <div class="infoboxnotealso" id="GUID-46F3DC5D-B20D-45DC-9381-D2EA084290C7__GUID-9B63435B-9EC0-4841-A487-C10B0DFCA80E">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p> <span class="q">“ <a href="oracle-database-instance.html#GUID-CD115A39-2FAE-4B94-BB3E-59818AD42803" title="具有SYSDBA或SYSOPER权限的数据库管理员可以使用SQL * Plus SHUTDOWN命令或企业管理器关闭数据库。SHUTDOWN命令具有确定关闭行为的选项。">关机模式</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=BRADV89479" target="_blank"><span><cite>“Oracle数据库备份和恢复用户指南”</cite></span></a>了解有关不一致备份的更多信息</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div><a id="CNCPT1430"></a><div class="props_rev_3"><a id="GUID-007F0035-B75A-4E9F-B547-60F73AC22901" name="GUID-007F0035-B75A-4E9F-B547-60F73AC22901"></a><h6 id="CNCPT-GUID-007F0035-B75A-4E9F-B547-60F73AC22901" class="sect6">备份集和映像副本</h6>
                        <div>
                           <p>RMAN <code class="codeph">BACKUP</code>命令生成映像副本或备份集。
                           </p>
                           <p>备份类型的不同之处如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>图像复制</p>
                                 <p><a href="glossary.html#GUID-5F0E0899-96CD-40CC-872A-B07919D519D4"><span class="xrefglossterm">映像副本</span></a>是数据文件，控制文件或归档重做日志文件的逐位磁盘副本。您可以使用操作系统实用程序或RMAN创建物理文件的映像副本，并使用任一工具还原它们。
                                 </p>
                                 <div class="infoboxnote" id="GUID-007F0035-B75A-4E9F-B547-60F73AC22901__GUID-8F5C8AF6-2DCE-40C9-A691-28DAEA34FCC6">
                                    <p class="notep1">注意：</p>
                                    <p>与操作系统副本不同，RMAN验证文件中的块并将映像副本记录在RMAN存储库中。</p>
                                 </div>
                              </li>
                              <li>
                                 <p>备份集</p>
                                 <p>RMAN还可以以称为<a href="glossary.html#GUID-D2FB70E0-E30F-403F-9742-376C6576DAC3"><span class="xrefglossterm">备份集</span></a>的专有格式创建备份。备份集包含来自一个或多个数据文件，归档重做日志文件或控制文件或服务器参数文件的数据。备份集的最小单元是称为<a href="glossary.html#GUID-E12020FC-321F-4D7E-A821-487EE833143E"><span class="xrefglossterm">备份片</span></a>的二进制文件。备份集是RMAN可以将备份写入顺序设备（如磁带驱动器）的唯一形式。
                                 </p>
                                 <p>备份集使磁带设备能够持续流式传输。例如，RMAN可以将慢速，中速和快速磁盘中的块混合到一个备份集中，以便磁带设备具有恒定的块输入。映像副本对磁盘很有用，因为您可以逐步更新它们，并在适当的位置恢复它们。</p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-007F0035-B75A-4E9F-B547-60F73AC22901__GUID-D411DB8C-3179-46A0-8D88-10BDB2DBBE6F">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../bradv/rman-backup-concepts.html#BRADV002" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南</span></a> ，了解有关备份集和映像副本的更多信息</p>
                           </div>
                        </div>
                     </div>
                  </div><a id="CNCPT1437"></a><div class="props_rev_3"><a id="GUID-BCE6455B-0E49-4835-B9AB-2BC70F673F88" name="GUID-BCE6455B-0E49-4835-B9AB-2BC70F673F88"></a><h5 id="CNCPT-GUID-BCE6455B-0E49-4835-B9AB-2BC70F673F88" class="sect5">数据修复</h5>
                     <div>
                        <p>虽然有几个问题可以阻止数据库的正常运行或影响I / O操作，但只有一些问题需要DBA干预和数据修复。</p>
                        <p>在以下情况下通常需要进行数据修复：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>媒体失败</p>
                              <p>当数据库外部的问题阻止其读取或写入文件时，会发生介质故障。典型的介质故障包括物理故障，例如磁盘头崩溃，以及数据库文件的覆盖，删除或损坏。媒体故障不如用户或应用程序错误常见，但必须采用合理的备份和恢复策略。</p>
                           </li>
                           <li>
                              <p>用户错误</p>
                              <p>用户或应用程序可能会对数据库进行不必要的更改，例如错误更新，删除表的内容或删除数据库对象。良好的备份和恢复策略使您可以将数据库返回到所需的状态，对数据库可用性的影响最小，并且DBA工作量最小。</p>
                           </li>
                        </ul>
                        <p>通常，您有多种方法可以解决上述问题。本节总结了其中一些解决方案。</p>
                        <div class="infoboxnotealso" id="GUID-BCE6455B-0E49-4835-B9AB-2BC70F673F88__GUID-9486C87A-3144-4849-8055-ACFA06194F3C">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="topics-for-database-administrators-and-developers.html#GUID-088B804A-DF09-475F-B168-961E16708DDA" title="当提交无意或恶意操作导致数据库中的数据逻辑损坏或无法使用时，会发生人为错误中断。根据受影响数据的数量和关键性质，人为错误中断的服务级别影响可能会有很大差异。">人为错误</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../bradv/rman-data-repair-concepts.html#BRADV89703" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南，</cite></span></a>用于数据修复概念</p>
                              </li>
                           </ul>
                        </div>
                     </div><a id="CNCPT1439"></a><div class="props_rev_3"><a id="GUID-7E5A9B5A-0C0A-4DBB-8B30-D6AFC5F2FF64" name="GUID-7E5A9B5A-0C0A-4DBB-8B30-D6AFC5F2FF64"></a><h6 id="CNCPT-GUID-7E5A9B5A-0C0A-4DBB-8B30-D6AFC5F2FF64" class="sect6">Oracle闪回技术</h6>
                        <div>
                           <p>Oracle数据库提供了一组称为<span class="bold">Oracle闪回技术的功能</span> ，支持查看过去的数据状态，及时来回缠绕数据，而无需恢复备份。
                           </p>
                           <p>根据数据库更改，闪回功能通常可以更快地逆转不需要的更改，并且对可用性的影响小于介质恢复。以下闪回功能与备份和恢复最相关：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>闪回数据库</p>
                                 <p>在非CDB中，您可以将Oracle数据库倒回到上一次，以纠正由逻辑数据损坏或用户错误导致的问题。闪回数据库还可用于补充Data Guard，Data Recovery Advisor以及同步克隆数据库。闪回数据库不会还原或执行文件的介质恢复，因此您无法使用它来纠正磁盘崩溃等介质故障。</p>
                              </li>
                              <li>
                                 <p>闪回PDB</p>
                                 <p>在多租户容器数据库（CDB）中，您可以回滚可插拔数据库（PDB）而不影响其他PDB。您还可以创建<a href="glossary.html#GUID-D756A71D-5645-45AD-AC2E-5925E908F73C"><span class="xrefglossterm">PDB还原点</span></a> ，并将PDB回滚到此还原点，而不会影响其他PDB。</p>
                              </li>
                              <li>
                                 <p>闪回表</p>
                                 <p>您可以使用单个SQL语句将表回滚到指定的时间点。您可以在数据库联机时还原表数据以及关联的索引，触发器和约束，从而撤消对指定表的更改。闪回表不解决物理损坏，例如坏磁盘或数据段和索引不一致。</p>
                              </li>
                              <li>
                                 <p>闪回掉落</p>
                                 <p>您可以反转<code class="codeph">DROP TABLE</code>操作的效果。闪回丢弃比恢复机制（如时间点恢复）快得多，并且不会导致最近的事务或停机时间丢失。
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-7E5A9B5A-0C0A-4DBB-8B30-D6AFC5F2FF64__GUID-9F1DA378-98E8-445F-BF02-8A5C62FEF24C">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="../bradv/introduction-backup-recovery.html#BRADV89342" target="_blank"><span><cite>“Oracle数据库备份和恢复用户指南”</cite></span></a>了解有关闪回功能的更多信息</p>
                                 </li>
                                 <li>
                                    <p><a href="../sqlrf/FLASHBACK-DATABASE.html#SQLRF01801" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a>和<a href="../rcmrf/FLASHBACK-DATABASE.html#RCMRF194" target="_blank"><span class="italic">Oracle数据库备份和恢复参考，</span></a>以了解<code class="codeph">FLASHBACK DATABASE</code>语句</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div><a id="CNCPT1438"></a><div class="props_rev_3"><a id="GUID-2D8A4B90-A204-41F3-BE26-974FBD7C8DFA" name="GUID-2D8A4B90-A204-41F3-BE26-974FBD7C8DFA"></a><h6 id="CNCPT-GUID-2D8A4B90-A204-41F3-BE26-974FBD7C8DFA" class="sect6">数据恢复顾问</h6>
                        <div>
                           <p>使用Data Recovery Advisor诊断数据故障，为您的环境提供最佳修复选项，以及执行和验证修复。</p>
                           <p><a href="glossary.html#GUID-0B1CA606-6DB8-434B-898D-B449AD9993CE"><span class="xrefglossterm">Data Recovery Advisor</span></a>工具可自动诊断持久性数据故障，提供适当的修复选项，并根据用户的请求执行修复。通过提供用于自动数据修复的集中式工具，Data Recovery Advisor可提高Oracle数据库的可管理性和可靠性，从而有助于缩短恢复时间。
                           </p>
                           <p>该数据库包括用于运行检查的Health Monitor框架。<span class="italic">检查器</span>是在Health Monitor中注册的操作或过程，用于评估数据库或其组件的运行状况。健康评估称为<span class="italic">数据完整性检查</span> ，可以被动地或主动地调用。
                           </p>
                           <p>失败是数据完整性检查检测到的持久性数据损坏。通常会被动地检测到故障。涉及数据损坏的数据库操作会导致错误，该错误会自动调用数据完整性检查，以检查数据库中与错误相关的故障。如果诊断出故障，则数据库将它们记录在自动存储库（ADR）中。</p>
                           <p>在数据库检测到故障并存储在ADR中后，Data Recovery Advisor会自动确定最佳修复选项及其对数据库的影响。通常，Data Recovery Advisor会为每个故障或一组故障生成手动和自动修复选项。</p>
                           <p>在提供自动修复选项之前，Data Recovery Advisor会针对特定环境以及完成建议修复所需的介质组件的可用性对其进行验证。如果选择自动修复，则Oracle Database会为您执行此操作。Data Recovery Advisor验证修复成功并关闭相应的故障。</p>
                           <div class="infoboxnotealso" id="GUID-2D8A4B90-A204-41F3-BE26-974FBD7C8DFA__GUID-607B37B3-8A95-484C-9BAC-3A2941DF9D4D">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../bradv/diagnosing-repairing-failures-dra.html#BRADV246" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a> ，了解如何使用Data Recovery Advisor</p>
                           </div>
                        </div>
                     </div><a id="CNCPT1445"></a><div class="props_rev_3"><a id="GUID-77CE5C26-00F1-486F-AE6D-7D3FA206438D" name="GUID-77CE5C26-00F1-486F-AE6D-7D3FA206438D"></a><h6 id="CNCPT-GUID-77CE5C26-00F1-486F-AE6D-7D3FA206438D" class="sect6">阻止媒体恢复</h6>
                        <div>
                           <p>阻止介质恢复是一种在数据文件联机时恢复和恢复损坏的数据块的技术。</p>
                           <p><a href="glossary.html#GUID-5E547C75-9814-499E-AF42-69950EE331C1"><span class="xrefglossterm">块损坏</span></a>是一种数据块，它不是可识别的Oracle格式，或者其内容不是内部一致的。如果检测到块损坏，并且只有少数块损坏，则块恢复可能比数据文件恢复更可取。
                           </p>
                           <div class="infoboxnotealso" id="GUID-77CE5C26-00F1-486F-AE6D-7D3FA206438D__GUID-BA4300D7-042F-4E38-92E3-30B1B73726A1">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="topics-for-database-administrators-and-developers.html#GUID-CEA4D714-A143-4F9F-8EED-EE5A6B29B3C3" title="当硬件，软件或网络组件导致读取或写入损坏的数据时，会发生数据损坏。">数据腐败</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=BRADV89781" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a> ，了解如何执行块介质恢复</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div><a id="CNCPT88772"></a><div class="props_rev_3"><a id="GUID-7F5703F9-CAE5-4736-895B-B45A51974A7C" name="GUID-7F5703F9-CAE5-4736-895B-B45A51974A7C"></a><h6 id="CNCPT-GUID-7F5703F9-CAE5-4736-895B-B45A51974A7C" class="sect6">数据文件恢复</h6>
                        <div>
                           <p>数据文件恢复修复丢失或损坏的当前数据文件或控制文件。它还可以恢复在没有<code class="codeph">OFFLINE</code> <code class="codeph">NORMAL</code>选项的情况下表空间脱机时丢失的更改。
                           </p>
                           <p>如果在没有<code class="codeph">OFFLINE</code> <code class="codeph">NORMAL</code>选项的情况下还原数据文件或控制文件的备份或数据文件脱机，则必须进行介质恢复。如果在线数据文件需要介质恢复，则无法打开数据库，在介质恢复完成之前，也无法将需要介质恢复的数据文件联机。
                           </p>
                           <p>要还原数据文件或控制文件的物理备份，请重新构建它并使其可供Oracle数据库使用。恢复备份是应用归档重做日志文件来重建丢失的更改。RMAN还可以使用增量备份恢复数据文件，增量备份仅包含先前备份后修改的数据块。</p>
                           <p>与自动将更改自动应用于联机文件的实例恢复不同，用户必须调用介质恢复，并将归档的重做日志文件应用于已还原的备份。数据文件介质恢复只能对未由任何数据库实例打开的数据库中的脱机数据文件或数据文件进行操作。</p>
                           <p>数据文件介质恢复因所有更改是否应用而异：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>完全恢复</p>
                                 <p>完全恢复将归档和联机重做日志中包含的<span class="italic">所有</span>重做更改应用于备份。通常，在介质故障损坏数据文件或控制文件后执行完整的介质恢复。您可以对数据库，表空间或数据文件执行完全恢复。
                                 </p>
                              </li>
                              <li>
                                 <p>恢复不完全</p>
                                 <p>不完整的恢复（也称为<a href="glossary.html#GUID-576051B8-32B4-4FE8-9485-50109C6D4BC8"><span class="xrefglossterm">数据库时间点恢复</span></a> ）会导致数据库的非当前版本。在这种情况下，您不应用还原备份后生成的所有重做。通常，您执行时间点数据库恢复以在无法使用Oracle闪回数据库时撤消用户错误。
                                 </p>
                                 <p>要执行不完全恢复，必须从要恢复的时间之前创建的备份中还原所有数据文件，然后在恢复完成时使用<code class="codeph">RESETLOGS</code>选项打开数据库。重置日志会创建一个以日志序列1开头的新日志序列号流。
                                 </p>
                                 <div class="infoboxnote" id="GUID-7F5703F9-CAE5-4736-895B-B45A51974A7C__GUID-E599B8FB-2563-46F1-A58A-0454AFB76432">
                                    <p class="notep1">注意：</p>
                                    <p>如果当前数据文件可用，则闪回数据库是DBPITR的替代方案。</p>
                                 </div>
                                 <p>表空间时间点恢复（TSPITR）功能允许您将一个或多个表空间恢复到比数据库其余部分更早的时间点。</p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-7F5703F9-CAE5-4736-895B-B45A51974A7C__GUID-DC35D0D1-C575-4EF3-BB8A-3E6FC970F16C">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="oracle-database-instance.html#GUID-728C6BE1-5687-4DC5-B570-D2042C88F935" title="实例恢复是将联机重做日志中的记录应用于数据文件以重建最近检查点之后所做更改的过程。">实例恢复概述</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p>用于介质恢复概念的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=BRADV117" target="_blank"><span><cite>Oracle数据库备份和恢复用户指南</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                  </div><a id="CNCPT94786"></a><div class="props_rev_3"><a id="GUID-89C1FA97-474D-412E-905E-59D08E26BBBF" name="GUID-89C1FA97-474D-412E-905E-59D08E26BBBF"></a><h5 id="CNCPT-GUID-89C1FA97-474D-412E-905E-59D08E26BBBF" class="sect5">零数据丢失恢复设备</h5>
                     <div>
                        <p>云规模的零数据丢失恢复设备（通常称为<span class="bold">恢复设备</span> ）是一个工程化系统，可显着减少企业中所有Oracle数据库的数据丢失和备份开销。
                        </p>
                        <p>通过与RMAN集成，Recovery Appliance使用云规模，容错硬件和存储为大量数据库部署集中式备份和恢复策略。恢复设备持续验证备份的可恢复性。</p>
                     </div><a id="CNCPT94787"></a><div class="props_rev_3"><a id="GUID-72541B62-7AF4-4D5F-AC82-BAB036F83BCC" name="GUID-72541B62-7AF4-4D5F-AC82-BAB036F83BCC"></a><h6 id="CNCPT-GUID-72541B62-7AF4-4D5F-AC82-BAB036F83BCC" class="sect6">恢复设备的好处</h6>
                        <div>
                           <p>集中式恢复设备可执行大多数数据库备份和还原处理，从而提高备份的存储利用率，性能和可管理性。</p>
                           <p>主要好处如下：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>消除数据丢失</p>
                                 <p>恢复设备使用以下技术消除了数据中心大多数数据库所经历的数据丢失风险：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>重做的连续传输从受保护数据库的SGA更改为恢复设备，称为<a href="glossary.html#GUID-E2E4CEC0-AFE0-457D-9560-6E6F39C4DC38"><span class="xrefglossterm">实时重做传输</span></a></p>
                                    </li>
                                    <li>
                                       <p>复制到远程恢复设备</p>
                                    </li>
                                    <li>
                                       <p>由集中式恢复设备进行的自动磁带备份</p>
                                    </li>
                                    <li>
                                       <p>端到端数据库块验证</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>最小的备份开销</p>
                                 <p>通过将工作卸载到恢复设备来最小化数据库服务器上的备份开销，恢复设备管理统一磁盘池中多个数据库的备份。RMAN <a href="glossary.html#GUID-EF38C61D-5301-4C79-81DC-129F6FC5BF08"><span class="xrefglossterm">增量永久备份策略</span></a>涉及将初始0级备份带到恢复设备，所有后续增量备份都在1级。恢复设备通过将级别0与级别1备份组合来创建<a href="glossary.html#GUID-8804188E-EEFF-44EC-9E5F-8A6A8295A150"><span class="xrefglossterm">虚拟完全</span></a>备份。恢复设备在块级别不断压缩，重复数据删除和验证备份。
                                 </p>
                              </li>
                              <li>
                                 <p>改进了端到端数据保护可见性</p>
                                 <p>Cloud Control提供从恢复设备管理的备份生命周期的完整端到端视图，从启动RMAN备份到将其存储在磁盘，磁带或复制到下游恢复设备时。安装Zero Data Loss Recovery Appliance企业管理器插件（Recovery Appliance插件）可实现监控和管理。</p>
                              </li>
                              <li>
                                 <p>云级保护</p>
                                 <p>Recovery Appliance可扩展以支持数十到数百或数千个数据库。该架构的关键组件如下：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>恢复设备通过<a href="glossary.html#GUID-C0444C9D-9420-4933-8947-974573A09BEE"><span class="xrefglossterm">保护策略</span></a>简化管理，该<a href="glossary.html#GUID-C0444C9D-9420-4933-8947-974573A09BEE"><span class="xrefglossterm">策略</span></a>定义了为与策略关联的每个数据库强制执行的<a href="glossary.html#GUID-F4D0DF97-755D-44D8-BB30-2C998FAF5D08"><span class="xrefglossterm">恢复窗口目标</span></a> 。保护策略通过将数据库分组为具有共享特征的层来提高可管理性。
                                       </p>
                                    </li>
                                    <li>
                                       <p>使用保护策略，恢复设备根据每个受保护数据库的恢复窗口目标管理备份存储空间。这种精细的，面向数据库的空间管理方法消除了在存储卷级别管理空间的需要，就像第三方设备那样。</p>
                                    </li>
                                    <li>
                                       <p>通过以简单，模块化的方式添加计算和存储资源，Recovery Appliance可以扩展以适应备份流量，存储使用和数据库数量的增加。</p>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                        </div>
                     </div><a id="CNCPT94789"></a><a id="CNCPT94788"></a><div class="props_rev_3"><a id="GUID-66D62E1A-5613-454D-AEB6-1127A37E4F9B" name="GUID-66D62E1A-5613-454D-AEB6-1127A37E4F9B"></a><h6 id="CNCPT-GUID-66D62E1A-5613-454D-AEB6-1127A37E4F9B" class="sect6">恢复设备环境</h6>
                        <div>
                           <p><span class="bold">受保护的数据库</span>是将数据备份到恢复设备的客户端数据库。
                           </p>
                           <p>下图显示了一个示例环境，其中包括六个受保护的数据库和两个恢复设备。每个数据库都使用零数据丢失恢复设备备份模块（ <a href="glossary.html#GUID-44120A0C-8834-4DF0-BF06-B9BDA797C44D"><span class="xrefglossterm">恢复设备备份模块</span></a> ）进行备份。此模块是Oracle提供的SBT库，RMAN使用该库将备份通过网络传输到恢复设备。
                           </p>
                           <div class="figure" id="GUID-66D62E1A-5613-454D-AEB6-1127A37E4F9B__BGBEHEIA">
                              <p class="titleinfigure">图18-4恢复设备环境</p><img src="img/amagd_vm_025.png" alt="下面是图18-4的描述" title="下面是图18-4的描述" longdesc="img_text/amagd_vm_025.html"><br><a href="img_text/amagd_vm_025.html">“图18-4恢复设备环境”的说明</a></div>
                           <!-- class="figure" -->
                           <p>驻留在每个恢复设备上的<a href="glossary.html#GUID-5344CAFE-B53D-4C47-B07D-ABBC56E1E8EE"><span class="xrefglossterm">恢复设备元数据数据库</span></a>管理存储在恢复目录中的元数据。将备份发送到恢复设备的所有受保护数据库都必须使用此恢复目录。备份位于<a href="glossary.html#GUID-E2C49C85-3CEF-4245-A70C-631B4F192763"><span class="xrefglossterm">恢复设备存储位置</span></a> ，该<a href="glossary.html#GUID-E2C49C85-3CEF-4245-A70C-631B4F192763"><span class="xrefglossterm">位置</span></a>是一组Oracle ASM磁盘组。
                           </p>
                           <div class="infoboxnote" id="GUID-66D62E1A-5613-454D-AEB6-1127A37E4F9B__GUID-87455C90-1A88-4112-85BD-4DAC5C64F65F">
                              <p class="notep1">注意：</p>
                              <p>数据库可能使用Recovery Appliance作为其恢复目录，而不将其用作备份存储库。</p>
                           </div>
                           <p>管理员使用Cloud Control来管理和监控环境。无论备份驻留在磁盘，磁带还是其他恢复设备上，云控制都会为每个数据库提供整个备份生命周期的“单一窗格”视图。</p>
                           <div class="infoboxnotealso" id="GUID-66D62E1A-5613-454D-AEB6-1127A37E4F9B__GUID-E40C5E88-3732-40BA-82F6-57830E72D456">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=AMAGD107" target="_blank"><span><cite>零数据丢失恢复设备管理员指南</cite></span></a> ，全面介绍产品</p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT89115"></a><a id="CNCPT1244"></a><div class="props_rev_3"><a id="GUID-D39DB708-CC94-4EE6-ACDA-ACED36DA4DA5" name="GUID-D39DB708-CC94-4EE6-ACDA-ACED36DA4DA5"></a><h4 id="CNCPT-GUID-D39DB708-CC94-4EE6-ACDA-ACED36DA4DA5" class="sect4">内存管理</h4>
                  <div>
                     <p>内存管理涉及在数据库更改需求时保持Oracle实例内存结构的最佳大小。初始化参数设置确定如何管理SGA和实例PGA内存。</p>
                     <p><a href="concepts-for-database-administrators.html#GUID-D39DB708-CC94-4EE6-ACDA-ACED36DA4DA5__BGBEJAJI">图18-5</a>显示了内存管理选项的决策树。以下部分详细说明了这些选项。
                     </p>
                     <div class="figure" id="GUID-D39DB708-CC94-4EE6-ACDA-ACED36DA4DA5__BGBEJAJI">
                        <p class="titleinfigure">图18-5内存管理方法</p><img src="img/cncpt242.gif" alt="下面是图18-5的描述" title="下面是图18-5的描述" longdesc="img_text/cncpt242.html"><br><a href="img_text/cncpt242.html">“图18-5内存管理方法”的说明</a></div>
                     <!-- class="figure" -->
                     <div class="infoboxnotealso" id="GUID-D39DB708-CC94-4EE6-ACDA-ACED36DA4DA5__GUID-FC1E6CE4-F45D-4C3D-997B-B2CB85C12452">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="memory-architecture.html#GUID-913335DF-050A-479A-A653-68A064DCCA41" title="本章讨论数据库实例的内存体系结构。">内存架构</a> ”</span>了解有关SGA和PGA的更多信息</p>
                     </div>
                  </div><a id="CNCPT89116"></a><a id="CNCPT837"></a><div class="props_rev_3"><a id="GUID-C7AFB6E3-195E-4269-A871-D514CD9A84BE" name="GUID-C7AFB6E3-195E-4269-A871-D514CD9A84BE"></a><h5 id="CNCPT-GUID-C7AFB6E3-195E-4269-A871-D514CD9A84BE" class="sect5">自动内存管理</h5>
                     <div>
                        <p>在<span class="bold">自动内存管理中</span> ，Oracle数据库完全自动管理SGA和实例PGA内存。此方法最简单，Oracle强烈建议使用此方法。
                        </p>
                        <p>唯一的用户指定控件是目标内存大小初始化参数（ <code class="codeph">MEMORY_TARGET</code> ）和可选的最大内存大小初始化参数（ <code class="codeph">MEMORY_MAX_TARGET</code> ）。Oracle数据库调整到目标内存大小，根据需要在SGA和实例PGA之间重新分配内存。</p>
                        <p>SGA可以包含<a href="glossary.html#GUID-A19D33EA-7BAA-42C0-9E13-6AF686E2A976"><span class="xrefglossterm">内存中列存储</span></a> （IM列存储）或<a href="glossary.html#GUID-BE14DEE8-A53C-4B30-96FE-41079CF056C8"><span class="xrefglossterm">memoptimize池</span></a> ，两者都是可选的。无论使用哪种内存管理方法，使用<code class="codeph">INMEMORY_SIZE</code>初始化参数调整IM列存储的大小，使用<code class="codeph">INMEMORY_SIZE</code>初始化参数调整memoptimize池的<code class="codeph">MEMOPTIMIZE_POOL_SIZE</code> 。IM列存储大小memoptimize池包含在内存目标中，但不受自动调整大小算法的管理。例如，如果将<code class="codeph">MEMORY_TARGET</code>设置为5 GB并将<code class="codeph">INMEMORY_SIZE</code>为1 GB，则总内存目标为5 GB（不是6 GB）， <code class="codeph">INMEMORY_SIZE</code>始终为1 GB。</p>
                        <p>下图显示了有时处理在线用户提交的作业以及有时批处理作业的数据库。使用自动内存管理，数据库会根据正在运行的作业类型自动调整<a href="glossary.html#GUID-D9A10657-F0EF-4D84-AB58-852CD58BF0B4"><span class="xrefglossterm">大型池</span></a>和<a href="glossary.html#GUID-7913177D-8183-4CC5-8F59-816FE66DA363"><span class="xrefglossterm">数据库缓冲区高速缓存</span></a>的大小。请注意，图形不描绘IM列存储或memoptimize区域。
                        </p>
                        <div class="figure" id="GUID-C7AFB6E3-195E-4269-A871-D514CD9A84BE__CHDDIDHC">
                           <p class="titleinfigure">图18-6自动内存管理</p><img src="img/cncpt256.gif" alt="下面是图18-6的描述" title="下面是图18-6的描述" longdesc="img_text/cncpt256.html"><br><a href="img_text/cncpt256.html">“图18-6自动内存管理”的说明</a></div>
                        <!-- class="figure" -->
                        <p>如果使用DBCA创建数据库并选择基本安装选项，则Oracle Database默认启用自动内存管理。</p>
                        <div class="infoboxnotealso" id="GUID-C7AFB6E3-195E-4269-A871-D514CD9A84BE__GUID-587B320C-98CC-40CC-A3DC-43B3949F564E">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="memory-architecture.html#GUID-80C1C6A3-3E48-4868-ACA1-370C4D341209" title="内存区域是一个可选的SGA组件，包含内存中列存储（IM列存储）。">内存区</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="memory-architecture.html#GUID-D58DC90F-0ABB-4B1E-96C1-6094A04A5E12" title="memoptimize池存储指定为MEMOPTIMIZE FOR READ的堆组织表的缓冲区和相关结构。">Memoptimize Pool</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=ADMIN11199" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解自动内存管理</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT838"></a><div class="props_rev_3"><a id="GUID-22B45512-2878-4CF7-B1C5-F96F11A27AF8" name="GUID-22B45512-2878-4CF7-B1C5-F96F11A27AF8"></a><h5 id="CNCPT-GUID-22B45512-2878-4CF7-B1C5-F96F11A27AF8" class="sect5">SGA的共享内存管理</h5>
                     <div>
                        <p>您可以通过使用自动共享内存管理设置SGA大小或手动调整SGA组件来手动控制SGA的大小。</p>
                        <p>如果未启用自动内存管理，则系统必须使用SGA的共享内存管理。可以使用以下任一形式进行共享内存管理：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>自动共享内存管理</p>
                              <p>此模式使您可以更直接地控制SGA的大小，并且在禁用自动内存管理时是默认设置。数据库将总SGA调整为目标大小，并动态调整SGA组件的大小。如果您使用的是服务器参数文件，则Oracle数据库会记住跨数据库实例关闭的自动调整组件的大小。</p>
                           </li>
                           <li>
                              <p>手动共享内存管理</p>
                              <p>在此模式下，您可以设置多个单独SGA组件的大小，并持续手动调整各个SGA组件。您可以完全控制各个SGA组件尺寸。禁用自动内存管理和自动共享内存管理时，数据库默认为此模式。</p>
                              <div class="infoboxnote" id="GUID-22B45512-2878-4CF7-B1C5-F96F11A27AF8__GUID-3949C9BF-F76A-4598-B826-0737C560AF60">
                                 <p class="notep1">注意：</p>
                                 <p>禁用自动内存管理后，在某些情况下，数据库可以根据用户工作负载自动调整共享池和缓冲区高速缓存的相对大小。</p>
                              </div>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-22B45512-2878-4CF7-B1C5-F96F11A27AF8__GUID-8E34A4EA-D536-4F47-870C-4899B6D86017">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=ADMIN11203" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解共享内存管理</p>
                              </li>
                              <li>
                                 <p>我的Oracle支持说明1269139.1了解有关手动模式下自动调整大小的更多信息：</p>
                                 <p><a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1269139.1" target="_blank"><code class="codeph">https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1269139.1</code></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT839"></a><div class="props_rev_3"><a id="GUID-E4B4F2E4-E83A-4869-8FA6-171AD52B7924" name="GUID-E4B4F2E4-E83A-4869-8FA6-171AD52B7924"></a><h5 id="CNCPT-GUID-E4B4F2E4-E83A-4869-8FA6-171AD52B7924" class="sect5">实例PGA的内存管理</h5>
                     <div>
                        <p>如果未启用自动内存管理，则Oracle数据库使用自动或手动PGA内存管理。</p>
                        <p>以下模式可用于管理PGA内存：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>自动PGA内存管理</p>
                              <p>禁用自动内存管理（ <code class="codeph">MEMORY_TARGET</code> ）并将<code class="codeph">PGA_AGGREGATE_TARGET</code>设置为非零值时，数据库将使用自动PGA内存管理。在此模式下， <code class="codeph">PGA_AGGREGATE_TARGET</code>为实例PGA指定“软”目标大小。目标是软的，因为它仅适用于可以选择使用临时空间而不是PGA的特定类型的内存分配。数据库将实例PGA的大小调整到该目标，并动态调整各个PGA的大小。如果未明确设置目标大小，则数据库会自动配置合理的默认值。
                              </p>
                              <p><code class="codeph">PGA_AGGREGATE_LIMIT</code>初始化参数动态设置PGA内存的实例范围硬限制。由于参数响应于更改内存条件，因此您无需显式设置参数值。默认情况下， <code class="codeph">PGA_AGGREGATE_LIMIT</code>设置为以下中的较大者：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>2 GB</p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">PGA_AGGREGATE_TARGET</code>初始化参数设置的200％</p>
                                 </li>
                                 <li>
                                    <p>（ <code class="codeph">PROCESSES</code>初始化参数设置的值）* 3 MB</p>
                                 </li>
                              </ul>
                              <p>后台进程定期将PGA大小与<code class="codeph">PGA_AGGREGATE_LIMIT</code>设置的限制进行比较。如果达到或超过限制，则此过程终止使用最不可控制的PGA内存的会话调用。如果这些会话仍然没有释放足够的内存，那么它们也会被终止。
                              </p>
                           </li>
                           <li>
                              <p>手动PGA内存管理</p>
                              <p>禁用自动内存管理且<code class="codeph">PGA_AGGREGATE_TARGET</code>设置为<code class="codeph">0</code> ，数据库默认为手动PGA管理。以前版本的Oracle数据库要求DBA手动为每种类型的SQL <a href="glossary.html#GUID-4BC5B7D2-6483-4742-AD66-E0B7C39047E3"><span class="xrefglossterm">运算符</span></a>指定最大工作区大小（例如排序或<a href="glossary.html#GUID-D2587A67-E1CB-4F35-8830-4599717C47BC"><span class="xrefglossterm">散列连接</span></a> ）。事实证明这种技术非常困难，因为工作量总是在变化。虽然Oracle数据库支持手动PGA内存管理方法，但Oracle强烈建议自动内存管理。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-E4B4F2E4-E83A-4869-8FA6-171AD52B7924__GUID-7C987DE6-F27B-4534-8E5D-480A20BFED28">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=TGDBA346" target="_blank"><span class="italic">Oracle数据库性能调优指南</span></a> ，了解PGA内存管理</p>
                        </div>
                     </div>
                  </div><a id="CNCPT89117"></a><a id="CNCPT840"></a><div class="props_rev_3"><a id="GUID-17DC29B0-9741-4B80-8091-D9E1A886B357" name="GUID-17DC29B0-9741-4B80-8091-D9E1A886B357"></a><h5 id="CNCPT-GUID-17DC29B0-9741-4B80-8091-D9E1A886B357" class="sect5">内存管理方法综述</h5>
                     <div>
                        <p>内存管理是自动或手动的。</p>
                        <p>如果未启用自动内存管理，则必须为SGA单独配置一种内存管理方法，为PGA单独配置一种内存管理方法。</p>
                        <div class="infoboxnote" id="GUID-17DC29B0-9741-4B80-8091-D9E1A886B357__GUID-DB1B08EF-9B7F-4B7B-A610-0AA209E22AE6">
                           <p class="notep1">注意：</p>
                           <p>当对整个数据库实例禁用自动内存管理时，Oracle数据库默认启用自动PGA内存管理。</p>
                        </div>
                        <p>下表包括<code class="codeph">INMEMORY_SIZE</code>初始化参数和<code class="codeph">MEMOPTIMIZE_POOL_SIZE</code>初始化参数。两个控制存储区都是可选的。
                        </p>
                        <div class="tblformalwide" id="GUID-17DC29B0-9741-4B80-8091-D9E1A886B357__BGBDACCH">
                           <p class="titleintable">表18-3内存管理方法</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="内存管理方法" width="100%" border="1" summary="This table shows memory management methods fir the SGA and the PGA, and the initialization parameters you must set. ." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="10%" id="d92580e11137">例</th>
                                    <th align="left" valign="bottom" width="9%" id="d92580e11140">SGA</th>
                                    <th align="left" valign="bottom" width="10%" id="d92580e11143">PGA</th>
                                    <th align="left" valign="bottom" width="26%" id="d92580e11146">描述</th>
                                    <th align="left" valign="bottom" width="45%" id="d92580e11149">初始化参数</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d92580e11154" headers="d92580e11137 ">
                                       <p>汽车</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d92580e11154 d92580e11140 ">
                                       <p>N / A</p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d92580e11154 d92580e11143 ">
                                       <p>N / A</p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d92580e11154 d92580e11146 ">
                                       <p>数据库根据单个实例目标大小调整实例的大小。</p>
                                    </td>
                                    <td align="left" valign="top" width="45%" headers="d92580e11154 d92580e11149 ">
                                       <p>你设置：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>数据库实例的总内存目标大小（ <code class="codeph">MEMORY_TARGET</code> ）</p>
                                          </li>
                                          <li>
                                             <p>数据库实例的可选最大内存大小（ <code class="codeph">MEMORY_MAX_TARGET</code> ）</p>
                                          </li>
                                          <li>
                                             <p>SGA中IM列存储（ <code class="codeph">INMEMORY_SIZE</code> ）的可选大小</p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d92580e11189" headers="d92580e11137 ">
                                       <p>N / A</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d92580e11189 d92580e11140 ">
                                       <p>汽车</p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d92580e11189 d92580e11143 ">
                                       <p>汽车</p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d92580e11189 d92580e11146 ">
                                       <p>数据库根据SGA目标自动调整SGA。</p>
                                       <p>数据库根据PGA目标自动调整PGA。</p>
                                    </td>
                                    <td align="left" valign="top" width="45%" headers="d92580e11189 d92580e11149 ">
                                       <p>你设置：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>SGA目标尺寸（ <code class="codeph">SGA_TARGET</code> ）</p>
                                          </li>
                                          <li>
                                             <p>可选的SGA最大大小（ <code class="codeph">SGA_MAX_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>SGA中IM列存储（ <code class="codeph">INMEMORY_SIZE</code> ）的可选大小</p>
                                          </li>
                                          <li>
                                             <p>SGA中memoptimize池的可选大小（ <code class="codeph">MEMOPTIMIZE_POOL_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>PGA聚合目标尺寸（ <code class="codeph">PGA_AGGREGATE_TARGET</code> ） <a id="fn_1" name="fn_1" href="#fn_1" the="" database="" automatically="" configures="" pga_aggregate_limit="" initialization="" parameter.="" you="" also="" choose="" to="" set="" this="" parameter="" manually=")" ="" onclick="footdisplay(1, "><sup>脚1</sup></a></p>
                                          </li>
                                       </ul>
                                       <p>数据库自动配置<code class="codeph">PGA_AGGREGATE_LIMIT</code>初始化参数。您可以手动设置此参数。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d92580e11249" headers="d92580e11137 ">
                                       <p>N / A</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d92580e11249 d92580e11140 ">
                                       <p>汽车</p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d92580e11249 d92580e11143 ">
                                       <p>手册</p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d92580e11249 d92580e11146 ">
                                       <p>数据库根据SGA目标自动调整SGA。</p>
                                       <p>您可以手动控制PGA，为每种类型的SQL <a href="glossary.html#GUID-4BC5B7D2-6483-4742-AD66-E0B7C39047E3"><span class="xrefglossterm">运算符</span></a>设置最大工作区大小。
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="45%" headers="d92580e11249 d92580e11149 ">
                                       <p>你设置：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>SGA目标尺寸（ <code class="codeph">SGA_TARGET</code> ）</p>
                                          </li>
                                          <li>
                                             <p>可选的SGA最大大小（ <code class="codeph">SGA_MAX_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>SGA（ <code class="codeph">INMEMORY_SIZE</code> ）中IM列存储的可选大小</p>
                                          </li>
                                          <li>
                                             <p>SGA中memoptimize池的可选大小（ <code class="codeph">MEMOPTIMIZE_POOL_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>PGA工作区参数，例如<code class="codeph">SORT_AREA_SIZE</code> ， <code class="codeph">HASH_AREA_SIZE</code>和<code class="codeph">BITMAP_MERGE_AREA_SIZE</code></p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d92580e11306" headers="d92580e11137 ">
                                       <p>N / A</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d92580e11306 d92580e11140 ">
                                       <p>手册</p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d92580e11306 d92580e11143 ">
                                       <p>汽车</p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d92580e11306 d92580e11146 ">
                                       <p>您可以通过设置单个组件大小来手动控制SGA。</p>
                                       <p>数据库根据PGA目标自动调整PGA。</p>
                                    </td>
                                    <td align="left" valign="top" width="45%" headers="d92580e11306 d92580e11149 ">
                                       <p>你设置：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>共享池大小（ <code class="codeph">SHARED_POOL_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>缓冲区缓存大小（ <code class="codeph">DB_CACHE_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>大池大小（ <code class="codeph">LARGE_POOL_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>Java池大小（ <code class="codeph">JAVA_POOL_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>SGA中IM列存储（ <code class="codeph">INMEMORY_SIZE</code> ）的可选大小</p>
                                          </li>
                                          <li>
                                             <p>SGA中memoptimize池的可选大小（ <code class="codeph">MEMOPTIMIZE_POOL_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>PGA聚合目标尺寸（ <code class="codeph">PGA_AGGREGATE_TARGET</code> ） <a id="fn_2" name="fn_2" href="#fn_2" the="" database="" automatically="" configures="" pga_aggregate_limit="" initialization="" parameter.="" you="" also="" choose="" to="" set="" this="" parameter="" manually=")" ="" onclick="footdisplay(2, "><sup>脚2</sup></a></p>
                                          </li>
                                       </ul>
                                       <p>数据库自动配置<code class="codeph">PGA_AGGREGATE_LIMIT</code>初始化参数。您可以手动设置此参数。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="10%" id="d92580e11378" headers="d92580e11137 ">
                                       <p>N / A</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d92580e11378 d92580e11140 ">
                                       <p>手册</p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d92580e11378 d92580e11143 ">
                                       <p>手册</p>
                                    </td>
                                    <td align="left" valign="top" width="26%" headers="d92580e11378 d92580e11146 ">
                                       <p>您必须手动配置SGA组件大小。</p>
                                       <p>您可以手动控制PGA，为每种类型的SQL运算符设置最大工作区大小。</p>
                                    </td>
                                    <td align="left" valign="top" width="45%" headers="d92580e11378 d92580e11149 ">
                                       <p>您必须手动配置SGA组件大小。你设置：</p>
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>共享池大小（ <code class="codeph">SHARED_POOL_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>缓冲区缓存大小（ <code class="codeph">DB_CACHE_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>大池大小（ <code class="codeph">LARGE_POOL_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>Java池大小（ <code class="codeph">JAVA_POOL_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>SGA中IM列存储（ <code class="codeph">INMEMORY_SIZE</code> ）的可选大小</p>
                                          </li>
                                          <li>
                                             <p>SGA中memoptimize池的可选大小（ <code class="codeph">MEMOPTIMIZE_POOL_SIZE</code> ）</p>
                                          </li>
                                          <li>
                                             <p>PGA工作区参数，例如<code class="codeph">SORT_AREA_SIZE</code> ， <code class="codeph">HASH_AREA_SIZE</code>和<code class="codeph">BITMAP_MERGE_AREA_SIZE</code></p>
                                          </li>
                                       </ul>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p class="tablefootnote"><sup class="tablefootnote">脚注1</sup></p><p>数据库自动配置<code class="codeph">PGA_AGGREGATE_LIMIT</code>初始化参数。您还可以选择手动设置此参数。
                           </p>
                        <p></p>
                        <p class="tablefootnote"><sup class="tablefootnote">脚注2</sup></p><p>数据库自动配置<code class="codeph">PGA_AGGREGATE_LIMIT</code>初始化参数。您还可以选择手动设置此参数。
                           </p>
                        <p></p>
                        <div class="infoboxnotealso" id="GUID-17DC29B0-9741-4B80-8091-D9E1A886B357__GUID-16B51FDA-B3BE-41B7-9BB3-9546CD97E525">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=ADMIN11236" target="_blank"><span><cite>Oracle数据库管理员指南，</cite></span></a>因为并非所有平台都提供自动内存管理</p>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT860"></a><div class="props_rev_3"><a id="GUID-EB2AB7CA-8F3A-4A2B-AA0A-8E9D138D8B75" name="GUID-EB2AB7CA-8F3A-4A2B-AA0A-8E9D138D8B75"></a><h4 id="CNCPT-GUID-EB2AB7CA-8F3A-4A2B-AA0A-8E9D138D8B75" class="sect4">资源管理和任务调度</h4>
                  <div>
                     <p>Oracle数据库提供了一些工具来帮助您管理资源，并提供计划任务以减少对用户的影响。</p>
                     <p>在具有许多活动用户的数据库中，资源管理是数据库管理的重要部分。消耗过多资源的会话可能会阻止其他会话执行其工作。一个相关的问题是如何安排任务以便它们在最佳时间运行。Oracle数据库提供了帮助解决这些问题的工具。</p>
                  </div><a id="CNCPT89118"></a><a id="CNCPT1396"></a><div class="props_rev_3"><a id="GUID-308CCFA9-830F-442B-BA81-F03B9B6BCE49" name="GUID-308CCFA9-830F-442B-BA81-F03B9B6BCE49"></a><h5 id="CNCPT-GUID-308CCFA9-830F-442B-BA81-F03B9B6BCE49" class="sect5">数据库资源管理器</h5>
                     <div>
                        <p>Oracle数据库资源管理器（资源管理器）提供对分配给用户帐户，应用程序和服务的数据库资源的精细控制。资源管理器主要用作网守，减慢一些作业运行缓慢，以便其他人可以快速运行。</p>
                        <p><code class="codeph">DBMS_RESOURCE_MANAGER</code> PL / SQL包解决了操作系统无法很好管理的许多资源分配问题，包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>开销过大</p>
                           </li>
                           <li>
                              <p>调度效率低下</p>
                           </li>
                           <li>
                              <p>资源分配不当</p>
                           </li>
                           <li>
                              <p>无法管理特定于数据库的资源</p>
                           </li>
                        </ul>
                        <p>资源管理器通过为数据库提供对硬件资源分配和数据库内工作优先级的更多控制，帮助克服上述问题。您可以根据会话属性将会话分组，然后将资源分配给这些组以优化硬件利用率。您可以使用资源管理器为PDB内存消耗设置限制。</p>
                        <p>根据数据库管理员指定的资源计划将资源分配给用户。该计划指定如何在资源使用者组之间分配资源，资源使用者组是按资源要求分组的用户会话。资源计划指令将资源使用者组与计划相关联，并指定如何将资源分配给该组。</p>
                        <p><a href="concepts-for-database-administrators.html#GUID-308CCFA9-830F-442B-BA81-F03B9B6BCE49__CHDGHHBF">图18-7</a>显示了在白天同时运行OLTP应用程序和报告应用程序的组织的简单资源计划。当前活动的计划<code class="codeph">DAYTIME</code>在三个资源使用者组之间分配CPU资源。具体来说， <code class="codeph">OLTP</code>分配75％的CPU时间， <code class="codeph">REPORTS</code>分配15％， <code class="codeph">OTHER_GROUPS</code>分配剩余的10％。
                        </p>
                        <div class="figure" id="GUID-308CCFA9-830F-442B-BA81-F03B9B6BCE49__CHDGHHBF">
                           <p class="titleinfigure">图18-7简单资源计划</p><img src="img/admin078.gif" width="346" alt="下面是图18-7的描述" title="下面是图18-7的描述" longdesc="img_text/admin078.html"><br><a href="img_text/admin078.html">“图18-7简单资源计划”的描述</a></div>
                        <!-- class="figure" -->
                        <p>资源管理器可以解决的一个问题是失控查询，它可以使用SQL Monitor进行监视。资源管理器使您可以指定阈值以识别和响应失控的SQL语句。例如，您可以为使用者组中的每个前台进程指定CPU时间，已用时间，物理或逻辑I / O和PGA使用的阈值。作为响应，资源管理器可以切换到较低优先级的使用者组，终止SQL语句或记录阈值违例。</p>
                        <div class="infoboxnotealso" id="GUID-308CCFA9-830F-442B-BA81-F03B9B6BCE49__GUID-9A9157FE-9388-47BD-89BB-F0F154151C2D">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=ADMIN027" target="_blank"><span class="italic">Oracle数据库管理员指南</span></a> ，了解如何使用资源管理器</p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=ARPLS050" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a> ，了解如何使用<code class="codeph">DBMS_RESOURCE_MANAGER</code> PL / SQL包</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT89119"></a><a id="CNCPT1413"></a><div class="props_rev_3"><a id="GUID-077CBA84-5099-4550-AA11-250B301B609A" name="GUID-077CBA84-5099-4550-AA11-250B301B609A"></a><h5 id="CNCPT-GUID-077CBA84-5099-4550-AA11-250B301B609A" class="sect5">Oracle Scheduler</h5>
                     <div>
                        <p>Oracle Scheduler（调度程序）使数据库管理员和应用程序开发人员能够控制在数据库环境中执行各种任务的时间和位置。</p>
                        <p>Scheduler提供复杂的企业调度功能，您可以使用它来：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>根据时间或事件安排作业执行</p>
                           </li>
                           <li>
                              <p>以模拟业务需求的方式安排作业处理</p>
                           </li>
                           <li>
                              <p>管理和监控工作</p>
                           </li>
                           <li>
                              <p>在集群环境中执行和管理作业</p>
                           </li>
                        </ul>
                        <p>程序对象（程序）包含有关Scheduler将运行的命令的元数据，包括任何参数的默认值。计划对象（计划）包含有关运行日期和时间以及重复发生模式的信息。作业对象（作业）将程序与计划相关联。要定义执行的内容和时间，可以在程序，计划和作业之间分配关系。</p>
                        <p>Scheduler在<code class="codeph">DBMS_SCHEDULER</code> PL / SQL包中实现为一组函数和过程。您可以使用此程序包或使用Enterprise Manager创建和操作Scheduler对象。由于Scheduler对象是标准数据库对象，因此您可以使用系统和对象权限控制对它们的访问。
                        </p>
                        <p><a href="concepts-for-database-administrators.html#GUID-077CBA84-5099-4550-AA11-250B301B609A__CHDHJDBE">图18-8</a>显示了Scheduler的基本体系结构。作业表是所有作业的容器，每个数据库有一个表。根据需要自动启动和停止作业协调员后台进程。必须运行作业时，协调员会唤醒作业从属从属从作业表中收集元数据并运行作业。
                        </p>
                        <div class="figure" id="GUID-077CBA84-5099-4550-AA11-250B301B609A__CHDHJDBE">
                           <p class="titleinfigure">图18-8调度程序组件</p><img src="img/admin062.gif" alt="下面是图18-8的描述" title="下面是图18-8的描述" longdesc="img_text/admin062.html"><br><a href="img_text/admin062.html">“图18-8调度程序组件”的说明</a></div>
                        <!-- class="figure" -->
                        <div class="infoboxnotealso" id="GUID-077CBA84-5099-4550-AA11-250B301B609A__GUID-FB180869-1E6B-47B5-9342-E07054EFB61C">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="process-architecture.html#GUID-C67612E5-CA83-4AE0-B56D-05993A8B38F9" title="队列进程通常以批处理模式运行用户作业。作业是计划运行一次或多次的用户定义任务。">作业队列进程（CJQ0和Jnnn）</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/cncpt&amp;id=ADMIN033" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解调度程序</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1379"></a><div class="props_rev_3"><a id="GUID-045B9963-F53D-427C-87B7-04858B22D4D8" name="GUID-045B9963-F53D-427C-87B7-04858B22D4D8"></a><h4 id="CNCPT-GUID-045B9963-F53D-427C-87B7-04858B22D4D8" class="sect4">性能和调优</h4>
                  <div>
                     <p>作为DBA，您负责Oracle数据库的性能。通常，性能问题是由不可接受的响应时间引起的，响应时间是完成指定工作负载的时间，或吞吐量，即可在指定时间内完成的工作量。</p>
                     <p>典型问题包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>CPU瓶颈</p>
                        </li>
                        <li>
                           <p>小型内存结构</p>
                        </li>
                        <li>
                           <p>I / O容量问题</p>
                        </li>
                        <li>
                           <p>低效或高负载的SQL语句</p>
                        </li>
                        <li>
                           <p>调优SQL语句后出现意外的性能回归</p>
                        </li>
                        <li>
                           <p>并发和争用问题</p>
                        </li>
                        <li>
                           <p>数据库配置问题</p>
                        </li>
                     </ul>
                     <p>调优的一般目标通常是改善响应时间，增加吞吐量，或两者兼而有之。具体且可衡量的目标可能是“将指定的<code class="codeph">SELECT</code>语句的响应时间减少到5秒以内”。这个目标是否可实现取决于可能会或可能不会受DBA控制的因素。通常，调优是通过以尽可能最有效的方式使用数据库资源来实现特定的，可测量的和可实现的调优目标的努力。
                     </p>
                     <p>Oracle性能方法基于识别和消除数据库中的瓶颈，以及开发高效的SQL语句。应用Oracle性能方法涉及以下任务：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>执行预调整准备</p>
                        </li>
                        <li>
                           <p>定期主动调整数据库</p>
                        </li>
                        <li>
                           <p>当用户报告性能问题时，以反应方式调整数据库</p>
                        </li>
                        <li>
                           <p>识别，调整和优化高负载SQL语句</p>
                        </li>
                     </ul>
                     <p>本节介绍Oracle数据库性能调优的基本方面，包括使用顾问程序。Oracle数据库顾问程序提供有关如何解决关键数据库管理挑战的具体建议，涵盖广泛的领域，包括空间，性能和撤消管理。</p>
                     <div class="infoboxnotealso" id="GUID-045B9963-F53D-427C-87B7-04858B22D4D8__GUID-2B354826-F99D-48F5-B074-0B4A85D0F3AC">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../tdppt/oracle-database-performance-method.html#GUID-6203E485-FA06-4EE3-9003-4449FBDE214B" target="_blank"><span><cite>“Oracle数据库2天+性能调优指南”</cite></span></a>和“ <a href="../tgsql/sql-performance-methodology.html#GUID-C8B23C09-35B5-4F0E-90B2-272805EC4062" target="_blank"><span><cite>Oracle数据库SQL调优指南”</cite></span></a>用于了解如何实现Oracle性能方法</p>
                     </div>
                  </div><a id="CNCPT1376"></a><div class="props_rev_3"><a id="GUID-BF0FC773-7BFE-4FF6-A183-D30C4B68215C" name="GUID-BF0FC773-7BFE-4FF6-A183-D30C4B68215C"></a><h5 id="CNCPT-GUID-BF0FC773-7BFE-4FF6-A183-D30C4B68215C" class="sect5">数据库自我监控</h5>
                     <div>
                        <p>在数据库执行常规操作时进行自我监视，确保数据库在出现问题时意识到问题。Oracle数据库可以发送服务器生成的警报，以通知您即将发生的问题。</p>
                        <p>发生问题或数据与每秒物理读取或SQL响应时间等指标的预期值不匹配时，将自动生成警报。<a href="glossary.html#GUID-09DBC6B7-8D29-45DD-B033-B10A882269E3"><span class="xrefglossterm">度量标准</span></a>是累积统计量的变化率。服务器生成的警报可以基于用户指定的阈值级别，也可以是因为发生了事件。
                        </p>
                        <p>服务器生成的警报不仅可以识别问题，还可以建议如何解决报告的问题。一个示例是快速恢复区域空间不足的警报，建议删除过时的备份或添加额外的磁盘空间。</p>
                        <div class="infoboxnotealso" id="GUID-BF0FC773-7BFE-4FF6-A183-D30C4B68215C__GUID-9B4E6138-08C7-4CB4-A661-142C1D9EF2D1">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../admin/monitoring-the-database.html#ADMIN11247" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a></p>
                        </div>
                     </div>
                  </div><a id="CNCPT89120"></a><a id="CNCPT1374"></a><div class="props_rev_3"><a id="GUID-1C0B57E9-1D1D-4C48-8A3D-5F56160435ED" name="GUID-1C0B57E9-1D1D-4C48-8A3D-5F56160435ED"></a><h5 id="CNCPT-GUID-1C0B57E9-1D1D-4C48-8A3D-5F56160435ED" class="sect5">自动工作负载存储库（AWR）</h5>
                     <div>
                        <p><span class="bold">自动工作负载存储库（AWR）</span>是历史性能数据的存储库，其中包括系统，会话，单个SQL语句，段和服务的累积统计信息。
                        </p>
                        <p>AWR统计数据是性能调优的基础。通过自动收集数据库统计信息以进行问题检测和调优，AWR可作为数据库自我管理的基础。</p>
                        <p>如下图所示，数据库在SGA中存储最近的AWR统计信息。默认情况下，MMON进程每小时收集一次统计信息并创建一个AWR快照。<a href="glossary.html#GUID-A32367A4-F1EB-43B2-9458-54986FC74A9D"><span class="xrefglossterm">AWR快照</span></a>是在特定时间捕获的一组性能统计信息。数据库将快照写入<code class="codeph">SYSAUX</code>表空间。AWR管理快照空间，根据可配置的快照保留策略清除旧快照。
                        </p>
                        <div class="figure" id="GUID-1C0B57E9-1D1D-4C48-8A3D-5F56160435ED__CHDGCEFE">
                           <p class="titleinfigure">图18-9自动工作负载存储库（AWR）</p><img src="img/cncpt279.gif" alt="下面是图18-9的描述" title="下面是图18-9的描述" longdesc="img_text/cncpt279.html"><br><a href="img_text/cncpt279.html">“图18-9自动工作负载存储库（AWR）”的说明</a></div>
                        <!-- class="figure" -->
                        <p><a href="glossary.html#GUID-19E46AF0-A587-422B-8A06-CEF094E47F6A"><span class="xrefglossterm">AWR基线</span></a>是通常在系统在峰值负载下表现良好的时段内采用的统计速率的集合。您可以指定一对或一系列AWR快照作为基准。通过使用AWR报告将在性能不佳期间捕获的统计信息与基准进行比较，您可以诊断问题。
                        </p>
                        <p>称为AutoTask的自动维护基础架构说明了Oracle数据库如何使用AWR进行自我管理。通过分析AWR数据，AutoTask可以确定维护任务的需要并安排它们在Oracle Scheduler维护窗口中运行。任务示例包括收集<a href="glossary.html#GUID-54114749-0A81-41D7-8E16-7B76D93CEE2B"><span class="xrefglossterm">优化程序的</span></a>统计信息和运行自动分段顾问。
                        </p>
                        <div class="infoboxnotealso" id="GUID-1C0B57E9-1D1D-4C48-8A3D-5F56160435ED__GUID-98F12DE2-95F6-43C3-805E-733562D751FC">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="process-architecture.html#GUID-D175CA2B-20FE-4D5D-9A89-5CAA279479EC" title="可管理性监视器进程（MMON）执行与自动工作负载存储库（AWR）相关的许多任务。">可管理性监控流程（MMON和MMNL）</a> ”</span></p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="logical-storage-structures.html#GUID-E4055936-C426-4B5C-8811-32FF98284F16" title="SYSAUX表空间是SYSTEM表空间的辅助表空间。">SYSAUX表空间</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../tgdba/gathering-database-statistics.html#TGDBA169" target="_blank"><span><cite>Oracle数据库性能调优指南</cite></span></a> ，了解AWR</p>
                              </li>
                              <li>
                                 <p><a href="../admin/managing-automated-database-maintenance-tasks.html#ADMIN0235" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何管理自动维护任务</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT850"></a><div class="props_rev_3"><a id="GUID-7916CC5E-AE65-46E1-BF1A-052C54DD9915" name="GUID-7916CC5E-AE65-46E1-BF1A-052C54DD9915"></a><h5 id="CNCPT-GUID-7916CC5E-AE65-46E1-BF1A-052C54DD9915" class="sect5">自动数据库监控（ADDM）</h5>
                     <div>
                        <p>使用在AWR（自动工作负载存储库）中捕获的统计信息，ADDM可自动并主动诊断数据库性能并确定如何解决已识别的问题。您也可以手动运行ADDM。</p>
                        <p><a href="glossary.html#GUID-F89BDBAC-398F-4568-8041-C0D1611598E0"><span class="xrefglossterm">自动数据库诊断监视器（ADDM）</span></a>是Oracle数据库中内置的自我顾问程序。
                        </p>
                        <p>ADDM采用整体方法来处理系统性能，将时间用作组件之间的通用货币。ADDM识别消耗最多时间的Oracle数据库区域。例如，数据库可能花费过多的时间等待空闲数据库缓冲区。ADDM向下钻取以确定问题的根本原因，而不仅仅是症状，并报告问题对整个Oracle数据库的影响。在此过程中会产生最小的开销。</p>
                        <p>在许多情况下，ADDM建议解决方案并量化预期的性能优势。例如，ADDM可能会建议更改硬件，数据库配置，数据库架构或应用程序。如果建议，则ADDM报告时间收益。使用时间作为衡量标准可以比较问题或建议。</p>
                        <p>除了报告潜在的性能问题之外，ADDM还记录了数据库中没有问题的区域。在没有显着影响数据库性能的子组件（如I / O和内存）在早期阶段从分类树中进行了修剪。ADDM列出了这些子组件，以便您可以快速看到在这些区域中执行操作几乎没有任何好处。</p>
                        <div class="infoboxnotealso" id="GUID-7916CC5E-AE65-46E1-BF1A-052C54DD9915__GUID-83D3D164-8F4E-4AAB-BCE4-35FC724823D2">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../tdppt/automatic-database-performance-monitoring.html#TDPPT021" target="_blank"><span><cite>“Oracle数据库2天+性能调优指南”</cite></span></a>和“ <a href="../tgdba/automatic-performance-diagnostics.html#TGDBA02602" target="_blank"><span><cite>Oracle数据库性能调整指南”</cite></span></a></p>
                        </div>
                     </div>
                  </div><a id="CNCPT852"></a><div class="props_rev_3"><a id="GUID-12C38C77-BD4A-4D0D-8A67-FF7BF2167C77" name="GUID-12C38C77-BD4A-4D0D-8A67-FF7BF2167C77"></a><h5 id="CNCPT-GUID-12C38C77-BD4A-4D0D-8A67-FF7BF2167C77" class="sect5">活动会话历史记录（ASH）</h5>
                     <div>
                        <p><span class="bold">活动会话历史记录（ASH）</span>每秒对活动数据库会话进行一次采样，将数据写入内存和持久存储。ASH是数据库自我管理框架的组成部分，可用于诊断性能问题。
                        </p>
                        <p>与自动工作负载存储库（AWR）收集的实例级统计信息不同，数据库在会话级别收集ASH统计信息。<a href="glossary.html#GUID-ABE53BC0-1FEF-4304-86B2-06BFF5A4576D"><span class="xrefglossterm">活动会话</span></a>是使用CPU并且不等待空闲等待类中的事件的会话。
                        </p>
                        <p>您可以使用Enterprise Manager或SQL脚本生成ASH报告，以收集在指定持续时间内收集的会话统计信息。您可以使用ASH报告：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>分析自动数据库诊断监视器（ADDM）未识别的短期性能问题</p>
                           </li>
                           <li>
                              <p>通过各种维度或其组合（例如时间，会话，模块，操作或SQL ID）进行范围或目标性能分析</p>
                           </li>
                        </ul>
                        <p>例如，用户在晚上10点到晚上10点之间通知您数据库速度很慢但是，2分钟的性能下降代表了从晚上10点到晚上11点的AWR快照间隔的一小部分。没有出现在ADDM调查结果中。ASH报告可以帮助确定瞬态问题的来源。</p>
                        <div class="infoboxnotealso" id="GUID-12C38C77-BD4A-4D0D-8A67-FF7BF2167C77__GUID-E9D2CD9E-5EC5-4C58-AFD6-4935B1E0BDCA">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../tdppt/resolving-transient-performance-problems.html#TDPPT065" target="_blank"><span><cite>“Oracle数据库2天+性能调优指南”</cite></span></a>和“ <a href="../tgdba/analyzing-sampled-data.html#TGDBA278" target="_blank"><span><cite>Oracle数据库性能调整指南”</cite></span></a></p>
                        </div>
                     </div>
                  </div><a id="CNCPT1380"></a><div class="props_rev_3"><a id="GUID-6AF46C02-62A0-4302-A981-8A10EDF7F966" name="GUID-6AF46C02-62A0-4302-A981-8A10EDF7F966"></a><h5 id="CNCPT-GUID-6AF46C02-62A0-4302-A981-8A10EDF7F966" class="sect5">应用程序和SQL调优</h5>
                     <div>
                        <p>Oracle数据库完全自动化SQL调优过程。</p>
                        <p>ADDM识别消耗异常高系统资源的SQL语句，从而导致性能问题。此外，AWR根据CPU和共享内存消耗自动捕获顶级SQL语句。高负载SQL语句的标识自动发生，无需干预。</p>
                     </div><a id="CNCPT89280"></a><div class="props_rev_3"><a id="GUID-804A3E13-06F5-4922-9D1A-4FAFFC4E0E98" name="GUID-804A3E13-06F5-4922-9D1A-4FAFFC4E0E98"></a><h6 id="CNCPT-GUID-804A3E13-06F5-4922-9D1A-4FAFFC4E0E98" class="sect6">解释计划声明</h6>
                        <div>
                           <p>诸如<code class="codeph">EXPLAIN PLAN</code>语句之类的工具使您可以查看优化程序选择的执行计划。
                           </p>
                           <p><code class="codeph">EXPLAIN PLAN</code>显示指定SQL查询的查询计划（如果它现在在当前会话中执行）。其他工具是Oracle Enterprise Manager和SQL * Plus <code class="codeph">AUTOTRACE</code>命令。
                           </p>
                           <div class="infoboxnotealso" id="GUID-804A3E13-06F5-4922-9D1A-4FAFFC4E0E98__GUID-B4B83031-6C62-425E-BE78-F3C44BBCAF3E">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../sqlrf/EXPLAIN-PLAN.html#SQLRF01601" target="_blank"><span><cite>Oracle Database SQL语言参考</cite></span></a> ，了解<code class="codeph">EXPLAIN PLAN</code></p>
                           </div>
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-781A678D-C395-4C8E-8E59-8AD6BF4BB448" name="GUID-781A678D-C395-4C8E-8E59-8AD6BF4BB448"></a><h6 id="CNCPT-GUID-781A678D-C395-4C8E-8E59-8AD6BF4BB448" class="sect6">优化器统计顾问</h6>
                        <div>
                           <p>Optimizer Statistics Advisor是一种诊断软件，可分析您当前收集统计信息的方式，现有统计信息收集作业的有效性以及收集的统计信息的质量。Optimizer Statistics Advisor使用与自动数据库诊断监视器（ADDM），SQL性能分析器和其他顾问相同的顾问程序框架。</p>
                           <p>与传统方法相比，Optimizer Statistics Advisor具有以下优势：传统方法依赖于最佳实践：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>提供易于理解的报告</p>
                              </li>
                              <li>
                                 <p>提供脚本以实现必要的修复， <span class="italic">而</span>无需更改应用程序代码</p>
                              </li>
                              <li>
                                 <p>在维护窗口中每天<code class="codeph">AUTO_STATS_ADVISOR_TASK</code>一次名为<code class="codeph">AUTO_STATS_ADVISOR_TASK</code>的预定义任务</p>
                              </li>
                              <li>
                                 <p>在<code class="codeph">DBMS_STATS</code>包中提供API，使您可以手动创建和运行任务，将结果和建议存储在数据字典视图中，生成任务报告，并在必要时实施更正</p>
                              </li>
                              <li>
                                 <p>与Oracle Enterprise Manager（企业管理器）等现有工具集成</p>
                              </li>
                           </ul>
                           <p>Optimizer Statistics Advisor维护规则，这些规则是Oracle提供的标准，顾问程序通过该标准执行检查。这些规则体现了基于当前功能集的Oracle最佳实践。如果最佳实践在发行版之间发生变化，那么Optimizer Statistics Advisor规则也会发生变化。通过这种方式，顾问始终提供最新的建议。</p>
                           <p>优化程序统计顾问检查统计信息收集过程，然后生成违反规则的结果报告。如果顾问提出建议，并且如果它建议基于这些建议的操作，那么您可以自动实施操作或生成可编辑的可执行PL / SQL脚本。</p>
                           <p>顾问程序任务在维护窗口中自动运行，但您也可以按需运行它。</p>
                           <div class="infoboxnotealso" id="GUID-781A678D-C395-4C8E-8E59-8AD6BF4BB448__GUID-3018550A-1276-4C28-86E9-47DD04188842">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="../tgsql/optimizer-statistics-advisor.html#TGSQL-GUID-054F4B76-DD57-46EE-98EA-0FF04F49D1B3" target="_blank"><span><cite>Oracle Database SQL Tuning Guide</cite></span></a>以了解有关Optimizer Statistics Advisor的更多信息</p>
                                 </li>
                                 <li>
                                    <p><a href="../arpls/DBMS_SPM.html#ARPLS150" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考，</cite></span></a>以了解<code class="codeph">DBMS_STATS</code>包</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div><a id="CNCPT853"></a><div class="props_rev_3"><a id="GUID-9104F5D9-E1BE-4B15-8A0F-EAB03E3CA3B4" name="GUID-9104F5D9-E1BE-4B15-8A0F-EAB03E3CA3B4"></a><h6 id="CNCPT-GUID-9104F5D9-E1BE-4B15-8A0F-EAB03E3CA3B4" class="sect6">SQL Tuning Advisor</h6>
                        <div>
                           <p>用于自动SQL调优的界面是SQL Tuning Advisor，它在系统维护窗口期间作为维护任务自动运行。</p>
                           <p>在每次自动运行期间，顾问程序在数据库中选择高负载SQL查询，并生成调整这些查询的建议。</p>
                           <p>SQL Tuning Advisor建议分为以下几类：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>统计分析</p>
                              </li>
                              <li>
                                 <p>SQL分析</p>
                              </li>
                              <li>
                                 <p>访问路径分析</p>
                              </li>
                              <li>
                                 <p>SQL结构分析</p>
                              </li>
                           </ul>
                           <p><a href="glossary.html#GUID-E54F3CED-F5B8-4367-923E-BCFB67319D3A"><span class="xrefglossterm">SQL概要文件</span></a>包含特定于SQL语句的其他统计信息，并使优化程序能够生成更好的<a href="glossary.html#GUID-2DF33B85-94BB-44F3-93B7-06916FB18361"><span class="xrefglossterm">执行计划</span></a> 。实质上，SQL配置文件是一种分析查询的方法。<a href="glossary.html#GUID-56F7FB03-3499-4D51-8D23-F86C45194F09"><span class="xrefglossterm">访问路径</span></a>和SQL结构分析对于调整正在开发的应用程序或本地生产应用程序非常有用。
                           </p>
                           <p>SQL Tuning Advisor的主要优点是解决方案来自优化器而不是外部工具。因此，调整由负责执行计划和SQL性能的数据库组件执行。调优过程可以考虑SQL语句的过去执行统计信息，并自定义此语句的优化程序设置。</p>
                           <div class="infoboxnotealso" id="GUID-9104F5D9-E1BE-4B15-8A0F-EAB03E3CA3B4__GUID-FDE7D192-EEB3-4171-BF67-CBB3E41B7196">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p> <span class="q">“ <a href="sql.html#GUID-3F42B1AA-530A-4144-8179-F0074832AF81" title="要了解Oracle数据库如何处理SQL语句，有必要了解数据库中称为优化器的部分（也称为查询优化器或基于成本的优化器）。所有SQL语句都使用优化器来确定访问指定数据的最有效方法。">优化器概述</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><a href="../tdppt/tuning-sql-statements.html#TDPPT160" target="_blank"><span><cite>Oracle数据库2天+性能调优指南</cite></span></a>和<a href="../tgsql/introduction-to-sql-tuning.html#TGSQL540" target="_blank"><span><cite>Oracle数据库SQL调优指南</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div><a id="CNCPT854"></a><div class="props_rev_3"><a id="GUID-F6B6AE39-784A-4ACA-B6FF-DD3F3D57C159" name="GUID-F6B6AE39-784A-4ACA-B6FF-DD3F3D57C159"></a><h6 id="CNCPT-GUID-F6B6AE39-784A-4ACA-B6FF-DD3F3D57C159" class="sect6">SQL Access Advisor</h6>
                        <div>
                           <p>使用SQL Access Advisor可以帮助您分析SQL查询，并确定优化模式对象或调优查询的方法。</p>
                           <p>SQL Access Advisor提供有关如何优化数据访问路径的建议。具体而言，它建议如何通过分区，物化视图，索引和物化视图日志来提高数据库性能。</p>
                           <p>诸如分区和索引之类的模式对象对于优化复杂的数据密集型查询至关重要。但是，创建和维护这些对象可能非常耗时，并且空间要求可能很高。SQL Access Advisor通过为指定工作负载推荐数据结构来帮助实现性能目标。</p>
                           <p>您可以使用向导或使用<code class="codeph">DBMS_ADVISOR</code>包从Enterprise Manager运行SQL Access Advisor。<code class="codeph">DBMS_ADVISOR</code>包含一组可从任何PL / SQL程序调用的分析和建议函数和过程。
                           </p>
                           <div class="infoboxnotealso" id="GUID-F6B6AE39-784A-4ACA-B6FF-DD3F3D57C159__GUID-A11040CF-7390-4B13-8DF8-EC56099B5F3A">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../tdppt/optimizing-data-access-paths.html#TDPPT170" target="_blank"><span><cite>Oracle数据库2天+性能调优指南</cite></span></a>和<a href="../tgsql/introduction-to-sql-tuning.html#TGSQL591" target="_blank"><span><cite>Oracle数据库SQL调优指南</cite></span></a></p>
                           </div>
                        </div>
                     </div><a id="CNCPT89281"></a><div class="props_rev_3"><a id="GUID-67362328-A94E-4818-A4A1-0206FD89B766" name="GUID-67362328-A94E-4818-A4A1-0206FD89B766"></a><h6 id="CNCPT-GUID-67362328-A94E-4818-A4A1-0206FD89B766" class="sect6">SQL计划管理</h6>
                        <div>
                           <p>使用SQL计划管理来管理SQL执行计划，以仅执行经过测试和验证的计划。</p>
                           <p><a href="glossary.html#GUID-D75689FA-8F43-4BA6-9764-1BDFA1DB28FC"><span class="xrefglossterm">SQL计划管理</span></a>是一种预防机制，使优化程序能够自动管理执行计划，确保数据库仅使用经过验证的计划。此机制可以构建<a href="glossary.html#GUID-F9730C73-DF8D-4360-B0E6-CB8B381D1447"><span class="xrefglossterm">SQL计划基准</span></a> ，这是一组可重复SQL语句的一个或多个已接受计划。基线的影响是优化程序将其选择限制为基线中的已验证计划。
                           </p>
                           <p>从<span>Oracle Database 12c开始</span> ，数据库可以使用自适应SPM。 SPM Evolve Advisor每天在计划的维护窗口中运行，对所有未接受的计划进行排名，然后在窗口期间执行尽可能多的计划的测试执行。SPM Evolve Advisor在SQL计划基准中选择成本最低的已接受计划，以与每个未接受的计划进行比较。如果未接受的计划比现有的接受计划表现得足够好，那么顾问会接受该计划。如果没有，顾问会将计划保留为未接受，并更新上次验证的日期。
                           </p>
                           <div class="infoboxnotealso" id="GUID-67362328-A94E-4818-A4A1-0206FD89B766__GUID-2A4A5C60-4C99-487C-BAC6-2F71B4B47DA1">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="concepts-for-database-administrators.html#GUID-FA659979-25B7-4611-AA8D-48B5404301FE" title="Oracle提供了几种用于管理数据库的工具。">数据库管理员工具</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><a href="../tgsql/query-optimizer-concepts.html#TGSQL202" target="_blank"><span><cite>Oracle数据库SQL调优指南</cite></span></a> ，了解SQL计划管理</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>