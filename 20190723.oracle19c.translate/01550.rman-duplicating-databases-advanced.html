<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This chapter explains advanced forms of database duplication."></meta>
      <meta name="description" content="This chapter explains advanced forms of database duplication."></meta>
      <title>复制数据库：高级主题</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta property="og:description" content="This chapter explains advanced forms of database duplication."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96241-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="rman-duplicating-databases.html" title="Previous" type="text/html"></link>
      <link rel="next" href="creating-transportable-tablespace-sets.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="BRADV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="rman-duplicating-databases.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="creating-transportable-tablespace-sets.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-transfering-data-rman.html" property="item" typeof="WebPage"><span property="name">使用RMAN传输数据</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">复制数据库：高级主题</li>
            </ol>
            <a id="GUID-8E3B1C4D-9B1F-422D-9A35-8A5AE71C36F5" name="GUID-8E3B1C4D-9B1F-422D-9A35-8A5AE71C36F5"></a>
            
            <h2 id="BRADV-GUID-8E3B1C4D-9B1F-422D-9A35-8A5AE71C36F5" class="sect2"><span class="enumeration_chapter">26</span>复制数据库：高级主题</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍了数据库复制的高级形式。</p>
               <p>本章包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="rman-duplicating-databases-advanced.html#GUID-2D8041F5-A322-452F-980C-5E81E1902D1C" title="如果源数据库和重复数据库不对数据库文件使用相同的名称，则必须为重复文件选择备用命名策略。">为重复数据库文件指定备用名称</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="您可以使用共享磁盘技术使备份可用于辅助实例。如果NFS或共享磁盘不是选项，则存储备份的路径必须同时存在于源主机和目标主机上，除非BACKUP LOCATION选项用于没有目标或恢复目录连接的DUPLICATE命令。">无需共享磁盘即可访问磁盘备份</a></p>
                  </li>
               </ul>
            </div>
            <div class="sect2"><a id="GUID-2D8041F5-A322-452F-980C-5E81E1902D1C" name="GUID-2D8041F5-A322-452F-980C-5E81E1902D1C"></a><h3 id="BRADV-GUID-2D8041F5-A322-452F-980C-5E81E1902D1C" class="sect3"><span class="enumeration_section">26.1</span>为重复数据库文件指定备用名称</h3>
               <div>
                  <p>如果源数据库和重复数据库不对数据库文件使用相同的名称，则必须为重复文件选择备用命名策略。</p>
                  <div class="section">
                     <p>根据源和重复数据库是使用Oracle托管文件（OMF）还是Oracle自动存储管理（ASM），请使用以下策略之一：</p>
                  </div>
                  <!-- class="section" -->
                  <ul>
                     <li class="stepexpand"><span><a href="rman-duplicating-databases-advanced.html#GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65" title="如果源数据库和重复数据库使用不同的目录结构或使用相同的结构但您希望以不同方式命名重复文件，则必须指定必须如何命名重复的数据库文件。">为重复数据库文件指定非OMF或非ASM备用名称</a></span></li>
                     <li class="stepexpand"><span><a href="rman-duplicating-databases-advanced.html#GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE" title="CONFIGURE AUXNAME命令是SET NEWNAME命令的替代命令。不同之处在于，第一次配置辅助名称后，其他DUPLICATE命令会重用已配置的设置。相反，每次执行DUPLICATE命令时都必须重新发出SET NEWNAME命令。">使用CONFIGURE AUXNAME命令命名文件系统数据文件和OMF或ASM目标数据文件</a></span><div>
                           <p>如果源数据文件使用OMF，则无法使用<code class="codeph">DB_FILE_NAME_CONVERT</code>初始化参数重命名它们。<a href="performing-rman-tspitr.html#GUID-AEA2C5F4-214B-4795-86DE-69BC307832EE" title="有多种方法可用于重命名辅助数据库的OMF（非ASM）文件名。">使用非ASM存储可以</a>讨论OMF管理的数据文件的详细信息和选项。
                           </p>
                        </div>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65" name="GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65"></a><h4 id="BRADV-GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65" class="sect4"><span class="enumeration_section">26.1.1</span>为重复数据库文件指定非OMF或非ASM备用名称</h4>
                  <div>
                     <p>如果源数据库和重复数据库使用不同的目录结构或使用相同的结构但您希望以不同方式命名重复文件，则必须指定必须如何命名重复的数据库文件。</p>
                     <div class="section">
                        <p><a href="rman-duplicating-databases-advanced.html#GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65__GUID-9E492CBE-B861-4ACB-AA35-89E96B264B97" title="此表描述了可用于命名重复数据库文件的格式">表26-1</a>总结了可用于命名每种类型文件的格式。
                        </p>
                        <div class="tblformal" id="GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65__GUID-9E492CBE-B861-4ACB-AA35-89E96B264B97">
                           <p class="titleintable">表26-1 SET NEWNAME命令的替换变量</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="SET NEWNAME命令的替换变量" border="1" summary="This table describes the formats available for naming duplicate database files" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d122325e301"><span class="bold">变量</span></th>
                                    <th align="left" valign="bottom" width="20%" id="d122325e304"><span class="bold">描述</span></th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d122325e309" headers="d122325e301 ">
                                       <p><code class="codeph">％b</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d122325e309 d122325e304 ">
                                       <p>指定剥离目录路径的文件名。例如，如果数据文件名为<code class="codeph">/oradata/prod/financial.dbf</code> ，则<code class="codeph">%b</code> <code class="codeph">financial.dbf</code> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d122325e326" headers="d122325e301 ">
                                       <p><code class="codeph">％F</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d122325e326 d122325e304 ">
                                       <p>指定为其生成新名称的数据文件的绝对文件号。例如，如果数据文件2重复，则<code class="codeph">%f</code>生成值2。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d122325e337" headers="d122325e301 ">
                                       <p><code class="codeph">％一世</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d122325e337 d122325e304 ">
                                       <p>指定DBID。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d122325e345" headers="d122325e301 ">
                                       <p><code class="codeph">％N</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d122325e345 d122325e304 ">
                                       <p>指定表空间名称。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" id="d122325e353" headers="d122325e301 ">
                                       <p><code class="codeph">％U</code></p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d122325e353 d122325e304 ">
                                       <p>指定以下格式： <code class="codeph">data-D-%d_id-%I_TS-%N_FNO-%f</code></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>使用以下技术之一为非OMF或非ASM重复数据库文件提供备用名称：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="rman-duplicating-databases-advanced.html#GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2" title="在执行DUPLICATE命令以命名重复数据文件之前，请使用SET NEWNAME命令。">使用SET NEWNAME命令命名文件系统数据文件和临时文件</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases-advanced.html#GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE" title="CONFIGURE AUXNAME命令是SET NEWNAME命令的替代命令。不同之处在于，第一次配置辅助名称后，其他DUPLICATE命令会重用已配置的设置。相反，每次执行DUPLICATE命令时都必须重新发出SET NEWNAME命令。">使用CONFIGURE AUXNAME命令命名文件系统数据文件和OMF或ASM目标数据文件</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="sect4"><a id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2" name="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2"></a><h5 id="BRADV-GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2" class="sect5"><span class="enumeration_section">26.1.1.1</span>使用SET NEWNAME命令命名文件系统数据文件和临时文件</h5>
                     <div>
                        <p>在执行<code class="codeph">DUPLICATE</code>命令以命名重复数据文件之前，请使用<code class="codeph">SET NEWNAME</code>命令。
                        </p>
                        <div class="section">
                           <p>RMAN支持以下优先顺序列出的命令：</p>
                           <ol>
                              <li>
                                 <p><code class="codeph">SET NEWNAME FOR DATAFILE</code> <code class="codeph">SET NEWNAME FOR TEMPFILE</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">为TABLESPACE设置NEWNAME</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">为数据库设置NEWNAME</code></p>
                              </li>
                           </ol>
                           <p>优先顺序意味着<code class="codeph">SET NEWNAME FOR TABLESPACE</code>命令指定未由<code class="codeph">SET NEWNAME FOR DATAFILE</code>和<code class="codeph">SET NEWNAME FOR TEMPFILE</code>命令命名的文件的名称，而<code class="codeph">SET NEWNAME FOR DATABASE</code>命令指定未由命名的文件的名称。 <code class="codeph">SET NEWNAME FOR TABLESPACE</code> <code class="codeph">SET NEWNAME FOR DATAFILE</code> <code class="codeph">SET NEWNAME FOR TEMPFILE</code> ，或<code class="codeph">SET NEWNAME FOR TEMPFILE</code>命令<code class="codeph">SET NEWNAME FOR TEMPFILE</code> 。
                           </p>
                           <p>当您使用<code class="codeph">SET NEWNAME FOR DATAFILE</code>命令时，您可以将完整路径指定为文字，如<code class="codeph">/oradata1/system01.dbf</code> 。但是，当您使用带有<code class="codeph">FOR DATABASE</code>或<code class="codeph">FOR TABLESPACE</code>选项的<code class="codeph">SET</code>命令时，必须至少使用这些替换变量中的一个，如<a href="rman-duplicating-databases-advanced.html#GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65__GUID-9E492CBE-B861-4ACB-AA35-89E96B264B97" title="此表描述了可用于命名重复数据库文件的格式">表26-1中所述</a> ： <code class="codeph">%b</code> ， <code class="codeph">%f</code> ， <code class="codeph">%U</code> （ <code class="codeph">%I</code>和<code class="codeph">%N</code>是可选的）。
                           </p>
                           <p>要使用<code class="codeph">SET NEWNAME</code>命令指定新文件名：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>确保满足所选复制技术的先决条件。</span><div>
                                 <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="先决条件取决于正在执行的数据库重复的类型。某些先决条件对于所有类型的复制都是通用的，而其他先决条件则特定于特定类型的复制。">复制数据库的先决条件</a> ”</span> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>在开始数据库复制之前，请完成所需的规划任务。</span><div>
                                 <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="在复制数据库之前，您必须对复制过程做出一些决定。">计划复制数据库</a> ”</span> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>准备创建重复数据库时使用的辅助实例。</span><div>
                                 <p>复制Oracle Real Application Clusters（Oracle RAC）数据库时，请将辅助数据库上的<code class="codeph">CLUSTER_DATABASE</code>初始化参数设置为<code class="codeph">FALSE</code> 。复制过程完成后，此参数可以重置为<code class="codeph">TRUE</code> 。
                                 </p>
                                 <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN使用辅助实例来创建重复数据库。在开始复制之前，必须准备辅助实例。">准备辅助实例</a> ”</span> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>启动RMAN并连接到所需的数据库。根据您的复制技术，您可能需要连接到以下一个或多个目标：目标数据库，辅助实例或恢复目录。</span><div>
                                 <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="您必须启动RMAN客户端并根据所选复制技术的要求连接到数据库实例。RMAN客户端可以位于任何主机上，只要它可以通过网络连接到必要的数据库。">启动RMAN并连接到数据库</a> ”</span> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>如有必要，将源数据库置于适当的状态。</span><div>
                                 <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="如果RMAN作为TARGET连接到源数据库，则源数据库必须处于正确的复制状态。">将源数据库置于适当的状态</a> ”</span> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>（可选）配置RMAN通道以提高复制性能。通道执行复制数据库的主要任务。</span><div>
                                 <p>请参阅<span class="q">“ <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="数据库复制的主要工作由RMAN通道执行。每个通道对应于执行复制任务的Oracle数据库服务器会话。根据复制技术，RMAN使用辅助通道或目标通道。">配置RMAN通道以用于复制</a> ”</span> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>在<code class="codeph">RUN</code>命令中，在发出<code class="codeph">DUPLICATE</code>命令之前发出<code class="codeph">SET NEWNAME</code>命令。</span></li>
                        </ol>
                        <div class="example" id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-F74D6F45-8786-4DA2-A873-EEAD94BCDA92">
                           <p class="titleinexample">示例26-1使用SET NEWNAME FOR DATAFILE命令复制数据库</p>
                           <p>此示例说明了一个脚本，它指定数据文件1到5和临时文件1的新名称。该脚本不为数据文件6设置新名称，因为它位于<code class="codeph">TOOLS</code>表空间中，该表空间从重复数据库中排除。
                           </p>
                           <div class="p">假设如下：<ul style="list-style-type:disc">
                                 <li>
                                    <p>DBID是87650928</p>
                                 </li>
                                 <li>
                                    <p>数据库名称是<code class="codeph">PROD</code></p>
                                 </li>
                              </ul>
                           </div>
                           <p>使用以下命令复制数据库：</p><pre class="pre codeblock"><code>运行{为数据文件设置NEWNAME 1'到'/oradata1/system01.dbf';将DATAFILE 2的NEWNAME设置为'/oradata2/sysaux01.dbf';将DATAFILE 3的NEWNAME设置为'/oradata3/undotbs01.dbf';将DATAFILE 4的NEWNAME设置为'/oradata4/users01.dbf';将DATAFILE 5的NEWNAME设置为'/oradata5/users02.dbf';为TEMPFILE 1设置NEWNAME到'/oradatat/temp01.dbf'; DUPLICATE目标数据库到dupdb SKIP TABLESPACE工具LOGFILE GROUP 1（'/duplogs/redo01a.log','/duplogs/redo01b.log'）SIZE 4M REUSE，GROUP 2（'/duplogs / redo02a.log'，'/ duplogs / redo02b.log'）SIZE 4M REUSE; }</code></pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-8BBF6497-1BAB-4DB1-B850-8B91F57CFFE7">
                           <p class="titleinexample">示例26-2使用SET NEWNAME FOR DATAFILE复制数据库并为TABLESPACE命令设置NEWNAME</p>
                           <p>此示例是<a href="rman-duplicating-databases-advanced.html#GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-F74D6F45-8786-4DA2-A873-EEAD94BCDA92">示例26-1</a>的变体，并使用单个<code class="codeph">SET NEWNAME</code>命令命名表空间<code class="codeph">users</code>中的所有数据文件。示例完成后，表空间<code class="codeph">users</code>的文件名设置为： <code class="codeph">/oradata4/users01.dbf</code>和<code class="codeph">/oradata5/users02.dbf</code> 。
                           </p>
                           <p>使用以下命令复制数据库：</p><pre class="pre codeblock"><code>{TABLESPACE用户设置NEWNAME''/ oradata％f /％b';将DATAFILE 1的NEW NEWNAME设置为'/oradata1/system01.dbf';将DATAFILE 2的NEWNAME设置为'/oradata2/sysaux01.dbf';将DATAFILE 3的NEWNAME设置为'/oradata3/undotbs01.dbf';为TEMPFILE 1设置NEWNAME到'/oradatat/temp01.dbf'; DUPLICATE目标数据库到dupdb SKIP TABLESPACE工具LOGFILE GROUP 1（'/duplogs/redo01a.log','/duplogs/redo01b.log'）SIZE 4M REUSE，GROUP 2（'/duplogs / redo02a.log'，'/ duplogs / redo02b.log'）SIZE 4M REUSE; }</code></pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-2F07DAA1-075B-4C14-A406-980CBA954A35">
                           <p class="titleinexample">示例26-3使用SET NEWNAME FOR DATABASE命令复制数据库</p>
                           <p>此示例是<a href="rman-duplicating-databases-advanced.html#GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-F74D6F45-8786-4DA2-A873-EEAD94BCDA92">示例26-1</a>的变体，并使用单个<code class="codeph">SET</code>命令命名数据库中的所有数据文件。
                           </p>
                           <p>使用以下命令复制数据库：</p><pre class="pre codeblock"><code>运行{设置数据库的新数字'/ oradata /％U'; DUPLICATE目标数据库到dupdb SKIP TABLESPACE工具LOGFILE GROUP 1（'/duplogs/redo01a.log','/duplogs/redo01b.log'）SIZE 4M REUSE，GROUP 2（'/duplogs / redo02a.log'，'/ duplogs / redo02b.log'）SIZE 4M REUSE; }</code></pre><p>下表显示了此示例的结果。</p>
                           <div class="tblformal" id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-E94CC87D-EE72-4BEE-A608-535B8F43421C">
                              <p class="titleintable">表26-2 SET NEWNAME DATABASE命令的结果</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="SET NEWNAME DATABASE命令的结果" border="1" summary="This table lists the before and after results from SET NEWNAME DATABASE." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e756">在SET NEWNAME DATABASE之前</th>
                                       <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e759">表空间名称</th>
                                       <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e762">数据文件编号</th>
                                       <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e765">SET NEWNAME DATABASE TO'/ oradata /％U'之后;</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e770" headers="d122325e756 ">
                                          <p><code class="codeph">... / system01.dbf</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e770 d122325e759 ">
                                          <p><code class="codeph">系统</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e770 d122325e762 ">
                                          <p>1</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e770 d122325e765 ">
                                          <p><code class="codeph">/ ORADATA /数据d-PROD_ID-87650928_TS-SYSTEM_FNO-1</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e786" headers="d122325e756 ">
                                          <p><code class="codeph">... / sysaux01.dbf</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e786 d122325e759 ">
                                          <p><code class="codeph">SYSAUX</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e786 d122325e762 ">
                                          <p>2</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e786 d122325e765 ">
                                          <p><code class="codeph">/ ORADATA /数据d-PROD_ID-87650928_TS-SYSAUX_FNO -2-</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e802" headers="d122325e756 ">
                                          <p><code class="codeph">... / UNDOTBS01.DBF</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e802 d122325e759 ">
                                          <p><code class="codeph">UNDOTS</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e802 d122325e762 ">
                                          <p>3</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e802 d122325e765 ">
                                          <p><code class="codeph">/ ORADATA /数据d-PROD_ID-87650928_TS-UNDOTS_FNO -3-</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e818" headers="d122325e756 ">
                                          <p><code class="codeph">... / USERS01.DBF</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e818 d122325e759 ">
                                          <p><code class="codeph">USERS</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e818 d122325e762 ">
                                          <p>4</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e818 d122325e765 ">
                                          <p><code class="codeph">/ ORADATA /数据d-PROD_ID-87650928_TS-USERS_FNO -4-</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e834" headers="d122325e756 ">
                                          <p><code class="codeph">... / users02.dbf</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e834 d122325e759 ">
                                          <p><code class="codeph">USERS</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e834 d122325e762 ">
                                          <p>五</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e834 d122325e765 ">
                                          <p><code class="codeph">/ ORADATA /数据d-PROD_ID-87650928_TS-USERS_FNO -5-</code></p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e850" headers="d122325e756 ">
                                          <p><code class="codeph">... / temp01.dbf</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e850 d122325e759 ">
                                          <p><code class="codeph">TEMP</code></p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e850 d122325e762 ">
                                          <p>1</p>
                                       </td>
                                       <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e850 d122325e765 ">
                                          <p><code class="codeph">/ ORADATA /数据d-PROD_ID-87650928_TS-TEMP_FNO-1</code></p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <div class="infoboxnotealso" id="GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2__GUID-F3B28FFA-0060-4281-94BC-088EE60CFA67">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">SET NEWNAME</code>可用的替换变量的详细信息，请参阅<a href="../rcmrf/SET.html#RCMRF-GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE" name="GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE"></a><h5 id="BRADV-GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE" class="sect5"><span class="enumeration_section">26.1.1.2</span>使用CONFIGURE AUXNAME命令命名文件系统数据文件和OMF或ASM目标数据文件</h5>
                     <div>
                        <p><code class="codeph">CONFIGURE AUXNAME</code>命令是<code class="codeph">SET NEWNAME</code>命令的替代命令。不同之处在于，第一次配置辅助名称后，其他<code class="codeph">DUPLICATE</code>命令会重用已配置的设置。相反，每次执行<code class="codeph">DUPLICATE</code>命令时都必须重新<code class="codeph">SET NEWNAME</code>命令。
                        </p>
                        <div class="section">
                           <p>要使用<code class="codeph">CONFIGURE AUXNAME</code>命令指定重复数据文件的名称：</p>
                           <ol>
                              <li>
                                 <p>为每个要在重复数据库中命名的文件发出<code class="codeph">CONFIGURE AUXNAME</code>命令。
                                 </p>
                                 <p>例如，在RMAN提示符处输入以下命令，以指定文件数据文件1到5的名称：</p><pre class="pre codeblock"><code>将DATAFILE 1的AUXNAME配置为'/oradata1/system01.dbf';将DATAFILE 2的AUXNAME配置为'/oradata2/sysaux01.dbf';将数据文件3的AUXNAME配置为'/oradata3/undotbs01.dbf';将数据文件4的AUXNAME配置为'/oradata4/users01.dbf';将数据文件5的AUXNAME配置为'/oradata5/users02.dbf';</code></pre></li>
                              <li>
                                 <p>发出<code class="codeph">DUPLICATE</code>命令。
                                 </p>
                                 <p>例如，在RMAN提示符处输入以下命令：</p><pre class="pre codeblock"><code>为TEMPFILE 1设置NEWNAME到'/oradatat/temp01.dbf'; DUPLICATE目标数据库到dupdb SKIP TABLESPACE工具LOGFILE GROUP 1（'/duplogs/redo01a.log','/duplogs/redo01b.log'）SIZE 4M REUSE，GROUP 2（'/duplogs / redo02a.log'，'/ duplogs / redo02b.log'）SIZE 4M REUSE;</code></pre></li>
                           </ol>
                           <div class="infoboxnotealso" id="GUID-8230C91E-A668-48E8-AEFC-45E8892E2BDE__GUID-317CDC14-A5EB-4868-930E-64B4B1D9348D">
                              <p class="notep1">也可以看看：</p>
                              <p>有关使用<code class="codeph">CONFIGURE AUXNAME</code>详细信息，请<a href="../rcmrf/CONFIGURE.html#RCMRF-GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A" target="_blank"><span><cite>参见Oracle数据库备份和恢复参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-EC10A9C8-DF30-407E-9B0A-E597ABFE5D6F" name="GUID-EC10A9C8-DF30-407E-9B0A-E597ABFE5D6F"></a><h4 id="BRADV-GUID-EC10A9C8-DF30-407E-9B0A-E597ABFE5D6F" class="sect4"><span class="enumeration_section">26.1.2</span>为重复数据库文件指定OMF或ASM备用名称</h4>
                  <div>
                     <p>当源数据库和重复数据库对数据库文件使用相同的名称时，必须指定如何命名重复的数据库文件。</p>
                     <p>以下部分讨论当重复数据库的部分或全部文件使用OMF或ASM时创建重复数据库的要求和过程：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-CA4E1982-6C0F-4111-A971-96990D4634DC" title="创建使用OMF的重复数据库时，必须在辅助实例中设置初始化参数。如果使用DUPLICATE命令的SPFILE选项命名文件，则可以在SPFILE选项中设置初始化参数。">OMF初始化参数的设置和限制</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-82E9B9C5-74D6-4B22-A03C-2A24930B8A03" title="您必须确定控制创建文件位置的初始化参数，并将这些参数设置为ASM磁盘组。">设置ASM的初始化参数</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA" title="本节包含有关将数据库复制到ASM的示例。">示例：将数据库复制到ASM</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA" title="要命名Oracle托管数据文件，可以使用带有TO NEW选项的SET NEWNAME命令而不是TO&#39;filename&#39;选项。RMAN在DB_CREATE_FILE_DEST参数指定的位置创建具有OMF名称的指定数据文件或临时文件。">使用SET NEWNAME命令创建OMF或ASM文件</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-086A9599-15DB-4441-8E02-A939CBC5FF96" title="除了使用SET NEWNAME或CONFIGURE AUXNAME命令外，还可以使用DB_FILE_NAME_CONVERT参数转换目标文件名。您可以在DUPLICATE命令中指定DB_FILE_NAME_CONVERT选项，也可以在辅助实例的初始化参数文件中设置它。">使用DB_FILE_NAME_CONVERT参数为非OMF或ASM数据文件生成名称</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-A11B8766-5078-433F-927E-D77314236755" title="如果已省略LOG_FILE子句且未指定任何OMF初始化参数DB_CREATE_FILE_DEST，DB_CREATE_ONLINE_DEST_n或DB_RECOVERY_FILE_DEST，则LOG_FILE_NAME_CONVERT参数可以转换目标文件名。这与DB_FILE_NAME_CONVERT参数将目标文件名从log_ *转换为duplog_ *的方式相同。">使用LOG_FILE_NAME_CONVERT参数为非OMF或ASM日志文件生成名称</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-EC10A9C8-DF30-407E-9B0A-E597ABFE5D6F__GUID-5EBD5330-8C1C-4E8D-86D9-41B44CEDD939">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="italic">“Oracle自动存储管理管理员指南”</span> ，介绍ASM和OMF</p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-CA4E1982-6C0F-4111-A971-96990D4634DC" name="GUID-CA4E1982-6C0F-4111-A971-96990D4634DC"></a><h5 id="BRADV-GUID-CA4E1982-6C0F-4111-A971-96990D4634DC" class="sect5"><span class="enumeration_section">26.1.2.1</span> OMF初始化参数的设置和限制</h5>
                     <div>
                        <p>创建使用OMF的重复数据库时，必须在辅助实例中设置初始化参数。如果使用<code class="codeph">DUPLICATE</code>命令的<code class="codeph">SPFILE</code>选项命名文件，则可以在<code class="codeph">SPFILE</code>选项中设置初始化参数。
                        </p>
                        <p><a href="rman-duplicating-databases-advanced.html#GUID-CA4E1982-6C0F-4111-A971-96990D4634DC__GUID-A3E1C5B8-E35B-4825-A0C7-A9E3AD4AD1D8" title="Oracle Managed Files的相关初始化参数">表26-3</a>介绍了相关参数和推荐设置。
                        </p>
                        <div class="tblformal" id="GUID-CA4E1982-6C0F-4111-A971-96990D4634DC__GUID-A3E1C5B8-E35B-4825-A0C7-A9E3AD4AD1D8">
                           <p class="titleintable">表26-3 Oracle托管文件的初始化参数</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Oracle托管文件的初始化参数" border="1" summary="Relevant initialization parameters for Oracle Managed Files" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1286">初始化参数</th>
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1289">目的</th>
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1292">建议</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1297" headers="d122325e1286 ">
                                       <p><code class="codeph">DB_CREATE_FILE_DEST</code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1297 d122325e1289 ">
                                       <p>指定Oracle托管数据文件的默认位置。如果未指定<code class="codeph">DB_CREATE_ONLINE_LOG_DEST</code>初始化参数，则此位置也是Oracle托管控制文件和联机日志的缺省位置。
                                       </p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1297 d122325e1292 ">
                                       <p>将此参数设置为OMF的位置。在<code class="codeph">DB_CREATE_FILE_DEST</code>参数指定的目录中创建未指定位置的任何数据库文件。您可以使用<code class="codeph">SET NEWNAME</code>命令覆盖特定文件的默认值，如<span class="q">“ <a href="rman-duplicating-databases-advanced.html#GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA" title="要命名Oracle托管数据文件，可以使用带有TO NEW选项的SET NEWNAME命令而不是TO&#39;filename&#39;选项。RMAN在DB_CREATE_FILE_DEST参数指定的位置创建具有OMF名称的指定数据文件或临时文件。">使用SET NEWNAME命令创建OMF或ASM文件</a> ”中所述</span> 。
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1339" headers="d122325e1286 ">
                                       <p><code class="codeph">DB_CREATE_ONLINE_LOG_DEST_ <span class="codeinlineitalic">n</span></code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1339 d122325e1289 ">
                                       <p>指定Oracle托管控制文件和联机重做日志的默认位置。如果设置了多个参数，则会在每个位置创建一个控制文件和一个联机重做日志。</p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1339 d122325e1292 ">
                                       <p>仅当您要在多个位置多路复用控制文件和联机重做日志文件时，才设置这些参数（_1，_2等）。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1352" headers="d122325e1286 ">
                                       <p><code class="codeph">DB_RECOVERY_FILE_DEST</code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1352 d122325e1289 ">
                                       <p>指定快速恢复区域的默认位置。快速恢复区域包含当前控制文件和联机重做日志文件的多路复用副本。</p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1352 d122325e1292 ">
                                       <p>如果要在恢复区域中使用控制文件和联机重做日志文件的多路复用副本，请设置此参数。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p><a href="rman-duplicating-databases-advanced.html#GUID-CA4E1982-6C0F-4111-A971-96990D4634DC__GUID-4841F1A7-6E5C-49FD-BABD-2ED20BBCA3BC" title="Oracle托管文件的初始化参数限制列表">表26-4</a>列出了设置其他初始化参数的限制。
                        </p>
                        <div class="tblformal" id="GUID-CA4E1982-6C0F-4111-A971-96990D4634DC__GUID-4841F1A7-6E5C-49FD-BABD-2ED20BBCA3BC">
                           <p class="titleintable">表26-4 Oracle托管文件的初始化参数限制</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Oracle托管文件的初始化参数限制" border="1" summary="List of Initialization Parameter Restrictions for Oracle Managed Files" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1379">初始化参数</th>
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1382">目的</th>
                                    <th rowspan="1" colspan="1" align="left" valign="bottom" id="d122325e1385">限制</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1390" headers="d122325e1379 ">
                                       <p><code class="codeph">CONTROL_FILES</code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1390 d122325e1382 ">
                                       <p>指定控制文件的一个或多个名称，以逗号分隔。</p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1390 d122325e1385 ">
                                       <p>如果需要OMF格式的重复数据库控制文件，请不要设置此参数。当您使用OMF格式的控制文件时，Oracle建议您在重复数据库中使用服务器参数文件。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1401" headers="d122325e1379 ">
                                       <p><code class="codeph">DB_FILE_NAME_CONVERT</code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1401 d122325e1382 ">
                                       <p>将主数据库上的新数据文件的文件名转换为重复数据库上的文件名。</p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1401 d122325e1385 ">
                                       <p>不要设置此参数。省略此参数可使数据库为重复数据文件生成有效的Oracle托管文件名。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="1" colspan="1" align="left" valign="top" id="d122325e1412" headers="d122325e1379 ">
                                       <p><code class="codeph">LOG_FILE_NAME_CONVERT</code></p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1412 d122325e1382 ">
                                       <p>将主数据库上的新日志文件的文件名转换为备用数据库上的日志文件的文件名。</p>
                                    </td>
                                    <td rowspan="1" colspan="1" align="left" valign="top" headers="d122325e1412 d122325e1385 ">
                                       <p>不要设置此参数。省略此参数允许数据库生成有效的Oracle托管重做日志文件名。</p>
                                       <p>要将重复的数据库联机重做日志文件定向到Oracle托管存储，可以使用<code class="codeph">DB_CREATE_FILE_DEST</code> ， <code class="codeph">DB_RECOVERY_FILE_DEST</code>或<code class="codeph">DB_CREATE_ONLINE_LOG_DEST_ <span class="codeinlineitalic">n</span></code>初始化参数来标识联机日志的Oracle托管位置。
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-82E9B9C5-74D6-4B22-A03C-2A24930B8A03" name="GUID-82E9B9C5-74D6-4B22-A03C-2A24930B8A03"></a><h5 id="BRADV-GUID-82E9B9C5-74D6-4B22-A03C-2A24930B8A03" class="sect5"><span class="enumeration_section">26.1.2.2</span>设置ASM的初始化参数</h5>
                     <div>
                        <p>您必须确定控制创建文件位置的初始化参数，并将这些参数设置为ASM磁盘组。</p>
                        <p>为ASM位置创建重复数据库的过程类似于向OMF创建重复数据库的过程。例如，将<code class="codeph">DB_CREATE_FILE_DEST</code> ， <code class="codeph">DB_CREATE_ONLINE_DEST_ <span class="codeinlineitalic">n</span></code>和<code class="codeph">CONTROL_FILES</code>参数设置为<code class="codeph">+DISK1</code> 。
                        </p>
                        <div class="infoboxnotealso" id="GUID-82E9B9C5-74D6-4B22-A03C-2A24930B8A03__GUID-520B2CC8-308F-40DD-A677-D0AA782872F8">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="rman-duplicating-databases-advanced.html#GUID-CA4E1982-6C0F-4111-A971-96990D4634DC" title="创建使用OMF的重复数据库时，必须在辅助实例中设置初始化参数。如果使用DUPLICATE命令的SPFILE选项命名文件，则可以在SPFILE选项中设置初始化参数。">OMF初始化参数的设置和限制</a></p>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA" name="GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA"></a><h5 id="BRADV-GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA" class="sect5"><span class="enumeration_section">26.1.2.3</span>示例：将数据库复制到ASM</h5>
                     <div>
                        <p>本节包含有关将数据库复制到ASM的示例。</p>
                        <div class="example" id="GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA__GUID-832F053F-FE17-45D6-9094-829936EB187E">
                           <p class="titleinexample">示例26-4将数据库从文件系统复制到ASM</p>
                           <p>在此示例中，您使用活动数据库复制。如果源数据库使用服务器参数文件（或备份可用），则可以在目标主机上创建临时初始化参数文件，并仅设置<code class="codeph">DB_NAME</code>参数。
                           </p>
                           <p>假设源数据库<code class="codeph">prod</code>在<code class="codeph">host1</code>并将其数据文件存储在非ASM文件系统中。<code class="codeph">prod</code>的控制文件位于<code class="codeph">/oracle/oradata/prod/</code> 。您希望将源数据库复制到远程主机<code class="codeph">host2</code>上的数据库<code class="codeph">dupdb</code> 。您希望将重复的数据库文件存储在ASM磁盘组<code class="codeph">+DISK1</code> 。
                           </p>
                           <p>将RMAN连接到目标，复制和恢复目录数据库后，运行以下RMAN脚本以复制数据库。</p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE to dupdb FROM ACTIVE DATABASE SPFILE PARAMETER_VALUE_CONVERT'/ oracle / oradata / prod /'，'+ DISK1'CET DB_CREATE_FILE_DEST + DISK1;</code></pre><p><code class="codeph">DUPLICATE</code>命令完成后，将创建重复数据库，其中包含ASM磁盘组<code class="codeph">+DISK1</code>数据文件，联机重做日志文件和控制文件。
                           </p>
                        </div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-0FF00823-8A70-4283-8BAD-988C786F5DDA__GUID-C9E585B7-665E-42F8-8B9B-D469D53F4C39">
                           <p class="titleinexample">示例26-5将数据库从ASM复制到ASM</p>
                           <p>在此示例中，您使用活动数据库复制。如果源数据库使用服务器参数文件（或备份可用），则可以在目标主机上创建临时初始化参数文件，并仅设置<code class="codeph">DB_NAME</code>参数。
                           </p>
                           <p>假设源数据库<code class="codeph">prod</code>在<code class="codeph">host1</code>并将其数据文件存储在ASM磁盘组<code class="codeph">+DISK1</code> 。您希望将目标复制到远程主机<code class="codeph">host2</code>上的数据库<code class="codeph">dupdb</code> 。您希望在ASM中存储<code class="codeph">dupdb</code>的数据文件。具体来说，您希望将数据文件和控制文件存储在磁盘组<code class="codeph">+DISK2</code> 。
                           </p>
                           <p>在<code class="codeph">DUPLICATE</code>命令中，设置<code class="codeph">PARAMETER_VALUE_CONVERT</code>以将所有目录位置从<code class="codeph">+DISK1</code>转换为<code class="codeph">+DISK2</code> 。<code class="codeph">+DISK2</code>中的新文件名由ASM生成，与磁盘组<code class="codeph">+DISK1</code>中的原始文件名不匹配。
                           </p>
                           <p>连接到目标数据库，副本数据库和目录数据库后，运行以下RMAN脚本以复制数据库。</p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE to dupdb FROM ACTIVE DATABASE SPFILE PARAMETER_VALUE_CONVERT'+ DISK1'，'+ DISK2'SET DB_RECOVERY_FILE_DEST_SIZE ='750G';</code></pre><p><code class="codeph">DUPLICATE</code>命令完成后，将创建重复数据库，其中包含较大ASM磁盘组<code class="codeph">+DISK2</code>数据文件，联机重做日志和控制文件。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA" name="GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA"></a><h5 id="BRADV-GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA" class="sect5"><span class="enumeration_section">26.1.2.4</span>使用SET NEWNAME命令创建OMF或ASM文件</h5>
                     <div>
                        <p>要命名Oracle托管数据文件，可以使用带有<code class="codeph">TO NEW</code>选项的<code class="codeph">SET NEWNAME</code>命令而不是<code class="codeph">TO ' <span class="codeinlineitalic">filename</span> '</code>选项。RMAN在<code class="codeph">DB_CREATE_FILE_DEST</code>参数指定的位置创建具有OMF名称的指定数据文件或临时文件。
                        </p>
                        <div class="section">
                           <p>要使用<code class="codeph">SET NEWNAME</code>命令为OMF指定名称：</p>
                           <ol>
                              <li>
                                 <p>将辅助实例的<code class="codeph">DB_CREATE_FILE_DEST</code>初始化参数设置为所需位置。
                                 </p>
                              </li>
                              <li>
                                 <p>将<code class="codeph">DUPLICATE</code>命令包含在<code class="codeph">RUN</code>块中，并使用<code class="codeph">SET NEWNAME</code>命令和OMF的<code class="codeph">TO NEW</code>选项。</p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA__GUID-F92206B1-407C-46D9-BD4C-5CCEE29814DB">
                           <p class="titleinexample">示例26-6使用用于DATAFILE的SET NEWNAME和用于TABLESPACE命令的SET NEWNAME复制数据库</p>
                           <p>此示例说明了一个脚本，该脚本指定数据文件1-5的文字名称。源数据库中唯一的Oracle Managed Files是<code class="codeph">users</code>表空间中的数据文件。因此，在<code class="codeph">SET NEWNAME</code>命令中为这些文件指定了<code class="codeph">TO NEW</code>选项。
                           </p><pre class="pre codeblock"><code>运行{TABLESPACE用户的新设置为新用户;将DATAFILE 3的NEWNAME设置为NEW;将DATAFILE 1的NEW NEWNAME设置为'/oradata1/system01.dbf';将DATAFILE 2的NEWNAME设置为'/oradata2/sysaux01.dbf';为TEMPFILE 1设置NEWNAME到'/ oradatat / temp01'; DUPLICATE目标数据库到dupdb SKIP TABLESPACE工具LOGFILE GROUP 1（'/duplogs/redo01a.log','/duplogs/redo01b.log'）SIZE 4M REUSE，GROUP 2（'/duplogs / redo02a.log'，'/ duplogs / redo02b.log'）SIZE 4M REUSE; }</code></pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA__GUID-EB974396-00C3-43A6-B6A1-A532F3A39E50">
                           <p class="titleinexample">示例26-7使用SET NEWNAME命令在ASM磁盘组中创建文件</p>
                           <p>此示例使用<code class="codeph">SET NEWNAME</code>命令将单个数据文件，临时文件或表空间定向到指定的ASM磁盘组。
                           </p><pre class="pre codeblock"><code>运行{为数据文件1设置NEWNAME到“+ DGROUP1”;将DATAFILE 2的NEWNAME设置为“+ DGROUP2”; 。。。DUPLICATE TARGET DATABASE to dupdb FROM ACTIVE DATABASE SPFILE SET DB_CREATE_FILE_DEST + DGROUP3; }</code></pre></div>
                        <!-- class="example" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-B0AA14DA-A617-493B-B764-86A653EC3BEA__GUID-CB28FE6F-6660-4DE1-82C2-479CB07CA833">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="rman-duplicating-databases-advanced.html#GUID-5A858E63-1D33-4B2C-BC92-48B0DFE8DEF2" title="在执行DUPLICATE命令以命名重复数据文件之前，请使用SET NEWNAME命令。">使用SET NEWNAME命令命名文件系统数据文件和临时文件</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-086A9599-15DB-4441-8E02-A939CBC5FF96" name="GUID-086A9599-15DB-4441-8E02-A939CBC5FF96"></a><h5 id="BRADV-GUID-086A9599-15DB-4441-8E02-A939CBC5FF96" class="sect5"><span class="enumeration_section">26.1.2.5</span>使用DB_FILE_NAME_CONVERT参数为非OMF或ASM数据文件生成名称</h5>
                     <div>
                        <p>除了使用<code class="codeph">SET NEWNAME</code>或<code class="codeph">CONFIGURE AUXNAME</code>命令外，还可以使用<code class="codeph">DB_FILE_NAME_CONVERT</code>参数转换目标文件名。您可以在<code class="codeph">DUPLICATE</code>命令中指定<code class="codeph">DB_FILE_NAME_CONVERT</code>选项，也可以在辅助实例的初始化参数文件中设置它。
                        </p>
                        <div class="section">
                           <p>例如，您可以将目标文件名从<code class="codeph">/oracle/</code>目录更改为<code class="codeph">/dup/oracle/</code>目录。<code class="codeph">DB_FILE_NAME_CONVERT</code>参数允许您指定多个转换文件名对。它还可用于为数据文件和临时文件生成名称。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-086A9599-15DB-4441-8E02-A939CBC5FF96__GUID-412E315A-28C3-4CFE-A7EC-6D8A9099FD17">DB_FILE_NAME_CONVERT参数的限制</p>
                           <p>您不能使用<code class="codeph">DUPLICATE</code>命令的<code class="codeph">DB_FILE_NAME_CONVERT</code>选项来控制在源数据库实例的OMF格式的重复实例上生成文件的新名称。
                           </p>
                           <div class="infoboxnotealso" id="GUID-086A9599-15DB-4441-8E02-A939CBC5FF96__GUID-78B27DE3-F3B1-445C-A2A6-B399B5313EFB">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle数据库备份和恢复参考</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-A11B8766-5078-433F-927E-D77314236755" name="GUID-A11B8766-5078-433F-927E-D77314236755"></a><h5 id="BRADV-GUID-A11B8766-5078-433F-927E-D77314236755" class="sect5"><span class="enumeration_section">26.1.2.6</span>使用LOG_FILE_NAME_CONVERT参数为非OMF或ASM日志文件生成名称</h5>
                     <div>
                        <p>如果已省略<code class="codeph">LOG_FILE</code>子句<code class="codeph">DB_RECOVERY_FILE_DEST</code>指定任何OMF初始化参数<code class="codeph">DB_CREATE_FILE_DEST</code> ， <code class="codeph">DB_CREATE_ONLINE_DEST_n</code>或<code class="codeph">DB_RECOVERY_FILE_DEST</code> ，则<code class="codeph">LOG_FILE_NAME_CONVERT</code>参数可以转换目标文件名。这与<code class="codeph">DB_FILE_NAME_CONVERT</code>参数将目标文件名从<code class="codeph">log_*</code>为<code class="codeph">duplog_*</code> 。
                        </p>
                        <div class="section">
                           <p>您可以使用此参数指定多个转换文件名对。指定<code class="codeph">LOG_FILE_NAME_CONVERT</code>参数时，RMAN在创建联机重做日志时使用<code class="codeph">REUSE</code>参数。如果在指定位置存在联机重做日志文件且大小正确，则会将其重复用于复制过程。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-A11B8766-5078-433F-927E-D77314236755__GUID-C845CC21-83E2-4BD5-A37F-18F34696740A">LOG_FILE_NAME_CONVERT参数的限制</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果设置OMF初始化参数，请不要指定<code class="codeph">LOG_FILE_NAME_CONVERT</code>参数。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">LOG_FILE_NAME_CONVERT</code>参数不能在<code class="codeph">DUPLICATE</code>命令中指定为子句，只能在辅助实例的初始化参数中指定。
                                 </p>
                              </li>
                              <li>
                                 <p>您不能使用<code class="codeph">LOG_FILE_NAME_CONVERT</code>初始化参数来控制在源数据库实例的OMF格式的重复实例上生成文件的新名称。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" name="GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13"></a><h3 id="BRADV-GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" class="sect3"><span class="enumeration_section">26.2</span>在没有共享磁盘的情况下使磁盘备份可访问</h3>
               <div>
                  <p>您可以使用共享磁盘技术使备份可用于辅助实例。当NFS或共享磁盘不是一个选项，然后存储该备份必须存在于源<span class="italic">主机</span>和目标主机，除非路径<code class="codeph">BACKUP LOCATION</code>选项用于<code class="codeph">DUPLICATE</code>命令没有目标或恢复目录的连接。
                  </p>
                  <div class="section">
                     <p>假设您维护两个主机， <code class="codeph">srchost</code>和<code class="codeph">dsthost</code> 。<code class="codeph">srchost</code>上的数据库是<code class="codeph">srcdb</code> 。<code class="codeph">srcdb</code>的RMAN备份位于主机<code class="codeph">srchost</code>上的<code class="codeph">/dsk1/bkp</code>目录中。目录主机上正在使用目录<code class="codeph">/dsk1/bkp</code> ，因此您打算将备份存储在目标主机上的<code class="codeph">/dsk2/dup</code>目录中。
                     </p>
                     <p>要将备份从源主机传输到目标主机：</p>
                     <ol>
                        <li>
                           <p>在源主机中创建一个目录，该目录与包含备份的目标主机上的目录同名。</p>
                           <p>例如，如果你打算到RMAN备份在存储<code class="codeph">/dsk2/dup</code>目录中的目标主机上，然后创建<code class="codeph">/dsk2/dup</code>源主机上目录。
                           </p>
                        </li>
                        <li>
                           <div class="p">在源主机上，将备份复制到上一步中创建的目录，然后对备份进行编目。您可以使用以下任一方法：<ul style="list-style-type:disc">
                                 <li>将RMAN作为<code class="codeph">TARGET</code>连接到源数据库，并使用<code class="codeph">BACKUP</code>命令备份备份。例如，使用<code class="codeph">BACKUP COPY OF DATABASE</code>命令将源主机上<code class="codeph">/dsk2/dup</code> <code class="codeph">/dsk1/bkp</code>的备份复制到源主机上的<code class="codeph">/dsk2/dup</code> 。在这种情况下，RMAN会自动对新位置中的备份进行编目。如果要复制PDB，请使用<code class="codeph">BACKUP COPY OF</code>命令的<code class="codeph">PLUGGABLE DATABASE</code>语法仅复制PDB的备份。</li>
                                 <li>使用操作系统实用程序将源主机上<code class="codeph">/dsk2/dup</code> <code class="codeph">/dsk1/bkp</code>目录中的备份复制到源主机上的<code class="codeph">/dsk2/dup</code>目录。然后，将RMAN作为<code class="codeph">TARGET</code>连接到源数据库，并使用<code class="codeph">CATALOG</code>命令使用手动传输的备份的位置更新源控制文件。
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p>手动将源主机上新目录中的备份传输到目标主机上具有相同名称的目录。</p>
                           <p>例如，使用FTP将源主机上<code class="codeph">/dsk2/dup</code>目录中的备份传输到目标主机上的<code class="codeph">/dsk2/dup</code>目录。
                           </p>
                        </li>
                     </ol>辅助通道可以在目标主机上的<code class="codeph">/dsk2/dup</code>目录中搜索备份并还原它们。
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>