<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Oracle Maps is the name for a suite of technologies for developing high-performance interactive web-based mapping applications."></meta>
      <meta name="description" content="Oracle Maps is the name for a suite of technologies for developing high-performance interactive web-based mapping applications."></meta>
      <title>Oracle Maps</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Map Visualization Developer&#39;s Guide "></meta>
      <meta property="og:description" content="Oracle Maps is the name for a suite of technologies for developing high-performance interactive web-based mapping applications."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Map Visualization Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="spatial-and-graph-map-visualization-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T11:37:22-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E94797-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="map-visualization-servers.html" title="Previous" type="text/html"></link>
      <link rel="next" href="oracle-map-builder-tool.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Spatial and Graph Map Visualization Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="JIMPV"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="map-visualization-servers.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="oracle-map-builder-tool.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">地图可视化开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle Maps</li>
            </ol>
            <a id="GUID-9B4DB4C9-5E4B-4776-92F6-84084F65784E" name="GUID-9B4DB4C9-5E4B-4776-92F6-84084F65784E"></a><a id="JIMPV8000"></a>
            
            <h2 id="JIMPV-GUID-9B4DB4C9-5E4B-4776-92F6-84084F65784E" class="sect2"><span class="enumeration_chapter">4</span> Oracle Maps</h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Maps是用于开发基于Web的高性能交互式映射应用程序的一套技术的名称。</p>
               <p><a id="d26950e23" class="indexterm-anchor"></a> Oracle Maps包含在地图可视化组件中。
               </p>
               <p>地图可视化组件允许拥有有效许可并符合地图图块提供商使用条款的用户显示来自这些许可服务的地图图块。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="oracle-maps.html#GUID-0D5BC30A-40AC-4347-89FA-E95D44918E32">Oracle Maps JavaScript API</a><br>Oracle Maps JavaScript客户端是一个基于浏览器的地图可视化引擎，它在地图图块服务器之上工作，并使用HTML5技术。
                  </li>
                  <li class="ulchildlink"><a href="oracle-maps.html#GUID-B0C3C99C-3D0C-4FB7-BCF5-F924A42B56CC">开发Oracle Maps应用程序</a><br>本主题描述如何开发Oracle Maps应用程序。
                  </li>
                  <li class="ulchildlink"><a href="oracle-maps.html#GUID-E3A7A484-B021-459C-8AE9-E7ABBDC04C94">使用谷歌地图</a><br>应用程序可以将Google地图图块显示为内置地图图块图层，方法是在地图窗口中创建并添加<code class="codeph">MVGoogleTileLayer</code>实例。
                  </li>
                  <li class="ulchildlink"><a href="oracle-maps.html#GUID-DB268520-D5AC-4E32-A674-6FB17A21B72B">将数据转换为球形墨卡托坐标系</a><br>流行的在线地图服务（如Google Maps）使用球形墨卡托投影作为其地图。
                  </li>
                  <li class="ulchildlink"><a href="oracle-maps.html#GUID-F1647A8F-CA15-42D2-8037-09B0EA332611">使用动态图块层</a><br><span class="bold">动态切片图层</span>是在客户端定义的切片图层。
                  </li>
               </ul>
            </div>
            <a id="JIMPV9821"></a><div class="props_rev_3"><a id="GUID-0D5BC30A-40AC-4347-89FA-E95D44918E32" name="GUID-0D5BC30A-40AC-4347-89FA-E95D44918E32"></a><h3 id="JIMPV-GUID-0D5BC30A-40AC-4347-89FA-E95D44918E32" class="sect3"><span class="enumeration_section">4.1</span> Oracle Maps JavaScript API</h3>
               <div>
                  <p>Oracle Maps JavaScript客户端是一个基于浏览器的地图可视化引擎，它在地图图块服务器之上工作，并使用HTML5技术。</p>
                  <p>它实现了以下功能：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>从地图图块服务器中获取地图图块，并在Web浏览器中将其显示为地图图块图层。</p>
                     </li>
                     <li>
                        <p>控制用户交互，例如拖动地图导航，单击要素，绘制矩形和红线。</p>
                        <p>绘制矩形是指应用程序用户通过在矩形的一个角上单击并按住鼠标按钮，将鼠标拖动到对角的对角，然后释放鼠标按钮来创建矩形。</p>
                        <p><span class="bold">修订标注</span>是指应用程序用户通过单击鼠标按钮然后移动鼠标并单击多次来创建多边形或折线，每次单击都会将红线延伸一条直线。（红线图纸通常以红色显示，但您可以指定使用任何颜色的线条样式。）
                        </p>
                     </li>
                  </ul>
                  <p>要访问这些函数，请使用JavaScript API，它由几个JavaScript类组成。有关Oracle Maps JavaScript API中所有类的详细信息，请参阅Javadoc样式的参考文档，该文档包含在<code class="codeph">mvdemo.ear</code>文件中，可从以下位置获得： <code class="codeph">http://</code> <span class="italic"><code class="codeph">host:port</code></span> <code class="codeph">/mvdemo/api/oracle_maps_html5_api.jsp</code></p>
                  <p>API的教程和演示可作为具有根上下文路径<code class="codeph">/mvdemo</code>的独立打包应用程序提供。教程从基础开始（显示地图图块层，添加导航面板，显示交互式功能和信息窗口），然后转到更复杂的主题，例如注册事件侦听器，以编程方式创建和使用样式以及空间过滤。
                  </p>
                  <p>这些教程都基于MVDEMO示例数据集（可从Oracle技术网上的地图可视化组件页面获得），并假设名为<code class="codeph">mvdemo</code>的数据源。教程页面有三个面板。左边列出了示例代码或演示标题。单击一个，并在右上方的面板中显示执行该示例代码的结果。底部面板包含标题为JavaScript和HTML的选项卡，分别显示所选演示的JavaScript和HTML代码片段。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-D915B019-4F89-4648-BD93-53CD42D2690E">关于Oracle Maps JavaScript API</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-9B4DB4C9-5E4B-4776-92F6-84084F65784E" title="Oracle Maps是用于开发基于Web的高性能交互式映射应用程序的一套技术的名称。">Oracle Maps</a></p>
                     </div>
                  </div>
               </div>
               <a id="JIMPV9960"></a><div class="props_rev_3"><a id="GUID-D915B019-4F89-4648-BD93-53CD42D2690E" name="GUID-D915B019-4F89-4648-BD93-53CD42D2690E"></a><h4 id="JIMPV-GUID-D915B019-4F89-4648-BD93-53CD42D2690E" class="sect4"><span class="enumeration_section">4.1.1</span>关于Oracle Maps JavaScript API</h4>
                  <div>
                     <p>Oracle Maps JavaScript API利用了现代浏览器和HTML5的功能。它的一些功能包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>内置支持各种第三方地图图块服务，例如maps.oracle.com，Nokia Maps，OpenStreet Maps和其他地图服务提供商</p>
                        </li>
                        <li>
                           <p>丰富的客户端渲染地理空间数据，即时应用渲染样式和效果，如渐变，动画和阴影</p>
                        </li>
                        <li>
                           <p>自动聚集大量点和客户端热图生成</p>
                        </li>
                        <li>
                           <p>基于属性值的客户端特征过滤以及空间谓词（查询窗口）</p>
                        </li>
                        <li>
                           <p>丰富的内置地图控件和工具，包括可自定义的导航栏和信息窗口，可配置的图层控件以及红线和距离测量工具</p>
                        </li>
                     </ul>
                     <p>现有的服务器端预定义样式和主题将与API一起使用。例如，以下代码段基于预定义主题<code class="codeph">mvdemo.customers</code>创建交互式矢量图层，该<code class="codeph">mvdemo.customers</code>具有关联的预定义样式：</p><pre class="oac_no_warn" dir="ltr">var baseURL =“http：//”+ document.location.host +“/ mapviewer”; var layer = new OM.layer。VectorLayer（“layer1”，{def：{type：OM.layer。VectorLayer。TYPE_PREDEFINED，dataSource：“mvdemo”，主题：“customers”，url：baseURL}}）;</pre><p>API具有以下顶级类和子包，所有这些都在命名空间<code class="codeph">OM</code> ：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">Map</code>类是API的主要类。</p>
                        </li>
                        <li>
                           <p><code class="codeph">Feature</code>类表示各个地理<code class="codeph">Feature</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">MapContext</code>类是封装一些基本上下文信息的顶级类，例如当前地图中心点和缩放级别。它通常被传递给事件监听器。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">control</code>包包含所有地图控件，例如导航栏和概览图。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">event</code>包包含所有地图和图层事件类。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">filter</code>包包含用于选择或子集化所显示的矢量图层要素的所有客户端过滤器（空间或关系）。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">geometry</code>包包含各种几何类。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">layer</code>包包含各种图块和矢量图层类。切片图层类包括访问一些在线地图服务，如Oracle，Nokia和OpenStreetMap。矢量图层是交互式要素图层。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">infowindow</code>包中包含可自定义的信息窗口及其样式。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">style</code>包包含适用于客户端矢量数据的样式。它还包括视觉效果，如动画，渐变和阴影。
                           </p>
                        </li>
                        <li>
                           <p>该<code class="codeph">tool</code>包包含各种地图工具，例如用于距离测量，红线和几何图形。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">universe</code>包中包含内置或预定义的<span class="italic">地图Universe</span> 。地图Universe定义地图内容的边界框和缩放级别定义集。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">util</code>包包含各种实用程序类。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">visualfilter</code>包为各种视觉效果提供了界面，例如渐变和阴影。
                           </p>
                        </li>
                     </ul>
                     <p><code class="codeph">OM.Map</code>是Web浏览器中所有地图操作的主要入口类。此类和其他类提供用于在Web制图应用程序中添加特定于应用程序的逻辑，操作和交互性的接口。应用程序逻辑和操作可包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>创建一个地图客户端实例，并将其与网页中创建的地图容器DIV对象相关联。</p>
                        </li>
                        <li>
                           <p>配置地图参数，例如地图中心和地图缩放级别。</p>
                        </li>
                        <li>
                           <p>（可选）创建和操作地图图块图层。不需要地图图块层。应用程序只能使用自定义Universe的交互式矢量图层，以编程方式定义缩放级别和比例。</p>
                        </li>
                        <li>
                           <p>创建和操作矢量图层。</p>
                        </li>
                        <li>
                           <p>在地图上显示信息窗口。</p>
                        </li>
                        <li>
                           <p>创建固定的地图装饰，例如地图标题，版权注释和地图控件。</p>
                        </li>
                        <li>
                           <p>访问内置实用程序，例如导航面板，矩形或圆形工具，比例尺和总览图面板。</p>
                        </li>
                        <li>
                           <p>使用事件侦听器来自定义事件处理，从而映射交互。</p>
                        </li>
                     </ul>
                     <p>有关使用Oracle Maps API的其他说明和注意事项：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>先前版本的API中的“FOI服务器”现在是数据服务器，其将要素的向量几何和属性流式传输到客户端以进行本地呈现。因此，先前版本中的“FOI层”现在称为<span class="bold">矢量层</span> 。
                           </p>
                        </li>
                        <li>
                           <p>为了显示交互式矢量图层，不需要背景地图图块层。例如，应用程序可以显示状态的专题图（例如，按人口五分之一填充颜色），没有背景图块层。</p>
                        </li>
                        <li>
                           <p>API依赖于并包含<code class="codeph">JQuery</code>和<code class="codeph">JQueryUI</code> 。因此， <code class="codeph">oraclemapsv2.js</code>包括<code class="codeph">jquery-1.7.2.min.js</code>和<code class="codeph">jquery-ui-1.8.16.min.js</code> 。如果您的应用程序也使用JQuery和JQueryUI并且已经包含它们，那么使用<code class="codeph">&lt;script&gt;</code>标记中的文件<code class="codeph">oraclemapsv2_core.js</code>来加载Oracle Maps库。也就是说，使用以下内容：</p>
                           <p><code class="codeph">&lt;script src =“/ mapviewer / jslib / v2 / oraclemapsv2_core.js”&gt; &lt;/ script&gt;</code></p>
                           <p>代替：</p>
                           <p><code class="codeph">&lt;script src =“/ mapviewer / jslib / v2 / oraclemapsv2.js”&gt; &lt;/ script&gt;</code></p>
                        </li>
                     </ul>
                     <p>有关使用API开发应用程序的信息，请参阅<a href="oracle-maps.html#GUID-B0C3C99C-3D0C-4FB7-BCF5-F924A42B56CC" title="本主题描述如何开发Oracle Maps应用程序。">开发Oracle Maps应用程序</a>和Oracle提供的教程和演示。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-0D5BC30A-40AC-4347-89FA-E95D44918E32" title="Oracle Maps JavaScript客户端是一个基于浏览器的地图可视化引擎，它在地图图块服务器之上工作，并使用HTML5技术。">Oracle Maps JavaScript API</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="JIMPV9822"></a><div class="props_rev_3"><a id="GUID-B0C3C99C-3D0C-4FB7-BCF5-F924A42B56CC" name="GUID-B0C3C99C-3D0C-4FB7-BCF5-F924A42B56CC"></a><h3 id="JIMPV-GUID-B0C3C99C-3D0C-4FB7-BCF5-F924A42B56CC" class="sect3"><span class="enumeration_section">4.2</span>开发Oracle Maps应用程序</h3>
               <div>
                  <p>本主题描述如何开发Oracle Maps应用程序。</p>
                  <p>如果在Oracle数据库中管理基础底图和图层，则客户端应用程序中显示的每个地图图块层必须在USER_SDO_CACHED_MAPS元数据视图中具有相应的数据库元数据条目（在<a href="map-visualization-concepts.html#GUID-820FD52E-E02D-4371-B85B-88B76FAC50FF">xxx_SDO_CACHED_MAPS视图中</a>描述）。同样，如果交互层基于数据库内容，则它必须在USER_SDO_THEMES视图中具有元数据条目（在<a href="map-visualization-concepts.html#GUID-565BF7E3-C504-4CDC-88B0-E1ACC67300E5" title="描述基本映射，主题和样式的映射元数据存储在由MDSYS拥有的全局表SDO_MAPS_TABLE，SDO_THEMES_TABLE和SDO_STYLES_TABLE中。">Map Visualizer元数据视图中</a>描述，尤其是<a href="map-visualization-concepts.html#GUID-BB3EC523-0FE9-47DD-994F-D3B8726F2347">xxx_SDO_THEMES视图</a> ）。可以使用Map Builder工具（在<a href="oracle-map-builder-tool.html#GUID-17324FF4-9AA2-4182-93B7-B7999737FA67" title="本章简要介绍了地图可视化组件Map Builder工具，也称为Oracle Map Builder。它不提供有关工具界面的详细信息;为此，您应该使用Oracle Map Builder时可以使用的在线帮助。">Oracle Map Builder工具中</a>描述）定义这些切片和交互层以及它们的样式和样式规则。
                  </p>
                  <p>要使用API开发Oracle Maps应用程序，请执行以下基本步骤：</p>
                  <ol>
                     <li>
                        <p>导入<code class="codeph">oraclemapsv2.js</code>库。
                        </p>
                        <p>API在单个JavaScript库中提供，该库作为地图可视化组件EAR存档的一部分打包。</p>
                     </li>
                     <li>
                        <p>部署并启动地图可视化组件后，通过<code class="codeph">&lt;script&gt;</code>标记加载库，例如：</p><pre class="oac_no_warn" dir="ltr">&lt;script type =“text / javascript”url =“http：// localhost：8080 / mapviewer / jslib / v2 / oraclemapsv2.js”/&gt;</pre><div class="infoboxnote" id="GUID-B0C3C99C-3D0C-4FB7-BCF5-F924A42B56CC__GUID-70DFA383-4218-44F0-AFB1-AACA1D9D4B38">
                           <p class="notep1">注意：</p>
                           <p>如果你需要一个特定的jQuery版本而不是<code class="codeph">oraclemapsv2.js</code>打包的<code class="codeph">oraclemapsv2.js</code> （如前面的例子所示），那么你可以先添加你喜欢的jQuery，然后再添加一个库列表。例如：</p><pre class="oac_no_warn" dir="ltr">&lt;script src =“ <span class="italic">your_preferred_jQuery_library_listed_here_first</span> .js”&gt; &lt;/ script&gt; &lt;script src =“v2 / jquery / jquery.hammer-full.min.js”&gt; &lt;/ script&gt; &lt;script src =“v2 / jquery / jquery.i18n .properties-min-1.0.9.js“&gt; &lt;/ script&gt; &lt;script src =”v2 / jquery / jquery.mousewheel.min.js“&gt; &lt;/ script&gt; &lt;script src =”v2 / rtree / rtree-min .js“&gt; &lt;/ script&gt; &lt;script src =”v2 / fortknox-libs / fortknox-canvas.js“&gt; &lt;/ script&gt; &lt;script src =”v2 / oraclemapsv2_core.js“&gt; &lt;/ script&gt;</pre></div>
                     </li>
                     <li>
                        <p>在HTML页面中创建一个<code class="codeph">&lt;DIV&gt;</code>标记，该标记将包含交互式地图。
                        </p>
                     </li>
                     <li>
                        <p>创建将处理所有地图显示功能的客户端地图实例。</p>
                        <p>该类名为<code class="codeph">OM.Map</code> ，是API的主要入口点。</p>
                     </li>
                     <li>
                        <p>设置地图Universe（除非您还执行可选的下一步）。</p>
                        <p>地图Universe基本上定义了每个缩放级别的整体地图范围，缩放级别数以及可选的分辨率（以每个像素为单位的地图单位）。请注意，为了显示交互式矢量图层或主题，不需要预定义图块层。例如，按地区划分的销售互动专题地图不需要具有背景地图或平铺图层。</p>
                     </li>
                     <li>
                        <p>（可选）添加用作背景地图的切片图层。</p>
                        <p>切片图层可以来自数据库，例如<code class="codeph">mvdemo.demo_map</code> ，也可以来自支持的服务，例如诺基亚地图。添加切片图层也隐式定义了地图Universe，因此在这种情况下不需要执行上一步（设置地图Universe）。
                        </p>
                     </li>
                     <li>
                        <p>添加一个或多个交互式矢量图层。</p>
                        <p><code class="codeph">OM.VectorLayer</code>使用HTML5（Canvas或SVG）技术渲染浏览器中的所有数据。因此，除非另有说明，否则所有矢量图层内容都会加载一次，并且在地图缩放或平移操作中没有后续数据库查询或数据提取。
                        </p>
                     </li>
                     <li>
                        <p>添加一个或多个地图控件，工具和其他特定于应用程序的UI控件，以便用户可以设置显示的图层，样式和视觉效果。</p>
                     </li>
                  </ol>
                  <p>如果您需要阻止主题在默认情况下进行流式传输，则必须通过添加身份验证来保护它们，即通过在地图可视化组件<code class="codeph">web.xml</code>文件中添加安全性约束并通过配置<code class="codeph">mds.xml</code>文件来授权访问各种主题。有关信息，请参阅<a href="introduction-to-map-visualization-component.html#GUID-DA9FF5B5-17C1-472C-B6EF-B968869BA21F">为HTML5 API配置和保护Map数据服务器</a> 。</p>
                  <p>有关使用API的详细说明和相关信息，请参阅Oracle提供的教程和演示。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-1030CA92-20CB-4800-A59A-62A8CF065629">使用API创建客户端应用程序</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-9B4DB4C9-5E4B-4776-92F6-84084F65784E" title="Oracle Maps是用于开发基于Web的高性能交互式映射应用程序的一套技术的名称。">Oracle Maps</a></p>
                     </div>
                  </div>
               </div>
               <a id="JIMPV10133"></a><div class="props_rev_3"><a id="GUID-1030CA92-20CB-4800-A59A-62A8CF065629" name="GUID-1030CA92-20CB-4800-A59A-62A8CF065629"></a><h4 id="JIMPV-GUID-1030CA92-20CB-4800-A59A-62A8CF065629" class="sect4"><span class="enumeration_section">4.2.1</span>使用API创建客户端应用程序</h4>
                  <div>
                     <p>Oracle Maps应用程序在Web浏览器中运行，只需要支持HTML5（Canvas）支持和JavaScript。不需要额外的插件。</p>
                     <p>Oracle Maps应用程序的源代码通常打包在HTML页面中，该页面包含以下部分：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>一个<code class="codeph">&lt;script&gt;</code>元素，用于将Oracle Maps客户端库加载到浏览器的JavaScript引擎中。例如：</p><pre class="oac_no_warn" dir="ltr">&lt;script src =“/ mapviewer / jslib / v2 / oraclemapsv2.js”&gt; &lt;/ script&gt;</pre></li>
                        <li>
                           <p>包含地图的HTML <code class="codeph">&lt;div&gt;</code>元素。例如：</p><pre class="oac_no_warn" dir="ltr">&lt;div id =“map”style =“width：600px; height：500px”&gt; &lt;/ div&gt;</pre></li>
                        <li>
                           <p>用于创建地图客户端实例并设置初始地图内容（平铺和矢量图层），初始中心和缩放以及地图控件的JavaScript代码。此代码应打包在一个函数中，该函数在加载或准备好HTML页面时执行。该函数在HTML页面的<code class="codeph">&lt;body&gt;</code>元素的<code class="codeph">onload</code>属性中指定。例如：</p><pre class="oac_no_warn" dir="ltr">function on_load_mapview（）{var baseURL =“http：//”+ document.location.host +“/ mapviewer”; //创建一个OM.Map实例来显示地图var mapview = new OM.Map（document.getElementById（“map”），{mapviewerURL：baseURL}）; //添加地图图块层作为背景。var tileLayer = new OM.layer。TileLayer（“baseMap”，{dataSource：“mvdemo”，tileLayer：“demo_map”，tileServerURL：baseURL +“/ mcserver”}）; mapview.addLayer（tileLayer）; //设置初始地图中心和缩放级别var mapCenterLon = -122.45; var mapCenterLat = 37.7706; var mapZoom = 4; var mpoint = new OM.geometry。点（mapCenterLon，mapCenterLat，8307）; mapview.setMapCenter（M点）; mapview.setMapZoomLevel（mapZoom）; //添加基于主题的FOI图层以在地图上显示客户customersLayer = new OM.layer。VectorLayer（“客户”，{def：{type：OM.layer。VectorLayer。TYPE_PREDEFINED，dataSource：“mvdemo”，主题：“customers”，url：baseURL，loadOnDemand：false}}）; mapview.addLayer（customersLayer）; //在地图右侧添加导航面板var navigationPanelBar = new OM.control。NavigationPanelBar（）; navigationPanelBar.setStyle（{backgroundColor：“＃FFFFFF”，buttonColor：“＃008000”，大小：12}）; mapview.addMapDecoration（navigationPanelBar）; //添加比例尺var mapScaleBar = new OM.control。比例尺（）; mapview.addMapDecoration（mapScaleBar）; //显示地图。//初始化和显示只进行一次。mapview.init（）; }</pre></li>
                        <li>
                           <p>其他HTML元素和JavaScript代码，用于实现其他特定于应用程序的用户界面和控制逻辑。例如，HTML <code class="codeph">&lt;input&gt;</code>元素和JavaScript函数<code class="codeph">setLayerVisible</code>一起实现了层可见性控制。<code class="codeph">setLayerVisible</code>函数编码如下：</p><pre class="oac_no_warn" dir="ltr">function setLayerVisible（checkBox）{//如果选中复选框则显示customers vector layer，否则//隐藏它。if（checkBox.checked）customersLayer.setVisible（true）; else customersLayer.setVisible（false）; }</pre><p>该函数在定义复选框的<code class="codeph">&lt;input&gt;</code>元素的<code class="codeph">onclick</code>属性中指定。在以下示例中，只要用户单击Show Customers复选框，就会执行该函数：</p><pre class="oac_no_warn" dir="ltr">&lt;INPUT TYPE =“复选框”onclick =“setLayerVisible（this）”选中/&gt;显示客户</pre></li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-B0C3C99C-3D0C-4FB7-BCF5-F924A42B56CC" title="本主题描述如何开发Oracle Maps应用程序。">开发Oracle Maps应用程序</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="JIMPV9942"></a><div class="props_rev_3"><a id="GUID-E3A7A484-B021-459C-8AE9-E7ABBDC04C94" name="GUID-E3A7A484-B021-459C-8AE9-E7ABBDC04C94"></a><h3 id="JIMPV-GUID-E3A7A484-B021-459C-8AE9-E7ABBDC04C94" class="sect3"><span class="enumeration_section">4.3</span>使用谷歌地图</h3>
               <div>
                  <p>应用程序可以将Google地图图块显示为内置地图图块图层，方法是在地图窗口中创建并添加<code class="codeph">MVGoogleTileLayer</code>实例。
                  </p>
                  <p>在内部，Oracle Maps客户端使用官方Google Maps API显示由Google Maps服务器直接提供的地图。</p>
                  <p>要使用Google地图图块，您对图块的使用必须符合Google指定的服务条款（请参阅<a href="https://developers.google.com/readme/terms" target="_blank"><code class="codeph">https://developers.google.com/readme/terms</code></a> ）。</p>
                  <p>如果您需要在Google地图图块层上叠加自己的空间数据，请参阅<a href="oracle-maps.html#GUID-DB268520-D5AC-4E32-A674-6FB17A21B72B" title="流行的在线地图服务（如Google Maps）使用球形墨卡托投影作为其地图。">将数据转换为球形墨卡托坐标系</a> 。）
                  </p>
                  <p>以下部分描述了使用内置地图图块层的两个选项。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-CEBF1805-101D-4B7C-A051-641A71BFBCBC">在客户端定义Google Maps图块层</a><br></li>
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-104759F3-E7AA-41B2-A1E4-6BD76FA66399">在服务器端定义内置地图图块层</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-9B4DB4C9-5E4B-4776-92F6-84084F65784E" title="Oracle Maps是用于开发基于Web的高性能交互式映射应用程序的一套技术的名称。">Oracle Maps</a></p>
                     </div>
                  </div>
               </div>
               <a id="JIMPV9943"></a><div class="props_rev_3"><a id="GUID-CEBF1805-101D-4B7C-A051-641A71BFBCBC" name="GUID-CEBF1805-101D-4B7C-A051-641A71BFBCBC"></a><h4 id="JIMPV-GUID-CEBF1805-101D-4B7C-A051-641A71BFBCBC" class="sect4"><span class="enumeration_section">4.3.1</span>在客户端定义Google Maps图块层</h4>
                  <div>
                     <p>要在客户端定义内置地图图块层，您需要创建<code class="codeph">MVGoogleTileLayer</code>对象，并将其添加到MVMapView对象。（截至Oracle融合中间件版本<code class="codeph">MVGoogleTileLayer</code> ， <code class="codeph">MVGoogleTileLayer</code>使用Google Maps版本3 API。）
                     </p>
                     <p>例如，要使用Google磁贴，请将Google磁贴图层添加到地图中：</p><pre class="oac_no_warn" dir="ltr">mapview = new MVMapView（document.getElementById（“map”），baseURL）; tileLayer =新的MVGoogleTileLayer（）; mapview.addMapTileLayer（tileLayer）;</pre><p>在应用程序中，您可以调用<code class="codeph">MVGoogleTileLayer.setMapType</code>方法将地图类型设置为地图提供程序支持的类型之一，例如道路，卫星或混合。
                     </p>
                     <p>有关使用示例和更多信息，请参阅<code class="codeph">MVGoogleTileLayer</code>的JavaScript API文档以及<span class="italic">内置Google Maps Tile Layer</span>的教程演示。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-E3A7A484-B021-459C-8AE9-E7ABBDC04C94" title="应用程序可以将Google地图图块显示为内置地图图块图层，方法是在地图窗口中创建并添加MVGoogleTileLayer实例。">使用Google地图</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="JIMPV9944"></a><div class="props_rev_3"><a id="GUID-104759F3-E7AA-41B2-A1E4-6BD76FA66399" name="GUID-104759F3-E7AA-41B2-A1E4-6BD76FA66399"></a><h4 id="JIMPV-GUID-104759F3-E7AA-41B2-A1E4-6BD76FA66399" class="sect4"><span class="enumeration_section">4.3.2</span>在服务器端定义内置地图图块层</h4>
                  <div>
                     <p>您可以在元数据中的服务器端定义内置地图切片图层（也称为外部切片图层），并将其用作客户端上的常规地图可视化组件切片图层。要在服务器端定义内置地图图块层，请按照下列步骤操作：</p>
                     <ol>
                        <li>
                           <p>登录到地图可视化组件管理页面（在“ <a href="introduction-to-map-visualization-component.html#GUID-2191CCA7-AC00-4E8C-9011-D27CE3E50CDC">登录到地图可视化组件管理”页面中进行了说明</a> ）。
                           </p>
                        </li>
                        <li>
                           <p>选择Admin选项卡，然后单击<span class="bold">Create tile layer</span> 。
                           </p>
                        </li>
                        <li>
                           <p>对于<span class="bold">Tile Layer Type</span> ，选择Oracle Maps，Google Maps，HERE Maps，OpenStreet Maps，Tomtom Maps或LocationBox Maps，然后单击<span class="bold">Next</span> 。
                           </p>
                        </li>
                        <li>
                           <p>为此外部切片图层（例如GOOGLE_MAP）提供名称，然后选择要存储切片图层定义的数据源。</p>
                        </li>
                        <li>
                           <p>设置从地图提供程序获取的许可证密钥和其他相关属性（详细信息可用于特定外部切片图层），然后单击“ <span class="bold">下一步”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>查看外部切片图层的XML描述。您可以单击“ <span class="bold">上一步”</span>转到<span class="bold">上一页</span>进行更改。
                           </p>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">提交”</span>以创建切片图层。
                           </p>
                        </li>
                     </ol>
                     <p>在服务器端创建内置地图图块层后，您可以像使用MapViewer提供的任何其他图块层一样使用它。您无需添加任何<code class="codeph">&lt;script&gt;</code>标记来加载外部JavaScript库。
                     </p>
                     <p>以下代码片段显示了服务器端定义的Google地图图块层：</p><pre class="oac_no_warn" dir="ltr">var tileLayer = new OM.layer。TileLayer（“google1”，{dataSource：“mvdemo”，tileLayer：“GOOGLE_MAP”}）; map.addLayer（tileLayer）;</pre><div class="infoboxnote" id="GUID-104759F3-E7AA-41B2-A1E4-6BD76FA66399__GUID-E6D2FA26-99F4-4B37-A3BF-9FFE1CB5E2D2">
                        <p class="notep1">注意：</p>
                        <p>每个内置切片图层都有自己的特定属性。您可能需要向服务提供商咨询要求。</p>
                        <p>如果要使用Google地图，您可能需要提供以下属性：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">key</code> ：您从Google地图获取的密钥。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">client</code> ：客户端ID，您可以从Google地图获取的可选属性。提供客户端ID时仍需要密钥属性。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">lib_url</code> ：Google Maps API网址，例如： <code class="codeph">http://maps.google.com/maps/api/js?sensor=false</code> ： <code class="codeph">lib_url</code> 。如果未提供，将使用默认值。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">version</code> ：当前API版本为3。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">mapTyelList</code> ，可以提供地图类型列表：MVGoogleTileLayer。TYPE_ROAD; MVGoogleTileLayer。TYPE_SHADED; MVGoogleTileLayer。TYPE_SATELLITE; MVGoogleTileLayer。TYPE_HYBRID。</p>
                           </li>
                           <li>
                              <p><code class="codeph">mapTypeVisible</code> ，布尔值<code class="codeph">true</code>或<code class="codeph">false</code>值，指示是否显示地图类型按钮以选择地图类型。
                              </p>
                           </li>
                        </ul>
                        <p></p>
                     </div>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-E3A7A484-B021-459C-8AE9-E7ABBDC04C94" title="应用程序可以将Google地图图块显示为内置地图图块图层，方法是在地图窗口中创建并添加MVGoogleTileLayer实例。">使用Google地图</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="JIMPV9945"></a><div class="props_rev_3"><a id="GUID-DB268520-D5AC-4E32-A674-6FB17A21B72B" name="GUID-DB268520-D5AC-4E32-A674-6FB17A21B72B"></a><h3 id="JIMPV-GUID-DB268520-D5AC-4E32-A674-6FB17A21B72B" class="sect3"><span class="enumeration_section">4.4</span>将数据转换为球形墨卡托坐标系</h3>
               <div>
                  <p>流行的在线地图服务（如Google Maps）使用球形墨卡托投影作为其地图。</p>
                  <p>如果您使用的是早于11.1.0.7的Oracle数据库版本，并且需要在这样的图块层（例如Google地图图块层）之上叠加自己的空间数据，则必须设置数据库以正确处理坐标如果两个坐标系不相同，则该瓦片层的坐标系与您自己的数据坐标系之间的系统转换。</p>
                  <div class="infoboxnote" id="GUID-DB268520-D5AC-4E32-A674-6FB17A21B72B__GUID-5D55AE6D-7924-4B42-A358-DF9F5209DD37">
                     <p class="notep1">注意：</p>
                     <p>要执行本节中的操作，您的数据库必须是版本10.2.0.1或更高版本。</p>
                  </div>
                  <p>谷歌地图使用球形墨卡托坐标系统（EPSG：3785），它也广泛用于商业API提供商，如雅虎！地图。在版本11.1.0.7之前，Oracle Spatial and Graph未提供此坐标系（SRID 3785）。为了使地图可视化组件，地图可视化组件和Oracle Spatial and Graph能够将您自己的数据转换为此坐标系，您必须首先将此坐标系定义添加到Oracle数据库中（如果尚未定义）。</p>
                  <p>要检查是否已定义此坐标系，可以输入以下语句：</p><pre class="oac_no_warn" dir="ltr">SELECT srid FROM mdsys.cs_srs WHERE srid = 3785;</pre><p>如果前面的语句返回一行，则无需执行本节中的操作。如果前面的语句未返回行，则必须执行本节中的操作，以便能够在切片图层顶部叠加您自己的空间数据。</p>
                  <p>跟着这些步骤：</p>
                  <ol>
                     <li>
                        <p>以特权用户身份连接到数据库，例如具有DBA角色的用户。</p>
                     </li>
                     <li>
                        <p>运行<code class="codeph">csdefinition.sql</code>脚本，如下所示。（将<span class="italic"><code class="codeph">$MAPVIEWER_HOME</code></span>替换<span class="italic"><code class="codeph">$MAPVIEWER_HOME</code></span>的WebLogic Server实例的根目录，并在一行中输入命令。）
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>Linux： <span class="italic"><code class="codeph">$MAPVIEWER_HOME</code></span> <code class="codeph">/j2ee/home/applications/mapviewer/web/WEB-INF/admin/csdefinition.sql</code></p>
                           </li>
                           <li>
                              <p>Windows： <span class="italic"><code class="codeph">$MAPVIEWER_HOME</code></span> <code class="codeph">\j2ee\home\applications\mapviewer\web\WEB-INF\admin\csdefinition.sql</code></p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>如有必要，创建转换规则以使Oracle Spatial and Graph在将数据从指定坐标系转换为Spherical Mercator系统时跳过数据转换。要了解是否需要创建此类转换规则，请参阅<a href="oracle-maps.html#GUID-46480CF4-3E2C-483C-ADD3-410D34E56C8A">创建转换规则以跳过基准转换</a> 。
                        </p>
                     </li>
                     <li>
                        <p>要么预先转换空间数据以获得更好的性能，要么让地图可视化组件在运行时（“动态”）转换数据。请注意，如果数据库版本早于10.2.0.4，则预转换是唯一的选择。</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要将所有数据预转换为球形墨卡托坐标系，请对所有数据使用SDO_CS.TRANSFORM_LAYER过程，并使用转换后的数据进行映射。（请参阅<a href="../spatl/SDO_CS-reference.html#SPATL1076" target="_blank"><span class="italic">Oracle Spatial and Graph Developer's Guide中</span></a>的SDO_CS.TRANSFORM_LAYER参考部分。）
                              </p>
                           </li>
                           <li>
                              <p>要让地图可视化组件在运行时转换数据，请在使用数据进行映射之前不要转换数据。</p>
                           </li>
                        </ul>
                     </li>
                  </ol>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-46480CF4-3E2C-483C-ADD3-410D34E56C8A">创建转换规则以跳过基准转换</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-9B4DB4C9-5E4B-4776-92F6-84084F65784E" title="Oracle Maps是用于开发基于Web的高性能交互式映射应用程序的一套技术的名称。">Oracle Maps</a></p>
                     </div>
                  </div>
               </div>
               <a id="JIMPV9947"></a><a id="JIMPV9946"></a><div class="props_rev_3"><a id="GUID-46480CF4-3E2C-483C-ADD3-410D34E56C8A" name="GUID-46480CF4-3E2C-483C-ADD3-410D34E56C8A"></a><h4 id="JIMPV-GUID-46480CF4-3E2C-483C-ADD3-410D34E56C8A" class="sect4"><span class="enumeration_section">4.4.1</span>创建转换规则以跳过基准转换</h4>
                  <div>
                     <p>空间数据通常位于基于椭球数据的坐标系中，例如WGS84或BNG。在这种情况下，Oracle Spatial and Graph默认情况下在将数据转换为Spherical Mercator系统时应用基准转换。这会在您的数据与Google地图其他地图服务图块之间引入少量不匹配或错误。如果要解决此问题，可以创建转换规则，告知Oracle Spatial and Graph在将数据从指定坐标系转换为Spherical Mercator系统时跳过数据转换。</p>
                     <p><a href="oracle-maps.html#GUID-46480CF4-3E2C-483C-ADD3-410D34E56C8A__BACCFFFA">示例4-1</a>显示了包含在<code class="codeph">csdefinition.sql</code>脚本中并创建此类转换规则的SQL语句。但是，如果<a href="oracle-maps.html#GUID-46480CF4-3E2C-483C-ADD3-410D34E56C8A__BACCFFFA">示例4-1中</a>显示的规则未涵盖空间数据的坐标系，则可以在这些规则未涵盖数据坐标系的情况下创建自己的规则。（有关创建坐标系转换规则的更多信息，请参阅<a href="../spatl/coordinate-systems-concepts.html#SPATL054" target="_blank"><span class="italic">Oracle Spatial and Graph Developer's Guide</span></a> 。）
                     </p>
                     <div class="example" id="GUID-46480CF4-3E2C-483C-ADD3-410D34E56C8A__BACCFFFA">
                        <p class="titleinexample">示例4-1 csdefinition.sql脚本中定义的转换规则</p><pre class="oac_no_warn" dir="ltr">- 创建tfm_plans，即转换规则。- 注意：这将导致错误的转换，因为它忽略了椭圆体和球体之间的基准面 - 基准面。但是，数据会在Google地图上更好地匹配。- 对于wgs84（8307），调用sdo_cs.create_pref_concatenated_op（83073785，'CONCATENATED OPERATION 8307 3785'，TFM_PLAN（SDO_TFM_CHAIN（8307,1000000000,4055,19847,3785）），NULL）; - 对于4326，EPSG等效于8307，调用sdo_cs.create_pref_concatenated_op（43263785，'CONCATENATED_OPERATION_4326_3785'，TFM_PLAN（SDO_TFM_CHAIN（4326,1000000000,4055,19847,3785）），NULL）; - 对于OS BNG，Oracle SRID 81989调用sdo_cs.create_pref_concatenated_op（819893785，'CONCATENATED OPERATION 81989 3785'，TFM_PLAN（SDO_TFM_CHAIN（81989，-19916,2000021,1000000000,4055,19847,3785）），NULL）; - 对于27700，EPSG等效于81989，调用sdo_cs.create_pref_concatenated_op（277003785，'CONCATENATED_OPERATION_27700_3785'，TFM_PLAN（SDO_TFM_CHAIN（27700，-19916,4277,1000000000,4055,19847,3785）），NULL）;承诺;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-DB268520-D5AC-4E32-A674-6FB17A21B72B" title="流行的在线地图服务（如Google Maps）使用球形墨卡托投影作为其地图。">将数据转换为球形墨卡托坐标系</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-F1647A8F-CA15-42D2-8037-09B0EA332611" name="GUID-F1647A8F-CA15-42D2-8037-09B0EA332611"></a><h3 id="JIMPV-GUID-F1647A8F-CA15-42D2-8037-09B0EA332611" class="sect3"><span class="enumeration_section">4.5</span>使用动态图块层</h3>
               <div>
                  <p><span class="bold">动态切片图层</span>是在客户端定义的切片图层。
                  </p>
                  <p>动态切片图层与常规切片图层的区别在于以下方式：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>它由客户端应用程序定义，因此不需要在USER_SDO_CACHED_MAPS元数据中预定义。</p>
                     </li>
                     <li>
                        <p>服务器不缓存地图图块。</p>
                     </li>
                     <li>
                        <p>当提供地图图块图像URL生成功能时，它可以使用第三方地图服务。</p>
                     </li>
                  </ul>
                  <p>因此，动态图块层可以由客户端应用程序动态地定义，并且地图图像可以来自地图可视化组件服务器或来自第三方地图服务。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-9D06150F-FECD-4982-BDF5-C514F309A1AB">为动态磁贴层创建Universe和配置实例</a><br></li>
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-B8F07CD7-3B9B-4C8A-9CF1-2E247498ADC1">使用基本地图创建动态平铺图层</a><br></li>
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-D66B53D6-9F3D-45CA-92F5-4F5E40C0B9C7">使用预定义主题创建动态切片层</a><br></li>
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-B515D9FC-C99B-4660-B4C2-FFF5570E7054">直接使用空间表创建动态切片层</a><br></li>
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-66199642-3D36-47F4-BB45-02943A10EF42">使用第三方地图服务创建动态图块层</a><br></li>
                     <li class="ulchildlink"><a href="oracle-maps.html#GUID-31918E3F-96F8-41E6-B835-5796714DC54F">动态图块层用例</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-9B4DB4C9-5E4B-4776-92F6-84084F65784E" title="Oracle Maps是用于开发基于Web的高性能交互式映射应用程序的一套技术的名称。">Oracle Maps</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-9D06150F-FECD-4982-BDF5-C514F309A1AB" name="GUID-9D06150F-FECD-4982-BDF5-C514F309A1AB"></a><h4 id="JIMPV-GUID-9D06150F-FECD-4982-BDF5-C514F309A1AB" class="sect4"><span class="enumeration_section">4.5.1</span>为动态切片层创建Universe和配置实例</h4>
                  <div>
                     <p>在创建动态切片图层实例之前，必须为动态切片图层创建Universe和切片图层配置。</p>
                     <p>例如，假设已正确定义名为baseURL的变量（例如http://myapp.mycorp.com/mapviewer）并且指定的数据源存在。您必须创建切片图层配置实例和Universe实例。您可以使用Oracle Maps JavaScript API内置Universe或创建自己的Universe。为简单起见，此处使用内置Universe。</p>
                     <p>切片图层配置实例仅需要定义图像切片的尺寸，并且通常使用切片图像的宽度和高度的256个像素。以下代码段创建了此实例：</p><pre class="pre codeblock"><code>var myuniv = new OM.universe。LatLonUniverse（）; //内置Universe var myconfig = new OM.layer。TileLayerConfig（//图块层配置实例{tileImageWidth：256，tileImageHeight：256}）;</code></pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-F1647A8F-CA15-42D2-8037-09B0EA332611" title="动态切片图层是在客户端定义的切片图层。">使用动态平铺层</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-B8F07CD7-3B9B-4C8A-9CF1-2E247498ADC1" name="GUID-B8F07CD7-3B9B-4C8A-9CF1-2E247498ADC1"></a><h4 id="JIMPV-GUID-B8F07CD7-3B9B-4C8A-9CF1-2E247498ADC1" class="sect4"><span class="enumeration_section">4.5.2</span>使用基本映射创建动态切片层</h4>
                  <div>
                     <p>使用基本地图创建动态切片图层是最简单的方法，因为地图内容已由服务器端地图可视化组件基本地图定义。跟着这些步骤。</p>
                     <ol>
                        <li>
                           <p>创建<code class="codeph">ServerMapRequest</code>实例并设置其属性。例如：</p><pre class="pre codeblock"><code>var req = new OM.server。ServerMapRequest（基本URL）; req.setProperties（{dataSource：“MVDEMO”，basemap：'demo_map'，//此basemap属性定义透明的地图内容：true，antialiase：“false”}）;</code></pre></li>
                        <li>
                           <p>创建一个包含此动态切片图层属性的对象。例如：</p><pre class="pre codeblock"><code>var dtl_props = {universe：myuniv，tileLayerConfig：myconfig，tileServerURL：baseURL +“/ omserver”，//地图图像来自此omserver的enableUTFGrid：true，// UTFGrid已启用enableUTFGridInfoWindow：true，//用于显示的信息窗口UTFGrid启用utfGridResolution：4 //一个网格单元代表16（4乘4）图像像素};</code></pre><p>在此示例中，变量<code class="codeph">tileServerURL</code>的字符串值指向地图可视化组件服务器。它可以与部署Web应用程序的服务器相同，也可以是其他地图可视化组件服务器实例。例如，它可以采用以下任一形式：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>来自相同的Oracle Maps服务器实例：例如：</p><pre class="pre codeblock"><code>var baseURL = document.location.protocol +“//”+ document.location.host +“/ mapviewer”;</code></pre></li>
                              <li>
                                 <p>来自另一个Oracle Maps服务器实例。例如：</p><pre class="pre codeblock"><code>var baseURL =“http://myapp.mycorp.com/mapviewer”;</code></pre></li>
                           </ul>
                        </li>
                        <li>
                           <p>创建动态切片图层。例如：</p><pre class="pre codeblock"><code>var dynamic_tilelayer_1 =新的OM.layer。DynamicTileLayer（“dtl1”，dtl_props，req）;</code></pre><p>动态切片图层从地图可视化组件的地图服务器（omserver）请求地图图像，该地图服务器呈现新的地图图像并且不会将图像缓存在磁盘上。</p>
                        </li>
                     </ol>
                     <p>从前面的例子中，注意给出了三个语句来创建动态切片层：（1）创建一个map请求实例（ <code class="codeph">ServerMapRequest</code> ）; （2）创建一个包含动态切片层相关属性的对象; （3）实例化动态切片图层。
                     </p>
                     <p>动态切片图层从地图可视化组件的地图服务器（ <code class="codeph">omserver</code> ）请求地图图像，该地图服务器呈现新的地图图像并且不会将图像缓存在磁盘上。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-F1647A8F-CA15-42D2-8037-09B0EA332611" title="动态切片图层是在客户端定义的切片图层。">使用动态平铺层</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-D66B53D6-9F3D-45CA-92F5-4F5E40C0B9C7" name="GUID-D66B53D6-9F3D-45CA-92F5-4F5E40C0B9C7"></a><h4 id="JIMPV-GUID-D66B53D6-9F3D-45CA-92F5-4F5E40C0B9C7" class="sect4"><span class="enumeration_section">4.5.3</span>使用预定义主题创建动态切片层</h4>
                  <div>
                     <p>另一种创建动态切片图层的方法是使用预定义的主题。跟着这些步骤。</p>
                     <ol>
                        <li>
                           <p>创建<code class="codeph">ServerMapRequest</code>实例并设置其属性。例如：</p><pre class="pre codeblock"><code>var req = new OM.server。ServerMapRequest（基本URL）; req.setProperties（{dataSource：“MVDEMO”，transparent：true，antialiase：“false”，}）; //下面的三个主题已经在元数据中定义。var t1 = new OM.server。ServerPredefinedTheme（ “THEME_DEMO_STATES”）; var t2 = new OM.server。ServerPredefinedTheme（ “THEME_DEMO_HIGHWAYS”）; var t3 = new OM.server。ServerPredefinedTheme（ “THEME_DEMO_CITIES”）; req.addThemes（[t1，t2，t3]）;</code></pre></li>
                        <li>
                           <p>创建一个包含此动态切片图层属性的对象。例如：</p><pre class="pre codeblock"><code>var dtl_props = {universe：myuniv，tileLayerConfig：myconfig，tileServerURL：baseURL +“/ omserver”，enableUTFGrid：true，enableUTFGridInfoWindow：true，utfGridResolution：4};</code></pre></li>
                        <li>
                           <p>创建动态切片图层。例如：</p><pre class="pre codeblock"><code>var dynamic_tilelayer_2 =新的OM.layer。DynamicTileLayer（“dtl2”，dtl_props，req）;</code></pre><p>动态切片图层从地图可视化组件的地图服务器（omserver）请求地图图像，该地图服务器呈现新的地图图像并且不会将图像缓存在磁盘上。</p>
                        </li>
                     </ol>
                     <p>在此方法中， <code class="codeph">ServerMapRequest</code>实例不是指定服务器基本映射，而是添加一些地图可视化组件服务器预定义主题。从实际角度来看，这允许客户端应用程序使用视图USER_SDO_THEMES中的服务器端定义的主题创建切片层。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-F1647A8F-CA15-42D2-8037-09B0EA332611" title="动态切片图层是在客户端定义的切片图层。">使用动态平铺层</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-B515D9FC-C99B-4660-B4C2-FFF5570E7054" name="GUID-B515D9FC-C99B-4660-B4C2-FFF5570E7054"></a><h4 id="JIMPV-GUID-B515D9FC-C99B-4660-B4C2-FFF5570E7054" class="sect4"><span class="enumeration_section">4.5.4</span>直接使用空间表创建动态切片层</h4>
                  <div>
                     <p>您可以通过创建<code class="codeph">ServerJBCTheme</code>实例并将它们添加到<code class="codeph">ServerMapRequest</code>实例中，直接将空间表用于动态切片图层。跟着这些步骤。
                     </p>
                     <ol>
                        <li>
                           <p>创造一种风格。例如：</p><pre class="pre codeblock"><code>var myc1 = new OM.style。颜色（{styleName：“mycolor1”，笔画：“＃333333”，strokeOpacity：1.0，填充：“＃F2EFE9”，fillOpacity：1.0}）;</code></pre></li>
                        <li>
                           <p>创建JDBC主题并设置其属性。空间表用于SQL查询语句中。该语句作为字符串类型变量，在<code class="codeph">OM.server.设置为属性<code class="codeph">OM.server.ServerJDBCTheme</code>实例。例如：</p><pre class="pre codeblock"><code>var jdbcTStates = new OM.server。ServerJDBCTheme（ 'theme_jdbc_states'）; jdbcTStates.setDataSourceName（ 'mvdemo'）; jdbcTStates.setSRID（ '8307'）; jdbcTStates.setGeometryColumnName（ '的geom'）; var sql ='select totpop，poppsqmi，state，state_abrv，geom from states'; //查询jdbcTStates.setQuery（sql）; //设置SQL字符串jdbcTStates.addInfoColumn（{column：'state_abrv'，name：'State'}）; jdbcTStates.addInfoColumn（{column：'totpop'，name：'Population'}）; jdbcTStates.addInfoColumn（{column：'poppsqmi'，name：'Pop。密度'}）; jdbcTStates.setRenderingStyleName（ 'mycolor1'）;</code></pre></li>
                        <li>
                           <p>创建<code class="codeph">ServerMapRequest</code>实例并设置其属性。例如：</p><pre class="pre codeblock"><code>var req = new OM.server。ServerMapRequest（基本URL）; req.setProperties（{dataSource：“MVDEMO”，transparent：true，antialiase：“false”，}）; req.addTheme（jdbcTStates）; req.addStyle（myc1）;</code></pre></li>
                        <li>
                           <p>创建一个包含此动态切片图层属性的对象。例如：</p><pre class="pre codeblock"><code>var dtl_props = {universe：myuniv，tileLayerConfig：myconfig，tileServerURL：baseURL +“/ omserver”，enableUTFGrid：true，enableUTFGridInfoWindow：true，utfGridResolution：4};</code></pre></li>
                        <li>
                           <p>创建动态切片图层。例如：</p><pre class="pre codeblock"><code>var dynamic_tilelayer_3 =新的OM.layer。DynamicTileLayer（“dtl3”，dtl_props，req）;</code></pre></li>
                     </ol>
                     <p>在此示例中，首先创建动态定义的样式和<code class="codeph">ServerJDBCTheme</code>对象。<code class="codeph">ServerJDBCTheme</code>可以使用SQL语句直接使用空间表。然后，这些表由<code class="codeph">ServerMapRequest</code>对象的<code class="codeph">addTheme</code>和<code class="codeph">addStyle</code>方法使用。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-F1647A8F-CA15-42D2-8037-09B0EA332611" title="动态切片图层是在客户端定义的切片图层。">使用动态平铺层</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-66199642-3D36-47F4-BB45-02943A10EF42" name="GUID-66199642-3D36-47F4-BB45-02943A10EF42"></a><h4 id="JIMPV-GUID-66199642-3D36-47F4-BB45-02943A10EF42" class="sect4"><span class="enumeration_section">4.5.5</span>使用第三方地图服务创建动态图块层</h4>
                  <div>
                     <p>另一种创建动态切片图层的方法是使用第三方地图服务。第三方的地图服务URL由客户提供的URL生成功能提供。跟着这些步骤。</p>
                     <ol>
                        <li>
                           <p>使用第三方地图服务提供商的规范，创建URL构造函数，用于通过动态切片图层构建地图图像请求。例如：</p><pre class="pre codeblock"><code>var urlb = function（w，h，minX，minY，maxX，maxY，options）{var str =“http://my.mycorp.com:8080/geoserver/ows？”; var optParams =“”; str = str +“request = getmap”+“＆bbox =”+ minX +“，”+ minY +“，”+ maxX +“，”+ maxY +“＆width =”+ w +“＆height =”+ h;如果（！OM.isNull（options））{for（选项中的var键）{optParams = optParams +“＆”+ key +“=”+ options [key];返回str + optParams; }</code></pre></li>
                        <li>
                           <p>创建一个包含此动态切片图层属性的对象。例如：</p><pre class="pre codeblock"><code>var dtl_props = {universe：myuniv，tileLayerConfig：myconfig，urlBuilder：urlb，urlBuilderOptions：{“layers”：“topp：states，sf：sfdem，sf：roads，sf：streams”，“CRS”：“CRS：84” ，“服务”：“WMS”，“版本”：“1.3.0”，“格式”：“image / png”}};</code></pre></li>
                        <li>
                           <p>创建动态切片图层。例如：</p><pre class="pre codeblock"><code>var dynamic_tilelayer_4 =新的OM.layer。DynamicTileLayer（“dl4”，dtl_props）;</code></pre></li>
                     </ol>
                     <p>在此示例中，动态切片图层实例（ <code class="codeph">dynamic_tilelayer_4</code> ）包含<code class="codeph">urlBuilder</code>属性以提供URL生成功能（ <code class="codeph">iurlb</code> ）。动态切片层将使用URL生成功能从指定的地图服务提供者获取图像切片。此示例使用第三方地图提供程序（ <code class="codeph">GeoServer</code>实例）来提供地图图像。
                     </p>
                     <p>可以在<code class="codeph">urlBuilderOptions</code>属性中提供其他地图服务提供程序所需的参数。此示例指定<code class="codeph">GeoServer</code>实例所需的几个附加参数（ <code class="codeph">layers</code> ， <code class="codeph">CRS</code> ， <code class="codeph">service</code> ， <code class="codeph">version</code>和<code class="codeph">format</code> ）。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-F1647A8F-CA15-42D2-8037-09B0EA332611" title="动态切片图层是在客户端定义的切片图层。">使用动态平铺层</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-31918E3F-96F8-41E6-B835-5796714DC54F" name="GUID-31918E3F-96F8-41E6-B835-5796714DC54F"></a><h4 id="JIMPV-GUID-31918E3F-96F8-41E6-B835-5796714DC54F" class="sect4"><span class="enumeration_section">4.5.6</span>动态图块层用例</h4>
                  <div>
                     <p>本主题描述了动态切片图层用例。</p>
                     <p>代码示例来自动态切片图层应用程序。该应用程序使用地图可视化组件服务器来提供地图图像切片。它直接通过<code class="codeph">OM.server.使用空间表<code class="codeph">OM.server.ServerJDBCTheme</code>实例。
                     </p>
                     <ol>
                        <li>
                           <p>使用<code class="codeph">getWhereClauseFromUI()</code>函数从应用程序的用户界面获取SQL查询的“where”子句，假设该函数已在该应用程序中正确定义并返回预期结果。例如：</p><pre class="pre codeblock"><code>var wherec = getWhereClauseFromUI（）;</code></pre></li>
                        <li>
                           <p>创建JDBC主题并设置其属性。例如：</p><pre class="pre codeblock"><code>var objJDBCTheme = new OM.server。ServerJDBCTheme（）; objJDBCTheme.setDataSourceName（ '风暴'）; objJDBCTheme.setSRID（ '3857'）; objJDBCTheme.setXColumnName（ 'long_loc'）; objJDBCTheme.setYColumnName（ 'lat_loc'）; objJDBCTheme.addInfoColumn（{column：'YEAR'，name：'Year'}）; objJDBCTheme.addInfoColumn（{column：'MONTH'，name：'Month'}）; objJDBCTheme.addInfoColumn（{column：'DAY'，name：'Day'}）; objJDBCTheme.addInfoColumn（{column：'STATE'，name：'State'}）; objJDBCTheme.addInfoColumn（{column：'LOSS'，name：'Loss'}）; objJDBCTheme.addInfoColumn（{column：'CROPLOSS'，name：'Crop_loss'}）; objJDBCTheme.addInfoColumn（{column：'FATALITIES'，name：'Fatalities'}）; objJDBCTheme.addInfoColumn（{column：'INJURIES'，name：'Injuries'}）; objJDBCTheme.setName（ 'theme_tornado'）; objJDBCTheme.setQuery（“SELECT s.geom.sdo_point.x long_loc，s.geom.sdo_point.y lat_loc，年，月，日，州，死亡，受伤，损失，来自tornado_3857的庄稼”+（wherec ===“ “？“”：wherec））; objJDBCTheme.setRenderingStyleName（ 'V.TORNADO'）;</code></pre></li>
                        <li>
                           <p>创建<code class="codeph">ServerMapRequest</code>实例并设置其属性。例如：</p><pre class="pre codeblock"><code>var req = new OM.server。ServerMapRequest（基本URL）; req.setProperties（{dataSource：'storm'，transparent：true，// map image设置为透明antialiase：“false”}）; req.addTheme（objJDBCTheme）;</code></pre></li>
                        <li>
                           <p>创建一个包含此动态切片图层属性的对象。例如：</p><pre class="pre codeblock"><code>var dtl_props = {universe：myuniv，tileLayerConfig：myconfig，tileServerURL：baseURL +“/ omserver”，enableUTFGrid：true，enableUTFGridInfoWindow：true，utfGridResolution：4};</code></pre></li>
                        <li>
                           <p>创建动态切片图层。例如：</p><pre class="pre codeblock"><code>var tornado_damage =新的OM.layer。DynamicTileLayer（“tornado_damage”，dtl_props，req）;</code></pre></li>
                     </ol>
                     <p>前面步骤中的代码示例说明了以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>地图应用程序从地图可视化组件服务器获取地图图像。因此，它可以使用地图可视化组件服务器中的所有可用功能。</p>
                        </li>
                        <li>
                           <p>地图图像被设置为透明的（即，对于属性的值<code class="codeph">transparent</code>是<code class="codeph">true</code> ）。当多个动态切片图层堆叠显示时，此设置可使所有非重叠特征可见。例如，当您在<code class="codeph">tornado_damage</code>动态切片图层上叠加<code class="codeph">hail_damage</code>动态切片图层时，当这些事件（如其名称所示）发生在非重叠位置时，您可能会在地图上看到这两个图层。此设置对包含线性和点要素的多个图层更有用。请注意，由于API允许您打开/关闭图层的可见性，因此您始终可以使感兴趣的图层突出显示并在应用程序中可见。
                           </p>
                        </li>
                        <li>
                           <p>动态切片图层还支持地图可视化组件服务器的<code class="codeph">UTFGrid</code>支持（具体而言，属性<code class="codeph">enableUTFGrid</code>的值设置为<code class="codeph">true</code> ， <code class="codeph">utfGridResolution</code>属性的分辨率值设置为4）。此设置指示地图可视化组件的API请求其他<code class="codeph">UTFGrid</code>文件作为其地图图块图像的伴随。它是一个JSON文件，它包含一个UTF编码的二维网格表，它与平铺图像匹配。它还包含每个网格单元的一些文本属性。
                           </p>
                           <p>当在图像像素处触发鼠标事件（例如，鼠标点击）时，可以定位其对应的网格单元，获得其UTF代码，并且随后可以检索与该网格单元的UTF代码相关联的文本属性。并显示在弹出信息窗口中。</p>
                           <p>该JSON文件中包含的文本属性是使用<code class="codeph">addInfoColumn()</code>方法指定的。这些文本属性将显示在信息窗口中，用于在地图上单击的像素。
                           </p>
                           <p>请注意，如果动态切片图层使用服务器端预定义几何主题，则必须在主题的<code class="codeph">&lt;hidden_info&gt;</code>元素中指定信息窗口的文本属性。这也适用于基于基础地图的动态切片图层，其中预定义主题可在地图可视化组件的基本地图定义中找到</p>
                           <p>分辨率值（例如， <code class="codeph">"utfGridResolution":4</code> ）表示网格单元的宽度和高度与其伴随地图图块图像像素进行比较。在此示例中， <code class="codeph">UTFGrid</code>数据集中的一个网格单元表示16个像素（4x4 = 16）。
                           </p>
                        </li>
                        <li>
                           <p>此动态切片层直接通过<code class="codeph">ServerJDBCTheme</code>使用空间表来定义其地图内容。在其嵌入式SQL语句中，客户端Web应用程序可以灵活地构造整个语句，包括要使用的表，要选择的列以及用于优化查询的“where”子句。在代码片段中，它假定客户端函数<code class="codeph">getWhereClauseFromUI()</code>仅构造JDBC主题定义中的“where”子句。
                           </p>
                        </li>
                     </ul>
                     <p>Oracle Maps JavaScript API支持的动态切片图层允许切片图层使用地图可视化组件服务器元数据，并且可以灵活地定义动态切片图层的方式以及客户端应用程序在何处获取其地图图像。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="oracle-maps.html#GUID-F1647A8F-CA15-42D2-8037-09B0EA332611" title="动态切片图层是在客户端定义的切片图层。">使用动态平铺层</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>