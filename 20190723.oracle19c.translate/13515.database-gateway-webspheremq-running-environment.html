<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>用于WebSphere MQ运行环境的Oracle数据库网关</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Installation and User&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Installation and User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-gateway-websphere-mq-installation-and-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-16T19:05:45-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2006, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96225-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="configuring-database-gateway-webspheremq.html" title="Previous" type="text/html"></link>
      <link rel="next" href="database-gateway-webspheremq-pgm-packages.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Gateway for WebSphere MQ Installation and User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="WSMQG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="configuring-database-gateway-webspheremq.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="database-gateway-webspheremq-pgm-packages.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">安装和用户指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">用于WebSphere MQ运行环境的Oracle数据库网关</li>
            </ol>
            <a id="GUID-85997913-2ED0-463F-9137-89324478D58A" name="GUID-85997913-2ED0-463F-9137-89324478D58A"></a><a id="WSMQG209"></a>
            
            <h2 id="WSMQG-GUID-85997913-2ED0-463F-9137-89324478D58A" class="sect2"><span class="enumeration_chapter">8</span> Oracle Database Gateway for WebSphere MQ运行环境</h2>
         </header>
         <div class="ind">
            <div>
               <p>以下主题描述了<a id="d13746e20" class="indexterm-anchor"></a>用于WebSphere MQ运行环境的Oracle Database Gateway：</p>
            </div><a id="WSMQG210"></a><div class="props_rev_3"><a id="GUID-147324B7-6FF4-418E-B9C4-705D1877C55B" name="GUID-147324B7-6FF4-418E-B9C4-705D1877C55B"></a><h3 id="WSMQG-GUID-147324B7-6FF4-418E-B9C4-705D1877C55B" class="sect3">安全模型</h3>
               <div>
                  <p>WebSphere MQ具有自己的授权机制。仅当应用程序的有效用户ID具有每个操作的授权时，才允许应用程序对队列或队列管理器执行某些操作。</p>
                  <p>有效用户ID（通常是操作系统用户）取决于WebSphere MQ环境及其运行的平台。</p>
                  <p>Oracle环境中的有效用户ID不依赖于操作系统帐户或平台。由于存在这种差异，网关为Oracle应用程序提供了两种授权模型，以便与WebSphere MQ一起使用：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>轻松</p>
                     </li>
                     <li>
                        <p>严格</p>
                     </li>
                  </ul>
                  <p>虽然Oracle和操作系统用户ID可能超过12个字符，但用于任一模型的用户ID长度不能超过12个字符。Oracle用户帐户没有密码所需的最小字符数，但某些平台和操作系统可以。在决定使用密码或用户ID时，请考虑他们的要求。</p>
                  <p>授权模型使用网关中的<code class="codeph">AUTHORIZATION_MODEL</code>参数进行配置<a id="d13746e71" class="indexterm-anchor"></a><a id="d13746e77" class="indexterm-anchor"></a>初始化文件。
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="database-gateway-webspheremq-initialization-parameters.html#GUID-A037975F-8CED-4A9F-97A1-59CBAD688F62">用于WebSphere MQ初始化参数的Oracle数据库网关</a></li>
                     </ul>
                  </div>
               </div>
               <a id="WSMQG211"></a><div class="props_rev_3"><a id="GUID-D6D83632-02A5-498A-AB45-DE173FF1C6AD" name="GUID-D6D83632-02A5-498A-AB45-DE173FF1C6AD"></a><h4 id="WSMQG-GUID-D6D83632-02A5-498A-AB45-DE173FF1C6AD" class="sect4">轻松的模特</h4>
                  <div>
                     <p>此模型会丢弃Oracle用户名和密码。</p>
                     <p>由队列管理器授予网关的有效用户ID的授权是Oracle应用程序具有的唯一关联。例如，如果网关用户标识被授予打开或读取消息或将消息放入队列的权限，则访问网关的所有Oracle应用程序都可以请求这些操作。</p>
                     <p>有效用户ID由网关运行方式决定：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果网关作为MQI客户端应用程序运行，则用户ID由MQI通道定义确定。</p>
                           <div class="infoboxnotealso" id="GUID-D6D83632-02A5-498A-AB45-DE173FF1C6AD__GUID-51CAD550-0E86-4E99-B166-1AE98969E90B">
                              <p class="notep1">也可以看看：</p>
                              <p>有关通道定义的更多信息，请参阅IBM出版物</p>
                           </div>
                        </li>
                        <li>
                           <p>如果网关作为MQI服务器应用程序运行，则网关的有效用户ID是启动Oracle Net侦听器的用户帐户，并且具有Oracle应用程序要访问的所有WebSphere MQ对象的权限。</p>
                        </li>
                     </ul>
                     <p>Oracle建议仅在应用程序具有最低安全要求时才使用宽松模型。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="database-gateway-webspheremq-running-environment.html#GUID-70E6AD86-77BA-4D4F-B0A1-4E34EBCAAC77" title="本主题描述WebSphere MQ对象的访问权限。">WebSphere MQ对象的授权</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="WSMQG212"></a><div class="props_rev_3"><a id="GUID-2974BD2E-F059-4212-A395-4C260E303645" name="GUID-2974BD2E-F059-4212-A395-4C260E303645"></a><h4 id="WSMQG-GUID-2974BD2E-F059-4212-A395-4C260E303645" class="sect4">严格的模型</h4>
                  <div>
                     <p><code class="codeph">CREATE DATABASE LINK</code>时，此模型使用<code class="codeph">CREATE DATABASE LINK</code>语句中提供的Oracle用户标识和密码;如果<code class="codeph">CREATE DATABASE LINK</code>未提供，则使用当前的Oracle用户标识和密码。</p>
                     <p>该<a id="d13746e183" class="indexterm-anchor"></a><a id="d13746e187" class="indexterm-anchor"></a> Oracle用户ID：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>必须与运行网关的系统的用户帐户以及运行WebSphere MQ队列管理器的系统匹配</p>
                        </li>
                        <li>
                           <p>必须具有所有访问的WebSphere MQ对象的授权。</p>
                        </li>
                     </ul>
                     <p>验证Oracle用户标识和密码的授权过程会有所不同，具体取决于网关的运行方式。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="database-gateway-webspheremq-running-environment.html#GUID-70E6AD86-77BA-4D4F-B0A1-4E34EBCAAC77" title="本主题描述WebSphere MQ对象的访问权限。">WebSphere MQ对象的授权</a></li>
                        </ul>
                     </div>
                  </div>
                  <a id="WSMQG213"></a><div class="props_rev_3"><a id="GUID-E78532F3-25E0-4EDB-B6C3-82AC317460B9" name="GUID-E78532F3-25E0-4EDB-B6C3-82AC317460B9"></a><h5 id="WSMQG-GUID-E78532F3-25E0-4EDB-B6C3-82AC317460B9" class="sect5">WebSphere MQ Server应用程序的授权过程</h5>
                     <div>
                        <p>如果网关作为WebSphere MQ服务器应用程序运行，则授权过程将根据本地或网络密码文件检查用户标识和密码。</p>
                        <p>如果它们匹配，则网关为用户ID执行SET-UID并继续在此用户ID下运行。对此用户标识进行进一步的WebSphere MQ授权检查。</p>
                     </div>
                  </div><a id="WSMQG214"></a><div class="props_rev_3"><a id="GUID-1D7787E0-2803-49FB-813E-62C98DAF3C6F" name="GUID-1D7787E0-2803-49FB-813E-62C98DAF3C6F"></a><h5 id="WSMQG-GUID-1D7787E0-2803-49FB-813E-62C98DAF3C6F" class="sect5">WebSphere MQ客户端应用程序的授权过程</h5>
                     <div>
                        <p>如果网关作为WebSphere MQ客户端应用程序运行，则授权过程将根据本地或网络密码文件检查用户标识和密码。</p>
                        <p>如果他们匹配，那么<a id="d13746e263" class="indexterm-anchor"></a><a id="d13746e265" class="indexterm-anchor"></a><a id="d13746e269" class="indexterm-anchor"></a> <code class="codeph">MQ_USER_ID</code>和<a id="d13746e278" class="indexterm-anchor"></a><a id="d13746e280" class="indexterm-anchor"></a><a id="d13746e284" class="indexterm-anchor"></a> <code class="codeph">MQ_PASSWORD</code> WebSphere MQ环境变量设置为用户标识和密码的值。如果通道定义指定<code class="codeph">MCAUSER</code> WebSphere MQ环境变量<a id="d13746e297" class="indexterm-anchor"></a><a id="d13746e299" class="indexterm-anchor"></a><a id="d13746e303" class="indexterm-anchor"></a>作为空白字符，然后对用户标识执行WebSphere MQ授权检查。</p>
                        <p>如果设置了MCAUSER，未设置MCAUSER，或者为MQI通道定义了安全出口，则会覆盖网关工作。</p>
                        <div class="infoboxnotealso" id="GUID-1D7787E0-2803-49FB-813E-62C98DAF3C6F__GUID-8E9EA032-EEAE-415E-952F-F93130A9BB8D">
                           <p class="notep1">也可以看看：</p>
                           <p>有关WebSphere MQ环境变量的更多信息，请参阅IBM出版物。</p>
                        </div>
                     </div>
                  </div>
               </div><a id="WSMQG340"></a><a id="WSMQG215"></a><div class="props_rev_3"><a id="GUID-70E6AD86-77BA-4D4F-B0A1-4E34EBCAAC77" name="GUID-70E6AD86-77BA-4D4F-B0A1-4E34EBCAAC77"></a><h4 id="WSMQG-GUID-70E6AD86-77BA-4D4F-B0A1-4E34EBCAAC77" class="sect4">WebSphere MQ对象的授权</h4>
                  <div>
                     <p>本主题描述WebSphere MQ对象的访问权限。</p>
                     <p><a id="d13746e339" class="indexterm-anchor"></a>宽松模型的有效用户ID和严格模型的Oracle用户ID需要<a id="d13746e344" class="indexterm-anchor"></a> <a href="database-gateway-webspheremq-running-environment.html#GUID-70E6AD86-77BA-4D4F-B0A1-4E34EBCAAC77__CEGGCCJD" title="该表描述了访问授权。">表8-1中</a>描述了WebSphere MQ授权。
                     </p>
                     <div class="tblformal" id="GUID-70E6AD86-77BA-4D4F-B0A1-4E34EBCAAC77__CEGGCCJD">
                        <p class="titleintable">表8-1 WebSphere MQ访问授权</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="WebSphere MQ访问授权" width="100%" border="1" summary="This table describes access authorization." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="32%" id="d13746e363">访问类型</th>
                                 <th align="left" valign="bottom" width="32%" id="d13746e366">WebSphere MQ授权关键字</th>
                                 <th align="left" valign="bottom" width="36%" id="d13746e369">备用WebSphere MQ授权关键字</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d13746e374" headers="d13746e363 ">
                                    <p>访问WebSphere MQ队列管理器的权限</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d13746e374 d13746e366 ">
                                    <p><code class="codeph">all</code>或<code class="codeph">allmqi</code></p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d13746e374 d13746e369 ">
                                    <p><code class="codeph">连</code></p>
                                    <p><code class="codeph">设置名称</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d13746e392" headers="d13746e363 ">
                                    <p>将消息发送到WebSphere MQ队列的权限</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d13746e392 d13746e366 ">
                                    <p><code class="codeph">all</code>或<code class="codeph">allmqi</code></p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d13746e392 d13746e369 ">
                                    <p><code class="codeph">PASSALL</code></p>
                                    <p><code class="codeph">passid</code></p>
                                    <p><code class="codeph">放</code></p>
                                    <p><code class="codeph">设置名称</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d13746e416" headers="d13746e363 ">
                                    <p>从WebSphere MQ队列接收消息的权限</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d13746e416 d13746e366 ">
                                    <p><code class="codeph">all</code>或<code class="codeph">allmqi</code></p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d13746e416 d13746e369 ">
                                    <p><code class="codeph">浏览</code></p>
                                    <p><code class="codeph">得到</code></p>
                                    <p><code class="codeph">PASSALL</code></p>
                                    <p><code class="codeph">passid</code></p>
                                    <p><code class="codeph">设置名称</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="infoboxnotealso" id="GUID-70E6AD86-77BA-4D4F-B0A1-4E34EBCAAC77__GUID-E859FE6C-9430-472F-BBBD-10FA59E34A5B">
                        <p class="notep1">也可以看看：</p>
                        <p>有关WebSphere MQ授权的更多信息，请参阅IBM出版物。</p>
                     </div>
                  </div>
               </div>
            </div><a id="WSMQG216"></a><div class="props_rev_3"><a id="GUID-EE664BD2-F673-4E30-B5D4-F82E44A72EBC" name="GUID-EE664BD2-F673-4E30-B5D4-F82E44A72EBC"></a><h3 id="WSMQG-GUID-EE664BD2-F673-4E30-B5D4-F82E44A72EBC" class="sect3">交易支持</h3>
               <div>
                  <p>来自使用网关并调用WebSphere MQ消息队列操作的Oracle应用程序的事务由事务发起的Oracle数据库中的事务协调器管理。</p>
               </div><a id="WSMQG217"></a><div class="props_rev_3"><a id="GUID-E7C554A5-8A4D-4B3C-A33D-1AA8D6C1A00B" name="GUID-E7C554A5-8A4D-4B3C-A33D-1AA8D6C1A00B"></a><h4 id="WSMQG-GUID-E7C554A5-8A4D-4B3C-A33D-1AA8D6C1A00B" class="sect4">非Oracle数据源和分布式事务</h4>
                  <div>
                     <p>当Oracle分布式数据库包含网关时，必须正确配置网关以参与分布式事务。</p>
                     <p>涉及网关的分布式事务的结果应该是所有参与的站点回滚或提交它们的分布式事务的部分。必须保护在分布式事务期间更新的所有参与站点（包括网关站点）免于失败，并且必须能够参与两阶段提交机制。</p>
                     <p>作为分布式事务的一部分更新目标系统的网关必须能够参与自动恢复机制，这可能需要将恢复信息记录在目标系统的事务存储器中。</p>
                     <p>如果分布式事务中涉及基于SQL的网关，则在提交分布式事务后，分布式数据库必须处于一致状态。</p>
                     <p>具有procedural选项的数据库网关或基于SQL的网关将远程过程调用转换为目标系统调用。从Oracle事务模型的角度来看，网关就像一个Oracle数据库，执行包含用于访问Oracle数据库的SQL语句的PL / SQL块。</p>
                     <p>对于数据库网关，目标系统调用是否会改变数据是未知的。为确保分布式数据库的一致性，必须假定数据库网关更新目标系统。因此，发送到数据库网关的所有远程过程调用都参与分布式事务，并且必须受两阶段提交协议的保护。例如，您可以发出以下SQL * Plus语句：</p><pre class="oac_no_warn" dir="ltr">EXECUTE REMOTE_PROC @ FACTORY; INSERT INTO DEBIT @ FINANCE ROLLBACK;</pre><p>在此示例中， <code class="codeph">REMOTE_PROC</code>是访问数据库网关的远程过程调用， <code class="codeph">DEBIT</code>是驻留在Oracle数据库中的Oracle表，而<code class="codeph">FACTORY</code>和<code class="codeph">FINANCE</code>是用于访问远程站点的数据库链接。
                     </p>
                  </div>
               </div><a id="WSMQG218"></a><div class="props_rev_3"><a id="GUID-4D7BDADF-909F-4292-B658-F4B3D9767C32" name="GUID-4D7BDADF-909F-4292-B658-F4B3D9767C32"></a><h4 id="WSMQG-GUID-4D7BDADF-909F-4292-B658-F4B3D9767C32" class="sect4">交易能力类型</h4>
                  <div>
                     <p>当网关涉及分布式事务时，非Oracle数据源的事务功能确定数据源是否可以参与两阶段提交操作或分布式事务。</p>
                     <p>根据非Oracle数据源的功能，可以将事务分类为以下类型之一：</p>
                     <div class="tblformal" id="GUID-4D7BDADF-909F-4292-B658-F4B3D9767C32__GUID-8672E209-C5F1-45D2-81D9-E748B53006FA">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table describes transaction capability types." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="27%" id="d13746e554">类型</th>
                                 <th align="left" valign="bottom" width="73%" id="d13746e557">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="27%" id="d13746e562" headers="d13746e554 ">
                                    <p>只读</p>
                                 </td>
                                 <td align="left" valign="top" width="73%" headers="d13746e562 d13746e557 ">
                                    <p>在分布式事务期间，网关提供对数据源的只读访问，因此只能查询网关。只读用于使用推定提交模型或不支持回滚机制的目标系统。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="27%" id="d13746e569" headers="d13746e554 ">
                                    <p>单站点</p>
                                 </td>
                                 <td align="left" valign="top" width="73%" headers="d13746e569 d13746e557 ">
                                    <p>在分布式事务期间，目标系统是只读的（其他站点可以更新）或唯一站点更新（可以参与远程事务）。单站点用于支持回滚，提交和假定中止的目标系统，但不能准备或提交确认，因为它们没有分布式事务内存，能够记住分布式事务期间和之后发生的事情。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="27%" id="d13746e576" headers="d13746e554 ">
                                    <p>提交 - 确认</p>
                                 </td>
                                 <td align="left" valign="top" width="73%" headers="d13746e576 d13746e557 ">
                                    <p>网关是Oracle事务模式的部分合作伙伴。在更新它的分布式事务期间，网关必须是提交点站点。Commit-confirm用于支持回滚，提交，推测中止和提交确认的目标系统，但不支持准备。提交确认功能需要分布式事务内存。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="27%" id="d13746e583" headers="d13746e554 ">
                                    <p>两阶段提交</p>
                                 </td>
                                 <td align="left" valign="top" width="73%" headers="d13746e583 d13746e557 ">
                                    <p>网关是Oracle事务模型中的部分合作伙伴。在分布式事务期间，网关不能是提交点站点。两阶段提交用于支持回滚，提交，推测 - 中止和准备的目标系统，但不支持commit-confirm，因为它们没有分布式事务内存。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="27%" id="d13746e590" headers="d13746e554 ">
                                    <p>两阶段提交提交确认</p>
                                 </td>
                                 <td align="left" valign="top" width="73%" headers="d13746e590 d13746e557 ">
                                    <p>网关是Oracle事务模型中的完整合作伙伴。在分布式事务期间，网关可以是提交点站点，具体取决于网关初始化文件中定义的提交点强度。此事务类型用于支持完整的两阶段提交事务模型的目标系统。也就是说，目标系统支持回滚，提交，推测 - 中止，准备和提交 - 确认。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="WSMQG219"></a><div class="props_rev_3"><a id="GUID-7229937F-7266-4ABF-8FAD-833F32E4363E" name="GUID-7229937F-7266-4ABF-8FAD-833F32E4363E"></a><h4 id="WSMQG-GUID-7229937F-7266-4ABF-8FAD-833F32E4363E" class="sect4">用于WebSphere MQ的Oracle Database Gateway的事务功能类型</h4>
                  <div>
                     <p>来自Oracle应用程序（调用WebSphere MQ消息队列操作和使用网关）的事务由Oracle事务发起的Oracle数据库中的Oracle事务协调器管理。</p>
                     <p>Oracle Database Gateway for WebSphere MQ提供以下事务类型：</p>
                  </div><a id="WSMQG220"></a><div class="props_rev_3"><a id="GUID-1003BF8E-18E7-4357-AE74-63AAA7ED2458" name="GUID-1003BF8E-18E7-4357-AE74-63AAA7ED2458"></a><h5 id="WSMQG-GUID-1003BF8E-18E7-4357-AE74-63AAA7ED2458" class="sect5">单站点事务</h5>
                     <div>
                        <p>所有WebSphere MQ环境和平台都支持单站点事务。</p>
                        <p><a id="d13746e649" class="indexterm-anchor"></a>单站点意味着仅当属于同一WebSphere MQ队列管理器的队列更新时，网关才能参与事务。Oracle应用程序可以选择但不更新发送到WebSphere MQ队列或从WebSphere MQ队列接收消息的同一事务中的任何Oracle数据库上的数据。要更新Oracle数据库中的对象，应首先提交或回滚涉及WebSphere MQ队列的事务。
                        </p>
                        <p>网关的默认模式使用WebSphere MQ单阶段实现，其中队列管理器充当同步点协调器。</p>
                     </div>
                  </div><a id="WSMQG221"></a><div class="props_rev_3"><a id="GUID-00A75967-A3C8-498C-8BC7-560E3FBA431E" name="GUID-00A75967-A3C8-498C-8BC7-560E3FBA431E"></a><h5 id="WSMQG-GUID-00A75967-A3C8-498C-8BC7-560E3FBA431E" class="sect5">提交确认事务</h5>
                     <div>
                        <p>Commit-Confirm事务是单站点事务的增强形式，并且支持所有WebSphere MQ环境和平台。</p>
                        <p><a id="d13746e684" class="indexterm-anchor"></a><a id="d13746e688" class="indexterm-anchor"></a>提交确认意味着当更新属于同一WebSphere MQ队列管理器的队列时，网关可以参与事务，同时更新任意数量的Oracle数据库。只有一个具有commit-confirm模型的网关才能加入分布式事务，因为网关作为事务的焦点。要将更改应用于多个队列管理器的队列，需要在为下一个队列管理器启动新事务之前提交应用于一个队列管理器的更新。
                        </p>
                        <p>与单站点事务一样，commit-confirm事务是使用WebSphere MQ单阶段实现的，但它需要队列管理器上的专用恢复队列来记录事务ID。在提交时，网关将消息放入此队列，并将消息ID设置为Oracle事务ID。在网关调用队列管理器提交事务之后，事务日志队列上的额外消息将成为整个事务的一部分。这使得可以在系统故障的情况下确定事务的结果，允许网关恢复失败的事务。当事务成功完成时，网关将从队列中删除关联的消息。</p>
                        <p>WebSphere MQ管理员必须在队列管理器中创建保留队列。此队列的名称在网关中指定<a id="d13746e695" class="indexterm-anchor"></a><a id="d13746e701" class="indexterm-anchor"></a>初始化文件用<a id="d13746e708" class="indexterm-anchor"></a><a id="d13746e710" class="indexterm-anchor"></a> <code class="codeph">TRANSACTION_LOG_QUEUE</code>参数。通过网关访问WebSphere MQ的所有Oracle用户都应具有此队列的完全授权。事务日志队列仅保留用于事务日志记录，不得由网关使用，访问或更新。发生系统故障时，Oracle恢复过程会检查事务日志队列以确定恢复策略。
                        </p>
                        <p>两个网关初始化参数， <a id="d13746e719" class="indexterm-anchor"></a><a id="d13746e721" class="indexterm-anchor"></a> <code class="codeph">TRANSACTION_RECOVERY_USER</code>和<a id="d13746e728" class="indexterm-anchor"></a><a id="d13746e730" class="indexterm-anchor"></a> <code class="codeph">TRANSACTION_RECOVERY_PASSWORD</code>在网关初始化文件中设置，以指定用于恢复目的的用户ID和密码。设置后，网关将使用此用户ID和密码组合进行恢复工作。恢复用户标识应具有事务日志队列的完全授权。
                        </p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="database-gateway-webspheremq-initialization-parameters.html#GUID-A037975F-8CED-4A9F-97A1-59CBAD688F62">用于WebSphere MQ初始化参数的Oracle数据库网关</a></li>
                           </ul>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="WSMQG222"></a><div class="props_rev_3"><a id="GUID-4FD2B66E-D207-46AF-A365-B6717E73A0F7" name="GUID-4FD2B66E-D207-46AF-A365-B6717E73A0F7"></a><h3 id="WSMQG-GUID-4FD2B66E-D207-46AF-A365-B6717E73A0F7" class="sect3">故障排除</h3>
               <div>
                  <p>本节包括有关消息，错误代码，网关跟踪和网关操作的信息。</p>
               </div><a id="WSMQG223"></a><div class="props_rev_3"><a id="GUID-53AE79F7-382B-4369-A670-E9390A5C6050" name="GUID-53AE79F7-382B-4369-A670-E9390A5C6050"></a><h4 id="WSMQG-GUID-53AE79F7-382B-4369-A670-E9390A5C6050" class="sect4">消息和错误代码处理</h4>
                  <div>
                     <p>网关架构包括许多组件。在处理PL / SQL代码时，这些组件中的任何一个都可以检测并报告错误情况。</p>
                     <p>错误条件可能很复杂，涉及错误代码和来自多个组件的支持数据。在所有情况下，Oracle应用程序都会收到一个要执行操作的Oracle错误代码。</p>
                     <p>错误条件以下列方式表示：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a id="d13746e798" class="indexterm-anchor"></a>来自的错误<a id="d13746e803" class="indexterm-anchor"></a> Oracle数据库</p>
                           <p>来自Oracle数据库的消息的格式为ORA- <span class="italic">xxxxx</span>或PLS- <span class="italic">xxxxx，</span>其中<span class="italic">xxxxx</span>是代码编号。ORA- <span class="italic">xxxxx</span>之后是解释错误代码的文本。
                           </p>
                           <p>例如：</p><pre class="oac_no_warn" dir="ltr">PLS-00306：调用'MQOPEN'ORA-06550时错误的参数数量或类型：第7行，第3列：PL / SQL：语句被忽略</pre></li>
                        <li>
                           <p>网关和<a id="d13746e829" class="indexterm-anchor"></a> WebSphere MQ <a id="d13746e834" class="indexterm-anchor"></a>错误<a id="d13746e839" class="indexterm-anchor"></a> 
                           </p>
                           <p>如果可能，WebSphere MQ错误代码将转换为Oracle错误代码。如果那是不可能的，那么Oracle <a id="d13746e846" class="indexterm-anchor"></a>错误<a id="d13746e851" class="indexterm-anchor"></a>返回带有相应WebSphere MQ错误代码的ORA-29400。
                           </p>
                           <p>例如：</p><pre class="oac_no_warn" dir="ltr">ORA-29400：数据盒式磁带错误MQI MQCONNX失败。完成代码= 2，原因代码= 2058</pre><div class="infoboxnote" id="GUID-53AE79F7-382B-4369-A670-E9390A5C6050__GUID-C6A6FC0D-8392-4535-9BAD-D5D2B846A9D3">
                              <p class="notep1">注意：</p>
                              <p>由于Oracle数据库仅区分所有用户操作的成功或失败结果，因此返回警告的MQI调用将报告为成功操作。</p>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="database-gateway-webspheremq-running-environment.html#GUID-C2FB7109-1E21-4341-998E-231883127A18" title="本节中描述的错误条件是应用程序在使用网关时可能会收到的常见错误情况。">常见错误代码</a></li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-53AE79F7-382B-4369-A670-E9390A5C6050__NOTE-134-E248FC9B">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/wsmqg&amp;id=ERRMG" target="_blank"><span class="italic">Oracle数据库错误消息</span></a></p>
                     </div>
                  </div>
                  <a id="WSMQG224"></a><div class="props_rev_3"><a id="GUID-4A0A51D3-B84E-4EF4-B481-7568A8F23CBD" name="GUID-4A0A51D3-B84E-4EF4-B481-7568A8F23CBD"></a><h5 id="WSMQG-GUID-4A0A51D3-B84E-4EF4-B481-7568A8F23CBD" class="sect5">解释网关消息</h5>
                     <div>
                        <p>除了与Oracle消息号关联的文本之外，错误代码通常还附带有其他消息文本。</p>
                        <p><a id="d13746e901" class="indexterm-anchor"></a><a id="d13746e905" class="indexterm-anchor"></a>附加文本包含有关错误的详细信息。
                        </p>
                        <p>网关消息具有以下格式：</p><pre class="oac_no_warn" dir="ltr">ORA-nnnnn： <span class="italic">error_message_text</span> <span class="italic">gateway_message_line</span>
</pre><p>哪里：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>nnnn是Oracle错误号。</p>
                           </li>
                           <li>
                              <p><span class="italic"><code class="codeph">error_message_text</code></span>是与错误关联的消息的文本。
                              </p>
                           </li>
                           <li>
                              <p><span class="italic"><code class="codeph">gateway_message_line</code></span>是网关生成的附加消息文本。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="WSMQG225"></a><div class="props_rev_3"><a id="GUID-C2FB7109-1E21-4341-998E-231883127A18" name="GUID-C2FB7109-1E21-4341-998E-231883127A18"></a><h4 id="WSMQG-GUID-C2FB7109-1E21-4341-998E-231883127A18" class="sect4">常见错误代码</h4>
                  <div>
                     <p>本节中描述的错误条件是应用程序在使用网关时可能会收到的常见错误情况。</p>
                     <div class="section">
                        <p>但是，它并未涵盖所有错误情况。</p>
                        <dl>
                           <dt class="dlterm"><a name="GUID-C2FB7109-1E21-4341-998E-231883127A18__GUID-C838B9C7-1EEA-4230-9182-800394B1E580"><!-- --></a> ORA-01017：用户名/密码无效;登录被拒绝</dt>
                           <dd>
                              <p>原因：用户名或密码无效</p>
                           </dd>
                           <dd class="ddexpand">
                              <p>行动：登录被拒绝</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-C2FB7109-1E21-4341-998E-231883127A18__GUID-215A1FE7-2DB3-4A99-88A4-7371C24A8089"><!-- --></a> ORA-29400：MQSeries MQI调用“call_name”失败，原因码为mqi_code</dt>
                           <dd>
                              <p>原因：对WebSphere MQ队列管理器的MQI调用失败。网关无法完成当前操作。</p>
                           </dd>
                           <dd class="ddexpand">
                              <p>操作：如果是<span class="italic"><code class="codeph">call_name</code></span> <a id="d13746e1001" class="indexterm-anchor"></a><a id="d13746e1005" class="indexterm-anchor"></a> <code class="codeph">MQOPEN</code>和<span class="italic"><code class="codeph">mqi_code</code></span>是2035，然后执行以下操作：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果为宽松的安全模型配置了网关，则使用WebSphere MQ管理命令界面为启动Oracle Net侦听器的用户帐户授予足够的消息权限。这些特权允许用户发送和接收指定WebSphere MQ队列的消息。有关更多信息，请参阅IBM出版物。</p>
                                 </li>
                                 <li>
                                    <p>如果为严格安全模型配置了网关，请使用WebSphere MQ管理命令接口将消息特权授予在中指定的用户名<a id="d13746e1023" class="indexterm-anchor"></a> <code class="codeph">CREATE DATABASE LINK</code> <a id="d13746e1030" class="indexterm-anchor"></a>声明。如果在<code class="codeph">CREATE DATABASE LINK</code>语句中未指定用户名，则授予当前Oracle用户标识的权限。这些特权使用户能够发送和接收指定WebSphere MQ队列的消息。有关更多信息，请参阅IBM出版物。
                                    </p>
                                 </li>
                              </ul>
                              <p>如果<span class="italic"><code class="codeph">call_name</code></span>是<a id="d13746e1046" class="indexterm-anchor"></a> <code class="codeph">MQOPEN</code> <a id="d13746e1052" class="indexterm-anchor"></a> ，如果<span class="italic"><code class="codeph">mqi_code</code></span>为2085，则验证WebSphere MQ概要文件中指定的队列是否存在于您尝试访问的WebSphere MQ队列管理器中，并且队列名称是否正确拼写并且位于正确的字母大小写中。
                              </p>
                              <div class="infoboxnotealso" id="GUID-C2FB7109-1E21-4341-998E-231883127A18__GUID-2E3CBA3D-CED0-48C1-A5B7-11C99383C61F">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关除2035和2085之外的<code class="codeph">mqi_codes</code>更多信息，请参阅IBM出版物。
                                 </p>
                              </div>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="WSMQG226"></a><div class="props_rev_3"><a id="GUID-19235502-FCE9-4F57-AAFD-E46338A410DF" name="GUID-19235502-FCE9-4F57-AAFD-E46338A410DF"></a><h4 id="WSMQG-GUID-19235502-FCE9-4F57-AAFD-E46338A410DF" class="sect4">网关追踪</h4>
                  <div>
                     <p>网关具有用于测试和调试目的的跟踪功能。</p>
                     <p><a id="d13746e1090" class="indexterm-anchor"></a><a id="d13746e1094" class="indexterm-anchor"></a>跟踪功能收集有关网关运行环境，MQI调用和MQI调用的参数值的信息。要收集的跟踪数据量基于使用选择的跟踪级别<a id="d13746e1097" class="indexterm-anchor"></a><a id="d13746e1099" class="indexterm-anchor"></a> <code class="codeph">TRACE_LEVEL</code>参数。
                     </p>
                     <div class="infoboxnote" id="GUID-19235502-FCE9-4F57-AAFD-E46338A410DF__GUID-87F03078-B44B-4E90-BA2E-8D929D54B926">
                        <p class="notep1">注意：</p>
                        <p>当您的应用程序在生产环境中运行时，请勿启用跟踪，因为它会降低网关性能。</p>
                     </div>
                     <p>跟踪数据将写入由指定的目录和文件<a id="d13746e1111" class="indexterm-anchor"></a><a id="d13746e1113" class="indexterm-anchor"></a> <code class="codeph">LOG_DESTINATION</code>参数。
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="database-gateway-webspheremq-initialization-parameters.html#GUID-A037975F-8CED-4A9F-97A1-59CBAD688F62">用于WebSphere MQ初始化参数的Oracle数据库网关</a></li>
                        </ul>
                     </div>
                  </div>
                  <a id="WSMQG227"></a><div class="props_rev_3"><a id="GUID-38CAFD20-929C-4089-B4CD-15B8D8A58832" name="GUID-38CAFD20-929C-4089-B4CD-15B8D8A58832"></a><h5 id="WSMQG-GUID-38CAFD20-929C-4089-B4CD-15B8D8A58832" class="sect5">LOG_DESTINATION参数</h5>
                     <div>
                        <p>这是网关初始化参数。</p>
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div><a id="WSMQG228"></a><div class="props_rev_3"><a id="GUID-A6682AE6-7038-4E8D-9DD1-811B3520FCDE" name="GUID-A6682AE6-7038-4E8D-9DD1-811B3520FCDE"></a><h6 id="WSMQG-GUID-A6682AE6-7038-4E8D-9DD1-811B3520FCDE" class="sect6">网关</h6>
                        <div>
                           <div class="section">
                              <p>基于SQL和程序</p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="WSMQG229"></a><div class="props_rev_3"><a id="GUID-37EF9E08-FD63-4B74-9858-B5D552D927E2" name="GUID-37EF9E08-FD63-4B74-9858-B5D552D927E2"></a><h6 id="WSMQG-GUID-37EF9E08-FD63-4B74-9858-B5D552D927E2" class="sect6">默认值</h6>
                        <div>
                           <div class="section">
                              <p>默认值为<code class="codeph">SID_agt_PID.trc</code> 。
                              </p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="WSMQG230"></a><div class="props_rev_3"><a id="GUID-F42E55A0-0A7D-4354-9C60-DA202F49B327" name="GUID-F42E55A0-0A7D-4354-9C60-DA202F49B327"></a><h6 id="WSMQG-GUID-F42E55A0-0A7D-4354-9C60-DA202F49B327" class="sect6">价值范围</h6>
                        <div>
                           <div class="section">
                              <p>没有</p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="WSMQG341"></a><a id="WSMQG231"></a><div class="props_rev_3"><a id="GUID-C1CD1E44-DFEE-434D-9FC8-941BF279DBE2" name="GUID-C1CD1E44-DFEE-434D-9FC8-941BF279DBE2"></a><h6 id="WSMQG-GUID-C1CD1E44-DFEE-434D-9FC8-941BF279DBE2" class="sect6">句法</h6>
                        <div>
                           <div class="section">
                              <p> <code class="codeph">LOG_DESTINATION =</code> <span class="italic"><code class="codeph">log_file</code></span></p>
                           </div>
                           <!-- class="section" -->
                           <div class="section">
                              <p class="subhead3" id="GUID-C1CD1E44-DFEE-434D-9FC8-941BF279DBE2__GUID-57F8C676-4382-4B0F-843C-6ECA50A4D81E">参数说明</p>
                           </div>
                           <!-- class="section" -->
                           <div class="section"><pre class="oac_no_warn" dir="ltr">LOG_DESTINATION = <span class="italic">log_file</span>
</pre><p><code class="codeph">LOG_DESTINATION</code>指定网关写入日志记录信息的文件名或目录。当<code class="codeph">log_file</code>已存在时，日志信息将写入文件末尾。
                              </p>
                              <p>如果未指定<code class="codeph">LOG_DESTINATION</code> ，则每次网关启动时都会创建默认日志文件。
                              </p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div>
               </div><a id="WSMQG232"></a><div class="props_rev_3"><a id="GUID-25B2E31D-6969-4EC6-BE24-C406358D6832" name="GUID-25B2E31D-6969-4EC6-BE24-C406358D6832"></a><h4 id="WSMQG-GUID-25B2E31D-6969-4EC6-BE24-C406358D6832" class="sect4">验证网关操作</h4>
                  <div>
                     <p>如果您的应用程序无法连接到网关，请在启用网关跟踪功能的情况下重新运行应用程序。</p>
                     <p>如果没有将跟踪信息写入<code class="codeph">LOG_DESTINATION</code>指定的日志文件，或者根本没有创建日志文件，则验证：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>网关和Oracle数据库的Oracle Net配置已正确设置。</p>
                        </li>
                        <li>
                           <p>Oracle数据库与网关之间存在数据库链接。</p>
                        </li>
                     </ul>
                     <p>如果正确设置了Oracle Net配置和数据库链接，请使用<code class="codeph">test.sql</code>脚本检查网关的操作：</p>
                     <ol>
                        <li>
                           <p>输入以下命令将目录更改为网关示例目录：</p>
                           <p>对于Microsoft Windows：</p><pre class="oac_no_warn" dir="ltr">&gt; cd％ORACLE_HOME％\ dg4mq \ sample</pre><p>对于基于UNIX的系统：</p><pre class="oac_no_warn" dir="ltr">$ cd $ ORACLE_HOME / dg4mq / sample</pre></li>
                        <li>
                           <p>使用编辑器修改<a id="d13746e1335" class="indexterm-anchor"></a><a id="d13746e1337" class="indexterm-anchor"></a> <code class="codeph">test.sql</code>脚本如下：</p>
                           <ol type="a">
                              <li>
                                 <p>指定为网关创建的数据库链接名称。要执行此操作，请将字符<code class="codeph">@dg4mq</code>替换为<code class="codeph">@</code> <span class="italic"><code class="codeph">dblink</code></span> ，其中<span class="italic"><code class="codeph">dblink</code></span>是您在创建数据库链接时选择的名称。
                                 </p>
                              </li>
                              <li>
                                 <p>将字符<span class="italic"><code class="codeph">YOUR_QUEUE_NAME</code></span>替换为有效的WebSphere MQ队列名称。
                                 </p>
                              </li>
                           </ol>
                        </li>
                        <li>
                           <p>使用SQL * Plus，以有效用户身份连接到Oracle数据库。</p>
                        </li>
                        <li>
                           <p>运行<code class="codeph">test.sql</code> ，这是一个从WebSphere MQ队列发送和检索消息的脚本。成功完成将显示以下输出：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; @ test.sql消息放在队列中= 10203040506070809000 MQPUT：CorrelId length = 24 MQPUT：MsgId length = 24返回MQPUT，原因码为0 MQGET返回原因码0消息回读= 10203040506070809000</pre><p>不成功的测试显示以下输出：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; @ test.sql消息放在队列中= 10203040506070809000错误：Oracle Database Gateway for WebSphere MQ验证脚本失败。ORA-29400：数据盒式磁带错误MQI MQOPEN失败。完成代码= 2，原因代码= 2085</pre></li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="configuring-database-gateway-webspheremq.html#GUID-B7316A3E-DC89-44AC-984D-EE262D09AB3F" title="网关要求Oracle Net提供与Oracle数据库之间的透明数据访问。">为网关配置Oracle Net</a></li>
                           <li><a href="configuring-database-gateway-webspheremq.html#GUID-047A4F17-55B1-4F8E-8C32-670CA94EDA3C" title="首次在Oracle会话中使用时，通过数据库链接建立与网关的连接。">管理数据库链接别名库</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>