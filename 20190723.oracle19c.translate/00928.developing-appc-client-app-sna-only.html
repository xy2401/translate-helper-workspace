<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Developing Client Application (SNA Only)</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="User's Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-gateway-appc-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-04-16T18:35:49-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="F18239-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="creating-tip-oracle-database-gateway-appc.html" title="Previous" type="text/html">
      <link rel="next" href="implement-appc-commit-confirm-sna-only.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Gateway for APPC User's Guide">
    <meta name="dcterms.isVersionOf" content="APPUG">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="creating-tip-oracle-database-gateway-appc.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="implement-appc-commit-confirm-sna-only.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">User's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Developing Client Application (SNA Only)</li>
            </ol>
            <a id="GUID-9D1AFA3A-C1DC-4D52-AAAB-41269D6D5788" name="GUID-9D1AFA3A-C1DC-4D52-AAAB-41269D6D5788"></a><a id="APPUG400"></a>
            
            <h2 id="APPUG-GUID-9D1AFA3A-C1DC-4D52-AAAB-41269D6D5788" class="sect2"><span class="enumeration_chapter">4 </span> Developing Client Application (SNA Only)
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The following sections discuss how you will call a TIP and control a remote host transaction. It also provides you with the steps for preparing and executing a gateway transaction. The following assumptions are made:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p>a remote host transaction (RHT) has already been written</p>
                  </li>
                  <li>
                     <p>a TIP corresponding to the RHT has already been defined using the steps described in <a href="creating-tip-oracle-database-gateway-appc.html#GUID-78D4439E-7DD6-45DF-842E-35007FCC572B">Creating a TIP</a></p>
                     <div class="infoboxnote" id="GUID-9D1AFA3A-C1DC-4D52-AAAB-41269D6D5788__GUID-868E1727-1517-4BC4-865D-38F73C533907">
                        <p class="notep1">Note:</p>
                        <p>If your gateway uses the TCP/IP support for IMS Connect, refer to <a href="developing-appc-client-app-tcpip-only.html#GUID-705991C2-2CC2-4FAB-A04C-D63485B571FC"> Client Application Development (TCP/IP Only)</a> for information about calling a TIP and controlling a remote host transaction.
                        </p>
                     </div>
                  </li>
               </ul>
               <p>Topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-4AF92748-25E4-4262-88D7-742CE302709D">Overview of Client Application </a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-234C85C7-BC32-4B2F-9580-9151360B3DD7">Preparing the Client Application</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-BFE11091-D32F-4B66-B48F-5569EB5FAD6E">Understanding the Remote Host Transaction Requirements</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-30316801-BD91-4799-BAB2-B145F27CD624">Customized TIPs for Each Remote Host Transaction</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E">Client Application Requirements</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-B264D759-308E-46B3-B303-7E651B4AF83C">Ensuring TIP and Remote Transaction Program Correspondence</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-1C0A2278-D220-4DDB-888C-F691D057BB78">Calling the TIP from the Client Application</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-62418ADB-1A9B-4DCC-A2D5-70940D7ECBFC">Exchanging Data</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-19815A38-8520-41D5-9418-2DB46AFDB9AA">Executing the Application</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-E02BE2D4-97BA-407C-B1D6-4503D79561D7">APPC Conversation Sharing</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-2F5FD89A-06E6-47DF-84CD-525B6515B25F">Application Development with Multi-Byte Character Set Support</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-B118F27C-0B26-4429-8B70-3CC5B01C6A93">Modifying a Terminal-Oriented Transaction to Use APPC</a></p>
                  </li>
                  <li>
                     <p><a href="developing-appc-client-app-sna-only.html#GUID-8E530425-F978-4095-8A39-B8FD8BE2A47A">Privileges Needed to Use TIPs</a></p>
                  </li>
               </ul>
            </div><a id="APPUG1299"></a><a id="APPUG970"></a><div class="props_rev_3"><a id="GUID-4AF92748-25E4-4262-88D7-742CE302709D" name="GUID-4AF92748-25E4-4262-88D7-742CE302709D"></a><h3 id="APPUG-GUID-4AF92748-25E4-4262-88D7-742CE302709D" class="sect3">Overview of Client Application </h3>
               <div>
                  <p>The Procedural Gateway Administration Utility (<a id="d17239e161" class="indexterm-anchor"></a>PGAU) generates a complete TIP using definitions you provide. The client application can then call the TIP to access the remote host transaction. <a href="pga-utility-oracle-database-gateway-appc.html#GUID-F73E20E7-D94C-468F-BA65-CC34F6373F19"> Procedural Gateway Administration Utility </a>, discusses the use of PGAU in detail.
                  </p>
                  <p>This overview explains what you must do in order to call a TIP and control a remote host transaction.</p>
                  <p>The gateway receives PL/SQL calls from the <a id="d17239e172" class="indexterm-anchor"></a>Oracle database and issues APPC calls to communicate with a remote transaction program. The following three application programs make this possible:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>an APPC-enabled remote host transaction program</p>
                     </li>
                     <li>
                        <p>a <a id="d17239e182" class="indexterm-anchor"></a>Transaction Interface Package, or TIP. A TIP is a P<a id="d17239e185" class="indexterm-anchor"></a>L/SQL package that handles communication between the client and the gateway and performs datatype conversions between COBOL and PL/SQL.
                        </p>
                        <p>PGAU generates the <a id="d17239e192" class="indexterm-anchor"></a><a id="d17239e196" class="indexterm-anchor"></a>TIP specification for you. In the shipped samples, the PGAU-generated package is called <code class="codeph">pgadb2i.pkb</code>. This generated TIP includes at least three function calls that map to the remote transaction program:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">pgadb2i_init</code> initializes the conversation with the remote transaction program
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">pgadb2i_main</code> exchanges application data with the remote transaction program
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">pgadb2i_term</code> terminates the conversation with the remote transaction program
                              </p>
                           </li>
                        </ul>
                        <p>Refer to <a href="tip-internals-oracle-database-gateway-appc.html#GUID-9F4E3177-13B0-43CE-AD0A-5BCD66B3FD17"> Tip Internals</a> for more information about TIPs, if you are writing your own TIP or debugging.
                        </p>
                     </li>
                     <li>
                        <p>a client application that calls the TIP.</p>
                        <p>The client application calls the three TIP functions with input and output arguments. In the example, the client application passes <code class="codeph">empno</code>, an employee number to the remote transaction and the remote transaction sends back <code class="codeph">emprec</code> an employee record.
                        </p>
                     </li>
                  </ul>
                  <p><a href="developing-appc-client-app-sna-only.html#GUID-4AF92748-25E4-4262-88D7-742CE302709D__CHDDBIFA" title="This 3 column table describes demonstrates the logic flow between the PL/SQL driver, the TIP, and the gateway using the example CICS-DB2 transaction">Table 4-1</a> demonstrates the logic flow between the PL/SQL driver, the TIP, and the gateway using the example CICS-DB2 transaction. 
                  </p>
                  <div class="tblformal" id="GUID-4AF92748-25E4-4262-88D7-742CE302709D__CHDDBIFA">
                     <p class="titleintable">Table 4-1 Logic Flow of CICS-DB2 Example</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Logic Flow of CICS-DB2 Example" summary="This 3 column table describes demonstrates the logic flow between the PL/SQL driver, the TIP, and the gateway using the example CICS-DB2 transaction" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="24%" id="d17239e252">Client Application</th>
                              <th align="left" valign="bottom" width="30%" id="d17239e255">Oracle TIP</th>
                              <th align="left" valign="bottom" width="46%" id="d17239e258">Procedures Established Between the Gateway and the Remote Transaction (mainframe)</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="24%" id="d17239e263" headers="d17239e252 ">
                                 <p><code class="codeph">calls tip_init</code></p>
                                 <p></p>
                              </td>
                              <td align="left" valign="top" width="30%" headers="d17239e263 d17239e255 ">
                                 <p>Calls <code class="codeph">PGAINIT</code></p>
                              </td>
                              <td align="left" valign="top" width="46%" headers="d17239e263 d17239e258 ">
                                 <p>Gateway sets up control blocks and issues APPC <code class="codeph">ALLOCATE</code>. Mainframe program initiates.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="24%" id="d17239e280" headers="d17239e252 ">
                                 <p><code class="codeph">calls tip_main</code></p>
                              </td>
                              <td align="left" valign="top" width="30%" headers="d17239e280 d17239e255 ">
                                 <p>Calls <code class="codeph">PGAXFER</code> to send <code class="codeph">empno</code> and receive <code class="codeph">emprec</code></p>
                              </td>
                              <td align="left" valign="top" width="46%" headers="d17239e280 d17239e258 ">
                                 <p>Gateway issues APPC <code class="codeph">SEND</code> to the mainframe. Mainframe <code class="codeph">RECEIVE</code> completes. Mainframe performs application logic and issues APPC <code class="codeph">SEND</code> back to gateway. The gateway- issues APPC <code class="codeph">RECEIVE</code>; receive completes. Mainframe issues APPC <code class="codeph">TERM</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="24%" id="d17239e314" headers="d17239e252 ">
                                 <p><code class="codeph">calls tip_term</code></p>
                              </td>
                              <td align="left" valign="top" width="30%" headers="d17239e314 d17239e255 ">
                                 <p>Call <code class="codeph">PGATERM</code></p>
                              </td>
                              <td align="left" valign="top" width="46%" headers="d17239e314 d17239e258 ">
                                 <p>Gateway cleans up control blocks.</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>A client application which utilizes the gateway to exchange data with a remote host transaction performs some tasks for itself and instructs the TIP to perform other tasks on its behalf. The client application designer must consequently know the behavior of the remote transaction and how the TIP facilitates the exchange.</p>
                  <p>The following sections provide an overview of remote host transaction behavior, how this behavior is controlled by the client application and how TIP function calls and data declarations support the client application to control the remote host transaction. These sections also provide background information about what the TIP does for the client application and how the TIP calls exchange data with the remote host transaction.</p>
               </div>
            </div><a id="APPUG971"></a><div class="props_rev_3"><a id="GUID-234C85C7-BC32-4B2F-9580-9151360B3DD7" name="GUID-234C85C7-BC32-4B2F-9580-9151360B3DD7"></a><h3 id="APPUG-GUID-234C85C7-BC32-4B2F-9580-9151360B3DD7" class="sect3">Preparing the Client Application</h3>
               <div>
                  <div class="section">
                     <p>To prepare the client application for execution you must understand the remote host transaction requirements and then perform these steps:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li><span>Move relevant <a id="d17239e373" class="indexterm-anchor"></a>COBOL records layout (copybooks) to the gateway system for input to PGAU.</span></li>
                     <li><span>Describe the remote host transaction data and calls to the <a id="d17239e379" class="indexterm-anchor"></a>PG Data Dictionary     (PG DD) with <code class="codeph">DEFINE DATA</code>, <code class="codeph">DEFINE CALL</code>, and <code class="codeph">DEFINE TRANSACTION</code> statements.</span></li>
                     <li><span>Generate the TIP in the Oracle database, using <code class="codeph">GENERATE</code>.</span></li>
                     <li><span>Create the client application that calls the TIP public functions.</span></li>
                     <li><span>Grant privileges on the newly created package.</span></li>
                  </ol>
               </div>
            </div><a id="APPUG972"></a><div class="props_rev_3"><a id="GUID-BFE11091-D32F-4B66-B48F-5569EB5FAD6E" name="GUID-BFE11091-D32F-4B66-B48F-5569EB5FAD6E"></a><h3 id="APPUG-GUID-BFE11091-D32F-4B66-B48F-5569EB5FAD6E" class="sect3">Understanding the Remote Host Transaction Requirements</h3>
               <div>
                  <p>Browse through the remote host transaction program (RTP) to determine: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>the PL/SQL parameters required on the various client application to TIP calls</p>
                     </li>
                     <li>
                        <p>the order in which the calls are made</p>
                     </li>
                  </ul>
                  <p>Identify the remote host transaction program (RTP) facilities to be called and the data to be exchanged on each call. You will then define the following, and store them in the PG&nbsp;DD:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">DEFINE DATA</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">DEFINE CALL</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">DEFINE TRANSACTION</code></p>
                     </li>
                  </ul>
                  <p>Refer to <a href="creating-tip-oracle-database-gateway-appc.html#GUID-78D4439E-7DD6-45DF-842E-35007FCC572B"> Creating a TIP</a> for specific definition steps and for the actual creation and generation of a TIP.
                  </p>
               </div><a id="APPUG973"></a><div class="props_rev_3"><a id="GUID-72D8DB06-5E1C-499E-8C3F-95D5304DB401" name="GUID-72D8DB06-5E1C-499E-8C3F-95D5304DB401"></a><h4 id="APPUG-GUID-72D8DB06-5E1C-499E-8C3F-95D5304DB401" class="sect4">TIP Content and Purpose</h4>
                  <div>
                     <p>The content of a PGAU-generated TIP reflects the calls available to the remote host transaction and the data that has been exchanged. Understanding this content helps when designing and debugging client applications that call the TIP.</p>
                     <p>A TIP is a <a id="d17239e522" class="indexterm-anchor"></a>PL/SQL package, and accordingly has <a id="d17239e527" class="indexterm-anchor"></a><a id="d17239e531" class="indexterm-anchor"></a>two sections:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>A Package Specification containing:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Public function prototypes and parameters, and</p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>A Package Body containing:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Private functions and internal control variables</p>
                              </li>
                              <li>
                                 <p>Public functions</p>
                              </li>
                              <li>
                                 <p>Package initialization following the last public function.</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p>The purpose of the TIP is to provide a PL/SQL callable public function for every allowed remote transaction program interaction. A <a id="d17239e561" class="indexterm-anchor"></a>remote transaction program interaction is a logically related group of data exchanges through one or more <a id="d17239e566" class="indexterm-anchor"></a><a id="d17239e568" class="indexterm-anchor"></a><code class="codeph">PGAXFER</code> RPC calls. This is conceptually similar to a screen or menu interaction in which several fields are filled in, the enter key is pressed, and several fields are returned to the user. Carrying the analogy further:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>the user might be likened to the TIP or client application</p>
                        </li>
                        <li>
                           <p>fields to be filled in are <code class="codeph">IN</code> parameters on the TIP function call
                           </p>
                        </li>
                        <li>
                           <p>fields returned are <code class="codeph">OUT</code> parameters on the TIP function call
                           </p>
                        </li>
                        <li>
                           <p>screen or menu is the group of <code class="codeph">IN</code> and <code class="codeph">OUT</code> parameters combined
                           </p>
                        </li>
                        <li>
                           <p>a pressed enter key is likened to the <code class="codeph">PGAXFER</code> remote procedural call (RPC)
                           </p>
                        </li>
                     </ul>
                     <p>The actual grouping of parameters that constitute a transaction call is defined by the user. The gateway places no restrictions on how a remote transaction program might correspond to a collection of TIP function calls, each call having many <code class="codeph">IN</code> and <code class="codeph">OUT</code> parameters.
                     </p>
                     <p>PGA users typically have one TIP per remote transaction program. How the TIP function calls are grouped and what data parameters are exchanged on each call depends on the size, complexity and behavior of the remote transaction program.</p>
                     <p>Refer to Oracle's <a href="../lnpls/index.html" target="_blank"><span class="italic">Oracle Database PL/SQL Language Reference</span></a> for a discussion of how <a id="d17239e623" class="indexterm-anchor"></a>PL/SQL packages work. The following discussion covers the logic that must be performed within a TIP. Refer to the sample TIP and driver supplied in the                       <code class="codeph">%ORACLE_HOME%\dg4appc\demo\CICS </code>directory for Microsoft Windows or  <code class="codeph">$ORACLE_HOME/dg4appc/demo/CICS</code> directory for UNIX based systems, in files<a id="d17239e632" class="indexterm-anchor"></a><a id="d17239e634" class="indexterm-anchor"></a> <code class="codeph">pgadb2i.pkh</code>, <a id="d17239e643" class="indexterm-anchor"></a><a id="d17239e645" class="indexterm-anchor"></a><code class="codeph">pgadb2i.pkb</code>, and<a id="d17239e652" class="indexterm-anchor"></a> <code class="codeph">pgadb2id.sql</code>.
                     </p>
                  </div>
               </div><a id="APPUG974"></a><div class="props_rev_3"><a id="GUID-FD67739C-7249-466A-A492-0E43195A6D3B" name="GUID-FD67739C-7249-466A-A492-0E43195A6D3B"></a><h4 id="APPUG-GUID-FD67739C-7249-466A-A492-0E43195A6D3B" class="sect4">Remote Host Transaction Types</h4>
                  <div>
                     <p>From a database gateway application perspective, there are three main types of remote host transactions:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>one-shot</p>
                        </li>
                        <li>
                           <p>persistent</p>
                        </li>
                        <li>
                           <p>multi-conversational</p>
                        </li>
                     </ul>
                  </div><a id="APPUG975"></a><div class="props_rev_3"><a id="GUID-58F456FB-9B18-4D4A-ABA9-D97863A69B2E" name="GUID-58F456FB-9B18-4D4A-ABA9-D97863A69B2E"></a><h5 id="APPUG-GUID-58F456FB-9B18-4D4A-ABA9-D97863A69B2E" class="sect5">One-Shot Transactions</h5>
                     <div>
                        <p><a id="d17239e747" class="indexterm-anchor"></a>A simple remote transaction program which receives one employee number and returns the employee record could have a TIP which provides one call, passing the employee number as an <code class="codeph">IN</code> parameter and returning the employee record as an <code class="codeph">OUT</code> parameter. An additional two function calls must be provided by this and every TIP:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>a remote transaction program init function call</p>
                           </li>
                           <li>
                              <p>a remote transaction program terminate function call</p>
                           </li>
                        </ul>
                        <p>The most simple TIP has three public functions, such as <code class="codeph">tip_init</code>, <code class="codeph">tip_main</code>, and           <code class="codeph">tip_term</code>.
                        </p>
                        <p>The client application calls <code class="codeph">tip_init</code>, <code class="codeph">tip_main</code>, and <code class="codeph">tip_term</code> in succession. The corresponding activity at the remote site is remote transaction program start, data exchange, and remote transaction program end.
                        </p>
                        <p>The remote transaction program might even terminate itself before receiving a terminate signal from the gateway. This sequence is usual and is handled normally by gateway logic. This kind of remote transaction program is termed one-shot.</p>
                     </div>
                  </div><a id="APPUG976"></a><div class="props_rev_3"><a id="GUID-6F97F428-51DD-4A44-A5E3-EFD7A07A1AAD" name="GUID-6F97F428-51DD-4A44-A5E3-EFD7A07A1AAD"></a><h5 id="APPUG-GUID-6F97F428-51DD-4A44-A5E3-EFD7A07A1AAD" class="sect5">Persistent Transactions</h5>
                     <div>
                        <p><a id="d17239e826" class="indexterm-anchor"></a>A more complex remote transaction program has two modes of behavior: an <code class="codeph">INQUIRY</code> or reporting mode, and an <code class="codeph">UPDATE</code> mode. These modes can have two TIP data transfer function calls: one for <code class="codeph">INQUIRY</code> and one for <code class="codeph">UPDATE</code>. Such a TIP might have five public functions. For example:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a id="d17239e844" class="indexterm-anchor"></a><code class="codeph">tip_init</code></p>
                              <p>This initializes communications with the remote transaction program.</p>
                           </li>
                           <li>
                              <p><a id="d17239e856" class="indexterm-anchor"></a><code class="codeph">tip_mode</code></p>
                              <p>This accepts a mode selection parameter and puts the transaction program into either inquiry or update mode.</p>
                           </li>
                           <li>
                              <p><a id="d17239e868" class="indexterm-anchor"></a><code class="codeph">tip_inqr</code> 
                              </p>
                              <p>This returns an employee record for a given employee number.</p>
                           </li>
                           <li>
                              <p>t<a id="d17239e882" class="indexterm-anchor"></a><code class="codeph">ip_updt</code></p>
                              <p>This accepts an employee record for a given employee number.</p>
                           </li>
                           <li>
                              <p><a id="d17239e894" class="indexterm-anchor"></a><code class="codeph">tip_term</code></p>
                              <p>This terminates communications with the remote transaction program.</p>
                           </li>
                        </ul>
                        <p>The client application calls <code class="codeph">tip_init</code> and then <code class="codeph">tip_mode</code> to place the remote transaction program in inquiry mode which then scans employee records, searching for some combination of attributes (known to the client application and end-user).   Some parameter on an inquiry call is then set to signal a change to update mode and the client application calls <code class="codeph">tip_updt</code> to update some record. The client application finally calls <code class="codeph">tip_term</code> to terminate the remote transaction program.
                        </p>
                        <p>The corresponding activity at the <a id="d17239e920" class="indexterm-anchor"></a>remote site is:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>remote transaction program start</p>
                           </li>
                           <li>
                              <p>mode selection exchange</p>
                           </li>
                           <li>
                              <p>loop reading records</p>
                           </li>
                           <li>
                              <p>switch to update mode</p>
                           </li>
                           <li>
                              <p>update one record</p>
                           </li>
                           <li>
                              <p>remote transaction program end</p>
                           </li>
                        </ul>
                        <p>Such a remote transaction program is called persistent because it interacts until it is signalled to terminate.</p>
                        <p>The remote transaction program can be written to permit a return to inquiry mode and repeat the entire process indefinitely.</p>
                     </div>
                  </div><a id="APPUG977"></a><div class="props_rev_3"><a id="GUID-EB18C5AF-6577-4702-9893-250023FB106B" name="GUID-EB18C5AF-6577-4702-9893-250023FB106B"></a><h5 id="APPUG-GUID-EB18C5AF-6577-4702-9893-250023FB106B" class="sect5">Multi-Conversational Transactions</h5>
                     <div>
                        <p><a id="d17239e988" class="indexterm-anchor"></a>A client application might need to get information from one transaction, <code class="codeph">tran_A</code>, and subsequently write or lookup information from another, <code class="codeph">tran_B</code>. This is possible with a properly written client application and TIPs for <code class="codeph">tran_A</code> and <code class="codeph">tran_B</code>. In fact, any number of transactions might be concurrently controlled by a single client application. All transactions could be read-only, with the client application retrieving data from each and consolidating it into a local Oracle database or displaying it in an Oracle Form. 
                        </p>
                        <p>Alternatively, a transaction could be capable of operating in different modes or performing different services depending on what input selections were supplied by the client application. For example, one instance of <code class="codeph">tran_C</code> can perform one service while a second instance of <code class="codeph">tran_C</code> performs a second service. Each instance of          <code class="codeph">tran_C</code> would have its own unique conversation with the client application and each instance could have its own behavior (one-shot or persistent) depending on the nature of the service being performed.
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="APPUG1300"></a><a id="APPUG978"></a><div class="props_rev_3"><a id="GUID-30316801-BD91-4799-BAB2-B145F27CD624" name="GUID-30316801-BD91-4799-BAB2-B145F27CD624"></a><h3 id="APPUG-GUID-30316801-BD91-4799-BAB2-B145F27CD624" class="sect3">Customized TIPs for Each Remote Host Transaction</h3>
               <div>
                  <p>Each remote host system might have hundreds of <a id="d17239e1057" class="indexterm-anchor"></a>remote transaction programs (RTPs) which a user might want to call. Each remote transaction program is different, passes different data, and performs different functions. The interface between the user and each remote transaction program must consequently be specialized and customized to the user's requirements for each remote transaction program. The Transaction Interface Package provides this customized interface.
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-30316801-BD91-4799-BAB2-B145F27CD624__GUID-BA1A1ECC-D0C8-4B68-9E3D-596D66EC921F">Example</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Assume that the remote site has a transaction program which manages employee information in an employee database or other file system. The remote transaction program's name, in the remote host, is <code class="codeph">EMPT</code> for Employee Tracking. <code class="codeph">EMPT</code> provides both inquiry and update facilities, and different Oracle users are required to access and use these <code class="codeph">EMPT</code> facilities.
                     </p>
                     <p>Some users might be restricted to inquiry-only use of <code class="codeph">EMPT</code>, while others might have update requirements. In support of the Oracle users' client applications, at least three possible TIPs could exist:
                     </p>
                     <ol>
                        <li>
                           <p><code class="codeph">EMP_MGMT</code> to provide access to all facilities of the <code class="codeph">EMPT</code> remote transaction program.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">EMP_UPDT</code> to access only the update functions of the <code class="codeph">EMPT</code> remote transaction program.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">EMP_INQR</code> to access only the lookup functions of the <code class="codeph">EMPT</code> remote transaction program.
                           </p>
                        </li>
                     </ol>
                     <p>End-user access to these TIPs is controlled by Oracle privileges. Additional security might be imposed on the end-user by the remote host.</p>
                     <p>Each TIP also has encoded within it the name of the remote transaction program (<code class="codeph">EMPT</code>) and network information sufficient to establish an APPC conversation with <code class="codeph">EMPT</code>.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="APPUG1301"></a><a id="APPUG1302"></a><a id="APPUG1303"></a><a id="APPUG979"></a><div class="props_rev_3"><a id="GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E" name="GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E"></a><h3 id="APPUG-GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E" class="sect3">Client Application Requirements</h3>
               <div>
                  <p>Using the TIP, the client application must correspond with and control the <a id="d17239e1181" class="indexterm-anchor"></a>remote host transaction. This involves:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>client application initialization</p>
                     </li>
                     <li>
                        <p>user input and output</p>
                     </li>
                     <li id="GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E__I1008983">
                        <p>remote host transaction initialization using the TIP initialization functions (with and without overrides)</p>
                     </li>
                     <li id="GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E__I1008989">
                        <p>remote host transaction control and data exchange using the TIP user functions</p>
                     </li>
                     <li id="GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E__I1008993">
                        <p>remote host transaction termination using the TIP termination function</p>
                        <p>The preceding three steps vary, based on the requirements of the remote host transaction.</p>
                     </li>
                     <li>
                        <p>exception handling</p>
                     </li>
                     <li>
                        <p>client application termination</p>
                     </li>
                  </ul>
                  <div class="section">
                     <p class="subhead2" id="GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E__GUID-7AAE85C6-85B8-48CE-96F8-5ABD3024CCFD"> One-shot remote host transaction client applications must:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Declare RHT/TIP datatypes to be exchanged. <a id="d17239e1218" class="indexterm-anchor"></a>All client applications must declare variables to be exchanged with the RHTs using TIPs. <a id="d17239e1225" class="indexterm-anchor"></a>PL/SQL datatypes for such variables have already been defined in the TIP corresponding to each RHT and the client application need only reference the TIP datatype in its declaration. Refer also to <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-26AFD2F9-2126-418D-9B71-B01D2A06E7E6">Declaring TIP Variables</a>"</span> for more information. Also refer to the TIP content documentation file for the specific TIP/RHT for more information about the exact usage of these variables.
                           </p>
                        </li>
                        <li>
                           <p>Initialize the RHT using the TIP initialization function<a id="d17239e1238" class="indexterm-anchor"></a>. The TIP directs the gateway server to initialize a conversation with the desired RHT, specifying either default RHT identifying parameters (supplied when the RHT was defined in the PG DD and encoded within the TIP when it was generated) or override RHT identifying parameters supplied by the user or client application when the TIP initialization function is called. Refer to <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-41ABD528-5797-468E-A436-B6B3434ADF34">Initializing the Conversation</a>"</span> and <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-125BF246-33A2-46AF-87E8-7344F3B4F573">Overriding TIP Initializations</a>"</span> for more details. 
                           </p>
                        </li>
                        <li>
                           <p>Exchange data with the RHT using the TIP user function (one call).<a id="d17239e1258" class="indexterm-anchor"></a> As previously discussed, a one-shot remote host transaction only accommodates a single data exchange and upon completion of that exchange, the RHT terminates on its own. The client application consequently needs only to execute a single call to the user-defined TIP function to cause the data exchange. 
                           </p>
                           <p>Refer to the TIP content documentation file in                                                  <code class="codeph">%ORACLE_HOME%\dg4appc\demo\CICS\</code> on Microsoft Windows or <code class="codeph">$ORACLE_HOME/dg4appc/demo/CICS/</code> on UNIX based systems, for the specific TIP/RHT for the exact syntax of this call.
                           </p>
                           <p>The client application should initialize values into <code class="codeph">IN</code> or <code class="codeph">IN OUT</code> parameter values before calling the TIP function call. These are the same variables that were declared above, when you declared the RHT/TIP datatypes to be exchanged.
                           </p>
                           <p>All TIP function calls return a <code class="codeph">0</code> return code value and all returned user gateway data values are exchanged in the function parameters. Any exception conditions are raised as required and can be intercepted in an exception handler.
                           </p>
                           <p>Upon return from the TIP function call, the client application can analyze and operate on the <code class="codeph">IN OUT</code> or <code class="codeph">OUT</code> parameter values. These are the same variables that were declared above, when you declared the RHT/TIP datatypes to be exchanged.
                           </p>
                           <p>Refer to <a href="data-type-conversion-oracle-database-gateway-appc.html#GUID-FEB0C201-9C07-4932-A328-B048B582B18A"> Datatype Conversions</a> for details about how TIPs convert the various types and formats of remote host data.
                           </p>
                        </li>
                        <li>
                           <p>Terminate the RHT using the TIP termination function<a id="d17239e1303" class="indexterm-anchor"></a>. Regardless of the type of RHT being accessed, the TIP terminate function should be called to clean up and terminate the conversation with the RHT. Conversations with one-shot RHTs can be terminated from the gateway server before the RHT terminates. The TIP must perform its cleanup as well. Cleanup is only performed at the termination request of the client application.
                           </p>
                           <p>The client application can request a normal or an aborted termination.</p>
                           <p>Refer to <a id="d17239e1314" class="indexterm-anchor"></a><a id="d17239e1316" class="indexterm-anchor"></a><span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-3CDB9504-3937-4909-A6FE-3B63FC25BF75">Terminating the Conversation</a>"</span> for more information.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E__GUID-A1A87711-9449-496D-88E7-B271382F6BBD">Persistent remote host transaction client applications must:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Declare RHT/TIP datatypes to be exchanged. <a id="d17239e1333" class="indexterm-anchor"></a>All client applications must declare variables to be exchanged with the RHTs using TIPs. <a id="d17239e1340" class="indexterm-anchor"></a>PL/SQL datatypes for such variables have already been defined in the TIP corresponding to each RHT; the client application need only reference the TIP datatype in its declaration. Refer to <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-26AFD2F9-2126-418D-9B71-B01D2A06E7E6">Declaring TIP Variables</a>"</span> for more information. Refer also to the TIP content documentation file for the specific TIP/RHT for more information about the exact usage of these variables.
                           </p>
                        </li>
                        <li>
                           <p>Initialize the RHT using the TIP initialization function. <a id="d17239e1353" class="indexterm-anchor"></a>The TIP directs the gateway server to initialize a conversation with the desired RHT, specifying either default RHT identifying parameters (supplied when the RHT was defined in the PG DD and encoded within the TIP when it was generated) or override RHT identifying parameters supplied by the user or client application when the TIP initialization function is called. Refer to <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-41ABD528-5797-468E-A436-B6B3434ADF34">Initializing the Conversation</a>"</span> and <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-125BF246-33A2-46AF-87E8-7344F3B4F573">Overriding TIP Initializations</a>"</span> for more details. 
                           </p>
                        </li>
                        <li>
                           <p>Repetitively exchange data with RHT using the TIP user function(s).<a id="d17239e1373" class="indexterm-anchor"></a> Remote host transactions that provide or require ongoing or repetitive control sequences should be controlled by the client application in the same manner that the RHT would be operated by an interactive user or other control program. The intercession of the TIP and gateway server does not alter the RHT behavior; instead, it extends control of that behavior to the client application using the various function calls defined in the TIP.
                           </p>
                           <p>A persistent RHT can be controlled with one or more TIP function calls. The RHT might be designed, for example, to loop and return output for every input until the conversation is explicitly terminated. Or it could have been designed to accept as input a count or list of operations to perform and return the results in multiple exchanges for which the TIP function has only <code class="codeph">OUT</code> parameters.
                           </p>
                           <p>A persistent RHT can also be interactive, each output being specified by a previous input selection and ending only when the conversation has been explicitly terminated by the client application.</p>
                           <p>The TIP function calls available to the client applications and their specific syntax is documented in the TIP Content documentation file for the specific TIP/RHT.</p>
                           <p>The manner in which the RHT interprets the TIP <code class="codeph">IN</code> parameters and returns TIP <code class="codeph">OUT</code> parameters must be determined from the RHT or explained by the RHT programmer. The TIP provides the function calls and the exchanged parameter datatypes to facilitate the client application's control of the RHT and imposes no limitations or preconditions on the sequence of operations the RHT is directed to perform. The TIP provides the client application with the calls and data parameters the RHT was defined to accept in the PG DD.
                           </p>
                        </li>
                        <li>
                           <p>Terminate the RHT using the TIP termination function<a id="d17239e1400" class="indexterm-anchor"></a>. Regardless of the type of RHT being accessed, the TIP terminate function should be called to clean up and terminate the conversation with the RHT. Conversations with persistent RHTs can be terminated from the gateway server before the RHT terminates, or the RHT might have already terminated. The TIP must perform its cleanup as well and this cleanup is only performed at the termination request of the client application.
                           </p>
                           <p>The client application can request a normal or an aborted termination.</p>
                           <p>Refer to <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-3CDB9504-3937-4909-A6FE-3B63FC25BF75">Terminating the Conversation</a>"</span> for more information.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E__GUID-593ABAAC-F841-4C3F-9E40-C787577267B5">Multi-conversational remote host transaction client applications must:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Declare RHT/TIP datatypes to be exchanged.<a id="d17239e1424" class="indexterm-anchor"></a> All client applications must declare variables to be exchanged with the RHTs using TIPs. <a id="d17239e1431" class="indexterm-anchor"></a>PL/SQL datatypes for such variables have already been defined in the TIP corresponding to each RHT, and the client application need only reference the TIP datatype in its declaration. Refer to <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-26AFD2F9-2126-418D-9B71-B01D2A06E7E6">Declaring TIP Variables</a>"</span> for more information. Also refer to the TIP content documentation file for the specific TIP/RHT for more information about the exact usage of these variables.
                           </p>
                        </li>
                        <li>
                           <p>Initialize each RHT involved, using the TIP initializing function<a id="d17239e1444" class="indexterm-anchor"></a>. A specific customized TIP exists for each RHT as defined in the PG DD. Client applications that control multiple RHTs are multi-conversational and must start each RHT and its associated conversation. This is done by calling each TIP initialization function as before; but multiple TIPs are initialized.
                           </p>
                           <p>If a single RHT is designed to perform multiple services for one or more callers and if the client application is designed to use this RHT, the TIP corresponding to that RHT can be initialized multiple times by the client application.</p>
                           <p>The client application subsequently distinguishes from active RHTs under its control using:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>TIP schema <code class="codeph">tipname.callname</code> when multiple TIP/RHTs are being controlled. By encoding the same TIP schema name on TIP user calls, the client application specifies to which RHT the call is being made.
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">tranuse</code> <code class="codeph">IN OUT</code> parameter value when multiple instances of the same TIP/RHT are being controlled. This is the value returned on the TIP initialization function call and subsequently passed as an <code class="codeph">IN</code> parameter on the user-defined TIP function calls. The returned <code class="codeph">tranuse</code> value corresponds to that conversation connected to a given instance of an RHT. By supplying the same <code class="codeph">tranuse</code> value on TIP user calls, the client application specifies to which RHT instance the given RHT call is being made.
                                 </p>
                              </li>
                           </ul>
                           <p>Client application logic must keep track of which RHTs have been started and which TIPs and <code class="codeph">tranuse</code> values correspond to started RHTs.
                           </p>
                        </li>
                        <li>
                           <p>Exchange data with each RHT, using the TIP user function(s), either once or repetitively<a id="d17239e1487" class="indexterm-anchor"></a> if the RHT is one-shot or persistent. Client application logic must sequence the RHTs though their allowed steps in accordance with proper RHT operation, as does a user operating the RHTs interactively.
                           </p>
                           <p>Client application logic must also perform any cross-RHT result analysis or data transfer that might be required. All TIPs execute in isolation from each other.</p>
                           <p>Output from one RHT intended as input to another RHT must be received in the client application as an <code class="codeph">IN</code> or <code class="codeph">IN OUT</code> parameter from the first RHT and sent as an <code class="codeph">IN</code> or <code class="codeph">IN OUT</code> parameter from the client application to the second RHT. All TIP-to-RHT function calls must be performed by the client application and data parameters exchanged must have been declared as variables by the client application. The TIPs provide both the required datatype definitions and the RHT function calls for the client application.
                           </p>
                           <p>Refer to the TIP content documentation file for each specific TIP/RHT for the exact syntax of the TIP function calls and definitions of the parameter datatypes exchanged.</p>
                        </li>
                        <li>
                           <p>Terminate each initialized RHT<a id="d17239e1515" class="indexterm-anchor"></a>, using the TIP termination function. To terminate an RHT, its corresponding TIP termination function must be called to terminate the RHT and its conversation and to initiate TIP cleanup. The RHT to be terminated is specified by its TIP schema name (the same schema as for its data exchange function calls) and the <code class="codeph">tranuse</code> value when multiple instances of the same RHT are being terminated.
                           </p>
                           <p>RHTs and their corresponding TIPs can be terminated in any sequence desired by the client application and do not have to be terminated in the same order in which they are initialized.</p>
                           <div class="infoboxnote" id="GUID-A3323A41-AEDA-48EA-90D2-4C150D708D8E__GUID-0685857D-C793-43B8-8CEC-C04933C85D14">
                              <p class="notep1">Note:</p>
                              <p>The specific syntax of the various TIP data exchange variables function calls is the same as was previously defined in the PG DD for the particular RHT and can be researched by examining the TIP content documentation file<a id="d17239e1530" class="indexterm-anchor"></a><a id="d17239e1532" class="indexterm-anchor"></a> (<code class="codeph">tipname.doc</code>) or the TIP specification file produced when the TIP was generated. If a TIP has not yet been generated for the RHT being accessed, refer to <a href="creating-tip-oracle-database-gateway-appc.html#GUID-78D4439E-7DD6-45DF-842E-35007FCC572B"> Creating a TIP</a>, and <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-2EE274FF-C15C-4E8A-9245-ACE1F41D147E">DATA Correspondence</a>"</span>, <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-5CB6DA00-C709-43E5-B3D1-3937D097E48F">CALL Correspondence</a>"</span>, and <span class="q">"<a href="developing-appc-client-app-sna-only.html#GUID-21400950-327F-4A8B-831D-3F34333C3264">TRANSACTION Correspondence</a>"</span> for more information. It is preferable to define and generate the TIP first, however, so that the client application reference documentation is available to you when needed.
                              </p>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="APPUG980"></a><div class="props_rev_3"><a id="GUID-B264D759-308E-46B3-B303-7E651B4AF83C" name="GUID-B264D759-308E-46B3-B303-7E651B4AF83C"></a><h3 id="APPUG-GUID-B264D759-308E-46B3-B303-7E651B4AF83C" class="sect3">Ensuring TIP and Remote Transaction Program Correspondence</h3>
               <div>
                  <p>A remote host transaction program and its related TIP with client application must correspond on <a id="d17239e1605" class="indexterm-anchor"></a>two key requirements:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Parameter datatype conversion, which results from the way in which transaction <code class="codeph">DATA</code> is defined. Refer to <a href="data-type-conversion-oracle-database-gateway-appc.html#GUID-FEB0C201-9C07-4932-A328-B048B582B18A"> Datatype Conversions</a> for a discussion of how PGAU-generated TIPs convert data based on the data definitions.
                        </p>
                     </li>
                     <li>
                        <p>APPC send/receive synchronization, which results from the way in which transaction <code class="codeph">CALL</code>s are defined
                        </p>
                     </li>
                  </ul>
                  <p>These <code class="codeph">DATA</code> and <code class="codeph">CALL</code> definitions are then included by reference in a <code class="codeph">TRANSACTION</code> definition.
                  </p>
               </div><a id="APPUG981"></a><div class="props_rev_3"><a id="GUID-2EE274FF-C15C-4E8A-9245-ACE1F41D147E" name="GUID-2EE274FF-C15C-4E8A-9245-ACE1F41D147E"></a><h4 id="APPUG-GUID-2EE274FF-C15C-4E8A-9245-ACE1F41D147E" class="sect4">DATA Correspondence</h4>
                  <div>
                     <p>Using data definitions programmed in the language of the remote host transaction, the <a id="d17239e1684" class="indexterm-anchor"></a><a id="d17239e1688" class="indexterm-anchor"></a>PGAU <code class="codeph">DEFINE DATA</code> command stores in the <a id="d17239e1694" class="indexterm-anchor"></a>PG DD the information needed for <a id="d17239e1699" class="indexterm-anchor"></a><a id="d17239e1701" class="indexterm-anchor"></a>PGAU <code class="codeph">GENERATE</code> to create the TIP function logic to perform:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>all data conversion from PL/SQL <code class="codeph">IN</code> parameters supplied by the receiving remote host transaction
                           </p>
                        </li>
                        <li>
                           <p>all buffering into the format expected by the receiving remote host transaction</p>
                        </li>
                        <li>
                           <p>all data unbuffering from the format supplied by the sending remote host transaction</p>
                        </li>
                        <li>
                           <p>all data conversion to PL/SQL <code class="codeph">OUT</code> parameters supplied by the sending remote host transaction
                           </p>
                        </li>
                     </ul>
                     <p>PGAU determines the information needed to generate the conversion and buffering logic from the data definitions included in the remote host transaction program. PGAU <code class="codeph">DEFINE DATA</code> reads this information from files, such as COBOL copy books, or in-stream from scripts and saves it in the PG DD for repeated use. The gateway Administrator needs to transfer these definition files from the remote host to the Oracle host where PGAU runs. 
                     </p>
                     <p>From the data definitions stored in the PG DD, PGAU <code class="codeph">GENERATE</code> determines the remote host datatype and matches it to an appropriate <a id="d17239e1739" class="indexterm-anchor"></a>PL/SQL datatype. It also determines data lengths and offsets within records and buffers and generates the needed PL/SQL logic into the TIP. Refer to the PGAU <span class="q">"<a href="pga-utility-oracle-database-gateway-appc.html#GUID-A39AE344-8E2F-49EE-9791-6BAF4ECF4F6B">DEFINE DATA</a>"</span> statement  in <a href="pga-utility-oracle-database-gateway-appc.html#GUID-F73E20E7-D94C-468F-BA65-CC34F6373F19"> Procedural Gateway Administration Utility </a> and <span class="q">"<a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-F0ACAA50-16F8-4C5C-83FE-C0D280981772">Sample PGAU DEFINE DATA Statements</a>"</span> in <a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-AA9B8762-BDAF-4EED-A8B0-09F8A937F04E"> Administration Utility Samples</a> for more information. 
                     </p>
                     <p>All data that are referenced as parameters by subsequent calls must first be defined using PGAU <code class="codeph">DEFINE DATA</code>. Simple data items, such as single numbers or character strings, and complex multi-field data aggregates, such as records or structures, can be defined. PGAU automatically generates equivalent PL/SQL variables and records of fields or tables for the client application to reference in its calls to the generated TIP.
                     </p>
                     <p>As discussed, a parameter might be a simple data item, such as an employee number, or a complex item, such as an employee record. PGAU <code class="codeph">DEFINE DATA</code> automatically extracts the datatype information it needs from the input program data definition files.
                     </p>
                     <p>In this example, <code class="codeph">empno</code> and <code class="codeph">emprec</code> are the arguments to be exchanged. 
                     </p><pre class="oac_no_warn" dir="ltr">pgadb2i_main(trannum,empno,emprec)
</pre><p>A PGAU <code class="codeph">DEFINE DATA</code> statement must therefore be issued for each of these parameters:
                     </p><pre class="oac_no_warn" dir="ltr">DEFINE DATA EMPNO
       PLSDNAME (EMPNO)
       USAGE (PASS)
       LANGUAGE (IBMVSCOBOLII)
       (
       01 EMP-NO PIC X(6).
       ); 

DEFINE DATA EMPREC
       PLSDNAME (DCLEMP)
       USAGE (PASS)
       LANGUAGE (IBMVSCOBOLII)
       INFILE("emp.cob");
</pre><p>Note that a definition is not required for the <code class="codeph">trannum</code> argument. This is the APPC conversation identifier and does not require a definition in PGAU.
                     </p>
                  </div>
               </div><a id="APPUG982"></a><div class="props_rev_3"><a id="GUID-5CB6DA00-C709-43E5-B3D1-3937D097E48F" name="GUID-5CB6DA00-C709-43E5-B3D1-3937D097E48F"></a><h4 id="APPUG-GUID-5CB6DA00-C709-43E5-B3D1-3937D097E48F" class="sect4">CALL Correspondence</h4>
                  <div>
                     <p>The requirement to synchronize <a id="d17239e1847" class="indexterm-anchor"></a>APPC <code class="codeph">SEND</code>s and <code class="codeph">RECEIVE</code>s means that when the remote transaction program expects data parameters to be input, it issues APPC <code class="codeph">RECEIVE</code>s to read the data parameters. Accordingly, the TIP must cause the gateway to issue APPC <code class="codeph">SEND</code>s to write the data parameters to the remote transaction program. The TIP must also cause the gateway to issue APPC <code class="codeph">RECEIVE</code>s when the remote transaction program issues APPC <code class="codeph">SEND</code>s.
                     </p>
                     <p>The PGAU <code class="codeph">DEFINE CALL</code> statement specifies how the generated TIP is to be called by the client application and which data parameters are to be exchanged with the remote host transaction for that call. Each PGAU <code class="codeph">DEFINE CALL</code> statement might specify the name of the TIP function, one or more data parameters, and the <code class="codeph">IN/OUT</code> mode of each data parameter. Data parameters must have been previously defined with PGAU <code class="codeph">DEFINE DATA</code> statements. Refer to <span class="q">"<a href="pga-utility-oracle-database-gateway-appc.html#GUID-01EEB1ED-7AB6-4BFA-AF6F-A9D36A44C0B1">DEFINE CALL</a>"</span> in <a href="pga-utility-oracle-database-gateway-appc.html#GUID-F73E20E7-D94C-468F-BA65-CC34F6373F19"> Procedural Gateway Administration Utility </a> and <span class="q">"<a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-336981E2-C7F9-47C1-8B18-330187556305">Sample PGAU DEFINE CALL Statements</a>"</span> in <a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-AA9B8762-BDAF-4EED-A8B0-09F8A937F04E"> Administration Utility Samples</a> for more information. 
                     </p>
                     <p>PGAU <code class="codeph">DEFINE CALL</code> processing stores the specified information in the PG DD for later use by PGAU <code class="codeph">GENERATE</code>. PGAU <code class="codeph">GENERATE</code> then creates the following in the TIP package specification:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>declarations of public PL/SQL functions for each <code class="codeph">CALL</code> defined with PL/SQL parameters for each <code class="codeph">DATA</code> definition specified on the <code class="codeph">CALL</code></p>
                        </li>
                        <li>
                           <p>declarations of the public PL/SQL data parameters</p>
                        </li>
                     </ul>
                     <p>The client application calls the TIP public function as a PL/SQL function call, using the function name and parameter list specified in the PGAU <code class="codeph">DEFINE CALL</code> statement. The client application might also declare, by reference, private variables of the same datatype as the TIP public data parameters to facilitate data passing and handling within the client application, thus sharing the declarations created by PGAU <code class="codeph">GENERATE</code>.
                     </p>
                     <p>In this example, the following PGAU <code class="codeph">DEFINE CALL</code> statement must be issued to define the TIP public function:
                     </p><pre class="oac_no_warn" dir="ltr">DEFINE CALL DB2IMAIN
       PKGCALL (pgadb2i_main)
       PARMS ((empno IN),(emprec OUT));</pre></div><a id="APPUG983"></a><div class="props_rev_3"><a id="GUID-0522D9DF-E342-4451-A167-0FD0E5ADD13D" name="GUID-0522D9DF-E342-4451-A167-0FD0E5ADD13D"></a><h5 id="APPUG-GUID-0522D9DF-E342-4451-A167-0FD0E5ADD13D" class="sect5">Flexible Call Sequence</h5>
                     <div>
                        <p><a id="d17239e1984" class="indexterm-anchor"></a><a id="d17239e1988" class="indexterm-anchor"></a>The number of data parameters exchanged between the TIP and the gateway on each call can vary at the user's discretion, as long as the remote transaction program's <code class="codeph">SEND/RECEIVE</code> requests are satisfied. For example, the remote transaction program data exchange sequence might be:
                        </p><pre class="oac_no_warn" dir="ltr">APPC SEND    5 fields  (field1-field5)
APPC RECEIVE 1 fields  (field6)
APPC SEND    1 field   (field7)
APPC RECEIVE 3 fields  (field8 - field10)
</pre><p>The resulting TIP/application call sequence could be:</p><pre class="oac_no_warn" dir="ltr">tip_call1(parm1 OUT,  &lt;-- APPC SEND field1 from remote TP
         parm2 OUT,  &lt;-- APPC SEND field2 from remote TP
         parm3 OUT); &lt;-- APPC SEND field3 from remote TP

tip_call2(parm4 OUT,  &lt;-- APPC SEND field4 from remote TP
         parm5 OUT); &lt;-- APPC SEND field5 from remote TP
tip_call3(parm6 IN OUT); --&gt; APPC RECEIVE field6 in remote TP
                         &lt;-- APPC SEND field7 from remote TP

tip_call4(parm8 IN,   --&gt; APPC RECEIVE field8 into remote TP
          parm9 IN,   --&gt; APPC RECEIVE field9 into remote TP
          parm10 IN); --&gt; APPC RECEIVE field10 into remote TP
</pre><p>To define these four public functions to the TIP, four PGAU <code class="codeph">DEFINE CALL</code> statements must be issued, each specifying its unique public function name (<code class="codeph">tip_callx</code>) and the data parameter list to be exchanged. Once a data item is defined using <code class="codeph">DEFINE DATA</code>, it can be referenced in multiple calls in any mode (<code class="codeph">IN</code>, <code class="codeph">OUT</code>, or<code class="codeph"> IN OUT</code>). For example, <code class="codeph">parm5</code> could be used a second time in place of <code class="codeph">parm6</code>. This implies the same data is being exchanged in both instances, received into the TIP and application on <code class="codeph">        tip_call2</code> and returned, possibly updated, to the remote host in <code class="codeph">tip_call4</code>.
                        </p>
                        <p>Notice also that the remote transaction program's first five written fields are read by two separate TIP function calls, <code class="codeph">tip_call1</code> and <code class="codeph">tip_call2</code>. This could also have been equivalently accomplished with five TIP function calls of one <code class="codeph">OUT</code> parameter each or a single TIP function call with five <code class="codeph">OUT</code> parameters. Then the remote transaction program's first read field (<code class="codeph">field6</code>) and subsequent written field (<code class="codeph">field7</code>) correspond to a single TIP function call (<code class="codeph">tip_call3</code>) with a single <code class="codeph">IN OUT </code>parameter (<code class="codeph">parm6</code>).
                        </p>
                        <p>This use of a single <code class="codeph">IN OUT</code> parameter implies that the remote transaction program's datatype for <code class="codeph">field6</code> and <code class="codeph">field7</code> are both the same and correspond to the conversion performed for the datatype of <code class="codeph">parm6</code>. If <code class="codeph">field6</code> and <code class="codeph">field7</code> were of different datatypes, then they have to correspond to different PL/SQL parameters (for example, <code class="codeph">parm6</code> <code class="codeph">IN</code> and <code class="codeph">parm7</code> <code class="codeph">OUT</code>). They could still be exchanged as two parameters on a single TIP call or one parameter each on two TIP calls, however.
                        </p>
                        <p>Lastly, the remote transaction program's remaining three <code class="codeph">RECEIVE</code> fields are supplied by <code class="codeph">tip_call4</code> parameters 8-10. They also could have been done with three TIP calls passing one parameter each or two TIP calls passing one parameter on one call and two parameters on the other, in either order. This flexibility permits the user to define the correspondence between the remote transaction program's operation and the TIP function calls in whatever manner best suits the user.
                        </p>
                     </div>
                  </div><a id="APPUG984"></a><div class="props_rev_3"><a id="GUID-14708CCA-BE3B-4571-9F1D-CA2158D51816" name="GUID-14708CCA-BE3B-4571-9F1D-CA2158D51816"></a><h5 id="APPUG-GUID-14708CCA-BE3B-4571-9F1D-CA2158D51816" class="sect5">Call Correspondence Order Restrictions</h5>
                     <div>
                        <p><a id="d17239e2145" class="indexterm-anchor"></a>Each TIP public function first sends all <code class="codeph">IN</code> parameters, before it receives any <code class="codeph">OUT</code> parameters. Thus, a remote transaction program expecting to send one field and then receive one field must correspond to separate TIP calls. 
                        </p>
                        <p>For example:</p><pre class="oac_no_warn" dir="ltr">tip_callO( parmO OUT); &lt;-- APPC SEND outfield from remote TP
</pre><p><code class="codeph">PGAXFER</code> RPC checks first for parameters to send, but finds none and proceeds to receive parameters:
                        </p><pre class="oac_no_warn" dir="ltr">tip_callI( parmI IN);  --&gt; APPC RECEIVE infield to remote TP
</pre><p><code class="codeph">PGAXFER</code> RPC processes parameters to send and then checks for parameters to receive, but finds none and completes; therefore, a single TIP public function with an <code class="codeph">OUT</code> parameter followed by an <code class="codeph">IN</code> parameter does not work, because the <code class="codeph">IN</code> parameter is processed first--regardless of its position in the parameter list.
                        </p>
                     </div>
                  </div>
               </div><a id="APPUG985"></a><div class="props_rev_3"><a id="GUID-21400950-327F-4A8B-831D-3F34333C3264" name="GUID-21400950-327F-4A8B-831D-3F34333C3264"></a><h4 id="APPUG-GUID-21400950-327F-4A8B-831D-3F34333C3264" class="sect4">TRANSACTION Correspondence</h4>
                  <div>
                     <p>The <a id="d17239e2234" class="indexterm-anchor"></a>remote host transaction is defined with the PGAU<code class="codeph"> DEFINE TRANSACTION</code> statement with additional references to prior definitions of <code class="codeph">CALL</code>s that the transaction supports.
                     </p>
                     <p>You specify the <a id="d17239e2247" class="indexterm-anchor"></a>remote host transaction attributes, such as:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>transaction ID or name</p>
                        </li>
                        <li>
                           <p>network address or location</p>
                        </li>
                        <li>
                           <p>system type (such as IBM370)</p>
                        </li>
                        <li>
                           <p>Oracle National Language of the remote host</p>
                           <div class="infoboxnote" id="GUID-21400950-327F-4A8B-831D-3F34333C3264__GUID-51349B34-B64C-4BB1-9549-15EC0CACC394">
                              <p class="notep1">Note:</p>
                              <p>The <a id="d17239e2268" class="indexterm-anchor"></a>PL/SQL package name is specified when the transaction is defined; this is the name by which the TIP is referenced and which the public function calls to be included within the TIP. Each public function must have been previously defined with a PGAU <code class="codeph">DEFINE CALL</code> statement, which has been stored in the PG DD.   If you do not specify a package name (TIP name) in the <code class="codeph">GENERATE</code> statement, the transaction name you specified will become the package name by default. In that case, the transaction name (<span class="italic"><code class="codeph">tname) </code></span>must be unique and must be in valid PL/SQL syntax within the database containing the PL/SQL packages. 
                              </p>
                              <p>For more information, refer to <span class="q">"<a href="pga-utility-oracle-database-gateway-appc.html#GUID-EC8B6848-0566-45CD-BA08-78F15ED0EEB4">DEFINE TRANSACTION</a>"</span> in <a href="pga-utility-oracle-database-gateway-appc.html#GUID-F73E20E7-D94C-468F-BA65-CC34F6373F19"> Procedural Gateway Administration Utility </a> and <span class="q">"<a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-C8F9DE40-9DE6-4F49-A765-BFFDEC3065F9">Sample PGAU DEFINE TRANSACTION Statement</a>"</span> in <a href="admin-utility-samples-oracle-database-gateway-appc.html#GUID-AA9B8762-BDAF-4EED-A8B0-09F8A937F04E"> Administration Utility Samples</a>.
                              </p>
                           </div>
                        </li>
                     </ul>
                     <p>In this example, the following <code class="codeph">DEFINE TRANSACTION</code> statements are used to define a remote CICS transaction called <code class="codeph">DB2I</code>:
                     </p><pre class="oac_no_warn" dir="ltr">DEFINE TRANSACTION DB2I
   CALL (   DB2IMAIN,
            DB2IDIAG   )
   SIDEPROFILE(CICSPROD)
   TPNAME(DB2I)
   LOGMODE(ORAPLU62)
   SYNCLEVEL(0)
   NLS_LANGUAGE("AMERICAN_AMERICA.WE8EBCDIC37C");</pre></div>
               </div>
            </div><a id="APPUG986"></a><div class="props_rev_3"><a id="GUID-1C0A2278-D220-4DDB-888C-F691D057BB78" name="GUID-1C0A2278-D220-4DDB-888C-F691D057BB78"></a><h3 id="APPUG-GUID-1C0A2278-D220-4DDB-888C-F691D057BB78" class="sect3">Calling the TIP from the Client Application</h3>
               <div>
                  <p>Once a TIP is created, a client application must be written to interface with the TIP. A client application that calls the TIP functions must include five logical sections:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>declaring TIP variables</p>
                     </li>
                     <li>
                        <p>initializing the conversation</p>
                     </li>
                     <li>
                        <p>exchanging data </p>
                     </li>
                     <li>
                        <p>terminating the conversation</p>
                     </li>
                     <li>
                        <p>error handling</p>
                     </li>
                  </ul>
               </div><a id="APPUG1304"></a><a id="APPUG1305"></a><a id="APPUG987"></a><div class="props_rev_3"><a id="GUID-26AFD2F9-2126-418D-9B71-B01D2A06E7E6" name="GUID-26AFD2F9-2126-418D-9B71-B01D2A06E7E6"></a><h4 id="APPUG-GUID-26AFD2F9-2126-418D-9B71-B01D2A06E7E6" class="sect4">Declaring TIP Variables</h4>
                  <div>
                     <p>The user declarations section of the <code class="codeph">tipname.doc</code> file documents the required declarations.
                     </p>
                     <p>When passing <a id="d17239e2425" class="indexterm-anchor"></a>PL/SQL parameters on calls to TIP functions, the client application must use the exact same PL/SQL datatypes for TIP function arguments as are defined by the TIP in its specification section. Assume, for example, the following is in the TIP specification, or <code class="codeph">tipname.doc:</code></p><pre class="oac_no_warn" dir="ltr">FUNCTION <span class="italic">tip_call1</span>    <span class="italic">tranuse</span>,   IN      BINARY_INTEGER, 
                      <span class="italic">tip_var1   io_mode pls_type1,</span> 
                      <span class="italic">tip_record io_mode tran_rectype)</span> 
RETURN INTEGER;

TYPE  <span class="italic">tran_rectype</span> is RECORD
      <span class="italic">(rec_field1 pls_type1</span>,
      ...
      <span class="italic">rec_fieldN pls_typeN)</span>;
</pre><p><a href="developing-appc-client-app-sna-only.html#GUID-26AFD2F9-2126-418D-9B71-B01D2A06E7E6__G1013935" title="This 2 column table provides a description of the function declaration.">Table 4-2</a> provides a description of the function declarations: 
                     </p>
                     <div class="tblformal" id="GUID-26AFD2F9-2126-418D-9B71-B01D2A06E7E6__G1013935">
                        <p class="titleintable">Table 4-2 Function Declarations</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Function Declarations" summary="This 2 column table provides a description of the function declaration." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d17239e2472">Item</th>
                                 <th align="left" valign="bottom" width="69%" id="d17239e2475">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e2480" headers="d17239e2472 ">
                                    <p><span class="italic"><code class="codeph">tip_call1</code></span> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e2480 d17239e2475 ">
                                    <p>The TIP function name as defined in the package specification.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e2490" headers="d17239e2472 ">
                                    <p><span class="italic"><code class="codeph">tranuse</code></span></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e2490 d17239e2475 ">
                                    <p>The remote transaction instance parameter returned from the TIP init function identifying the conversation on which this TIP call is to exchange data.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e2499" headers="d17239e2472 ">
                                    <p><span class="italic"><code class="codeph">tran_rectype</code></span> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e2499 d17239e2475 ">
                                    <p>The PL/SQL record datatype declared in the <code class="codeph">tipname</code><span class="italic"> </span>TIP specification. This is the same value as in the                            TYPE<span class="italic"> </span><span class="italic"><code class="codeph">tran_rectype</code></span><code class="codeph"> is RECORD</code> statement.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e2522" headers="d17239e2472 ">
                                    <p><span class="italic"><code class="codeph">pls_typeN</code></span></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e2522 d17239e2475 ">
                                    <p>Is a PL/SQL atomic datatype.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e2531" headers="d17239e2472 ">
                                    <p><span class="italic"><code class="codeph">rec_fieldN</code></span></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e2531 d17239e2475 ">
                                    <p>Is a PL/SQL record field corresponding to a remote transaction program record field.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>In the client application PL/SQL atomic datatypes should be defined as the exact same datatype of their corresponding arguments in the TIP function definition. The following should be coded in the client application before the <code class="codeph">BEGIN</code> command:
                     </p><pre class="oac_no_warn" dir="ltr"><span class="italic">appl_var  pls_type1</span>;    /* declare appl variable for ....  */
</pre><p>TIP datatypes need not be redefined. They must be declared <code class="codeph">locally</code> within the client application, appearing in the client application before the <code class="codeph">BEGIN</code>:
                     </p><pre class="oac_no_warn" dir="ltr"><span class="italic">appl_record tipname.tran_rectype;</span>  /* declare appl record */
</pre><p><a href="developing-appc-client-app-sna-only.html#GUID-26AFD2F9-2126-418D-9B71-B01D2A06E7E6__G1013965" title="This 2 column table describes the command line arguments.">Table 4-3</a> describes the command line arguments:
                     </p>
                     <div class="tblformal" id="GUID-26AFD2F9-2126-418D-9B71-B01D2A06E7E6__G1013965">
                        <p class="titleintable">Table 4-3 Command Line Arguments </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Command Line Arguments " summary="This 2 column table describes the command line arguments." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d17239e2576">Item</th>
                                 <th align="left" valign="bottom" width="69%" id="d17239e2579">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e2584" headers="d17239e2576 ">
                                    <p><span class="italic"><code class="codeph">tip_call1</code></span> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e2584 d17239e2579 ">
                                    <p>The TIP function name as defined in the package specification.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e2594" headers="d17239e2576 ">
                                    <p><span class="italic"><code class="codeph">tranuse</code></span></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e2594 d17239e2579 ">
                                    <p>The remote transaction instance parameter returned from the TIP init function identifying the conversation on which this TIP call is to exchange data.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e2603" headers="d17239e2576 ">
                                    <p><span class="italic"><code class="codeph">tran_rectype</code></span> 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e2603 d17239e2579 ">
                                    <p>The PL/SQL record datatype declared in the <code class="codeph">tipname</code><span class="italic"> </span>TIP specification. This is the same value as in the <code class="codeph">TYPE</code><span class="italic">                    </span><span class="italic"><code class="codeph">tran_rectype</code></span><code class="codeph"> is RECORD</code> statement.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>Refer to the <span class="italic"><code class="codeph">tipname</code></span><code class="codeph">.doc</code> content file for a complete description of the user declarations you can reference.
                     </p>
                     <p>The client application calls the TIP public function as if it were any local PL/SQL function:</p><pre class="oac_no_warn" dir="ltr">rc = tip_call1( tranuse,
                appl_var,
                appl_record);
</pre><p>In the CICS-DB2 inquiry example, the PL/SQL driver <code class="codeph">pgadb2id.sql</code>, which is<span class="bold"> </span>located in <code class="codeph">%ORACLE_HOME%\dg4appc\demo\CICS</code> directory for Microsoft Windows and <code class="codeph">$ORACLE_HOME/dg4appc/demo/CICS</code> directory for UNIX based systems, is the client application and includes the following declaration:
                     </p><pre class="oac_no_warn" dir="ltr">...
...
CREATE or REPLACE PROCEDURE db2idriv(empno IN CHAR) IS
tranuse INTEGER :=0               /* transaction usage number     */
DCLEMP PGADB2I.DCLEMP_typ;        /* DB2 EMP row definition       */
DB2 PGADB2I.DB2_typ;              /* DB2 diagnostic information   */
rc INTEGER :=0                    /* PGA RPC return codes         */
line VARCHAR2(132);               /* work buffer for output       */
term INTEGER :=0;                 /* 1 if pgadb2i_term called     */
...
...</pre></div>
               </div><a id="APPUG988"></a><div class="props_rev_3"><a id="GUID-41ABD528-5797-468E-A436-B6B3434ADF34" name="GUID-41ABD528-5797-468E-A436-B6B3434ADF34"></a><h4 id="APPUG-GUID-41ABD528-5797-468E-A436-B6B3434ADF34" class="sect4">Initializing the Conversation</h4>
                  <div>
                     <p>The call to <a id="d17239e2688" class="indexterm-anchor"></a>initialize the conversation serves several purposes:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>To cause the PL/SQL package, the TIP, to be loaded and to perform the initialization logic programmed in the TIP initialization section. </p>
                        </li>
                        <li>
                           <p>To cause the TIP init function to call the <code class="codeph">PGAINIT</code> remote procedural call (RPC), which in turn establishes communication with the remote transaction program (RTP), and returns a transaction instance number to the application.
                           </p>
                        </li>
                     </ul>
                     <p>Optionally, calls to initialize the conversation can be used to:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Override default RHT/OLTP identification, network address attributes, and conversation security user&nbsp;ID and password.</p>
                        </li>
                        <li>
                           <p>Specify what diagnostic <a id="d17239e2712" class="indexterm-anchor"></a>traces the TIP is to produce. Refer to <a href="troubleshooting-oracle-database-gateway-appc.html#GUID-6A2105DD-D6F0-4368-BE63-F8A85D5C959F"> Troubleshooting</a> for more information about diagnostic traces.
                           </p>
                        </li>
                     </ul>
                     <p>PGAU-generated TIPs provide four different initialization functions that client applications can call. These are overloaded functions which all have the same name, but vary in the types of parameters passed. </p>
                     <p>Three initialization parameters are passed:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The transaction instance number for RHT conversation identification. The <code class="codeph">tranuse</code> parameter is required on all TIP initializations.
                           </p>
                        </li>
                        <li>
                           <p>TIP diagnostic flags for TIP runtime diagnostic controls. The <code class="codeph">tipdiag</code> parameter is optional. Refer to <a href="troubleshooting-oracle-database-gateway-appc.html#GUID-6A2105DD-D6F0-4368-BE63-F8A85D5C959F"> Troubleshooting</a> for a discussion of TIP diagnostics.
                           </p>
                        </li>
                        <li>
                           <p>TIP default overrides for overriding OLTP and network attributes. The <code class="codeph">override</code> parameter is optional.
                           </p>
                        </li>
                     </ul>
                     <p>The following four functions are shown as they might appear in the TIP Content documentation file. Examples of client application use are provided later.</p><pre class="oac_no_warn" dir="ltr">TYPE override_Typ IS RECORD (
        tranname  VARCHAR2(255),  /* Transaction Program     */
        transync  BINARY_INTEGER, /* RESERVED                */
        trannls   VARCHAR2(50),   /* RESERVED                */
        oltpname  VARCHAR2(255),  /* Logical Unit            */
        oltpmode  VARCHAR2(255),  /* LOG Mode Entry          */
        netaddr   VARCHAR2(255),  /* Side Profile            */
        oltpuser  VARCHAR2(8),    /* userid for OLTP access  */
        oltppass  VARCHAR2(8));   /* password for OLTP access*/

FUNCTION pgadb2i_init(                /* init standard */
           tranuse IN OUT BINARY_INTEGER)
           RETURN INTEGER;

FUNCTION pgadb2i_init(                /* init override */
           tranuse IN OUT BINARY_INTEGER,
           override IN override_Typ)
           RETURN INTEGER;

FUNCTION pgadb2i_init(               /* init diagnostic */
           tranuse IN OUT BNARY_INTEGER,
           tipdiag IN CHAR)
           RETURN INTEGER;

FUNCTION pgadb2i_init(                /* init over-diag */
           tranuse IN OUT BINARY_INTEGER,
           override IN override_Typ,
           tipdiag IN CHAR)
           RETURN INTEGER;
</pre></div><a id="APPUG989"></a><div class="props_rev_3"><a id="GUID-29DC252A-A067-4092-87B8-80AB1AC6AC04" name="GUID-29DC252A-A067-4092-87B8-80AB1AC6AC04"></a><h5 id="APPUG-GUID-29DC252A-A067-4092-87B8-80AB1AC6AC04" class="sect5">Transaction Instance Parameter</h5>
                     <div>
                        <p>This transaction instance number (shown in examples as <code class="codeph">tranuse</code>) must be passed to subsequent TIP exchange and terminate functions. It identifies to the gateway on which APPC conversation--and therefore which iteration of a remote transaction program--the data is to be transmitted or communication terminated.
                        </p>
                        <p>A single client application might control multiple instances of the same remote transaction program or multiple different remote transaction programs, all concurrently. The transaction instance number is the TIP‘s mechanism for routing the client application call through the gateway to the intended remote transaction program.</p>
                        <p>It is the responsibility of the client application to save the transaction instance number of each active transaction and pass the correct one to each TIP function called for that transaction.</p>
                        <p>The client application calls the TIP initialization function as if it were any local PL/SQL function. For example:</p><pre class="oac_no_warn" dir="ltr">...
...
tranuse INTEGER := 0;/* transaction usage number*/
...
...
BEGIN
 rc := pgadb2i.pgadb2i_init(tranuse);
...
...</pre></div>
                  </div><a id="APPUG990"></a><div class="props_rev_3"><a id="GUID-125BF246-33A2-46AF-87E8-7344F3B4F573" name="GUID-125BF246-33A2-46AF-87E8-7344F3B4F573"></a><h5 id="APPUG-GUID-125BF246-33A2-46AF-87E8-7344F3B4F573" class="sect5">Overriding TIP Initializations</h5>
                     <div>
                        <p>Note that in the preceding example the client application did not specify any remote transaction program name, network connection, or security information. The TIP has such information internally coded as defaults and the client application simply calls the appropriate TIP for the chosen remote transaction program. The client application can, however, optionally override some TIP defaults and supply security information. </p>
                        <p>You do not need to change any client applications that do not require overrides.</p>
                        <p>When the remote host transaction was defined in the PG DD, the <code class="codeph">DEFINE TRANSACTION</code> statement specified certain default OLTP and network identification attributes which can be overridden:<a id="d17239e2852" class="indexterm-anchor"></a><a id="d17239e2856" class="indexterm-anchor"></a><a id="d17239e2860" class="indexterm-anchor"></a><a id="d17239e2864" class="indexterm-anchor"></a></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="italic"><code class="codeph">TPname</code></span></p>
                           </li>
                           <li>
                              <p><span class="italic"><code class="codeph">LUname</code></span></p>
                           </li>
                           <li>
                              <p><code class="codeph">LOGMODE</code></p>
                           </li>
                           <li>
                              <p><span class="italic"><code class="codeph">Side Profile</code></span></p>
                           </li>
                        </ul>
                        <p>Refer to <span class="q">"<a href="pga-utility-oracle-database-gateway-appc.html#GUID-EC8B6848-0566-45CD-BA08-78F15ED0EEB4">DEFINE TRANSACTION</a>"</span> in <a href="pga-utility-oracle-database-gateway-appc.html#GUID-F73E20E7-D94C-468F-BA65-CC34F6373F19"> Procedural Gateway Administration Utility </a> for more information about the <code class="codeph">DEFINE TRANSACTION </code>statement.
                        </p>
                        <p>These PG DD-defined transaction attributes are generated into TIPs as defaults and can be overridden at <a id="d17239e2904" class="indexterm-anchor"></a>TIP initialization time. This facilitates the use of one TIP, which can be used with a test transaction or system, and can later be used with a production transaction or system, without having to regenerate the TIP.
                        </p>
                        <p>The <code class="codeph">override_Typ</code> record datatype describes the various transaction attributes that can be overridden by the client application. The following o<a id="d17239e2914" class="indexterm-anchor"></a><a id="d17239e2916" class="indexterm-anchor"></a>verrides are currently supported:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">tranname</code> can be set to override the value that was specified by the <code class="codeph">TPNAME</code> parameter of the <code class="codeph">DEFINE TRANSACTION </code>statement
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oltpname</code> can be set to override the value that was specified by the <code class="codeph">LUNAME</code> parameter of the <code class="codeph">DEFINE TRANSACTION</code> statement
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oltpmode</code> can be set to override the value that was specified by the <code class="codeph">LOGMODE</code> parameter of the <code class="codeph">DEFINE TRANSACTION</code> statement
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">netaddr</code> can be set to override the value that was specified by the <code class="codeph">SIDEPROFILE</code> parameter of the <code class="codeph">DEFINE TRANSACTION</code> statement
                              </p>
                           </li>
                        </ul>
                        <p>In addition to the transaction attributes defined in the <a id="d17239e2968" class="indexterm-anchor"></a>PG DD, there are two security-related parameters, conversation security user&nbsp;ID and conversation security password, that can be overridden at TIP initialization time. The values for these parameters normally come from either the database link used to access the gateway or the Oracle database session. There are cases when the Oracle database user&nbsp;ID is not sufficient for accessing the OLTP system. The user&nbsp;ID and password overrides provide a way to specify those parameters to the OLTP system. 
                        </p>
                        <p>The following overrides are currently supported:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">oltpuser</code> can be set to override the user&nbsp;ID used to initialize the conversation with the OLTP
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">oltppass</code> can be set to override the password used to initialize the conversation with the OLTP
                              </p>
                           </li>
                        </ul>
                        <p>The security overrides have an effect only if <code class="codeph">PGA_SECURITY_TYPE=PROGRAM</code> is specified in the gateway initialization file, and the OLTP system is configured to accept a user&nbsp;ID and password on incoming conversation requests.
                        </p>
                        <p>The <code class="codeph">transync</code> (APPC <code class="codeph">SYNCLEVEL</code>) and <code class="codeph">trannls</code> (Globalization Support character set) are defined in the override record datatype, but are reserved for future use. The RHT <code class="codeph">SYNCLEVEL</code> and Globalization Support name cannot be overridden.
                        </p>
                        <p>The client application might override the default attributes at TIP initialization for the following reasons:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>to start a different version of the RHT (such as production instead of test)</p>
                           </li>
                           <li>
                              <p>to change the location of the OLTP containing the RHT (if the OLTP was moved due to migration or a switch to backup configuration)</p>
                           </li>
                        </ul>
                        <p>Client applications requiring overrides can use any combination of override and initialization parameters and might alter the combination at any time without regenerating the TIP or affecting applications that do not override parameters.</p>
                        <p>To override the TIP defaults, an additional client application record variable must be declared as <code class="codeph">override_Typ</code> datatype, values must be assigned to the override subfields, and the override record variable must be passed on the TIP initialization call from the client application.
                        </p>
                        <p>For example:</p><pre class="oac_no_warn" dir="ltr">   ...
   ...
   my_overrides pgadb2i.override_Typ;   -- declaration
   ...
   ...
   my_overrides.oltpname := 'CICSPROD'; -- swap to production CICS
   my_overrides.tranname := 'TNEW';     -- new transaction name

BEGIN
   rc := pgadb2i.pgadb2i_init(tranuse,my_overrides); -- init
   ...
   ...
</pre><p>Within the TIP, override attributes are checked for syntax problems and passed to the gateway server.</p>
                     </div>
                  </div><a id="APPUG991"></a><div class="props_rev_3"><a id="GUID-01314972-B6A2-403B-BFD0-81F5BA60F3E2" name="GUID-01314972-B6A2-403B-BFD0-81F5BA60F3E2"></a><h5 id="APPUG-GUID-01314972-B6A2-403B-BFD0-81F5BA60F3E2" class="sect5">Security Considerations</h5>
                     <div>
                        <p>The <a id="d17239e3061" class="indexterm-anchor"></a><a id="d17239e3065" class="indexterm-anchor"></a>security requirements of the default and overridden OLTPs must be the same because the same gateway server is used in either conversation, as dictated by the database link names in the PGA RPC calls. The gateway server startup security mode is set at gateway server initialization time and passed unchanged to the OLTP at TIP or conversation initialization time.
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="APPUG992"></a><div class="props_rev_3"><a id="GUID-62418ADB-1A9B-4DCC-A2D5-70940D7ECBFC" name="GUID-62418ADB-1A9B-4DCC-A2D5-70940D7ECBFC"></a><h3 id="APPUG-GUID-62418ADB-1A9B-4DCC-A2D5-70940D7ECBFC" class="sect3">Exchanging Data</h3>
               <div>
                  <div class="section">
                     <p>The client application should pass the transaction instance number, returned from a previous <code class="codeph">tip_init</code> call, to identify which remote transaction program is affected and to identify any client application data parameters to be exchanged with the remote transaction program.
                     </p>
                     <p>In this CICS-DB2 inquiry example, we pass an employee number and receive an employee record back:</p><pre class="oac_no_warn" dir="ltr">rc = pgadb2i.pgadb2i_main(tranuse, /* transfer data         */
                           empno,   /* employee number       */
                           DCLEMP); /* return employee record*/</pre></div>
                  <!-- class="section" -->
               </div><a id="APPUG993"></a><div class="props_rev_3"><a id="GUID-3CDB9504-3937-4909-A6FE-3B63FC25BF75" name="GUID-3CDB9504-3937-4909-A6FE-3B63FC25BF75"></a><h4 id="APPUG-GUID-3CDB9504-3937-4909-A6FE-3B63FC25BF75" class="sect4">Terminating the Conversation</h4>
                  <div>
                     <p>The client application calls the TIP termination function as if it were any local PL/SQL function. For example:</p><pre class="oac_no_warn" dir="ltr">...
...
term := 1;    /* indicate term called* */
 rc := pgadb2i.pgadb2i_term(tranuse,0); /* terminate normally  */
...
...
</pre><p>After a transaction instance number has been passed on a TIP terminate call to terminate the transaction, or after the remote transaction program has abended, that particular transaction instance number may be forgotten. </p>
                  </div>
               </div><a id="APPUG994"></a><div class="props_rev_3"><a id="GUID-4A799962-BFF3-47FD-AB6D-C99474E157D8" name="GUID-4A799962-BFF3-47FD-AB6D-C99474E157D8"></a><h4 id="APPUG-GUID-4A799962-BFF3-47FD-AB6D-C99474E157D8" class="sect4">Error Handling</h4>
                  <div>
                     <p>The client application should include an exception handler that can clean up any active APPC conversations before the client application terminates. The sample client application provided in <code class="codeph">pgadb2id.sql</code> contains an example of exception handling. 
                     </p>
                     <p>Gateway exceptions are reported in the range PGA-20900 to PGA-20999. When an exception occurs, the TIP termination function should be called for any active conversations that have been started by prior calls to the TIP initialization function. </p>
                     <p>For example:</p><pre class="oac_no_warn" dir="ltr">EXCEPTION
 WHEN OTHERS THEN
  IF term = 0 THEN         /* terminate function not called yet */
   rc := pgadb2i.pgadb2i_term(tranuse,1); /*terminate abnormally*/
  END IF;
 RAISE;
...
...
</pre><p>The remote transaction should also include provisions for error handling and debugging, such as writing debugging information to the CICS temporary storage queue area. Refer to the <a href="../lnpls/plsql-error-handling.html#LNPLS00701" target="_blank"><span class="italic">Oracle Database PL/SQL Language Reference</span></a> for a discussion of how to intercept and handle Oracle exceptions.
                     </p>
                  </div>
               </div><a id="APPUG995"></a><div class="props_rev_3"><a id="GUID-4FFF7E49-C061-4A57-A575-3EF98E2A1E50" name="GUID-4FFF7E49-C061-4A57-A575-3EF98E2A1E50"></a><h4 id="APPUG-GUID-4FFF7E49-C061-4A57-A575-3EF98E2A1E50" class="sect4">Granting Execute Authority</h4>
                  <div>
                     <div class="section">
                        <p>The TIP is a standard <a id="d17239e3264" class="indexterm-anchor"></a>PL/SQL package and execute authority must be granted to users who call the TIP from their client application. In this example, we grant execute on the <code class="codeph">PGADB2I</code> package to user <code class="codeph">SCOTT</code>:
                        </p><pre class="oac_no_warn" dir="ltr">GRANT EXECUTE ON PGADB2I TO SCOTT
</pre><p>Refer to the <a href="../admin/getting-started-with-database-administration.html#ADMIN11062" target="_blank"><span class="italic">Oracle Database Administrator's Guide</span></a> for further information.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="APPUG996"></a><div class="props_rev_3"><a id="GUID-19815A38-8520-41D5-9418-2DB46AFDB9AA" name="GUID-19815A38-8520-41D5-9418-2DB46AFDB9AA"></a><h3 id="APPUG-GUID-19815A38-8520-41D5-9418-2DB46AFDB9AA" class="sect3">Executing the Application</h3>
               <div>
                  <div class="section">
                     <p>Before executing the client application, ensure that a connection to the host is established and that the receiving partner is available. In this example we use PL/SQL driver <code class="codeph">DB2IDRIV</code> to execute the CICS-DB2 inquiry. To execute this client application, enter from SQL*Plus:
                     </p><pre class="oac_no_warn" dir="ltr">set serveroutput on
execute DB2IDRIV(<span class="italic">'nnnnnn'</span><span class="italic"><code class="codeph">)</code></span>;</pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="APPUG997"></a><div class="props_rev_3"><a id="GUID-E02BE2D4-97BA-407C-B1D6-4503D79561D7" name="GUID-E02BE2D4-97BA-407C-B1D6-4503D79561D7"></a><h3 id="APPUG-GUID-E02BE2D4-97BA-407C-B1D6-4503D79561D7" class="sect3">APPC Conversation Sharing</h3>
               <div>
                  <p>Multiple TIPs can share the same APPC conversation with one or more <a id="d17239e3375" class="indexterm-anchor"></a>Remote Host Transactions (RHTs) which are also sharing that same conversation. Two benefits derive from this feature:<a id="d17239e3380" class="indexterm-anchor"></a></p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Existing RHTs which rely upon passing control of a conversation are supported by Oracle Database Gateway for APPC.</p>
                     </li>
                     <li>
                        <p>TIPs otherwise too large for PL/SQL compilation can be separated into multiple smaller TIPs, each with fewer user-defined functions, providing the client application with the same set of function calls and data definitions without any change to the RHT. </p>
                     </li>
                  </ul>
               </div><a id="APPUG998"></a><div class="props_rev_3"><a id="GUID-7C9B4EAB-3D8C-4DF0-8E32-F45845336F1A" name="GUID-7C9B4EAB-3D8C-4DF0-8E32-F45845336F1A"></a><h4 id="APPUG-GUID-7C9B4EAB-3D8C-4DF0-8E32-F45845336F1A" class="sect4">APPC Conversation Sharing Concepts</h4>
                  <div>
                     <p>Mainframe OLTPs, such as IMS, allow transactions to share a single APPC conversation by passing it when the transaction calls another transaction. RHTs are defined to PGAU as single transactions with calls, inputs and outputs for which PGAU generates a single TIP with initialization, transfer and termination functions corresponding to that specific RHT.</p>
                     <p>Logic generated into every TIP allows that TIP either:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>to initiate a new conversation when its init function is called, or</p>
                        </li>
                        <li>
                           <p>to transfer data on an existing conversation when its user-defined functions are called, or</p>
                        </li>
                        <li>
                           <p>to terminate an existing conversation when its "term" function is called.</p>
                        </li>
                     </ul>
                     <p>An APPC conversation is treated as a resource shared and managed by multiple TIPs. There is no requirement for any TIP to be the sole user of an APPC conversation. </p>
                     <p>Any <a id="d17239e3447" class="indexterm-anchor"></a>TIP generated at 3.4.0 or later can perform any of the following combinations of service: 
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>initiate</p>
                        </li>
                        <li>
                           <p>initiate and transfer</p>
                        </li>
                        <li>
                           <p>initiate, transfer, and terminate (standard operation)</p>
                        </li>
                        <li>
                           <p>transfer</p>
                        </li>
                        <li>
                           <p>transfer and terminate</p>
                        </li>
                        <li>
                           <p>terminate</p>
                        </li>
                        <li>
                           <p>initiate and terminate (assumes other TIPs perform transfer)</p>
                        </li>
                     </ul>
                     <p>A single APPC conversation can be shared in the following ways:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>from one TIP to multiple RHTs</p>
                        </li>
                        <li>
                           <p>from multiple TIPs to one RHT</p>
                        </li>
                        <li>
                           <p>from multiple TIPs to multiple RHTs</p>
                        </li>
                     </ul>
                     <p>Without APPC conversation sharing, a single TIP must be defined which contains all functions and data for all RHTs which a client application might need to call. Creating TIPs with a superset of RHTs often causes such TIPs to be too large for PL/SQL to compile. </p>
                     <p>Conversely, with APPC conversation sharing, each RHT (or even each RHT data exchange for those RHTs which perform multiple, different data exchange operations) can be defined in a single TIP which is smaller and less likely to exceed PL/SQL compilation limits.</p>
                  </div>
               </div><a id="APPUG999"></a><div class="props_rev_3"><a id="GUID-D7BCC8CE-C9A1-479E-B53E-53EFCFEB44F8" name="GUID-D7BCC8CE-C9A1-479E-B53E-53EFCFEB44F8"></a><h4 id="APPUG-GUID-D7BCC8CE-C9A1-479E-B53E-53EFCFEB44F8" class="sect4">APPC Conversation Sharing Usage</h4>
                  <div>
                     <p>APPC conversation sharing is automatically available in every TIP generated at 3.4.0 or later. No TIPs generated before 3.4.0 can participate in APPC conversation sharing. TIPs generated before 3.4.0 must be regenerated using PGAU 3.4.0. or later to participate in APPC conversation sharing. PGAU is upward compatible and regeneration should be transparent, provided only the regenerated TIP body (<span class="italic"><code class="codeph">tipname</code></span><code class="codeph">.pkb</code>) is recompiled. If the TIP specification is also recompiled, the client application needs recompilation as well. Refer to <a href="tip-internals-oracle-database-gateway-appc.html#GUID-9F4E3177-13B0-43CE-AD0A-5BCD66B3FD17"> Tip Internals</a> for more detailed information.
                     </p>
                     <p>Definition and generation of TIPs is accomplished as previously discussed in Chapters 1, 2, and 3. No additional options or parameters need be specified. </p>
                     <p><a id="d17239e3541" class="indexterm-anchor"></a>Run-time use of APPC conversation sharing is under the control of the client application. It is accomplished simply by calling the init function of one of the TIPs that share a conversation and passing the <code class="codeph">tranuse</code> value returned to the other TIP functions as each is called in its desired order. Any TIP init function can be used, provided that all TIPs were defined with the same <code class="codeph">DEFINE TRANSACTION TPNAME</code> or <code class="codeph">SIDEPROFILE</code> value. The <code class="codeph">TPNAME</code> or <code class="codeph">SIDEPROFILE</code> value specifies which RHT to initialize. 
                     </p>
                     <p>When the init function of an APPC conversation sharing-capable TIP is called to initialize a conversation, the <code class="codeph">tranuse</code> value returned indicates conversation sharing is enabled. By passing that same <code class="codeph">tranuse</code> value when calling functions in other TIPs, those other TIPs perform their transfers on the same conversation already initialized, provided that all TIPs involved were generated at Version 3.4.0 or later. 
                     </p>
                  </div>
               </div><a id="APPUG1000"></a><div class="props_rev_3"><a id="GUID-5B01C80D-5FC0-45B8-B17B-D1BDBD882BD7" name="GUID-5B01C80D-5FC0-45B8-B17B-D1BDBD882BD7"></a><h4 id="APPUG-GUID-5B01C80D-5FC0-45B8-B17B-D1BDBD882BD7" class="sect4">APPC Conversation Sharing TIP Compatibility</h4>
                  <div>
                     <p>TIPs generated at 3.4.0 or later of the <a id="d17239e3612" class="indexterm-anchor"></a>database gateway use and expect different values for <code class="codeph">tranuse</code> than do pre-3.4.0 TIPs. If a pre-3.4.0 TIP is used to initialize a conversation and its <code class="codeph">tranuse</code> value is passed to a 3.4.0 or later generated TIP, the following exception is raised: 
                     </p><pre class="oac_no_warn" dir="ltr">ORA-20704 PGA_TIP: tranuse value cannot be shared
</pre><p>Pre-3.4.0 generated TIPs do not detect the different <code class="codeph">tranuse</code> value for shared conversations, however, and this can result in unpredictable errors.
                     </p>
                     <div class="infoboxnote" id="GUID-5B01C80D-5FC0-45B8-B17B-D1BDBD882BD7__GUID-83D84FD1-D319-4532-A54A-E4A07FD62E59">
                        <p class="notep1">Note:</p>
                        <p>All TIPs called in a shared conversation must have been generated at 3.4.0 or later.</p>
                        <p>No TIPs generated before 3.4.0 can participate in APPC conversation sharing.</p>
                     </div>
                     <p>The <code class="codeph">tranuse</code> values are incompatible between pre-3.4.0 and 3.4.0 or later releases. This should not pose a problem for you for the following reason: before 3.4.0, all RHT functions defined in a TIP had to be called through that TIPs functions, and the init function of that same TIP had to be called first to initialize the conversation. The <code class="codeph">tranuse</code> value was only valid for the TIP which initialized it. Thus, unless you make programming changes, it is not possible for an existing application to accidentally mix <code class="codeph">tranuse</code> values.
                     </p>
                     <p>Pre-3.4.0 TIPs and client applications can continue to be used without change and old client applications can call new 3.4.0 or later TIPs without change. This is made possible when an old TIP body is regenerated and compiled; the TIP now becomes capable of APPC conversation sharing, even though the old client application has not changed.</p>
                     <p>None of the functions of a pre-3.4.0 TIP can share an APPC conversation. However, once a TIP is regenerated at 3.4.0 or later, any of its functions can share APPC conversations.</p>
                  </div>
               </div><a id="APPUG1306"></a><a id="APPUG1001"></a><div class="props_rev_3"><a id="GUID-CA0E1792-1F88-4DA0-BFCC-D4F40F7B5673" name="GUID-CA0E1792-1F88-4DA0-BFCC-D4F40F7B5673"></a><h4 id="APPUG-GUID-CA0E1792-1F88-4DA0-BFCC-D4F40F7B5673" class="sect4">APPC Conversation Sharing for TIPs That Are Too Large </h4>
                  <div>
                     <p><a id="d17239e3692" class="indexterm-anchor"></a>You can use conversation sharing to circumvent a TIP that is too large to compile. This is identified by '<code class="codeph">PLS-00123 - package too large to compile</code>', or some other problem symptom such as PL/SQL compilation hanging. In this case you must choose which function calls to remove from the former TIP and define into new TIPs.
                     </p>
                     <p>Specifically, you must decide which <a id="d17239e3704" class="indexterm-anchor"></a><a id="d17239e3708" class="indexterm-anchor"></a>PGAU<code class="codeph"> DEFINE CALL</code> statements and their related <a id="d17239e3714" class="indexterm-anchor"></a><a id="d17239e3716" class="indexterm-anchor"></a><code class="codeph">DEFINE DATA</code> statements should be moved from the old PGAU control file (<code class="codeph">.ctl</code>) into one or more new PGAU control files. In addition, you must decide which P<a id="d17239e3727" class="indexterm-anchor"></a><a id="d17239e3731" class="indexterm-anchor"></a>GAU <code class="codeph">DEFINE TRANSACTION</code> statements should be included in each new PGAU control file defining each new TIP.
                     </p>
                     <p>You must consider several PGAU statements; refer to <a href="developing-appc-client-app-sna-only.html#GUID-CA0E1792-1F88-4DA0-BFCC-D4F40F7B5673__G1013981" title="This 2 column table lists the PGAU statements and their descriptions">Table 4-4</a> for a list of the PGAU statements and their descriptions:
                     </p>
                     <div class="tblformal" id="GUID-CA0E1792-1F88-4DA0-BFCC-D4F40F7B5673__G1013981">
                        <p class="titleintable">Table 4-4 PGAU Statements</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="PGAU Statements" summary="This 2 column table lists the PGAU statements and their descriptions" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d17239e3754">Statement</th>
                                 <th align="left" valign="bottom" width="69%" id="d17239e3757">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e3762" headers="d17239e3754 ">
                                    <p><code class="codeph">DEFINE DATA</code> statements
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e3762 d17239e3757 ">
                                    <p>Must be unique. They can be shared by all affected PGAU control files, provided they are defined to the Procedural Gateway Data Dictionary (PG DD) before being referenced by <code class="codeph">DEFINE CALL</code> statements. No changes are needed to these statements.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e3774" headers="d17239e3754 ">
                                    <p><code class="codeph">DEFINE CALL</code> statements
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e3774 d17239e3757 ">
                                    <p>Must be unique. They need only be referenced by the new <code class="codeph">DEFINE TRANSACTION</code> statement of the TIP in which they are included, provided they are defined to the PG DD before being referenced by a <code class="codeph">DEFINE TRANSACTION</code> statement. The <code class="codeph">DEFINE CALL</code> statements can optionally be moved to the new PGAU control file of the TIP in which they are included.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d17239e3792" headers="d17239e3754 ">
                                    <p><code class="codeph">DEFINE TRANSACTION</code> statements
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d17239e3792 d17239e3757 ">
                                    <p>Specified for each new TIP desired and will reference those call definitions moved from the former large TIP to the new small TIPs. No transaction attributes will change. This allows any new TIP to perform the same initialization or termination with the same RHT as the former large TIP. The old <code class="codeph">DEFINE TRANSACTION</code> statement (of the former large TIP) should now exclude any call definitions which are being moved to new small TIPs. 
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
               </div><a id="APPUG1307"></a><a id="APPUG1308"></a><a id="APPUG1309"></a><a id="APPUG1002"></a><div class="props_rev_3"><a id="GUID-7194BAD8-2440-48AE-BF6C-3A9BEB8CCF8F" name="GUID-7194BAD8-2440-48AE-BF6C-3A9BEB8CCF8F"></a><h4 id="APPUG-GUID-7194BAD8-2440-48AE-BF6C-3A9BEB8CCF8F" class="sect4">APPC Conversation Sharing Example</h4>
                  <div>
                     <p>Assume the existence of RHTs <code class="codeph">A</code>, <code class="codeph">B</code> and <code class="codeph">C</code>, and that RHT <code class="codeph">A</code> performs a menu selection and calls RHT <code class="codeph">B</code> for a query function or RHT <code class="codeph">C</code> for an update followed by a select function.
                     </p>
                     <p>You could define the following <code class="codeph">DATA</code> and <code class="codeph">CALL</code>s:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">DEFINE DATA</code> <span class="italic"><code class="codeph">choice ...</code></span> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DEFINE DATA</code> <span class="italic"><code class="codeph">input  ...</code></span> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DEFINE DATA</code> <span class="italic"><code class="codeph">answer ...</code></span></p>
                        </li>
                        <li>
                           <p><code class="codeph">DEFINE DATA</code> <span class="italic"><code class="codeph">record ... </code></span></p>
                        </li>
                        <li>
                           <p><code class="codeph">DEFINE CALL menu_A callname(pick)  parms(choice in);</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DEFINE CALL query_B callname(query) parms((input in), (answer out));</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DEFINE CALL update_C callname(update) parms(record in);</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DEFINE CALL select_C callname(select) parms(record out);</code></p>
                        </li>
                     </ul>
                     <p>The following example TIPs could be defined:</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-7194BAD8-2440-48AE-BF6C-3A9BEB8CCF8F__GUID-5B4B8ECC-AC78-4EF8-BABB-EF572686AACE">Example 1</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>This example does not use APPC conversation sharing, but is a valid TIP definition created before release 3.4.0, combining the functions of RHTs <code class="codeph">A</code>, <code class="codeph">B</code> and <code class="codeph">C</code>.
                        </p><pre class="oac_no_warn" dir="ltr">DEFINE TRANSACTION rhtABC calls(menu_A, 
                                query_B, 
                                update_C, 
                                select_C) 
                          tpname(RHTA);   </pre><p>This TIP includes all data definitions and calls, and might be too large to compile. This TIP does not use APPC conversation sharing as there is only the one TIP, <code class="codeph">rhtABC</code>. The RHTs do, however, perform their normal sharing of the conversation at the remote host. If the TIP was small enough to compile, the client application calls TIP functions as follows: 
                        </p><pre class="oac_no_warn" dir="ltr">rc := rhtABC.rhtABC_init(tranuse); 
rc := rhtABC.pick(tranuse, choice); 
rc := rhtABC.query(tranuse, input, answer); 
rc := rhtABC.update(tranuse, record); 
rc := rhtABC.select(tranuse, record); 
rc := rhtABC.rhtABC_term(tranuse); </pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7194BAD8-2440-48AE-BF6C-3A9BEB8CCF8F__GUID-DD54E1E7-B689-4945-8135-44BB7EBEDE53">Example 2</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>This example demonstrates defining a set of TIPs with APPC conversation sharing, separating the functions of RHTs <code class="codeph">A</code>, <code class="codeph">B</code> and <code class="codeph">C</code> into three TIPs: 
                        </p><pre class="oac_no_warn" dir="ltr">DEFINE TRANSACTION rhtA calls(menu_A)   tpname(RHTA); 
DEFINE TRANSACTION rhtB calls(query_B)  tpname(RHTA); 
DEFINE TRANSACTION rhtC calls(update_C, 
                              select_C) tpname(RHTA); 
</pre><p>Each TIP includes only the call and data it requires, and each TIP automatically performs APPC conversation sharing. The client application calls these functions as follows:</p><pre class="oac_no_warn" dir="ltr">rc := rhtA.rhtA_init(tranuse); 
rc := rhtA.pick(tranuse, choice); 
rc := rhtB.query(tranuse, input, answer); 
rc := rhtC.update(tranuse, record); 
rc := rhtC.select(tranuse, record); 
rc := rhtB.rhtB_term(tranuse); 
</pre><p>The only client application difference between the two examples is in the schema qualifier on each of the TIP calls. This is because the function being called is in a different TIP which has a different package name in the database.</p>
                        <p>Only new <code class="codeph">DEFINE TRANSACTION</code> statements were needed to make use of APPC conversation sharing. The <code class="codeph">CALL</code> and <code class="codeph">DATA</code> definitions were used as-is. This means the old TIP <code class="codeph">rhtABC</code> is still defined as it was and might still be too large to compile.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7194BAD8-2440-48AE-BF6C-3A9BEB8CCF8F__GUID-ED341DA9-8EA1-466F-822A-7D99BC723ABC">Example 3</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>If you performed Sample 2 but you still believe that the TIP may be too large to compile, try this:</p><pre class="oac_no_warn" dir="ltr">DEFINE TRANSACTION rhtABC calls(menu_A)   tpname(RHTA); 
DEFINE TRANSACTION rhtB   calls(query_B)  tpname(RHTA); 
DEFINE TRANSACTION rhtCU  calls(update_C) tpname(RHTA); 
DEFINE TRANSACTION rhtCS  calls(select_C) tpname(RHTA); 
</pre><p>TIP <code class="codeph">rhtABC</code> has had three functions removed so it is now smaller and more likely to compile. TIP <code class="codeph">rhtB</code> has one function and TIP <code class="codeph">rhtC</code> has been separated into two TIPs even though the corresponding host functions remain in a single RHT. 
                        </p>
                        <p>The client application calls these functions as follows: </p><pre class="oac_no_warn" dir="ltr">rc := rhtB.rhtB_init(tranuse); 
rc := rhtABC.pick(tranuse, choice); 
rc := rhtB.query(tranuse, input); 
rc := rhtCU.update(tranuse, record); 
rc := rhtCS.select(tranuse, record); 
rc := rhtABC.rhtABC_term(tranuse); 
</pre><p>A different TIP is used for initialization, illustrating that all TIPs contain the init and term functions, and because the <code class="codeph">DEFINE TRANSACTION </code>statements all specified the same <code class="codeph">tpname(RHTA)</code>, the same remote host transaction is always called for initialization.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="APPUG1003"></a><div class="props_rev_3"><a id="GUID-B04E6B1E-4AA9-4CD2-8976-A19B782D99C1" name="GUID-B04E6B1E-4AA9-4CD2-8976-A19B782D99C1"></a><h4 id="APPUG-GUID-B04E6B1E-4AA9-4CD2-8976-A19B782D99C1" class="sect4">APPC Conversation Sharing Overrides and Diagnostics</h4>
                  <div>
                     <p><a id="d17239e4060" class="indexterm-anchor"></a>TIP default override parameters are processed in the TIP init function which was called to perform initialization. Once the APPC conversation is established, no further sharing of overriding parameters is necessary. You need do nothing more than pass the overrides to the TIP init function.
                     </p>
                     <p><a id="d17239e4066" class="indexterm-anchor"></a>TIP diagnostic parameters are shared among all TIPs sharing a given conversation. In effect, requesting diagnostics of the TIP performing initialization causes the same diagnostics to be requested of all TIPs sharing the conversation. Requesting diagnostics from only one TIP of several sharing a conversation is not possible. The application designer or user need only pass the TIP runtime trace controls to the TIP init function. 
                     </p>
                  </div>
               </div>
            </div><a id="APPUG1004"></a><div class="props_rev_3"><a id="GUID-2F5FD89A-06E6-47DF-84CD-525B6515B25F" name="GUID-2F5FD89A-06E6-47DF-84CD-525B6515B25F"></a><h3 id="APPUG-GUID-2F5FD89A-06E6-47DF-84CD-525B6515B25F" class="sect3">Application Development with Multi-Byte Character Set Support</h3>
               <div>
                  <p><a id="d17239e4114" class="indexterm-anchor"></a>COBOL presently only supports <a id="d17239e4119" class="indexterm-anchor"></a>double byte character sets (<a id="d17239e4124" class="indexterm-anchor"></a>DBCS) for <a id="d17239e4129" class="indexterm-anchor"></a><code class="codeph">PIC G</code> datatypes. 
                  </p>
                  <p>PGAU processes COBOLII <code class="codeph">PIC G</code> datatypes as PL/SQL <code class="codeph">VARCHAR2</code> variables and generates TIPs which automatically convert the data according to the                       Oracle <code class="codeph">NLS_LANGUAGE</code>s specified for the remote host data and the local Oracle data.
                  </p>
                  <p>These Oracle <code class="codeph">NLS_LANGUAGE</code>s can be specified as defaults for all <code class="codeph">PIC G </code>data exchanged by the TIP with the remote transaction (see <code class="codeph">DEFINE TRANSACTION</code> <code class="codeph">... </code><code class="codeph">REMOTE_MBCS</code> or <code class="codeph">LOCAL_MBCS</code>). The Oracle <code class="codeph">NLS_LANGUAGE</code>s for any individual <code class="codeph">PIC G</code> data item can be further overridden (see <code class="codeph">REDEFINE DATA</code> <code class="codeph">... </code><code class="codeph">REMOTE</code> or <code class="codeph">LOCAL_LANGUAGE</code>). 
                  </p>
                  <p>DBCS data can be encoded in any combination of supported DBCS character sets. For example, a remote host application which allows different codepages for each field of data in a record is supported by the Oracle Database Gateway <a id="d17239e4186" class="indexterm-anchor"></a>MBCS<a id="d17239e4189" class="indexterm-anchor"></a> support. 
                  </p>
                  <p>Use of <code class="codeph">REDEFINE DATA ... REMOTE_LANGUAGE</code> or <code class="codeph">LOCAL_LANGUAGE</code> on <code class="codeph">PIC X</code> items is also supported. Thus a TIP can perform DBCS or MBCS conversions for specified <code class="codeph">PIC X</code> data fields, in addition to SBCS conversions by default for the remaining <code class="codeph">PIC X</code> data fields. Default SBCS conversion is according to the <code class="codeph">DEFINE TRANSACTION...  NLS_LANGUAGE</code> and local Oracle default <code class="codeph">LANGUAGE</code> environment values. 
                  </p>
                  <p>When PGAU is generating a TIP, the <code class="codeph">PIC G</code> datatypes are converted to PL/SQL <code class="codeph">VARCHAR2</code> datatypes. After conversion by the TIP, received <code class="codeph">'PIC G' VARCHAR2</code> datatypes can have a length less then the maximum due to deletion of shift-out and shift-in meta characters, and sent <code class="codeph">'PIC G' </code>RAWs will have the shift-out and shift-in characters inserted as required by the remote host character set specified. 
                  </p>
                  <p>This is different from the conversions performed for <code class="codeph">PIC X</code> data which is always a known fixed-length and hence <code class="codeph">CHAR</code> datatypes are used in TIPs for <code class="codeph">PIC X</code> data fields. However, even when the <code class="codeph">PIC X</code> field contains DBCS or MBCS data, a <code class="codeph">CHAR</code> variable is still used and padded with blanks if needed.
                  </p>
                  <p>Some remote host applications bracket a<code class="codeph"> PIC G</code> field with <code class="codeph">PIC X</code> bytes used for shift-out, shift-in meta-character insertion. Such a COBOL definition might look like:   
                  </p><pre class="oac_no_warn" dir="ltr">01 MY_RECORD. 
   05 SO PIC X. 
   05 MY_SBCS_DATA PIC G(52). 
   05 SI PIC X. 
</pre><p>This is not processed correctly by PGAU, because all three fields are defined, and consequently treated, as separate data items when conversion is performed.</p>
                  <p>To be properly processed, the definition input to PGAU should be: </p><pre class="oac_no_warn" dir="ltr">01 MY_RECORD. 
   05 MY_MBCS_DATA PIC G(51).
</pre><p>The PGAU <code class="codeph">REDEFINE DATA</code> statement can redefine the 3-field definition to the 1-field definition by specifying <code class="codeph">USAGE(SKIP)</code> on fields <code class="codeph">SO</code> and <code class="codeph">SI</code>, and <code class="codeph">'05 MY_MBCS_DATA PIC G(51).'</code> to redefine <code class="codeph">MY_MBCS_DATA</code>. The three <code class="codeph">REDEFINE</code> statements can be placed in the PGAU input control file, and thus the remote host definition need not be altered. 
                  </p>
               </div>
            </div><a id="APPUG1005"></a><div class="props_rev_3"><a id="GUID-B118F27C-0B26-4429-8B70-3CC5B01C6A93" name="GUID-B118F27C-0B26-4429-8B70-3CC5B01C6A93"></a><h3 id="APPUG-GUID-B118F27C-0B26-4429-8B70-3CC5B01C6A93" class="sect3">Modifying a Terminal-Oriented Transaction to Use APPC</h3>
               <div>
                  <p><a id="d17239e4322" class="indexterm-anchor"></a><a id="d17239e4326" class="indexterm-anchor"></a>The remote transaction program must include mapped APPC verbs to initiate, communicate, and terminate the APPC conversation. However, when the remote transaction program is terminal-oriented, the following options are available:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>You can separate the terminal logic from the application and I/O logic. Once this separation is achieved, a small front end remote transaction program can be written to interface between the gateway calls and the transaction application logic. For example, in CICS the CICS <code class="codeph">LINK</code> is used to implement this technique.
                        </p>
                     </li>
                     <li>
                        <p>You can modify your existing program so that APPC calls are embedded. In the example, <code class="codeph">PGADB2I</code>, we use CICS and its associated mapped APPC verbs as follows: 
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>EXEC CICS <code class="codeph">ASSIGN</code> accepts the conversation initiated by the gateway.
                              </p>
                           </li>
                           <li>
                              <p>EXEC CICS <code class="codeph">RECEIVE</code> receives the arguments.
                              </p>
                           </li>
                           <li>
                              <p>EXEC CICS <code class="codeph">SEND</code> ends the results.
                              </p>
                           </li>
                           <li>
                              <p>EXEC CICS <code class="codeph">RETURN</code> terminates the conversation.
                              </p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>If you do not want to modify your terminal-oriented transaction, you can insert an APPC-capable interface, such as IBM Corporation's FEPI for CICS Transaction Server for z/OS, between the terminal-oriented program and the gateway.</p>
                     </li>
                     <li>
                        <p>With IMS/TM, existing unmodified IMS transactions can be accessed with the gateway using the implicit APPC facility. With implicit APPC, the standard DLI GU, GN, and ISRT calls using the I/O PCB are automatically converted to appropriate APPC send or receive calls when the IMS transaction is invoked through APPC.<a id="d17239e4375" class="indexterm-anchor"></a></p>
                     </li>
                  </ul>
               </div>
            </div><a id="APPUG1006"></a><div class="props_rev_3"><a id="GUID-8E530425-F978-4095-8A39-B8FD8BE2A47A" name="GUID-8E530425-F978-4095-8A39-B8FD8BE2A47A"></a><h3 id="APPUG-GUID-8E530425-F978-4095-8A39-B8FD8BE2A47A" class="sect3">Privileges Needed to Use TIPs</h3>
               <div>
                  <p>Execute privileges must be explicitly granted to callers of TIPs or procedures. This privilege cannot be granted through a role.</p>
                  <p>Any TIP user wanting to trace a TIP must be granted execute privileges on the rtrace and ptrace procedures. Refer to the "Configuring PGAU" section in the chapter appropriate for your communications protocol in the installation guides for more information. </p>
                  <p>For example, on Microsoft Windows:</p><pre class="oac_no_warn" dir="ltr">C:\&gt; sqlplus pgaadmin\<span class="italic">pw@database_specification_string</span> 
SQL&gt; grant execute on pgaadmin.purge_trace to <span class="italic">tip_user_userid</span>;
SQL&gt; grant execute on pgaadmin.read_trace to <span class="italic">tip_user_userid;</span> 
</pre><p>On UNIX based systems:</p><pre class="oac_no_warn" dir="ltr">$ sqlplus pgaadmin/<span class="italic">pw@database_specification_string</span> 
SQL&gt; grant execute on pgaadmin.purge_trace to <span class="italic">tip_user_userid</span>;
SQL&gt; grant execute on pgaadmin.read_trace to <span class="italic">tip_user_userid;</span> 
</pre><p>After a TIP has been developed, the TIP user must be granted execute privileges on the TIP by the TIP owner. The TIP owner is usually <code class="codeph">PGAADMIN</code>, but can be another user who has been granted either the <code class="codeph">PGDDDEF</code> or <code class="codeph">PGDDGEN</code> roles. 
                  </p>
                  <p>For example, on Microsoft Windows:</p><pre class="oac_no_warn" dir="ltr">C:\&gt; sqlplus tip_owner\<span class="italic">pw@database_specification_string</span> 
SQL&gt; grant execute on tipname to <span class="italic">tip_user_userid</span>;
</pre><p>On UNIX based systems:</p><pre class="oac_no_warn" dir="ltr">$ sqlplus tip_owner/<span class="italic">pw@database_specification_string</span> 
SQL&gt; grant execute on tipname to <span class="italic">tip_user_userid</span>;
</pre><p>where<span class="italic"><code class="codeph"> database_specification_string</code></span>  is the <a id="d17239e4493" class="indexterm-anchor"></a>Oracle Net identifier for the Oracle database where the gateway <code class="codeph">UTL_RAW</code> and <code class="codeph">UTL_PG</code> components were installed. This is the same Oracle database where the TIPs are executed and where grants on the TIPs are performed from the TIP owner user&nbsp;ID.
                  </p>
                  <p>A SQL script for performing these grants is provided in the                                        <code class="codeph">%ORACLE_HOME%\dg4appc\admin</code> directory on Microsoft Windows and in the <code class="codeph">$ORACLE_HOME/dg4appc/admin</code> directory on UNIX based system. The<a id="d17239e4510" class="indexterm-anchor"></a><a id="d17239e4512" class="indexterm-anchor"></a> <code class="codeph">pgddausr.sql</code> script performs the grants for private access to the packages by a single TIP user. If private grants are to be used, the <code class="codeph">pgddausr.sql</code> script must be run once for each TIP user's user&nbsp;ID. 
                  </p>
                  <p>To run these scripts, use SQL*Plus to connect to the Oracle database as user <code class="codeph">PGAADMIN</code>. From SQL*Plus, run the <code class="codeph">pgddausr.sql</code> script from the                                    <code class="codeph">%ORACLE_HOME%\dg4appc\admin</code> directory on Microsoft Windows or       <code class="codeph">$ORACLE_HOME/dg4appc/admin</code> directory on UNIX based system. The script performs the necessary grants as previously described. You are prompted for the required user&nbsp;IDs, passwords, and database specification strings. If you are using private grants, repeat this step for each user&nbsp;ID requiring access to the packages.
                  </p>
                  <p>No script has been provided to perform public grants. To do this, issue the following commands:</p>
                  <p>For Microsoft Windows:</p><pre class="oac_no_warn" dir="ltr">C:\&gt; sqlplus tip_owner\<span class="italic">pw@database_specification_string</span> 
SQL&gt; grant execute on tipname to PUBLIC;  
</pre><p>For UNIX based systems:</p><pre class="oac_no_warn" dir="ltr">$ sqlplus tip_owner/<span class="italic">pw@database_specification_string</span> 
SQL&gt; grant execute on tipname to PUBLIC;  
</pre></div>
            </div>
         </div>
      </article>
   </body>
</html>