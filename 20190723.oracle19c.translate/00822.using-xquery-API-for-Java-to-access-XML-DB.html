<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="An explanation is given of how to use the XQuery API for Java (XQJ) to access Oracle XML DB."></meta>
      <meta name="description" content="An explanation is given of how to use the XQuery API for Java (XQJ) to access Oracle XML DB."></meta>
      <title>使用XQuery API for Java访问Oracle XML DB</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Programmer&#39;s Guide"></meta>
      <meta property="og:description" content="An explanation is given of how to use the XQuery API for Java (XQJ) to access Oracle XML DB."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Programmer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="xml-developers-kit-programmers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-11T05:58:48-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96292-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="using-xquery-processor-for-Java.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-XML-schema-processor-for-Java.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML Developers Kit Programmers Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADXDK"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-xquery-processor-for-Java.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-XML-schema-processor-for-Java.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">程序员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="XDK-for-Java.html" property="item" typeof="WebPage"><span property="name">Oracle XML Developer's Kit for Java</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用XQuery API for Java访问Oracle XML DB</li>
            </ol>
            <a id="GUID-DDFFD115-A115-4B6C-805C-350AF78281EB" name="GUID-DDFFD115-A115-4B6C-805C-350AF78281EB"></a><a id="ADXDK992"></a><a id="ADXDK136"></a>
            
            <h2 id="ADXDK-GUID-DDFFD115-A115-4B6C-805C-350AF78281EB" class="sect2"><span class="enumeration_chapter">16</span>使用XQuery API for Java访问Oracle XML DB</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='using-xquery-API-for-Java-to-access-XML-DB'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>解释了如何使用XQuery API for Java（XQJ）来访问Oracle XML DB。</p>
               <div class="section"> </div>
               <!-- class="section" -->
            </div><a id="ADXDK963"></a><div class="props_rev_3"><a id="GUID-4CCB8866-D4A3-4CB7-B08B-00C227CE6F0B" name="GUID-4CCB8866-D4A3-4CB7-B08B-00C227CE6F0B"></a><h3 id="ADXDK-GUID-4CCB8866-D4A3-4CB7-B08B-00C227CE6F0B" class="sect3">XQJ的Oracle XML DB支持简介</h3>
               <div>
                  <p>XQuery API for Java（XQJ），也称为JSR-225，为Java程序使用XQuery访问可扩展标记语言（XML）数据提供了行业标准方法。它允许您根据XML数据源评估XQuery表达式，并将结果作为XML数据处理。</p>
                  <p>Oracle提供了两个用于评估XQuery表达式的XQuery引擎：一个用于Oracle XML DB，用于数据库中的XML数据，另一个用于Oracle XML Developer's Kit（XDK），用于数据库外部的XML数据。（有关XDK的XQuery引擎的信息，请参阅<a href="using-xquery-processor-for-Java.html#GUID-9E6570F0-37BB-4690-BFF6-A2052B5B57E8" title="解释了如何使用Oracle XML Developer Kit（XDK）XQuery处理器来实现Java。">使用XQuery Processor for Java</a> ）。
                  </p>
                  <p>Oracle提供了两种不同的XQJ实现来访问这两个XQuery引擎。这两个实现都是XDK的一部分，使您可以使用XDK使用标准XQJ API访问XML数据，无论该数据是驻留在数据库中还是其他位置。</p>
                  <p>XQJ执行的查询是使用Oracle XML DB支持的标准万维网联合会（W3C）XQuery 1.0语言编写的。此功能的典型用例是从本地Java程序访问存储在远程数据库（在Oracle XML DB中）中的XML数据。</p>
                  <p>有关XQuery和XQJ的一般信息记录在本文档之外。</p>
                  <div class="infoboxnotealso" id="GUID-4CCB8866-D4A3-4CB7-B08B-00C227CE6F0B__GUID-51568F89-4794-4BBA-B230-972A576E57D5">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../adxdb/intro-to-XML-DB.html#ADXDB0100" target="_blank"><span><cite>Oracle XML DB开发人员指南</cite></span></a> ，了解有关Oracle XML DB的更多信息，包括有关XQuery功能和Oracle XML DB支持的详细信息</p>
                        </li>
                        <li>
                           <p><a href="../jaxml/index.html" target="_blank"><span><cite>Oracle Database XML Java API中的</cite></span></a> <code class="codeph">XQuery Packages</code>用于相关的API文档</p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdk&amp;id=jcp_org_jsr225" target="_blank"><span class="italic">JSR-000225用于Java的XQuery API</span></a> ，它非常具体且具有可理解的示例</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADXDK962"></a><div class="props_rev_3"><a id="GUID-D3053B76-1E68-4EAB-A47D-38D602772647" name="GUID-D3053B76-1E68-4EAB-A47D-38D602772647"></a><h4 id="ADXDK-GUID-D3053B76-1E68-4EAB-A47D-38D602772647" class="sect4">使用XQJ访问Oracle XML DB的先决条件</h4>
                  <div>
                     <p>您需要Java Runtime Environment 1.6才能将XQJ与Oracle XML DB一起使用。您还需要某些Java Archive（JAR）文件位于<code class="codeph">CLASSPATH</code>环境变量中或使用命令行选项<code class="codeph">classpath</code>传递。
                     </p>
                     <p>JAR文件如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="using-xquery-processor-for-Java.html#GUID-42469EA3-F7DC-41AF-A58B-795ED2BDC7AA" title="XDK提供独立的XQuery处理器供Java应用程序使用。XQuery是可扩展标记语言（XML）的万维网联盟（W3C）标准查询语言。使用XQuery在Java应用程序中处理XML可以提高开发人员的工作效率和应用程序性能。">XQuery Processor for Java简介中</a>列出了所需的JAR文件</p>
                        </li>
                        <li>
                           <p><code class="codeph">JDBC / LIB / ojdbc6.jar</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">RDBMS / jlib / xdb6.jar</code></p>
                        </li>
                     </ul>
                     <p>这些JAR文件的目录路径相对于数据库安装的<code class="codeph">ORACLE_HOME</code>目录。
                     </p>
                  </div>
               </div>
            </div><a id="ADXDK210"></a><a id="ADXDK964"></a><a id="ADXDK209"></a><div class="props_rev_3"><a id="GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E" name="GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E"></a><h3 id="ADXDK-GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E" class="sect3">示例：使用XQJ查询Oracle XML DB</h3>
               <div>
                  <p>此处的示例显示了如何使用XQJ在Oracle XML DB中查询和检索数据。</p>
                  <div class="section">
                     <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">例16-1</a>显示了如何使用XQJ从Oracle XML DB中的表中查询数据。它使用Order Entry（OE）数据库示例模式中的<code class="codeph">WAREHOUSES</code>表。OE示例模式包含<code class="codeph">WAREHOUSES</code>表中包含仓库信息的XML文档。<code class="codeph">WAREHOUSES</code>表包含XMLType列<code class="codeph">warehouse_spec</code>和其他列。（有关此示例中使用的数据的详细信息，请参阅<a href="../adxdb/preface.html#ADXDB3910" target="_blank"><span><cite>Oracle XML DB Developer's Guide中</cite></span></a>有关标准数据库模式的讨论。）
                     </p>
                     <p>具体来说， <a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">例16-1</a>显示了如何执行这些步骤：</p>
                     <ol>
                        <li>
                           <p>获取与Oracle XML DB的XQJ连接。</p>
                           <p>使用XQJ连接到Oracle XML DB的每个程序都必须首先创建一个<code class="codeph">OXQDDataSource</code>对象。然后，在获得与Oracle XML数据库实例的XQJ连接之前，必须使用必需的属性值初始化<code class="codeph">OXQDDataSource</code> 。
                           </p>
                        </li>
                        <li>
                           <p>准备一个XQuery表达式。</p>
                        </li>
                        <li>
                           <p>提交XQuery表达式以进行评估。</p>
                        </li>
                        <li>
                           <p>在生成的XQuery序列中打印每个项目。</p>
                        </li>
                     </ol>
                     <p>在<a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">例16-1中</a> ，XQuery表达式通过使用<code class="codeph">oradb</code>资源标识符（URI）方案<code class="codeph">oradb</code>访问<code class="codeph">WAREHOUSES</code>表。（有关使用XQuery和XML DB查询表或查看数据的更多信息，请参阅<a href="../adxdb/xquery-and-XML-DB.html#ADXDB5994" target="_blank"><span><cite>Oracle XML DB Developer's Guide中</cite></span></a>有关URI方案<code class="codeph">oradb</code>的讨论。）
                     </p>
                     <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">例16-1</a>还显示了如何在XQJ中绑定外部变量值。该查询有一个外部变量<code class="codeph">$x</code> ，用于通过<code class="codeph">WAREHOUSE_ID</code>过滤<code class="codeph">WAREHOUSES</code>表中返回的行。</p>
                     <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">例16-1</a>生成此输出（重新格式化以获得更好的可读性）：</p><pre class="oac_no_warn" dir="ltr">&lt;仓库&gt; &lt;建筑物&gt;拥有&lt;/ Building&gt; &lt;Area&gt; 25000 &lt;/ Area&gt; &lt;Docks&gt; 2 &lt;/ Docks&gt; &lt;DockType&gt; Rearload &lt;/ DockType&gt; &lt;WaterAccess&gt; Y &lt;/ WaterAccess&gt; &lt;RailAccess&gt; N &lt;/ RailAccess &gt; &lt;停车&gt;街道&lt;/停车&gt; &lt;VClearance&gt; 10英尺&lt;/ VClearance&gt; &lt;/仓库&gt; &lt;仓库&gt; &lt;建筑物&gt;租用&lt;/ Building&gt; &lt;Area&gt; 50000 &lt;/ Area&gt; &lt;Docks&gt; 1 &lt;/ Docks&gt; &lt; DockType&gt; Sideload &lt;/ DockType&gt; &lt;WaterAccess&gt; Y &lt;/ WaterAccess&gt; &lt;RailAccess&gt; N &lt;/ RailAccess&gt; &lt;停车&gt;批次&lt;/停车&gt; &lt;VClearance&gt; 12英尺&lt;/ VClearance&gt; &lt;/ Warehouse&gt;</pre><p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBBGDEJ">例16-2</a>显示了如何使用XQJ从Oracle XML DB存储库中检索数据。此示例假定已将两个文件<code class="codeph">depts.xml</code>和<code class="codeph">emps.xml</code>上载到文件夹<code class="codeph">/public</code>下的XML DB存储库中。例如，您可以使用FTP将这两个文件上载到Oracle XML DB存储库中。（有关在Oracle XML DB存储库中存储数据和使用Oracle XML DB存储库的更多信息，请参阅<a href="../adxdb/index.html" target="_blank"><span><cite>Oracle XML DB Developer's Guide</cite></span></a>中有关使用Oracle XML DB存储库的讨论。）
                     </p>
                     <p><code class="codeph">depts.xml</code>的内容是：</p><pre class="oac_no_warn" dir="ltr">depts.xml：&lt;？xml版本=“1.0”？&gt; &lt;depts&gt; &lt;dept deptno =“10”dname =“Administration”/&gt; &lt;dept deptno =“20”dname =“Marketing”/&gt; &lt;dept deptno =“30”dname =“Purchasing”/&gt; &lt;/ depts&gt;</pre><p><code class="codeph">emps.xml</code>的内容是：</p><pre class="oac_no_warn" dir="ltr">emps.xml：&lt;？xml版本=“1.0”？&gt; &lt;emps&gt; &lt;emp empno =“1”deptno =“10”ename =“John”salary =“21000”/&gt; &lt;emp empno =“2”deptno =“10”ename =“Jack”salary =“310000” /&gt; &lt;emp empno =“3”deptno =“20”ename =“Jill”salary =“100001”/&gt; &lt;/ emps&gt;</pre><p>您可以使用<code class="codeph">fn:doc</code>和<code class="codeph">fn:collection</code>函数使用XQuery查询Oracle XML DB存储库中的数据。<a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBBGDEJ">例16-2</a>显示了如何在XQuery中使用<code class="codeph">fn:doc</code>函数来访问存储库。（有关使用这些XQuery函数的更多信息，请参阅<a href="../adxdb/query-and-update-XML.html#ADXDB5125" target="_blank"><span><cite>Oracle XML DB Developer's Guide</cite></span></a>中有关在Oracle XML DB存储库中查询XML数据的讨论。）
                     </p>
                     <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBBGDEJ">例16-2</a>生成了这个输出：</p><pre class="oac_no_warn" dir="ltr">&lt;emp ename =“Jack”dept =“Administration”/&gt; &lt;emp ename =“Jill”dept =“Marketing”/&gt;</pre></div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBCIJEB">
                     <p class="titleinexample">示例16-1使用XQJ使用XQuery查询XML DB表</p><pre class="oac_no_warn" dir="ltr">import oracle.xml.xquery.xqjdb。OXQDDataSource; import javax.xml.xquery。XQItemType; import javax.xml.xquery。XQResultSequence; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQPreparedExpression; import javax.xml.namespace。QName的; public class example1 {public static void main（String argv []）{try {//创建一个新的OXQDDataSource用于连接到Oracle XML DB OXQDDataSource oxqDS = new OXQDDataSource（）; //为数据库实例设置适当的连接信息。//必须使用瘦驱动程序oxqDS.setProperty（“driver”，“jdbc：oracle：thin”）; oxqDS.setProperty（“dbusername”，“oe”）; oxqDS.setProperty（“dbpassword”，“oe”）; //机器主机名oxqDS.setProperty（“dbserver”，“myserver”）; //数据库实例端口号oxqDS.setProperty（“dbport”，“6479”）; //数据库实例端口号oxqDS.setProperty（“serviceName”，“mydbinstance”）; XQConnection conn = oxqDS.getConnection（）; XQItemType itemTypeInt = conn.createAtomicType（XQItemType。XQBASETYPE_INT）; XQPreparedExpression expr = conn.prepareExpression（“声明变量$ x为xs：int external;对于$ i in fn：collection（'oradb：/ OE / WAREHOUSES'）其中$ i / ROW / WAREHOUSE_ID &lt;$ x返回$ i / ROW / WAREHOUSE_SPEC /仓库“）; expr.bindInt（new QName（“x”），3，itemTypeInt）; XQResultSequence xqSeq = expr.executeQuery（）; while（xqSeq.next（））System.out.println（xqSeq.getItemAsString（null））; } catch（Exception e）{e.printStackTrace（）; }}}</pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-445890C9-62DD-4ED9-BC27-B1FC11AC014E__BGBBGDEJ">
                     <p class="titleinexample">示例16-2使用XQJ使用XQuery查询XML DB存储库</p><pre class="oac_no_warn" dir="ltr">import oracle.xml.xquery.xqjdb。OXQDDataSource; import javax.xml.xquery。XQItemType; import javax.xml.xquery。XQResultSequence; import javax.xml.xquery。XQConnection; import javax.xml.xquery。XQPreparedExpression; import javax.xml.namespace。QName的; public class example2 {public static void main（String argv []）{try {//创建一个新的OXQDDataSource用于连接到Oracle XML DB OXQDDataSource oxqDS = new OXQDDataSource（）; //为数据库实例设置适当的连接信息。//必须使用瘦驱动程序oxqDS.setProperty（“driver”，“jdbc：oracle：thin”）; oxqDS.setProperty（“dbusername”，“oe”）; oxqDS.setProperty（“dbpassword”，“oe”）; //机器主机名oxqDS.setProperty（“dbserver”，“myserver”）; //数据库实例端口号oxqDS.setProperty（“dbport”，“6479”）; //数据库实例端口号oxqDS.setProperty（“serviceName”，“mydbinstance”）; XQConnection conn = oxqDS.getConnection（）; XQPreparedExpression expr = conn.prepareExpression（“for $ e in doc（\”/ public / emps.xml \“）/ emps / emp let $ d：= doc（\”/ public / depts.xml \“）// dept [@deptno = $ e / @ deptno] / @ dname其中$ e / @ salary&gt; 100000 order by $ e / @ empno return &lt;emp ename = \“{$ e / @ ename} \”dept = \“{$ d} \ “/&gt;”）; XQResultSequence xqSeq = expr.executeQuery（）; while（xqSeq.next（））System.out.println（xqSeq.getItemAsString（null））; } catch（Exception e）{e.printStackTrace（）; }}}</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDK202"></a><a id="ADXDK201"></a><a id="ADXDK137"></a><div class="props_rev_3"><a id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A" name="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A"></a><h3 id="ADXDK-GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A" class="sect3">XQJ支持Oracle XML DB</h3>
               <div>
                  <p>两个Oracle XQJ实现在某些方面有所不同。描述了对XQJ的Oracle XML DB支持。</p>
                  <p><a href="using-xquery-processor-for-Java.html#GUID-9E6570F0-37BB-4690-BFF6-A2052B5B57E8" title="解释了如何使用Oracle XML Developer Kit（XDK）XQuery处理器来实现Java。">使用XQuery Processor for Java</a>提供了有关使用XQJ访问中间层XQuery引擎的信息。
                  </p>
                  <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBEAIA" title="此表描述了用于连接Oracle XML DB的OXQDDataSource属性。 OXQDataSource属性">表16-1</a>描述了用于连接Oracle XML DB的OXQDDataSource属性。要创建与Oracle XML DB的XQJ连接，必须设置这些属性的值。您必须设置<code class="codeph">dbname</code>或<code class="codeph">serviceName</code>属性值，以及<a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBEAIA" title="此表描述了用于连接Oracle XML DB的OXQDDataSource属性。 OXQDataSource属性">表16-1中</a>列出的所有其他OXQDDataSource属性值。
                  </p>
                  <div class="tblformalwide" id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBEAIA">
                     <p class="titleintable">表16-1 OXQDDataSource属性</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="OXQDDataSource属性" width="100%" border="1" summary="This table describes the OXQDDataSource properties to be used for connection to Oracle XML DB. OXQDataSource Properties" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="13%" id="d60904e680">属性</th>
                              <th align="left" valign="bottom" width="52%" id="d60904e683">值</th>
                              <th align="left" valign="bottom" width="18%" id="d60904e686">获取方法</th>
                              <th align="left" valign="bottom" width="18%" id="d60904e689">设置方法</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e694" headers="d60904e680 ">
                                 <p><code class="codeph">司机</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e694 d60904e683 ">
                                 <p><code class="codeph">JDBC：ORACLE：薄</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e694 d60904e686 ">
                                 <p><code class="codeph">getDriver</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e694 d60904e689 ">
                                 <p><code class="codeph">setDriver</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e711" headers="d60904e680 ">
                                 <p><code class="codeph">数据库用户名</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e711 d60904e683 ">
                                 <p>数据库架构（用户）名称</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e711 d60904e686 ">
                                 <p><code class="codeph">getDBUserName</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e711 d60904e689 ">
                                 <p><code class="codeph">setDBUserName</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e727" headers="d60904e680 ">
                                 <p><code class="codeph">DBPASSWORD</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e727 d60904e683 ">
                                 <p>数据库架构的密码</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e727 d60904e686 ">
                                 <p><code class="codeph">getDBPassword</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e727 d60904e689 ">
                                 <p><code class="codeph">setDBPassword</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e743" headers="d60904e680 ">
                                 <p><code class="codeph">DBSERVER</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e743 d60904e683 ">
                                 <p>数据库实例的主机名</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e743 d60904e686 ">
                                 <p><code class="codeph">getDBServer</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e743 d60904e689 ">
                                 <p><code class="codeph">setDBServer</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e759" headers="d60904e680 ">
                                 <p><code class="codeph">dbport</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e759 d60904e683 ">
                                 <p>XQJ连接的数据库实例的端口号</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e759 d60904e686 ">
                                 <p><code class="codeph">getDBPort</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e759 d60904e689 ">
                                 <p><code class="codeph">setDBPort</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e775" headers="d60904e680 ">
                                 <p><code class="codeph">DBNAME</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e775 d60904e683 ">
                                 <p>数据库实例名称（服务ID） <a id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBCCFH" name="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBCCFH" href="#GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBCCFH" you="" can="" identify="" the="" database="" using="" either="" service="" or="" name=")" ="" onclick="footdisplay(1, "><sup>脚1</sup></a></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e775 d60904e686 ">
                                 <p><code class="codeph">getDBName</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e775 d60904e689 ">
                                 <p><code class="codeph">setDBName</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="13%" id="d60904e794" headers="d60904e680 ">
                                 <p><code class="codeph">服务名称</code></p>
                              </td>
                              <td align="left" valign="top" width="52%" headers="d60904e794 d60904e683 ">
                                 <p>服务名称<a id="fnsrc_d60904e801" name="fnsrc_d60904e801" href="#fnsrc_d60904e801" you="" can="" identify="" the="" database="" using="" either="" service="" or="" name=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e794 d60904e686 ">
                                 <p><code class="codeph">getServiceName</code></p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d60904e794 d60904e689 ">
                                 <p><code class="codeph">setServiceName</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p class="tablefootnote"><sup class="tablefootnote">脚注1</sup></p><p>您可以使用服务标识或服务名称标识数据库。</p>
                  <p></p>
                  <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBHICIJ" title="XQJ的Oracle XML DB支持">表16-2</a>描述了对可选XQJ功能的Oracle XML DB支持。
                  </p>
                  <div class="infoboxnote" id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__GUID-47A8F4C2-94C1-40F6-96A7-A40E8D0A9C6D">
                     <p class="notep1">注意：</p>
                     <p>Oracle XML DB对某些XQJ功能的支持与中层XQuery引擎的支持不同。特别是，Oracle XML DB XQJ实现不支持使用用户定义的类型。</p>
                  </div>
                  <div class="tblformalwide" id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBHICIJ">
                     <p class="titleintable">表16-2对可选XQJ功能的Oracle XML DB支持</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="Oracle XML DB支持可选的XQJ功能" width="100%" border="1" summary="Oracle XML DB Support for XQJ" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="55%" id="d60904e830">XQJ功能</th>
                              <th align="left" valign="bottom" width="45%" id="d60904e833">Oracle XML DB支持</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e838" headers="d60904e830 ">
                                 <p><code class="codeph">XQDataSource</code>实现的类名</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e838 d60904e833 ">
                                 <p><code class="codeph">oracle.xml.xquery.xqjdb。OXQDDataSource</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e849" headers="d60904e830 ">
                                 <p>JDBC连接</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e849 d60904e833 ">
                                 <p>不支持。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e856" headers="d60904e830 ">
                                 <p>在<code class="codeph">OXQDDataSource</code>定义的属性（连接信息）</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e856 d60904e833 ">
                                 <p><a href="using-xquery-API-for-Java-to-access-XML-DB.html#GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__BGBBEAIA" title="此表描述了用于连接Oracle XML DB的OXQDDataSource属性。 OXQDataSource属性">见表16-1</a> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e871" headers="d60904e830 ">
                                 <p>命令</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e871 d60904e833 ">
                                 <p>不支持。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e878" headers="d60904e830 ">
                                 <p><code class="codeph">XQPreparedExpression.cancel</code> （取消查询执行）</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e878 d60904e833 ">
                                 <p>不支持。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e887" headers="d60904e830 ">
                                 <p>序列化</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e887 d60904e833 ">
                                 <p>只有值为<code class="codeph">xml</code>参数<code class="codeph">method</code>和值为<code class="codeph">UTF-8</code>或<code class="codeph">UTF-16</code>参数<code class="codeph">encoding</code> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e909" headers="d60904e830 ">
                                 <p>其他StAX和SAX事件</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e909 d60904e833 ">
                                 <p>不支持。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e916" headers="d60904e830 ">
                                 <p>用户定义的模式类型</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e916 d60904e833 ">
                                 <p>不支持。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e923" headers="d60904e830 ">
                                 <p>节点绑定到外部变量时的节点标识，文档顺序和全节点上下文保留</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e923 d60904e833 ">
                                 <p>不支持。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e930" headers="d60904e830 ">
                                 <p>登录超时</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e930 d60904e833 ">
                                 <p>不支持。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e937" headers="d60904e830 ">
                                 <p>交易</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e937 d60904e833 ">
                                 <p>不支持。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e945" headers="d60904e830 ">
                                 <p>当输入节点不是文档节点时， <code class="codeph">XQItemAccessor</code>方法<code class="codeph">getNodeUri()</code>行为</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e945 d60904e833 ">
                                 <p>返回<code class="codeph">NULL</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e961" headers="d60904e830 ">
                                 <p><code class="codeph">XQItemType</code>方法的行为<code class="codeph">getTypeName()</code>用于匿名类型</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e961 d60904e833 ">
                                 <p>返回<code class="codeph">false</code> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e977" headers="d60904e830 ">
                                 <p><code class="codeph">XQItemType</code>方法的行为<code class="codeph">getSchemaURI()</code></p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e977 d60904e833 ">
                                 <p>返回<code class="codeph">NULL</code>或类型创建期间提供的模式URI。目前，Oracle XML DB XQJ实现不使用模式URI来获取类型信息，并且不支持用户定义的类型。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e992" headers="d60904e830 ">
                                 <p>如果输入不是格式良好的XML文档，则<code class="codeph">XQDataFactory</code>方法的行为<code class="codeph">createItemFromDocument()</code>和<code class="codeph">bindDocument()</code></p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e992 d60904e833 ">
                                 <p>提出例外。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e1008" headers="d60904e830 ">
                                 <p>从<code class="codeph">XQQueryException</code>返回的其他错误代码</p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e1008 d60904e833 ">
                                 <p>不支持。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e1017" headers="d60904e830 ">
                                 <p>接口<code class="codeph">ConnectionPoolXQDataSource</code> ， <code class="codeph">PooledXQConnection</code> ， <code class="codeph">XQConnectionEvent</code> ， <code class="codeph">XQConnectionEventListener</code></p>
                              </td>
                              <td align="left" valign="top" width="45%" headers="d60904e1017 d60904e833 ">
                                 <p>不支持。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e1035" headers="d60904e830 "><pre class="oac_no_warn" dir="ltr">XQDataSource.getConnection（java.sql。连接）</pre></td>
                              <td align="left" valign="top" width="45%" headers="d60904e1035 d60904e833 ">
                                 <p>不支持。（不支持JDBC连接。）</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="55%" id="d60904e1042" headers="d60904e830 "><pre class="oac_no_warn" dir="ltr">XQDataSource.getConnection（java.lang。String，java.lang。串）</pre></td>
                              <td align="left" valign="top" width="45%" headers="d60904e1042 d60904e833 ">
                                 <p>与没有参数的<code class="codeph">getConnection()</code>相同：忽略参数。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="infoboxnotealso" id="GUID-02F09032-5E3C-4CE1-AADE-E9FFF70DC01A__GUID-184746E1-31CC-4633-B897-9B58DBFD6684">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../adxdb/xquery-and-XML-DB.html#ADXDB1700" target="_blank"><span><cite>Oracle XML DB Developer's Guide</cite></span></a> ，了解有关将XQuery语言与Oracle XML DB一起使用的信息</p>
                  </div>
               </div><a id="ADXDK207"></a><div class="props_rev_3"><a id="GUID-E2322A10-4973-40D6-B050-897FA1CC0972" name="GUID-E2322A10-4973-40D6-B050-897FA1CC0972"></a><h4 id="ADXDK-GUID-E2322A10-4973-40D6-B050-897FA1CC0972" class="sect4">其他Oracle XML DB XQJ支持限制</h4>
                  <div>
                     <p>描述了Oracle XML DB对XQJ的支持限制。它们都不适用于XQJ的中端XQuery引擎支持。</p>
                     <p>XQJ的Oracle XML DB支持在以下方面受到限制：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>所有Oracle XML DB XQuery支持限制也适用于XQJ的Oracle XML DB支持。</p>
                        </li>
                        <li>
                           <p>仅支持XDK文档对象模型（DOM）。使用任何其他DOM都可能导致错误。</p>
                        </li>
                        <li>
                           <p>不要指望Oracle XML DB XQJ实现可以与另一个XQJ实现互操作，包括XQJ的XDK Java实现。 （有关“可互操作”的含义，请参阅XQJ标准（JSR-225）。）</p>
                        </li>
                        <li>
                           <p><code class="codeph">XQDataSource</code>方法<code class="codeph">getLogWriter</code>和<code class="codeph">setLogWriter</code>没有效果（它们被忽略）。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">XQStaticContent</code>方法<code class="codeph">getBoundarySpacePolicy</code> ， <code class="codeph">setBoundarySpacePolicy</code> ， <code class="codeph">getDefaultCollation</code>和<code class="codeph">setDefaultCollation</code>都没有效果（它们被忽略）。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">XQStaticContent</code>方法的复制命名空间模式<code class="codeph">setCopyNamespacesModPreserve</code>和<code class="codeph">setCopyNamespacesModeInherit</code>无效（忽略它）。使用的值分别始终<code class="codeph">preserve</code>和<code class="codeph">inherit</code> 。
                           </p>
                        </li>
                        <li>
                           <p>不支持使用<code class="codeph">XQDynamicContext</code>方法绑定<code class="codeph">DocumentFragment</code>对象。
                           </p>
                        </li>
                        <li>
                           <p>不支持<code class="codeph">xs:duration</code>类型的值。使用<code class="codeph">XQDynamicContext</code>方法绑定<code class="codeph">xs:duration</code>或访问<code class="codeph">xs:duration</code>值会引发错误。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">xs:date</code> ， <code class="codeph">xs:dateTime</code> ， <code class="codeph">xs:gYear</code>和<code class="codeph">xs:gYearMonth</code>值的<code class="codeph">xs:gYearMonth</code>必须为-4712到9999（含）。使用此范围之外的一年可能会引发错误或产生不可预测的结果。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADXDK208"></a><div class="props_rev_3"><a id="GUID-1A6A963C-2C86-4592-A82A-5CFC1DCDE373" name="GUID-1A6A963C-2C86-4592-A82A-5CFC1DCDE373"></a><h3 id="ADXDK-GUID-1A6A963C-2C86-4592-A82A-5CFC1DCDE373" class="sect3">XQJ与Oracle XML DB一起使用的性能注意事项</h3>
               <div>
                  <p>要从数据库中获取项目序列，请使用<code class="codeph">XQResultSequence</code>方法<code class="codeph">next()</code>检索单个项目;然后使用<code class="codeph">XQItemAccessor</code>方法获取与该项对应的所有数据。
                  </p>
                  <p>这提供了比使用这些全序列提取方法更好的性能，每个方法在返回任何数据之前都实现了整个序列。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">getSequenceAsStream（）</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">getSequenceAsString（java.util中。属性道具）</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">writeSequence（java.io。OutputStream os，java.util。属性道具）</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">writeSequence（java.io。Writer ow，java.util。属性道具）</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">writeSequenceToResult（javax.xml.transform中。结果结果）</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">writeSequenceToSAX（org.xml.sax中。ContentHandler saxhdlr）</code></p>
                     </li>
                  </ul>
                  <p>例如，如果调用<code class="codeph">getSequenceAsStream()</code> ，则在从其构建的<code class="codeph">XMLStreamReader</code>实例返回到您的程序之前，将从数据库中获取所有XQuery结果序列数据。
                  </p>
                  <p>还要注意项目本身不可流化：项目访问器方法在输出任何部分之前始终实现整个项目。</p>
                  <p>对于输入， <code class="codeph">XQDynamicContext</code>定义的所有绑定方法在将输入数据传递给数据库之前完全实现输入数据。
                  </p>
                  <p>例如，当您调用<code class="codeph">bindDocument(javax.xml.namespace.QName varName，javax.xml.stream。XMLStreamReader value, XQItemType type)</code> ，输入<code class="codeph">XMLStreamReader</code>实例引用的所有数据在外部XQuery变量绑定到它之前处理。
                  </p>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>