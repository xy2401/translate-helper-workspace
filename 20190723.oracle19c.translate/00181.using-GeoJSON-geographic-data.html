<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="GeoJSON objects are JSON objects that represent geographic data. Examples are provided of creating GeoJSON data, indexing it, and querying it.">
      <meta name="description" content="GeoJSON objects are JSON objects that represent geographic data. Examples are provided of creating GeoJSON data, indexing it, and querying it.">
      <title>Using GeoJSON Geographic Data</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="JSON Developer's Guide">
      <meta property="og:description" content="GeoJSON objects are JSON objects that represent geographic data. Examples are provided of creating GeoJSON data, indexing it, and querying it.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="JSON Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="json-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-22T10:58:31-08:00">
      <meta name="dcterms.title" content="JSON Developer's Guide">
      <meta name="dcterms.dateCopyrighted" content="2015, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96227-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="GeoJSON-geographic-data.html" title="Previous" type="text/html">
      <link rel="next" href="performance-tuning-for-json-data.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADJSN">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="GeoJSON-geographic-data.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="performance-tuning-for-json-data.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JSON Developer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="GeoJSON-geographic-data.html" property="item" typeof="WebPage"><span property="name">GeoJSON Geographic Data</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Using GeoJSON Geographic Data</li>
            </ol>
            <a id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE" name="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE"></a>
            
            <h2 id="ADJSN-GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE" class="sect2"><span class="enumeration_chapter">24 </span>Using GeoJSON Geographic Data
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>GeoJSON objects are JSON objects that represent geographic data. Examples are provided of creating GeoJSON data, indexing it, and querying it.</p>
               <div class="section" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__GEOJSONOBJECTSGEOMETRYFEATUREFEATUR-1AE35DAB">
                  <p class="subhead1" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__GEOJSONOBJECTSGEOMETRYFEATUREFEATUR-1AE35B7B">GeoJSON Objects: Geometry, Feature, Feature Collection</p>
                  <p>GeoJSON uses JSON objects that represent various geometrical entities and combinations of these together with user-defined properties.</p>
                  <p>A <span class="bold"><strong class="term">position</strong></span> is an array of two or more spatial (numerical) coordinates, the first three of which generally represent longitude, latitude, and altitude.
                  </p>
                  <p>A <span class="bold"><strong class="term">geometry</strong></span> object has a <code class="codeph">type</code> field and (except for a geometry-collection object) a <code class="codeph">coordinates</code> field, as shown in <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__TABLE-1312-1ADAB5C5" title="Two columns: “type Field” and “coordinates Field”. The former has entries for possible values for field “type”. The latter has descriptions of the associated “coordinates” field.">Table 24-1</a>.
                  </p>
                  <p>A <span class="bold"><strong class="term">geometry collection</strong></span> is a geometry object with <code class="codeph">type</code> <code class="codeph">GeometryCollection</code>. Instead of a <code class="codeph">coordinates</code> field it has a <code class="codeph">geometries</code> field, whose value  is an array of geometry objects other than <code class="codeph">GeometryCollection</code> objects.
                  </p>
                  <div class="tblformal" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__TABLE-1312-1ADAB5C5">
                     <p class="titleintable">Table 24-1 GeoJSON Geometry Objects Other Than Geometry Collections</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="GeoJSON Geometry Objects Other Than Geometry Collections" summary="Two columns: “type Field” and “coordinates Field”. The former has entries for possible values for field “type”. The latter has descriptions of the associated “coordinates” field." frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d34085e130"><code class="codeph">type</code> Field
                              </th>
                              <th align="left" valign="bottom" width="20%" id="d34085e134"><code class="codeph">coordinates</code> Field
                              </th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d34085e140" headers="d34085e130 "><code class="codeph">Point</code></td>
                              <td align="left" valign="top" width="20%" headers="d34085e140 d34085e134 ">A position.</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d34085e146" headers="d34085e130 "><code class="codeph">MultiPoint</code></td>
                              <td align="left" valign="top" width="20%" headers="d34085e146 d34085e134 ">An array of positions.</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d34085e152" headers="d34085e130 "><code class="codeph">LineString</code></td>
                              <td align="left" valign="top" width="20%" headers="d34085e152 d34085e134 ">An array of two or more positions.</td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d34085e158" headers="d34085e130 "><code class="codeph">MultiLineString</code></td>
                              <td align="left" valign="top" width="20%" headers="d34085e158 d34085e134 ">An array of <code class="codeph">LineString</code> arrays of positions.
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d34085e167" headers="d34085e130 "><code class="codeph">Polygon</code></td>
                              <td align="left" valign="top" width="20%" headers="d34085e167 d34085e134 ">A <code class="codeph">MultiLineString</code>, each of whose arrays is a <code class="codeph">LineString</code> whose first and last positions coincide (are equivalent). If the array of a polygon contains more than one array then the first represents the outside polygon and the others represent holes inside it.
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d34085e179" headers="d34085e130 "><code class="codeph">MultiPolygon</code></td>
                              <td align="left" valign="top" width="20%" headers="d34085e179 d34085e134 ">An array of <code class="codeph">Polygon</code> arrays, that is, multidimensional array of positions.
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>A <span class="bold"><strong class="term">feature</strong></span> object has a <code class="codeph">type</code> field of value <code class="codeph">Feature</code>, a <code class="codeph">geometry</code> field whose value is a geometric object, and a <code class="codeph">properties</code> field whose value can be any JSON object. 
                  </p>
                  <p>A <span class="bold"><strong class="term">feature collection</strong></span> object has a <code class="codeph">type</code> field of value <code class="codeph">FeatureCollection</code>, and it has a <code class="codeph">features</code> field whose value is an array of feature objects.
                  </p>
                  <p><a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__ATABLEWITHGEOJSONDATA-1A78A498">Example 24-1</a> presents a feature-collection object whose <code class="codeph">features</code> array has three features. The <code class="codeph">geometry</code> of the first feature is of type <code class="codeph">Point</code>; that of the second is of type <code class="codeph">LineString</code>; and that of the third is of type <code class="codeph">Polygon</code>.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__GUID-99C6ADFF-6369-4797-9BBA-4434B6D35398">Query and Index GeoJSON Data</p>
                  <p>You can use SQL/JSON query functions and conditions to examine GeoJSON data or to project parts of it as non-JSON data, including as Oracle Spatial and Graph <code class="codeph">SDO_GEOMETRY</code> object-type instances. This is illustrated in <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__SELECTINGAGEOMETRYOBJECTFROMAGEOJSO-1A7FF6BC">Example 24-2</a>, <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__RETRIEVINGMULTIPLEGEOMETRYOBJECTSFR-1A798541">Example 24-3</a>, and <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__USINGGEOJSONGEOMETRYWITHSPATIALOPER-1A80027C">Example 24-5</a>. 
                  </p>
                  <p>To improve query performance, you can create an Oracle Spatial and Graph index (type <code class="codeph">MDSYS.SPATIAL_INDEX</code>) on function <code class="codeph">json_value</code> applied to GeoJSON data. This is illustrated by <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__CREATINGASPATIALINDEXFORSCALARGEOJS-1089E75F">Example 24-4</a>.
                  </p>
                  <p><a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__CREATINGASPATIALINDEXFORSCALARGEOJS-1089E75F">Example 24-4</a> indexes only one particular element of an array of geometry features (the first element). A B-tree index on function <code class="codeph">json_value</code> can target only a <span class="italic">scalar</span> value. To improve the performance of queries, such as that of <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__RETRIEVINGMULTIPLEGEOMETRYOBJECTSFR-1A798541">Example 24-3</a>, that target any number of array elements, you can do the following:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Create an on-statement, refreshable <span class="italic">materialized view</span> of the array data, and place that view <span class="italic">in memory</span>.
                        </p>
                     </li>
                     <li>
                        <p>Create a spatial index on the array data.</p>
                     </li>
                  </ul>
                  <p>This is shown in <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__CREATINGAMATERIALIZEDVIEWOVERGEOJSO-1080D4F4">Example 24-6</a> and <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__CREATINGASPATIALINDEXONAMATERIALIZE-108B156F">Example 24-7</a>. 
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__SDO_GEOMETRYOBJECT-TYPEINSTANCESAND-1AE4B386">
                  <p class="subhead1" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__SDO_GEOMETRYOBJECT-TYPEINSTANCESAND-1AE4B175">SDO_GEOMETRY Object-Type Instances and Spatial Operations</p>
                  <p>You can convert Oracle Spatial and Graph <code class="codeph">SDO_GEOMETRY</code> object-type instances to GeoJSON objects and GeoJSON objects to <code class="codeph">SDO_GEOMETRY</code> instances. 
                  </p>
                  <p>You can use Oracle Spatial and Graph operations on <code class="codeph">SDO_GEOMETRY</code> objects that you obtain from GeoJSON objects. For example, you can use operator <code class="codeph">sdo_distance</code> in PL/SQL package <code class="codeph">SDO_GEOM</code> to compute the minimum distance between two geometry objects. This is the distance between the closest two points or two segments, one point or segment from each object. This is illustrated by <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__USINGGEOJSONGEOMETRYWITHSPATIALOPER-1A80027C">Example 24-5</a>.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__GUID-FC937265-C835-4849-B84F-631CCB674C2D">JSON Data Guide Supports GeoJSON Data</p>
                  <p>A JSON data guide summarizes structural and type information contained in a set of JSON documents. If some of the documents contain GeoJSON data then that data is summarized in a data guide that you create using SQL aggregate function <code class="codeph">json_dataguide</code>. If you use SQL function <code class="codeph">json_dataguide</code> to create a view based on such a data guide, and you specify the formatting argument as <code class="codeph">DBMS_JSON.GEOJSON</code> or <code class="codeph">DBMS_JSON.GEOJSON+DBMS_JSON.PRETTY</code>, then a column that projects GeoJSON data from the document set is of SQL data type <code class="codeph">SDO_GEOMETRY</code>.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="infoboxnotealso" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__GUID-98669737-E5A5-4A2F-8693-4F0F38B1CFC5">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../spatl/spatial-concepts.html#SPATL-GUID-D703DF4D-57D1-4990-8F53-CAAA9C8FCB2F" target="_blank"><span><cite>Oracle Spatial and Graph Developer's Guide</cite></span></a> for information about using GeoJSON data with Oracle Spatial and Graph 
                           </p>
                        </li>
                        <li>
                           <p><a href="../spatl/spatial-concepts.html#SPATL-GUID-67E4037F-C40F-442A-8662-837DD5539784" target="_blank"><span><cite>Oracle Spatial and Graph Developer's Guide</cite></span></a> for information about Oracle Spatial and Graph and <code class="codeph">SDO_GEOMETRY</code> object type
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=geojson_org" target="_blank">GeoJSON.org</a> for information about GeoJSON
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adjsn&amp;id=geojson_spec" target="_blank"><span class="italic">The GeoJSON Format Specification</span></a> for details about GeoJSON data
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__ATABLEWITHGEOJSONDATA-1A78A498">
                  <p class="titleinexample">Example 24-1 A Table With GeoJSON Data</p>
                  <p>This example creates table <code class="codeph">j_geo</code>, which has a column, <code class="codeph">geo_doc</code> of GeoJSON documents. 
                  </p>
                  <p>Only one such document is inserted here. It contains a GeoJSON object of <code class="codeph">type</code> <code class="codeph">FeatureCollection</code>, and a <code class="codeph">features</code> array of objects of <code class="codeph">type</code> <code class="codeph">Feature</code>. Those objects have <code class="codeph">geometry</code>, respectively, of <code class="codeph">type</code> <code class="codeph">Point</code>, <code class="codeph">LineString</code>, and <code class="codeph">Polygon</code>.
                  </p><pre class="pre codeblock"><code>CREATE TABLE <span class="bold">j_geo</span>
  (id      VARCHAR2 (32) NOT NULL,
   <span class="bold">geo_doc</span> VARCHAR2 (4000) CHECK (geo_doc IS JSON));

INSERT INTO j_geo
  VALUES (1,
          '{"type"     : "<span class="bold">FeatureCollection</span>",
            "features" : [{"type"       : "<span class="bold">Feature</span>",
                           "geometry"   : {"type" : "<span class="bold">Point</span>",
                                           "coordinates" : [-122.236111, 37.482778]},
                           "properties" : {"Name" : Redwood City"}},
                          {"type" : "<span class="bold">Feature</span>",
                           "geometry" : {"type" : "<span class="bold">LineString</span>",
                                         "coordinates" : [[102.0, 0.0],
                                                          [103.0, 1.0],
                                                          [104.0, 0.0],
                                                          [105.0, 1.0]]},
                           "properties" : {"prop0" : "value0",
                                           "prop1" : 0.0}},
                          {"type"        : "<span class="bold">Feature</span>",
                            "geometry"   : {"type" : "<span class="bold">Polygon</span>",
                                            "coordinates" : [[[100.0, 0.0],
                                                              [101.0, 0.0],
                                                              [101.0, 1.0],
                                                              [100.0, 1.0],
                                                              [100.0, 0.0]]]},
                            "properties" : {"prop0" : "value0",
                                            "prop1" : {"this" : "that"}}}]}');
</code></pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__SELECTINGAGEOMETRYOBJECTFROMAGEOJSO-1A7FF6BC">
                  <p class="titleinexample">Example 24-2 Selecting a geometry Object From a GeoJSON Feature As an SDO_GEOMETRY Instance</p>
                  <p>This example uses SQL/JSON function <code class="codeph">json_value</code> to select the value of field <code class="codeph">geometry</code> from the first element of array <code class="codeph">features</code>. The value is returned as Oracle Spatial and Graph data, not as JSON data, that is, as an instance of PL/SQL object type <code class="codeph">SDO_GEOMETRY</code>, not as a SQL string or LOB instance. 
                  </p><pre class="pre codeblock"><code>SELECT json_value(geo_doc, '<span class="bold">$.features[0].geometry</span>'
                  <span class="bold">RETURNING SDO_GEOMETRY</span> 
                  ERROR ON ERROR)
  FROM j_geo;</code></pre><p>The value returned is this, which represents a point with longitude and latitude (coordinates) -122.236111 and 37.482778, respectively.</p><pre class="pre codeblock"><code><span class="bold">SDO_GEOMETRY</span>(2001, 4326, <span class="bold">SDO_POINT_TYPE</span>(<span class="bold">-122.236111</span>, <span class="bold">37.482778</span>, NULL), NULL, NULL)</code></pre><div class="infoboxnotealso" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__GUID-FE4D2396-9217-4374-BA3A-CDCB4DEDD892">
                     <p class="notep1">See Also:</p>
                     <p><a href="../sqlrf/JSON_VALUE.html#SQLRF-GUID-C7F19D36-1E75-4CB2-AE67-ADFBAD23CBC2" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function <code class="codeph">json_value</code></p>
                  </div>
               </div>
               <!-- class="example" -->
               <div class="example" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__RETRIEVINGMULTIPLEGEOMETRYOBJECTSFR-1A798541">
                  <p class="titleinexample">Example 24-3 Retrieving Multiple geometry Objects From a GeoJSON Feature As SDO_GEOMETRY</p>
                  <p>This example uses SQL/JSON function <code class="codeph">json_table</code> to project the value of field <code class="codeph">geometry</code> from <span class="italic">each</span> element of array <code class="codeph">features</code>, as column <code class="codeph">sdo_val</code> of a virtual table. The retrieved data is returned as <code class="codeph">SDO_GEOMETRY</code>.
                  </p><pre class="pre codeblock"><code>SELECT jt.*
  FROM j_geo,
       json_table(geo_doc, '<span class="bold">$.features[*]</span>'
         COLUMNS (<span class="bold">sdo_val</span> <span class="bold">SDO_GEOMETRY</span> PATH '<span class="bold">$.geometry</span>')) jt;
</code></pre><div class="infoboxnotealso" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__GUID-81005FB2-21C4-424C-B31B-387AC0528977">
                     <p class="notep1">See Also:</p>
                     <p><a href="../sqlrf/JSON_TABLE.html#SQLRF-GUID-3C8E63B5-0B94-4E86-A2D3-3D4831B67C62" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function <code class="codeph">json_table</code></p>
                  </div>
                  <p>The following three rows are returned for the query. The first represents the same <code class="codeph">Point</code> as in <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__SELECTINGAGEOMETRYOBJECTFROMAGEOJSO-1A7FF6BC">Example 24-2</a>. The second represents the <code class="codeph">LineString</code> array. The third represents the <code class="codeph">Polygon</code>. 
                  </p><pre class="pre codeblock"><code>SDO_GEOMETRY(2001, 4326, SDO_POINT_TYPE(-122.236111, 37.482778, NULL), NULL, NULL)

SDO_GEOMETRY(2002, 4326, NULL, <span class="bold">SDO_ELEM_INFO_ARRAY</span>(1, <span class="bold">2</span>, <span class="bold">1</span>),
<span class="bold">SDO_ORDINATE_ARRAY</span>(102, 0, 103, 1, 104, 0, 105, 1))

SDO_GEOMETRY(2003, 4326, NULL, <span class="bold">SDO_ELEM_INFO_ARRAY</span>(1, <span class="bold">1003</span>, <span class="bold">1</span>),
<span class="bold">SDO_ORDINATE_ARRAY</span>(100, 0, 101, 0, 101, 1, 100, 1, 100, 0))</code></pre><p>The second and third elements of attribute <code class="codeph">SDO_ELEM_INFO_ARRAY</code> specify how to interpret the coordinates provided by attribute <code class="codeph">SDO_ORDINATE_ARRAY</code>. They show that the first row returned represents a <span class="italic">line string</span> (2) with straight segments (1), and the second row represents a <span class="italic">polygon</span> (2003) of straight segments (1).
                  </p>
               </div>
               <!-- class="example" -->
               <div class="example" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__CREATINGASPATIALINDEXFORSCALARGEOJS-1089E75F">
                  <p class="titleinexample">Example 24-4 Creating a Spatial Index For Scalar GeoJSON Data</p>
                  <p>This example creates a <code class="codeph">json_value</code> function-based index of type <code class="codeph">MDSYS.SPATIAL_INDEX</code> on field <code class="codeph">geometry</code> of the first element of array <code class="codeph">features</code>. This can improve the performance of queries that use <code class="codeph">json_value</code> to retrieve that value.
                  </p><pre class="pre codeblock"><code>CREATE INDEX <span class="bold">geo_first_feature_idx</span>
  ON j_geo (json_value(geo_doc, '<span class="bold">$.features[0].geometry</span>'
                       <span class="bold">RETURNING SDO_GEOMETRY</span>))
  INDEXTYPE IS <span class="bold">MDSYS.SPATIAL_INDEX</span>;
</code></pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__USINGGEOJSONGEOMETRYWITHSPATIALOPER-1A80027C">
                  <p class="titleinexample">Example 24-5 Using GeoJSON Geometry With Spatial Operators</p>
                  <p>This example selects the documents (there is only one in this table) for which the <code class="codeph">geometry</code> field of the first <code class="codeph">features</code> element is within 100 kilometers of a given point. The point is provided literally here (its <code class="codeph">coordinates</code> are the longitude and latitude of San Francisco, California). The distance is computed from this point to each geometry object.
                  </p>
                  <p>The query orders the selected documents by the calculated distance. The tolerance in meters for the distance calculation is provided in this query as the literal argument 100.</p><pre class="pre codeblock"><code>SELECT id,
       json_value(geo_doc, '$features[0].properties.<span class="bold">Name</span>') "<span class="italic">Name</span>",
       <span class="bold">SDO_GEOM.sdo_distance</span>(
         json_value(geo_doc, '$features[0].geometry') RETURNING <span class="bold">SDO_GEOMETRY</span>,
         <span class="bold">SDO_GEOMETRY</span>(2001,
                      4326,
                      <span class="bold">SDO_POINT_TYPE</span>(<span class="italic">-122.416667</span>, <span class="italic">37.783333</span>, NULL),
                      NULL,
                      NULL),
         <span class="italic">100</span>, <span class="italic">-- Tolerance in meters</span>
         'unit=KM') "<span class="italic">Distance in kilometers</span>"
  FROM  j_geo
  WHERE <span class="bold">sdo_within_distance</span>(
          json_value(geo_doc, '$.features[0].geometry' RETURNING <span class="bold">SDO_GEOMETRY</span>),
          <span class="bold">SDO_GEOMETRY</span>(2001,
                       4326,
                       <span class="bold">SDO_POINT_TYPE</span>(<span class="italic">-122.416667</span>, <span class="italic">37.783333</span>, NULL),
                       NULL,
                       NULL),
          '<span class="bold">distance=100 unit=KM</span>')
        = 'TRUE';
</code></pre><div class="infoboxnotealso" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__GUID-1DB619A2-BEF3-4535-B988-14C74266044F">
                     <p class="notep1">See Also:</p>
                     <p><a href="../sqlrf/JSON_VALUE.html#SQLRF-GUID-C7F19D36-1E75-4CB2-AE67-ADFBAD23CBC2" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function <code class="codeph">json_value</code></p>
                  </div>
                  <p>The query returns a single row:</p><pre class="pre codeblock"><code>ID    Name           Distance in kilometers
----- -------------- ----------------------
1     <span class="bold">Redwood City</span>   <span class="bold">26.9443035</span></code></pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__CREATINGAMATERIALIZEDVIEWOVERGEOJSO-1080D4F4">
                  <p class="titleinexample">Example 24-6 Creating a Materialized View Over GeoJSON Data</p><pre class="pre codeblock"><code>CREATE OR REPLACE MATERIALIZED VIEW <span class="bold">geo_doc_view</span>
  BUILD IMMEDIATE
  REFRESH FAST ON STATEMENT WITH ROWID
  AS SELECT g.rowid, jt.*
       FROM j_geo g,
            json_table(geo_doc, '<span class="bold">$.features[*]</span>'
              COLUMNS (<span class="bold">sdo_val</span> SDO_GEOMETRY PATH '$.geometry')) jt;
</code></pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__CREATINGASPATIALINDEXONAMATERIALIZE-108B156F">
                  <p class="titleinexample">Example 24-7 Creating a Spatial Index on a Materialized View Over GeoJSON Data</p>
                  <p>This example first prepares for the creation of the spatial index by populating some spatial-indexing metadata. It then creates the index on the <code class="codeph">SDO_GEOMETRY</code> column, <code class="codeph">sdo_val</code>, of materialized view <code class="codeph">geo_doc_view</code>, which is created in <a href="using-GeoJSON-geographic-data.html#GUID-2AD827B4-871E-4652-87F3-AC33FE7839AE__CREATINGAMATERIALIZEDVIEWOVERGEOJSO-1080D4F4">Example 24-6</a>. Except for the view and column names, the code for populating the indexing metadata is fixed — use it each time you need to create a spatial index on a materialized view.
                  </p><pre class="pre codeblock"><code>
-- Populate spatial-indexing metadata

INSERT INTO USER_SDO_GEOM_METADATA
  VALUES ('<span class="bold">GEO_DOC_VIEW</span>',
          '<span class="bold">SDO_VAL</span>',
          MDSYS.sdo_dim_array(
            MDSYS.sdo_dim_element('Longitude', -180, 180, 0.05),
            MDSYS.sdo_dim_element('Latitude', -90, 90, 0.05)),
          7
          4326);

-- Create spatial index on geometry column of materialized view

CREATE INDEX <span class="bold">geo_all_features_idx</span> ON <span class="bold">geo_doc_view</span>(<span class="bold">sdo_val</span>)
  INDEXTYPE IS <span class="bold">MDSYS.SPATIAL_INDEX V2</span>;</code></pre></div>
               <!-- class="example" -->
            </div>
            <div>
               <div class="relinfo">
                  <p><strong>Related Topics</strong></p>
                  <ul>
                     <li><a href="function-JSON_TABLE.html#GUID-BFA1FB9A-0F18-4ED2-B504-6855DC6705B5" title="To improve query performance you can create a view over JSON data that you project to columns using SQL/JSON function json_table. To further improve query performance you can create a materialized view and place the JSON data in memory.">Creating a View Over JSON Data Using JSON_TABLE</a></li>
                     <li><a href="json-dataguide.html#GUID-D8448CB1-0350-4848-B07E-9370B3B1A9BE" title="The predefined fields of a JSON data guide are described. They include JSON Schema fields (keywords) and Oracle-specific fields.">JSON Data-Guide Fields</a></li>
                  </ul>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="GeoJSON-geographic-data.html#GUID-1B740D97-DC77-4548-80F8-E8FBD28C3A38" title="GeoJSON data is geographic JSON data. Oracle Spatial and Graph supports the use of GeoJSON objects to store, index, and manage GeoJSON data.">GeoJSON Geographic Data</a></p>
                  </div>
               </div>
            </div>
            
         </div>
      </article>
   </body>
</html>