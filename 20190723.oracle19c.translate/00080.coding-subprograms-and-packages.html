<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>编码PL / SQL子程序和包</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Development Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Development Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-development-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-31T23:23:15-08:00"></meta>
      <meta name="dcterms.title" content="Database Development Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96334-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="plsql-for-application-developers.html" title="Previous" type="text/html"></link>
      <link rel="next" href="plscope.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADFNS"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="plsql-for-application-developers.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="plscope.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库开发指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="plsql-for-application-developers.html" property="item" typeof="WebPage"><span property="name">应用程序开发人员的PL / SQL</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">编码PL / SQL子程序和包</li>
            </ol>
            <a id="GUID-18D5ADA3-97E1-4D71-8829-7C2F18DF6E2F" name="GUID-18D5ADA3-97E1-4D71-8829-7C2F18DF6E2F"></a><a id="ADFNS1029"></a><a id="ADFNS009"></a>
            
            <h2 id="ADFNS-GUID-18D5ADA3-97E1-4D71-8829-7C2F18DF6E2F" class="sect2"><span class="enumeration_chapter">13</span>编码PL / SQL子程序和包</h2>
         </header>
         <div class="ind">
            <div>
               <p>PL / SQL子程序和包是Oracle数据库应用程序的构建块。由于<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS00902" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考中</span></a>给出的原因，Oracle建议您将应用程序实现为程序包。
               </p>
               <div class="section">
                  <p class="subhead1" id="GUID-18D5ADA3-97E1-4D71-8829-7C2F18DF6E2F__GUID-EF845E7B-3370-42AA-904D-5A8606465081">话题：</p>
               </div>
               <!-- class="section" -->
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-037FB905-0E13-4729-840F-CF3DDC1028D9">PL / SQL子程序概述</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-29768EA9-170A-4038-B6EB-9821E33E5DF6">PL / SQL包概述</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF">PL / SQL单元概述</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-C0141D00-57EA-4957-9270-CCA83EE82C95">创建PL / SQL子程序和包</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-165E6DFF-2BD3-4A69-A1F1-557F74D4B7C0">改变PL / SQL子程序和包</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-49E5AD11-BFCE-4AA5-B309-C86A34502C88">弃用包，子程序和类型</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-BAE76DFB-434F-499A-8D9A-8AB15C36AA40">删除PL / SQL子程序和包</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-53216323-38DB-4BE4-B2A9-E85DFCCBBB7A">编译本机执行的PL / SQL单元</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-C898484A-4592-44F6-875D-C83B30E1DDAA">调用存储的PL / SQL子程序</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-C35B709B-EE78-4DB4-9B63-54EB8B4D639F" title="您可以在创建PL / SQL包时使用PRAGMA RESTRICT_REFERENCES子句。">从SQL语句调用存储的PL / SQL函数</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-7D7E93D3-FD00-42C7-85D1-2B8965CA99D5" title="可以使用Oracle SQL Developer，Oracle JDeveloper和各种第三方工具调试数据库中的PL / SQL和Java代码。DBMS_DEBUG_JDWP包用于在数据库会话和这些调试器程序之间建立连接。">调试存储的子程序</a></p>
                  </li>
                  <li>
                     <p><a href="coding-subprograms-and-packages.html#GUID-819553BB-9DC8-45A6-88EC-8BAF797C634E">包失效和会话状态</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-18D5ADA3-97E1-4D71-8829-7C2F18DF6E2F__GUID-713C90D8-FFF8-48D1-90CD-2204F6C0F50A">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>有关处理PL / SQL子程序和包中的错误的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS007" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                     </li>
                     <li>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ADDCI2120" target="_blank"><span class="italic">Oracle数据库数据盒开发人员指南</span></a> ，了解有关为复杂数据类型创建聚合函数的信息，例如使用对象类型，不透明类型和LOB存储的多媒体数据</p>
                     </li>
                     <li>
                        <p>有关应用程序跟踪工具的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=TGSQL791" target="_blank"><span class="italic">“Oracle数据库SQL调优指南”</span></a> ，该工具可帮助您查找PL / SQL代码中的问题</p>
                     </li>
                  </ul>
               </div>
            </div><a id="ADFNS1397"></a><div class="props_rev_3"><a id="GUID-037FB905-0E13-4729-840F-CF3DDC1028D9" name="GUID-037FB905-0E13-4729-840F-CF3DDC1028D9"></a><h3 id="ADFNS-GUID-037FB905-0E13-4729-840F-CF3DDC1028D9" class="sect3">PL / SQL子程序概述</h3>
               <div>
                  <p>PL / SQL源程序的基本单元是<span class="bold">块</span> ，它对相关的声明和语句进行分组。块具有可选的声明部分，必需的可执行部分和可选的异常处理部分。块可以是匿名的，也可以是命名的。
                  </p>
                  <p>PL / SQL <span class="bold">子程序</span>是可以重复调用的命名块。如果子程序具有参数，则它们的值可以在每次调用时不同。
                  </p>
                  <p>子程序是程序或功能。通常，您使用<span class="bold">过程</span>执行操作，并使用<span class="bold">函数</span>来计算和返回值。
                  </p>
                  <p>子程序也可以是<span class="bold">嵌套子程序</span> （在PL / SQL块中创建，可以是另一个子程序）， <span class="bold">包子程序</span> （在包规范中声明并在包体中定义），或<span class="bold">独立子程序</span> （在模式级别创建） ）。包子程序和独立程序是<span class="bold">存储的子程序</span> 。存储的子程序被编译并存储在数据库中，许多应用程序可以在其中调用它。
                  </p>
                  <p>存储的子程序受<code class="codeph">AUTHID</code>和<code class="codeph">ACCESSIBLE</code> <code class="codeph">BY</code>子句的影响。<span class="bold"><code class="codeph">AUTHID</code></span> <span class="bold">子句</span>影响子程序在运行时发出的SQL语句的名称解析和权限检查。<span class="bold"><code class="codeph">ACCESSIBLE</code></span> <span class="bold"><code class="codeph">BY</code></span> <span class="bold">子句</span>指定可以访问子程序的PL / SQL单元的白名单。
                  </p>
                  <p>在Oracle数据库实例上运行的PL / SQL子程序可以调用以第三代语言（3GL）编写的<span class="bold">外部子程序</span> 。3GL子程序在与数据库不同的地址空间中运行。
                  </p>
                  <p>PL / SQL允许您重载嵌套的子程序，包子程序和类型方法。<span class="bold">重载的子程序</span>具有相同的名称，但它们的形式参数在名称，编号，顺序或数据类型系列方面有所不同。
                  </p>
                  <p>与存储过程类似， <span class="bold">触发器</span>是一个名为PL / SQL的单元，存储在数据库中并可以重复调用。与存储过程不同，您可以启用和禁用触发器，但不能显式调用它。启用触发器时，数据库会自动调用它 - 也就是说，触发器会在触发事件发生时触发。触发器被禁用时，它不会触发。
                  </p>
                  <div class="infoboxnotealso" id="GUID-037FB905-0E13-4729-840F-CF3DDC1028D9__GUID-AB62AEE9-DC8E-43D9-80C6-0633EA64B8AA">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关PL / SQL子程序的完整信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS008" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p>有关PL / SQL块的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS141" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p>有关子程序的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS99900" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF">有关PL / SQL单元</a>的信息，请参阅PL / SQL单元<a href="coding-subprograms-and-packages.html#GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF">概述</a></p>
                        </li>
                        <li>
                           <p><a href="external-procedures.html#GUID-230B2B41-2A6F-4756-AEC0-DBC99DCA8A37">使用多种编程语言开发应用程序</a>以获取有关外部子程序的信息</p>
                        </li>
                        <li>
                           <p>有关重载子程序的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS00807" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p>有关触发器的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS020" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADFNS1398"></a><div class="props_rev_3"><a id="GUID-29768EA9-170A-4038-B6EB-9821E33E5DF6" name="GUID-29768EA9-170A-4038-B6EB-9821E33E5DF6"></a><h3 id="ADFNS-GUID-29768EA9-170A-4038-B6EB-9821E33E5DF6" class="sect3">PL / SQL包概述</h3>
               <div>
                  <p>PL / SQL <span class="bold">包</span>是一个模式对象，它将逻辑上相关的PL / SQL类型，变量，常量，子程序，游标和异常分组。包被编译并存储在数据库中，许多应用程序可以在其中共享其内容。
                  </p>
                  <p>包始终具有<span class="bold">规范</span> ，该<span class="bold">规范</span>声明可以从包外引用的<span class="bold">公共项</span> 。具有该程序包的<code class="codeph">EXECUTE</code>特权或<code class="codeph">EXECUTE</code> <code class="codeph">ANY</code> <code class="codeph">PROCEDURE</code>特权的外部用户可以使用或调用公共项。
                  </p>
                  <p>如果公共项目包括游标或子程序，则包裹也必须具有<span class="bold">正文</span> 。正文必须定义公共游标的查询和公共子程序的代码。正文还可以声明和定义无法从包外引用的<span class="bold">私有项</span> ，但对于包的内部工作是必需的。最后，正文可以有一个<span class="bold">初始化部分</span> ，其语句初始化变量并执行其他一次性设置步骤，以及异常处理部分。您可以在不更改规范或公共项目引用的情况下更改正文;因此，您可以将包装体视为黑盒子。
                  </p>
                  <p>在包规范或包体中，可以使用<span class="bold">调用规范</span>将包子程序映射到外部Java或C子程序，该<span class="bold">规范</span>将外部子程序名称，参数类型和返回类型映射到它们的SQL副本。
                  </p>
                  <p>包规范的<span class="bold"><code class="codeph">AUTHID</code></span> <span class="bold">子句</span>确定包中的子程序和游标是否以其定义者（默认）或调用者的权限运行，以及它们是否在定义者或调用者的模式中解析了对模式对象的非限定引用。
                  </p>
                  <p>包规范的<span class="bold"><code class="codeph">ACCESSIBLE</code></span> <span class="bold"><code class="codeph">BY</code></span> <span class="bold">子句</span>允许您指定可以访问包的PL / SQL单元的白名单。您可以在以下情况中使用此子句：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>您将PL / SQL应用程序实现为多个包 - 一个包提供应用程序编程接口（API）和帮助程序包来完成工作。您希望客户端可以访问API，但不能访问帮助程序包。因此，您省略了API包规范中的<code class="codeph">ACCESSIBLE</code> <code class="codeph">BY</code>子句，并将其包含在每个帮助程序包规范中，您指定只有API包才能访问帮助程序包。
                        </p>
                     </li>
                     <li>
                        <p>您可以创建一个实用程序包，以便为同一模式中的某些（但不是所有）PL / SQL单元提供服务。要将程序包的使用限制在目标单元中，请在程序包规范中的<code class="codeph">ACCESSIBLE</code> <code class="codeph">BY</code>子句中列出它们。
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-29768EA9-170A-4038-B6EB-9821E33E5DF6__GUID-4C6FD4FE-3584-417E-8588-2B41AF1CF7D9">
                     <p class="notep1">注意：</p>
                     <p>在创建自己的软件包之前，请检查<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ARPLS-GUID-4AA6AA30-CAEE-4DCD-B214-9AD51D0229B4" target="_blank"><span><cite>Oracle Database PL / SQL软件包和类型参考，</cite></span></a>以查看Oracle是否提供了具有所需功能的软件包。
                     </p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-29768EA9-170A-4038-B6EB-9821E33E5DF6__GUID-88A6C13D-E7D9-4069-9EA3-D6B77680DEF0">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF">有关PL / SQL单元</a>的信息，请参阅PL / SQL单元<a href="coding-subprograms-and-packages.html#GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF">概述</a></p>
                        </li>
                        <li>
                           <p>有关PL / SQL包的完整信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS009" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p><a href="../lnpls/plsql-packages.html#LNPLS00902" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a>了解使用包的原因</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADFNS00901"></a><div class="props_rev_3"><a id="GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF" name="GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF"></a><h3 id="ADFNS-GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF" class="sect3">PL / SQL单元概述</h3>
               <div>
                  <p>PL / SQL单元是以下之一：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>PL / SQL匿名块</p>
                     </li>
                     <li>
                        <p><code class="codeph">功能</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">图书馆</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">包</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">PACKAGE</code> <code class="codeph">BODY</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">程序</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">触发</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">类型</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">TYPE</code> <code class="codeph">BODY</code></p>
                     </li>
                  </ul>
                  <p>PL / SQL单元受PL / SQL编译参数（一类数据库初始化参数）的影响。不同的PL / SQL单元（例如，包规范及其主体）可以具有不同的编译参数设置。</p>
                  <p>PL / SQL单元的<code class="codeph">AUTHID</code>属性会影响单元在运行时发出的SQL语句的名称解析和权限检查。
                  </p>
                  <div class="infoboxnotealso" id="GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF__GUID-40E99704-3DE6-4F44-8F02-D20DEEBBCC86">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关PL / SQL单元和编译参数的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS0121" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">AUTHID</code>属性的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS00809" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADFNS1423"></a><a id="ADFNS1422"></a><div class="props_rev_3"><a id="GUID-146CA35F-6890-4AC2-AE17-209173853465" name="GUID-146CA35F-6890-4AC2-AE17-209173853465"></a><h4 id="ADFNS-GUID-146CA35F-6890-4AC2-AE17-209173853465" class="sect4">PLSQL_OPTIMIZE_LEVEL编译参数</h4>
                  <div>
                     <p>PL / SQL优化级别确定PL / SQL优化器可以重新排列代码以获得更好性能的程度。使用编译参数<code class="codeph">PLSQL_OPTIMIZE_LEVEL</code> （其默认值为2）设置此级别。
                     </p>
                     <p>要更改会话的PL / SQL优化级别，请使用SQL命令<code class="codeph">ALTER</code> <code class="codeph">SESSION</code> 。更改会话的级别仅影响后续创建的PL / SQL单元。要更改现有PL / SQL单元的级别，请使用带有<code class="codeph">COMPILE</code>子句的<code class="codeph">ALTER</code>命令。
                     </p>
                     <p>要显示<code class="codeph">PLSQL_OPTIMIZE_LEVEL</code>的当前值，请使用静态数据字典视图<code class="codeph">ALL_PLSQL_OBJECT_SETTINGS</code> 。</p>
                     <p><a href="coding-subprograms-and-packages.html#GUID-146CA35F-6890-4AC2-AE17-209173853465__BABJGEAA">例13-1</a>创建了两个过程，显示了它们的优化级别，更改了会话的优化级别，创建了第三个过程，并显示了所有三个过程的优化级别。只有第三个程序具有新的优化级别。然后，该示例仅更改一个过程的优化级别，并再次显示所有三个过程的优化级别。
                     </p>
                     <div class="infoboxnotealso" id="GUID-146CA35F-6890-4AC2-AE17-209173853465__GUID-5125DA1A-47A4-4A37-B1EA-347B3A52F8A0">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关PL / SQL优化器的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS01201" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">PLSQL_OPTIMIZE_LEVEL</code>更多信息，请<code class="codeph">PLSQL_OPTIMIZE_LEVEL</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=REFRN10255" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">ALTER</code> <code class="codeph">SESSION</code>更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=SQLRF00901" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关PL / SQL单元的<code class="codeph">ALTER</code>命令的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS99974" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">ALL_PLSQL_OBJECT_SETTINGS</code>更多信息，请<code class="codeph">ALL_PLSQL_OBJECT_SETTINGS</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=REFRN20385" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="example" id="GUID-146CA35F-6890-4AC2-AE17-209173853465__BABJGEAA">
                        <p class="titleinexample">例13-1更改PLSQL_OPTIMIZE_LEVEL</p>
                        <p>创建两个过程：</p><pre class="oac_no_warn" dir="ltr">创建或替换程序p1 AUTHID DEFINER为BEGIN NULL;结束; /创建或替换程序p2 AUTHID DEFINER为BEGIN NULL;结束; /</pre><p>显示两个过程的优化级别：</p><pre class="oac_no_warn" dir="ltr">SELECT NAME，PLSQL_OPTIMIZE_LEVEL来自USER_PLSQL_OBJECT_SETTINGS，其名称类似于'P％'和TYPE ='程序'按名称排序;</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">名称PLSQL_OPTIMIZE_LEVEL ------------------------------ ------------------ - 选择P1 2 P2 2 2行。
</pre><p>更改会话的优化级别并创建第三个过程：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">ALTER SESSION SET PLSQL_OPTIMIZE_LEVEL = 1;</span>创建或替换程序p3 AUTHID DEFINER为BEGIN NULL;结束; /</pre><p>显示三个程序的优化级别：</p><pre class="oac_no_warn" dir="ltr">SELECT NAME，PLSQL_OPTIMIZE_LEVEL来自USER_PLSQL_OBJECT_SETTINGS，其名称类似于'P％'和TYPE ='程序'按名称排序;</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">名称PLSQL_OPTIMIZE_LEVEL ------------------------------ ------------------ - 选择P1 2 P2 2 P3 1 3行。
</pre><p>将过程<code class="codeph">p1</code>的优化级别更改为3：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">更改程序p1编译PLSQL_OPTIMIZE_LEVEL = 3;</span>
 </pre><p>显示三个程序的优化级别：</p><pre class="oac_no_warn" dir="ltr">SELECT NAME，PLSQL_OPTIMIZE_LEVEL来自USER_PLSQL_OBJECT_SETTINGS，其名称类似于'P％'和TYPE ='程序'按名称排序;</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">名称PLSQL_OPTIMIZE_LEVEL ------------------------------ ------------------ - 选择P1 3 P2 2 P3 1 3行。</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="ADFNS312"></a><a id="ADFNS311"></a><div class="props_rev_3"><a id="GUID-C0141D00-57EA-4957-9270-CCA83EE82C95" name="GUID-C0141D00-57EA-4957-9270-CCA83EE82C95"></a><h3 id="ADFNS-GUID-C0141D00-57EA-4957-9270-CCA83EE82C95" class="sect3">创建PL / SQL子程序和包</h3>
               <div>
                  <div class="section">
                     <p class="subhead2" id="GUID-C0141D00-57EA-4957-9270-CCA83EE82C95__GUID-E304962F-327C-4A16-A927-6CE0A2B86959">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-E605F1D2-71F2-43A4-A20F-794AC9EAEDFD">创建子程序和包所需的权限</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-50BE2CE8-D203-4540-A1B4-72B13B42910C">创建子程序和包</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-BB9E57B9-5A98-4CCA-A886-E84044C41752">PL / SQL对象大小限制</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-32CE5470-A170-454A-A3E5-1E3EF2D70F96">PL / SQL数据类型</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-02AD5C8B-C803-4A4A-AF0F-BE87AB66ADF2">将结果集返回给客户端</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-A6887963-BE8C-4407-B5E4-68746E31A166">从函数返回大量数据</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-F9C263DB-7843-4CB8-B7D8-E409E38939A4">PL / SQL函数结果缓存</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-7C76F50E-2DF7-4D46-BAD1-A46FAFA9A65A">批量绑定概述</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-AA03D3E8-BCAB-4146-ABB2-3D727C21EA1E">PL / SQL动态SQL</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS328"></a><div class="props_rev_3"><a id="GUID-E605F1D2-71F2-43A4-A20F-794AC9EAEDFD" name="GUID-E605F1D2-71F2-43A4-A20F-794AC9EAEDFD"></a><h4 id="ADFNS-GUID-E605F1D2-71F2-43A4-A20F-794AC9EAEDFD" class="sect4">创建子程序和包所需的权限</h4>
                  <div>
                     <p>要在您自己的模式中创建独立的子程序或包，您必须具有<code class="codeph">CREATE</code> <code class="codeph">PROCEDURE</code>系统特权。要在另一个模式中创建独立的子程序或包，您必须具有<code class="codeph">CREATE</code> <code class="codeph">ANY</code> <code class="codeph">PROCEDURE</code>系统特权。
                     </p>
                     <p>如果您创建的子程序或包引用了架构对象，则必须具有这些对象的必要对象权限。必须明确授予您这些权限，而不是通过角色。</p>
                     <p>如果子程序或包的所有者的权限发生更改，则子程序或包必须在运行之前重新进行身份验证。如果从子程序或包的所有者撤消对引用对象的必需对象权限，则子程序无法运行。</p>
                     <p>授予子程序的<code class="codeph">EXECUTE</code>特权允许用户在子程序所有者的安全域下运行该子程序，这样就不需要为用户授予子程序引用的对象的权限。<code class="codeph">EXECUTE</code>特权为数据库应用程序及其用户提供了更加严格和有效的安全策略。此外，它允许子程序和包存储在数据字典中（在<code class="codeph">SYSTEM</code>表空间中），其中没有配额控制创建子程序和包的用户可用的空间量。
                     </p>
                     <div class="infoboxnotealso" id="GUID-E605F1D2-71F2-43A4-A20F-794AC9EAEDFD__GUID-F9D240EC-0598-4346-945C-BDB9327B41E2">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关系统和对象权限的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=SQLRF01603" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-C898484A-4592-44F6-875D-C83B30E1DDAA">调用存储的PL / SQL子程序</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADFNS327"></a><div class="props_rev_3"><a id="GUID-50BE2CE8-D203-4540-A1B4-72B13B42910C" name="GUID-50BE2CE8-D203-4540-A1B4-72B13B42910C"></a><h4 id="ADFNS-GUID-50BE2CE8-D203-4540-A1B4-72B13B42910C" class="sect4">创建子程序和包</h4>
                  <div>
                     <div class="section">
                        <p>本主题说明如何使用SQL数据定义语言（DDL）语句创建独立子程序和包。</p>
                        <p>用于创建独立子程序和包的DDL语句是：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">CREATE</code> <code class="codeph">FUNCTION</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">CREATE</code> <code class="codeph">PROCEDURE</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">CREATE</code> <code class="codeph">PACKAGE</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">CREATE</code> <code class="codeph">PACKAGE</code> <code class="codeph">BODY</code></p>
                              <p>包的名称及其公共对象的名称在包模式中必须是唯一的。包规范和正文必须具有相同的名称。除了重载的子程序之外，包构造必须在包的范围内具有唯一的名称。</p>
                           </li>
                        </ul>
                        <p>前面的每个<code class="codeph">CREATE</code>语句都有一个可选的<code class="codeph">OR</code> <code class="codeph">REPLACE</code>子句。指定<code class="codeph">OR</code> <code class="codeph">REPLACE</code>以重新创建现有PL / SQL单元 - 即更改其声明或定义而不删除它，重新创建它，以及重新授予先前在其上授予的对象权限。如果重新定义PL / SQL单元，数据库将重新编译它。
                        </p>
                        <div class="infoboxnote" id="GUID-50BE2CE8-D203-4540-A1B4-72B13B42910C__GUID-9F6B43E3-B55B-4733-8CF4-93A30E1C0ED3">
                           <p class="notep1">警告：</p>
                           <p>在替换现有PL / SQL单元之前， <code class="codeph">CREATE</code> <code class="codeph">OR</code> <code class="codeph">REPLACE</code>语句不会发出警告。
                           </p>
                        </div>
                        <p>使用任何文本编辑器，创建一个包含DDL语句的文本文件，以创建任意数量的子程序和包。</p>
                        <p>要运行DDL语句，请使用SQL * Plus等交互式工具。SQL * Plus命令<code class="codeph">START</code>或@运行脚本。例如，此SQL * Plus命令运行脚本<code class="codeph">my_app.sql</code> ：</p><pre class="oac_no_warn" dir="ltr">@my_app</pre><p>或者，您可以使用SQL Developer创建和运行DDL语句。</p>
                        <div class="infoboxnotealso" id="GUID-50BE2CE8-D203-4540-A1B4-72B13B42910C__GUID-AAF8AD03-FD1F-4AF9-A6E1-611B609AB622">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关在SQL * Plus中运行脚本的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=SQPUG015" target="_blank"><span class="italic">SQL * Plus用户指南和参考</span></a></p>
                              </li>
                              <li>
                                 <p>有关SQL Developer的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=RPTUG-GUID-464C045C-FBDF-417A-A20B-037D294B3BDA" target="_blank"><span><cite>“Oracle SQL Developer用户指南”</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关以下功能的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS-GUID-2FBCFBBE-6B42-4DB8-83F3-55B63B75B1EB" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                                 <div class="p">
                                    <ul style="list-style-type:disc">
                                       <li>
                                          <p><code class="codeph">CREATE</code> <code class="codeph">FUNCTION</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">CREATE</code> <code class="codeph">PROCEDURE</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">CREATE</code> <code class="codeph">PACKAGE</code></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">CREATE</code> <code class="codeph">PACKAGE</code> <code class="codeph">BODY</code></p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS336"></a><div class="props_rev_3"><a id="GUID-BB9E57B9-5A98-4CCA-A886-E84044C41752" name="GUID-BB9E57B9-5A98-4CCA-A886-E84044C41752"></a><h4 id="ADFNS-GUID-BB9E57B9-5A98-4CCA-A886-E84044C41752" class="sect4">PL / SQL对象大小限制</h4>
                  <div>
                     <p>PL / SQL存储的数据库对象（如子程序，触发器和包）的大小限制是共享池中Ada（DIANA）代码的描述性中间属性表示法的大小（以字节为单位）。Linux和UNIX对扁平DIANA /代码大小的限制为64K，但桌面平台上的限制可能为32K。</p>
                     <p>用户可以访问的最密切相关的数字是<code class="codeph">PARSED_SIZE</code> ，静态数据字典视图中的列<code class="codeph">*_OBJECT_SIZE</code> 。 <code class="codeph">PARSED_SIZE</code>列给出了存储在<code class="codeph">SYS.IDL_xxx$</code>表中的DIANA大小（以字节为单位）。这不是共享池中的大小。PL / SQL代码（在编译期间使用）的DIANA部分的大小在共享池中比在系统表中大得多。
                     </p>
                     <div class="infoboxnotealso" id="GUID-BB9E57B9-5A98-4CCA-A886-E84044C41752__GUID-2DA71BE4-E7CD-4CA3-AB01-F1437988A4CF">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关PL / SQL程序限制和<code class="codeph">PARSED_SIZE</code>更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS018" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">*_OBJECT_SIZE</code>信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=REFRN23143" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADFNS1345"></a><a id="ADFNS975"></a><div class="props_rev_3"><a id="GUID-32CE5470-A170-454A-A3E5-1E3EF2D70F96" name="GUID-32CE5470-A170-454A-A3E5-1E3EF2D70F96"></a><h4 id="ADFNS-GUID-32CE5470-A170-454A-A3E5-1E3EF2D70F96" class="sect4">PL / SQL数据类型</h4>
                  <div>
                     <p>本主题介绍PL / SQL数据类型，并参考其他章节或文档以获取更多信息。</p>
                     <p>对数据库应用程序中的每个PL / SQL变量使用正确且最具体的PL / SQL数据类型。</p>
                     <div class="infoboxnotealso" id="GUID-32CE5470-A170-454A-A3E5-1E3EF2D70F96__NOTE-133-CA7FAAFA">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="sql-data-types.html#GUID-868098E7-024A-452D-9CAC-011F364FFA33">使用正确和最具体的数据类型</a></p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-32CE5470-A170-454A-A3E5-1E3EF2D70F96__GUID-2BDD096B-6C18-416A-8A6E-502501A941B8">话题：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-CB5650E9-A386-477B-A49D-F30A10821F76">PL / SQL标量数据类型</a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-5ADF59C6-7B31-402B-916F-A17CBC43BA34">PL / SQL复合数据类型</a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-5BDB686D-13C3-4691-8EC1-39356D07F314">抽象数据类型</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADFNS1208"></a><a id="ADFNS1104"></a><div class="props_rev_3"><a id="GUID-CB5650E9-A386-477B-A49D-F30A10821F76" name="GUID-CB5650E9-A386-477B-A49D-F30A10821F76"></a><h5 id="ADFNS-GUID-CB5650E9-A386-477B-A49D-F30A10821F76" class="sect5">PL / SQL标量数据类型</h5>
                     <div>
                        <p><span class="bold">标量数据类型</span>存储没有内部组件的值。
                        </p>
                        <p>标量数据类型可以具有子类型。<span class="bold">子类型</span>是数据类型，它是另一种数据类型的子集，这是其<span class="bold">基本类型</span> 。子类型与其基本类型具有相同的有效操作。数据类型及其子类型包括<span class="bold">数据类型族</span> 。
                        </p>
                        <p>PL / SQL在包<code class="codeph">STANDARD</code>预定义了许多类型和子类型，并允许您定义自己的子类型。
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-CB5650E9-A386-477B-A49D-F30A10821F76__GUID-BA22B303-EB19-492A-8A78-2856A2CDE6A9">话题：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="coding-subprograms-and-packages.html#GUID-0727699E-567B-4D41-8171-A587465B74FA">SQL数据类型</a></p>
                              </li>
                              <li>
                                 <p><a href="coding-subprograms-and-packages.html#GUID-85A8D1FE-A8AC-4200-94C1-0B44671A35F5">BOOLEAN数据类型</a></p>
                              </li>
                              <li>
                                 <p><a href="coding-subprograms-and-packages.html#GUID-3950315C-B55C-4BD0-ADA6-BBEF2184B4A6">PLS_INTEGER和BINARY_INTEGER数据类型</a></p>
                              </li>
                              <li>
                                 <p><a href="coding-subprograms-and-packages.html#GUID-C73CB1E0-15BE-449E-866E-7879D3699A7D">REF CURSOR数据类型</a></p>
                              </li>
                              <li>
                                 <p><a href="coding-subprograms-and-packages.html#GUID-A95F2E40-8D7D-489C-91CA-B4E8A647CF25">用户定义的PL / SQL子类型</a></p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-CB5650E9-A386-477B-A49D-F30A10821F76__GUID-17B712DE-456E-4F0C-8F5F-7F8831163757">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS003" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考，</span></a>用于标量PL / SQL数据类型的完整描述</p>
                                 </li>
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS2163" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考，</span></a>用于按数据类型系列分组的预定义PL / SQL数据类型和子类型</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div><a id="ADFNS987"></a><a id="ADFNS1209"></a><a id="ADFNS0002"></a><div class="props_rev_3"><a id="GUID-0727699E-567B-4D41-8171-A587465B74FA" name="GUID-0727699E-567B-4D41-8171-A587465B74FA"></a><h6 id="ADFNS-GUID-0727699E-567B-4D41-8171-A587465B74FA" class="sect6">SQL数据类型</h6>
                        <div>
                           <p>PL / SQL数据类型包括SQL数据类型。</p>
                           <div class="infoboxnotealso" id="GUID-0727699E-567B-4D41-8171-A587465B74FA__NOTE-123-CA802033">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="sql-data-types.html#GUID-9EC05CBD-6D83-436F-B532-556DFD5FC4F2">使用数据库应用程序中的SQL数据类型</a>获取有关如何在数据库应用程序中使用SQL数据类型的信息</p>
                                 </li>
                                 <li>
                                    <p>有关SQL数据类型的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS286" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div><a id="ADFNS1210"></a><div class="props_rev_3"><a id="GUID-85A8D1FE-A8AC-4200-94C1-0B44671A35F5" name="GUID-85A8D1FE-A8AC-4200-94C1-0B44671A35F5"></a><h6 id="ADFNS-GUID-85A8D1FE-A8AC-4200-94C1-0B44671A35F5" class="sect6">BOOLEAN数据类型</h6>
                        <div>
                           <p><code class="codeph">BOOLEAN</code>数据类型存储<span class="bold">逻辑值</span> ，布尔值为<code class="codeph">TRUE</code>和<code class="codeph">FALSE</code> ，值为<code class="codeph">NULL</code> 。 <code class="codeph">NULL</code>表示未知值。
                           </p>
                           <div class="infoboxnotealso" id="GUID-85A8D1FE-A8AC-4200-94C1-0B44671A35F5__NOTE-132-CA80E81C">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">BOOLEAN</code>数据类型的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS348" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </div>
                        </div>
                     </div><a id="ADFNS1211"></a><div class="props_rev_3"><a id="GUID-3950315C-B55C-4BD0-ADA6-BBEF2184B4A6" name="GUID-3950315C-B55C-4BD0-ADA6-BBEF2184B4A6"></a><h6 id="ADFNS-GUID-3950315C-B55C-4BD0-ADA6-BBEF2184B4A6" class="sect6">PLS_INTEGER和BINARY_INTEGER数据类型</h6>
                        <div>
                           <p>PL / SQL数据类型<code class="codeph">PLS_INTEGER</code>和<code class="codeph">BINARY_INTEGER</code>是相同的。为简单起见，本指南使用<code class="codeph">PLS_INTEGER</code>表示<code class="codeph">PLS_INTEGER</code>和<code class="codeph">BINARY_INTEGER</code> 。</p>
                           <p><code class="codeph">PLS_INTEGER</code>数据类型存储-2,147,483,648到2,147,483,647范围内的有符号整数，以32位表示。
                           </p>
                           <p>与<code class="codeph">NUMBER</code>数据类型和<code class="codeph">NUMBER</code>子类型相比， <code class="codeph">PLS_INTEGER</code>数据类型具有以下优势：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">PLS_INTEGER</code>值需要较少的存储空间。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">PLS_INTEGER</code>操作使用硬件算法，因此它们比使用库算术的<code class="codeph">NUMBER</code>操作更快。
                                 </p>
                              </li>
                           </ul>
                           <p>为了提高效率，请对其范围内的所有计算使用<code class="codeph">PLS_INTEGER</code>值。
                           </p>
                           <div class="infoboxnotealso" id="GUID-3950315C-B55C-4BD0-ADA6-BBEF2184B4A6__NOTE-136-CA817609">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">PLS_INTEGER</code>数据类型的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS319" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </div>
                        </div>
                     </div><a id="ADFNS1316"></a><div class="props_rev_3"><a id="GUID-C73CB1E0-15BE-449E-866E-7879D3699A7D" name="GUID-C73CB1E0-15BE-449E-866E-7879D3699A7D"></a><h6 id="ADFNS-GUID-C73CB1E0-15BE-449E-866E-7879D3699A7D" class="sect6">REF CURSOR数据类型</h6>
                        <div>
                           <p><code class="codeph">REF</code> <code class="codeph">CURSOR</code>是游标变量的数据类型。
                           </p>
                           <p><span class="bold">游标变量</span>类似于显式游标，但以下情况除外：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>它不仅限于一个查询。</p>
                                 <p>您可以打开查询的游标变量，处理结果集，然后将游标变量用于另一个查询。</p>
                              </li>
                              <li>
                                 <p>您可以为其分配值。</p>
                              </li>
                              <li>
                                 <p>您可以在表达式中使用它。</p>
                              </li>
                              <li>
                                 <p>它可以是子程序参数。</p>
                                 <p>您可以使用游标变量在子程序之间传递查询结果集。</p>
                              </li>
                              <li>
                                 <p>它可以是宿主变量。</p>
                                 <p>您可以使用游标变量在PL / SQL存储的子程序与其客户端之间传递查询结果集。</p>
                              </li>
                              <li>
                                 <p>它不能接受参数。</p>
                                 <p>您不能将参数传递给游标变量，但可以将整个查询传递给它。</p>
                              </li>
                           </ul>
                           <p>游标变量具有这种灵活性，因为它是一个指针;也就是说，它的值是项目的地址，而不是项目本身。</p>
                           <div class="infoboxnotealso" id="GUID-C73CB1E0-15BE-449E-866E-7879D3699A7D__NOTE-135-CA819974">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">REF</code> <code class="codeph">CURSOR</code>数据类型和游标变量的更多信息，请<a href="../lnpls/static-sql.html#LNPLS00605" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </div>
                        </div>
                     </div><a id="ADFNS1317"></a><div class="props_rev_3"><a id="GUID-A95F2E40-8D7D-489C-91CA-B4E8A647CF25" name="GUID-A95F2E40-8D7D-489C-91CA-B4E8A647CF25"></a><h6 id="ADFNS-GUID-A95F2E40-8D7D-489C-91CA-B4E8A647CF25" class="sect6">用户定义的PL / SQL子类型</h6>
                        <div>
                           <p>PL / SQL允许您定义自己的子类型。基类型可以是任何标量PL / SQL类型，包括先前定义的用户定义子类型。</p>
                           <p>子类型可以：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>提供与ANSI / ISO数据类型的兼容性</p>
                              </li>
                              <li>
                                 <p>显示该类型数据项的预期用途</p>
                              </li>
                              <li>
                                 <p>检测超出范围的值</p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-A95F2E40-8D7D-489C-91CA-B4E8A647CF25__NOTE-134-CA81C96E">
                              <p class="notep1">也可以看看：</p>
                              <p>有关用户定义的PL / SQL子类型的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS99935" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="ADFNS1318"></a><div class="props_rev_3"><a id="GUID-5ADF59C6-7B31-402B-916F-A17CBC43BA34" name="GUID-5ADF59C6-7B31-402B-916F-A17CBC43BA34"></a><h5 id="ADFNS-GUID-5ADF59C6-7B31-402B-916F-A17CBC43BA34" class="sect5">PL / SQL复合数据类型</h5>
                     <div>
                        <p><span class="bold">复合数据类型</span>具有内部组件。PL / SQL复合数据类型是集合和记录。
                        </p>
                        <p>在<span class="bold">集合中</span> ，内部组件始终具有相同的数据类型，并且称为<span class="bold">元素</span> 。您可以通过其唯一索引访问集合变量的每个元素。PL / SQL有三种集合类型 - 关联数组， <code class="codeph">VARRAY</code> （可变大小数组）和嵌套表。
                        </p>
                        <p>在<span class="bold">记录中</span> ，内部组件可以具有不同的数据类型，并且称为<span class="bold">字段</span> 。您可以按名称访问记录变量的每个字段。
                        </p>
                        <p>您可以创建记录集合以及包含集合的记录。</p>
                        <div class="infoboxnotealso" id="GUID-5ADF59C6-7B31-402B-916F-A17CBC43BA34__NOTE-135-CA8252A4">
                           <p class="notep1">也可以看看：</p>
                           <p>有关PL / SQL组合数据类型的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS005" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </div>
                     </div>
                  </div><a id="ADFNS1323"></a><div class="props_rev_3"><a id="GUID-5BDB686D-13C3-4691-8EC1-39356D07F314" name="GUID-5BDB686D-13C3-4691-8EC1-39356D07F314"></a><h5 id="ADFNS-GUID-5BDB686D-13C3-4691-8EC1-39356D07F314" class="sect5">抽象数据类型</h5>
                     <div>
                        <p>抽象数据类型（ADT）由数据结构和操纵数据的子程序组成。在静态数据字典视图<code class="codeph">*_OBJECTS</code> ，所述<code class="codeph">OBJECT_TYPE</code>一个ADT的是<code class="codeph">TYPE</code> 。在静态数据字典视图<code class="codeph">*_TYPES</code> ，ADT的<code class="codeph">TYPECODE</code>是<code class="codeph">OBJECT</code> 。</p>
                        <div class="infoboxnotealso" id="GUID-5BDB686D-13C3-4691-8EC1-39356D07F314__FORMOREINFORMATIONABOUTADTSSEEORACL-CA832B17">
                           <p class="notep1">也可以看看：</p>
                           <p>有关ADT的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS163" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="ADFNS1034"></a><a id="ADFNS00903"></a><div class="props_rev_3"><a id="GUID-02AD5C8B-C803-4A4A-AF0F-BE87AB66ADF2" name="GUID-02AD5C8B-C803-4A4A-AF0F-BE87AB66ADF2"></a><h4 id="ADFNS-GUID-02AD5C8B-C803-4A4A-AF0F-BE87AB66ADF2" class="sect4">将结果集返回给客户端</h4>
                  <div>
                     <div class="section">
                        <p>在PL / SQL中，与传统的数据库编程一样，您使用游标来处理查询结果集。<span class="bold">游标</span>是指向私有SQL区域的指针，该区域存储有关处理特定<code class="codeph">SELECT</code>或DML语句的信息。
                        </p>
                        <div class="infoboxnote" id="GUID-02AD5C8B-C803-4A4A-AF0F-BE87AB66ADF2__GUID-FCFAFDFC-CBEC-4CA1-85AF-80EF46CDEBE7">
                           <p class="notep1">注意：</p>
                           <p>本节讨论的游标是会话游标。<span class="bold">会话游标</span>位于会话内存中，直到会话结束，此时它不再存在。会话游标与程序全局区域（PGA）的私有SQL区域中的游标不同。
                           </p>
                        </div>
                        <p>由PL / SQL构造和管理的<span class="bold">游标</span>是<span class="bold">隐式游标</span> 。您构造和管理的<span class="bold">游标</span>是<span class="bold">显式游标</span> 。显式游标优于隐式游标的唯一优点是，使用显式游标，可以限制获取的行数。
                        </p>
                        <p><span class="bold">游标变量</span>是指向游标的指针。也就是说，它的值是游标的地址，而不是游标本身。因此，游标变量比显式游标具有更大的灵活性。但是，游标变量也具有显式游标不具有的成本。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-02AD5C8B-C803-4A4A-AF0F-BE87AB66ADF2__GUID-B1A28F23-A99A-4854-9B56-66845FD28CFA">话题：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-AF17F2B9-0A52-45F1-AC79-D2D7B90D240A">游标变量的优点</a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-DC5BA056-14C7-45B1-A145-091618CEDA56">游标变量的缺点</a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-0C7A9F09-7626-4EB2-948C-14BF002803EB">隐含地返回查询结果</a></p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-02AD5C8B-C803-4A4A-AF0F-BE87AB66ADF2__GUID-1301F66C-6EF9-4368-BB83-743FCF96281D">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS00605" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a>有关游标变量的一般信息，以及使用隐式和显式游标的查询集结果处理</p>
                              </li>
                              <li>
                                 <p>有关如何限制批量收集语句中的行数和集合大小的详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS00602" target="_blank"><span class="italic">Oracle数据库PL / SQL语言参考</span></a></p>
                              </li>
                              <li>
                                 <p>有关在OCI中使用游标变量的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNOCI16367" target="_blank"><span class="italic">“Oracle调用接口程序员指南”</span></a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPCC3218" target="_blank"><span class="italic">Pro * C / C ++程序员指南</span></a> ，了解有关在Pro * C / C ++中使用游标变量的信息</p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPCB371" target="_blank"><span class="italic">Pro * COBOL程序员指南</span></a> ，了解有关在Pro * COBOL中使用游标变量的信息</p>
                              </li>
                              <li>
                                 <p>有关在JDBC中使用游标变量的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDBC28151" target="_blank"><span class="italic">“Oracle数据库JDBC开发人员指南”</span></a></p>
                              </li>
                              <li>
                                 <p><a href="coding-subprograms-and-packages.html#GUID-A6887963-BE8C-4407-B5E4-68746E31A166">从函数返回大量数据</a></p>
                              </li>
                              <li>
                                 <p>有关PGA的更多信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=CNCPT1239" target="_blank"><span class="italic">Oracle数据库概念</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADFNS159"></a><div class="props_rev_3"><a id="GUID-AF17F2B9-0A52-45F1-AC79-D2D7B90D240A" name="GUID-AF17F2B9-0A52-45F1-AC79-D2D7B90D240A"></a><h5 id="ADFNS-GUID-AF17F2B9-0A52-45F1-AC79-D2D7B90D240A" class="sect5">游标变量的优点</h5>
                     <div>
                        <p>游标变量类似于显式游标，除了：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>它不仅限于一个查询。</p>
                              <p>您可以打开查询的游标变量，处理结果集，然后将游标变量用于另一个查询。</p>
                           </li>
                           <li>
                              <p>您可以为其分配值。</p>
                           </li>
                           <li>
                              <p>您可以在表达式中使用它。</p>
                           </li>
                           <li>
                              <p>它可以是子程序参数。</p>
                              <p>您可以使用游标变量在子程序之间传递查询结果集。</p>
                           </li>
                           <li>
                              <p>它可以是宿主变量。</p>
                              <p>您可以使用游标变量在PL / SQL存储的子程序与其客户端之间传递查询结果集。</p>
                           </li>
                           <li>
                              <p>它不能接受参数。</p>
                              <p>您不能将参数传递给游标变量，但可以将整个查询传递给它。查询可以包含变量。</p>
                           </li>
                        </ul>
                        <p>前面的特性赋予游标变量这些优点：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>封装</p>
                              <p>查询集中在打开游标变量的存储子程序中。</p>
                           </li>
                           <li>
                              <p>易于维护</p>
                              <p>如果必须更改光标，则必须仅更改存储的子程序，而不是每个调用存储的子程序的应用程序。</p>
                           </li>
                           <li>
                              <p>安全方便</p>
                              <p>应用程序使用应用程序用户的用户名连接到服务器。应用程序用户必须对打开游标的存储子程序具有<code class="codeph">EXECUTE</code>权限，但不需要对查询表具有<code class="codeph">READ</code>权限。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="ADFNS176"></a><a id="ADFNS160"></a><div class="props_rev_3"><a id="GUID-DC5BA056-14C7-45B1-A145-091618CEDA56" name="GUID-DC5BA056-14C7-45B1-A145-091618CEDA56"></a><h5 id="ADFNS-GUID-DC5BA056-14C7-45B1-A145-091618CEDA56" class="sect5">游标变量的缺点</h5>
                     <div>
                        <p>如果不需要使用游标变量，则使用隐式或显式游标，以获得更好的性能和编程的简易性。</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-DC5BA056-14C7-45B1-A145-091618CEDA56__GUID-C430C599-2DC4-4FD5-A556-83238D1C7E56">话题：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="coding-subprograms-and-packages.html#GUID-18ADFDA2-10D5-4AEB-9BB6-BBB2C37092C7">解析游标变量的惩罚</a></p>
                              </li>
                              <li>
                                 <p><a href="coding-subprograms-and-packages.html#GUID-DCCFD17D-2086-4F08-A1DF-4632DBACA3B7">游标变量的多行获取惩罚</a></p>
                              </li>
                           </ul>
                           <div class="infoboxnote" id="GUID-DC5BA056-14C7-45B1-A145-091618CEDA56__GUID-81B8BB9E-0F26-4284-986E-7E6083072E0A">
                              <p class="notep1">注意：</p>
                              <p>这些主题中的示例包括<code class="codeph">TKPROF</code>报告。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-DC5BA056-14C7-45B1-A145-091618CEDA56__NOTE-1333-CAB82171">
                              <p class="notep1">也可以看看：</p>
                              <p>有关生成<code class="codeph">TKPROF</code>报告的说明，请<code class="codeph">TKPROF</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=TGSQL809" target="_blank"><span class="italic">“Oracle数据库SQL调优指南”</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div><a id="ADFNS178"></a><a id="ADFNS177"></a><div class="props_rev_3"><a id="GUID-18ADFDA2-10D5-4AEB-9BB6-BBB2C37092C7" name="GUID-18ADFDA2-10D5-4AEB-9BB6-BBB2C37092C7"></a><h6 id="ADFNS-GUID-18ADFDA2-10D5-4AEB-9BB6-BBB2C37092C7" class="sect6">解析游标变量的惩罚</h6>
                        <div>
                           <p>当你关闭一个显式游标时，光标会从你的角度关闭 - 也就是说，你不能在需要打开游标的地方使用它 - 但是PL / SQL将显式游标缓存在打开状态。如果重新执行与游标关联的语句，则PL / SQL将使用缓存的游标，从而避免解析。</p>
                           <p>避免解析可以显着减少CPU使用，并且显式游标的缓存对您来说是透明的;它不会影响你的编程。PL / SQL不会减少可用的打开游标的供应。如果你的程序必须打开另一个游标但是这样做会超过<code class="codeph">OPEN_CURSORS</code>的init.ora设置，那么PL / SQL会关闭缓存的游标。
                           </p>
                           <p>PL / SQL无法将游标变量缓存在打开状态。因此，游标变量具有解析惩罚。</p>
                           <p>在<a href="coding-subprograms-and-packages.html#GUID-18ADFDA2-10D5-4AEB-9BB6-BBB2C37092C7__BABJIJBE">例13-2中</a> ，过程打开，从中获取并关闭显式游标，然后对游标变量执行相同操作。匿名块调用该过程10次。<code class="codeph">TKPROF</code>报告显示两个查询都运行了10次，但与显式游标关联的查询仅解析了一次，而与游标变量关联的查询被解析了10次。
                           </p>
                           <div class="example" id="GUID-18ADFDA2-10D5-4AEB-9BB6-BBB2C37092C7__BABJIJBE">
                              <p class="titleinexample">例13-2解析游标变量的惩罚</p><pre class="oac_no_warn" dir="ltr">创建或替换程序p AUTHID DEFINER是CURSOR e_c IS <span class="bold">SELECT * FROM DUAL d1</span> ; - <span class="bold">显式游标</span> c_v SYS_REFCURSOR; - <span class="bold">游标变量</span> rec DUAL％ROWTYPE;开始开放e_c; - <span class="bold">显式游标</span> FETCH e_c INTO rec;关闭e_c; OPEN c_v FOR <span class="bold">SELECT * FROM DUAL d2</span> ; - <span class="bold">游标变量</span> FETCH c_v INTO rec;关闭c_v;结束; /开始为i IN 1..10循环 - 执行p 10次p;结束循环;</pre><p><code class="codeph">TKPROF</code>报告类似于：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">SELECT * FROM DUAL D1;</span>通话次数------- ------ <span class="bold">解析</span> <span class="bold">1</span>执行10次取10 ------- ------总计<span class="bold">21</span> ************** ** <span class="bold">SELECT * FROM DUAL D2;</span>通话次数------- ------ <span class="bold">解析</span> <span class="bold">10</span>执行10次提取10 ------- ------共<span class="bold">30次</span></pre></div>
                           <!-- class="example" -->
                        </div>
                     </div><a id="ADFNS217"></a><a id="ADFNS215"></a><div class="props_rev_3"><a id="GUID-DCCFD17D-2086-4F08-A1DF-4632DBACA3B7" name="GUID-DCCFD17D-2086-4F08-A1DF-4632DBACA3B7"></a><h6 id="ADFNS-GUID-DCCFD17D-2086-4F08-A1DF-4632DBACA3B7" class="sect6">游标变量的多行获取惩罚</h6>
                        <div>
                           <p><a href="coding-subprograms-and-packages.html#GUID-DCCFD17D-2086-4F08-A1DF-4632DBACA3B7__BABEBAJF">例13-3</a>创建一个包含7,000多行的表，并将所有这些行两次读取，首先使用隐式游标（获取数组），然后使用游标变量（获取单个行）。隐式游标的代码比游标变量的代码简单， <code class="codeph">TKPROF</code>报告显示它也表现得更好。
                           </p>
                           <p>虽然您可以使用游标变量来获取数组，但您需要更多代码。具体来说，您需要代码来执行以下操作：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>定义要获取阵列的集合的类型</p>
                              </li>
                              <li>
                                 <p>明确批量收集到集合中</p>
                              </li>
                              <li>
                                 <p>遍历集合以处理获取的数据</p>
                              </li>
                              <li>
                                 <p>关闭显式打开的游标变量</p>
                              </li>
                           </ul>
                           <div class="example" id="GUID-DCCFD17D-2086-4F08-A1DF-4632DBACA3B7__BABEBAJF">
                              <p class="titleinexample">例13-3对于游标变量的数组获取惩罚</p>
                              <p>创建表以查询并显示其行数：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE t AS SELECT * FROM ALL_OBJECTS; SELECT COUNT（*）FROM t;</pre><p>结果类似于：</p><pre class="oac_no_warn" dir="ltr">COUNT（*）---------- 70788</pre><p>使用隐式游标和游标变量执行等效操作：</p><pre class="oac_no_warn" dir="ltr">DECLARE c_v SYS_REFCURSOR; rec t％ROWTYPE; BEGIN FOR x IN（ <span class="bold">SELECT * FROM t exp_cur</span> ）LOOP  - <span class="bold">隐式游标</span> NULL;结束循环;打开c_v FOR <span class="bold">SELECT * FROM t cur_var</span> ; - <span class="bold">游标变量</span> LOOP FETCH c_v INTO rec;退出时c_v％NOTFOUND;结束循环;关闭c_v;结束; /</pre><p><code class="codeph">TKPROF</code>报告类似于：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">SELECT * FROM T EXP_CUR</span>调用count cpu经过磁盘查询当前行------- ------ -------- ---------- ------ ---- ---------- ---------- ---------- Parse 1 0.00 0.00 0 0 0 0执行1 0.00 0.00 0 0 0 0 <span class="bold">取722</span> 0.23 0.23 0 <span class="bold">1748</span> 0 <span class="bold">72198</span> ------- ------ -------- ---------- ----------  - --------- ---------- ----------总计724 0.23 0.23 0 1748 0 72198 ************* ************************************************** ***************** <span class="bold">SELECT * FROM T CUR_VAR</span>调用count cpu经过磁盘查询当前行------- ------ ------- -  ---------- ---------- ---------- ---------- --------- -  Parse 1 0.00 0.00 0 0 0 0执行1 0.00 0.00 0 0 0 0 <span class="bold">Fetch 72199</span> 0.40 0.42 0 <span class="bold">72203</span> 0 <span class="bold">72198</span> ------- ------ -------- ---- ------ ---------- ---------- ---------- ----------总计72201 0.40 0.42 0 72203 0 72198</pre></div>
                           <!-- class="example" -->
                        </div>
                     </div>
                  </div><a id="ADFNS1035"></a><div class="props_rev_3"><a id="GUID-0C7A9F09-7626-4EB2-948C-14BF002803EB" name="GUID-0C7A9F09-7626-4EB2-948C-14BF002803EB"></a><h5 id="ADFNS-GUID-0C7A9F09-7626-4EB2-948C-14BF002803EB" class="sect5">隐含地返回查询结果</h5>
                     <div>
                        <div class="section">
                           <p>存储的子程序可以通过调用<code class="codeph">DBMS_SQL</code>将查询结果隐式返回给客户端程序或子程序的直接调用者。 <code class="codeph">RETURN_RESULT</code>程序。在<code class="codeph">DBMS_SQL</code>之后。 <code class="codeph">RETURN_RESULT</code>返回结果，只有收件人才能访问它。
                           </p>
                           <div class="infoboxnote" id="GUID-0C7A9F09-7626-4EB2-948C-14BF002803EB__GUID-19E1938F-37CA-47C4-87A0-519F710403B0">
                              <p class="notep1">注意：</p>
                              <p>要隐式返回使用动态SQL执行的查询的结果，子程序必须使用<code class="codeph">DBMS_SQL</code>过程而不是<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句执行查询。其原因是，该光标<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句返回到子程序时关闭<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句完成。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-0C7A9F09-7626-4EB2-948C-14BF002803EB__NOTE-1314-CAB834F0">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">DBMS_SQL</code>更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS2174" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a> 。 <code class="codeph">RETURN_RESULT</code>程序</p>
                                 </li>
                                 <li>
                                    <p>有关使用<code class="codeph">DBMS_SQL</code>过程进行动态SQL的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS01108" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="ADFNS00909"></a><div class="props_rev_3"><a id="GUID-A6887963-BE8C-4407-B5E4-68746E31A166" name="GUID-A6887963-BE8C-4407-B5E4-68746E31A166"></a><h4 id="ADFNS-GUID-A6887963-BE8C-4407-B5E4-68746E31A166" class="sect4">从函数返回大量数据</h4>
                  <div>
                     <div class="section">
                        <p>在数据仓库环境中，您可以使用PL / SQL函数来转换大量数据。您可以通过一系列转换传递数据，每个转换由不同的函数执行。PL / SQL表函数允许您执行此类转换，而不会产生大量内存开销，或者需要在每个转换阶段之间将数据存储在表中。这些函数可以接受和返回多行，可以在准备就绪时返回行，而不是一次性返回行，并且可以并行化。</p>
                        <div class="infoboxnotealso" id="GUID-A6887963-BE8C-4407-B5E4-68746E31A166__GUID-49F58F21-0A6D-4B68-AACE-910961D23D9E">
                           <p class="notep1">也可以看看：</p>
                           <p>有关使用流水线表函数执行多个转换的更多信息，请<a href="../lnpls/plsql-optimization-and-tuning.html#LNPLS01210" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="ADFNS333"></a><div class="props_rev_3"><a id="GUID-F9C263DB-7843-4CB8-B7D8-E409E38939A4" name="GUID-F9C263DB-7843-4CB8-B7D8-E409E38939A4"></a><h4 id="ADFNS-GUID-F9C263DB-7843-4CB8-B7D8-E409E38939A4" class="sect4">PL / SQL函数结果缓存</h4>
                  <div>
                     <p>使用PL / SQL函数结果缓存可以节省大量的空间和时间。每次使用不同的参数值调用结果缓存的PL / SQL函数时，这些参数及其结果都存储在缓存中。随后，当使用相同的参数值调用相同的函数时，将从缓存中检索结果，而不是重新计算。由于缓存存储在共享全局区域（SGA）中，因此它可用于运行应用程序的任何会话。</p>
                     <p>如果更新了用于计算缓存结果的数据库对象，则缓存的结果将变为无效，必须重新计算。</p>
                     <p>结果缓存的最佳候选者是经常调用的函数，但依赖于不经常更改或从不更改的信息。</p>
                     <div class="infoboxnotealso" id="GUID-F9C263DB-7843-4CB8-B7D8-E409E38939A4__NOTE-134-CAB88EBF">
                        <p class="notep1">也可以看看：</p>
                        <p>有关PL / SQL函数结果缓存的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS00817" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                     </div>
                  </div>
               </div><a id="ADFNS1055"></a><a id="ADFNS343"></a><div class="props_rev_3"><a id="GUID-7C76F50E-2DF7-4D46-BAD1-A46FAFA9A65A" name="GUID-7C76F50E-2DF7-4D46-BAD1-A46FAFA9A65A"></a><h4 id="ADFNS-GUID-7C76F50E-2DF7-4D46-BAD1-A46FAFA9A65A" class="sect4">批量绑定概述</h4>
                  <div>
                     <p>Oracle数据库使用两个引擎来运行PL / SQL单元。PL / SQL引擎运行过程语句，SQL引擎运行SQL语句。每个SQL语句都会导致两个引擎之间的上下文切换。通过最小化每个PL / SQL单元的上下文切换次数，可以极大地提高数据库应用程序的性能。</p>
                     <p>当SQL语句在使用集合元素作为绑定变量的循环内运行时，所需的大量上下文切换会导致性能不佳。收藏包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>关联数组</p>
                        </li>
                        <li>
                           <p>可变大小的数组</p>
                        </li>
                        <li>
                           <p>嵌套表</p>
                        </li>
                        <li>
                           <p>主机阵列</p>
                        </li>
                     </ul>
                     <p><strong class="term">绑定</strong>是在SQL语句中为PL / SQL变量赋值。<strong class="term">批量绑定</strong>一次绑定整个集合。批量绑定在一次操作中传递两个引擎之间的整个集合。
                     </p>
                     <p>通常，批量绑定可提高影响四个或更多数据库行的SQL语句的性能。受SQL语句影响的行越多，批量绑定的性能提升就越大。考虑使用批量绑定来提高引用集合和引用集合并返回DML的<code class="codeph">FOR</code>循环的DML和<code class="codeph">SELECT</code> <code class="codeph">INTO</code>语句的性能。</p>
                     <div class="infoboxnote" id="GUID-7C76F50E-2DF7-4D46-BAD1-A46FAFA9A65A__GUID-E1BF2E17-7B29-4EC4-B55B-9E2E32B8E096">
                        <p class="notep1">注意：</p>
                        <p>使用批量绑定禁用并行DML语句。</p>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-7C76F50E-2DF7-4D46-BAD1-A46FAFA9A65A__GUID-9E9EC32D-13DB-4555-998D-CF3694BC8A34">话题：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-BA80F211-00AB-4238-8E1B-42DEDCE8F9F0">引用集合的DML语句</a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-49868DBC-12CF-4AC7-96A0-EC91AEA55074">引用集合的SELECT语句</a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-36285186-64C9-4074-AF2D-0884D3B8DC49">FOR引用集合和返回DML的循环</a></p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-7C76F50E-2DF7-4D46-BAD1-A46FAFA9A65A__GUID-1BE08EE1-1324-4D02-958D-75EE42FECF05">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关批量绑定的更多信息，包括如何处理批量绑定操作期间发生的异常，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS01205" target="_blank"><span class="italic">Oracle数据库PL / SQL语言参考</span></a></p>
                              </li>
                              <li>
                                 <p>有关并行DML语句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS930" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADFNS346"></a><a id="ADFNS345"></a><div class="props_rev_3"><a id="GUID-BA80F211-00AB-4238-8E1B-42DEDCE8F9F0" name="GUID-BA80F211-00AB-4238-8E1B-42DEDCE8F9F0"></a><h5 id="ADFNS-GUID-BA80F211-00AB-4238-8E1B-42DEDCE8F9F0" class="sect5">引用集合的DML语句</h5>
                     <div>
                        <p>使用<code class="codeph">FORALL</code>关键字的批量绑定可以提高引用集合元素的<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code>语句的性能。
                        </p>
                        <p><a href="coding-subprograms-and-packages.html#GUID-BA80F211-00AB-4238-8E1B-42DEDCE8F9F0__BABDJIJG">示例13-4中</a>的PL / SQL块增加了经理的ID号为7902,7698或7839的员工的工资，有或没有批量绑定。如果没有批量绑定，PL / SQL会为每个更新的员工向SQL引擎发送一条SQL语句，从而导致上下文切换降低性能。
                        </p>
                        <div class="infoboxnotealso" id="GUID-BA80F211-00AB-4238-8E1B-42DEDCE8F9F0__GUID-73CF69B3-3FD7-4D95-90B3-105A578FA8FF">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">FORALL</code>语句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS879" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </div>
                        <div class="example" id="GUID-BA80F211-00AB-4238-8E1B-42DEDCE8F9F0__BABDJIJG">
                           <p class="titleinexample">示例13-4引用集合的DML语句</p><pre class="oac_no_warn" dir="ltr">DECLARE TYPE numlist IS VARRAY（100）OF NUMBER; id NUMLIST：= NUMLIST（7902,7698,7839）; BEGIN <span class="bold">- 使用批量绑定的高效方法：</span> <span class="bold">FORALL</span> i IN id。FIRST..id。最后更新员工SET SALARY = 1.1 * SALARY WHERE MANAGER_ID = id（i）; <span class="bold">- 较慢的方法：</span> <span class="bold">FOR</span> i IN id。FIRST..id。最后一次<span class="bold">循环</span>更新员工设置SALARY = 1.1 * SALARY WHERE MANAGER_ID = id（i）; <span class="bold">结束循环;</span>结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADFNS348"></a><a id="ADFNS347"></a><div class="props_rev_3"><a id="GUID-49868DBC-12CF-4AC7-96A0-EC91AEA55074" name="GUID-49868DBC-12CF-4AC7-96A0-EC91AEA55074"></a><h5 id="ADFNS-GUID-49868DBC-12CF-4AC7-96A0-EC91AEA55074" class="sect5">引用集合的SELECT语句</h5>
                     <div>
                        <p><code class="codeph">BULK</code> <code class="codeph">COLLECT</code>子句可以提高引用集合的查询的性能。您可以将<code class="codeph">BULK</code> <code class="codeph">COLLECT</code>与标量值表或<code class="codeph">%TYPE</code>值表一起使用。
                        </p>
                        <div class="infoboxnotealso" id="GUID-49868DBC-12CF-4AC7-96A0-EC91AEA55074__GUID-48FDFD48-0337-4C4F-BBD4-592FE478CD6B">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">BULK</code> <code class="codeph">COLLECT</code>子句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS891" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </div>
                        <p><a href="coding-subprograms-and-packages.html#GUID-49868DBC-12CF-4AC7-96A0-EC91AEA55074__BABGEDJB">例13-5中</a>的PL / SQL块将多个值查询到PL / SQL表中，包含和不包含批量绑定。如果没有批量绑定，PL / SQL会为每个选定的员工向SQL引擎发送一条SQL语句，从而导致上下文切换降低性能。
                        </p>
                        <div class="example" id="GUID-49868DBC-12CF-4AC7-96A0-EC91AEA55074__BABGEDJB">
                           <p class="titleinexample">示例13-5引用集合的SELECT语句</p><pre class="oac_no_warn" dir="ltr">DECLARE TYPE var_tab是VARCHAR2的表（20）INDEX BY PLS_INTEGER; empno VAR_TAB; en VAR_TAB;柜台号码; CURSOR c是选择EMPLOYEE_ID，LAST_NAME来自员工WHERE MANAGER_ID = 7698; BEGIN <span class="bold">- 高效的方法，使用批量绑定：</span> SELECT EMPLOYEE_ID，LAST_NAME <span class="bold">BULK COLLECT</span> INTO empno，ename FROM EMPLOYEES WHERE MANAGER_ID = 7698; <span class="bold">- 较慢的方法：</span>计数器：= 1; <span class="bold">FOR</span> rec IN c <span class="bold">LOOP</span> empno（counter）：= rec。员工ID; ename（counter）：= rec。姓; counter：= counter + 1; <span class="bold">结束循环;</span>结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="ADFNS350"></a><a id="ADFNS99880"></a><div class="props_rev_3"><a id="GUID-36285186-64C9-4074-AF2D-0884D3B8DC49" name="GUID-36285186-64C9-4074-AF2D-0884D3B8DC49"></a><h5 id="ADFNS-GUID-36285186-64C9-4074-AF2D-0884D3B8DC49" class="sect5">FOR引用集合和返回DML的循环</h5>
                     <div>
                        <p>您可以将<code class="codeph">FORALL</code>关键字与<code class="codeph">BULK</code> <code class="codeph">COLLECT</code>关键字一起使用，以提高引用集合和返回DML的<code class="codeph">FOR</code>循环的性能。</p>
                        <div class="infoboxnotealso" id="GUID-36285186-64C9-4074-AF2D-0884D3B8DC49__GUID-D563DB6B-DB75-482F-864B-6D16206FEF8D">
                           <p class="notep1">也可以看看：</p>
                           <p>有关将<code class="codeph">BULK</code> <code class="codeph">COLLECT</code>子句与<code class="codeph">RETURNING</code> <code class="codeph">INTO</code>子句一起使用的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS899" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </div>
                        <p><a href="coding-subprograms-and-packages.html#GUID-36285186-64C9-4074-AF2D-0884D3B8DC49__BABIBDGI">例13-6中</a>的PL / SQL块通过计算员工集合的奖金来更新<code class="codeph">EMPLOYEES</code>表。然后它返回名为<code class="codeph">bonus_list_inst</code>的列中的奖金。使用和不使用批量绑定执行操作。如果没有批量绑定，PL / SQL会为每个更新的员工向SQL引擎发送一条SQL语句，从而导致上下文切换降低性能。
                        </p>
                        <div class="example" id="GUID-36285186-64C9-4074-AF2D-0884D3B8DC49__BABIBDGI">
                           <p class="titleinexample">示例13-6 FOR引用集合和返回DML的循环</p><pre class="oac_no_warn" dir="ltr">DECLARE TYPE emp_list是EMPLOYEES.EMPLOYEE_ID％TYPE的VARRAY（100）; empids emp_list：= emp_list（182,187,193,200,204,206）; TYPE bonus_list是员工表.SALARY％TYPE; bonus_list_inst bonus_list;开始<span class="bold">- 使用批量绑定的高效方法：</span> <span class="bold">FORALL</span> i IN empids。FIRST..empids。最后更新员工设置SALARY = 0.1 * SALER，其中EMPLOYEE_ID = empids（i） <span class="bold">返回SALAL BULK收集到bonus_list_inst;</span> - 较慢的方法： <span class="bold">FOR</span> i IN empids。FIRST..empids。最后一次<span class="bold">循环</span>更新员工设置SALARY = 0.1 * SALER，其中EMPLOYEE_ID = empids（i）将<span class="bold">SALARY归还给bonus_list_inst（i）;</span> <span class="bold">结束循环;</span>结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="ADFNS1320"></a><div class="props_rev_3"><a id="GUID-AA03D3E8-BCAB-4146-ABB2-3D727C21EA1E" name="GUID-AA03D3E8-BCAB-4146-ABB2-3D727C21EA1E"></a><h4 id="ADFNS-GUID-AA03D3E8-BCAB-4146-ABB2-3D727C21EA1E" class="sect4">PL / SQL动态SQL</h4>
                  <div>
                     <p><span class="bold">动态SQL</span>是一种用于在运行时生成和运行SQL语句的编程方法。在编写通用和灵活的程序（如动态查询系统），编写必须运行数据库定义语言（DDL）语句的程序时，或者在编译时不知道SQL语句的全文或数字时，它非常有用。其输入和输出变量的数据类型。
                     </p>
                     <p>如果您不需要动态SQL，那么使用静态SQL，它具有以下优点：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>成功编译将验证静态SQL语句是否引用了有效的数据库对象，以及是否具有访问这些对象所需的特权。</p>
                        </li>
                        <li>
                           <p>成功编译会创建架构对象依赖项。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-AA03D3E8-BCAB-4146-ABB2-3D727C21EA1E__NOTE-134-CAB8EF16">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="schema-object-dependency.html#GUID-488AF7D9-EDEB-4589-A503-FDE31CE55B60">了解架构对象依赖关系</a>信息的架构对象依赖关系</p>
                           </li>
                           <li>
                              <p>有关动态SQL的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS011" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关静态SQL的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS006" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="ADFNS329"></a><div class="props_rev_3"><a id="GUID-165E6DFF-2BD3-4A69-A1F1-557F74D4B7C0" name="GUID-165E6DFF-2BD3-4A69-A1F1-557F74D4B7C0"></a><h3 id="ADFNS-GUID-165E6DFF-2BD3-4A69-A1F1-557F74D4B7C0" class="sect3">改变PL / SQL子程序和包</h3>
               <div>
                  <div class="section">
                     <p>要更改存储的独立子程序或包的名称，必须将其删除，然后使用新名称创建它。例如：</p><pre class="oac_no_warn" dir="ltr">CREATE PROCEDURE <span class="bold">p开始为</span>空;结束; / DROP PROCEDURE p / CREATE PROCEDURE <span class="bold">p1</span> IS BEGIN NULL;结束; /</pre><p>要更改存储的独立子程序或包而不更改其名称，可以通过在<code class="codeph">CREATE</code>语句中包含<code class="codeph">OR</code> <code class="codeph">REPLACE</code>将其替换为具有相同名称的新版本。例如：</p><pre class="oac_no_warn" dir="ltr">创建<span class="bold">或替换</span>过程<span class="bold">p1从</span> BMSIN开始DBMS_OUTPUT.PUT_LINE（'你好，世界！“）;结束; /</pre><div class="infoboxnote" id="GUID-165E6DFF-2BD3-4A69-A1F1-557F74D4B7C0__GUID-A1CE0172-E9A2-4DFF-AB7E-79DA834150B4">
                        <p class="notep1">注意：</p>
                        <p><code class="codeph">ALTER</code>语句（例如<code class="codeph">ALTER</code> <code class="codeph">FUNCTION</code> ， <code class="codeph">ALTER</code> <code class="codeph">PROCEDURE</code>和<code class="codeph">ALTER</code> <code class="codeph">PACKAGE</code> ）不会改变现有PL / SQL单元的声明或定义，它们只重新编译单元。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-165E6DFF-2BD3-4A69-A1F1-557F74D4B7C0__NOTE-1316-CAB91EB1">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-BAE76DFB-434F-499A-8D9A-8AB15C36AA40">删除PL / SQL子程序和包</a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">ALTER</code>语句的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS99974" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-49E5AD11-BFCE-4AA5-B309-C86A34502C88" name="GUID-49E5AD11-BFCE-4AA5-B309-C86A34502C88"></a><h3 id="ADFNS-GUID-49E5AD11-BFCE-4AA5-B309-C86A34502C88" class="sect3">弃用包，子程序和类型</h3>
               <div>
                  <p></p>
                  <div class="section">从Oracle Database 12 <span class="italic">c</span>第2版（12.2）开始，您可以使用<code class="codeph">DEPRECATE</code> pragma来通知新接口已弃用或取代包，子程序或类型。编译单元以引用已弃用的元素时，将发出编译警告。要将PL / SQL单元标记为已弃用，请使用<code class="codeph">DEPRECATE</code>编译指示。
                     <div class="infoboxnotealso" id="GUID-49E5AD11-BFCE-4AA5-B309-C86A34502C88__NOTE-1414-CAB9615F">
                        <p class="notep1">也可以看看：</p>
                        <p>有关<code class="codeph">DEPRECATE</code> pragma的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS-GUID-D2DAD89D-C537-4666-A8A7-2836EB77A0E5" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADFNS330"></a><div class="props_rev_3"><a id="GUID-BAE76DFB-434F-499A-8D9A-8AB15C36AA40" name="GUID-BAE76DFB-434F-499A-8D9A-8AB15C36AA40"></a><h3 id="ADFNS-GUID-BAE76DFB-434F-499A-8D9A-8AB15C36AA40" class="sect3">删除PL / SQL子程序和包</h3>
               <div>
                  <div class="section">
                     <p>要删除存储的独立子程序，请使用以下语句：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">DROP</code> <code class="codeph">FUNCTION</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DROP</code> <code class="codeph">PROCEDURE</code></p>
                        </li>
                     </ul>
                     <p>要删除包（规范和正文）或仅<code class="codeph">DROP</code>其正文，请使用<code class="codeph">DROP</code> <code class="codeph">PACKAGE</code>语句。
                     </p>
                     <div class="infoboxnotealso" id="GUID-BAE76DFB-434F-499A-8D9A-8AB15C36AA40__NOTE-1323-CAB99175">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">DROP</code> <code class="codeph">FUNCTION</code>更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS99993" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">DROP</code> <code class="codeph">PROCEDURE</code>更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS99991" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS99992" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> <code class="codeph">DROP</code> <code class="codeph">PACKAGE</code></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADFNS00902"></a><div class="props_rev_3"><a id="GUID-53216323-38DB-4BE4-B2A9-E85DFCCBBB7A" name="GUID-53216323-38DB-4BE4-B2A9-E85DFCCBBB7A"></a><h3 id="ADFNS-GUID-53216323-38DB-4BE4-B2A9-E85DFCCBBB7A" class="sect3">编译本机执行的PL / SQL单元</h3>
               <div>
                  <div class="section">
                     <p>您通常可以通过将PL / SQL单元编译为本机代码（依赖于处理器的系统代码）来加速PL / SQL单元（您自己和Oracle提供的单元），这些代码存储在SYSTEM表空间中。</p>
                     <p>编译为本机代码的PL / SQL单元在所有服务器环境中运行，包括共享服务器配置（以前称为“多线程服务器”）和Oracle Real Application Clusters（Oracle RAC）。</p>
                     <p>是否将PL / SQL单元编译为本机代码取决于您在开发周期中的位置以及PL / SQL单元的作用。</p>
                     <div class="infoboxnote" id="GUID-53216323-38DB-4BE4-B2A9-E85DFCCBBB7A__GUID-C2B31DF5-81D3-4FC0-9372-44F09E174D6F">
                        <p class="notep1">注意：</p>
                        <p>要编译用于本机执行的Java包和类，请使用<code class="codeph">ncomp</code>工具。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-53216323-38DB-4BE4-B2A9-E85DFCCBBB7A__NOTE-1316-CABA503A">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关为本机执行编译PL / SQL单元的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS01209" target="_blank"><span class="italic">参见Oracle数据库PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDEV01200" target="_blank"><span class="italic">Oracle数据库Java开发人员指南</span></a> 
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADFNS1038"></a><a id="ADFNS00906"></a><div class="props_rev_3"><a id="GUID-C898484A-4592-44F6-875D-C83B30E1DDAA" name="GUID-C898484A-4592-44F6-875D-C83B30E1DDAA"></a><h3 id="ADFNS-GUID-C898484A-4592-44F6-875D-C83B30E1DDAA" class="sect3">调用存储的PL / SQL子程序</h3>
               <div>
                  <div class="section">
                     <p>可以从许多不同的环境调用存储的PL / SQL子程序。例如：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>交互式地，使用Oracle数据库工具</p>
                        </li>
                        <li>
                           <p>来自另一个子程序的正文</p>
                        </li>
                        <li>
                           <p>从触发器的主体</p>
                        </li>
                        <li>
                           <p>在应用程序内（例如SQL * Forms或预编译器）</p>
                        </li>
                     </ul>
                     <p>也可以从SQL语句中调用存储的PL / SQL函数（但不是过程）。</p>
                     <p>当您调用另一个用户拥有的子程序时：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您必须在调用中包含所有者的名称。例如：</p><pre class="oac_no_warn" dir="ltr">执行<span class="bold">jdoe</span> 。Fire_emp（1043）;执行<span class="bold">jdoe</span> 。Hire_fire。Fire_emp（1043）;</pre></li>
                        <li>
                           <p>子程序的<code class="codeph">AUTHID</code>属性会影响子程序在运行时发出的SQL语句的名称解析和权限检查。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-C898484A-4592-44F6-875D-C83B30E1DDAA__GUID-5217FDF6-9D5D-4BEA-A7EB-B169660AA8E1">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-445A213F-ED71-49B2-9E7E-852E36762D06">调用存储的子程序所需的权限</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-FECA0AE1-034A-45EB-849A-56761004B54B">从Oracle Tools以交互方式调用子程序</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-A4C492D5-54F8-4A4F-BC52-486A136FFC56">从另一个子程序调用子程序</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-F5F8AD0C-4B45-459D-BBD5-BA8F07E19025">调用远程子程序</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-C898484A-4592-44F6-875D-C83B30E1DDAA__GUID-A176FB40-68F2-4BBA-9569-B36D9D317A74">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">AUTHID</code>属性，子程序调用，参数以及定义者和调用者权限的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS008" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关编码触发器主体的信息，请参阅<a href="../lnpls/CREATE-TRIGGER-statement.html#LNPLS2006" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-C35B709B-EE78-4DB4-9B63-54EB8B4D639F" title="您可以在创建PL / SQL包时使用PRAGMA RESTRICT_REFERENCES子句。">从SQL语句调用存储的PL / SQL函数</a></p>
                           </li>
                           <li>
                              <p>有关从OCI应用程序调用PL / SQL子程序的信息，请参阅<a href="../lnoci/binding-and-defining-in-oci.html#LNOCI16365" target="_blank"><span class="italic">“Oracle调用接口程序员指南”</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPCC3422" target="_blank"><span class="italic">Pro * C / C ++程序员指南</span></a> ，了解从Pro * C / C ++调用PL / SQL子程序的相关信息</p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPCB006" target="_blank"><span class="italic">Pro * COBOL程序员指南</span></a> ，了解从Pro * COBOL调用PL / SQL子程序的相关信息</p>
                           </li>
                           <li>
                              <p>有关从JDBC应用程序调用PL / SQL子程序的信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDBC28076" target="_blank"><span class="italic">“Oracle数据库JDBC开发人员指南”</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS370"></a><div class="props_rev_3"><a id="GUID-445A213F-ED71-49B2-9E7E-852E36762D06" name="GUID-445A213F-ED71-49B2-9E7E-852E36762D06"></a><h4 id="ADFNS-GUID-445A213F-ED71-49B2-9E7E-852E36762D06" class="sect4">调用存储的子程序所需的权限</h4>
                  <div>
                     <p>您不需要调用权限：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您拥有的独立子程序</p>
                        </li>
                        <li>
                           <p>您拥有的包中的子程序</p>
                        </li>
                        <li>
                           <p>公共独立子程序</p>
                        </li>
                        <li>
                           <p>公共包中的子程序</p>
                        </li>
                     </ul>
                     <p>要调用另一个用户拥有的存储子程序，您必须具有独立子程序或包含子程序包的<code class="codeph">EXECUTE</code>特权，或者您必须具有<code class="codeph">EXECUTE</code> <code class="codeph">ANY</code> <code class="codeph">PROCEDURE</code>系统特权。如果子程序是远程的，则必须直接授予您<code class="codeph">EXECUTE</code>特权或<code class="codeph">EXECUTE</code> <code class="codeph">ANY</code> <code class="codeph">PROCEDURE</code>系统特权，而不是通过角色。
                     </p>
                     <div class="infoboxnotealso" id="GUID-445A213F-ED71-49B2-9E7E-852E36762D06__GUID-48CBB2C2-175E-44E9-BD4C-FE18D759E55F">
                        <p class="notep1">也可以看看：</p>
                        <p>有关系统和对象权限的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=SQLRF01603" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a></p>
                     </div>
                  </div>
               </div><a id="ADFNS372"></a><a id="ADFNS373"></a><a id="ADFNS371"></a><div class="props_rev_3"><a id="GUID-FECA0AE1-034A-45EB-849A-56761004B54B" name="GUID-FECA0AE1-034A-45EB-849A-56761004B54B"></a><h4 id="ADFNS-GUID-FECA0AE1-034A-45EB-849A-56761004B54B" class="sect4">从Oracle Tools以交互方式调用子程序</h4>
                  <div>
                     <div class="section">
                        <p>您可以从Oracle数据库工具（如SQL * Plus）以交互方式调用子程序。</p>
                        <div class="infoboxnotealso" id="GUID-FECA0AE1-034A-45EB-849A-56761004B54B__GUID-C0057587-7B9E-4214-A21F-44C7DE7441F0">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=SQPUG043" target="_blank"><span class="italic">SQL * Plus用户指南和参考</span></a>有关<code class="codeph">EXECUTE</code>命令的信息</p>
                              </li>
                              <li>
                                 <p>有关使用开发工具执行类似操作的信息，请参阅工具文档</p>
                              </li>
                           </ul>
                        </div>
                        <p><a href="coding-subprograms-and-packages.html#GUID-FECA0AE1-034A-45EB-849A-56761004B54B__BABFDDBJ">例13-7</a>使用SQL * Plus创建过程，然后以两种不同的方式调用它。
                        </p>
                        <p>某些交互式工具允许您创建会话变量，您可以在会话期间使用这些变量。使用SQL * Plus， <a href="coding-subprograms-and-packages.html#GUID-FECA0AE1-034A-45EB-849A-56761004B54B__BABFJFJC">例13-8</a>创建，使用和打印会话变量。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-FECA0AE1-034A-45EB-849A-56761004B54B__BABFDDBJ">
                        <p class="titleinexample">示例13-7使用SQL * Plus以交互方式调用子程序</p><pre class="oac_no_warn" dir="ltr">创建或替换程序salary_raise（员工EMPLOYEES.EMPLOYEE_ID％TYPE，增加EMPLOYEES.SALARY％TYPE）是BEGIN UPDATE员工设定SALARY = SALARY +增加WHERE EMPLOYEE_ID =员工;结束; /</pre><p>从匿名块中调用过程：</p><pre class="oac_no_warn" dir="ltr">BEGIN <span class="bold">salary_raise（205,200）;</span>结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">PL / SQL过程成功完成。
 </pre><p>使用<code class="codeph">EXECUTE</code>语句调用过程：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">执行salary_raise（205,200）;</span>
 </pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">PL / SQL过程成功完成。
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-FECA0AE1-034A-45EB-849A-56761004B54B__BABFJFJC">
                        <p class="titleinexample">示例13-8使用SQL * Plus创建和使用会话变量</p><pre class="oac_no_warn" dir="ltr">- 创建函数供以后使用：CREATE OR REPLACE FUNCTION get_job_id（emp_id EMPLOYEES.EMPLOYEE_ID％TYPE）RETURN EMPLOYEES.JOB_ID％TYPE IS job_id EMPLOYEES.JOB_ID％TYPE; BEGIN SELECT JOB_ID INTO job_id from EMPLOYEES WHERE EMPLOYEE_ID = emp_id;返回job_id;结束; / <span class="bold">- 创建会话变量：</span> <span class="bold">VARIABLE job VARCHAR2（10）;</span> <span class="bold">- 在会话变量中运行函数并存储返回值：</span> <span class="bold">EXECUTE：job：= get_job_id（204）;</span> PL / SQL过程成功完成。
 </pre><p>SQL * Plus命令：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">打印工作;</span>
 </pre><p>结果：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">JOB</span> <span class="bold">--------------------------------</span> <span class="bold">PR_REP</span></pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADFNS375"></a><a id="ADFNS374"></a><div class="props_rev_3"><a id="GUID-A4C492D5-54F8-4A4F-BC52-486A136FFC56" name="GUID-A4C492D5-54F8-4A4F-BC52-486A136FFC56"></a><h4 id="ADFNS-GUID-A4C492D5-54F8-4A4F-BC52-486A136FFC56" class="sect4">从另一个子程序调用子程序</h4>
                  <div>
                     <div class="section">
                        <p>子程序或触发器可以调用另一个存储的子程序。在<a href="coding-subprograms-and-packages.html#GUID-A4C492D5-54F8-4A4F-BC52-486A136FFC56__BABGJHII">示例13-9中</a> ，过程<code class="codeph">print_mgr_name</code>调用过程<code class="codeph">print_emp_name</code> 。
                        </p>
                        <p>允许递归子程序调用（即子程序可以调用自身）。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-A4C492D5-54F8-4A4F-BC52-486A136FFC56__BABGJHII">
                        <p class="titleinexample">示例13-9从另一个子程序中调用子程序</p><pre class="oac_no_warn" dir="ltr">- 创建获取员工ID并打印员工姓名的<span class="bold">程序</span> ：CREATE OR REPLACE <span class="bold">PROCEDURE print_emp_name</span> （emp_id EMPLOYEES.EMPLOYEE_ID％TYPE）IS fname EMPLOYEES.FIRST_NAME％TYPE; lname EMPLOYEES.LAST_NAME％TYPE; BEGIN SELECT FIRST_NAME，LAST_NAME INTO fname，lname FROM EMPLOYEES WHERE EMPLOYEE_ID = emp_id; DBMS_OUTPUT.PUT_LINE（'Employee＃'|| emp_id ||'：'|| fname ||''|| lname）;结束; /  - 创建获取员工ID并打印管理员姓名的过程：CREATE OR REPLACE <span class="bold">PROCEDURE print_mgr_name</span> （emp_id EMPLOYEES.EMPLOYEE_ID％TYPE）IS mgr_id EMPLOYEES.MANAGER_ID％TYPE; BEGIN SELECT MANAGER_ID INTO mgr_id from EMPLOYEES WHERE EMPLOYEE_ID = emp_id; DBMS_OUTPUT.PUT_LINE（'员工经理＃'|| emp_id ||'是：'）; <span class="bold">print_emp_name（mgr_id）;</span>结束; /</pre><p>调用程序：</p><pre class="oac_no_warn" dir="ltr">BEGIN print_emp_name（200）; print_mgr_name（200）;结束; /</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">员工＃200：员工＃200的Jennifer Whalen经理是：员工＃101：Neena Kochhar</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADFNS1039"></a><a id="ADFNS00907"></a><div class="props_rev_3"><a id="GUID-F5F8AD0C-4B45-459D-BBD5-BA8F07E19025" name="GUID-F5F8AD0C-4B45-459D-BBD5-BA8F07E19025"></a><h4 id="ADFNS-GUID-F5F8AD0C-4B45-459D-BBD5-BA8F07E19025" class="sect4">调用远程子程序</h4>
                  <div>
                     <div class="section">
                        <p><span class="bold">远程子程序</span>存储在与其调用程序不同的数据库中。远程子程序调用必须包括子程序名称，存储子程序的数据库的数据库链接，以及每个形式参数的实际参数（即使形式参数具有默认值）。
                        </p>
                        <p>例如，此SQL * Plus语句调用存储的独立过程<code class="codeph">fire_emp1</code> ，该过程由名为<code class="codeph">boston_server</code>的本地数据库链接<code class="codeph">boston_server</code> ：</p><pre class="oac_no_warn" dir="ltr">执行fire_emp1 @ boston_server（1043）;</pre><div class="infoboxnote" id="GUID-F5F8AD0C-4B45-459D-BBD5-BA8F07E19025__GUID-6CA41C89-AC2A-497F-B136-829CC6768494">
                           <p class="notep1">注意：</p>
                           <p>虽然您可以调用远程包子程序，但您无法直接访问远程包变量和常量。</p>
                        </div>
                        <div class="infoboxnote" id="GUID-F5F8AD0C-4B45-459D-BBD5-BA8F07E19025__GUID-2823C873-5EDF-4B5A-8EA9-E8B0712F6466">
                           <p class="notep1">警告：</p>
                           <p></p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>远程子程序调用使用运行时绑定。您连接的用户帐户取决于数据库链接。（存储的子程序使用编译时绑定。）</p>
                              </li>
                              <li>
                                 <p>如果本地子程序调用远程子程序，并且在执行本地子程序期间发现时间戳不匹配，则不运行远程子程序，并且本地子程序无效。有关更多信息，请参阅<a href="schema-object-dependency.html#GUID-5DDF2B74-A9B4-40D4-ABFE-175F11544F3D">本地和远程数据库过程之间的依赖关系</a> 。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F5F8AD0C-4B45-459D-BBD5-BA8F07E19025__GUID-54BAF7E0-18BE-42F7-96E7-CDB27BCE1C10">话题：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-94B53C2E-D329-4B95-BB59-C05476FA2DFA">Remote Subprograms的同义词</a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-B486CBF0-A1E9-4B2E-8BDE-5DE66B7B2BF2">调用远程子程序的事务</a></p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-F5F8AD0C-4B45-459D-BBD5-BA8F07E19025__GUID-9A8C35AB-AB72-400D-B6C2-F2FFAB7290DF">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="schema-object-dependency.html#GUID-5DDF2B74-A9B4-40D4-ABFE-175F11544F3D">本地和远程数据库程序之间的依赖关系</a></p>
                              </li>
                              <li>
                                 <p>有关处理子程序中的错误的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS007" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADFNS377"></a><div class="props_rev_3"><a id="GUID-94B53C2E-D329-4B95-BB59-C05476FA2DFA" name="GUID-94B53C2E-D329-4B95-BB59-C05476FA2DFA"></a><h5 id="ADFNS-GUID-94B53C2E-D329-4B95-BB59-C05476FA2DFA" class="sect5">Remote Subprograms的同义词</h5>
                     <div>
                        <p><span class="bold">同义词</span>是架构对象的别名。您可以为远程子程序名称和数据库链接创建同义词，然后使用同义词来调用子程序。例如：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">为fire_emp1 @ boston_server创建SYNONYM synonym1;</span> EXECUTE <span class="bold">synonym1</span> （1043）;</pre><div class="infoboxnote" id="GUID-94B53C2E-D329-4B95-BB59-C05476FA2DFA__GUID-8A37FA94-8F11-40E0-9157-C836AEEF71E7">
                           <p class="notep1">注意：</p>
                           <p>您无法为包子程序创建同义词，因为它不是架构对象（其包是架构对象）。</p>
                        </div>
                        <p>同义词提供数据独立性和位置透明性。使用同义词，用户可以在不知道谁拥有它或它在哪里的情况下调用子程序。但是，同义词不能替代权限 - 使用同义词来调用子程序，用户仍然需要子程序的必要权限。</p>
                        <p>授予同义词权限等同于授予基础对象的权限。同样，为基础对象授予权限等同于授予对象的所有同义词的权限。</p>
                        <p>您可以创建私人和公共同义词。私有同义词在您的架构中，您可以控制其他人的可用性。公共同义词属于用户组<code class="codeph">PUBLIC</code> ，可供每个数据库用户使用。
                        </p>
                        <p>谨慎使用公共同义词，因为它们使数据库整合更加困难。</p>
                        <p>如果您不想使用同义词，可以创建一个本地子程序来调用远程子程序。例如：</p><pre class="oac_no_warn" dir="ltr">创建或替换过程local_procedure（arg IN NUMBER）AS BEGIN <span class="bold">fire_emp1 @ boston_server（arg）;</span>结束; / DECLARE arg NUMBER; BEGIN <span class="bold">local_procedure（arg）;</span>结束; /</pre><div class="infoboxnotealso" id="GUID-94B53C2E-D329-4B95-BB59-C05476FA2DFA__GUID-D2B0F51C-96AB-4837-99E6-9E5B9362B872">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=CNCPT711" target="_blank"><span class="italic">Oracle Database Concepts</span></a>获取有关同义词的一般信息</p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=CNCPT88883" target="_blank"><span class="italic">Oracle Database Concepts，</span></a>用于公共同义词的示例</p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">CREATE</code> <code class="codeph">SYNONYM</code>语句的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=SQLRF01401" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                              </li>
                              <li>
                                 <p>有关<code class="codeph">GRANT</code>语句的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=SQLRF01603" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="ADFNS378"></a><div class="props_rev_3"><a id="GUID-B486CBF0-A1E9-4B2E-8BDE-5DE66B7B2BF2" name="GUID-B486CBF0-A1E9-4B2E-8BDE-5DE66B7B2BF2"></a><h5 id="ADFNS-GUID-B486CBF0-A1E9-4B2E-8BDE-5DE66B7B2BF2" class="sect5">调用远程子程序的事务</h5>
                     <div>
                        <p>假定远程子程序调用更新数据库。因此，调用远程子程序的事务需要两阶段提交（即使远程子程序不更新数据库）。如果事务被回滚，则远程子程序完成的工作也将回滚。</p>
                        <p>对于语句<code class="codeph">COMMIT</code> ， <code class="codeph">ROLLBACK</code>和<code class="codeph">SAVEPOINT</code> ，远程子程序在这些方面与本地子程序不同：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果事务在不是Oracle数据库的数据库上启动，则远程子程序无法运行这些语句。</p>
                              <p>这种情况可能发生在Oracle XA应用程序中，不建议这样做。有关详细信息，请参阅<a href="xa.html#GUID-1DAB062F-F796-4424-9FFD-9756688AC5B7">使用Oracle XA开发应用程序</a> 。</p>
                           </li>
                           <li>
                              <p>运行其中一个语句后，远程子程序无法启动自己的分布式事务。</p>
                              <p><strong class="term">分布式事务</strong>更新两个或多个数据库。事务中的语句被发送到不同的数据库，并且事务作为一个单元成功或失败。如果事务在任何数据库上失败，则必须在所有数据库上回滚（对于保存点或完全）。在创建执行分布式更新的子程序时请考虑这一点。
                              </p>
                           </li>
                           <li>
                              <p>如果远程子程序未提交或回滚其工作，则在关闭数据库链接时将隐式提交工作。在此之前，远程子程序被认为正在执行交易。因此，不允许进一步调用远程子程序。</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="ADFNS1040"></a><a id="ADFNS00908"></a><div class="props_rev_3"><a id="GUID-C35B709B-EE78-4DB4-9B63-54EB8B4D639F" name="GUID-C35B709B-EE78-4DB4-9B63-54EB8B4D639F"></a><h3 id="ADFNS-GUID-C35B709B-EE78-4DB4-9B63-54EB8B4D639F" class="sect3">从SQL语句调用存储的PL / SQL函数</h3>
               <div>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-C35B709B-EE78-4DB4-9B63-54EB8B4D639F__GUID-D50D5F17-4132-4C0D-9ED6-290A7ACA208F">
                        <p class="notep1">警告：</p>
                        <p>因为SQL是一种声明性语言，而不是命令式（或程序性）语言，所以你无法知道SQL语句调用的函数将运行多少次 - 即使该函数是用PL / SQL（一种命令式语言）编写的。</p>
                        <p>如果您的应用程序要求函数执行一定次数，请不要从SQL语句调用该函数。请改用光标。</p>
                        <p>例如，如果应用程序要求为每个选定的行调用函数，则打开游标，从游标中选择行，然后为每一行调用函数。此技术保证对函数的调用次数是从游标获取的行数。</p>
                        <p>有关游标的一般信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS00602" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                        </p>
                     </div>
                     <p>这些SQL语句可以调用PL / SQL存储函数：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">插入</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">UPDATE</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">删除</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">选择</code></p>
                           <p>（ <code class="codeph">SELECT</code>还可以调用在其<code class="codeph">WITH</code>子句中声明和定义的PL / SQL函数。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">呼叫</code></p>
                           <p>（ <code class="codeph">CALL</code>也可以调用PL / SQL存储过程。）
                           </p>
                        </li>
                     </ul>
                     <p>要从SQL语句调用PL / SQL函数，您必须拥有或拥有该函数的<code class="codeph">EXECUTE</code>特权。要从使用PL / SQL函数定义的视图中进行选择，您必须对视图具有<code class="codeph">READ</code>或<code class="codeph">SELECT</code>权限。从视图中选择不需要单独的<code class="codeph">EXECUTE</code>特权。
                     </p>
                     <div class="infoboxnote" id="GUID-C35B709B-EE78-4DB4-9B63-54EB8B4D639F__GUID-FA5097E1-F7E8-4577-B2EF-A0551B08D74F">
                        <p class="notep1">注意：</p>
                        <p>PL / SQL函数的<code class="codeph">AUTHID</code>属性还可以影响从SQL语句调用函数所需的特权，因为<code class="codeph">AUTHID</code>会影响单元在运行时发出的SQL语句的名称解析和特权检查。有关详细信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS00809" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-C35B709B-EE78-4DB4-9B63-54EB8B4D639F__GUID-D82C3BAF-4B07-4283-9A73-2642F909B44B">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-88C59874-0A18-4AF8-A231-88ED3D41FAA0">为什么从SQL语句中调用PL / SQL函数？</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-6AFBEB39-08CB-45F4-86EA-51ED4E6ADA30">PL / SQL函数可以出现在SQL语句中的位置</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-E562FA4E-B8A1-4B47-A102-A65E26100F3F">当PL / SQL函数可以出现在SQL表达式中时</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-69A02381-FE34-42D9-8A19-9AA8A51514C6" title="您可以在创建PL / SQL包时使用PRAGMA RESTRICT_REFERENCES子句。">控制从SQL语句调用的PL / SQL函数的副作用</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-C35B709B-EE78-4DB4-9B63-54EB8B4D639F__NOTE-1342-CABE192A">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">SELECT</code>语句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=SQLRF55665" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS008" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a>有关调用子程序的一般信息，包括传递参数</p>
                              <p></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS379"></a><div class="props_rev_3"><a id="GUID-88C59874-0A18-4AF8-A231-88ED3D41FAA0" name="GUID-88C59874-0A18-4AF8-A231-88ED3D41FAA0"></a><h4 id="ADFNS-GUID-88C59874-0A18-4AF8-A231-88ED3D41FAA0" class="sect4">为什么从SQL语句中调用PL / SQL函数？</h4>
                  <div>
                     <p>在SQL语句中调用PL / SQL函数可以：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>通过扩展SQL提高用户工作效率</p>
                           <p>SQL语句的表达性会因活动过于复杂，太笨拙或SQL不可用而增加。</p>
                        </li>
                        <li>
                           <p>提高查询效率</p>
                           <p>查询的<code class="codeph">WHERE</code>子句中的函数可以使用必须由应用程序评估的条件来过滤数据。
                           </p>
                        </li>
                        <li>
                           <p>处理字符串以表示特殊数据类型（例如，纬度，经度或温度）</p>
                        </li>
                        <li>
                           <p>提供并行查询执行</p>
                           <p>如果查询是并行化的，那么PL / SQL子程序中的SQL语句也可以并行运行（使用并行查询选项）。</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADFNS380"></a><div class="props_rev_3"><a id="GUID-6AFBEB39-08CB-45F4-86EA-51ED4E6ADA30" name="GUID-6AFBEB39-08CB-45F4-86EA-51ED4E6ADA30"></a><h4 id="ADFNS-GUID-6AFBEB39-08CB-45F4-86EA-51ED4E6ADA30" class="sect4">PL / SQL函数可以出现在SQL语句中的位置</h4>
                  <div>
                     <p>只要SQL函数或表达式可以出现在SQL语句中，PL / SQL函数就可以出现在SQL语句中。例如：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>选择<code class="codeph">SELECT</code>语句的列表</p>
                        </li>
                        <li>
                           <p><code class="codeph">WHERE</code>或<code class="codeph">HAVING</code>子句的条件</p>
                        </li>
                        <li>
                           <p><code class="codeph">CONNECT</code> <code class="codeph">BY</code> ， <code class="codeph">START</code> <code class="codeph">WITH</code> ， <code class="codeph">ORDER</code> <code class="codeph">BY</code>或<code class="codeph">GROUP</code> <code class="codeph">BY</code>子句</p>
                        </li>
                        <li>
                           <p><code class="codeph">INSERT</code>语句的<code class="codeph">VALUES</code>子句</p>
                        </li>
                        <li>
                           <p><code class="codeph">UPDATE</code>语句的<code class="codeph">SET</code>子句</p>
                        </li>
                     </ul>
                     <p>PL / SQL表函数（返回行的集合）可以出现在<code class="codeph">SELECT</code>语句中，而不是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">SELECT</code>列表中的列名称</p>
                        </li>
                        <li>
                           <p><code class="codeph">FROM</code>子句中的表名</p>
                        </li>
                     </ul>
                     <p>PL / SQL函数不能出现在这些需要不变定义的上下文中：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">CHECK</code> <code class="codeph">CREATE</code>或<code class="codeph">ALTER</code> <code class="codeph">TABLE</code>语句的约束子句</p>
                        </li>
                        <li>
                           <p>列的默认值规范</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADFNS382"></a><a id="ADFNS381"></a><div class="props_rev_3"><a id="GUID-E562FA4E-B8A1-4B47-A102-A65E26100F3F" name="GUID-E562FA4E-B8A1-4B47-A102-A65E26100F3F"></a><h4 id="ADFNS-GUID-E562FA4E-B8A1-4B47-A102-A65E26100F3F" class="sect4">当PL / SQL函数可以出现在SQL表达式中时</h4>
                  <div>
                     <p>要从SQL表达式调用，PL / SQL函数必须满足以下要求：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>它必须是用户定义的聚合函数或行函数。</p>
                        </li>
                        <li>
                           <p>其形式参数必须是<code class="codeph">IN</code>参数，而不是<code class="codeph">OUT</code>或<code class="codeph">IN</code> <code class="codeph">OUT</code>参数。
                           </p>
                        </li>
                     </ul>
                     <p><a href="coding-subprograms-and-packages.html#GUID-E562FA4E-B8A1-4B47-A102-A65E26100F3F__CIHGHHCE">例13-10中</a>的功能满足前述要求。
                     </p>
                     <div class="example" id="GUID-E562FA4E-B8A1-4B47-A102-A65E26100F3F__CIHGHHCE">
                        <p class="titleinexample">示例13-10 SQL表达式中的PL / SQL函数（遵循规则）</p><pre class="oac_no_warn" dir="ltr">DROP TABLE工资单; - 如果它存在CREATE TABLE工资单（srate NUMBER，orate NUMBER，acctno NUMBER）;创建或替换<span class="bold">功能gross_pay</span> （emp_id <span class="bold">IN NUMBER</span> ，st_hrs <span class="bold">IN NUMBER</span> ：= 40，ot_hrs <span class="bold">IN NUMBER</span> ：= 0） <span class="bold">RETURN NUMBER</span> IS st_rate NUMBER; ot_rate NUMBER; BEGIN SELECT srate，orate INTO st_rate，ot_rate FROM payroll WHERE acctno = emp_id; RETURN st_hrs * st_rate + ot_hrs * ot_rate; END gross_pay; /</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADFNS1041"></a><a id="ADFNS384"></a><div class="props_rev_3"><a id="GUID-69A02381-FE34-42D9-8A19-9AA8A51514C6" name="GUID-69A02381-FE34-42D9-8A19-9AA8A51514C6"></a><h4 id="ADFNS-GUID-69A02381-FE34-42D9-8A19-9AA8A51514C6" class="sect4">控制从SQL语句调用的PL / SQL函数的副作用</h4>
                  <div>
                     <div class="section">
                        <p>如果子程序除了自身局部变量的值之外发生任何变化，则会<span class="bold">产生副作用</span> 。例如，更改以下任何一项的子程序会产生副作用：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>它自己的<code class="codeph">OUT</code>或<code class="codeph">IN</code> <code class="codeph">OUT</code>参数</p>
                           </li>
                           <li>
                              <p>全局变量</p>
                           </li>
                           <li>
                              <p>包中的公共变量</p>
                           </li>
                           <li>
                              <p>数据库表</p>
                           </li>
                           <li>
                              <p>数据库</p>
                           </li>
                           <li>
                              <p>外部状态（例如，通过调用<code class="codeph">DBMS_OUTPUT</code>或发送电子邮件）</p>
                           </li>
                        </ul>
                        <p>副作用可以阻止查询的并行化，产生依赖于顺序（因此，不确定）的结果，或者要求跨用户会话维护包状态。</p>
                        <p>在从SQL查询或DML语句调用的函数中不允许出现一些副作用。</p>
                        <p>在Oracle Database <span class="italic">8g</span>第1版（8.1）之前，应用程序开发人员使用<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT_REFERENCES</code>来断言函数的<span class="bold">纯度</span> （没有副作用）。此pragma仍可用于向后兼容，但不要在新应用程序中使用它。而是在创建函数时指定优化程序提示<code class="codeph">DETERMINISTIC</code>和<code class="codeph">PARALLEL_ENABLE</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-69A02381-FE34-42D9-8A19-9AA8A51514C6__GUID-50FD9864-E615-4FE9-A6EB-843F164C163B">话题：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-035E5BD6-A547-4E88-9C41-52575A4298FE">对SQL语句调用的函数的限制</a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-5E6ED839-367B-4884-BE4D-1AB851AECA22">从并行化SQL语句调用的PL / SQL函数</a></p>
                           </li>
                           <li>
                              <p><a href="coding-subprograms-and-packages.html#GUID-2FBBF442-399F-4A03-B66E-0C1E5C6A9736" title="您可以在创建PL / SQL包时使用PRAGMA RESTRICT_REFERENCES子句。">PRAGMA RESTRICT_REFERENCES</a> （已弃用）</p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-69A02381-FE34-42D9-8A19-9AA8A51514C6__NOTE-1342-CABEB337">
                           <p class="notep1">也可以看看：</p>有关<code class="codeph">DETERMINISTIC</code>和<code class="codeph">PARALLEL_ENABLE</code>优化程序提示的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS01370" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="ADFNS385"></a><div class="props_rev_3"><a id="GUID-035E5BD6-A547-4E88-9C41-52575A4298FE" name="GUID-035E5BD6-A547-4E88-9C41-52575A4298FE"></a><h5 id="ADFNS-GUID-035E5BD6-A547-4E88-9C41-52575A4298FE" class="sect5">对SQL语句调用的函数的限制</h5>
                     <div>
                        <div class="infoboxnote" id="GUID-035E5BD6-A547-4E88-9C41-52575A4298FE__GUID-CDD9E820-24C6-42C0-89CA-8C79832CBCB6">
                           <p class="notep1">注意：</p>
                           <p>对SQL语句调用的函数的限制也适用于SQL语句触发的触发器。</p>
                        </div>
                        <p>如果SQL语句调用一个函数，并且该函数运行一个新的SQL语句，那么新语句的执行将逻辑嵌入在调用该函数的语句的上下文中。为了确保新语句在此上下文中是安全的，Oracle数据库对该函数强制执行以下限制：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果调用该函数的SQL语句是查询或DML语句，则该函数不能结束当前事务，创建或回滚到保存点，或者<code class="codeph">ALTER</code>系统或会话。
                              </p>
                           </li>
                           <li>
                              <p>如果调用该函数的SQL语句是查询或并行化DML语句，则该函数无法运行DML语句或以其他方式修改数据库。</p>
                           </li>
                           <li>
                              <p>如果调用该函数的SQL语句是DML语句，则该函数既不能读取也不能修改由调用该函数的SQL语句修改的表。</p>
                           </li>
                        </ul>
                        <p>无论函数如何运行新的SQL语句，这些限制都适用。例如，它们适用于新的SQL语句，该函数：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>从PL / SQL调用，无论是直接嵌入函数体，使用<code class="codeph">EXECUTE</code> <code class="codeph">IMMEDIATE</code>语句运行，还是使用<code class="codeph">DBMS_SQL</code>包运行</p>
                           </li>
                           <li>
                              <p>使用JDBC运行</p>
                           </li>
                           <li>
                              <p>使用外部C函数内的回调上下文运行OCI</p>
                           </li>
                        </ul>
                        <p>要避免这些限制，请确保新SQL语句的执行不会在逻辑上嵌入调用该函数的SQL语句的上下文中。例如，将新SQL语句放在自治事务中，或者在OCI中，为外部C函数创建新连接，而不是使用<code class="codeph">OCIExtProcContext</code>参数提供的句柄。
                        </p>
                        <div class="infoboxnotealso" id="GUID-035E5BD6-A547-4E88-9C41-52575A4298FE__NOTE-128-CABF011E">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="sql-processing-for-application-developers.html#GUID-BA46A896-4998-4E3C-ACAE-334B8716BC26">自治交易</a></p>
                        </div>
                     </div>
                  </div><a id="ADFNS387"></a><div class="props_rev_3"><a id="GUID-5E6ED839-367B-4884-BE4D-1AB851AECA22" name="GUID-5E6ED839-367B-4884-BE4D-1AB851AECA22"></a><h5 id="ADFNS-GUID-5E6ED839-367B-4884-BE4D-1AB851AECA22" class="sect5">从并行化SQL语句调用的PL / SQL函数</h5>
                     <div>
                        <p>当Oracle数据库运行<span class="bold">并行化</span> SQL语句时，多个进程同时工作以运行单个SQL语句。当并行化SQL语句调用函数时，每个进程可以调用其自己的函数副本，仅用于该进程处理的行的子集。
                        </p>
                        <p>每个进程都有自己的包变量副本。并行执行开始时，为每个进程初始化包变量，就像用户登录系统一样;不会从原始登录会话中复制包变量值。一个进程对包变量所做的更改不会自动传播到其他进程或原始登录会话。Java <code class="codeph">STATIC</code>类属性在每个进程中都是独立初始化和修改的。函数可以使用包和Java <code class="codeph">STATIC</code>变量在它遇到的各行中累积值。因此，默认情况下，Oracle数据库不会并行化用户定义函数的执行。
                        </p>
                        <p>在Oracle Database <span class="italic">8g</span>第1版（8.1）之前：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果并行化查询调用了用户定义的函数，那么如果<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT_REFERENCES</code>为该函数断言<code class="codeph">RNPS</code>和<code class="codeph">WNPS</code> ，则该函数的执行可以并行化，即该函数既未引用包变量也未更改其值。
                              </p>
                              <p>如果没有这个断言，如果Oracle数据库确定该函数既未引用包变量也未更改其值，则可以并行执行独立的PL / SQL函数（但不是C或Java函数）。</p>
                           </li>
                           <li>
                              <p>如果并行化的DML语句调用了用户定义的函数，那么如果<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT_REFERENCES</code>为函数声明了<code class="codeph">RNDS</code> ， <code class="codeph">WNDS</code> ， <code class="codeph">RNPS</code>和<code class="codeph">WNPS</code> ，那么函数的执行可以并行化 - 也就是说，函数既没有引用也没有改变任何一个的值。包变量或数据库表。
                              </p>
                              <p>如果没有这个断言，如果Oracle数据库确定该函数既未引用也未更改包变量或数据库表的值，则可并行执行独立的PL / SQL函数（但不是C或Java函数）。</p>
                           </li>
                        </ul>
                        <p>从Oracle Database <span class="italic">8g</span>第1版（8.1版）开始，如果并行化SQL语句调用用户定义的函数，则在以下情况下可以并行化函数的执行：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>该函数是使用<code class="codeph">PARALLEL_ENABLE</code>创建的。</p>
                           </li>
                           <li>
                              <p>在Oracle Database <span class="italic">8g</span>第1版（8.1）之前，数据库将该函数识别为可并行化。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="ADFNS389"></a><a id="ADFNS1042"></a><a id="ADFNS388"></a><div class="props_rev_3"><a id="GUID-2FBBF442-399F-4A03-B66E-0C1E5C6A9736" name="GUID-2FBBF442-399F-4A03-B66E-0C1E5C6A9736"></a><h5 id="ADFNS-GUID-2FBBF442-399F-4A03-B66E-0C1E5C6A9736" class="sect5">PRAGMA RESTRICT_REFERENCES</h5>
                     <div>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-2FBBF442-399F-4A03-B66E-0C1E5C6A9736__GUID-2FB7F43B-F70F-486E-81BC-033C0CBA3598">
                              <p class="notep1">注意：</p>
                              <p><code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT_REFERENCES</code>已弃用。在新的应用程序中，Oracle建议使用<code class="codeph">DETERMINISTIC</code>和<code class="codeph">PARALLEL_ENABLE</code> （在<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS01370" target="_blank"><span class="italic">Oracle数据库SQL语言参考中</span></a>解释）而不是<code class="codeph">RESTRICT_REFERENCES</code> 。</p>
                           </div>
                           <p>在现有的PL / SQL应用程序中，您可以删除<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT_REFERENCES</code>或继续使用它，即使使用新功能，也可以简化与现有代码的集成。例如：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>从现有代码中完全删除<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT_REFERENCES</code>是不可能或不切实际的。
                                 </p>
                                 <p>例如，如果子程序S1依赖于子程序S2，并且您没有从S1中删除该编译指示，则可能需要S2中的编译指示来编译S1。</p>
                              </li>
                              <li>
                                 <p>在现有代码中用<code class="codeph">PARALLEL_ENABLE</code>和<code class="codeph">DETERMINISTIC</code>替换<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT_REFERENCES</code>会对新的相关代码的操作产生负面影响。
                                 </p>
                              </li>
                           </ul>
                           <p>使用<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT_REFERENCES</code>来断言函数的纯度：在函数声明之后的任何地方的包规范（不是包体）中，使用以下语法：</p><pre class="oac_no_warn" dir="ltr">PRAGMA RESTRICT_REFERENCES（ <span class="italic">function_name</span> ， <span class="italic">assertion</span> [， <span class="italic">assertion</span> ] ...）;</pre><p><span class="italic"><code class="codeph">assertion</code></span>是以下之一：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="tblformal" id="GUID-2FBBF442-399F-4A03-B66E-0C1E5C6A9736__GUID-DE38865C-25D8-44D2-B0B5-3740239952D9">
                           <table cellpadding="4" cellspacing="0" class="Formal" title="" width="100%" border="1" summary="This table summarizes the assertions of the RESTRICT_REFERENCES pragma." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="14%" id="d58669e8533">断言</th>
                                    <th align="left" valign="bottom" width="86%" id="d58669e8536">含义</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="14%" id="d58669e8541" headers="d58669e8533 ">
                                       <p><code class="codeph">RNPS</code></p>
                                    </td>
                                    <td align="left" valign="top" width="86%" headers="d58669e8541 d58669e8536 ">
                                       <p>该函数读取没有包状态（不引用包变量的值）</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="14%" id="d58669e8549" headers="d58669e8533 ">
                                       <p><code class="codeph">WNPS</code></p>
                                    </td>
                                    <td align="left" valign="top" width="86%" headers="d58669e8549 d58669e8536 ">
                                       <p>该函数不写入包状态（不更改包变量的值）。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="14%" id="d58669e8557" headers="d58669e8533 ">
                                       <p><code class="codeph">RNDS</code></p>
                                    </td>
                                    <td align="left" valign="top" width="86%" headers="d58669e8557 d58669e8536 ">
                                       <p>该函数不读取数据库状态（不查询数据库表）。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="14%" id="d58669e8565" headers="d58669e8533 ">
                                       <p><code class="codeph">WNDS</code></p>
                                    </td>
                                    <td align="left" valign="top" width="86%" headers="d58669e8565 d58669e8536 ">
                                       <p>该函数不写入数据库状态（不修改数据库表）。</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="14%" id="d58669e8573" headers="d58669e8533 ">
                                       <p><code class="codeph">信任</code></p>
                                    </td>
                                    <td align="left" valign="top" width="86%" headers="d58669e8573 d58669e8536 ">
                                       <p>相信函数体中没有SQL语句违反了为函数做出的任何断言。有关更多信息，请参阅<a href="coding-subprograms-and-packages.html#GUID-3C2C075A-1425-44C4-9A69-C0BAB8E1BAD1">指定断言信任</a> 。</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="section">
                           <p>如果未指定<code class="codeph">TRUST</code> ，并且函数体中的SQL语句违反了您指定的断言，则PL / SQL编译器在解析违规语句时会发出错误消息。
                           </p>
                           <p>断言函数允许的最高纯度级别（大多数断言），以便PL / SQL编译器永远不会不必要地拒绝该函数。</p>
                           <div class="infoboxnote" id="GUID-2FBBF442-399F-4A03-B66E-0C1E5C6A9736__GUID-E840C982-2A8A-42B9-B090-6706C294629C">
                              <p class="notep1">注意：</p>
                              <p>如果函数调用子程序，则还要为这些子程序指定<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT_REFERENCES</code> ，或者在调用函数或调用的子程序中指定<code class="codeph">TRUST</code> 。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-2FBBF442-399F-4A03-B66E-0C1E5C6A9736__GUID-E61495AC-DBF8-4121-A67B-47091C5BAA9D">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT_REFERENCES</code>更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS01339" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-2FBBF442-399F-4A03-B66E-0C1E5C6A9736__GUID-0F68FF68-AA2B-4C7A-885B-CF10B59A5B2F">话题：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="coding-subprograms-and-packages.html#GUID-3C2C075A-1425-44C4-9A69-C0BAB8E1BAD1">指定断言信任</a></p>
                              </li>
                              <li>
                                 <p><a href="coding-subprograms-and-packages.html#GUID-2B125FF5-DD29-413B-89BC-52BC15AA0616">静态和动态SQL语句之间的差异</a></p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div class="sect5"><a id="GUID-43642F83-8A51-42FD-AB01-E41DF38A6B5D" name="GUID-43642F83-8A51-42FD-AB01-E41DF38A6B5D"></a><h6 id="ADFNS-GUID-43642F83-8A51-42FD-AB01-E41DF38A6B5D" class="sect6">示例：PRAGMA RESTRICT_REFERENCES</h6>
                        <div>
                           <p>您可以在创建PL / SQL包时使用<code class="codeph">PRAGMA RESTRICT_REFERENCES</code>子句。
                           </p>
                           <p><a href="coding-subprograms-and-packages.html#GUID-43642F83-8A51-42FD-AB01-E41DF38A6B5D__CIHEIHCD">例13-11</a>创建了一个既不读取也不写入数据库或包状态的函数，并且断言具有最大纯度级别。
                           </p>
                           <div class="example" id="GUID-43642F83-8A51-42FD-AB01-E41DF38A6B5D__CIHEIHCD">
                              <p class="titleinexample">例13-11 PRAGMA RESTRICT_REFERENCES</p><pre class="oac_no_warn" dir="ltr">DROP TABLE帐户; - 如果存在CREATE TABLE帐户（acctno INTEGER，余额NUMBER）; INSERT INTO帐户（acctno，balance）VALUES（12345,1000.00）;创建或替换包裹融资作为<span class="bold">功能复合</span> _（年数，数量，数量，数字）返回数字; <span class="bold">PRAGMA RESTRICT_REFERENCES（复合_，WNDS，WNPS，RNDS，RNPS）</span> ;结束融资; / CREATE PACKAGE BODY finance AS <span class="bold">FUNCTION compound_</span> （年份IN NUMBER，金额IN NUMBER，汇率IN NUMBER）返回号码是BEGIN RETURN amount * POWER（（rate / 100）+ 1，years）; END compound_; <span class="bold">- 包裹体</span> END资金<span class="bold">没有pragma</span> ; / DECLARE利息NUMBER; BEGIN SELECT finance.compound_（5,1000,6）INTO interest FROM accounts WHERE acctno = 12345;结束; /</pre></div>
                           <!-- class="example" -->
                        </div>
                     </div><a id="ADFNS392"></a><a id="ADFNS391"></a><a id="ADFNS390"></a><div class="props_rev_3"><a id="GUID-3C2C075A-1425-44C4-9A69-C0BAB8E1BAD1" name="GUID-3C2C075A-1425-44C4-9A69-C0BAB8E1BAD1"></a><h6 id="ADFNS-GUID-3C2C075A-1425-44C4-9A69-C0BAB8E1BAD1" class="sect6">指定断言信任</h6>
                        <div>
                           <div class="section">
                              <p>当<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT</code> <code class="codeph">REFERENCES</code>指定<code class="codeph">TRUST</code> ，PL / SQL编译器不检查子程序体是否存在违规。
                              </p>
                              <p><code class="codeph">TRUST</code>使得使用<code class="codeph">PRAGMA</code> <code class="codeph">RESTRICT</code> <code class="codeph">REFERENCES</code>的子程序更容易调用不使用它的子程序。
                              </p>
                              <p>如果您的PL / SQL子程序调用C或Java子程序，则必须为PL / SQL子程序（如<a href="coding-subprograms-and-packages.html#GUID-3C2C075A-1425-44C4-9A69-C0BAB8E1BAD1__BABBAGBC">例13-12</a> ）或C或Java子程序（如<a href="coding-subprograms-and-packages.html#GUID-3C2C075A-1425-44C4-9A69-C0BAB8E1BAD1__BABDCDFI">例13-13</a> ）指定<code class="codeph">TRUST</code> ，因为PL / SQL编译器无法在运行时检查C或Java子程序是否存在违规。
                              </p>
                           </div>
                           <!-- class="section" -->
                           <div class="example" id="GUID-3C2C075A-1425-44C4-9A69-C0BAB8E1BAD1__BABBAGBC">
                              <p class="titleinexample">例13-12在Invoker上使用TRUST的PRAGMA RESTRICT参考</p><pre class="oac_no_warn" dir="ltr">创建或替换包是程序java_sleep（milli_seconds IN NUMBER）AS LANGUAGE JAVA NAME'java.lang。了Thread.sleep（长）'; <span class="bold">功能f</span> （n NUMBER）返回号码; <span class="bold">PRAGMA RESTRICT_REFERENCES（f，WNDS，TRUST）;</span>结束p; /创建或替换<span class="bold">包裹身体</span> <span class="bold">功能f</span> （n NUMBER）返回<span class="bold">号码是否开始java_sleep（n）;</span>返回;结束f;结束p; /</pre></div>
                           <!-- class="example" -->
                           <div class="example" id="GUID-3C2C075A-1425-44C4-9A69-C0BAB8E1BAD1__BABDCDFI">
                              <p class="titleinexample">例13-13在Invokee上使用TRUST的PRAGMA RESTRICT参考</p><pre class="oac_no_warn" dir="ltr">创建或替换包是<span class="bold">程序java_sleep</span> （milli_seconds IN NUMBER）AS LANGUAGE JAVA NAME'java.lang。了Thread.sleep（长）'; <span class="bold">PRAGMA RESTRICT_REFERENCES（java_sleep，WNDS，TRUST）</span> ;功能f（n NUMBER）返回号码;结束p; /创建或替换<span class="bold">包裹身体</span> <span class="bold">功能f</span> （n NUMBER）返回<span class="bold">号码是否开始java_sleep（n）;</span>返回;结束f;结束p; /</pre></div>
                           <!-- class="example" -->
                        </div>
                     </div><a id="ADFNS393"></a><div class="props_rev_3"><a id="GUID-2B125FF5-DD29-413B-89BC-52BC15AA0616" name="GUID-2B125FF5-DD29-413B-89BC-52BC15AA0616"></a><h6 id="ADFNS-GUID-2B125FF5-DD29-413B-89BC-52BC15AA0616" class="sect6">静态和动态SQL语句之间的差异</h6>
                        <div>
                           <p>如果静态<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code>语句未显式读取数据库状态（例如表列），则它不会违反<code class="codeph">RNDS</code> 。动态<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code>语句始终违反<code class="codeph">RNDS</code> ，无论它是否显式读取数据库状态。
                           </p>
                           <p>如果动态执行，则以下<code class="codeph">INSERT</code>语句违反<code class="codeph">RNDS</code> ，但如果静态执行则不会违反<code class="codeph">RNDS</code> ：</p><pre class="oac_no_warn" dir="ltr">INSERT INTO my_table values（3，'BOB'）;</pre><p>以下<code class="codeph">UPDATE</code>语句始终违反<code class="codeph">RNDS</code> ，无论是静态还是动态执行，因为它显式读取<code class="codeph">my_table</code>的列<code class="codeph">name</code> ：</p><pre class="oac_no_warn" dir="ltr">UPDATE my_table SET id = 777 WHERE name ='BOB';</pre></div>
                     </div>
                  </div>
               </div>
            </div><a id="ADFNS1037"></a><a id="ADFNS99873"></a><div class="props_rev_3"><a id="GUID-7D7E93D3-FD00-42C7-85D1-2B8965CA99D5" name="GUID-7D7E93D3-FD00-42C7-85D1-2B8965CA99D5"></a><h3 id="ADFNS-GUID-7D7E93D3-FD00-42C7-85D1-2B8965CA99D5" class="sect3">分析和调试存储的子程序</h3>
               <div>
                  <div class="section">
                     <p>要编译存储的子程序，必须修复代码中的任何语法错误。为确保子程序正常运行，运行良好并从错误中恢复，您可能需要进行其他调试。此类调试可能涉及：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>添加额外的输出语句以验证执行进度并检查子程序中某些点的数据值。</p>
                           <p>要输出变量和表达式的值，请使用Oracle软件包<code class="codeph">DBMS_OUTPUT</code>的<code class="codeph">PUT</code>和<code class="codeph">PUT_LINE</code>子程序。</p>
                        </li>
                        <li>
                           <p>通过运行PL / Scope，PL / SQL分层分析器或调试器来更详细地分析程序及其执行</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-7D7E93D3-FD00-42C7-85D1-2B8965CA99D5__GUID-53D8B04D-CD37-4460-B9C3-68BE44A92C84">话题：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-BAAD5B8A-02C5-4BDE-A7D4-3FA89755946A">PL /范围</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-D3AB64E2-6E43-4B2A-A80C-2BE0438D7957">PL / SQL分层分析器</a></p>
                        </li>
                        <li>
                           <p><a href="coding-subprograms-and-packages.html#GUID-42D1C32E-BCC0-46B3-94D4-E2341F776BF7" title="可以使用Oracle SQL Developer，Oracle JDeveloper和各种第三方工具调试数据库中的PL / SQL和Java代码。DBMS_DEBUG_JDWP包用于在数据库会话和这些调试器程序之间建立连接。">调试PL / SQL和Java</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-7D7E93D3-FD00-42C7-85D1-2B8965CA99D5__GUID-C1AE4F5F-B5FF-477C-9EC8-F1B76A3A8A5C">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关处理PL / SQL子程序和包中的错误的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS007" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">DBMS_OUTPUT</code>包的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ARPLS036" target="_blank"><span class="italic">参见Oracle Database PL / SQL包和类型参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div><a id="ADFNS362"></a><div class="props_rev_3"><a id="GUID-BAAD5B8A-02C5-4BDE-A7D4-3FA89755946A" name="GUID-BAAD5B8A-02C5-4BDE-A7D4-3FA89755946A"></a><h4 id="ADFNS-GUID-BAAD5B8A-02C5-4BDE-A7D4-3FA89755946A" class="sect4">PL /范围</h4>
                  <div>
                     <p>PL / Scope允许您开发功能强大且有效的PL / Scope源代码工具，通过最大限度地减少浏览和理解源代码所花费的时间来提高PL / SQL开发人员的工作效率。</p>
                     <p>有关PL / Scope的更多信息，请参阅<a href="plscope.html#GUID-24109CB5-7BB9-48B2-AD7A-39458AA13C0C" title="PL / Scope是一个编译器驱动的工具，它收集PL / SQL和SQL标识符以及PL / SQL源代码中的SQL语句用法。默认情况下，PUBLIC对各种系统表和视图具有SELECT权限，对各种PL / SQL对象具有EXECUTE权限。默认情况下，PL / Scope不会收集PL / SQL源程序中的标识符和语句的数据。要启用和控制收集的内容，请设置PL / SQL编译参数PLSCOPE_SETTINGS.PL/Scope用法是描述代表标识符执行的操作的动词。每个标识符使用都被赋予一个在代码单元中唯一的数字ID。这是标识符的USAGE_ID。标识符用法可以是其他标识符用法的上下文。这在用法之间创建了一对多的父子关系。父上下文使用的USAGE_ID是子用法的USAGE_CONTEXT_ID。DBA_STATEMENTS静态字典视图系列描述了PL / Scope收集的SQL语句。PL / Scope语句类型表示PL / SQL中使用的SQL语句.DBA_STATEMENTS视图中的每一行代表PL / SQL单元中SQL语句的唯一位置。这相当于编译单元中的唯一键。语句可以充当其他语句或标识符的上下文。声明也可以在其他声明或标识符的上下文中。每个SQL语句都有一个唯一的PL / Scope签名，用于标识所有PL / SQL单元中的语句实例。除PL / Scope数据字典视图外，以下静态字典视图对PL / SQL程序员最有用，并且通常在与PL / SQL代码管理报告相关的查询中引用。这不是所有静态数据字典视图的详尽列表。">使用PL / Scope</a> 。
                     </p>
                  </div>
               </div><a id="ADFNS363"></a><div class="props_rev_3"><a id="GUID-D3AB64E2-6E43-4B2A-A80C-2BE0438D7957" name="GUID-D3AB64E2-6E43-4B2A-A80C-2BE0438D7957"></a><h4 id="ADFNS-GUID-D3AB64E2-6E43-4B2A-A80C-2BE0438D7957" class="sect4">PL / SQL分层分析器</h4>
                  <div>
                     <p>PL / SQL分层分析器报告PL / SQL程序的动态执行配置文件，由子程序调用组织。它分别考虑SQL和PL / SQL执行时间。动态执行配置文件中的每个子程序级摘要包括诸如子程序调用次数，子程序本身所花费的时间，子程序子树中花费的时间（即其子级子程序）以及详细的父子信息等信息。 。</p>
                     <p>您可以在任何浏览器中浏览生成的HTML报告。浏览器的导航功能与精心选择的链接相结合，提供了一种分析大型应用程序性能，提高应用程序性能和降低开发成本的强大方法。</p>
                     <div class="infoboxnotealso" id="GUID-D3AB64E2-6E43-4B2A-A80C-2BE0438D7957__NOTE-123-CABF8F4E">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="hierarchical-profiler.html#GUID-B2E3A739-08C6-4648-A65F-1D093A0DADDE" title="了解DBMS_HPROF.ANALYZE SQL级报告。">有关PL / SQL分层分析器</a>的更多信息，请使用PL / SQL分层分析器</p>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-42D1C32E-BCC0-46B3-94D4-E2341F776BF7" name="GUID-42D1C32E-BCC0-46B3-94D4-E2341F776BF7"></a><h4 id="ADFNS-GUID-42D1C32E-BCC0-46B3-94D4-E2341F776BF7" class="sect4">调试PL / SQL和Java</h4>
                  <div>
                     <p>可以使用Oracle SQL Developer，Oracle JDeveloper和各种第三方工具调试数据库中的PL / SQL和Java代码。DBMS_DEBUG_JDWP包用于在数据库会话和这些调试器程序之间建立连接。</p>
                     <p>通过连接到会话以从另一个会话调试，可以调查长时间运行的测试或生产环境中发生的问题。在调试会话时，可以检查范围内变量的状态，并检查数据库状态，因为正在调试的会话在未提交的事务期间看到它。在断点处停止时，调试用户可以发出SQL命令，并在必要时运行PL / SQL代码，在匿名块中调用存储的PL / SQL子程序。</p>
                     <div class="infoboxnotealso" id="GUID-42D1C32E-BCC0-46B3-94D4-E2341F776BF7__ORACLEDATABASEPLSQLLANGUAGEREFERENC-5CDDDDEB">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关运行和调试函数和过程的详细信息，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=RPTUG-GUID-2DCC7144-A46F-4361-9B09-955E1154D7CB" target="_blank"><span class="italic">“Oracle SQL Developer用户指南”</span></a></p>
                           </li>
                           <li>
                              <p>有关使用Java调试线协议（JDWP）PL / SQL调试器的信息，请参见“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=JJDEV13192" target="_blank"><span class="italic">Oracle数据库Java开发人员指南</span></a> ”</p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">DBMS_DEBUG_JDWP</code>包的信息，请<code class="codeph">DBMS_DEBUG_JDWP</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=ARPLS-GUID-AFF566A0-9E90-4218-B5C6-A74C3BF1CE14" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">V$PLSQL_DEBUGGABLE_SESSIONS</code>视图的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=REFRN-GUID-AFF714A6-946A-4568-9B99-6EF82C7DC447" target="_blank"><span class="italic">参见Oracle数据库参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="ADFNS313"></a><div class="props_rev_3"><a id="GUID-58B89FA9-16ED-47A5-A5F8-5685552322C3" name="GUID-58B89FA9-16ED-47A5-A5F8-5685552322C3"></a><h5 id="ADFNS-GUID-58B89FA9-16ED-47A5-A5F8-5685552322C3" class="sect5">编译调试代码</h5>
                     <div>
                        <div class="section">
                           <p>调试器可以在单独的代码行上停止，并且仅在使用生成的调试信息编译的代码中访问变量。</p>
                           <p>要编译生成调试信息的PL / SQL单元，请将编译参数<code class="codeph">PLSQL_OPTIMIZE_LEVEL</code>设置为1（默认值为2）。
                           </p>
                           <div class="infoboxnote" id="GUID-58B89FA9-16ED-47A5-A5F8-5685552322C3__GUID-F6DB71E1-CD72-4BA2-9A33-365FFCBDE506">
                              <p class="notep1">注意：</p>
                              <p>PL / SQL编译器永远不会为使用PL / SQL <code class="codeph">wrap</code>实用程序隐藏的代码生成调试信息。
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-58B89FA9-16ED-47A5-A5F8-5685552322C3__NOTE-1314-CABFB063">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关<code class="codeph">wrap</code>实用程序的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=LNPLS016" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                                 </li>
                                 <li>
                                    <p><a href="coding-subprograms-and-packages.html#GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF">有关PL / SQL单元</a>的信息，请参阅PL / SQL单元<a href="coding-subprograms-and-packages.html#GUID-DF29C489-E8F5-4171-8CF1-AE86032111BF">概述</a></p>
                                 </li>
                                 <li>
                                    <p>有关<code class="codeph">PLSQL_OPTIMIZE_LEVEL</code>更多信息，请<code class="codeph">PLSQL_OPTIMIZE_LEVEL</code> <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adfns&amp;id=REFRN10255" target="_blank"><span class="italic">Oracle数据库参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADFNS366"></a><div class="props_rev_3"><a id="GUID-5C7978B5-2C67-496B-9B36-3A05357D428A" name="GUID-5C7978B5-2C67-496B-9B36-3A05357D428A"></a><h5 id="ADFNS-GUID-5C7978B5-2C67-496B-9B36-3A05357D428A" class="sect5">调试PL / SQL和Java存储子程序的权限</h5>
                     <div>
                        <p>对于连接到调试器的会话，连接操作时的有效用户必须具有<code class="codeph">DEBUG CONNECT SESSION</code> ， <code class="codeph">DEBUG CONNECT ANY</code>或相应的<code class="codeph">DEBUG CONNECT ON USER</code>权限。有效用户可能是进行连接呼叫所涉及的DR子程序的所有者。
                        </p>
                        <p>当会话连接到调试器时，会话登录用户和启用的会话级角色将被修复为该调试连接的权限环境。必须将调试所需的权限授予相关代码上的用户和角色组合。特权是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>显示和更改PL / SQL包规范或Java公共变量中声明的变量： <code class="codeph">EXECUTE</code>或<code class="codeph">DEBUG</code> 。</p>
                           </li>
                           <li>
                              <p>要显示和更改私有变量，要么逐步更改断点和运行代码行： <code class="codeph">DEBUG</code></p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-5C7978B5-2C67-496B-9B36-3A05357D428A__GUID-BB0C4918-849C-4726-8118-93B90E2A9D35">
                           <p class="notep1">警告：</p>
                           <p><code class="codeph">DEBUG</code>权限允许调试会话执行被调试的子程序在其代码中包含该操作时可以执行的任何操作。
                           </p>
                        </div>
                        <p>授予<code class="codeph">DEBUG</code> <code class="codeph">ANY</code> <code class="codeph">PROCEDURE</code>系统特权等同于授予数据库中所有对象的<code class="codeph">DEBUG</code>特权。如果<code class="codeph">O7_DICTIONARY_ACCESSIBILITY</code>参数的值为<code class="codeph">TRUE</code>则包括<code class="codeph">SYS</code>拥有的对象。</p>
                        <div class="infoboxnote" id="GUID-5C7978B5-2C67-496B-9B36-3A05357D428A__GUID-358DFD51-D237-473F-8199-66E96F6A5521">
                           <p class="notep1">警告：</p>
                           <p>授予<code class="codeph">DEBUG</code> <code class="codeph">ANY</code> <code class="codeph">PROCEDURE</code>权限，或授予<code class="codeph">SYS</code>拥有的任何对象<code class="codeph">DEBUG</code>权限，授予数据库的完整权限。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-5C7978B5-2C67-496B-9B36-3A05357D428A__GUID-9827B4FC-2FD5-480F-AE1F-DAE4A1CD0844">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关系统和对象权限的信息，请参阅<a href="../sqlrf/GRANT.html#SQLRF01603" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a></p>
                              </li>
                              <li>
                                 <p>有关调试Java子程序的权限的信息，请参见<a href="../jjdev/database-contents-Oracle-JVM-security.html#JJDEV13344" target="_blank"><span class="italic">“Oracle数据库Java开发人员指南”</span></a></p>
                              </li>
                              <li>
                                 <p>有关DBMS_DEBUG_JDWP程序包安全模型的信息，请参阅<a href="../arpls/DBMS_DEBUG_JDWP.html#ARPLS-GUID-200AB599-E581-4CB7-A062-57B43986037D" target="_blank"><span class="italic">Oracle Database PL / SQL程序包和类型参考</span></a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="ADFNS1032"></a><a id="ADFNS1033"></a><a id="ADFNS341"></a><div class="props_rev_3"><a id="GUID-819553BB-9DC8-45A6-88EC-8BAF797C634E" name="GUID-819553BB-9DC8-45A6-88EC-8BAF797C634E"></a><h3 id="ADFNS-GUID-819553BB-9DC8-45A6-88EC-8BAF797C634E" class="sect3">包失效和会话状态</h3>
               <div>
                  <p>引用包对象的每个会话都有自己的相应包的实例，包括任何公共和私有变量，游标和常量的持久状态。如果任何会话的实例化包（规范或正文）无效，则会话中的所有包实例都将失效并重新编译。因此，会话中的所有包实例都会丢失会话状态。</p>
                  <p>当给定会话中的包无效时，会话在第一次尝试使用无效包实例的任何对象时收到ORA-04068。会话第二次进行这样的包调用时，会为会话重新实例化包而不会出错。但是，如果您在应用程序中处理此错误，请注意以下事项：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>为获得最佳性能，Oracle Database仅在丢弃程序包状态时才返回此错误消息。当一个包中的子程序调用另一个包中的子程序时，两个包的会话状态都将丢失。</p>
                     </li>
                     <li>
                        <p>如果服务器会话陷阱ORA-04068，则不会为客户端会话引发ORA-04068。因此，当客户端会话尝试使用包中的对象时，不会重新实例化包。要重新实例化包，客户端会话必须重新连接到数据库或重新编译包。</p>
                     </li>
                  </ul>
                  <p>在大多数生产环境中，可能导致失效的DDL操作通常在非活动工作时间执行;因此，这种情况对最终用户应用程序可能不是问题。但是，如果程序包失效在工作时间内在您的系统中很常见，那么您可能希望编写应用程序代码以在进行包调用时处理此错误。</p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-28215E66-071A-4AC3-9FDA-A009A0EB6A88" name="GUID-28215E66-071A-4AC3-9FDA-A009A0EB6A88"></a><h3 id="ADFNS-GUID-28215E66-071A-4AC3-9FDA-A009A0EB6A88" class="sect3">示例：引发ORA-04068错误</h3>
               <div>
                  <p>您可以使用<code class="codeph">RAISE</code>子句来引发异常。
                  </p>
                  <p>在<a href="coding-subprograms-and-packages.html#GUID-28215E66-071A-4AC3-9FDA-A009A0EB6A88__BABCFFEC">例13-14中</a> ， <code class="codeph">RAISE</code>语句引发当前异常ORA-04068，它是处理异常的原因，ORA-06508。ORA-04068没有被困。
                  </p>
                  <div class="example" id="GUID-28215E66-071A-4AC3-9FDA-A009A0EB6A88__BABCFFEC">
                     <p class="titleinexample">例13-14提高ORA-04068</p><pre class="oac_no_warn" dir="ltr">程序p是package_exception EXCEPTION; PRAGMA EXCEPTION_INIT（package_exception，-6508）;开始 ...当package_exception <span class="bold">升高时的</span>异常<span class="bold">;</span>结束; /</pre></div>
                  <!-- class="example" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-BDFBDCC9-FDD4-41DB-9930-456A793D9AF4" name="GUID-BDFBDCC9-FDD4-41DB-9930-456A793D9AF4"></a><h3 id="ADFNS-GUID-BDFBDCC9-FDD4-41DB-9930-456A793D9AF4" class="sect3">示例：捕获ORA-04068</h3>
               <div>
                  <p>您可以在程序包定义中使用<code class="codeph">RAISE</code>语句来捕获错误。
                  </p>
                  <p>在<a href="coding-subprograms-and-packages.html#GUID-BDFBDCC9-FDD4-41DB-9930-456A793D9AF4__BABIFBBB">例13-15中</a> ， <code class="codeph">RAISE</code>语句引发异常ORA-20001以响应ORA-06508，而不是当前异常ORA-04068。ORA-04068被困。发生这种情况时，会屏蔽ORA-04068错误，从而阻止程序包重新实例化。
                  </p>
                  <div class="example" id="GUID-BDFBDCC9-FDD4-41DB-9930-456A793D9AF4__BABIFBBB">
                     <p class="titleinexample">例13-15捕获ORA-04068</p><pre class="oac_no_warn" dir="ltr">程序p是package_exception EXCEPTION; other_exception EXCEPTION; PRAGMA EXCEPTION_INIT（package_exception，-6508）; PRAGMA EXCEPTION_INIT（other_exception，-20001）;开始 ...当package_exception那么EXCEPTION ......
    <span class="bold">提升other_exception;</span>结束; /</pre></div>
                  <!-- class="example" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>