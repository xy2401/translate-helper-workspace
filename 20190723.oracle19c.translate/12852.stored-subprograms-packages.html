<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Stored subprograms and packages can be used as building blocks for many different database applications."></meta>
      <meta name="description" content="Stored subprograms and packages can be used as building blocks for many different database applications."></meta>
      <title>开发存储的子程序和包</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="2 Day Developer&#39;s Guide "></meta>
      <meta property="og:description" content="Stored subprograms and packages can be used as building blocks for many different database applications."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="2 Day Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="2-day-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T13:00:30-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E94801-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="creating-managing-schema-objects.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-triggers.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="2 Day Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="TDDDG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="creating-managing-schema-objects.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-triggers.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">2天开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">开发存储的子程序和包</li>
            </ol>
            <a id="GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" name="GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F"></a><a id="TDDDG40000"></a>
            
            <h2 id="TDDDG-GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" class="sect2"><span class="enumeration_chapter">5</span>开发存储的子程序和包</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='stored-subprograms-packages'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>存储的子程序和包可以用作许多不同数据库应用程序的构建块。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-06E542A7-90A1-438A-951C-D9F60F908394">关于存储的子程序</a><br><strong class="term">存储的子程序</strong>是存储在数据库中的子程序。因为它们存储在数据库中，所以存储的程序可以用作许多不同数据库应用程序的构建块。
                  </li>
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-711EE477-C725-40BE-A82B-1880EECBF912">关于包裹</a><br><strong class="term">包</strong>是一个PL / SQL单元，由相关的子程序和它们使用的声明游标和变量组成。Oracle建议您将子程序放入包中。
                  </li>
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-558EF48E-4929-435C-A3CC-32EB3C048C98">关于PL / SQL标识符</a><br>每个PL / SQL子程序，包，参数，变量，常量，异常和声明的游标都有一个名称，它是一个PL / SQL标识符。
                  </li>
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-6C848D95-8B1E-436E-835D-2225567977B5">关于PL / SQL数据类型</a><br>每个PL / SQL常量，变量，子程序参数和函数返回值都有一个数据类型，用于确定其存储格式，约束，有效值范围以及可对其执行的操作。
                  </li>
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C">创建和管理独立子程序</a><br>您可以创建和管理独立的PL / SQL子程序。
                  </li>
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-84755B9D-6E53-4066-8FEE-5FD1A42B6484">创建和管理包</a><br>您可以创建和管理PL / SQL包。
                  </li>
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-57A239C2-095F-4707-A813-797B75C369AC">为变量和常量声明和赋值</a><br>包规范中声明的变量或常量可供任何有权访问包的程序使用。在包体或子程序中声明的变量或常量是该包或子程序的本地变量。声明常量时，必须为其指定初始值。
                  </li>
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51">控制程序流程</a><br>与按照输入顺序运行语句的SQL不同，PL / SQL具有控制语句，可以控制程序的流程。
                  </li>
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38">使用记录和游标</a><br>您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。
                  </li>
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E">使用关联数组</a><br>关联数组是一种集合。
                  </li>
                  <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-7D9BAC1B-A6AA-428E-8C08-73DB9D7911D5">处理异常（运行时错误）</a><br>您可以使用PL / SQL代码处理运行时发生的异常。
                  </li>
               </ul>
            </div>
            <a id="TDDDG48000"></a><div class="props_rev_3"><a id="GUID-06E542A7-90A1-438A-951C-D9F60F908394" name="GUID-06E542A7-90A1-438A-951C-D9F60F908394"></a><h3 id="TDDDG-GUID-06E542A7-90A1-438A-951C-D9F60F908394" class="sect3"><span class="enumeration_section">5.1</span>关于存储的子程序</h3>
               <div>
                  <p><strong class="term">存储的子程序</strong>是存储在数据库中的子程序。因为它们存储在数据库中，所以存储的程序可以用作许多不同数据库应用程序的构建块。
                  </p>
                  <p><strong class="term">子程序</strong>是一个PL / SQL单元，由SQL和PL / SQL语句组成，用于解决特定问题或执行一组相关任务。子程序可以有参数，其值由调用者提供。子程序可以是程序或功能。通常，您使用过程执行操作，并使用函数来计算和返回值。
                  </p>
                  <p>由于存储的子程序存储在数据库中，因此存储的程序可以用作许多不同数据库应用程序的构建块。在另一个子程序中或在匿名块内声明的子程序称为<strong class="term">嵌套子程序</strong>或<strong class="term">本地子程序</strong> 。它不能从子程序或声明它的块外部调用。<strong class="term">匿名块</strong>是未存储在数据库中的块。
                  </p>
                  <p>存储的子程序有两种：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><strong class="term">独立子程序</strong> ，在模式级别创建</p>
                     </li>
                     <li>
                        <p><strong class="term">包子程序</strong> ，这是一个包装内产生</p>
                     </li>
                  </ul>
                  <p>独立子程序对于测试程序逻辑块很有用，但是当您确定它们按预期工作时，Oracle建议您将它们放入包中。</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-06E542A7-90A1-438A-951C-D9F60F908394__GUID-84637F30-EC66-4225-ABD5-F28637AE8299">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关存储的子程序的一般信息，请参见<a href="../cncpt/server-side-programming.html#CNCPT1776" target="_blank"><span class="italic">Oracle数据库概念</span></a></p>
                        </li>
                        <li>
                           <p>有关PL / SQL子程序的完整信息，请<a href="../lnpls/plsql-subprograms.html#LNPLS008" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TDDDG99991"></a><div class="props_rev_3"><a id="GUID-711EE477-C725-40BE-A82B-1880EECBF912" name="GUID-711EE477-C725-40BE-A82B-1880EECBF912"></a><h3 id="TDDDG-GUID-711EE477-C725-40BE-A82B-1880EECBF912" class="sect3"><span class="enumeration_section">5.2</span>关于包裹</h3>
               <div>
                  <p><strong class="term">包</strong>是一个PL / SQL单元，由相关的子程序和它们使用的声明游标和变量组成。Oracle建议您将子程序放入包中。
                  </p>
                  <p>Oracle建议您将子程序放入包中的一些原因是：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>包允许您隐藏客户端程序的实现细节。</p>
                        <p>隐藏客户端程序的实现细节是一种被广泛接受的最佳实践。许多Oracle客户严格遵循这种做法，只允许客户端程序通过调用PL / SQL子程序来访问数据库。一些客户允许客户端程序使用<span class="keyword">SELECT</span>语句从数据库表中检索信息，但要求他们为所有更改数据库的业务功能调用PL / SQL子程序。
                        </p>
                     </li>
                     <li>
                        <p>从包外部调用时，包子程序必须使用包名限定，这可确保在从包外部调用时，它们的名称始终有效。</p>
                        <p>例如，假设您在Oracle Database <span class="italic">11g</span>之前开发了名为CONTINUE的模式级过程。Oracle Database <span class="italic">11g</span>引入了<span class="keyword">CONTINUE</span>语句。因此，如果将代码移植到Oracle Database <span class="italic">11g</span> ，它将不再编译。但是，如果您在包中开发了过程，则代码将引用过程作为<span class="italic">package_name</span> 。CONTINUE，所以代码仍然可以编译。
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-711EE477-C725-40BE-A82B-1880EECBF912__GUID-A6580A92-3EDB-4442-8E2A-C4B0B92E2176">
                     <p class="notep1">注意：</p>
                     <p>Oracle数据库提供了许多PL / SQL包，以扩展数据库功能并提供对SQL功能的PL / SQL访问。您可以在创建应用程序时使用提供的包，也可以在创建自己的存储过程时使用提供的包。有关这些包的信息，请参阅<a href="../arpls/index.html" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a> 。
                     </p>
                  </div>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-711EE477-C725-40BE-A82B-1880EECBF912__GUID-404044BB-9F2A-4F2D-8CA8-2FD33FDEAD73">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关包的一般信息，请参阅<a href="../cncpt/server-side-programming.html#CNCPT1784" target="_blank"><span class="italic">Oracle数据库概念</span></a></p>
                        </li>
                        <li>
                           <p><a href="../lnpls/plsql-packages.html#LNPLS00902" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a>了解更多使用包的原因</p>
                        </li>
                        <li>
                           <p>有关PL / SQL包的完整信息，请<a href="../lnpls/plsql-packages.html#LNPLS009" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p><a href="../arpls/index.html" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考，</span></a>以获取有关Oracle提供的PL / SQL包的完整信息</p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TDDDG42210"></a><div class="props_rev_3"><a id="GUID-558EF48E-4929-435C-A3CC-32EB3C048C98" name="GUID-558EF48E-4929-435C-A3CC-32EB3C048C98"></a><h3 id="TDDDG-GUID-558EF48E-4929-435C-A3CC-32EB3C048C98" class="sect3"><span class="enumeration_section">5.3</span>关于PL / SQL标识符</h3>
               <div>
                  <p>每个PL / SQL子程序，包，参数，变量，常量，异常和声明的游标都有一个名称，它是一个PL / SQL标识符。</p>
                  <p>标识符的最小长度是一个字符;最大长度为30个字符。第一个字符必须是字母，但每个后面的字符可以是字母，数字，美元符号（$），下划线（_）或数字符号（＃）。例如，这些是可接受的标识符：</p><pre class="oac_no_warn" dir="ltr">X t2手机＃credit_limit姓氏oracle $ number money $$$树SN ## try_again_</pre><p>PL / SQL对标识符不区分大小写。例如，PL / SQL认为这些是相同的：</p><pre class="oac_no_warn" dir="ltr">lastname LastName LASTNAME</pre><p>您不能使用PL / SQL保留字作为标识符。您可以使用PL / SQL关键字作为标识符，但不建议这样做。有关PL / SQL保留字和关键字的列表，请参阅<a href="../lnpls/plsql-reserved-words-keywords.html#LNPLS019" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-558EF48E-4929-435C-A3CC-32EB3C048C98__GUID-162D313A-3EAB-452B-9120-4BF5FE111BF6">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关PL / SQL标识符的其他常规信息，请<a href="../lnpls/plsql-language-fundamentals.html#LNPLS99973" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p>有关PL / SQL命名约定的其他信息，请<a href="../lnpls/plsql-language-fundamentals.html#LNPLS99973" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p>有关PL / SQL标识符的范围和可见性的信息，请<a href="../lnpls/plsql-language-fundamentals.html#LNPLS99945" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p>有关如何收集PL / SQL标识符数据的信息，请参阅<a href="../lnpls/plsql-optimization-and-tuning.html#LNPLS01213" target="_blank"><span class="italic">Oracle数据库PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p>有关PL / SQL如何解析标识符名称的信息，请参阅<a href="../lnpls/plsql-name-resolution.html#LNPLS017" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TDDDG42100"></a><div class="props_rev_3"><a id="GUID-6C848D95-8B1E-436E-835D-2225567977B5" name="GUID-6C848D95-8B1E-436E-835D-2225567977B5"></a><h3 id="TDDDG-GUID-6C848D95-8B1E-436E-835D-2225567977B5" class="sect3"><span class="enumeration_section">5.4</span>关于PL / SQL数据类型</h3>
               <div>
                  <p>每个PL / SQL常量，变量，子程序参数和函数返回值都有一个数据类型，用于确定其存储格式，约束，有效值范围以及可对其执行的操作。</p>
                  <p>PL / SQL数据类型是SQL数据类型（例如<span class="keyword">VARCHAR2</span> ， <span class="keyword">NUMBER</span>或<span class="keyword">DATE</span> ）或仅PL / SQL数据类型。后者包括<span class="keyword">BOOLEAN</span> ， <span class="keyword">RECORD</span> ， <span class="keyword">REF CURSOR</span>和许多预定义的子类型。PL / SQL还允许您定义自己的子类型。
                  </p>
                  <p><strong class="term">子类型</strong>是另一种数据类型的子集，称为其<strong class="term">基本类型</strong> 。子类型与其基本类型具有相同的有效操作，但只有其有效值的子集。子类型可以提高可靠性，提供与ANSI / ISO类型的兼容性，并通过指示常量和变量的预期用途来提高可读性。
                  </p>
                  <p>预定义的数字子类型<span class="keyword">PLS_INTEGER</span>特别有用，因为它的操作使用硬件算法，而不是其基类型使用的库算法。
                  </p>
                  <p>您不能在架构级别（即表或独立子程序中）使用仅PL / SQL数据类型。因此，要在存储的子程序中使用这些数据类型，必须将它们放在包中。</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-6C848D95-8B1E-436E-835D-2225567977B5__GUID-1C188F21-998B-4B6E-ACAF-C05D105D1587">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关PL / SQL数据类型的一般信息，请<a href="../lnpls/plsql-data-types.html#LNPLS003" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p>有关<span class="keyword">PLS_INTEGER</span>数据类型的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00305" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="creating-managing-schema-objects.html#GUID-033333E2-F3CE-4161-A6C3-BA9811E58D5D" title="创建表时，必须为每列指定SQL数据类型，以确定列可包含的值。">关于SQL数据类型</a> ”</span></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="TDDDG41000"></a><div class="props_rev_4"><a id="GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C" name="GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C"></a><h3 id="TDDDG-GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C" class="sect3"><span class="enumeration_section">5.5</span>创建和管理独立子程序</h3>
               <div>
                  <p>您可以创建和管理独立的PL / SQL子程序。</p>
                  <div class="infoboxnote" id="GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C__GUID-493716F8-6AA3-4015-A69A-E0C83E4FDE15">
                     <p class="notep1">注意：</p>
                     <p>要执行本文档中的教程，您必须以SQL Developer中的用户HR身份连接到Oracle数据库。</p>
                  </div>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-8C076E20-30D0-4E91-8485-246B02FA5BB8">关于子程序结构</a><br></li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44">教程：创建独立过程</a><br>本教程介绍如何使用“创建过程”工具创建名为ADD_EVALUATION的独立过程，该过程向EVALUATIONS表添加一行。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735">教程：创建独立功能</a><br>本教程介绍如何使用“创建函数”工具创建名为CALCULATE_SCORE的独立函数，该函数具有三个参数并返回<span class="keyword">NUMBER</span>类型的值。</li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-FFEAD0D9-4234-422B-A683-9CA63B0C173E">更改独立子程序</a><br>要更改独立子程序，请使用SQL Developer工具Edit或DDL语句<span class="keyword">ALTER PROCEDURE</span>或<span class="keyword">ALTER FUNCTION</span> 。</li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-0BB18DA5-209F-4B12-9D52-4FF3074B0A5A">教程：测试独立功能</a><br>本教程介绍如何使用SQL Developer工具Run来测试独立函数CALCULATE_SCORE。</li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-0BA5A5AC-7E7C-4D14-9A46-8A7A15DC1F81">删除独立子程序</a><br>要删除独立子程序，请使用SQL Developer <span class="wintitle">Connections</span>框架和Drop工具，或DDL语句<span class="keyword">DROP PROCEDURE</span>或<span class="keyword">DROP FUNCTION</span> 。</li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               <a id="TDDDG42205"></a><div class="props_rev_3"><a id="GUID-8C076E20-30D0-4E91-8485-246B02FA5BB8" name="GUID-8C076E20-30D0-4E91-8485-246B02FA5BB8"></a><h4 id="TDDDG-GUID-8C076E20-30D0-4E91-8485-246B02FA5BB8" class="sect4"><span class="enumeration_section">5.5.1</span>关于子程序结构</h4>
                  <div>
                     <p></p>
                     <p>子程序遵循PL / SQL块结构;也就是说，它有：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><strong class="term">声明部分</strong> （可选）</p>
                           <p>声明性部分包含类型，常量，变量，异常，声明游标和嵌套子程序的声明。这些项目是子程序的本地项目，并在子程序完成执行时不再存在。</p>
                        </li>
                        <li>
                           <p><strong class="term">可执行部分</strong> （必填）</p>
                           <p>可执行部分包含分配值，控制执行和操作数据的语句。</p>
                        </li>
                        <li>
                           <p><strong class="term">异常处理部分</strong> （可选）</p>
                           <p>异常处理部分包含处理异常（运行时错误）的代码。</p>
                        </li>
                     </ul>
                     <p><strong class="term">注释</strong>可以出现在PL / SQL代码中的任何位置。PL / SQL编译器会忽略它们。为您的计划添加评论可提高可读性并有助于理解。<strong class="term">单行注释</strong>以双连字符（ <code class="codeph">--</code> ）开头，并延伸到行尾。<strong class="term">多行注释</strong>以斜杠和星号（ <code class="codeph">/*</code> ）开头，以星号和斜杠（ <code class="codeph">*/</code> ）结尾。
                     </p>
                     <p>程序的结构是：</p><pre class="oac_no_warn" dir="ltr">PROCEDURE <span class="italic">名称</span> [（ <span class="italic">parameter_list</span> ）] {IS | AS} [ <span class="italic">declarative_part</span> ] BEGIN  - 可执行部分开始<span class="italic">声明</span> ; [ <span class="italic">声明</span> ; ] ...[EXCEPTION  - 可执行部分结束，异常处理部分开始] <span class="italic">exception_handler</span> ; [ <span class="italic">exception_handler</span> ; ] ...] 结束; / *异常处理部分如果存在则结束;否则，可执行部分结束* /</pre><p>函数的结构类似于过程的结构，除了它包含<code class="codeph">RETURN</code>子句和至少一个<code class="codeph">RETURN</code>语句（以及一些超出本文档范围的可选子句）：</p><pre class="oac_no_warn" dir="ltr">FUNCTION <span class="italic">name</span> [（ <span class="italic">parameter_list</span> ）] <span class="bold">RETURN</span> <span class="italic"><span class="bold"><code class="codeph">data_type</code></span></span> [ <span class="italic">clauses</span> ] {IS | AS} [ <span class="italic">declarative_part</span> ] BEGIN  - 可执行部分开始 - <span class="bold">至少一个语句必须是RETURN语句</span> <span class="italic">语句</span> ; [ <span class="italic">声明</span> ; ] ...[EXCEPTION  - 可执行部分结束，异常处理部分开始] <span class="italic">exception_handler</span> ; [ <span class="italic">exception_handler</span> ; ] ...] 结束; / *异常处理部分如果存在则结束;否则，可执行部分结束* /</pre><p>以<span class="keyword">PROCEDURE</span>或<span class="keyword">FUNCTION</span>开头并在<span class="keyword">IS</span>或<span class="keyword">AS</span>之前结束的代码是<strong class="term">子程序签名</strong> 。声明性，可执行和异常处理部分构成<strong class="term">子程序体</strong> 。<span class="synph">exception-handler</span>的语法在<span class="q">“ <a href="stored-subprograms-packages.html#GUID-46958EB5-3629-4E28-A922-9899D73F93FB" title="当PL / SQL代码中发生运行时错误时，会引发异常。如果引发异常的子程序（或块）具有异常处理部分，则控制转移到它;否则，执行停止。">关于异常和异常处理程序</a> ”中</span> 。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-8C076E20-30D0-4E91-8485-246B02FA5BB8__GUID-8B26424D-1DDB-463D-BA72-CD30C88C50A8">
                        <p class="notep1">也可以看看：</p>
                        <p>有关子程序部分的更多信息，请<a href="../lnpls/plsql-subprograms.html#LNPLS99897" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C" title="您可以创建和管理独立的PL / SQL子程序。">创建和管理独立子程序</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG215"></a><a id="TDDDG99975"></a><div class="props_rev_3"><a id="GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44" name="GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44"></a><h4 id="TDDDG-GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44" class="sect4"><span class="enumeration_section">5.5.2</span>教程：创建独立过程</h4>
                  <div>
                     <p>本教程介绍如何使用“创建过程”工具创建名为ADD_EVALUATION的独立过程，该过程向EVALUATIONS表添加一行。</p>
                     <div class="section">
                        <p>EVALUATIONS表在<a href="creating-managing-schema-objects.html#GUID-E30613F2-506F-4A41-B167-B3F07968DD7A__CHDJCGGG">例4-1</a>中创建。
                        </p>
                        <p>要创建独立过程，请使用SQL Developer工具Create Procedure或DDL语句<span class="keyword">CREATE PROCEDURE</span> 。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__GUID-BA9AB9A1-FDE8-4AAC-BC13-DFD91EA15B7E">要使用“创建过程”工具创建独立过程：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，右键单击“ <span class="uicontrol bold">过程”</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">新建过程”</span> 。</span><div>
                              <p>将打开“ <span class="wintitle">创建过程”</span>窗口。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>对于<span class="wintitle">Schema</span> ，接受默认值HR。</span></li>
                        <li class="stepexpand"><span>对于<span class="wintitle">Name</span> ，将PROCEDURE1更改为<kbd class="userinput">ADD_EVALUATION</kbd> 。</span></li>
                        <li class="stepexpand" id="GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABJCIIF"><span>单击图标<span class="uicontrol bold">添加参数</span> 。</span><div>
                              <p>列标题下方会显示一行。其字段具有以下默认值： <span class="wintitle">Name</span> ，PARAM1; <span class="wintitle">模式</span> ， <span class="keyword">IN</span> ; <span class="wintitle">没有复制</span> ，取消选择; <span class="wintitle">数据类型</span> ， <span class="keyword">VARCHAR2</span> ; <span class="wintitle">默认值</span> ，为空。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>对于<span class="wintitle">Name</span> ，将PARAM1更改为<kbd class="userinput">EVALUATION_ID</kbd> 。</span></li>
                        <li class="stepexpand"><span>对于<span class="wintitle">Mode</span> ，接受默认值<span class="keyword">IN</span> 。</span></li>
                        <li class="stepexpand"><span>对于<span class="wintitle">数据类型</span> ，从菜单中选择<span class="uicontrol bold">NUMBER</span> 。</span></li>
                        <li class="stepexpand" id="GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABFCHHF"><span>将<span class="wintitle">默认值</span>保留为空。</span></li>
                        <li class="stepexpand"><span>通过使用<span class="wintitle">名称</span> <kbd class="userinput">EMPLOYEE_ID</kbd>和<span class="wintitle">数据类型</span> <span class="keyword">NUMBER</span>重复步骤<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABJCIIF">6</a>到<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABFCHHF">10来</a>添加第二个参数。</span></li>
                        <li class="stepexpand"><span>通过使用<span class="wintitle">Name</span> <kbd class="userinput">EVALUATION_DATE</kbd>和<span class="wintitle">Data Type</span> <span class="keyword">DATE</span>重复步骤<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABJCIIF">6</a>到<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABFCHHF">10来</a>添加第三个参数。</span></li>
                        <li class="stepexpand"><span>通过使用<span class="wintitle">名称</span> <kbd class="userinput">JOB_ID</kbd>和<span class="wintitle">数据类型</span> <span class="keyword">VARCHAR2</span>重复步骤<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABJCIIF">6</a>到<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABFCHHF">10来</a>添加第四个参数。</span></li>
                        <li class="stepexpand"><span>使用<span class="wintitle">Name</span> <kbd class="userinput">MANAGER_ID</kbd>和<span class="wintitle">Data Type</span> <span class="keyword">NUMBER</span>重复步骤<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABJCIIF">6</a>到<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABFCHHF">10</a> ，添加第五个参数。</span></li>
                        <li class="stepexpand"><span>使用<span class="wintitle">名称</span> <kbd class="userinput">DEPARTMENT_ID</kbd>和<span class="wintitle">数据类型</span> <span class="keyword">NUMBER</span>重复步骤<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABJCIIF">6</a>到<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABFCHHF">10</a> ，添加第六个参数。</span></li>
                        <li class="stepexpand"><span>通过使用<span class="wintitle">名称</span> <kbd class="userinput">TOTAL_SCORE</kbd>和<span class="wintitle">数据类型</span> <span class="keyword">NUMBER</span>重复步骤<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABJCIIF">6</a>到<a href="stored-subprograms-packages.html#GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__BABFCHHF">10来</a>添加第七个参数。</span></li>
                        <li class="stepexpand"><span>单击<span class="bold">确定</span> 。</span><div><pre class="oac_no_warn" dir="ltr"><span class="bold">CREATE OR REPLACE PROCEDURE</span> ADD_EVALUATION（EVALUATION_ID <span class="bold">在数量</span> ，EMPLOYEE_ID <span class="bold">在数量</span> ，EVALUATION_DATE <span class="bold">IN DATE，JOB_ID</span> <span class="bold">IN VARCHAR2，MANAGER_ID</span> <span class="bold">在数量</span> ，DEPARTMENT_ID <span class="bold">在数量</span> ，TOTAL_SCORE <span class="bold">IN <span class="bold">NUMBER）AS</span></span> <span class="bold">BEGIN</span> <span class="bold">NULL;</span> <span class="bold">END</span> ADD_EVALUATION;</pre><p><span class="wintitle">ADD_EVALUATION</span>窗格的标题是斜体字体，表示该过程尚未保存在数据库中。
                              </p>
                              <p>由于过程的执行部分仅包含<span class="keyword">NULL</span>语句，因此该过程不执行任何操作。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>用此语句替换<span class="keyword">NULL</span>语句：</span><div><pre class="oac_no_warn" dir="ltr">INSERT INTO EVALUATIONS（evaluation_id，employee_id，evaluation_date，job_id，manager_id，department_id，total_score）VALUES（ADD_EVALUATION.evaluation_id，ADD_EVALUATION.employee_id，ADD_EVALUATION.evaluation_date，ADD_EVALUATION.job_id，ADD_EVALUATION.manager_id，ADD_EVALUATION.department_id，ADD_EVALUATION.total_score）;</pre><p>（使用过程名称限定参数名称可确保它们不会与具有相同名称的列混淆。）</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>从“文件”菜单中，选择“ <span class="uicontrol bold">保存”</span> 。</span><div>
                              <p>Oracle数据库编译该过程并将其保存。<span class="wintitle">ADD_EVALUATION</span>窗格的标题不再是斜体字体。“ <span class="wintitle">消息 - 日志”</span>窗格具有“已<samp class="sysout">编译</samp> ”消息。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-05E1E3F2-F1F5-4EA9-B29D-5BBA28DAEB44__GUID-D0D14C05-2176-4B78-9637-E6938BE03D1A">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=RPTUG20600" target="_blank"><span class="italic">Oracle SQL Developer用户指南</span></a> ，了解使用SQL Developer创建独立过程的另一个示例</p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="creating-managing-schema-objects.html#GUID-0663F857-7E62-464C-9EE8-42BC600FAA6C" title="数据定义语言（DDL）语句创建，更改和删除模式对象。在DDL语句之前和之后，Oracle数据库发出隐式COMMIT语句;因此，您无法回滚DDL语句。">关于数据定义语言（DDL）语句</a> ”，</span>用于适用于<span class="keyword">CREATE PROCEDURE</span>语句的一般信息</p>
                           </li>
                           <li>
                              <p>有关<span class="keyword">CREATE PROCEDURE</span>语句的信息，请<a href="../lnpls/CREATE-PROCEDURE-statement.html#LNPLS01373" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C" title="您可以创建和管理独立的PL / SQL子程序。">创建和管理独立子程序</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG216"></a><a id="TDDDG99984"></a><div class="props_rev_3"><a id="GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735" name="GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735"></a><h4 id="TDDDG-GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735" class="sect4"><span class="enumeration_section">5.5.3</span>教程：创建独立功能</h4>
                  <div>
                     <p>本教程介绍如何使用“创建函数”工具创建名为CALCULATE_SCORE的独立函数，该函数具有三个参数并返回<span class="keyword">NUMBER</span>类型的值。</p>
                     <div class="section">
                        <p>要创建独立函数，请使用SQL Developer工具Create Function或DDL语句<span class="keyword">CREATE FUNCTION</span> 。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735__GUID-F797379D-05C9-48ED-8DC6-599B4EFDB9AF">要使用“创建函数”工具创建独立函数：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，右键单击“ <span class="uicontrol bold">函数”</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">新建功能”</span> 。</span><div>
                              <p>将打开“ <span class="wintitle">创建函数”</span>窗口。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>对于<span class="wintitle">Schema</span> ，接受默认值HR。</span></li>
                        <li class="stepexpand"><span>对于<span class="wintitle">Name</span> ，将FUNCTION1更改为<kbd class="userinput">CALCULATE_SCORE</kbd> 。</span></li>
                        <li class="stepexpand"><span>对于<span class="wintitle">返回类型</span> ，从菜单中选择<span class="uicontrol bold">NUMBER</span> 。</span></li>
                        <li class="stepexpand" id="GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735__BABBECCF"><span>单击图标<span class="uicontrol bold">添加参数</span> 。</span><div>
                              <p>列标题下方会显示一行。其字段具有以下默认值： <span class="wintitle">Name</span> ，PARAM1; <span class="wintitle">模式</span> ， <span class="keyword">IN</span> ; <span class="wintitle">没有复制</span> ，取消选择; <span class="wintitle">数据类型</span> ， <span class="keyword">VARCHAR2</span> ; <span class="wintitle">默认值</span> ，为空。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>对于<span class="wintitle">Name</span> ，将PARAM1更改为<kbd class="userinput">cat</kbd> 。</span></li>
                        <li class="stepexpand"><span>对于<span class="wintitle">Mode</span> ，接受默认值<span class="keyword">IN</span> 。</span></li>
                        <li class="stepexpand"><span>对于<span class="wintitle">数据类型</span> ，接受默认值<span class="keyword">VARCHAR2</span> 。</span></li>
                        <li class="stepexpand" id="GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735__BABFDIBH"><span>将<span class="wintitle">默认值</span>保留为空。</span></li>
                        <li class="stepexpand"><span>通过使用“ <span class="wintitle">名称”</span> <kbd class="userinput">分数</kbd>和“ <span class="wintitle">数据类型”</span> <span class="keyword">NUMBER</span>重复步骤<a href="stored-subprograms-packages.html#GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735__BABBECCF">7</a>到<a href="stored-subprograms-packages.html#GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735__BABFDIBH">11</a> ，添加第二个参数。</span></li>
                        <li class="stepexpand"><span>通过使用<span class="wintitle">名称</span> <kbd class="userinput">权重</kbd>和<span class="wintitle">数据类型</span> <span class="keyword">NUMBER</span>重复步骤<a href="stored-subprograms-packages.html#GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735__BABBECCF">7</a>到<a href="stored-subprograms-packages.html#GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735__BABFDIBH">11来</a>添加第三个参数。</span></li>
                        <li class="stepexpand"><span>单击<span class="uicontrol bold">确定</span> 。</span><div>
                              <p>将打开<span class="wintitle">CALCULATE_SCORE</span>窗格，其中显示了创建该函数的<span class="keyword">CREATE FUNCTION</span>语句：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">创建或替换功能</span> CALCULATE_SCORE（CAT <span class="bold">在VARCHAR2中</span> ，分数<span class="bold">在数字中</span> ，重量<span class="bold">在数字中</span> ） <span class="bold">返回数字为</span> <span class="bold">BEGIN</span> <span class="bold">RETURN NULL</span> ; <span class="bold">END</span> CALCULATE_SCORE;</pre><p><span class="wintitle">CALCULATE_SCORE</span>窗格的标题是斜体字体，表示该功能尚未保存在数据库中。
                              </p>
                              <p>因为函数执行部分中唯一的语句是语句<span class="keyword">RETURN NULL</span> ，所以函数什么都不做。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>用<kbd class="userinput">score * weight</kbd>替换<span class="keyword">NULL</span> 。</span></li>
                        <li class="stepexpand"><span>从“ <span class="wintitle">文件”</span>菜单中，选择“ <span class="uicontrol bold">保存”</span> 。</span><div>
                              <p>Oracle数据库编译该函数并保存它。<span class="wintitle">CALCULATE_SCORE</span>窗格的标题不再是斜体字体。“ <span class="wintitle">消息 - 日志”</span>窗格具有“已<samp class="sysout">编译</samp> ”消息。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B89C969D-B6E5-4E6C-8184-58BC909EA735__GUID-ABABC482-DBA3-4222-8AE3-609485B8D836">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="creating-managing-schema-objects.html#GUID-0663F857-7E62-464C-9EE8-42BC600FAA6C" title="数据定义语言（DDL）语句创建，更改和删除模式对象。在DDL语句之前和之后，Oracle数据库发出隐式COMMIT语句;因此，您无法回滚DDL语句。">关于数据定义语言（DDL）语句</a> ”</span> ，适用于<span class="keyword">CREATE FUNCTION</span>语句的一般信息</p>
                           </li>
                           <li>
                              <p>有关<span class="keyword">CREATE FUNCTION</span>语句的信息，请<a href="../lnpls/CREATE-FUNCTION-statement.html#LNPLS01370" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C" title="您可以创建和管理独立的PL / SQL子程序。">创建和管理独立子程序</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG217"></a><a id="TDDDG41200"></a><div class="props_rev_3"><a id="GUID-FFEAD0D9-4234-422B-A683-9CA63B0C173E" name="GUID-FFEAD0D9-4234-422B-A683-9CA63B0C173E"></a><h4 id="TDDDG-GUID-FFEAD0D9-4234-422B-A683-9CA63B0C173E" class="sect4"><span class="enumeration_section">5.5.4</span>更改独立子程序</h4>
                  <div>
                     <p>要更改独立子程序，请使用SQL Developer工具Edit或DDL语句<span class="keyword">ALTER PROCEDURE</span>或<span class="keyword">ALTER FUNCTION</span> 。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-FFEAD0D9-4234-422B-A683-9CA63B0C173E__GUID-406BE374-C2DE-4BED-980A-C6B29BBD7394">要使用“编辑”工具更改独立子程序：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，展开“ <span class="uicontrol bold">函数”</span>或“ <span class="uicontrol bold">过程”</span> 。</span><div>
                              <p>出现功能或过程列表。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>单击要更改的功能或过程。</span><div>
                              <p>在<span class="wintitle">Connections</span>框架的右侧，出现一个框架。其顶部选项卡具有要更改的子程序的名称。“ <span class="wintitle">代码”</span>窗格显示创建子程序的代码。
                              </p>
                              <p>“ <span class="wintitle">代码”</span>窗格处于写入模式。（单击铅笔图标可将模式从写入模式切换为只读，反之亦然。）
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在“ <span class="wintitle">代码”</span>窗格中，更改代码。</span><div>
                              <p>窗格的标题更改为斜体字体，表示更改尚未保存在数据库中。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>从“ <span class="wintitle">文件”</span>菜单中，选择“ <span class="uicontrol bold">保存”</span> 。</span><div>
                              <p>Oracle数据库编译子程序并保存它。窗格的标题不再是斜体字体。“ <span class="wintitle">消息 - 日志”</span>窗格具有“已<samp class="sysout">编译</samp> ”消息。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-FFEAD0D9-4234-422B-A683-9CA63B0C173E__GUID-A9BE04CE-A824-44B8-96D6-F81AE6D7047C">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="creating-managing-schema-objects.html#GUID-0663F857-7E62-464C-9EE8-42BC600FAA6C" title="数据定义语言（DDL）语句创建，更改和删除模式对象。在DDL语句之前和之后，Oracle数据库发出隐式COMMIT语句;因此，您无法回滚DDL语句。">关于数据定义语言（DDL）语句</a> ”</span> ，适用于适用于<span class="keyword">ALTER PROCEDURE</span>和<span class="keyword">ALTER FUNCTION</span>语句的一般信息</p>
                           </li>
                           <li>
                              <p>有关<span class="keyword">ALTER PROCEDURE</span>语句的信息，请<a href="../lnpls/ALTER-PROCEDURE-statement.html#LNPLS99997" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<span class="keyword">ALTER FUNCTION</span>语句的信息，请<a href="../lnpls/ALTER-FUNCTION-statement.html#LNPLS99999" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C" title="您可以创建和管理独立的PL / SQL子程序。">创建和管理独立子程序</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG218"></a><a id="TDDDG41400"></a><div class="props_rev_3"><a id="GUID-0BB18DA5-209F-4B12-9D52-4FF3074B0A5A" name="GUID-0BB18DA5-209F-4B12-9D52-4FF3074B0A5A"></a><h4 id="TDDDG-GUID-0BB18DA5-209F-4B12-9D52-4FF3074B0A5A" class="sect4"><span class="enumeration_section">5.5.5</span>教程：测试独立功能</h4>
                  <div>
                     <p>本教程介绍如何使用SQL Developer工具Run来测试独立函数CALCULATE_SCORE。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-0BB18DA5-209F-4B12-9D52-4FF3074B0A5A__GUID-B9005814-C563-4056-868D-DD5CF5A87AB2">要使用“运行”工具测试CALCULATE_SCORE函数：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，展开“ <span class="uicontrol bold">函数”</span> 。</span></li>
                        <li class="stepexpand"><span>在函数列表中，右键单击<span class="uicontrol bold">CALCULATE_SCORE</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击<span class="uicontrol bold">“运行”</span> 。</span><div>
                              <p>将打开“ <span class="wintitle">运行PL / SQL”</span>窗口。其PL / SQL Block框架包含以下代码：</p><pre class="oac_no_warn" dir="ltr">v_Return：= CALCULATE_SCORE（CAT =&gt; CAT，SCORE =&gt; SCORE，WEIGHT =&gt; WEIGHT）;</pre></div>
                        </li>
                        <li class="stepexpand"><span>将<span class="wintitle">SCORE</span>和<span class="wintitle">WEIGHT</span>的值分别更改为<kbd class="userinput">8</kbd>和<kbd class="userinput">0.2</kbd> ：</span><div><pre class="oac_no_warn" dir="ltr">v_Return：= CALCULATE_SCORE（CAT =&gt; CAT，SCORE =&gt; <span class="bold">8</span> ，WEIGHT =&gt; <span class="bold">0.2</span> ）;</pre></div>
                        </li>
                        <li class="stepexpand"><span>单击<span class="uicontrol bold">确定</span> 。</span><div>
                              <p>在“ <span class="wintitle">代码”</span>窗格下，将打开“ <span class="wintitle">运行”</span>窗口，显示以下结果：</p><pre class="oac_no_warn" dir="ltr">连接到数据库hr_conn。流程已退出。断开与数据库hr_conn的连接。
</pre><p>“ <span class="wintitle">运行</span> ”选项卡右侧是“ <span class="wintitle">输出变量</span> ”选项卡。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>单击选项卡<span class="uicontrol bold">输出变量</span> 。</span><div>
                              <p>出现两个框架，即<span class="wintitle">Variable</span>和<span class="wintitle">Value</span> ，它们分别包含值&lt;Return Value&gt;和1.6。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-0BB18DA5-209F-4B12-9D52-4FF3074B0A5A__GUID-582972DB-6AFC-495A-8C42-6E951C615432">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=RPTUG10600" target="_blank"><span class="italic">Oracle SQL Developer用户指南</span></a> ，了解有关使用SQL Developer运行和调试过程和函数的信息</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C" title="您可以创建和管理独立的PL / SQL子程序。">创建和管理独立子程序</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG219"></a><a id="TDDDG41300"></a><div class="props_rev_3"><a id="GUID-0BA5A5AC-7E7C-4D14-9A46-8A7A15DC1F81" name="GUID-0BA5A5AC-7E7C-4D14-9A46-8A7A15DC1F81"></a><h4 id="TDDDG-GUID-0BA5A5AC-7E7C-4D14-9A46-8A7A15DC1F81" class="sect4"><span class="enumeration_section">5.5.6</span>删除独立子程序</h4>
                  <div>
                     <p>要删除独立子程序，请使用SQL Developer <span class="wintitle">Connections</span>框架和Drop工具，或DDL语句<span class="keyword">DROP PROCEDURE</span>或<span class="keyword">DROP FUNCTION</span> 。</p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-0BA5A5AC-7E7C-4D14-9A46-8A7A15DC1F81__GUID-69535032-842C-48C9-B0BA-190E766B361F">
                           <p class="notep1">警告：</p>
                           <p>不要删除过程<code class="codeph">ADD_EVALUATION</code>或函数<code class="codeph">CALCULATE_SCORE</code> - 您需要它们以供以后的教程使用。如果要练习删除子程序，请创建简单的子程序然后删除它们。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-0BA5A5AC-7E7C-4D14-9A46-8A7A15DC1F81__GUID-F5CACE33-286C-4566-AC04-E52578257060">要使用Drop工具删除独立子程序：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li><span>在架构对象类型列表中，展开“ <span class="uicontrol bold">函数”</span>或“ <span class="uicontrol bold">过程”</span> 。</span></li>
                        <li><span>在函数或过程列表中，右键单击要删除的函数或过程的名称。</span></li>
                        <li><span>在选项列表中，单击“ <span class="uicontrol bold">删除”</span> 。</span></li>
                        <li><span>在“ <span class="wintitle">下拉”</span>窗口中，单击“ <span class="uicontrol bold">应用”</span> 。</span></li>
                        <li><span>在“ <span class="wintitle">确认”</span>窗口中，单击“ <span class="uicontrol bold">确定”</span> 。</span></li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-0BA5A5AC-7E7C-4D14-9A46-8A7A15DC1F81__GUID-872CD71C-BA3D-4FBD-A478-DB45CDFC7BD7">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="creating-managing-schema-objects.html#GUID-0663F857-7E62-464C-9EE8-42BC600FAA6C" title="数据定义语言（DDL）语句创建，更改和删除模式对象。在DDL语句之前和之后，Oracle数据库发出隐式COMMIT语句;因此，您无法回滚DDL语句。">关于数据定义语言（DDL）语句</a> ”</span> ，适用于适用于<span class="keyword">DROP PROCEDURE</span>和<span class="keyword">DROP FUNCTION</span>语句的一般信息</p>
                           </li>
                           <li>
                              <p>有关<span class="keyword">DROP PROCEDURE</span>语句的信息，请<a href="../sqlrf/DROP-PROCEDURE.html#SQLRF01528" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<span class="keyword">DROP FUNCTION</span>语句的信息，请<a href="../sqlrf/DROP-FUNCTION.html#SQLRF01518" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-0712D99B-5AE1-4E5E-8B8E-630783D4D86C" title="您可以创建和管理独立的PL / SQL子程序。">创建和管理独立子程序</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TDDDG47000"></a><div class="props_rev_4"><a id="GUID-84755B9D-6E53-4066-8FEE-5FD1A42B6484" name="GUID-84755B9D-6E53-4066-8FEE-5FD1A42B6484"></a><h3 id="TDDDG-GUID-84755B9D-6E53-4066-8FEE-5FD1A42B6484" class="sect3"><span class="enumeration_section">5.6</span>创建和管理包</h3>
               <div>
                  <p>您可以创建和管理PL / SQL包。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-2B6A3A0E-59B9-421B-8446-EC98453311ED">关于包结构</a><br>包总是有规格，通常有一个正文。规范定义了包本身，是一个应用程序接口（API）。正文定义了声明游标的查询，以及在程序包规范中声明的子程序的代码。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-B781B764-7A16-43A4-B3E7-310F2D53AFDA">教程：创建包规范</a><br>本教程介绍如何使用“创建包”工具为名为EMP_EVAL的包创建规范，该包出现在本文档的许多教程和示例中。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-70B09116-C33F-452A-878E-DFFD9C91ACBD">教程：更改包规范</a><br>本教程介绍如何使用“编辑”工具更改EMP_EVAL包的规范，该规范出现在本文档的许多教程和示例中。具体来说，本教程将介绍如何为过程EVAL_DEPARTMENT和函数CALCULATE_SCORE添加声明。</li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-056688EF-E8CD-4215-A832-D004ABFB993C">教程：创建包体</a><br>本教程介绍如何使用Create Body工具为EMP_EVAL包创建一个主体，该主题出现在本文档的许多示例和教程中。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-BEE92DA5-F64D-4B6F-BA8D-216BD0F63A9C">丢弃包裹</a><br>要删除包（规范和正文），请使用SQL Developer <span class="wintitle">Connections</span>框架和Drop工具，或使用DDL语句<span class="keyword">DROP PACKAGE</span> 。</li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-84755B9D-6E53-4066-8FEE-5FD1A42B6484__GUID-4D7428CA-2260-4F17-B3A1-0F04A225A4E7">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="stored-subprograms-packages.html#GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413" title="本教程介绍如何使用SQL Developer工具Edit在EMP_EVAL.CALCULATE_SCORE函数中声明变量和常量。（本教程也是更改包体的示例。）">教程：在子程序中声明变量和常量</a> ”</span> ，其中显示了如何更改包体</p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               <a id="TDDDG99993"></a><div class="props_rev_3"><a id="GUID-2B6A3A0E-59B9-421B-8446-EC98453311ED" name="GUID-2B6A3A0E-59B9-421B-8446-EC98453311ED"></a><h4 id="TDDDG-GUID-2B6A3A0E-59B9-421B-8446-EC98453311ED" class="sect4"><span class="enumeration_section">5.6.1</span>关于包结构</h4>
                  <div>
                     <p>包总是有规格，通常有一个正文。规范定义了包本身，是一个应用程序接口（API）。正文定义了声明游标的查询，以及在程序包规范中声明的子程序的代码。</p>
                     <p><strong class="term">包规范</strong>定义了包，声明了可以从包外引用的类型，变量，常量，异常，声明的游标和子程序。包规范是一个<strong class="term">应用程序接口（API）</strong> ：它包含客户端程序调用其子程序所需的所有信息，但没有关于其实现的信息。
                     </p>
                     <p><strong class="term">包体</strong>定义了声明游标的查询，以及子程序的代码，这些查询在包规范中声明（因此，既没有声明游标也没有子程序的包不需要主体）。包体还可以定义<strong class="term">局部子程序</strong> ，这些<strong class="term">子程序</strong>未在规范中声明，并且只能由包中的其他子程序调用。程序包主体内容对客户端程序是隐藏的。您可以更改包体，而不会使调用包的应用程序无效。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-2B6A3A0E-59B9-421B-8446-EC98453311ED__GUID-D2F227FC-5C37-4E51-9514-38D3EF759336">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关包规范的更多信息，请<a href="../lnpls/plsql-packages.html#LNPLS00904" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关包体的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00905" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-84755B9D-6E53-4066-8FEE-5FD1A42B6484" title="您可以创建和管理PL / SQL包。">创建和管理包</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG220"></a><a id="TDDDG47200"></a><div class="props_rev_3"><a id="GUID-B781B764-7A16-43A4-B3E7-310F2D53AFDA" name="GUID-B781B764-7A16-43A4-B3E7-310F2D53AFDA"></a><h4 id="TDDDG-GUID-B781B764-7A16-43A4-B3E7-310F2D53AFDA" class="sect4"><span class="enumeration_section">5.6.2</span>教程：创建包规范</h4>
                  <div>
                     <p>本教程介绍如何使用“创建包”工具为名为EMP_EVAL的包创建规范，该包出现在本文档的许多教程和示例中。</p>
                     <div class="section">
                        <p>要创建包规范，请使用SQL Developer工具Create Package或DDL语句<span class="keyword">CREATE PACKAGE</span> 。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-B781B764-7A16-43A4-B3E7-310F2D53AFDA__GUID-2F3B1DD8-0C09-4493-A8DB-95B46EED637F">要使用“创建包”工具创建包规范：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，右键单击“ <span class="uicontrol bold">包”</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">新建包”</span> 。</span><div>
                              <p>将打开“ <span class="wintitle">创建包”</span>窗口。字段<span class="wintitle">Schema</span>具有值HR，字段<span class="wintitle">Name</span>具有默认值PACKAGE1，并且取消选中<span class="wintitle">Add New Source In</span> Lowercase复选框。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>对于<span class="wintitle">Schema</span> ，接受默认值HR。</span></li>
                        <li class="stepexpand"><span>对于<span class="wintitle">Name</span> ，将值PACKAGE1更改为<kbd class="userinput">EMP_EVAL</kbd> 。</span></li>
                        <li class="stepexpand"><span>单击<span class="underline">确定</span> 。</span><div>
                              <p>将打开<span class="wintitle">EMP_EVAL</span>窗格，其中显示了<span class="keyword">创建包</span>的<span class="keyword">CREATE PACKAGE</span>语句：</p><pre class="oac_no_warn" dir="ltr">创建或替换包emp_eval AS / * TODO在这里输入包声明（类型，异常，方法等）* / END emp_eval;</pre><p>窗格的标题是斜体字体，表示包未保存到数据库。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>（可选）在<span class="keyword">CREATE PACKAGE</span>语句中，将注释替换为声明。</span><div>
                              <p>如果您现在不执行此步骤，则可以稍后执行此操作，如<span class="q">“ <a href="stored-subprograms-packages.html#GUID-70B09116-C33F-452A-878E-DFFD9C91ACBD" title="本教程介绍如何使用“编辑”工具更改EMP_EVAL包的规范，该规范出现在本文档的许多教程和示例中。具体来说，本教程将介绍如何为过程EVAL_DEPARTMENT和函数CALCULATE_SCORE添加声明。">教程：更改包规范</a> ”中所述</span> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>从“文件”菜单中，选择“ <span class="uicontrol bold">保存”</span> 。</span><div>
                              <p>Oracle数据库编译包并保存它。<span class="wintitle">EMP_EVAL</span>窗格的标题不再是斜体字体。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B781B764-7A16-43A4-B3E7-310F2D53AFDA__GUID-221A38C5-3809-4A88-A491-E363FF240EFC">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01371" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a>有关<span class="keyword">CREATE PACKAGE</span>语句的信息（对于包规范）</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-84755B9D-6E53-4066-8FEE-5FD1A42B6484" title="您可以创建和管理PL / SQL包。">创建和管理包</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG221"></a><a id="TDDDG47300"></a><div class="props_rev_3"><a id="GUID-70B09116-C33F-452A-878E-DFFD9C91ACBD" name="GUID-70B09116-C33F-452A-878E-DFFD9C91ACBD"></a><h4 id="TDDDG-GUID-70B09116-C33F-452A-878E-DFFD9C91ACBD" class="sect4"><span class="enumeration_section">5.6.3</span>教程：更改包规范</h4>
                  <div>
                     <p>本教程介绍如何使用“编辑”工具更改EMP_EVAL包的规范，该规范出现在本文档的许多教程和示例中。具体来说，本教程将介绍如何为过程EVAL_DEPARTMENT和函数CALCULATE_SCORE添加声明。</p>
                     <div class="section">
                        <p>要更改包规范，请使用SQL Developer工具Edit或带有<span class="keyword">OR REPLACE</span>子句的DDL语句<span class="keyword">CREATE PACKAGE</span> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-70B09116-C33F-452A-878E-DFFD9C91ACBD__GUID-6A5B280D-6F44-4AAC-A693-252B9B465820">要使用“编辑”工具更改EMP_EVAL包规范：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，展开“ <span class="uicontrol bold">包”</span> 。</span></li>
                        <li class="stepexpand"><span>在包列表中，右键单击<span class="uicontrol bold">EMP_EVAL</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">编辑”</span> 。</span><div>
                              <p>将打开<span class="wintitle">EMP_EVAL</span>窗格，其中显示了<span class="keyword">创建包</span>的<span class="keyword">CREATE PACKAGE</span>语句：</p><pre class="oac_no_warn" dir="ltr">创建或替换包emp_eval AS / * TODO在这里输入包声明（类型，异常，方法等）* / END emp_eval;</pre><p>窗格的标题不是斜体字体，表示包已保存在数据库中。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在<span class="wintitle">EMP_EVAL</span>窗格中，使用以下代码替换注释：</span><div><pre class="oac_no_warn" dir="ltr">程序eval_department（dept_id IN NUMBER）; FUNCTION calculate_score（evaluate_id IN NUMBER，performance_id IN NUMBER）返回号码;</pre><p><span class="wintitle">EMP_EVAL</span>窗格的标题更改为斜体字体，表示更改尚未保存到数据库。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>单击图标<span class="uicontrol bold">编译</span> 。</span><div>
                              <p>更改的包规范将编译并保存到数据库中。<span class="wintitle">EMP_EVAL</span>窗格的标题不再是斜体字体。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-70B09116-C33F-452A-878E-DFFD9C91ACBD__GUID-8DE570FA-01D1-4655-B38B-C818BCA122E0">
                        <p class="notep1">也可以看看：</p>
                        <p>有关带有<code class="codeph">OR</code> <code class="codeph">REPLACE</code>子句的<span class="keyword">CREATE PACKAGE</span>语句的信息，请<a href="../lnpls/CREATE-PACKAGE-statement.html#LNPLS01371" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-84755B9D-6E53-4066-8FEE-5FD1A42B6484" title="您可以创建和管理PL / SQL包。">创建和管理包</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG222"></a><a id="TDDDG99992"></a><div class="props_rev_3"><a id="GUID-056688EF-E8CD-4215-A832-D004ABFB993C" name="GUID-056688EF-E8CD-4215-A832-D004ABFB993C"></a><h4 id="TDDDG-GUID-056688EF-E8CD-4215-A832-D004ABFB993C" class="sect4"><span class="enumeration_section">5.6.4</span>教程：创建包体</h4>
                  <div>
                     <p>本教程介绍如何使用Create Body工具为EMP_EVAL包创建一个主体，该主题出现在本文档的许多示例和教程中。</p>
                     <div class="section">
                        <p>要创建包体，请使用SQL Developer工具Create Body或DDL语句<span class="keyword">CREATE PACKAGE BODY</span> 。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-056688EF-E8CD-4215-A832-D004ABFB993C__GUID-0672CCC1-7D49-4AA0-82D8-837A75F4A5CE">要使用“创建实体”工具为包EMP_EVAL创建实体：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，展开“ <span class="uicontrol bold">包”</span> 。</span></li>
                        <li class="stepexpand"><span>在包列表中，右键单击<span class="uicontrol bold">EMP_EVAL</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">创建实体”</span> 。</span><div>
                              <p>将出现<span class="wintitle">EMP_EVAL正文</span>窗格，显示自动生成的包体代码：</p><pre class="oac_no_warn" dir="ltr">创建或替换程序包EMP_EVAL作为过程eval_department（dept_id IN NUMBER）AS BEGIN  -  PROCEDURE EMP_EVAL.eval_department NULL所需的TODO实现; END eval_department; FUNCTION calculate_score（evaluate_id IN NUMBER，performance_id IN NUMBER）返回NUMBER AS BEGIN  -  FUNCTION EMP_EVAL.calculate_score所需的TODO实现RETURN NULL; END calculate_score; END EMP_EVAL;</pre><p>窗格的标题是斜体字体，表示代码未保存在数据库中。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>（可选）在<span class="keyword">CREATE PACKAGE BODY</span>语句中：</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>用可执行语句替换注释。</p>
                                 </li>
                                 <li>
                                    <p>（可选）在过程的可执行部分中，删除<span class="keyword">NULL</span>或将其替换为可执行语句。
                                    </p>
                                 </li>
                                 <li>
                                    <p>（可选）在函数的可执行部分中，将<span class="keyword">NULL</span>替换为另一个表达式。
                                    </p>
                                 </li>
                              </ul>
                              <p>如果您现在不执行此步骤，则可以稍后执行此操作，如<span class="q">“ <a href="stored-subprograms-packages.html#GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413" title="本教程介绍如何使用SQL Developer工具Edit在EMP_EVAL.CALCULATE_SCORE函数中声明变量和常量。（本教程也是更改包体的示例。）">教程：在子程序中声明变量和常量</a> ”中所示</span> 。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>单击图标<span class="uicontrol bold">编译</span> 。</span><div>
                              <p>更改的包体编译并保存到数据库中。<span class="wintitle">EMP_EVAL正文</span>窗格的标题不再是斜体字体。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-056688EF-E8CD-4215-A832-D004ABFB993C__GUID-77E24372-5850-4612-A06D-E591A021113E">
                        <p class="notep1">也可以看看：</p>
                        <p>有关<span class="keyword">CREATE PACKAGE BODY</span>语句的信息，请参阅<a href="../lnpls/CREATE-PACKAGE-BODY-statement.html#LNPLS01372" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> （对于包体）</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-84755B9D-6E53-4066-8FEE-5FD1A42B6484" title="您可以创建和管理PL / SQL包。">创建和管理包</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG223"></a><a id="TDDDG47400"></a><div class="props_rev_3"><a id="GUID-BEE92DA5-F64D-4B6F-BA8D-216BD0F63A9C" name="GUID-BEE92DA5-F64D-4B6F-BA8D-216BD0F63A9C"></a><h4 id="TDDDG-GUID-BEE92DA5-F64D-4B6F-BA8D-216BD0F63A9C" class="sect4"><span class="enumeration_section">5.6.5</span>删除包</h4>
                  <div>
                     <p>要删除包（规范和正文），请使用SQL Developer <span class="wintitle">Connections</span>框架和Drop工具，或使用DDL语句<span class="keyword">DROP PACKAGE</span> 。</p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-BEE92DA5-F64D-4B6F-BA8D-216BD0F63A9C__GUID-AFCAC6C8-960E-4555-A55B-A798A1C5A6B1">
                           <p class="notep1">警告：</p>
                           <p>不要删除包EMP_EVAL  - 您需要它用于以后的教程。如果您想练习删除包，请创建简单包然后删除它们。</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BEE92DA5-F64D-4B6F-BA8D-216BD0F63A9C__GUID-CD2EF23B-3AEA-4E83-8918-4F85D4D9DA82">要使用Drop工具删除包：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，展开“ <span class="uicontrol bold">包”</span> 。</span><div>
                              <p>出现包列表。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在包列表中，右键单击要删除的包的名称。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">删除包”</span> 。</span></li>
                        <li class="stepexpand"><span>在“ <span class="wintitle">下拉”</span>窗口中，单击“ <span class="uicontrol bold">应用”</span> 。</span></li>
                        <li class="stepexpand"><span>在“ <span class="wintitle">确认”</span>窗口中，单击“ <span class="uicontrol bold">确定”</span> 。</span></li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-BEE92DA5-F64D-4B6F-BA8D-216BD0F63A9C__GUID-DD88B5C9-67C1-4CFE-8B3B-ADA75CF28DA2">
                        <p class="notep1">也可以看看：</p>
                        <p>有关<span class="keyword">DROP PACKAGE</span>语句的信息，请<a href="../lnpls/DROP-PACKAGE-statement.html#LNPLS99992" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-84755B9D-6E53-4066-8FEE-5FD1A42B6484" title="您可以创建和管理PL / SQL包。">创建和管理包</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TDDDG42000"></a><div class="props_rev_3"><a id="GUID-57A239C2-095F-4707-A813-797B75C369AC" name="GUID-57A239C2-095F-4707-A813-797B75C369AC"></a><h3 id="TDDDG-GUID-57A239C2-095F-4707-A813-797B75C369AC" class="sect3"><span class="enumeration_section">5.7</span>为变量和常量声明和赋值</h3>
               <div>
                  <p>包规范中声明的变量或常量可供任何有权访问包的程序使用。在包体或子程序中声明的变量或常量是该包或子程序的本地变量。声明常量时，必须为其指定初始值。</p>
                  <p>PL / SQL优于SQL的一个显着优点是PL / SQL允许您声明和使用变量和常量。</p>
                  <p>包规范中声明的变量或常量可供任何有权访问包的程序使用。在包体或子程序中声明的变量或常量是该包或子程序的本地变量。</p>
                  <p><strong class="term">变量</strong>保存特定数据类型的值。您的程序可以在运行时更改该值。<strong class="term">常量</strong>保存一个无法更改的值。
                  </p>
                  <p>变量或常量可以具有任何PL / SQL数据类型。声明变量时，可以为其分配初始值;如果不这样做，则其初始值为<span class="keyword">NULL</span> 。声明常量时，必须为其指定初始值。要为变量或常量分配初始值，请使用赋值运算符（ <code class="codeph">:=</code> ）。
                  </p>
                  <div class="infobox-tip" id="GUID-57A239C2-095F-4707-A813-797B75C369AC__GUID-C63C14DC-79BD-4963-98A1-092ED3F88BEF">
                     <p class="notep1">小费：</p>
                     <p>声明所有不作为常量更改的值。这种做法可以优化您编译的代码，使您的源代码更易于维护。</p>
                  </div>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413">教程：在子程序中声明变量和常量</a><br>本教程介绍如何使用SQL Developer工具Edit在EMP_EVAL.CALCULATE_SCORE函数中声明变量和常量。（本教程也是更改包体的示例。）
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-3B89ACCF-1BF4-480C-AE7D-855D11BA1E95">确保变量，常量和参数具有正确的数据类型</a><br>通过使用<span class="keyword">％TYPE</span>属性声明变量，常量和参数具有正确的数据类型。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-592F12C2-5BD0-434F-AF77-7CE941223A89">教程：更改声明以使用％TYPE属性</a><br>本教程介绍如何使用SQL Developer工具Edit更改EMP_EVAL.CALCULATE_SCORE函数的变量，常量和形式参数的声明，以使用<span class="keyword">％TYPE</span>属性。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-82079350-4F1D-48F8-96E0-935DF9A78568">将值分配给变量</a><br></li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-57A239C2-095F-4707-A813-797B75C369AC__GUID-4EF8C839-AA2B-4D8C-A0F0-91D4CFD9AB42">
                     <p class="notep1">也可以看看：</p>
                     <p>有关变量和常量的一般信息，请<a href="../lnpls/plsql-language-fundamentals.html#LNPLS00202" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               <a id="TDDDG224"></a><a id="TDDDG42200"></a><div class="props_rev_3"><a id="GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413" name="GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413"></a><h4 id="TDDDG-GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413" class="sect4"><span class="enumeration_section">5.7.1</span>教程：在子程序中声明变量和常量</h4>
                  <div>
                     <p>本教程介绍如何使用SQL Developer工具Edit在EMP_EVAL.CALCULATE_SCORE函数中声明变量和常量。（本教程也是更改包体的示例。）</p>
                     <div class="section">
                        <p>EMP_EVAL.CALCULATE_SCORE函数在<span class="q">“ <a href="stored-subprograms-packages.html#GUID-B781B764-7A16-43A4-B3E7-310F2D53AFDA" title="本教程介绍如何使用“创建包”工具为名为EMP_EVAL的包创建规范，该包出现在本文档的许多教程和示例中。">教程：创建包规范</a> ”中</span>指定。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413__GUID-C0B862F5-7AC8-4564-8386-D9C23570D356">要在CALCULATE_SCORE函数中声明变量和常量：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，展开“ <span class="uicontrol bold">包”</span> 。</span></li>
                        <li class="stepexpand"><span>在包列表中，展开<span class="uicontrol bold">EMP_EVAL</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，右键单击<span class="uicontrol bold">EMP_EVAL Body</span> 。</span><div>
                              <p>出现一个选择列表。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">编辑”</span> 。</span><div>
                              <p>将出现<span class="wintitle">EMP_EVAL正文</span>窗格，显示包体的代码：</p><pre class="oac_no_warn" dir="ltr">创建或替换程序包EMP_EVAL作为过程eval_department（dept_id IN NUMBER）AS BEGIN  -  PROCEDURE EMP_EVAL.eval_department NULL所需的TODO实现; END eval_department; FUNCTION calculate_score（evaluate_id IN NUMBER，performance_id IN NUMBER）返回NUMBER AS BEGIN  -  FUNCTION EMP_EVAL.calculate_score所需的TODO实现RETURN NULL; END calculate_score; END EMP_EVAL;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在<code class="codeph">RETURN NUMBER AS</code>和<code class="codeph">BEGIN</code> ，添加以下变量和常量声明：</span><div><pre class="oac_no_warn" dir="ltr">n_score NUMBER（1,0）; - 变量n_weight NUMBER; - 变量max_score CONSTANT NUMBER（1,0）：= 9; - 常数，初始值9 max_weight CONSTANT NUMBER（8,8）：= 1; - 常数，初始值1</pre><p><span class="wintitle">EMP_EVAL正文</span>窗格的标题更改为斜体字体，表示代码未保存在数据库中。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>从“ <span class="wintitle">文件”</span>菜单中，选择“ <span class="uicontrol bold">保存”</span> 。</span><div>
                              <p>Oracle数据库编译并保存更改的包体。<span class="wintitle">EMP_EVAL正文</span>窗格的标题不再是斜体字体。
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413__GUID-E62F560B-7A23-4192-AF8A-39C7123B2F0F">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关声明变量和常量的一般信息，请参阅<a href="../lnpls/plsql-language-fundamentals.html#LNPLS00202" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="stored-subprograms-packages.html#GUID-5BBDCDC0-B8DD-4263-9014-5144883ED2B0" title="使用赋值运算符（：=），可以将表达式的值分配给子程序的声明性或可执行部分中的变量。">使用赋值运算符将值赋给变量</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-57A239C2-095F-4707-A813-797B75C369AC" title="包规范中声明的变量或常量可供任何有权访问包的程序使用。在包体或子程序中声明的变量或常量是该包或子程序的本地变量。声明常量时，必须为其指定初始值。">为变量和常量声明和赋值</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG42220"></a><div class="props_rev_3"><a id="GUID-3B89ACCF-1BF4-480C-AE7D-855D11BA1E95" name="GUID-3B89ACCF-1BF4-480C-AE7D-855D11BA1E95"></a><h4 id="TDDDG-GUID-3B89ACCF-1BF4-480C-AE7D-855D11BA1E95" class="sect4"><span class="enumeration_section">5.7.2</span>确保变量，常量和参数具有正确的数据类型</h4>
                  <div>
                     <p>通过使用<span class="keyword">％TYPE</span>属性声明变量，常量和参数具有正确的数据类型。
                     </p>
                     <p>在<span class="q">“ <a href="stored-subprograms-packages.html#GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413" title="本教程介绍如何使用SQL Developer工具Edit在EMP_EVAL.CALCULATE_SCORE函数中声明变量和常量。（本教程也是更改包体的示例。）">教程：在子程序中声明变量和常量</a> ”之后</span> ，EMP_EVAL.CALCULATE_SCORE函数的代码是：</p><pre class="oac_no_warn" dir="ltr">FUNCTION calculate_score（evaluate_id IN NUMBER，performance_id IN NUMBER）返回编号为n_score NUMBER（1,0）; - 变量n_weight NUMBER; - 变量max_score CONSTANT NUMBER（1,0）：= 9; - 常数，初始值9 max_weight CONSTANT NUMBER（8,8）：= 1; - 常量，初始值1 BEGIN  -  FUNCTION所需的TODO实现EMP_EVAL.calculate_score RETURN NULL; END calculate_score;</pre><p>函数的变量，常量和参数表示表SCORES和PERFORMANCE_PARTS（在<span class="q">“ <a href="creating-managing-schema-objects.html#GUID-87AA2B05-2B7B-49D9-AD21-1B2877113D23" title="To create tables, use either the SQL Developer tool Create Table or the DDL statement CREATE TABLE.">创建表</a> ”</span>中<span class="q"><a href="creating-managing-schema-objects.html#GUID-87AA2B05-2B7B-49D9-AD21-1B2877113D23" title="要创建表，请使用SQL Developer工具Create Table或DDL语句CREATE TABLE。">创建</a></span> ）中的值：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>变量n_score将保存SCORE.SCORES列中的值，并将常量max_score与此类值进行比较。</p>
                        </li>
                        <li>
                           <p>变量n_weight将保留PERFORMANCE_PARTS.WEIGHT列中的值，并将常量max_weight与此类值进行比较。</p>
                        </li>
                        <li>
                           <p>参数evaluation_id将保存SCORE.EVALUATION_ID列中的值。</p>
                        </li>
                        <li>
                           <p>参数performance_id将保存SCORE.PERFORMANCE_ID列中的值。</p>
                        </li>
                     </ul>
                     <p>因此，每个变量，常量和参数与其对应列具有相同的数据类型。</p>
                     <p>如果列的数据类型发生更改，则希望变量，常量和参数的数据类型更改为相同的数据类型;否则，CALCULATE_SCORE函数无效。</p>
                     <p>要确保变量，常量和参数的数据类型始终与列的数据类型匹配，请使用<span class="keyword">％TYPE</span>属性声明它们。<span class="keyword">％TYPE</span>属性提供表列或其他变量的数据类型，以确保正确的数据类型分配。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-3B89ACCF-1BF4-480C-AE7D-855D11BA1E95__GUID-F98C4322-9E67-469E-8E84-FB9C1CEDD9C3">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">%TYPE</code>属性的更多信息，请<a href="../lnpls/plsql-language-fundamentals.html#LNPLS99970" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="../lnpls/TYPE-attribute.html#LNPLS01352" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考，</span></a>用于<span class="keyword">％TYPE</span>属性的语法</p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-57A239C2-095F-4707-A813-797B75C369AC" title="包规范中声明的变量或常量可供任何有权访问包的程序使用。在包体或子程序中声明的变量或常量是该包或子程序的本地变量。声明常量时，必须为其指定初始值。">为变量和常量声明和赋值</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG225"></a><a id="TDDDG99960"></a><div class="props_rev_3"><a id="GUID-592F12C2-5BD0-434F-AF77-7CE941223A89" name="GUID-592F12C2-5BD0-434F-AF77-7CE941223A89"></a><h4 id="TDDDG-GUID-592F12C2-5BD0-434F-AF77-7CE941223A89" class="sect4"><span class="enumeration_section">5.7.3</span>教程：更改声明以使用％TYPE属性</h4>
                  <div>
                     <p>本教程介绍如何使用SQL Developer工具Edit更改EMP_EVAL.CALCULATE_SCORE函数的变量，常量和形式参数的声明，以使用<span class="keyword">％TYPE</span>属性。
                     </p>
                     <div class="section">
                        <p>EMP_EVAL.CALCULATE_SCORE函数显示在<span class="q">“ <a href="stored-subprograms-packages.html#GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413" title="本教程介绍如何使用SQL Developer工具Edit在EMP_EVAL.CALCULATE_SCORE函数中声明变量和常量。（本教程也是更改包体的示例。）">教程：在子程序中声明变量和常量</a> ”中</span> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-592F12C2-5BD0-434F-AF77-7CE941223A89__GUID-ADA83268-0997-4980-BFFF-EF168E12928A">要更改CALCULATE_SCORE中的声明以使用％TYPE：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，展开“ <span class="uicontrol bold">包”</span> 。</span></li>
                        <li class="stepexpand"><span>在包列表中，展开<span class="uicontrol bold">EMP_EVAL</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，右键单击<span class="uicontrol bold">EMP_EVAL Body</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">编辑”</span> 。</span><div>
                              <p>将出现<span class="wintitle">EMP_EVAL正文</span>窗格，显示包体的代码：</p><pre class="oac_no_warn" dir="ltr">创建或替换包主体emp_eval AS过程eval_department（dept_id IN NUMBER）AS BEGIN  -  PROCEDURE EMP_EVAL.eval_department所需的TODO实现NULL; END eval_department; FUNCTION calculate_score（evaluate_id IN NUMBER，performance_id IN NUMBER）返回编号为n_score NUMBER（1,0）; - 变量n_weight NUMBER; - 变量max_score CONSTANT NUMBER（1,0）：= 9; - 常数，初始值9 max_weight CONSTANT NUMBER（8,8）：= 1; - 常量，初始值1 BEGIN  -  FUNCTION所需的TODO实现EMP_EVAL.calculate_score RETURN NULL; END calculate_score; END emp_eval;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在函数的代码中，使更改以粗体显示：</span><div><pre class="oac_no_warn" dir="ltr">FUNCTION calculate_score（evaluation_id IN <span class="bold">SCORES.EVALUATION_ID％TYPE</span> ，performance_id IN <span class="bold">SCORES.PERFORMANCE_ID％TYPE</span> ）返回编号为n_score <span class="bold">SCORES.SCORE％TYPE</span> ; n_weight <span class="bold">PERFORMANCE_PARTS.WEIGHT％TYPE</span> ; max_score CONSTANT <span class="bold">SCORES.SCORE％TYPE</span> ：= 9; max_weight CONSTANT <span class="bold">PERFORMANCE_PARTS.WEIGHT％TYPE</span> ：= 1;</pre></div>
                        </li>
                        <li class="stepexpand"><span>右键单击<span class="uicontrol bold">EMP_EVAL</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">编辑”</span> 。</span><div>
                              <p>将打开<span class="wintitle">EMP_EVAL窗格</span> ，其中显示了<span class="keyword">创建包</span>的<span class="keyword">CREATE PACKAGE</span>语句：</p><pre class="oac_no_warn" dir="ltr">创建或替换包EMP_EVAL作为程序eval_department（dept_id IN NUMBER）; FUNCTION calculate_score（evaluate_id IN NUMBER，performance_id IN NUMBER）返回号码; END EMP_EVAL;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在函数的代码中，使更改以粗体显示：</span><div><pre class="oac_no_warn" dir="ltr">FUNCTION calculate_score（evaluation_id IN <span class="bold">scores.evaluation_id％TYPE</span> ，performance_id IN <span class="bold">scores.performance_id％TYPE</span> ）</pre></div>
                        </li>
                        <li class="stepexpand"><span>右键单击<span class="uicontrol bold">EMP_EVAL</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">编译”</span> 。</span></li>
                        <li class="stepexpand"><span>右键单击<span class="uicontrol bold">EMP_EVAL Body</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">编译”</span> 。</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-57A239C2-095F-4707-A813-797B75C369AC" title="包规范中声明的变量或常量可供任何有权访问包的程序使用。在包体或子程序中声明的变量或常量是该包或子程序的本地变量。声明常量时，必须为其指定初始值。">为变量和常量声明和赋值</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG42300"></a><div class="props_rev_3"><a id="GUID-82079350-4F1D-48F8-96E0-935DF9A78568" name="GUID-82079350-4F1D-48F8-96E0-935DF9A78568"></a><h4 id="TDDDG-GUID-82079350-4F1D-48F8-96E0-935DF9A78568" class="sect4"><span class="enumeration_section">5.7.4</span>为变量赋值</h4>
                  <div>
                     <div class="section">
                        <p>您可以通过以下方式为变量赋值：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用赋值运算符为其指定表达式的值。</p>
                           </li>
                           <li>
                              <p>使用<span class="keyword">SELECT INTO</span>或<span class="keyword">FETCH</span>语句为表中的值赋值。
                              </p>
                           </li>
                           <li>
                              <p>将其作为<span class="keyword">OUT</span>或<span class="keyword">IN OUT</span>参数传递给子程序，然后在子程序中指定值。
                              </p>
                           </li>
                           <li>
                              <p>将变量绑定到一个值。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-5BBDCDC0-B8DD-4263-9014-5144883ED2B0">使用赋值运算符将值分配给变量</a><br>使用赋值运算符（ <code class="codeph">:=</code> ），可以将表达式的值分配给子程序的声明性或可执行部分中的变量。
                        </li>
                        <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-3D2B6489-265A-432B-BBC1-2409235493E2">使用SELECT INTO语句将值分配给变量</a><br>要在子程序或包中使用表值，必须使用<span class="keyword">SELECT INTO</span>语句将它们分配给变量。
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-82079350-4F1D-48F8-96E0-935DF9A78568__GUID-564B2867-EFB3-4743-865A-320D8A5A95D5">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关将值赋给变量的更多信息，请<a href="../lnpls/plsql-language-fundamentals.html#LNPLS00205" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=TDPJD210" target="_blank"><span class="italic">Oracle Database 2 Day + Java Developer's Guide</span></a> ，了解有关绑定变量的信息</p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-57A239C2-095F-4707-A813-797B75C369AC" title="包规范中声明的变量或常量可供任何有权访问包的程序使用。在包体或子程序中声明的变量或常量是该包或子程序的本地变量。声明常量时，必须为其指定初始值。">为变量和常量声明和赋值</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="TDDDG226"></a><a id="TDDDG42320"></a><div class="props_rev_3"><a id="GUID-5BBDCDC0-B8DD-4263-9014-5144883ED2B0" name="GUID-5BBDCDC0-B8DD-4263-9014-5144883ED2B0"></a><h5 id="TDDDG-GUID-5BBDCDC0-B8DD-4263-9014-5144883ED2B0" class="sect5"><span class="enumeration_section">5.7.4.1</span>使用赋值运算符将值<span class="enumeration_section">赋给</span>变量</h5>
                     <div>
                        <p>使用赋值运算符（ <code class="codeph">:=</code> ），可以将表达式的值分配给子程序的声明性或可执行部分中的变量。
                        </p>
                        <div class="section">
                           <p>在子程序的声明部分中，您可以在声明变量时为其指定初始值。语法是：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">variable_name</span> <span class="italic">data_type</span> <span class="bold">：=</span> <span class="italic">expression</span> ;</pre><p>在子程序的可执行部分中，您可以使用赋值语句为变量赋值。语法是：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">variable_name</span> <span class="bold">：=</span> <span class="italic">expression</span> ;</pre><p><a href="stored-subprograms-packages.html#GUID-5BBDCDC0-B8DD-4263-9014-5144883ED2B0__BABDEEDD">例5-1</a>以粗体显示了对EMP_EVAL.CALCULATE_SCORE函数进行的更改，以添加变量running_total，并将其用作函数的返回值。赋值运算符出现在函数的声明性和可执行部分中。（running_total的数据类型必须为<span class="keyword">NUMBER</span> ，而不是SCORES.SCORE％TYPE或PERFORMANCE_PARTS.WEIGHT％TYPE，因为它包含两个具有不同精度和比例的<span class="keyword">NUMBER</span>值的乘积。）
                           </p>
                           <div class="infoboxnotealso" id="GUID-5BBDCDC0-B8DD-4263-9014-5144883ED2B0__GUID-761A2074-C3F7-4918-AC61-06F025DDEC21">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>用于变量声明语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01388" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                                 </li>
                                 <li>
                                    <p>用于赋值语句语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01301" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-5BBDCDC0-B8DD-4263-9014-5144883ED2B0__BABDEEDD">
                           <p class="titleinexample">示例5-1使用赋值运算符为变量赋值</p><pre class="oac_no_warn" dir="ltr">FUNCTION calculate_score（evaluation_id IN SCORES.EVALUATION_ID％TYPE，performance_id IN SCORES.PERFORMANCE_ID％TYPE）返回编号为n_score SCORES.SCORE％TYPE; n_weight PERFORMANCE_PARTS.WEIGHT％TYPE; <span class="bold">running_total NUMBER：= 0;</span> max_score CONSTANT SCORES.SCORE％TYPE：= 9; max_weight CONSTANT PERFORMANCE_PARTS.WEIGHT％TYPE：= 1; BEGIN <span class="bold">running_total：= max_score * max_weight;</span> RETURN <span class="bold">running_total</span> ; END calculate_score;</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-82079350-4F1D-48F8-96E0-935DF9A78568">将值分配给变量</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="TDDDG227"></a><a id="TDDDG228"></a><a id="TDDDG42330"></a><div class="props_rev_3"><a id="GUID-3D2B6489-265A-432B-BBC1-2409235493E2" name="GUID-3D2B6489-265A-432B-BBC1-2409235493E2"></a><h5 id="TDDDG-GUID-3D2B6489-265A-432B-BBC1-2409235493E2" class="sect5"><span class="enumeration_section">5.7.4.2</span>使用SELECT INTO语句将值分配给变量</h5>
                     <div>
                        <p>要在子程序或包中使用表值，必须使用<span class="keyword">SELECT INTO</span>语句将它们分配给变量。
                        </p>
                        <div class="section">
                           <p><a href="stored-subprograms-packages.html#GUID-3D2B6489-265A-432B-BBC1-2409235493E2__BABFIGBI">示例5-2</a>以粗体显示了对EMP_EVAL.CALCULATE_SCORE函数所做的更改，以使其从表值计算running_total。
                           </p>
                           <p><a href="stored-subprograms-packages.html#GUID-3D2B6489-265A-432B-BBC1-2409235493E2__BABBDEHA">例5-3中</a>的ADD_EVAL过程使用EMPLOYEES表中相应行的值将一行插入EVALUATIONS表。将ADD_EVAL过程添加到EMP_EVAL包的主体，但不添加到规范。因为它不在规范中，所以ADD_EVAL是包的本地 - 它只能由包中的其他子程序调用，而不能从包外部调用。
                           </p>
                           <div class="infoboxnotealso" id="GUID-3D2B6489-265A-432B-BBC1-2409235493E2__GUID-A0659E0C-1E4E-40CE-89C6-4F34698A87A7">
                              <p class="notep1">也可以看看：</p>
                              <p>有关<span class="keyword">SELECT INTO</span>语句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01345" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-3D2B6489-265A-432B-BBC1-2409235493E2__BABFIGBI">
                           <p class="titleinexample">示例5-2使用SELECT INTO将表值分配给变量</p><pre class="oac_no_warn" dir="ltr">FUNCTION calculate_score（evaluation_id IN scores.evaluation_id％TYPE，performance_id IN scores.performance_id％TYPE）RETURN NUMBER AS n_score scores.score％TYPE; n_weight performance_parts.weight％TYPE; running_total NUMBER：= 0; max_score CONSTANT scores.score％TYPE：= 9; max_weight CONSTANT performance_parts.weight％TYPE：= 1; BEGIN <span class="bold">SELECT s.score INTO n_score</span> <span class="bold">FROM SCORES s</span> <span class="bold">WHERE evaluation_id = s.evaluation_id</span> <span class="bold">AND performance_id = s.performance_id;</span> <span class="bold">SELECT p.weight INTO n_weight</span> <span class="bold">FROM PERFORMANCE_PARTS p</span> <span class="bold">WHERE performance_id = p.performance_id;</span> running_total：= <span class="bold">n_score * n_weight</span> ; RETURN running_total; END calculate_score;</pre></div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-3D2B6489-265A-432B-BBC1-2409235493E2__BABBDEHA">
                           <p class="titleinexample">示例5-3使用另一个表中的值插入表行</p><pre class="oac_no_warn" dir="ltr">程序add_eval（employee_id在EMPLOYEES.EMPLOYEE_ID％TYPE，今天在IN DATE）AS job_id EMPLOYEES.JOB_ID％TYPE; manager_id EMPLOYEES.MANAGER_ID％TYPE; department_id EMPLOYEES.DEPARTMENT_ID％TYPE; BEGIN INSERT INTO EVALUATIONS（evaluation_id，employee_id，evaluation_date，job_id，manager_id，department_id，total_score）SELECT evaluations_sequence。NEXTVAL， -  evaluation_id add_eval.employee_id， -  employee_id add_eval.today， -  evaluation_date e.job_id， -  job_id e.manager_id， -  manager_id e.department_id， -  department_id 0  -  total_score FROM employees e; IF SQL％ROWCOUNT = 0然后升起NO_DATA_FOUND;万一; END add_eval;</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-82079350-4F1D-48F8-96E0-935DF9A78568">将值分配给变量</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="TDDDG44000"></a><div class="props_rev_4"><a id="GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51" name="GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51"></a><h3 id="TDDDG-GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51" class="sect3"><span class="enumeration_section">5.8</span>控制程序流程</h3>
               <div>
                  <p>与按照输入顺序运行语句的SQL不同，PL / SQL具有控制语句，可以控制程序的流程。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-A9812516-AB03-4AFC-A4AD-7607753F0254">关于控制声明</a><br>PL / SQL有三类控制语句：条件选择语句，循环语句和顺序控制语句。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-8E9ADF4C-BA52-44DE-8C5C-B2635785BBC4">使用IF声明</a><br><span class="keyword">IF</span>语句执行或跳过一系列语句，具体取决于布尔表达式的值。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-985AF0C3-948B-4EE7-95D6-B814A35CD8F2">使用CASE声明</a><br><span class="keyword">CASE</span>语句从一系列条件中选择，并执行相应的语句。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-0C2C4B51-E161-45DF-864C-E68A336C20D9">使用FOR LOOP语句</a><br><span class="keyword">FOR LOOP</span>语句为<span class="synph">lower_bound</span>到<span class="synph">upper_bound</span>范围内的每个整数重复一次语句序列。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-CBFF6F8E-CB57-4897-BD86-467924F3BFBC">使用WHILE LOOP语句</a><br><span class="keyword">WHILE LOOP</span>语句在条件为<span class="keyword">TRUE</span>时重复一系列语句。</li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-9D8169B6-3267-470B-907E-58D66F14562C">使用基本循环并在语句时退出</a><br>基本的<span class="keyword">LOOP</span>语句重复一系列语句。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               <a id="TDDDG99959"></a><div class="props_rev_3"><a id="GUID-A9812516-AB03-4AFC-A4AD-7607753F0254" name="GUID-A9812516-AB03-4AFC-A4AD-7607753F0254"></a><h4 id="TDDDG-GUID-A9812516-AB03-4AFC-A4AD-7607753F0254" class="sect4"><span class="enumeration_section">5.8.1</span>关于控制语句</h4>
                  <div>
                     <p>PL / SQL有三类控制语句：条件选择语句，循环语句和顺序控制语句。</p>
                     <p><strong class="term">条件选择语句</strong>允许您为不同的数据值执行不同的语句。条件选择语句是<code class="codeph">IF</code>和<code class="codeph">CASE</code> 。</p>
                     <p><strong class="term">循环语句</strong>允许您使用一系列不同的数据值重复相同的语句。循环语句是<code class="codeph">FOR</code> <code class="codeph">LOOP</code> ， <code class="codeph">WHILE</code> <code class="codeph">LOOP</code>和基本<code class="codeph">LOOP</code> 。 <code class="codeph">EXIT</code>语句将控制转移到循环结束。<code class="codeph">CONTINUE</code>语句退出循环的当前迭代并将控制转移到下一次迭代。<code class="codeph">EXIT</code>和<code class="codeph">CONTINUE</code>都有一个可选的<code class="codeph">WHEN</code>子句，您可以在其中指定条件。
                     </p>
                     <p><strong class="term">顺序控制语句</strong>允许您转到指定的带标签语句或不执行任何操作。顺序控制语句是<code class="codeph">GOTO</code>和<code class="codeph">NULL</code> 。</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-A9812516-AB03-4AFC-A4AD-7607753F0254__GUID-C83F2FE8-62F2-42F7-BEDD-384A15F3CD55">
                        <p class="notep1">也可以看看：</p>
                        <p>有关PL / SQL控制语句概述的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00401" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51" title="与按照输入顺序运行语句的SQL不同，PL / SQL具有控制语句，可以控制程序的流程。">控制程序流</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG229"></a><a id="TDDDG44110"></a><div class="props_rev_3"><a id="GUID-8E9ADF4C-BA52-44DE-8C5C-B2635785BBC4" name="GUID-8E9ADF4C-BA52-44DE-8C5C-B2635785BBC4"></a><h4 id="TDDDG-GUID-8E9ADF4C-BA52-44DE-8C5C-B2635785BBC4" class="sect4"><span class="enumeration_section">5.8.2</span>使用IF语句</h4>
                  <div>
                     <p><span class="keyword">IF</span>语句执行或跳过一系列语句，具体取决于布尔表达式的值。
                     </p>
                     <p><span class="keyword">IF</span>语句具有以下语法：</p><pre class="oac_no_warn" dir="ltr">IF <span class="italic">boolean_expression</span> THEN <span class="italic">语句</span> [， <span class="italic">语句</span> ] [ELSIF <span class="italic">boolean_expression</span> THEN <span class="italic">语句</span> [， <span class="italic">语句</span> ]] ...[ELSE <span class="italic">声明</span> [， <span class="italic">声明</span> ]] END IF;</pre><p>假设您的公司在雇佣的前10年中每年对雇员进行两次评估，但仅在一年后评估一次。您需要一个返回员工评估频率的函数。您可以使用<span class="keyword">IF</span>语句来确定函数的返回值，如<a href="stored-subprograms-packages.html#GUID-8E9ADF4C-BA52-44DE-8C5C-B2635785BBC4__BABEIIJG">例5-4所示</a> 。
                     </p>
                     <p>将EVAL_FREQUENCY函数添加到EMP_EVAL包的主体，但不添加到规范。因为它不在规范中，所以EVAL_FREQUENCY是包的本地 - 它只能由包中的其他子程序调用，而不能从包外部调用。</p>
                     <div class="infobox-tip" id="GUID-8E9ADF4C-BA52-44DE-8C5C-B2635785BBC4__GUID-7C311466-FAA6-4542-9637-C5838008CE1F">
                        <p class="notep1">小费：</p>
                        <p>在SQL语句中使用PL / SQL变量时，如<a href="stored-subprograms-packages.html#GUID-8E9ADF4C-BA52-44DE-8C5C-B2635785BBC4__BABEIIJG">示例5-4</a>中的第二个<span class="keyword">SELECT</span>语句，使用子程序名称限定变量，以确保它不会被误认为是表列。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-8E9ADF4C-BA52-44DE-8C5C-B2635785BBC4__GUID-064197DF-2A57-4B5A-8ED6-0E3E8A248CB3">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../lnpls/IF-statement.html#LNPLS01324" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考，</span></a>用于<span class="keyword">IF</span>语句的语法</p>
                           </li>
                           <li>
                              <p>有关使用<span class="keyword">IF</span>语句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00402" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="example" id="GUID-8E9ADF4C-BA52-44DE-8C5C-B2635785BBC4__BABEIIJG">
                        <p class="titleinexample">例5-4确定函数返回值的IF语句</p><pre class="oac_no_warn" dir="ltr">功能eval_frequency（emp_id IN EMPLOYEES.EMPLOYEE_ID％TYPE）返回PLS_INTEGER作为h_date EMPLOYEES.HIRE_DATE％TYPE;今天EMPLOYEES.HIRE_DATE％TYPE; eval_freq PLS_INTEGER;今天从DUAL开始选择SYSDATE INTO; SELECT HIRE_DATE INTO h_date FROM EMPLOYEES WHERE EMPLOYEE_ID = <span class="bold">eval_frequency.emp_id</span> ; <span class="bold">IF</span> （（h_date +（INTERVAL'120'MONTH））&lt;today） <span class="bold">那么</span> eval_freq：= 1; <span class="bold">ELSE</span> eval_freq：= 2; <span class="bold">结束如果</span> ; RETURN eval_freq;结束eval_frequency;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51" title="与按照输入顺序运行语句的SQL不同，PL / SQL具有控制语句，可以控制程序的流程。">控制程序流</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG230"></a><a id="TDDDG44120"></a><div class="props_rev_3"><a id="GUID-985AF0C3-948B-4EE7-95D6-B814A35CD8F2" name="GUID-985AF0C3-948B-4EE7-95D6-B814A35CD8F2"></a><h4 id="TDDDG-GUID-985AF0C3-948B-4EE7-95D6-B814A35CD8F2" class="sect4"><span class="enumeration_section">5.8.3</span>使用CASE声明</h4>
                  <div>
                     <p><span class="keyword">CASE</span>语句从一系列条件中选择，并执行相应的语句。
                     </p>
                     <p>简单的<span class="keyword">CASE</span>语句计算单个表达式并将其与几个潜在值进行比较。它有这样的语法：</p><pre class="oac_no_warn" dir="ltr">CASE <span class="italic">表达式</span> WHEN <span class="italic">值</span> THEN <span class="italic">语句</span> [WHEN <span class="italic">值</span> THEN <span class="italic">语句</span> ] ...[ELSE <span class="italic">声明</span> [， <span class="italic">声明</span> ] ......]结束案例;</pre><p>搜索到的<span class="keyword">CASE</span>语句计算多个布尔表达式，并选择值为<span class="keyword">TRUE</span>的第一个表达式。有关搜索的<span class="keyword">CASE</span>语句的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS99972" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                     </p>
                     <div class="infobox-tip" id="GUID-985AF0C3-948B-4EE7-95D6-B814A35CD8F2__GUID-4976077F-0A84-4CA2-BE8B-72249C39B292">
                        <p class="notep1">小费：</p>
                        <p>当您可以使用<span class="keyword">CASE</span>语句或嵌套的<span class="keyword">IF</span>语句时，请使用<span class="keyword">CASE</span>语句 - 它更具可读性和效率。
                        </p>
                     </div>
                     <p>假设，如果员工每年只评估一次，您希望EVAL_FREQUENCY函数建议加薪，这取决于JOB_ID。</p>
                     <p>更改EVAL_FREQUENCY函数，如<a href="stored-subprograms-packages.html#GUID-985AF0C3-948B-4EE7-95D6-B814A35CD8F2__BABGJFBG">例5-5</a>中的粗体字所示。（有关打印字符串的过程的信息，DBMS_OUTPUT.PUT_LINE，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=ARPLS036" target="_blank"><span class="italic">Oracle数据库PL / SQL包和类型参考</span></a> 。）
                     </p>
                     <div class="example" id="GUID-985AF0C3-948B-4EE7-95D6-B814A35CD8F2__BABGJFBG">
                        <p class="titleinexample">示例5-5确定要打印的字符串的CASE语句</p><pre class="oac_no_warn" dir="ltr">功能eval_frequency（emp_id IN EMPLOYEES.EMPLOYEE_ID％TYPE）返回PLS_INTEGER作为h_date EMPLOYEES.HIRE_DATE％TYPE;今天EMPLOYEES.HIRE_DATE％TYPE; eval_freq PLS_INTEGER; <span class="bold">j_id EMPLOYEES.JOB_ID％TYPE;</span>今天从DUAL开始选择SYSDATE INTO; SELECT HIRE_DATE， <span class="bold">JOB_ID</span> INTO h_date， <span class="bold">j_id</span> FROM EMPLOYEES WHERE EMPLOYEE_ID = eval_frequency.emp_id; IF（（h_date +（INTERVAL'12'MONTH））&lt;today）那么eval_freq：= 1; <span class="bold">CASE</span> j_id <span class="bold">当</span> 'PU_CLERK' <span class="bold">那么</span> DBMS_OUTPUT.PUT_LINE（'考虑员工加薪8％'||| emp_id）; <span class="bold">当</span> 'SH_CLERK' <span class="bold">那么</span> DBMS_OUTPUT.PUT_LINE（'考虑员工加薪7％|'|| emp_id）; <span class="bold">当</span> 'ST_CLERK' <span class="bold">那么</span> DBMS_OUTPUT.PUT_LINE（'考虑员工加薪6％'||| emp_id）; <span class="bold">当</span> 'HR_REP' <span class="bold">那么</span> DBMS_OUTPUT.PUT_LINE（'考虑员工加薪5％|'|| emp_id）; <span class="bold">当</span> 'PR_REP' <span class="bold">那么</span> DBMS_OUTPUT.PUT_LINE（'考虑员工加薪5％|'|| emp_id）; <span class="bold">当</span> 'MK_REP' <span class="bold">那么</span> DBMS_OUTPUT.PUT_LINE（'考虑员工加薪4％'||| emp_id）; <span class="bold">ELSE</span> DBMS_OUTPUT.PUT_LINE（'对员工＃'|| emp_id无效）; <span class="bold">结束案例</span> ; ELSE eval_freq：= 2;万一; RETURN eval_freq;结束eval_frequency;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-985AF0C3-948B-4EE7-95D6-B814A35CD8F2__GUID-CC805C40-E83F-44D7-BA9B-2DB01394E360">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="connecting-exploring-database.html#GUID-B7BACC62-95F0-42D9-BA26-882FE5268A0F" title="CASE表达式允许您使用IF ...然后 ...SQL语句中的ELSE逻辑，无需调用子程序。有两种CASE表达式，简单和搜索。">在查询中使用CASE表达式</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../lnpls/CASE-statement.html#LNPLS01304" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考，</span></a>用于<span class="keyword">CASE</span>语句的语法</p>
                           </li>
                           <li>
                              <p>有关使用<span class="keyword">CASE</span>语句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00402" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51" title="与按照输入顺序运行语句的SQL不同，PL / SQL具有控制语句，可以控制程序的流程。">控制程序流</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG231"></a><a id="TDDDG44210"></a><div class="props_rev_3"><a id="GUID-0C2C4B51-E161-45DF-864C-E68A336C20D9" name="GUID-0C2C4B51-E161-45DF-864C-E68A336C20D9"></a><h4 id="TDDDG-GUID-0C2C4B51-E161-45DF-864C-E68A336C20D9" class="sect4"><span class="enumeration_section">5.8.4</span>使用FOR LOOP语句</h4>
                  <div>
                     <p><span class="keyword">FOR LOOP</span>语句为<span class="synph">lower_bound</span>到<span class="synph">upper_bound</span>范围内的每个整数重复一次语句序列。
                     </p>
                     <p><span class="keyword">FOR LOOP</span>的语法是：</p><pre class="oac_no_warn" dir="ltr">FOR <span class="italic">计数器</span> IN <span class="italic">lower_bound</span> .. <span class="italic">upper_bound</span> LOOP <span class="italic">语句</span> [， <span class="italic">声明</span> ] ...结束循环;</pre><p><span class="keyword">LOOP</span>和<span class="keyword">END LOOP</span>之间的语句可以使用<span class="synph">counter</span> ，但不能更改其值。
                     </p>
                     <p>假设您不希望仅仅建议加薪，而是希望EVAL_FREQUENCY函数报告如果工资每年增加建议金额五年，那么工资将会是多少。</p>
                     <p>更改EVAL_FREQUENCY函数，如<a href="stored-subprograms-packages.html#GUID-0C2C4B51-E161-45DF-864C-E68A336C20D9__BABJDIHB">例5-6</a>中的粗体字所示。（有关打印字符串的过程的信息， <code class="codeph">DBMS_OUTPUT.PUT_LINE</code> ，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=ARPLS036" target="_blank"><span class="italic">Oracle Database PL / SQL包和类型参考</span></a> 。）
                     </p>
                     <div class="example" id="GUID-0C2C4B51-E161-45DF-864C-E68A336C20D9__BABJDIHB">
                        <p class="titleinexample">例5-6五年后计算工资的LOOP语句</p><pre class="oac_no_warn" dir="ltr">功能eval_frequency（emp_id IN EMPLOYEES.EMPLOYEE_ID％TYPE）返回PLS_INTEGER作为h_date EMPLOYEES.HIRE_DATE％TYPE;今天EMPLOYEES.HIRE_DATE％TYPE; eval_freq PLS_INTEGER; j_id EMPLOYEES.JOB_ID％TYPE; <span class="bold">sal EMPLOYEES.SALARY％TYPE;</span> <span class="bold">sal_raise NUMBER（3,3）：= 0;</span>今天从DUAL开始选择SYSDATE INTO; SELECT HIRE_DATE，JOB_ID， <span class="bold">SALARY</span> INTO h_date，j_id， <span class="bold">sal</span> FROM EMPLOYEES WHERE EMPLOYEE_ID = eval_frequency.emp_id; IF（（h_date +（INTERVAL'12'MONTH））&lt;today）那么eval_freq：= 1; CASE j_id当'PU_CLERK'那么<span class="bold">sal_raise：= 0.08</span> ;当'SH_CLERK'那么<span class="bold">sal_raise：= 0.07</span> ;当'ST_CLERK'那么<span class="bold">sal_raise：= 0.06</span> ;当'HR_REP'那么<span class="bold">sal_raise：= 0.05</span> ;当'PR_REP'那么<span class="bold">sal_raise：= 0.05</span> ;当'MK_REP'那么<span class="bold">sal_raise：= 0.04</span> ; ELSE NULL;结束案例; <span class="bold">如果（sal_raise！= 0）THEN</span> <span class="bold">BEGIN</span> <span class="bold">DBMS_OUTPUT.PUT_LINE（ '如果薪水' || SAL || ||</span> <span class="bold">ROUND</span> <span class="bold">'通过增大<span class="bold">'（（sal_raise</span></span> <span class="bold">* 100），0）||</span> <span class="bold">'每年％为5年，这将是：'） ;</span> <span class="bold">FOR i IN 1..5 LOOP</span> <span class="bold">sal：= sal *（1 + sal_raise）;</span> <span class="bold">DBMS_OUTPUT.PUT_LINE（'|| i ||'year（s）'之后的ROUND（sal，2）||';</span> <span class="bold">结束循环;</span> <span class="bold">结束;</span> <span class="bold">万一;</span> ELSE eval_freq：= 2;万一; RETURN eval_freq;结束eval_frequency;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-0C2C4B51-E161-45DF-864C-E68A336C20D9__GUID-2F524FEC-AC04-46ED-9D0B-6F4E72B3B366">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../lnpls/basic-LOOP-statement.html#LNPLS01328" target="_blank"><span class="italic">Oracle数据库PL / SQL语言参考，</span></a>用于<span class="keyword">FOR LOOP</span>语句的语法</p>
                           </li>
                           <li>
                              <p>有关使用<span class="keyword">FOR LOOP</span>语句的更多信息，请<a href="../lnpls/plsql-control-statements.html#LNPLS00403" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51" title="与按照输入顺序运行语句的SQL不同，PL / SQL具有控制语句，可以控制程序的流程。">控制程序流</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG232"></a><a id="TDDDG44220"></a><div class="props_rev_3"><a id="GUID-CBFF6F8E-CB57-4897-BD86-467924F3BFBC" name="GUID-CBFF6F8E-CB57-4897-BD86-467924F3BFBC"></a><h4 id="TDDDG-GUID-CBFF6F8E-CB57-4897-BD86-467924F3BFBC" class="sect4"><span class="enumeration_section">5.8.5</span>使用WHILE LOOP语句</h4>
                  <div>
                     <p><span class="keyword">WHILE LOOP</span>语句在条件为<span class="keyword">TRUE</span>时重复一系列语句。</p>
                     <p><span class="keyword">WHILE LOOP</span>语句的语法是：</p><pre class="oac_no_warn" dir="ltr">WHILE <span class="italic">条件</span> LOOP <span class="italic">语句</span> [， <span class="italic">声明</span> ] ......结束循环;</pre><div class="infoboxnote" id="GUID-CBFF6F8E-CB57-4897-BD86-467924F3BFBC__GUID-A5CF38CC-C669-4779-832A-A3C8FEEA8224">
                        <p class="notep1">注意：</p>
                        <p>如果<span class="keyword">LOOP</span>和<span class="keyword">END LOOP</span>之间的语句永远不会导致<span class="synph">条件</span>变为<span class="keyword">FALSE</span> ，则<span class="keyword">WHILE LOOP</span>语句将无限期地运行。
                        </p>
                     </div>
                     <p>假设EVAL_FREQUENCY函数使用<span class="keyword">WHILE LOOP</span>语句而不是<span class="keyword">FOR LOOP</span>语句，并在建议的工资超过JOB_ID的最大工资后结束。</p>
                     <p>更改EVAL_FREQUENCY函数，如<a href="stored-subprograms-packages.html#GUID-CBFF6F8E-CB57-4897-BD86-467924F3BFBC__BABFBBDC">例5-7</a>中的粗体字所示。（有关打印字符串的过程的信息，DBMS_OUTPUT.PUT_LINE，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=ARPLS036" target="_blank"><span class="italic">Oracle数据库PL / SQL包和类型参考</span></a> 。）
                     </p>
                     <div class="example" id="GUID-CBFF6F8E-CB57-4897-BD86-467924F3BFBC__BABFBBDC">
                        <p class="titleinexample">例5-7 WHILE LOOP语句计算工资到最大值</p><pre class="oac_no_warn" dir="ltr">功能eval_frequency（emp_id IN EMPLOYEES.EMPLOYEE_ID％TYPE）返回PLS_INTEGER作为h_date EMPLOYEES.HIRE_DATE％TYPE;今天EMPLOYEES.HIRE_DATE％TYPE; eval_freq PLS_INTEGER; j_id EMPLOYEES.JOB_ID％TYPE; sal EMPLOYEES.SALARY％TYPE; sal_raise NUMBER（3,3）：= 0; <span class="bold">sal_max JOBS.MAX_SALARY％TYPE;</span>今天从DUAL开始选择SYSDATE INTO;选择HIRE_DATE，j。JOB_ID，SALARY， <span class="bold">MAX_SALARY</span> INTO h_date，j_id，sal， <span class="bold">sal_max</span> <span class="bold">FROM EMPLOYEES e，JOBS j</span> WHERE EMPLOYEE_ID = eval_frequency.emp_id AND JOB_ID = eval_frequency.j_id; IF（（h_date +（INTERVAL'12'MONTH））&lt;today）那么eval_freq：= 1; CASE j_id当'PU_CLERK'那么sal_raise：= 0.08;当'SH_CLERK'那么sal_raise：= 0.07;当'ST_CLERK'那么sal_raise：= 0.06;当'HR_REP'那么sal_raise：= 0.05;当'PR_REP'那么sal_raise：= 0.05;当'MK_REP'那么sal_raise：= 0.04; ELSE NULL;结束案例;如果（sal_raise！= 0）然后开始DBMS_OUTPUT.PUT_LINE（'如果工资'|| sal ||'增加'|| ROUND（（sal_raise * 100），0）|| <span class="bold">'％每年，它将是：'</span> ）; <span class="bold">当sal &lt;= sal_max LOOP</span> sal：= sal *（1 + sal_raise）; <span class="bold">DBMS_OUTPUT.PUT_LINE（ROUND（sal，2））;</span>结束循环; <span class="bold">DBMS_OUTPUT.PUT_LINE（'这份工作的最高工资是'|| sal_max）;</span>结束;万一; ELSE eval_freq：= 2;万一; RETURN eval_freq;结束eval_frequency;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-CBFF6F8E-CB57-4897-BD86-467924F3BFBC__GUID-C9C672CB-CCD2-4D36-B9D1-4C1EAF2D7C3B">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<span class="keyword">WHILE LOOP</span>语句语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01328" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关使用<span class="keyword">WHILE LOOP</span>语句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00403" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51" title="与按照输入顺序运行语句的SQL不同，PL / SQL具有控制语句，可以控制程序的流程。">控制程序流</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG233"></a><a id="TDDDG44230"></a><div class="props_rev_3"><a id="GUID-9D8169B6-3267-470B-907E-58D66F14562C" name="GUID-9D8169B6-3267-470B-907E-58D66F14562C"></a><h4 id="TDDDG-GUID-9D8169B6-3267-470B-907E-58D66F14562C" class="sect4"><span class="enumeration_section">5.8.6</span>使用基本循环并在语句时退出</h4>
                  <div>
                     <p>基本的<span class="keyword">LOOP</span>语句重复一系列语句。
                     </p>
                     <p>基本<span class="keyword">LOOP</span>语句的语法是：</p><pre class="oac_no_warn" dir="ltr">LOOP <span class="italic">声明</span> [， <span class="italic">声明</span> ] ......结束循环;</pre><p>至少有一个<span class="synph">语句</span>必须是<span class="keyword">EXIT</span>语句;否则， <span class="keyword">LOOP</span>语句无限期运行。
                     </p>
                     <p><span class="keyword">EXIT WHEN</span>语句（带有可选<span class="keyword">WHEN</span>子句的<span class="keyword">EXIT</span>语句）在条件为<span class="keyword">TRUE</span>时退出循环并将控制权转移到循环结束。
                     </p>
                     <p>在EVAL_FREQUENCY函数中，在<span class="keyword">WHILE LOOP</span>语句的最后一次迭代中，最后计算的值通常超过最大工资。
                     </p>
                     <p>将<span class="keyword">WHILE LOOP</span>语句更改为包含<span class="keyword">EXIT WHEN</span>语句的基本<span class="keyword">LOOP</span>语句，如<a href="stored-subprograms-packages.html#GUID-9D8169B6-3267-470B-907E-58D66F14562C__BABDCEFE">例5-8所示</a> 。
                     </p>
                     <div class="example" id="GUID-9D8169B6-3267-470B-907E-58D66F14562C__BABDCEFE">
                        <p class="titleinexample">例5-8使用EXIT WHEN语句</p><pre class="oac_no_warn" dir="ltr">功能eval_frequency（emp_id IN EMPLOYEES.EMPLOYEE_ID％TYPE）返回PLS_INTEGER作为h_date EMPLOYEES.HIRE_DATE％TYPE;今天EMPLOYEES.HIRE_DATE％TYPE; eval_freq PLS_INTEGER; j_id EMPLOYEES.JOB_ID％TYPE; sal EMPLOYEES.SALARY％TYPE; sal_raise NUMBER（3,3）：= 0; sal_max JOBS.MAX_SALARY％TYPE;今天从DUAL开始选择SYSDATE INTO;选择HIRE_DATE，j。JOB_ID，SALARY，MAX_SALARY INTO h_date，j_id，sal，sal_max FROM EMPLOYEES e，JOBS j WHERE EMPLOYEE_ID = eval_frequency.emp_id AND JOB_ID = eval_frequency.j_id; IF（（h_date +（INTERVAL'12'MONTH））&lt;today）那么eval_freq：= 1; CASE j_id当'PU_CLERK'那么sal_raise：= 0.08;当'SH_CLERK'那么sal_raise：= 0.07;当'ST_CLERK'那么sal_raise：= 0.06;当'HR_REP'那么sal_raise：= 0.05;当'PR_REP'那么sal_raise：= 0.05;当'MK_REP'那么sal_raise：= 0.04; ELSE NULL;结束案例;如果（sal_raise！= 0）然后开始DBMS_OUTPUT.PUT_LINE（'如果工资'|| sal ||'增加'|| ROUND（（sal_raise * 100），0）||'％每年，它将是：'）; <span class="bold">LOOP</span> <span class="bold">sal：= sal *（1 + sal_raise）;</span> <span class="bold">当sal&gt; sal_max时退出;</span> DBMS_OUTPUT.PUT_LINE（ROUND（SAL，2））; <span class="bold">结束循环;</span> DBMS_OUTPUT.PUT_LINE（'这份工作的最高工资是'|| sal_max）;结束;万一; ELSE eval_freq：= 2;万一; RETURN eval_freq;结束eval_frequency;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-9D8169B6-3267-470B-907E-58D66F14562C__GUID-B70FD2EC-E887-4D23-8A1B-2691EE6DBA35">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<span class="keyword">LOOP</span>语句语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01328" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<span class="keyword">EXIT</span>语句语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01318" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关使用<span class="keyword">LOOP</span>和<span class="keyword">EXIT</span>语句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00403" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51" title="与按照输入顺序运行语句的SQL不同，PL / SQL具有控制语句，可以控制程序的流程。">控制程序流</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TDDDG43000"></a><div class="props_rev_4"><a id="GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" name="GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38"></a><h3 id="TDDDG-GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" class="sect3"><span class="enumeration_section">5.9</span>使用记录和游标</h3>
               <div>
                  <p>您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-E8EB2F03-3417-4D92-8484-4593343E3DD5">关于记录</a><br><strong class="term">记录</strong>是PL / SQL复合变量，可以存储不同类型的数据值。您可以将内部组件（ <strong class="term">字段</strong> ）视为标量变量。您可以将整个记录作为子程序参数传递。记录对于保存表行或表行的某些列中的数据非常有用。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-706251E8-2ACF-4798-81A7-5BD61AEACE78">教程：声明记录类型</a><br>本教程介绍如何使用SQL Developer工具Edit来声明一个<span class="keyword">RECORD</span>类型sal_info，其字段可以包含员工作业ID的工资信息，该工作ID的最小和最大工资，当前工资和建议的加薪。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-BC10DB90-5802-4BEF-B89A-BC546C94863D">教程：使用记录参数创建和调用子程序</a><br>本教程介绍如何使用SQL Developer工具Edit创建和调用具有记录类型sal_info的参数的子程序。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F">关于游标</a><br>当Oracle数据库执行SQL语句时，它会将结果集和处理信息存储在未命名的私有SQL区域中。指向此未命名区域的指针（称为<strong class="term">游标</strong> ）允许您一次检索一行结果集。<strong class="term">游标属性</strong>返回有关<strong class="term">游标</strong>状态的信息。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-43519FA9-743A-4BB4-ADB3-A947650A9706">使用声明的游标一次检索一个结果集行</a><br>您可以使用声明的游标一次检索一个结果集行。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-F263299E-B3B7-4F80-924E-3B4777E03713">教程：使用声明的游标一次检索一个结果集行</a><br>本教程介绍如何实现EMP_EVAL.EVAL_DEPARTMENT过程，该过程使用声明的游标emp_cursor。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-AAF33D3B-FE73-42AC-AB07-3FA1A45CE02B">关于游标变量</a><br><strong class="term">游标变量</strong>就像一个游标，它不仅限于一个查询。您可以打开查询的游标变量，处理结果集，然后将游标变量用于另一个查询。游标变量对于在子程序之间传递查询结果很有用。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-C096B097-0B42-4D72-B702-85BADCF9DD26">使用游标变量一次检索一个结果集行</a><br>您可以使用游标变量一次检索一个结果集行。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-D8EAC5CF-8D2B-4BC3-A295-810B0BDF2F4B">教程：使用游标变量一次检索一个结果集行</a><br>本教程介绍如何更改EMP_EVAL.EVAL_DEPARTMENT过程，以便它使用游标变量而不是声明的游标（这使它可以处理多个部门）以及如何使EMP_EVAL.EVAL_DEPARTMENT和EMP_EVAL.ADD_EVAL更高效。
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38__GUID-64153AD0-83E2-4A26-801D-691EBF36F81A">
                     <p class="notep1">也可以看看：</p>
                     <p>有关记录的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS005" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               <a id="TDDDG99958"></a><div class="props_rev_3"><a id="GUID-E8EB2F03-3417-4D92-8484-4593343E3DD5" name="GUID-E8EB2F03-3417-4D92-8484-4593343E3DD5"></a><h4 id="TDDDG-GUID-E8EB2F03-3417-4D92-8484-4593343E3DD5" class="sect4"><span class="enumeration_section">5.9.1</span>关于记录</h4>
                  <div>
                     <p><strong class="term">记录</strong>是PL / SQL复合变量，可以存储不同类型的数据值。您可以将内部组件（ <strong class="term">字段</strong> ）视为标量变量。您可以将整个记录作为子程序参数传递。记录对于保存表行或表行的某些列中的数据非常有用。
                     </p>
                     <p><strong class="term">记录</strong>是PL / SQL复合变量，可以存储不同类型的数据值，类似于C，C ++或Java中的<span class="keyword">结构</span>类型。记录的内部组件称为<strong class="term">字段</strong> 。要访问记录字段，请使用<strong class="term">点表示法</strong> ： <span class="synph">record_name.field_name</span> 。
                     </p>
                     <p>您可以将记录字段视为标量变量。您还可以将整个记录作为子程序参数传递。</p>
                     <p>记录对于保存表行或表行的某些列中的数据非常有用。每个记录字段对应一个表列。</p>
                     <p>创建记录有三种方法：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>声明<strong class="term">RECORD</strong>类型，然后声明该类型的变量。
                           </p>
                           <p>语法是：</p><pre class="oac_no_warn" dir="ltr">TYPE <span class="italic">record_name</span> IS RECORD（ <span class="italic">field_name</span> <span class="italic">data_type</span> [：= <span class="italic">initial_value</span> ] [， <span class="italic">field_name</span> <span class="italic">data_type</span> [：= <span class="italic">initial_value</span> ]] ...）; <span class="italic">variable_name record_name</span> ;</pre></li>
                        <li>
                           <p>声明<span class="synph">table_name</span> <span class="keyword">％ROWTYPE</span>类型的变量。</p>
                           <p>记录的字段与表的列具有相同的名称和数据类型。</p>
                        </li>
                        <li>
                           <p>声明<span class="synph">cursor_name</span> <span class="keyword">％ROWTYPE</span>类型的变量。</p>
                           <p>记录的字段与游标<span class="keyword">SELECT</span>语句的<span class="keyword">FROM</span>子句中的表的列具有相同的名称和数据类型。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-E8EB2F03-3417-4D92-8484-4593343E3DD5__GUID-AF2D7EA0-1FC3-4E61-A953-9BB5A6B557BC">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关定义<span class="keyword">RECORD</span>类型和声明该类型记录的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00509" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01338" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考，</span></a>用于获取<span class="keyword">RECORD</span>类型定义的语法</p>
                           </li>
                           <li>
                              <p>有关<span class="keyword">％ROWTYPE</span>属性的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS99971" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01342" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> ，了解<span class="keyword">％ROWTYPE</span>属性的语法</p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" title="您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。">使用记录和游标</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG234"></a><a id="TDDDG99957"></a><div class="props_rev_3"><a id="GUID-706251E8-2ACF-4798-81A7-5BD61AEACE78" name="GUID-706251E8-2ACF-4798-81A7-5BD61AEACE78"></a><h4 id="TDDDG-GUID-706251E8-2ACF-4798-81A7-5BD61AEACE78" class="sect4"><span class="enumeration_section">5.9.2</span>教程：声明RECORD类型</h4>
                  <div>
                     <p>本教程介绍如何使用SQL Developer工具Edit来声明一个<span class="keyword">RECORD</span>类型sal_info，其字段可以包含员工作业ID的工资信息，该工作ID的最小和最大工资，当前工资和建议的加薪。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-706251E8-2ACF-4798-81A7-5BD61AEACE78__GUID-198A29A0-2A8B-442E-B45A-22BDA96361C7">要声明RECORD类型sal_info：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span><div>
                              <p>在<span class="wintitle">hr_conn</span>图标下，将显示架构对象类型列表。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>展开<span class="uicontrol bold">包</span> 。</span><div>
                              <p>出现包列表。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>右键单击<span class="uicontrol bold">EMP_EVAL</span> 。</span><div>
                              <p>出现一个选择列表。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>单击<span class="uicontrol bold">编辑</span> 。</span><div>
                              <p>将打开<span class="wintitle">EMP_EVAL</span>窗格，其中显示了<code class="codeph">CREATE PACKAGE</code>的<code class="codeph">CREATE PACKAGE</code>语句：</p><pre class="oac_no_warn" dir="ltr">创建或替换包EMP_EVAL作为程序eval_department（dept_id IN NUMBER）; FUNCTION calculate_score（evaluate_id IN NUMBER，performance_id IN NUMBER）返回号码; END EMP_EVAL;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在<span class="wintitle">EMP_EVAL</span>窗格中，紧接在<code class="codeph">END EMP_EVAL</code>之前，添加以下代码：</span><div><pre class="oac_no_warn" dir="ltr">TYPE sal_info IS RECORD（j_id jobs.job_id％type，sal_min jobs.min_salary％type，sal_max jobs.max_salary％type，sal employees.salary％type，sal_raise NUMBER（3,3））;</pre><p>窗格的标题是斜体字体，表示更改尚未保存到数据库。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>单击图标<span class="uicontrol bold">编译</span> 。</span><div>
                              <p>更改的包规范将编译并保存到数据库中。<span class="wintitle">EMP_EVAL</span>窗格的标题不再是斜体字体。
                              </p>
                              <p>现在，您可以声明sal_info类型的记录，如<span class="q">“ <a href="stored-subprograms-packages.html#GUID-BC10DB90-5802-4BEF-B89A-BC546C94863D" title="本教程介绍如何使用SQL Developer工具Edit创建和调用具有记录类型sal_info的参数的子程序。">教程：使用记录参数创建和调用子程序</a> ”中所述</span> 。
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" title="您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。">使用记录和游标</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG235"></a><a id="TDDDG99956"></a><div class="props_rev_3"><a id="GUID-BC10DB90-5802-4BEF-B89A-BC546C94863D" name="GUID-BC10DB90-5802-4BEF-B89A-BC546C94863D"></a><h4 id="TDDDG-GUID-BC10DB90-5802-4BEF-B89A-BC546C94863D" class="sect4"><span class="enumeration_section">5.9.3</span>教程：使用记录参数创建和调用子程序</h4>
                  <div>
                     <p>本教程介绍如何使用SQL Developer工具Edit创建和调用具有记录类型sal_info的参数的子程序。</p>
                     <div class="section">
                        <p>记录类型sal_info在<span class="q">“ <a href="stored-subprograms-packages.html#GUID-706251E8-2ACF-4798-81A7-5BD61AEACE78" title="本教程介绍如何使用SQL Developer工具Edit来声明一个RECORD类型sal_info，其字段可以包含员工作业ID的工资信息，该工作ID的最小和最大工资，当前工资和建议的加薪。">教程：声明记录类型</a> ”中创建</span> 。
                        </p>
                        <p>本教程介绍如何使用SQL Developer工具Edit执行以下操作：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>创建一个过程SALARY_SCHEDULE，其参数类型为sal_info。</p>
                           </li>
                           <li>
                              <p>更改EVAL_FREQUENCY函数，使其声明类型为sal_info的记录emp_sal，填充其字段，并将其传递给SALARY_SCHEDULE过程。</p>
                           </li>
                        </ul>
                        <p>因为EVAL_FREQUENCY将调用SALARY_SCHEDULE，所以SALARY_SCHEDULE的声明必须在EVAL_FREQUENCY声明之前（否则程序包将无法编译）。但是，SALARY_SCHEDULE的定义可以在包体中的任何位置。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-BC10DB90-5802-4BEF-B89A-BC546C94863D__GUID-C3EF5CEC-80B7-4D6F-9859-BDEF812FEF7D">要创建SALARY_SCHEDULE并更改EVAL_FREQUENCY：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<span class="wintitle">Connections</span>框架中，展开<span class="uicontrol bold">hr_conn</span> 。</span></li>
                        <li class="stepexpand"><span>在架构对象类型列表中，展开“ <span class="uicontrol bold">包”</span> 。</span></li>
                        <li class="stepexpand"><span>在包列表中，展开<span class="uicontrol bold">EMP_EVAL</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，右键单击<span class="uicontrol bold">EMP_EVAL Body</span> 。</span></li>
                        <li class="stepexpand"><span>在选项列表中，单击“ <span class="uicontrol bold">编辑”</span> 。</span><div>
                              <p>将出现<span class="wintitle">EMP_EVAL正文</span>窗格，显示包体的代码。
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在<span class="wintitle">EMP_EVAL正文</span>窗格中，紧接在<code class="codeph">END EMP_EVAL</code>之前，添加SALARY_SCHEDULE过程的此定义：</span><div><pre class="oac_no_warn" dir="ltr">PROCEDURE salary_schedule（emp IN sal_info）AS accumulating_sal NUMBER; BEGIN DBMS_OUTPUT.PUT_LINE（'如果薪水'|| emp.sal ||'增加'|| ROUND（（emp.sal_raise * 100），0）||'％每年，它将是：'）; accumulating_sal：= emp.sal; WHILE accumulating_sal &lt;= emp.sal_max LOOP accumulating_sal：= accumulating_sal *（1 + emp.sal_raise）; DBMS_OUTPUT.PUT_LINE（ROUND（accumulating_sal，2）||'，'）;结束循环; END salary_schedule;</pre><p>窗格的标题是斜体字体，表示更改尚未保存到数据库。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>在<span class="wintitle">EMP_EVAL正文</span>窗格中，输入以粗体显示的代码，位于以下位置：</span><div><pre class="oac_no_warn" dir="ltr">创建或替换包EOD_EVAL作为<span class="bold">功能eval_frequency（emp_id EMPLOYEES.EMPLOYEE_ID％TYPE）</span> <span class="bold">返回PLS_INTEGER;</span> <span class="bold">PROCEDURE salary_schedule（emp IN sal_info）;</span> <span class="bold">PROCEDURE add_eval（employee_id IN employees.employee_id％type，今天是IN DATE）;</span>程序eval_department（dept_id IN NUMBER）AS</pre></div>
                        </li>
                        <li class="stepexpand"><span>编辑<code class="codeph">EVAL_FREQUENCY</code>函数，使更改以粗体显示：</span><div><pre class="oac_no_warn" dir="ltr">功能eval_frequency（emp_id EMPLOYEES.EMPLOYEE_ID％TYPE）返回PLS_INTEGER作为h_date EMPLOYEES.HIRE_DATE％TYPE;今天EMPLOYEES.HIRE_DATE％TYPE; eval_freq PLS_INTEGER; <span class="bold">emp_sal SAL_INFO; - 替换sal，sal_raise和sal_max</span> BEGIN SELECT SYSDATE INTO今天FROM DUAL; SELECT HIRE_DATE INTO h_date FROM EMPLOYEES WHERE EMPLOYEE_ID = eval_frequency.emp_id; IF（（h_date +（INTERVAL'120'MONTH））&lt;today）那么eval_freq：= 1; <span class="bold">/ *填充emp_sal * /</span> <span class="bold">SELECT j。JOB_ID，j。MIN_SALARY，j。MAX_SALARY，e。SALARY</span> <span class="bold">INTO emp_sal.j_id，emp_sal.sal_min，emp_sal.sal_max，emp_sal.sal</span> <span class="bold">FROM EMPLOYEES e，JOBS j</span> <span class="bold">WHERE e。EMPLOYEE_ID = eval_frequency.emp_id</span> <span class="bold">AND j。JOB_ID = eval_frequency.emp_id;</span> <span class="bold">emp_sal.sal_raise：= 0; - 默认</span> CASE <span class="bold">emp_sal。</span> j_id当'PU_CLERK'然后是<span class="bold">emp_sal。</span> sal_raise：= 0.08;当'SH_CLERK'那么<span class="bold">emp_sal。</span> sal_raise：= 0.07;当'ST_CLERK'那么<span class="bold">emp_sal。</span> sal_raise：= 0.06;当'HR_REP'然后是<span class="bold">emp_sal。</span> sal_raise：= 0.05;当'PR_REP'那么<span class="bold">emp_sal。</span> sal_raise：= 0.05;当'MK_REP'那么<span class="bold">emp_sal。</span> sal_raise：= 0.04; ELSE NULL;结束案例; <span class="bold">IF（emp_sal。sal_raise！</span>= 0）那么<span class="bold">salary_schedule（emp_sal）;</span>万一; ELSE eval_freq：= 2;万一; RETURN eval_freq;结束eval_frequency;</pre></div>
                        </li>
                        <li class="stepexpand"><span>单击“ <span class="uicontrol bold">编译”</span> 。</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" title="您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。">使用记录和游标</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG236"></a><a id="TDDDG45000"></a><div class="props_rev_3"><a id="GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F" name="GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F"></a><h4 id="TDDDG-GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F" class="sect4"><span class="enumeration_section">5.9.4</span>关于游标</h4>
                  <div>
                     <p>当Oracle数据库执行SQL语句时，它会将结果集和处理信息存储在未命名的私有SQL区域中。指向此未命名区域的指针（称为<strong class="term">游标</strong> ）允许您一次检索一行结果集。<strong class="term">游标属性</strong>返回有关<strong class="term">游标</strong>状态的信息。
                     </p>
                     <p>每次运行SQL DML语句或PL / SQL <span class="keyword">SELECT INTO</span>语句时，PL / SQL都会打开一个<strong class="term">隐式游标</strong> 。您可以从其属性中获取有关此游标的信息，但无法控制它。语句运行后，数据库关闭游标;但是，在另一个DML或<span class="keyword">SELECT INTO</span>语句运行之前，其属性值仍然可用。
                     </p>
                     <p>PL / SQL还允许您声明游标。<strong class="term">声明的游标</strong>具有名称并与查询（SQL <span class="keyword">SELECT</span>语句）相关联 - 通常是返回多行的查询。声明游标后，必须隐式或显式处理它。要隐式处理游标，请使用游标<span class="keyword">FOR LOOP</span> 。语法是：</p><pre class="oac_no_warn" dir="ltr">FOR <span class="italic">record_name</span> IN <span class="italic">cursor_name</span> LOOP <span class="italic">语句</span> [ <span class="italic">statement</span> ] ...结束循环;</pre><p>要显式处理游标，请打开它（使用<span class="keyword">OPEN</span>语句），一次一个地从结果集中获取行或使用<span class="keyword">FETCH</span>语句获取行（使用<span class="keyword">FETCH</span>语句），然后关闭游标（使用<span class="keyword">CLOSE</span>语句）。关闭游标后，既不能从结果集中获取记录，也不能查看游标属性值。
                     </p>
                     <p>隐式游标属性值的语法是<span class="keyword">SQL％</span> <span class="synph">属性</span> （例如， <span class="keyword">SQL％FOUND</span> ）。<span class="keyword">SQL％</span> <span class="synph">属性</span>始终引用最近运行的DML或<span class="keyword">SELECT INTO</span>语句。
                     </p>
                     <p>声明的游标属性的值的语法是<span class="synph">cursor_name</span> ％ <span class="synph">属性</span> （例如，c1％FOUND）。
                     </p>
                     <p><a href="stored-subprograms-packages.html#GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F__BABCDDED" title="该表有三列四行。第一列列出了四个游标属性。第二列描述了属性为隐式游标返回的信息。第三列描述了属性为显式游标返回的信息。">表5-1</a>列出了游标属性及其可以返回的值。（隐式游标具有超出本书范围的其他属性。）
                     </p>
                     <div class="tblformal" id="GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F__BABCDDED">
                        <p class="titleintable">表5-1游标属性值</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="游标属性值" width="100%" border="1" summary="This table has three columns and four rows. The first column lists the four cursor attributes. The second column describes the information that the attribute returns for an implicit cursor. The third column describes the information that the attribute returns for an explicit cursor." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="19%" id="d16920e6554">属性</th>
                                 <th align="left" valign="bottom" width="41%" id="d16920e6557">声明游标的值</th>
                                 <th align="left" valign="bottom" width="41%" id="d16920e6560">隐式光标的值</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="19%" id="d16920e6565" headers="d16920e6554 ">
                                    <p><span class="keyword">％FOUND</span></p>
                                 </td>
                                 <td align="left" valign="top" width="41%" headers="d16920e6565 d16920e6557 ">
                                    <p>如果光标打开<a id="GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F__CIHFEFJI" name="GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F__CIHFEFJI" href="#GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F__CIHFEFJI" if="" the="" cursor="" is="" not="" open,="" attribute="" raises="" predefined="" exception="" invalid_cursor=")" ="" onclick="footdisplay(1, "><sup>Foot 1</sup></a>但未尝试获取，则为<span class="keyword">NULL</span> 。</p>
                                    <p>如果最近的提取返回一行， <span class="keyword">则为TRUE</span> 。</p>
                                    <p>如果最近的提取没有返回一行， <span class="keyword">则为FALSE</span> 。</p>
                                 </td>
                                 <td align="left" valign="top" width="41%" headers="d16920e6565 d16920e6560 ">
                                    <p>如果没有运行DML或<span class="keyword">SELECT INTO</span>语句， <span class="keyword">则为NULL</span> 。</p>
                                    <p>如果最新的DML或<span class="keyword">SELECT INTO</span>语句返回一行， <span class="keyword">则为TRUE</span> 。</p>
                                    <p>如果最近的DML或<span class="keyword">SELECT INTO</span>语句没有返回一行， <span class="keyword">则为FALSE</span> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="19%" id="d16920e6618" headers="d16920e6554 ">
                                    <p><span class="keyword">％未找到</span></p>
                                 </td>
                                 <td align="left" valign="top" width="41%" headers="d16920e6618 d16920e6557 ">
                                    <p>如果光标打开<a id="fnsrc_d16920e6625" name="fnsrc_d16920e6625" href="#fnsrc_d16920e6625" if="" the="" cursor="" is="" not="" open,="" attribute="" raises="" predefined="" exception="" invalid_cursor=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a>但未尝试获取， <a id="fnsrc_d16920e6625" name="fnsrc_d16920e6625" href="#fnsrc_d16920e6625" if="" the="" cursor="" is="" not="" open,="" attribute="" raises="" predefined="" exception="" invalid_cursor=")" ="" onclick="footdisplay(1, "><sup>则为</sup></a> <span class="keyword">NULL</span> 。</p>
                                    <p>如果最近的fetch返回一行， <span class="keyword">则为FALSE</span> 。</p>
                                    <p>如果最近的提取没有返回一行， <span class="keyword">则为TRUE</span> 。</p>
                                 </td>
                                 <td align="left" valign="top" width="41%" headers="d16920e6618 d16920e6560 ">
                                    <p>如果没有运行DML或<span class="keyword">SELECT INTO</span>语句， <span class="keyword">则为NULL</span> 。</p>
                                    <p>如果最近的DML或<span class="keyword">SELECT INTO</span>语句返回一行， <code class="codeph">FALSE</code> 。</p>
                                    <p>如果最新的DML或<span class="keyword">SELECT INTO</span>语句未返回行， <code class="codeph">TRUE</code> 。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="19%" id="d16920e6667" headers="d16920e6554 ">
                                    <p><span class="keyword">％ROWCOUNT</span></p>
                                 </td>
                                 <td align="left" valign="top" width="41%" headers="d16920e6667 d16920e6557 ">
                                    <p>如果光标打开<a id="fnsrc_d16920e6674" name="fnsrc_d16920e6674" href="#fnsrc_d16920e6674" if="" the="" cursor="" is="" not="" open,="" attribute="" raises="" predefined="" exception="" invalid_cursor=")" ="" onclick="footdisplay(1, "><sup>Footref 1</sup></a> ，则数字大于或等于零。
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="41%" headers="d16920e6667 d16920e6560 ">
                                    <p>如果没有运行DML或<span class="keyword">SELECT INTO</span>语句，则为<span class="keyword">NULL</span> ;否则，大于或等于零的数字。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="19%" id="d16920e6686" headers="d16920e6554 ">
                                    <p><span class="keyword">％开了</span></p>
                                 </td>
                                 <td align="left" valign="top" width="41%" headers="d16920e6686 d16920e6557 ">
                                    <p>如果光标打开，则为<span class="keyword">TRUE</span> ;如果没有， <span class="keyword">假</span> 。</p>
                                 </td>
                                 <td align="left" valign="top" width="41%" headers="d16920e6686 d16920e6560 ">
                                    <p>总是<span class="keyword">错的</span> 。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p class="tablefootnote"><sup class="tablefootnote">脚注1</sup></p><p>如果光标未打开，则该属性会引发预定义的异常<span class="keyword">INVALID_CURSOR</span> 。</p>
                     <p></p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F__GUID-9EE1F43C-95C2-4AFA-A9EF-48B50F411C40">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="connecting-exploring-database.html#GUID-A6EC754C-D820-43EC-8509-DD7CF663FD03" title="查询或SQL SELECT语句从一个或多个表或视图中选择数据。">关于查询</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="dml-and-transactions.html#GUID-40EE6F61-F008-4F37-8256-D31A2DE49DC9" title="数据操作语言（DML）语句访问和操作现有表中的数据。">关于数据操作语言（DML）声明</a> ”</span></p>
                           </li>
                           <li>
                              <p>有关<span class="keyword">SELECT INTO</span>语句的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01345" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关在PL / SQL中管理游标的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00602" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" title="您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。">使用记录和游标</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG237"></a><a id="TDDDG46100"></a><div class="props_rev_3"><a id="GUID-43519FA9-743A-4BB4-ADB3-A947650A9706" name="GUID-43519FA9-743A-4BB4-ADB3-A947650A9706"></a><h4 id="TDDDG-GUID-43519FA9-743A-4BB4-ADB3-A947650A9706" class="sect4"><span class="enumeration_section">5.9.5</span>使用声明的游标一次检索一个结果集行</h4>
                  <div>
                     <p>您可以使用声明的游标一次检索一个结果集行。</p>
                     <div class="section">
                        <p>以下过程以最简单的形式使用每个必需的语句，但提供对其完整语法的引用。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-43519FA9-743A-4BB4-ADB3-A947650A9706__GUID-39F20D83-7C62-4661-B563-B6E18699DA41">要使用声明的游标一次检索一个结果集行：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ol>
                           <li>
                              <p>在声明部分：</p>
                              <ol type="a">
                                 <li>
                                    <p>声明游标：</p><pre class="oac_no_warn" dir="ltr">CURSOR <span class="italic">cursor_name</span> IS <span class="italic">查询</span> ;</pre><p>有关完整声明的游标声明语法，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01313" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>声明一条记录来保存游标返回的行：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">record_name</span> <span class="italic">cursor_name</span> ％ROWTYPE;</pre><p>有关完整的<span class="keyword">％ROWTYPE</span>语法，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01342" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>在可执行部分：</p>
                              <ol type="a">
                                 <li>
                                    <p>打开光标：</p><pre class="oac_no_warn" dir="ltr">OPEN <span class="italic">cursor_name</span> ;</pre><p>有关完整的<span class="keyword">OPEN</span>语句语法，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01332" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用具有与此类似的语法的<span class="keyword">LOOP</span>语句一次一个地从游标（结果集中的行）中获取行：</p><pre class="oac_no_warn" dir="ltr">LOOP FETCH <span class="italic">cursor_name</span> INTO <span class="italic">record_name</span> ;退出时， <span class="italic">cursor_name</span> ％NOTFOUND; - 处于<span class="italic">record_name</span> ： <span class="italic">statement的</span>进程行; [ <span class="italic">声明</span> ; ] ...结束循环;</pre><p>有关完整的<span class="keyword">FETCH</span>语句语法，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01320" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>关闭光标：</p><pre class="oac_no_warn" dir="ltr">CLOSE <span class="italic">cursor_name</span> ;</pre><p>有关完整的<span class="keyword">CLOSE</span>语句语法，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01305" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                              </ol>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" title="您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。">使用记录和游标</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG238"></a><a id="TDDDG99953"></a><div class="props_rev_3"><a id="GUID-F263299E-B3B7-4F80-924E-3B4777E03713" name="GUID-F263299E-B3B7-4F80-924E-3B4777E03713"></a><h4 id="TDDDG-GUID-F263299E-B3B7-4F80-924E-3B4777E03713" class="sect4"><span class="enumeration_section">5.9.6</span>教程：使用声明的光标一次检索一个结果集行</h4>
                  <div>
                     <p>本教程介绍如何实现EMP_EVAL.EVAL_DEPARTMENT过程，该过程使用声明的游标emp_cursor。</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-F263299E-B3B7-4F80-924E-3B4777E03713__GUID-A211DA25-3E70-4116-BAA6-894D7991D61E">要实现EMP_EVAL.EVAL_DEPARTMENT过程：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在EMP_EVAL包规范中，更改EVAL_DEPARTMENT过程的声明，如粗体字所示：</span><div><pre class="oac_no_warn" dir="ltr">程序eval_department（dept_id IN <span class="bold">employees.department_id％TYPE</span> ）;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在EMP_EVAL包体中，更改EVAL_DEPARTMENT过程的定义，如粗体显示：</span><div><pre class="oac_no_warn" dir="ltr">程序eval_department（dept_id IN <span class="bold">employees.department_id％TYPE</span> ）AS <span class="bold">CURSOR emp_cursor IS</span> <span class="bold">SELECT * FROM EMPLOYEES</span> <span class="bold">WHERE DEPARTMENT_ID = eval_department.dept_id;</span> <span class="bold">emp_record EMPLOYEES％ROWTYPE;</span> - 由游标返回的行<span class="bold">all_evals BOOLEAN;</span> - 如果部门的所有员工<span class="bold">今天</span>都需要评估，则为真<span class="bold">;</span> <span class="bold">今天开始：= SYSDATE;</span> <span class="bold">如果（提取（今天一个月）&lt;6）那么</span> <span class="bold">all_evals：= FALSE;</span> - 只有新员工需要评估<span class="bold">ELSE</span> <span class="bold">all_evals：= TRUE;</span> - 所有员工都需要评估<span class="bold">END IF;</span> <span class="bold">OPEN emp_cursor;</span> <span class="bold">DBMS_OUTPUT.PUT_LINE（</span> <span class="bold">'确定部门＃'||</span> <span class="bold">dept_id中</span> <span class="bold">所需的评估</span> <span class="bold">）;</span> <span class="bold">LOOP</span> <span class="bold">FETCH emp_cursor INTO emp_record;</span> <span class="bold">当emp_cursor％NOTFOUND时退出;</span> <span class="bold">如果all_evals那么</span> <span class="bold">add_eval（emp_record.employee_id，今天）;</span> <span class="bold">ELSIF（eval_frequency（emp_record.employee_id）= 2）那么</span> <span class="bold">add_eval（emp_record.employee_id，今天）;</span> <span class="bold">万一;</span> <span class="bold">结束循环;</span> <span class="bold">DBMS_OUTPUT.PUT_LINE（'Processed'|| emp_cursor％ROWCOUNT ||'记录。“）;</span> <span class="bold">关闭emp_cursor;</span> END eval_department;</pre><p>（有关更改包体的分步示例，请参阅<span class="q">“ <a href="stored-subprograms-packages.html#GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413" title="本教程介绍如何使用SQL Developer工具Edit在EMP_EVAL.CALCULATE_SCORE函数中声明变量和常量。（本教程也是更改包体的示例。）">教程：在子程序中声明变量和常量</a> ”</span> 。）
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>编译EMP_EVAL包规范。</span></li>
                        <li class="stepexpand"><span>编译EMP_EVAL包体。</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" title="您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。">使用记录和游标</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG99939"></a><div class="props_rev_3"><a id="GUID-AAF33D3B-FE73-42AC-AB07-3FA1A45CE02B" name="GUID-AAF33D3B-FE73-42AC-AB07-3FA1A45CE02B"></a><h4 id="TDDDG-GUID-AAF33D3B-FE73-42AC-AB07-3FA1A45CE02B" class="sect4"><span class="enumeration_section">5.9.7</span>关于游标变量</h4>
                  <div>
                     <p><strong class="term">游标变量</strong>就像一个游标，它不仅限于一个查询。您可以打开查询的游标变量，处理结果集，然后将游标变量用于另一个查询。游标变量对于在子程序之间传递查询结果很有用。
                     </p>
                     <p>有关游标的信息，请参阅<span class="q">“ <a href="stored-subprograms-packages.html#GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F" title="当Oracle数据库执行SQL语句时，它会将结果集和处理信息存储在未命名的私有SQL区域中。指向此未命名区域的指针（称为游标）允许您一次检索一行结果集。游标属性返回有关游标状态的信息。">关于游标</a> ”</span> 。
                     </p>
                     <p>要声明游标变量，请声明<span class="keyword">REF CURSOR</span>类型，然后声明该类型的变量（因此，游标变量通常称为<strong class="term">REF CURSOR</strong> ）。<span class="keyword">REF CURSOR</span>类型可以是强或弱。
                     </p>
                     <p><strong class="term">强REF CURSOR类型</strong>指定<strong class="term">返回类型</strong> ，它是其游标变量的<span class="keyword">RECORD</span>类型。PL / SQL编译器不允许您对返回不是返回类型的行的查询使用这些<strong class="term">强类型</strong>游标变量。强<span class="keyword">REF CURSOR</span>类型比弱类型更容易出错，但弱类型更灵活。
                     </p>
                     <p><strong class="term">弱REF CURSOR类型</strong>未指定返回类型。PL / SQL编译器在任何查询中接受<strong class="term">弱类型的</strong>游标变量。弱<span class="keyword">REF CURSOR</span>类型可互换;因此，您可以使用预定义类型弱光标类型<span class="keyword">SYS_REFCURSOR</span> ，而不是创建弱<span class="keyword">REF CURSOR</span>类型。</p>
                     <p>声明游标变量后，必须为特定查询打开它（使用<span class="keyword">OPEN FOR</span>语句），从结果集中获取一行（使用<span class="keyword">FETCH</span>语句），然后关闭游标（使用<span class="keyword">CLOSE</span>语句） ）或者为另一个特定查询打开它（使用<span class="keyword">OPEN FOR</span>语句）。打开另一个查询的游标变量会将其关闭以用于上一个查询。关闭特定查询的游标变量后，既不能从该查询的结果集中获取记录，也不能查看该查询的游标属性值。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-AAF33D3B-FE73-42AC-AB07-3FA1A45CE02B__GUID-C287FF43-0395-4EDA-B357-958E8106AF9D">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关使用游标变量的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00605" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01312" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考，</span></a>用于游标变量声明的语法</p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" title="您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。">使用记录和游标</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG239"></a><a id="TDDDG99954"></a><div class="props_rev_3"><a id="GUID-C096B097-0B42-4D72-B702-85BADCF9DD26" name="GUID-C096B097-0B42-4D72-B702-85BADCF9DD26"></a><h4 id="TDDDG-GUID-C096B097-0B42-4D72-B702-85BADCF9DD26" class="sect4"><span class="enumeration_section">5.9.8</span>使用游标变量一次检索一个结果集行</h4>
                  <div>
                     <p>您可以使用游标变量一次检索一个结果集行。</p>
                     <div class="section">
                        <p>以下过程以最简单的形式使用每个必要的语句，但提供了对其完整语法的引用。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-C096B097-0B42-4D72-B702-85BADCF9DD26__GUID-77F8B405-96C4-48AA-A32C-D78B177905BF">要使用游标变量一次检索一个结果集行：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ol>
                           <li>
                              <p>在声明部分：</p>
                              <ol type="a">
                                 <li>
                                    <p>声明<span class="keyword">REF CURSOR</span>类型：</p><pre class="oac_no_warn" dir="ltr">TYPE <span class="italic">cursor_type</span>是REF CURSOR [RETURN <span class="italic"><code class="codeph">return_type</code></span> ];</pre><p>有关完整的<span class="keyword">REF CURSOR</span>类型声明语法，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01312" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>声明该类型的游标变量：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">cursor_variable cursor_type</span> ;</pre><p>有关完整的游标变量声明语法，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01312" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>声明一条记录来保存游标返回的行：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">record_name</span> <span class="italic"><code class="codeph">return_type</code></span> ;</pre><p>有关记录声明语法的完整信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01338" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>在可执行部分：</p>
                              <ol type="a">
                                 <li>
                                    <p>打开特定查询的游标变量：</p><pre class="oac_no_warn" dir="ltr">OPEN <span class="italic">cursor_variable</span> FOR <span class="italic">查询</span> ;</pre><p>有关<span class="keyword">OPEN FOR</span>语句语法的完整信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01333" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>使用具有与此类似的语法的<span class="keyword">LOOP</span>语句一次一个地从游标变量（结果集中的行）中获取行：</p><pre class="oac_no_warn" dir="ltr">LOOP FETCH <span class="italic">cursor_variable</span> INTO <span class="italic">record_name</span> ;退出时， <span class="italic">cursor_variable</span> ％NOTFOUND; - 处于<span class="italic">record_name</span> ： <span class="italic">statement的</span>进程行; [ <span class="italic">声明</span> ; ] ...结束循环;</pre><p>有关<span class="keyword">FETCH</span>语句语法的完整信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01320" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>关闭游标变量：</p><pre class="oac_no_warn" dir="ltr">CLOSE <span class="italic">cursor_variable</span> ;</pre><p>或者，您可以打开另一个查询的游标变量，该查询会为当前查询关闭它。</p>
                                    <p>有关<span class="keyword">CLOSE</span>语句语法的完整信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01305" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                              </ol>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" title="您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。">使用记录和游标</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG240"></a><a id="TDDDG99955"></a><div class="props_rev_3"><a id="GUID-D8EAC5CF-8D2B-4BC3-A295-810B0BDF2F4B" name="GUID-D8EAC5CF-8D2B-4BC3-A295-810B0BDF2F4B"></a><h4 id="TDDDG-GUID-D8EAC5CF-8D2B-4BC3-A295-810B0BDF2F4B" class="sect4"><span class="enumeration_section">5.9.9</span>教程：使用游标变量一次检索一个结果集行</h4>
                  <div>
                     <p>本教程介绍如何更改EMP_EVAL.EVAL_DEPARTMENT过程，以便它使用游标变量而不是声明的游标（这使它可以处理多个部门）以及如何使EMP_EVAL.EVAL_DEPARTMENT和EMP_EVAL.ADD_EVAL更高效。</p>
                     <div class="section">
                        <p>本教程如何使EMP_EVAL.EVAL_DEPARTMENT和EMP_EVAL.ADD_EVAL更高效：EVAL_DEPARTMENT将整个记录传递给ADD_EVAL和ADD_EVAL，而不是将记录的一个字段传递给ADD_EVAL并让ADD_EVAL使用三个查询来提取同一记录的三个其他字段。使用点表示法来访问其他三个字段的值。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-D8EAC5CF-8D2B-4BC3-A295-810B0BDF2F4B__GUID-030F40F1-4AAE-4C3D-B530-1B626D5A4488">要更改EMP_EVAL.EVAL_DEPARTMENT过程以使用游标变量：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在EMP_EVAL包规范中，添加过程声明和<span class="keyword">REF CURSOR</span>类型定义，如粗体字所示：</span><div><pre class="oac_no_warn" dir="ltr">创建或替换包装emp_eval AS PROCEDURE eval_department（dept_id IN employees.department_id％TYPE）; <span class="bold">程序eval_everyone;</span> FUNCTION calculate_score（eval_id IN scores.evaluation_id％TYPE，perf_id IN scores.performance_id％TYPE）返回号码; TYPE SAL_INFO是RECORD（j_id jobs.job_id％type，sal_min jobs.min_salary％type，sal_max jobs.max_salary％type，salary employees.salary％type，sal_raise NUMBER（3,3））; <span class="bold">TYPE emp_refcursor_type IS REF CURSOR RETURN员工％ROWTYPE;</span> END emp_eval;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在EMP_EVAL包体中，为过程EVAL_LOOP_CONTROL添加一个前向声明，并更改过程ADD_EVAL的声明，如粗体字所示：</span><div><pre class="oac_no_warn" dir="ltr">创建或替换包装EMP_EVAL作为功能eval_frequency（emp_id IN EMPLOYEES.EMPLOYEE_ID％TYPE）RETURN PLS_INTEGER; PROCEDURE salary_schedule（emp IN sal_info）; <span class="bold">程序add_eval（emp_record IN EMPLOYEES％ROWTYPE，今天是日期）;</span> <span class="bold">程序eval_loop_control（emp_cursor IN emp_refcursor_type）;</span> ...</pre><p>（有关更改包体的分步示例，请参阅<span class="q">“ <a href="stored-subprograms-packages.html#GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413" title="本教程介绍如何使用SQL Developer工具Edit在EMP_EVAL.CALCULATE_SCORE函数中声明变量和常量。（本教程也是更改包体的示例。）">教程：在子程序中声明变量和常量</a> ”</span> 。）
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>更改EVAL_DEPARTMENT过程以根据部门检索三个单独的结果集，并调用EVAL_LOOP_CONTROL过程，如粗体字所示：</span><div><pre class="oac_no_warn" dir="ltr">PROCEDURE eval_department（dept_id IN employees.department_id％TYPE）AS <span class="bold">emp_cursor emp_refcursor_type;</span> <span class="bold">current_dept departments.department_id％TYPE;</span> BEGIN <span class="bold">current_dept：= dept_id;</span> <span class="bold">FOR loop_c IN 1..3 LOOP</span> <span class="bold">OPEN emp_cursor FOR</span> <span class="bold">SELECT *</span> <span class="bold">FROM employees</span> <span class="bold">WHERE current_dept = eval_department.dept_id;</span> DBMS_OUTPUT.PUT_LINE（'确定部门＃'|| <span class="bold">current_dept中的</span>必要评估）; <span class="bold">eval_loop_control（emp_cursor）;</span> DBMS_OUTPUT.PUT_LINE（'Processed'|| emp_cursor％ROWCOUNT ||'记录。“）;关闭emp_cursor; <span class="bold">current_dept：= current_dept + 10;</span> <span class="bold">结束循环;</span> END eval_department;</pre></div>
                        </li>
                        <li class="stepexpand"><span>更改ADD_EVAL过程，如粗体显示：</span><div><pre class="oac_no_warn" dir="ltr">程序add_eval（ <span class="bold">emp_record IN employees％ROWTYPE</span> ，今天在日期）AS <span class="bold">- （删除局部变量）</span> BEGIN INSERT INTO EVALUATIONS（evaluation_id，employee_id，evaluation_date，job_id，manager_id，department_id，total_score）VALUES（evaluations_sequence。NEXTVAL， -  evaluation_id <span class="bold">emp_record.employee_id， -  employee_id</span> today， -  evaluation_date <span class="bold">emp_record.job_id， -  job_id</span> <span class="bold">emp_record.manager_id， -  manager_id</span> <span class="bold">emp_record.department_id， -  department_id</span> 0  -  total_score）; END add_eval;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在<code class="codeph">END EMP_EVAL</code>之前，添加以下过程，该过程从结果集中提取单个记录并处理它们：</span><div><pre class="oac_no_warn" dir="ltr">程序eval_loop_control（emp_cursor IN emp_refcursor_type）AS emp_record EMPLOYEES％ROWTYPE; all_evals BOOLEAN;今天DATE;今天开始：= SYSDATE;如果（提取（今天一个月）&lt;6）那么all_evals：= FALSE; ELSE all_evals：= TRUE;万一; LOOP FETCH emp_cursor INTO emp_record;当emp_cursor％NOTFOUND时退出;如果all_evals那么add_eval（emp_record，今天）; ELSIF（eval_frequency（emp_record.employee_id）= 2）那么add_eval（emp_record，今天）;万一;结束循环; END eval_loop_control;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在<code class="codeph">END EMP_EVAL</code>之前，添加以下过程，该过程检索包含公司中所有员工的结果集：</span><div><pre class="oac_no_warn" dir="ltr">程序eval_everyone AS emp_cursor emp_refcursor_type; BEGIN OPEN emp_cursor FOR SELECT * FROM employees; DBMS_OUTPUT.PUT_LINE（'确定必要评估的数量。“）; eval_loop_control（emp_cursor）; DBMS_OUTPUT.PUT_LINE（'Processed'|| emp_cursor％ROWCOUNT ||'记录。“）;关闭emp_cursor; END eval_everyone;</pre></div>
                        </li>
                        <li class="stepexpand"><span>编译<code class="codeph">EMP_EVAL</code>包规范。</span></li>
                        <li class="stepexpand"><span>编译<code class="codeph">EMP_EVAL</code>包体。</span></li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-3D91FF89-07B3-4F27-9E73-FCFDA001EF38" title="您可以将数据值存储在记录中，并使用游标作为指向结果集和相关处理信息的指针。">使用记录和游标</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TDDDG49000"></a><div class="props_rev_4"><a id="GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E" name="GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E"></a><h3 id="TDDDG-GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E" class="sect3"><span class="enumeration_section">5.10</span>使用关联数组</h3>
               <div>
                  <p>关联数组是一种集合。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-8D238CE2-20B7-47DB-A20B-A5AE23B8ABFD">关于收藏</a><br><strong class="term">集合</strong>是PL / SQL复合变量，它以指定的顺序存储相同类型的元素，类似于一维数组。集合的内部组件称为<strong class="term">元素</strong> 。每个元素都有一个唯一的下标，用于标识其在集合中的位置。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-159C7208-9AA4-479F-8DDC-8C1812785DC1">关于关联数组</a><br><strong class="term">关联数组</strong>是一组无限的键值对。每个键都是唯一的，并且用作保存相应值的元素的下标。因此，您可以访问元素而无需知道它们在数组中的位置，也无需遍历数组。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-43060654-B9CC-45E3-B7F3-0233753279A1">声明关联数组</a><br>要声明关联数组，请声明关联数组类型，然后声明该类型的变量。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-018BD661-D3E1-49D6-A46B-BC8006672B7F">填充关联数组</a><br>填充密集关联数组的最有效方法通常是使用带有<span class="keyword">BULK COLLECT INTO</span>子句的<span class="keyword">SELECT</span>语句。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-E02BABFA-5547-4A52-BEA3-716D4E6D86AE">遍历密集关联数组</a><br><strong class="term">密集关联数组</strong> （由整数索引）在元素之间没有间隙 - 第一个和最后一个元素之间的每个元素都被定义并且具有一个值（可以是<span class="keyword">NULL</span> ）。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-0139973B-C839-4049-82C1-5AC0D7D69778">遍历稀疏关联数组</a><br><strong class="term">稀疏关联数组</strong> （由字符串索引）可能在元素之间存在间隙。
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E__GUID-362FE22D-4364-45F5-A44C-64A836F856F7">
                     <p class="notep1">也可以看看：</p>
                     <p>有关集合的更多信息：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=CNCPT1787" target="_blank"><span class="italic">Oracle数据库概念</span></a> 
                           </p>
                        </li>
                        <li>
                           <p><a href="../lnpls/plsql-collections-and-records.html#LNPLS005" target="_blank"><span class="italic">Oracle数据库PL / SQL语言参考</span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               <a id="TDDDG99952"></a><div class="props_rev_3"><a id="GUID-8D238CE2-20B7-47DB-A20B-A5AE23B8ABFD" name="GUID-8D238CE2-20B7-47DB-A20B-A5AE23B8ABFD"></a><h4 id="TDDDG-GUID-8D238CE2-20B7-47DB-A20B-A5AE23B8ABFD" class="sect4"><span class="enumeration_section">5.10.1</span>关于集合</h4>
                  <div>
                     <p><strong class="term">集合</strong>是PL / SQL复合变量，它以指定的顺序存储相同类型的元素，类似于一维数组。集合的内部组件称为<strong class="term">元素</strong> 。每个元素都有一个唯一的下标，用于标识其在集合中的位置。
                     </p>
                     <p>要访问集合元素，请使用<strong class="term">下标表示法</strong> ： <span class="synph">collection_name</span> （ <span class="synph">element_subscript</span> ）。
                     </p>
                     <p>您可以将集合元素视为标量变量。您还可以将整个集合作为子程序参数传递（如果发送子节点和接收子程序都不是独立的子程序）。</p>
                     <p><strong class="term">集合方法</strong>是内置的PL / SQL子程序，它返回有关集合的信息或对集合进行操作。要调用集合方法，请使用<strong class="term">点表示法</strong> ： <span class="synph">collection_name</span> 。 <span class="synph">method_name</span> 。例如， <span class="synph">collection_name</span> 。<span class="keyword">COUNT</span>返回集合中的元素数。
                     </p>
                     <p>PL / SQL有三种类型的集合：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>关联数组（以前称为“PL / SQL表”或“索引表”）</p>
                        </li>
                        <li>
                           <p>嵌套表</p>
                        </li>
                        <li>
                           <p>变量数组（varrays）</p>
                        </li>
                     </ul>
                     <p>本文档仅解释了关联数组。</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-8D238CE2-20B7-47DB-A20B-A5AE23B8ABFD__GUID-8725CEBB-0EC4-4EC8-A950-A96559C5BB54">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关PL / SQL集合类型的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00501" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关集合方法的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00508" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E" title="关联数组是一种集合。">使用关联数组</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG99951"></a><div class="props_rev_3"><a id="GUID-159C7208-9AA4-479F-8DDC-8C1812785DC1" name="GUID-159C7208-9AA4-479F-8DDC-8C1812785DC1"></a><h4 id="TDDDG-GUID-159C7208-9AA4-479F-8DDC-8C1812785DC1" class="sect4"><span class="enumeration_section">5.10.2</span>关于关联数组</h4>
                  <div>
                     <p><strong class="term">关联数组</strong>是一组无限的键值对。每个键都是唯一的，并且用作保存相应值的元素的下标。因此，您可以访问元素而无需知道它们在数组中的位置，也无需遍历数组。
                     </p>
                     <p>密钥的数据类型可以是<span class="keyword">PLS_INTEGER</span>或<span class="keyword">VARCHAR2</span> （ <span class="synph">长度</span> ）。
                     </p>
                     <p>如果键的数据类型是<span class="keyword">PLS_INTEGER</span>并且关联数组是<strong class="term">由整数索引</strong>并且是<strong class="term">密集的</strong> （即，元素之间没有间隙），那么第一个和最后一个元素之间的每个元素都被定义并且具有一个值（可以是<span class="keyword">NULL</span> ）。
                     </p>
                     <p>如果密钥类型是<span class="keyword">VARCHAR2</span> （ <span class="synph">长度</span> ），则关联数组<strong class="term">由字符串</strong> （ <span class="synph">长度为</span>字符） <strong class="term">索引</strong>并且是<strong class="term">稀疏的</strong> ;也就是说，元素之间可能存在间隙。
                     </p>
                     <p>遍历密集关联数组时，您无需注意元素之间的间隙;在遍历稀疏关联数组时，你会这样做。</p>
                     <p>要为关联数组元素赋值，可以使用赋值运算符：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">array_name</span> （ <span class="italic">key</span> ）：= <span class="italic">value</span>
</pre><p>如果<span class="synph">key</span>不在数组中，则赋值语句将<span class="synph">键</span> - <span class="synph">值</span>对添加到数组中。否则，该语句将<span class="synph">array_name</span> （ <span class="synph">key</span> ）的值更改为<span class="synph">value</span> 。
                     </p>
                     <p>关联数组对于临时存储数据很有用。它们不使用表所需的磁盘空间或网络操作。但是，由于关联数组用于临时存储，因此无法使用DML语句对其进行操作。</p>
                     <p>如果在包中声明关联数组并将值赋给包体中的变量，则关联数组在数据库会话的生命周期中存在。否则，它存在于您声明它的子程序的生命周期中。</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-159C7208-9AA4-479F-8DDC-8C1812785DC1__GUID-BB3C11A9-15AE-4BDE-9235-1B7C45F230C0">
                        <p class="notep1">也可以看看：</p>
                        <p>有关关联数组的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS99969" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E" title="关联数组是一种集合。">使用关联数组</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG241"></a><a id="TDDDG242"></a><a id="TDDDG99950"></a><div class="props_rev_3"><a id="GUID-43060654-B9CC-45E3-B7F3-0233753279A1" name="GUID-43060654-B9CC-45E3-B7F3-0233753279A1"></a><h4 id="TDDDG-GUID-43060654-B9CC-45E3-B7F3-0233753279A1" class="sect4"><span class="enumeration_section">5.10.3</span>声明关联数组</h4>
                  <div>
                     <p>要声明关联数组，请声明关联数组类型，然后声明该类型的变量。</p>
                     <div class="section">
                        <p>最简单的语法是：</p><pre class="oac_no_warn" dir="ltr">TYPE <span class="italic">array_type</span> IS TABLE OF <span class="italic">element_type</span> INDEX BY <span class="italic">key_type</span> ; <span class="italic">array_name array_type</span> ;</pre><p>声明关联数组的有效方法是使用游标，使用以下过程。该过程以最简单的形式使用每个必需的语句，但提供对其完整语法的引用。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-43060654-B9CC-45E3-B7F3-0233753279A1__GUID-190D12B7-5F66-4604-8AAE-0DE3334FB2A4">要使用游标声明关联数组：</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ol>
                           <li>
                              <p>在声明部分：</p>
                              <ol type="a">
                                 <li>
                                    <p>声明游标：</p><pre class="oac_no_warn" dir="ltr">CURSOR <span class="italic">cursor_name</span> IS <span class="italic">查询</span> ;</pre><p>有关完整声明的游标声明语法，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01307" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>声明关联数组类型：</p><pre class="oac_no_warn" dir="ltr">TYPE <span class="italic">array_type</span> IS TABLE OF <span class="italic">cursor_name</span> ％ROWTYPE INDEX BY {PLS_INTEGER | VARCHAR2 <span class="italic"><code class="codeph">length</code></span> }</pre><p>有关完整的关联数组类型声明语法，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01313" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>声明该类型的关联数组变量：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">array_name array_type</span> ;</pre><p>有关完整的变量声明语法，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01388" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                                    </p>
                                 </li>
                              </ol>
                           </li>
                        </ol>
                        <p><a href="stored-subprograms-packages.html#GUID-43060654-B9CC-45E3-B7F3-0233753279A1__BABCJGAD">例5-9</a>使用前面的过程来声明两个关联数组employees_jobs和jobs_，然后声明第三个关联数组job_titles，而不使用游标。前两个数组用整数索引;第三个是用字符串索引的。
                        </p>
                        <div class="infoboxnote" id="GUID-43060654-B9CC-45E3-B7F3-0233753279A1__GUID-BC6A1B46-CE6D-4C39-AEB6-065023B584B4">
                           <p class="notep1">注意：</p>
                           <p>employees_jobs_cursor声明中的<span class="keyword">ORDER BY</span>子句确定关联数组employee_jobs的元素的存储顺序。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-43060654-B9CC-45E3-B7F3-0233753279A1__BABCJGAD">
                        <p class="titleinexample">例5-9声明关联数组</p><pre class="oac_no_warn" dir="ltr">DECLARE  - 声明游标：CURSOR employees_jobs_cursor IS SELECT FIRST_NAME，LAST_NAME，来自员工的JOB_ID，由JOB_ID，LAST_NAME，FIRST_NAME订购; - 声明关联数组类型：TYPE employees_jobs_type IS TABLE OF employees_jobs_cursor％ROWTYPE INDEX BY PLS_INTEGER; - 声明关联数组：employees_jobs employees_jobs_type; - 使用相同的过程声明另一个关联数组：CURSOR jobs_cursor IS SELECT JOB_ID，JOB_TITLE FROM JOBS; TYPE jobs_type IS TABLE OF jobs_cursor％ROWTYPE INDEX BY PLS_INTEGER; jobs_ jobs_type; - 在不使用游标的情况下声明关联数组：TYPE job_titles_type IS TABLE of JOBS.JOB_TITLE％TYPE INDEX BY JOBS.JOB_ID％TYPE; -  jobs.job_id％type是varchar2（10）job_titles job_titles_type; BEGIN NULL;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-43060654-B9CC-45E3-B7F3-0233753279A1__GUID-46714F5E-355F-407C-A7C4-097C96A56ABB">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="stored-subprograms-packages.html#GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F" title="当Oracle数据库执行SQL语句时，它会将结果集和处理信息存储在未命名的私有SQL区域中。指向此未命名区域的指针（称为游标）允许您一次检索一行结果集。游标属性返回有关游标状态的信息。">关于游标</a> ”</span></p>
                           </li>
                           <li>
                              <p>用于关联数组声明语法的<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01307" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E" title="关联数组是一种集合。">使用关联数组</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG244"></a><a id="TDDDG99949"></a><div class="props_rev_3"><a id="GUID-018BD661-D3E1-49D6-A46B-BC8006672B7F" name="GUID-018BD661-D3E1-49D6-A46B-BC8006672B7F"></a><h4 id="TDDDG-GUID-018BD661-D3E1-49D6-A46B-BC8006672B7F" class="sect4"><span class="enumeration_section">5.10.4填充</span>关联数组</h4>
                  <div>
                     <p>填充密集关联数组的最有效方法通常是使用带有<span class="keyword">BULK COLLECT INTO</span>子句的<span class="keyword">SELECT</span>语句。
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-018BD661-D3E1-49D6-A46B-BC8006672B7F__GUID-0A5653FB-10F5-4F3B-AA64-BB86CA903C6F">
                           <p class="notep1">注意：</p>
                           <p>如果密集关联数组太大以致<span class="keyword">SELECT</span>语句返回的结果集太大而无法放入内存中，则不要使用<span class="keyword">SELECT</span>语句。而是使用游标填充数组，并使用子句<span class="keyword">BULK COLLECT INTO</span>和<span class="keyword">LIMIT</span>填充<span class="keyword">FETCH</span>语句。有关将<span class="keyword">FETCH</span>语句与<span class="keyword">BULK COLLECT INTO</span>子句一起使用的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS894" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                           </p>
                        </div>
                        <p>您不能使用<span class="keyword">SELECT</span>语句来填充稀疏关联数组（例如<span class="q">“ <a href="stored-subprograms-packages.html#GUID-43060654-B9CC-45E3-B7F3-0233753279A1" title="要声明关联数组，请声明关联数组类型，然后声明该类型的变量。">声明关联数组</a> ”中的</span> job_titles）。相反，您必须在循环语句中使用赋值语句。有关循环语句的信息，请参阅<span class="q">“ <a href="stored-subprograms-packages.html#GUID-19AC8484-5CCE-4037-9E53-E95ACBCB2E51" title="与按照输入顺序运行语句的SQL不同，PL / SQL具有控制语句，可以控制程序的流程。">控制程序流</a> ”</span> 。
                        </p>
                        <p><a href="stored-subprograms-packages.html#GUID-018BD661-D3E1-49D6-A46B-BC8006672B7F__CIHJHGAI">例5-10</a>使用<span class="keyword">SELECT</span>语句填充关联数组employees_jobs和jobs_，它们由整数索引。然后，它使用<span class="keyword">FOR LOOP</span>语句中的赋值语句来填充关联数组job_titles，该数组由string索引。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-018BD661-D3E1-49D6-A46B-BC8006672B7F__CIHJHGAI">
                        <p class="titleinexample">示例5-10填充关联数组</p><pre class="oac_no_warn" dir="ltr">- <a href="stored-subprograms-packages.html#GUID-43060654-B9CC-45E3-B7F3-0233753279A1__BABCJGAD">例5-9中的</a>声明部分就在这里。BEGIN  - 填充由整数索引的关联数组：SELECT FIRST_NAME，LAST_NAME，JOB_ID BULK COLLECT INTO employees_jobs FROM EMPLOYEES ORDER by JOB_ID，LAST_NAME，FIRST_NAME; SELECT JOB_ID，JOB_TITLE BULK收集job_ FROM JOBS; - 填充由字符串索引的关联数组：FOR i IN 1..jobs_。COUNT（）LOOP job_titles（jobs_（i）.job_id）：= jobs_（i）.job_title;结束循环;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-018BD661-D3E1-49D6-A46B-BC8006672B7F__GUID-770F4BFA-4B8E-4E1E-B9CB-0F9A71264D1B">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="stored-subprograms-packages.html#GUID-05FA9E55-F394-4A5F-A3C6-39EC0F68549F" title="当Oracle数据库执行SQL语句时，它会将结果集和处理信息存储在未命名的私有SQL区域中。指向此未命名区域的指针（称为游标）允许您一次检索一行结果集。游标属性返回有关游标状态的信息。">关于游标</a> ”</span></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E" title="关联数组是一种集合。">使用关联数组</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG245"></a><a id="TDDDG49500"></a><div class="props_rev_3"><a id="GUID-E02BABFA-5547-4A52-BEA3-716D4E6D86AE" name="GUID-E02BABFA-5547-4A52-BEA3-716D4E6D86AE"></a><h4 id="TDDDG-GUID-E02BABFA-5547-4A52-BEA3-716D4E6D86AE" class="sect4"><span class="enumeration_section">5.10.5</span>遍历密集关联数组</h4>
                  <div>
                     <p><strong class="term">密集关联数组</strong> （由整数索引）在元素之间没有间隙 - 第一个和最后一个元素之间的每个元素都被定义并且具有一个值（可以是<span class="keyword">NULL</span> ）。
                     </p>
                     <div class="section">
                        <p>您可以使用<span class="keyword">FOR LOOP</span>语句遍历密集数组，如<a href="stored-subprograms-packages.html#GUID-E02BABFA-5547-4A52-BEA3-716D4E6D86AE__CIHFJFDG">例5-11所示</a> 。
                        </p>
                        <p>当插入<a href="stored-subprograms-packages.html#GUID-018BD661-D3E1-49D6-A46B-BC8006672B7F__CIHJHGAI">示例5-10</a>的可执行部分时，在填充employees_jobs数组的代码之后， <a href="stored-subprograms-packages.html#GUID-E02BABFA-5547-4A52-BEA3-716D4E6D86AE__CIHFJFDG">示例5-11中</a>的<span class="keyword">FOR LOOP</span>语句按照存储它们的顺序打印employees_jobs数组的元素。它们的存储顺序由employees_jobs_cursor声明中的<span class="keyword">ORDER BY</span>子句确定，该子句用于声明employees_jobs（参见<a href="stored-subprograms-packages.html#GUID-43060654-B9CC-45E3-B7F3-0233753279A1__BABCJGAD">例5-9</a> ）。
                        </p>
                        <p><span class="keyword">FOR LOOP</span>语句的上限，employees_jobs。<span class="keyword">COUNT</span> ，调用一个返回数组中元素数的集合方法。有关<span class="keyword">COUNT的</span>更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS99967" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-E02BABFA-5547-4A52-BEA3-716D4E6D86AE__CIHFJFDG">
                        <p class="titleinexample">例5-11遍历密集关联数组</p><pre class="oac_no_warn" dir="ltr">- 填充employees_jobs的代码必须在此代码之前：FOR i IN 1 .. <span class="bold">employees_jobs。COUNT</span> LOOP DBMS_OUTPUT.PUT_LINE（RPAD（employees_jobs（i）.first_name，23）|| RPAD（employees_jobs（i）.last_name，28）|| employees_jobs（i）.job_id）;结束循环;</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">William Gietz AC_ACCOUNT Shelley Higgins AC_MGR Jennifer Whalen AD_ASST Steven King AD_PRES Lex De Haan AD_VP Neena Kochhar AD_VP John Chen FI_ACCOUNT ...Jose Manuel Urman FI_ACCOUNT Nancy Greenberg FI_MGR Susan Mavris HR_REP David Austin IT_PROG ......Valli Pataballa IT_PROG Michael Hartstein MK_MAN Pat Fay MK_REP Hermann Baer PR_REP Shelli Baida PU_CLERK ......Sigal Tobias PU_CLERK Den Raphaely PU_MAN Gerald Cambrault SA_MAN ......Eleni Zlotkey SA_MAN Ellen Abel SA_REP ......Clara Vishney SA_REP Sarah Bell SH_CLERK ......Peter Vargas ST_CLERK Adam Fripp ST_MAN ......Matthew Weiss ST_MAN</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E" title="关联数组是一种集合。">使用关联数组</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG246"></a><a id="TDDDG99948"></a><div class="props_rev_3"><a id="GUID-0139973B-C839-4049-82C1-5AC0D7D69778" name="GUID-0139973B-C839-4049-82C1-5AC0D7D69778"></a><h4 id="TDDDG-GUID-0139973B-C839-4049-82C1-5AC0D7D69778" class="sect4"><span class="enumeration_section">5.10.6</span>遍历稀疏关联数组</h4>
                  <div>
                     <p><strong class="term">稀疏关联数组</strong> （由字符串索引）可能在元素之间存在间隙。
                     </p>
                     <div class="section">
                        <p>您可以使用<span class="keyword">WHILE LOOP</span>语句遍历它，如<a href="stored-subprograms-packages.html#GUID-0139973B-C839-4049-82C1-5AC0D7D69778__CIHFADJH">例5-12所示</a> 。
                        </p>
                        <p>要运行<a href="stored-subprograms-packages.html#GUID-0139973B-C839-4049-82C1-5AC0D7D69778__CIHFADJH">示例5-12中</a>的代码，该代码将打印job_titles数组的元素：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>在<a href="stored-subprograms-packages.html#GUID-43060654-B9CC-45E3-B7F3-0233753279A1__BABCJGAD">例5-9</a>的声明部分的末尾，插入此变量声明：</span><div><pre class="oac_no_warn" dir="ltr">我jobs.job_id％TYPE;</pre></div>
                        </li>
                        <li class="stepexpand"><span>在<a href="stored-subprograms-packages.html#GUID-018BD661-D3E1-49D6-A46B-BC8006672B7F__CIHJHGAI">示例5-10</a>的可执行部分中，在填充job_titles数组的代码之后，插入<a href="stored-subprograms-packages.html#GUID-0139973B-C839-4049-82C1-5AC0D7D69778__CIHFADJH">示例5-12中</a>的代码。</span></li>
                     </ol>
                     <div class="example" id="GUID-0139973B-C839-4049-82C1-5AC0D7D69778__CIHFADJH">
                        <p class="titleinexample">示例5-12遍历稀疏关联数组</p><pre class="oac_no_warn" dir="ltr">/ *在声明部分声明此变量：i jobs.job_id％TYPE;在填充job_titles的代码之后，将此代码添加到可执行部分：* / i：= <span class="bold">job_titles。第一</span> ;虽然我不是空的LOOP DBMS_OUTPUT.PUT_LINE（RPAD（i，12）|| job_titles（i））;我：= <span class="bold">job_titles。下一个（i）</span> ;结束循环;</pre><p>结果：</p><pre class="oac_no_warn" dir="ltr">AC_ACCOUNT公共会计师AC_MGR会计经理AD_ASST管理助理AD_PRES总裁AD_VP管理副总裁FI_ACCOUNT会计师FI_MGR财务经理HR_REP人力资源代表IT_PROG程序员MK_MAN营销经理MK_REP营销代表PR_REP公共关系代表PU_CLERK采购文员PU_MAN采购经理SA_MAN销售经理SA_REP销售代表SH_CLERK Shipping职员ST_CLERK股票职员ST_MAN股票经理</pre><p><a href="stored-subprograms-packages.html#GUID-0139973B-C839-4049-82C1-5AC0D7D69778__CIHFADJH">示例5-12</a>包括两个集合方法调用job_titles。<span class="keyword">FIRST</span>和job_titles。<span class="keyword">下一个（i）</span> 。职称。<span class="keyword">FIRST</span>返回job_titles和job_titles的第一个元素。<span class="keyword">NEXT（i）</span>返回成功<code class="codeph">i</code>的下标。有关<span class="keyword">FIRST的</span>更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS99965" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。有关<span class="keyword">NEXT的</span>更多信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS99964" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                        </p>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-6200D2F0-1A2E-46BB-AE2E-C72E4FE82C2E" title="关联数组是一种集合。">使用关联数组</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="TDDDG46000"></a><div class="props_rev_4"><a id="GUID-7D9BAC1B-A6AA-428E-8C08-73DB9D7911D5" name="GUID-7D9BAC1B-A6AA-428E-8C08-73DB9D7911D5"></a><h3 id="TDDDG-GUID-7D9BAC1B-A6AA-428E-8C08-73DB9D7911D5" class="sect3"><span class="enumeration_section">5.11</span>处理异常（运行时错误）</h3>
               <div>
                  <p>您可以使用PL / SQL代码处理运行时发生的异常。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-46958EB5-3629-4E28-A922-9899D73F93FB">关于异常和异常处理程序</a><br>当PL / SQL代码中发生运行时错误时，会引发<strong class="term">异常</strong> 。如果引发异常的子程序（或块）具有异常处理部分，则控制转移到它;否则，执行停止。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-AD2E9A8A-AF04-433B-A974-D17262871652">何时使用异常处理程序</a><br>Oracle建议仅在这些情况下使用异常处理程序。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-A3B25A8E-746A-4E6D-9635-5758BD5459CB">处理预定义的异常</a><br>您可以处理预定义的异常。
                     </li>
                     <li class="ulchildlink"><a href="stored-subprograms-packages.html#GUID-F13424DB-ED01-4C48-AAC4-D8889963D578">声明和处理用户定义的异常</a><br>您可以声明和处理用户定义的异常。
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-7D9BAC1B-A6AA-428E-8C08-73DB9D7911D5__GUID-FDDDA4E4-6BA2-48B1-A7A4-185DCB0C48E6">
                     <p class="notep1">也可以看看：</p>
                     <p>有关处理PL / SQL错误的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS007" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-1BF71E98-6A2D-4BC2-B780-7E7C2CBF080F" title="存储的子程序和包可以用作许多不同数据库应用程序的构建块。">开发存储的子程序和包</a></p>
                     </div>
                  </div>
               </div>
               <a id="TDDDG99947"></a><div class="props_rev_3"><a id="GUID-46958EB5-3629-4E28-A922-9899D73F93FB" name="GUID-46958EB5-3629-4E28-A922-9899D73F93FB"></a><h4 id="TDDDG-GUID-46958EB5-3629-4E28-A922-9899D73F93FB" class="sect4"><span class="enumeration_section">5.11.1</span>关于异常和异常处理程序</h4>
                  <div>
                     <p>当PL / SQL代码中发生运行时错误时，会引发<strong class="term">异常</strong> 。如果引发异常的子程序（或块）具有异常处理部分，则控制转移到它;否则，执行停止。
                     </p>
                     <p>运行时错误可能由设计错误，编码错误，硬件故障和许多其他来源引起。</p>
                     <p>Oracle数据库有许多<strong class="term">预定义的异常</strong> ，当程序违反数据库规则或超出系统相关限制时，它会自动引发。例如，如果<span class="keyword">SELECT INTO</span>语句未返回任何行，则Oracle Database会引发预定义的异常<span class="keyword">NO_DATA_FOUND</span> 。有关预定义PL / SQL异常的摘要，请参见<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00703" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                     </p>
                     <p>PL / SQL允许您定义（声明）自己的异常。异常声明具有以下语法：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">exception_name</span> EXCEPTION;</pre><p>与预定义的异常不同，必须使用<span class="keyword">RAISE</span>语句或DBMS_STANDARD.RAISE_APPLICATION_ERROR显式引发<strong class="term">用户定义的异常</strong> 。程序。例如：</p><pre class="oac_no_warn" dir="ltr">IF <span class="italic">条件</span> THEN RAISE <span class="italic">exception_name</span> ;</pre><p>有关DBMS_STANDARD.RAISE_APPLICATION_ERROR过程的信息，请参阅<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS99960" target="_blank"><span class="italic">Oracle Database PL / SQL语言参考</span></a> 。
                     </p>
                     <p>子程序的异常处理部分包含一个或多个异常处理程序。<strong class="term">异常处理程序</strong>具有以下语法：</p><pre class="oac_no_warn" dir="ltr">WHEN { <span class="italic">exception_name</span> [OR <span class="italic">exception_name</span> ] ...|其他}那么<span class="italic">声明</span> ; [ <span class="italic">声明</span> ; ] ...
</pre><p>（ <span class="q">“ <a href="stored-subprograms-packages.html#GUID-8C076E20-30D0-4E91-8485-246B02FA5BB8">关于子程序结构</a> ”</span>显示放置<span class="q"><a href="stored-subprograms-packages.html#GUID-8C076E20-30D0-4E91-8485-246B02FA5BB8">子程序</a></span>的异常处理部分的位置。）
                     </p>
                     <p><span class="keyword">WHEN OTHERS</span>异常处理程序处理意外的运行时错误。如果使用，它必须是最后的。例如：</p><pre class="oac_no_warn" dir="ltr">异常，当<span class="italic">exception_1</span> THEN <span class="italic">语句</span> ; [ <span class="italic">声明</span> ; ] ...当<span class="italic">exception_2</span>或<span class="italic">exception_3</span> THEN <span class="italic">语句时</span> ; [ <span class="italic">声明</span> ; ] ...什么时候其他<span class="italic">声明</span> ; [ <span class="italic">声明</span> ; ] ...提高; - 重新加注异常（非常重要）。结束;</pre><p><span class="keyword">WHEN OTHERS</span>异常处理程序的替代方法是<span class="keyword">EXCEPTION_INIT</span> pragma，它将用户定义的异常名称与Oracle Database错误号相关联。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-46958EB5-3629-4E28-A922-9899D73F93FB__GUID-424BCDB8-89AD-497C-A347-F771AD18FB6F">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关异常声明语法的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01387" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关异常处理程序语法的详细信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01316" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                           <li>
                              <p>有关<span class="keyword">EXCEPTION_INIT</span> pragma的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS01315" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-7D9BAC1B-A6AA-428E-8C08-73DB9D7911D5" title="您可以使用PL / SQL代码处理运行时发生的异常。">处理异常（运行时错误）</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG142"></a><div class="props_rev_3"><a id="GUID-AD2E9A8A-AF04-433B-A974-D17262871652" name="GUID-AD2E9A8A-AF04-433B-A974-D17262871652"></a><h4 id="TDDDG-GUID-AD2E9A8A-AF04-433B-A974-D17262871652" class="sect4"><span class="enumeration_section">5.11.2</span>何时使用异常处理程序</h4>
                  <div>
                     <p>Oracle建议仅在这些情况下使用异常处理程序。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您期望一个例外，并希望处理它。</p>
                           <p>例如，您希望最终<span class="keyword">SELECT INTO</span>语句不返回任何行，从而导致Oracle数据库引发预定义的异常<span class="keyword">NO_DATA_FOUND</span> 。您希望子程序或块处理该异常（这不是错误）然后继续，如<a href="stored-subprograms-packages.html#GUID-A3B25A8E-746A-4E6D-9635-5758BD5459CB__BABDJCJC">例5-13所示</a> 。
                           </p>
                        </li>
                        <li>
                           <p>您必须放弃或关闭资源。</p>
                           <p>例如：</p><pre class="oac_no_warn" dir="ltr">...file：= UTL_FILE.OPEN ...BEGIN <span class="italic">语句</span> <span class="italic">声明</span> ] ...  - 如果此代码因任何原因失败，则除了UTL_FILE.FCLOSE（文件）之外的异常; - 然后你想要关闭文件。提高; - 重新加注异常（非常重要）。结束; UTL_FILE.FCLOSE（文件）; ...
</pre></li>
                        <li>
                           <p>在代码的顶层，您要记录错误。</p>
                           <p>例如，客户端进程可能会发出此块：</p><pre class="oac_no_warn" dir="ltr">BEGIN proc（...）;其他东西，例如log_error_using_autonomous_transaction（...）;提高; - 重新加注异常（非常重要）。结束; /</pre><p>或者，客户端调用的独立子程序可以包含相同的异常处理逻辑 - 但仅限于顶级。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-7D9BAC1B-A6AA-428E-8C08-73DB9D7911D5" title="您可以使用PL / SQL代码处理运行时发生的异常。">处理异常（运行时错误）</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG247"></a><a id="TDDDG99940"></a><div class="props_rev_3"><a id="GUID-A3B25A8E-746A-4E6D-9635-5758BD5459CB" name="GUID-A3B25A8E-746A-4E6D-9635-5758BD5459CB"></a><h4 id="TDDDG-GUID-A3B25A8E-746A-4E6D-9635-5758BD5459CB" class="sect4"><span class="enumeration_section">5.11.3</span>处理预定义的异常</h4>
                  <div>
                     <p>您可以处理预定义的异常。</p>
                     <div class="section">
                        <p><a href="stored-subprograms-packages.html#GUID-A3B25A8E-746A-4E6D-9635-5758BD5459CB__BABDJCJC">示例5-13</a>以粗体显示如何更改EMP_EVAL.EVAL_DEPARTMENT过程以处理预定义的异常<span class="keyword">NO_DATA_FOUND</span> 。进行此更改并编译已更改的过程。（有关如何更改包体的示例，请参阅<span class="q">“ <a href="stored-subprograms-packages.html#GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413" title="本教程介绍如何使用SQL Developer工具Edit在EMP_EVAL.CALCULATE_SCORE函数中声明变量和常量。（本教程也是更改包体的示例。）">教程：在子程序中声明变量和常量</a> ”</span> 。）
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-A3B25A8E-746A-4E6D-9635-5758BD5459CB__BABDJCJC">
                        <p class="titleinexample">示例5-13处理预定义的异常NO_DATA_FOUND</p><pre class="oac_no_warn" dir="ltr">PROCEDURE eval_department（dept_id IN employees.department_id％TYPE）AS emp_cursor emp_refcursor_type; current_dept departments.department_id％TYPE; BEGIN current_dept：= dept_id; FOR loop_c IN 1..3 LOOP OPEN emp_cursor FOR SELECT * FROM employees WHERE current_dept = eval_department.dept_id; DBMS_OUTPUT.PUT_LINE（'确定部门＃'|| current_dept中的必要评估）; eval_loop_control（emp_cursor）; DBMS_OUTPUT.PUT_LINE（'Processed'|| emp_cursor％ROWCOUNT ||'记录。“）;关闭emp_cursor; current_dept：= current_dept + 10;结束循环; <span class="bold">NO_DATA_FOUND之后的</span> <span class="bold">异常</span> <span class="bold">DBMS_OUTPUT.PUT_LINE（'查询未返回结果集'）;</span> END eval_department;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-A3B25A8E-746A-4E6D-9635-5758BD5459CB__GUID-3035DDCB-EA2B-4612-8654-0AEED50B83A6">
                        <p class="notep1">也可以看看：</p>
                        <p>有关预定义异常的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00703" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-7D9BAC1B-A6AA-428E-8C08-73DB9D7911D5" title="您可以使用PL / SQL代码处理运行时发生的异常。">处理异常（运行时错误）</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="TDDDG248"></a><a id="TDDDG46200"></a><div class="props_rev_3"><a id="GUID-F13424DB-ED01-4C48-AAC4-D8889963D578" name="GUID-F13424DB-ED01-4C48-AAC4-D8889963D578"></a><h4 id="TDDDG-GUID-F13424DB-ED01-4C48-AAC4-D8889963D578" class="sect4"><span class="enumeration_section">5.11.4</span>声明和处理用户定义的异常</h4>
                  <div>
                     <p>您可以声明和处理用户定义的异常。</p>
                     <div class="section">
                        <p><a href="stored-subprograms-packages.html#GUID-F13424DB-ED01-4C48-AAC4-D8889963D578__BABDJFFF">例5-14</a>以粗体显示了如何更改EMP_EVAL.CALCULATE_SCORE函数以声明和处理两个用户定义的异常，wrong_weight和wrong_score。进行此更改并编译已更改的函数。（有关如何更改包体的示例，请参阅<span class="q">“ <a href="stored-subprograms-packages.html#GUID-92B10EDA-E0B1-42AF-9289-24E87EE65413" title="本教程介绍如何使用SQL Developer工具Edit在EMP_EVAL.CALCULATE_SCORE函数中声明变量和常量。（本教程也是更改包体的示例。）">教程：在子程序中声明变量和常量</a> ”</span> 。）
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-F13424DB-ED01-4C48-AAC4-D8889963D578__BABDJFFF">
                        <p class="titleinexample">示例5-14处理用户定义的异常</p><pre class="oac_no_warn" dir="ltr">FUNCTION calculate_score（evaluation_id IN scores.evaluation_id％TYPE，performance_id IN scores.performance_id％TYPE）RETURN NUMBER AS <span class="bold">weight_wrong EXCEPTION;</span> <span class="bold">score_wrong EXCEPTION;</span> n_score scores.score％TYPE; n_weight performance_parts.weight％TYPE; running_total NUMBER：= 0; max_score CONSTANT scores.score％TYPE：= 9; max_weight CONSTANT performance_parts.weight％TYPE：= 1; BEGIN SELECT s.score INTO n_score FROM SCORES s WHERE evaluation_id = s.evaluation_id AND performance_id = s.performance_id; SELECT p.weight INTO n_weight FROM PERFORMANCE_PARTS p WHERE performance_id = p.performance_id; <span class="bold">BEGIN</span> <span class="bold">IF（n_weight&gt; max_weight）或（n_weight &lt;0）THEN</span> <span class="bold">上升weight_wrong;</span> <span class="bold">万一;</span> <span class="bold">结束;</span> <span class="bold">BEGIN</span> <span class="bold">IF（n_score&gt; max_score）或（n_score &lt;0）THEN</span> <span class="bold">RAISE score_wrong;</span> <span class="bold">万一;</span> <span class="bold">结束;</span> running_total：= n_score * n_weight; RETURN running_total; <span class="bold">异常，</span> <span class="bold">当weight_wrong THEN</span> <span class="bold"><span class="bold">DBMS_OUTPUT.PUT_LINE（“</span>的得分的权重必须在0和之间” || max_weight）;</span> <span class="bold">返回-1;</span> <span class="bold">当得分_Wrong那么</span> <span class="bold">DBMS_OUTPUT.PUT_LINE（</span> <span class="bold">'得分必须介于0和'|| max_score之间）;</span> <span class="bold">返回-1;</span> END calculate_score;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-F13424DB-ED01-4C48-AAC4-D8889963D578__GUID-07A7E33B-D83E-4055-B474-9C0F36716F43">
                        <p class="notep1">也可以看看：</p>
                        <p>有关用户定义的异常的更多信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/tdddg&amp;id=LNPLS00704" target="_blank"><span class="italic">参见Oracle Database PL / SQL语言参考</span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="stored-subprograms-packages.html#GUID-7D9BAC1B-A6AA-428E-8C08-73DB9D7911D5" title="您可以使用PL / SQL代码处理运行时发生的异常。">处理异常（运行时错误）</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>