<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="SQL/JSON function json_query selects one or more values from JSON data and returns a string (VARCHAR2, CLOB, or BLOB instance) that represents the JSON values. You can thus use json_query to retrieve fragments of a JSON document."></meta>
      <meta name="description" content="SQL/JSON function json_query selects one or more values from JSON data and returns a string (VARCHAR2, CLOB, or BLOB instance) that represents the JSON values. You can thus use json_query to retrieve fragments of a JSON document."></meta>
      <title>SQL / JSON函数JSON_QUERY</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="JSON Developer&#39;s Guide"></meta>
      <meta property="og:description" content="SQL/JSON function json_query selects one or more values from JSON data and returns a string (VARCHAR2, CLOB, or BLOB instance) that represents the JSON values. You can thus use json_query to retrieve fragments of a JSON document."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="JSON Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="json-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-22T10:58:31-08:00"></meta>
      <meta name="dcterms.title" content="JSON Developer&#39;s Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2015, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96227-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="function-JSON_VALUE.html" title="Previous" type="text/html"></link>
      <link rel="next" href="function-JSON_TABLE.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="ADJSN"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="function-JSON_VALUE.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="function-JSON_TABLE.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JSON开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="query-json-data.html" property="item" typeof="WebPage"><span property="name">查询JSON数据</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">SQL / JSON函数JSON_QUERY</li>
            </ol>
            <a id="GUID-D64C7BE9-335D-449C-916D-1123539BF1FB" name="GUID-D64C7BE9-335D-449C-916D-1123539BF1FB"></a>
            
            <h2 id="ADJSN-GUID-D64C7BE9-335D-449C-916D-1123539BF1FB" class="sect2"><span class="enumeration_chapter">17</span> SQL / JSON函数JSON_QUERY</h2>
         </header>
         <div class="ind">
            <div>
               <p>SQL / JSON函数<code class="codeph">json_query</code>从JSON数据中选择一个或多个值，并返回表示JSON值的字符串（ <code class="codeph">VARCHAR2</code> ， <code class="codeph">CLOB</code>或<code class="codeph">BLOB</code>实例）。因此，您可以使用<code class="codeph">json_query</code>来检索JSON文档的<span class="italic">片段</span> 。
               </p>
               <div class="section">
                  <p><code class="codeph">json_query</code>的第一个参数是一个SQL表达式，它返回标量SQL数据类型的实例（即，不是对象或集合数据类型）。它可以是数据类型<code class="codeph">VARCHAR2</code> ， <code class="codeph">CLOB</code>或<code class="codeph">BLOB</code> 。它可以是表或视图列值，PL / SQL变量或具有适当强制转换的绑定变量。评估SQL表达式的结果用作评估路径表达式的<span class="italic">上下文项</span> 。
                  </p>
                  <p><code class="codeph">json_query</code>的第二个参数是SQL / JSON路径表达式，后跟可选子句<code class="codeph">RETURNING</code> ， <code class="codeph">WRAPPER</code> ， <code class="codeph">ON ERROR</code>和<code class="codeph">ON EMPTY</code> 。路径表达式可以定位任意数量的JSON值。
                  </p>
                  <p>在<code class="codeph">RETURNING</code>子句中，您可以指定数据类型<code class="codeph">VARCHAR2</code> ， <code class="codeph">CLOB</code>或<code class="codeph">BLOB</code> 。 <code class="codeph">BLOB</code>结果在AL32UTF8字符集中。（ <code class="codeph">VARCHAR2</code>是默认值。）返回的值始终包含格式良好的JSON数据。这包括确保字符串值中的非ASCII字符根据需要进行转义。例如，ASCII TAB字符（Unicode字符CHARACTER TABULATION，U + 0009）将转义为<code class="codeph">\t</code> 。关键字<code class="codeph">json_query</code>不需要（或不可用） <code class="codeph">FORMAT JSON</code> - 返回值隐含JSON格式。
                  </p>
                  <p>wrapper子句确定返回的字符串值的形式。</p>
                  <p><code class="codeph">json_query</code>的error子句可以指定<code class="codeph">EMPTY ON ERROR</code> ，这意味着在出错的情况下返回空数组（ <code class="codeph">[]</code> ）（不会引发错误）。
                  </p>
                  <p><a href="function-JSON_QUERY.html#GUID-D64C7BE9-335D-449C-916D-1123539BF1FB__CACEAIBD">例17-1</a>显示了SQL / JSON函数<code class="codeph">json_query</code>与数组包装器一起使用的示例。对于每个文档，它返回<code class="codeph">VARCHAR2</code>值，其内容表示具有电话类型元素的JSON数组，其格式未指定。对于<a href="creating-a-table-with-a-json-column.html#GUID-E6CC0DCF-3D72-41EF-ACA4-B3BF54EE3CA0__CACCIEFA">示例4-2中</a>的文档，电话类型为<code class="codeph">"Office"</code>和<code class="codeph">"Mobile"</code> ，返回的数组为<code class="codeph">["Mobile", "Office"]</code>或<code class="codeph">["Office", "Mobile"]</code> 。
                  </p>
                  <p>注意，如果路径表达式<code class="codeph">$.ShippingInstructions。在<a href="function-JSON_QUERY.html#GUID-D64C7BE9-335D-449C-916D-1123539BF1FB__CACEAIBD">例17-1</a>中使用了Phone.type</code> ，它会给出相同的结果。由于SQL / JSON路径表达式语法松弛， <code class="codeph">[*].type</code>等同于<code class="codeph">.type</code> 。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section"></div>
               <!-- class="section" -->
               <div class="section">
                  <div class="infoboxnotealso" id="GUID-D64C7BE9-335D-449C-916D-1123539BF1FB__GUID-68FFBD9F-46C0-470C-826A-C558FFC779BD">
                     <p class="notep1">也可以看看：</p>
                     <p>有关<code class="codeph">json_query</code>信息，请<code class="codeph">json_query</code> <a href="../sqlrf/JSON_QUERY.html#SQLRF56718" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a></p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-D64C7BE9-335D-449C-916D-1123539BF1FB__CACEAIBD">
                  <p class="titleinexample">示例17-1使用JSON_QUERY选择JSON值</p><pre class="pre codeblock"><code>SELECT json_query（po_document，'$。ShippingInstructions。电话[*]。输入'WITH WRAPPER）来自j_purchaseorder;</code></pre></div>
               <!-- class="example" -->
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="function-JSON_QUERY.html#GUID-555D8633-8AA9-4878-A72A-C665FA769D91">JSON_QUERY为JSON_TABLE</a><br>SQL / JSON函数<code class="codeph">json_query</code>可以视为函数<code class="codeph">json_table</code> 。
                  </li>
               </ul>
               <div class="relinfo">
                  <p><strong>相关话题</strong></p>
                  <ul>
                     <li><a href="json-path-expressions.html#GUID-951A61D5-EDC2-4E30-A20C-AE2AE7605C77" title="放宽基本的SQL / JSON路径表达式语法，以允许隐式数组包装和解包。这意味着，如果数据发展为使用此类值的数组替换JSON值，则无需更改代码中的路径表达式，反之亦然。提供了示例。">SQL / JSON路径表达式语法松弛</a></li>
                     <li><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-DE9F29D3-1C23-4271-9DCD-E585866576D2" title="SQL函数json_value，json_query，json_serialize和json_mergepatch接受一个可选的RETURNING子句，该子句指定函数返回的值的数据类型。此处描述了此子句和默认行为（无RETURNING子句）。">SQL查询函数的RETURNING子句</a></li>
                     <li><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-9079CD9C-3783-4857-9F6B-84D746C91317" title="SQL / JSON查询函数json_query和json_table接受一个可选的包装子句，它指定json_query返回的值的形式或用于json_table列中的数据。此处描述了此子句和默认行为（无包装子句）。提供了示例。">SQL / JSON查询函数的包装子句JSON_QUERY和JSON_TABLE</a></li>
                     <li><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-55344240-B1F0-490A-89BF-1526FA0546D4" title="某些SQL查询函数和条件接受可选的错误子句，该子句指定处理由函数或条件引发的运行时错误。此处总结了此子句和默认行为（无错误子句）。">SQL查询函数和条件的错误子句</a></li>
                     <li><a href="clauses-used-in-functions-and-conditions-for-json.html#GUID-3176ECEA-BBCE-4C7C-AB24-7FCE250B8443" title="SQL / JSON查询函数json_value，json_query和json_table接受可选的ON EMPTY子句，该子句指定在查询的数据中不存在目标JSON字段时要使用的处理。此处描述了此子句和默认行为（无ON EMPTY子句）。">SQL / JSON查询函数的空字段子句</a></li>
                  </ul>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="query-json-data.html#GUID-119E5069-77F2-45DC-B6F0-A1B312945590" title="您可以使用简单的点表示法查询JSON数据，或者，对于更多功能，使用SQL / JSON函数和条件。您可以创建和查询数据指南，该指南汇总了一组JSON文档的结构和类型信息。">查询JSON数据</a></p>
                  </div>
               </div>
            </div>
            <a id="ADXDB6385"></a><a id="ADXDB6384"></a><div class="props_rev_3"><a id="GUID-555D8633-8AA9-4878-A72A-C665FA769D91" name="GUID-555D8633-8AA9-4878-A72A-C665FA769D91"></a><h3 id="ADJSN-GUID-555D8633-8AA9-4878-A72A-C665FA769D91" class="sect3"><span class="enumeration_section">17.1</span> JSON_QUERY为JSON_TABLE</h3>
               <div>
                  <p>SQL / JSON函数<code class="codeph">json_query</code>可以视为函数<code class="codeph">json_table</code> 。
                  </p>
                  <p><a href="function-JSON_QUERY.html#GUID-555D8633-8AA9-4878-A72A-C665FA769D91__CACCFCEB">例17-2</a>说明了等价：两个<code class="codeph">SELECT</code>语句具有相同的效果。
                  </p>
                  <p>除了可能帮助您更好地理解<code class="codeph">json_query</code> ，这种等效性实际上很重要，因为它意味着您可以使用任一函数来获得相同的效果。
                  </p>
                  <p>特别是，如果您<code class="codeph">json_query</code>使用<code class="codeph">json_query</code> ，或者将它与<code class="codeph">json_exists</code>或<code class="codeph">json_value</code> （也可以使用<code class="codeph">json_table</code>表示）结合使用，要访问相同的数据，那么单次调用<code class="codeph">json_table</code>带来数据优势只解析一次。
                  </p>
                  <p>因此，优化器通常会自动将<code class="codeph">json_exists</code> ， <code class="codeph">json_value</code>和<code class="codeph">json_query</code> （任意组合）的多次调用重写为较少的<code class="codeph">json_table</code>调用。
                  </p>
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-555D8633-8AA9-4878-A72A-C665FA769D91__CACCFCEB">
                     <p class="titleinexample">示例17-2使用JSON_TABLE表示的JSON_QUERY</p><pre class="pre codeblock"><code>SELECT <span class="bold">json_query（</span> <span class="italic">柱</span> <span class="italic">，json_path</span> <span class="bold">RETURNING</span> <span class="italic">DATA_TYPE</span> <span class="italic">array_wrapper</span> <span class="italic">error_hander</span> <span class="bold">ON ERROR）FROM</span> <span class="italic">表</span> ; SELECT <span class="italic">jt.column_alias</span> FROM <span class="italic">table</span> ， <span class="bold">json_table</span> （ <span class="italic">column</span> ， <span class="bold">'$'</span> <span class="italic">error_handler</span> ON ERROR <span class="bold">COLUMNS</span> （“ <span class="italic">COLUMN_ALIAS</span> ” <span class="italic">data_type</span> <span class="bold">FORMAT JSON</span> <span class="italic">array_wrapper</span> <span class="bold">PATH</span> <span class="italic">json_path</span> ）） <span class="bold">AS</span> “ <span class="italic">JT</span> ”;</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="function-JSON_TABLE.html#GUID-5CDC25A8-A516-44B8-9C8F-0CE666933903" title="SQL / JSON函数json_table概括了SQL / JSON条件json_exists和SQL / JSON函数json_value和json_query。使用这些函数可以执行的所有操作都可以使用json_table执行。对于他们完成的工作，这些函数的语法比json_table的语法更容易使用。">JSON_TABLE概括了SQL / JSON查询函数和条件</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="function-JSON_QUERY.html#GUID-D64C7BE9-335D-449C-916D-1123539BF1FB" title="SQL / JSON函数json_query从JSON数据中选择一个或多个值，并返回表示JSON值的字符串（VARCHAR2，CLOB或BLOB实例）。因此，您可以使用json_query来检索JSON文档的片段。">SQL / JSON函数JSON_QUERY</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>