<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="After you have loaded spatial data , you should create a spatial index on it to enable efficient query performance using the data."></meta>
      <meta name="description" content="After you have loaded spatial data , you should create a spatial index on it to enable efficient query performance using the data."></meta>
      <title>索引和查询空间数据</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Developer&#39;s Guide "></meta>
      <meta property="og:description" content="After you have loaded spatial data , you should create a spatial index on it to enable efficient query performance using the data."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="spatial-and-graph-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-10T14:11:51-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E94799-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="loading-spatial-data.html" title="Previous" type="text/html"></link>
      <link rel="next" href="coordinate-systems-concepts.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Spatial and Graph Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="SPATL"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="loading-spatial-data.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="coordinate-systems-concepts.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="spatial-concepts-usage.html" property="item" typeof="WebPage"><span property="name">概念和使用信息</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">索引和查询空间数据</li>
            </ol>
            <a id="GUID-07129836-0DAE-4BCC-B290-942C456AE2EA" name="GUID-07129836-0DAE-4BCC-B290-942C456AE2EA"></a><a id="SPATL040"></a>
            
            <h2 id="SPATL-GUID-07129836-0DAE-4BCC-B290-942C456AE2EA" class="sect2"><span class="enumeration_chapter">5</span>索引和查询空间数据</h2>
         </header>
         <div class="ind">
            <div>
               <p>加载空间数据后，应在其上创建空间索引，以使用数据实现高效的查询性能。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1">创建空间索引</a><br>一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。
                  </li>
                  <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-34D74D79-6B6A-4827-B418-A05D3F41103D">查询空间数据</a><br>空间层的结构用于解析空间查询和空间连接。
                  </li>
               </ul>
               <div class="relinfo">
                  <p><strong>相关话题</strong></p>
                  <ul>
                     <li><a href="loading-spatial-data.html#GUID-69233A26-EE80-4AFC-82EF-803124DA7F97" title="描述如何将空间数据加载到数据库中，包括将数据存储在具有SDO_GEOMETRY类型列的表中。">加载空间数据</a></li>
                  </ul>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="spatial-concepts-usage.html#GUID-EEEED709-34A1-46EA-9AF3-869FD06E3076">概念和使用信息</a></p>
                  </div>
               </div>
            </div><a id="SPATL583"></a><div class="props_rev_3"><a id="GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" name="GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1"></a><h3 id="SPATL-GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" class="sect3"><span class="enumeration_section">5.1</span>创建空间索引</h3>
               <div>
                  <p>一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。</p>
                  <p><a id="d34665e133" class="indexterm-anchor"></a>例如，以下语句使用所有参数的默认值创建名为<code class="codeph">territory_idx</code>的空间索引：</p><pre class="oac_no_warn" dir="ltr">CREATE INDEX territory_idx ON地区（territory_geom）INDEXTYPE是MDSYS.SPATIAL_INDEX_V2;</pre><div class="infoboxnote" id="GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1__GUID-4C9EBA15-6FBD-4668-8CE2-45D282A9EBC8">
                     <p class="notep1">注意：</p>
                     <p>有关INDEXTYPE IS MDSYS.SPATIAL_INDEX_V2中“_V2”的说明，请参阅<a href="indexing-querying-spatial-data.html#GUID-6BBF58C4-10D0-4993-8DF2-60C3157412D7">使用系统管理的空间索引</a></p>
                  </div>
                  <p>有关创建空间索引的选项的详细信息，请参阅<a href="sql-indexing-spatial-data.html#GUID-BB6D7C9E-277B-4F49-BDD4-539CFE88D12C">CREATE INDEX</a>语句的文档。
                  </p>
                  <p>如果索引创建因任何原因未完成，则索引无效，必须使用<a href="sql-indexing-spatial-data.html#GUID-A661EFD5-59E6-4084-A511-B5141F9205A7">DROP INDEX</a> &lt;index_name&gt; [FORCE]语句删除。
                  </p>
                  <p>在要索引的每个几何列中，所有几何必须具有相同的SDO_SRID值。</p>
                  <p>空间索引可以建立在两维，三维或四维数据上。默认维数为2，但如果数据具有两个以上的维度，则可以使用<code class="codeph">sdo_indx_dims</code>参数关键字指定构建索引的维数。（有关支持三维几何的信息，请参阅<a href="spatial-concepts.html#GUID-6F3A9C6E-3617-47D9-AE61-CF9F1770555A" title="Oracle Spatial and Graph支持三维空间数据的存储和检索，包括点，点云（点集合），线，多边形，曲面和实体。">三维空间对象</a> 。有关对查询元素中各种维度组合的支持的说明，请参阅<a href="indexing-querying-spatial-data.html#GUID-DDD42A40-3EF8-473D-8D07-52A934A72D0C">数据和索引维度以及空间查询</a> 。）
                  </p>
                  <p>如果您<span class="italic">未</span>使用Oracle数据库的自动撤消管理功能或PGA内存管理功能，请参阅<a href="indexing-querying-spatial-data.html#GUID-41454B7A-666C-48BA-A44C-5E946943BC1A">回滚段和排序区域大小，</a>以获取有关您可能需要设置的初始化参数值的信息。默认情况下启用自动撤消管理和PGA内存管理，强烈建议使用它们。
                  </p>
                  <p>使用<a href="sql-indexing-spatial-data.html#GUID-BB6D7C9E-277B-4F49-BDD4-539CFE88D12C">CREATE INDEX</a>语句中的<code class="codeph">tablespace</code>关键字指定的<code class="codeph">tablespace</code> （如果未指定<code class="codeph">tablespace</code>关键字，则使用默认表<code class="codeph">tablespace</code> ）用于保存索引数据表和为内部计算创建的一些临时表。如果指定WORK_TABLESPACE作为表空间，则临时表将存储在工作表空间中。
                  </p>
                  <p>对于大型表（超过100万行），可能需要临时表空间来执行内部排序操作。此临时表空间的建议大小为100 * <span class="italic">n</span>字节，其中<span class="italic">n</span>是表中的行数，最大需要1 GB的临时表空间。
                  </p>
                  <p>要估计创建空间索引所需的空间，请使用<a href="SDO_TUNE-reference.html#GUID-BE58E3F8-63C2-4E81-A2B8-F17CDD381F1F">SDO_TUNE.ESTIMATE_RTREE_INDEX_SIZE</a>函数。
                  </p>
                  <p><a id="d34665e214" class="indexterm-anchor"></a>嵌套表不支持空间索引。
                  </p>
                  <p>本节还包含以下主题。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-6BBF58C4-10D0-4993-8DF2-60C3157412D7">使用系统管理的空间索引</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-0A054242-4FCC-4DBB-97FC-E375DE9773EE">将数据约束到几何类型</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-14E71BA4-7802-4AA2-A727-22B029906F50">在点上创建复合B树空间索引</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-8E6AE949-758B-4A5E-9453-CC3D00647497">创建交叉模式索引</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61">使用分区空间索引</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-54F618C8-EAAE-41F4-8C35-19373FF39F85">交换包含索引的分区</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-4206F617-284B-46CE-9327-7EEDA3B47044">空间索引和数据的导出和导入注意事项</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-AA03F9FB-7A46-4AF8-96CF-EC61270186F8">R-Tree空间索引支持的分布式和Oracle XA事务</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-F18EDF46-B0E2-437D-AB05-74941EC3608C">启用对空间索引统计的访问</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-41454B7A-666C-48BA-A44C-5E946943BC1A">回滚段和排序区域大小</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-07129836-0DAE-4BCC-B290-942C456AE2EA" title="加载空间数据后，应在其上创建空间索引，以使用数据实现高效的查询性能。">索引和查询空间数据</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="props_rev_3"><a id="GUID-6BBF58C4-10D0-4993-8DF2-60C3157412D7" name="GUID-6BBF58C4-10D0-4993-8DF2-60C3157412D7"></a><h4 id="SPATL-GUID-6BBF58C4-10D0-4993-8DF2-60C3157412D7" class="sect4"><span class="enumeration_section">5.1.1</span>使用系统管理的空间索引</h4>
                  <div>
                     <p>从版本12.2开始，可以通过在创建索引时指定INDEXTYPE = MDSYS.SPATIAL_INDEX <span class="bold">_V2</span>来对系统管理空间索引。强烈建议您将此索引类型用于您创建的所有新空间索引，无论空间表或空间索引是否已分区，如果您决定重新创建旧版空间索引，也可能需要使用它。
                     </p>
                     <p>主要好处是简化空间索引管理。这在分区的情况下是最有益的，因为这种新的索引类型消除了对大多数（如果不是全部）索引分区管理操作的需要。几乎所有Oracle数据库基表分区模型都提供完全支持，包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>单级分区：范围，哈希，列表</p>
                        </li>
                        <li>
                           <p>复合分区：范围范围，范围哈希，范围列表，列表范围，列表哈希，列表列表，哈希哈希，哈希列表，哈希范围</p>
                        </li>
                        <li>
                           <p>分区扩展：间隔（但不是基于间隔的复合分区），引用，基于虚拟列的分区</p>
                        </li>
                     </ul>
                     <p>旧的INDEXTYPE = MDSYS.SPATIAL_INDEX（没有“_V2”）仍然可以使用，它可以提供稍好的索引创建性能，尤其是对于小数据集而不涉及分区。如果您需要删除旧的空间索引，然后想要以与以前完全相同的形式重新创建它，您可能还想使用旧类型。但是，在所有或几乎所有情况下，您都需要在创建任何空间索引时指定INDEXTYPE = MDSYS.SPATIAL_INDEX_V2。</p>
                     <p>以下主题提供了使用INDEXTYPE = MDSYS.SPATIAL_INDEX_V2的示例。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-CF86A02C-67EB-4D67-A1BD-AA4A2F8BAE18">空间索引示例：间隔分区</a><br></li>
                        <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-D0EC4A9D-AD99-4AFD-ACB7-681950C51E15">空间索引示例：虚拟列分区</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" title="一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。">创建空间索引</a></p>
                        </div>
                     </div>
                  </div>
                  
                  <div class="props_rev_3"><a id="GUID-CF86A02C-67EB-4D67-A1BD-AA4A2F8BAE18" name="GUID-CF86A02C-67EB-4D67-A1BD-AA4A2F8BAE18"></a><h5 id="SPATL-GUID-CF86A02C-67EB-4D67-A1BD-AA4A2F8BAE18" class="sect5"><span class="enumeration_section">5.1.1.1</span>空间索引示例：间隔分区</h5>
                     <div>
                        <p>间隔分区是一种分区方法，当插入的值与任何现有分区范围不匹配时，Oracle数据库会自动创建基表分区。</p>
                        <p>以下限制适用：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>您只能指定一个基表分区键列，它必须是NUMBER或DATE类型。</p>
                           </li>
                           <li>
                              <p>索引组织表不支持间隔分区。</p>
                           </li>
                        </ul>
                        <p>请考虑以下名为DEST_TABLE的基表示例，该基表根据“当前上次查看”列的月份进行分区：</p><pre class="pre codeblock"><code>CREATE TABLE dest_table PARTITION BY RANGE（“CURR_LAST_SEEN_AT”）INTERVAL（NUMTOYMINTERVAL（1，'MONTH'））（PARTITION“YEAR_1999”值小于（TIMESTAMP'2000-01-01 00:00:00'），PARTITION“YEAR_2000”价值低于（TIMESTAMP'2001-01-01 00:00:00'））PARALLEL AS SELECT imo_num，last_seen_at curr_last_seen_at，a.geometry.sdo_point.x curr_longitude，a.geometry.sdo_point.y curr_latitude，LAG（last_seen_at）OVER （由imo_num ORDER BY last_seen_at分区）prev_last_seen_at，LEAD（last_seen_at）OVER（由imo_num分区ORDER BY last_seen_at）next_last_seen_at，LAG（a.geometry.sdo_point.x）OVER（由imo_num分区ORDER BY last_seen_at）prev_longitude，LAG（a。 geometry.sdo_point.y）OVER（由imo_num分区ORDER BY last_seen_at）prev_latitude，LEAD（a.geometry.sdo_point.x）OVER（由imo_num ORDER BY last_seen_at分区）next_longitude，LEAD（a.geometry.sdo_point.y）OVER（通过imo_num进行分区ORDER BY last_seen_at）next_latitude FROM source_table a;</code></pre><p>当数据从源表（source_table）中选择到此DEST_TABLE表中时，Oracle数据库会自动按CURR_LAST_SEEN_AT列的月份对数据进行分区。如果相应的分区不存在，Oracle数据库将自动创建一个新分区，而无需您执行任何操作。</p>
                        <p>前面的示例创建了两个显式分区。要查看我们的实际数据是什么样的，请使用查询，例如跟踪数据库字典以查看创建的分区：</p><pre class="pre codeblock"><code>SQL&gt; select user_name，high_value 2 from user_tab_partitions 3 where table_name ='DEST_TABLE'4 order by partition_name; PARTITION_NAME ------------------------------------------------- -  -  -  -  -  -  -  -  -  -  -  -  -  -  - - 高价值  -  -  -  -  -  -  -  -  - -------------------------------------------------- ------------ SYS_P2881 TIMESTAMP'2014-08-01 00：00：00'SYS_P2882 TIMESTAMP'2014-09-01 00：00：00'SYS_P2883 TIMESTAMP'2014-10-01 00： 00：00'SYS_P2884 TIMESTAMP'2014-11-01 00：00：00'YEAR_1999 TIMESTAMP'2000-01-01 00：00：00'YEAR_2000 TIMESTAMP'2001-01-01 00:00:00'选择了6行。
</code></pre><p>现在创建空间索引。以下示例使用基于函数的索引;该函数将基表标量经度和纬度列转换为虚拟空间几何，这将是索引“键值”：</p><pre class="pre codeblock"><code>创建或替换函数get_geometry（in_longitude NUMBER，in_latitude NUMBER）返回SDO_GEOMETRY DETERMINISTIC PARALLEL_ENABLE是BEGIN RETURN sdo_geometry（2001,4326，sdo_point_type（in_longitude，in_latitude，NULL），NULL，NULL）;结束; / INSERT INTO user_sdo_geom_metadata VALUES（'DEST_TABLE'，'SCOTT.GET_GEOMETRY（CURR_LONGITUDE，CURR_LATITUDE）'，SDO_DIM_ARRAY（SDO_DIM_ELEMENT（'经度'，' -  180'，'180'，'。05'），SDO_DIM_ELEMENT（'纬度'， '-90'，'90'，'。05'）），4326）;承诺; CREATE INDEX geom_idx1 ON dest_table（GET_GEOMETRY（CURR_LONGITUDE，CURR_LATITUDE））INDEXTYPE是MDSYS.SPATIAL_INDEX_V2 LOCAL PARALLEL;</code></pre><p>请注意，没有为空间索引指定分区信息。要查看自动创建的分区，请使用以下查询：</p><pre class="pre codeblock"><code>SQL&gt; select partition_name，high_value 2 from user_ind_partitions 3其中index_name ='PRECOMPUTE_GEOM_IDX1'4 order by partition_name; PARTITION_NAME ------------------------------------------------- -  -  -  -  -  -  -  -  -  -  -  -  -  -  - - 高价值  -  -  -  -  -  -  -  -  - -------------------------------------------------- ------------ SYS_P2921 TIMESTAMP'2014-08-01 00：00：00'SYS_P2922 TIMESTAMP'2014-09-01 00：00：00'SYS_P2923 TIMESTAMP'2014-10-01 00： 00：00'SYS_P2924 TIMESTAMP'2014-11-01 00：00：00'YEAR_1999 TIMESTAMP'2000-01-01 00：00：00'YEAR_2000 TIMESTAMP'2001-01-01 00:00:00'选择了6行。
</code></pre><p>请注意，索引分区的数量与为基表创建的数量相同，包括两个与CREATE TABLE语句中显式指定的分区同名的分区。但是，系统生成的索引分区名称与基表名称不同。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-6BBF58C4-10D0-4993-8DF2-60C3157412D7">使用系统管理的空间索引</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
                  <div class="props_rev_3"><a id="GUID-D0EC4A9D-AD99-4AFD-ACB7-681950C51E15" name="GUID-D0EC4A9D-AD99-4AFD-ACB7-681950C51E15"></a><h5 id="SPATL-GUID-D0EC4A9D-AD99-4AFD-ACB7-681950C51E15" class="sect5"><span class="enumeration_section">5.1.1.2</span>空间索引示例：虚拟列分区</h5>
                     <div>
                        <p>虚拟列是基于基表中的一个或多个现有列的表达式。虽然虚拟列仅存储为元数据并且不消耗物理空间，但它可以编制索引并包含优化程序统计信息和直方图。使用虚拟列上的分区键的表支持分区</p>
                        <p>如果未使用系统管理的空间索引，则要使用派生值对表进行分区，DBA必须创建并填充其他物理列才能获得相同的结果。然后，必须由应用程序或在插入之前计算表达式的触发器填充派生值。在任何一种情况下，在没有系统管理的索引的情况下实现此目标需要额外的开销并增加物理列的磁盘空间。</p>
                        <p>如果使用系统管理的索引，则将表达式用作分区键的能力提供了一种更有效的方法来满足全面的业务需求，而不会产生不必要的开销。当表不能被现有数据列分区时，这非常有用。</p>
                        <p>请考虑以下名为ACCOUNTS的基表示例，该基表包含名为REGION的虚拟列：</p><pre class="pre codeblock"><code>create table accounts_v（account_number varchar2（30），account_name varchar2（30），contact_person varchar2（30），region AS（substr（account_name，1,1）='N'时的情况，然后是substr时的'NORTH'（account_name，1， 1）='E'然后'EAST'当substr（account_name，1,1）='S'然后'SOUTH'当substr（account_name，1,1）='W'然后'WEST'结束时），形成mdsys。 sdo_geometry）按列表（区域）划分（分区pN值（'NORTH'），分区pE值（'EAST'），分区pS值（'SOUTH'），分区pW值（'WEST'））;</code></pre><p>现在，在SHAPE列上创建一个系统管理的本地域空间索引：</p><pre class="pre codeblock"><code>插入user_sdo_geom_metadata值（'ACCOUNTS_V'，'SHAPE'，mdsys.sdo_dim_array（mdsys.sdo_dim_element（'Longitude'，-180,180,0.05），mdsys.sdo_dim_element（'Latitude'， -  90,90,0.05）），空值）;承诺;在accounts_v（shape）上创建索引shape_v_idx indextype是mdsys.spatial_index_v2 LOCAL;</code></pre><p>请注意，未指定任何空间索引分区信息。但是，会自动创建一整套空间索引分区，而无需用户干预。</p>
                        <p>要验证相应分区中记录的位置，请查询特定分区。以下查询适用于东部地区的帐户（：</p><pre class="pre codeblock"><code>SQL&gt; select * from accounts_v partition（PE）2 order by account_number; ACCOUNT_NUMBER ACCOUNT_NAME ------------------------------ ------------------ ------------ CONTACT_PERSON REGIO ------------------------------ ----- SHAPE （SDO_GTYPE，SDO_SRID，SDO_POINT（X，Y，Z），SDO_ELEM_INFO，SDO_ORDINATES）-------------------------------- ------------------------------------------------ 8778- 5435-5345-5223 E-HORIZON-AUTOMOTIVE RICK EAST SDO_GEOMETRY（2001，NULL，SDO_POINT_TYPE（2,2，NULL），NULL，NULL）选择1行。
</code></pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-6BBF58C4-10D0-4993-8DF2-60C3157412D7">使用系统管理的空间索引</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="SPATL584"></a><div class="props_rev_3"><a id="GUID-0A054242-4FCC-4DBB-97FC-E375DE9773EE" name="GUID-0A054242-4FCC-4DBB-97FC-E375DE9773EE"></a><h4 id="SPATL-GUID-0A054242-4FCC-4DBB-97FC-E375DE9773EE" class="sect4"><span class="enumeration_section">5.1.2将</span>数据约束到几何类型</h4>
                  <div>
                     <p>创建或重建空间索引时，可以确保表中或稍后插入的所有几何都具有指定的几何类型。为了约束这样的数据几何类型，使用<code class="codeph">layer_gtype</code>关键字的参数子句<a href="sql-indexing-spatial-data.html#GUID-BB6D7C9E-277B-4F49-BDD4-539CFE88D12C">CREATE INDEX</a>或<a href="sql-indexing-spatial-data.html#GUID-9DBFA670-1F9D-49CB-8D68-66F1C31C1677">ALTER INDEX REBUILD</a>语句，并指定由所描述的有效SDO_GTYPE值表的几何类型列中的值<a href="spatial-datatypes-metadata.html#GUID-4D84CE67-67E4-4A84-8255-C586E765A94B">SDO_GTYPE</a> 。例如，要将图层中的空间数据约束为多边形：</p><pre class="oac_no_warn" dir="ltr">CREATE INDEX cola_spatial_idx ON cola_markets（shape）INDEXTYPE是MDSYS.SPATIAL_INDEX_V2 PARAMETERS（'layer_gtype = POLYGON'）;</pre><p>检查数据时， <a href="spatial-datatypes-metadata.html#GUID-4D84CE67-67E4-4A84-8255-C586E765A94B">SDO_GTYPE</a>中的几何类型被视为层次结构：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="italic">MULTI</span>表格也包括常规表格。例如，指定<code class="codeph">'layer_gtype=</code> <code class="codeph">MULTIPOINT'</code>允许图层包含POINT和MULTIPOINT几何。
                           </p>
                        </li>
                        <li>
                           <p>COLLECTION允许图层包含所有类型的几何图形。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" title="一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。">创建空间索引</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-14E71BA4-7802-4AA2-A727-22B029906F50" name="GUID-14E71BA4-7802-4AA2-A727-22B029906F50"></a><h4 id="SPATL-GUID-14E71BA4-7802-4AA2-A727-22B029906F50" class="sect4"><span class="enumeration_section">5.1.3</span>创建点的复合B树空间索引</h4>
                  <div>
                     <p>从版本12.2开始，您可以通过在<a href="sql-indexing-spatial-data.html#GUID-BB6D7C9E-277B-4F49-BDD4-539CFE88D12C">CREATE INDEX</a>语句的PARAMETERS子句中指定<code class="codeph">cbtree_index=true</code>和<code class="codeph">layer_gtype=POINT</code>关键字来创建点数据的复合B树索引。例如：</p><pre class="oac_no_warn" dir="ltr">PT_CB上的CREATE INDEX pt_idx（c2）indextype是mdsys.spatial_index_v2 PAREMETERS（'layer_gtype = POINT <span class="bold">cbtree_index = true</span> '）;</pre><p>前面的示例创建了一个复合B树空间索引，而不是R树空间索引。对点数据使用复合B树空间索引可以：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>提高空间索引创建的性能。</p>
                        </li>
                        <li>
                           <p>从许多Oracle会话执行并发DML时，提高DML性能。</p>
                        </li>
                     </ul>
                     <p>然而，虽然复合B树空间查询性能非常快，但是可以通过对该数据使用R树空间索引来获得最佳空间查询性能（尤其是将SPATIAL_VECTOR_ACCELERATION设置为推荐值<code class="codeph">TRUE</code> ）。
                     </p>
                     <p><code class="codeph">cbtree_index=true</code>关键字只能用于创建空间索引（CREATE INDEX语句）。它不能与ALTER INDEX或ALTER INDEX REBUILD一起使用。</p>
                     <p>使用复合B树空间索引时，不支持<a href="spatial-operators-reference.html#GUID-4D9DD9EF-DD9C-4198-A416-37B900B4E32F">SDO_JOIN</a>运算符</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" title="一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。">创建空间索引</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SPATL585"></a><div class="props_rev_3"><a id="GUID-8E6AE949-758B-4A5E-9453-CC3D00647497" name="GUID-8E6AE949-758B-4A5E-9453-CC3D00647497"></a><h4 id="SPATL-GUID-8E6AE949-758B-4A5E-9453-CC3D00647497" class="sect4"><span class="enumeration_section">5.1.4</span>创建交叉模式索引</h4>
                  <div>
                     <div class="section">
                        <p>您可以在不在架构中的表上创建空间索引。假设用户B想要在用户A的模式下在表T1中的列GEOMETRY上创建空间索引。跟着这些步骤：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>以特权用户身份（例如，作为SYSTEM）连接到数据库，并执行以下语句：</span><div><pre class="oac_no_warn" dir="ltr">GRANT创建表，创建序列到A; GRANT创建表，创建序列到B;</pre></div>
                        </li>
                        <li class="stepexpand"><span>以特权用户或用户A（或用户A连接）连接，并执行以下语句：</span><div><pre class="oac_no_warn" dir="ltr">GRANT选择，A.T1到B的索引;</pre></div>
                        </li>
                        <li class="stepexpand"><span>以用户B身份连接并执行如下语句：</span><div><pre class="oac_no_warn" dir="ltr">A.T1上的CREATE INDEX t1_spatial_idx（几何）INDEXTYPE IS mdsys.spatial_index_v2;</pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" title="一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。">创建空间索引</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SPATL1453"></a><a id="SPATL586"></a><div class="props_rev_3"><a id="GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61" name="GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61"></a><h4 id="SPATL-GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61" class="sect4"><span class="enumeration_section">5.1.5</span>使用分区空间索引</h4>
                  <div>
                     <p>您可以在分区表上创建分区空间索引。本节介绍Oracle Spatial和Graph特有的使用注意事项。有关分区表和分区索引的详细说明，请参见“ <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/spatl&amp;id=VLDBG002" target="_blank"><span class="italic">Oracle数据库VLDB和分区指南”</span></a> 。
                     </p>
                     <p>分区空间索引可以提供以下好处：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>减少长时间运行查询的响应时间，因为分区可减少磁盘I / O操作</p>
                        </li>
                        <li>
                           <p>减少并发查询的响应时间，因为I / O操作在每个分区上并发运行</p>
                        </li>
                        <li>
                           <p>由于分区级创建和重建操作，索引维护更容易</p>
                           <p>可以重建分区上的索引，而不会影响其他分区上的查询，并且可以独立于其他分区更改每个本地索引的存储参数。</p>
                        </li>
                        <li>
                           <p>多分区搜索的并行查询</p>
                           <p>并行度是USER_INDEXES视图中索引行中DEGREE列的值（即，使用<a href="sql-indexing-spatial-data.html#GUID-BB6D7C9E-277B-4F49-BDD4-539CFE88D12C">CREATE INDEX</a> ， <a href="sql-indexing-spatial-data.html#GUID-D1F318B7-F224-4576-A59C-F42E14427B99">ALTER INDEX</a>或<a href="sql-indexing-spatial-data.html#GUID-9DBFA670-1F9D-49CB-8D68-66F1C31C1677">ALTER INDEX REBUILD</a>语句为PARALLEL关键字指定或默认值）。
                           </p>
                        </li>
                        <li>
                           <p>改进了多处理器系统环境中的查询处理</p>
                           <p>在多处理器系统环境中，如果在具有分区空间索引的表上调用空间运算符，并且如果查询中涉及多个分区，则可以使用多个处理器来评估查询。使用的处理器数量由并行度和评估查询时使用的分区数决定。</p>
                        </li>
                     </ul>
                     <p>以下限制适用于空间索引分区：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>空间表的分区键必须是标量值，并且不能是空间列。</p>
                        </li>
                        <li>
                           <p>基础表仅支持范围分区。分区空间索引当前不支持所有其他类型的分区。</p>
                        </li>
                     </ul>
                     <p>要创建分区空间索引，必须指定LOCAL关键字。（如果未指定LOCAL关键字，则会在所有表分区中的数据上创建非分区空间索引。）以下示例创建分区空间索引：</p><pre class="oac_no_warn" dir="ltr">CREATE INDEX counties_idx ON县（几何）INDEXTYPE是MDSYS.SPATIAL_INDEX_V2 LOCAL;</pre><p>在此示例中，默认值用于索引分区的数量和位置，即：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>索引分区基于底层表分区。对于每个表分区，将创建相应的索引分区。</p>
                        </li>
                        <li>
                           <p>每个索引分区都放在默认表空间中。</p>
                        </li>
                     </ul>
                     <p>如果确实为各个分区指定了参数，则以下注意事项适用：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>每个分区的存储特性对于每个分区可以相同或不同。如果它们不同，则可以启用并行I / O（如果表空间位于不同的磁盘上）并且可以提高性能。</p>
                        </li>
                        <li>
                           <p>所有分区的<code class="codeph">sdo_indx_dims</code>值必须相同。
                           </p>
                        </li>
                        <li>
                           <p>用于每个分区的<code class="codeph">layer_gtype</code>参数值（请参阅<a href="indexing-querying-spatial-data.html#GUID-0A054242-4FCC-4DBB-97FC-E375DE9773EE">约束数据到几何类型</a> ）可能不同。
                           </p>
                        </li>
                     </ul>
                     <p>要覆盖默认分区值，请使用具有以下常规格式的CREATE INDEX语句：</p><pre class="oac_no_warn" dir="ltr">CREATE INDEX &lt;indexname&gt; ON &lt;table&gt;（&lt;column&gt;）INDEXTYPE IS MDSYS.SPATIAL_INDEX_V2 [PARAMETERS（'&lt;spatial-params&gt;，&lt;storage-params&gt;'）] LOCAL [（PARTITION &lt;index_partition&gt; PARAMETERS（'&lt;space- params&gt;，&lt;storage-params&gt;'）[，PARTITION &lt;index_partition&gt; PARAMETERS（'&lt;spatial-params&gt;，&lt;storage-params&gt;'）]）]</pre><p>查询可以对分区表进行操作，以仅对一个分区执行查询。例如：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM counties PARTITION（p1）WHERE ... &lt;some-spatial-predicate&gt;;</pre><p>查询所选分区可以加速查询，并且还可以在多个查询同时在不同分区上运行时提高整体吞吐量。</p>
                     <p>当查询使用分区空间索引时，空间运算符和函数的语义（含义或行为）与分区和非分区索引相同，除了<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">SDO_NN</a> （最近邻居）的情况。使用<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">SDO_NN</a> ，将为受查询影响的每个分区返回请求的几何数量。（有关详细信息，请参阅<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">Spatial Operators中</a> <a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">SDO_NN</a>运算符的说明。）
                     </p>
                     <p>例如，如果您请求5个最近的餐馆到一个点，并且空间索引有4个分区，则<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">SDO_NN</a>最多返回20（5 * 4）个几何。在这种情况下，您必须使用ROWNUM伪列（此处为<code class="codeph">WHERE ROWNUM &lt;=5</code> ）返回5个最近的餐厅，并使用ORDER BY子句按距离（英里）对结果进行排序。<a href="indexing-querying-spatial-data.html#GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61__BABEBDJH">例5-1</a>从分区空间索引返回5个最近的餐馆。
                     </p>
                     <div class="infoboxnotealso" id="GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61__GUID-E3894790-548F-4FAF-A864-2C3F46CC64E7">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="complex-spatial-queries.html#GUID-C4BE15BF-04AC-41EC-BEE1-F6DDA2A29E79">SDO_NN</a>有关使用<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">SDO_NN</a>运算符的更多示例的示例。
                        </p>
                     </div>
                     <p>对于表具有分区空间索引时的跨模式查询，必须为空间表和索引表（MDRT_ <span class="italic">xxx</span> ）授予用户对空间表上创建的空间索引的SELECT或READ权限。有关更多信息和示例，请参阅<a href="spatial-operators-reference.html#GUID-4D9DD9EF-DD9C-4198-A416-37B900B4E32F">SDO_JOIN</a>运算符的使用说明中的“ <a href="spatial-operators-reference.html#GUID-4D9DD9EF-DD9C-4198-A416-37B900B4E32F">SDO_JOIN的</a> <span class="q"><a href="spatial-operators-reference.html#GUID-4D9DD9EF-DD9C-4198-A416-37B900B4E32F__BABBFGFE">跨模式调用</a> ”</span> 。
                     </p>
                     <div class="example" id="GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61__BABEBDJH">
                        <p class="titleinexample">示例5-1带分区空间索引的SDO_NN查询</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM（SELECT r.name，r.location，SDO_NN_DISTANCE（1）distance_in_miles FROM restaurants_part_table r WHERE SDO_NN（r.location，MDSYS.SDO_GEOMETRY（2001,8307，MDSYS.SDO_POINT_TYPE（-110,35，Null），Null， Null），'SDO_NUM_RES = 5 distance = 2 unit = MILE'，1）='TRUE'ORDER <span class="bold">BY distance_in_miles</span> ） <span class="bold">WHERE ROWNUM &lt;= 5</span> ;</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-3009AE2A-2BB3-48D7-94D2-57D11BDE7496">创建本地分区空间索引</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" title="一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。">创建空间索引</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="SPATL587"></a><div class="props_rev_3"><a id="GUID-3009AE2A-2BB3-48D7-94D2-57D11BDE7496" name="GUID-3009AE2A-2BB3-48D7-94D2-57D11BDE7496"></a><h5 id="SPATL-GUID-3009AE2A-2BB3-48D7-94D2-57D11BDE7496" class="sect5"><span class="enumeration_section">5.1.5.1</span>创建本地分区空间索引</h5>
                     <div>
                        <div class="section">
                           <p>如果要创建本地分区空间索引，Oracle建议您使用本节中的过程而不是使用PARALLEL关键字，以避免在任何原因创建任何分区索引失败时重新启动（例如，因为表空间已满。跟着这些步骤：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>创建本地空间索引并指定UNUSABLE关键字。例如：</span><div><pre class="oac_no_warn" dir="ltr">CREATE INDEX sp_idx ON my_table（location）INDEXTYPE IS mdsys.spatial_index_v2 PARAMETERS（'tablespace = tb_name work_tablespace = work_tb_name'） <span class="bold">LOCAL UNUSABLE</span> ;</pre><p>此语句快速执行并创建与索引关联的元数据。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>使用ALTER INDEX REBUILD语句创建脚本，但没有PARALLEL关键字。例如，如果您有100个分区和10个处理器，请使用10个ALTER INDEX语句创建10个脚本，如下所示：</span><div><pre class="oac_no_warn" dir="ltr">ALTER INDEX sp_idx REBUILD PARTITION ip1; ALTER INDEX sp_idx REBUILD PARTITION ip2; 。 。 。ALTER INDEX sp_idx REBUILD PARTITION ip10;</pre></div>
                           </li>
                           <li class="stepexpand"><span>同时运行所有脚本，以便每个处理器处理单个分区的索引，但所有处理器都忙于处理它们自己的ALTER INDEX语句集。</span></li>
                        </ol>
                        <div class="section">
                           <p>如果任何ALTER INDEX语句失败，则无需重建已成功完成操作的任何分区。</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-DB52CEB5-4A4D-44E5-B6F6-F80E00A39E61">使用分区空间索引</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="SPATL588"></a><div class="props_rev_3"><a id="GUID-54F618C8-EAAE-41F4-8C35-19373FF39F85" name="GUID-54F618C8-EAAE-41F4-8C35-19373FF39F85"></a><h4 id="SPATL-GUID-54F618C8-EAAE-41F4-8C35-19373FF39F85" class="sect4"><span class="enumeration_section">5.1.6</span>交换包含索引的分区</h4>
                  <div>
                     <p>您可以将ALTER TABLE语句与EXCHANGE PARTITION一起使用...INCLUDING INDEXES子句用于将空间表分区及其索引分区与相应的表及其索引进行交换。有关交换分区的信息，请参阅“ <a href="../sqlrf/ALTER-TABLE.html#SQLRF01001" target="_blank"><span class="italic">Oracle数据库SQL语言参考”</span></a>中的ALTER TABLE语句的说明。
                     </p>
                     <p>此功能可以帮助您在许多情况下更有效地操作，例如：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>将数据引入分区表并避免重新创建索引的成本。</p>
                        </li>
                        <li>
                           <p>管理和创建分区索引。例如，数据可以分成多个表。可以一个接一个地构建每个表的索引，以最小化索引创建期间所需的内存和表空间资源。或者，可以在多个会话中并行创建索引。然后可以与原始数据表的分区交换表（以及索引）。</p>
                        </li>
                        <li>
                           <p>管理脱机插入操作。新数据可以存储在临时表中，并定期与新分区交换（例如，在包含历史数据的数据库中）。</p>
                        </li>
                     </ul>
                     <p>要交换包含空间数据和索引的索引的分区，两个空间索引（一个在分区上，另一个在表上）必须具有相同的维度（ <code class="codeph">sdo_indx_dims</code>值）。如果索引不具有相同的维度，则会引发错误。交换表数据，但不交换索引并将索引标记为失败。要使用索引，必须重建它们</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" title="一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。">创建空间索引</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SPATL589"></a><div class="props_rev_3"><a id="GUID-4206F617-284B-46CE-9327-7EEDA3B47044" name="GUID-4206F617-284B-46CE-9327-7EEDA3B47044"></a><h4 id="SPATL-GUID-4206F617-284B-46CE-9327-7EEDA3B47044" class="sect4"><span class="enumeration_section">5.1.7</span>空间索引和数据的导出和导入注意事项</h4>
                  <div>
                     <p>如果使用“导出”实用程序导出具有空间数据的表，则操作的行为取决于空间数据是否已进行空间索引：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果空间数据尚未进行空间索引，则会导出表数据。但是，必须使用目标系统上的相应信息更新USER_SDO_GEOM_METADATA视图。</p>
                        </li>
                        <li>
                           <p>如果空间数据已在空间索引，则导出表数据，将相应的信息插入目标系统上的USER_SDO_GEOM_METADATA视图，并在目标系统上构建空间索引。但是，如果插入USER_SDO_GEOM_METADATA视图失败（例如，如果空间层已存在USER_SDO_GEOM_METADATA条目），则不会构建空间索引。</p>
                        </li>
                     </ul>
                     <p>如果使用“导入”实用程序导入已进行空间索引的数据，则以下注意事项适用：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果导出数据的索引是使用<code class="codeph">TABLESPACE</code>子句创建的，并且如果导入时数据库中不存在指定的表空间，则不会构建索引。（这与其他Oracle索引的行为不同，如果在导入时为原始索引指定的表空间不存在，则在用户的默认表空间中创建索引。）
                           </p>
                        </li>
                        <li>
                           <p>如果导入操作必须由特权数据库用户完成，并且使用<code class="codeph">FROMUSER</code>和<code class="codeph">TOUSER</code>格式，则必须在导入操作之前授予<code class="codeph">TOUSER</code>用户CREATE TABLE和CREATE SEQUENCE权限，如以下示例所示（并输入提示时SYSTEM帐户的密码）：</p><pre class="oac_no_warn" dir="ltr">sqlplus system SQL&gt; grant CREATE TABLE，CREATE SEQUENCE to CHRIS; SQL&gt;退出; imp system file = spatl_data.dmp fromuser = SCOTT touser = CHRIS</pre></li>
                     </ul>
                     <p>有关使用导出和导入实用程序的信息，请参阅<a href="../sutil/oracle-data-pump-overview.html#SUTIL100" target="_blank"><span class="italic">Oracle数据库实用程序</span></a> 。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" title="一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。">创建空间索引</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SPATL590"></a><div class="props_rev_3"><a id="GUID-AA03F9FB-7A46-4AF8-96CF-EC61270186F8" name="GUID-AA03F9FB-7A46-4AF8-96CF-EC61270186F8"></a><h4 id="SPATL-GUID-AA03F9FB-7A46-4AF8-96CF-EC61270186F8" class="sect4"><span class="enumeration_section">5.1.8</span> R-Tree空间索引支持的分布式和Oracle XA事务</h4>
                  <div>
                     <p>分布式和Oracle XA事务支持使用R树空间索引。</p>
                     <p>但是，在可序列化的分布式事务中不允许进行空间DML操作。</p>
                     <p>有关分布式事务的更多信息，请参见“ <a href="../admin/distributed-transactions-concepts.html#ADMIN031" target="_blank"><span class="italic">Oracle数据库管理员指南”</span></a> 。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" title="一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。">创建空间索引</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SPATL1520"></a><div class="props_rev_3"><a id="GUID-F18EDF46-B0E2-437D-AB05-74941EC3608C" name="GUID-F18EDF46-B0E2-437D-AB05-74941EC3608C"></a><h4 id="SPATL-GUID-F18EDF46-B0E2-437D-AB05-74941EC3608C" class="sect4"><span class="enumeration_section">5.1.9</span>启用对空间索引统计的访问</h4>
                  <div>
                     <p>Oracle数据库优化器收集描述有关数据库及其对象的详细信息的统计信息。统计信息对于优化器为SQL语句选择最佳执行计划的能力至关重要。有关优化程序统计信息的详细信息，请参阅“ <a href="../tgsql/optimizer-statistics.html#TGSQL335" target="_blank"><span class="italic">Oracle数据库SQL调整指南”</span></a> 。
                     </p>
                     <p>为了能够使用<a href="../arpls/index.html" target="_blank"><code class="codeph">DBMS_STATS.GATHER_INDEX_STATS</code></a>和<a href="../arpls/index.html" target="_blank"><code class="codeph">DBMS_STATS.GATHER_SCHEMA_STATS</code></a>来收集与空间索引相关的索引统计信息，必须为将执行统计信息收集的所有数据库用户授予CREATE TABLE特权。
                     </p>
                     <p>在不同架构（用户）的空间域索引上运行ANALYZE INDEX时，执行ANALYZE操作的用户需要以下权限：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>创建任何TABLE以创建缺少的临时表</p>
                        </li>
                        <li>
                           <p>DROP ANY TABLE用于截断或删除现有临时表</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" title="一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。">创建空间索引</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SPATL591"></a><div class="props_rev_3"><a id="GUID-41454B7A-666C-48BA-A44C-5E946943BC1A" name="GUID-41454B7A-666C-48BA-A44C-5E946943BC1A"></a><h4 id="SPATL-GUID-41454B7A-666C-48BA-A44C-5E946943BC1A" class="sect4"><span class="enumeration_section">5.1.10</span>回滚段和排序区域大小</h4>
                  <div>
                     <p><span class="italic">仅</span>当您（或数据库管理员）未使用Oracle数据库的自动撤消管理功能或PGA内存管理功能或两者时，本节才适用。默认情况下启用自动内存管理和PGA内存管理，强烈建议使用它们。有关这些功能的说明，请参阅：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/spatl&amp;id=CNCPT305" target="_blank"><span class="italic">Oracle数据库概念中</span></a>自动撤消管理和还原段的部分</p>
                        </li>
                        <li>
                           <p>有关<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/spatl&amp;id=CNCPT803" target="_blank"><span class="italic">Oracle数据库概念中</span></a> PGA内存管理的部分</p>
                        </li>
                     </ul>
                     <p><a id="d34665e1693" class="indexterm-anchor"></a><a id="d34665e1697" class="indexterm-anchor"></a><a id="d34665e1703" class="indexterm-anchor"></a>如果您没有使用自动撤消管理，并且回滚段不够大，则尝试创建空间索引将失败。回滚段应为100 * <span class="italic">n</span>字节，其中<span class="italic">n</span>是要编制索引的数据行数。例如，如果表包含100万（1,000,000）行，则回滚段大小应为100,000,000（1亿）字节。
                     </p>
                     <p>要确保有足够的回滚段，或者您尝试创建空间索引并收到无法扩展回滚段的错误，请查看（或进行DBA审查）回滚段的大小和结构。创建适当大小的公共回滚段，并将该回滚段置于联机状态。此外，确保在大型空间索引操作期间将任何小的不适当的回滚段置于脱机状态。</p>
                     <p><a id="d34665e1717" class="indexterm-anchor"></a>如果未使用PGA内存管理功能，则数据库参数SORT_AREA_SIZE会影响创建索引所需的时间。SORT_AREA_SIZE值是用于排序操作的最大内存量（以字节为单位）。最佳值取决于数据库大小，但是一个好的准则是在创建空间索引时使其至少为100万字节。要更改SORT_AREA_SIZE值，请使用ALTER SESSION语句。例如，要将值更改为2000万字节：</p><pre class="oac_no_warn" dir="ltr">ALTER SESSION SET SORT_AREA_SIZE = 20000000;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-18BB2973-096E-4239-9A01-0C95E9AFEFA1" title="一旦通过批量或事务加载将数据加载到空间表中，就必须在表中的每个几何列上创建空间索引（即空间R树索引），以便有效地访问数据。">创建空间索引</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="SPATL592"></a><div class="props_rev_3"><a id="GUID-34D74D79-6B6A-4827-B418-A05D3F41103D" name="GUID-34D74D79-6B6A-4827-B418-A05D3F41103D"></a><h3 id="SPATL-GUID-34D74D79-6B6A-4827-B418-A05D3F41103D" class="sect3"><span class="enumeration_section">5.2</span>查询空间数据</h3>
               <div>
                  <p>空间层的结构用于解析空间查询和空间连接。</p>
                  <p>Spatial和Graph使用具有主要和辅助过滤器操作的双层查询模型来解析空间查询和空间连接，如<a href="spatial-concepts.html#GUID-79F09397-E9DA-4E91-B154-9ECB327A5809" title="Spatial和Graph使用双层查询模型来解析空间查询和空间连接。">查询模型中所述</a> 。术语<span class="italic">双层</span>表示执行两个不同的操作来解析查询。如果同时执行了两个操作，则返回确切的结果集。
                  </p>
                  <p><a id="d34665e1803" class="indexterm-anchor"></a><a id="d34665e1807" class="indexterm-anchor"></a>如果在该表上定义了空间索引，则无法将数据库链接（dblink）名称附加到查询中空间表的名称。
                  </p>
                  <p>本节还包含以下主题。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5">空间查询</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-C4C35CB5-0138-487B-9C50-B4BF1BDAFE08">空间连接</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-DDD42A40-3EF8-473D-8D07-52A934A72D0C">数据和索引维度以及空间查询</a><br></li>
                     <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-D5FC46C1-6A9F-40C5-90A9-449DD93EAF0A">使用事件54700要求空间查询的空间索引</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-07129836-0DAE-4BCC-B290-942C456AE2EA" title="加载空间数据后，应在其上创建空间索引，以使用数据实现高效的查询性能。">索引和查询空间数据</a></p>
                     </div>
                  </div>
               </div>
               <a id="SPATL594"></a><a id="SPATL595"></a><a id="SPATL593"></a><div class="props_rev_3"><a id="GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5" name="GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5"></a><h4 id="SPATL-GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5" class="sect4"><span class="enumeration_section">5.2.1</span>空间查询</h4>
                  <div>
                     <p>在空间R树索引中，每个几何体由其最小边界矩形（MBR）表示，如<a href="spatial-concepts.html#GUID-69A50E50-F713-4E3D-9182-AF3797250B97">R树索引中所述</a> 。考虑<a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5__BGBHEJGE">图5-1中</a>包含多个对象的以下层。每个对象都标有其几何名称（行字符串为geom_1，四边形多边形为geom_2，三角形多边形为geom_3，椭圆为geom_4），每个对象周围的MBR由虚线表示。
                     </p>
                     <div class="figure" id="GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5__BGBHEJGE">
                        <p class="titleinfigure">图5-1具有MBR的几何图形</p><img src="img/query_mbrs.gif" alt="下面是图5-1的描述" title="下面是图5-1的描述" longdesc="img_text/query_mbrs.html"><br><a href="img_text/query_mbrs.html">“图5-1带MBR的几何图形”的描述</a></div>
                     <!-- class="figure" -->
                     <p>典型的空间查询是请求位于a中的所有对象<a id="d34665e1922" class="indexterm-anchor"></a> <span class="bold">查询窗口</span> ，即定义的围栏或窗口。一个<a id="d34665e1927" class="indexterm-anchor"></a>动态查询窗口是指未在数据库中定义的矩形区域，但必须在使用之前定义。<a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5__BGBHIEJD">图5-2</a>显示了与<a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5__BGBHEJGE">图5-1中</a>相同的几何图形，但添加了一个由粗虚线框表示的查询窗口。
                     </p>
                     <div class="figure" id="GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5__BGBHIEJD">
                        <p class="titleinfigure">图5-2带有查询窗口的图层</p><img src="img/query_window.gif" alt="下面是图5-2的描述" title="下面是图5-2的描述" longdesc="img_text/query_window.html"><br><a href="img_text/query_window.html">“图5-2带有查询窗口的图层”的说明</a></div>
                     <!-- class="figure" -->
                     <p>在<a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5__BGBHIEJD">图5-2中</a> ，查询窗口涵盖了几何部分geom_1和geom_2的部分，以及geom_3的部分MBR，但没有实际的geom_3几何体。查询窗口不包含geom_4几何体的任何部分或其MBR。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07">主过滤器操作员</a><br></li>
                        <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-00000B2F-E63F-44DE-B969-BD5E6F8F5A5B">主要和次要过滤器操作员</a><br></li>
                        <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-3839BEE8-7743-46F4-B573-667ADC7FEB3E">内部操作员</a><br></li>
                        <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-850B0CE8-ED06-4B81-A3CE-39CE63DAFF25">最近邻运营商</a><br></li>
                        <li class="ulchildlink"><a href="indexing-querying-spatial-data.html#GUID-76F77285-DC7D-496C-8352-1A25202D47A7">空间功能</a><br></li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-34D74D79-6B6A-4827-B418-A05D3F41103D" title="空间层的结构用于解析空间查询和空间连接。">查询空间数据</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="SPATL597"></a><a id="SPATL598"></a><a id="SPATL599"></a><a id="SPATL596"></a><div class="props_rev_3"><a id="GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07" name="GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07"></a><h5 id="SPATL-GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07" class="sect5"><span class="enumeration_section">5.2.1.1</span>主过滤器操作员</h5>
                     <div>
                        <p><a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="This chapter describes the operators that you can use when working with the spatial object data type.">Spatial Operators中</a>描述的<a href="spatial-operators-reference.html#GUID-9AB42477-D0C0-4A87-826F-1BDDF1CA1FE5">SDO_FILTER</a>运算<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">符</a>实现了Oracle Spatial and Graph查询处理模型中涉及的两步过程的主过滤器部分。主过滤器使用索引数据来仅确定一组候选对象对是否可以交互。具体而言，主过滤器检查候选对象的MBR是否相互作用，而不是对象本身是否相互作用。<a href="spatial-operators-reference.html#GUID-9AB42477-D0C0-4A87-826F-1BDDF1CA1FE5">SDO_FILTER</a>运算符语法如下：</p><pre class="oac_no_warn" dir="ltr">SDO_FILTER（geometry1 SDO_GEOMETRY，geometry2 SDO_GEOMETRY，param VARCHAR2）</pre><p>在上面的语法中：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">geometry1</code>是表中SDO_GEOMETRY类型的列。此列必须在空间索引。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">geometry2</code>是SDO_GEOMETRY类型的对象。该对象可能来自也可能不来自表。如果它来自一个表，它可能会或可能不会在空间索引。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">param</code>是VARCHAR2类型的可选字符串。它可以指定<code class="codeph">min_resolution</code>和<code class="codeph">max_resolution</code>关键字中的一个或两个。
                              </p>
                           </li>
                        </ul>
                        <p>以下示例仅执行主过滤操作（不进行二次过滤操作）。它们将返回<a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5__BGBHIEJD">图5-2</a>中显示的所有几何图形，这些几何图形具有与查询窗口交互的MBR。以下示例的结果是几何图形geom_1，geom_2和geom_3。
                        </p>
                        <p><a href="indexing-querying-spatial-data.html#GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07__i1005295">示例5-2</a>执行主过滤操作，而不将查询窗口插入表中。窗口将在内存中编入索引，性能将非常好。
                        </p>
                        <div class="example" id="GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07__i1005295">
                           <p class="titleinexample">示例5-2具有临时查询窗口的主过滤器</p><pre class="oac_no_warn" dir="ltr">SELECT A.Feature_ID FROM TARGET A WHERE sdo_filter（A.shape，SDO_geometry（2003，NULL，NULL，SDO_elem_info_array（1,1003,3），SDO_ordinate_array（x1，y1，x2，y2）））='TRUE';</pre><p>在<a href="indexing-querying-spatial-data.html#GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07__i1005295">例5-2中</a> ， <code class="codeph">(x1,y1)</code>和<code class="codeph">(x2,y2)</code>是查询窗口的左下角和右上角。
                           </p>
                           <p>在<a href="indexing-querying-spatial-data.html#GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07__i1005306">例5-3中</a> ，为查询窗口构造了类型为SDO_GEOMETRY的瞬态实例，而不是在查询本身中指定窗口参数。
                           </p>
                        </div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07__i1005306">
                           <p class="titleinexample">示例5-3具有查询窗口的瞬态实例的主过滤器</p><pre class="oac_no_warn" dir="ltr">SELECT A.Feature_ID FROM TARGET A WHERE sdo_filter（A.shape，：theWindow）='TRUE';</pre><p><a href="indexing-querying-spatial-data.html#GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07__i1005314">例5-4</a>假设查询窗口已插入名为WINDOWS的表中，其ID为WINS_1。
                           </p>
                        </div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-E5954C4A-C8FF-4264-A583-5178A42B3F07__i1005314">
                           <p class="titleinexample">示例5-4具有存储查询窗口的主过滤器</p><pre class="oac_no_warn" dir="ltr">SELECT A.Feature_ID FROM TARGET A，WINDOWS B WHERE B.ID ='WINS_1'和sdo_filter（A.shape，B.shape）='TRUE';</pre><p>如果B.SHAPE列未进行空间索引，则<a href="spatial-operators-reference.html#GUID-9AB42477-D0C0-4A87-826F-1BDDF1CA1FE5">SDO_FILTER</a>运算符会将查询窗口编入内存索引，并且性能非常好。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5">空间查询</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="SPATL601"></a><a id="SPATL602"></a><a id="SPATL600"></a><div class="props_rev_3"><a id="GUID-00000B2F-E63F-44DE-B969-BD5E6F8F5A5B" name="GUID-00000B2F-E63F-44DE-B969-BD5E6F8F5A5B"></a><h5 id="SPATL-GUID-00000B2F-E63F-44DE-B969-BD5E6F8F5A5B" class="sect5"><span class="enumeration_section">5.2.1.2</span>主要和辅助过滤器操作员</h5>
                     <div>
                        <p><a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">空间操作</a>符中描述的<a href="spatial-operators-reference.html#GUID-97C17C18-F05E-49B4-BE11-E89B972E2A02">SDO_RELATE</a>运算符在处理查询时执行主过滤器阶段和辅助过滤器阶段。辅助过滤器确保仅选择实际交互的候选对象。仅当在两个数据维上创建了空间索引时，才能使用此运算符。<a href="spatial-operators-reference.html#GUID-97C17C18-F05E-49B4-BE11-E89B972E2A02">SDO_RELATE</a>运算符的语法如下：</p><pre class="oac_no_warn" dir="ltr">SDO_RELATE（geometry1 SDO_GEOMETRY，geometry2 SDO_GEOMETRY，param VARCHAR2）</pre><p>在上面的语法中：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">geometry1</code>是表中SDO_GEOMETRY类型的列。此列必须在空间索引。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">geometry2</code>是SDO_GEOMETRY类型的对象。该对象可能来自也可能不来自表。如果它来自一个表，它可能会或可能不会在空间索引。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">param</code>是带有<code class="codeph">mask</code>关键字和有效掩码值的带引号的字符串，可选择<code class="codeph">min_resolution</code>和<code class="codeph">max_resolution</code>关键字中的一个或两个，如<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">Spatial Operators中</a> <a href="spatial-operators-reference.html#GUID-97C17C18-F05E-49B4-BE11-E89B972E2A02">SDO_RELATE</a>运算符的文档中所述。
                              </p>
                           </li>
                        </ul>
                        <p>以下示例执行主要和辅助过滤器操作。它们返回<a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5__BGBHIEJD">图5-2</a>中位于查询窗口内或与查询窗口重叠的所有几何图形。这些示例的结果是对象geom_1和geom_2。
                        </p>
                        <p><a href="indexing-querying-spatial-data.html#GUID-00000B2F-E63F-44DE-B969-BD5E6F8F5A5B__i1005358">示例5-5</a>执行主过滤操作和辅助过滤操作，而不将查询窗口插入表中。窗口将在内存中编入索引，性能将非常好。
                        </p>
                        <div class="example" id="GUID-00000B2F-E63F-44DE-B969-BD5E6F8F5A5B__i1005358">
                           <p class="titleinexample">示例5-5使用临时查询窗口的辅助过滤器</p><pre class="oac_no_warn" dir="ltr">SELECT A.Feature_ID FROM TARGET A WHERE sdo_relate（A.shape，SDO_geometry（2003，NULL，NULL，SDO_elem_info_array（1,1003,3），SDO_ordinate_array（x1，y1，x2，y2）），'mask = anyinteract'）= '真正';</pre><p>在<a href="indexing-querying-spatial-data.html#GUID-00000B2F-E63F-44DE-B969-BD5E6F8F5A5B__i1005358">例5-5中</a> ， <code class="codeph">(x1,y1)</code>和<code class="codeph">(x2,y2)</code>是查询窗口的左下角和右上角。
                           </p>
                           <p><a href="indexing-querying-spatial-data.html#GUID-00000B2F-E63F-44DE-B969-BD5E6F8F5A5B__i1005370">例5-6</a>假定查询窗口已插入名为WINDOWS的表中，其ID值为WINS_1。
                           </p>
                        </div>
                        <!-- class="example" -->
                        <div class="example" id="GUID-00000B2F-E63F-44DE-B969-BD5E6F8F5A5B__i1005370">
                           <p class="titleinexample">示例5-6使用存储查询窗口的辅助过滤器</p><pre class="oac_no_warn" dir="ltr">SELECT A.Feature_ID FROM TARGET A，WINDOWS B WHERE B.ID ='WINS_1'和sdo_relate（A.shape，B.shape，'mask = anyinteract'）='TRUE';</pre><p>如果B.SHAPE列未进行空间索引，则<a href="spatial-operators-reference.html#GUID-97C17C18-F05E-49B4-BE11-E89B972E2A02">SDO_RELATE</a>运算符<a href="spatial-operators-reference.html#GUID-97C17C18-F05E-49B4-BE11-E89B972E2A02">会将</a>查询窗口编入内存索引，并且性能非常好。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5">空间查询</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="SPATL603"></a><div class="props_rev_3"><a id="GUID-3839BEE8-7743-46F4-B573-667ADC7FEB3E" name="GUID-3839BEE8-7743-46F4-B573-667ADC7FEB3E"></a><h5 id="SPATL-GUID-3839BEE8-7743-46F4-B573-667ADC7FEB3E" class="sect5"><span class="enumeration_section">5.2.1.3</span>距离内操作员</h5>
                     <div>
                        <p><a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="This chapter describes the operators that you can use when working with the spatial object data type.">空间操作</a>符中描述的<a href="spatial-operators-reference.html#GUID-682B258F-1604-4BE8-824D-F6E05376E7EC">SDO_WITHIN_DISTANCE</a>运算<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">符</a>用于确定表中与参考对象在<span class="italic">n个</span>距离单位内的对象集。仅当在两个数据维上创建了空间索引时，才能使用此运算符。引用对象可以是SDO_GEOMETRY的瞬态或持久实例，例如临时查询窗口或存储在数据库中的永久几何。运算符的语法如下：</p><pre class="oac_no_warn" dir="ltr">SDO_WITHIN_DISTANCE（geometry1 SDO_GEOMETRY，aGeom SDO_GEOMETRY，params VARCHAR2）;</pre><p>在上面的语法中：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">geometry1</code>是表中SDO_GEOMETRY类型的列。此列必须在空间索引。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">aGeom</code>是SDO_GEOMETRY类型的实例。</p>
                           </li>
                           <li>
                              <p><code class="codeph">params</code>是一个引用的关键字值对字符串，用于确定运算符的行为。请参阅<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">Spatial Operators中</a>的<a href="spatial-operators-reference.html#GUID-682B258F-1604-4BE8-824D-F6E05376E7EC">SDO_WITHIN_DISTANCE</a>运算符以获取参数列表。
                              </p>
                           </li>
                        </ul>
                        <p>以下示例从查询窗口中选择1.35距离单位内的任何对象：</p><pre class="oac_no_warn" dir="ltr">SELECT A.Feature_ID FROM TARGET A WHERE SDO_WITHIN_DISTANCE（A.shape，：theWindow，'distance = 1.35'）='TRUE';</pre><p>距离单位基于使用的几何坐标系。如果您使用的是大地坐标系，则单位为米。如果没有使用坐标系，则单位与存储的数据相同。</p>
                        <p><a href="spatial-operators-reference.html#GUID-682B258F-1604-4BE8-824D-F6E05376E7EC">SDO_WITHIN_DISTANCE</a>运算符不适合执行空间连接。也就是说，诸如<span class="italic">查找距离海岸线10个距离单位内的所有公园</span>的查询将不会被处理为COASTLINES和PARKS表的基于索引的空间连接。相反，它将作为嵌套循环查询处理，其中每个COASTLINES实例依次是针对PARKS表进行缓冲，索引和评估的引用对象。因此，如果COASTLINES表中有<span class="italic">n</span>行，则执行<span class="italic">n</span>次<a href="spatial-operators-reference.html#GUID-682B258F-1604-4BE8-824D-F6E05376E7EC">SDO_WITHIN_DISTANCE</a>操作。
                        </p>
                        <p>对于非大地测量数据，有一种有效的方法可以实现空间连接，包括缓冲层的所有几何形状。此方法不使用<a href="spatial-operators-reference.html#GUID-682B258F-1604-4BE8-824D-F6E05376E7EC">SDO_WITHIN_DISTANCE</a>运算符。首先，创建一个新表COSINE_BUFS如下：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE cosine_bufs UNRECOVERABLE AS SELECT SDO_BUFFER（A.SHAPE，B.DIMINFO，1.35）FROM COSINE A，USER_SDO_GEOM_METADATA B WHERE TABLE_NAME ='COSINES'和COLUMN_NAME ='SHAPE';</pre><p>接下来，在COSINE_BUFS的SHAPE列上创建空间索引。然后，您可以执行以下查询：</p><pre class="oac_no_warn" dir="ltr">SELECT / * + ordered * / a.gid，b.gid FROM TABLE（SDO_JOIN（'PARKS'，'SHAPE'，'COSINE_BUFS'，'SHAPE'，'mask = ANYINTERACT'））c，停放a，cosine_bufs b WHERE c.rowid1 = a.rowid AND c.rowid2 = b.rowid;</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5">空间查询</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="SPATL604"></a><div class="props_rev_3"><a id="GUID-850B0CE8-ED06-4B81-A3CE-39CE63DAFF25" name="GUID-850B0CE8-ED06-4B81-A3CE-39CE63DAFF25"></a><h5 id="SPATL-GUID-850B0CE8-ED06-4B81-A3CE-39CE63DAFF25" class="sect5"><span class="enumeration_section">5.2.1.4</span>最近邻运营商</h5>
                     <div>
                        <p><a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="This chapter describes the operators that you can use when working with the spatial object data type.">空间操作</a>符中描述的<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">SDO_NN</a>运算<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">符</a>用于标识几何的最近邻居。仅当在两个数据维上创建了空间索引时，才能使用此运算符。运算符的语法如下：</p><pre class="oac_no_warn" dir="ltr">SDO_NN（geometry1 SDO_GEOMETRY，geometry2 SDO_GEOMETRY，param VARCHAR2 [，number NUMBER]）;</pre><p>在上面的语法中：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">geometry1</code>是表中SDO_GEOMETRY类型的列。此列必须在空间索引。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">geometry2</code>是SDO_GEOMETRY类型的实例。</p>
                           </li>
                           <li>
                              <p><code class="codeph">param</code>是一个带引号的关键字 - 值对字符串，可以确定运算符的行为，例如返回多少个最近邻居几何。有关此参数的信息，请参阅<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="This chapter describes the operators that you can use when working with the spatial object data type.">Spatial Operators中</a>的<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">SDO_NN</a>运算<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">符</a> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">number</code>与调用<a href="spatial-operators-reference.html#GUID-4CD900B5-E2FB-4802-B843-E66D5D86BE64">SDO_NN_DISTANCE时</a>使用的<code class="codeph">number</code>相同。仅当<a href="spatial-operators-reference.html#GUID-4CD900B5-E2FB-4802-B843-E66D5D86BE64">SDO_NN_DISTANCE</a>辅助运算符包含在对<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">SDO_NN</a>的调用中<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">时才</a>使用此<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">选项</a> 。有关此参数的信息，请参阅<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="This chapter describes the operators that you can use when working with the spatial object data type.">Spatial Operators中</a>的<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">SDO_NN</a>运算<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">符</a> 。
                              </p>
                           </li>
                        </ul>
                        <p>以下示例从COLA_MARKETS表中的SHAPE列中查找最接近指定点（10,7）的两个对象。（请注意在SELECT语句中使用优化程序提示，如<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">空间操作</a>符中<a href="spatial-operators-reference.html#GUID-41E6B1FA-1A03-480B-996F-830E8566661D">SDO_NN</a>运算符的使用说明中所述。）
                        </p><pre class="oac_no_warn" dir="ltr">SELECT / * + INDEX（cola_markets cola_spatial_idx）* / c.mkt_id，c.name FROM cola_markets c WHERE SDO_NN（c.shape，SDO_geometry（2001，NULL，SDO_point_type（10,7，NULL），NULL，NULL），'sdo_num_res = 2'）='正确';</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5">空间查询</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="SPATL605"></a><div class="props_rev_3"><a id="GUID-76F77285-DC7D-496C-8352-1A25202D47A7" name="GUID-76F77285-DC7D-496C-8352-1A25202D47A7"></a><h5 id="SPATL-GUID-76F77285-DC7D-496C-8352-1A25202D47A7" class="sect5"><span class="enumeration_section">5.2.1.5</span>空间功能</h5>
                     <div>
                        <p>Spatial和Graph还提供用于确定几何之间关系，查找有关单个几何的信息，更改几何以及组合几何的函数。这些功能都考虑了源数据的两个维度。如果这些函数的输出值是几何，则生成的几何将具有与输入几何相同的维度，但只有前两个维度将准确反映操作的结果。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-FE2E8337-8A4E-4508-8D8D-F206ACB898E5">空间查询</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="SPATL606"></a><div class="props_rev_3"><a id="GUID-C4C35CB5-0138-487B-9C50-B4BF1BDAFE08" name="GUID-C4C35CB5-0138-487B-9C50-B4BF1BDAFE08"></a><h4 id="SPATL-GUID-C4C35CB5-0138-487B-9C50-B4BF1BDAFE08" class="sect4"><span class="enumeration_section">5.2.2</span>空间连接</h4>
                  <div>
                     <p>一个<a id="d34665e2721" class="indexterm-anchor"></a> <span class="bold">空间连接</span>与常规连接相同，只是谓词涉及空间运算符。在“空间”和“图形”中，当您将一个图层的所有几何图形与另一个图层的所有几何图形进行比较时，会发生空间连接。这与查询窗口不同，后者将单个几何图形与图层的所有几何图形进行比较。
                     </p>
                     <p>空间连接可用于回答诸如<span class="italic">哪些高速公路穿越国家公园等问题？</span></p>
                     <p>下表结构说明了如何为此示例完成连接：</p><pre class="oac_no_warn" dir="ltr">PARKS（GID VARCHAR2（32），SHAPE SDO_GEOMETRY）HIGHWAYS（GID VARCHAR2（32），SHAPE SDO_GEOMETRY）</pre><p>要执行空间连接，请使用<a href="spatial-operators-reference.html#GUID-4D9DD9EF-DD9C-4198-A416-37B900B4E32F">SDO_JOIN</a>运算符，该运算符在<a href="spatial-operators-reference.html#GUID-85422854-5133-4F1D-BF0E-228CA6EDAF87" title="本章介绍了使用空间对象数据类型时可以使用的运算符。">Spatial Operators中</a>描述。以下空间连接查询，列出公路与公园交互的公路和公园的GID列值，仅执行主过滤操作（ <code class="codeph">'mask=FILTER'</code> ），因此仅返回近似结果：</p><pre class="oac_no_warn" dir="ltr">SELECT / * + ordered * / a.gid，b.gid FROM TABLE（SDO_JOIN（'PARKS'，'SHAPE'，'HIGHWAYS'，'SHAPE'，'mask = FILTER'））c，停放a，高速公路b WHERE c.rowid1 = a.rowid AND c.rowid2 = b.rowid;</pre><div class="infoboxnote" id="GUID-C4C35CB5-0138-487B-9C50-B4BF1BDAFE08__GUID-BE1280DD-EED8-439E-8319-C6305DF0CFB4">
                        <p class="notep1">注意：</p>
                        <p>使用复合B树空间索引时，不支持<a href="spatial-operators-reference.html#GUID-4D9DD9EF-DD9C-4198-A416-37B900B4E32F">SDO_JOIN</a>运算符。
                        </p>
                     </div>
                     <p>以下空间连接查询请求与前面示例中相同的信息，但它执行主要和次要过滤操作（ <code class="codeph">'mask=ANYINTERACT'</code> ），因此它返回精确结果：</p><pre class="oac_no_warn" dir="ltr">SELECT / * + ordered * / a.gid，b.gid FROM TABLE（SDO_JOIN（'PARKS'，'SHAPE'，'HIGHWAYS'，'SHAPE'，'mask = ANYINTERACT'））c，停放a，高速公路b WHERE c.rowid1 = a.rowid AND c.rowid2 = b.rowid;</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-34D74D79-6B6A-4827-B418-A05D3F41103D" title="空间层的结构用于解析空间查询和空间连接。">查询空间数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="SPATL1412"></a><a id="SPATL1411"></a><div class="props_rev_3"><a id="GUID-DDD42A40-3EF8-473D-8D07-52A934A72D0C" name="GUID-DDD42A40-3EF8-473D-8D07-52A934A72D0C"></a><h4 id="SPATL-GUID-DDD42A40-3EF8-473D-8D07-52A934A72D0C" class="sect4"><span class="enumeration_section">5.2.3</span>数据和索引维度以及空间查询</h4>
                  <div>
                     <p>理论上，空间查询的元素可以具有以下维度：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>基表几何（或空间运算符格式中的<code class="codeph">geometry1</code> ）可以具有两个，三个或更多维。
                           </p>
                        </li>
                        <li>
                           <p>在基表（或<code class="codeph">geometry1</code> ）上创建的空间索引可以是二维或三维的。
                           </p>
                        </li>
                        <li>
                           <p>查询窗口（或空间运算符格式中的<code class="codeph">geometry2</code> ）可以具有两个，三个或更多维度。
                           </p>
                        </li>
                     </ul>
                     <p>支持三个元素之间的某些维度组合，而有些则不支持。<a href="indexing-querying-spatial-data.html#GUID-DDD42A40-3EF8-473D-8D07-52A934A72D0C__BGBCEEFJ" title="数据和索引维度以及查询支持。第1列是基表（geometry1）维度，第2列是空间索引维度，第3列是查询窗口（geometry2）维度，第4列是查询结果。">表5-1</a>说明了涉及二维和三维的可能组合会发生什么。
                     </p>
                     <div class="tblformal" id="GUID-DDD42A40-3EF8-473D-8D07-52A934A72D0C__BGBCEEFJ">
                        <p class="titleintable">表5-1数据和索引维度以及查询支持</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="数据和索引维度以及查询支持" width="100%" border="1" summary="Data and Index Dimensionality, and Query Support. Column 1 is Base Table (geometry1) Dimensionality, column 2 is Spatial Index Dimensionality, column 3 is Query Window (geometry2) Dimensionality, and column 4 is Query Result." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="16%" id="d34665e2867">基表（geometry1）维度</th>
                                 <th align="left" valign="bottom" width="16%" id="d34665e2870">空间索引维度</th>
                                 <th align="left" valign="bottom" width="15%" id="d34665e2873">查询窗口（geometry2）维度</th>
                                 <th align="left" valign="bottom" width="53%" id="d34665e2876">查询结果</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d34665e2881" headers="d34665e2867 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d34665e2881 d34665e2870 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d34665e2881 d34665e2873 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d34665e2881 d34665e2876 ">
                                    <p>执行二维查询。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d34665e2894" headers="d34665e2867 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d34665e2894 d34665e2870 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d34665e2894 d34665e2873 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d34665e2894 d34665e2876 ">
                                    <p>如果查询窗口具有小于3008的适当SDO_GTYPE值，则支持。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d34665e2907" headers="d34665e2867 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d34665e2907 d34665e2870 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d34665e2907 d34665e2873 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d34665e2907 d34665e2876 ">
                                    <p>不支持：2D数据不允许3D索引。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d34665e2920" headers="d34665e2867 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d34665e2920 d34665e2870 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d34665e2920 d34665e2873 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d34665e2920 d34665e2876 ">
                                    <p>不支持：2D数据不允许3D索引。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d34665e2933" headers="d34665e2867 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d34665e2933 d34665e2870 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d34665e2933 d34665e2873 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d34665e2933 d34665e2876 ">
                                    <p>忽略每个基础几何体中的第三个（Z）维度并执行二维查询。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d34665e2946" headers="d34665e2867 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d34665e2946 d34665e2870 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d34665e2946 d34665e2873 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d34665e2946 d34665e2876 ">
                                    <p>如果查询窗口具有小于3008的适当SDO_GTYPE值，则支持。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d34665e2959" headers="d34665e2867 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d34665e2959 d34665e2870 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d34665e2959 d34665e2873 ">
                                    <p>2维</p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d34665e2959 d34665e2876 ">
                                    <p>将2D查询窗口转换为零Z值的3D窗口并执行三维查询。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="16%" id="d34665e2972" headers="d34665e2867 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d34665e2972 d34665e2870 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d34665e2972 d34665e2873 ">
                                    <p>3维</p>
                                 </td>
                                 <td align="left" valign="top" width="53%" headers="d34665e2972 d34665e2876 ">
                                    <p>执行三维查询。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-34D74D79-6B6A-4827-B418-A05D3F41103D" title="空间层的结构用于解析空间查询和空间连接。">查询空间数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-D5FC46C1-6A9F-40C5-90A9-449DD93EAF0A" name="GUID-D5FC46C1-6A9F-40C5-90A9-449DD93EAF0A"></a><h4 id="SPATL-GUID-D5FC46C1-6A9F-40C5-90A9-449DD93EAF0A" class="sect4"><span class="enumeration_section">5.2.4</span>使用事件54700要求空间查询的空间索引</h4>
                  <div>
                     <p><a id="d34665e3044" class="indexterm-anchor"></a>尽管建议空间索引用于空间查询，但默认情况下不需要空间索引。但是，您可以通过将事件54700设置为<code class="codeph">level</code>值<code class="codeph">1</code>来要求定义空间索引并将其用于空间查询。您可以通过将事件54700设置为<code class="codeph">level</code>值<code class="codeph">0</code> （零）将行为重置为默认值。
                     </p>
                     <p>您可以分别使用ALTER SESSION或ALTER SYSTEM语句为会话或系统应用事件。例如：</p><pre class="pre codeblock"><code>ALTER SESSION永远设置事件'54700跟踪名称上下文，级别1';</code></pre><p>可能的<code class="codeph">level</code>值是：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>0（默认值）：表示即使查询候选几何列上不存在空间索引，也可以执行空间查询。</p>
                        </li>
                        <li>
                           <p>1：表示空间查询<span class="bold">必须</span>在查询候选几何列上显示空间索引。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="indexing-querying-spatial-data.html#GUID-34D74D79-6B6A-4827-B418-A05D3F41103D" title="空间层的结构用于解析空间查询和空间连接。">查询空间数据</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>