<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>识别高负载SQL语句</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database 2 Day + Performance Tuning Guide"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database 2 Day + Performance Tuning Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-2-day-performance-tuning-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T02:50:24-08:00"></meta>
      <meta name="dcterms.title" content="Database 2 Day + Performance Tuning Guide"></meta>
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96346-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="part-IV-sql-tuning.html" title="Previous" type="text/html"></link>
      <link rel="next" href="tuning-sql-statements.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TDPPT"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="part-IV-sql-tuning.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="tuning-sql-statements.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库2天+性能调整指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-IV-sql-tuning.html" property="item" typeof="WebPage"><span property="name">SQL调优</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">识别高负载SQL语句</li>
            </ol>
            <a id="GUID-D4D8C985-93B4-402C-A6C9-D5ABA980BEDB" name="GUID-D4D8C985-93B4-402C-A6C9-D5ABA980BEDB"></a><a id="TDPPT140"></a>
            
            <h2 id="TDPPT-GUID-D4D8C985-93B4-402C-A6C9-D5ABA980BEDB" class="sect2"><span class="enumeration_chapter">11</span>识别高负载SQL语句</h2>
         </header>
         <div class="ind">
            <div>
               <p>高负载SQL语句<a id="d21103e80" class="indexterm-anchor"></a>可能消耗不成比例的系统资源。这些SQL语句通常会极大地影响数据库性能，必须进行调整以优化其性能和资源消耗。即使正确调整了数据库，低效的SQL也会严重降低性能。
               </p>
               <p>识别高负载SQL语句是一项必须定期执行的重要SQL调优活动。自动数据库诊断监视器（ADDM）通过主动识别潜在的高负载SQL语句来自动执行此任务。此外，您可以使用Oracle Enterprise Manager云控制（云控制）来识别需要进一步调查的高负载SQL语句。确定高负载SQL语句后，可以使用SQL Tuning Advisor和SQL Access Advisor对其进行调整。</p>
               <p>本章介绍如何识别高负载SQL语句，并包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="identifying-high-load-sql-statements.html#GUID-795AF9F0-5CBF-44FB-8D20-FC170EFA149C">使用ADDM查找标识高负载SQL语句</a></p>
                  </li>
                  <li>
                     <p><a href="identifying-high-load-sql-statements.html#GUID-572D0FE3-BC16-4107-A8CC-EF59480B9C9E">使用Top SQL识别高负载SQL语句</a></p>
                  </li>
               </ul>
            </div><a id="TDPPT141"></a><div class="props_rev_3"><a id="GUID-795AF9F0-5CBF-44FB-8D20-FC170EFA149C" name="GUID-795AF9F0-5CBF-44FB-8D20-FC170EFA149C"></a><h3 id="TDPPT-GUID-795AF9F0-5CBF-44FB-8D20-FC170EFA149C" class="sect3"><span class="enumeration_section">11.1</span>使用ADDM查找标识高负载SQL语句</h3>
               <div>
                  <p>默认情况下，ADDM每小时主动运行一次。它分析自动工作负载存储库（AWR）在过去一小时收集的关键统计信息，以识别任何性能问题，包括高负载SQL语句<a id="d21103e182" class="indexterm-anchor"></a><a id="d21103e186" class="indexterm-anchor"></a> 。当系统发现性能问题时，它会在自动数据库诊断监视器（ADDM）页面中将其显示为ADDM结果。
                  </p>
                  <p>ADDM为每个ADDM发现提供建议。识别出高负载SQL语句时，ADDM会提供建议，例如在SQL语句上运行SQL Tuning Advisor。您可以按照调整SQL语句中的描述开始调<a href="tuning-sql-statements.html#GUID-6B386EC1-A58F-4CFC-AEFB-9F787A112396">优SQL语句</a> 。
                  </p>
                  <div class="infoboxnotealso" id="GUID-795AF9F0-5CBF-44FB-8D20-FC170EFA149C__GUID-C06B2CDF-ECF1-426C-8658-12F951B50EDD">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="automatic-database-performance-monitoring.html#GUID-32E92AEC-AF1A-4602-B998-3250920CD3BE" title="从Oracle Database 12c开始，默认情况下在多租户容器数据库（CDB）的根容器中启用ADDM。从Oracle Database 19c开始，您还可以在可插拔数据库（PDB）中使用ADDM。">自动数据库诊断监视器概述</a> ”</span></p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="automatic-database-performance-monitoring.html#GUID-3262CC73-BDB4-4315-907C-440307A0565C">自动数据库诊断监视器结果的解释</a> ”</span></p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="automatic-database-performance-monitoring.html#GUID-8CBEA3E7-7550-41D9-ACFF-13BACF9900F1">实施自动数据库诊断监视器建议</a> ”</span></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="TDPPT430"></a><a id="TDPPT142"></a><div class="props_rev_3"><a id="GUID-572D0FE3-BC16-4107-A8CC-EF59480B9C9E" name="GUID-572D0FE3-BC16-4107-A8CC-EF59480B9C9E"></a><h3 id="TDPPT-GUID-572D0FE3-BC16-4107-A8CC-EF59480B9C9E" class="sect3"><span class="enumeration_section">11.2</span>使用Top SQL识别高负载SQL语句</h3>
               <div>
                  <div class="section">
                     <p>ADDM自动识别可能导致系统性能下降的高负载SQL语句。在正常情况下，不需要手动识别高负载SQL语句。但是，在某些情况下，您可能希望以更精细的级别监视SQL语句。Top SQL部分<a id="d21103e305" class="indexterm-anchor"></a><a id="d21103e309" class="indexterm-anchor"></a><a id="d21103e313" class="indexterm-anchor"></a>通过Cloud Control中的Top Activity页面，您可以识别任何5分钟间隔的高负载SQL语句。
                     </p>
                     <p><a href="identifying-high-load-sql-statements.html#GUID-572D0FE3-BC16-4107-A8CC-EF59480B9C9E__CHDEDBJE">图11-1</a>显示了Top Activity页面的示例。该页面显示数据库上运行的顶级活动的1小时时间线。使用最高百分比的数据库活动的SQL语句列在Top SQL部分下，并以5分钟为间隔显示。
                     </p>
                     <div class="figure" id="GUID-572D0FE3-BC16-4107-A8CC-EF59480B9C9E__CHDEDBJE">
                        <p class="titleinfigure">图11-1热门活动页面</p><img src="img/top_activity.gif" alt="下面是图11-1的描述" title="下面是图11-1的描述" longdesc="img_text/top_activity.html"><br><a href="img_text/top_activity.html">“图11-1热门活动页面”的描述</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-572D0FE3-BC16-4107-A8CC-EF59480B9C9E__GUID-03B87EB8-EF0E-49B2-9783-CE54947C8D26">要访问“热门活动”页面：</p>
                     <ol>
                        <li>
                           <p>访问数据库主页。</p>
                           <p>有关详细信息，请参阅<span class="q">“ <a href="introduction.html#GUID-653C25F9-71B4-4E26-8902-12BC20B20270">访问数据库主页</a> ”</span> 。
                           </p>
                        </li>
                        <li>
                           <p>从<span class="bold">Performance</span>菜单中，选择<span class="bold">Top Activity</span> 。
                           </p>
                           <p>如果出现“数据库登录”页面，则以具有管理员权限的用户身份登录。将显示“热门活动”页面。</p>
                        </li>
                        <li>
                           <p>要移动5分钟间隔，请将阴影框拖动到所需时间。</p>
                           <p>Top SQL部分中包含的信息会自动更新以反映所选的时间段。</p>
                        </li>
                        <li>
                           <p>要监视SQL语句的持续时间超过一小时，请从“查看数据”列表中选择“ <span class="bold">历史</span> ”。
                           </p>
                           <p>在历史视图中，您可以查看AWR保留期定义的持续时间内的顶级SQL语句。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="identifying-high-load-sql-statements.html#GUID-65BF9DC3-4FD4-4CA9-B678-21D36E7188D6">按等级类查看SQL语句</a></p>
                        </li>
                        <li>
                           <p><a href="identifying-high-load-sql-statements.html#GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0">查看SQL语句的详细信息</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="TDPPT143"></a><div class="props_rev_3"><a id="GUID-65BF9DC3-4FD4-4CA9-B678-21D36E7188D6" name="GUID-65BF9DC3-4FD4-4CA9-B678-21D36E7188D6"></a><h4 id="TDPPT-GUID-65BF9DC3-4FD4-4CA9-B678-21D36E7188D6" class="sect4"><span class="enumeration_section">11.2.1</span>按等级类查看SQL语句</h4>
                  <div>
                     <div class="section">
                        <p>Top Activity页面的Top SQL部分中显示的SQL语句<a id="d21103e461" class="indexterm-anchor"></a><a id="d21103e465" class="indexterm-anchor"></a><a id="d21103e469" class="indexterm-anchor"></a>根据热门活动图表上图例中描述的相应类别，将其分类为各种等待类。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-65BF9DC3-4FD4-4CA9-B678-21D36E7188D6__GUID-B387AB91-9674-4371-AC1B-F2AE6739E246">要查看特定等待类的SQL语句：</p>
                        <ol>
                           <li>
                              <p>访问数据库主页。</p>
                              <p>有关详细信息，请参阅<span class="q">“ <a href="introduction.html#GUID-653C25F9-71B4-4E26-8902-12BC20B20270">访问数据库主页</a> ”</span> 。
                              </p>
                           </li>
                           <li>
                              <p>从<span class="bold">Performance</span>菜单中，选择<span class="bold">Top Activity</span> 。
                              </p>
                              <p>如果出现“数据库登录”页面，则以具有管理员权限的用户身份登录。将显示“热门活动”页面。</p>
                           </li>
                           <li>
                              <p>在“顶部活动”图表中，单击图表上等待类的颜色块或图例中相应的等待类。</p>
                              <p>将显示所选等待类的“活动会话工作”页面。Top SQL部分自动更新以仅显示指定等待类的SQL语句。</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-65BF9DC3-4FD4-4CA9-B678-21D36E7188D6__GUID-296B5F6D-8C9C-4FE4-B74C-7F052CB4C9AA">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="monitoring-real-time-database-performance.html#GUID-EE9118C7-708A-488F-A332-4ECFA6638A07">监视用户活动</a> ”</span>以获取有关使用“活动会话工作”页面的信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TDPPT144"></a><div class="props_rev_3"><a id="GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0" name="GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0"></a><h4 id="TDPPT-GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0" class="sect4"><span class="enumeration_section">11.2.2</span>查看SQL语句的详细信息</h4>
                  <div>
                     <div class="section">
                        <p>Top Activity页面的Top SQL部分显示SQL语句<a id="d21103e597" class="indexterm-anchor"></a>在所选的5分钟间隔内根据其资源消耗以降序执行。此表顶部的SQL语句表示该时间段内资源最密集的SQL语句，后跟第二个资源最密集的SQL语句，依此类推。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0__GUID-1026DAEC-45BB-4472-ADCC-35F158E193EC">要查看SQL语句的详细信息：</p>
                        <ol>
                           <li>
                              <p>访问数据库主页。</p>
                              <p>有关详细信息，请参阅<span class="q">“ <a href="introduction.html#GUID-653C25F9-71B4-4E26-8902-12BC20B20270">访问数据库主页</a> ”</span> 。
                              </p>
                           </li>
                           <li>
                              <p>从<span class="bold">Performance</span>菜单中，选择<span class="bold">Top Activity</span> 。
                              </p>
                              <p>如果出现“数据库登录”页面，则以具有管理员权限的用户身份登录。热门活动页面<a id="d21103e627" class="indexterm-anchor"></a>出现。
                              </p>
                           </li>
                           <li>
                              <p>在Top SQL部分中，单击SQL语句的<span class="bold">SQL ID</span>链接。
                              </p>
                              <p>将显示所选SQL语句的“SQL详细信息”页面。</p>
                           </li>
                           <li>
                              <p>要查看更长时间的SQL详细信息，请从“查看数据”列表中选择“ <span class="bold">历史</span> ”。
                              </p>
                              <div class="figure" id="GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0__GUID-F6AF52ED-21B3-4C72-A266-205EE1131862"><img src="img/sql_details_historical.gif" alt="下面是sql_details_historical.gif的描述" title="下面是sql_details_historical.gif的描述" longdesc="img_text/sql_details_historical.html"><br><a href="img_text/sql_details_historical.html">插图说明sql_details_historical.gif</a></div>
                              <!-- class="figure" -->
                              <p>您现在可以查看过去的SQL详细信息，直到AWR保留期定义的持续时间。</p>
                           </li>
                           <li>
                              <p>在“文本”部分中，查看SQL语句的SQL文本。</p>
                              <p>文本部分<a id="d21103e656" class="indexterm-anchor"></a>包含所选SQL语句的SQL文本。请注意，如果仅显示部分SQL语句，则“文本”标题旁会显示加号（ <code class="codeph">+</code> ）图标。要查看整个SQL语句的SQL文本，请单击加号（ <span class="bold">+</span> ）图标。
                              </p>
                              <p>在<a href="identifying-high-load-sql-statements.html#GUID-572D0FE3-BC16-4107-A8CC-EF59480B9C9E__CHDEDBJE">图11-1中</a> ，SQL语句<code class="codeph">ddthrb7j9a63f</code>的文本如下：</p><pre class="oac_no_warn" dir="ltr">SELECT E.LAST_NAME，J.JOB_TITLE，D.DEPARTMENT_NAME来自HR.EMPLOYEES E，HR.DEPARTMENTS D，HR.JOBS J WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID AND E.JOB_ID = J.JOB_ID AND E.LAST_NAME LIKE'A ％”</pre></li>
                           <li>
                              <p>在“详细信息”部分的“计划哈希值”列表中，执行以下操作之一：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果SQL语句有多个计划，则选择“ <span class="bold">全部”</span>以显示所有计划的SQL详细信息。
                                    </p>
                                 </li>
                                 <li>
                                    <p>选择特定计划以仅显示此计划的SQL详细信息。</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>查看“SQL详细信息”页面上可用的子页面以显示有关SQL语句的其他信息，如以下部分所述：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="identifying-high-load-sql-statements.html#GUID-C6418DB0-9238-429D-9159-DE7E6E20393E">查看SQL统计信息</a></p>
                                 </li>
                                 <li>
                                    <p><a href="identifying-high-load-sql-statements.html#GUID-AD63DDAB-0B64-4F02-8FA6-D8488607222B">查看会话活动</a></p>
                                 </li>
                                 <li>
                                    <p><a href="identifying-high-load-sql-statements.html#GUID-586546C6-60A2-473A-9FA5-B683EC5AB7C6">查看SQL执行计划</a></p>
                                 </li>
                                 <li>
                                    <p><a href="identifying-high-load-sql-statements.html#GUID-5FDF9E5C-1CE6-4262-BD21-BAE7D4A5F615">查看计划控制</a></p>
                                 </li>
                                 <li>
                                    <p><a href="identifying-high-load-sql-statements.html#GUID-EA069807-764B-4E0A-B5B3-63ADFE876B96">查看调整历史记录</a></p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>如果SQL语句是高负载SQL语句，则按照<a href="tuning-sql-statements.html#GUID-6B386EC1-A58F-4CFC-AEFB-9F787A112396">调整SQL语句中的说明</a>进行<a href="tuning-sql-statements.html#GUID-6B386EC1-A58F-4CFC-AEFB-9F787A112396">调整</a> 。
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div><a id="TDPPT497"></a><div class="props_rev_3"><a id="GUID-C6418DB0-9238-429D-9159-DE7E6E20393E" name="GUID-C6418DB0-9238-429D-9159-DE7E6E20393E"></a><h5 id="TDPPT-GUID-C6418DB0-9238-429D-9159-DE7E6E20393E" class="sect5"><span class="enumeration_section">11.2.2.1</span>查看SQL统计信息</h5>
                     <div>
                        <div class="section">
                           <p>该<a id="d21103e808" class="indexterm-anchor"></a><a id="d21103e812" class="indexterm-anchor"></a> “SQL详细信息”页面的“统计信息”子页面显示有关SQL语句的统计信息。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-C6418DB0-9238-429D-9159-DE7E6E20393E__GUID-30806835-C5A8-497B-B758-04C05B9C179B">要查看SQL语句的统计信息：</p>
                           <ol>
                              <li>
                                 <p>访问“SQL详细信息”页面，如<span class="q">“ <a href="identifying-high-load-sql-statements.html#GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0">查看SQL语句的详细信息</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>在Details下，单击<span class="bold">Statistics</span> 。
                                 </p>
                                 <p>出现统计子页面。</p>
                                 <div class="figure" id="GUID-C6418DB0-9238-429D-9159-DE7E6E20393E__GUID-618C54AC-5F94-40E8-B067-8B3D3633F503"><img src="img/sql_details_statistics.gif" alt="下面是sql_details_statistics.gif的描述" title="下面是sql_details_statistics.gif的描述" longdesc="img_text/sql_details_statistics.html"><br><a href="img_text/sql_details_statistics.html">插图说明sql_details_statistics.gif</a></div>
                                 <!-- class="figure" -->
                              </li>
                              <li>
                                 <p>查看SQL语句的统计信息，如以下部分所述：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><a href="identifying-high-load-sql-statements.html#GUID-C1A2F014-0B46-4289-9A72-984CC83B456E">SQL统计摘要</a></p>
                                    </li>
                                    <li>
                                       <p><a href="identifying-high-load-sql-statements.html#GUID-4D30886E-A7BC-4A42-A115-3661999FD6D4">一般SQL统计</a></p>
                                    </li>
                                    <li>
                                       <p><a href="identifying-high-load-sql-statements.html#GUID-9DAF8880-E83F-436A-95FD-6945E6B7C419">等待统计活动和按时间统计活动</a></p>
                                    </li>
                                    <li>
                                       <p><a href="identifying-high-load-sql-statements.html#GUID-6C19EB4C-5EA4-4EB2-80A8-A59D669AF509">经过时间细分统计</a></p>
                                    </li>
                                    <li>
                                       <p><a href="identifying-high-load-sql-statements.html#GUID-E5A10F7C-133D-463D-A5B4-C5AAA9253A40">共享游标统计和执行统计信息</a></p>
                                    </li>
                                    <li>
                                       <p><a href="identifying-high-load-sql-statements.html#GUID-A519C862-8042-42CA-9C6F-1118728CFA4D">其他SQL统计信息</a></p>
                                    </li>
                                 </ul>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div><a id="TDPPT499"></a><div class="props_rev_3"><a id="GUID-C1A2F014-0B46-4289-9A72-984CC83B456E" name="GUID-C1A2F014-0B46-4289-9A72-984CC83B456E"></a><h6 id="TDPPT-GUID-C1A2F014-0B46-4289-9A72-984CC83B456E" class="sect6"><span class="enumeration_section">11.2.2.1.1</span> SQL统计摘要</h6>
                        <div>
                           <p>“摘要”部分显示图表上的SQL统计信息和活动。</p>
                           <p>在“实时”视图中，“活动会话”图表显示过去一小时内执行SQL语句的平均活动会话数。如果SQL语句有多个计划并且在计划哈希值列表中选择了<span class="bold">全部</span> ，则图表会以不同颜色显示每个计划，使您可以轻松发现计划是否更改以及这是否可能是性能下降的原因。或者，您可以选择仅显示该计划的特定计划。
                           </p>
                           <p>在历史视图中，图表以不同维度显示执行统计信息。要查看执行统计信息，请从“查看”列表中选择所需的维度：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>每次执行经过的时间</p>
                              </li>
                              <li>
                                 <p>每小时执行一次</p>
                              </li>
                              <li>
                                 <p>每次执行磁盘读取</p>
                              </li>
                              <li>
                                 <p>每次执行缓冲区</p>
                              </li>
                           </ul>
                           <p>此技术使您可以使用不同的维度跟踪SQL语句的响应时间。您可以根据所选维度确定SQL语句的性能是否已降低。</p>
                           <p>要查看特定时间间隔的SQL语句的统计信息，请单击图表下方的快照图标。您还可以使用箭头滚动图表以查找所需的快照。</p>
                        </div>
                     </div><a id="TDPPT500"></a><div class="props_rev_3"><a id="GUID-4D30886E-A7BC-4A42-A115-3661999FD6D4" name="GUID-4D30886E-A7BC-4A42-A115-3661999FD6D4"></a><h6 id="TDPPT-GUID-4D30886E-A7BC-4A42-A115-3661999FD6D4" class="sect6"><span class="enumeration_section">11.2.2.1.2</span>常规SQL统计信息</h6>
                        <div>
                           <p>“常规”部分使您可以通过列出以下信息来标识SQL语句的来源：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>模块，如果使用<code class="codeph">DBMS_APPLICATION_INFO</code>包指定</p>
                              </li>
                              <li>
                                 <p>Action，如果使用<code class="codeph">DBMS_APPLICATION_INFO</code>包指定</p>
                              </li>
                              <li>
                                 <p>解析模式或用于执行SQL语句的数据库帐户</p>
                              </li>
                              <li>
                                 <p>PL / SQL源，如果SQL语句是PL / SQL程序的一部分，则为代码行</p>
                              </li>
                           </ul>
                        </div>
                     </div><a id="TDPPT501"></a><div class="props_rev_3"><a id="GUID-9DAF8880-E83F-436A-95FD-6945E6B7C419" name="GUID-9DAF8880-E83F-436A-95FD-6945E6B7C419"></a><h6 id="TDPPT-GUID-9DAF8880-E83F-436A-95FD-6945E6B7C419" class="sect6"><span class="enumeration_section">11.2.2.1.3</span>按时间统计的等待统计和活动的活动</h6>
                        <div>
                           <p>“按等待的活动”和“按时间的活动”部分使您可以确定SQL语句大部分时间的使用情况。“按等待的活动”部分包含CPU消耗的剩余时间和剩余等待的图形表示。“按时间划分的活动”部分将经过的总时间分为CPU时间和等待时间。</p>
                        </div>
                     </div><a id="TDPPT502"></a><div class="props_rev_3"><a id="GUID-6C19EB4C-5EA4-4EB2-80A8-A59D669AF509" name="GUID-6C19EB4C-5EA4-4EB2-80A8-A59D669AF509"></a><h6 id="TDPPT-GUID-6C19EB4C-5EA4-4EB2-80A8-A59D669AF509" class="sect6"><span class="enumeration_section">11.2.2.1.4</span>经过时间细分统计</h6>
                        <div>
                           <p>Elapsed Time Breakdown部分使您能够识别SQL语句本身是否消耗了大量时间，或者由于原始程序或应用程序花费在PL / SQL或Java引擎上的时间而导致总耗用时间过长。如果PL / SQL时间或Java时间占经过时间的很大一部分，那么调整SQL语句可能会带来最小的好处。相反，您应该检查应用程序以确定如何减少PL / SQL时间或Java时间。</p>
                        </div>
                     </div><a id="TDPPT503"></a><div class="props_rev_3"><a id="GUID-E5A10F7C-133D-463D-A5B4-C5AAA9253A40" name="GUID-E5A10F7C-133D-463D-A5B4-C5AAA9253A40"></a><h6 id="TDPPT-GUID-E5A10F7C-133D-463D-A5B4-C5AAA9253A40" class="sect6"><span class="enumeration_section">11.2.2.1.5</span>共享游标统计和执行统计</h6>
                        <div>
                           <p>Shared Cursors Statistics和Execution Statistics部分提供有关SQL执行过程各个阶段的效率的信息。</p>
                        </div>
                     </div><a id="TDPPT504"></a><div class="props_rev_3"><a id="GUID-A519C862-8042-42CA-9C6F-1118728CFA4D" name="GUID-A519C862-8042-42CA-9C6F-1118728CFA4D"></a><h6 id="TDPPT-GUID-A519C862-8042-42CA-9C6F-1118728CFA4D" class="sect6"><span class="enumeration_section">11.2.2.1.6</span>其他SQL统计信息</h6>
                        <div>
                           <p>“其他统计信息”部分提供有关SQL语句的其他信息，例如平均持久性和运行时内存。</p>
                        </div>
                     </div>
                  </div><a id="TDPPT505"></a><div class="props_rev_3"><a id="GUID-AD63DDAB-0B64-4F02-8FA6-D8488607222B" name="GUID-AD63DDAB-0B64-4F02-8FA6-D8488607222B"></a><h5 id="TDPPT-GUID-AD63DDAB-0B64-4F02-8FA6-D8488607222B" class="sect5"><span class="enumeration_section">11.2.2.2</span>查看会话活动</h5>
                     <div>
                        <div class="section">
                           <p>活动子页面<a id="d21103e1494" class="indexterm-anchor"></a><a id="d21103e1498" class="indexterm-anchor"></a>包含会话活动的图形表示。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-AD63DDAB-0B64-4F02-8FA6-D8488607222B__GUID-89915857-5208-4769-9F7E-DAF68E5415EE">要查看SQL语句的会话活动：</p>
                           <ol>
                              <li>
                                 <p>访问“SQL详细信息”页面，如<span class="q">“ <a href="identifying-high-load-sql-statements.html#GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0">查看SQL语句的详细信息</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>在详细信息下，单击<span class="bold">活动</span> 。
                                 </p>
                                 <p>将出现“SQL详细信息”页面，其中显示“活动”子页面</p>
                                 <div class="figure" id="GUID-AD63DDAB-0B64-4F02-8FA6-D8488607222B__GUID-B419CCE9-520D-4103-9A8D-B0FEF8FB4E11"><img src="img/sql_details_activity.gif" alt="下面是sql_details_activity.gif的描述" title="下面是sql_details_activity.gif的描述" longdesc="img_text/sql_details_activity.html"><br><a href="img_text/sql_details_activity.html">插图描述sql_details_activity.gif</a></div>
                                 <!-- class="figure" -->
                                 <p>“活动”子页面显示执行SQL语句的各个会话的详细信息。“活动会话”图表会描述一段时间内活动会话的平均数。</p>
                              </li>
                              <li>
                                 <p>（可选）拖动阴影框以选择5分钟的间隔。</p>
                                 <p>“选定的5分钟间隔的详细信息”部分列出了在选定的5分钟间隔期间执行SQL语句的会话。“ <span>活动％”</span>列中的多色条形图描述了在执行SQL语句时如何为每个会话划分数据库时间。
                                 </p>
                              </li>
                              <li>
                                 <p>（可选）单击要查看的会话的<span class="bold">SID</span>列中的链接以显示“会话详细信息”页面。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-AD63DDAB-0B64-4F02-8FA6-D8488607222B__GUID-76EA6DDA-6AAA-4B24-BC53-14C08443A408">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关监控会话活动和详细信息的信息，请<span class="q">“ <a href="monitoring-real-time-database-performance.html#GUID-F89D9B48-A4CA-4AC6-80FB-81EF8BB78DFC">监控热门会话</a> ”</span></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TDPPT506"></a><div class="props_rev_3"><a id="GUID-586546C6-60A2-473A-9FA5-B683EC5AB7C6" name="GUID-586546C6-60A2-473A-9FA5-B683EC5AB7C6"></a><h5 id="TDPPT-GUID-586546C6-60A2-473A-9FA5-B683EC5AB7C6" class="sect5"><span class="enumeration_section">11.2.2.3</span>查看SQL执行计划</h5>
                     <div>
                        <div class="section">
                           <p>SQL语句的<span class="bold">执行计划</span>是Oracle数据库为运行该语句而执行的操作序列。计划子页面<a id="d21103e1639" class="indexterm-anchor"></a><a id="d21103e1643" class="indexterm-anchor"></a>在图表视图和表视图中显示SQL语句的执行计划。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-586546C6-60A2-473A-9FA5-B683EC5AB7C6__GUID-88AE832B-AC78-4F7A-9E63-442B14AF0557">要查看SQL语句的执行计划：</p>
                           <ol>
                              <li>
                                 <p>访问“SQL详细信息”页面，如<span class="q">“ <a href="identifying-high-load-sql-statements.html#GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0">查看SQL语句的详细信息</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>在详细信息下，单击<span class="bold">计划</span> 。
                                 </p>
                                 <p>将出现“SQL详细信息”页面，其中显示“计划”子页面</p>
                              </li>
                              <li>
                                 <p>单击“ <span class="bold">图形”</span>以在图表视图中查看SQL执行。
                                 </p>
                                 <div class="figure" id="GUID-586546C6-60A2-473A-9FA5-B683EC5AB7C6__GUID-7249D0E3-FFFE-4F1C-8B70-2D7D566761E1"><img src="img/sql_details_plan_graph.gif" alt="下面是sql_details_plan_graph.gif的描述" title="下面是sql_details_plan_graph.gif的描述" longdesc="img_text/sql_details_plan_graph.html"><br><a href="img_text/sql_details_plan_graph.html">插图描述sql_details_plan_graph.gif</a></div>
                                 <!-- class="figure" -->
                              </li>
                              <li>
                                 <p>（可选）在图形中选择一个操作以显示有关执行计划中显示的操作的详细信息。</p>
                                 <p>“选择详细信息”部分将刷新以显示有关所选操作的详细信息。</p>
                              </li>
                              <li>
                                 <p>如果所选操作位于特定数据库对象（例如表）上，则单击“ <span class="bold">对象”</span>链接以查看有关数据库对象的更多详细信息。
                                 </p>
                              </li>
                              <li>
                                 <p>要在表视图中查看SQL执行，请单击“ <span class="bold">表格”</span> 。
                                 </p>
                                 <p>计划子页面刷新以在表格中显示解释计划。</p>
                                 <div class="figure" id="GUID-586546C6-60A2-473A-9FA5-B683EC5AB7C6__GUID-9224C9DA-4EAD-4AD1-95F5-FF3B93B84763"><img src="img/sql_details_plan_table.gif" alt="下面是sql_details_plan_table.gif的描述" title="下面是sql_details_plan_table.gif的描述" longdesc="img_text/sql_details_plan_table.html"><br><a href="img_text/sql_details_plan_table.html">插图描述sql_details_plan_table.gif</a></div>
                                 <!-- class="figure" -->
                                 <p><span class="bold">查询重写</span>是一种优化技术，它将根据主表编写的用户请求转换为包含物化视图的语义等效请求。数据库比较查询的成本，有和没有查询重写，并选择成本最低的选项。如果需要重写，则在Explain Rewrite部分中显示查询重写及其成本优势。
                                 </p>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-586546C6-60A2-473A-9FA5-B683EC5AB7C6__GUID-135D1E03-BD99-4D76-9E1D-14BD037AFA9D">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="tuning-sql-statements.html#GUID-6B386EC1-A58F-4CFC-AEFB-9F787A112396">调整SQL语句</a> ”</span>以获取有关执行计划和查询优化器的信息</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TDPPT507"></a><div class="props_rev_3"><a id="GUID-5FDF9E5C-1CE6-4262-BD21-BAE7D4A5F615" name="GUID-5FDF9E5C-1CE6-4262-BD21-BAE7D4A5F615"></a><h5 id="TDPPT-GUID-5FDF9E5C-1CE6-4262-BD21-BAE7D4A5F615" class="sect5"><span class="enumeration_section">11.2.2.4</span>查看计划控制</h5>
                     <div>
                        <div class="section">
                           <p>该<a id="d21103e1796" class="indexterm-anchor"></a>计划控制子页面包含有关以下项目的信息：</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>SQL配置文件</p>
                                 <p>SQL配置文件包含SQL语句的其他统计信息。优化程序使用这些统计信息为语句生成更好的执行计划。</p>
                              </li>
                              <li>
                                 <p>SQL补丁</p>
                                 <p>将自动生成SQL修补程序以解决单个SQL语句的错误或性能问题。</p>
                              </li>
                              <li>
                                 <p>SQL计划基准</p>
                                 <p>SQL计划基准是一种被证明对给定SQL语句具有可接受性能的执行计划。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-5FDF9E5C-1CE6-4262-BD21-BAE7D4A5F615__GUID-B505238C-1474-4747-8676-83C1EDC0B7D3">要查看计划控制信息：</p>
                           <ol>
                              <li>
                                 <p>访问“SQL详细信息”页面，如<span class="q">“ <a href="identifying-high-load-sql-statements.html#GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0">查看SQL语句的详细信息</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>在详细信息下，单击<span class="bold">计划控制</span> 。
                                 </p>
                                 <p>将出现“SQL详细信息”页面，其中显示“计划控制”子页面</p>
                              </li>
                              <li>
                                 <p>查看与计划相关的信息。</p>
                                 <p>在以下示例中，优化程序使用名为<code class="codeph">STMT01</code>的SQL计划基准作为SQL语句。
                                 </p>
                                 <div class="figure" id="GUID-5FDF9E5C-1CE6-4262-BD21-BAE7D4A5F615__GUID-9CCBC96C-A543-47C2-BCA1-0E02C9EBEA37"><img src="img/sql_details_plan_control.gif" alt="下面是sql_details_plan_control.gif的描述" title="下面是sql_details_plan_control.gif的描述" longdesc="img_text/sql_details_plan_control.html"><br><a href="img_text/sql_details_plan_control.html">插图描述sql_details_plan_control.gif</a></div>
                                 <!-- class="figure" -->
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-5FDF9E5C-1CE6-4262-BD21-BAE7D4A5F615__GUID-73300239-AD2F-4E3E-A942-D095EB92FE3E">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关SQL Tuning Advisor和SQL配置文件的信息，请<span class="q">“ <a href="tuning-sql-statements.html#GUID-6B386EC1-A58F-4CFC-AEFB-9F787A112396">调整SQL语句</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="tuning-sql-statements.html#GUID-84FE7EBB-54AB-4D11-A910-9C63B8C39441">管理SQL配置文件</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p>有关SQL Access Advisor的信息， <span class="q">“ <a href="optimizing-data-access-paths.html#GUID-1E926221-441F-483A-B045-8AE4A5764B8C">优化数据访问路径</a> ”</span></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TDPPT508"></a><div class="props_rev_3"><a id="GUID-EA069807-764B-4E0A-B5B3-63ADFE876B96" name="GUID-EA069807-764B-4E0A-B5B3-63ADFE876B96"></a><h5 id="TDPPT-GUID-EA069807-764B-4E0A-B5B3-63ADFE876B96" class="sect5"><span class="enumeration_section">11.2.2.5</span>查看调整历史记录</h5>
                     <div>
                        <div class="section">
                           <p>“SQL调整历史记录”部分显示SQL Tuning Advisor和SQL Access Advisor任务的历史记录。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-EA069807-764B-4E0A-B5B3-63ADFE876B96__GUID-5DAB588C-429D-4BD2-B81F-CCD7D5F9BCFF">要查看SQL调优历史记录：</p>
                           <ol>
                              <li>
                                 <p>访问“SQL详细信息”页面，如<span class="q">“ <a href="identifying-high-load-sql-statements.html#GUID-FDC4381B-0703-4FBF-93FC-36B9425A85C0">查看SQL语句的详细信息</a> ”中所述</span> 。
                                 </p>
                              </li>
                              <li>
                                 <p>在详细信息下，单击<span class="bold">调整历史记录</span> 。
                                 </p>
                                 <p>将出现“SQL详细信息”页面，其中显示“调整历史记录”子页面</p>
                              </li>
                              <li>
                                 <p>查看有关调整历史记录的信息。</p>
                                 <p>“SQL调整历史记录”部分显示SQL Tuning Advisor或SQL Access Advisor任务的历史记录。</p>
                                 <p>此SQL在历史时段期间的ADDM结果部分显示与SQL语句关联的ADDM结果的出现次数。</p>
                                 <p>以下示例显示SQL调优任务由用户<code class="codeph">DBA1</code>在2012年2月9日执行。
                                 </p>
                                 <div class="figure" id="GUID-EA069807-764B-4E0A-B5B3-63ADFE876B96__GUID-E53BFDE4-9D78-4FAD-93F8-966962C69E16"><img src="img/sql_details_tuning.gif" alt="下面是sql_details_tuning.gif的描述" title="下面是sql_details_tuning.gif的描述" longdesc="img_text/sql_details_tuning.html"><br><a href="img_text/sql_details_tuning.html">插图说明sql_details_tuning.gif</a></div>
                                 <!-- class="figure" -->
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-EA069807-764B-4E0A-B5B3-63ADFE876B96__GUID-97309675-1659-4C40-96A8-09FBEC4449E7">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>有关SQL Tuning Advisor和SQL配置文件的信息，请<span class="q">“ <a href="tuning-sql-statements.html#GUID-6B386EC1-A58F-4CFC-AEFB-9F787A112396">调整SQL语句</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><span class="q">“ <a href="tuning-sql-statements.html#GUID-84FE7EBB-54AB-4D11-A910-9C63B8C39441">管理SQL配置文件</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p>有关SQL Access Advisor的信息， <span class="q">“ <a href="optimizing-data-access-paths.html#GUID-1E926221-441F-483A-B045-8AE4A5764B8C">优化数据访问路径</a> ”</span></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>