<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="SQL explains the Structured Query Language (SQL) language and how the database processes SQL statements. This chapter explains how Procedural Language/SQL (PL/SQL) or Java programs stored in the database can use SQL."></meta>
      <meta name="description" content="SQL explains the Structured Query Language (SQL) language and how the database processes SQL statements. This chapter explains how Procedural Language/SQL (PL/SQL) or Java programs stored in the database can use SQL."></meta>
      <title>服务器端编程：PL / SQL和Java</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Concepts"></meta>
      <meta property="og:description" content="SQL explains the Structured Query Language (SQL) language and how the database processes SQL statements. This chapter explains how Procedural Language/SQL (PL/SQL) or Java programs stored in the database can use SQL."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Concepts"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-concepts.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T07:47:16-08:00"></meta>
      <meta name="dcterms.title" content="Database Concepts"></meta>
      <meta name="dcterms.dateCopyrighted" content="1993, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96138-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="sql.html" title="Previous" type="text/html"></link>
      <link rel="next" href="oracle-transaction-management.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CNCPT"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="sql.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="oracle-transaction-management.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库概念</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-data-access.html" property="item" typeof="WebPage"><span property="name">Oracle数据访问</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">服务器端编程：PL / SQL和Java</li>
            </ol>
            <a id="GUID-D4A154D2-DF56-45DA-863C-BED5DA6BDA34" name="GUID-D4A154D2-DF56-45DA-863C-BED5DA6BDA34"></a><a id="CNCPT036"></a>
            
            <h2 id="CNCPT-GUID-D4A154D2-DF56-45DA-863C-BED5DA6BDA34" class="sect2"><span class="enumeration_chapter">8</span>服务器端编程：PL / SQL和Java</h2>
         </header>
         <div class="ind">
            <div>
               <p><span class="bold">SQL</span>解释了结构化查询语言（SQL）语言以及数据库如何处理SQL语句。本章介绍了数据库中存储的过程语言/ SQL（PL / SQL）或Java程序如何使用SQL。</p>
               <p>本章包括以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="server-side-programming.html#GUID-6B5D98B7-A25D-4187-B3A9-43629E214635" title="在诸如SQL的非过程语言中，指定要操作的数据集，但不指定要执行的操作或它们的执行方式。">服务器端编程简介</a></p>
                  </li>
                  <li>
                     <p><a href="server-side-programming.html#GUID-1E17CED5-73C6-4C10-85F1-A2CB4D5F9855" title="PL / SQL提供了一种服务器端存储过程语言，易于使用，与SQL无缝连接，健壮，可移植且安全。您可以使用称为PL / SQL单元的过程对象来访问和操作数据库数据。">PL / SQL概述</a></p>
                  </li>
                  <li>
                     <p><a href="server-side-programming.html#GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7" title="Java已经成为面向对象编程语言的首选。">Oracle数据库中的Java概述</a></p>
                  </li>
                  <li>
                     <p><a href="server-side-programming.html#GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63" title="数据库触发器是一个编译的存储程序单元，用PL / SQL或Java编写，Oracle数据库调用（" fire=")=" ="">触发器概述</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-D4A154D2-DF56-45DA-863C-BED5DA6BDA34__GUID-E8018424-A5DC-43F5-9CFF-E7C8FD41C575">
                  <p class="notep1">也可以看看：</p>
                  <p><span class="q">“ <a href="sql.html#GUID-DA48618A-A6BB-421A-A10A-02859D8ED9AD" title="本章概述了结构化查询语言（SQL）以及Oracle数据库如何处理SQL语句。">SQL</a> ”</span>用于概述SQL语言</p>
               </div>
            </div><a id="CNCPT1758"></a><div class="props_rev_3"><a id="GUID-6B5D98B7-A25D-4187-B3A9-43629E214635" name="GUID-6B5D98B7-A25D-4187-B3A9-43629E214635"></a><h3 id="CNCPT-GUID-6B5D98B7-A25D-4187-B3A9-43629E214635" class="sect3">服务器端编程简介</h3>
               <div>
                  <p>在诸如SQL的非过程语言中，指定要操作的数据集，但不指定要执行的操作或它们的执行方式。</p>
                  <p>在过程语言程序中，大多数语句执行依赖于先前或后续语句以及SQL中不可用的控制结构（例如循环或条件分支）。为了说明过程语言和非过程语言之间的区别，假设以下SQL语句查询<code class="codeph">employees</code>表：</p><pre class="pre codeblock"><code>SELECT employee_id，department_id，last_name，salary FROM employees;</code></pre><p>前面的语句请求数据，但不对数据应用逻辑。但是，假设您希望应用程序确定数据集中的每个员工是否应根据薪资和部门绩效进行加薪。加薪的一个必要条件是员工在过去五年内没有获得超过三次加薪。如果要求加薪，则申请必须调整工资并通过电子邮件发送给经理;否则，应用程序必须更新报告。</p>
                  <p>问题是需要条件逻辑和程序流控制的过程数据库应用程序如何使用SQL。基本的开发方法如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>使用客户端编程将SQL语句嵌入用过程语言（如C，C ++或Java）编写的应用程序中</p>
                        <p>您可以将SQL语句放在源代码中，然后在编译之前将其提交给<a href="glossary.html#GUID-FDCF892E-6AD5-4AC9-9D1D-A9C7D106D21D"><span class="xrefglossterm">预编译器</span></a>或Java转换器。或者，您可以取消预编译步骤并使用API（如Java数据库连接（JDBC）或Oracle调用接口（OCI））来使应用程序与数据库交互。
                        </p>
                     </li>
                     <li>
                        <p>使用服务器端编程来开发驻留在数据库中的数据逻辑</p>
                        <p>应用程序可以显式调用用PL / SQL（发音为<span class="italic">PL sequel</span> ）或Java编写的存储子程序（过程和函数）。您还可以创建一个名为program unit的<a href="glossary.html#GUID-8BA32C58-ACF3-4B6B-941F-586DE399D22A"><span class="xrefglossterm">触发器</span></a> ，该<a href="glossary.html#GUID-8BA32C58-ACF3-4B6B-941F-586DE399D22A"><span class="xrefglossterm">触发器</span></a>存储在数据库中并响应指定的事件而调用。
                        </p>
                     </li>
                  </ul>
                  <p>本章介绍第二种方法。服务器端编程的主要好处是可以在任何地方部署内置于数据库中的功能。数据库而不是应用程序确定在给定操作系统上执行任务的最佳方式。此外，子程序通过在服务器上集中应用程序处理来增加可伸缩性，使客户端能够重用代码。由于子程序调用快速有效，因此单个调用可以启动计算密集型存储子程序，从而减少网络流量。</p>
                  <p>您可以使用以下语言在Oracle数据库中存储数据逻辑：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>PL / SQL</p>
                        <p>PL / SQL是SQL的Oracle数据库过程扩展。 PL / SQL与数据库集成，支持所有Oracle SQL语句，函数和数据类型。用数据库API编写的应用程序可以调用PL / SQL存储的子程序，并将PL / SQL代码块发送到数据库以供执行。</p>
                     </li>
                     <li>
                        <p>Java的</p>
                        <p>Oracle数据库还为开发，存储和部署Java应用程序提供支持。Java存储的子程序在数据库中运行，并且独立于在中间层中运行的程序。Java存储的子程序使用与PL / SQL类似的执行模型与SQL接口。</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-6B5D98B7-A25D-4187-B3A9-43629E214635__GUID-7663186E-29A6-4904-B7B0-7435318534A7">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-87F23274-B506-486B-8775-880016095EF5" title="您可以使用预编译器或Java转换器将SQL语句放在源代码中，也可以使用API使应用程序与数据库交互。">客户端数据库编程</a> ”</span> ，了解如何使用预编译器和API嵌入SQL</p>
                        </li>
                        <li>
                           <p><a href="../tdddg/two-day-developer-intro.html#TDDDG10000" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a> ，介绍Oracle数据库应用程序开发</p>
                        </li>
                        <li>
                           <p><a href="../adfns/application-architecture.html#ADFNS00109" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a> ，了解如何选择编程环境</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="CNCPT416"></a><div class="props_rev_3"><a id="GUID-1E17CED5-73C6-4C10-85F1-A2CB4D5F9855" name="GUID-1E17CED5-73C6-4C10-85F1-A2CB4D5F9855"></a><h3 id="CNCPT-GUID-1E17CED5-73C6-4C10-85F1-A2CB4D5F9855" class="sect3">PL / SQL概述</h3>
               <div>
                  <p>PL / SQL提供了一种服务器端存储过程语言，易于使用，与SQL无缝连接，健壮，可移植且安全。您可以使用称为<span class="italic">PL / SQL单元的</span>过程对象来访问和操作数据库数据。
                  </p>
                  <p>PL / SQL单元通常分类如下：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="glossary.html#GUID-4BF65C07-E5DD-454C-8AD0-E38EF5672CE4"><span class="xrefglossterm">PL / SQL子程序</span></a>是存储在数据库中的PL / SQL块，可以通过应用程序中的名称进行调用。创建子程序时，数据库会解析子程序并将其解析后的表示存储在数据库中。您可以将子程序声明为过程或函数。
                        </p>
                     </li>
                     <li>
                        <p><a href="glossary.html#GUID-97C2CD46-CE4D-4A23-B44D-815A1E8F0906"><span class="xrefglossterm">PL / SQL匿名块</span></a>是PL / SQL块，它出现在应用程序中，未在数据库中命名或存储。在许多应用程序中，PL / SQL块可以出现在SQL语句出现的任何位置。
                        </p>
                     </li>
                  </ul>
                  <p>PL / SQL编译器和解释器嵌入在Oracle SQL Developer中，为开发人员提供了在客户端和服务器上的一致且有利的开发模型。此外，可以从多个数据库客户端调用PL / SQL存储过程，例如Pro * C，JDBC，ODBC或OCI，以及Oracle Reports和Oracle Forms。</p>
                  <div class="infoboxnotealso" id="GUID-1E17CED5-73C6-4C10-85F1-A2CB4D5F9855__GUID-9582AD50-F0BC-40DA-9E70-09D4B64431F4">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-D1C1BC1D-03C7-4A18-BB88-0D76F311DAF0" title="Oracle提供了几种用于开发数据库应用程序的工具。本节介绍一些常用的开发工具。">数据库开发人员工具</a> ”</span></p>
                        </li>
                        <li>
                           <p>有关PL / SQL的完整信息，包括包，请参阅<a href="../lnpls/overview.html#LNPLS001" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="CNCPT1776"></a><div class="props_rev_3"><a id="GUID-7C398775-F4FB-47A2-AED5-458E00FB1E35" name="GUID-7C398775-F4FB-47A2-AED5-458E00FB1E35"></a><h4 id="CNCPT-GUID-7C398775-F4FB-47A2-AED5-458E00FB1E35" class="sect4">PL / SQL子程序</h4>
                  <div>
                     <p>PL / SQL子程序是一个命名的PL / SQL块，允许调用者提供只能输入，仅输出或输入和输出值的参数。</p>
                     <p>子程序解决特定问题或执行相关任务，并作为模块化，可维护数据库应用程序的构建块。子程序是<a href="glossary.html#GUID-D2210901-18F2-43C0-B0CC-6953E94CD7EF"><span class="xrefglossterm">PL / SQL过程</span></a>或<a href="glossary.html#GUID-1DBC272B-41F6-43A9-A894-D7E714017E2B"><span class="xrefglossterm">PL / SQL函数</span></a> 。过程和函数是相同的，除了函数总是向调用者返回单个值，而过程不返回。本章中的术语<span class="italic">PL / SQL过程</span>涉及过程或函数。
                     </p>
                     <div class="infoboxnotealso" id="GUID-7C398775-F4FB-47A2-AED5-458E00FB1E35__GUID-9FD5B2CC-EB41-4A46-9D75-A9E0DF550A82">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../lnpcb/introduction.html#GUID-2F2833F4-62F3-4FC7-8FC1-B742E44727B0" target="_blank"><span><cite>Pro * C / C ++程序员指南</cite></span></a>和<a href="../lnpcb/embedded-PLSQL.html#LNPCB006" target="_blank"><span><cite>Pro * COBOL程序员指南</cite></span></a> ，了解这些语言的存储过程</p>
                           </li>
                           <li>
                              <p><a href="../lnpls/overview.html#LNPLS174" target="_blank"><span><cite>Oracle数据库PL / SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="CNCPT1777"></a><div class="props_rev_3"><a id="GUID-BC90E680-65D8-4CD4-BCE2-A6A2FE732D59" name="GUID-BC90E680-65D8-4CD4-BCE2-A6A2FE732D59"></a><h5 id="CNCPT-GUID-BC90E680-65D8-4CD4-BCE2-A6A2FE732D59" class="sect5">PL / SQL子程序的优点</h5>
                     <div>
                        <p>与客户端编程相比，服务器端编程具有许多优势。</p>
                        <p>优点包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>改善了性能</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>与发布单个SQL语句或将整个PL / SQL块的文本发送到Oracle数据库相比，应用程序必须通过网络发送的信息量很小，因为信息只发送一次，然后在使用时调用。</p>
                                 </li>
                                 <li>
                                    <p>程序的编译形式在数据库中很容易获得，因此在执行时不需要编译。</p>
                                 </li>
                                 <li>
                                    <p>如果该过程存在于<a href="glossary.html#GUID-3F87437B-614A-472E-B691-F09D4A310DE4"><span class="xrefglossterm">SGA</span></a>的<a href="glossary.html#GUID-64AFFF3A-C836-44F9-A25C-86CE4B9B16A8"><span class="xrefglossterm">共享池中</span></a> ，则数据库无需从磁盘检索它并可立即开始执行。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>内存分配</p>
                              <p>由于存储过程利用了Oracle数据库的共享内存功能，因此它必须只将一个过程副本加载到内存中，以供多个用户执行。在用户之间共享代码导致应用程序的数据库内存需求大幅减少。</p>
                           </li>
                           <li>
                              <p>提高生产力</p>
                              <p>存储过程可提高开发效率。通过围绕一组通用过程设计应用程序，可以避免冗余编码。例如，您可以编写过程来操作<code class="codeph">employees</code>表中的行。任何应用程序都可以调用这些过程，而无需重写SQL语句。如果数据管理方法发生变化，则只需修改过程，而不是使用过程的应用程序。
                              </p>
                              <p>存储过程可能是实现代码重用的最佳方法。因为用连接到数据库的任何语言编写的任何客户端应用程序都可以调用存储过程，所以它们在所有环境中提供最大的代码重用。</p>
                           </li>
                           <li>
                              <p>廉正</p>
                              <p>存储过程可提高应用程序的完整性和一致性。通过围绕一组通用程序开发应用程序，可以降低编码错误的可能性。</p>
                              <p>例如，您可以测试子程序以确保它返回准确的结果，并在验证后，在任何数量的应用程序中重复使用它而无需重新测试。如果更改了过程引用的数据结构，则只能重新编译该过程。调用该过程的应用程序不一定需要修改。</p>
                           </li>
                           <li>
                              <p>具有定义者权利程序的安全性</p>
                              <p>存储过程可以帮助实施数据安全性。<a href="glossary.html#GUID-743039B9-002B-48D5-AE43-001BCDBEAA3E"><span class="xrefglossterm">定义者权限PL / SQL过程</span></a>以其所有者的<a href="glossary.html#GUID-197053D8-1AA8-4B0F-BEE1-8C8AD2DBD0C6"><span class="xrefglossterm">权限</span></a>执行，而不是其当前用户。因此，您可以通过允许用户仅通过使用定义者权限运行的过程和函数来访问数据来限制用户执行的数据库任务。
                              </p>
                              <p>例如，您可以授予用户访问更新表但不授予对表本身的访问权限的过程的权限。当用户调用该过程时，它将以其所有者的权限运行。仅具有运行该过程的权限（但不具有从基础表进行查询，更新或删除的权限）的用户可以调用该过程，但不能以任何其他方式操作表数据。</p>
                           </li>
                           <li>
                              <p>具有调用者权限过程的继承权限和模式上下文</p>
                              <p><a href="glossary.html#GUID-25256D39-4B45-410E-8CEA-2463E6934152"><span class="xrefglossterm">调用者权限PL / SQL过程</span></a>在当前用户的模式中使用当前用户的权限执行。换句话说，调用者的权限过程不依赖于特定的用户或模式。即使底层数据在用户模式之间划分，Invoker的权限过程也使应用程序开发人员可以轻松集中应用程序逻辑。
                              </p>
                              <p>例如，在<code class="codeph">hr.employees</code>表上运行更新过程的<code class="codeph">hr_manager</code>用户可以更新工资，而运行相同过程的<code class="codeph">hr_clerk</code>仅限于更新地址数据。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-BC90E680-65D8-4CD4-BCE2-A6A2FE732D59__GUID-4D946D74-A5A8-4FB2-86E1-A824B1EAB4B5">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="topics-for-database-administrators-and-developers.html#GUID-4D6D2B67-1B65-476D-852A-976E9D153EEC" title="通常，数据库安全性涉及用户身份验证，加密，访问控制和监视。">数据库安全概述</a> ”</span></p>
                              </li>
                              <li>
                                 <p>有关PL / SQL子程序概述的<a href="../lnpls/plsql-subprograms.html#LNPLS008" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a></p>
                              </li>
                              <li>
                                 <p><a href="../dbseg/configuring-privilege-and-role-authorization.html#DBSEG50010" target="_blank"><span><cite>Oracle数据库安全指南</cite></span></a> ，了解有关定义者和调用者权利的更多信息</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CNCPT88932"></a><a id="CNCPT88931"></a><div class="props_rev_3"><a id="GUID-07E0EC3E-2629-4673-9762-202B8074CB52" name="GUID-07E0EC3E-2629-4673-9762-202B8074CB52"></a><h5 id="CNCPT-GUID-07E0EC3E-2629-4673-9762-202B8074CB52" class="sect5">创建PL / SQL子程序</h5>
                     <div>
                        <p>独立存储的子程序是在模式级别使用<code class="codeph">CREATE PROCEDURE</code>或<code class="codeph">CREATE FUNCTION</code>语句创建的子程序。程序包中定义的<span class="bold">子程序</span>称为<span class="bold">程序包子程序，</span>并被视为程序包的一部分。
                        </p>
                        <p>数据库将子程序存储在数据字典中作为模式对象。子程序具有规范，其包括任何参数的描述和主体。</p>
                        <div class="example" id="GUID-07E0EC3E-2629-4673-9762-202B8074CB52__BABIAJHG">
                           <p class="titleinexample">例8-1 PL / SQL过程</p>此示例显示了独立PL / SQL过程<code class="codeph">hire_employees</code>的创建语句的一部分。该过程在<code class="codeph">employees</code>表中插入一行。<pre class="pre codeblock"><code>CREATE PROCEDURE hire_employees（p_last_name VARCHAR2，p_job_id VARCHAR2，p_manager_id NUMBER，p_hire_date DATE，p_salary NUMBER，p_commission_pct NUMBER，p_department_id NUMBER）已开始。。。INSERT INTO员工（employee_id，last_name，job_id，manager_id，hire_date，salary，commission_pct，department_id）VALUES（emp_sequence。NEXTVAL，p_last_name，p_job_id，p_manager_id，p_hire_date，p_salary，p_commission_pct，p_department_id）; 。。。结束;</code></pre><div class="infoboxnotealso" id="GUID-07E0EC3E-2629-4673-9762-202B8074CB52__GUID-631AA004-1EFF-4F80-9559-6B808C3C5337">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><a href="../tdddg/stored-subprograms-packages.html#TDDDG41000" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a> ，了解如何创建子程序</p>
                                 </li>
                                 <li>
                                    <p><a href="../lnpls/CREATE-PROCEDURE-statement.html#LNPLS01373" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解<code class="codeph">CREATE PROCEDURE</code>语句</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="CNCPT88934"></a><a id="CNCPT88933"></a><div class="props_rev_3"><a id="GUID-E94C8618-0464-45DA-AA90-07BA9EB4458C" name="GUID-E94C8618-0464-45DA-AA90-07BA9EB4458C"></a><h5 id="CNCPT-GUID-E94C8618-0464-45DA-AA90-07BA9EB4458C" class="sect5">执行PL / SQL子程序</h5>
                     <div>
                        <p>用户可以以多种方式以交互方式执行子程序。</p>
                        <p>选项是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用Oracle工具，例如SQL * Plus或SQL Developer</p>
                           </li>
                           <li>
                              <p>在数据库应用程序的代码中显式调用它，例如Oracle Forms或预编译器应用程序</p>
                           </li>
                           <li>
                              <p>在另一个过程或触发器的代码中显式调用它</p>
                           </li>
                        </ul>
                        <p>下图显示了调用<code class="codeph">hire_employees</code>不同数据库应用程序。
                        </p>
                        <div class="figure" id="GUID-E94C8618-0464-45DA-AA90-07BA9EB4458C__FIG-124-16F280AE">
                           <p class="titleinfigure">图8-1存储过程的多次执行</p><img src="img/cncpt073.gif" alt="下面是图8-1的描述" title="下面是图8-1的描述" longdesc="img_text/cncpt073.html"><br><a href="img_text/cncpt073.html">“图8-1存储过程的多次执行”的描述</a></div>
                        <!-- class="figure" -->
                        <p>或者，特权用户可以使用Oracle Enterprise Manager或SQL * Plus运行<code class="codeph">hire_employees</code>过程，使用如下语句：</p><pre class="pre codeblock"><code>执行hire_employees（'TSMITH'，'CLERK'，1037，SYSDATE，500，NULL，20）;</code></pre><p>上述语句在<code class="codeph">employees</code>表中插入<code class="codeph">TSMITH</code>的新记录。
                        </p>
                        <p>存储过程取决于其正文中引用的对象。数据库自动跟踪和管理这些依赖项。例如，如果以一种会影响此过程的方式更改<code class="codeph">hire_employees</code>过程引用的<code class="codeph">employees</code>表的定义，则必须重新编译该过程以验证它是否仍按设计工作。通常，数据库会自动管理此类依赖关系管理。
                        </p>
                        <div class="infoboxnotealso" id="GUID-E94C8618-0464-45DA-AA90-07BA9EB4458C__GUID-FFA83CB7-EAD2-4F20-8084-56F8E7F995B1">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-D1C1BC1D-03C7-4A18-BB88-0D76F311DAF0" title="Oracle提供了几种用于开发数据库应用程序的工具。本节介绍一些常用的开发工具。">用于数据库开发人员的工具</a> ”</span>以了解有关SQL * Plus和SQL Developer的更多信息</p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-87F23274-B506-486B-8775-880016095EF5" title="您可以使用预编译器或Java转换器将SQL语句放在源代码中，也可以使用API使应用程序与数据库交互。">客户端数据库编程</a> ”</span>以了解有关预编译器的更多信息</p>
                              </li>
                              <li>
                                 <p><a href="../lnpls/plsql-subprograms.html#LNPLS008" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解如何使用PL / SQL子程序</p>
                              </li>
                              <li>
                                 <p><a href="../sqpug/EXECUTE.html#SQPUG043" target="_blank"><span><cite>SQL * Plus用户指南和参考</cite></span></a>了解<code class="codeph">EXECUTE</code>命令</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1784"></a><div class="props_rev_3"><a id="GUID-87FA8137-A449-4542-8869-441C63810C63" name="GUID-87FA8137-A449-4542-8869-441C63810C63"></a><h4 id="CNCPT-GUID-87FA8137-A449-4542-8869-441C63810C63" class="sect4">PL / SQL包</h4>
                  <div>
                     <p><span class="bold">PL / SQL包</span>是一组相关的子程序，以及它们使用的游标和变量，它们一起存储在数据库中以便作为一个单元继续使用。应用程序或用户可以显式调用打包的子程序。
                     </p>
                     <p>Oracle数据库包括许多提供的包，这些包扩展了数据库功能并提供对SQL功能的PL / SQL访问。例如， <code class="codeph">UTL_HTTP</code>包允许来自PL / SQL和SQL的HTTP标注访问Internet上的数据或调用Oracle Web Server Cartridges。您可以在创建应用程序时使用提供的包，也可以在创建自己的存储过程时使用提供的包。
                     </p>
                  </div><a id="CNCPT1785"></a><div class="props_rev_3"><a id="GUID-C7F00F30-5D7F-47F2-856F-CEE8E6465820" name="GUID-C7F00F30-5D7F-47F2-856F-CEE8E6465820"></a><h5 id="CNCPT-GUID-C7F00F30-5D7F-47F2-856F-CEE8E6465820" class="sect5">PL / SQL包的优点</h5>
                     <div>
                        <p>PL / SQL包为应用程序开发人员提供了许多优势。</p>
                        <p>优点包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>封装</p>
                              <p>通过包，您可以在命名的存储单元中封装或分组存储过程，变量，数据类型等。封装在开发过程中提供了更好的组织，并且更具灵活性。您可以创建规范和引用公共过程，而无需实际创建包体。封装简化了权限管理。授予包的权限使得包构造可供被授权者访问。</p>
                           </li>
                           <li>
                              <p>数据安全</p>
                              <p>包定义方法使您可以指定哪些变量，游标和过程是公共的和私有的。公共意味着包可以直接访问它。私有意味着它对包的用户是隐藏的。</p>
                              <p>例如，一个包可以包含10个过程。您可以定义包，以便只有三个过程是公共的，因此可供包的用户执行。其余过程是私有的，只能通过包中的过程访问。不要将公共和私有包变量与<code class="codeph">PUBLIC</code>授权混淆。</p>
                           </li>
                           <li>
                              <p>更好的性能</p>
                              <p>当第一次调用包中的过程时，整个包以小块的形式加载到内存中。此负载在一次操作中完成，而不是独立过程所需的单独负载。当调用相关的打包过程时，不需要磁盘I / O来在内存中运行已编译的代码。</p>
                              <p>可以更换和重新编译封装体，而不会影响规格。因此，除非还替换了包规范，否则无需重新编译引用包的构造（始终通过规范）的模式对象。通过使用包，可以最小化不必要的重新编译，从而减少对整体数据库性能的影响。</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="CNCPT88936"></a><a id="CNCPT88935"></a><div class="props_rev_3"><a id="GUID-1CB910EF-09B4-43FD-AEC5-7450296AC58C" name="GUID-1CB910EF-09B4-43FD-AEC5-7450296AC58C"></a><h5 id="CNCPT-GUID-1CB910EF-09B4-43FD-AEC5-7450296AC58C" class="sect5">创建PL / SQL包</h5>
                     <div>
                        <p>您可以分为两部分创建包：规范和正文。包规范声明了包的所有公共构造，而包体定义了包的所有构造（公共和私有）。</p>
                        <p>以下示例显示了为<code class="codeph">employees_management</code>创建包规范的语句的一部分，该声明封装了用于管理员工数据库的多个子程序。包的每个部分都使用不同的语句创建。
                        </p><pre class="pre codeblock"><code>CREATE PACKAGE employees_management AS FUNCTION hire_employees（last_name VARCHAR2，job_id VARCHAR2，manager_id NUMBER，salary NUMBER，commission_pct NUMBER，department_id NUMBER）返回号码;程序fire_employees（employee_id NUMBER）; PROCEDURE salary_raise（employee_id NUMBER，salary_incr NUMBER）; 。。。no_sal EXCEPTION; END employees_management;</code></pre><p>规范声明函数<code class="codeph">hire_employees</code> ，过程<code class="codeph">fire_employees</code>和<code class="codeph">salary_raise</code> ，以及异常<code class="codeph">no_sal</code> 。所有这些公共程序对象都可供有权访问该程序包的用户使用。
                        </p>
                        <p><code class="codeph">CREATE PACKAGE BODY</code>语句定义规范中声明的对象。必须在与包相同的模式中创建包体。创建程序包后，您可以开发调用任何这些公共过程或函数的应用程序，或者引发程序包的任何公共异常。
                        </p>
                        <div class="infoboxnotealso" id="GUID-1CB910EF-09B4-43FD-AEC5-7450296AC58C__GUID-0E9E3A46-FE7F-4067-B814-DCEBD37F6E15">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../lnpls/CREATE-PACKAGE-statement.html#LNPLS01371" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解<code class="codeph">CREATE PACKAGE</code>语句</p>
                        </div>
                     </div>
                  </div><a id="CNCPT88938"></a><a id="CNCPT88937"></a><div class="props_rev_3"><a id="GUID-82299071-97A1-47B6-A0AB-202F65F3F865" name="GUID-82299071-97A1-47B6-A0AB-202F65F3F865"></a><h5 id="CNCPT-GUID-82299071-97A1-47B6-A0AB-202F65F3F865" class="sect5">执行PL / SQL包子程序</h5>
                     <div>
                        <p>数据库触发器，存储的子程序，3GL应用程序和Oracle工具可以引用包内容。</p>
                        <p>下图显示了调用<code class="codeph">employees_management</code>包中的过程和函数的数据库应用程序。
                        </p>
                        <div class="figure" id="GUID-82299071-97A1-47B6-A0AB-202F65F3F865__I18841">
                           <p class="titleinfigure">图8-2在PL / SQL包中调用子程序</p><img src="img/cncpt075.gif" width="595" alt="下面是图8-2的描述" title="下面是图8-2的描述" longdesc="img_text/cncpt075.html"><br><a href="img_text/cncpt075.html">“图8-2调用PL / SQL包中的子程序”的描述</a></div>
                        <!-- class="figure" -->
                        <p>数据库应用程序显式调用打包过程。在被授予<code class="codeph">employees_management</code>包的权限后，用户可以显式运行其中包含的任何过程。例如，SQL * Plus可以发出以下语句来运行<code class="codeph">hire_employees</code>包过程：</p><pre class="pre codeblock"><code>执行employees_management.hire_employees（'TSMITH'，'CLERK'，1037，SYSDATE，500，NULL，20）;</code></pre><div class="infoboxnotealso" id="GUID-82299071-97A1-47B6-A0AB-202F65F3F865__GUID-4EB5C854-FCD7-4E1E-8937-02E52D926F6C">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="../lnpls/plsql-packages.html#LNPLS009" target="_blank"><span><cite>Oracle Database PL / SQL语言参考，</cite></span></a>用于介绍PL / SQL包</p>
                              </li>
                              <li>
                                 <p><a href="../adfns/coding-subprograms-and-packages.html#ADFNS009" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a> ，了解如何编写PL / SQL包</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT88939"></a><a id="CNCPT1779"></a><div class="props_rev_3"><a id="GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA" name="GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA"></a><h4 id="CNCPT-GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA" class="sect4">PL / SQL匿名块</h4>
                  <div>
                     <p>PL / SQL匿名块是未命名的非持久PL / SQL单元。</p>
                     <p>匿名块的典型用途包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>启动对子程序和包构造的调用</p>
                        </li>
                        <li>
                           <p>隔离异常处理</p>
                        </li>
                        <li>
                           <p>通过在其他PL / SQL块中嵌套代码来管理控制</p>
                        </li>
                     </ul>
                     <p>匿名块没有存储子程序的代码重用优势。<a href="server-side-programming.html#GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA__CHDJGEBD" title="此表总结了匿名块和子程序之间的差异。">表8-1</a>总结了两种类型的PL / SQL单元之间的差异。
                     </p>
                     <div class="tblformal" id="GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA__CHDJGEBD">
                        <p class="titleintable">表8-1匿名块和子程序之间的差异</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="匿名块和子程序之间的差异" width="100%" border="1" summary="This table summarizes the differences between anonymous blocks and subprograms." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="40%" id="d40402e3948">是PL / SQL单元......</th>
                                 <th align="left" valign="bottom" width="30%" id="d40402e3951">匿名块</th>
                                 <th align="left" valign="bottom" width="30%" id="d40402e3954">子程序</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e3959" headers="d40402e3948 ">
                                    <p>用名字指定？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3959 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3959 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e3969" headers="d40402e3948 ">
                                    <p>编译每次重用？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3969 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3969 d40402e3954 ">
                                    <p>没有</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e3979" headers="d40402e3948 ">
                                    <p>存储在数据库中？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3979 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3979 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e3989" headers="d40402e3948 ">
                                    <p>其他应用程序是否可以调用？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3989 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3989 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e3999" headers="d40402e3948 ">
                                    <p>能够返回绑定变量值吗？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3999 d40402e3951 ">
                                    <p>是</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e3999 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e4009" headers="d40402e3948 ">
                                    <p>能够返回功能值吗？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e4009 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e4009 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="40%" id="d40402e4019" headers="d40402e3948 ">
                                    <p>能够接受参数吗？</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e4019 d40402e3951 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d40402e4019 d40402e3954 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>匿名块由可选的声明部分，可执行部分和一个或多个可选的异常处理程序组成。以下示例匿名块将员工姓氏选择到变量中并输出名称：</p><pre class="pre codeblock"><code>DECLARE v_lname VARCHAR2（25）; BEGIN SELECT last_name INTO v_lname FROM employees WHERE employee_id = 101; DBMS_OUTPUT.PUT_LINE（'员工姓氏为'|| v_lname）;结束;</code></pre><p>Oracle数据库编译PL / SQL块并将其放在SGA的共享池中，但它不会将源代码或编译版本存储在数据库中，以便在当前实例之外重用。与触发器不同，每次将匿名块加载到内存时都会编译它。共享SQL允许重用和共享共享池中的匿名PL / SQL块，直到它们从共享池中刷新。</p>
                     <div class="infoboxnotealso" id="GUID-76EA9A76-8D25-4FF5-A6D1-4F358B0651AA__GUID-4D91FDC9-6046-4771-AC6B-BC9324CDA94B">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../adfns/coding-subprograms-and-packages.html#ADFNS311" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a> ，了解有关匿名PL / SQL块的更多信息</p>
                     </div>
                  </div>
               </div><a id="CNCPT1770"></a><div class="props_rev_3"><a id="GUID-0C8B57A4-9717-4E9A-8401-D817E2F0A308" name="GUID-0C8B57A4-9717-4E9A-8401-D817E2F0A308"></a><h4 id="CNCPT-GUID-0C8B57A4-9717-4E9A-8401-D817E2F0A308" class="sect4">PL / SQL语言构造</h4>
                  <div>
                     <p>PL / SQL块可以包括各种不同的PL / SQL语言结构。</p>
                     <p>这些结构包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>变量和常量</p>
                           <p>您可以在过程，函数或包中声明这些构造。您可以在SQL或PL / SQL语句中使用变量或常量来捕获或在需要时提供值。</p>
                        </li>
                        <li>
                           <p>游标</p>
                           <p>您可以在过程，函数或包中显式声明<a href="glossary.html#GUID-D1D3E8DD-CD5C-4C0D-93E4-DE0BF0BD53A3"><span class="xrefglossterm">游标</span></a> ，以促进面向记录的Oracle数据库数据处理。PL / SQL引擎也可以隐式声明游标。
                           </p>
                        </li>
                        <li>
                           <p>例外</p>
                           <p>PL / SQL允许您显式处理在处理PL / SQL代码期间出现的内部和用户定义的错误条件，称为<span class="italic">异常</span> 。
                           </p>
                        </li>
                     </ul>
                     <p>PL / SQL可以运行<a href="glossary.html#GUID-4962BC92-A7FC-471D-BE50-4650A791E3E7"><span class="xrefglossterm">动态SQL</span></a>语句，直到运行时才能知道其完整文本。动态SQL语句存储在运行时由程序输入或构建的字符串中。此技术使您可以创建通用过程。例如，您可以创建一个对运行时名称未知的表进行操作的过程。
                     </p>
                     <div class="infoboxnotealso" id="GUID-0C8B57A4-9717-4E9A-8401-D817E2F0A308__GUID-0E7BF886-54C0-4F4C-A75A-F1AE955DDDA0">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关动态SQL的详细信息，请<a href="../lnpls/dynamic-sql.html#LNPLS011" target="_blank"><span><cite>参见Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_SQL.html#ARPLS058" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a> ，了解如何在<code class="codeph">DBMS_SQL</code>包中使用动态SQL</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT1786"></a><div class="props_rev_3"><a id="GUID-BE22C508-16F7-4D82-B7DE-DA10D9210F78" name="GUID-BE22C508-16F7-4D82-B7DE-DA10D9210F78"></a><h4 id="CNCPT-GUID-BE22C508-16F7-4D82-B7DE-DA10D9210F78" class="sect4">PL / SQL集合和记录</h4>
                  <div>
                     <p>许多编程技术使用集合类型，例如数组，包，列表，嵌套表，集合和树。</p>
                     <p>为了支持数据库应用程序中的收集技术，PL / SQL提供了数据类型<code class="codeph">TABLE</code>和<code class="codeph">VARRAY</code> 。这些类型使您能够声明关联数组，嵌套表和可变大小数组。
                     </p>
                  </div><a id="CNCPT1787"></a><div class="props_rev_3"><a id="GUID-9E35FAD6-6C27-479B-AC42-0A1B83E66882" name="GUID-9E35FAD6-6C27-479B-AC42-0A1B83E66882"></a><h5 id="CNCPT-GUID-9E35FAD6-6C27-479B-AC42-0A1B83E66882" class="sect5">集合</h5>
                     <div>
                        <p><span class="bold">PL / SQL集合</span>是一组有序的元素，它们都是相同的类型。
                        </p>
                        <p>每个元素都有一个唯一的下标，用于确定其在集合中的位置。要创建集合，首先要定义集合类型，然后声明该类型的变量。</p>
                        <p>集合的工作方式与大多数第三代编程语言中的数组类似。此外，集合可以作为参数传递。因此，您可以使用它们将数据列移入和移出数据库表，或者移动到客户端应用程序和存储的子程序之间。</p>
                     </div>
                  </div><a id="CNCPT1788"></a><div class="props_rev_3"><a id="GUID-689D64D1-5BAA-437B-847D-16B6D09AB032" name="GUID-689D64D1-5BAA-437B-847D-16B6D09AB032"></a><h5 id="CNCPT-GUID-689D64D1-5BAA-437B-847D-16B6D09AB032" class="sect5">记录</h5>
                     <div>
                        <p><span class="bold">PL / SQL记录</span>是一个复合变量，可以存储不同类型的数据值，类似于C，C ++或Java中的结构类型。记录对于保存表行或表行中的某些列的数据非常有用。
                        </p>
                        <p>假设您有关于员工的数据，例如姓名，工资和雇用日期。这些项目的类型不同但在逻辑上相关。包含每个项目字段的记录允许您将数据视为逻辑单元。</p>
                        <p>您可以使用<code class="codeph">%ROWTYPE</code>属性声明一条记录，该记录表示从游标中获取的表行或行。使用用户定义的记录，您可以声明自己的字段。
                        </p>
                        <div class="infoboxnotealso" id="GUID-689D64D1-5BAA-437B-847D-16B6D09AB032__GUID-12732388-5988-4909-A43F-B02041E68410">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../lnpls/plsql-collections-and-records.html#LNPLS005" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解如何使用PL / SQL记录</p>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT88940"></a><a id="CNCPT1767"></a><div class="props_rev_3"><a id="GUID-D8D5CA8C-4D62-4EEF-B891-6D9C3CFA3D3F" name="GUID-D8D5CA8C-4D62-4EEF-B891-6D9C3CFA3D3F"></a><h4 id="CNCPT-GUID-D8D5CA8C-4D62-4EEF-B891-6D9C3CFA3D3F" class="sect4">PL / SQL如何运行</h4>
                  <div>
                     <p>PL / SQL支持解释执行和本机执行。</p>
                     <p>在解释执行中，PL / SQL源代码被编译成所谓的字节码表示。作为Oracle数据库的一部分实现的可移植虚拟计算机运行此字节码。</p>
                     <p>本机执行在计算密集型单元上提供最佳性能。在这种情况下，PL / SQL单元的源代码直接编译为给定平台的目标代码。此目标代码链接到Oracle数据库。</p>
                     <p><a href="glossary.html#GUID-DA886C43-D6F7-41D4-9CD8-63770DA864B1"><span class="xrefglossterm">PL / SQL引擎</span></a>定义，编译和运行PL / SQL单元。该引擎是许多Oracle产品的特殊组件，包括Oracle数据库。虽然许多Oracle产品都有PL / SQL组件，但本主题专门介绍了可以存储在Oracle数据库中并使用Oracle Database PL / SQL引擎进行处理的PL / SQL单元。每个Oracle工具的文档都描述了其PL / SQL功能。
                     </p>
                     <p>下图说明了Oracle数据库中包含的PL / SQL引擎。</p>
                     <div class="figure" id="GUID-D8D5CA8C-4D62-4EEF-B891-6D9C3CFA3D3F__BABFIHDH">
                        <p class="titleinfigure">图8-3 PL / SQL引擎和Oracle数据库</p><img src="img/cncpt070.gif" alt="下面是图8-3的描述" title="下面是图8-3的描述" longdesc="img_text/cncpt070.html"><br><a href="img_text/cncpt070.html">“图8-3 PL / SQL引擎和Oracle数据库”的描述</a></div>
                     <!-- class="figure" -->
                     <p>PL / SQL单元存储在数据库中。当应用程序调用存储过程时，数据库会将已编译的PL / SQL单元加载到<a href="glossary.html#GUID-78C0E867-233A-4857-B9FE-A3852A9B7BDF"><span class="xrefglossterm">系统全局区域（SGA）中</span></a>的<a href="glossary.html#GUID-64AFFF3A-C836-44F9-A25C-86CE4B9B16A8"><span class="xrefglossterm">共享池中</span></a> 。PL / SQL和SQL语句执行程序一起处理过程中的语句。
                     </p>
                     <p>您可以从另一个PL / SQL块调用存储过程，该块可以是匿名块或另一个存储过程。例如，您可以从Oracle Forms调用存储过程。</p>
                     <p>在Oracle数据库上执行的PL / SQL过程可以调用以C编程语言编写并存储在共享库中的外部过程或函数。C例程在与Oracle数据库不同的地址空间中运行。</p>
                     <div class="infoboxnotealso" id="GUID-D8D5CA8C-4D62-4EEF-B891-6D9C3CFA3D3F__GUID-0F2F1705-348A-4E0B-B0CA-7B05837E163D">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="memory-architecture.html#GUID-1CB2BA23-4386-46DA-9146-5FE0E4599AC6" title="共享池缓存各种类型的程序数据。">共享池</a> ”</span>以了解有关共享池的用途和内容的更多信息</p>
                           </li>
                           <li>
                              <p><a href="../lnpls/overview.html#LNPLS00103" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解PL / SQL体系结构</p>
                           </li>
                           <li>
                              <p><a href="../adfns/external-procedures.html#ADFNS1402" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a>了解有关外部过程的更多信息</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT88941"></a><a id="CNCPT616"></a><div class="props_rev_3"><a id="GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7" name="GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7"></a><h3 id="CNCPT-GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7" class="sect3">Oracle数据库中的Java概述</h3>
               <div>
                  <p>Java已经成为面向对象编程语言的首选。</p>
                  <p>Java包括以下功能：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>Java虚拟机（JVM），它提供了平台独立性的基础</p>
                     </li>
                     <li>
                        <p>自动存储管理技术，例如垃圾收集</p>
                     </li>
                     <li>
                        <p>借用C语言并强制执行强类型的语言语法</p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7__GUID-00A7F2DE-530D-48A2-97CF-D1459D4ED5FE">
                     <p class="notep1">注意：</p>
                     <p>本章假定您对Java语言有一定的了解。</p>
                  </div>
                  <p>该数据库为Java程序提供了动态数据处理引擎，该引擎支持复杂查询和多个数据视图。客户端请求被组合为数据查询以便立即处理。查询结果是动态生成的。</p>
                  <p>Java和Oracle数据库的结合可帮助您创建基于组件的，以网络为中心的应用程序，这些应用程序可随业务需求的变化而轻松更新。此外，您还可以将应用程序和数据存储从桌面移到智能网络和以网络为中心的服务器上。更重要的是，您可以从任何客户端设备访问这些应用程序和数据存储。</p>
                  <p>下图显示了传统的双层客户端/服务器配置，其中客户端调用Java存储过程的方式与调用PL / SQL子程序的方式相同。</p>
                  <div class="figure" id="GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7__BABECJGF">
                     <p class="titleinfigure">图8-4双层客户/服务器配置</p><img src="img/cncpt236.gif" alt="下面是图8-4的描述" title="下面是图8-4的描述" longdesc="img_text/cncpt236.html"><br><a href="img_text/cncpt236.html">“图8-4双层客户/服务器配置”的描述</a></div>
                  <!-- class="figure" -->
                  <div class="infoboxnotealso" id="GUID-DDFED855-D1F3-4AB2-8FD3-B2A1B3C922D7__GUID-2B7609D1-BFA5-432A-AEAE-012F03A1C1A4">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../tdpjd/using-java-with-oracle-database.html#TDPJD101" target="_blank"><span><cite>Oracle数据库2天+ Java开发人员指南</cite></span></a> ，介绍如何将Java与Oracle数据库结合使用</p>
                  </div>
               </div><a id="CNCPT1797"></a><div class="props_rev_3"><a id="GUID-F754E0BC-5C62-4D65-91BD-96314493EB2F" name="GUID-F754E0BC-5C62-4D65-91BD-96314493EB2F"></a><h4 id="CNCPT-GUID-F754E0BC-5C62-4D65-91BD-96314493EB2F" class="sect4">Java虚拟机（JVM）概述</h4>
                  <div>
                     <p><span class="bold">JVM</span>是运行已编译Java代码的虚拟处理器。
                     </p>
                     <p>Java源代码编译为与平台无关的低级机器指令（称为<span class="italic">字节码）</span> 。Java字节码通过JVM解释为依赖于平台的操作。
                     </p>
                  </div><a id="CNCPT88942"></a><a id="CNCPT820"></a><div class="props_rev_3"><a id="GUID-ACAF8922-A3D5-4260-9935-9D92BBA578A5" name="GUID-ACAF8922-A3D5-4260-9935-9D92BBA578A5"></a><h5 id="CNCPT-GUID-ACAF8922-A3D5-4260-9935-9D92BBA578A5" class="sect5">Oracle JVM概述</h5>
                     <div>
                        <p><span class="bold">Oracle JVM</span>是一个标准的，Java兼容的环境，可以运行任何纯Java应用程序。它与JLS和JVM规范兼容。
                        </p>
                        <p>Oracle JVM支持标准Java二进制格式和API。此外，Oracle数据库遵循标准Java语言语义，包括运行时的动态类加载。</p>
                        <p>下图说明了Oracle Java应用程序如何驻留在Java核心类库之上，Java核心类库位于Oracle JVM之上。由于Oracle Java支持系统位于数据库中，因此JVM与数据库库交互，而不是直接与操作系统交互。</p>
                        <div class="figure" id="GUID-ACAF8922-A3D5-4260-9935-9D92BBA578A5__I21492">
                           <p class="titleinfigure">图8-5 Java组件结构</p><img src="img/cncpt206.gif" alt="下面是图8-5的描述" title="下面是图8-5的描述" longdesc="img_text/cncpt206.html"><br><a href="img_text/cncpt206.html">“图8-5 Java组件结构”的描述</a></div>
                        <!-- class="figure" -->
                        <p>与其他Java环境不同，Oracle JVM嵌入在Oracle数据库中。Oracle JVM与典型客户端JVM之间存在一些重要差异。例如，在标准Java环境中，通过在命令行上发出以下命令，通过解释器运行Java应用程序，其中<span class="italic"><code class="codeph">classname</code></span>是JVM首先解释的类的名称：</p><pre class="pre codeblock"><code>java <span class="italic">classname</span>
</code></pre><p>上述命令使应用程序在操作系统上的进程内运行。但是，如果未使用命令行界面，则必须将应用程序加载到数据库中，发布接口，然后在数据库<a href="glossary.html#GUID-D6A3934F-BA6D-464F-9612-C683E20514A4"><span class="xrefglossterm">数据字典中</span></a>运行该应用程序。
                        </p>
                        <div class="infoboxnotealso" id="GUID-ACAF8922-A3D5-4260-9935-9D92BBA578A5__GUID-F0C5092E-A66C-4525-9A50-6A54586DB228">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<a href="../jjdev/Oracle-JVM-overview.html#JJDEV01300" target="_blank"><span><cite>Oracle</cite></span></a> JVM与典型客户端JVM之间的其他差异的说明，请参阅<a href="../jjdev/Oracle-JVM-overview.html#JJDEV01300" target="_blank"><span><cite>Oracle数据库Java开发人员指南</cite></span></a></p>
                        </div>
                     </div>
                  </div><a id="CNCPT88943"></a><a id="CNCPT821"></a><div class="props_rev_3"><a id="GUID-50C3A528-351E-4DF4-9C76-1EB238973120" name="GUID-50C3A528-351E-4DF4-9C76-1EB238973120"></a><h5 id="CNCPT-GUID-50C3A528-351E-4DF4-9C76-1EB238973120" class="sect5">Oracle JVM的主要组件</h5>
                     <div>
                        <p>Oracle JVM通过共享其内存堆并直接访问其关系数据，在与数据库内核相同的进程空间和地址空间中运行。此设计可优化内存使用并提高吞吐量。</p>
                        <p>Oracle JVM为Java对象提供运行时环境。它完全支持Java数据结构，方法分派，异常处理和语言级线程。它还支持所有核心Java类库，包括<code class="codeph">java.lang</code> ， <code class="codeph">java.io</code> ， <code class="codeph">java.net</code> ， <code class="codeph">java.math</code>和<code class="codeph">java.util</code> 。
                        </p>
                        <p>下图显示了Oracle JVM的主要组件。</p>
                        <div class="figure" id="GUID-50C3A528-351E-4DF4-9C76-1EB238973120__BABJJHIA">
                           <p class="titleinfigure">图8-6 Oracle JVM的主要组件</p><img src="img/cncpt254.gif" width="429" alt="下面是图8-6的描述" title="下面是图8-6的描述" longdesc="img_text/cncpt254.html"><br><a href="img_text/cncpt254.html">“图8-6 Oracle JVM的主要组件”的描述</a></div>
                        <!-- class="figure" -->
                        <p>Oracle JVM将标准Java命名空间嵌入数据库模式中。此功能允许Java程序访问整个企业中存储在Oracle数据库和应用程序服务器中的Java对象。</p>
                        <p>此外，Oracle JVM与数据库的可扩展共享内存架构紧密集成。Java程序在没有用户干预的情况下有效地使用调用，会话和对象生存期。因此，Oracle JVM和中间层Java业务对象可以扩展，即使它们具有会话长状态。</p>
                        <div class="infoboxnotealso" id="GUID-50C3A528-351E-4DF4-9C76-1EB238973120__GUID-2036FC3C-F815-41C9-AD61-3718EE6454B5">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../jjdev/Oracle-JVM-overview.html#JJDEV01300" target="_blank"><span><cite>Oracle数据库Java开发人员指南，</cite></span></a>用于描述Oracle JVM的主要组件</p>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1804"></a><div class="props_rev_3"><a id="GUID-2F70C608-849D-4E54-BC09-BDE53E01012E" name="GUID-2F70C608-849D-4E54-BC09-BDE53E01012E"></a><h4 id="CNCPT-GUID-2F70C608-849D-4E54-BC09-BDE53E01012E" class="sect4">Java编程环境</h4>
                  <div>
                     <p>Oracle为企业应用程序开发人员提供了用于创建，部署和管理Java应用程序的端到端Java解决方案。</p>
                     <p>该解决方案包括客户端和服务器端编程接口，支持Java开发的工具以及与Oracle数据库集成的Java虚拟机。所有这些产品都与Java标准兼容。</p>
                     <p>Java编程环境包含以下附加功能：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>Java存储过程作为Java等价物和PL / SQL的伴随。 Java存储过程与PL / SQL紧密集成。您可以从PL / SQL包调用Java存储过程，从Java存储过程调用过程。</p>
                        </li>
                        <li>
                           <p>用于访问SQL数据的JDBC和SQLJ编程接口。</p>
                        </li>
                        <li>
                           <p>有助于开发，加载和管理类的工具和脚本。</p>
                        </li>
                     </ul>
                  </div><a id="CNCPT1805"></a><div class="props_rev_3"><a id="GUID-48434C99-5806-4174-A2E1-DC07ADA0CCBC" name="GUID-48434C99-5806-4174-A2E1-DC07ADA0CCBC"></a><h5 id="CNCPT-GUID-48434C99-5806-4174-A2E1-DC07ADA0CCBC" class="sect5">Java存储过程</h5>
                     <div>
                        <p><span class="bold">Java存储过程</span>是发布到SQL并存储在数据库中的Java方法。
                        </p>
                        <p>与PL / SQL子程序一样，可以使用SQL * Plus等产品直接调用Java过程，也可以使用触发器间接调用Java过程。您可以从任何Oracle Net客户端-OCI，预编译器或JDBC访问它。</p>
                        <p>要发布Java方法，可以编写调用规范，将Java方法名称，参数类型和返回类型映射到SQL对应项。当客户端应用程序调用时，Java存储过程可以接受参数，引用Java类并返回Java结果值。</p>
                        <p>通过引用调用规范的名称来调用Java方法的应用程序。运行时系统在Oracle数据字典中查找调用规范定义并运行相应的Java方法。</p>
                        <p>此外，您可以使用Java开发独立于PL / SQL的强大程序。 Oracle数据库提供了Java编程语言和JVM的完全兼容的实现。</p>
                        <div class="infoboxnotealso" id="GUID-48434C99-5806-4174-A2E1-DC07ADA0CCBC__GUID-5BFDF774-1865-4E72-85B5-80D6498FC1EA">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../jjdev/developing-Java-stored-procedures.html#GUID-AE1E5C4B-A077-4D1E-8821-6A7142BF1FEA" target="_blank"><span><cite>Oracle数据库Java开发人员指南</cite></span></a>介绍了如何使用Java编写存储过程，如何从PL / SQL访问它们，以及如何从Java访问PL / SQL功能</p>
                        </div>
                     </div>
                  </div><a id="CNCPT823"></a><div class="props_rev_3"><a id="GUID-A7135BCC-A366-428F-BC69-23CD20914DF5" name="GUID-A7135BCC-A366-428F-BC69-23CD20914DF5"></a><h5 id="CNCPT-GUID-A7135BCC-A366-428F-BC69-23CD20914DF5" class="sect5">Java和PL / SQL集成</h5>
                     <div>
                        <p>您可以从PL / SQL从Java和Java程序调用现有的PL / SQL程序。此解决方案可保护和利用您的PL / SQL和Java代码。</p>
                        <p>Oracle数据库提供了两种从Java访问SQL数据的不同方法：JDBC和SQLJ。 JDBC在客户端和服务器上都可用，而SQLJ仅在客户端上可用。</p>
                     </div><a id="CNCPT825"></a><div class="props_rev_3"><a id="GUID-174E853D-233D-4202-AC5D-E76637A2AA44" name="GUID-174E853D-233D-4202-AC5D-E76637A2AA44"></a><h6 id="CNCPT-GUID-174E853D-233D-4202-AC5D-E76637A2AA44" class="sect6">JDBC驱动程序</h6>
                        <div>
                           <p>JDBC是一种数据库访问协议，使您可以连接到数据库并运行SQL语句和查询到数据库。</p>
                           <p>核心Java类库只提供一个JDBC API， <code class="codeph">java.sql</code> 。但是，JDBC旨在使供应商能够提供为特定数据库提供必要专业化的驱动程序。Oracle提供了下表中显示的不同JDBC驱动程序。
                           </p>
                           <div class="tblformal" id="GUID-174E853D-233D-4202-AC5D-E76637A2AA44__GUID-69263B4E-8D8F-4A25-A6D1-570DE44532B4">
                              <p class="titleintable">表8-2 JDBC驱动程序</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="JDBC驱动程序" width="100%" border="1" summary="This table is a list and description of provided JDBC drivers." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d40402e7956">司机</th>
                                       <th align="left" valign="bottom" id="d40402e7959">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d40402e7964" headers="d40402e7956 ">
                                          <p>JDBC瘦驱动程序</p>
                                       </td>
                                       <td align="left" valign="top" headers="d40402e7964 d40402e7959 ">
                                          <p>您可以使用JDBC Thin驱动程序编写访问Oracle SQL数据的纯Java应用程序和applet。JDBC Thin驱动程序特别适用于基于Web的应用程序和applet，因为您可以从Web页面动态下载它，类似于任何其他Java applet。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d40402e7971" headers="d40402e7956 ">
                                          <p>JDBC OCI驱动程序</p>
                                       </td>
                                       <td align="left" valign="top" headers="d40402e7971 d40402e7959 ">
                                          <p>JDBC OCI驱动程序访问特定于Oracle的本机代码，即非Java代码，以及客户端或中间层上的库，与JDBC Thin驱动程序相比，性能得到提升，代价是规模更大，客户端更大安装。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d40402e7978" headers="d40402e7956 ">
                                          <p>JDBC服务器端内部驱动程序</p>
                                       </td>
                                       <td align="left" valign="top" headers="d40402e7978 d40402e7959 ">
                                          <p>当Java代码在服务器上运行时，Oracle数据库使用服务器端内部驱动程序。它允许在服务器上的Oracle JVM中运行的Java应用程序使用JDBC访问本地定义的数据，即同一系统和同一进程中的数据。它提供了性能提升，因为它能够直接使用底层的Oracle RDBMS库，而不需要Java代码和SQL数据之间的中间网络连接的开销。通过在服务器上支持相同的Java-SQL接口，Oracle数据库不需要您在部署时重做代码。</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <div class="infoboxnotealso" id="GUID-174E853D-233D-4202-AC5D-E76637A2AA44__GUID-31D8041A-7029-4E39-93B8-44043A2BE52D">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><span class="q">“ <a href="concepts-for-database-developers.html#GUID-C5A31D66-F743-4BAC-9698-4B2058E3D8A9" title="ODBC是一种标准API，它使应用程序能够连接到数据库，然后准备和运行SQL语句。">ODBC和JDBC</a> ”</span></p>
                                 </li>
                                 <li>
                                    <p><a href="../tdpjd/index.html" target="_blank"><span><cite>Oracle数据库2天+ Java开发人员指南</cite></span></a>和<a href="../jjdbc/introducing-JDBC.html#GUID-D6975767-9F5A-4B30-8910-9298DDD7FEF0" target="_blank"><span><cite>Oracle数据库JDBC开发人员指南</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div><a id="CNCPT826"></a><div class="props_rev_3"><a id="GUID-BCCC0B04-0B9C-45BA-A34A-46051F0643E1" name="GUID-BCCC0B04-0B9C-45BA-A34A-46051F0643E1"></a><h6 id="CNCPT-GUID-BCCC0B04-0B9C-45BA-A34A-46051F0643E1" class="sect6">SQLJ</h6>
                        <div>
                           <p><strong class="term">SQLJ</strong>是用于在Java程序中嵌入SQL语句的ANSI标准。您可以使用客户端SQLJ程序。此外，您可以将SQLJ程序与JDBC结合使用。</p>
                           <div class="infoboxnote" id="GUID-BCCC0B04-0B9C-45BA-A34A-46051F0643E1__GUID-5E38EC2B-B52D-4CC8-9EB6-F152C47190BF">
                              <p class="notep1">注意：</p>
                              <p>从<span>Oracle Database 12c第</span> 2版（12.2）开始，Oracle数据库不支持运行<span class="italic">服务器端</span> SQLJ代码，包括在数据库环境中运行存储过程，函数和触发器。
                              </p>
                           </div>
                           <p>SQLJ提供了一种简单但功能强大的方法来开发从Java访问数据库的客户端和中间层应用程序。开发人员使用SQLJ编写程序，然后使用SQLJ转换器将嵌入式SQL转换为基于JDBC的纯Java代码。在运行时，程序可以使用标准JDBC驱动程序与多供应商数据库进行通信。</p>
                           <p>以下示例显示了一个简单的SQLJ可执行语句：</p><pre class="pre codeblock"><code>字符串名称; #sql {SELECT first_name INTO：name FROM employees WHERE employee_id = 112}; System.out.println（“名称是”+名称+“，员工编号=”+ employee_id）;</code></pre><div class="infoboxnotealso" id="GUID-BCCC0B04-0B9C-45BA-A34A-46051F0643E1__GUID-6F096BBC-3733-4FC4-9A9E-8A70A63EC57A">
                              <p class="notep1">也可以看看：</p>
                              <ul style="list-style-type:disc">
                                 <li><span class="q">“ <a href="concepts-for-database-developers.html#GUID-575F8325-3839-45ED-B370-2292D208D9C3" title="SQLJ是用于在Java源代码中嵌入SQL语句的ANSI SQL-1999标准。SQLJ为Java数据库连接（JDBC）API提供了一种更简单的替代方法，用于从Java进行客户端SQL数据访问。">SQLJ</a> ”</span></li>
                                 <li>
                                    <p><a href="../jsqlj/intro-to-SQLJ.html#GUID-B3A3C319-5C61-40C6-B3FB-37C2BD98AD48" target="_blank"><span><cite>Oracle数据库SQLJ开发人员指南</cite></span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT118"></a><div class="props_rev_3"><a id="GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63" name="GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63"></a><h3 id="CNCPT-GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63" class="sect3">触发器概述</h3>
               <div>
                  <p>数据库<span class="bold">触发器</span>是一个编译的存储程序单元，用PL / SQL或Java编写，Oracle Database在某些情况下自动调用（“触发”）。
                  </p>
                  <p>只要发生以下操作之一，就会触发触发器：</p>
                  <ol>
                     <li>
                        <p>由任何用户发布的特定表或视图上的<a href="glossary.html#GUID-B5F2F112-1B33-41B5-B63D-9DC8F99A369D"><span class="xrefglossterm">DML</span></a>语句</p>
                        <p>DML语句修改模式对象中的数据。例如，插入和删除行是DML操作。</p>
                     </li>
                     <li>
                        <p>由特定用户或任何用户发布的<a href="glossary.html#GUID-64F19D78-A73F-44A5-AA2E-60EBC800CB22"><span class="xrefglossterm">DDL</span></a>语句</p>
                        <p>DDL语句定义模式对象。例如，创建表并添加列是DDL操作。</p>
                     </li>
                     <li>
                        <p>数据库事件</p>
                        <p>用户登录或注销，错误以及数据库启动或关闭是可以调用触发器的事件。</p>
                     </li>
                  </ol>
                  <p>触发器是类似于子程序的架构对象，但它们的调用方式不同。子程序由用户，应用程序或触发器显式运行。触发事件发生时，数据库会隐式调用触发器。</p>
                  <div class="infoboxnotealso" id="GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63__GUID-4D2869DE-CDF1-4430-A0E7-EBCCFD3859DB">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="sql.html#GUID-662EE4B0-7D5E-43F5-806D-A2AE404D77BF" title="对Oracle数据库中的信息执行的所有操作都使用SQL语句运行。SQL语句是由标识符，参数，变量，名称，数据类型和SQL保留字组成的计算机程序或指令。">SQL语句概述</a> ”</span>以了解DML和DDL</p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="oracle-database-instance.html#GUID-5FCFB104-8365-4E7B-87A1-736E65D6658F" title="数据库实例提供用户对数据库的访问权限。实例和数据库可以处于各种状态。">数据库实例启动和关闭概述</a> ”</span></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="CNCPT88945"></a><div class="props_rev_3"><a id="GUID-F1177761-342B-468C-BE5B-943A1ABC7B7C" name="GUID-F1177761-342B-468C-BE5B-943A1ABC7B7C"></a><h4 id="CNCPT-GUID-F1177761-342B-468C-BE5B-943A1ABC7B7C" class="sect4">触发器的优点</h4>
                  <div>
                     <p>正确使用触发器使您能够构建和部署更强大且更有效地使用数据库的应用程序。</p>
                     <p>您可以使用触发器：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>自动生成派生列值</p>
                        </li>
                        <li>
                           <p>防止无效的交易</p>
                        </li>
                        <li>
                           <p>提供审核和事件记录</p>
                        </li>
                        <li>
                           <p>记录有关表访问的信息</p>
                        </li>
                     </ul>
                     <p>您可以使用触发器来强制执行所有客户端应用程序通用的低级业务规则。例如，多个应用程序可以访问<code class="codeph">employees</code>表。如果此表上的触发器确保插入数据的格式，则不需要在每个客户端中复制此业务逻辑。由于应用程序无法绕过触发器，因此会自动使用触发器中的业务逻辑。
                     </p>
                     <p>您可以使用触发器和完整性约束来定义和实施任何类型的完整性规则。但是，Oracle强烈建议您仅使用触发器来强制执行使用<a href="glossary.html#GUID-67F8FE8C-EBA5-4796-820A-8919982A1411"><span class="xrefglossterm">完整性约束</span></a>无法定义的复杂业务规则。
                     </p>
                     <p>过度使用触发器会导致复杂的相互依赖性，这在大型应用程序中很难维护。例如，当调用触发器时，其触发器操作中的SQL语句可能会触发其他触发器，从而导致可能产生意外影响的级联触发器。</p>
                     <div class="infoboxnotealso" id="GUID-F1177761-342B-468C-BE5B-943A1ABC7B7C__GUID-A5182620-E802-41C6-98FD-F6FD3E3E6142">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="data-integrity.html#GUID-A8893CD7-8B19-42AA-8550-9713071FA679" title="数据保持数据完整性非常重要，这符合数据库管理员或应用程序开发人员确定的业务规则。">数据完整性简介</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../tdddg/using-triggers.html#TDDDG50000" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../lnpls/plsql-triggers.html#LNPLS2002" target="_blank"><span><cite>Oracle Database PL / SQL语言参考，</cite></span></a>用于规划应用程序触发器时的准则和限制</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT318"></a><div class="props_rev_3"><a id="GUID-02E647D9-D55E-4C74-993A-65FCE1AFE6AA" name="GUID-02E647D9-D55E-4C74-993A-65FCE1AFE6AA"></a><h4 id="CNCPT-GUID-02E647D9-D55E-4C74-993A-65FCE1AFE6AA" class="sect4">触发器的类型</h4>
                  <div>
                     <p>触发器可以根据其调用方式和它们执行的操作类型进行分类。</p>
                     <p>Oracle数据库支持以下类型的触发器：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>行触发器</p>
                           <p>每次表格受触发语句影响时，都会触发<a href="glossary.html#GUID-24EF0C74-72E4-4455-8C95-C52A1CDDF81C"><span class="xrefglossterm">行触发器</span></a> 。例如，如果语句更新多行，则对于受<code class="codeph">UPDATE</code>影响的每一行，行触发器将触发一次。如果触发语句不影响任何行，则不会运行行触发器。如果触发器操作中的代码依赖于触发语句提供的数据或受影响的行，则行触发器很有用。
                           </p>
                        </li>
                        <li>
                           <p>声明触发器</p>
                           <p>无论受触发语句影响的行数如何，都会代表触发语句触发一次<a href="glossary.html#GUID-85D25BFF-A802-4DAB-B86C-A41EFCA11B6E"><span class="xrefglossterm">语句触发器</span></a> 。例如，如果语句从表中删除100行，则语句级<code class="codeph">DELETE</code>触发器仅触发一次。如果触发器操作中的代码不依赖于触发语句提供的数据或受影响的行，则语句触发器很有用。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">INSTEAD OF</code>触发器</p>
                           <p>Oracle数据库<a href="glossary.html#GUID-9BB0F932-40F0-4727-85A1-904E162405D0"><span class="xrefglossterm">触发INSTEAD OF触发器</span></a> ，而不是执行触发语句。这些触发器对于透明地修改无法通过DML语句直接修改的视图非常有用。
                           </p>
                        </li>
                        <li>
                           <p>事件触发器</p>
                           <p>您可以使用触发器向订阅者发布有关数据库事件的信息。事件触发器分为以下几类：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="glossary.html#GUID-EFE577C5-037A-4974-8358-F3761AC70601"><span class="xrefglossterm">系统事件触发器</span></a>可能由数据库实例启动和关闭或错误消息等事件引起。
                                 </p>
                              </li>
                              <li>
                                 <p>由于与用户登录和注销，DDL语句和DML语句相关的<a href="glossary.html#GUID-54BD71CF-7D44-4CB2-9FC4-90F5CA8EF110"><span class="xrefglossterm">事件，将触发用户事件触发器</span></a> 。
                                 </p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-02E647D9-D55E-4C74-993A-65FCE1AFE6AA__GUID-2C35DBFE-34BB-461E-A13F-A4F34C3D3C7E">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../tdddg/using-triggers.html#TDDDG51000" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../lnpls/plsql-triggers.html#LNPLS2005" target="_blank"><span><cite>Oracle数据库PL / SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT88946"></a><div class="props_rev_3"><a id="GUID-A29549A3-AB75-4CCD-9093-559F8B5DA9B2" name="GUID-A29549A3-AB75-4CCD-9093-559F8B5DA9B2"></a><h4 id="CNCPT-GUID-A29549A3-AB75-4CCD-9093-559F8B5DA9B2" class="sect4">触发器的时间</h4>
                  <div>
                     <p>您可以定义触发器计时 - 是否在触发语句之前或之后运行触发器操作。</p>
                     <p><a href="glossary.html#GUID-2B4F37A3-7EB0-455F-8704-32C072C25198"><span class="xrefglossterm">简单触发器</span></a>是表上的单个触发器，使您可以为以下某个时间点指定操作：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在解雇声明之前</p>
                        </li>
                        <li>
                           <p>在受到解雇声明影响的每一行之前</p>
                        </li>
                        <li>
                           <p>在每一行受到触发声明影响之后</p>
                        </li>
                        <li>
                           <p>解雇声明后</p>
                        </li>
                     </ul>
                     <p>对于语句和行触发器， <code class="codeph">BEFORE</code>触发器可以在更改数据库之前增强安全性并启用业务规则。<code class="codeph">AFTER</code>触发器非常适合记录操作。
                     </p>
                     <p><a href="glossary.html#GUID-AE8C3B7A-EF80-4452-9C4D-4094E21BFC9E"><span class="xrefglossterm">复合触发器</span></a>可以在多个定时点<a href="glossary.html#GUID-AE8C3B7A-EF80-4452-9C4D-4094E21BFC9E"><span class="xrefglossterm">触发</span></a> 。复合触发器有助于编写一种方法，在该方法中，您为各种时序点实现的操作共享公共数据。
                     </p>
                     <div class="infoboxnotealso" id="GUID-A29549A3-AB75-4CCD-9093-559F8B5DA9B2__GUID-2DFB36FF-EEA0-49F7-92E3-02A53665E5EB">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../lnpls/plsql-triggers.html#LNPLS2005" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解复合触发器</p>
                     </div>
                  </div>
               </div><a id="CNCPT88948"></a><a id="CNCPT88947"></a><a id="CNCPT218"></a><div class="props_rev_3"><a id="GUID-146A5161-0BEA-4556-B0BC-DB29306FACFA" name="GUID-146A5161-0BEA-4556-B0BC-DB29306FACFA"></a><h4 id="CNCPT-GUID-146A5161-0BEA-4556-B0BC-DB29306FACFA" class="sect4">创建触发器</h4>
                  <div>
                     <p><code class="codeph">CREATE TRIGGER</code>语句创建或替换数据库触发器。
                     </p>
                     <p>PL / SQL触发器具有以下一般语法形式：</p><pre class="pre codeblock"><code>CREATE TRIGGER <span class="italic">trigger_name</span> <span class="italic">triggering_statement</span> [ <span class="italic">trigger_restriction</span> ] BEGIN <span class="italic">triggered_action</span> ;结束;</code></pre><p>PL / SQL触发器具有以下基本组件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>触发器名称</p>
                           <p>该名称在同一模式中的其他触发器名称中必须是唯一的。例如，名称可能是<code class="codeph">part_reorder_trigger</code> 。
                           </p>
                        </li>
                        <li>
                           <p>触发事件或语句</p>
                           <p>触发事件或语句是导致触发器被调用的SQL语句，数据库事件或用户事件。例如，用户更新表。</p>
                        </li>
                        <li>
                           <p>触发限制</p>
                           <p>触发器限制指定一个布尔<a href="glossary.html#GUID-E2141FFA-A7B2-4113-BEEE-2401FC38AB2E"><span class="xrefglossterm">表达式</span></a> ，该触发器必须为<code class="codeph">true</code>才能触发。例如，除非可用部件的数量小于当前的重新订购数量，否则不会调用触发器。
                           </p>
                        </li>
                        <li>
                           <p>触发动作</p>
                           <p>触发操作是包含在发出触发语句并且触发器限制评估为true时要运行的SQL语句和代码的过程。例如，用户将行插入到挂单表中。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-146A5161-0BEA-4556-B0BC-DB29306FACFA__GUID-AA1B80EE-D949-46E9-AF54-604B974722C0">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../tdddg/using-triggers.html#TDDDG52000" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a>和<a href="../lnpls/CREATE-PROCEDURE-statement.html#LNPLS2004" target="_blank"><span><cite>Oracle数据库PL / SQL语言参考</cite></span></a> ，了解如何创建触发器</p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/CREATE-TRIGGER.html#SQLRF01405" target="_blank"><span><cite>Oracle Database SQL语言参考</cite></span></a>了解<code class="codeph">CREATE TRIGGER</code>语句</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-355D97A1-A490-477F-9888-278624393ABF" name="GUID-355D97A1-A490-477F-9888-278624393ABF"></a><h5 id="CNCPT-GUID-355D97A1-A490-477F-9888-278624393ABF" class="sect5">示例：CREATE TRIGGER语句</h5>
                     <div>
                        <p>此示例创建一个触发器，该行触发器在行项目表上执行<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code>语句时触发。
                        </p>
                        <div class="example" id="GUID-355D97A1-A490-477F-9888-278624393ABF__GUID-AE3458EA-D92C-4D1D-B59D-5052C751E1FE">
                           <p>假设您使用以下语句创建<code class="codeph">orders</code>和<code class="codeph">lineitems</code>表。<code class="codeph">orders</code>表包含每个唯一订单的行，而<code class="codeph">lineitems</code>表包含订单中每个项目的行。
                           </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE命令（order_id NUMBER PRIMARY KEY，/ *其他属性* / line_items_count NUMBER DEFAULT 0）; CREATE TABLE lineitems（order_id REFERENCES orders，seq_no NUMBER，/ * other attributes * / CONSTRAINT lineitems PRIMARY KEY（order_id，seq_no））;</pre><p>以下语句创建一个示例触发器，该触发器使用<code class="codeph">orders</code>中的项目数自动更新<code class="codeph">orders</code>表：</p><pre class="pre codeblock"><code>创建或替换TRIGGER lineitems_trigger插入或更新或删除线条项目后每行开始IF（插入或更新）然后更新订单SET line_items_count = NVL（line_items_count，0）+1 WHERE order_id =：new.order_id;万一; IF（删除或更新）然后更新订单SET line_items_count = NVL（line_items_count，0）-1 WHERE order_id =：old.order_id;万一;结束; /</code></pre><p>在<code class="codeph">lineitems_trigger</code> ，触发语句是<code class="codeph">lineitems</code>表上的<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>或<code class="codeph">DELETE</code> 。不存在触发限制。为每个更改的行调用触发器。触发器可以访问受触发语句影响的当前行的旧列值和新列值。要修改的表的每一列都存在两个相关名：旧值（ <code class="codeph">:old</code> ）和新值（ <code class="codeph">:new</code> ）。如果会话更新或插入订单的<code class="codeph">lineitems</code>中的行，则在操作之后，触发器将按此顺序计算项目数，并使用计数更新<code class="codeph">orders</code>表。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-787A32DF-959F-4821-AFAD-3B3424769D25" name="GUID-787A32DF-959F-4821-AFAD-3B3424769D25"></a><h5 id="CNCPT-GUID-787A32DF-959F-4821-AFAD-3B3424769D25" class="sect5">示例：调用行级触发器</h5>
                     <div>
                        <p>在这种情况下，客户启动两个订单并添加和删除订单中的订单项。</p>
                        <div class="example" id="GUID-787A32DF-959F-4821-AFAD-3B3424769D25__GUID-BEC423E0-5961-4151-9B6A-BA6A53BCF4DA">
                           <p>该方案基于<a href="server-side-programming.html#GUID-355D97A1-A490-477F-9888-278624393ABF" title="此示例创建一个触发器，该行触发器在行项目表上执行INSERT，UPDATE或DELETE语句时触发。">Example：CREATE TRIGGER Statement中创建的触发器</a> 。
                           </p>
                           <div class="tblformalwide" id="GUID-787A32DF-959F-4821-AFAD-3B3424769D25__GUID-94121B35-F6AD-4813-A58F-C13FCA364DD0">
                              <p class="titleintable">表8-3行级触发器方案</p>
                              <table cellpadding="4" cellspacing="0" class="FormalWide" title="行级触发场景" width="100%" border="1" summary="This table describes a scenario where a customer initiates two orders and adds and removes line items from the orders." frame="hsides" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="20%" id="d40402e10648">SQL语句</th>
                                       <th align="left" valign="bottom" width="20%" id="d40402e10651">触发的SQL语句</th>
                                       <th align="left" valign="bottom" width="20%" id="d40402e10654">描述</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10659" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO orders（order_id）VALUES（78）;已创建1行。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10659 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10659 d40402e10654 ">
                                          <p>客户创建ID为78的订单。此时客户订单中没有商品。</p>
                                          <p>由于未对<code class="codeph">lineitems</code>表执行任何操作，因此不会调用触发器。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10672" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO orders（order_id）VALUES（92）;已创建1行。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10672 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10672 d40402e10654 ">
                                          <p>客户创建一个ID为92的单独订单。此时客户订单中没有商品。</p>
                                          <p>由于未对<code class="codeph">lineitems</code>表执行任何操作，因此不会调用触发器。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10685" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO lineitems（order_id，seq_no）VALUES（78,1）;已创建1行。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10685 d40402e10651 "><pre class="oac_no_warn" dir="ltr">更新订单SET line_items_count = NVL（NULL，0）+1 WHERE order_id = 78;</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10685 d40402e10654 ">
                                          <p>客户在订单中添加商品78。</p>
                                          <p><code class="codeph">INSERT</code>调用触发器。触发的语句将订单78的行项目计数从0增加到1。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10700" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; INSERT INTO lineitems（order_id，seq_no）VALUES（78,2）;已创建1行。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10700 d40402e10651 "><pre class="oac_no_warn" dir="ltr">更新订单SET line_items_count = NVL（1,0）+1 WHERE order_id = 78;</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10700 d40402e10654 ">
                                          <p>客户在订单78中添加了一个额外的项目。</p>
                                          <p><code class="codeph">INSERT</code>调用触发器。触发的语句将订单78的行项目计数从1增加到2。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10715" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM orders; ORDER_ID LINE_ITEMS_COUNT --------- ---------------- 78 2 92 0</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10715 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10715 d40402e10654 ">
                                          <p>客户查询两个订单的状态。订单78包含两个项目。订单92不包含任何项目。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10723" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM lineitems; ORDER_ID SEQ_NO ---------- ---------- 78 1 78 2</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10723 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10723 d40402e10654 ">
                                          <p>客户查询订单项的状态。每个项目由订单ID和序列号唯一标识。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10731" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; UPDATE lineitems SET order_id = 92; 2行更新。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10731 d40402e10651 "><pre class="oac_no_warn" dir="ltr">UPDATE命令SET line_items_count = NVL（NULL，0）+1 WHERE order_id = 92;更新订单SET line_items_count = NVL（2,0）-1 WHERE order_id = 78;</pre><pre class="oac_no_warn" dir="ltr">更新订单SET line_items_count = NVL（1,0）+1 WHERE order_id = 92;更新订单SET line_items_count = NVL（1,0）-1 WHERE order_id = 78;</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10731 d40402e10654 ">
                                          <p>客户将订单78中的订单项移至订单92。</p>
                                          <p><code class="codeph">UPDATE</code>语句更改<code class="codeph">lineitems</code>表中的2行，每行为每行调用一次触发器。
                                          </p>
                                          <p>每次调用触发器时，都会满足触发器中的两个<code class="codeph">IF</code>条件。第一个条件使订单92的计数递增，而第二个条件减少订单78的计数。因此，运行四个总<code class="codeph">UPDATE</code>语句。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10759" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM orders; ORDER_ID LINE_ITEMS_COUNT --------- ---------------- 78 0 92 2</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10759 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10759 d40402e10654 ">
                                          <p>客户查询两个订单的状态。净效应是订单92的行项目计数从0增加到2，而订单78的计数从2减少到0。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10767" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM lineitems; ORDER_ID SEQ_NO ---------- ---------- 92 1 92 2</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10767 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10767 d40402e10654 ">
                                          <p>客户查询订单项的状态。每个项目由订单ID和序列号唯一标识。</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10775" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; DELETE FROM lineitems;删除了2行。</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10775 d40402e10651 "><pre class="oac_no_warn" dir="ltr">更新订单SET line_items_count = NVL（2,0）-1 WHERE order_id = 92;更新订单SET line_items_count = NVL（1,0）-1 WHERE order_id = 92;</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10775 d40402e10654 ">
                                          <p>客户现在从所有订单中删除所有订单项。</p>
                                          <p><code class="codeph">DELETE</code>语句在<code class="codeph">lineitems</code>表中更改了2行，每行为每行调用一次触发器。对于每个触发器调用，只满足触发器中的一个<code class="codeph">IF</code>条件。每次条件将订单92的计数减少1。因此，运行两个总<code class="codeph">UPDATE</code>语句。
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="20%" id="d40402e10799" headers="d40402e10648 "><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT * FROM orders; ORDER_ID LINE_ITEMS_COUNT --------- ---------------- 78 0 92 0 SQL&gt; SELECT * FROM lineitems;没有选择任何行</pre></td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10799 d40402e10651 "> </td>
                                       <td align="left" valign="top" width="20%" headers="d40402e10799 d40402e10654 ">
                                          <p>客户查询两个订单的状态。这两个订单都不包含订单项。</p>
                                          <p>客户还会查询订单项的状态。没有物品存在。</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div><a id="CNCPT1697"></a><div class="props_rev_3"><a id="GUID-F5B4011B-AA09-4D61-A409-6AB290A9025F" name="GUID-F5B4011B-AA09-4D61-A409-6AB290A9025F"></a><h4 id="CNCPT-GUID-F5B4011B-AA09-4D61-A409-6AB290A9025F" class="sect4">执行触发器</h4>
                  <div>
                     <p>Oracle数据库使用与子程序执行相同的步骤在内部执行触发器。</p>
                     <p>唯一细微的区别是，如果用户帐户有权运行触发语句，则有权触发触发器。有了这个例外，数据库验证并运行触发器的方式与存储的子程序相同。</p>
                     <div class="infoboxnotealso" id="GUID-F5B4011B-AA09-4D61-A409-6AB290A9025F__GUID-ADC3DCE9-FC22-4342-9967-BDC3475C475B">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../lnpls/plsql-triggers.html#LNPLS020" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解有关触发器执行的更多信息</p>
                     </div>
                  </div>
               </div><a id="CNCPT88949"></a><a id="CNCPT1696"></a><div class="props_rev_3"><a id="GUID-D54C348D-BFC6-41B6-AEDD-C081C1089208" name="GUID-D54C348D-BFC6-41B6-AEDD-C081C1089208"></a><h4 id="CNCPT-GUID-D54C348D-BFC6-41B6-AEDD-C081C1089208" class="sect4">存储触发器</h4>
                  <div>
                     <p>Oracle数据库以编译形式将PL / SQL触发器存储在数据库模式中，就像PL / SQL存储过程一样。</p>
                     <p>当<code class="codeph">CREATE TRIGGER</code>语句提交时，编译的PL / SQL代码存储在数据库中。共享池删除PL / SQL触发器的源代码。
                     </p>
                     <p>下图显示了具有隐式调用PL / SQL触发器的SQL语句的数据库应用程序。触发器与其关联表分开存储。</p>
                     <div class="figure" id="GUID-D54C348D-BFC6-41B6-AEDD-C081C1089208__BABJAIBB">
                        <p class="titleinfigure">图8-7触发器</p><img src="img/cncpt076.gif" alt="下面是图8-7的描述" title="下面是图8-7的描述" longdesc="img_text/cncpt076.html"><br><a href="img_text/cncpt076.html">“图8-7触发器”的描述</a></div>
                     <!-- class="figure" -->
                     <p>Java触发器的存储方式与PL / SQL触发器的存储方式相同。但是，Java触发器引用使用<code class="codeph">CALL</code>语句单独编译的Java代码。因此，创建Java触发器涉及创建Java代码并创建引用此Java代码的触发器。
                     </p>
                     <div class="infoboxnotealso" id="GUID-D54C348D-BFC6-41B6-AEDD-C081C1089208__GUID-AF279AA8-4118-4B89-B4FD-B5E68A3B2C0D">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../lnpls/plsql-triggers.html#LNPLS2007" target="_blank"><span><cite>Oracle Database PL / SQL语言参考</cite></span></a> ，了解有关编译和存储触发器的信息</p>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>