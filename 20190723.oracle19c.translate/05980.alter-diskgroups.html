<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can alter a disk group with SQL*Plus, ASMCA, or ASMCMD commands."></meta>
      <meta name="description" content="You can alter a disk group with SQL*Plus, ASMCA, or ASMCMD commands."></meta>
      <title>更改磁盘组</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Administrator&#39;s Guide"></meta>
      <meta property="og:description" content="You can alter a disk group with SQL*Plus, ASMCA, or ASMCMD commands."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Administrator&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="automatic-storage-management-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-23T18:56:15-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2007, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96198-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="create-diskgroups.html" title="Previous" type="text/html"></link>
      <link rel="next" href="asm-disk-discovery.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Automatic Storage Management Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="OSTMG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="create-diskgroups.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="asm-disk-discovery.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">管理员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-instance-diskgroup.html" property="item" typeof="WebPage"><span property="name">Oracle ASM实例和磁盘组</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="admin-asm-diskgroups.html" property="item" typeof="WebPage"><span property="name">管理Oracle ASM磁盘组</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">更改磁盘组</li>
            </ol>
            <a id="GUID-6BB31112-8687-4C1E-AF14-D94FFCDA736F" name="GUID-6BB31112-8687-4C1E-AF14-D94FFCDA736F"></a><a id="OSTMG10070"></a>
            
            <h2 id="OSTMG-GUID-6BB31112-8687-4C1E-AF14-D94FFCDA736F" class="sect2">更改磁盘组</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以使用SQL * Plus，ASMCA或ASMCMD命令更改磁盘组。</p>
               <p>您可以使用<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL语句来更改磁盘组配置。您还可以使用Oracle ASM Configuration Assistant（ASMCA）和ASMCMD <code class="codeph">chdg</code>命令更改磁盘组配置。
               </p>
               <p>您可以在数据库保持联机时添加，调整大小或删除磁盘。只要有可能，建议在单个<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句中进行多个操作。在单个<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句中对操作进行分组可以减少重新平衡操作。
               </p>
               <p>当磁盘组配置发生更改时，Oracle ASM会自动重新平衡。默认情况下， <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句不会等到操作完成后再返回。查询<code class="codeph">V$ASM_OPERATION</code>视图以监视此操作的状态。
               </p>
               <p>使用<code class="codeph">REBALANCE</code> <code class="codeph">WAIT</code>子句使<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句处理等到重新平衡操作完成后再返回。这在脚本中特别有用。该语句还接受<code class="codeph">REBALANCE</code> <code class="codeph">NOWAIT</code>子句，该子句调用在后台异步执行重新平衡操作的默认行为。
               </p>
               <p>您可以通过在大多数平台上键入<code class="codeph">CTRL+C</code>来中断在等待模式下运行的重新平衡。这会导致语句立即返回消息<code class="codeph">ORA-01013: user requested cancel of current operation</code> ，然后异步继续操作。键入<code class="codeph">CTRL+C</code>不会取消重新平衡操作或任何磁盘添加，删除或调整大小操作。
               </p>
               <p>要控制重新平衡操作的速度和资源消耗，可以在添加，删除或调整磁盘大小的语句中包含<code class="codeph">REBALANCE</code> <code class="codeph">POWER</code>子句。
               </p>
               <p>讨论了以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="alter-diskgroups.html#GUID-17B6982D-DC71-40D2-BB9B-A6C659DD187E" title="您可以在磁盘组中创建Oracle ASM动态卷管理器（Oracle ADVM）卷。">管理磁盘组中的Oracle ADVM卷</a></p>
                  </li>
                  <li>
                     <p><a href="alter-diskgroups.html#GUID-85391590-DAD5-46BB-A70C-ED94DA94D18D" title="您可以使用ALTER DISKGROUP语句的ADD子句将磁盘或故障组添加到磁盘组。">将磁盘添加到磁盘组</a></p>
                  </li>
                  <li>
                     <p><a href="alter-diskgroups.html#GUID-2BD060BC-EF48-414D-9B24-3C4B2FD6E260" title="可以替换磁盘组中的磁盘或多个磁盘，而不是将其删除并添加回来。">更换磁盘组中的磁盘</a></p>
                  </li>
                  <li>
                     <p><a href="alter-diskgroups.html#GUID-A2E82BE6-BE5E-42F8-8723-03DF5CD55D90">重命名磁盘组中的磁盘</a></p>
                  </li>
                  <li>
                     <p><a href="alter-diskgroups.html#GUID-44160C76-20B6-40C8-82F8-FF332A28899E" title="您可以使用ALTER DISKGROUP语句的DROP DISK子句从磁盘组中删除磁盘。">从磁盘组中删除磁盘</a></p>
                  </li>
                  <li>
                     <p><a href="alter-diskgroups.html#GUID-6AEFFA72-7BDC-4AA8-8667-8417AAF3DAC8" title="ALTER DISKGROUP的RESIZE子句使您可以调整磁盘组中的磁盘大小。">调整磁盘组中的磁盘大小</a></p>
                  </li>
                  <li>
                     <p><a href="alter-diskgroups.html#GUID-733B25C1-029C-452A-B19F-02FE2BD24ECB" title="ALTER DISKGROUP语句的UNDROP DISKS子句使您可以取消磁盘组中所有挂起的磁盘丢弃。">磁盘组中的Undropping磁盘</a></p>
                  </li>
                  <li>
                     <p><a href="alter-diskgroups.html#GUID-020ABD10-8370-444C-9B44-71F2FF688861" title="您可以使用ALTER DISKGROUP语句的REBALANCE子句手动重新平衡磁盘组中的文件。">手动重新平衡磁盘组</a></p>
                  </li>
                  <li>
                     <p><a href="alter-diskgroups.html#GUID-14E48E96-F5D6-4F41-A8E4-B535CBD3CAE5">调整再平衡操作</a></p>
                  </li>
                  <li>
                     <p><a href="alter-diskgroups.html#GUID-ECCAE4F3-CFC5-4B55-81D2-FFB6953C035C">清理磁盘组</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-6BB31112-8687-4C1E-AF14-D94FFCDA736F__GUID-3F0E124F-C0DC-4928-8966-267F602E9BA3">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="manage-asm-asmca.html#GUID-F78B035C-168D-4CBB-B321-21BB57FED363" title="Oracle ASM Configuration Assistant使您可以使用“配置ASM磁盘组”选项卡配置或创建Oracle ASM磁盘组。">使用ASMCA管理磁盘组，</a>以获取有关使用Oracle ASM Configuration Assistant（ASMCA）更改磁盘组配置的信息</p>
                     </li>
                     <li>
                        <p><a href="asmcmd-diskgroup-commands.html#GUID-E2C4C913-5AA8-45F1-9A05-EE1F69496EB5">chdg</a>约改变与ASMCMD磁盘组配置信息<code class="codeph">chdg</code></p>
                     </li>
                     <li>
                        <p>有关<code class="codeph">REBALANCE</code> <code class="codeph">POWER</code>子句的更多信息，请<a href="alter-diskgroups.html#GUID-020ABD10-8370-444C-9B44-71F2FF688861" title="您可以使用ALTER DISKGROUP语句的REBALANCE子句手动重新平衡磁盘组中的文件。">手动重新平衡磁盘组</a></p>
                     </li>
                     <li>
                        <p>有关<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL语句的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/ostmg&amp;id=SQLRF01113" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                     </li>
                  </ul>
               </div>
            </div><a id="OSTMG94112"></a><a id="OSTMG10072"></a><div class="props_rev_3"><a id="GUID-17B6982D-DC71-40D2-BB9B-A6C659DD187E" name="GUID-17B6982D-DC71-40D2-BB9B-A6C659DD187E"></a><h3 id="OSTMG-GUID-17B6982D-DC71-40D2-BB9B-A6C659DD187E" class="sect3">管理磁盘组中的Oracle ADVM卷</h3>
               <div>
                  <p>您可以在磁盘组中创建Oracle ASM动态卷管理器（Oracle ADVM）卷。</p>
                  <p>与动态卷关联的卷设备可用于托管Oracle ACFS文件系统。</p>
                  <p>磁盘组的兼容性属性<code class="codeph">COMPATIBLE.ASM</code>和<code class="codeph">COMPATIBLE.ADVM</code>必须设置为<code class="codeph">11.2</code>或更高。
                  </p>
                  <p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">VOLUME</code> SQL语句使您可以管理Oracle ADVM卷，包括添加，修改，调整大小，禁用，启用和删除卷的功能。
                  </p>
                  <p>如果Oracle ADVM卷位于Flex磁盘组上，则可以使用<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">MODIFY</code> <code class="codeph">FILEGROUP</code> <code class="codeph"><span class="codeinlineitalic">volume_name</span></code> SQL语句在线更改Oracle ADVM卷的冗余。
                  </p>
                  <div class="infoboxnote" id="GUID-17B6982D-DC71-40D2-BB9B-A6C659DD187E__GUID-89ED5D51-B3ED-499C-A131-1CD63EA19CFB">
                     <p class="notep1">注意：</p>
                     <p>如果卷托管Oracle ACFS文件系统，则无法使用SQL <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句调整该卷的大小。您必须使用<code class="codeph">acfsutil</code> <code class="codeph">size</code>命令。
                     </p>
                  </div>
                  <p>以下是<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">VOLUME</code>语句的示例。
                  </p>
                  <div class="example" id="GUID-17B6982D-DC71-40D2-BB9B-A6C659DD187E__GUID-89FA9B0D-F909-4055-94DA-BE0A1F54AA20">
                     <p class="titleinexample">示例4-5使用ALTER DISKGROUP VOLUME语句管理卷</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DISKGROUP数据ADD VOLUME volume1 SIZE 10G; Diskgroup改变了。SQL&gt; ALTER DISKGROUP数据调整音量volume1 SIZE 15G; Diskgroup改变了。SQL&gt; ALTER DISKGROUP数据DISABLE VOLUME volume1; Diskgroup改变了。SQL&gt; ALTER DISKGROUP数据ENABLE VOLUME volume1; Diskgroup改变了。SQL&gt; ALTER DISKGROUP ALL DISABLE VOLUME ALL; Diskgroup改变了。SQL&gt; ALTER DISKGROUP数据DROP VOLUME volume1; Diskgroup改变了。</pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-17B6982D-DC71-40D2-BB9B-A6C659DD187E__GUID-765E774A-F64E-4A6E-BE40-71608D21284A">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="diskgroup-compatibility.html#GUID-AE540604-92D9-4CFE-A40E-BF4486163772">磁盘组兼容性属性</a>有关磁盘组兼容性属性的信息</p>
                           </li>
                           <li>
                              <p>有关使用<code class="codeph">acfsutil</code> <code class="codeph">size</code>调整卷<a href="acfs-commands-utilities.html#GUID-79A8333D-4E1C-4788-944D-EC86E4278C00">大小</a>的信息，请<code class="codeph">acfsutil</code> <code class="codeph">size</code></p>
                           </li>
                           <li>
                              <p>有关Oracle ADVM的信息，请参见<a href="overview-advm.html#GUID-B7A61F3B-C22A-4021-A846-F5EA749E79FF" title="Oracle ASM动态卷管理器（Oracle ADVM）为客户端提供卷管理服务和标准磁盘设备驱动程序接口。">Oracle ASM Dynamic Volume Manager概述</a></p>
                           </li>
                           <li>
                              <p>有关<a href="manage-advm-asmcmd.html#GUID-07E90E70-406A-4273-B27F-9F2ED7C1C4BF" title="Oracle ASM命令行实用程序（ASMCMD）提供用于管理Oracle ADVM卷的命令。">使用ASMCMD</a>管理Oracle ADVM卷的信息，请使用ASMCMD管理Oracle ADVM</p>
                           </li>
                           <li>
                              <p><a href="manage-acfs-advm-asmca.html#GUID-74A49C55-C793-42F2-8147-B4EAB962D957" title="Oracle ASM Configuration Assistant使您可以创建或配置Oracle ACFS文件系统。Oracle ASM Configuration Assistant使您可以为Oracle ACFS文件系统配置安全性和加密。">用于管理Oracle ACFS和Oracle ADVM的ASMCA GUI工具，</a>以获取有关使用ASMCA管理Oracle ADVM卷的信息</p>
                           </li>
                           <li>
                              <p><a href="asm-filegroups.html#GUID-BE9083C8-A5DF-48CD-BB32-C8A6FCDA3E7B">关于Oracle ASM文件组属性，</a>以获取有关文件组属性的信息</p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL语句的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/ostmg&amp;id=SQLRF01113" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="OSTMG10071"></a><div class="props_rev_3"><a id="GUID-85391590-DAD5-46BB-A70C-ED94DA94D18D" name="GUID-85391590-DAD5-46BB-A70C-ED94DA94D18D"></a><h3 id="OSTMG-GUID-85391590-DAD5-46BB-A70C-ED94DA94D18D" class="sect3">将磁盘添加到磁盘组</h3>
               <div>
                  <p>您可以使用<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句的<code class="codeph">ADD</code>子句将磁盘或故障组添加到磁盘组。
                  </p>
                  <p>您可以使用<code class="codeph">ALTER DISKGROUP</code> SQL语句添加磁盘或故障组。使用的语法类似于<code class="codeph">CREATE</code> <code class="codeph">DISKGROUP</code>语句。添加新磁盘后，随着重新平衡的进行，新磁盘逐渐开始适应其工作负载份额。
                  </p>
                  <p>添加磁盘时，磁盘的大小必须与磁盘组中的其他磁盘大小相同。</p>
                  <div class="infoboxnotealso" id="GUID-85391590-DAD5-46BB-A70C-ED94DA94D18D__GUID-63228F87-2DFA-4B3C-A45E-86CE288EDB7F">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="alter-diskgroups.html#GUID-7AED5447-C99B-4B7F-8196-CDA485BECA17">使用ALTER DISKGROUP SQL语句将磁盘添加到磁盘组</a> ，以获取使用SQL语句将磁盘<a href="alter-diskgroups.html#GUID-7AED5447-C99B-4B7F-8196-CDA485BECA17">添加到磁盘组</a>的示例</p>
                        </li>
                        <li>
                           <p><a href="create-diskgroups.html#GUID-7FB8914B-0995-4DA0-8F37-15B8EEAEEE4D__CHDDEHJH">例4-1</a>给出了<code class="codeph">CREATE</code> <code class="codeph">DISKGROUP</code> SQL语句的示例</p>
                        </li>
                        <li>
                           <p><a href="mirroring-diskgroup-redundancy.html#GUID-C93FC8D9-5FB8-452B-860F-EFB4D3DE95BD">镜像，冗余和故障组选项</a>以及<a href="asm-intro.html#GUID-051330D2-680F-4A2B-B559-02246C551AC7" title="本主题介绍了关键Oracle ASM组件的概念。">了解Oracle ASM概念，</a>以获取有关冗余级别和故障组的信息</p>
                        </li>
                        <li>
                           <p><a href="manage-asm-asmca.html#GUID-F78B035C-168D-4CBB-B321-21BB57FED363" title="Oracle ASM Configuration Assistant enables you to configure or create Oracle ASM disk groups with the Configure ASM Disk Groups tab.">使用ASMCA管理磁盘组，</a>以获取有关<a href="manage-asm-asmca.html#GUID-F78B035C-168D-4CBB-B321-21BB57FED363" title="Oracle ASM Configuration Assistant使您可以使用“配置ASM磁盘组”选项卡配置或创建Oracle ASM磁盘组。">使用ASMCA</a>将磁盘添加到磁盘组的信息</p>
                        </li>
                        <li>
                           <p>有关<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL语句的信息，请<a href="../sqlrf/ALTER-DISKGROUP.html#SQLRF01113" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="OSTMG94113"></a><div class="props_rev_3"><a id="GUID-7AED5447-C99B-4B7F-8196-CDA485BECA17" name="GUID-7AED5447-C99B-4B7F-8196-CDA485BECA17"></a><h4 id="OSTMG-GUID-7AED5447-C99B-4B7F-8196-CDA485BECA17" class="sect4">使用ALTER DISKGROUP SQL语句将磁盘添加到磁盘组</h4>
                  <div>
                     <p>本主题中的SQL示例演示了磁盘发现与<code class="codeph">ADD</code> <code class="codeph">DISK</code>操作的交互。假设磁盘发现识别<code class="codeph">/devices</code>目录中的以下磁盘：</p><pre class="oac_no_warn" dir="ltr">/ devices / diska1  -  data1 / devices / diska2的成员 -  data1 / devices / diska3的成员 -  data1 / devices / diska4的成员 -  data1 / devices / diska5的成员 - 候选磁盘/ devices / diska6  - 候选磁盘/设备/ diska7  - 候选磁盘/设备/ diska8  - 候选磁盘/设备/ diskb1  -  data1 / devices / diskb2的成员 -  data1 / devices / diskb3的成员 -  data1 / devices / diskb4的成员 -  -  data2 / devices / diskc1的成员 -  data2 / devices / diskc2的成员 -  data2 / devices / diskc3的成员 -  data3 / devices / diskc4的成员 - 候选磁盘/ devices / diskd1  - 候选磁盘/ devices / diskd2  - 候选磁盘/设备/ diskd3  - 候选磁盘/设备/ diskd4  - 候选磁盘/设备/ diskd5  - 候选磁盘/设备/ diskd6  - 候选磁盘/设备/ diskd7  - 候选磁盘/设备/ diskd8  -  - 候选磁盘</pre><p>您可以查询<code class="codeph">V$ASM_DISK</code>视图以显示Oracle ASM磁盘的状态。请参见<a href="views-asm-info.html#GUID-7CAB3FBA-5B76-4F30-A13F-C4C16BD59147">包含Oracle ASM信息的视图</a> 。
                     </p>
                     <p>以下语句将失败，因为<code class="codeph">/devices/diska1</code>到<code class="codeph">/devices/diska4</code>当前属于磁盘组<code class="codeph">data1</code> 。
                     </p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data1 ADD DISK'/ devices / diska *';</pre><p>以下语句成功将disks <code class="codeph">/devices/diska5</code>和<code class="codeph">/devices/diska6</code>到<code class="codeph">data1</code> 。因为<code class="codeph">ALTER DISKGROUP</code>语句中不包含<code class="codeph">FAILGROUP</code>子句，所以每个磁盘都分配给自己的故障组。<code class="codeph">NAME</code>子句为磁盘分配名称，否则将为其分配系统生成的名称。
                     </p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data1 ADD DISK'/ devices / diska5'NAME diska5，'/ devices / diska6'NAME diska6;</pre><p>指定故障组时，可以指定类型（常规或仲裁）以及名称。故障组类型值默认为常规。您必须包含<code class="codeph">QUORUM</code> <code class="codeph">FAILGROUP</code>子句以指定仲裁失败组。以下语句使用<code class="codeph">FAILGROUP</code>子句成功将disks <code class="codeph">/devices/diska7</code>和<code class="codeph">/devices/diska8</code>到<code class="codeph">data1</code>以指定故障组。
                     </p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data1 FAILGROUP fg_diska78 ADD DISK'/ devices / diska7'NAME diska7，'/ devices / diska8'NAME diska8;</pre><p>以下语句将失败，因为搜索字符串与其他磁盘组中包含的磁盘匹配。具体来说， <code class="codeph">/devices/diska4</code>属于磁盘组<code class="codeph">data1</code> ， <code class="codeph">/devices/diskb4</code>属于磁盘组<code class="codeph">data2</code> 。
                     </p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data1 ADD DISK'/ devices / disk * 4';</pre><p>以下语句将成功将<code class="codeph">/devices/diskd1</code>通过<code class="codeph">/devices/diskd8</code>到磁盘组<code class="codeph">data1</code> 。此语句以5的重新平衡功率运行，并且在重新平衡操作完成之前不会返回。
                     </p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data1 ADD DISK'/ devices / diskd *'REBALANCE POWER 5 WAIT;</pre><p>如果<code class="codeph">/devices/diskc3</code>以前是不再存在的磁盘组的成员，则可以使用<code class="codeph">FORCE</code>选项将磁盘添加为另一个磁盘组的成员。例如，下面使用的<code class="codeph">FORCE</code>子句使<code class="codeph">/devices/diskc3</code>被添加到<code class="codeph">data2</code> ，即使它是一个当前成员<code class="codeph">data3</code> 。要使此语句成功，无法装入<code class="codeph">data3</code> 。
                     </p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data2 ADD DISK'/ devices / diskc3'FORCE;</pre></div>
               </div>
            </div><a id="OSTMG95350"></a><div class="props_rev_3"><a id="GUID-2BD060BC-EF48-414D-9B24-3C4B2FD6E260" name="GUID-2BD060BC-EF48-414D-9B24-3C4B2FD6E260"></a><h3 id="OSTMG-GUID-2BD060BC-EF48-414D-9B24-3C4B2FD6E260" class="sect3">更换磁盘组中的磁盘</h3>
               <div>
                  <p>可以替换磁盘组中的磁盘或多个磁盘，而不是将其删除并添加回来。</p>
                  <p>单个替换操作比删除和添加磁盘更有效。当磁盘丢失或损坏时，此操作特别有用。</p>
                  <p>例如，您可以发出以下语句，将<code class="codeph">diskc7</code>磁盘替换为<code class="codeph">/devices/diskc18</code>路径标识的另一个磁盘。
                  </p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DISKGROUP data2 REPLACE DISK diskc7 WITH'/ devices / diskc18'POWER 3;</pre><p>电源选项的操作与<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">REBALANCE</code>语句的电源选项相同，但电源选项不能设置为<code class="codeph">0</code> 。
                  </p>
                  <p>带有<code class="codeph">REPLACE</code>子句的<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL语句包括<code class="codeph">WAIT</code>或<code class="codeph">NOWAIT</code>选项以及<code class="codeph">FORCE</code>选项。
                  </p>
                  <div class="infoboxnote" id="GUID-2BD060BC-EF48-414D-9B24-3C4B2FD6E260__GUID-0B0B82D6-A82C-475C-B484-6AC110806A8B">
                     <p class="notep1">注意：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="alter-diskgroups.html#GUID-020ABD10-8370-444C-9B44-71F2FF688861" title="You can manually rebalance the files in a disk group using the REBALANCE clause of the ALTER DISKGROUP statement.">手动重新平衡磁盘组，</a>以获取有关<a href="alter-diskgroups.html#GUID-020ABD10-8370-444C-9B44-71F2FF688861" title="您可以使用ALTER DISKGROUP语句的REBALANCE子句手动重新平衡磁盘组中的文件。">重新平衡磁盘组</a>的电源选项的信息</p>
                        </li>
                        <li>
                           <p><a href="init-params-asm-instance.html#GUID-BCA97B38-50AB-4B71-8D09-C67D8530D7BD" title="ASM_POWER_LIMIT初始化参数指定磁盘组中磁盘重新平衡的默认功率。">ASM_POWER_LIMIT</a>有关信息<code class="codeph">ASM_POWER_LIMIT</code>初始化参数</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="OSTMG95706"></a><div class="props_rev_3"><a id="GUID-A2E82BE6-BE5E-42F8-8723-03DF5CD55D90" name="GUID-A2E82BE6-BE5E-42F8-8723-03DF5CD55D90"></a><h3 id="OSTMG-GUID-A2E82BE6-BE5E-42F8-8723-03DF5CD55D90" class="sect3">重命名磁盘组中的磁盘</h3>
               <div>
                  <p>您可以使用<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">RENAME</code> <code class="codeph">DISK</code> SQL语句重命名磁盘组中的磁盘。
                  </p>
                  <div class="infoboxnote" id="GUID-A2E82BE6-BE5E-42F8-8723-03DF5CD55D90__GUID-F2726D0C-9B2E-4621-A437-A03007E1A60E">
                     <p class="notep1">注意：</p>只有当包含磁盘的磁盘组处于<code class="codeph">MOUNT</code> <code class="codeph">RESTRICTED</code>状态时，才能使用<code class="codeph">RENAME</code> <code class="codeph">DISK</code>操作。如果磁盘组中的任何磁盘脱机，则<code class="codeph">RENAME</code>操作将失败。如果存在新磁盘名称，则<code class="codeph">RENAME</code>操作将失败。您必须具有<code class="codeph">SYSASM</code>权限才能重命名磁盘。
                  </div>
                  <p>在一个SQL语句中，您可以使用<code class="codeph">RENAME</code> <code class="codeph">DISKS</code> <code class="codeph">ALL</code>子句重命名一个或多个磁盘，或重命名磁盘组中的所有磁盘。
                  </p>
                  <p>例如，您可以按如下方式重命名磁盘：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DISKGROUP fra2 MOUNT RESTRICTED; SQL&gt; ALTER DISKGROUP fra2重命名盘'FRA1_0001'到'FRA2_0001'，'FRA1_0002'到'FRA2_0002';</pre><p>对于<code class="codeph">NORMAL</code> ， <code class="codeph">HIGH</code>和<code class="codeph">FLEX</code>冗余磁盘组，可以使用<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">RENAME</code> <code class="codeph">DISK</code>将<code class="codeph">SITE</code>名称与<code class="codeph">SITE</code>子句相关联。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DISKGROUP data1 RENAME DISK'DATA1_0001'SITE SITE1;</pre><p>有关数据站点，扩展磁盘组和磁盘首选读取的信息，请参阅<a href="asm-filegroups.html#GUID-5A0CD2C9-3BE4-45FB-B5B6-5CD58D7F89EA" title="Oracle ASM扩展磁盘组具有Flex磁盘组的所有功能，其特定设计在扩展（拉伸）群集环境中具有高可用性，该环境包含跨多个物理上分离的站点的节点。">关于Oracle ASM扩展磁盘组</a>和<a href="manage-diskgroup-attributes.html#GUID-F3E0FDDE-125D-4D7B-B3F5-8EE81DC1D3FB" title="在包含跨多个物理上分离的站点的节点的Oracle扩展群集中，PREFERRED_READ.ENABLED磁盘组属性控制是否为磁盘组启用首选读取功能。">PREFERRED_READ.ENABLED</a> 。有关ASMCMD <code class="codeph">stamp</code>命令的信息，请参阅<a href="asmcmd-diskgroup-commands.html#GUID-B0ECE8DA-2C57-4973-875A-3083BDBBDB4F">戳记</a> 。
                  </p>
                  <p>对于<code class="codeph">EXTERNAL</code>冗余磁盘组，可以将<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">RENAME</code> <code class="codeph">DISK</code>与<code class="codeph">FAILGROUP</code>子句一起使用，以指定磁盘的故障组。例如：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DISKGROUP external1 RENAME DISK'EXTERNAL1_0001'FAILGROUP FG_EXT1_0001;</pre><p><code class="codeph">SITE</code>和<code class="codeph">FAILGROUP</code>子句不能在同一SQL <code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">RENAME</code>语句中一起使用。
                  </p>
                  <p>可以在<code class="codeph">renamedg</code>实用程序之后运行<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <span class="italic"><code class="codeph">diskgroupname</code></span> <code class="codeph">RENAME</code> <code class="codeph">DISKS</code> <code class="codeph">ALL</code>语句，以更改重命名的磁盘组中的磁盘名称。有关<code class="codeph">renamedg</code>信息，请参阅<a href="maintain-diskgroups.html#GUID-45A0F079-2D23-47D3-A366-569076D2F845">重命名磁盘组</a> 。
                  </p>
                  <p>当您运行<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <span class="italic"><code class="codeph">diskgroupname</code></span> <code class="codeph">RENAME</code> <code class="codeph">DISKS</code> <code class="codeph">ALL</code>语句时，任何不在<span class="italic"><code class="codeph">diskgroupname</code></span> <code class="codeph">_</code> <span class="italic"><code class="codeph">number</code></span>格式的磁盘名称将重命名为该格式。已更改为<span class="italic"><code class="codeph">diskgroupname</code></span> <code class="codeph">_</code> <span class="italic"><code class="codeph">number</code></span>格式的磁盘名称。
                  </p>
                  <div class="infoboxnote" id="GUID-A2E82BE6-BE5E-42F8-8723-03DF5CD55D90__GUID-C486A675-3B4B-4518-B932-BC1A267BBA14">
                     <p class="notep1">注意：</p>
                     <p>如果磁盘被任何子系统标记;例如ASMLIB，ASMFD，EXADATA或ASMTOOL;然后该标签成为设计的磁盘名称。这些子系统上的<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">RENAME</code> <code class="codeph">DISKS</code> SQL语句无效，磁盘未重命名。
                     </p>
                  </div>
               </div>
            </div><a id="OSTMG94114"></a><a id="OSTMG10222"></a><div class="props_rev_3"><a id="GUID-44160C76-20B6-40C8-82F8-FF332A28899E" name="GUID-44160C76-20B6-40C8-82F8-FF332A28899E"></a><h3 id="OSTMG-GUID-44160C76-20B6-40C8-82F8-FF332A28899E" class="sect3">从磁盘组中删除磁盘</h3>
               <div>
                  <p>您可以使用<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句的<code class="codeph">DROP</code> <code class="codeph">DISK</code>子句从磁盘组中<code class="codeph">DROP</code> <code class="codeph">DISK</code> 。
                  </p>
                  <p>您还可以使用<code class="codeph">DROP</code> <code class="codeph">DISKS</code> <code class="codeph">IN</code> <code class="codeph">FAILGROUP</code>子句<code class="codeph">DROP</code>指定故障组中的所有<code class="codeph">DISKS</code> 。
                  </p>
                  <p>删除磁盘后，通过将所有文件扩展区从已删除的磁盘移动到磁盘组中的其他磁盘来重新平衡磁盘组。如果其他磁盘上没有足够的可用空间，则磁盘操作可能会失败。最好的方法是使用相同的<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句执行添加和删除操作。这样做的好处是只重新平衡一次数据扩展区并确保有足够的空间使重新平衡操作成功。
                  </p>
                  <div class="infoboxnote" id="GUID-44160C76-20B6-40C8-82F8-FF332A28899E__GUID-39DB2D71-0053-4E3E-A002-BE17CCB3726F">
                     <p class="notep1">警告：</p>
                     <p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">...</code><code class="codeph">DROP</code> <code class="codeph">DISK</code> SQL语句在完成删除和重新平衡操作之前返回到SQL提示符。在<code class="codeph">V$ASM_DISK</code>视图中此磁盘的<code class="codeph">HEADER_STATUS</code>列更改为<code class="codeph">FORMER</code>之前，请勿重复使用，删除或断开已删除的磁盘。您可以查询<code class="codeph">V$ASM_OPERATION</code>视图以确定完成删除/重新平衡操作的剩余时间。
                     </p>
                  </div>
                  <p>如果为删除操作指定<code class="codeph">FORCE</code>子句，则即使Oracle ASM无法读取或写入磁盘，也会删除该磁盘。从外部冗余磁盘组中删除磁盘时，不能使用<code class="codeph">FORCE</code>标志。
                  </p>
                  <div class="infoboxnote" id="GUID-44160C76-20B6-40C8-82F8-FF332A28899E__GUID-E59172C2-CFA4-4F67-9FFF-0EECECC90A3C">
                     <p class="notep1">警告：</p>
                     <p><code class="codeph">DROP</code> <code class="codeph">FORCE</code>操作会以降低的冗余度<code class="codeph">FORCE</code>数据，直到后续的重新平衡操作完成。如果在重新平衡期间出现后续磁盘故障，则会增加数据丢失的风险。请谨慎使用<code class="codeph">DROP</code> <code class="codeph">FORCE</code> 。
                     </p>
                  </div>
                  <p><a href="alter-diskgroups.html#GUID-44160C76-20B6-40C8-82F8-FF332A28899E__CHDJIJEH">例4-6中</a>的语句演示了如何从磁盘组<code class="codeph">data1</code>删除磁盘。第一个示例从磁盘组<code class="codeph">data1</code>删除<code class="codeph">diska5</code> 。第二个示例从磁盘组<code class="codeph">data1</code>删除<code class="codeph">diska5</code> ，并说明了如何使用一个<code class="codeph">ALTER DISKGROUP</code>语句执行多个操作。
                  </p>
                  <div class="example" id="GUID-44160C76-20B6-40C8-82F8-FF332A28899E__CHDJIJEH">
                     <p class="titleinexample">示例4-6从磁盘组中删除磁盘</p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data1 DROP DISK diska5; ALTER DISKGROUP data1 DROP DISK diska5 ADD FAILGROUP failgrp1 DISK'/ devices / diska9'NAME diska9;</pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-44160C76-20B6-40C8-82F8-FF332A28899E__GUID-1358B594-B1E7-46B0-8BCE-97668088E2ED">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="manage-asm-asmca.html#GUID-F78B035C-168D-4CBB-B321-21BB57FED363" title="Oracle ASM Configuration Assistant enables you to configure or create Oracle ASM disk groups with the Configure ASM Disk Groups tab.">使用ASMCA管理磁盘组，</a>以获取有关<a href="manage-asm-asmca.html#GUID-F78B035C-168D-4CBB-B321-21BB57FED363" title="Oracle ASM Configuration Assistant使您可以使用“配置ASM磁盘组”选项卡配置或创建Oracle ASM磁盘组。">使用ASMCA</a>从磁盘组中删除磁盘的信息</p>
                           </li>
                           <li>
                              <p><a href="alter-diskgroups.html#GUID-7AED5447-C99B-4B7F-8196-CDA485BECA17">使用ALTER DISKGROUP SQL语句将磁盘添加到磁盘组</a>以获取<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句的示例</p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">V$ASM_OPERATION</code>视图的信息，请<a href="../refrn/V-ASM_OPERATION.html#REFRN30173" target="_blank"><span><cite>参见Oracle数据库参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL语句的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/ostmg&amp;id=SQLRF01113" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="OSTMG94116"></a><a id="OSTMG94115"></a><div class="props_rev_3"><a id="GUID-6AEFFA72-7BDC-4AA8-8667-8417AAF3DAC8" name="GUID-6AEFFA72-7BDC-4AA8-8667-8417AAF3DAC8"></a><h3 id="OSTMG-GUID-6AEFFA72-7BDC-4AA8-8667-8417AAF3DAC8" class="sect3">调整磁盘组中的磁盘大小</h3>
               <div>
                  <p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>的<code class="codeph">RESIZE</code>子句使您可以调整磁盘组中的磁盘大小。
                  </p>
                  <p>调整磁盘组中的磁盘大小时，所有磁盘的大小必须相同。</p>
                  <p>如果未在<code class="codeph">SIZE</code>子句中指定新大小，则Oracle ASM将使用操作系统返回的磁盘大小。新大小将写入Oracle ASM磁盘头，如果大小增加，则新空间可立即分配。如果大小正在减小，则重新平衡必须将文件范围重新定位超出新的大小限制，使其低于限制的可用空间。如果重新平衡操作可以成功重定位所有扩展区，则新大小将成为永久大小，否则重新平衡将失败。
                  </p>
                  <p>以下示例调整磁盘组<code class="codeph">data1</code>中的所有磁盘的大小。如果新大小大于磁盘容量，则语句将失败。
                  </p>
                  <div class="example" id="GUID-6AEFFA72-7BDC-4AA8-8667-8417AAF3DAC8__GUID-E0C60ADB-6559-4523-8D50-840F7BF70358">
                     <p class="titleinexample">示例4-7调整磁盘组中的磁盘大小</p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data1 RESIZE ALL SIZE 100G;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="OSTMG94118"></a><a id="OSTMG94117"></a><div class="props_rev_3"><a id="GUID-733B25C1-029C-452A-B19F-02FE2BD24ECB" name="GUID-733B25C1-029C-452A-B19F-02FE2BD24ECB"></a><h3 id="OSTMG-GUID-733B25C1-029C-452A-B19F-02FE2BD24ECB" class="sect3">磁盘组中的Undropping磁盘</h3>
               <div>
                  <p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句的<code class="codeph">UNDROP DISKS</code>子句使您可以取消磁盘组中所有挂起的磁盘丢弃。
                  </p>
                  <p>如果删除磁盘操作已完成，则不能使用此语句来还原它。此语句不能用于还原由于<code class="codeph">DROP</code> <code class="codeph">DISKGROUP</code>语句而被删除的磁盘，也不能用于使用<code class="codeph">FORCE</code>子句删除的磁盘。
                  </p>
                  <p>以下示例取消从磁盘组<code class="codeph">data1</code>删除磁盘：</p>
                  <div class="example" id="GUID-733B25C1-029C-452A-B19F-02FE2BD24ECB__GUID-099EAD78-1154-4570-BE27-D37FBC130B24">
                     <p class="titleinexample">示例4-8在磁盘组中取消磁盘</p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data1 UNDROP DISKS;</pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <div class="infoboxnote" id="GUID-733B25C1-029C-452A-B19F-02FE2BD24ECB__GUID-F696F7F3-84FD-4511-9FA6-2288B3E69BE2">
                        <p class="notep1">注意：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关<code class="codeph">DROP</code> <code class="codeph">DISKGROUP</code> SQL语句的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/ostmg&amp;id=SQLRF01517" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL语句的信息，请<a href="../sqlrf/ALTER-DISKGROUP.html#SQLRF01113" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="OSTMG94119"></a><a id="OSTMG10080"></a><div class="props_rev_3"><a id="GUID-020ABD10-8370-444C-9B44-71F2FF688861" name="GUID-020ABD10-8370-444C-9B44-71F2FF688861"></a><h3 id="OSTMG-GUID-020ABD10-8370-444C-9B44-71F2FF688861" class="sect3">手动重新平衡磁盘组</h3>
               <div>
                  <p>您可以使用<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句的<code class="codeph">REBALANCE</code>子句手动重新平衡磁盘组中的文件。
                  </p>
                  <p>通常不需要手动重新平衡，因为Oracle ASM会在配置更改时自动重新平衡磁盘组，包括对文件组的更改。但是，您可能希望执行手动重新平衡操作来控制自动重新平衡操作的速度。</p>
                  <p><code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <code class="codeph">REBALANCE</code>语句的<code class="codeph">POWER</code>子句指定并行度和重新平衡操作的速度。较高的值会增加重新平衡操作的速度。它可以设置为最小值<code class="codeph">0</code> ，这将停止重新平衡操作，直到隐式或显式重新运行该语句。
                  </p>
                  <p>默认重新平衡功率由<code class="codeph">ASM_POWER_LIMIT</code>初始化参数设置。对于<code class="codeph">ASM_POWER_LIMIT</code>初始化参数， <code class="codeph">POWER</code>子句的值范围相同。
                  </p>
                  <p>通过使用<code class="codeph">MODIFY</code> <code class="codeph">POWER</code>子句输入rebalance语句，可以更改正在进行的重新平衡操作的功率级别。例如，以下SQL语句将功率设置修改为正在进行的重新平衡的<code class="codeph">10</code> 。
                  </p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data2 REBALANCE MODIFY POWER 10;</pre><p>以下SQL语句将电源设置修改为默认值。</p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data2 REBALANCE MODIFY POWER;</pre><p>重新平衡磁盘组时，可以选择使用<code class="codeph">WITH</code>或<code class="codeph">WITHOUT</code>关键字选择以下阶段选项，除非另有说明：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">恢复</code></p>
                        <p><code class="codeph">RESTORE</code>阶段包括<code class="codeph">RESYNC</code> ， <code class="codeph">RESILVER</code>和<code class="codeph">REBUILD</code>操作。<code class="codeph">RESTORE</code>阶段始终默认运行，不能排除。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">RESYNC</code></p>
                              <p>此操作会同步正在联机的磁盘上的陈旧扩展区。</p>
                           </li>
                           <li>
                              <p><code class="codeph">重新同步</code></p>
                              <p>此操作仅适用于Exadata系统。在此阶段，数据将从一个镜像复制到具有过时数据的镜像。</p>
                           </li>
                           <li>
                              <p><code class="codeph">重建</code></p>
                              <p>此操作仅恢复强制磁盘的冗余。强制磁盘是那些使用force选项删除的磁盘。</p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p><code class="codeph">平衡</code></p>
                        <p>此阶段可恢复磁盘组中所有磁盘的冗余，包括文件组，还可以平衡Oracle ASM磁盘上的扩展区。</p>
                     </li>
                     <li>
                        <p><code class="codeph">准备</code></p>
                        <p>此阶段完成与准备SQL操作相对应的工作。此阶段仅对<code class="codeph">FLEX</code>或<code class="codeph">EXTENDED</code>冗余磁盘组启用。<code class="codeph">COMPATIBLE.ASM</code>必须设置为<code class="codeph">12.2</code>或更高。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">紧凑</code></p>
                        <p>此阶段对Oracle ASM磁盘中的扩展区进行碎片整理和压缩。</p>
                     </li>
                  </ul>
                  <p>重新平衡操作以最佳顺序执行阶段。如果没有使用<code class="codeph">ALTER DISKGROUP...指定相位<code class="codeph">ALTER DISKGROUP...REBALANCE</code> SQL语句，然后行为保持与Oracle ASM 12.2发行版之前的重新平衡操作相同，在此期间运行所有重新平衡阶段。
                  </p>
                  <p>以下示例显示了使用<code class="codeph">ALTER DISKGROUP...的阶段选项<code class="codeph">ALTER DISKGROUP...REBALANCE</code> ：</p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP数据2重新平衡与平衡紧凑; ALTER DISKGROUP数据3没有平衡的重置;</pre><p><code class="codeph">ALTER DISKGROUP...REBALANCE</code>命令默认立即返回，以便您可以在后台异步执行重新平衡操作时运行其他命令。您可以在<code class="codeph">V$ASM_OPERATION</code>视图中查询重新平衡操作的状态。如果未运行所有重新平衡阶段，则<code class="codeph">V$ASM_OPERATION</code>视图会在重新平衡结束时显示<code class="codeph">ORA-59000</code>错误。
                  </p>
                  <p>导致<code class="codeph">ALTER DISKGROUP...REBALANCE</code>命令在返回之前等待重新平衡操作完成，将<code class="codeph">WAIT</code>关键字添加到<code class="codeph">REBALANCE</code>子句。等待功能在脚本中特别有用。该命令还接受<code class="codeph">NOWAIT</code>关键字，该关键字调用异步执行重新平衡操作的默认行为。您可以通过在大多数平台上键入<code class="codeph">CTRL+C</code>来中断在等待模式下运行的重新平衡。这会导致命令立即返回消息<code class="codeph">ORA-01013: user requested cancel of current operation</code> ，然后异步继续重新平衡操作。
                  </p>
                  <p>重新平衡操作的其他规则包括以下内容：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果更改配置时存储配置发生更改，或者配置因故障或中断而发生更改，则会重新启动正在进行的重新平衡命令。此外，如果由于用户错误而导致新的重新平衡失败，则可能需要手动重新平衡。</p>
                     </li>
                     <li>
                        <p><code class="codeph">ALTER DISKGROUP...即使您使用的是Oracle Real Application Clusters（Oracle RAC）， REBALANCE</code>语句也会在单个节点上运行。
                        </p>
                     </li>
                     <li>
                        <p>Oracle ASM可以在给定实例上一次执行一个磁盘组重新平衡。如果您在单个节点上的不同磁盘组上启动了多个重新平衡，则Oracle会在其他节点上并行处理这些操作（如果可用）;否则，重新平衡在单个节点上串行执行。您可以并行显式地在不同节点上的不同磁盘组上启动重新平衡。</p>
                     </li>
                     <li>
                        <p>在执行重新平衡的Oracle ASM实例失败时，重新平衡仍在继续。</p>
                     </li>
                     <li>
                        <p><code class="codeph">REBALANCE</code>子句（及其关联的<code class="codeph">POWER</code>和<code class="codeph">WAIT/NOWAIT</code>关键字）也可用于添加，删除或调整磁盘大小的<code class="codeph">ALTER DISKGROUP</code>命令。
                        </p>
                        <div class="infoboxnote" id="GUID-020ABD10-8370-444C-9B44-71F2FF688861__GUID-B9A49E1D-493A-4B55-B4A6-0299C1C65EDB">
                           <p class="notep1">注意：</p>
                           <p>如果存储配置发生更改，Oracle将重新启动正在进行的重新平衡操作的处理。如果由于用户错误导致下一次重新平衡操作失败，则可能需要手动重新平衡。</p>
                        </div>
                     </li>
                  </ul>
                  <p>以下示例手动重新平衡磁盘组<code class="codeph">data2</code> 。在重新平衡操作完成之前，该命令不会返回。执行重新平衡操作的所有受支持阶段。请注意，不需要指定<code class="codeph">RESTORE</code>因为该阶段始终在重新平衡期间运行。
                  </p>
                  <div class="example" id="GUID-020ABD10-8370-444C-9B44-71F2FF688861__GUID-3105CA00-4A1C-4F2F-BC14-7075EFC29BFF">
                     <p class="titleinexample">示例4-9手动重新平衡磁盘组</p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP data2 REBALANCE RESTORE POWER 5 WAIT;</pre></div>
                  <!-- class="example" -->
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-020ABD10-8370-444C-9B44-71F2FF688861__GUID-945033EC-A428-419D-86FD-EF284C8A5FE7">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="init-params-asm-instance.html#GUID-BCA97B38-50AB-4B71-8D09-C67D8530D7BD" title="ASM_POWER_LIMIT初始化参数指定磁盘组中磁盘重新平衡的默认功率。">ASM_POWER_LIMIT</a>有关信息<code class="codeph">ASM_POWER_LIMIT</code>初始化参数</p>
                           </li>
                           <li>
                              <p><a href="alter-diskgroups.html#GUID-14E48E96-F5D6-4F41-A8E4-B535CBD3CAE5">调整重新平衡操作</a>以获取有关重新<a href="alter-diskgroups.html#GUID-14E48E96-F5D6-4F41-A8E4-B535CBD3CAE5">平衡操作</a>的信息</p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL语句的信息，请<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/ostmg&amp;id=SQLRF01113" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="OSTMG10221"></a><div class="props_rev_3"><a id="GUID-14E48E96-F5D6-4F41-A8E4-B535CBD3CAE5" name="GUID-14E48E96-F5D6-4F41-A8E4-B535CBD3CAE5"></a><h3 id="OSTMG-GUID-14E48E96-F5D6-4F41-A8E4-B535CBD3CAE5" class="sect3">调整再平衡操作</h3>
               <div>
                  <p></p>
                  <p>如果未在<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>语句中指定<code class="codeph">POWER</code>子句，或者通过添加或删除磁盘隐式运行重新平衡，则重新平衡功率默认为<code class="codeph">ASM_POWER_LIMIT</code>初始化参数的值。您可以动态调整此参数的值。对于<code class="codeph">ASM_POWER_LIMIT</code>初始化参数， <code class="codeph">POWER</code>子句的值范围相同。
                  </p>
                  <p>功率限制越高，重新平衡操作就越快完成。使用较低功率值进行重新平衡需要更长时间，但消耗的处理和I / O资源较少，这些资源由其他应用程序（如数据库）共享。</p>
                  <p>Oracle ASM尝试为每个单位的电源保持重新平衡I / O.每个I / O都需要PGA内存，以用于重定位所涉及的范围。</p>
                  <p>默认值<code class="codeph">1</code>最大限度地减少对其他应用程序的干扰。适当的值取决于您的硬件配置，性能要求和可用性要求。Oracle ASM始终调整功率以适应可用内存。
                  </p>
                  <p>当<code class="codeph">COMPATIBLE.ASM</code>磁盘组设置为<code class="codeph">11.2.0.2</code>或更高版本时，可以使用异步I / O将重新平衡操作作为一个进程运行。您可以查看Oracle ASM警报日志，以获取有关重新平衡过程的详细信息。
                  </p>
                  <p>如果由于手动或自动删除磁盘而正在进行重新平衡，则增加重新平衡的功能会缩短在其他磁盘上重建丢弃磁盘上的数据的冗余副本的时间范围。</p>
                  <p>您还可以使用<code class="codeph">CONTENT.CHECK</code>和<code class="codeph">THIN_PROVISIONED</code>磁盘组属性影响重新平衡行为。
                  </p>
                  <p><code class="codeph">EXPLAIN</code> <code class="codeph">WORK</code> SQL语句确定重新平衡操作的工作量，结果计算显示在<code class="codeph">V$ASM_ESTIMATE</code>视图中。
                  </p>
                  <p>例如：</p><pre class="oac_no_warn" dir="ltr">ALTER DISKGROUP数据的EXPLAIN WORK DROP DISK data_0000;解释。SELECT est_work FROM V $ ASM_ESTIMATE; EST_WORK -------- 4211 EXPLAIN WORK SET STATEMENT_ID ='online'FOR ALTER DISKGROUP data ONLINE disk data_000;解释。SELECT est_work FROM V $ ASM_ESTIMATE WHERE STATEMENT_ID ='online'; EST_WORK -------- 421</pre><p><code class="codeph">V$ASM_ESTIMATE</code>视图提供有关调整<code class="codeph">ASM_POWER_LIMIT</code>信息以及重新平衡操作的结果。<code class="codeph">EST_WORK</code>列提供了重新平衡操作必须移动以完成的分配单元数量的估计值。
                  </p>
                  <p><code class="codeph">V$ASM_OPERATION</code>的<code class="codeph">PASS</code>列已更新，用于重新同步和重新平衡操作。列的内容可以是<code class="codeph">RESYNC</code> ， <code class="codeph">REBALANCE</code>或<code class="codeph">COMPACT</code> 。例如，以下SQL查询在重新平衡操作期间显示<code class="codeph">PASS</code>列中的值。
                  </p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT GROUP_NUMBER，PASS，STATE FROM V $ ASM_OPERATION; GROUP_NUMBER PASS STAT ------------ --------- ---- 2 RESYNC WAIT 2 REBALANCE WAIT 2 COMPACT WAIT</pre><div class="infoboxnotealso" id="GUID-14E48E96-F5D6-4F41-A8E4-B535CBD3CAE5__GUID-5CA27D8E-955E-4407-959F-9A2813AE2281">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="init-params-asm-instance.html#GUID-BCA97B38-50AB-4B71-8D09-C67D8530D7BD" title="ASM_POWER_LIMIT初始化参数指定磁盘组中磁盘重新平衡的默认功率。">ASM_POWER_LIMIT</a>有关信息<code class="codeph">ASM_POWER_LIMIT</code>初始化参数</p>
                        </li>
                        <li>
                           <p><a href="manage-diskgroup-attributes.html#GUID-7A52077C-DCE5-44E0-BFA9-D30F485B8079" title="The CONTENT.CHECK attribute enables or disables content checking when performing data relocation operations for a disk group. The CONTENT_HARDCHECK.ENABLED disk group attribute enables or disables Hardware Assisted Resilient Data (HARD) checking when performing data copy operations for rebalancing a disk group. In an Oracle extended cluster, which contains nodes that span multiple physically separated sites, the PREFERRED_READ.ENABLED disk group attribute controls whether preferred read functionality is enabled for a disk group.">有关磁盘组属性</a>的信息<a href="manage-diskgroup-attributes.html#GUID-7A52077C-DCE5-44E0-BFA9-D30F485B8079" title="CONTENT.CHECK属性在执行磁盘组的数据重定位操作时启用或禁用内容检查。CONTENT_HARDCHECK.ENABLED磁盘组属性在执行用于重新平衡磁盘组的数据复制操作时启用或禁用硬件辅助弹性数据（HARD）检查。在包含跨多个物理上分离的站点的节点的Oracle扩展群集中，PREFERRED_READ.ENABLED磁盘组属性控制是否为磁盘组启用首选读取功能。">的磁盘组属性摘要</a></p>
                        </li>
                        <li>
                           <p>有关重新<a href="alter-diskgroups.html#GUID-020ABD10-8370-444C-9B44-71F2FF688861" title="You can manually rebalance the files in a disk group using the REBALANCE clause of the ALTER DISKGROUP statement.">平衡磁盘组</a>的详细信息，请<a href="alter-diskgroups.html#GUID-020ABD10-8370-444C-9B44-71F2FF688861" title="您可以使用ALTER DISKGROUP语句的REBALANCE子句手动重新平衡磁盘组中的文件。">手动重新</a>平衡磁盘组</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="OSTMG95351"></a><div class="props_rev_3"><a id="GUID-ECCAE4F3-CFC5-4B55-81D2-FFB6953C035C" name="GUID-ECCAE4F3-CFC5-4B55-81D2-FFB6953C035C"></a><h3 id="OSTMG-GUID-ECCAE4F3-CFC5-4B55-81D2-FFB6953C035C" class="sect3">清理磁盘组</h3>
               <div>
                  <p>Oracle ASM磁盘清理通过搜索可能不太可能被读取的数据来提高可用性和可靠性。磁盘清理检查逻辑数据损坏并在正常和高冗余磁盘组中自动进行修复。清理过程使用镜像磁盘修复逻辑损坏。磁盘清理可与磁盘组重新平衡相结合，以减少I / O资源。磁盘清理过程对生产系统中的常规I / O影响最小。</p>
                  <p>您可以使用<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> SQL语句对磁盘组，指定磁盘或磁盘组的指定文件执行清理。例如，以下SQL语句显示运行<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code> <span class="italic"><code class="codeph">disk_group</code></span> <code class="codeph">SCRUB</code> SQL语句时使用的各种选项。
                  </p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DISKGROUP数据SCRUB POWER LOW; SQL&gt; ALTER DISKGROUP数据SCRUB FILE'+ DATA / ORCL / DATAFILE / example.266.806582193'修复功率高强度; SQL&gt; ALTER DISKGROUP数据SCRUB DISK DATA_0005 REPAIR POWER HIGH FORCE;</pre><p>您可以使用<code class="codeph">STOP</code>选项停止正在进行的清理操作。
                  </p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER DISKGROUP数据SCRUB STOP;</pre><p>将<code class="codeph">ALTER</code> <code class="codeph">DISKGROUP</code>与<code class="codeph">SCRUB</code>选项一起使用时，以下项目适用：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>可选的<code class="codeph">REPAIR</code>选项可自动修复磁盘损坏。如果未指定<code class="codeph">REPAIR</code>选项，则<code class="codeph">SCRUB</code>选项仅检查并报告指定目标的逻辑损坏。
                        </p>
                     </li>
                     <li>
                        <p>可选的<code class="codeph">POWER</code>值可以设置为<code class="codeph">AUTO</code> ， <code class="codeph">LOW</code> ， <code class="codeph">HIGH</code>或<code class="codeph">MAX</code> 。如果未指定<code class="codeph">POWER</code>选项，则功率值默认为<code class="codeph">AUTO</code> ，并且功率调整为系统的最佳级别。
                        </p>
                     </li>
                     <li>
                        <p>如果指定了可选的<code class="codeph">WAIT</code>选项，则在擦洗操作完成后返回该命令。如果未指定<code class="codeph">WAIT</code>选项，则会将清理操作添加到清理队列中，并立即返回命令。
                        </p>
                     </li>
                     <li>
                        <p>如果指定了可选的<code class="codeph">FORCE</code>选项，则即使系统I / O负载较高或在系统级内部禁用了清理，也会处理该命令。
                        </p>
                     </li>
                  </ul>
                  <p>当清理过程正在运行时，清理过程在<code class="codeph">V$ASM_OPERATION</code>视图的字段中可见。
                  </p>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>