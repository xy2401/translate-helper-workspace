<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Oracle Virtual Private Database (VPD) enables you to filter users who access data."></meta>
      <meta name="description" content="Oracle Virtual Private Database (VPD) enables you to filter users who access data."></meta>
      <title>使用Oracle虚拟专用数据库控制数据访问</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Security Guide "></meta>
      <meta property="og:description" content="Oracle Virtual Private Database (VPD) enables you to filter users who access data."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Security Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-security-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-28T14:57:12-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96299-04"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="using-application-contexts-to-retrieve-user-information.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-transparent-sensitive-data-protection.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Security Guide"></meta>
    <meta name="dcterms.isVersionOf" content="DBSEG"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-application-contexts-to-retrieve-user-information.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-transparent-sensitive-data-protection.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">安全指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part_3.html" property="item" typeof="WebPage"><span property="name">控制对数据的访问</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用Oracle虚拟专用数据库控制数据访问</li>
            </ol>
            <a id="GUID-06022729-9210-4895-BF04-6177713C65A7" name="GUID-06022729-9210-4895-BF04-6177713C65A7"></a><a id="DBSEG007"></a>
            
            <h2 id="DBSEG-GUID-06022729-9210-4895-BF04-6177713C65A7" class="sect2"><span class="enumeration_chapter">12</span>使用Oracle虚拟专用数据库控制数据访问</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='using-oracle-vpd-to-control-data-access'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>Oracle虚拟专用数据库（VPD）使您可以过滤访问数据的用户。</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-8AB08B54-5858-4A6F-B1F2-43F7C5922DD8">关于Oracle虚拟专用数据库</a><br>Oracle虚拟专用数据库（VPD）为过滤用户对数据的访问提供了重要的好处。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-486517C7-EECD-4F1C-AA40-6C13C46565D3">Oracle虚拟专用数据库策略的组件</a><br>VPD策略使用函数生成动态<code class="codeph">WHERE</code>子句，以及将函数附加到要保护的对象的策略。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB">配置Oracle虚拟专用数据库策略</a><br><code class="codeph">DBMS_RLS</code> PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-2113CF3C-D950-40B3-A121-A44284EF104D">教程：创建Oracle虚拟专用数据库策略</a><br>这些教程展示了如何创建简单的基于数据库会话的Oracle虚拟专用策略，以及如何创建策略组。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-496F4B53-7206-4CDF-8F45-016067D0303D">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</a><br>您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-09300037-0440-4212-B28A-1EABEA6ABDB2">Oracle虚拟专用数据库数据字典视图</a><br>Oracle数据库提供了列出有关Oracle虚拟专用数据库策略的信息的数据字典视图。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="part_3.html" title="第III部分介绍了如何控制对数据的访问。">控制对数据的访问</a></p>
                  </div>
               </div>
            </div>
            <a id="DBSEG80081"></a><div class="props_rev_3"><a id="GUID-8AB08B54-5858-4A6F-B1F2-43F7C5922DD8" name="GUID-8AB08B54-5858-4A6F-B1F2-43F7C5922DD8"></a><h3 id="DBSEG-GUID-8AB08B54-5858-4A6F-B1F2-43F7C5922DD8" class="sect3">关于Oracle虚拟专用数据库</h3>
               <div>
                  <p>Oracle虚拟专用数据库（VPD）为过滤用户对数据的访问提供了重要的好处。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-4F37BAE5-CA2E-42AC-9CDF-EC9181671FFE">什么是Oracle虚拟专用数据库？</a><br>Oracle虚拟专用数据库（VPD）创建安全策略以控制行和列级别的数据库访问。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-AE9A0A2A-0F0B-4410-BB54-AECD6AE068BD">使用Oracle虚拟专用数据库策略的好处</a><br>Oracle虚拟专用数据库策略提供了重要的好处。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-7E73FA77-9056-41A7-8062-7F22D035F364">谁可以创建Oracle虚拟专用数据库策略？</a><br><code class="codeph">DBMS_RLS</code> PL / SQL包使您可以创建VPD策略。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-6F30A5EA-87A9-4D8B-8DBA-789704E8400F">运行Oracle虚拟专用数据库策略功能的权限</a><br>您应该了解运行Oracle虚拟专用数据库（VPD）策略功能的正确权限。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-36849380-3641-4485-B03F-3D494158BAB3">Oracle Virtual Private Database与应用程序上下文一起使用</a><br>您可以将应用程序上下文与Oracle虚拟专用数据库策略一起使用。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-E6343F14-933E-4980-A67A-D5AAEC5743C5">多租户环境中的Oracle虚拟专用数据库</a><br> <span>您可以在应用程序根目录中创建虚拟专用数据库策略，以便在任何关联的应用程序PDB中使用。</span></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-06022729-9210-4895-BF04-6177713C65A7" title="Oracle虚拟专用数据库（VPD）使您可以过滤访问数据的用户。">使用Oracle虚拟专用数据库控制数据访问</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG235"></a><div class="props_rev_3"><a id="GUID-4F37BAE5-CA2E-42AC-9CDF-EC9181671FFE" name="GUID-4F37BAE5-CA2E-42AC-9CDF-EC9181671FFE"></a><h4 id="DBSEG-GUID-4F37BAE5-CA2E-42AC-9CDF-EC9181671FFE" class="sect4">什么是Oracle虚拟专用数据库？</h4>
                  <div>
                     <p>Oracle虚拟专用数据库（VPD）创建安全策略以控制行和列级别的数据库访问。</p>
                     <div class="infoboxnote" id="GUID-4F37BAE5-CA2E-42AC-9CDF-EC9181671FFE__GUID-CC44D99A-1031-411E-B725-04DC6A003550">
                        <p class="notep1">注意：</p>
                        <p>Oracle Database 12c版引入了Real Application Security（RAS）来取代VPD。 Oracle建议您将RAS用于需要对其应用程序执行行级和列级访问控制的新项目。</p>
                     </div>
                     <p>实质上，Oracle虚拟专用数据库将SQL动态<code class="codeph">WHERE</code>子句添加到针对应用了Oracle虚拟专用数据库安全策略的表，视图或同义词发出的SQL语句。
                     </p>
                     <p>Oracle虚拟专用数据库直接在数据库表，视图或同义词上实施精确的粒度级别的安全性。由于您将安全策略直接附加到这些数据库对象，并且每当用户访问数据时都会自动应用策略，因此无法绕过安全性。</p>
                     <p>当用户直接或间接访问受Oracle虚拟专用数据库策略保护的表，视图或同义词时，Oracle数据库会动态修改用户的SQL语句。此修改创建由实现安全策略的函数返回的<code class="codeph">WHERE</code>条件（称为谓词）。Oracle数据库使用可以在函数中表达或返回的任何条件，以动态，透明的方式修改语句。您可以将Oracle虚拟专用数据库策略应用于<code class="codeph">SELECT</code> ， <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">INDEX</code>和<code class="codeph">DELETE</code>语句。
                     </p>
                     <p>例如，假设用户执行以下查询：</p><pre class="pre codeblock"><code>SELECT * FROM OE.ORDERS;</code></pre><p>Oracle虚拟专用数据库策略使用<code class="codeph">WHERE</code>子句动态附加语句。例如：</p><pre class="pre codeblock"><code>SELECT * FROM OE.ORDERS WHERE SALES_REP_ID = 159;</code></pre><p>在该示例中，用户只能按销售代表159查看订单。</p>
                     <p>如果要根据该用户的会话信息（例如用户的ID）过滤用户，则可以创建<code class="codeph">WHERE</code>子句以使用应用程序上下文。例如：</p><pre class="pre codeblock"><code>SELECT * FROM OE.ORDERS WHERE SALES_REP_ID = SYS_CONTEXT（'USERENV'，'SESSION_USER'）;</code></pre><div class="infoboxnote" id="GUID-4F37BAE5-CA2E-42AC-9CDF-EC9181671FFE__GUID-6C59F3CD-71C6-4728-AA45-A01CE1527BEE">
                        <p class="notep1">注意：</p>
                        <p>Oracle虚拟专用数据库不支持对DDL进行过滤，例如<code class="codeph">TRUNCATE</code>或<code class="codeph">ALTER TABLE</code>语句。
                        </p>
                     </div>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="configuring-audit-policies.html#GUID-DA5EB801-5B3E-4CA2-8B75-E03874E76607" title="统一审计跟踪自动捕获Oracle虚拟专用数据库（VPD）策略中使用的谓词。">审计Oracle虚拟专用数据库谓词</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8AB08B54-5858-4A6F-B1F2-43F7C5922DD8" title="Oracle虚拟专用数据库（VPD）为过滤用户对数据的访问提供了重要的好处。">关于Oracle虚拟专用数据库</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG236"></a><div class="props_rev_3"><a id="GUID-AE9A0A2A-0F0B-4410-BB54-AECD6AE068BD" name="GUID-AE9A0A2A-0F0B-4410-BB54-AECD6AE068BD"></a><h4 id="DBSEG-GUID-AE9A0A2A-0F0B-4410-BB54-AECD6AE068BD" class="sect4">使用Oracle虚拟专用数据库策略的好处</h4>
                  <div>
                     <p>Oracle虚拟专用数据库策略提供了重要的好处。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-C21458A6-65DE-4F32-9210-789F5531CB7D">基于数据库对象而不是应用程序的安全策略</a><br>Oracle虚拟专用数据库在安全性，简单性和灵活性方面具有优势。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-2F856DCB-BEE1-45D0-88E2-B3D10CB55644">控制Oracle数据库如何评估策略功能</a><br>多次运行策略功能会影响性能。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8AB08B54-5858-4A6F-B1F2-43F7C5922DD8" title="Oracle虚拟专用数据库（VPD）为过滤用户对数据的访问提供了重要的好处。">关于Oracle虚拟专用数据库</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG237"></a><div class="props_rev_3"><a id="GUID-C21458A6-65DE-4F32-9210-789F5531CB7D" name="GUID-C21458A6-65DE-4F32-9210-789F5531CB7D"></a><h5 id="DBSEG-GUID-C21458A6-65DE-4F32-9210-789F5531CB7D" class="sect5">基于数据库对象而不是应用程序的安全策略</h5>
                     <div>
                        <p>Oracle虚拟专用数据库在安全性，简单性和灵活性方面具有优势。</p>
                        <p>将Oracle虚拟专用数据库安全策略附加到数据库表，视图或同义词，而不是在所有应用程序中实现访问控制，可提供以下好处：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">安全。</span> 将策略与数据库表，视图或同义词相关联可以解决潜在的严重应用程序安全问题。假设用户有权使用应用程序，然后利用与该应用程序关联的权限，使用即席查询工具（如SQL * Plus）错误地修改数据库。通过将安全策略直接附加到表，视图或同义词，无论用户如何访问数据，细粒度的访问控制都可确保相同的安全性生效。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">简单。</span> 您只需将安全策略添加到表，视图或同义词一次，而不是将其重复添加到每个基于表，基于视图或基于同义词的应用程序中。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">灵活性。</span> 您可以为<code class="codeph">SELECT</code>语句设置一个安全策略，为<code class="codeph">INSERT</code>语句设置另一个安全策略，对<code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>语句设置其他策略。例如，您可能希望启用人力资源职员对其部门中的所有员工记录具有<code class="codeph">SELECT</code>权限，但仅更新其姓氏以<code class="codeph">A</code>到<code class="codeph">F</code>开头的部门中的员工的工资。此外，您可以为每个表，视图或同义词创建多个策略。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-AE9A0A2A-0F0B-4410-BB54-AECD6AE068BD" title="Oracle虚拟专用数据库策略提供了重要的好处。">使用Oracle虚拟专用数据库策略的好处</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG238"></a><div class="props_rev_3"><a id="GUID-2F856DCB-BEE1-45D0-88E2-B3D10CB55644" name="GUID-2F856DCB-BEE1-45D0-88E2-B3D10CB55644"></a><h5 id="DBSEG-GUID-2F856DCB-BEE1-45D0-88E2-B3D10CB55644" class="sect5">控制Oracle数据库如何评估策略功能</h5>
                     <div>
                        <p>多次运行策略功能会影响性能。</p>
                        <p>您可以通过配置Oracle数据库缓存Oracle虚拟专用数据库谓词的方式来控制策略功能的性能。</p>
                        <p>可以使用以下选项：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>为每个查询评估策略一次（静态策略）。</p>
                           </li>
                           <li>
                              <p>仅当策略功能中的应用程序上下文发生更改（上下文相关策略）时才评估策略。</p>
                           </li>
                           <li>
                              <p>每次运行时评估策略（动态策略）。</p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-AE9A0A2A-0F0B-4410-BB54-AECD6AE068BD" title="Oracle虚拟专用数据库策略提供了重要的好处。">使用Oracle虚拟专用数据库策略的好处</a></p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div><a id="DBSEG884"></a><div class="props_rev_3"><a id="GUID-7E73FA77-9056-41A7-8062-7F22D035F364" name="GUID-7E73FA77-9056-41A7-8062-7F22D035F364"></a><h4 id="DBSEG-GUID-7E73FA77-9056-41A7-8062-7F22D035F364" class="sect4">谁可以创建Oracle虚拟专用数据库策略？</h4>
                  <div>
                     <p><code class="codeph">DBMS_RLS</code> PL / SQL包使您可以创建VPD策略。
                     </p>
                     <p>已获得<code class="codeph">DBMS_RLS</code> PL / SQL包的<code class="codeph">EXECUTE</code>特权的用户可以创建Oracle虚拟专用数据库策略。与所有权限一样，仅将此权限授予受信任的用户。您可以通过查询<span class="apiname" translate="no">DBA_SYS_PRIVS</span>数据字典视图找到已授予用户的权限。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8AB08B54-5858-4A6F-B1F2-43F7C5922DD8" title="Oracle虚拟专用数据库（VPD）为过滤用户对数据的访问提供了重要的好处。">关于Oracle虚拟专用数据库</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG239"></a><div class="props_rev_3"><a id="GUID-6F30A5EA-87A9-4D8B-8DBA-789704E8400F" name="GUID-6F30A5EA-87A9-4D8B-8DBA-789704E8400F"></a><h4 id="DBSEG-GUID-6F30A5EA-87A9-4D8B-8DBA-789704E8400F" class="sect4">运行Oracle虚拟专用数据库策略功能的权限</h4>
                  <div>
                     <p>您应该了解运行Oracle虚拟专用数据库（VPD）策略功能的正确权限。</p>
                     <p>为了提高安全性，Oracle虚拟专用数据库策略函数的运行就像使用definer权限声明一样。</p>
                     <p>不要将其声明为调用者的权利，因为这可能会使您自己和维护代码的其他用户感到困惑。</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-6F30A5EA-87A9-4D8B-8DBA-789704E8400F__GUID-A0EB17CF-46F2-40B1-9C4E-77C30CA7F2B3">
                        <p class="notep1">也可以看看：</p>
                        <p>有关定义者权限的详细信息，请<a href="../lnpls/plsql-subprograms.html#LNPLS00809" target="_blank"><span><cite>参见Oracle Database PL / SQL语言参考</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8AB08B54-5858-4A6F-B1F2-43F7C5922DD8" title="Oracle虚拟专用数据库（VPD）为过滤用户对数据的访问提供了重要的好处。">关于Oracle虚拟专用数据库</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG240"></a><div class="props_rev_3"><a id="GUID-36849380-3641-4485-B03F-3D494158BAB3" name="GUID-36849380-3641-4485-B03F-3D494158BAB3"></a><h4 id="DBSEG-GUID-36849380-3641-4485-B03F-3D494158BAB3" class="sect4">Oracle Virtual Private Database与应用程序上下文一起使用</h4>
                  <div>
                     <p>您可以将应用程序上下文与Oracle虚拟专用数据库策略一起使用。</p>
                     <p>创建应用程序上下文时，它会安全地缓存用户信息。只有指定的应用程序包才能设置缓存环境。它不能由用户或包外更改。此外，由于数据被缓存，性能会提高。</p>
                     <p>例如，假设您希望基于客户ID号对<code class="codeph">ORDERS_TAB</code>表进行访问。您可以将数字存储在应用程序上下文中，而不是在每次需要时查询登录用户的客户ID号。然后，客户编号在您需要时可在会话中使用。
                     </p>
                     <p>如果您的安全策略基于多个安全属性，则应用程序上下文特别有用。例如，如果策略函数将<code class="codeph">WHERE</code>谓词基于四个属性（例如员工编号，成本中心，职位，支出限制），则必须执行多个子查询以检索此信息。相反，如果通过应用程序上下文提供此数据，则性能会更快。
                     </p>
                     <p>您可以使用应用程序上下文来返回通过谓词强制执行的正确安全策略。例如，考虑一个强制执行以下规则的订单输入应用程序：客户只能看到自己的订单，而职员会查看所有客户的所有订单。这是两个不同的政策。您可以使用<code class="codeph">position</code>属性定义应用程序上下文，并且可以在policy函数中访问此属性以返回正确的谓词，具体取决于属性的值。因此，您可以使<code class="codeph">clerk</code>在<code class="codeph">clerk</code>位置检索所有订单，但<code class="codeph">customer</code>位置的用户只能看到与该特定用户关联的那些记录。
                     </p>
                     <p>要设计返回属性的特定谓词的细粒度访问控制策略，您需要访问实现策略的函数中的应用程序上下文。例如，假设您希望限制客户只看到自己的记录。用户执行以下查询：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM orders_tab</pre><p>细粒度访问控制动态修改此查询以包括以下<code class="codeph">WHERE</code>谓词：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM orders_tab WHERE custno = SYS_CONTEXT（'order_entry'，'cust_num'）;</pre><p>继续前面的示例，假设您有50,000个客户，并且您不希望为每个客户返回不同的谓词。客户都共享相同的<code class="codeph">WHERE</code>谓词，规定他们只能看到自己的订单。仅仅是他们的客户数量不同。
                     </p>
                     <p>使用应用程序上下文，您可以在适用于50,000个客户的策略函数中返回一个<code class="codeph">WHERE</code>谓词。因此，有一个共享游标对每个客户执行不同的操作，因为客户编号在执行时进行评估。每个客户的价值都不同。在这种情况下，应用程序上下文的使用可提供最佳性能，并具有行级安全性。
                     </p>
                     <p><code class="codeph">SYS_CONTEXT</code>函数的工作方式与绑定变量非常相似;只有<code class="codeph">SYS_CONTEXT</code>参数是常量。
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="using-application-contexts-to-retrieve-user-information.html#GUID-51C9D5FA-6787-4F05-82EF-A5968BEDC5A0" title="应用程序上下文存储可以启用或阻止用户访问数据库中的数据的用户标识。">使用应用程序上下文来检索用户信息</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8AB08B54-5858-4A6F-B1F2-43F7C5922DD8" title="Oracle虚拟专用数据库（VPD）为过滤用户对数据的访问提供了重要的好处。">关于Oracle虚拟专用数据库</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DBSEG592"></a><div class="props_rev_3"><a id="GUID-E6343F14-933E-4980-A67A-D5AAEC5743C5" name="GUID-E6343F14-933E-4980-A67A-D5AAEC5743C5"></a><h4 id="DBSEG-GUID-E6343F14-933E-4980-A67A-D5AAEC5743C5" class="sect4">多租户环境中的Oracle虚拟专用数据库</h4>
                  <div>
                     <p> <span>您可以在应用程序根目录中创建虚拟专用数据库策略，以便在任何关联的应用程序PDB中使用。</span></p>
                     <p>CDB限制也适用于与虚拟专用数据库策略相关的共享上下文敏感策略和视图。您无法为整个多租户环境创建虚拟专用数据库策略。</p>
                     <p>对于应用程序容器，您可以通过将公共策略应用于属于应用程序根目录的所有PDB来创建虚拟专用数据库策略以保护应用程序公共对象。换句话说，在应用程序根目录中安装应用程序时，保护公共对象的所有常见虚拟专用数据库策略都将应用于应用程序容器中的所有PDB并立即强制执行。</p>
                     <p>请注意以下事项：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您只能在应用程序根目录中创建公共虚拟专用数据库策略及其关联的PL / SQL功能，并且只能将其附加到应用程序公共对象。如果该函数与策略不在同一位置，则会在运行时引发错误。</p>
                        </li>
                        <li>
                           <p>应用于公共对象的虚拟专用数据库策略被视为一种通用策略，当从应用程序PDB访问应用程序公共对象时，该策略将在属于应用程序容器的PDB中自动实施。</p>
                        </li>
                        <li>
                           <p>应用程序通用虚拟专用数据库策略只能保护应用程序公共对</p>
                        </li>
                        <li>
                           <p>应用于应用程序根目录中的应用程序公共对象并应用于所有应用程序PDB的虚拟专用数据库策略被视为常见的虚拟专用数据库策略。应用于本地数据库表并在一个PDB中强制执行的策略被视为本地虚拟专用数据库策略。</p>
                           <p>例如，如果将策略<code class="codeph">VPD_P1</code>应用于应用程序根目录中的应用程序公用表<code class="codeph">T1</code> ，则将其视为公共策略。它将在每个应用程序PDB中强制执行。如果一个名为政策<code class="codeph">VPD_P1</code>应用于称为本地表<code class="codeph">T1</code>在<code class="codeph">PDB1</code> ，那么它被认为是一个本地策略，这意味着它仅影响<code class="codeph">PDB1</code> 。如果将名为<code class="codeph">VPD_P1</code>的策略应用于应用程序根目录中的本地表<code class="codeph">T1</code> ，则它仍被视为本地策略，因为它仅影响应用程序根目录。此概念适用于其他操作，例如启用，禁用和删除虚拟专用数据库策略。
                           </p>
                        </li>
                        <li>
                           <p>应用程序通用虚拟专用数据库策略仅保护应用程序公共对象，而本地虚拟专用数据库策略仅保护本地对象</p>
                        </li>
                        <li>
                           <p>如果您正在使用应用程序上下文，则确保在公共虚拟专用数据库配置中使用基于公共数据库会话的应用程序上下文和公共全局应用程序上下文对象。</p>
                        </li>
                        <li>
                           <p>应用程序容器Virtual Private Database策略存储在应用程序根目录中。PDB仅存储本地策略。如果将PDB插入应用程序容器，则公共策略不会转换为本地策略。相反，Oracle数据库从应用程序根目录加载它们，并在策略访问本地PDB中的公共对象时在本地PDB中强制执行它们。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8AB08B54-5858-4A6F-B1F2-43F7C5922DD8" title="Oracle虚拟专用数据库（VPD）为过滤用户对数据的访问提供了重要的好处。">关于Oracle虚拟专用数据库</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DBSEG241"></a><div class="props_rev_3"><a id="GUID-486517C7-EECD-4F1C-AA40-6C13C46565D3" name="GUID-486517C7-EECD-4F1C-AA40-6C13C46565D3"></a><h3 id="DBSEG-GUID-486517C7-EECD-4F1C-AA40-6C13C46565D3" class="sect3">Oracle虚拟专用数据库策略的组件</h3>
               <div>
                  <p>VPD策略使用函数生成动态<code class="codeph">WHERE</code>子句，以及将函数附加到要保护的对象的策略。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-532B05E7-2E08-4D8A-96B0-7F6EDD75DD14">生成动态WHERE子句的函数</a><br>Oracle虚拟专用数据库（VPD）功能定义了您要强制执行的限制。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-B90B6F53-66D4-4DDA-AB5B-8974E3F15DD7">将功能附加到要保护的对象的策略</a><br>Oracle虚拟专用数据库策略将VPD功能与表，视图或同义词相关联。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-06022729-9210-4895-BF04-6177713C65A7" title="Oracle虚拟专用数据库（VPD）使您可以过滤访问数据的用户。">使用Oracle虚拟专用数据库控制数据访问</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG242"></a><div class="props_rev_3"><a id="GUID-532B05E7-2E08-4D8A-96B0-7F6EDD75DD14" name="GUID-532B05E7-2E08-4D8A-96B0-7F6EDD75DD14"></a><h4 id="DBSEG-GUID-532B05E7-2E08-4D8A-96B0-7F6EDD75DD14" class="sect4">生成动态WHERE子句的函数</h4>
                  <div>
                     <p>Oracle虚拟专用数据库（VPD）功能定义了您要强制执行的限制。</p>
                     <p>要生成Oracle虚拟专用数据库（VPD）动态<code class="codeph">WHERE</code>子句（谓词），您必须创建定义这些限制的函数（而不是过程）。
                     </p>
                     <p>通常，安全性管理员在其自己的架构中创建此功能。对于更复杂的行为，例如包括对其他函数的调用或添加检查以跟踪失败的登录尝试，请在包中创建这些函数。</p>
                     <p>该函数必须具有以下行为：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">它必须将模式名称和对象（表，视图或同义词）名称作为参数作为输入。</span> 定义输入参数以保存此信息，但不要在函数内指定模式和对象名称。使用<code class="codeph">DBMS_RLS</code>程序包创建的策略（在<a href="using-oracle-vpd-to-control-data-access.html#GUID-B90B6F53-66D4-4DDA-AB5B-8974E3F15DD7" title="Oracle虚拟专用数据库策略将VPD功能与表，视图或同义词相关联。">将功能附加到要保护的对象的策略中</a>描述）提供了模式的名称以及将应用策略的对象。您必须首先为架构创建参数，然后是对象的参数。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">它必须为将生成的WHERE子句谓词提供返回值。</span> <code class="codeph">WHERE</code>子句的返回值始终是<code class="codeph">VARCHAR2</code>数据类型。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">它必须生成有效的WHERE子句。</span> 此代码可以与<a href="using-oracle-vpd-to-control-data-access.html#GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5" title="本教程介绍如何使用OE用户帐户创建简单的Oracle虚拟专用数据库策略。">教程：创建简单Oracle虚拟专用数据库策略中</a>的示例一样基本，因为其<code class="codeph">WHERE</code>子句对于所有登录的用户都是相同的。
                           </p>
                           <p>但在大多数情况下，您可能希望将<code class="codeph">WHERE</code>子句设计为每个用户，每组用户或访问要保护的对象的每个应用程序都不同。例如，如果管理员登录，则<code class="codeph">WHERE</code>子句可以特定于该特定管理器的权限。您可以通过将访问用户会话信息的应用程序上下文合并到<code class="codeph">WHERE</code>子句生成代码中来实现此目的。<a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a>演示了如何创建使用应用程序上下文的Oracle虚拟专用数据库策略。
                           </p>
                           <p>您可以创建不使用应用程序上下文的Oracle虚拟专用数据库功能，但应用程序上下文通过安全地基于该用户的会话属性（例如用户ID）进行用户访问来创建更强大的Oracle虚拟专用数据库策略。 <a href="using-application-contexts-to-retrieve-user-information.html#GUID-51C9D5FA-6787-4F05-82EF-A5968BEDC5A0" title="应用程序上下文存储可以启用或阻止用户访问数据库中的数据的用户标识。">使用应用程序上下文来检索用户信息</a> ，详细讨论了不同类型的应用程序上下文。
                           </p>
                           <p>此外，您可以嵌入C或Java调用来访问操作系统信息或从操作系统文件或其他源返回<code class="codeph">WHERE</code>子句。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">它不能从关联策略函数中的表中进行选择。</span> 虽然您可以针对表定义策略，但是无法从针对表定义的策略中选择该表。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">它必须是纯粹的功能。</span> VPD函数必须仅依赖于应用程序上下文和传递给函数的参数来生成<code class="codeph">WHERE</code>子句。此函数不得依赖于包变量。
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-532B05E7-2E08-4D8A-96B0-7F6EDD75DD14__GUID-9D8BABA9-F280-4A10-89FF-29F8F6391D65">
                        <p class="notep1">注意：</p>
                        <p>如果您计划跨不同版本运行该功能，则可以控制该功能的结果：所有版本的结果是否一致，或者特定于运行该功能的版本。有关详细信息，请参阅<a href="using-application-contexts-to-retrieve-user-information.html#GUID-075BCAB6-8462-4825-B738-B81F31DF033A" title="全局应用程序上下文包，Oracle虚拟专用数据库包和细粒度审计策略可用于多个版本。">版本如何影响全局应用程序上下文PL / SQL包的结果</a> 。
                        </p>
                     </div>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-486517C7-EECD-4F1C-AA40-6C13C46565D3" title="VPD策略使用函数生成动态WHERE子句，以及将函数附加到要保护的对象的策略。">Oracle虚拟专用数据库策略的组件</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG243"></a><div class="props_rev_3"><a id="GUID-B90B6F53-66D4-4DDA-AB5B-8974E3F15DD7" name="GUID-B90B6F53-66D4-4DDA-AB5B-8974E3F15DD7"></a><h4 id="DBSEG-GUID-B90B6F53-66D4-4DDA-AB5B-8974E3F15DD7" class="sect4">将功能附加到要保护的对象的策略</h4>
                  <div>
                     <p>Oracle虚拟专用数据库策略将VPD功能与表，视图或同义词相关联。</p>
                     <p>您可以使用<code class="codeph">DBMS_RLS</code>包创建策略。如果您不是<code class="codeph">SYS</code> ，则必须授予您<code class="codeph">EXECUTE</code>特权才能使用<code class="codeph">DBMS_RLS</code>包。此程序包包含的过程使您可以管理策略并设置细粒度的访问控制。例如，要将策略附加到表，请使用<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程。在此设置中，您可以设置细粒度的访问控制，例如将策略设置为在用户在表或视图上发出<code class="codeph">SELECT</code>或<code class="codeph">UPDATE</code>语句时生效。
                     </p>
                     <p>创建函数然后将其应用于表或视图的组合称为创建Oracle虚拟专用数据库策略。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" title="DBMS_RLS PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。">配置Oracle虚拟专用数据库策略</a></li>
                           <li><a href="using-oracle-vpd-to-control-data-access.html#GUID-2113CF3C-D950-40B3-A121-A44284EF104D" title="这些教程展示了如何创建简单的基于数据库会话的Oracle虚拟专用策略，以及如何创建策略组。">教程：创建Oracle虚拟专用数据库策略</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-486517C7-EECD-4F1C-AA40-6C13C46565D3" title="VPD策略使用函数生成动态WHERE子句，以及将函数附加到要保护的对象的策略。">Oracle虚拟专用数据库策略的组件</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="DBSEG244"></a><div class="props_rev_3"><a id="GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" name="GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB"></a><h3 id="DBSEG-GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" class="sect3">配置Oracle虚拟专用数据库策略</h3>
               <div>
                  <p><code class="codeph">DBMS_RLS</code> PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-2E214F39-0739-4578-B3F9-36AC93E110CD">关于Oracle虚拟专用数据库策略</a><br>Oracle虚拟专用数据库策略将VPD功能与数据库表，视图或同义词相关联。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-FEEE8343-84E9-4BE7-B638-7DBE0C6ED815">将策略附加到数据库表，视图或同义词</a><br><code class="codeph">DBMS_RLS</code> PL / SQL包可以将策略附加到表，视图或同义词。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-2355CB50-CBF4-4C93-B207-FEF549B4FE13">示例：将简单Oracle虚拟专用数据库策略附加到表</a><br><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以将Oracle虚拟专用数据库（VPD）策略附加到表，视图或同义词。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-B05F730E-45C2-4071-8A0F-A69AD7516C66">对特定SQL语句类型实施策略</a><br>您可以为<code class="codeph">SELECT</code> ， <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">INDEX</code>和<code class="codeph">DELETE</code>语句强制实施Oracle虚拟专用数据库策略。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-C2AE2671-5B09-42DB-82C3-44320CBE4501">示例：使用DBMS_RLS.ADD_POLICY指定SQL语句类型</a><br><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程<code class="codeph">statement_types</code>参数可以指定策略的<code class="codeph">SELECT</code>和<code class="codeph">INDEX</code>语句。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-1E2916F5-7DB8-48C4-B274-5C0EF931F218">使用策略控制列数据的显示</a><br>您可以创建在查询中引用安全相关列时强制执行行级安全性的策略。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-011EB74C-42DD-4817-A847-5BB28D67F6BE">Oracle虚拟专用数据库策略组</a><br>Oracle虚拟专用数据库策略组是可以应用于应用程序的VPD策略的命名集合。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD">使用Oracle虚拟专用数据库策略类型优化性能</a><br>您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-06022729-9210-4895-BF04-6177713C65A7" title="Oracle虚拟专用数据库（VPD）使您可以过滤访问数据的用户。">使用Oracle虚拟专用数据库控制数据访问</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG246"></a><a id="DBSEG245"></a><div class="props_rev_3"><a id="GUID-2E214F39-0739-4578-B3F9-36AC93E110CD" name="GUID-2E214F39-0739-4578-B3F9-36AC93E110CD"></a><h4 id="DBSEG-GUID-2E214F39-0739-4578-B3F9-36AC93E110CD" class="sect4">关于Oracle虚拟专用数据库策略</h4>
                  <div>
                     <p>Oracle虚拟专用数据库策略将VPD功能与数据库表，视图或同义词相关联。</p>
                     <p>此函数定义Oracle Virtual Private Database <code class="codeph">WHERE</code>子句的操作。然后，您必须将此功能与Oracle虚拟专用数据库（VPD）操作所适用的数据库表相关联。
                     </p>
                     <p>您可以通过配置Oracle虚拟专用数据库策略来执行此操作。策略本身是一种管理虚拟专用数据库功能的机制。该策略还允许您添加细粒度的访问控制，例如指定策略影响的SQL语句类型或特定表列。当用户尝试访问此数据库对象中的数据时，该策略将自动生效。</p>
                     <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-2E214F39-0739-4578-B3F9-36AC93E110CD__G1015641" title="此表列出了为DBMS_RLS程序包定义的过程及其用途。">表12-1</a>列出了<code class="codeph">DBMS_RLS</code>包中的过程。
                     </p>
                     <div class="tblformal" id="GUID-2E214F39-0739-4578-B3F9-36AC93E110CD__G1015641">
                        <p class="titleintable">表12-1 DBMS_RLS过程</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_RLS程序" width="100%" border="1" summary="This table lists the procedures that have been defined for the DBMS_RLS package and their purpose." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="58%" id="d94784e2487">程序</th>
                                 <th align="left" valign="bottom" width="42%" id="d94784e2490">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2495" headers="d94784e2487 ">
                                    <p><span class="bold">处理个人政策</span></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2495 d94784e2490 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2503" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.ADD_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2503 d94784e2490 ">
                                    <p>将策略添加到表，视图或同义词</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2511" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.ENABLE_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2511 d94784e2490 ">
                                    <p>启用（或禁用）先前添加到表，视图或同义词的策略</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2519" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.ALTER_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2519 d94784e2490 ">
                                    <p>更改现有策略以将属性与策略关联或取消关联</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2527" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.REFRESH_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2527 d94784e2490 ">
                                    <p>使与非静态策略关联的游标无效</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2535" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.DROP_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2535 d94784e2490 ">
                                    <p>从表，视图或同义词中删除策略</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2543" headers="d94784e2487 ">
                                    <p><span class="bold">用于处理分组策略</span></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2543 d94784e2490 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2551" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.CREATE_POLICY_GROUP</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2551 d94784e2490 ">
                                    <p>创建一个策略组</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2559" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.ALTER_GROUPED_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2559 d94784e2490 ">
                                    <p>改变政策小组</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2567" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.DELETE_POLICY_GROUP</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2567 d94784e2490 ">
                                    <p>删除策略组</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2575" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.ADD_GROUPED_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2575 d94784e2490 ">
                                    <p>将策略添加到指定的策略组</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2584" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.ENABLE_GROUPED_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2584 d94784e2490 ">
                                    <p>在组内启用策略</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2592" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.REFRESH_GROUPED_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2592 d94784e2490 ">
                                    <p>再次解析与刷新策略关联的SQL语句</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2600" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.DISABLE_GROUPED_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2600 d94784e2490 ">
                                    <p>禁用组内的策略</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2608" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.DROP_GROUPED_POLICY</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2608 d94784e2490 ">
                                    <p>删除作为指定组成员的策略</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2616" headers="d94784e2487 ">
                                    <p><span class="bold">用于处理应用程序上下文</span></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2616 d94784e2490 ">
                                    <p>-</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2624" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.ADD_POLICY_CONTEXT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2624 d94784e2490 ">
                                    <p>添加活动应用程序的上下文</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="58%" id="d94784e2632" headers="d94784e2487 ">
                                    <p><code class="codeph">DBMS_RLS.DROP_POLICY_CONTEXT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="42%" headers="d94784e2632 d94784e2490 ">
                                    <p>删除应用程序的上下文</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="using-oracle-vpd-to-control-data-access.html#GUID-486517C7-EECD-4F1C-AA40-6C13C46565D3" title="VPD策略使用函数生成动态WHERE子句，以及将函数附加到要保护的对象的策略。">Oracle虚拟专用数据库策略的组件</a></li>
                           <li><a href="using-application-contexts-to-retrieve-user-information.html#GUID-51C9D5FA-6787-4F05-82EF-A5968BEDC5A0" title="应用程序上下文存储可以启用或阻止用户访问数据库中的数据的用户标识。">使用应用程序上下文来检索用户信息</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" title="DBMS_RLS PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。">Oracle虚拟专用数据库策略的配置</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DBSEG247"></a><div class="sect3"><a id="GUID-FEEE8343-84E9-4BE7-B638-7DBE0C6ED815" name="GUID-FEEE8343-84E9-4BE7-B638-7DBE0C6ED815"></a><h4 id="DBSEG-GUID-FEEE8343-84E9-4BE7-B638-7DBE0C6ED815" class="sect4">将策略附加到数据库表，视图或同义词</h4>
                  <div>
                     <p><code class="codeph">DBMS_RLS</code> PL / SQL包可以将策略附加到表，视图或同义词。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>要将策略附加到数据库表，视图或同义词，请使用<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程。
                           </p>
                        </li>
                     </ul>
                     <p>您必须指定要添加策略的表，视图或同义词，以及策略的名称。您还可以指定其他信息，例如策略控制的语句类型（ <code class="codeph">SELECT</code> ， <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">DELETE</code> ， <code class="codeph">CREATE INDEX</code>或<code class="codeph">ALTER INDEX</code> ）。
                     </p>
                     <p>请遵循以下准则：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果已将视图创建为扩展数据链接对象，则Oracle建议您对此类视图应用与在视图的基础对象上应用相同的VPD策略。</p>
                        </li>
                        <li>
                           <p>确定要添加VPD策略的基础对象是否具有依赖对象。如果它具有依赖对象，则在将VPD策略添加到基础对象时这些对象将变为无效，并且这些对象在使用时将自动重新编译。</p>
                           <p>或者，您可以使用<code class="codeph">ALTER ...主动自行重新编译它们<code class="codeph">ALTER ...COMPILE</code>声明。请注意，使相关对象无效（通过在其基础对象上添加VPD策略）并导致需要重新编译它们会降低整个系统的性能。Oracle建议您仅在非高峰时段或计划停机期间向具有依赖对象的对象添加VPD策略。
                           </p>
                        </li>
                        <li>
                           <p>请注意，可以为单个对象创建的最大策略数为255。</p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" title="DBMS_RLS PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。">Oracle虚拟专用数据库策略的配置</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG248"></a><div class="props_rev_3"><a id="GUID-2355CB50-CBF4-4C93-B207-FEF549B4FE13" name="GUID-2355CB50-CBF4-4C93-B207-FEF549B4FE13"></a><h4 id="DBSEG-GUID-2355CB50-CBF4-4C93-B207-FEF549B4FE13" class="sect4">示例：将简单Oracle虚拟专用数据库策略附加到表</h4>
                  <div>
                     <p><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以将Oracle虚拟专用数据库（VPD）策略附加到表，视图或同义词。
                     </p>
                     <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-2355CB50-CBF4-4C93-B207-FEF549B4FE13__CIHDDEEA">示例12-1</a>显示了如何使用<code class="codeph">DBMS_RLS.ADD_POLICY</code>将名为<code class="codeph">secure_update</code>的Oracle虚拟专用数据库策略<code class="codeph">secure_update</code>到<code class="codeph">HR.EMPLOYEES</code>表。附加到策略的功能是<code class="codeph">check_updates</code> 。
                     </p>
                     <div class="example" id="GUID-2355CB50-CBF4-4C93-B207-FEF549B4FE13__CIHDDEEA">
                        <p class="titleinexample">示例12-1将简单Oracle虚拟专用数据库策略附加到表</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'hr'，object_name =&gt;'employees'，policy_name =&gt;'secure_update'，policy_function =&gt;'check_updates'，...
</pre><p>如果函数是在包内创建的，请包含包名称。例如：</p><pre class="oac_no_warn" dir="ltr">policy_function =&gt;'pkg.check_updates'，...</pre><p>虽然您可以针对表定义策略，但是无法从针对表定义的策略中选择该表。</p>
                     </div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" title="DBMS_RLS PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。">Oracle虚拟专用数据库策略的配置</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG249"></a><div class="props_rev_3"><a id="GUID-B05F730E-45C2-4071-8A0F-A69AD7516C66" name="GUID-B05F730E-45C2-4071-8A0F-A69AD7516C66"></a><h4 id="DBSEG-GUID-B05F730E-45C2-4071-8A0F-A69AD7516C66" class="sect4">对特定SQL语句类型实施策略</h4>
                  <div>
                     <p>您可以为<code class="codeph">SELECT</code> ， <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code> ， <code class="codeph">INDEX</code>和<code class="codeph">DELETE</code>语句强制实施Oracle虚拟专用数据库策略。
                     </p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p>要为策略指定SQL语句类型，请使用<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程中的<code class="codeph">statement_types</code>参数。如果要指定多个，请用逗号分隔每个。将列表括在一对单引号中。
                              </p>
                           </li>
                        </ul>
                        <p>如果未指定语句类型，则默认情况下，Oracle数据库指定<code class="codeph">SELECT</code> ， <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code> ，但不指定<code class="codeph">INDEX</code> 。您可以输入这些语句类型的任意组合。
                        </p>
                        <p>指定<code class="codeph">statement_types</code>参数时，请注意以下功能：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">受虚拟专用数据库策略影响的应用程序代码可以包含MERGE INTO语句。</span> 但是，在虚拟专用数据库策略中，必须确保<code class="codeph">statement_types</code>参数包含策略成功的所有三个<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>语句。或者，您可以省略<code class="codeph">statement_types</code>参数。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">请注意，具有维护索引权限的用户可以查看所有行数据，即使用户在常规查询（如SELECT）下没有完整的表访问权限也是如此。</span>例如，用户可以创建基于函数的索引，该索引包含以列值作为参数的用户定义函数。在创建索引期间，Oracle数据库会将每行的列值传递到用户函数中，从而使行数据可供创建索引的用户使用。您可以通过使用<code class="codeph">statement_types</code>参数指定<code class="codeph">INDEX</code>来对索引维护操作强制实施Oracle虚拟专用数据库策略。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" title="DBMS_RLS PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。">Oracle虚拟专用数据库策略的配置</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG250"></a><div class="sect3"><a id="GUID-C2AE2671-5B09-42DB-82C3-44320CBE4501" name="GUID-C2AE2671-5B09-42DB-82C3-44320CBE4501"></a><h4 id="DBSEG-GUID-C2AE2671-5B09-42DB-82C3-44320CBE4501" class="sect4">示例：使用DBMS_RLS.ADD_POLICY指定SQL语句类型</h4>
                  <div>
                     <p><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程<code class="codeph">statement_types</code>参数可以指定策略的<code class="codeph">SELECT</code>和<code class="codeph">INDEX</code>语句。
                     </p>
                     <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-C2AE2671-5B09-42DB-82C3-44320CBE4501__CIHEBBHG">例12-2</a>显示了它的工作原理。
                     </p>
                     <div class="example" id="GUID-C2AE2671-5B09-42DB-82C3-44320CBE4501__CIHEBBHG">
                        <p class="titleinexample">示例12-2使用DBMS_RLS.ADD_POLICY指定SQL语句类型</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'hr'，object_name =&gt;'employees'，policy_name =&gt;'secure_update'，policy_function =&gt;'check_updates'， <span class="bold">statement_types =&gt;'SELECT，INDEX'</span> ）;结束; /</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" title="DBMS_RLS PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。">Oracle虚拟专用数据库策略的配置</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG251"></a><div class="props_rev_3"><a id="GUID-1E2916F5-7DB8-48C4-B274-5C0EF931F218" name="GUID-1E2916F5-7DB8-48C4-B274-5C0EF931F218"></a><h4 id="DBSEG-GUID-1E2916F5-7DB8-48C4-B274-5C0EF931F218" class="sect4">使用策略控制列数据的显示</h4>
                  <div>
                     <p>您可以创建在查询中引用安全相关列时强制执行行级安全性的策略。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-C9F08971-13FD-4FD1-A584-41B9F35BC8A3">列级Oracle虚拟专用数据库的策略</a><br>当查询引用与安全相关的列时，列级策略会强制执行行级安全性。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-795AC2AA-BC7C-4D39-807F-945583803D29">示例：创建列级Oracle虚拟专用数据库策略</a><br><span class="apiname" translate="no">CREATE FUNCTION</span>语句和<span class="apiname" translate="no">DBMS_RLS.ADD_POLICY</span>过程可以配置列级Oracle虚拟专用数据库策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-7984D9DD-6987-42A7-9C42-4ECFA07F27E1">仅显示与查询相关的列行</a><br>默认情况下，列级Oracle虚拟专用数据库限制查询返回的行数，该行引用包含敏感信息的列。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-AE56264C-72D0-4965-8B6A-DA687FB6CFAE">列掩码将敏感列显示为NULL值</a><br>如果查询引用了敏感列，则默认情况下，列级Oracle虚拟专用数据库会限制返回的行数。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-47EE56EE-FEB6-41DA-8620-43D717621DF5">示例：将列掩码添加到Oracle虚拟专用数据库策略</a><br><span class="apiname" translate="no">DBMS_RLS.ADD_POLICY</span>过程可以配置列级Oracle虚拟专用数据库列屏蔽。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" title="DBMS_RLS PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。">Oracle虚拟专用数据库策略的配置</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG252"></a><div class="sect4"><a id="GUID-C9F08971-13FD-4FD1-A584-41B9F35BC8A3" name="GUID-C9F08971-13FD-4FD1-A584-41B9F35BC8A3"></a><h5 id="DBSEG-GUID-C9F08971-13FD-4FD1-A584-41B9F35BC8A3" class="sect5">列级Oracle虚拟专用数据库的策略</h5>
                     <div>
                        <p>当查询引用与安全相关的列时，列级策略会强制执行行级安全性。</p>
                        <p>您可以将列级Oracle虚拟专用数据库策略应用于表和视图，但不应用于同义词。要将策略应用于列，请使用<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程的<code class="codeph">SEC_RELEVANT_COLS</code>参数指定与安全相关的列。只要在查询中显式或隐式引用列，此参数就会应用安全策略。
                        </p>
                        <p>例如，通常不允许不在人力资源部门的用户查看他们自己的社会安全号码。销售员发起以下查询：</p><pre class="oac_no_warn" dir="ltr">SELECT fname，lname，ssn FROM emp;</pre><p>实现安全策略的函数返回谓词<code class="codeph">ssn='my_ssn</code> '。Oracle数据库重写查询并执行以下操作：</p><pre class="oac_no_warn" dir="ltr">SELECT fname，lname，ssn FROM emp WHERE ssn ='my_ssn';</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-1E2916F5-7DB8-48C4-B274-5C0EF931F218" title="您可以创建在查询中引用安全相关列时强制执行行级安全性的策略。">使用策略控制列数据的显示</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG253"></a><div class="props_rev_3"><a id="GUID-795AC2AA-BC7C-4D39-807F-945583803D29" name="GUID-795AC2AA-BC7C-4D39-807F-945583803D29"></a><h5 id="DBSEG-GUID-795AC2AA-BC7C-4D39-807F-945583803D29" class="sect5">示例：创建列级Oracle虚拟专用数据库策略</h5>
                     <div>
                        <p><span class="apiname" translate="no">CREATE FUNCTION</span>语句和<span class="apiname" translate="no">DBMS_RLS.ADD_POLICY</span>过程可以配置列级Oracle虚拟专用数据库策略。
                        </p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-795AC2AA-BC7C-4D39-807F-945583803D29__I1014790">示例12-3</a>显示了Oracle虚拟专用数据库策略，其中销售部门用户无法查看销售部门用户的部门（部门编号30）之外的人员的工资。该政策的相关栏目是<code class="codeph">sal</code>和<code class="codeph">comm</code> 。首先，创建Oracle Virtual Private Database策略函数，然后使用<code class="codeph">DBMS_RLS</code> PL / SQL包添加它。
                        </p>
                        <div class="example" id="GUID-795AC2AA-BC7C-4D39-807F-945583803D29__I1014790">
                           <p class="titleinexample">示例12-3创建列级Oracle虚拟专用数据库策略</p><pre class="oac_no_warn" dir="ltr">创建或替换函数hide_sal_comm（v_schema IN VARCHAR2，v_objname IN VARCHAR2）RETURN VARCHAR2 AS con VARCHAR2（200）; BEGIN con：='deptno = 30';返回（con）; END hide_sal_comm;</pre><p>然后使用<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程配置策略，如下所示：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'scott'，object_name =&gt;'emp'，policy_name =&gt;'hide_sal_policy'，policy_function =&gt;'hide_sal_comm'， <span class="bold">sec_relevant_cols =&gt;'sal，comm'）;</span>结束;</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-1E2916F5-7DB8-48C4-B274-5C0EF931F218" title="您可以创建在查询中引用安全相关列时强制执行行级安全性的策略。">使用策略控制列数据的显示</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG254"></a><div class="props_rev_3"><a id="GUID-7984D9DD-6987-42A7-9C42-4ECFA07F27E1" name="GUID-7984D9DD-6987-42A7-9C42-4ECFA07F27E1"></a><h5 id="DBSEG-GUID-7984D9DD-6987-42A7-9C42-4ECFA07F27E1" class="sect5">仅显示与查询相关的列行</h5>
                     <div>
                        <p>默认情况下，列级Oracle虚拟专用数据库限制查询返回的行数，该行引用包含敏感信息的列。</p>
                        <p>您可以使用<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程的<code class="codeph">SEC_RELEVANT_COLUMNS</code>参数指定这些与安全相关的列，如<a href="using-oracle-vpd-to-control-data-access.html#GUID-795AC2AA-BC7C-4D39-807F-945583803D29__I1014790">例12-3</a>所示。
                        </p>
                        <p>例如，考虑具有<code class="codeph">emp</code>表的<code class="codeph">SELECT</code>权限的销售部门用户，该权限受<a href="using-oracle-vpd-to-control-data-access.html#GUID-795AC2AA-BC7C-4D39-807F-945583803D29__I1014790">实例12-3中</a>创建的列级Oracle虚拟专用数据库策略的保护。用户（例如，用户<code class="codeph">SCOTT</code> ）运行以下查询：</p><pre class="oac_no_warn" dir="ltr">SELECT ENAME，d.dname，JOB，SAL，COMM FROM emp e，dept d WHERE d.deptno = e.deptno;</pre><p>数据库返回以下行：</p><pre class="oac_no_warn" dir="ltr">ENAME DNAME JOB SAL COMM ---------- -------------- --------- ----------  - -------- ALLEN SALES SALESMAN 1600 300 WARD SALES SALESMAN 1250 500 MARTIN SALES SALESMAN 1250 1400 BLAKE SALES MANAGER 2850 TURNER SALES SALESMAN 1500 0 JAMES SALES CLERK 950 6行入选。
</pre><p>显示的唯一行是用户有权访问行中所有列的行。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-1E2916F5-7DB8-48C4-B274-5C0EF931F218" title="您可以创建在查询中引用安全相关列时强制执行行级安全性的策略。">使用策略控制列数据的显示</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG255"></a><div class="props_rev_3"><a id="GUID-AE56264C-72D0-4965-8B6A-DA687FB6CFAE" name="GUID-AE56264C-72D0-4965-8B6A-DA687FB6CFAE"></a><h5 id="DBSEG-GUID-AE56264C-72D0-4965-8B6A-DA687FB6CFAE" class="sect5">列掩码将敏感列显示为NULL值</h5>
                     <div>
                        <p>如果查询引用了敏感列，则默认情况下，列级Oracle虚拟专用数据库会限制返回的行数。</p>
                        <p>使用列掩码行为时，所有行都会显示，甚至是那些引用敏感列的行。但是，敏感列显示为<code class="codeph">NULL</code>值。要启用列掩码，请设置<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程的<code class="codeph">SEC_RELEVANT_COLS_opt</code>参数。
                        </p>
                        <p>例如，考虑前一个示例中描述的销售员查询的结果。如果使用了列掩码，则代替只查看包含销售员的详细信息和社会安全号的行，职员将看到<code class="codeph">emp</code>表中的所有行，但<code class="codeph">ssn</code>列值将返回为<code class="codeph">NULL</code> 。请注意，此行为与所有其他类型的Oracle虚拟专用数据库策略根本不同，后者仅返回行的子集。
                        </p>
                        <p>与列级Oracle虚拟专用数据库的默认操作相反，列掩码显示所有行，但将敏感列值返回为<code class="codeph">NULL</code> 。要在策略中包含列掩码，请将<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程的<code class="codeph">SEC_RELEVANT_COLS_OPT</code>参数设置为<code class="codeph">DBMS_RLS.ALL_ROWS</code> 。</p>
                        <p>以下注意事项适用于列掩码：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>列掩码仅适用于<code class="codeph">SELECT</code>语句。
                              </p>
                           </li>
                           <li>
                              <p>与常规Oracle虚拟专用数据库谓词不同，策略函数生成的列掩码条件必须是简单的布尔表达式。</p>
                           </li>
                           <li>
                              <p>对于执行计算或不期望<code class="codeph">NULL</code>值的应用程序，请使用标准列级Oracle虚拟专用数据库，指定<code class="codeph">SEC_RELEVANT_COLS</code>而不是<code class="codeph">SEC_RELEVANT_COLS_OPT</code>列屏蔽选项。
                              </p>
                           </li>
                           <li>
                              <p>不要在<code class="codeph">sec_relevant_cols</code>设置中包含对象数据类型的列（包括<code class="codeph">XMLtype</code> ）。<code class="codeph">sec_relevant_cols</code>设置不支持此列类型。
                              </p>
                           </li>
                           <li>
                              <p>与<code class="codeph">UPDATE AS SELECT</code>一起使用的列掩码仅更新允许用户查看的列。
                              </p>
                           </li>
                           <li>
                              <p>对于某些查询，列掩码可能会阻止某些行显示。例如：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM emp WHERE sal = 10;</pre><p>由于已设置了列掩码选项，因此如果<code class="codeph">salary</code>列返回<code class="codeph">NULL</code>值，则此查询可能不会返回行。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-1E2916F5-7DB8-48C4-B274-5C0EF931F218" title="您可以创建在查询中引用安全相关列时强制执行行级安全性的策略。">使用策略控制列数据的显示</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG256"></a><div class="props_rev_3"><a id="GUID-47EE56EE-FEB6-41DA-8620-43D717621DF5" name="GUID-47EE56EE-FEB6-41DA-8620-43D717621DF5"></a><h5 id="DBSEG-GUID-47EE56EE-FEB6-41DA-8620-43D717621DF5" class="sect5">示例：将列掩码添加到Oracle虚拟专用数据库策略</h5>
                     <div>
                        <p><span class="apiname" translate="no">DBMS_RLS.ADD_POLICY</span>过程可以配置列级Oracle虚拟专用数据库列屏蔽。
                        </p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-47EE56EE-FEB6-41DA-8620-43D717621DF5__I1014928">示例12-4</a>显示了列级Oracle虚拟专用数据库列掩码。它使用与<a href="using-oracle-vpd-to-control-data-access.html#GUID-795AC2AA-BC7C-4D39-807F-945583803D29" title="The CREATE FUNCTION statement and the DBMS_RLS.ADD_POLICY procedure can configure a column-level Oracle Virtual Private Database policy.">示例</a>相同的VPD策略<a href="using-oracle-vpd-to-control-data-access.html#GUID-795AC2AA-BC7C-4D39-807F-945583803D29" title="CREATE FUNCTION语句和DBMS_RLS.ADD_POLICY过程可以配置列级Oracle虚拟专用数据库策略。">：创建列级Oracle虚拟专用数据库策略</a> ，但将<code class="codeph">sec_relevant_cols_opt</code>指定为<code class="codeph">DBMS_RLS.ALL_ROWS</code> 。</p>
                        <div class="example" id="GUID-47EE56EE-FEB6-41DA-8620-43D717621DF5__I1014928">
                           <p class="titleinexample">示例12-4将列掩码添加到Oracle虚拟专用数据库策略</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'scott'，object_name =&gt;'emp'，policy_name =&gt;'hide_sal_policy'，policy_function =&gt;'hide_sal_comm'，sec_relevant_cols =&gt;'sal，comm'，sec_relevant_cols_opt =&gt; dbms_rls。ALL_ROWS）;结束;</pre><p>假设对<code class="codeph">emp</code>表具有<code class="codeph">SELECT</code>权限的销售部门用户（例如用户<code class="codeph">SCOTT</code> ）运行以下查询：</p><pre class="oac_no_warn" dir="ltr">SELECT ENAME，d.dname，job，sal，comm FROM emp e，dept d WHERE d.deptno = e.deptno;</pre><p>数据库返回查询中指定的所有行，但由于Oracle虚拟专用数据库策略而屏蔽了某些值：</p><pre class="oac_no_warn" dir="ltr">ENAME DNAME JOB SAL COMM ---------- -------------- --------- ----------  - -------- CLARK会计经理KING会计总裁MILLER会计秘书JONES研究经理FORD研究分析员ADAMS研究秘书SMITH研究秘书SCOTT研究分析员销售销售员1250 500 TURNER SALES SALESMAN 1500 0 ALLEN SALES SALESMAN 1600 300 JAMES SALES CLERK选择950 BLAKE SALES MANAGER 2850 MARTIN SALES SALESMAN 1250 1400 14行。
</pre><p>列掩码返回销售用户查询请求的所有行，但是对销售部门外的员工使<code class="codeph">sal</code>和<code class="codeph">comm</code> <code class="codeph">NULL</code> 。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-1E2916F5-7DB8-48C4-B274-5C0EF931F218" title="您可以创建在查询中引用安全相关列时强制执行行级安全性的策略。">使用策略控制列数据的显示</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="DBSEG257"></a><div class="props_rev_3"><a id="GUID-011EB74C-42DD-4817-A847-5BB28D67F6BE" name="GUID-011EB74C-42DD-4817-A847-5BB28D67F6BE"></a><h4 id="DBSEG-GUID-011EB74C-42DD-4817-A847-5BB28D67F6BE" class="sect4">Oracle虚拟专用数据库策略组</h4>
                  <div>
                     <p>Oracle虚拟专用数据库策略组是可以应用于应用程序的VPD策略的命名集合。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-87EA1733-CB75-487C-B773-FE5676185F5C">关于Oracle虚拟专用数据库策略组</a><br>您可以将多个安全策略组合在一起，并将它们应用于应用程序。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-2D0E2295-C768-466E-8CCA-22A531B36B26">创建新的Oracle虚拟专用数据库策略组</a><br><code class="codeph">DBMS_RLS.ADD_GROUPED_POLICY</code>过程将VPD策略添加到VPD策略组。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-1A70422F-26C3-4A38-A0BE-6C3B9388635C">具有SYS_DEFAULT策略组的默认策略组</a><br>在一组安全策略中，您可以将一个安全策略指定为默认安全策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-4E7285B9-220D-499D-9F22-586E7DED2311">每个表，视图或同义词的多个策略</a><br>您可以为同一个表，视图或同义词建立多个策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-A11B72DE-18B8-44A3-8E04-851247175B35">验证用于连接到数据库的应用程序</a><br>实现驱动上下文的包必须正确验证用于连接到数据库的应用程序。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" title="DBMS_RLS PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。">Oracle虚拟专用数据库策略的配置</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG258"></a><div class="props_rev_3"><a id="GUID-87EA1733-CB75-487C-B773-FE5676185F5C" name="GUID-87EA1733-CB75-487C-B773-FE5676185F5C"></a><h5 id="DBSEG-GUID-87EA1733-CB75-487C-B773-FE5676185F5C" class="sect5">关于Oracle虚拟专用数据库策略组</h5>
                     <div>
                        <p>您可以将多个安全策略组合在一起，并将它们应用于应用程序。</p>
                        <p>策略组是属于应用程序的一组安全策略。您可以指定应用程序上下文（称为<span class="italic">驱动上下文</span>或<span class="italic">策略上下文</span> ）以指示有效的策略组。然后，当用户访问表，视图或同义词列时，Oracle数据库会查找驱动上下文以确定有效的策略组。它强制执行属于策略组的所有关联策略。
                        </p>
                        <p>策略组对于具有多个安全策略的多个应用程序共享相同的表，视图或同义词的情况非常有用。这使您可以识别在访问表，视图或同义词时应该生效的策略。</p>
                        <p>例如，在托管环境中，公司A可以为公司B和公司C托管<code class="codeph">BENEFIT</code>表。该表由两个不同的应用程序（人力资源和财务）访问，具有两个不同的安全策略。人力资源应用程序根据公司的排名授权用户，而财务应用程序根据部门授权用户。将这两项政策整合到<code class="codeph">BENEFIT</code>表中需要两家公司共同制定政策，这不是一个可行的选择。通过定义应用程序上下文来驱动对基础对象的特定策略集的实施，每个应用程序可以实现一组私有安全策略。
                        </p>
                        <p>为此，您需要将安全策略组织到组中。通过引用应用程序上下文，Oracle数据库确定哪些策略组应在运行时生效。服务器强制执行属于该策略组的所有策略。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-011EB74C-42DD-4817-A847-5BB28D67F6BE" title="Oracle虚拟专用数据库策略组是可以应用于应用程序的VPD策略的命名集合。">Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG259"></a><div class="props_rev_3"><a id="GUID-2D0E2295-C768-466E-8CCA-22A531B36B26" name="GUID-2D0E2295-C768-466E-8CCA-22A531B36B26"></a><h5 id="DBSEG-GUID-2D0E2295-C768-466E-8CCA-22A531B36B26" class="sect5">创建新的Oracle虚拟专用数据库策略组</h5>
                     <div>
                        <p><code class="codeph">DBMS_RLS.ADD_GROUPED_POLICY</code>过程将VPD策略添加到VPD策略组。
                        </p>
                        <p>要指定哪些策略有效，可以使用<code class="codeph">DBMS_RLS.ADD_POLICY_CONTEXT</code>过程添加驱动上下文。如果驱动上下文返回未知策略组，则返回错误。
                        </p>
                        <p>如果未定义驱动上下文，则Oracle数据库将运行所有策略。同样，如果驱动上下文为<code class="codeph">NULL</code> ，则强制执行所有策略组的策略。访问数据的应用程序无法绕过安全设置模块（设置应用程序上下文）以避免任何适用的策略。
                        </p>
                        <p>您可以将多个驾驶上下文应用于同一个表，视图或同义词，并且每个都将单独处理。这使您可以配置要强制执行的多个活动策略集。</p>
                        <p>例如，考虑托管公司和托管公司，托管公司共享一些数据库对象。两个应用程序都使用<code class="codeph">SYS_DEFAULT</code>策略组中的<code class="codeph">SUBSCRIBER</code>策略进行托管。数据访问首先由订户ID分区，然后根据用户是否正在访问福利或财务应用程序（由驾驶上下文确定）进行分区。假设使用托管服务的公司A想要应用仅与其自己的数据访问相关的自定义策略。您可以添加其他驾驶上下文（例如<code class="codeph">COMPANY A SPECIAL</code> ）以确保仅为公司A的数据访问应用其他特殊策略组。您不会在<code class="codeph">SUBSCRIBER</code>策略下应用此策略，因为该策略仅与A公司相关，并且将基本主机策略与其他策略隔离更有效。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-011EB74C-42DD-4817-A847-5BB28D67F6BE" title="Oracle虚拟专用数据库策略组是可以应用于应用程序的VPD策略的命名集合。">Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG260"></a><div class="props_rev_3"><a id="GUID-1A70422F-26C3-4A38-A0BE-6C3B9388635C" name="GUID-1A70422F-26C3-4A38-A0BE-6C3B9388635C"></a><h5 id="DBSEG-GUID-1A70422F-26C3-4A38-A0BE-6C3B9388635C" class="sect5">具有SYS_DEFAULT策略组的默认策略组</h5>
                     <div>
                        <p>在一组安全策略中，您可以将一个安全策略指定为默认安全策略。</p>
                        <p>这在您按应用程序对安全策略进行分区的情况下非常有用，因此它们始终有效。默认安全策略使开发人员能够在所有条件下实施安全实施，同时按应用程序（使用安全组）对安全策略进行分区，可以在默认安全策略之上分层额外的特定于应用程序的安全性。要实施默认安全策略，请将策略添加到<code class="codeph">SYS_DEFAULT</code>策略组。
                        </p>
                        <p>在该组中为特定表，视图或同义词定义的策略与驱动上下文指定的策略组一起运行。如前所述，驱动上下文是指示有效的策略组的应用程序上下文。<code class="codeph">SYS_DEFAULT</code>策略组可能包含也可能不包含策略。您不能删除<code class="codeph">SYS_DEFAULT</code>策略组。如果这样做，那么Oracle数据库会显示错误。
                        </p>
                        <p>如果向<code class="codeph">SYS_DEFAULT</code>策略组添加与两个或多个对象关联的策略，则每个对象将具有与之关联的单独<code class="codeph">SYS_DEFAULT</code>策略组。例如， <code class="codeph">scott</code>模式中的<code class="codeph">emp</code>表具有一个<code class="codeph">SYS_DEFAULT</code>策略组，并且<code class="codeph">scott</code>模式中的<code class="codeph">dept</code>表具有与之关联的不同<code class="codeph">SYS_DEFAULT</code>策略组。将它们视为在树结构中组织如下：</p><pre class="oac_no_warn" dir="ltr">SYS_DEFAULT  -  policy1（scott / emp） -  policy3（scott / emp）SYS_DEFAULT  -  policy2（scott / dept）</pre><p>您可以创建具有相同名称的策略组。选择特定策略组时，其关联的架构和对象名称将显示在屏幕右侧的属性表中。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-011EB74C-42DD-4817-A847-5BB28D67F6BE" title="Oracle虚拟专用数据库策略组是可以应用于应用程序的VPD策略的命名集合。">Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG261"></a><div class="props_rev_3"><a id="GUID-4E7285B9-220D-499D-9F22-586E7DED2311" name="GUID-4E7285B9-220D-499D-9F22-586E7DED2311"></a><h5 id="DBSEG-GUID-4E7285B9-220D-499D-9F22-586E7DED2311" class="sect5">每个表，视图或同义词的多个策略</h5>
                     <div>
                        <p>您可以为同一个表，视图或同义词建立多个策略。</p>
                        <p>例如，假设您有一个订单输入的基本应用程序，并且您公司的每个部门都有自己的数据访问规则。您可以向表中添加特定于部门的策略函数，而无需重写基本应用程序的策略函数。</p>
                        <p>应用于表的所有策略都使用<code class="codeph">AND</code>语法强制执行。如果有三个策略应用于<code class="codeph">CUSTOMERS</code>表，则每个策略都应用于表。您可以使用策略组和应用程序上下文来细分细粒度的访问控制实施，以便应用不同的策略，具体取决于哪个应用程序正在访问数据。这消除了开发组在策略上进行协作并简化应用程序开发的要求。您还可以拥有始终适用的默认策略组（例如，在托管环境中强制执行由订户分隔的数据）。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-011EB74C-42DD-4817-A847-5BB28D67F6BE" title="Oracle虚拟专用数据库策略组是可以应用于应用程序的VPD策略的命名集合。">Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG262"></a><div class="props_rev_3"><a id="GUID-A11B72DE-18B8-44A3-8E04-851247175B35" name="GUID-A11B72DE-18B8-44A3-8E04-851247175B35"></a><h5 id="DBSEG-GUID-A11B72DE-18B8-44A3-8E04-851247175B35" class="sect5">验证用于连接到数据库的应用程序</h5>
                     <div>
                        <p>实现驱动上下文的包必须正确验证用于连接到数据库的应用程序。</p>
                        <p>虽然Oracle数据库检查调用堆栈以确保实现驱动上下文的程序包设置上下文属性，但仍可在程序包内进行不充分的验证。例如，在数据库用户或企业用户为数据库所知的应用程序中，用户需要对设置驱动上下文的包具有<code class="codeph">EXECUTE</code>特权。考虑一个用户，他知道<code class="codeph">BENEFITS</code>应用程序可以实现比<code class="codeph">HR</code>应用程序更自由的访问。<code class="codeph">setctx</code>过程（在驱动上下文中设置正确的策略组）不执行任何验证来确定哪个应用程序实际连接。也就是说，该过程不检查传入连接的IP地址（对于三层系统）或用户会话的<code class="codeph">proxy_user</code>属性。
                        </p>
                        <p>此用户可以将驱动上下文包传递给更自由的<code class="codeph">BENEFITS</code>策略组的上下文，然后访问<code class="codeph">HR</code>应用程序。由于<code class="codeph">setctx</code>不会对应用程序进行进一步验证，因此该用户会绕过限制性更强的HR安全策略。
                        </p>
                        <p>相反，如果您使用Oracle虚拟专用数据库实现代理身份验证，则可以确定代表用户连接到数据库的中间层（和应用程序）的身份。将为每个应用程序应用正确的策略来调解数据访问。</p>
                        <p>例如，使用代理身份验证功能的开发人员可以确定连接到数据库的应用程序（中间层）是<code class="codeph">HRAPPSERVER</code> 。从而实现了驱动上下文中的包可以验证是否<code class="codeph">proxy_user</code>在用户会话<code class="codeph">HRAPPSERVER</code> 。如果是，则可以设置驾驶上下文以使用<code class="codeph">HR</code>策略组。如果<code class="codeph">proxy_user</code>不是<code class="codeph">HRAPPSERVER</code> ，那么它可以拒绝访问。
                        </p>
                        <p>在这种情况下，执行以下查询：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM apps.benefit;</pre><p>Oracle数据库从默认策略组（ <code class="codeph">SYS_DEFAULT</code> ）和活动命名空间<code class="codeph">HR</code>获取策略。查询在内部重写如下：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM apps.benefit WHERE company = SYS_CONTEXT（'ID'，'MY_COMPANY'）AND SYS_CONTEXT（'ID'，'TITLE'）='MANAGER';</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-011EB74C-42DD-4817-A847-5BB28D67F6BE" title="Oracle虚拟专用数据库策略组是可以应用于应用程序的VPD策略的命名集合。">Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="DBSEG14001"></a><div class="props_rev_3"><a id="GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" name="GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD"></a><h4 id="DBSEG-GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" class="sect4">使用Oracle虚拟专用数据库策略类型优化性能</h4>
                  <div>
                     <p>您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-894BAEFF-8DB4-4136-9FD2-C9D5041F9C91">关于Oracle虚拟专用数据库策略类型</a><br>为策略指定策略类型可以优化每个Oracle虚拟专用数据库策略运行的性能。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-719884EE-E3F7-4BC1-9571-6F3D037613C7">动态策略类型自动重新运行策略功能</a><br>每次用户访问受虚拟专用数据库保护的数据库对象时， <code class="codeph">DYNAMIC</code>策略类型都会运行策略功能。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-47077306-2EF6-439D-B6A2-FB8BDCBC4378">示例：使用DBMS_RLS.ADD_POLICY创建DYNAMIC策略</a><br><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以创建动态Oracle虚拟专用数据库策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-79469105-B0FF-4DBC-854B-4EDCBD5DB593">防止策略函数重新运行每个查询的静态策略</a><br>静态策略类型为实例中的所有用户强制实施相同的谓词。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-270DF0C3-B95C-4591-A2F7-463379F0CA95">示例：使用DBMS_RLS.ADD_POLICY创建静态策略</a><br><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以创建静态Oracle虚拟专用数据库（VPD）策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-ACC1DF63-FF05-409D-9478-045DD3A233A2">示例：共享静态策略以与多个对象共享策略</a><br><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以创建共享静态Oracle虚拟专用数据库策略，以与多个对象共享策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-B11CACA8-B7A3-43EA-A16E-9810988E3932">何时使用静态和共享静态策略</a><br>当每个查询都需要相同的谓词并且快速性能至关重要时，静态策略是理想的，例如托管环境。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-8D342184-FBFF-4322-ACC9-4D03CF866C68">应用程序上下文属性的上下文敏感策略</a><br>当必须应用不同的谓词时，上下文相关的策略很有用，具体取决于执行查询的谓词。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-88C911CF-9666-4054-AEB6-E9548D02588A">示例：使用DBMS_RLS.ADD_POLICY创建上下文相关策略</a><br><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以创建Oracle虚拟专用数据库上下文相关策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-96B8204B-5CCD-4008-BE91-9270472966C3">示例：刷新VPD上下文相关策略的缓存语句</a><br><span class="apiname" translate="no">DBMS_RLS.REFRESH_POLICY</span>语句可以刷新Oracle虚拟专用数据库上下文相关策略的缓存语句。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-4AE84443-F76D-428C-97DD-AD0780CE4565">示例：更改现有的上下文相关策略</a><br><code class="codeph">DBMS_RLS.ALTER_POLICY</code>过程可以修改Oracle虚拟专用数据库策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-3B100B7D-7E47-4B07-89D4-CCEF72021617">示例：使用共享上下文相关策略与多个对象共享策略</a><br><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以创建共享的上下文敏感的Oracle虚拟专用数据库，以共享具有多个对象的策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-6B2F8145-E920-4A09-BA5E-21F49DAB8B15">何时使用上下文敏感和共享上下文敏感策略</a><br>当谓词不需要为用户会话更改时使用上下文相关策略，但策略必须为不同用户或组强制实施多个谓词。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-011F285D-258F-4A2B-BB04-79C1E99BE172">五种Oracle虚拟专用数据库策略类型摘要</a><br>Oracle虚拟专用数据库根据用户需求（如托管环境）提供五种策略类型。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-8F39CFC1-E210-4011-9D49-F84E91AF41CB" title="DBMS_RLS PL / SQL包可以配置Oracle虚拟专用数据库（VPD）策略。">Oracle虚拟专用数据库策略的配置</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG263"></a><div class="props_rev_3"><a id="GUID-894BAEFF-8DB4-4136-9FD2-C9D5041F9C91" name="GUID-894BAEFF-8DB4-4136-9FD2-C9D5041F9C91"></a><h5 id="DBSEG-GUID-894BAEFF-8DB4-4136-9FD2-C9D5041F9C91" class="sect5">关于Oracle虚拟专用数据库策略类型</h5>
                     <div>
                        <p>为策略指定策略类型可以优化每个Oracle虚拟专用数据库策略运行的性能。</p>
                        <p>策略类型控制Oracle数据库如何缓存Oracle虚拟专用数据库策略谓词。请考虑为策略设置策略类型，因为策略功能的执行可能会占用大量系统资源。最小化策略函数可以运行的次数可以优化数据库性能。</p>
                        <p>您可以从五种策略类型中进行选择： <code class="codeph">DYNAMIC</code> ， <code class="codeph">STATIC</code> ， <code class="codeph">SHARED_STATIC</code> ， <code class="codeph">CONTEXT_SENSITIVE</code>和<code class="codeph">SHARED_CONTEXT_SENSITIVE</code> 。这些使您能够精确指定策略谓词应更改的频率。要指定策略类型，请设置<code class="codeph">DBMS_RLS.ADD POLICY</code>过程的<code class="codeph">policy_type</code>参数。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG264"></a><div class="props_rev_3"><a id="GUID-719884EE-E3F7-4BC1-9571-6F3D037613C7" name="GUID-719884EE-E3F7-4BC1-9571-6F3D037613C7"></a><h5 id="DBSEG-GUID-719884EE-E3F7-4BC1-9571-6F3D037613C7" class="sect5">动态策略类型自动重新运行策略功能</h5>
                     <div>
                        <p>每次用户访问受虚拟专用数据库保护的数据库对象时， <code class="codeph">DYNAMIC</code>策略类型都会运行策略功能。
                        </p>
                        <p></p>
                        <p>如果未在<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程中指定策略类型，则默认情况下，您的策略将是动态的。通过将<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程的<code class="codeph">policy_type</code>参数设置为<code class="codeph">DYNAMIC</code> ，可以将策略专门配置为<code class="codeph">DYNAMIC</code> 。</p>
                        <p>此策略类型不会像静态和上下文敏感策略类型那样优化数据库性能。但是，Oracle建议在将策略设置为静态或上下文相关之前，应首先将它们作为每次运行的<code class="codeph">DYNAMIC</code>策略类型进行测试。将策略函数作为<code class="codeph">DYNAMIC</code>策略测试首先使您能够观察策略函数如何影响每个查询，因为没有任何缓存。这可确保在将功能启用为静态或上下文相关策略类型以优化性能之前，功能正常工作。
                        </p>
                        <p>您可以使用<code class="codeph">DBMS_UTILITY.GET_TIME</code>函数来测量要执行的语句的开始和结束时间。例如：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">-  1。获取开始时间：</span> SELECT DBMS_UTILITY.GET_TIME FROM DUAL; GET_TIME ---------- 2312721 <span class="bold">-  2。运行语句：</span> SELECT COUNT（*）FROM HR.EMPLOYEES; COUNT（*）---------- 107 <span class="bold">-  3。获取结束时间：</span> SELECT DBMS_UTILITY.GET_TIME FROM DUAL; GET_TIME ---------- 2314319</pre></div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="configuring-audit-policies.html#GUID-50FB686D-D357-4066-ADF1-17F1B9B19DB5" title="您可以审核函数，过程，PL / SQL包和触发器。">审计功能，过程，包和触发器</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="DBSEG265"></a><div class="props_rev_3"><a id="GUID-47077306-2EF6-439D-B6A2-FB8BDCBC4378" name="GUID-47077306-2EF6-439D-B6A2-FB8BDCBC4378"></a><h5 id="DBSEG-GUID-47077306-2EF6-439D-B6A2-FB8BDCBC4378" class="sect5">示例：使用DBMS_RLS.ADD_POLICY创建DYNAMIC策略</h5>
                     <div>
                        <p><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以创建动态Oracle虚拟专用数据库策略。
                        </p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-47077306-2EF6-439D-B6A2-FB8BDCBC4378__CIHFIGFI">例12-5</a>显示了如何创建<code class="codeph">DYNAMIC</code>策略类型。
                        </p>
                        <div class="example" id="GUID-47077306-2EF6-439D-B6A2-FB8BDCBC4378__CIHFIGFI">
                           <p class="titleinexample">示例12-5使用DBMS_RLS.ADD_POLICY创建DYNAMIC策略</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'hr'，object_name =&gt;'employees'，policy_name =&gt;'secure_update'，policy_function =&gt;'hide_fin'，policy_type =&gt; dbms_rls。动态）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG266"></a><div class="props_rev_3"><a id="GUID-79469105-B0FF-4DBC-854B-4EDCBD5DB593" name="GUID-79469105-B0FF-4DBC-854B-4EDCBD5DB593"></a><h5 id="DBSEG-GUID-79469105-B0FF-4DBC-854B-4EDCBD5DB593" class="sect5">防止策略函数重新运行每个查询的静态策略</h5>
                     <div>
                        <p>静态策略类型为实例中的所有用户强制实施相同的谓词。</p>
                        <p>Oracle数据库在SGA中存储静态策略谓词，因此不会为每个查询重新运行策略函数。这导致更快的性能。</p>
                        <p>您可以通过将<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程的<code class="codeph">policy_type</code>参数设置为<code class="codeph">STATIC</code>或<code class="codeph">SHARED_STATIC</code>来启用静态策略，具体取决于您是否希望跨多个对象共享策略。
                        </p>
                        <p>每次执行相同的游标都可以为同一个谓词生成不同的行集，因为谓词可能会根据<code class="codeph">SYS_CONTEXT</code>或<code class="codeph">SYSDATE</code>等属性对数据进行不同的过滤。</p>
                        <p>例如，假设您将策略启用为<code class="codeph">STATIC</code>或<code class="codeph">SHARED_STATIC</code>策略类型，该策略类型将以下谓词附加到针对受策略保护的数据库对象进行的所有查询：</p><pre class="oac_no_warn" dir="ltr">WHERE dept = SYS_CONTEXT（'hr_app'，'deptno'）</pre><p>尽管每个查询的谓词都不会更改，但它适用于基于<code class="codeph">SYS_CONTEXT</code>会话属性的<code class="codeph">SYS_CONTEXT</code> 。对于前面的示例，谓词仅返回部门编号与<code class="codeph">SYS_CONTEXT</code>的<code class="codeph">deptno</code>属性匹配的行， <code class="codeph">SYS_CONTEXT</code>是查询受策略保护的数据库对象的用户的部门编号。
                        </p>
                        <div class="infoboxnote" id="GUID-79469105-B0FF-4DBC-854B-4EDCBD5DB593__GUID-E871A782-3757-4F40-925D-719417FCC7CA">
                           <p class="notep1">注意：</p>
                           <p>使用共享静态策略时，请确保策略谓词不包含特定于特定数据库对象的属性，例如列名。</p>
                        </div>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="configuring-audit-policies.html#GUID-50FB686D-D357-4066-ADF1-17F1B9B19DB5" title="您可以审核函数，过程，PL / SQL包和触发器。">审计功能，过程，包和触发器</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="DBSEG267"></a><div class="props_rev_3"><a id="GUID-270DF0C3-B95C-4591-A2F7-463379F0CA95" name="GUID-270DF0C3-B95C-4591-A2F7-463379F0CA95"></a><h5 id="DBSEG-GUID-270DF0C3-B95C-4591-A2F7-463379F0CA95" class="sect5">示例：使用DBMS_RLS.ADD_POLICY创建静态策略</h5>
                     <div>
                        <p><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以创建静态Oracle虚拟专用数据库（VPD）策略。
                        </p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-270DF0C3-B95C-4591-A2F7-463379F0CA95__CIHHCGAH">例12-6</a>显示了如何创建<code class="codeph">STATIC</code>策略类型。
                        </p>
                        <div class="example" id="GUID-270DF0C3-B95C-4591-A2F7-463379F0CA95__CIHHCGAH">
                           <p class="titleinexample">示例12-6使用DBMS_RLS.ADD_POLICY创建静态策略</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'hr'，object_name =&gt;'employees'，policy_name =&gt;'secure_update'，policy_function =&gt;'hide_fin'，policy_type =&gt; DBMS_RLS.STATIC）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG269"></a><a id="DBSEG268"></a><div class="props_rev_3"><a id="GUID-ACC1DF63-FF05-409D-9478-045DD3A233A2" name="GUID-ACC1DF63-FF05-409D-9478-045DD3A233A2"></a><h5 id="DBSEG-GUID-ACC1DF63-FF05-409D-9478-045DD3A233A2" class="sect5">示例：共享静态策略以与多个对象共享策略</h5>
                     <div>
                        <p><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以创建共享静态Oracle虚拟专用数据库策略，以与多个对象共享策略。
                        </p>
                        <p>例如，如果您希望将<a href="using-oracle-vpd-to-control-data-access.html#GUID-270DF0C3-B95C-4591-A2F7-463379F0CA95__CIHHCGAH">示例12-6中</a>的策略应用于<code class="codeph">HR</code>模式中可能包含您想要支持的财务数据的第二个表，则可以对两个表使用<code class="codeph">SHARED_STATIC</code>设置。
                        </p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-ACC1DF63-FF05-409D-9478-045DD3A233A2__CIHCDAIF">示例12-7</a>显示了如何为共享相同策略的两个表设置<code class="codeph">SHARED_STATIC</code>策略类型。
                        </p>
                        <div class="example" id="GUID-ACC1DF63-FF05-409D-9478-045DD3A233A2__CIHCDAIF">
                           <p class="titleinexample">示例12-7创建共享静态策略以与多个对象共享策略</p><pre class="oac_no_warn" dir="ltr"><span class="bold">-  1。为第一个表创建策略，员工：</span> BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'hr'，object_name =&gt;'employees'，policy_name =&gt;'secure_update'，policy_function =&gt;'hide_fin'，policy_type =&gt; dbms_rls。SHARED_STATIC）;结束; / <span class="bold">-  2。为第二个表创建策略fin_data：</span> BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'hr'，object_name =&gt;'fin_data'，policy_name =&gt;'secure_update'，policy_function =&gt;'hide_fin'，policy_type =&gt; dbms_rls。SHARED_STATIC）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG270"></a><div class="props_rev_3"><a id="GUID-B11CACA8-B7A3-43EA-A16E-9810988E3932" name="GUID-B11CACA8-B7A3-43EA-A16E-9810988E3932"></a><h5 id="DBSEG-GUID-B11CACA8-B7A3-43EA-A16E-9810988E3932" class="sect5">何时使用静态和共享静态策略</h5>
                     <div>
                        <p>当每个查询都需要相同的谓词并且快速性能至关重要时，静态策略是理想的，例如托管环境。</p>
                        <p>对于这些情况，当策略函数将相同的谓词附加到每个查询时，每次重新运行策略函数都会给系统增加不必要的开销。例如，考虑一个数据仓库，其中包含作为竞争对手的客户组织的市场研究数据。仓库必须执行每个组织只能看到自己的市场研究的政策，这由以下谓词表示：</p><pre class="oac_no_warn" dir="ltr">WHERE subscriber_id = SYS_CONTEXT（'customer'，'cust_num'）</pre><p>将<code class="codeph">SYS_CONTEXT</code>用于应用程序上下文使数据库能够动态更改返回的行。您无需重新运行该函数，因此可以在SGA中缓存谓词，从而节省系统资源并提高性能。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG271"></a><div class="props_rev_3"><a id="GUID-8D342184-FBFF-4322-ACC9-4D03CF866C68" name="GUID-8D342184-FBFF-4322-ACC9-4D03CF866C68"></a><h5 id="DBSEG-GUID-8D342184-FBFF-4322-ACC9-4D03CF866C68" class="sect5">应用程序上下文属性的上下文敏感策略</h5>
                     <div>
                        <p>当必须应用不同的谓词时，上下文相关的策略很有用，具体取决于执行查询的谓词。</p>
                        <p>例如，考虑管理者应该将谓词<code class="codeph">WHERE group</code>设置为<code class="codeph">managers</code> ，并且员工应该将谓词<code class="codeph">WHERE empno_ctx</code>设置为<code class="codeph">emp_id</code> 。通过上下文相关策略，您只能显示管理员登录时管理员必须看到的信息，以及员工登录时必须看到的信息。策略使用应用程序上下文来确定要使用的谓词。
                        </p>
                        <p>与静态策略相反，上下文相关策略并不总是缓存谓词。对于上下文相关的策略，数据库假定谓词将在语句分析时间后更改。但是，如果本地应用程序上下文没有变化，则Oracle数据库不会在用户会话中重新运行策略功能。如果在用户会话期间任何应用程序上下文的任何属性发生更改，则默认情况下，数据库会重新执行策略函数，以确保它捕获自初始解析以来对谓词的所有更改。如果没有关联的属性发生更改，则会导致不必要的重新执行策略功能。您可以通过包含<code class="codeph">namespace</code>和<code class="codeph">attribute</code>参数来将评估限制为特定的应用程序上下文。
                        </p>
                        <p>如果您计划在策略中使用<code class="codeph">namespace</code>和<code class="codeph">attribute</code>参数，请遵循以下准则：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>确保指定<code class="codeph">namespace</code>和<code class="codeph">attribute</code>参数，而不仅仅指定一个。
                              </p>
                           </li>
                           <li>
                              <p>确保您的策略的<code class="codeph">policy_type</code>参数设置为<code class="codeph">DBMS_RLS.CONTEXT_SENSITIVE</code>或<code class="codeph">SHARED_CONTEXT_SENSITIVE</code> 。您不能在静态或动态策略中使用<code class="codeph">namespace</code>和<code class="codeph">attribute</code>参数。
                              </p>
                           </li>
                        </ul>
                        <p>如果没有与虚拟专用数据库策略功能关联的属性，则Oracle数据库会针对任何应用程序上下文更改评估上下文相关功能。</p>
                        <p>共享上下文敏感策略的操作方式与常规上下文相关策略的操作方式相同，只是它们可以跨多个数据库对象共享。对于此策略类型，所有对象都可以从UGA共享策略函数，其中谓词被缓存，直到本地会话上下文发生更改。</p>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="using-oracle-vpd-to-control-data-access.html#GUID-3B100B7D-7E47-4B07-89D4-CCEF72021617" title="DBMS_RLS.ADD_POLICY过程可以创建共享的上下文敏感的Oracle虚拟专用数据库，以共享具有多个对象的策略。">示例：使用共享上下文相关策略与多个对象共享策略</a></li>
                              <li><a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></li>
                              <li><a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" title="本教程演示了如何创建Oracle虚拟专用数据库策略组。">教程：实施Oracle虚拟专用数据库策略组</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="DBSEG272"></a><div class="props_rev_3"><a id="GUID-88C911CF-9666-4054-AEB6-E9548D02588A" name="GUID-88C911CF-9666-4054-AEB6-E9548D02588A"></a><h5 id="DBSEG-GUID-88C911CF-9666-4054-AEB6-E9548D02588A" class="sect5">示例：使用DBMS_RLS.ADD_POLICY创建上下文相关策略</h5>
                     <div>
                        <p><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以创建Oracle虚拟专用数据库上下文相关策略。
                        </p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-88C911CF-9666-4054-AEB6-E9548D02588A__CIHEAAEB">示例12-8</a>显示了如何创建<code class="codeph">CONTEXT_SENSITIVE</code>策略，其中仅针对<code class="codeph">empno_ctx</code>命名空间和<code class="codeph">emp_id</code>属性的更改评估策略。
                        </p>
                        <div class="example" id="GUID-88C911CF-9666-4054-AEB6-E9548D02588A__CIHEAAEB">
                           <p class="titleinexample">示例12-8使用DBMS_RLS.ADD_POLICY创建上下文相关策略</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'hr'，object_name =&gt;'employees'，policy_name =&gt;'secure_update'，policy_function =&gt;'hide_fin'，policy_type =&gt; dbms_rls。CONTEXT_SENSITIVE，namespace =&gt;'empno_ctx'，attribute =&gt;'emp_id'）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG851"></a><div class="props_rev_3"><a id="GUID-96B8204B-5CCD-4008-BE91-9270472966C3" name="GUID-96B8204B-5CCD-4008-BE91-9270472966C3"></a><h5 id="DBSEG-GUID-96B8204B-5CCD-4008-BE91-9270472966C3" class="sect5">示例：刷新VPD上下文相关策略的缓存语句</h5>
                     <div>
                        <p><span class="apiname" translate="no">DBMS_RLS.REFRESH_POLICY</span>语句可以刷新Oracle虚拟专用数据库上下文相关策略的缓存语句。
                        </p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-96B8204B-5CCD-4008-BE91-9270472966C3__BABJHAJA">示例12-9</a>显示您可以通过运行<code class="codeph">DBMS_RLS.REFRESH_POLICY</code>过程手动刷新与虚拟专用数据库上下文相关策略关联的所有高速缓存语句。
                        </p>
                        <div class="example" id="GUID-96B8204B-5CCD-4008-BE91-9270472966C3__BABJHAJA">
                           <p class="titleinexample">示例12-9刷新VPD上下文相关策略的缓存语句</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.REFRESH_POLICY（object_schema =&gt;'hr'，object_name =&gt;'employees'，policy_name =&gt;'secure_update'）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG383"></a><div class="props_rev_3"><a id="GUID-4AE84443-F76D-428C-97DD-AD0780CE4565" name="GUID-4AE84443-F76D-428C-97DD-AD0780CE4565"></a><h5 id="DBSEG-GUID-4AE84443-F76D-428C-97DD-AD0780CE4565" class="sect5">示例：更改现有的上下文相关策略</h5>
                     <div>
                        <p><code class="codeph">DBMS_RLS.ALTER_POLICY</code>过程可以修改Oracle虚拟专用数据库策略。
                        </p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-4AE84443-F76D-428C-97DD-AD0780CE4565__BABJCBID">示例12-10</a>显示了如何使用<code class="codeph">DBMS_RLS.ALTER_POLICY</code>语句更改现有的上下文相关策略，以便仅在相关上下文属性更改时才执行<code class="codeph">order_update_pol</code>策略功能。
                        </p>
                        <div class="example" id="GUID-4AE84443-F76D-428C-97DD-AD0780CE4565__BABJCBID">
                           <p class="titleinexample">示例12-10更改现有的上下文相关策略</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ALTER_POLICY（object_schema =&gt;'oe'，object_name =&gt;'orders'，policy_name =&gt;'order_update_pol'，alter_option =&gt; DBMS_RLS.ADD_ATTRIBUTE_ASSOCIATION，namespace =&gt;'empno_ctx'，attribute =&gt;'emp_role'）;结束; /</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG274"></a><a id="DBSEG273"></a><div class="props_rev_3"><a id="GUID-3B100B7D-7E47-4B07-89D4-CCEF72021617" name="GUID-3B100B7D-7E47-4B07-89D4-CCEF72021617"></a><h5 id="DBSEG-GUID-3B100B7D-7E47-4B07-89D4-CCEF72021617" class="sect5">示例：使用共享上下文相关策略与多个对象共享策略</h5>
                     <div>
                        <p><code class="codeph">DBMS_RLS.ADD_POLICY</code>过程可以创建共享的上下文敏感的Oracle虚拟专用数据库，以共享具有多个对象的策略。
                        </p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-3B100B7D-7E47-4B07-89D4-CCEF72021617__CIHJJGGB">示例12-11</a>显示了如何创建两个共享上下文敏感策略，这些策略与多个表共享策略，以及如何仅对<code class="codeph">empno_ctx</code>命名空间和<code class="codeph">emp_id</code>属性的更改限制评估。
                        </p>
                        <div class="example" id="GUID-3B100B7D-7E47-4B07-89D4-CCEF72021617__CIHJJGGB">
                           <p class="titleinexample">示例12-11使用DBMS_RLS.ADD_POLICY的共享上下文相关策略</p><pre class="oac_no_warn" dir="ltr"><span class="bold">-  1。为第一个表创建策略，员工：</span> BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'hr'，object_name =&gt;'employees'，policy_name =&gt;'secure_update'，policy_function =&gt;'hide_fin'，policy_type =&gt; dbms_rls。SHARED_CONTEXT_SENSITIVE，namespace =&gt;'empno_ctx'，attribute =&gt;'emp_id'）;结束; / <span class="bold">--2。为第二个表创建策略fin_data：</span> BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'hr'，object_name =&gt;'fin_data'，policy_name =&gt;'secure_update'，policy_function =&gt;'hide_fin'，policy_type =&gt; dbms_rls。SHARED_CONTEXT_SENSITIVE，namespace =&gt;'empno_ctx'，attribute =&gt;'emp_id'）;结束; /</pre><p>请注意以下事项：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用共享上下文相关策略时，请确保策略谓词不包含特定于特定数据库对象的属性，例如列名。</p>
                              </li>
                              <li>
                                 <p>要手动刷新与虚拟专用数据库共享上下文相关策略关联的所有高速缓存语句，请运行<code class="codeph">DBMS_RLS.REFRESH_GROUPED_POLICY</code>过程。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG275"></a><div class="props_rev_3"><a id="GUID-6B2F8145-E920-4A09-BA5E-21F49DAB8B15" name="GUID-6B2F8145-E920-4A09-BA5E-21F49DAB8B15"></a><h5 id="DBSEG-GUID-6B2F8145-E920-4A09-BA5E-21F49DAB8B15" class="sect5">何时使用上下文敏感和共享上下文敏感策略</h5>
                     <div>
                        <p>当谓词不需要为用户会话更改时使用上下文相关策略，但策略必须为不同用户或组强制实施多个谓词。</p>
                        <p>例如，考虑具有单个策略的<code class="codeph">sales_history</code>表。该政策规定，分析师只能看到自己的产品，区域员工只能看到自己的区域。在这种情况下，每次用户类型更改时，数据库都必须重新运行策略功能。当用户可以登录并针对受保护对象发出多个DML语句而不会导致服务器重新运行策略功能时，可以实现性能提升。
                        </p>
                        <div class="infoboxnote" id="GUID-6B2F8145-E920-4A09-BA5E-21F49DAB8B15__GUID-16C0FD03-B2B0-4376-98E1-090BACF445D6">
                           <p class="notep1">注意：</p>
                           <p>对于多个客户端共享数据库会话的会话池，中间层必须在客户端切换期间重置上下文。</p>
                        </div>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG277"></a><a id="DBSEG276"></a><div class="props_rev_3"><a id="GUID-011F285D-258F-4A2B-BB04-79C1E99BE172" name="GUID-011F285D-258F-4A2B-BB04-79C1E99BE172"></a><h5 id="DBSEG-GUID-011F285D-258F-4A2B-BB04-79C1E99BE172" class="sect5">五种Oracle虚拟专用数据库策略类型摘要</h5>
                     <div>
                        <p>Oracle虚拟专用数据库根据用户需求（如托管环境）提供五种策略类型。</p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-011F285D-258F-4A2B-BB04-79C1E99BE172__CIHICBIE" title="此表列出了不同的策略类型，解释了它们何时执行，提供了一个用法示例，并指出它们是否可以跨多个对象共享。">表12-2</a>总结了可用策略类型的类型。
                        </p>
                        <div class="tblformalwide" id="GUID-011F285D-258F-4A2B-BB04-79C1E99BE172__CIHICBIE">
                           <p class="titleintable">表12-2 DBMS_RLS.ADD_POLICY策略类型</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="DBMS_RLS.ADD_POLICY策略类型" width="100%" border="1" summary="This table lists the different policy types, explain when they execute, provide a usage example, and indicate whether they can be shared across multiple objects." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="12%" id="d94784e7522">政策类型</th>
                                    <th align="left" valign="bottom" width="35%" id="d94784e7525">当策略功能执行时</th>
                                    <th align="left" valign="bottom" width="44%" id="d94784e7528">用法示例</th>
                                    <th align="left" valign="bottom" width="9%" id="d94784e7531">共享多个对象？</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="12%" id="d94784e7536" headers="d94784e7522 ">
                                       <p><code class="codeph">动态</code></p>
                                    </td>
                                    <td align="left" valign="top" width="35%" headers="d94784e7536 d94784e7525 ">
                                       <p>每次访问受策略保护的数据库对象时，都会重新执行策略函数。</p>
                                    </td>
                                    <td align="left" valign="top" width="44%" headers="d94784e7536 d94784e7528 ">
                                       <p>必须为每个查询生成策略谓词的应用程序，例如在一天中的某些时间拒绝用户访问数据库对象的时间相关策略</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d94784e7536 d94784e7531 ">
                                       <p>没有</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="12%" id="d94784e7550" headers="d94784e7522 ">
                                       <p><code class="codeph">静态的</code></p>
                                    </td>
                                    <td align="left" valign="top" width="35%" headers="d94784e7550 d94784e7525 ">
                                       <p>一次，然后谓词缓存在SGA <a id="fn_1" name="fn_1" href="#fn_1" data="" each="" execution="" of="" the="" same="" cursor="" could="" produce="" a="" different="" row="" set="" for="" predicate="" because="" may="" filter="" differently="" based="" on="" attributes="" such="" as="" sys_context="" or="" sysdate=")" ="" ="" onclick="footdisplay(1, "><sup>Foot 1中</sup></a></p>
                                    </td>
                                    <td align="left" valign="top" width="44%" headers="d94784e7550 d94784e7528 ">
                                       <p>查看替换</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d94784e7550 d94784e7531 ">
                                       <p>没有</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="12%" id="d94784e7573" headers="d94784e7522 ">
                                       <p><code class="codeph">SHARED_STATIC</code></p>
                                    </td>
                                    <td align="left" valign="top" width="35%" headers="d94784e7573 d94784e7525 ">
                                       <p>与<code class="codeph">STATIC</code>相同</p>
                                    </td>
                                    <td align="left" valign="top" width="44%" headers="d94784e7573 d94784e7528 ">
                                       <p>托管环境，例如必须将同一谓词应用于多个数据库对象的数据仓库</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d94784e7573 d94784e7531 ">
                                       <p>是</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="12%" id="d94784e7589" headers="d94784e7522 ">
                                       <p><code class="codeph">CONTEXT_SENSITIVE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="35%" headers="d94784e7589 d94784e7525 ">
                                       <ul style="list-style-type:disc">
                                          <li>
                                             <p>在语句分析时</p>
                                          </li>
                                          <li>
                                             <p>在自上次使用游标以来本地应用程序上下文发生更改时的语句执行时间</p>
                                          </li>
                                       </ul>
                                    </td>
                                    <td align="left" valign="top" width="44%" headers="d94784e7589 d94784e7528 ">
                                       <p>三层会话池应用程序，其中策略为不同的用户或组强制执行两个或更多谓词</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d94784e7589 d94784e7531 ">
                                       <p>没有</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="12%" id="d94784e7608" headers="d94784e7522 ">
                                       <p><code class="codeph">SHARED_CONTEXT_SENSITIVE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="35%" headers="d94784e7608 d94784e7525 ">
                                       <p>第一次在数据库会话中引用该对象。</p>
                                       <p>谓词缓存在私有会话内存UGA中，因此可以在对象之间共享策略函数。</p>
                                    </td>
                                    <td align="left" valign="top" width="44%" headers="d94784e7608 d94784e7528 ">
                                       <p>与<code class="codeph">CONTEXT_SENSITIVE</code>相同，但多个对象可以从会话UGA共享策略功能</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d94784e7608 d94784e7531 ">
                                       <p>是</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p class="tablefootnote"><sup class="tablefootnote">脚注1</sup></p><p>每次执行相同的游标都可以为同一个谓词生成不同的行集，因为谓词可能会根据<code class="codeph">SYS_CONTEXT</code>或<code class="codeph">SYSDATE</code>等属性对数据进行不同的过滤。</p>
                        <p></p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-EE56D7A9-BBF5-477E-ADFD-95CEDE1CBAAD" title="您可以使用Oracle虚拟专用数据库（VPD）动态，静态或共享策略类型来优化性能。">使用Oracle虚拟专用数据库策略类型优化性能</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="DBSEG278"></a><div class="props_rev_3"><a id="GUID-2113CF3C-D950-40B3-A121-A44284EF104D" name="GUID-2113CF3C-D950-40B3-A121-A44284EF104D"></a><h3 id="DBSEG-GUID-2113CF3C-D950-40B3-A121-A44284EF104D" class="sect3">教程：创建Oracle虚拟专用数据库策略</h3>
               <div>
                  <p>这些教程展示了如何创建简单的基于数据库会话的Oracle虚拟专用策略，以及如何创建策略组。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5">教程：创建简单的Oracle虚拟专用数据库策略</a><br>本教程介绍如何使用<code class="codeph">OE</code>用户帐户创建简单的Oracle虚拟专用数据库策略。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F">教程：实现基于会话的应用程序上下文策略</a><br>本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B">教程：实施Oracle虚拟专用数据库策略组</a><br>本教程演示了如何创建Oracle虚拟专用数据库策略组。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-06022729-9210-4895-BF04-6177713C65A7" title="Oracle虚拟专用数据库（VPD）使您可以过滤访问数据的用户。">使用Oracle虚拟专用数据库控制数据访问</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG279"></a><div class="props_rev_3"><a id="GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5" name="GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5"></a><h4 id="DBSEG-GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5" class="sect4">教程：创建简单的Oracle虚拟专用数据库策略</h4>
                  <div>
                     <p>本教程介绍如何使用<code class="codeph">OE</code>用户帐户创建简单的Oracle虚拟专用数据库策略。
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-1CC4DE75-188C-4D0F-92B3-70BDE1D6DEBE">关于本教程</a><br>本教程介绍如何创建一个VPD策略，该策略限制对<code class="codeph">OE.ORDERS</code>表中Sales Representative 159创建的订单的访问。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-616AA376-64B9-4544-A2BC-14B24E95E248">步骤1：确保OE用户帐户处于活动状态</a><br>首先，您必须确保<code class="codeph">OE</code>用户帐户处于活动状态。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-EF2AB277-4328-4BCD-BC12-0CB44B0ECAF3">第2步：创建策略功能</a><br>接下来，您已准备好创建策略功能。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-237895BF-4FBE-40DC-B7DE-46617EC5F5FE">第3步：创建Oracle虚拟专用数据库策略</a><br>创建策略功能后，您就可以将其与VPD策略相关联。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-6EDCB350-998F-4FA4-9D08-915C63CBDFB8">第4步：测试政策</a><br>创建Oracle虚拟专用数据库策略后，它立即生效。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-F2ACE842-9F27-489F-B482-3978ACDBE5CE">第5步：删除本教程的组件</a><br>如果您不再需要本教程的组件，则可以删除它们。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-2113CF3C-D950-40B3-A121-A44284EF104D" title="这些教程展示了如何创建简单的基于数据库会话的Oracle虚拟专用策略，以及如何创建策略组。">教程：创建Oracle虚拟专用数据库策略</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG562"></a><div class="props_rev_3"><a id="GUID-1CC4DE75-188C-4D0F-92B3-70BDE1D6DEBE" name="GUID-1CC4DE75-188C-4D0F-92B3-70BDE1D6DEBE"></a><h5 id="DBSEG-GUID-1CC4DE75-188C-4D0F-92B3-70BDE1D6DEBE" class="sect5">关于本教程</h5>
                     <div>
                        <p>本教程介绍如何创建一个VPD策略，该策略限制对<code class="codeph">OE.ORDERS</code>表中Sales Representative 159创建的订单的访问。
                        </p>
                        <p>从本质上讲，该政策翻译了以下声明：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM OE.ORDERS;</pre><p>致以下声明：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM OE.ORDERS WHERE SALES_REP_ID = 159;</pre><div class="infoboxnote" id="GUID-1CC4DE75-188C-4D0F-92B3-70BDE1D6DEBE__GUID-546BEB4A-5D3D-4C93-95D6-195313823AB2">
                           <p class="notep1">注意：</p>
                           <p>如果您使用的是多租户环境，则本教程仅适用于当前的PDB。</p>
                        </div>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5" title="本教程介绍如何使用OE用户帐户创建简单的Oracle虚拟专用数据库策略。">教程：创建简单的Oracle虚拟专用数据库策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG280"></a><div class="props_rev_3"><a id="GUID-616AA376-64B9-4544-A2BC-14B24E95E248" name="GUID-616AA376-64B9-4544-A2BC-14B24E95E248"></a><h5 id="DBSEG-GUID-616AA376-64B9-4544-A2BC-14B24E95E248" class="sect5">步骤1：确保OE用户帐户处于活动状态</h5>
                     <div>
                        <p>首先，您必须确保<code class="codeph">OE</code>用户帐户处于活动状态。
                        </p>
                        <ol>
                           <li class="stepexpand"><span>以具有<code class="codeph">SYSDBA</code>管理权限的用户<code class="codeph">SYS</code>身份登录到SQL * Plus。</span><div><pre class="oac_no_warn" dir="ltr">sqlplus sys as sysdba输入密码： <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>在多租户环境中，连接到相应的PDB。</span><div>
                                 <p>例如：</p><pre class="oac_no_warn" dir="ltr">CONNECT SYS @hrpdb AS SYSDBA输入密码： <span class="italic">password</span>
</pre><p>要查找可用的PDB，请运行<code class="codeph">show pdbs</code>命令。要检查当前PDB，请运行<code class="codeph">show con_name</code>命令。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>查询<code class="codeph">DBA_USERS</code>数据字典视图以查找<code class="codeph">OE</code>的帐户状态。</span><div><pre class="oac_no_warn" dir="ltr">SELECT USERNAME，ACCOUNT_STATUS FROM DBA_USERS WHERE USERNAME ='OE';</pre><p>状态应为<code class="codeph">OPEN</code> 。如果<code class="codeph">DBA_USERS</code>视图将用户<code class="codeph">OE</code>列为已锁定且已过期，则输入以下语句以解锁<code class="codeph">OE</code>帐户并创建新密码：</p><pre class="oac_no_warn" dir="ltr">更改用户OE帐户解锁<span class="italic">密码</span>识别;</pre><p>请遵循<a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle provides a set of minimum requirements for passwords.">密码最低要求中</a>的准则，使用安全<a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle提供了一组密码的最低要求。">密码</a>替换<span class="italic"><code class="codeph">password</code></span> 。为了提高安全性，请不要重复使用以前版本的Oracle数据库中使用的相同密码。
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5" title="本教程介绍如何使用OE用户帐户创建简单的Oracle虚拟专用数据库策略。">教程：创建简单的Oracle虚拟专用数据库策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG281"></a><div class="props_rev_3"><a id="GUID-EF2AB277-4328-4BCD-BC12-0CB44B0ECAF3" name="GUID-EF2AB277-4328-4BCD-BC12-0CB44B0ECAF3"></a><h5 id="DBSEG-GUID-EF2AB277-4328-4BCD-BC12-0CB44B0ECAF3" class="sect5">第2步：创建策略功能</h5>
                     <div>
                        <p>接下来，您已准备好创建策略功能。</p>
                        <div class="section">
                           <p>作为用户<code class="codeph">SYS</code> ，创建以下函数，该函数将<code class="codeph">WHERE SALES_REP_ID = 159</code>子句附加到<code class="codeph">OE.ORDERS</code>表上的任何<code class="codeph">SELECT</code>语句。（您可以通过将光标定位在第一行中<code class="codeph">CREATE OR REPLACE</code>的开头来复制和粘贴此文本。）
                           </p><pre class="pre codeblock"><code>CREATE或REPLACE FUNCTION auth_orders（schema_var IN VARCHAR2，table_var IN VARCHAR2）RETURN VARCHAR2 IS return_val VARCHAR2（400）; BEGIN return_val：='SALES_REP_ID = 159'; RETURN return_val; END auth_orders; /</code></pre><p>在这个例子中：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">schema_var</code>和<code class="codeph">table_var</code>创建输入参数以指定存储模式名称， <code class="codeph">OE</code>和表名称<code class="codeph">ORDERS</code> 。首先，定义模式的参数，然后定义对象的参数，在本例中为表。始终按此顺序创建它们。您创建的虚拟专用数据库策略将需要这些参数来指定<code class="codeph">OE.ORDERS</code>表。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">RETURN VARCHAR2</code>返回将用于<code class="codeph">WHERE</code>谓词子句的字符串。请记住，返回值始终是<code class="codeph">VARCHAR2</code>数据类型。
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">是......RETURN return_val</code>包含<code class="codeph">WHERE SALES_REP_ID = 159</code>谓词的创建。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5" title="本教程介绍如何使用OE用户帐户创建简单的Oracle虚拟专用数据库策略。">教程：创建简单的Oracle虚拟专用数据库策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG282"></a><div class="props_rev_3"><a id="GUID-237895BF-4FBE-40DC-B7DE-46617EC5F5FE" name="GUID-237895BF-4FBE-40DC-B7DE-46617EC5F5FE"></a><h5 id="DBSEG-GUID-237895BF-4FBE-40DC-B7DE-46617EC5F5FE" class="sect5">第3步：创建Oracle虚拟专用数据库策略</h5>
                     <div>
                        <p>创建策略功能后，您就可以将其与VPD策略相关联。</p>
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>使用<code class="codeph">DBMS_RLS</code>包中的<code class="codeph">ADD_POLICY</code>过程创建以下策略。
                                 </p><pre class="pre codeblock"><code>BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'oe'，object_name =&gt;'orders'，policy_name =&gt;'orders_policy'，function_schema =&gt;'sys'，policy_function =&gt;'auth_orders'，statement_types =&gt;'select'）;结束; /</code></pre><p>在这个例子中：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">object_schema =&gt; 'oe'</code>指定要保护的架构，即<code class="codeph">OE</code> 。</p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">object_name =&gt; 'orders'</code>指定要保护的模式中的对象，即<code class="codeph">ORDERS</code>表。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">policy_name =&gt; 'orders_policy'</code>将此策略命名为<code class="codeph">orders_policy</code> 。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">function_schema =&gt; 'sys'</code>指定创建<code class="codeph">auth_orders</code>函数的模式。在此示例中， <code class="codeph">auth_orders</code>是在<code class="codeph">SYS</code>模式中创建的。但通常，它应该在安全管理员的模式中创建。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">policy_function =&gt; 'auth_orders'</code>指定强制执行策略的功能。在此处，指定在<a href="using-oracle-vpd-to-control-data-access.html#GUID-EF2AB277-4328-4BCD-BC12-0CB44B0ECAF3" title="接下来，您已准备好创建策略功能。">步骤2：创建策略函数中创建</a>的<code class="codeph">auth_orders</code>函数。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">statement_types =&gt; 'select'</code>指定策略应用的操作。在此示例中，策略适用于用户可能执行的所有<code class="codeph">SELECT</code>语句。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5" title="本教程介绍如何使用OE用户帐户创建简单的Oracle虚拟专用数据库策略。">教程：创建简单的Oracle虚拟专用数据库策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG283"></a><div class="props_rev_3"><a id="GUID-6EDCB350-998F-4FA4-9D08-915C63CBDFB8" name="GUID-6EDCB350-998F-4FA4-9D08-915C63CBDFB8"></a><h5 id="DBSEG-GUID-6EDCB350-998F-4FA4-9D08-915C63CBDFB8" class="sect5">第4步：测试政策</h5>
                     <div>
                        <p>创建Oracle虚拟专用数据库策略后，它立即生效。</p>
                        <div class="section">
                           <p>下次用户（包括架构的所有者）在<code class="codeph">OE.ORDERS</code>上执行<code class="codeph">SELECT</code>时，将仅访问销售代表159的订单。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>以用户<code class="codeph">OE</code>身份连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT oe <span class="italic">- 或者，连接OE @hrpdb</span>输入密码： <span class="italic">密码</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>输入以下<code class="codeph">SELECT</code>语句：</span><div><pre class="oac_no_warn" dir="ltr">SELECT COUNT（*）FROM ORDERS;</pre><p>应出现以下输出：</p><pre class="oac_no_warn" dir="ltr">COUNT（*）--------- 7</pre><p>该策略对用户<code class="codeph">OE</code> ：如您所见，订单表中的105行中只有7行被返回。
                                 </p>
                                 <p>但具有管理权限的用户仍可访问表中的所有行。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>以<code class="codeph">SYS</code>用户身份连接<code class="codeph">SYSDBA</code>管理权限。</span><div><pre class="oac_no_warn" dir="ltr">将SYS作为SYSDBA连接<span class="italic">- 或者，连接SYS @hrpdb AS SYSDBA</span>输入密码： <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>输入以下<code class="codeph">SELECT</code>语句：</span><div><pre class="oac_no_warn" dir="ltr">SELECT COUNT（*）FROM OE.ORDERS;</pre><p>应出现以下输出：</p><pre class="oac_no_warn" dir="ltr">COUNT（*）--------- 105</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5" title="本教程介绍如何使用OE用户帐户创建简单的Oracle虚拟专用数据库策略。">教程：创建简单的Oracle虚拟专用数据库策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG284"></a><div class="props_rev_3"><a id="GUID-F2ACE842-9F27-489F-B482-3978ACDBE5CE" name="GUID-F2ACE842-9F27-489F-B482-3978ACDBE5CE"></a><h5 id="DBSEG-GUID-F2ACE842-9F27-489F-B482-3978ACDBE5CE" class="sect5">第5步：删除本教程的组件</h5>
                     <div>
                        <p>如果您不再需要本教程的组件，则可以删除它们。</p>
                        <ol>
                           <li class="stepexpand"><span>作为用户<code class="codeph">SYS</code> ，删除功能和策略如下：</span><div><pre class="oac_no_warn" dir="ltr">DROP FUNCTION auth_orders; EXEC DBMS_RLS.DROP_POLICY（'OE'，'ORDERS'，'ORDERS_POLICY'）;</pre></div>
                           </li>
                           <li class="stepexpand"><span>如果您需要锁定并使<code class="codeph">OE</code>帐户过期，请输入以下语句：</span><div><pre class="oac_no_warn" dir="ltr">更改用户OE账户锁密码存储;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-96F02E4D-4765-41BA-B834-DA54CC2E72B5" title="本教程介绍如何使用OE用户帐户创建简单的Oracle虚拟专用数据库策略。">教程：创建简单的Oracle虚拟专用数据库策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="DBSEG285"></a><div class="props_rev_3"><a id="GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" name="GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F"></a><h4 id="DBSEG-GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" class="sect4">教程：实现基于会话的应用程序上下文策略</h4>
                  <div>
                     <p>本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-C07E1A23-08A7-4739-B943-F17593AAAE4F">关于本教程</a><br>本教程介绍如何使用基于数据库会话的应用程序上下文来实现客户只能看到自己的订单的策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-738857D8-8EDD-4CBE-AAED-EB5DAA60BE0D">第1步：创建用户帐户和示例表</a><br>首先，创建用户帐户和示例表。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-8DFE13D1-02BB-40F7-870B-E2ADA190F48B">步骤2：创建基于数据库会话的应用程序上下文</a><br>接下来，您已准备好创建基于数据库会话的应用程序上下文。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-FCA5AD56-ACA5-4357-9EA6-AAADE0386B3B">步骤3：创建PL / SQL包以设置应用程序上下文</a><br>创建应用程序上下文后，您就可以创建一个包来设置上下文。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-F2C840AA-2CB0-4F7B-8543-3B39F9B895C9">步骤4：创建登录触发器以运行应用程序上下文PL / SQL包</a><br>登录触发器运行PL / SQL程序包过程，以便下次用户登录时，将设置应用程序上下文。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-F3102964-ED20-40C5-97DB-C9EE9E13D60A">步骤5：测试登录触发器</a><br>当触发器运行<code class="codeph">sysadmin_vpd.orders_ctx_pkg.set_custnum</code>过程时，登录触发器为用户设置应用程序上下文。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-B0EC8CD5-43FB-4FCA-A61A-6E62E6B21A9D">步骤6：创建PL / SQL策略功能以限制用户访问其订单</a><br>下一步是创建一个PL / SQL函数来控制用户查询的显示。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-FD4D9C74-93B0-4E28-81C9-D75D85400748">第7步：创建新的安全策略</a><br>最后，您已准备好创建VPD安全策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-E188CB4D-BCF3-4A2F-87BC-2688EC05C699">第8步：测试新政策</a><br>现在您已经创建了所有组件，您就可以测试该策略了。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-B7B6563A-F6B6-43B3-AF40-12A92EF47FE1">第9步：删除本教程的组件</a><br>如果您不再需要本教程的组件，则可以删除它们。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-2113CF3C-D950-40B3-A121-A44284EF104D" title="这些教程展示了如何创建简单的基于数据库会话的Oracle虚拟专用策略，以及如何创建策略组。">教程：创建Oracle虚拟专用数据库策略</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG563"></a><div class="props_rev_3"><a id="GUID-C07E1A23-08A7-4739-B943-F17593AAAE4F" name="GUID-C07E1A23-08A7-4739-B943-F17593AAAE4F"></a><h5 id="DBSEG-GUID-C07E1A23-08A7-4739-B943-F17593AAAE4F" class="sect5">关于本教程</h5>
                     <div>
                        <p>本教程介绍如何使用基于数据库会话的应用程序上下文来实现客户只能看到自己的订单的策略。</p>
                        <p>如果您使用的是多租户环境，则本教程仅适用于当前的PDB。</p>
                        <p>在本教程中，您将创建以下安全层：</p>
                        <ol>
                           <li>
                              <p>当用户登录时，基于数据库会话的应用程序上下文会检查用户是否是客户。如果用户不是客户，则用户仍可以登录，但此用户无法访问您将为此示例创建的订单输入表。</p>
                           </li>
                           <li>
                              <p>如果用户是客户，则他或她可以登录。客户登录后，Oracle虚拟专用数据库策略会限制此用户仅查看他或她的订单。</p>
                           </li>
                           <li>
                              <p>作为进一步限制，Oracle虚拟专用数据库策略可防止用户添加，修改或删除订单。</p>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG286"></a><div class="props_rev_3"><a id="GUID-738857D8-8EDD-4CBE-AAED-EB5DAA60BE0D" name="GUID-738857D8-8EDD-4CBE-AAED-EB5DAA60BE0D"></a><h5 id="DBSEG-GUID-738857D8-8EDD-4CBE-AAED-EB5DAA60BE0D" class="sect5">第1步：创建用户帐户和示例表</h5>
                     <div>
                        <p>首先，创建用户帐户和示例表。</p>
                        <ol>
                           <li class="stepexpand"><span>启动SQL * Plus并以具有管理权限的用户身份登录。</span><div><pre class="oac_no_warn" dir="ltr">sqlplus sys as sysdba输入密码： <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>在多租户环境中，连接到相应的PDB。</span><div>
                                 <p>例如：</p><pre class="oac_no_warn" dir="ltr">CONNECT SYS @hrpdb AS SYSDBA输入密码： <span class="italic">password</span>
</pre><p>要查找可用的PDB，请查询<code class="codeph">DBA_PDBS</code>数据字典视图。要检查当前PDB，请运行<code class="codeph">show con_name</code>命令。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>创建以下管理用户，该用户将管理Oracle虚拟专用数据库策略。</span><div>
                                 <p>以下SQL语句创建此用户，然后授予用户完成本教程所需的权限。</p><pre class="oac_no_warn" dir="ltr">CREATE USER sysadmin_vpd IDENTIFIED BY <span class="italic">密码</span> CONTAINER = CURRENT;授予创建会话，创建任何背景，创建程序，创建触发器，管理数据库触发器到sysadmin_vpd;在DBMS_SESSION上执行GRANT EXECUTE到sysadmin_vpd;在DBMS_RLS上执行GRANT EXECUTE到sysadmin_vpd;</pre><p>请遵循<a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle provides a set of minimum requirements for passwords.">密码最低要求中</a>的准则，使用安全<a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle提供了一组密码的最低要求。">密码</a>替换<span class="italic"><code class="codeph">password</code></span> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>创建以下本地用户：</span><div><pre class="oac_no_warn" dir="ltr">CREATE USER tbrooke IDENTIFIED BY <span class="italic">密码</span> CONTAINER = CURRENT; CREATE USER owoods IDENTIFIED BY <span class="italic">密码</span> CONTAINER = CURRENT; GRANT创建会议以促进会议，owoods;</pre><p>使用安全密码替换<span class="italic"><code class="codeph">password</code></span> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>检查示例用户<code class="codeph">SCOTT</code>的帐户状态，您将在本教程中使用该用户：</span><div><pre class="oac_no_warn" dir="ltr">SELECT USERNAME，ACCOUNT_STATUS FROM DBA_USERS WHERE USERNAME ='SCOTT';</pre><p>状态应为<code class="codeph">OPEN</code> 。如果<code class="codeph">DBA_USERS</code>视图将用户<code class="codeph">SCOTT</code>列为已锁定且已过期，则输入以下语句以解锁<code class="codeph">SCOTT</code>帐户并为其创建新密码：</p><pre class="oac_no_warn" dir="ltr">更改用户SCOTT帐户解锁<span class="italic">密码</span>识别;</pre><p>请遵循<a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle provides a set of minimum requirements for passwords.">密码最低要求中</a>的准则，使用安全<a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle提供了一组密码的最低要求。">密码</a>替换<span class="italic"><code class="codeph">password</code></span> 。为了提高安全性，请不要重复使用以前版本的Oracle数据库中使用的相同密码。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>以<code class="codeph">SCOTT</code>用户身份连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT SCOTT <span class="italic">- 或者，连接SCOTT @ hrpdb</span>输入密码： <span class="italic">密码</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>创建并填充<code class="codeph">customers</code>表。</span><div><pre class="oac_no_warn" dir="ltr">CREATE TABLE客户（cust_no NUMBER（4），cust_email VARCHAR2（20），cust_name VARCHAR2（20））;插入客户VALUES（1234，'TBROOKE'，'Thadeus Brooke'）;插入客户VALUES（5678，'OWOODS'，'Oberon Woods'）;</pre><p>输入用户电子邮件ID时，请以大写字母输入。稍后，当您创建应用程序上下文PL / SQL包时， <code class="codeph">SYS_CONTEXT</code>函数的<code class="codeph">SESSION_USER</code>参数要求用户名为大写。否则，您将无法为用户设置应用程序上下文。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>用户<code class="codeph">sysadmin_vpd</code>将需要customers表的<code class="codeph">SELECT</code>权限，因此作为用户<code class="codeph">SCOTT</code> ，授予他此权限。</span><div><pre class="oac_no_warn" dir="ltr">授予客户TO sysadmin_vpd;</pre></div>
                           </li>
                           <li class="stepexpand"><span>创建并填充<code class="codeph">orders_tab</code>表。</span><div><pre class="oac_no_warn" dir="ltr">CREATE TABLE orders_tab（cust_no NUMBER（4），order_no NUMBER（4））; INSERT INTO orders_tab VALUES（1234,9876）; INSERT INTO orders_tab VALUES（5678,5432）; INSERT INTO orders_tab VALUES（5678,4592）;</pre></div>
                           </li>
                           <li class="stepexpand"><span>用户<code class="codeph">tbrooke</code>和<code class="codeph">owoods</code>需要查询<code class="codeph">orders_tab</code>表，因此授予他们<code class="codeph">READ</code>对象权限。</span><div><pre class="oac_no_warn" dir="ltr">GRANT READ ON orders_tab to tbrooke，owoods;</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>在这个阶段，两个样本客户<code class="codeph">tbrooke</code>和<code class="codeph">owoods</code>在<code class="codeph">orders_tab</code>订单输入表中有一个购买记录，如果他们现在尝试，他们可以看到该表中的所有订单。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG287"></a><div class="props_rev_3"><a id="GUID-8DFE13D1-02BB-40F7-870B-E2ADA190F48B" name="GUID-8DFE13D1-02BB-40F7-870B-E2ADA190F48B"></a><h5 id="DBSEG-GUID-8DFE13D1-02BB-40F7-870B-E2ADA190F48B" class="sect5">步骤2：创建基于数据库会话的应用程序上下文</h5>
                     <div>
                        <p>接下来，您已准备好创建基于数据库会话的应用程序上下文。</p>
                        <ol>
                           <li class="stepexpand"><span>以<code class="codeph">sysadmin_vpd</code>用户身份进行连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sysadmin_vpd <span class="italic">- 或者，CONNECT sysadmin_vpd @hrpdb</span>输入密码： <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>输入以下语句：</span><div><pre class="oac_no_warn" dir="ltr">创建或替换CONTEXT orders_ctx使用orders_ctx_pkg;</pre><p>此语句创建<code class="codeph">orders_ctx</code>应用程序上下文。请记住，即使用户<code class="codeph">sysadmin_vpd</code>已创建此上下文并且它与<code class="codeph">sysadmin_vpd</code>架构相关联， <code class="codeph">SYS</code>架构也拥有应用程序上下文。
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG288"></a><div class="props_rev_3"><a id="GUID-FCA5AD56-ACA5-4357-9EA6-AAADE0386B3B" name="GUID-FCA5AD56-ACA5-4357-9EA6-AAADE0386B3B"></a><h5 id="DBSEG-GUID-FCA5AD56-ACA5-4357-9EA6-AAADE0386B3B" class="sect5">步骤3：创建PL / SQL包以设置应用程序上下文</h5>
                     <div>
                        <p>创建应用程序上下文后，您就可以创建一个包来设置上下文。</p>
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>作为用户<code class="codeph">sysadmin_vpd</code> ，创建以下PL / SQL包，该包将在客户<code class="codeph">tbrooke</code>和<code class="codeph">owoods</code>登录其帐户时设置基于数据库会话的应用程序上下文。
                                 </p><pre class="pre codeblock"><code>创建或替换包裹orders_ctx_pkg是程序set_custnum;结束; /创建或替换包裹订单orders_ctx_pkg是程序set_custnum AS custnum NUMBER; BEGIN SELECT cust_no INTO custnum FROM SCOTT.CUSTOMERS WHERE cust_email = SYS_CONTEXT（'USERENV'，'SESSION_USER'）; DBMS_SESSION.SET_CONTEXT（'orders_ctx'，'cust_no'，custnum）; NO_DATA_FOUND为零时的异常; END set_custnum;结束; /</code></pre><p>在这个例子中：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p><code class="codeph">custnum NUMBER</code>创建<code class="codeph">custnum</code>变量，该变量将保存客户ID。</p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">SELECT cust_no INTO custnum</code>执行<code class="codeph">SELECT</code>语句，将存储在<code class="codeph">cust_no</code>列数据中的客户ID从<code class="codeph">scott.customers</code>表<code class="codeph">scott.customers</code>到<code class="codeph">custnum</code>变量中。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">WHERE cust_email = SYS_CONTEXT('USERENV', 'SESSION_USER')</code>使用<code class="codeph">WHERE</code>子句查找与登录用户的用户名匹配的所有客户ID。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">DBMS_SESSION.SET_CONTEXT('orders_ctx', 'cust_no', custnum)</code>通过创建<code class="codeph">cust_no</code>属性然后将其设置为存储在<code class="codeph">custnum</code>变量中的值来设置<code class="codeph">orders_ctx</code>应用程序上下文值。
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">例外......WHEN</code>添加<code class="codeph">WHEN NO_DATA_FOUND</code>系统异常以捕获可能由<code class="codeph">SELECT cust_no INTO custnum ...</code>语句中的<code class="codeph">SELECT</code>语句导致的任何<code class="codeph">no data found</code>错误。
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                           <p>总而言之， <code class="codeph">sysadmin_vpd.set_cust_num</code>过程通过尝试在<code class="codeph">custnum</code>变量中选择用户的客户ID来识别会话用户是否是注册客户。如果用户是注册客户，则Oracle数据库会为此用户设置应用程序上下文值。正如您将在<a href="using-oracle-vpd-to-control-data-access.html#GUID-B0EC8CD5-43FB-4FCA-A61A-6E62E6B21A9D" title="下一步是创建一个PL / SQL函数来控制用户查询的显示。">步骤6：创建PL / SQL策略函数以限制用户访问其订单</a>时所看到的，策略函数使用上下文值来控制用户对<code class="codeph">orders_tab</code>表中数据的<code class="codeph">orders_tab</code> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG289"></a><div class="props_rev_3"><a id="GUID-F2C840AA-2CB0-4F7B-8543-3B39F9B895C9" name="GUID-F2C840AA-2CB0-4F7B-8543-3B39F9B895C9"></a><h5 id="DBSEG-GUID-F2C840AA-2CB0-4F7B-8543-3B39F9B895C9" class="sect5">步骤4：创建登录触发器以运行应用程序上下文PL / SQL包</h5>
                     <div>
                        <p>登录触发器运行PL / SQL程序包过程，以便下次用户登录时，将设置应用程序上下文。</p>
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>作为用户<code class="codeph">sysadmin_vpd</code> ，创建以下登录触发器：</p><pre class="oac_no_warn" dir="ltr">创建TRIGGER set_custno_ctx_trig登录DATABASE BEGIN后sysadmin_vpd.orders_ctx_pkg.set_custnum;结束; /</pre></li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="using-application-contexts-to-retrieve-user-information.html#GUID-580EE6B3-D244-4AAE-BBB5-BB606A456410" title="用户登录数据库实例后必须运行数据库会话应用程序上下文包。">登录触发器以运行数据库会话应用程序上下文包</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="DBSEG1053"></a><div class="props_rev_3"><a id="GUID-F3102964-ED20-40C5-97DB-C9EE9E13D60A" name="GUID-F3102964-ED20-40C5-97DB-C9EE9E13D60A"></a><h5 id="DBSEG-GUID-F3102964-ED20-40C5-97DB-C9EE9E13D60A" class="sect5">步骤5：测试登录触发器</h5>
                     <div>
                        <p>当触发器运行<code class="codeph">sysadmin_vpd.orders_ctx_pkg.set_custnum</code>过程时，登录触发器为用户设置应用程序上下文。
                        </p>
                        <ol>
                           <li class="stepexpand"><span>以用户<code class="codeph">tbrooke</code>连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT tbrooke <span class="italic">- 对于CDB，连接到PDB，例如@hrpdb</span>输入密码： <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>执行以下查询：</span><div><pre class="oac_no_warn" dir="ltr">SELECT SYS_CONTEXT（'orders_ctx'，'cust_no'）custnum FROM DUAL;</pre><p>应出现以下输出：</p><pre class="oac_no_warn" dir="ltr">EMP_ID ------------------------------------------------- ------------------ 1234</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG290"></a><div class="props_rev_3"><a id="GUID-B0EC8CD5-43FB-4FCA-A61A-6E62E6B21A9D" name="GUID-B0EC8CD5-43FB-4FCA-A61A-6E62E6B21A9D"></a><h5 id="DBSEG-GUID-B0EC8CD5-43FB-4FCA-A61A-6E62E6B21A9D" class="sect5">步骤6：创建PL / SQL策略功能以限制用户访问其订单</h5>
                     <div>
                        <p>下一步是创建一个PL / SQL函数来控制用户查询的显示。</p>
                        <div class="section">当已登录的用户执行<code class="codeph">SELECT * FROM scott.orders_tab</code>查询时，该函数应使输出仅显示该用户的订单。
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>以<code class="codeph">sysadmin_vpd</code>用户身份进行连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sysadmin_vpd <span class="italic">- 或者，CONNECT sysadmin_vpd @hrpdb</span>输入密码： <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>创建以下功能：</span><div><pre class="oac_no_warn" dir="ltr">创建或替换函数get_user_orders（schema_p IN VARCHAR2，table_p IN VARCHAR2）RETURN VARCHAR2 AS orders_pred VARCHAR2（400）; BEGIN orders_pred：='cust_no = SYS_CONTEXT（''orders_ctx''，''cust_no''）'; RETURN orders_pred;结束; /</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>此函数创建并返回<code class="codeph">WHERE</code>谓词，该谓词转换为“显示的订单属于已登录的用户的位置”。然后，它将此<code class="codeph">WHERE</code>谓词附加到此用户可能针对<code class="codeph">scott.orders_tab</code>表运行的任何查询。接下来，您已准备好创建将此功能应用于<code class="codeph">orders_tab</code>表的Oracle虚拟专用数据库策略。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG291"></a><div class="props_rev_3"><a id="GUID-FD4D9C74-93B0-4E28-81C9-D75D85400748" name="GUID-FD4D9C74-93B0-4E28-81C9-D75D85400748"></a><h5 id="DBSEG-GUID-FD4D9C74-93B0-4E28-81C9-D75D85400748" class="sect5">第7步：创建新的安全策略</h5>
                     <div>
                        <p>最后，您已准备好创建VPD安全策略。</p>
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>作为用户<code class="codeph">sysadmin_vpd</code> ，使用<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程创建策略，如下所示：</p><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_POLICY（object_schema =&gt;'scott'，object_name =&gt;'orders_tab'，policy_name =&gt;'orders_policy'，function_schema =&gt;'sysadmin_vpd'，policy_function =&gt;'get_user_orders'，statement_types =&gt;'select'，policy_type =&gt; DBMS_RLS.CONTEXT_SENSITIVE，namespace =&gt;'orders_ctx'，attribute =&gt;'cust_no'）;结束; /</pre></li>
                           </ul>
                           <p>此语句创建名为<code class="codeph">orders_policy</code>的策略，并将其应用于<code class="codeph">orders_tab</code>表，客户将在<code class="codeph">SCOTT</code>模式中查询其订单。<code class="codeph">get_user_orders</code>函数实现策略，该策略存储在<code class="codeph">sysadmin_vpd</code>模式中。该策略进一步限制用户仅发出<code class="codeph">SELECT</code>语句。<code class="codeph">namespace</code>和<code class="codeph">attribute</code>参数指定您之前创建的应用程序上下文。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG292"></a><div class="props_rev_3"><a id="GUID-E188CB4D-BCF3-4A2F-87BC-2688EC05C699" name="GUID-E188CB4D-BCF3-4A2F-87BC-2688EC05C699"></a><h5 id="DBSEG-GUID-E188CB4D-BCF3-4A2F-87BC-2688EC05C699" class="sect5">第8步：测试新政策</h5>
                     <div>
                        <p>现在您已经创建了所有组件，您就可以测试该策略了。</p>
                        <ol>
                           <li class="stepexpand"><span>以用户<code class="codeph">tbrooke</code>连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT tbrooke <span class="italic">- 或者，CONNECT tbrooke @ hrpdb</span>输入密码： <span class="italic">password</span>
</pre><p>用户<code class="codeph">tbrooke</code>可以登录，因为他已经通过了您在应用程序上下文中定义的要求。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>用户<code class="codeph">tbrooke</code> ，访问您的购买。</span><div><pre class="oac_no_warn" dir="ltr">SELECT * FROM scott.orders_tab;</pre><p>应出现以下输出：</p><pre class="oac_no_warn" dir="ltr">CUST_NO ORDER_NO ---------- ---------- 1234 9876</pre><p>用户<code class="codeph">tbrooke</code>已通过第二次测试。他可以在<code class="codeph">scott.orders_tab</code>表中访问自己的订单。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>以用户<code class="codeph">owoods</code>连接，然后访问您的购买。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT owoods <span class="italic">- 对于CDB，连接到PDB，例如@hrpdb</span>输入密码： <span class="italic">password</span> SELECT * FROM scott.orders_tab</pre><p>应出现以下输出：</p><pre class="oac_no_warn" dir="ltr">CUST_NO ORDER_NO ---------- ---------- 5678 5432 5678 4592</pre><p>与用户<code class="codeph">tbrooke</code> ，用户<code class="codeph">owoods</code>可以登录并查看他自己的订单列表。
                                 </p>
                              </div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>请注意以下事项：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>您可以根据用户的位置创建多个谓词。例如，销售代表只能查看其客户的记录，订单输入员可以查看任何客户订单。您可以展开<code class="codeph">custnum_sec</code>函数以根据用户位置上下文值返回不同的谓词。
                                 </p>
                              </li>
                              <li>
                                 <p>在细粒度访问控制包中使用应用程序上下文可以有效地在解析语句中提供绑定变量。例如：</p><pre class="oac_no_warn" dir="ltr">SELECT * FROM scott.orders_tab WHERE cust_no = SYS_CONTEXT（'order_entry'，'cust_num'）;</pre><p>这是完全解析和优化的，但是对<code class="codeph">order_entry</code>上下文的用户的<code class="codeph">cust_num</code>属性值的评估是在运行时进行的。这意味着您可以获得优化语句的好处，该语句对发出语句的每个用户执行不同的操作。
                                 </p>
                                 <div class="infoboxnote" id="GUID-E188CB4D-BCF3-4A2F-87BC-2688EC05C699__GUID-E33CAA7E-3DCA-4A13-A816-2425E7B1242D">
                                    <p class="notep1">注意：</p>
                                    <p>您可以通过索引<code class="codeph">cust_no</code>来提高本教程中函数的性能。
                                    </p>
                                 </div>
                              </li>
                              <li>
                                 <p>您可以根据数据库表中的数据或使用轻型目录访问协议（LDAP）从目录服务器设置上下文属性。</p>
                              </li>
                           </ul>
                           <div class="infoboxnote" id="GUID-E188CB4D-BCF3-4A2F-87BC-2688EC05C699__GUID-B0170ECE-B7C3-4FC7-9A3D-04B63550B205">
                              <p class="notep1">注意：</p>
                              <p>有关触发器的更多信息，请<a href="../lnpls/plsql-triggers.html#LNPLS020" target="_blank"><span><cite>参见Oracle Database PL / SQL语言参考</cite></span></a></p>
                           </div>
                           <p>将本教程（使用动态生成的谓词中的应用程序上下文）与<a href="using-oracle-vpd-to-control-data-access.html#GUID-2E214F39-0739-4578-B3F9-36AC93E110CD" title="Oracle虚拟专用数据库策略将VPD功能与数据库表，视图或同义词相关联。">关于Oracle虚拟专用数据库策略</a> （使用谓词中的子查询）进行比较。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG293"></a><div class="props_rev_3"><a id="GUID-B7B6563A-F6B6-43B3-AF40-12A92EF47FE1" name="GUID-B7B6563A-F6B6-43B3-AF40-12A92EF47FE1"></a><h5 id="DBSEG-GUID-B7B6563A-F6B6-43B3-AF40-12A92EF47FE1" class="sect5">第9步：删除本教程的组件</h5>
                     <div>
                        <p>如果您不再需要本教程的组件，则可以删除它们。</p>
                        <ol>
                           <li class="stepexpand"><span>以<code class="codeph">SCOTT</code>用户身份连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT SCOTT <span class="italic">- 或者，连接SCOTT @ hrpdb</span>输入密码： <span class="italic">密码</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>删除<code class="codeph">orders_tab</code>和<code class="codeph">customers</code>表。</span><div><pre class="oac_no_warn" dir="ltr">DROP TABLE orders_tab; DROP TABLE客户;</pre></div>
                           </li>
                           <li class="stepexpand"><span>以<code class="codeph">SYS</code>用户身份连接，与<code class="codeph">AS SYSDBA</code>连接。</span><div><pre class="oac_no_warn" dir="ltr">将SYS作为SYSDBA连接<span class="italic">- 或者，连接SYS @hrpdb AS SYSDBA</span>输入密码： <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>运行以下语句以删除本教程的组件：</span><div><pre class="oac_no_warn" dir="ltr">DROP CONTEXT orders_ctx; DROP USER sysadmin_vpd CASCADE; DROP USER tbrooke; DROP USER owoods;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-52A959FA-E021-4C3A-B532-0C6289BDD50F" title="本教程演示了如何创建使用基于数据库会话的应用程序上下文的Oracle虚拟专用数据库策略。">教程：实现基于会话的应用程序上下文策略</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="DBSEG294"></a><div class="props_rev_3"><a id="GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" name="GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B"></a><h4 id="DBSEG-GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" class="sect4">教程：实施Oracle虚拟专用数据库策略组</h4>
                  <div>
                     <p>本教程演示了如何创建Oracle虚拟专用数据库策略组。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-B662EDF6-AD17-4E71-B358-51748793B1AF">关于本教程</a><br>本教程介绍如何使用Oracle虚拟专用数据库（VPD）创建策略组。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-A338A950-003C-435C-9A59-81F2188C9E7A">第1步：为本教程创建用户帐户和其他组件</a><br>首先，您必须为本教程创建用户帐户和表，并授予适当的权限。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-875B4EFA-9446-4DC6-8163-DC4B87DB3D81">第2步：创建两个策略组</a><br>接下来，您必须为两个非数据库用户<code class="codeph">provider_a</code>和<code class="codeph">provider_b</code>每一个创建一个策略组。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-BB24B7DE-CF63-4C49-AD51-1F498C3AE874">步骤3：创建PL / SQL函数以控制策略组</a><br>策略组必须具有定义应用程序如何控制用户数据访问的功能。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-B76F527D-35A0-44F0-A74C-25F9F85CCDAE">第4步：创建驾驶应用程序上下文</a><br>应用程序上下文确定登录的非数据库用户应使用哪个策略。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-3A3B0993-327A-4E02-B74D-4B6741AFE691">步骤5：将PL / SQL函数添加到策略组</a><br>现在您已经创建了必要的功能，您可以将它们与相应的策略组相关联。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-4642E9FE-4878-4940-A68F-1A45FE16F01A">第6步：测试策略组</a><br>现在您已准备好测试这两个策略组。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-A7BBA460-5283-4FB6-9E10-95D60D7639BC">第7步：删除本教程的组件</a><br>如果您不再需要本教程的组件，则可以删除它们。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-2113CF3C-D950-40B3-A121-A44284EF104D" title="这些教程展示了如何创建简单的基于数据库会话的Oracle虚拟专用策略，以及如何创建策略组。">教程：创建Oracle虚拟专用数据库策略</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG564"></a><div class="props_rev_3"><a id="GUID-B662EDF6-AD17-4E71-B358-51748793B1AF" name="GUID-B662EDF6-AD17-4E71-B358-51748793B1AF"></a><h5 id="DBSEG-GUID-B662EDF6-AD17-4E71-B358-51748793B1AF" class="sect5">关于本教程</h5>
                     <div>
                        <p>本教程介绍如何使用Oracle虚拟专用数据库（VPD）创建策略组。</p>
                        <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-011EB74C-42DD-4817-A847-5BB28D67F6BE" title="Oracle虚拟专用数据库策略组是可以应用于应用程序的VPD策略的命名集合。">Oracle虚拟专用数据库策略组</a>描述了如何对一组策略进行分组以在应用程序中使用。当非数据库用户登录到应用程序时，Oracle数据库会根据相应策略组中定义的策略授予用户访问权限。
                        </p>
                        <p>对于列级访问控制，每列或一组隐藏列由一个策略控制。在本教程中，您必须隐藏两组列。因此，您必须创建两个策略，每个策略对应一组要隐藏的列。您只需要为每个用户设置一个策略;驾驶应用程序上下文为您分离策略。</p>
                        <div class="infoboxnote" id="GUID-B662EDF6-AD17-4E71-B358-51748793B1AF__GUID-E4779620-742B-4C12-A56E-C11D761D13EA">
                           <p class="notep1">注意：</p>
                           <p>如果您使用的是多租户环境，则本教程仅适用于当前的PDB。</p>
                        </div>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" title="本教程演示了如何创建Oracle虚拟专用数据库策略组。">教程：实施Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG295"></a><div class="props_rev_3"><a id="GUID-A338A950-003C-435C-9A59-81F2188C9E7A" name="GUID-A338A950-003C-435C-9A59-81F2188C9E7A"></a><h5 id="DBSEG-GUID-A338A950-003C-435C-9A59-81F2188C9E7A" class="sect5">第1步：为本教程创建用户帐户和其他组件</h5>
                     <div>
                        <p>首先，您必须为本教程创建用户帐户和表，并授予适当的权限。</p>
                        <ol>
                           <li class="stepexpand"><span>使用<code class="codeph">SYSDBA</code>管理权限以<code class="codeph">SYS</code>用户身份登录。</span><div><pre class="oac_no_warn" dir="ltr">sqlplus sys as sysdba输入密码： <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>在多租户环境中，连接到相应的PDB。</span><div>
                                 <p>例如：</p><pre class="oac_no_warn" dir="ltr">CONNECT SYS @hrpdb AS SYSDBA输入密码： <span class="italic">password</span>
</pre><p>要查找可用的PDB，请运行<code class="codeph">show pdbs</code>命令。要检查当前PDB，请运行<code class="codeph">show con_name</code>命令。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>创建以下本地用户：</span><div><pre class="oac_no_warn" dir="ltr">CREATE USER apps_user IDENTIFIED BY <span class="italic">密码</span> CONTAINER = CURRENT; GRANT创建会话到apps_user; CREATE USER sysadmin_pg IDENTIFIED BY <span class="italic">密码</span> CONTAINER = CURRENT;授予创建会话，创建程序，为sysadmin_pg创建任何上下文;</pre><p>请遵循<a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle provides a set of minimum requirements for passwords.">密码最低要求中</a>的准则，使用安全<a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle提供了一组密码的最低要求。">密码</a>替换<span class="italic"><code class="codeph">password</code></span> 。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>为用户<code class="codeph">sysadmin_pg</code>授予以下额外权限：</span><div><pre class="oac_no_warn" dir="ltr">在DBMS_RLS上执行GRANT EXECUTE到sysadmin_pg;</pre></div>
                           </li>
                           <li class="stepexpand"><span>以用户<code class="codeph">OE</code>身份登录。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT OE <span class="italic">- 或者，连接OE @hrpdb</span>输入密码： <span class="italic">密码</span>
</pre><p>如果<code class="codeph">OE</code>帐户已锁定并已过期，则以<code class="codeph">SYS</code>用户身份重新连接<code class="codeph">SYSDBA</code>管理权限，并输入以下语句以解锁帐户并为其指定新密码：</p><pre class="oac_no_warn" dir="ltr">更改用户OE帐户解锁<span class="italic">密码</span>识别;</pre><p>使用安全密码替换<span class="italic"><code class="codeph">password</code></span> 。为了提高安全性，请不要重复使用以前版本的Oracle数据库中使用的相同密码。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>创建<code class="codeph">product_code_names</code>表：</span><div><pre class="oac_no_warn" dir="ltr">CREATE TABLE product_code_names（group_a varchar2（32），year_a varchar2（32），group_b varchar2（32），year_b varchar2（32））;</pre></div>
                           </li>
                           <li class="stepexpand"><span>将一些值插入<code class="codeph">product_code_names</code>表：</span><div><pre class="oac_no_warn" dir="ltr">INSERT INTO product_code_names值（'Biffo'，'2008'，'Beffo'，'2004'）; INSERT INTO product_code_names值（'Hortensia'，'2008'，'Bunko'，'2008'）; INSERT INTO product_code_names值（'Boppo'，'2006'，'Hortensia'，'2003'）;承诺;</pre></div>
                           </li>
                           <li class="stepexpand"><span>在<code class="codeph">product_code_names</code>表上授予<code class="codeph">apps_user</code>用户<code class="codeph">SELECT</code>权限。</span><div><pre class="oac_no_warn" dir="ltr">GRANT SELECT ON product_code_names TO apps_user;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" title="本教程演示了如何创建Oracle虚拟专用数据库策略组。">教程：实施Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG296"></a><div class="props_rev_3"><a id="GUID-875B4EFA-9446-4DC6-8163-DC4B87DB3D81" name="GUID-875B4EFA-9446-4DC6-8163-DC4B87DB3D81"></a><h5 id="DBSEG-GUID-875B4EFA-9446-4DC6-8163-DC4B87DB3D81" class="sect5">第2步：创建两个策略组</h5>
                     <div>
                        <p>接下来，您必须为两个非数据库用户<code class="codeph">provider_a</code>和<code class="codeph">provider_b</code>每一个创建一个策略组。
                        </p>
                        <ol>
                           <li class="stepexpand"><span>以<code class="codeph">sysadmin_pg</code>用户身份连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT sysadmin_pg <span class="italic">- 或者，CONNECT sysadmin_pg @hrpdb</span>输入密码： <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>创建<code class="codeph">provider_a_group</code>策略组，供用户<code class="codeph">provider_a</code> ：</span><div><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.CREATE_POLICY_GROUP（object_schema =&gt;'oe'，object_name =&gt;'product_code_names'，policy_group =&gt;'provider_a_group'）;结束; /</pre></div>
                           </li>
                           <li class="stepexpand"><span>创建<code class="codeph">provider_b_group</code>策略组，供用户<code class="codeph">provider_b</code> ：</span><div><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.CREATE_POLICY_GROUP（object_schema =&gt;'oe'，object_name =&gt;'product_code_names'，policy_group =&gt;'provider_b_group'）;结束; /</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" title="本教程演示了如何创建Oracle虚拟专用数据库策略组。">教程：实施Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG297"></a><div class="props_rev_3"><a id="GUID-BB24B7DE-CF63-4C49-AD51-1F498C3AE874" name="GUID-BB24B7DE-CF63-4C49-AD51-1F498C3AE874"></a><h5 id="DBSEG-GUID-BB24B7DE-CF63-4C49-AD51-1F498C3AE874" class="sect5">步骤3：创建PL / SQL函数以控制策略组</h5>
                     <div>
                        <p>策略组必须具有定义应用程序如何控制用户数据访问的功能。</p>
                        <div class="section">您将为此策略组创建的功能适用于<code class="codeph">provider_a</code>和<code class="codeph">provider_b</code>用户。
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>创建<code class="codeph">vpd_function_provider_a</code>函数，该函数限制用户<code class="codeph">provider_a</code>访问的数据。</span><div><pre class="oac_no_warn" dir="ltr"><code class="codeph">CREATE OR REPLACE FUNCTION</code> vpd_function_provider_a（varchar2中的模式，varchar2中的选项卡）将varchar2作为谓词返回varchar2（8）default NULL;如果开始下降（SYS_CONTEXT（'USERENV'，'CLIENT_IDENTIFIER'））='provider_a'那么谓词：='1 = 2'; ELSE NULL;万一;返回谓词;结束; /</pre><p>此函数检查登录的用户是否真的是用户<code class="codeph">provider_a</code> 。如果这是真的，那么只有在数据<code class="codeph">product_code_names</code>表列<code class="codeph">group_a</code>和<code class="codeph">year_a</code>将是可见的<code class="codeph">provider_a</code> 。在列数据<code class="codeph">group_b</code>和<code class="codeph">year_b</code>不会出现<code class="codeph">provider_a</code> 。其工作方式如下：设置<code class="codeph">predicate := '1=2'</code>隐藏相关列。在<a href="using-oracle-vpd-to-control-data-access.html#GUID-3A3B0993-327A-4E02-B74D-4B6741AFE691" title="现在您已经创建了必要的功能，您可以将它们与相应的策略组相关联。">步骤5：将PL / SQL函数添加到策略组中</a> ，您可以在<code class="codeph">SEC_RELEVANT_COLS</code>参数中指定这些列。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>创建<code class="codeph">vpd_function_provider_b</code>函数，该函数限制用户<code class="codeph">provider_a</code>访问的数据。</span><div><pre class="oac_no_warn" dir="ltr"><code class="codeph">CREATE OR REPLACE FUNCTION</code> vpd_function_provider_b（varchar2中的模式，varchar2中的选项卡）将varchar2作为谓词返回varchar2（8）default NULL;如果开始下降（SYS_CONTEXT（'USERENV'，'CLIENT_IDENTIFIER'））='provider_b'那么谓词：='1 = 2'; ELSE NULL;万一;返回谓词;结束; /</pre><p>与<code class="codeph">vpd_function_provider_a</code>函数类似，此函数检查登录的用户是否真的是用户<code class="codeph">provider_b</code> 。如果这是真的，则只有<code class="codeph">group_b</code>和<code class="codeph">year_b</code>列中的数据对<code class="codeph">provider_b</code>可见， <code class="codeph">group_a</code>和<code class="codeph">year_a</code>中的数据不出现在<code class="codeph">provider_b</code> 。与<code class="codeph">vpd_function_provider_a</code>函数类似， <code class="codeph">predicate := '1=2'</code>隐藏指定的相关列<a href="using-oracle-vpd-to-control-data-access.html#GUID-3A3B0993-327A-4E02-B74D-4B6741AFE691" title="Now that you have created the necessary functions, you are ready to associate them with their appropriate policy groups.">步骤5：将PL / SQL函数添加到</a> <code class="codeph">SEC_RELEVANT_COLS</code>参数中<a href="using-oracle-vpd-to-control-data-access.html#GUID-3A3B0993-327A-4E02-B74D-4B6741AFE691" title="现在您已经创建了必要的功能，您可以将它们与相应的策略组相关联。">的策略组</a> 。
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="using-oracle-vpd-to-control-data-access.html#GUID-532B05E7-2E08-4D8A-96B0-7F6EDD75DD14" title="Oracle虚拟专用数据库（VPD）功能定义了您要强制执行的限制。">生成动态WHERE子句的函数</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" title="本教程演示了如何创建Oracle虚拟专用数据库策略组。">教程：实施Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="DBSEG299"></a><div class="props_rev_3"><a id="GUID-B76F527D-35A0-44F0-A74C-25F9F85CCDAE" name="GUID-B76F527D-35A0-44F0-A74C-25F9F85CCDAE"></a><h5 id="DBSEG-GUID-B76F527D-35A0-44F0-A74C-25F9F85CCDAE" class="sect5">第4步：创建驾驶应用程序上下文</h5>
                     <div>
                        <p>应用程序上下文确定登录的非数据库用户应使用哪个策略。</p>
                        <ol>
                           <li class="stepexpand"><span>作为用户<code class="codeph">sysadmin_pg</code> ，创建驱动应用程序上下文，如下所示：</span><div><pre class="oac_no_warn" dir="ltr">创建或替换上下文provider_ctx使用provider_package;</pre></div>
                           </li>
                           <li class="stepexpand"><span>为应用程序上下文创建PL / SQL <code class="codeph">provider_package</code>包。</span><div><pre class="oac_no_warn" dir="ltr">创建或替换包提供者_package IS PROCEDURE set_provider_context（policy_group varchar2 default NULL）;结束; / CREATE OR REPLACE PACKAGE BODY provider_package AS PROCEDURE set_provider_context（policy_group varchar2 default NULL）IS BEGIN CASE LOWER（SYS_CONTEXT（'USERENV'，'CLIENT_IDENTIFIER'））当'provider_a'那么DBMS_SESSION.SET_CONTEXT（'provider_ctx'，'policy_group'，' PROVIDER_A_GROUP'）;当'provider_b'那么DBMS_SESSION.SET_CONTEXT（'provider_ctx'，'policy_group'，'PROVIDER_B_GROUP'）;结束案例; END set_provider_context;结束; /</pre></div>
                           </li>
                           <li class="stepexpand"><span>将<code class="codeph">provider_ctx</code>应用程序上下文与<code class="codeph">product_code_names</code>表相关联，然后提供名称。</span><div><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_POLICY_CONTEXT（object_schema =&gt;'oe'，object_name =&gt;'product_code_names'，namespace =&gt;'provider_ctx'，attribute =&gt;'policy_group'）;结束; /</pre></div>
                           </li>
                           <li class="stepexpand"><span>为<code class="codeph">apps_user</code>帐户授予<code class="codeph">provider_package</code>包的<code class="codeph">EXECUTE</code>特权。</span><div><pre class="oac_no_warn" dir="ltr">GRANT EXECUTE ON provider_package TO apps_user;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" title="本教程演示了如何创建Oracle虚拟专用数据库策略组。">教程：实施Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG298"></a><div class="props_rev_3"><a id="GUID-3A3B0993-327A-4E02-B74D-4B6741AFE691" name="GUID-3A3B0993-327A-4E02-B74D-4B6741AFE691"></a><h5 id="DBSEG-GUID-3A3B0993-327A-4E02-B74D-4B6741AFE691" class="sect5">步骤5：将PL / SQL函数添加到策略组</h5>
                     <div>
                        <p>现在您已经创建了必要的功能，您可以将它们与相应的策略组相关联。</p>
                        <ol>
                           <li class="stepexpand"><span>将<code class="codeph">vpd_function_provider_a</code>函数添加到<code class="codeph">provider_a_group</code>策略组。</span><div><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_GROUPED_POLICY（object_schema =&gt;'oe'，object_name =&gt;'product_code_names'，policy_group =&gt;'provider_a_group'，policy_name =&gt;'filter_provider_a'，function_schema =&gt;'sysadmin_pg'，policy_function =&gt;'vpd_function_provider_a'，statement_types =&gt; 'select'，policy_type =&gt; DBMS_RLS.CONTEXT_SENSITIVE，sec_relevant_cols =&gt;'group_b，year_b'，sec_relevant_cols_opt =&gt; DBMS_RLS.ALL_ROWS，namespace =&gt;'provider_ctx'，attribute =&gt;'provider_group'）;结束; /</pre><p><code class="codeph">sec_relevant_cols</code>参数中指定的<code class="codeph">group_b</code>和<code class="codeph">year_b</code>列对用户<code class="codeph">provider_a</code>是隐藏的。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>将<code class="codeph">vpd_function_provider_b</code>函数添加到<code class="codeph">provider_b_group</code>策略组。</span><div><pre class="oac_no_warn" dir="ltr">BEGIN DBMS_RLS.ADD_GROUPED_POLICY（object_schema =&gt;'oe'，object_name =&gt;'product_code_names'，policy_group =&gt;'provider_b_group'，policy_name =&gt;'filter_provider_b'，function_schema =&gt;'sysadmin_pg'，policy_function =&gt;'vpd_function_provider_b'，statement_types =&gt; 'select'，policy_type =&gt; DBMS_RLS.CONTEXT_SENSITIVE，sec_relevant_cols =&gt;'group_a，year_a'，sec_relevant_cols_opt =&gt; DBMS_RLS.ALL_ROWS，namespace =&gt;'provider_ctx'，attribute =&gt;'provider_group'）;结束; /</pre><p><code class="codeph">sec_relevant_cols</code>参数中指定的<code class="codeph">group_a</code>和<code class="codeph">year_a</code>列对用户<code class="codeph">provider_b</code>隐藏。
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" title="本教程演示了如何创建Oracle虚拟专用数据库策略组。">教程：实施Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG300"></a><div class="props_rev_3"><a id="GUID-4642E9FE-4878-4940-A68F-1A45FE16F01A" name="GUID-4642E9FE-4878-4940-A68F-1A45FE16F01A"></a><h5 id="DBSEG-GUID-4642E9FE-4878-4940-A68F-1A45FE16F01A" class="sect5">第6步：测试策略组</h5>
                     <div>
                        <p>现在您已准备好测试这两个策略组。</p>
                        <ol>
                           <li class="stepexpand"><span>以用户<code class="codeph">apps_user</code>连接，然后输入以下语句，以确保稍后创建的输出格式正确。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT apps_user <span class="italic">- 或者，CONNECT apps_user @hrpdb</span>输入密码： <span class="italic">password</span> col group_a format a16 col group_b format a16; col year_a格式a16; col year_b格式a16;</pre></div>
                           </li>
                           <li class="stepexpand"><span>将会话标识符设置为<code class="codeph">provider_a</code> 。</span><div><pre class="oac_no_warn" dir="ltr">EXEC DBMS_SESSION.SET_IDENTIFIER（'provider_a'）;</pre><p>这里，应用程序设置标识符。将标识符设置为<code class="codeph">provider_a</code> <code class="codeph">apps_user</code>用户设置为只应该看到<code class="codeph">provider_a_group</code>策略组中的产品可用的产品的用户。
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>运行<code class="codeph">provider_package</code>以根据上下文设置策略组。</span><div><pre class="oac_no_warn" dir="ltr">EXEC sysadmin_pg.provider_package.set_provider_context;</pre><p>在此阶段，您可以检查应用程序上下文的设置，如下所示：</p><pre class="oac_no_warn" dir="ltr">SELECT SYS_CONTEXT（'USERENV'，'CLIENT_IDENTIFIER'）AS END_USER FROM DUAL;</pre><p>应出现以下输出：</p><pre class="oac_no_warn" dir="ltr">END_USER ----------------- provider_a</pre></div>
                           </li>
                           <li class="stepexpand"><span>输入以下<code class="codeph">SELECT</code>语句：</span><div><pre class="oac_no_warn" dir="ltr">SELECT * FROM oe.product_code_names;</pre><p>应出现以下输出：</p><pre class="oac_no_warn" dir="ltr">GROUP_A YEAR_A GROUP_B YEAR_B ---------------- ---------------- -------------- -  ---------------- Biffo 2008 Hortensia 2008 Boppo 2006</pre></div>
                           </li>
                           <li class="stepexpand"><span>将客户端标识符设置为<code class="codeph">provider_b</code> ，然后输入以下语句：</span><div><pre class="oac_no_warn" dir="ltr">EXEC DBMS_SESSION.SET_IDENTIFIER（'provider_b'）; EXEC sysadmin_pg.provider_package.set_provider_context; SELECT * FROM oe.product_code_names;</pre><p>应出现以下输出：</p><pre class="oac_no_warn" dir="ltr">GROUP_A YEAR_A GROUP_B YEAR_B ---------------- ---------------- -------------- -  ---------------- Beffo 2004 Bunko 2008 Hortensia 2003</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" title="本教程演示了如何创建Oracle虚拟专用数据库策略组。">教程：实施Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG301"></a><div class="props_rev_3"><a id="GUID-A7BBA460-5283-4FB6-9E10-95D60D7639BC" name="GUID-A7BBA460-5283-4FB6-9E10-95D60D7639BC"></a><h5 id="DBSEG-GUID-A7BBA460-5283-4FB6-9E10-95D60D7639BC" class="sect5">第7步：删除本教程的组件</h5>
                     <div>
                        <p>如果您不再需要本教程的组件，则可以删除它们。</p>
                        <ol>
                           <li class="stepexpand"><span>以用户<code class="codeph">OE</code>身份连接。</span><div><pre class="oac_no_warn" dir="ltr">CONNECT OE <span class="italic">- 或者，连接OE @hrpdb</span>输入密码： <span class="italic">密码</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>删除<code class="codeph">product_code_names</code>表。</span><div><pre class="oac_no_warn" dir="ltr">DROP TABLE product_code_names;</pre></div>
                           </li>
                           <li class="stepexpand"><span>以<code class="codeph">SYS</code>用户身份连接<code class="codeph">SYSDBA</code>管理权限。</span><div><pre class="oac_no_warn" dir="ltr">将SYS作为SYSDBA连接<span class="italic">- 或者，连接SYS @hrpdb AS SYSDBA</span>输入密码： <span class="italic">password</span>
</pre></div>
                           </li>
                           <li class="stepexpand"><span>删除本教程的应用程序上下文和用户。</span><div><pre class="oac_no_warn" dir="ltr">DROP CONTEXT provider_ctx; DROP USER sysadmin_pg cascade; DROP USER apps_user;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" title="本教程演示了如何创建Oracle虚拟专用数据库策略组。">教程：实施Oracle虚拟专用数据库策略组</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="DBSEG302"></a><div class="props_rev_3"><a id="GUID-496F4B53-7206-4CDF-8F45-016067D0303D" name="GUID-496F4B53-7206-4CDF-8F45-016067D0303D"></a><h3 id="DBSEG-GUID-496F4B53-7206-4CDF-8F45-016067D0303D" class="sect3">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</h3>
               <div>
                  <p>您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-EF8092E7-C77D-4A9B-B9AC-33D272DB6EFD">带有版本的Oracle虚拟专用数据库策略</a><br>您应该了解如何将Oracle VPD与版本一起使用。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-F1FC8BE6-4695-46CC-BDAC-EE6524CAB8F1">在VPD保护的表上的用户查询中的SELECT FOR UPDATE语句</a><br>作为一般规则，用户在查询受虚拟专用数据库保护的表时不应包含<code class="codeph">FOR UPDATE</code>子句。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-0ADA7145-5C32-4E8A-8D8E-7B1F477E9493">Oracle虚拟专用数据库策略和外部或ANSI连接</a><br>Oracle虚拟专用数据库使用动态视图重写SQL。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-13F8AE16-15E5-4D9A-9F5D-247F15261E5D">Oracle虚拟专用数据库安全策略和应用程序</a><br>Oracle虚拟专用数据库安全策略应用于数据库本身，而不是应用程序中。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-F03172A8-730B-48EC-A904-FE747761863B">自动重新分析细粒度访问控制策略的功能</a><br>对使用细粒度访问控制启用的对象的查询运行策略函数，以便为每个策略使用最新谓词。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-FC004712-32D6-4AE4-B9B7-F1F7E4E9E2A5">Oracle虚拟专用数据库策略和闪回查询</a><br>数据库上的操作使用最近提交的可用数据。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-987DB35A-060B-4CD1-ADF6-147AD918E96F">Oracle虚拟专用数据库和Oracle Label Security</a><br>您可以将Oracle虚拟专用数据库与Oracle Label Security一起使用，但是当您这样做时，您应该了解安全性异常。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-7FFB40CB-E421-4FE4-8344-29D91360EFAD">使用EXPDP实用程序access_method参数导出数据</a><br>请注意，您是否尝试从已定义VPD策略的对象导出数据。
                     </li>
                     <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-1EBCA7B1-2991-4F5E-B36C-9CB446E943D8">用户模型和Oracle虚拟专用数据库</a><br>您可以在多种类型的用户模型中使用Oracle虚拟专用数据库。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-06022729-9210-4895-BF04-6177713C65A7" title="Oracle虚拟专用数据库（VPD）使您可以过滤访问数据的用户。">使用Oracle虚拟专用数据库控制数据访问</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG303"></a><div class="props_rev_3"><a id="GUID-EF8092E7-C77D-4A9B-B9AC-33D272DB6EFD" name="GUID-EF8092E7-C77D-4A9B-B9AC-33D272DB6EFD"></a><h4 id="DBSEG-GUID-EF8092E7-C77D-4A9B-B9AC-33D272DB6EFD" class="sect4">带有版本的Oracle虚拟专用数据库策略</h4>
                  <div>
                     <p>您应该了解如何将Oracle VPD与版本一起使用。</p>
                     <p>如果您正在准备基于版本的重新定义的应用程序，并且您使用版本视图覆盖了应用程序使用的每个表，则必须将保护这些表的虚拟专用数据库策略移动到编辑视图。</p>
                     <p>当已编辑的对象具有虚拟专用数据库策略时，它将应用于对象可见的所有版本。当实现编辑的对象时，附加到它的任何VPD策略都会新附加到新的实际事件。当您将VPD策略新应用于继承的已编辑对象时，此操作将实现它。</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-EF8092E7-C77D-4A9B-B9AC-33D272DB6EFD__GUID-F87D2752-50A3-4F00-8C2B-144270FA10AB">
                        <p class="notep1">也可以看看：</p>
                        <p>有关版本的详细信息，请参见<a href="../adfns/editions.html#ADFNS020" target="_blank"><span><cite>“Oracle数据库开发指南</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-496F4B53-7206-4CDF-8F45-016067D0303D" title="您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG304"></a><div class="props_rev_3"><a id="GUID-F1FC8BE6-4695-46CC-BDAC-EE6524CAB8F1" name="GUID-F1FC8BE6-4695-46CC-BDAC-EE6524CAB8F1"></a><h4 id="DBSEG-GUID-F1FC8BE6-4695-46CC-BDAC-EE6524CAB8F1" class="sect4">在VPD保护的表上的用户查询中的SELECT FOR UPDATE语句</h4>
                  <div>
                     <p>作为一般规则，用户在查询受虚拟专用数据库保护的表时不应包含<code class="codeph">FOR UPDATE</code>子句。
                     </p>
                     <p>虚拟专用数据库技术依赖于根据包含VPD策略功能生成的VPD谓词的内联视图重写用户的查询。因此，对视图的相同限制也适用于受VPD保护的表。如果用户对受VPD保护的表的查询在<code class="codeph">SELECT</code>语句中包含<code class="codeph">FOR UPDATE</code>子句，则在大多数情况下，查询可能不起作用。但是，如果VPD生成的内联视图足够简单，则用户的查询可能在某些情况下有效。
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-F1FC8BE6-4695-46CC-BDAC-EE6524CAB8F1__GUID-706F419F-BE8F-445F-8295-7A49D4F63A54">
                        <p class="notep1">也可以看看：</p>
                        <p>有关<code class="codeph">SELECT</code>语句中<code class="codeph">FOR UPDATE</code>子句限制的更多信息，请<a href="../sqlrf/SELECT.html#SQLRF01706" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-496F4B53-7206-4CDF-8F45-016067D0303D" title="您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG305"></a><div class="props_rev_3"><a id="GUID-0ADA7145-5C32-4E8A-8D8E-7B1F477E9493" name="GUID-0ADA7145-5C32-4E8A-8D8E-7B1F477E9493"></a><h4 id="DBSEG-GUID-0ADA7145-5C32-4E8A-8D8E-7B1F477E9493" class="sect4">Oracle虚拟专用数据库策略和外部或ANSI连接</h4>
                  <div>
                     <p>Oracle虚拟专用数据库使用动态视图重写SQL。</p>
                     <p>对于包含外部联接或ANSI操作的SQL，某些视图可能不会合并，并且可能不会使用某些索引。该问题是已知的优化限制。要解决此问题，请重写SQL以不使用外部联接或ANSI操作。</p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-496F4B53-7206-4CDF-8F45-016067D0303D" title="您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG306"></a><div class="props_rev_3"><a id="GUID-13F8AE16-15E5-4D9A-9F5D-247F15261E5D" name="GUID-13F8AE16-15E5-4D9A-9F5D-247F15261E5D"></a><h4 id="DBSEG-GUID-13F8AE16-15E5-4D9A-9F5D-247F15261E5D" class="sect4">Oracle虚拟专用数据库安全策略和应用程序</h4>
                  <div>
                     <p>Oracle虚拟专用数据库安全策略应用于数据库本身，而不是应用程序中。</p>
                     <p>因此，尝试使用其他应用程序访问数据的用户无法绕过Oracle虚拟专用数据库安全策略。在数据库中创建安全策略的另一个好处是，您可以将其维护在一个中心位置，而不是在多个应用程序中维护单独的安全策略。Oracle虚拟专用数据库以比较低的拥有成本提供比基于应用程序的安全性更强的安全性。</p>
                     <p>您可能希望根据访问数据的应用程序强制执行不同的安全策略。考虑两种应用程序Order Entry和Inventory都访问<code class="codeph">orders</code>表的情况。您可能希望Inventory应用程序使用根据产品类型限制访问的策略。同时，您可能希望订单输入应用程序使用根据客户编号限制访问的策略。
                     </p>
                     <p>在这种情况下，您必须按应用程序对细粒度访问的使用进行分区。否则，两个策略将自动连接在一起，这可能不是您想要的结果。您可以指定两个或多个策略组，以及确定哪个策略组对给定事务有效的驱动应用程序上下文。您还可以指定始终适用于数据访问的默认策略。例如，在托管应用程序中，数据访问应受订户ID的限制。</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="using-oracle-vpd-to-control-data-access.html#GUID-E2E04EE0-06B4-45F2-812B-9E2C65F6669B" title="本教程演示了如何创建Oracle虚拟专用数据库策略组。">教程：实施Oracle虚拟专用数据库策略组</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-496F4B53-7206-4CDF-8F45-016067D0303D" title="您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DBSEG307"></a><div class="props_rev_3"><a id="GUID-F03172A8-730B-48EC-A904-FE747761863B" name="GUID-F03172A8-730B-48EC-A904-FE747761863B"></a><h4 id="DBSEG-GUID-F03172A8-730B-48EC-A904-FE747761863B" class="sect4">自动重新分析细粒度访问控制策略的功能</h4>
                  <div>
                     <p>对使用细粒度访问控制启用的对象的查询运行策略函数，以便为每个策略使用最新谓词。</p>
                     <p>例如，在基于时间的策略函数的情况下，其中查询仅在上午8:00到下午5:00之间被允许，在中午解析的游标执行在那时运行策略函数，确保策略是再次咨询查询。即使光标在上午9点被解析，当它稍后运行时（例如，在中午），然后虚拟专用数据库策略函数再次运行以确保在当前时间（中午）仍然允许执行光标。这可确保它必须执行的安全检查是最新的。</p>
                     <p>在添加策略时将<code class="codeph">DBMS_RLS.ADD_POLICY</code>设置<code class="codeph">STATIC_POLICY</code>设置为<code class="codeph">TRUE</code>时，不会自动重新执行虚拟专用数据库策略功能。此设置使策略函数返回相同的谓词。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-496F4B53-7206-4CDF-8F45-016067D0303D" title="您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG308"></a><div class="props_rev_3"><a id="GUID-FC004712-32D6-4AE4-B9B7-F1F7E4E9E2A5" name="GUID-FC004712-32D6-4AE4-B9B7-F1F7E4E9E2A5"></a><h4 id="DBSEG-GUID-FC004712-32D6-4AE4-B9B7-F1F7E4E9E2A5" class="sect4">Oracle虚拟专用数据库策略和闪回查询</h4>
                  <div>
                     <p>数据库上的操作使用最近提交的可用数据。</p>
                     <p>闪回查询功能使您可以在过去的某个时间点查询数据库。</p>
                     <p>要编写使用闪回查询的应用程序，可以在SQL查询中使用<code class="codeph">AS OF</code>子句指定时间或系统更改编号（SCN），然后在指定时间内查询已提交的数据。您还可以使用<code class="codeph">DBMS_FLASHBACK</code> PL / SQL包，它需要更多代码，但允许您执行多个操作，所有操作都指向相同的时间点。
                     </p>
                     <p>但是，如果对受Oracle虚拟专用数据库策略保护的数据库对象使用闪回查询，则会将当前策略应用于旧数据。将当前的Oracle虚拟专用数据库策略应用于闪回查询数据更安全，因为它反映了最新的业务策略。</p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-FC004712-32D6-4AE4-B9B7-F1F7E4E9E2A5__GUID-2C958A9B-E86B-43CC-82FE-00E88197D431">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>有关闪回查询功能以及如何编写使用它的应用程序的详细信息，请参阅<a href="../adfns/flashback.html#ADFNS1008" target="_blank"><span><cite>“Oracle数据库开发指南”</cite></span></a></p>
                           </li>
                           <li>
                              <p>有关<code class="codeph">DBMS_FLASHBACK</code> PL / SQL包的更多信息，请<code class="codeph">DBMS_FLASHBACK</code> <a href="../arpls/DBMS_FLASHBACK.html#ARPLS142" target="_blank"><span><cite>Oracle Database PL / SQL包和类型参考</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-496F4B53-7206-4CDF-8F45-016067D0303D" title="您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG80854"></a><div class="props_rev_3"><a id="GUID-987DB35A-060B-4CD1-ADF6-147AD918E96F" name="GUID-987DB35A-060B-4CD1-ADF6-147AD918E96F"></a><h4 id="DBSEG-GUID-987DB35A-060B-4CD1-ADF6-147AD918E96F" class="sect4">Oracle虚拟专用数据库和Oracle Label Security</h4>
                  <div>
                     <p>您可以将Oracle虚拟专用数据库与Oracle Label Security一起使用，但是当您这样做时，您应该了解安全性异常。</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-63B4EB7D-2A73-4B84-B666-D8956B884F20">使用Oracle虚拟专用数据库实施Oracle Label Security策略</a><br>Oracle虚拟专用数据库策略提供基于Oracle Label Security用户授权的列级或行级访问控制。
                        </li>
                        <li class="ulchildlink"><a href="using-oracle-vpd-to-control-data-access.html#GUID-AA9D9B21-15B2-4785-B23E-70F93B03B341">Oracle虚拟专用数据库和Oracle Label Security异常</a><br>使用Oracle虚拟专用数据库和Oracle Label Security时，请注意安全性异常。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-496F4B53-7206-4CDF-8F45-016067D0303D" title="您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG88541"></a><div class="props_rev_3"><a id="GUID-63B4EB7D-2A73-4B84-B666-D8956B884F20" name="GUID-63B4EB7D-2A73-4B84-B666-D8956B884F20"></a><h5 id="DBSEG-GUID-63B4EB7D-2A73-4B84-B666-D8956B884F20" class="sect5">使用Oracle虚拟专用数据库实施Oracle Label Security策略</h5>
                     <div>
                        <p>Oracle虚拟专用数据库策略提供基于Oracle Label Security用户授权的列级或行级访问控制。</p>
                        <p>通常，您必须执行以下步骤：</p>
                        <ol>
                           <li>
                              <p>创建Oracle Label Security策略时，请不要将策略应用于要保护的表。（您创建的虚拟专用数据库策略将为您处理此问题。）在<code class="codeph">SA_SYSDBA.CREATE_POLICY</code>过程中，将<code class="codeph">default_options</code>参数设置为<code class="codeph">NO_CONTROL</code> 。</p>
                           </li>
                           <li id="GUID-63B4EB7D-2A73-4B84-B666-D8956B884F20__CIHGJFFG">
                              <p>创建Oracle Label Security标签组件并像平常一样授权用户。</p>
                           </li>
                           <li>
                              <p>创建Oracle虚拟专用数据库策略时，请执行以下操作：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>在为策略创建的PL / SQL函数中，使用Oracle Label Security <code class="codeph">DOMINATES</code>函数将用户的授权与您在步骤<a href="using-oracle-vpd-to-control-data-access.html#GUID-63B4EB7D-2A73-4B84-B666-D8956B884F20__CIHGJFFG">2中</a>创建的标签进行比较。<code class="codeph">DOMINATES</code>函数确定用户授权是否等于比较中使用的标签，或者它是否比比较中使用的标签更敏感。如果用户授权通过，则授予用户访问该列的权限。否则，拒绝用户访问。
                                    </p>
                                 </li>
                                 <li>
                                    <p>在虚拟专用数据库策略定义中，将此功能应用于要保护的表。在<code class="codeph">DBMS_RLS.ADD_POLICY</code>过程中，使用敏感列（ <code class="codeph">SEC_RELEVANT_COLS</code>参数）和列掩码（ <code class="codeph">SEC_RELEVANT_COLS_OPT</code>参数）功能来显示或隐藏基于Oracle Label Security用户授权的列。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-63B4EB7D-2A73-4B84-B666-D8956B884F20__GUID-1225A2A2-9D39-4C00-8B0A-1406C325EA0D">
                           <p class="notep1">也可以看看：</p>有关优势功能的详细信息，请参阅<a href="../olsag/advanced-topics-in-oracle-label-security.html#OLSAG3695" target="_blank"><span><cite>“Oracle Label Security管理员指南”</cite></span></a></div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-987DB35A-060B-4CD1-ADF6-147AD918E96F" title="您可以将Oracle虚拟专用数据库与Oracle Label Security一起使用，但是当您这样做时，您应该了解安全性异常。">Oracle虚拟专用数据库和Oracle Label Security</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG309"></a><div class="props_rev_3"><a id="GUID-AA9D9B21-15B2-4785-B23E-70F93B03B341" name="GUID-AA9D9B21-15B2-4785-B23E-70F93B03B341"></a><h5 id="DBSEG-GUID-AA9D9B21-15B2-4785-B23E-70F93B03B341" class="sect5">Oracle虚拟专用数据库和Oracle Label Security异常</h5>
                     <div>
                        <p>使用Oracle虚拟专用数据库和Oracle Label Security时，请注意安全性异常。</p>
                        <p></p>
                        <p>这些安全例外情况如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">导出数据时，在直接路径导出操作期间不会强制实施Oracle虚拟专用数据库和Oracle Label Security策略。</span> 在直接路径导出操作中，Oracle数据库将数据从磁盘读取到缓冲区高速缓存中，并将行直接传输到导出客户端。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">您无法将Oracle虚拟专用数据库策略和Oracle Label Security策略应用于SYS架构中的对象。</span> <code class="codeph">SYS</code>用户和与数据库建立DBA特权连接的用户（例如， <code class="codeph">CONNECT/AS SYSDBA</code> ）没有将Oracle虚拟专用数据库或Oracle Label Security策略应用于其操作。因此，无论用于从数据库中提取数据的导出模式，应用程序或实用程序如何，数据库用户<code class="codeph">SYS</code>始终免于Oracle虚拟专用数据库或Oracle Label Security强制实施。
                              </p>
                              <p>但是，您可以通过在安装时启用审计并指定将此审计跟踪存储在操作系统的安全位置来审计<code class="codeph">SYSDBA</code>操作。您还可以使用Oracle Database Vault密切监视<code class="codeph">SYS</code>用户。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">直接或通过数据库角色授予EXEMPT ACCESS POLICY权限的数据库用户可免于Oracle虚拟专用数据库强制执行。</span> 系统特权<code class="codeph">EXEMPT ACCESS POLICY</code>允许用户在任何<code class="codeph">SELECT</code>或DML操作（ <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code> ）上免除所有细粒度访问控制策略。这通过非<code class="codeph">SYS</code>模式提供了对管理活动（例如数据库的安装和导入和导出）的易用性。
                              </p>
                              <p>但是，即使授予<code class="codeph">EXEMPT ACCESS POLICY</code> ，以下策略执行选项仍然有效：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">INSERT_CONTROL</code> ， <code class="codeph">UPDATE_CONTROL</code> ， <code class="codeph">DELETE_CONTROL</code> ， <code class="codeph">WRITE_CONTROL</code> ， <code class="codeph">LABEL_UPDATE</code>和<code class="codeph">LABEL_DEFAULT</code></p>
                                 </li>
                                 <li>
                                    <p>如果Oracle Label Security策略指定<code class="codeph">ALL_CONTROL</code>选项，则应用除<code class="codeph">READ_CONTROL</code>和<code class="codeph">CHECK_CONTROL</code>之外的所有强制控制。</p>
                                 </li>
                              </ul>
                              <p>由于<code class="codeph">EXEMPT ACCESS POLICY</code>否定了细粒度访问控制的影响，因此您应该仅将此权限授予具有绕过细粒度访问控制实施的合法理由的用户。不要使用<code class="codeph">WITH ADMIN OPTION</code>授予此权限。如果这样做，用户可以将<code class="codeph">EXEMPT ACCESS POLICY</code>权限传递给其他用户，从而传播绕过细粒度访问控制的能力。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-AA9D9B21-15B2-4785-B23E-70F93B03B341__GUID-66571BF6-29E4-4BF2-B701-80B6977CB0C4">
                           <p class="notep1">注意：</p>
                           <p></p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><code class="codeph">EXEMPT ACCESS POLICY</code>权限不会影响对象权限（如<code class="codeph">SELECT</code> ， <code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code> 。即使用户被授予<code class="codeph">EXEMPT ACCESS POLICY</code>权限，也会强制执行这些权限。
                                 </p>
                              </li>
                              <li>
                                 <p>Oracle虚拟专用数据库使用的<code class="codeph">SYS_CONTEXT</code>值不会传播到辅助数据库以进行故障转移。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-AA9D9B21-15B2-4785-B23E-70F93B03B341__GUID-25EFA00E-EDCA-48D8-BAD2-84DF4320FF81">
                           <p class="notep1">也可以看看：</p><a href="../sutil/oracle-sql-loader-conventional-and-direct-loads.html#SUTIL009" target="_blank"><span><cite>Oracle数据库实用程序</cite></span></a> ，以获取有关直接路径导出操作的更多信</div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-987DB35A-060B-4CD1-ADF6-147AD918E96F" title="您可以将Oracle虚拟专用数据库与Oracle Label Security一起使用，但是当您这样做时，您应该了解安全性异常。">Oracle虚拟专用数据库和Oracle Label Security</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="DBSEG905"></a><div class="props_rev_3"><a id="GUID-7FFB40CB-E421-4FE4-8344-29D91360EFAD" name="GUID-7FFB40CB-E421-4FE4-8344-29D91360EFAD"></a><h4 id="DBSEG-GUID-7FFB40CB-E421-4FE4-8344-29D91360EFAD" class="sect4">使用EXPDP实用程序access_method参数导出数据</h4>
                  <div>
                     <p>请注意，您是否尝试从已定义VPD策略的对象导出数据。</p>
                     <p>如果您尝试使用Oracle数据泵导出（ <code class="codeph">EXPDP</code> ）实用程序并将<code class="codeph">access_method</code>参数设置为<code class="codeph">direct_path</code>以从包含其上定义了虚拟专用数据库策略的对象的模式导出数据，则可能会出现<code class="codeph">ORA-31696</code>错误消息出现，导出操作将失败。
                     </p>
                     <p>错误消息如下：</p><pre class="oac_no_warn" dir="ltr">ORA-31696：无法使用客户端指定的DIRECT_PATH方法导出/导入TABLE_DATA：“ <span class="italic">schema.table</span> ”</pre><p>仅当您作为尚未被授予<code class="codeph">EXP_FULL_DATABASE</code>角色的用户执行模式级别导出时，才会出现此问题。在完整数据库导出期间不会发生这种情况，这需要<code class="codeph">EXP_FULL_DATABASE</code>角色。<code class="codeph">EXP_FULL_DATABASE</code>角色包括<code class="codeph">EXP_FULL_DATABASE</code> <code class="codeph">EXEMPT ACCESS POLICY</code>系统特权，该特权绕过虚拟专用数据库策略。
                     </p>
                     <p>要查找基础问题，请再次尝试<code class="codeph">EXPDP</code>调用，但不要将<code class="codeph">access_method</code>参数设置为<code class="codeph">direct_path</code> 。相反，使用<code class="codeph">automatic</code>或<code class="codeph">external_table</code> 。根本问题可能是权限问题，例如：</p><pre class="oac_no_warn" dir="ltr">ORA-39181：由于“ <span class="italic">schema_name</span> ”上的细粒度访问控制，只能导出部分表数据。“ <span class="italic">object_name</span> ”</pre></div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-7FFB40CB-E421-4FE4-8344-29D91360EFAD__GUID-D16967B1-83D6-4554-AAFA-CB2F03E8D9D5">
                        <p class="notep1">也可以看看：</p>
                        <p>有关使用Data Pump Export的更多信息，请<a href="../sutil/oracle-data-pump-export-utility.html#SUTIL200" target="_blank"><span><cite>参见Oracle数据库实用程序</cite></span></a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-496F4B53-7206-4CDF-8F45-016067D0303D" title="您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG311"></a><a id="DBSEG310"></a><div class="props_rev_3"><a id="GUID-1EBCA7B1-2991-4F5E-B36C-9CB446E943D8" name="GUID-1EBCA7B1-2991-4F5E-B36C-9CB446E943D8"></a><h4 id="DBSEG-GUID-1EBCA7B1-2991-4F5E-B36C-9CB446E943D8" class="sect4">用户模型和Oracle虚拟专用数据库</h4>
                  <div>
                     <p>您可以在多种类型的用户模型中使用Oracle虚拟专用数据库。</p>
                     <p>这些用户模型如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="bold">同样是数据库用户的应用程序用户。</span> Oracle数据库使应用程序能够为每个用户强制执行细粒度的访问控制，无论该用户是数据库用户还是数据库未知的应用程序用户。当应用程序用户也是数据库用户时，Oracle虚拟专用数据库实施的工作方式如下：用户连接到数据库，然后应用程序为每个会话设置应用程序上下文。（您可以使用默认的<code class="codeph">USERENV</code>应用程序上下文命名空间，该命名空间提供许多参数以检索不同类型的用户会话数据。）由于每个会话是在不同的用户名下启动的，因此它可以为每个用户强制执行不同的细粒度访问控制条件。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">使用OCI或JDBC / OCI进行代理身份验证。</span>代理身份验证允许为每个用户提供不同的细粒度访问控制，因为每个会话（OCI或JDBC / OCI）都是具有自己的应用程序上下文的不同数据库会话。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">代理身份验证与Enterprise User Security集成。</span> 如果使用Enterprise User Security集成了代理身份验证，则可以从Oracle Internet Directory检索用户角色和其他属性，以强制实施Oracle虚拟专用数据库策略。（此外，还可以从目录中检索全局初始化的应用程序上下文。）
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">用户连接为一个大应用程序用户。</span> 代表所有用户作为单个用户连接到数据库的应用程序可以为每个用户提供细粒度的访问控制。该单个会话的用户通常称为“ <span class="italic">一个大应用程序用户”</span> 。但是，在该会话的上下文中，应用程序开发人员可以创建全局应用程序上下文属性来表示单个应用程序用户（例如， <code class="codeph">REALUSER</code> ）。虽然为一个大应用程序用户创建了所有数据库会话和审计记录，但每个会话的属性可能会有所不同，具体取决于最终用户的身份。此模型最适用于具有有限数量用户且不重用会话的应用程序。由于每个会话都是作为同一个数据库用户创建的，因此角色和数据库审计的范围会缩小。
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">基于Web的应用程序。</span> 基于Web的应用程序通常有数百个用户。即使存在与数据库的持久连接，支持许多用户请求的数据检索，这些连接也不是特定于基于Web的特定用户。相反，基于Web的应用程序通常会设置和重用连接，以提供可伸缩性，而不是为每个用户提供不同的会话。例如，当Web用户Jane和Ajit连接到中间层应用程序时，它可以建立一个代表两个用户使用的单个数据库会话。通常，数据库都不知道Jane和Ajit。应用程序负责在连接上切换用户名，以便在任何给定时间使用会话使用Jane或Ajit。
                           </p>
                           <p>Oracle虚拟专用数据库允许多个连接访问多个全局应用程序上下文，从而帮助实现连接池。此功能使得不必为每个不同的用户会话建立单独的应用程序上下文。</p>
                        </li>
                     </ul>
                     <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-1EBCA7B1-2991-4F5E-B36C-9CB446E943D8__CIHEFICI" title="此表总结了VPD在某些用户模型中的工作原理。">表12-3</a>总结了Oracle虚拟专用数据库如何应用于用户模型。
                     </p>
                     <div class="tblformalwide" id="GUID-1EBCA7B1-2991-4F5E-B36C-9CB446E943D8__CIHEFICI">
                        <p class="titleintable">表12-3不同用户模型中的Oracle虚拟专用数据库</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="不同用户模型中的Oracle虚拟专用数据库" width="100%" border="1" summary="This table summarizes how VPD works in certain user models." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="29%" id="d94784e14517">用户模型场景</th>
                                 <th class="text-center" valign="bottom" width="16%" id="d94784e14520">个人数据库连接</th>
                                 <th class="text-center" valign="bottom" width="21%" id="d94784e14523">每个用户单独的应用程序上下文</th>
                                 <th align="left" valign="bottom" width="16%" id="d94784e14526">单数据库连接</th>
                                 <th align="left" valign="bottom" width="20%" id="d94784e14529">应用程序必须切换用户名</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d94784e14534" headers="d94784e14517 ">
                                    <p>应用程序用户也是数据库用户</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d94784e14534 d94784e14520 ">
                                    <p>是</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d94784e14534 d94784e14523 ">
                                    <p>是</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d94784e14534 d94784e14526 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d94784e14534 d94784e14529 ">
                                    <p>没有</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d94784e14550" headers="d94784e14517 ">
                                    <p>使用OCI或JDBC / OCI进行代理身份验证</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d94784e14550 d94784e14520 ">
                                    <p>是</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d94784e14550 d94784e14523 ">
                                    <p>是</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d94784e14550 d94784e14526 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d94784e14550 d94784e14529 ">
                                    <p>没有</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d94784e14566" headers="d94784e14517 ">
                                    <p>与Enterprise User Security <a id="fn_2" name="fn_2" href="#fn_2" user="" roles="" and="" other="" attributes,="" including="" globally="" initialized="" application="" context,="" can="" be="" retrieved="" from="" oracle="" internet="" directory="" to="" enforce="" virtual="" private="" database=")" ="" ="" onclick="footdisplay(2, "><sup>Foot 2</sup></a>集成的代理身份验证</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d94784e14566 d94784e14520 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d94784e14566 d94784e14523 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d94784e14566 d94784e14526 ">
                                    <p>是</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d94784e14566 d94784e14529 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d94784e14585" headers="d94784e14517 ">
                                    <p>一个大应用程序用户</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d94784e14585 d94784e14520 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d94784e14585 d94784e14523 ">
                                    <p>没有<a id="fn_3" name="fn_3" href="#fn_3" application="" developers="" can="" create="" a="" global="" context="" attribute="" representing="" individual="" users="" (for="" example,="" realuser),="" which="" then="" be="" used="" for="" controlling="" each="" session="" attributes,="" or="" auditing=")" ="" ="" onclick="footdisplay(3, "><sup>脚3</sup></a></p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d94784e14585 d94784e14526 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d94784e14585 d94784e14529 ">
                                    <p>是的<sup>2</sup></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="29%" id="d94784e14609" headers="d94784e14517 ">
                                    <p>基于Web的应用程序</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d94784e14609 d94784e14520 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d94784e14609 d94784e14523 ">
                                    <p>没有</p>
                                 </td>
                                 <td align="left" valign="top" width="16%" headers="d94784e14609 d94784e14526 ">
                                    <p>是</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d94784e14609 d94784e14529 ">
                                    <p>是</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p class="tablefootnote"><sup class="tablefootnote">脚注2</sup></p><p>可以从Oracle Internet Directory检索用户角色和其他属性（包括全局初始化的应用程序上下文）以强制实施Oracle虚拟专用数据库。</p>
                     <p></p>
                     <p class="tablefootnote"><sup class="tablefootnote">脚注3</sup></p><p>应用程序开发人员可以创建表示各个应用程序用户（例如， <code class="codeph">REALUSER)</code>的全局应用程序上下文属性，然后可以将其用于控制每个会话属性或进行审计。
                        </p>
                     <p></p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="using-application-contexts-to-retrieve-user-information.html#GUID-85E9C986-4D83-4DBB-9A2E-000E737F30D6" title="您可以使用全局应用程序上下文跨数据库会话访问应用程序值，包括Oracle Real Application Clusters环境。">全球应用程序上下文</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-496F4B53-7206-4CDF-8F45-016067D0303D" title="您应该了解将Oracle虚拟专用数据库与其他Oracle功能一起使用的影响。">Oracle虚拟专用数据库如何与其他Oracle功能一起使用</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="DBSEG313"></a><a id="DBSEG312"></a><div class="props_rev_3"><a id="GUID-09300037-0440-4212-B28A-1EABEA6ABDB2" name="GUID-09300037-0440-4212-B28A-1EABEA6ABDB2"></a><h3 id="DBSEG-GUID-09300037-0440-4212-B28A-1EABEA6ABDB2" class="sect3">Oracle虚拟专用数据库数据字典视图</h3>
               <div>
                  <p>Oracle数据库提供了列出有关Oracle虚拟专用数据库策略的信息的数据字典视图。</p>
                  <div class="section">
                     <p><a href="using-oracle-vpd-to-control-data-access.html#GUID-09300037-0440-4212-B28A-1EABEA6ABDB2__CIHGIGID" title="VPD政策视图">表12-4</a>列出了特定于虚拟专用数据库的视图</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformalwide" id="GUID-09300037-0440-4212-B28A-1EABEA6ABDB2__CIHGIGID">
                     <p class="titleintable">表12-4显示有关VPD策略信息的数据字典视图</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="显示有关VPD策略信息的数据字典视图" width="100%" border="1" summary="VPD Policy Views" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="32%" id="d94784e14766">视图</th>
                              <th align="left" valign="bottom" width="68%" id="d94784e14769">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14774" headers="d94784e14766 ">
                                 <p><code class="codeph">ALL_POLICIES</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14774 d94784e14769 ">
                                 <p>描述当前用户可访问的对象的所有Oracle虚拟专用数据库安全策略。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14782" headers="d94784e14766 ">
                                 <p><code class="codeph">ALL_POLICY_ATTRIBUTES</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14782 d94784e14769 ">
                                 <p>描述所有应用程序上下文命名空间，属性和虚拟专用数据库策略关联，其中登录用户是VPD策略的所有者或VPD策略属于<code class="codeph">PUBLIC</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14793" headers="d94784e14766 ">
                                 <p><code class="codeph">ALL_POLICY_CONTEXTS</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14793 d94784e14769 ">
                                 <p>描述为当前用户可访问的同义词，表和视图定义的驱动上下文。驱动上下文是Oracle虚拟专用数据库策略中使用的应用程序上下文。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14801" headers="d94784e14766 ">
                                 <p><code class="codeph">ALL_POLICY_GROUPS</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14801 d94784e14769 ">
                                 <p>描述为当前用户可访问的同义词，表和视图定义的Oracle虚拟专用数据库策略组</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14810" headers="d94784e14766 ">
                                 <p><code class="codeph">ALL_SEC_RELEVANT_COLS</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14810 d94784e14769 ">
                                 <p>描述当前用户可访问的表和视图的安全策略的安全相关列</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14819" headers="d94784e14766 ">
                                 <p><code class="codeph">DBA_POLICIES</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14819 d94784e14769 ">
                                 <p>描述数据库中的所有Oracle Virtual Private Database安全策略。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14827" headers="d94784e14766 ">
                                 <p><code class="codeph">DBA_POLICY_ATTRIBUTES</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14827 d94784e14769 ">
                                 <p>描述上下文相关和共享上下文相关的虚拟专用数据库策略的所有应用程序上下文命名空间，属性和虚拟专用数据库策略关联</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14835" headers="d94784e14766 ">
                                 <p><code class="codeph">DBA_POLICY_GROUPS</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14835 d94784e14769 ">
                                 <p>描述数据库中的所有策略组。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14843" headers="d94784e14766 ">
                                 <p><code class="codeph">DBA_POLICY_CONTEXTS</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14843 d94784e14769 ">
                                 <p>描述数据库中的所有驱动上下文。其列与<code class="codeph">ALL_POLICY_CONTEXTS</code>列相同。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14854" headers="d94784e14766 ">
                                 <p><code class="codeph">DBA_SEC_RELEVANT_COLS</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14854 d94784e14769 ">
                                 <p>描述数据库中所有安全策略的安全相关列</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14863" headers="d94784e14766 ">
                                 <p><code class="codeph">UNIFIED_AUDIT_TRAIL</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14863 d94784e14769 ">
                                 <p>捕获<code class="codeph">RLS_INFO</code>列中的VPD谓词，以进行统一审计和细粒度审计</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14875" headers="d94784e14766 ">
                                 <p><code class="codeph">USER_POLICIES</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14875 d94784e14769 ">
                                 <p>描述与当前用户拥有的对象关联的所有Oracle Virtual Private Database安全策略。此视图不显示<code class="codeph">OBJECT_OWNER</code>列。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14886" headers="d94784e14766 ">
                                 <p><code class="codeph">USER_POLICY_ATTRIBUTES</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14886 d94784e14769 ">
                                 <p>描述虚拟专用数据库策略的所有者是当前用户的所有应用程序上下文命名空间，属性和虚拟专用数据库策略关联</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14894" headers="d94784e14766 ">
                                 <p><code class="codeph">USER_POLICY_CONTEXTS</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14894 d94784e14769 ">
                                 <p>描述为当前用户拥有的同义词，表和视图定义的驱动上下文。它的列（除了<code class="codeph">OBJECT_OWNER</code> ）是相同的<code class="codeph">ALL_POLICY_CONTEXTS</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14908" headers="d94784e14766 ">
                                 <p><code class="codeph">USER_SEC_RELEVANT_COLS</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14908 d94784e14769 ">
                                 <p>描述当前用户拥有的表和视图的安全策略的安全相关列。它的列（除了<code class="codeph">OBJECT_OWNER</code> ）是相同的<code class="codeph">ALL_SEC_RELEVANT_COLS</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14923" headers="d94784e14766 ">
                                 <p><code class="codeph">USER_POLICY_GROUPS</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14923 d94784e14769 ">
                                 <p>描述为当前用户拥有的同义词，表和视图定义的策略组。此视图不显示<code class="codeph">OBJECT_OWNER</code>列。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="32%" id="d94784e14934" headers="d94784e14766 ">
                                 <p><code class="codeph">V $ VPD_POLICY</code></p>
                              </td>
                              <td align="left" valign="top" width="68%" headers="d94784e14934 d94784e14769 ">
                                 <p>对于当前PDB，显示与当前库缓存中的游标关联的所有细粒度安全策略和谓词。此视图对于查找应用于SQL语句的策略很有用。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <div class="infobox-tip" id="GUID-09300037-0440-4212-B28A-1EABEA6ABDB2__GUID-01527CF6-4E81-4F80-99C6-DF1B5E2CFE0F">
                        <p class="notep1">小费：</p>
                        <p>除了这些视图之外，如果在使用虚拟专用数据库策略的应用程序中发现错误，请检查数据库跟踪文件。<code class="codeph">USER_DUMP_DEST</code>初始化参数指定跟踪文件的当前位置。您可以通过在SQL * Plus中发出<code class="codeph">SHOW PARAMETER USER_DUMP_DEST</code>来查找此参数的值。
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-09300037-0440-4212-B28A-1EABEA6ABDB2__GUID-F9E14249-6728-41AF-9D0A-3E42AACF6BAB">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="../refrn/index.html" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>有关这些视图的更多信息</p>
                        </li>
                        <li>
                           <p>有关跟踪文件的详细信息，请<a href="../tgsql/performing-application-tracing.html#TGSQL791" target="_blank"><span><cite>参见“Oracle数据库SQL调优指南”</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-vpd-to-control-data-access.html#GUID-06022729-9210-4895-BF04-6177713C65A7" title="Oracle虚拟专用数据库（VPD）使您可以过滤访问数据的用户。">使用Oracle虚拟专用数据库控制数据访问</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>