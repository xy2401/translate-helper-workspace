<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="This chapter explains how integrity constraints enforce the business rules associated with a database and prevent the entry of invalid information into tables."></meta>
      <meta name="description" content="This chapter explains how integrity constraints enforce the business rules associated with a database and prevent the entry of invalid information into tables."></meta>
      <title>数据的完整性</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Concepts"></meta>
      <meta property="og:description" content="This chapter explains how integrity constraints enforce the business rules associated with a database and prevent the entry of invalid information into tables."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Concepts"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-concepts.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T07:47:16-08:00"></meta>
      <meta name="dcterms.title" content="Database Concepts"></meta>
      <meta name="dcterms.dateCopyrighted" content="1993, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96138-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="partitions-views-and-other-schema-objects.html" title="Previous" type="text/html"></link>
      <link rel="next" href="data-dictionary-and-dynamic-performance-views.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CNCPT"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="partitions-views-and-other-schema-objects.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="data-dictionary-and-dynamic-performance-views.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库概念</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-relational-structures.html" property="item" typeof="WebPage"><span property="name">Oracle关系数据结构</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">数据的完整性</li>
            </ol>
            <a id="GUID-6A89FF39-AD42-4399-BD1B-E51ECEE50B4E" name="GUID-6A89FF39-AD42-4399-BD1B-E51ECEE50B4E"></a><a id="CNCPT021"></a>
            
            <h2 id="CNCPT-GUID-6A89FF39-AD42-4399-BD1B-E51ECEE50B4E" class="sect2"><span class="enumeration_chapter">5</span>数据完整性</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍完整性约束如何实施与数据库关联的业务规则，并防止将无效信息输入表中。</p>
               <p>本章包含以下部分：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="data-integrity.html#GUID-A8893CD7-8B19-42AA-8550-9713071FA679" title="数据保持数据完整性非常重要，这符合数据库管理员或应用程序开发人员确定的业务规则。">数据完整性简介</a></p>
                  </li>
                  <li>
                     <p><a href="data-integrity.html#GUID-1C9665AD-A444-4AFB-984F-6385FCBEA64E" title="Oracle数据库使您可以在表级和列级应用约束。">完整性约束的类型</a></p>
                  </li>
                  <li>
                     <p><a href="data-integrity.html#GUID-97D4BB23-FD4B-4FB6-BE21-E5F8C43BD94F" title="作为约束定义的一部分，您可以指定Oracle数据库应如何以及何时强制执行约束，从而确定约束状态。">完整性约束条件</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-6A89FF39-AD42-4399-BD1B-E51ECEE50B4E__GUID-05504E74-A476-4D7B-A386-2B9EFF90156A">
                  <p class="notep1">也可以看看：</p>
                  <p><span class="q">“ <a href="tables-and-table-clusters.html#GUID-F845B1A7-71E3-4312-B66D-BC16C198ECE5" title="表是Oracle数据库中数据组织的基本单元。">表概述</a> ”</span>了解列的背景和完整性约束的必要性</p>
               </div>
            </div><a id="CNCPT122"></a><div class="props_rev_3"><a id="GUID-A8893CD7-8B19-42AA-8550-9713071FA679" name="GUID-A8893CD7-8B19-42AA-8550-9713071FA679"></a><h3 id="CNCPT-GUID-A8893CD7-8B19-42AA-8550-9713071FA679" class="sect3">数据完整性简介</h3>
               <div>
                  <p>数据保持<span class="bold">数据完整性</span>非常重要，这符合数据库管理员或应用程序开发人员确定的业务规则。
                  </p>
                  <p>业务规则指定必须始终为true或必须始终为false的条件和关系。例如，每家公司都定义了自己的工资，员工编号，库存跟踪等政策。</p>
               </div><a id="CNCPT33333"></a><div class="props_rev_3"><a id="GUID-724DD096-39F4-4A0B-9C76-5360D46C1686" name="GUID-724DD096-39F4-4A0B-9C76-5360D46C1686"></a><h4 id="CNCPT-GUID-724DD096-39F4-4A0B-9C76-5360D46C1686" class="sect4">保证数据完整性的技术</h4>
                  <div>
                     <p>在设计数据库应用程序时，开发人员可以使用多种选项来保证数据库中存储的数据的完整性。</p>
                     <p>这些选项包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用触发的存储数据库过程实施业务规则</p>
                        </li>
                        <li>
                           <p>使用存储过程完全控制对数据的访问</p>
                        </li>
                        <li>
                           <p>在数据库应用程序的代码中实施业务规则</p>
                        </li>
                        <li>
                           <p>使用Oracle数据库完整性约束，这些约束是在列或对象级别定义的限制数据库中的值的规则</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-724DD096-39F4-4A0B-9C76-5360D46C1686__GUID-9BAFE885-3D2F-4DEC-8F66-1080659D65B0">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="server-side-programming.html#GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63" title="A database trigger is a compiled stored program unit, written in either PL/SQL or Java, that Oracle Database invokes (" fire=")=" ="">触发器概述</a> ”</span>解释了<span class="q"><a href="server-side-programming.html#GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63" title="数据库触发器是一个编译的存储程序单元，用PL / SQL或Java编写，Oracle数据库调用（" fire=")=" ="">触发器</a></span>的用途和类型</p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="server-side-programming.html#GUID-6B5D98B7-A25D-4187-B3A9-43629E214635" title="在诸如SQL的非过程语言中，指定要操作的数据集，但不指定要执行的操作或它们的执行方式。">服务器端编程简介</a> ”</span>解释了存储过程的目的和特征</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT33334"></a><div class="props_rev_3"><a id="GUID-FBAEAD76-CC71-40BF-B133-6EBCC2AA5A9D" name="GUID-FBAEAD76-CC71-40BF-B133-6EBCC2AA5A9D"></a><h4 id="CNCPT-GUID-FBAEAD76-CC71-40BF-B133-6EBCC2AA5A9D" class="sect4">完整性约束的优点</h4>
                  <div>
                     <p>完整性约束是使用SQL创建和删除的模式对象。要强制执行数据完整性，请尽可能使用完整性约束。</p>
                     <p>完整性限制优于强制执行数据完整性的替代方案的优点包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>陈述轻松</p>
                           <p>因为使用SQL语句定义完整性约束，所以在定义或更改表时不需要其他编程。SQL语句易于编写并消除编程错误。</p>
                        </li>
                        <li>
                           <p>集中规则</p>
                           <p>为表定义了完整性约束，并将其存储在<a href="glossary.html#GUID-D6A3934F-BA6D-464F-9612-C683E20514A4"><span class="xrefglossterm">数据字典中</span></a> 。因此，所有应用程序输入的数据必须遵循相同的完整性约束。如果规则在表级别更改，则应用程序无需更改。此外，即使在数据库检查SQL语句之前，应用程序也可以使用数据字典中的元数据立即通知用户违规。
                           </p>
                        </li>
                        <li>
                           <p>加载数据时的灵活性</p>
                           <p>您可以临时禁用完整性约束，以避免在加载大量数据时的性能开销。数据加载完成后，您可以重新启用完整性约束。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-FBAEAD76-CC71-40BF-B133-6EBCC2AA5A9D__GUID-B98886C5-41C9-4F6C-9987-F066974F8147">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="data-dictionary-and-dynamic-performance-views.html#GUID-9B9ABE1C-A1E3-464F-8936-978250DC3E1F" title="Oracle数据库的一个重要部分是它的数据字典，它是一组只读表，提供有关数据库的管理元数据。">数据字典概述</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../tdddg/creating-managing-schema-objects.html#TDDDG32200" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a>和<a href="../adfns/data-integrity.html#ADFNS004" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a> ，了解如何维护数据完整性</p>
                           </li>
                           <li>
                              <p><a href="../admin/managing-schema-objects.html#ADMIN11537" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a> ，了解如何管理完整性约束</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT88884"></a><a id="CNCPT322"></a><div class="props_rev_3"><a id="GUID-1C9665AD-A444-4AFB-984F-6385FCBEA64E" name="GUID-1C9665AD-A444-4AFB-984F-6385FCBEA64E"></a><h3 id="CNCPT-GUID-1C9665AD-A444-4AFB-984F-6385FCBEA64E" class="sect3">完整性约束的类型</h3>
               <div>
                  <p>Oracle数据库使您可以在表级和列级应用约束。</p>
                  <p>指定为列或属性定义的一部分的约束是内联规范。作为表定义的一部分指定的约束是外部规范。</p>
                  <p><a href="glossary.html#GUID-E0D85C39-5CB4-4E85-A9AB-3834FA6F09C7"><span class="xrefglossterm">键</span></a>是某些类型的完整性约束的定义中包含的列或列集。键描述关系数据库的表和列之间的关系。密钥中的各个值称为<a href="glossary.html#GUID-034BA760-3056-4791-A624-03BB28B82AFD"><span class="xrefglossterm">密钥值</span></a> 。
                  </p>
                  <p>下表描述了约束的类型。每个都可以指定为内联或外联，但<code class="codeph">NOT NULL</code>除外，它必须是内联的。
                  </p>
                  <div class="tblformal" id="GUID-1C9665AD-A444-4AFB-984F-6385FCBEA64E__TYPESOFCONSTRAINTSCONSTRAINTTYPEDES-185E6EB1">
                     <p class="titleintable">表5-1完整性约束的类型</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="完整性约束的类型" width="100%" border="1" summary="This table describes the types of integrity constraints." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d31842e1564">约束类型</th>
                              <th align="left" valign="bottom" width="20%" id="d31842e1566">描述</th>
                              <th align="left" valign="bottom" width="20%" id="d31842e1568">也可以看看</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d31842e1572" headers="d31842e1564 ">
                                 <p><code class="codeph">不是NULL</code></p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1572 d31842e1566 ">
                                 <p>允许或禁止在指定列中插入或更新包含<a href="glossary.html#GUID-8854502F-2B8F-4ABC-98FA-BBFC3695A964"><span class="xrefglossterm">null</span></a>的行。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1572 d31842e1568 ">
                                 <p><span class="q">“ <a href="data-integrity.html#GUID-CF2E06A6-6A35-46CE-808E-305A459457CC" title="NOT NULL约束要求表的列不包含空值。null表示没有值。默认情况下，表中的所有列都允许空值。">NOT NULL Integrity Constraints</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d31842e1597" headers="d31842e1564 ">
                                 <p>独特的钥匙</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1597 d31842e1566 ">
                                 <p>禁止多行在同一列或列组合中具有相同的值，但允许某些值为null。</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1597 d31842e1568 ">
                                 <p><span class="q">“ <a href="data-integrity.html#GUID-077C26A1-49C3-4E72-AE1D-7CEDD997917A" title="唯一键约束要求列或列集中的每个值都是唯一的。表的任何行都不会在具有唯一键约束的单个列（唯一键）或列集（复合唯一键）中具有重复值。">独特的约束</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d31842e1621" headers="d31842e1564 ">
                                 <p>首要的关键</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1621 d31842e1566 ">
                                 <p>组合<code class="codeph">NOT NULL</code>约束和唯一约束。它禁止多行在同一列或列组合中具有相同的值，并禁止值为空。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1621 d31842e1568 ">
                                 <p><span class="q">“ <a href="data-integrity.html#GUID-E1033BB9-0F67-4E59-82AC-B8B572FD82BB" title="在主键约束中，受约束约束的一个或多个列的组中的值唯一地标识该行。每个表都可以有一个主键，实际上命名行并确保不存在重复行。">主键约束</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d31842e1645" headers="d31842e1564 ">
                                 <p>外键</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1645 d31842e1566 ">
                                 <p>将列指定为外键，并在外键和主键或唯一键之间建立关系，称为<a href="glossary.html#GUID-B1E1A035-9C29-43EB-84AA-0A9CD4482530"><span class="xrefglossterm">引用键</span></a> 。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1645 d31842e1568 ">
                                 <p><span class="q">“ <a href="data-integrity.html#GUID-7CD73D16-EA1A-4AA8-AA7D-4288557395B8" title="只要两个表包含一个或多个公共列，Oracle数据库就可以通过外键约束（也称为引用完整性约束）强制实现两个表之间的关系。">外键约束</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d31842e1669" headers="d31842e1564 ">
                                 <p>校验</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1669 d31842e1566 ">
                                 <p>需要数据库值以遵守指定的条件。</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1669 d31842e1568 ">
                                 <p><span class="q">“ <a href="data-integrity.html#GUID-5AF9C206-0139-4506-96DE-F6AD1D41CD41" title="对列或列集的检查约束要求每行的指定条件为true或未知。">检查约束</a> ”</span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d31842e1690" headers="d31842e1564 ">
                                 <p><code class="codeph">REF</code></p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1690 d31842e1566 ">
                                 <p>指示<code class="codeph">REF</code>列中值允许的数据操作类型以及这些操作如何影响相关值。在对象关系数据库中，称为<code class="codeph">REF</code>的内置数据类型封装了对指定对象类型的行对象的引用。在参照完整性约束<code class="codeph">REF</code>列确保有针对行对象<code class="codeph">REF</code> 。</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d31842e1690 d31842e1568 ">
                                 <p><a href="../adobj/design-considerations-for-REFs.html#ADOBJ00805" target="_blank"><span><cite>Oracle数据库对象关系开发人员指南</cite></span></a> ，了解<code class="codeph">REF</code>约束</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="infoboxnotealso" id="GUID-1C9665AD-A444-4AFB-984F-6385FCBEA64E__GUID-E0B96DBC-119F-469C-BE1E-D64959821440">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="q">“ <a href="tables-and-table-clusters.html#GUID-F845B1A7-71E3-4312-B66D-BC16C198ECE5" title="表是Oracle数据库中数据组织的基本单元。">表格概述</a> ”</span></p>
                        </li>
                        <li>
                           <p><a href="../sqlrf/constraint.html#SQLRF52180" target="_blank"><span><cite>Oracle数据库SQL语言参考，</cite></span></a>以了解有关约束类型的更多信息</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="CNCPT1641"></a><div class="props_rev_3"><a id="GUID-CF2E06A6-6A35-46CE-808E-305A459457CC" name="GUID-CF2E06A6-6A35-46CE-808E-305A459457CC"></a><h4 id="CNCPT-GUID-CF2E06A6-6A35-46CE-808E-305A459457CC" class="sect4">NOT NULL完整性约束</h4>
                  <div>
                     <p><code class="codeph">NOT NULL</code>约束要求表的列不包含空值。<strong class="term">null</strong>表示没有值。默认情况下，表中的所有列都允许空值。
                     </p>
                     <p><code class="codeph">NOT NULL</code>约束适用于不能缺少值的列。例如， <code class="codeph">hr.employees</code>表需要<code class="codeph">email</code>列中的值。尝试插入没有电子邮件地址的员工行会产生错误：</p><pre class="pre codeblock"><code>SQL&gt; INSERT INTO hr.employees（employee_id，last_name）值（999，'Smith'）; 。。。第1行的错误：ORA-01400：无法插入NULL（“HR”。“EMPLOYEES”。“EMAIL”）</code></pre><p>如果表不包含任何行或者您指定了默认值，则只能添加具有<code class="codeph">NOT NULL</code>约束的列。
                     </p>
                     <div class="infoboxnotealso" id="GUID-CF2E06A6-6A35-46CE-808E-305A459457CC__GUID-D27843C7-6BD5-4F3F-BEDF-88D1B9D0AD79">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../tdddg/creating-managing-schema-objects.html#TDDDG32220" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a> ，了解向表中添加<code class="codeph">NOT NULL</code>约束的示例</p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/constraint.html#SQLRF30038" target="_blank"><span><cite>Oracle数据库SQL语言参考，</cite></span></a>用于限制使用<code class="codeph">NOT NULL</code>约束</p>
                           </li>
                           <li>
                              <p><a href="../adfns/data-integrity.html#ADFNS265" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a> ，了解何时使用<code class="codeph">NOT NULL</code>约束</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CNCPT88885"></a><a id="CNCPT1642"></a><div class="props_rev_3"><a id="GUID-077C26A1-49C3-4E72-AE1D-7CEDD997917A" name="GUID-077C26A1-49C3-4E72-AE1D-7CEDD997917A"></a><h4 id="CNCPT-GUID-077C26A1-49C3-4E72-AE1D-7CEDD997917A" class="sect4">独特的约束</h4>
                  <div>
                     <p><span class="bold">唯一键约束</span>要求列或列集中的每个值都是唯一的。表的任何行都不会在具有唯一键约束的单个列（ <span class="bold">唯一键</span> ）或列集（ <span class="bold">复合唯一键</span> ）中具有重复值。
                     </p>
                     <div class="infoboxnote" id="GUID-077C26A1-49C3-4E72-AE1D-7CEDD997917A__GUID-82F8DFCF-4E8D-4E6B-8DE7-7809977FAB3A">
                        <p class="notep1">注意：</p>
                        <p>术语<span class="italic">key</span>仅指完整性约束中定义的列。由于数据库通过隐式创建或重用键列上的<a href="glossary.html#GUID-3CDC5A7E-10A5-4F63-9ED3-49A74D001CA5"><span class="xrefglossterm">索引</span></a>来强制执行唯一约束，因此术语<span class="italic">唯一键</span>有时会错误地用作<span class="italic">唯一键约束</span>或<span class="italic">唯一索引</span>的同义词。
                        </p>
                     </div>
                     <p>唯一键约束适用于不允许重复值的任何列。唯一约束与主键约束不同，主键约束的目的是唯一地标识每个表行，并且通常包含除了唯一之外没有任何意义的值。唯一键的示例包括：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>客户电话号码，主键是客户号码</p>
                        </li>
                        <li>
                           <p>部门名称，主键是部门编号</p>
                        </li>
                     </ul>
                     <p>如<a href="tables-and-table-clusters.html#GUID-B0DFC5A7-E482-4E17-A6F5-FF476A92DC73__CBBEHJCH">例2-1</a>所示， <code class="codeph">hr.employees</code>表的<code class="codeph">email</code>列中存在唯一键约束。声明的相关部分如下：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE员工（......，电子邮件VARCHAR2（25）CONSTRAINT emp_email_nn NOT NULL ...，CONSTRAINT emp_email_uk UNIQUE（电子邮件）......）;</pre><p><code class="codeph">emp_email_uk</code>约束确保没有两个员工具有相同的电子邮件地址，如以下示例所示：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT employee_id，last_name，email FROM employees WHERE email ='PFAY'; EMPLOYEE_ID LAST_NAME电子邮件----------- ------------------------- ----------- -------------- 202 Fay PFAY SQL&gt; INSERT INTO员工（employee_id，last_name，email，hire_date，job_id）1 VALUES（999，'Fay'，'PFAY'，SYSDATE，'ST_CLERK “）; 。。。第1行的错误：ORA-00001：违反了唯一约束（HR.EMP_EMAIL_UK）</pre><p>除非还定义了<code class="codeph">NOT NULL</code>约束，否则null始终满足唯一键约束。因此，具有唯一键约束和<code class="codeph">NOT NULL</code>约束的列是典型的。此组合强制用户在唯一键中输入值，并消除新行数据与现有行数据冲突的可能性。
                     </p>
                     <div class="infoboxnote" id="GUID-077C26A1-49C3-4E72-AE1D-7CEDD997917A__GUID-007A291C-6A61-4701-BF8E-DB9C6B6EEC1D">
                        <p class="notep1">注意：</p>
                        <p>由于多列上唯一键约束的搜索机制，因此在部分空复合唯一键约束的非空列中不能具有相同的值。</p>
                     </div>
                     <div class="example" id="GUID-077C26A1-49C3-4E72-AE1D-7CEDD997917A__CHDJJAJA">
                        <p class="titleinexample">例5-1唯一约束</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT employee_id，last_name，email FROM employees WHERE email ='PFAY'; EMPLOYEE_ID LAST_NAME电子邮件----------- ------------------------- ----------- -------------- 202 Fay PFAY SQL&gt; INSERT INTO员工（employee_id，last_name，email，hire_date，job_id）1 VALUES（999，'Fay'，'PFAY'，SYSDATE，'ST_CLERK “）; 。。。第1行的错误：ORA-00001：违反了唯一约束（HR.EMP_EMAIL_UK）</pre><div class="infoboxnotealso" id="GUID-077C26A1-49C3-4E72-AE1D-7CEDD997917A__GUID-C28D471F-0F36-4116-9DE9-6E04C5381ED2">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="indexes-and-index-organized-tables.html#GUID-F6EFE752-18FA-4BCE-BDE0-F2C386361187" title="索引可以是唯一的也可以是非唯一的。唯一索引保证表中没有两行在键列中具有重复值。">独特和非独特的索引</a> ”</span></p>
                              </li>
                              <li>
                                 <p><a href="../tdddg/creating-managing-schema-objects.html#TDDDG192" target="_blank"><span class="italic">Oracle数据库2天开发人员指南</span></a> ，了解向表中添加<code class="codeph">UNIQUE</code>约束的示例</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="CNCPT1646"></a><div class="props_rev_3"><a id="GUID-E1033BB9-0F67-4E59-82AC-B8B572FD82BB" name="GUID-E1033BB9-0F67-4E59-82AC-B8B572FD82BB"></a><h4 id="CNCPT-GUID-E1033BB9-0F67-4E59-82AC-B8B572FD82BB" class="sect4">主键约束</h4>
                  <div>
                     <p>在<span class="bold">主键约束中</span> ，受<span class="bold">约束约束</span>的一个或多个列的组中的值唯一地标识该行。每个表都可以有一个<span class="bold">主键</span> ，实际上命名行并确保不存在重复行。
                     </p>
                     <p>主键可以是自然的或代理的。<a href="glossary.html#GUID-C697AA5E-12D3-40DC-A5D2-BC7DFDF3E945"><span class="xrefglossterm">自然键</span></a>是由表中的现有属性组成的有意义的标识符。例如，自然键可以是查找表中的邮政编码。相反， <a href="glossary.html#GUID-615CBF3E-BEBE-40A1-AE81-5B2F3275ABF3"><span class="xrefglossterm">代理键</span></a>是系统生成的递增标识符，用于确保表中的唯一性。通常， <a href="glossary.html#GUID-E55254A3-D483-4311-8637-1FFEB6BD25BF"><span class="xrefglossterm">序列</span></a>生成代理键。
                     </p>
                     <p>主键约束的Oracle数据库实现保证以下语句为真：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>没有两行在指定列或列集中具有重复值。</p>
                        </li>
                        <li>
                           <p>主键列不允许空值。</p>
                        </li>
                     </ul>
                     <p>调用主键的典型情况是员工的数字标识符。每位员工都必须拥有唯一的ID。员工必须由<code class="codeph">employees</code>表中的一行且仅一行描述。
                     </p>
                     <p><a href="data-integrity.html#GUID-077C26A1-49C3-4E72-AE1D-7CEDD997917A" title="唯一键约束要求列或列集中的每个值都是唯一的。表的任何行都不会在具有唯一键约束的单个列（唯一键）或列集（复合唯一键）中具有重复值。">唯一约束中</a>的示例表示现有员工的员工ID为202，其中员工ID是主键。以下示例显示尝试添加具有相同员工ID的员工和没有ID的员工：</p><pre class="pre codeblock"><code>SQL&gt; INSERT INTO employees（employee_id，last_name，email，hire_date，job_id）1 VALUES（202，'Chan'，'JCHAN'，SYSDATE，'ST_CLERK'）; 。。。第1行的错误：ORA-00001：违反SQL&gt; INSERT INTO employees（last_name）VALUES（'Chan'）的唯一约束（HR.EMP_EMP_ID_PK）; 。。。第1行的错误：ORA-01400：无法插入NULL（“HR”。“EMPLOYEES”。“EMPLOYEE_ID”）</code></pre><p>数据库使用<a href="glossary.html#GUID-3CDC5A7E-10A5-4F63-9ED3-49A74D001CA5"><span class="xrefglossterm">索引</span></a>强制执行主键约束。通常，为列创建的主键约束会隐式创建唯一索引和<code class="codeph">NOT NULL</code>约束。请注意此规则的以下例外情况：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>在某些情况下，与使用<a href="glossary.html#GUID-19E5560E-9730-4A50-9C26-4E95C4AD81AE"><span class="xrefglossterm">可延迟约束</span></a>创建主键时一样，生成的索引不是唯一的。
                           </p>
                           <div class="infoboxnote" id="GUID-E1033BB9-0F67-4E59-82AC-B8B572FD82BB__GUID-50F5F6AA-7332-46B9-ABAC-9DD5174EB994">
                              <p class="notep1">注意：</p>
                              <p>您可以使用<code class="codeph">CREATE UNIQUE INDEX</code>语句显式创建唯一索引。
                              </p>
                           </div>
                        </li>
                        <li>
                           <p>如果在创建主键约束时存在可用索引，则约束将重用此索引，并且不会隐式创建索引。</p>
                        </li>
                     </ul>
                     <p>默认情况下，隐式创建的索引的名称是主键约束的名称。您还可以为索引指定用户定义的名称。您可以通过在用于创建约束的<code class="codeph">CREATE TABLE</code>或<code class="codeph">ALTER TABLE</code>语句中包含<code class="codeph">ENABLE</code>子句来为索引指定存储选项。
                     </p>
                     <div class="infoboxnotealso" id="GUID-E1033BB9-0F67-4E59-82AC-B8B572FD82BB__GUID-C0584FA5-D66D-4E1F-A18E-CAB21E418F0F">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../tdddg/creating-managing-schema-objects.html#TDDDG193" target="_blank"><span><cite>“Oracle数据库2天开发人员指南”</cite></span></a>和“ <a href="../adfns/data-integrity.html#ADFNS00607" target="_blank"><span><cite>Oracle数据库开发指南”</cite></span></a> ，了解如何向表中添加主键约束</p>
                     </div>
                  </div>
               </div><a id="CNCPT88886"></a><a id="CNCPT88887"></a><a id="CNCPT1649"></a><div class="props_rev_3"><a id="GUID-7CD73D16-EA1A-4AA8-AA7D-4288557395B8" name="GUID-7CD73D16-EA1A-4AA8-AA7D-4288557395B8"></a><h4 id="CNCPT-GUID-7CD73D16-EA1A-4AA8-AA7D-4288557395B8" class="sect4">外键约束</h4>
                  <div>
                     <p>只要两个表包含一个或多个公共列，Oracle数据库就可以通过<span class="bold">外键约束</span> （也称为<span class="italic">引用完整性约束）</span>强制实现两个表之间的关系。
                     </p>
                     <p>外键约束要求对于定义约束的列中的每个值，另一个指定的其他表和列中的值必须匹配。参照完整性规则的一个示例是员工只能在现有部门工作。</p>
                     <p>下表列出了与参照完整性约束相关的术语。</p>
                     <div class="tblformal" id="GUID-7CD73D16-EA1A-4AA8-AA7D-4288557395B8__BABHECEH">
                        <p class="titleintable">表5-2参照完整性约束条款</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="参照完整性约束条款" border="1" summary="This table lists terms associated with referential integrity constraints." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d31842e3196">术语</th>
                                 <th align="left" valign="bottom" id="d31842e3199">定义</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d31842e3204" headers="d31842e3196 ">
                                    <p>外键</p>
                                 </td>
                                 <td align="left" valign="top" headers="d31842e3204 d31842e3199 ">
                                    <p>引用引用键的约束定义中包含的列或列集。例如， <code class="codeph">department_id</code>列<code class="codeph">employees</code>是一个外键引用<code class="codeph">department_id</code>列<code class="codeph">departments</code> 。
                                    </p>
                                    <p>外键可以定义为多个列。但是，复合外键必须引用具有相同列数和相同数据类型的复合主键或唯一键。</p>
                                    <p>外键的值可以与引用的主键或唯一键值匹配，也可以为null。如果复合外键的任何列为空，则键的非空部分不必匹配父键的任何相应部分。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d31842e3227" headers="d31842e3196 ">
                                    <p>参考密钥</p>
                                 </td>
                                 <td align="left" valign="top" headers="d31842e3227 d31842e3199 ">
                                    <p>外键引用的表的唯一键或主键。例如， <code class="codeph">department_id</code>列<code class="codeph">departments</code>对于所引用的关键<code class="codeph">department_id</code>列<code class="codeph">employees</code> 。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d31842e3246" headers="d31842e3196 ">
                                    <p>依赖或子表</p>
                                 </td>
                                 <td align="left" valign="top" headers="d31842e3246 d31842e3199 ">
                                    <p>包含外键的表。此表取决于引用的唯一键或主键中存在的值。例如， <code class="codeph">employees</code>表是<code class="codeph">departments</code>的子项。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d31842e3259" headers="d31842e3196 ">
                                    <p>引用或父表</p>
                                 </td>
                                 <td align="left" valign="top" headers="d31842e3259 d31842e3199 ">
                                    <p>子表的外键引用的表。此表的引用键确定子表中是否允许特定插入或更新。例如， <code class="codeph">departments</code>表是<code class="codeph">employees</code>的父级。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p><a href="data-integrity.html#GUID-7CD73D16-EA1A-4AA8-AA7D-4288557395B8__I3773">图5-1</a>显示了<code class="codeph">employees.department_id</code>列上的外键。它保证此列中的每个值都必须与<code class="codeph">departments.department_id</code>列中的值匹配。因此， <code class="codeph">employees.department_id</code>列中不存在错误的部门编号。
                     </p>
                     <div class="figure" id="GUID-7CD73D16-EA1A-4AA8-AA7D-4288557395B8__I3773">
                        <p class="titleinfigure">图5-1参照完整性约束</p><img src="img/cncpt056.gif" alt="下面是图5-1的描述" title="下面是图5-1的描述" longdesc="img_text/cncpt056.html"><br><a href="img_text/cncpt056.html">“图5-1参照完整性约束”的描述</a></div>
                     <!-- class="figure" -->
                     <div class="infoboxnotealso" id="GUID-7CD73D16-EA1A-4AA8-AA7D-4288557395B8__GUID-ACB57F63-6FC8-4978-B5FA-AE0E2EC14470">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../tdddg/creating-managing-schema-objects.html#TDDDG195" target="_blank"><span><cite>Oracle数据库2天开发人员指南</cite></span></a>和<a href="../adfns/data-integrity.html#ADFNS00611" target="_blank"><span><cite>Oracle数据库开发指南</cite></span></a> ，了解如何向表中添加外键约束</p>
                     </div>
                  </div><a id="CNCPT88888"></a><a id="CNCPT1650"></a><div class="props_rev_3"><a id="GUID-EF16D0D5-EB95-440A-9FFA-E890DFBB7C64" name="GUID-EF16D0D5-EB95-440A-9FFA-E890DFBB7C64"></a><h5 id="CNCPT-GUID-EF16D0D5-EB95-440A-9FFA-E890DFBB7C64" class="sect5">自我参照完整性约束</h5>
                     <div>
                        <p><span class="bold">自引用完整性约束</span>是引用同一表中的父键的外键。
                        </p>
                        <p>在下面的图中，自参照约束确保了每一个值<code class="codeph">employees.manager_id</code>列对应于在现有值<code class="codeph">employees.employee_id</code>柱。例如，员工102的经理必须存在于<code class="codeph">employees</code>表中。此约束消除了<code class="codeph">manager_id</code>列中错误员工编号的可能性。
                        </p>
                        <div class="figure" id="GUID-EF16D0D5-EB95-440A-9FFA-E890DFBB7C64__I3776">
                           <p class="titleinfigure">图5-2单表参照约束</p><img src="img/cncpt057.gif" alt="下面是图5-2的描述" title="下面是图5-2的描述" longdesc="img_text/cncpt057.html"><br><a href="img_text/cncpt057.html">“图5-2单表参考约束”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                  </div><a id="CNCPT33335"></a><div class="props_rev_3"><a id="GUID-147E2168-6739-481F-9703-3DC95D93B611" name="GUID-147E2168-6739-481F-9703-3DC95D93B611"></a><h5 id="CNCPT-GUID-147E2168-6739-481F-9703-3DC95D93B611" class="sect5">空和外键</h5>
                     <div>
                        <p>关系模型允许外键的值匹配引用的主键或唯一键值，或者为null。例如， <code class="codeph">hr.employees</code>的一行可能未指定部门ID。</p>
                        <p>如果复合外键的任何列为空，则键的非空部分不必匹配父键的任何相应部分。例如， <code class="codeph">reservations</code>表可能在<code class="codeph">table_id</code>和<code class="codeph">date</code>列上包含复合外键，但<code class="codeph">table_id</code>为null。
                        </p>
                     </div>
                  </div><a id="CNCPT88889"></a><a id="CNCPT33336"></a><div class="props_rev_3"><a id="GUID-FB419C3E-7C1E-4881-B77D-D09A57C741A6" name="GUID-FB419C3E-7C1E-4881-B77D-D09A57C741A6"></a><h5 id="CNCPT-GUID-FB419C3E-7C1E-4881-B77D-D09A57C741A6" class="sect5">父密钥修改和外键</h5>
                     <div>
                        <p>外键和父键之间的关系对删除父键有影响。例如，如果用户尝试删除该部门的记录，那么该部门员工的记录会发生什么变化？</p>
                        <p>修改父键时，参照完整性约束可以指定对子表中的从属行执行以下操作：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>删除或更新时无任何操作</p>
                              <p>在正常情况下，如果结果违反参照完整性，则用户无法修改引用的键值。例如，如果<code class="codeph">employees.department_id</code>是<code class="codeph">departments</code>的外键，并且员工属于特定部门，则尝试删除该部门的行会违反约束。
                              </p>
                           </li>
                           <li>
                              <p>级联删除</p>
                              <p>删除包含引用键值的行时删除级联（ <code class="codeph">DELETE CASCADE</code> ），从而导致子表中具有相关外键值的所有行也将被删除。例如，删除<code class="codeph">departments</code>中的行会导致删除此部门中所有员工的行。
                              </p>
                           </li>
                           <li>
                              <p>删除设置为null</p>
                              <p>删除包含引用键值的行时，删除设置为null（ <code class="codeph">DELETE SET NULL</code> ），从而导致具有从属外键值的子表中的所有行将这些值设置为null。例如，删除部门行会将<code class="codeph">department_id</code>列值设置为null，以用于此部门中的员工。
                              </p>
                           </li>
                        </ul>
                        <p><a href="data-integrity.html#GUID-FB419C3E-7C1E-4881-B77D-D09A57C741A6__G14265" title="此表显示不同参照操作对父表中的键值以及子表中的外键值所允许的DML语句。">表5-3</a>概述了对父表中键值的不同引用操作所允许的DML语句，以及子表中的外键值。
                        </p>
                        <div class="tblformal" id="GUID-FB419C3E-7C1E-4881-B77D-D09A57C741A6__G14265">
                           <p class="titleintable">表5-3更新允许的DML语句和删除无操作</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="更新允许的DML语句和删除无操作" width="100%" border="1" summary="This table shows the DML Statements  allowed by the different referential actions on the key values in the parent table, and the foreign key values in the child table. " frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="26%" id="d31842e4233">DML声明</th>
                                    <th align="left" valign="bottom" width="37%" id="d31842e4236">针对父表发布</th>
                                    <th align="left" valign="bottom" width="37%" id="d31842e4239">发布儿童表</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d31842e4244" headers="d31842e4233 ">
                                       <p><code class="codeph">插入</code></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d31842e4244 d31842e4236 ">
                                       <p>如果父键值是唯一的，则始终正常</p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d31842e4244 d31842e4239 ">
                                       <p>仅当外键值存在于父键中或者部分或全部为空时才可以</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d31842e4255" headers="d31842e4233 ">
                                       <p><code class="codeph">UPDATE NO</code> <code class="codeph">ACTION</code></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d31842e4255 d31842e4236 ">
                                       <p>如果语句未在子表中留下任何行而没有引用的父键值，则允许</p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d31842e4255 d31842e4239 ">
                                       <p>如果新的外键值仍引用引用的键值，则允许</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d31842e4269" headers="d31842e4233 ">
                                       <p><code class="codeph">DELETE NO</code> <code class="codeph">ACTION</code></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d31842e4269 d31842e4236 ">
                                       <p>如果子表中没有行引用父键值，则允许</p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d31842e4269 d31842e4239 ">
                                       <p>总是好的</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d31842e4283" headers="d31842e4233 ">
                                       <p><code class="codeph">删除CASCADE</code></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d31842e4283 d31842e4236 ">
                                       <p>总是好的</p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d31842e4283 d31842e4239 ">
                                       <p>总是好的</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="26%" id="d31842e4294" headers="d31842e4233 ">
                                       <p><code class="codeph">DELETE SET</code> <code class="codeph">NULL</code></p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d31842e4294 d31842e4236 ">
                                       <p>总是好的</p>
                                    </td>
                                    <td align="left" valign="top" width="37%" headers="d31842e4294 d31842e4239 ">
                                       <p>总是好的</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="infoboxnote" id="GUID-FB419C3E-7C1E-4881-B77D-D09A57C741A6__GUID-E26077A0-8038-4595-AE42-A371EBB2B81E">
                           <p class="notep1">注意：</p>
                           <p>可以使用数据库触发器强制执行Oracle数据库的<code class="codeph">FOREIGN KEY</code>完整性约束不支持的其他引用操作。请参阅<span class="q">“ <a href="server-side-programming.html#GUID-40297ADF-0968-42F8-B8B9-84AD6ADCBE63" title="数据库触发器是一个编译的存储程序单元，用PL / SQL或Java编写，Oracle数据库调用（" fire=")=" ="">触发器概述</a> ”</span> 。
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-FB419C3E-7C1E-4881-B77D-D09A57C741A6__GUID-97A95BE1-E246-4E76-98C0-70CBAF8300E9">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../sqlrf/constraint.html#SQLRF52202" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a> ，了解<code class="codeph">ON DELETE</code>子句</p>
                        </div>
                     </div>
                  </div><a id="CNCPT1657"></a><div class="props_rev_3"><a id="GUID-8D485547-5304-4FE7-A1B3-8A4009484A6A" name="GUID-8D485547-5304-4FE7-A1B3-8A4009484A6A"></a><h5 id="CNCPT-GUID-8D485547-5304-4FE7-A1B3-8A4009484A6A" class="sect5">索引和外键</h5>
                     <div>
                        <p>通常，应将外键编入索引。唯一的例外是永远不会更新或删除匹配的唯一键或主键。</p>
                        <p>索引子表中的外键具有以下优点：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>防止子表上的完整表锁定。而是，数据库获取索引上的行锁。</p>
                           </li>
                           <li>
                              <p>无需对子表进行<a href="glossary.html#GUID-BF9B54D6-892E-4C3B-8536-38958ACC069D"><span class="xrefglossterm">全表扫描</span></a> 。作为说明，假设用户从<code class="codeph">departments</code>表中删除了部门10的记录。如果未对<code class="codeph">employees.department_id</code>编制索引，则数据库必须扫描<code class="codeph">employees</code>以查看部门10中是否存在任何员工。
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-8D485547-5304-4FE7-A1B3-8A4009484A6A__GUID-35C81A3C-5431-40E9-84CA-ECD23109E318">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="q">“ <a href="data-concurrency-and-consistency.html#GUID-261F98F8-F7B4-49A9-9BE8-11F2B1F4609B" title="Oracle数据库最大化了与依赖外键相关的父键的并发控制。">锁和外键</a> ”</span>解释了索引和未索引的外键列的锁定行为</p>
                              </li>
                              <li>
                                 <p><span class="q">“ <a href="indexes-and-index-organized-tables.html#GUID-DE7A95BC-6E4A-47EA-9FC5-B85B54F8CF41" title="An index is an optional structure, associated with a table or table cluster, that can sometimes speed data access.">索引简介</a> ”</span>解释了<span class="q"><a href="indexes-and-index-organized-tables.html#GUID-DE7A95BC-6E4A-47EA-9FC5-B85B54F8CF41" title="索引是与表或表集群相关联的可选结构，有时可以加速数据访问。">索引</a></span>的目的和特征</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT1660"></a><div class="props_rev_3"><a id="GUID-5AF9C206-0139-4506-96DE-F6AD1D41CD41" name="GUID-5AF9C206-0139-4506-96DE-F6AD1D41CD41"></a><h4 id="CNCPT-GUID-5AF9C206-0139-4506-96DE-F6AD1D41CD41" class="sect4">检查约束</h4>
                  <div>
                     <p>对列或列集的<strong class="term">检查约束</strong>要求每行的指定<strong class="term">条件</strong>为true或未知。
                     </p>
                     <p>如果DML导致约束的条件评估为false，则回滚SQL语句。检查约束的主要好处是能够执行非常具体的完整性规则。例如，您可以使用检查约束在<code class="codeph">hr.employees</code>表中强制执行以下规则：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">salary</code>列的值不得大于10000。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">commission</code>列的值必须不大于工资。
                           </p>
                        </li>
                     </ul>
                     <p>以下示例为<code class="codeph">employees</code>创建最大工资约束，并演示当语句尝试插入包含超过最大值的工资的行时会发生什么：</p><pre class="pre codeblock"><code>SQL&gt; ALTER TABLE employees ADD CONSTRAINT max_emp_sal CHECK（salary &lt;10001）; SQL&gt; INSERT INTO employees（employee_id，last_name，email，hire_date，job_id，salary）1 VALUES（999，'Green'，'BGREEN'，SYSDATE，'ST_CLERK'，20000）; 。。。第1行的错误：ORA-02290：违反了检查约束（HR.MAX_EMP_SAL）</code></pre><p>单个列可以具有多个检查约束，这些约束在其定义中引用该列。例如， <code class="codeph">salary</code>列可以有一个约束来阻止超过10000的值和一个单独的约束来阻止小于500的值。
                     </p>
                     <p>如果列存在多个检查约束，则必须对它们进行设计，以使其目的不会发生冲突。不能假设评估条件的顺序。数据库不验证检查条件不相互排斥。</p>
                     <div class="infoboxnotealso" id="GUID-5AF9C206-0139-4506-96DE-F6AD1D41CD41__GUID-EFEF075C-5872-494B-B888-C66C63915053">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../sqlrf/constraint.html#SQLRF52204" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> ，了解检查约束的限制</p>
                     </div>
                  </div>
               </div>
            </div><a id="CNCPT33337"></a><div class="props_rev_3"><a id="GUID-97D4BB23-FD4B-4FB6-BE21-E5F8C43BD94F" name="GUID-97D4BB23-FD4B-4FB6-BE21-E5F8C43BD94F"></a><h3 id="CNCPT-GUID-97D4BB23-FD4B-4FB6-BE21-E5F8C43BD94F" class="sect3">完整性约束条件</h3>
               <div>
                  <p>作为约束定义的一部分，您可以指定Oracle数据库应如何以及何时强制执行约束，从而确定约束状态。</p>
               </div><a id="CNCPT88890"></a><a id="CNCPT33339"></a><div class="props_rev_3"><a id="GUID-F9E519B3-6DE9-47EC-9B6B-527E2D78349E" name="GUID-F9E519B3-6DE9-47EC-9B6B-527E2D78349E"></a><h4 id="CNCPT-GUID-F9E519B3-6DE9-47EC-9B6B-527E2D78349E" class="sect4">检查已修改和现有数据</h4>
                  <div>
                     <p>通过该数据库，您可以指定约束是应用于现有数据还是未来数据。如果启用了约束，则数据库会在输入或更新新数据时对其进行检查。不符合约束的数据无法进入数据库。</p>
                     <p>例如，在<code class="codeph">employees.department_id</code>上启用<code class="codeph">NOT NULL</code>约束可确保每个将来的行都具有部门ID。如果禁用约束，则表可以包含违反约束的行。
                     </p>
                     <p>您可以将约束设置为以下任一验证模式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">VALIDATE</code></p>
                           <p>现有数据必须符合约束条件。例如，在<code class="codeph">employees.department_id</code>上启用<code class="codeph">NOT NULL</code>约束并将其设置为<code class="codeph">VALIDATE</code>检查每个现有行是否具有部门ID。</p>
                        </li>
                        <li>
                           <p><code class="codeph">NOVALIDATE</code></p>
                           <p>现有数据不必符合约束条件。实际上，这是一种“信任我”模式。例如，如果您确定加载到表中的每个销售都有一个日期，那么您可以在日期列上创建一个<code class="codeph">NOT NULL</code>约束并将约束设置为<code class="codeph">NOVALIDATE</code> 。非强制约束通常仅对物化视图和查询重写有用。
                           </p>
                           <p>对于<code class="codeph">NOVALIDATE</code>模式中的约束， <code class="codeph">RELY</code>参数指示优化器可以使用约束来确定连接信息。即使约束不用于验证数据，它也可以为物化视图实现更复杂的查询重写，并使数据仓库工具能够从数据字典中检索约束信息。默认值为<code class="codeph">NORELY</code> ，这意味着优化器实际上不知道约束。
                           </p>
                        </li>
                     </ul>
                     <p><code class="codeph">VALIDATE</code>和<code class="codeph">NOVALIDATE</code>的行为始终取决于是启用还是禁用约束。下表总结了这些关系。
                     </p>
                     <div class="tblformal" id="GUID-F9E519B3-6DE9-47EC-9B6B-527E2D78349E__CHDEAFJA">
                        <p class="titleintable">表5-4对已修改数据和现有数据的检查</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="检查修改的和现有的数据" width="100%" border="1" summary="This table summarized the checks on modified and existing data." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d31842e5607">修改数据</th>
                                 <th align="left" valign="bottom" width="20%" id="d31842e5610">现有数据</th>
                                 <th align="left" valign="bottom" width="60%" id="d31842e5613">摘要</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d31842e5618" headers="d31842e5607 ">
                                    <p><code class="codeph">ENABLE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d31842e5618 d31842e5610 ">
                                    <p><code class="codeph">VALIDATE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d31842e5618 d31842e5613 ">
                                    <p>现有和未来的数据必须遵守约束条件。如果现有行违反约束，则尝试将新约束应用于填充表会导致错误。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d31842e5630" headers="d31842e5607 ">
                                    <p><code class="codeph">ENABLE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d31842e5630 d31842e5610 ">
                                    <p><code class="codeph">NOVALIDATE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d31842e5630 d31842e5613 ">
                                    <p>数据库检查约束，但不必对所有行都为true。因此，现有行可能违反约束，但新行或已修改的行必须符合规则。此模式通常用于包含已验证其完整性的现有数据的数据仓库中。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d31842e5642" headers="d31842e5607 ">
                                    <p><code class="codeph">DISABLE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d31842e5642 d31842e5610 ">
                                    <p><code class="codeph">VALIDATE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d31842e5642 d31842e5613 ">
                                    <p>数据库禁用约束，删除其索引，并阻止修改受约束的列。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d31842e5654" headers="d31842e5607 ">
                                    <p><code class="codeph">DISABLE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d31842e5654 d31842e5610 ">
                                    <p><code class="codeph">NOVALIDATE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="60%" headers="d31842e5654 d31842e5613 ">
                                    <p>不检查约束，并且不一定是真的。</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="infoboxnotealso" id="GUID-F9E519B3-6DE9-47EC-9B6B-527E2D78349E__GUID-AD053996-8713-455A-8D5B-DEC99CA1D305">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../sqlrf/constraint.html#SQLRF52214" target="_blank"><span class="italic">Oracle数据库SQL语言参考</span></a> ，了解约束状态</p>
                     </div>
                  </div>
               </div><a id="CNCPT522"></a><div class="props_rev_3"><a id="GUID-ED1E9D21-EDFB-4AAD-9193-87D576F67761" name="GUID-ED1E9D21-EDFB-4AAD-9193-87D576F67761"></a><h4 id="CNCPT-GUID-ED1E9D21-EDFB-4AAD-9193-87D576F67761" class="sect4">当数据库检查有效性的约束时</h4>
                  <div>
                     <p>每个约束都处于不可延迟（默认）或可延迟状态。此状态确定Oracle数据库何时检查约束的有效性。</p>
                     <p>下图显示了可延迟约束的选项。</p>
                     <div class="figure" id="GUID-ED1E9D21-EDFB-4AAD-9193-87D576F67761__GUID-93E99346-78E4-48C1-8B3A-74CC84B0B63E">
                        <p class="titleinfigure">图5-3可延迟约束的选项</p><img src="img/cncpt313.gif" alt="下面是图5-3的描述" title="下面是图5-3的描述" longdesc="img_text/cncpt313.html"><br><a href="img_text/cncpt313.html">“图5-3可延迟约束选项”的说明</a></div>
                     <!-- class="figure" -->
                  </div><a id="CNCPT88891"></a><div class="props_rev_3"><a id="GUID-6E6E9B10-620E-4211-A47E-B587B987BFF9" name="GUID-6E6E9B10-620E-4211-A47E-B587B987BFF9"></a><h5 id="CNCPT-GUID-6E6E9B10-620E-4211-A47E-B587B987BFF9" class="sect5">不可延迟的约束</h5>
                     <div>
                        <p>在不可延迟的<span class="bold">约束中</span> ，Oracle数据库永远不会将<span class="bold">约束</span>的有效性检查推迟到事务结束。相反，数据库会检查每个语句末尾的约束。如果违反约束，则语句回滚。
                        </p>
                        <p>例如， <code class="codeph">employees.last_name</code>列存在<code class="codeph">NOT NULL</code>延迟的<code class="codeph">NOT NULL</code>约束。如果会话尝试插入没有姓氏的行，则数据库会立即回滚该语句，因为违反了<code class="codeph">NOT NULL</code>约束。没有插入行。
                        </p>
                     </div>
                  </div><a id="CNCPT88892"></a><div class="props_rev_3"><a id="GUID-2C8FE035-70C8-454A-BB32-F6361A15DF96" name="GUID-2C8FE035-70C8-454A-BB32-F6361A15DF96"></a><h5 id="CNCPT-GUID-2C8FE035-70C8-454A-BB32-F6361A15DF96" class="sect5">可延迟的约束</h5>
                     <div>
                        <p><span class="bold">可延迟约束</span>允许事务使用<code class="codeph">SET CONSTRAINT</code>子句来推迟检查此约束，直到发出<code class="codeph">COMMIT</code>语句。如果对可能违反约束的数据库进行更改，则此设置可以有效地禁用约束，直到完成所有更改。
                        </p>
                        <p>您可以设置数据库检查可延迟约束时的默认行为。您可以指定以下任一属性：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">初步立即</code></p>
                              <p>数据库在每个语句执行后立即检查约束。如果违反了约束，则数据库将回滚该语句。</p>
                           </li>
                           <li>
                              <p><code class="codeph">初步推迟</code></p>
                              <p>发出<code class="codeph">COMMIT</code>时，数据库会检查约束。如果违反约束，则数据库回滚事务。
                              </p>
                           </li>
                        </ul>
                        <p>假设<code class="codeph">employees.last_name</code>上的可延迟<code class="codeph">NOT NULL</code>约束设置为<code class="codeph">INITIALLY DEFERRED</code> 。用户使用100个<code class="codeph">INSERT</code>语句创建事务，其中一些语句具有<code class="codeph">last_name</code>空值。当用户尝试提交时，数据库将回滚所有100个语句。但是，如果此约束设置为<code class="codeph">INITIALLY IMMEDIATE</code> ，则数据库不会回滚事务。
                        </p>
                        <p>如果约束导致操作，则数据库将此操作视为导致该操作的语句的一部分，无论约束是延迟还是立即。例如，删除<code class="codeph">departments</code>的行会导致删除引用已删除部门行的<code class="codeph">employees</code>中的所有行。在这种情况下，从<code class="codeph">employees</code>删除被视为对<code class="codeph">departments</code>执行的<code class="codeph">DELETE</code>语句的一部分。
                        </p>
                        <div class="infoboxnotealso" id="GUID-2C8FE035-70C8-454A-BB32-F6361A15DF96__GUID-97AEABFA-0331-4A0C-A9F5-56F6E6995154">
                           <p class="notep1">也可以看看：</p>
                           <p>有关约束属性及其默认值的信息，请<a href="../sqlrf/constraint.html#SQLRF52216" target="_blank"><span class="italic">参见Oracle数据库SQL语言参考</span></a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="CNCPT422"></a><div class="props_rev_3"><a id="GUID-7E8D0D6D-E7D8-4329-9C36-67A0A79851A1" name="GUID-7E8D0D6D-E7D8-4329-9C36-67A0A79851A1"></a><h4 id="CNCPT-GUID-7E8D0D6D-E7D8-4329-9C36-67A0A79851A1" class="sect4">约束检查的示例</h4>
                  <div>
                     <p>以下示例有助于说明Oracle数据库何时执行约束检查。</p>
                     <p>假设如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">employees</code>表具有<span class="q">“ <a href="data-integrity.html#GUID-EF16D0D5-EB95-440A-9FFA-E890DFBB7C64" title="自引用完整性约束是引用同一表中的父键的外键。">自引用完整性约束</a> ”中</span>所示的结构。
                           </p>
                        </li>
                        <li>
                           <p>自引用约束使<code class="codeph">manager_id</code>列中的条目依赖于<code class="codeph">employee_id</code>列的值。
                           </p>
                        </li>
                     </ul>
                  </div><a id="CNCPT33341"></a><div class="props_rev_3"><a id="GUID-6A309B2D-42B1-4886-AAAF-DD51760A8103" name="GUID-6A309B2D-42B1-4886-AAAF-DD51760A8103"></a><h5 id="CNCPT-GUID-6A309B2D-42B1-4886-AAAF-DD51760A8103" class="sect5">示例：当没有父键值存在时，在外键列中插入值</h5>
                     <div>
                        <p>此示例涉及将第一行插入<code class="codeph">employees</code>表。当前不存在任何行，那么如果<code class="codeph">manager_id</code>列中的值无法引用<code class="codeph">employee_id</code>列中的现有值，那么如何输入行？
                        </p>
                        <div class="example" id="GUID-6A309B2D-42B1-4886-AAAF-DD51760A8103__GUID-A64C6438-3348-432D-90FB-32C528358D8C">
                           <p>一些可能性是：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>如果<code class="codeph">manager_id</code>列没有在其上定义<code class="codeph">NOT NULL</code>约束，则可以为第一行的<code class="codeph">manager_id</code>列输入null。
                                 </p>
                                 <p>由于外键中允许空值，因此Oracle数据库会将此行插入表中。</p>
                              </li>
                              <li>
                                 <p>您可以在<code class="codeph">employee_id</code>和<code class="codeph">manager_id</code>列中输入相同的值，指定员工是他或她自己的经理。
                                 </p>
                                 <p>此案例表明Oracle Database在语句执行<span class="italic">后</span>执行其约束检查。要允许在父键和外键中使用相同的值输入行，数据库必须首先插入新行，然后确定表中的任何行是否具有与新行的<code class="codeph">manager_id</code>对应的<code class="codeph">employee_id</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>多行<code class="codeph">INSERT</code>语句（例如具有嵌套<code class="codeph">SELECT</code>语句的<code class="codeph">INSERT</code>语句）可以插入彼此引用的行。
                                 </p>
                                 <p>例如，第一行可能有200个用于员工ID，300个用于管理员ID，而第二行有300个用于员工ID，200个用于管理员ID。约束检查将推迟到<code class="codeph">INSERT</code>语句的完整执行。数据库插入所有行，然后检查所有行是否存在约束违规。
                                 </p>
                              </li>
                           </ul>
                           <p>在解析语句之前，默认值作为<code class="codeph">INSERT</code>语句的一部分包含在内。因此，默认列值受所有完整性约束检查的约束。
                           </p>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="CNCPT88893"></a><a id="CNCPT88894"></a><a id="CNCPT33342"></a><div class="props_rev_3"><a id="GUID-8AA33487-F1D7-4EC8-ADC1-04A4EEF7974B" name="GUID-8AA33487-F1D7-4EC8-ADC1-04A4EEF7974B"></a><h5 id="CNCPT-GUID-8AA33487-F1D7-4EC8-ADC1-04A4EEF7974B" class="sect5">示例：更新所有外键和父键值</h5>
                     <div>
                        <p>在此示例中，自引用约束使<code class="codeph">employees</code>的<code class="codeph">manager_id</code>列中的条目依赖于<code class="codeph">employee_id</code>列的值。
                        </p>
                        <div class="example" id="GUID-8AA33487-F1D7-4EC8-ADC1-04A4EEF7974B__GUID-1319D7AE-3357-4B72-B48E-A43C3184D5A1">
                           <p>该公司已被出售。由于此次销售，所有员工编号必须更新为当前值加5000，以便与新公司的员工编号进行协调。如下图所示，一些员工也是经理：</p>
                           <div class="figure" id="GUID-8AA33487-F1D7-4EC8-ADC1-04A4EEF7974B__I3782">
                              <p class="titleinfigure">图5-4更新前员工表</p><img src="img/cncpt058.gif" alt="下面是图5-4的描述" title="下面是图5-4的描述" longdesc="img_text/cncpt058.html"><br><a href="img_text/cncpt058.html">“图5-4更新前员工表”的说明</a></div>
                           <!-- class="figure" -->
                           <p>由于经理人数也是员工编号，经理人数也必须增加5000。您可以执行以下SQL语句来更新值：</p><pre class="pre codeblock"><code>UPDATE员工SET employee_id = employee_id + 5000，manager_id = manager_id + 5000;</code></pre><p>尽管定义了约束来验证每个<code class="codeph">manager_id</code>值是否与<code class="codeph">employee_id</code>值匹配，但前面的语句是有效的，因为数据库在语句完成后有效地检查约束。<a href="data-integrity.html#GUID-8AA33487-F1D7-4EC8-ADC1-04A4EEF7974B__I3784">图5-5</a>显示了数据库在检查约束之前执行整个SQL语句的操作。
                           </p>
                           <div class="figure" id="GUID-8AA33487-F1D7-4EC8-ADC1-04A4EEF7974B__I3784">
                              <p class="titleinfigure">图5-5约束检查</p><img src="img/cncpt059.gif" alt="下面是图5-5的描述" title="下面是图5-5的描述" longdesc="img_text/cncpt059.html"><br><a href="img_text/cncpt059.html">“图5-5约束检查”的描述</a></div>
                           <!-- class="figure" -->
                           <p>本节中的示例说明了<code class="codeph">INSERT</code>和<code class="codeph">UPDATE</code>语句中的约束检查机制，但数据库对所有类型的DML语句使用相同的机制。数据库对所有类型的约束使用相同的机制，而不仅仅是自引用约束。
                           </p>
                           <div class="infoboxnote" id="GUID-8AA33487-F1D7-4EC8-ADC1-04A4EEF7974B__GUID-3F0F4661-F1EC-4DDA-AAEF-657FBD9D1EDC">
                              <p class="notep1">注意：</p>
                              <p><a href="glossary.html#GUID-1274BCF5-2EC1-4752-B9CE-998A85A83307"><span class="xrefglossterm">视图</span></a>或<a href="glossary.html#GUID-FBC00D26-94DC-4BA6-82D0-60A7F29CB81D"><span class="xrefglossterm">同义词</span></a>上的操作受基表上定义的完整性约束的约束。
                              </p>
                           </div>
                        </div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>