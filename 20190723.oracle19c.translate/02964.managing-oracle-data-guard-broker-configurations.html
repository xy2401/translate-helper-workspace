<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="Use Oracle Data Guard broker to manage and monitor the configuration. Oracle Enterprise Manager uses the broker to report health and other operational characteristics."></meta>
      <meta name="description" content="Use Oracle Data Guard broker to manage and monitor the configuration. Oracle Enterprise Manager uses the broker to report health and other operational characteristics."></meta>
      <title>管理代理配置</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Broker "></meta>
      <meta property="og:description" content="Use Oracle Data Guard broker to manage and monitor the configuration. Oracle Enterprise Manager uses the broker to report health and other operational characteristics."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Broker"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="data-guard-broker.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-29T04:14:25-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96245-02"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="oracle-data-guard-broker-installation-requirements.html" title="Previous" type="text/html"></link>
      <link rel="next" href="managing-oracle-data-guard-broker-configuration-members.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Guard Broker"></meta>
    <meta name="dcterms.isVersionOf" content="DGBKR"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-data-guard-broker-installation-requirements.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="managing-oracle-data-guard-broker-configuration-members.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">经纪人</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">管理代理配置</li>
            </ol>
            <a id="GUID-FCCDC53A-C6F4-4AFB-A220-9D6622474027" name="GUID-FCCDC53A-C6F4-4AFB-A220-9D6622474027"></a><a id="DGBKR095"></a>
            
            <h2 id="DGBKR-GUID-FCCDC53A-C6F4-4AFB-A220-9D6622474027" class="sect2"><span class="enumeration_chapter">3</span>管理代理配置</h2>
         </header>
         <div class="ind">
            <div>
               <p>使用Oracle Data Guard代理来管理和监视配置。Oracle Enterprise Manager使用代理报告运行状况和其他操作特征。</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-7E2D5B71-4052-4EC9-AA18-3BB4645B1696" title="Oracle Data Guard代理允许您创建包含多达253个成员的代理配置，包括一个主数据库以及备用数据库，远程同步实例和零数据丢失恢复设备的组合。">配置支持</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-BF708883-519A-428D-A1A1-BDCDCE272D64" title="配置属性控制代理配置的行为。">配置属性</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-E4EE9680-63B7-4483-843B-47E33FC41B20" title="当代理首次启动时，将自动创建配置文件，并使用特定于操作系统的默认路径名和文件名进行命名。">设置代理配置文件</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-BAAE6C51-C29F-4950-A885-EB1289A230B2" title="设置配置文件后，必须将每个数据库的DG_BROKER_START初始化参数设置为TRUE才能启动DMON进程。">启动Data Guard Broker</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE" title="该图显示了代理配置的生命周期，随附的文本说明了该周期的每个阶段。">经纪人配置的管理周期</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-C2D3075F-FEA6-4C38-93F5-36E945D6C931" title="在代理配置中启用或禁用数据库时，您实际上是启用或禁用代理管理和监视指定数据库的功能。">启用和禁用操作</a></p>
                  </li>
                  <li>
                     <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-92632C7B-BFF3-4678-9F4F-CC0B72ED6A35" title="配置状态显示配置的整体运行状况。">配置状态</a></p>
                  </li>
               </ul>
            </div><a id="DGBKR3518"></a><a id="DGBKR100"></a><div class="props_rev_3"><a id="GUID-7E2D5B71-4052-4EC9-AA18-3BB4645B1696" name="GUID-7E2D5B71-4052-4EC9-AA18-3BB4645B1696"></a><h3 id="DGBKR-GUID-7E2D5B71-4052-4EC9-AA18-3BB4645B1696" class="sect3"><span class="enumeration_section">3.1</span>配置支持</h3>
               <div>
                  <p>Oracle Data Guard代理允许您创建包含多达253个成员的代理配置，包括一个主数据库以及备用数据库，远程同步实例和零数据丢失恢复设备的组合。</p>
                  <p>代理控制配置成员，监视配置的运行状况，如果使用Oracle Enterprise Manager云控制，则通过Oracle企业管理通知机制报告运行状况和其他操作特征，如果使用DGMGRL，则通过<code class="codeph">SHOW</code>命令报告。</p>
                  <p>受支持的Oracle Data Guard配置包含以下组件：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>主数据库（Oracle RAC或非Oracle RAC）</p>
                     </li>
                     <li>
                        <p>备用数据库，远程同步实例和从主数据库接收重做的恢复设备的组合。</p>
                     </li>
                     <li>
                        <p>Oracle Net Services网络配置，用于定义数据库之间的连接</p>
                     </li>
                     <li>
                        <p>待机（归档重做日志文件）目标参数和配置属性</p>
                     </li>
                     <li>
                        <p>重做传输服务，将重做数据从主数据库传输到备用数据库和远程同步实例</p>
                     </li>
                     <li>
                        <p>日志应用服务，将重做数据从存档的重做日志文件或备用重做日志文件应用于备用数据库</p>
                     </li>
                  </ul>
                  <p>Oracle Data Guard日志将服务更新备用数据库应用于重做数据，该重做数据由重做传输服务从主数据库自动传输。归档的重做日志文件和备用重做日志文件包含除<span class="italic">不可恢复</span>或未<span class="italic">记录的</span>更改之外的所有数据库更改。
                  </p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在物理备用数据库上，Redo Apply应用重做数据以使备用数据库与主数据库保持一致。</p>
                     </li>
                     <li>
                        <p>在逻辑备用数据库上，SQL Apply应用重做数据以使备用数据库与主数据库保持一致。</p>
                     </li>
                     <li>
                        <p>在快照备用数据库上，接收重做数据，但在将快照备用数据库转换回物理备用数据库之前不会应用。</p>
                     </li>
                     <li>
                        <p>在远程同步实例上，接收重做数据，然后将其转发到物理备用数据库。远程同步实例没有数据文件，也不应用它收到的任何重做数据。</p>
                     </li>
                  </ul>
                  <p>代理的Oracle Data Guard监视器（DMON）进程将代理配置配置为一组对象，您可以将其作为一个单元进行管理和监视。因此，当您输入影响多个数据库的命令时，DMON进程：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在主数据库上执行您的请求</p>
                     </li>
                     <li>
                        <p>根据您的请求，协调每个其他数据库的DMON流程</p>
                     </li>
                     <li>
                        <p>更新本地系统上的配置文件</p>
                     </li>
                     <li>
                        <p>与每个其他数据库的DMON进程通信，以更新其配置文件的副本</p>
                     </li>
                  </ul>
                  <p>通过DMON过程，您可以将数据库和配置作为一个整体进行配置，监视和控制。如果禁用配置，则还会禁用配置中所有数据库的代理管理。如果稍后启用配置，则会为配置中的每个数据库启用代理管理。</p>
                  <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-7E2D5B71-4052-4EC9-AA18-3BB4645B1696__I1016374">图3-1</a>显示了具有主数据库和物理备用数据库的代理配置。
                  </p>
                  <p>在主数据库中，该图显示了除以下主要组件之外的重做传输服务：主数据库，DMON，联机重做日志文件和归档重做日志文件。该图还显示了主要端的大纲形式的备用重做日志文件;概述备用重做日志以指示它们当前处于非活动状态但已配置为准备切换或故障转移到备用角色。物理备用数据库包括以下组件：备用数据库，日志应用服务，DMON，归档重做日志文件和备用重做日志文件。概述物理备用数据库上的联机重做日志文件，以指示它们当前处于非活动状态但已配置为准备切换或故障转移到主要角色。</p>
                  <div class="infoboxnotealso" id="GUID-7E2D5B71-4052-4EC9-AA18-3BB4645B1696__GUID-337C8B0D-FF7C-44EB-B9B1-256571504A47">
                     <p class="notep1">也可以看看：</p>
                     <p>有关备用数据库的详细信息，请参阅<a href="../sbydb/introduction-to-oracle-data-guard-concepts.html#SBYDB4703" target="_blank"><span><cite>Oracle Data Guard概念和管理</cite></span></a></p>
                  </div>
                  <div class="figure" id="GUID-7E2D5B71-4052-4EC9-AA18-3BB4645B1696__I1016374">
                     <p class="titleinfigure">图3-1 Oracle Data Guard Broker配置</p><img src="img/dgbkr009.gif" alt="下面是图3-1的描述" title="下面是图3-1的描述" longdesc="img_text/dgbkr009.html"><br><a href="img_text/dgbkr009.html">“图3-1 Oracle Data Guard Broker配置”的说明</a></div>
                  <!-- class="figure" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-7E2D5B71-4052-4EC9-AA18-3BB4645B1696__GUID-3A836008-B8CF-469A-B27F-983046E47E36">配置范围的服务名称</p>
                     <p>代理在每个配置成员上使用相同的名称发布服务。这种配置范围的服务的默认名称是<code class="codeph"><span class="variable" translate="no">primarydbname</span> _CFG</code> ，其中的一个后缀<code class="codeph">_CFG</code>被附加到的值<code class="codeph">DB_UNIQUE_NAME</code>在创建配置时，主数据库的初始化参数。要更改配置范围服务的名称，请使用<code class="codeph">ConfigurationWideServiceName</code>属性。请参见<a href="oracle-data-guard-broker-properties.html#GUID-EA9AA7B3-36F4-4D45-BD55-30D6A71210DC" title="ConfigurationWideServiceName配置属性用于更改配置范围服务的名称。">ConfigurationWideServiceName</a> 。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DGBKR3659"></a><div class="props_rev_3"><a id="GUID-BF708883-519A-428D-A1A1-BDCDCE272D64" name="GUID-BF708883-519A-428D-A1A1-BDCDCE272D64"></a><h3 id="DGBKR-GUID-BF708883-519A-428D-A1A1-BDCDCE272D64" class="sect3"><span class="enumeration_section">3.2</span>配置属性</h3>
               <div>
                  <p>配置属性控制代理配置的行为。</p>
                  <p>您可以使用DGMGRL或Cloud Control查看和动态更新这些属性的值。但是，某些属性只能通过DGMGRL更新。</p>
                  <p>配置属性具有配置范围;意味着您为属性设置的值统一应用于配置中的每个数据库。</p>
                  <p></p>
                  <div class="infoboxnote" id="GUID-BF708883-519A-428D-A1A1-BDCDCE272D64__GUID-9CFA7415-4D70-427A-83C7-D11F03D837F9">
                     <p class="notep1">注意：</p>
                     <p>与Oracle数据库版本19C，与数据库的初始化参数的性能，除了开始<code class="codeph">log_archive_dest_</code> <code class="codeph"><span class="codeinlineitalic">n</span></code>和<code class="codeph">log_archive_dest_state_</code> <code class="codeph"><span class="codeinlineitalic">n</span></code> ，不再存储在代理配置文件中
                     </p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-BF708883-519A-428D-A1A1-BDCDCE272D64__GUID-AD8C6BA7-0B37-4AEA-9F6A-FCEBA2E1F2CA">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="oracle-data-guard-broker-properties.html#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E" title="使用Oracle Data Guard代理属性来管理实例或整个配置。">Oracle Data Guard Broker属性，</a>用于完整描述所有代理配置属性</p>
                  </div>
               </div>
            </div><a id="DGBKR105"></a><div class="props_rev_3"><a id="GUID-E4EE9680-63B7-4483-843B-47E33FC41B20" name="GUID-E4EE9680-63B7-4483-843B-47E33FC41B20"></a><h3 id="DGBKR-GUID-E4EE9680-63B7-4483-843B-47E33FC41B20" class="sect3"><span class="enumeration_section">3.3</span>设置代理配置文件</h3>
               <div>
                  <p>当代理首次启动时，将自动创建配置文件，并使用特定于操作系统的默认路径名和文件名进行命名。</p>
                  <div class="section">
                     <p>二<a id="d6115e355" class="indexterm-anchor"></a>为每个数据库维护配置文件的副本，以便始终记录上次配置的<span class="italic">有效</span>状态。您可以通过为该数据库设置以下初始化参数来覆盖默认路径名和文件名：</p><pre class="oac_no_warn" dir="ltr">DG_BROKER_CONFIG_FILE1 DG_BROKER_CONFIG_FILE2</pre><p>设置<code class="codeph">DG_BROKER_CONFIG_FILE1</code>和<code class="codeph">DG_BROKER_CONFIG_FILE2</code>初始化参数时，请注意以下限制：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>只有在Oracle Data Guard代理未运行时才能设置或更改这些参数（ <code class="codeph">DG_BROKER_START=FALSE</code> ）。
                           </p>
                        </li>
                        <li>
                           <p>这些参数必须指定为所有Oracle RAC实例共享的Oracle ASM，Oracle OCFS或NFS。</p>
                        </li>
                        <li>
                           <p>使用PL / SQL程序包<code class="codeph">DBMS_ROLLING</code>执行升级时， <code class="codeph">DG_BROKER_CONFIG_FILE <span class="codeinlineitalic">n</span></code>参数必须指定Oracle主目录之外的位置。（默认位置是Oracle主目录中的<code class="codeph">dbs</code>目录。）
                           </p>
                        </li>
                     </ul>
                     <p>Oracle Data Guard代理适用于使用Oracle托管或用户托管数据文件的数据库。这些数据文件可以驻留在文件系统或Oracle ASM磁盘组中。以下部分包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-73036514-7061-4B0D-83E5-C257EE59D791" title="您可以通过发出ALTER SYSTEM SQL语句来更改代理配置文件的名称。">重命名代理配置文件</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-DFCBAD5E-221E-45E8-8D05-3B782E99B74F" title="在Oracle RAC环境中，数据库的所有实例都必须引用同一组配置文件。">在Oracle RAC环境中管理代理配置文件</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="DGBKR3391"></a><div class="props_rev_3"><a id="GUID-73036514-7061-4B0D-83E5-C257EE59D791" name="GUID-73036514-7061-4B0D-83E5-C257EE59D791"></a><h4 id="DGBKR-GUID-73036514-7061-4B0D-83E5-C257EE59D791" class="sect4"><span class="enumeration_section">3.3.1</span>重命名代理配置文件</h4>
                  <div>
                     <p>您可以通过发出<code class="codeph">ALTER SYSTEM</code> SQL语句来更改代理配置文件的名称。
                     </p>
                     <div class="section">
                        <p>但是，当代理的DMON进程正在运行时，您无法更改这些参数。要更改给定数据库的配置文件的名称，请执行以下步骤：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>使用DGMGRL <code class="codeph">DISABLE</code>命令禁用代理配置。请参阅<a href="managing-oracle-data-guard-broker-configurations.html#GUID-C2D3075F-FEA6-4C38-93F5-36E945D6C931" title="在代理配置中启用或禁用数据库时，您实际上是启用或禁用代理管理和监视指定数据库的功能。">启用和禁用操作</a> 。</span></li>
                        <li class="stepexpand"><span>使用以下SQL语句停止Oracle Data Guard代理DMON进程：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER SYSTEM SET DG_BROKER_START = FALSE;</pre></div>
                        </li>
                        <li class="stepexpand"><span>更改数据库的配置文件名：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER SYSTEM SET DG_BROKER_CONFIG_FILE1 = <span class="italic">filespec1</span> ; SQL&gt; ALTER SYSTEM SET DG_BROKER_CONFIG_FILE2 = <span class="italic">filespec2</span> ;</pre><div class="infoboxnote" id="GUID-73036514-7061-4B0D-83E5-C257EE59D791__GUID-9CBF1377-2E1D-44F6-8F98-8C52F072C449">
                                 <p class="notep1">注意：</p>
                                 <p>如果代理管理Oracle RAC数据库的价值<code class="codeph">DG_BROKER_CONFIG_FILE1</code>和价值<code class="codeph">DG_BROKER_CONFIG_FILE2</code>为每个实例必须指向同一组的物理文件。
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>移动文件的方法取决于它们当前所在的位置以及要将它们移动到的位置：</span><div>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果文件驻留在操作系统文件系统上，请使用操作系统命令将文件移动到新位置。</p>
                                 </li>
                                 <li>
                                    <p>如果旧位置或新位置是Oracle ASM磁盘组，请使用<code class="codeph">DBMS_FILE_TRANSFER.COPY_FILE</code>函数将文件传输到新位置。
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>重新启动Oracle Data Guard代理DMON进程，如下所示：</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER SYSTEM SET DG_BROKER_START = TRUE;</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用DGMGRL <code class="codeph">ENABLE</code>命令或Cloud Control的Oracle Data Guard管理页面中的启用操作启用代理配置。</span></li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-73036514-7061-4B0D-83E5-C257EE59D791__GUID-73AFF704-60F5-48BA-A7EA-C0817E4E8C1A">
                           <p class="notep1">注意：</p>
                           <p>从版本11.2开始，文件可以驻留在具有任何支持的扇区大小（物理块大小）的磁盘上，最多包括4KB扇区。由11.2之前的版本生成的配置文件仅限于驻留在与首次创建文件时使用的扇区大小相同的磁盘上。必须首先将这些文件升级到版本11.2，然后才能将它们移动到具有不同扇区大小的位置，否则预期它们将驻留在给定代理配置中的扇区大小的混合中。有关详细信息，请参阅<a href="upgrading-downgrading-in-data-guard-broker-configuration.html#GUID-9B424C49-A005-4106-9EF8-CB7479F9ACB8" title="如果您当前正在Oracle Database 10g或Oracle Database 11g上运行Oracle Data Guard，则可以使用Oracle数据库安装文档将数据库软件升级到Oracle Database 12c第1版（12.1）或Oracle Database 12c第2版（12.2）。适合您的操作系统。">从Oracle数据库10g和Oracle Database 11g升级到Oracle Database 12c</a> 。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="DGBKR3392"></a><div class="props_rev_3"><a id="GUID-DFCBAD5E-221E-45E8-8D05-3B782E99B74F" name="GUID-DFCBAD5E-221E-45E8-8D05-3B782E99B74F"></a><h4 id="DGBKR-GUID-DFCBAD5E-221E-45E8-8D05-3B782E99B74F" class="sect4"><span class="enumeration_section">3.3.2</span>在Oracle RAC环境中管理代理配置文件</h4>
                  <div>
                     <p>在Oracle RAC环境中，数据库的所有实例都必须引用同一组配置文件。</p>
                     <p>这意味着如果经纪人正在管理<a id="d6115e562" class="indexterm-anchor"></a>然后是Oracle RAC数据库的值<a id="d6115e567" class="indexterm-anchor"></a><a id="d6115e569" class="indexterm-anchor"></a> <code class="codeph">DG_BROKER_CONFIG_FILE1</code>和每个实例的<code class="codeph">DG_BROKER_CONFIG_FILE2</code>值必须指向同一组物理文件。可以使用以下方法之一部署配置文件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-DA58B12D-65A3-439E-8919-AF56F28DD2FD" title="代理配置文件可以驻留在群集文件系统（CFS）上。">使用群集文件系统（CFS）配置文件</a></p>
                        </li>
                        <li>
                           <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-72586D45-4E5D-409B-B594-8B00FBF91507" title="代理的配置文件也可以驻留在Oracle ASM磁盘组上。">将Oracle ASM磁盘组用于配置文件</a></p>
                        </li>
                     </ul>
                  </div><a id="DGBKR3519"></a><a id="DGBKR3393"></a><div class="props_rev_3"><a id="GUID-DA58B12D-65A3-439E-8919-AF56F28DD2FD" name="GUID-DA58B12D-65A3-439E-8919-AF56F28DD2FD"></a><h5 id="DGBKR-GUID-DA58B12D-65A3-439E-8919-AF56F28DD2FD" class="sect5"><span class="enumeration_section">3.3.2.1</span>使用群集文件系统（CFS）配置文件</h5>
                     <div>
                        <p>代理配置文件可以驻留在群集文件系统（CFS）上。</p>
                        <p>如果他们这样做的话<a id="d6115e621" class="indexterm-anchor"></a> ，必须将所有实例上的<code class="codeph">DG_BROKER_CONFIG_FILE</code> <span class="variable" translate="no">n</span>参数设置为这些文件，包括CFS区域的路径。<a href="managing-oracle-data-guard-broker-configurations.html#GUID-DA58B12D-65A3-439E-8919-AF56F28DD2FD__CFHBJHIG">图3-2</a>显示了代理配置文件的设置<a id="d6115e633" class="indexterm-anchor"></a><a id="d6115e637" class="indexterm-anchor"></a><a id="d6115e641" class="indexterm-anchor"></a> CFS。在这种情况下，所有实例的参数和值将是：</p><pre class="oac_no_warn" dir="ltr">DG_BROKER_CONFIG_FILE1 = $ ORACLE_BASE / admin / <span class="italic">db_unique_name</span> / dr1 <span class="italic">db_unique_name</span> .dat DG_BROKER_CONFIG_FILE2 = $ ORACLE_BASE / admin / <span class="italic">db_unique_name</span> / dr2 <span class="italic">db_unique_name</span> .dat</pre><div class="figure" id="GUID-DA58B12D-65A3-439E-8919-AF56F28DD2FD__CFHBJHIG">
                           <p class="titleinfigure">图3-2 CFS区域中的代理配置设置</p><img src="img/dgbkr002.gif" alt="下面是图3-2的描述" title="下面是图3-2的描述" longdesc="img_text/dgbkr002.html"><br><a href="img_text/dgbkr002.html">“图3-2 CFS区域中的代理配置设置”的描述</a></div>
                        <!-- class="figure" -->
                     </div>
                  </div><a id="DGBKR3520"></a><a id="DGBKR3394"></a><div class="props_rev_3"><a id="GUID-72586D45-4E5D-409B-B594-8B00FBF91507" name="GUID-72586D45-4E5D-409B-B594-8B00FBF91507"></a><h5 id="DGBKR-GUID-72586D45-4E5D-409B-B594-8B00FBF91507" class="sect5"><span class="enumeration_section">3.3.2.2</span>将Oracle ASM磁盘组用于配置文件</h5>
                     <div>
                        <p>代理的配置文件也可以驻留在Oracle ASM磁盘组上。</p>
                        <p><a href="managing-oracle-data-guard-broker-configurations.html#GUID-72586D45-4E5D-409B-B594-8B00FBF91507__CFHBJBDE">图3-3</a>显示了Oracle ASM设备上代理配置文件的设置。在这种情况下，将指定参数和值，如下所示：</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET DG_BROKER_CONFIG_FILE1 ='+ DG / DIRECTORY / DR1。DAT'SCOPE =两个; ALTER SYSTEM SET DG_BROKER_CONFIG_FILE2 ='+ DG / DIRECTORY / DR2。DAT'SCOPE =两个;</pre><div class="figure" id="GUID-72586D45-4E5D-409B-B594-8B00FBF91507__CFHBJBDE">
                           <p class="titleinfigure">图3-3使用Oracle ASM进行代理配置设置</p><img src="img/dgbkr001.gif" alt="下面是图3-3的描述" title="下面是图3-3的描述" longdesc="img_text/dgbkr001.html"><br><a href="img_text/dgbkr001.html">“图3-3使用Oracle ASM进行代理配置设置”的说明</a></div>
                        <!-- class="figure" -->
                        <p>由于配置文件必须由用户显式命名，因此这些配置文件不是Oracle Managed Files（OMF）。要在Oracle ASM磁盘组上创建代理的配置文件，请将<code class="codeph">DG_BROKER_CONFIG_FILE1</code>和<code class="codeph">DG_BROKER_CONFIG_FILE2</code>初始化参数设置为字符串值，该字符串值包括现有Oracle ASM磁盘组的名称，该磁盘组中的现有目录以及配置的名称文件本身。
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="DGBKR115"></a><div class="props_rev_3"><a id="GUID-BAAE6C51-C29F-4950-A885-EB1289A230B2" name="GUID-BAAE6C51-C29F-4950-A885-EB1289A230B2"></a><h3 id="DGBKR-GUID-BAAE6C51-C29F-4950-A885-EB1289A230B2" class="sect3"><span class="enumeration_section">3.4</span>启动Data Guard Broker</h3>
               <div>
                  <p>设置配置文件后，必须将每个数据库的<code class="codeph">DG_BROKER_START</code>初始化参数设置为<code class="codeph">TRUE</code>才能启动DMON进程。
                  </p>
                  <div class="section">
                     <p>默认情况下， <code class="codeph">DG_BROKER_START</code>初始化参数设置为<code class="codeph">FALSE</code> 。但是，您可以通过以下方式设置值：</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>如果您使用的是Cloud Control，它会自动将<code class="codeph">DG_BROKER_START</code>初始化参数设置为<code class="codeph">TRUE</code> ，以用于它创建的新备用数据库。
                           </p>
                        </li>
                        <li>
                           <p>如果使用DGMGRL，则必须将<code class="codeph">DG_BROKER_START</code>初始化参数明确设置为<code class="codeph">TRUE</code> ;否则，经纪人将无法启动。您可以使用以下SQL语句设置<code class="codeph">DG_BROKER_START</code>初始化参数：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; ALTER SYSTEM SET DG_BROKER_START = TRUE;系统改变了。SQL&gt; SHOW PARAMETER DG_BROKER_START NAME TYPE VALUE ------------------------------------ dg_broker_start boolean TRUE</pre></li>
                     </ul>
                     <p>无论您使用Cloud Control还是DGMGRL，请在每个主数据库和备用数据库的服务器参数文件中将<code class="codeph">DG_BROKER_START</code>初始化参数的值设置为<code class="codeph">TRUE</code> 。这样做可确保Oracle Data Guard代理在下次启动数据库实例时自动启动。
                     </p>
                     <div class="infoboxnote" id="GUID-BAAE6C51-C29F-4950-A885-EB1289A230B2__GUID-79299331-689C-4BC6-819D-E12D8256FC45">
                        <p class="notep1">注意：</p>如果初始化参数<code class="codeph">DG_BROKER_START=TRUE</code> ，则如果对主数据库执行SQL <code class="codeph">STARTUP MOUNT</code>或<code class="codeph">ALTER DATABASE MOUNT</code>语句，则会在数据库级别自动启用存档日志模式。
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DGBKR3522"></a><a id="DGBKR3523"></a><a id="DGBKR3524"></a><a id="DGBKR3525"></a><a id="DGBKR3634"></a><a id="DGBKR3526"></a><a id="DGBKR3527"></a><a id="DGBKR3528"></a><a id="DGBKR3529"></a><a id="DGBKR120"></a><div class="props_rev_3"><a id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE" name="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE"></a><h3 id="DGBKR-GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE" class="sect3"><span class="enumeration_section">3.5</span>代理配置的管理周期</h3>
               <div>
                  <p>该图显示了代理配置的生命周期，随附的文本说明了该周期的每个阶段。</p>
                  <div class="figure" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__I1019110">
                     <p class="titleinfigure">图3-4代理配置及其数据库的生命周期</p><img src="img/dgbkr005.gif" alt="下面是图3-4的描述" title="下面是图3-4的描述" longdesc="img_text/dgbkr005.html"><br><a href="img_text/dgbkr005.html">“图3-4代理配置及其数据库的生命周期”的描述</a></div>
                  <!-- class="figure" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-D3806B42-A34A-4E67-BD24-EA3BAE22EFDE">创建代理配置</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>使用Cloud Control时，“添加备用数据库”向导可以将现有（Oracle RAC或非Oracle RAC）备用数据库添加到配置中，也可以创建新的（Oracle RAC或非Oracle RAC）备用数据库并将其添加到配置中。备用数据库可以是物理，逻辑或快照数据库。</p>
                     <p>使用DGMGRL时，主数据库和备用数据库必须已存在。您可以从主数据库控制文件和数据文件的备份构造备用数据库，然后准备进行恢复。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-2A5EA4D1-EA60-4F34-A395-B69F90B37086">启用代理配置</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>必须启用Oracle Data Guard配置才能由代理管理或监视。相反，如果您不想再使用代理管理配置，则禁用配置。禁用配置时，还会禁用其所有数据库的代理管理。</p>
                     <div class="infoboxnote" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-5DAAC317-7C65-43A5-88AA-9BE073906F4B">
                        <p class="notep1">注意：</p>
                        <p>您可以使用DGMGRL启用或禁用配置。您无法使用Cloud Control禁用配置。如果以前使用DGMGRL禁用了Cloud Control，则可以使用Cloud Control启用配置。</p>
                     </div>
                     <p>首次使用Cloud Control创建时，代理配置会在“添加备用数据库”向导完成后立即自动启用。</p>
                     <p>首次使用DGMGRL创建时，代理配置处于禁用状态。这意味着其组成数据库尚未受到经纪人的主动控制。使用DGMGRL将数据库配置为代理配置后，必须启用配置以允许代理管理配置。</p>
                     <p>您可以启用：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>整个配置，包括其所有数据库</p>
                        </li>
                        <li>
                           <p>单个备用数据库</p>
                        </li>
                     </ul>
                     <p>如果出现问题，您可以轻松地禁用数据库，使其无法在代理配置中正常运行。请注意，您无法禁用主数据库。您必须禁用整个配置才能禁用主数据库。</p>
                     <p>您可能还希望暂时禁用配置，然后更改代理配置中的某些属性，而不会影响实际的数据库属性。更改的属性将在再次启用配置以供代理管理时生效。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-2A1D40D5-DB5C-497F-BE53-A5FE7B93D81A">根据需要在代理配置中进行角色更改</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以随时发出单个命令来更改配置中数据库的角色。如果某个事件使主数据库不可用，则可以将其中一个备用数据库故障转移为新的主数据库。</p>
                     <p>如果在以前的主数据库上启用了闪回数据库，则在故障转移完成后，您可以将以前的主数据库恢复为新主数据库的备用数据库。</p>
                     <p>此外，可以减少计划的维护停机时间，因为您可以快速将生产处理从当前主数据库切换到备用数据库，然后在计划维护后再次切换回来。</p>
                     <div class="infoboxnotealso" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-C45B43F6-BAEC-49F0-815E-2A45BC0B11D7">
                        <p class="notep1">也可以看看：</p>
                        <p>有关角色更改的详细信息，请<a href="using-data-guard-broker-to-manage-switchovers-failovers.html#GUID-44E7A982-7CD4-4A51-B00E-62C0698C5CD6" title="了解如何使用Oracle Data Guard代理在切换和故障转移期间管理数据库。">参见切换和故障转移操作</a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-8C76DCBA-6488-48A4-A07B-B42A7A40E75B">转换为快照备用数据库</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以随时发出单个命令将物理备用数据库转换为快照备用数据库。快照备用数据库是完全可更新的数据库，它接收从主数据库生成的重做数据，但不应用它。</p>
                     <p>使用完快照备用数据库后，可以再次发出一个命令将其转换为物理备用数据库。转换为物理备用数据库完成后，将启动重做应用服务（假设状态为<code class="codeph">APPLY-ON</code> ）并应用所有累积的重做数据。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-B2B77522-99DE-4882-82BD-724157B93905">根据需要对数据库进行状态更改</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>第一次启用配置时，默认情况下，代理会在主服务器上启动重做传输服务，并在备用服务器上启动日志应用服务（快照备用数据库除外）。</p>
                     <p>您可以随时通过Cloud Control或DGMGRL发出单个命令来更改数据库的状态。例如，您可以将主数据库置于<code class="codeph">TRANSPORT-OFF</code>状态，以暂时停止将重做数据发送到备用数据库。然后，要继续将重做数据发送到备用数据库，可以将主数据库置于<code class="codeph">TRANSPORT-ON</code>状态。
                     </p>
                     <div class="infoboxnotealso" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-14FF7D1D-3856-4DD9-8A3A-F56D27BDE0B2">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-0CD70A29-4F51-4CC1-88EB-2D8AA29F75D7" title="了解如何管理代理配置成员，以及监视配置的每个成员的状态。">管理代理配置的成员以</a>获取有关数据库状态更改的更多信息</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-C1DEB861-D0CF-4817-B02E-FB7B2A529D1D">根据需要更新数据库属性</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>代理允许您设置数据库属性，其中一些属性对应于数据库初始化参数。您可以更改这些属性以动态控制重做传输，备用文件管理，日志应用等操作，并支持整体配置保护模式。代理在Oracle Data Guard配置中记录每个数据库的代理配置文件中的更改，并根据需要将更改传播到服务器参数文件中的相关初始化参数。</p>
                     <div class="infoboxnotealso" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-907D046A-BFBA-4137-9407-0F667DB953A4">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-0CD70A29-4F51-4CC1-88EB-2D8AA29F75D7" title="Learn how to manage broker configuration members, and monitor the state of each member of the configuration.">管理Broker配置</a>和<a href="oracle-data-guard-broker-properties.html#GUID-1966A317-DD75-4385-8A64-ADEC75662F7E" title="使用Oracle Data Guard代理属性来管理实例或整个配置。">Oracle Data Guard Broker属性</a> <a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-0CD70A29-4F51-4CC1-88EB-2D8AA29F75D7" title="了解如何管理代理配置成员，以及监视配置的每个成员的状态。">的成员，以</a>获取有关数据库属性的完整信息</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-56CD3D92-B16C-477E-ABC8-3D41C95B3617">根据需要设置数据保护模式</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>代理使您可以为配置设置数据保护模式。您可以配置保护模式以最大化数据保护，最大化可用性或最大化性能。</p>
                     <div class="infoboxnotealso" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-7CBFAA08-843F-43E7-9693-F95397CA7669">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-994BE350-859F-41DC-A1D3-B6E8D5EEF2C8" title="您可以使用代理设置具有任何不同数据保护模式的配置。">管理数据保护模式</a>以获取有关管理数据保护模式的信息</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1CB8734A-B5D9-4B65-A950-72ADDF632DCE__GUID-1CB5227C-8181-4FCC-882B-9A70355A5070">监控配置</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>您可以检查配置的运行状况，显示和更新数据库的属性，以及设置Cloud Control事件。</p>
                     <p>Cloud Control还提供动态性能页面，可以按指定的时间间隔自动动态刷新图表数据和状态。性能图表显示了生成和应用多少重做数据的图形摘要。</p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="DGBKR125"></a><div class="props_rev_3"><a id="GUID-C2D3075F-FEA6-4C38-93F5-36E945D6C931" name="GUID-C2D3075F-FEA6-4C38-93F5-36E945D6C931"></a><h3 id="DGBKR-GUID-C2D3075F-FEA6-4C38-93F5-36E945D6C931" class="sect3"><span class="enumeration_section">3.6</span>启用和禁用操作</h3>
               <div>
                  <p>在代理配置中启用或禁用数据库时，您实际上是启用或禁用代理管理和监视指定数据库的功能。</p>
                  <p>仅为代理配置中的数据库定义启用和禁用操作;您不能对不属于代理配置的数据库执行这些代理操作。<a id="d6115e1063" class="indexterm-anchor"></a><a id="d6115e1067" class="indexterm-anchor"></a></p>
                  <p>但是，禁用代理配置不会影响实际Oracle Data Guard配置中的当前服务和操作。例如，禁用代理配置时，Oracle Data Guard配置中的重做传输服务和日志应用服务将继续保持不变，但您无法再通过代理接口对其进行管理。</p>
                  <p>此外，禁用数据库<span class="italic">不会</span>从代理配置文件中删除或删除它。您仍然可以更改已禁用数据库的属性，然后使用DGMGRL <code class="codeph">ENABLE CONFIGURATION</code>或<code class="codeph">ENABLE DATABASE</code>命令或Cloud Control的Oracle Data Guard管理页面中的Enable选项重新启用使用代理进行管理的功能。
                  </p>
                  <div class="infoboxnote" id="GUID-C2D3075F-FEA6-4C38-93F5-36E945D6C931__GUID-2A215DA6-F271-449D-9833-747D0285658E">
                     <p class="notep1">注意：</p>
                     <p>如果在代理配置中禁用备用数据库的代理管理，则在丢失主数据库时，代理不能将该备用数据库用作故障转移目标。</p>
                  </div>
                  <p>即使您要删除代理监视和控制数据库的能力，禁用代理管理配置也可能很有用。例如，暂时禁用配置以便同时更改代理配置中的一个或多个属性可能是有利的。在禁用配置中更改属性时，它不会影响下面的实际数据库属性，因为在重新启用配置之前，更改不会应用于正在运行的数据库。例如，您可能希望更改已禁用配置的整体配置保护模式和重做传输服务属性，以便在下一次启用操作时同时将所有更改应用于配置。</p>
                  <div class="infoboxnotealso" id="GUID-C2D3075F-FEA6-4C38-93F5-36E945D6C931__GUID-BF131332-12FD-4F4E-81BC-246C9CD448D6">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="managing-oracle-data-guard-broker-configuration-members.html#GUID-4F9446D8-AB6E-4917-BED2-058126654DA0" title="这些主题描述了Oracle Data Guard配置的保护模式和重做传输服务如何影响切换，故障转移以及禁用或启用配置等操作。">保护模式如何影响经纪人的运作</a></p>
                  </div>
               </div>
            </div><a id="DGBKR130"></a><div class="props_rev_3"><a id="GUID-92632C7B-BFF3-4678-9F4F-CC0B72ED6A35" name="GUID-92632C7B-BFF3-4678-9F4F-CC0B72ED6A35"></a><h3 id="DGBKR-GUID-92632C7B-BFF3-4678-9F4F-CC0B72ED6A35" class="sect3"><span class="enumeration_section">3.7</span>配置状态</h3>
               <div>
                  <p>配置状态显示配置的整体运行状况。</p>
                  <p>从其所有数据库的状态获取配置的状态。 <a id="d6115e1131" class="indexterm-anchor"></a><a id="d6115e1135" class="indexterm-anchor"></a><a id="d6115e1139" class="indexterm-anchor"></a> 
                  </p>
                  <p>以下列表描述了配置的可能状态模式：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a id="d6115e1149" class="indexterm-anchor"></a>成功</p>
                        <p>配置（包括其中配置的所有数据库）按用户指定的方式运行，没有任何警告或错误。</p>
                     </li>
                     <li>
                        <p><a id="d6115e1156" class="indexterm-anchor"></a>警告</p>
                        <p>配置中的一个或多个数据库未按用户指定的方式运行。要获取更多信息，请使用DGMGRL <code class="codeph">SHOW DATABASE &lt;db-unique-name&gt;</code>命令或Cloud Control显示来查找每个数据库并检查其状态以显示问题的根源。
                        </p>
                     </li>
                     <li>
                        <p><a id="d6115e1166" class="indexterm-anchor"></a><a id="d6115e1168" class="indexterm-anchor"></a>错误</p>
                        <p>配置中的一个或多个数据库失败或可能不再按用户指定的方式运行。要获取更多信息，请使用DGMGRL <code class="codeph">SHOW DATABASE &lt;db-unique-name&gt;</code>命令或Cloud Control显示来查找每个数据库并检查其状态以显示问题的根源。
                        </p>
                     </li>
                     <li>
                        <p>未知/禁用</p>
                        <p>已禁用配置的代理管理，并且代理不监视配置中数据库的状态。</p>
                     </li>
                     <li>
                        <p>滚动数据库维护正在进行中</p>
                        <p>使用PL / SQL <code class="codeph">DBMS_ROLLING</code>包执行的操作正在进行中。
                        </p>
                     </li>
                  </ul>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>