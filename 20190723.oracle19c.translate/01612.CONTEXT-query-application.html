<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>上下文查询应用程序</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Application Developer&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Application Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="text-application-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-07T01:45:16-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96275-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="migrating-oracle-text-applications.html" title="Previous" type="text/html"></link>
      <link rel="next" href="CATSEARCH-query-application.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Text Application Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="CCAPP"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="migrating-oracle-text-applications.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="CATSEARCH-query-application.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">应用程序开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">上下文查询应用程序</li>
            </ol>
            <a id="GUID-1F1B44E8-ACCA-446A-84EA-67FA692476BA" name="GUID-1F1B44E8-ACCA-446A-84EA-67FA692476BA"></a><a id="CCAPP3000"></a>
            
            <h2 id="CCAPP-GUID-1F1B44E8-ACCA-446A-84EA-67FA692476BA" class="sect2"><span class="enumeration_chapter">上下文</span>查询应用</h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d40230e61" class="indexterm-anchor"></a><a id="d40230e65" class="indexterm-anchor"></a><a id="d40230e67" class="indexterm-anchor"></a><a id="d40230e71" class="indexterm-anchor"></a>本附录介绍如何使用<code class="codeph">CONTEXT</code>索引类型构建简单的Web搜索应用程序。
               </p>
               <p>本附录包含以下主题：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="CONTEXT-query-application.html#GUID-D58C935C-301F-44F4-BF28-050B83EA2ACE">Web查询应用程序概述</a></p>
                  </li>
                  <li>
                     <p><a href="CONTEXT-query-application.html#GUID-02600A05-F136-464F-A683-0504F6809388">PL / SQL Server页面（PSP）Web应用程序</a></p>
                  </li>
                  <li>
                     <p><a href="CONTEXT-query-application.html#GUID-DEABF1DC-7C2E-436D-A83F-D036260B0B32">Java Server Pages（JSP）Web应用程序</a></p>
                  </li>
               </ul>
            </div><a id="CCAPP9528"></a><a id="CCAPP9529"></a><a id="CCAPP9371"></a><div class="props_rev_3"><a id="GUID-D58C935C-301F-44F4-BF28-050B83EA2ACE" name="GUID-D58C935C-301F-44F4-BF28-050B83EA2ACE"></a><h3 id="CCAPP-GUID-D58C935C-301F-44F4-BF28-050B83EA2ACE" class="sect3"><span class="enumeration_section">A.1</span> Web查询应用程序概述</h3>
               <div>
                  <p>Oracle Text的一个常见用途是为网站上的HTML文件编制索引，并为用户提供搜索功能。本附录中的示例应用程序对存储在数据库中的一组HTML文件进行索引。它还使用连接到Oracle数据库的Web服务器来提供搜索服务。</p>
                  <p>本附录描述了Web查询应用程序的两个版本：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>一个使用PL / SQL Server Pages（ <span class="bold">PSP</span> ）</p>
                     </li>
                     <li>
                        <p>一个使用Java Server Pages（ <span class="bold">JSP</span> ）</p>
                     </li>
                  </ul>
                  <p><a href="CONTEXT-query-application.html#GUID-D58C935C-301F-44F4-BF28-050B83EA2ACE__CHDIHHGG">图A-1</a>显示了文本查询应用程序的JSP版本。
                  </p>
                  <div class="figure" id="GUID-D58C935C-301F-44F4-BF28-050B83EA2ACE__CHDIHHGG">
                     <p class="titleinfigure">图A-1文本查询应用程序</p><img src="img/search01b.png" width="557" alt="下面是图A-1的描述" title="下面是图A-1的描述" longdesc="img_text/search01b.html"><br><a href="img_text/search01b.html">“图A-1文本查询应用程序”的描述</a></div>
                  <!-- class="figure" -->
                  <p><a href="CONTEXT-query-application.html#GUID-D58C935C-301F-44F4-BF28-050B83EA2ACE__CHDGCBIC">图A-2</a>显示了文本查询的结果。
                  </p>
                  <div class="figure" id="GUID-D58C935C-301F-44F4-BF28-050B83EA2ACE__CHDGCBIC">
                     <p class="titleinfigure">图A-2带结果的文本查询应用程序</p><img src="img/search02b.png" width="557" alt="下面是图A-2的描述" title="下面是图A-2的描述" longdesc="img_text/search02b.html"><br><a href="img_text/search02b.html">“图A-2带结果的文本查询应用程序”的描述</a></div>
                  <!-- class="figure" -->
                  <p>应用程序返回包含搜索词的文档的链接。每个文档都有四个链接：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="bold">HTML</span>链接显示文档。
                        </p>
                        <p>图形不会显示在已过滤的文档中。</p>
                     </li>
                     <li>
                        <p><span class="bold">突出显示</span>链接显示<span class="bold">突出</span>显示搜索词的文档。
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">主题</span>链接显示与文档关联的前50个主题。
                        </p>
                        <p><span class="bold">Gist</span>链接显示文档的简短摘要。
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="CCAPP9530"></a><a id="CCAPP9372"></a><div class="props_rev_3"><a id="GUID-02600A05-F136-464F-A683-0504F6809388" name="GUID-02600A05-F136-464F-A683-0504F6809388"></a><h3 id="CCAPP-GUID-02600A05-F136-464F-A683-0504F6809388" class="sect3"><span class="enumeration_section">A.2</span> PL / SQL Server页面（PSP）Web应用程序</h3>
               <div>
                  <p>PSP Web应用程序基于PL / SQL服务器页面。<a href="CONTEXT-query-application.html#GUID-02600A05-F136-464F-A683-0504F6809388__CACJEDFE">图A-3</a>说明了浏览器如何通过Web服务器调用Oracle数据库上的PSP存储过程。
                  </p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="CONTEXT-query-application.html#GUID-0D3EACC2-9FBC-480F-A742-F7F402905BB8">PSP Web应用程序先决条件</a></p>
                     </li>
                     <li>
                        <p><a href="CONTEXT-query-application.html#GUID-03558FFB-EFEF-4B43-92CA-E9ABB5EC0E6B">构建PSP Web应用程序</a></p>
                     </li>
                     <li>
                        <p><a href="CONTEXT-query-application.html#GUID-5399C5D7-77E6-4BD9-AAD8-21D63279E630">PSP Web应用程序示例代码</a></p>
                     </li>
                  </ul>
                  <div class="figure" id="GUID-02600A05-F136-464F-A683-0504F6809388__CACJEDFE">
                     <p class="titleinfigure">图A-3 PSP Web应用程序</p><img src="img/ccapp012.gif" width="596" alt="下面是图A-3的描述" title="下面是图A-3的描述" longdesc="img_text/ccapp012.html"><br><a href="img_text/ccapp012.html">“图A-3 PSP Web应用程序”的描述</a></div>
                  <!-- class="figure" -->
               </div><a id="CCAPP9373"></a><div class="props_rev_3"><a id="GUID-0D3EACC2-9FBC-480F-A742-F7F402905BB8" name="GUID-0D3EACC2-9FBC-480F-A742-F7F402905BB8"></a><h4 id="CCAPP-GUID-0D3EACC2-9FBC-480F-A742-F7F402905BB8" class="sect4"><span class="enumeration_section">A.2.1</span> PSP Web应用程序先决条件</h4>
                  <div>
                     <p>此应用程序具有以下要求：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您的Oracle数据库必须已启动并正在运行。</p>
                        </li>
                        <li>
                           <p>您解锁SCOTT帐户时使用其密码解锁，该帐户具有<code class="codeph">CREATE,</code> <code class="codeph">RESOURCE,</code>和<code class="codeph">CTXAPP</code>权限。
                           </p>
                        </li>
                        <li>
                           <p>Oracle PL / SQL网关必须正在运行。</p>
                        </li>
                        <li>
                           <p>Apache等Web服务器已启动并正在运行，并且已正确配置为向Oracle数据库发送请求。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-0D3EACC2-9FBC-480F-A742-F7F402905BB8__GUID-A6C42CA6-B81B-45E8-AB98-D34D38E601BB">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../jsqlj/key-programming-considerations.html#JSQLJ196" target="_blank"><span class="italic">Oracle数据库SQLJ开发人员指南，</span></a>用于连接示例</p>
                           </li>
                           <li>
                              <p>有关设置PL / SQL网关和开发PL / SQL Web应用程序的完整信息，请参见<a href="../adfns/web-applications.html#ADFNS015" target="_blank"><span class="italic">“Oracle数据库开发指南”</span></a></p>
                           </li>
                           <li>
                              <p>有关安装Apache HTTP Server的信息，请参阅<span class="italic">Oracle Database 2 Day + PHP Developer's Guide</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CCAPP9374"></a><div class="props_rev_3"><a id="GUID-03558FFB-EFEF-4B43-92CA-E9ABB5EC0E6B" name="GUID-03558FFB-EFEF-4B43-92CA-E9ABB5EC0E6B"></a><h4 id="CCAPP-GUID-03558FFB-EFEF-4B43-92CA-E9ABB5EC0E6B" class="sect4"><span class="enumeration_section">A.2.2</span>构建PSP Web应用程序</h4>
                  <div>
                     <div class="section">
                        <p>要创建PSP Web应用程序：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>创建文本表。</span><div>
                              <p>必须使用<code class="codeph">CREATE</code> <code class="codeph">TABLE</code>命令创建文本表以存储HTML文件。这些示例创建<code class="codeph">output_table,</code> <code class="codeph">gist_table,</code>和<code class="codeph">theme_table</code>表：</p><pre class="oac_no_warn" dir="ltr">CREATE TABLE output_table（query_id NUMBER，文档CLOB）; CREATE TABLE gist_table（query_id NUMBER，pov VARCHAR2（80），gist CLOB）; CREATE TABLE theme_table（query_id NUMBER，theme VARCHAR2（2000），weight NUMBER）;</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用SQL * Loader将HTML文档加载到表中。</span><div>
                              <p>您必须使用HTML文件加载文本表。此示例使用<a href="CONTEXT-query-application.html#GUID-D4D8B356-1F41-4927-8984-8195C0A05EB9">loader.ctl</a>控制文件来加载在<a href="CONTEXT-query-application.html#GUID-C9175A31-89FE-4B66-99A5-D60E6E7C4EB6">loader.dat中</a>指定的文件。SQL * Loader语句如下：</p><pre class="oac_no_warn" dir="ltr">％sqlldr userid = scott / <span class="italic">password</span> control = loader.ctl</pre></div>
                        </li>
                        <li class="stepexpand"><span>创建<code class="codeph">CONTEXT</code>索引。<a id="d40230e553" class="indexterm-anchor"></a><a id="d40230e557" class="indexterm-anchor"></a><a id="d40230e561" class="indexterm-anchor"></a><a id="d40230e565" class="indexterm-anchor"></a></span><div>
                              <p>通过在文本列上创建<code class="codeph">CONTEXT</code>索引来索引HTML文件，如下所示。因为您正在索引HTML，所以此示例使用<code class="codeph">NULL_FILTER</code>首选项类型进行无过滤，并使用<code class="codeph">HTML_SECTION_GROUP</code>类型，如下所示：</p><pre class="oac_no_warn" dir="ltr">在search_table（text）上创建索引idx_search_table indextype是ctxsys.context参数（'filter ctxsys.null_filter section group CTXSYS.HTML_SECTION_GROUP'）;</pre></div>
                        </li>
                        <li class="stepexpand"><span>编译Oracle数据库中的<code class="codeph">search_htmlservices</code>包。</span><div>
                              <p>应用程序必须向用户显示所选文档。为此，Oracle数据库必须从<code class="codeph">search_table</code>的字符大对象<code class="codeph">(CLOB)</code>读取文档并输出结果以供查看。为此，请调用<code class="codeph">search_htmlservices</code>包中的过程。在SQL * Plus提示符下编译文件<a href="CONTEXT-query-application.html#GUID-6F1889D2-689F-4548-8B0A-D6ED37ECC092">search_htmlservices.sql</a>文件，如下所示：</p><pre class="oac_no_warn" dir="ltr">SQL&gt; @ search_htmlservices.sql包创建。
</pre></div>
                        </li>
                        <li class="stepexpand"><span>使用<code class="codeph">search_html</code>编译<code class="codeph">search_html</code> PSP页面。</span><div>
                              <p>通过从浏览器调用<a href="CONTEXT-query-application.html#GUID-B82F1C3B-2EAC-4036-9584-ED7384D9CB80">search_html.psp</a>来调用搜索页面。您可以使用<code class="codeph">loadpsp</code>命令行程序在Oracle数据库中编译search_html，如下所示：</p><pre class="oac_no_warn" dir="ltr">％loadpsp -replace -user scott / <span class="italic">password</span> search_html.psp</pre><p>输出显示为：</p><pre class="oac_no_warn" dir="ltr">“search_html.psp”：创建过程“search_html”。</pre><div class="infoboxnotealso" id="GUID-03558FFB-EFEF-4B43-92CA-E9ABB5EC0E6B__GUID-0F0008F6-A5EC-4701-B3B4-7A95072258D8">
                                 <p class="notep1">也可以看看：</p>
                                 <p>有关使用PSP的更多信息，请参见“Oracle数据库开发指南”的Oracle Database 11g第2版（11.2）</p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>配置Web服务器。</span><div>
                              <p>您必须将Web服务器配置为接受客户端PSP请求作为URL。您的Web服务器将这些请求转发到Oracle数据库并将服务器输出返回给浏览器。<a href="CONTEXT-query-application.html#GUID-02600A05-F136-464F-A683-0504F6809388__CACJEDFE">见图A-3</a> 。
                              </p>
                              <p>您可以使用Oracle WebDB Web侦听器或Oracle Application Server，其中包括Apache Web服务器。</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>从浏览器输入查询。</span><div>
                              <p>您可以使用URL从浏览器访问查询应用程序。您使用Web服务器配置URL。示例URL可能如下所示：</p><pre class="oac_no_warn" dir="ltr">http://server.example.com:7777/mypath/search_html</pre><p>应用程序在浏览器中显示一个查询输入框，并将查询结果作为HTML链接列表返回， <a href="CONTEXT-query-application.html#GUID-D58C935C-301F-44F4-BF28-050B83EA2ACE__CHDIHHGG">如图A-1</a>和<a href="CONTEXT-query-application.html#GUID-D58C935C-301F-44F4-BF28-050B83EA2ACE__CHDGCBIC">图A-2所示</a> 。
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="CCAPP9375"></a><div class="props_rev_3"><a id="GUID-5399C5D7-77E6-4BD9-AAD8-21D63279E630" name="GUID-5399C5D7-77E6-4BD9-AAD8-21D63279E630"></a><h4 id="CCAPP-GUID-5399C5D7-77E6-4BD9-AAD8-21D63279E630" class="sect4"><span class="enumeration_section">A.2.3</span> PSP Web应用程序示例代码</h4>
                  <div>
                     <p>本节列出了用于构建示例Web应用程序的代码。它包括以下文件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="CONTEXT-query-application.html#GUID-D4D8B356-1F41-4927-8984-8195C0A05EB9">loader.ctl</a></p>
                        </li>
                        <li>
                           <p><a href="CONTEXT-query-application.html#GUID-C9175A31-89FE-4B66-99A5-D60E6E7C4EB6">loader.dat</a></p>
                        </li>
                        <li>
                           <p><a href="CONTEXT-query-application.html#GUID-6F1889D2-689F-4548-8B0A-D6ED37ECC092">search_htmlservices.sql</a></p>
                        </li>
                        <li>
                           <p><a href="CONTEXT-query-application.html#GUID-B82F1C3B-2EAC-4036-9584-ED7384D9CB80">search_html.psp</a></p>
                        </li>
                     </ul>
                  </div><a id="CCAPP9376"></a><div class="props_rev_3"><a id="GUID-D4D8B356-1F41-4927-8984-8195C0A05EB9" name="GUID-D4D8B356-1F41-4927-8984-8195C0A05EB9"></a><h5 id="CCAPP-GUID-D4D8B356-1F41-4927-8984-8195C0A05EB9" class="sect5"><span class="enumeration_section">A.2.3.1</span> loader.ctl</h5>
                     <div>
                        <div class="section">
                           <p>此示例显示了一个示例<code class="codeph">loader.ctl</code>文件。<code class="codeph">sqlldr</code>使用它来加载<code class="codeph">loader.dat</code>数据文件。
                           </p><pre class="oac_no_warn" dir="ltr">LOAD DATA INFILE'loading.dat'INTO TABLE search_table REPLACE FIELDS TERMINATED BY';' （tk INTEGER，标题CHAR，text_file FILLER CHAR，文本LOBFILE（text_file）由EOF终止）</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="CCAPP9377"></a><div class="props_rev_3"><a id="GUID-C9175A31-89FE-4B66-99A5-D60E6E7C4EB6" name="GUID-C9175A31-89FE-4B66-99A5-D60E6E7C4EB6"></a><h5 id="CCAPP-GUID-C9175A31-89FE-4B66-99A5-D60E6E7C4EB6" class="sect5"><span class="enumeration_section">A.2.3.2</span> loader.dat</h5>
                     <div>
                        <div class="section">
                           <p>此示例显示了一个示例<code class="codeph">loader.dat</code>文件。每行包含三个字段：文档的引用号，标签（或“标题”），以及要加载到<code class="codeph">search_table.</code>的文本列中的HTML文档的名称<code class="codeph">search_table.</code> 该示例已截断该文件。
                           </p><pre class="oac_no_warn" dir="ltr">1; Pizza Shredder; Pizza.html 2;冰箱带前门自动哈密瓜饮水机; Cantaloupe.html 3; Self-Tipping Couch; Couch.html 4; Home Air Dirtier; Mess.html 5;一套宠物磁铁; Pet.html 6; Esteem-Building Talking Pillow; Snooze.html</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="CCAPP9668"></a><a id="CCAPP9669"></a><a id="CCAPP9670"></a><a id="CCAPP9671"></a><a id="CCAPP9672"></a><a id="CCAPP9673"></a><a id="CCAPP9674"></a><a id="CCAPP9667"></a><div class="props_rev_3"><a id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382" name="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382"></a><h5 id="CCAPP-GUID-19B22A53-0B88-483E-9909-49EC1FAF1382" class="sect5"><span class="enumeration_section">A.2.3.3 loader.dat的</span> HTML文件示例</h5>
                     <div>
                        <p>这里包含了命名并加载到<code class="codeph">loader.dat</code>中的HTML文件，供您参考，如下所示：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="CONTEXT-query-application.html#GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIADFIGC">Pizza.html</a></p>
                           </li>
                           <li>
                              <p><a href="CONTEXT-query-application.html#GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIABDAHF">Cantaloupe.html</a></p>
                           </li>
                           <li>
                              <p><a href="CONTEXT-query-application.html#GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIAFFBAB">Couch.html</a></p>
                           </li>
                           <li>
                              <p><a href="CONTEXT-query-application.html#GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIADDBJJ">Mess.html</a></p>
                           </li>
                           <li>
                              <p><a href="CONTEXT-query-application.html#GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIAHJBBD">Pet.html</a></p>
                           </li>
                           <li>
                              <p><a href="CONTEXT-query-application.html#GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIADIEFD">Snooze.html</a></p>
                           </li>
                        </ul>
                        <div class="section" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIADFIGC">
                           <p class="subhead3" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__GUID-33B5C08D-1D1E-4BD2-9333-7FD27846FCC1">Pizza.html</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">&lt;html&gt; &lt;header&gt; &lt;title&gt;披萨碎纸机&lt;/ title&gt; &lt;/ header&gt; &lt;body&gt; &lt;h2&gt;披萨碎纸机&lt;/ h2&gt; &lt;h4&gt;保持披萨首选项安全&lt;/ h4&gt;所以这是结束一个漫长的夜晚。啤酒已经喝醉了，披萨已被吃掉。&lt;p&gt;但是剩下的比萨饼 - 你打算用它做什么？&lt;p&gt;你可以在早上保存它，或者你可以把它喂给你的宠物。但如果这些都没有吸引力（也许你没有宠物？）然后你会把它扔进垃圾桶。&lt;p&gt;但是等一下 - 任何人都可以看看你的垃圾，弄清楚你吃的是什么样的披萨！“没什么大不了的，”我听到你说。但它是！在他们发现你最喜欢的比萨饼是意大利辣香肠之后，只需要一小段时间来确定你的绝密网上银行密码是“pepperoni_pizza”。 &lt;p&gt;使用我们新的正在申请专利的“Mk III Pizza Shredder”，在垃圾箱潜水员身上找到一个。横切刀片确保您的披萨变得不可读，并且没有人能够识别原始配料。也兼作莴苣切碎机，也可用于去除不需要的指尖。&lt;h2&gt;模型比较&lt;/ h2&gt; &lt;table border =“1”&gt; &lt;tr&gt; &lt;th&gt;模型&lt;/ th&gt; &lt;th&gt; Blades0 &lt;/ th&gt; &lt;th&gt;披萨厚度&lt;/ th&gt; &lt;th&gt;价格&lt; / th&gt; &lt;/ tr&gt; &lt;tr&gt; &lt;td&gt; Mk I &lt;/ td&gt; &lt;td&gt;塑料&lt;/ td&gt; &lt;td&gt; 1/2英寸（薄皮）&lt;/ td&gt; &lt;$ 69.99 &lt;/ td&gt; &lt;/ tr&gt; &lt;tr&gt; &lt;td&gt; Mk II &lt;/ td&gt; &lt;td&gt;黄铜&lt;/ td&gt; &lt;td&gt; 1英寸（深盘）&lt;/ td&gt; &lt;td&gt; $ 99.99 &lt;/ td&gt; &lt;/ tr&gt; &lt; tr&gt; &lt;td&gt; Mk III &lt;/ td&gt; &lt;td&gt;碳钢&lt;/ td&gt; &lt;td&gt; 2英寸（Calzoni）&lt;/ td&gt; &lt;td&gt; $ 129.99 &lt;/ td&gt; &lt;/ tr&gt; &lt;/ table&gt; &lt;/ body&gt; &lt;/ html&gt;</pre></div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIABDAHF">
                           <p class="subhead3" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__GUID-D36AB4E7-152C-4078-8767-C8421B294D2D">Cantaloupe.html</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">&lt;html&gt; &lt;header&gt; &lt;title&gt;带有哈密瓜饮水机的冰箱&lt;/ title&gt; &lt;/ header&gt; &lt;body&gt; &lt;h2&gt;带有哈密瓜饮水机的冰箱&lt;/ h2&gt; &lt;h4&gt;一个不错的冷瓜。一个按钮&lt;/ h4&gt;你的冰箱门里只有一个无聊的饮水机吗？&lt;p&gt;当你渴望哈密瓜时，你是否需要花费宝贵的能量打开冰箱门并在半包装的宠物食品中钓鱼？&lt;p&gt;你的朋友是否抱怨他们希望从冰箱里拿出哈密瓜有一种轻松的方法？你是否听到他们说他们已经厌倦了总是不得不翻找你发霉的剩饭和密封餐来到冷瓜？&lt;p&gt;您需要的是内置哈密瓜分配器的便利性。&lt;p&gt;给你的朋友留下深刻印象。赢得邻居的赞扬。成为传奇主持人！&lt;p&gt; &lt;b&gt;试试我们新推出的&lt;i&gt; Melonic 2000 &lt;/ i&gt;模型！&lt;/ b&gt; &lt;p&gt;也适用于蜜露和小型crenshaws。&lt;p&gt;让&lt;i&gt; Melonic 2000 &lt;/ i&gt;为你工作。立即在当地商店订购一个。&lt;/ body&gt; &lt;/ html&gt;</pre></div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIAFFBAB">
                           <p class="subhead3" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__GUID-9C11CD5F-2665-41EB-B3C4-981C16145826">Couch.html</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">&lt;html&gt; &lt;header&gt; &lt;title&gt; The Self-Tipping Couch &lt;/ title&gt; &lt;/ header&gt; &lt;body&gt; &lt;h2&gt; Self-Tipping Couch &lt;/ h2&gt; &lt;h4&gt;有时离开沙发很难/ h4&gt; &lt;p&gt;有时候让你的伴侣或宠物离开沙发很难。&lt;p&gt; &lt;b&gt; Self-Tipping Couch &lt;/ b&gt;为您解决了这些问题。只需按一下按钮，它就会将沙发的内容物放在前面的地板上。&lt;p&gt; &lt;b&gt; Self-Tipping Couch &lt;/ b&gt;已被证明可以促进与顽固的配偶，子女和亲属的沟通。&lt;p&gt;你永远不会再大叫，“离开沙发！“只需按一下按钮，所有那些沙发慢跑者就会轻轻地甩到你的地毯上。&lt;p&gt;立即获取您自己的&lt;b&gt; Self-Tipping Couch &lt;/ b&gt;！&lt;/ body&gt; &lt;/ html&gt;</pre></div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIADDBJJ">
                           <p class="subhead3" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__GUID-66105F44-D4CD-4B2A-8B8A-3EE6EFEC87C2">Mess.html</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">&lt;html&gt; &lt;header&gt; &lt;title&gt; Home Air Dirtier &lt;/ title&gt; &lt;/ header&gt; &lt;body&gt; &lt;h2&gt; Home Air Dirtier &lt;/ h2&gt; &lt;h4&gt;在城市中心想念您的家？&lt;/ h4&gt; &lt;p&gt;像许多前城市居民一样，你可能会发现农村的空气太干净了。&lt;p&gt;您现在可以使用&lt;i&gt; UltraAppliance &lt;/ i&gt; &lt;b&gt; Home Air Dirtier &lt;/ b&gt;解决此问题。&lt;p&gt;只需插入我们的专利&lt;i&gt; CityFilth &lt;/ i&gt;墨盒，很快您就会享受到您家中常用的车辆烟雾和腐烂垃圾的香气。&lt;p&gt; &lt;b&gt;请注意：&lt;/ b&gt;腐烂的垃圾味可能会让您的宠物感到困惑。无论他多么狩猎，他都无法找到他能闻到的垃圾。如果这是一个问题，我们建议为您的环境添加真正的垃圾。&lt;/ body&gt; &lt;/ html&gt;</pre></div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIAHJBBD">
                           <p class="subhead3" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__GUID-641EA50F-16B0-4319-89E7-B2DA86514E99">Pet.html</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">&lt;html&gt; &lt;header&gt; &lt;title&gt;宠物磁铁&lt;/ title&gt; &lt;/ header&gt; &lt;body&gt; &lt;h2&gt;宠物磁铁&lt;/ h2&gt; &lt;h4&gt;每个宠物主人都喜欢让他或她的宠物自由奔跑，但是这并不总是可能&lt;/ h4&gt; &lt;p&gt;有时当地法律规定宠物必须穿着皮带。有时，一只自由漫游的宠物会破坏一张花坛，在人行道上留下一张“电话卡”，或者咀嚼另一只宠物。对于非常聪明的宠物，如黑猩猩或海豚，无人看管的宠物可能会逃脱，并在手机上收取数百美元的长途费用。&lt;p&gt;但皮带并不总是一个实际的答案。它们可能过于狭窄，或者太大，或者可能会在宠物的脖子上不舒服地拉扯。它们可能缠结在一起，或缠绕在杆子或路人身上。宠物可以通过皮带咀嚼，或者，在非常聪明的宠物的情况下，用乙炔火炬燃烧它。在猫的情况下，皮带看起来很荒谬，好像宠物主人真的想拥有一只狗，但在宠物商店感到困惑。&lt;p&gt;来自&lt;i&gt; UltraAppliance &lt;/ i&gt;的&lt;b&gt; Hold'Em 2000 Pet Magnet &lt;/ b&gt;就是答案。&lt;b&gt; Hold'Em 2000 Pet Magnet &lt;/ b&gt;不是老式的牵引带，而是以人性化和简单的方式控制您的宠物。&lt;p&gt;这是它的工作原理。几十个小磁铁放在宠物的外套下面，在那里它们可以无痛地看不见。任何时候你需要召回你的动物，你只需要激活方便，大量的Hold'Em 2000宠物磁铁电磁铁（适合任何极度超大的钱包），你的宠物将被轻轻无痛地拖到100码以上。对于任何宠物主人来说都是必备品！&lt;p&gt; &lt;blockquote&gt; &lt;i&gt;“&lt;b&gt; Hold'Em 2000 Pet Magnet &lt;/ b&gt;不仅让我的狗不会逃跑，而且如果我需要找到一根针，电磁铁也非常方便haystack“&lt;/ i&gt;  -  Anonymous Celebrity &lt;/ blockquote&gt; &lt;/ body&gt; &lt;/ html&gt;</pre></div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__CIADIEFD">
                           <p class="subhead3" id="GUID-19B22A53-0B88-483E-9909-49EC1FAF1382__GUID-E18900F8-5F54-4D95-8762-10FFD019F719">Snooze.html</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">&lt;html&gt; &lt;header&gt; &lt;title&gt;尊重建设会说话的枕头&lt;/ title&gt; &lt;/ header&gt; &lt;body&gt; &lt;h2&gt;尊重建设会说话的枕头&lt;/ h2&gt; &lt;h4&gt;当你感觉不到自己真正的潜力时早上醒来？&lt;/ h4&gt; &lt;p&gt;我们寻找一种方法来捕捉浪费的睡眠时间，并利用这宝贵的时间来建立动力，性格和自尊。&lt;p&gt;我们很自豪地宣布&lt;b&gt;尊重建设会说话的枕头&lt;/ b&gt;。我们对这个奇妙发明的骄傲更加发光，因为：&lt;i&gt;我们每晚都使用自己的发明！&lt;/ i&gt; &lt;p&gt;只有你知道你正在和&lt;b&gt;尊重建设说话枕头&lt;/ b&gt;睡觉，因为只有你能听到通过谨慎的说话者轻轻进入你大脑的舒缓肯定。&lt;p&gt;你会醒来时精神焕发，为自己带来的任何任务带来新的自豪感和热情。&lt;p&gt;成为第一个拥有&lt;b&gt; Esteem-building Talking Pillow &lt;/ b&gt;的人！当你不再在拐角处畏缩时，你的朋友和同事会感到惊讶。现在你将加入每一次谈话。&lt;p&gt; &lt;b&gt;免责声明：&lt;/ b&gt;不对自恋和hyberbolic声明负责。过度使用可能会导致极端行为。&lt;/ body&gt; &lt;/ html&gt;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="CCAPP9378"></a><div class="props_rev_3"><a id="GUID-6F1889D2-689F-4548-8B0A-D6ED37ECC092" name="GUID-6F1889D2-689F-4548-8B0A-D6ED37ECC092"></a><h5 id="CCAPP-GUID-6F1889D2-689F-4548-8B0A-D6ED37ECC092" class="sect5"><span class="enumeration_section">A.2.3.4</span> search_htmlservices.sql</h5>
                     <div>
                        <div class="section"><pre class="oac_no_warn" dir="ltr">set define off创建或替换包search_htmlServices作为过程showHTMLDoc（p_id in numeric）; procedure showDoc（varchar2中的p_id，varchar2中的p_query）; end search_htmlServices; /显示错误;创建或替换包体search_htmlServices作为过程showHTMLDoc（p_id in numeric）是v_clob_selected CLOB; v_read_amount整数; v_read_offset整数; v_buffer varchar2（32767）;从search_table开始选择文本到v_clob_selected，其中tk = p_id; v_read_amount：= 32767; v_read_offset：= 1; begin loop dbms_lob.read（v_clob_selected，v_read_amount，v_read_offset，v_buffer）; htp.print（v_buffer）; v_read_offset：= v_read_offset + v_read_amount; v_read_amount：= 32767;结束循环;当no_data_found为null时异常;结束;结束showHTMLDoc;过程showDoc（varchar2中的p_id，varchar2中的p_query）是v_clob_selected CLOB; v_read_amount整数; v_read_offset整数; v_buffer varchar2（32767）; v_query varchar（2000）; v_cursor整数;开始htp.p（'&lt;html&gt; &lt;title&gt;带有突出显示的术语&lt;/ title&gt;'的HTML版本）; htp.p（'&lt;body bgcolor =“＃ffffff”&gt;'）; htp.p（'&lt;b&gt;带有突出显示的术语的HTML版本&lt;/ b&gt;'）;开始ctx_doc.markup（index_name =&gt;'idx_search_table'，textkey =&gt; p_id，text_query =&gt; p_query，restab =&gt; v_clob_selected，starttag =&gt;'&lt;i&gt; &lt;font color = red&gt;'，endtag =&gt;'&lt;/ font&gt; &lt;/ i&gt;的'）; v_read_amount：= 32767; v_read_offset：= 1; begin loop dbms_lob.read（v_clob_selected，v_read_amount，v_read_offset，v_buffer）; htp.print（v_buffer）; v_read_offset：= v_read_offset + v_read_amount; v_read_amount：= 32767;结束循环;当no_data_found为null时异常;结束;当别人为空时的异常; --showHTMLdoc（P_ID）;结束;结束showDoc; end search_htmlServices; / show errors set define on</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="CCAPP9379"></a><div class="props_rev_3"><a id="GUID-B82F1C3B-2EAC-4036-9584-ED7384D9CB80" name="GUID-B82F1C3B-2EAC-4036-9584-ED7384D9CB80"></a><h5 id="CCAPP-GUID-B82F1C3B-2EAC-4036-9584-ED7384D9CB80" class="sect5"><span class="enumeration_section">A.2.3.5</span> search_html.psp</h5>
                     <div>
                        <div class="section"><pre class="oac_no_warn" dir="ltr">&lt;％@ plsql procedure =“search_html”％&gt; &lt;％@ plsql parameter =“query”default =“null”％&gt; &lt;％！v_results number：= 0; ％&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt; search_html搜索&lt;/ title&gt; &lt;/ head&gt; &lt;body&gt; &lt;％IF查询IS NULL THEN％&gt; &lt;center&gt; &lt;form method =“post”action =“search_html”&gt; &lt; b&gt;搜索：&lt;/ b&gt; &lt;input type =“text”name =“query”size =“30”&gt;＆nbsp; &lt;input type =“submit”value =“搜索”&gt; &lt;/ center&gt; &lt;hr&gt; &lt;％ELSE％&gt; &lt;p&gt; &lt;％！color varchar2（6）：='ffffff'; ％&gt; &lt;center&gt; &lt;form method =“post”action =“search_html”&gt; &lt;b&gt;搜索：&lt;/ b&gt; &lt;input type =“text”name =“query”size =“30”value =“&lt;％ = query％&gt;“&gt; &lt;input type =”submit“value =”Search“&gt; &lt;/ form&gt; &lt;/ center&gt; &lt;hr&gt; &lt;p&gt; &lt;％ - 选择语句FOR DOC IN（SELECT / * + DOMAIN_INDEX_SORT * / rowid，tk，title，score（1）scr FROM search_table WHERE CONTAINS（text，query，1）&gt; 0 ORDER BY score（1）DESC）LOOP v_results：= v_results + 1; IF v_results = 1 THEN％&gt; &lt;center&gt; &lt;table border =“0”&gt; &lt;tr bgcolor =“＃6699CC”&gt; &lt;th&gt;得分&lt;/ th&gt; &lt;th&gt;标题&lt;/ th&gt; &lt;/ tr&gt; &lt;％END如果; ％&gt; &lt;tr bgcolor =“＃&lt;％= color％&gt;”&gt; &lt;td&gt; &lt;％= doc.scr％&gt;％&lt;/ td&gt; &lt;td&gt; &lt;％= doc.title％&gt; [&lt;a href =“search_htmlServices .showHTMLDoc？p_id = &lt;％= doc.tk％&gt;“&gt; HTML &lt;/a&gt;] [&lt;a href =”search_htmlServices.showDoc？p_id = &lt;％= doc.tk％&gt;＆p_query = &lt;％=查询％&gt;“&gt;突出显示&lt;/a&gt;] &lt;/ td&gt; &lt;/ tr&gt; &lt;％IF（color ='ffffff'）那么颜色：='eeeeee '; ELSE color：='ffffff'; END IF; END LOOP;％&gt; &lt;/ table&gt; &lt;/ center&gt; &lt;％END IF;％&gt; &lt;/ body&gt; &lt;/ html&gt;</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="CCAPP9380"></a><div class="props_rev_3"><a id="GUID-DEABF1DC-7C2E-436D-A83F-D036260B0B32" name="GUID-DEABF1DC-7C2E-436D-A83F-D036260B0B32"></a><h3 id="CCAPP-GUID-DEABF1DC-7C2E-436D-A83F-D036260B0B32" class="sect3"><span class="enumeration_section">A.3</span> Java Server Pages（JSP）Web应用程序</h3>
               <div>
                  <p>创建基于JSP的Web应用程序涉及与构建基于PSP的应用程序中使用的大多数步骤相同的步骤。有关更多信息，请参阅<span class="q">“ <a href="CONTEXT-query-application.html#GUID-03558FFB-EFEF-4B43-92CA-E9ABB5EC0E6B">构建PSP Web应用程序</a> ”</span> 。您可以使用相同的<code class="codeph">loader.dat</code>和<code class="codeph">loader.ctl</code>文件。但是，使用基于JSP的应用程序，您不需要执行以下操作：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>编译<code class="codeph">search_htmlservices</code>包</p>
                     </li>
                     <li>
                        <p>编译<code class="codeph">search_html</code>与PSP页<code class="codeph">loadpsp</code></p>
                     </li>
                  </ul>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="CONTEXT-query-application.html#GUID-3749D0FF-0B93-4224-AD99-0AC17FDF4A01">JSP Web应用程序先决条件</a></p>
                     </li>
                     <li>
                        <p><a href="CONTEXT-query-application.html#GUID-CC35F085-B0A1-450D-B5C5-1E16C747AF0A">JSP Web应用程序示例代码</a></p>
                     </li>
                  </ul>
               </div><a id="CCAPP9381"></a><div class="props_rev_3"><a id="GUID-3749D0FF-0B93-4224-AD99-0AC17FDF4A01" name="GUID-3749D0FF-0B93-4224-AD99-0AC17FDF4A01"></a><h4 id="CCAPP-GUID-3749D0FF-0B93-4224-AD99-0AC17FDF4A01" class="sect4"><span class="enumeration_section">A.3.1</span> JSP Web应用程序先决条件</h4>
                  <div>
                     <p>JSP Web应用程序具有以下要求：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>您的Oracle数据库必须已启动并正在运行。</p>
                        </li>
                        <li>
                           <p>您有一个Web服务器，例如Apache Tomcat，它可以运行使用Java数据库连接（JDBC）连接到Oracle数据库的JavaServer Pages（JSP）脚本。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-3749D0FF-0B93-4224-AD99-0AC17FDF4A01__GUID-0BB76621-754C-47F3-B3BD-A0AE6787D5CC">
                        <p class="notep1">也可以看看：</p>
                        <p>有关安装Apache HTTP Server的信息，请参阅<span class="italic">Oracle Database 2 Day + PHP Developer's Guide</span></p>
                     </div>
                  </div>
               </div><a id="CCAPP9382"></a><div class="props_rev_3"><a id="GUID-CC35F085-B0A1-450D-B5C5-1E16C747AF0A" name="GUID-CC35F085-B0A1-450D-B5C5-1E16C747AF0A"></a><h4 id="CCAPP-GUID-CC35F085-B0A1-450D-B5C5-1E16C747AF0A" class="sect4"><span class="enumeration_section">A.3.2</span> JSP Web应用程序示例代码</h4>
                  <div>
                     <p>本节列出了用于构建示例Web应用程序的Java代码，如<code class="codeph">TextSearchApp.jsp</code>文件中所示。
                     </p><pre class="oac_no_warn" dir="ltr">&lt;％@ page language =“java”pageEncoding =“utf-8”contentType =“text / html; charset = utf-8”％&gt; &lt;％@ page import =“java.sql。*，java.util。*， java.net。*，oracle.jdbc。*，oracle.sql。*，oracle.jsp.dbutil。*“％&gt; &lt;％//更改这些详细信息以适合您的数据库和用户详细信息String connStr =”jdbc：oracle：thin：@ / / servername：1521 / pdb1“; String dbUser =”scott“; String dbPass =”tiger“; //我们运行查询的表称为SEARCH_TABLE。//它必须有列：// tk number主键， （主键对文档服务很重要）// title varchar2（2000），// text clob //文本列request.setCharacterEncoding（“UTF-8”）; java.util上必须有一个名为IDX_SEARCH_TABLE的CONTEXT索引。属性info = new java.util。属性（）;连接conn = null; ResultSet rset = null; OracleCallableStatement callStmt = null;语句stmt = null; String userQuery = null; String myQuery = null; String action = null; String theTk = null; URLEncoder myEncoder; int count = 0; int loopNum = 0; int startNum = 0; userQuery = request.getParameter（“query”）; action = request.getParameter（“action”）; theTk = request.getParameter（“tk”）; if（action == null）action =“”; //连接数据库try {DriverManager.registerDriver（new oracle.jdbc.driver。OracleDriver（））; info.put（“user”，dbUser）; info.put（“password”，dbPass）; conn = DriverManager.getConnection（connStr，info）; } catch（SQLException e）{％&gt; &lt;b&gt;错误：&lt;/ b&gt; &lt;％= e％&gt; &lt;p&gt; &lt;％} if（action.equals（“doHTML”））{//直接显示文本文件try {//没有尝试共享此示例的输出表，我们将在每次conn.createStatement（）。execute（“truncate table OUTPUT_TABLE”）时截断它; String sql =“{call ctx_doc.filter（index_name =&gt;'IDX_SEARCH_TABLE'，textkey =&gt;'”+ theTk +“'，restab =&gt;'OUTPUT_TABLE'，plaintext =&gt; false）}”; PreparedStatement s = conn.prepareCall（sql）; s.execute（）; sql =“从output_table中选择文档，其中rownum = 1”; stmt = conn.createStatement（）; rset = stmt.executeQuery（sql）; rset.next（）; oracle.sql。CLOB res =（oracle.sql。CLOB）rset.getClob（1）; //应该从clob中逐段取出，但为了保持简单，我们只需要将32K取到字符串String txt = res.getSubString（1,32767）;通过out.println（TXT）; } catch（SQLException e）{％&gt; &lt;b&gt;错误：&lt;/ b&gt; &lt;％= e％&gt; &lt;p&gt; &lt;％}}否则if（action.equals（“doHighlight”））{//显示文本从“标记”功能突出显示的文档尝试{//不尝试共享此示例的输出表，我们将在每次conn.createStatement（）。execute（“truncate table OUTPUT_TABLE”）时截断它; String sql =“{call ctx_doc.markup（index_name =&gt;'IDX_SEARCH_TABLE'，textkey =&gt;'”+ theTk +“'，text_query =&gt;'”+ userQuery +“'，restab =&gt;'OUTPUT_TABLE'，plaintext =&gt; false ，starttag =&gt;'&lt;i&gt; &lt;font color = \“red \”&gt;'，endtag =&gt;'&lt;/ font&gt; &lt;/ i&gt;'）}“; PreparedStatement s = conn.prepareCall（sql）; s.execute（）; sql =“从output_table中选择文档，其中rownum = 1”; stmt = conn.createStatement（）; rset = stmt.executeQuery（sql）; rset.next（）; oracle.sql。CLOB res =（oracle.sql。CLOB）rset.getClob（1）; //应该从clob中逐段取出，但为了保持简单，我们只需要将32K取到字符串String txt = res.getSubString（1,32767）;通过out.println（TXT）; } catch（SQLException e）{％&gt; &lt;b&gt;错误：&lt;/ b&gt; &lt;％= e％&gt; &lt;p&gt; &lt;％}}否则if（action.equals（“doThemes”））{//显示文本从“标记”函数突出显示的文件尝试{//不尝试共享此示例的输出表，我们将在每次conn.createStatement（）。execute（“truncate table THEME_TABLE”）时截断它; String sql =“{call ctx_doc.themes（index_name =&gt;'IDX_SEARCH_TABLE'，textkey =&gt;'”+ theTk +“'，restab =&gt;'THEME_TABLE'）}”; PreparedStatement s = conn.prepareCall（sql）; s.execute（）; sql =“select * from（select theme，weight from theme_table order by weight desc）其中rownum &lt;= 20”; stmt = conn.createStatement（）; rset = stmt.executeQuery（sql）; int weight = 0; String theme =“”; ％&gt; &lt;h2&gt;文档的前20个主题&lt;/ h2&gt; &lt;table BORDER = 1 CELLSPACING = 0 CELLPADDING = 0“&lt;tr bgcolor =”＃CCCC99“&gt; &lt;th&gt; &lt;font face =”arial“color =” ＃336699“&gt;主题&lt;/ th&gt; &lt;th&gt; &lt;font face =”arial“color =”＃336699“&gt;权重&lt;/ th&gt; &lt;/ tr&gt; &lt;％while（rset.next（））{theme = rset。 getString（1）; weight =（int）rset.getInt（2）;％&gt; &lt;tr bgcolor =“ffffe0”&gt; &lt;td align =“center”&gt; &lt;font face =“arial”&gt; &lt;b&gt; &lt;％= theme ％&gt; &lt;/ b&gt; &lt;/ font&gt; &lt;/ td&gt; &lt;td align =“center”&gt; &lt;font face =“arial”&gt; &lt;％=重量％&gt; &lt;/ font&gt; &lt;/ td&gt; &lt;/ tr&gt; &lt;％ }％&gt; &lt;/ table&gt; &lt;％} catch（SQLException e）{％&gt; &lt;b&gt;错误：&lt;/ b&gt; &lt;％= e％&gt; &lt;p&gt; &lt;％}}否则if（action.equals（“doGists”） ））{//显示文档的文本，突出显示“标记”功能try {//不尝试共享此示例的输出表，我们将在每次conn.createStatement（）执行时截断它（“ truncate table GIST_TABLE“）; String sql =”{call ctx_doc.gist（index_name =&gt;'IDX_SEARCH_TABLE'，textkey =&gt;'“+ theTk +”'，restab =&gt;'GIST_TABLE'，query_id =&gt; 1）}“; PreparedStatement s = conn.prepar eCall（sql）; s.execute（）; sql =“select pov，gist from gist_table，其中pov ='GENERIC'和query_id = 1”; stmt = conn.createStatement（）; rset = stmt.executeQuery（sql）; String pov =“”; String gist =“”; while（rset.next（））{pov = rset.getString（1）; oracle.sql。CLOB gistClob =（oracle.sql。CLOB）rset.getClob（2）; out.println（“&lt;h3&gt;文档要点为观点：”+ pov +“&lt;/ h3&gt;”）; gist = gistClob.getSubString（1,32767）;通过out.println（GIST）; }％&gt; &lt;/ table&gt; &lt;％} catch（SQLException e）{％&gt; &lt;b&gt;错误：&lt;/ b&gt; &lt;％= e％&gt; &lt;p&gt; &lt;％}} if（（action.equals（“”） ）&amp;&amp;（（userQuery == null）||（userQuery.length（）== 0）））{％&gt; &lt;html&gt; &lt;title&gt;文本搜索&lt;/ title&gt; &lt;body&gt; &lt;table width =“100％”&gt; &lt;tr bgcolor =“＃336699”&gt; &lt;td&gt; &lt;font face =“arial”align =“left”color =“＃CCCC99”size =“+ 2”&gt;文字搜索&lt;/ td&gt; &lt;/ tr&gt; &lt;/ table &gt; &lt;center&gt; &lt;form method = post&gt;搜索：&lt;input type =“text”name =“query”size =“30”&gt; &lt;input type =“submit”value =“Search”&gt; &lt;/ form&gt; &lt;/中心&gt; &lt;/ body&gt; &lt;/ html&gt; &lt;％}否则if（action.equals（“”））{％&gt; &lt;html&gt; &lt;title&gt;文本搜索结果页面&lt;/ title&gt; &lt;body text =“＃000000”bgcolor =“＃FFFFFF”link =“＃663300”vlink =“＃996633”alink =“＃ff6600”&gt; &lt;table width =“100％”&gt; &lt;tr bgcolor =“＃336699”&gt; &lt;td&gt; &lt;font face =“ arial“align =”left“color =”＃CCCC99“size = + 2&gt; Text Search &lt;/ td&gt; &lt;/ tr&gt; &lt;/ table&gt; &lt;center&gt; &lt;form method = post action =”TextSearchApp.jsp“&gt;搜索：&lt;input type = text name =“query”value =“&lt;％= userQuery％&gt;”size = 30&gt; &lt;input type = submit value =“Search”&gt; &lt;/ form&gt; &lt;/ center &gt; &lt;％myQuery = URLEncoder.encode（userQuery）; try {stmt = conn.createStatement（）; String numStr = request.getParameter（“sn”）;如果（numStr！= null）startNum = Integer.parseInt（numStr）; String theQuery = translate（userQuery）; callStmt =（OracleCallableStatement）conn.prepareCall（“begin”+“？：= ctx_query.count_hits（index_name =&gt;'IDX_SEARCH_TABLE'，”+“text_query =&gt;？“+”）; “+”结束; “）; callStmt.setString（2，theQuery）; callStmt.registerOutParameter（1，OracleTypes。数）; callStmt.execute（）;数=（（OracleCallableStatement）callStmt）.getNUMBER（1）.intValue（）; if（count&gt; =（startNum + 20））{％&gt; &lt;font color =“＃336699”FACE =“Arial”SIZE = + 1&gt;结果&lt;％= startNum + 1％&gt;  -  &lt;％= startNum + 20％&gt; &lt;％= count％&gt;匹配&lt;％}否则if（count&gt; 0）{％&gt; &lt;font color =“＃336699”FACE =“Arial”SIZE = + 1&gt;结果&lt;％= startNum + 1％&gt;  -  &lt; ％= count％&gt; &lt;％= count％&gt;匹配&lt;％} else {％&gt; &lt;font color =“＃336699”FACE =“Arial”SIZE = + 1&gt;找不到匹配项&lt;％}％&gt; &lt;table width = “100％”&gt; &lt;TR ALIGN =“RIGHT”&gt; &lt;％if（（startNum&gt; 0）＆（count &lt;= startNum + 20））{％&gt; &lt;TD ALIGN =“RIGHT”&gt; &lt;a href =“TextSearchApp。 JSP？sn = &lt;％= startNum-20％&gt;＆query = &lt;％= myQuery％&gt;“&gt; previous20 &lt;/a&gt; &lt;/ TD&gt; &lt;％}否则if（（count&gt; startNum + 20）＆（startNum == 0）） {％&gt; &lt;TD ALIGN =“RIGHT”&gt; &lt;a href =“TextSearchApp.jsp？sn = &lt;％= startNum + 20％&gt;＆query = &lt;％= myQuery％&gt;“&gt; next20 &lt;/a&gt; &lt;/ TD&gt; &lt;％}否则if（（count&gt; startNum + 20）＆（startNum&gt; 0））{ ％&gt; &lt;TD ALIGN =“RIGHT”&gt; &lt;a href =“TextSearchApp.jsp？sn = &lt;％= startNum-20％&gt;＆query = &lt;％= myQuery％&gt;“&gt; previous20 &lt;/a&gt; &lt;a href =”TextSearchApp.jsp？sn = &lt;％= startNum + 20％&gt;＆query = &lt;％= myQuery％&gt;“&gt; next20 &lt;/a&gt; &lt;/ TD&gt; &lt;％}％&gt; &lt;/ TR&gt; &lt;/ table&gt; &lt;％String ctxQuery =”select / * + FIRST_ROWS * /“+”tk，TITLE，score（1）scr，“+”ctx_doc.snippet（'IDX_SEARCH_TABLE'，tk，'“+ theQuery +”'）“+”来自search_table“+”其中包含（ TEXT，'“+ theQuery +”'，1）&gt; 0“+”order by score（1）desc“; rset = stmt.executeQuery（ctxQuery）; String tk = null; String [] colToDisplay = new String [1]; int myScore = 0; String snippet =“”; int items = 0; while（rset.next（）&amp;&amp; items &lt;20）{if（loopNum&gt; = startNum）{tk = rset.getString（1）; colToDisplay [0] = rset.getString（2）; myScore =（int）rset.getInt（3）; snippet = rset.getString（4）; items ++; if（items == 1）{％&gt; &lt;center&gt; &lt;table BORDER = 1 CELLSPACING = 0 CELLPADDING = 0 width =“100％”&lt;tr bgcolor =“＃CCCC99”&gt; &lt;th&gt; &lt;font face =“arial”color =“＃336699”&gt;得分&lt;/ th&gt; &lt;th&gt; &lt;font face =“arial “color =”＃336699“&gt; TITLE &lt;/ th&gt; &lt;th&gt; &lt;font face =”arial“color =”＃336699“&gt; Snippet &lt;/ th&gt; &lt;th&gt; &lt;font face =”arial“color =”＃336699 “&gt;文件服务&lt;/ th&gt; &lt;/ tr&gt; &lt;％ }％&gt; &lt;tr bgcolor =“＃FFFFE0”&gt; &lt;td ALIGN =“CENTER”&gt; &lt;％= myScore％&gt;％&lt;/ td&gt; &lt;td&gt; &lt;％= colToDisplay [0]％&gt; &lt;/ td&gt; &lt;td&gt; &lt;％= snippet％&gt; &lt;/ td&gt; &lt;td&gt; &lt;a href =“TextSearchApp.jsp？action = doHTML＆tk = &lt;％= tk％&gt;“&gt; HTML &lt;/a&gt;＆nbsp; &lt;a href =”TextSearchApp.jsp？action = doHighlight＆tk = &lt;％= tk％&gt;＆query = &lt;％= theQuery％&gt;“&gt;突出显示&lt;/a&gt;＆nbsp; &lt;a href =”TextSearchApp.jsp？action = doThemes＆tk = &lt;％= tk％&gt;＆query = &lt;％= theQuery％&gt;“&gt;主题&lt;/a&gt;＆nbsp; &lt;a href =”TextSearchApp.jsp？action = doGists＆tk = &lt;％= tk％&gt;“&gt; Gist &lt;/a&gt;＆nbsp; &lt;/ td&gt; &lt;/ tr&gt; &lt;％} loopNum ++;}} catch（SQLException e）{％&gt; &lt;b&gt;错误：&lt;/ b &gt; &lt;％= e％&gt; &lt;p&gt; &lt;％}终于{if（conn！= null）conn.close（）;如果（stmt！= null）stmt.close（）;如果（rset！= null）rset.close（）; }％&gt; &lt;/ table&gt; &lt;/ center&gt; &lt;table width =“100％”&gt; &lt;TR ALIGN =“RIGHT”&gt; &lt;％if（（startNum&gt; 0）＆（count &lt;= startNum + 20））{％&gt; &lt;TD ALIGN =“RIGHT”&gt; &lt;a href =“TextSearchApp.jsp？sn = &lt;％= startNum-20％&gt;＆query = &lt;％= myQuery％&gt;“&gt; previous20 &lt;/a&gt; &lt;/ TD&gt; &lt;％}否则if（（count&gt; startNum + 20）＆（startNum == 0）） {％&gt; &lt;TD ALIGN =“RIGHT”&gt; &lt;a href =“TextSearchApp.jsp？sn = &lt;％= startNum + 20％&gt;＆query = &lt;％= myQuery％&gt;“&gt; next20 &lt;/a&gt; &lt;/ TD&gt; &lt;％}否则if（（count&gt; startNum + 20）＆（startNum&gt; 0））{ ％&gt; &lt;TD ALIGN =“RIGHT”&gt; &lt;a href =“TextSearchApp.jsp？sn = &lt;％= startNum-20％&gt;＆query = &lt;％= myQuery％&gt;“&gt; previous20 &lt;/a&gt; &lt;a href =”TextSearchApp.jsp？sn = &lt;％= startNum + 20％&gt;＆query = &lt;％= myQuery％&gt;“&gt; next20 &lt;/a&gt; &lt;/ TD&gt; &lt;％}％&gt; &lt;/ TR&gt; &lt;/ table&gt; &lt;/ body&gt; &lt;/ html&gt; &lt;％}％&gt; &lt;％！public String translate（String input）{Vector reqWords = new Vector（）; StringTokenizer st = new StringTokenizer（input，“'”，true）; while（st.hasMoreTokens（））{String token = st.nextToken（）; if（token.equals（“'”））{String phrase = getQuotedPhrase（st）;如果（短语！= null）{reqWords.addElement（phrase）;如果（！）token.equals（“”））{reqWords.addElement（token）;返回getQueryString（reqWords）; private String getQuotedPhrase（StringTokenizer st）{StringBuffer phrase = new StringBuffer（）; String token = null; while（st.hasMoreTokens（）&amp;&amp;（！（token = st.nextToken（））。equals（“'”）））{phrase.append（token）; } return phrase.toString（）; private String getQueryString（Vector reqWords）{StringBuffer query = new StringBuffer（“”）; int length =（reqWords == null）？0：reqWords.size（）; for（int ii = 0; ii &lt;length; ii ++）{if（ii！）= 0）{query.append（“＆”）; } query.append（“{”）; query.append（reqWords.elementAt（II））; query.append（ “}”）; } return query.toString（）; }％&gt;</pre></div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>