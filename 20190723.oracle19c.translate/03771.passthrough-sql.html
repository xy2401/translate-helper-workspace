<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="The passthrough SQL feature enables you to send a statement directly to a non-Oracle system without first being interpreted by Oracle Database."></meta>
      <meta name="description" content="The passthrough SQL feature enables you to send a statement directly to a non-Oracle system without first being interpreted by Oracle Database."></meta>
      <title>Passthrough SQL</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Database Heterogeneous Connectivity User&#39;s Guide"></meta>
      <meta property="og:description" content="The passthrough SQL feature enables you to send a statement directly to a non-Oracle system without first being interpreted by Oracle Database."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Database Heterogeneous Connectivity User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="heterogeneous-connectivity-users-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-04-16T12:43:36-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2001, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96192-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="heterogeneous-replication.html" title="Previous" type="text/html"></link>
      <link rel="next" href="result-set-support.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Heterogeneous Connectivity User&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="HETER"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="heterogeneous-replication.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="result-set-support.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">数据库异构连接用户指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-database-gateways-features.html" property="item" typeof="WebPage"><span property="name">Oracle数据库网关的功能</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Passthrough SQL</li>
            </ol>
            <a id="GUID-C03895FB-EE60-4F71-8943-994C185C2EB2" name="GUID-C03895FB-EE60-4F71-8943-994C185C2EB2"></a><a id="HETER4049"></a>
            
            <h2 id="HETER-GUID-C03895FB-EE60-4F71-8943-994C185C2EB2" class="sect2">Passthrough SQL</h2>
         </header>
         <div class="ind">
            <div>
               <p>直通SQL功能使您可以直接将语句发送到非Oracle系统，而无需先由Oracle数据库进行解释。</p>
               <p><a id="d3480e33" class="indexterm-anchor"></a><a id="d3480e39" class="indexterm-anchor"></a><a id="d3480e45" class="indexterm-anchor"></a><a id="d3480e50" class="indexterm-anchor"></a>如果非Oracle系统允许在Oracle中没有等效语句的语句中进行操作，则此功能非常有用。
               </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="passthrough-sql.html#GUID-C9A8CC1A-ABB1-46F0-81C2-11C6014FC5DB">DBMS_HS_PASSTHROUGH包</a><br>您可以使用PL / SQL包<code class="codeph">DBMS_HS_PASSTHROUGH</code>直接在非Oracle系统上执行直通SQL语句。</li>
                  <li class="ulchildlink"><a href="passthrough-sql.html#GUID-3D0E0A6A-D3DA-46BD-88FD-A7A63BD74A4C">使用Passthrough SQL的含义</a><br>执行在非Oracle系统中隐式提交或回滚事务的直通SQL语句时，事务会受到影响。
                  </li>
                  <li class="ulchildlink"><a href="passthrough-sql.html#GUID-54AD0928-3148-43BA-8840-2661937F4C40">执行直通SQL语句</a><br>本节介绍<code class="codeph">DBMS_HS_PASSTHROUGH</code>程序包提供的功能和过程，使您可以执行直通SQL语句。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="oracle-database-gateways-features.html#GUID-13FD7B76-9463-4EE3-8DDA-13C1AA7C815C">Oracle数据库网关的功能</a></p>
                  </div>
               </div>
            </div>
            <a id="HETER4050"></a><div class="props_rev_3"><a id="GUID-C9A8CC1A-ABB1-46F0-81C2-11C6014FC5DB" name="GUID-C9A8CC1A-ABB1-46F0-81C2-11C6014FC5DB"></a><h3 id="HETER-GUID-C9A8CC1A-ABB1-46F0-81C2-11C6014FC5DB" class="sect3">DBMS_HS_PASSTHROUGH包</h3>
               <div>
                  <p>您可以使用PL / SQL包<code class="codeph">DBMS_HS_PASSTHROUGH</code>直接在非Oracle系统上执行直通SQL语句。</p>
                  <div class="section">
                     <p><a id="d3480e120" class="indexterm-anchor"></a>使用此包执行的任何语句都在与标准SQL语句相同的事务中执行。
                     </p>
                     <p><code class="codeph">DBMS_HS_PASSTHROUGH</code>包是一个虚拟包。它概念上位于非Oracle系统上。但实际上，对此程序包的调用被异构服务拦截并映射到一个或多个异构服务调用。然后，驱动程序将这些异构服务调用映射到非Oracle系统的API。客户端应用程序通过数据库链接调用包中的过程，其方式与调用非Oracle系统存储过程的方式相同。异构服务完成的特殊处理对用户是透明的。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-C9A8CC1A-ABB1-46F0-81C2-11C6014FC5DB__GUID-0175A0D7-6DB8-444A-90AD-20415B76B63B">
                     <p class="notep1">也可以看看：</p>
                     <p>有关此程序包的更多信息，请<a href="../arpls/DBMS_HS_PASSTHROUGH.html#ARPLS017" target="_blank"><span class="italic">参见Oracle Database PL / SQL程序包和类型参考</span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="passthrough-sql.html#GUID-C03895FB-EE60-4F71-8943-994C185C2EB2" title="直通SQL功能使您可以直接将语句发送到非Oracle系统，而无需先由Oracle数据库进行解释。">Passthrough SQL</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="HETER4051"></a><div class="props_rev_3"><a id="GUID-3D0E0A6A-D3DA-46BD-88FD-A7A63BD74A4C" name="GUID-3D0E0A6A-D3DA-46BD-88FD-A7A63BD74A4C"></a><h3 id="HETER-GUID-3D0E0A6A-D3DA-46BD-88FD-A7A63BD74A4C" class="sect3">使用Passthrough SQL的含义</h3>
               <div>
                  <p>执行在非Oracle系统中隐式提交或回滚事务的直通SQL语句时，事务会受到影响。</p>
                  <p><a id="d3480e168" class="indexterm-anchor"></a><a id="d3480e172" class="indexterm-anchor"></a>例如，某些系统隐式提交包含数据定义语言（DDL）语句的事务。由于Oracle数据库被绕过，Oracle数据库不知道事务是在非Oracle系统中提交的。因此，可以提交非Oracle系统中的数据，而Oracle数据库中的事务则不会。
                  </p>
                  <p>如果回滚Oracle数据库中的事务，则可能会发生Oracle数据库与非Oracle系统之间的数据不一致。这种情况导致<span class="bold">全局数据不一致。</span> 
                  </p>
                  <p>请注意，如果应用程序执行典型的<code class="codeph">COMMIT</code>语句，Oracle数据库可以协调分布式事务与非Oracle系统。使用passthrough工具执行的语句是分布式事务的一部分。
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="passthrough-sql.html#GUID-C03895FB-EE60-4F71-8943-994C185C2EB2" title="直通SQL功能使您可以直接将语句发送到非Oracle系统，而无需先由Oracle数据库进行解释。">Passthrough SQL</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="HETER4052"></a><div class="props_rev_3"><a id="GUID-54AD0928-3148-43BA-8840-2661937F4C40" name="GUID-54AD0928-3148-43BA-8840-2661937F4C40"></a><h3 id="HETER-GUID-54AD0928-3148-43BA-8840-2661937F4C40" class="sect3">执行直通SQL语句</h3>
               <div>
                  <p>本节介绍<code class="codeph">DBMS_HS_PASSTHROUGH</code>程序包提供的功能和过程，使您可以执行直通SQL语句。
                  </p>
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="tblformalwide" id="GUID-54AD0928-3148-43BA-8840-2661937F4C40__GUID-E8B4438F-A73B-43AF-875F-4E1E842A0A71">
                     <p class="titleintable">表3-1 DBMS_HS_PASSTHROUGH函数和过程</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="DBMS_HS_PASSTHROUGH函数和过程" width="100%" border="1" summary="This is a 2 column table describing the functions and procedures provided by the DBMS_HS_PASSTHROUGH package. Column 1 is the name of the function or procedure. Column 2 is a description of the function or procedure." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="39%" id="d3480e238">过程/函数</th>
                              <th align="left" valign="bottom" width="61%" id="d3480e241">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3480e246" headers="d3480e238 ">
                                 <p><code class="codeph">OPEN_CURSOR</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3480e246 d3480e241 ">
                                 <p>打开一个光标。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3480e254" headers="d3480e238 ">
                                 <p><code class="codeph">CLOSE_CURSOR</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3480e254 d3480e241 ">
                                 <p>关闭游标。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3480e262" headers="d3480e238 ">
                                 <p><code class="codeph">PARSE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3480e262 d3480e241 ">
                                 <p>解析声明。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3480e270" headers="d3480e238 ">
                                 <p><code class="codeph">BIND_VARIABLE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3480e270 d3480e241 ">
                                 <p>绑定<code class="codeph">IN</code>变量。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3480e281" headers="d3480e238 ">
                                 <p><code class="codeph">BIND_OUT_VARIABLE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3480e281 d3480e241 ">
                                 <p>绑定<code class="codeph">OUT</code>变量。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3480e292" headers="d3480e238 ">
                                 <p><code class="codeph">BIND_INOUT_VARIABLE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3480e292 d3480e241 ">
                                 <p>绑定<code class="codeph">IN OUT</code>变量。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3480e303" headers="d3480e238 ">
                                 <p><code class="codeph">EXECUTE_NON_QUERY</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3480e303 d3480e241 ">
                                 <p>执行非查询语句。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3480e311" headers="d3480e238 ">
                                 <p><code class="codeph">EXECUTE_IMMEDIATE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3480e311 d3480e241 ">
                                 <p>执行不带绑定变量的非查询语句。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3480e319" headers="d3480e238 ">
                                 <p><code class="codeph">FETCH_ROW</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3480e319 d3480e241 ">
                                 <p>从查询中获取行。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3480e327" headers="d3480e238 ">
                                 <p><code class="codeph">的get_value</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3480e327 d3480e241 ">
                                 <p>从<code class="codeph">SELECT</code>语句中检索列值或检索<code class="codeph">OUT</code>绑定参数。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="passthrough-sql.html#GUID-576AA232-B946-4C77-9A6F-037593614CFC">执行非查询</a><br>非查询包括语句<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>以及其他DDL类型的语句。
                     </li>
                     <li class="ulchildlink"><a href="passthrough-sql.html#GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59">执行查询</a><br>使用passthrough SQL执行查询。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="passthrough-sql.html#GUID-C03895FB-EE60-4F71-8943-994C185C2EB2" title="直通SQL功能使您可以直接将语句发送到非Oracle系统，而无需先由Oracle数据库进行解释。">Passthrough SQL</a></p>
                     </div>
                  </div>
               </div>
               <a id="HETER4053"></a><div class="props_rev_3"><a id="GUID-576AA232-B946-4C77-9A6F-037593614CFC" name="GUID-576AA232-B946-4C77-9A6F-037593614CFC"></a><h4 id="HETER-GUID-576AA232-B946-4C77-9A6F-037593614CFC" class="sect4">执行非查询</h4>
                  <div>
                     <p>非查询包括语句<code class="codeph">INSERT</code> ， <code class="codeph">UPDATE</code>和<code class="codeph">DELETE</code>以及其他DDL类型的语句。
                     </p>
                     <div class="section">
                        <p>执行<a id="d3480e409" class="indexterm-anchor"></a> nonquery语句，使用<code class="codeph">EXECUTE_IMMEDIATE</code>函数。例如，要在可以使用数据库链接<code class="codeph">salesdb</code>访问的非Oracle系统上执行DDL语句，请输入以下内容：</p><pre class="oac_no_warn" dir="ltr">DECLARE num_rows INTEGER; BEGIN num_rows：= DBMS_HS_PASSTHROUGH.EXECUTE_IMMEDIATE@salesdb（'CREATE TABLE dept1（n SMALLINT，loc CHARACTER（10））'）;结束;</pre><p>变量<span class="italic"><code class="codeph">num_rows</code></span>被分配了受执行语句影响的行数。对于DDL语句，返回零。请注意，您无法使用执行查询<a id="d3480e430" class="indexterm-anchor"></a> <code class="codeph">EXECUTE_IMMEDIATE</code>函数，您不能使用绑定变量。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="passthrough-sql.html#GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC">绑定变量概述</a><br>绑定变量允许您使用不同的值多次使用相同的SQL语句，从而减少了需要解析SQL语句的次数。
                        </li>
                        <li class="ulchildlink"><a href="passthrough-sql.html#GUID-16743824-9784-437E-9DCA-411EEE3D81C9">IN绑定变量</a><br>非Oracle系统的语法确定语句如何指定<code class="codeph">IN</code>绑定变量。
                        </li>
                        <li class="ulchildlink"><a href="passthrough-sql.html#GUID-D14E12B8-6433-434E-BF95-3E4F67FC0C07">OUT绑定变量</a><br>非Oracle系统可以支持<code class="codeph">OUT</code>绑定变量。
                        </li>
                        <li class="ulchildlink"><a href="passthrough-sql.html#GUID-C77A1E92-2FAF-4987-A3F5-412EBB8D21C0">IN OUT绑定变量</a><br>绑定变量既可以是<code class="codeph">IN</code>变量，也可以是<code class="codeph">OUT</code>变量。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="passthrough-sql.html#GUID-54AD0928-3148-43BA-8840-2661937F4C40" title="本节介绍DBMS_HS_PASSTHROUGH程序包提供的功能和过程，使您可以执行直通SQL语句。">执行直通SQL语句</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="HETER4055"></a><a id="HETER4054"></a><div class="props_rev_3"><a id="GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC" name="GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC"></a><h5 id="HETER-GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC" class="sect5">绑定变量概述</h5>
                     <div>
                        <p>绑定变量允许您使用不同的值多次使用相同的SQL语句，从而减少了需要解析SQL语句的次数。</p>
                        <p>例如，当你<a id="d3480e519" class="indexterm-anchor"></a>在表中插入四行，可以解析一次SQL语句，并为每一行绑定并执行SQL语句。一个SQL语句可以包含零个或多个绑定变量。
                        </p>
                        <p>执行<a id="d3480e526" class="indexterm-anchor"></a>使用绑定变量传递SQL语句，您必须：</p>
                        <ol>
                           <li>
                              <p>打开一个光标。</p>
                           </li>
                           <li>
                              <p>解析非Oracle系统上的SQL语句。</p>
                           </li>
                           <li>
                              <p>绑定变量。</p>
                           </li>
                           <li>
                              <p>在非Oracle系统上执行SQL语句。</p>
                           </li>
                           <li>
                              <p>关闭光标。</p>
                           </li>
                        </ol>
                        <p><a href="passthrough-sql.html#GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC__I1006184">图3-1</a>显示了使用绑定变量执行非查询的流程图。
                        </p>
                        <div class="figure" id="GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC__I1006184">
                           <p class="titleinfigure">图3-1 Nonquery Passthrough SQL的流程图</p><br><div class="imagecenter"><img class="imagecenter" src="img/heter007.gif" alt="下面是图3-1的描述" title="下面是图3-1的描述" longdesc="img_text/heter007.html"><br><a href="img_text/heter007.html">“图3-1 Nonquery Passthrough SQL流程图”的说明</a></div><br></div>
                        <!-- class="figure" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="passthrough-sql.html#GUID-576AA232-B946-4C77-9A6F-037593614CFC" title="非查询包括语句INSERT，UPDATE和DELETE以及其他DDL类型的语句。">执行非查询</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="HETER4056"></a><div class="props_rev_3"><a id="GUID-16743824-9784-437E-9DCA-411EEE3D81C9" name="GUID-16743824-9784-437E-9DCA-411EEE3D81C9"></a><h5 id="HETER-GUID-16743824-9784-437E-9DCA-411EEE3D81C9" class="sect5">IN绑定变量</h5>
                     <div>
                        <p>非Oracle系统的语法确定语句如何指定<code class="codeph">IN</code>绑定变量。
                        </p>
                        <p>例如， <a id="d3480e603" class="indexterm-anchor"></a>在Oracle系统上，您使用前面的冒号定义绑定变量。例如：</p><pre class="oac_no_warn" dir="ltr">...UPDATE emp SET sal = sal * 1.1 WHERE ename =：ename; ...
</pre><p>在此语句中<code class="codeph">,</code> <code class="codeph">ename</code>是绑定变量。在非Oracle系统上，您可能需要使用问号指定绑定变量。例如：</p><pre class="oac_no_warn" dir="ltr">...UPDATE emp SET sal = sal * 1.1 WHERE ename =？; ...
</pre><p>在绑定变量步骤中，必须将主机程序变量（在本例中为PL / SQL）与每个绑定变量进行位置关联。例如，要执行前面的语句，请使用以下PL / SQL程序：</p><pre class="oac_no_warn" dir="ltr">DECLARE c INTEGER; nr INTEGER; BEGIN c：= DBMS_HS_PASSTHROUGH.OPEN_CURSOR@salesdb; DBMS_HS_PASSTHROUGH.PARSE@salesdb（c，'UPDATE emp SET SAL = SAL * 1.1 WHERE ename =？“）; DBMS_HS_PASSTHROUGH.BIND_VARIABLE@salesdb（C，1， 'JONES'）; NR：=DBMS_HS_PASSTHROUGH.EXECUTE_NON_QUERY@salesdb（C）; DBMS_OUTPUT.PUT_LINE（nr ||'rows updated'）; DBMS_HS_PASSTHROUGH.CLOSE_CURSOR@salesdb（C）;结束;</pre></div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="passthrough-sql.html#GUID-576AA232-B946-4C77-9A6F-037593614CFC" title="非查询包括语句INSERT，UPDATE和DELETE以及其他DDL类型的语句。">执行非查询</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="HETER4057"></a><div class="props_rev_3"><a id="GUID-D14E12B8-6433-434E-BF95-3E4F67FC0C07" name="GUID-D14E12B8-6433-434E-BF95-3E4F67FC0C07"></a><h5 id="HETER-GUID-D14E12B8-6433-434E-BF95-3E4F67FC0C07" class="sect5">OUT绑定变量</h5>
                     <div>
                        <p>非Oracle系统可以支持<code class="codeph">OUT</code>绑定变量。
                        </p>
                        <p><a id="d3480e670" class="indexterm-anchor"></a><a id="d3480e676" class="indexterm-anchor"></a>使用<code class="codeph">OUT</code>绑定变量时，只有在执行SQL语句之后才能知道绑定变量的值。
                        </p>
                        <p>尽管在执行SQL语句后填充了<code class="codeph">OUT</code>绑定变量，但在执行SQL语句之前，非Oracle系统必须知道特定绑定变量是<code class="codeph">OUT</code>绑定变量。你必须使用<a id="d3480e690" class="indexterm-anchor"></a> <code class="codeph">BIND_OUT_VARIABLE</code>过程指定绑定变量是<code class="codeph">OUT</code>绑定变量。
                        </p>
                        <p>执行SQL语句后，您可以使用以下命令检索<code class="codeph">OUT</code>绑定变量的值<a id="d3480e703" class="indexterm-anchor"></a> <code class="codeph">GET_VALUE</code>程序。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="passthrough-sql.html#GUID-576AA232-B946-4C77-9A6F-037593614CFC" title="非查询包括语句INSERT，UPDATE和DELETE以及其他DDL类型的语句。">执行非查询</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="HETER4058"></a><div class="props_rev_3"><a id="GUID-C77A1E92-2FAF-4987-A3F5-412EBB8D21C0" name="GUID-C77A1E92-2FAF-4987-A3F5-412EBB8D21C0"></a><h5 id="HETER-GUID-C77A1E92-2FAF-4987-A3F5-412EBB8D21C0" class="sect5">IN OUT绑定变量</h5>
                     <div>
                        <p>绑定变量既可以是<code class="codeph">IN</code>变量，也可以是<code class="codeph">OUT</code>变量。
                        </p>
                        <p><a id="d3480e755" class="indexterm-anchor"></a>这意味着在执行SQL语句之前必须知道绑定变量的值，但是可以在执行SQL语句之后更改该值。
                        </p>
                        <p>对于<code class="codeph">IN OUT</code>绑定变量，必须使用<a id="d3480e767" class="indexterm-anchor"></a> <code class="codeph">BIND_INOUT_VARIABLE</code>过程在执行SQL语句之前提供值。执行SQL语句<span>后</span> ，您必须使用<code class="codeph">GET_VALUE</code>过程检索绑定变量的新值。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="passthrough-sql.html#GUID-576AA232-B946-4C77-9A6F-037593614CFC" title="非查询包括语句INSERT，UPDATE和DELETE以及其他DDL类型的语句。">执行非查询</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="HETER4060"></a><a id="HETER4059"></a><div class="props_rev_3"><a id="GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59" name="GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59"></a><h4 id="HETER-GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59" class="sect4">执行查询</h4>
                  <div>
                     <p>使用passthrough SQL执行查询。</p>
                     <div class="section">
                        <p><a id="d3480e829" class="indexterm-anchor"></a><a id="d3480e833" class="indexterm-anchor"></a>查询和非查询之间的区别在于查询从<code class="codeph">SELECT</code>语句中检索结果集。使用游标检索结果集。
                        </p>
                        <p><a href="passthrough-sql.html#GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59__I1006242">图3-2</a>说明了直通SQL查询中的步骤。在系统解析<code class="codeph">SELECT</code>语句之后，可以使用<code class="codeph">FETCH_ROW</code>过程检索结果集的每一行。检索行后，使用<code class="codeph">GET_VALUE</code>过程将选定的项列表检索到程序变量中。检索完所有行后，您可以关闭光标。
                        </p>
                        <div class="figure" id="GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59__I1006242">
                           <p class="titleinfigure">图3-2查询的Passthrough SQL</p><br><div class="imagecenter"><img class="imagecenter" src="img/heter008.gif" alt="下面是图3-2的描述" title="下面是图3-2的描述" longdesc="img_text/heter008.html"><br><a href="img_text/heter008.html">“图3-2查询的Passthrough SQL”的说明</a></div><br></div>
                        <!-- class="figure" -->
                        <p>您不必检索所有行。您可以在打开光标后随时关闭光标。</p>
                        <div class="infoboxnote" id="GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59__GUID-3596A8C9-7ED2-417B-89C8-BB594A7AFC00">
                           <p class="notep1">注意：</p>
                           <p>虽然您一次检索一行，但是异构服务<a id="d3480e865" class="indexterm-anchor"></a>优化Oracle数据库和非Oracle系统之间的往返<a id="d3480e870" class="indexterm-anchor"></a>缓冲<a id="d3480e875" class="indexterm-anchor"></a>在一次往返中对多行和从非Oracle数据系统中提取。
                           </p>
                        </div>
                        <p>以下示例执行查询：</p><pre class="oac_no_warn" dir="ltr">DECLARE val VARCHAR2（100）; c INTEGER; nr INTEGER; BEGIN c：= DBMS_HS_PASSTHROUGH.OPEN_CURSOR@salesdb; DBMS_HS_PASSTHROUGH.PARSE@salesdb（c，'从EMP中选择ETS，其中DEPTNO = 10'）; LOOP nr：= DBMS_HS_PASSTHROUGH.FETCH_ROW@salesdb（c）;当nr = 0时退出; DBMS_HS_PASSTHROUGH.GET_VALUE@salesdb（c，1，val）; DBMS_OUTPUT.PUT_LINE（VAL）;结束循环; DBMS_HS_PASSTHROUGH.CLOSE_CURSOR@salesdb（C）;结束;</pre><p>解析<code class="codeph">SELECT</code>语句后，将获取行并在循环中打印，直到<code class="codeph">FETCH_ROW</code>函数返回值<code class="codeph">0</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="passthrough-sql.html#GUID-54AD0928-3148-43BA-8840-2661937F4C40" title="本节介绍DBMS_HS_PASSTHROUGH程序包提供的功能和过程，使您可以执行直通SQL语句。">执行直通SQL语句</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>