<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="The XQuery language is one of the main ways that you interact with XML data in Oracle XML DB. Support for the language includes SQL*Plus commandXQUERY and SQL/XML functions XMLQuery, XMLTable, XMLExists, and XMLCast."></meta>
      <meta name="description" content="The XQuery language is one of the main ways that you interact with XML data in Oracle XML DB. Support for the language includes SQL*Plus commandXQUERY and SQL/XML functions XMLQuery, XMLTable, XMLExists, and XMLCast."></meta>
      <title>XQuery和Oracle XML DB</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Developer&#39;s Guide "></meta>
      <meta property="og:description" content="The XQuery language is one of the main ways that you interact with XML data in Oracle XML DB. Support for the language includes SQL*Plus commandXQUERY and SQL/XML functions XMLQuery, XMLTable, XMLExists, and XMLCast."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Developer&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="xml-db-developers-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-30T12:32:42-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96222-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="manipulation-of-XML-in-XML-DB.html" title="Previous" type="text/html"></link>
      <link rel="next" href="query-and-update-XML.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="XML DB Developer&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="ADXDB"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="manipulation-of-XML-in-XML-DB.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="query-and-update-XML.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="manipulation-of-XML-in-XML-DB.html" property="item" typeof="WebPage"><span property="name">在Oracle XML DB中操作XML数据</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">XQuery和Oracle XML DB</li>
            </ol>
            <a id="GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" name="GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1"></a><a id="ADXDB1700"></a>
            
            <h2 id="ADXDB-GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" class="sect2"><span class="enumeration_chapter">4</span> XQuery和Oracle XML DB</h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='xquery-and-XML-DB'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]u003e </style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>此页面上的脚本内容仅用于导航目的，不会以任何方式更改内容。</p>
            </noscript>
            <div>
               <p>XQuery语言是您与Oracle XML DB中的XML数据交互的主要方式之一。对该语言的支持包括SQL * Plus命令<code class="codeph">XQUERY</code>和SQL / XML函数<code class="codeph">XMLQuery</code> ， <code class="codeph">XMLTable</code> ， <code class="codeph">XMLExists</code>和<code class="codeph">XMLCast</code> 。
               </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-927FB610-9553-4772-8D3E-FAA7546C4371">XQuery语言概述</a><br>XQuery是专为查询和更新XML数据而设计的W3C语言。
                  </li>
                  <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-7DB63F8C-F441-4635-A185-4016016B22CE">Oracle XML DB中的XQuery概述</a><br>Oracle XML DB对XQuery语言的支持是通过SQL / XML函数<code class="codeph">XMLQuery</code> ， <code class="codeph">XMLTable</code> ， <code class="codeph">XMLExists</code>和<code class="codeph">XMLCast</code>的本机实现提供的。为方便起见，还提供了SQL * Plus命令<code class="codeph">XQUERY</code> ，它允许您直接输入XQuery表达式 - 实际上，此命令将SQL * Plus转换为XQuery命令行解释器。
                  </li>
                  <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392">SQL / XML函数XMLQUERY，XMLTABLE，XMLExists和XMLCast</a><br>SQL / XML函数<code class="codeph">XMLQuery</code> ， <code class="codeph">XMLTable</code> ， <code class="codeph">XMLExists</code>和<code class="codeph">XMLCast</code>由SQL / XML标准定义为SQL和XQuery语言之间的通用接口。
                  </li>
                  <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-7B039748-7C2A-4D86-9C54-55F4D08ED59B">URI Scheme oradb：使用XQuery查询表或查看数据</a><br>您可以使用XQuery函数<code class="codeph">fn:collection</code>来查询数据库表和视图中的数据。
                  </li>
                  <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-E04FDA5E-EBF1-42C9-8103-C089B2CF7513">Oracle XQuery扩展函数</a><br>Oracle XML DB为W3C标准中提供的功能添加了一些XQuery功能。这些附加功能位于Oracle XML DB命名空间<code class="codeph">http://xmlns.oracle.com/xdb</code> ，该命名空间使用预定义的前缀<span class="bold"><code class="codeph">ora</code></span> 。
                  </li>
                  <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-09066C46-8272-461A-ADE7-2F1B0FCDA948">Oracle XQuery扩展 - 表达式编译</a><br>W3C XQuery规范允许实现提供实现定义的扩展表达式。XQuery扩展表达式是一个XQuery表达式，它包含在大括号（ <code class="codeph">{</code> ， <code class="codeph">}</code> ）中，并以实现定义的pragma为前缀。Oracle实现提供了几个这样的编译指示。
                  </li>
                  <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-B7DB8827-C930-4711-A134-FA2BC58D749B">Oracle XML DB中的XQuery静态类型检查</a><br>如果可能，Oracle XML DB会对查询执行静态（编译时）类型检查。
                  </li>
                  <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-2D63B8EA-DC49-409F-B5DF-34A679AB2A99">Oracle XML DB支持XQuery</a><br>Oracle XML DB对XQuery语言的支持包括SQL支持和对XQuery函数和运算符的支持。
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="manipulation-of-XML-in-XML-DB.html#GUID-87C758D5-5792-483D-8894-4C01FCD2A8A0" title="此处介绍了以下内容：XQuery，XMLType操作和XML数据索引。">在Oracle XML DB中处理XML数据</a></p>
                  </div>
               </div>
            </div>
            <a id="ADXDB5089"></a><div class="props_rev_3"><a id="GUID-927FB610-9553-4772-8D3E-FAA7546C4371" name="GUID-927FB610-9553-4772-8D3E-FAA7546C4371"></a><h3 id="ADXDB-GUID-927FB610-9553-4772-8D3E-FAA7546C4371" class="sect3"><span class="enumeration_section">4.1</span> XQuery语言概述</h3>
               <div>
                  <p>XQuery是专为查询和更新XML数据而设计的W3C语言。</p>
                  <p>Oracle XML DB支持以下W3C XQuery标准：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>XQuery 1.0推荐</p>
                     </li>
                     <li>
                        <p><a id="d20054e188" class="indexterm-anchor"></a> XQuery Update Facility 1.0推荐</p>
                     </li>
                     <li>
                        <p>XQuery和XPath全文1.0推荐</p>
                     </li>
                  </ul>
                  <p>本节概述了XQuery语言。有关更多信息，请参阅最新的语言书籍或参考定义该语言的标准文档，所有这些文档均可在<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdb&amp;id=w3c_org" target="_blank"><code class="codeph">http://www.w3c.org/</code></a> 。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-4CE8BB4C-45F4-4F3A-9BB2-71F62E8A46CC">XPath表达式是XQuery表达式</a><br>XPath语言是用于导航XML文档的W3C推荐标准。它是XQuery语言的一个子集：XPath表达式也是一个XQuery表达式。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-498BE184-4F83-4FF8-8799-47D606F9066D">XQuery：基于序列的功能语言</a><br>XQuery在很多方面类似于SQL，但正如SQL用于查询结构化关系数据一样，XQuery专门用于查询来自各种数据源的半结构化XML数据。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-1F1A44CF-793C-4033-B91B-F519FB6B3BED">XQuery表达式</a><br>XQuery表达式区分大小写。XQuery表达式是<span class="italic">简单</span>表达式或<span class="italic">更新</span>表达式，后者是表示数据修改的表达式。更准确地说，这些是可能的XQuery表达式：</li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-E40FFA59-701C-43F6-9A89-774321970A19">FLWOR表达式</a><br>就像一般的XQuery一样，特别是有关FLWOR表达式的知识有很多。本节提供简要概述。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" title="XQuery语言是您与Oracle XML DB中的XML数据交互的主要方式之一。对该语言的支持包括SQL * Plus commandXQUERY和SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast。">XQuery和Oracle XML DB</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB5805"></a><a id="ADXDB4232"></a><div class="props_rev_3"><a id="GUID-4CE8BB4C-45F4-4F3A-9BB2-71F62E8A46CC" name="GUID-4CE8BB4C-45F4-4F3A-9BB2-71F62E8A46CC"></a><h4 id="ADXDB-GUID-4CE8BB4C-45F4-4F3A-9BB2-71F62E8A46CC" class="sect4"><span class="enumeration_section">4.1.1</span> XPath表达式是XQuery表达式</h4>
                  <div>
                     <p>XPath语言是用于导航XML文档的W3C推荐标准。它是XQuery语言的一个子集：XPath表达式也是一个XQuery表达式。</p>
                     <div class="section">
                        <p>XPath将XML文档建模为节点树。它提供了一组操作，可以遍历此树并应用谓词和节点测试函数。将XPath表达式应用于XML文档会生成一组节点。例如，表达式<code class="codeph">/PO/PONO</code>选择文档的<code class="codeph">PO</code>根元素下的所有<code class="codeph">PONO</code>子元素。
                        </p>
                        <p><a href="xquery-and-XML-DB.html#GUID-4CE8BB4C-45F4-4F3A-9BB2-71F62E8A46CC__CFHFHBIJ" title="该表描述了五种常见的XPath结构。">表4-1</a>列出了XPath中使用的一些常见结构。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformalwide" id="GUID-4CE8BB4C-45F4-4F3A-9BB2-71F62E8A46CC__CFHFHBIJ">
                        <p class="titleintable">表4-1常见的XPath构造</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="常见的XPath构造" width="100%" border="1" summary="This table describes five common XPath constructs." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="21%" id="d20054e323">XPath构造</th>
                                 <th align="left" valign="bottom" width="79%" id="d20054e326">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d20054e331" headers="d20054e323 ">
                                    <p><code class="codeph">/</code></p>
                                 </td>
                                 <td align="left" valign="top" width="79%" headers="d20054e331 d20054e326 ">
                                    <p>表示XPath表达式中树的根。例如， <code class="codeph">/PO</code>指的是名为<code class="codeph">PO</code>的根节点的子节点。</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d20054e345" headers="d20054e323 ">
                                    <p><code class="codeph">/</code></p>
                                 </td>
                                 <td align="left" valign="top" width="79%" headers="d20054e345 d20054e326 ">
                                    <p>用作路径分隔符以标识给定元素节点的子元素节点。例如， <code class="codeph">/PurchaseOrder/Reference</code>标识作为根元素的子元素的<code class="codeph">PurchaseOrder</code>元素的子元素的<code class="codeph">Reference</code>元素。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d20054e362" headers="d20054e323 ">
                                    <p><code class="codeph">//</code></p>
                                 </td>
                                 <td align="left" valign="top" width="79%" headers="d20054e362 d20054e326 ">
                                    <p>用于标识当前节点的所有后代。例如， <code class="codeph">PurchaseOrder//ShippingInstructions</code>匹配<code class="codeph">PurchaseOrder</code>元素下的任何<code class="codeph">ShippingInstructions</code>元素。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d20054e379" headers="d20054e323 ">
                                    <p><code class="codeph">*</code></p>
                                 </td>
                                 <td align="left" valign="top" width="79%" headers="d20054e379 d20054e326 ">
                                    <p>用作匹配任何子节点的通配符。例如， <code class="codeph">/PO/*/STREET</code>匹配作为<code class="codeph">PO</code>元素的孙子的任何街道元素。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d20054e393" headers="d20054e323 ">
                                    <p><code class="codeph">[]</code></p>
                                 </td>
                                 <td align="left" valign="top" width="79%" headers="d20054e393 d20054e326 ">
                                    <p>用于表示谓词表达式。XPath支持丰富的二元运算符列表，例如<code class="codeph">or</code> ， <code class="codeph">and</code> ，而<code class="codeph">not</code> 。例如， <code class="codeph">/PO[PONO = 20 and PNAME = "PO_2"]/SHIPADDR</code>选择采购订单编号为<code class="codeph">20</code>且采购订单名称为<code class="codeph">PO_2</code>的所有采购订单的送货地址元素。
                                    </p>
                                    <p>括号也用于表示位置（索引）。例如， <code class="codeph">/PO/PONO[2]</code>标识<code class="codeph">PO</code>根元素下的第二个购买订单号元素。
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="21%" id="d20054e428" headers="d20054e323 ">
                                    <p>功能</p>
                                 </td>
                                 <td align="left" valign="top" width="79%" headers="d20054e428 d20054e326 ">
                                    <p>XPath和XQuery支持一组内置函数，如<code class="codeph">substring</code> ， <code class="codeph">round</code>和<code class="codeph">not</code> 。此外，这些语言通过使用命名空间来提供扩展功能。对于名称空间<code class="codeph">http://xmlns.oracle.com/xdb</code> XQuery扩展函数使用名称空间前缀<code class="codeph">ora</code> 。请参阅<a href="xquery-and-XML-DB.html#GUID-E04FDA5E-EBF1-42C9-8103-C089B2CF7513" title="Oracle XML DB为W3C标准中提供的功能添加了一些XQuery功能。这些附加功能位于Oracle XML DB命名空间http://xmlns.oracle.com/xdb中，该命名空间使用预定义的前缀ora。">Oracle XQuery扩展函数</a> 。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p>XPath表达式必须标识单个节点或一组元素，文本或属性节点。评估XPath表达式的结果绝不是布尔表达式。</p>
                        <p>您可以使用PL / SQL，C或Java选择<code class="codeph">XMLType</code>数据。您还可以使用<code class="codeph">XMLType</code>方法<code class="codeph">getNumberVal()</code>将XML数据检索为<code class="codeph">NUMBER</code>值。
                        </p>
                        <div class="infoboxnote" id="GUID-4CE8BB4C-45F4-4F3A-9BB2-71F62E8A46CC__GUID-4E633027-A075-4466-971F-807F8B922B85">
                           <p class="notep1">注意：</p>
                           <p>Oracle SQL函数和<code class="codeph">XMLType</code>方法遵循W3C XPath建议，该建议指出如果XPath表达式在应用于XML数据时<span class="italic">不</span>针对<span class="italic">任何节点</span> ，则必须返回空序列。在这种情况下， <span class="italic">不得</span>引发错误。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-927FB610-9553-4772-8D3E-FAA7546C4371" title="XQuery是专为查询和更新XML数据而设计的W3C语言。">XQuery语言概述</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5090"></a><div class="props_rev_3"><a id="GUID-498BE184-4F83-4FF8-8799-47D606F9066D" name="GUID-498BE184-4F83-4FF8-8799-47D606F9066D"></a><h4 id="ADXDB-GUID-498BE184-4F83-4FF8-8799-47D606F9066D" class="sect4"><span class="enumeration_section">4.1.2</span> XQuery：基于序列的功能语言</h4>
                  <div>
                     <p>XQuery在很多方面类似于SQL，但正如SQL用于查询结构化关系数据一样，XQuery专门用于查询来自各种数据源的半结构化XML数据。</p>
                     <p>您可以使用XQuery在任何位置查询XML数据，无论数据是存储在数据库表中，还是通过Web服务提供，还是以其他方式即时创建。除了查询XML数据外，XQuery还可用于<span class="italic">构造</span> XML数据。在这方面，XQuery可以作为XSLT和其他SQL / XML发布函数（如<code class="codeph">XMLElement</code>的替代或补充。
                     </p>
                     <p>XQuery构建在Post-Schema-Validation Infoset（PSVI）数据模型之上，该模型将XML信息集（Infoset）数据模型和XML Schema类型系统结合在一起。XQuery定义了一个新的数据模型， <strong class="term">XQuery数据模型</strong> （XDM），它基于<span class="italic">序列</span> 。XQuery序列的另一个名称是<strong class="term">XDM实例</strong> 。
                     </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-647DE1EC-46E8-44E2-A856-F734DDEE5526">XQuery是关于序列的</a><br>XQuery就是在操纵序列。这使得XQuery类似于集合操作语言，除了序列是有序的并且可以包含重复的项目。XQuery序列与其他语言中的序列不同，因为嵌套的XQuery序列的效果总是<span class="italic">扁平化</span> 。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-30341909-E378-4909-B54B-D112A6144C5B">XQuery是引用透明的</a><br>XQuery是一种<span class="italic">功能</span>语言。因此，它由一组可能的<span class="italic">表达式</span>组成，这些<span class="italic">表达式</span>被<span class="italic">评估</span>并且其评估返回<span class="italic">值</span> （结果）。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-314E4088-CAA8-4A04-A55F-A04AC71444BB">XQuery更新对您的数据有副作用</a><br>引用透明性适用于XQuery表达式的评估。这并不意味着此评估不会对您的<span class="italic">数据</span> <span class="italic">产生副作用</span> 。特别是，您使用XQuery Update来修改数据。该修改是评估XQuery更新表达式的副作用。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-BC615C64-3B5F-4E05-A592-5E3DBC2BB5CE">XQuery更新快照</a><br>XQuery表达式（查询）可以调用多个更新操作。XQuery Update为与<span class="italic">原子</span>操作相同的查询执行所有此类操作：要么它们都成功，要么都不成功（如果引发错误）。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-804D83E9-23F3-4E70-B836-FD30793276D9">XQuery全文提供全文搜索</a><br>XQuery和XPath Full Text 1.0 Recommendation（XQuery Full Text）定义了XQuery对查询中全文搜索的支持。它定义了全文选择运算符，用于执行AllMatches模型的搜索和返回实例，它补充了XQuery数据模型（XDM）。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-927FB610-9553-4772-8D3E-FAA7546C4371" title="XQuery是专为查询和更新XML数据而设计的W3C语言。">XQuery语言概述</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADXDB6035"></a><div class="props_rev_3"><a id="GUID-647DE1EC-46E8-44E2-A856-F734DDEE5526" name="GUID-647DE1EC-46E8-44E2-A856-F734DDEE5526"></a><h5 id="ADXDB-GUID-647DE1EC-46E8-44E2-A856-F734DDEE5526" class="sect5"><span class="enumeration_section">4.1.2.1</span> XQuery是关于序列的</h5>
                     <div>
                        <p>XQuery就是在操纵序列。这使得XQuery类似于集合操作语言，除了序列是有序的并且可以包含重复的项目。XQuery序列与其他语言中的序列不同，因为嵌套的XQuery序列的效果总是<span class="italic">扁平化</span> 。
                        </p>
                        <p>在许多情况下，序列可以被视为无序，以最大化优化 - 如果可用，它在您的控制之下。这种<strong class="term">无序模式</strong>可以应用于嵌套迭代（ <code class="codeph">for</code> ）的处理中的连接顺序，并且它可以应用于XPath表达式的处理（例如，在<code class="codeph">/a/b</code> ，匹配的<code class="codeph">b</code>元素可以被处理而不考虑文件订购）。
                        </p>
                        <p>XQuery <strong class="term">序列</strong>由零个或多个<strong class="term">项组成</strong> ，可以是<span class="italic">原子</span> （标量）值或XML <span class="italic">节点</span> 。使用基于XML Schema类型的富类型系统键入项目。这种类型的系统是XPath 1.0的一个重大变化，它仅限于简单的标量类型，如布尔值，数字和字符串。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-498BE184-4F83-4FF8-8799-47D606F9066D" title="XQuery在很多方面类似于SQL，但正如SQL用于查询结构化关系数据一样，XQuery专门用于查询来自各种数据源的半结构化XML数据。">XQuery：基于序列的功能语言</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB6036"></a><div class="props_rev_3"><a id="GUID-30341909-E378-4909-B54B-D112A6144C5B" name="GUID-30341909-E378-4909-B54B-D112A6144C5B"></a><h5 id="ADXDB-GUID-30341909-E378-4909-B54B-D112A6144C5B" class="sect5"><span class="enumeration_section">4.1.2.2</span> XQuery是引用透明的</h5>
                     <div>
                        <p>XQuery是一种<span class="italic">功能</span>语言。因此，它由一组可能的<span class="italic">表达式</span>组成，这些<span class="italic">表达式</span>被<span class="italic">评估</span>并且其评估返回<span class="italic">值</span> （结果）。
                        </p>
                        <p>评估XQuery表达式的结果有两部分，其中至少有一部分是空的：（a）序列（XDM实例）和（b） <strong class="term">挂起的更新列表</strong> 。非正式地，序列有时被称为表达式值，尤其是当挂起的更新列表为空时，意味着不涉及数据更新。
                        </p>
                        <p>作为一种函数式语言，XQuery也是<strong class="term">引用透明的</strong> 。这意味着在<span class="italic">同一上下文中</span>计算的<span class="italic">相同表达式</span>返回<span class="italic">相同的值</span> 。
                        </p>
                        <p>这种理想的数学属性的<span class="italic">例外情况</span>包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>XQuery表达式，它们通过与外部环境的交互来获取其价值。例如，诸如<code class="codeph">fn:current-time(...)</code>或<code class="codeph">fn:doc(...)</code>类的表达式不一定总是返回相同的值，因为它取决于可以改变的外部条件（时间变化;目标文件的内容可能会改变）。
                              </p>
                              <p>在某些情况下，就像<code class="codeph">fn:doc</code> ，XQuery被定义为在单个查询的执行中是引用透明的：在查询中，每次使用相同参数调用<code class="codeph">fn:doc</code>生成相同的文档。
                              </p>
                           </li>
                           <li>
                              <p>XQuery表达式被定义为依赖于特定的XQuery语言实现。评估此类表达式的结果可能因实现而异。函数<code class="codeph">fn:doc</code>是一个基本上是实现定义的函数的示例。
                              </p>
                           </li>
                        </ul>
                        <p>XQuery Update不在列表中;它<span class="italic">不</span>存在一个例外，引用透明。请参阅<a href="xquery-and-XML-DB.html#GUID-314E4088-CAA8-4A04-A55F-A04AC71444BB" title="引用透明性适用于XQuery表达式的评估。这并不意味着此评估不会对您的数据产生副作用。特别是，您使用XQuery Update来修改数据。该修改是评估XQuery更新表达式的副作用。">XQuery更新对您的数据有副作用</a> 。
                        </p>
                        <p>引用透明度也适用于XQuery <span class="italic">变量</span> ：同一上下文中的相同变量具有相同的值。在这方面，函数式语言就像数学形式，而不像程序性或命令式编程语言。过程语言中的变量实际上是内存位置的名称;它具有<span class="italic">当前</span>值或状态，由其内容随时表示。声明性语言中的变量（如XQuery）实际上是<span class="italic">静态</span>值的名称。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-498BE184-4F83-4FF8-8799-47D606F9066D" title="XQuery在很多方面类似于SQL，但正如SQL用于查询结构化关系数据一样，XQuery专门用于查询来自各种数据源的半结构化XML数据。">XQuery：基于序列的功能语言</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB6037"></a><div class="props_rev_3"><a id="GUID-314E4088-CAA8-4A04-A55F-A04AC71444BB" name="GUID-314E4088-CAA8-4A04-A55F-A04AC71444BB"></a><h5 id="ADXDB-GUID-314E4088-CAA8-4A04-A55F-A04AC71444BB" class="sect5"><span class="enumeration_section">4.1.2.3</span> XQuery更新对您的数据有副作用</h5>
                     <div>
                        <p>引用透明性适用于XQuery表达式的评估。这并不意味着此评估不会对您的<span class="italic">数据</span> <span class="italic">产生副作用</span> 。特别是，您使用XQuery Update来修改数据。该修改是评估XQuery更新表达式的副作用。
                        </p>
                        <p>副作用是一回事;表达式值是另一个。从评估返回的值包括描述要执行的更新的挂起更新列表。对于给定的XQuery表达式，无论评估发生的上下文如何，此描述都是相同的（具有上述例外）。</p>
                        <p>XQuery Update标准定义了如何更新数据的XDM实例。这些更新如何传播到持久性数据存储（例如<code class="codeph">XMLType</code>表和列）与实现有关。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-498BE184-4F83-4FF8-8799-47D606F9066D" title="XQuery在很多方面类似于SQL，但正如SQL用于查询结构化关系数据一样，XQuery专门用于查询来自各种数据源的半结构化XML数据。">XQuery：基于序列的功能语言</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB6038"></a><div class="props_rev_3"><a id="GUID-BC615C64-3B5F-4E05-A592-5E3DBC2BB5CE" name="GUID-BC615C64-3B5F-4E05-A592-5E3DBC2BB5CE"></a><h5 id="ADXDB-GUID-BC615C64-3B5F-4E05-A592-5E3DBC2BB5CE" class="sect5"><span class="enumeration_section">4.1.2.4</span> XQuery更新快照</h5>
                     <div>
                        <p>XQuery表达式（查询）可以调用多个更新操作。XQuery Update为与<span class="italic">原子</span>操作相同的查询执行所有此类操作：要么它们都成功，要么都不成功（如果引发错误）。
                        </p>
                        <p>因此，更改单元是整个XQuery查询。为了实现此原子更新行为，在评估查询之前，XQuery Update会获取查询调用其修改的数据（XDM实例）的<strong class="term">快照</strong> 。它还将查询调用的更新操作添加到挂起的更新列表中。快照是作为更新目标的XDM实例的评估上下文。
                        </p>
                        <p>作为XQuery表达式评估的最后一步，处理挂起的更新列表，以原子方式应用指示的更新操作，并终止快照。</p>
                        <p>快照语义的原子性质意味着给定查询中使用的一组更新操作不一定按写入的顺序应用。实际上，应用更新操作的顺序是固定的，并由XQuery Update Feature标准指定。</p>
                        <p>这意味着<span class="italic">更新操作不会看到同一查询的任何其他更新操作的结果</span> 。没有中间或临时更新状态的概念 - 查询的所有更新都以原子方式一起应用。
                        </p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-498BE184-4F83-4FF8-8799-47D606F9066D" title="XQuery在很多方面类似于SQL，但正如SQL用于查询结构化关系数据一样，XQuery专门用于查询来自各种数据源的半结构化XML数据。">XQuery：基于序列的功能语言</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB6140"></a><div class="props_rev_3"><a id="GUID-804D83E9-23F3-4E70-B836-FD30793276D9" name="GUID-804D83E9-23F3-4E70-B836-FD30793276D9"></a><h5 id="ADXDB-GUID-804D83E9-23F3-4E70-B836-FD30793276D9" class="sect5"><span class="enumeration_section">4.1.2.5</span> XQuery全文提供全文搜索</h5>
                     <div>
                        <p>XQuery和XPath Full Text 1.0 Recommendation（XQuery Full Text）定义了XQuery对查询中全文搜索的支持。它定义了全文选择运算符，用于执行AllMatches模型的搜索和返回实例，它补充了XQuery数据模型（XDM）。</p>
                        <p>AllMatches实例描述了给定搜索上下文项的全文查询的所有可能解决方案。每个解决方案都由Match实例描述，该实例包含必须包含的搜索上下文标记（StringInclude实例）以及必须排除的那些（StringExclude实例）。</p>
                        <p>简而言之，XQuery Full Text为XQuery语言添加了一个包含全文的表达式。您在查询中使用此类表达式来搜索元素节点及其后代元素的文本（您还可以搜索属性节点的文本）。</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-498BE184-4F83-4FF8-8799-47D606F9066D" title="XQuery在很多方面类似于SQL，但正如SQL用于查询结构化关系数据一样，XQuery专门用于查询来自各种数据源的半结构化XML数据。">XQuery：基于序列的功能语言</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="ADXDB5091"></a><div class="props_rev_3"><a id="GUID-1F1A44CF-793C-4033-B91B-F519FB6B3BED" name="GUID-1F1A44CF-793C-4033-B91B-F519FB6B3BED"></a><h4 id="ADXDB-GUID-1F1A44CF-793C-4033-B91B-F519FB6B3BED" class="sect4"><span class="enumeration_section">4.1.3</span> XQuery表达式</h4>
                  <div>
                     <p>XQuery表达式区分大小写。XQuery表达式是<span class="italic">简单</span>表达式或<span class="italic">更新</span>表达式，后者是表示数据修改的表达式。更准确地说，这些是可能的XQuery表达式：</p>
                     <div class="section">
                        <ul style="list-style-type:disc">
                           <li>
                              <p><strong class="term">基本更新表达式 -</strong> <code class="codeph">insert</code> ， <code class="codeph">delete</code> ， <code class="codeph">replace</code>或<code class="codeph">rename</code>表达式，或对<span class="italic">更新函数</span>的调用（请参阅XQuery更新工具1.0建议）。
                              </p>
                           </li>
                           <li>
                              <p><strong class="term">更新表达式 -</strong>包含另一个更新表达式的基本更新表达式或表达式（变换表达式除外）（这是一个递归定义）。
                              </p>
                           </li>
                           <li>
                              <p><strong class="term">简单表达式 -</strong> XQuery 1.0表达式。它不要求任何更新。
                              </p>
                           </li>
                        </ul>
                        <p>评估简单表达式产生的挂起更新列表为空。通过评估更新表达式得到的序列值为空。</p>
                        <p><span class="italic">简单</span>表达式包括以下内容：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><strong class="term">主表达式 -</strong>文字，变量或函数应用程序。变量名以美元符号（ <code class="codeph">$</code> ）开头 - 例如<code class="codeph">$foo</code> 。文字包括数字，字符串和字符或实体引用。
                              </p>
                           </li>
                           <li>
                              <p><strong class="term">XPath表达式 -</strong>任何XPath表达式。XPath 2.0标准是XQuery的一个子集。
                              </p>
                           </li>
                           <li>
                              <p><strong class="term">FLWOR表达式 -</strong>最重要的XQuery表达式，按顺序由以下组成，FLWOR的名称来自： <code class="codeph">for</code> ， <code class="codeph">let</code> ， <code class="codeph">where</code> ， <code class="codeph">order by</code> ， <code class="codeph">return</code> 。
                              </p>
                           </li>
                           <li>
                              <p><strong class="term">XQuery序列</strong> - 逗号（ <code class="codeph">,</code> ）构造函数创建序列。序列操作函数，例如并<code class="codeph">union</code>和<code class="codeph">intersect</code>也是可用的。所有XQuery序列都是有效的<strong class="term">平面</strong> ：嵌套序列被视为其扁平等价物。因此，例如， <code class="codeph">(1, 2, (3, 4, (5), 6), 7)</code>被视为<code class="codeph">(1, 2, 3, 4, 5, 6, 7)</code> 。单例序列（如<code class="codeph">(42)</code>在大多数XQuery上下文中的作用与单个项目<code class="codeph">42</code> 。请记住，任何XQuery表达式的结果都是一个序列。
                              </p>
                           </li>
                           <li>
                              <p><strong class="term">直接（文字）结构</strong> -  XML元素和属性语法自动构造元素和属性：你看到的是你得到的。例如，XQuery表达式<code class="codeph">&lt;a&gt;33&lt;/a&gt;</code>构造XML元素<code class="codeph">&lt;a&gt;33&lt;/a&gt;</code> 。
                              </p>
                           </li>
                           <li>
                              <p><strong class="term">计算（动态）构造 -</strong>您可以使用计算值在运行时构造XML数据。例如，以下XQuery表达式构造此XML数据： <code class="codeph">&lt;foo toto="5"&gt;&lt;bar&gt;tata titi&lt;/bar&gt; why?&lt;/foo&gt;</code> 。
                              </p><pre class="pre codeblock"><code>&lt;foo&gt;属性toto {2 + 3}，元素栏{“tata”，“titi”}，文字{“为什么？“} &lt;/ FOO&gt;</code></pre><p>在这个例子中，元素<code class="codeph">foo</code>是直接构造;计算其他结构。实际上，计算构造函数的参数不是文字（例如<code class="codeph">toto</code>和<code class="codeph">"tata"</code> ），而是要计算的表达式（例如<code class="codeph">2+3</code> ）。可以计算元素或属性构造函数的名称和值参数。大括号（ <code class="codeph">{</code> ， <code class="codeph">}</code> ）用于标记要评估的XQuery表达式。
                              </p>
                           </li>
                           <li>
                              <p><strong class="term">条件表达式 -</strong>像往常一样，但请记住，表达式的每个部分本身都是一个任意表达式。例如，在这个条件表达式中，这些子表达式中的每一个都可以是任何XQuery表达式： <code class="codeph">something</code> ， <code class="codeph">somethingElse</code> ， <code class="codeph">expression1</code>和<code class="codeph">expression2</code> 。
                              </p><pre class="pre codeblock"><code>if（something &lt;somethingElse）然后是expression1 else expression2</code></pre></li>
                           <li>
                              <p><strong class="term">算术，关系表达式 -</strong>像往常一样，但请记住每个关系表达式返回一个（布尔<a id="fn_1" name="fn_1" href="#fn_1" value="" the="" returned="" is="" a="" sequence,="" as="" always.="" however,="" in="" xquery,="" sequence="" of="" one="" item="" equivalent="" to="" that="" itself.="" this="" case,="" single="" boolean="" ="" ="" onclick="footdisplay(1, "><sup>足1</sup></a> ）值。例子：</p><pre class="pre codeblock"><code>2 + 3 42 &lt;$ a + 5（1,4）=（1,2）5&gt; 3 eq true（）</code></pre></li>
                           <li>
                              <p><strong class="term">量词表达式 -</strong>通用（ <code class="codeph">every</code> ）和存在（ <code class="codeph">some</code> ）量词函数提供了在某些情况下使用FLWOR表达式的快捷方式。例子：</p><pre class="pre codeblock"><code>每个$ foo in doc（“bar.xml”）//无论什么满足$ foo / @ bar&gt; 42 some $ toto in（42,5），$ titi in（123,29,5）满足$ toto = $ titi</code></pre></li>
                           <li>
                              <p><strong class="term">正则表达式 -</strong> XQuery正则表达式基于XML Schema 1.0和Perl。（请参阅<a href="xquery-and-XML-DB.html#GUID-22940B8D-1468-4966-9F55-7DD4518E9612" title="Oracle XML DB支持最新的XQuery 1.0和XPath 2.0函数和运算符规范中包含的所有XQuery函数和运算符，但有一些例外。">对XQuery函数和运算符的支持</a> 。）
                              </p>
                           </li>
                           <li>
                              <p><strong class="term">类型表达式 -</strong>表示XQuery类型的XQuery表达式。示例： <code class="codeph">item()</code> ， <code class="codeph">node()</code> ， <code class="codeph">attribute()</code> ， <code class="codeph">element()</code> ， <code class="codeph">document-node()</code> ， <code class="codeph">namespace()</code> ， <code class="codeph">text()</code> ， <code class="codeph">xs:integer</code> ， <code class="codeph">xs:string</code> 。<a id="fn_2" name="fn_2" href="#fn_2" namespace="" prefix="" xs="" is="" predefined="" for="" the="" xml="" schema="" namespace,="" http:="" /="" /www.w3.org="" /2001="" /xmlschema=")" ="" ="" onclick="footdisplay(2, "><sup>脚2</sup></a></p>
                              <p>类型的表达式可以有<strong class="term">发生指标</strong> ： <span class="bold"><code class="codeph">?</code></span> （可选：零或一）， <span class="bold"><code class="codeph">*</code></span> （零或更多）， <span class="bold"><code class="codeph">+</code></span> （一个或多个）。示例： <code class="codeph">document-node(element())*</code> ， <code class="codeph">item()+</code> ， <code class="codeph">attribute()?</code> 。
                              </p>
                              <p>XQuery还提供了处理类型的运算符。这些包括<code class="codeph">cast as</code> ， <code class="codeph">typeswitch</code> <code class="codeph">castable as</code> ， <code class="codeph">treat as</code> ， <code class="codeph">instance of</code> ， <code class="codeph">typeswitch</code>和<code class="codeph">validate</code> 。例如， <code class="codeph">"42" cast as xs:integer</code>是一个表达式，其值为整数42。（严格来说，它不是类型表达式，因为它的值不代表类型。）
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">全文包含表达式</span> - 表示全文搜索的XQuery表达式。此表达式由XQuery和XPath Full Text 1.0 Recommendation提供。Oracle支持的全文包含表达式（FTContainsExpr）具有以下部分：指定要搜索的项的<span class="bold">搜索上下文</span> ，以及筛选这些项<span class="bold">的全文选择</span> ，选择匹配。
                              </p>
                              <p>选择部分本身由以下部分组成：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>用于匹配的<span class="bold">标记和短语</span> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>可选的<span class="bold">匹配选项</span> ，例如使用词干。
                                    </p>
                                 </li>
                                 <li>
                                    <p>用于组合全文选择的可选<span class="bold">布尔运算符</span> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>可选约束运算符，例如<span class="bold">位置过滤器</span> （例如， <code class="codeph">ordered window</code> ）。
                                    </p>
                                 </li>
                              </ul>
                              <p>请参阅<a href="xquery-and-XML-DB.html#GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048" title="Oracle XML DB支持存储为二进制XML的XMLType数据的XQuery Full Text。 Oracle Text技术提供全文索引和搜索，这是此支持的基础。">支持XQuery全文</a> 。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-927FB610-9553-4772-8D3E-FAA7546C4371" title="XQuery是专为查询和更新XML数据而设计的W3C语言。">XQuery语言概述</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5092"></a><div class="props_rev_3"><a id="GUID-E40FFA59-701C-43F6-9A89-774321970A19" name="GUID-E40FFA59-701C-43F6-9A89-774321970A19"></a><h4 id="ADXDB-GUID-E40FFA59-701C-43F6-9A89-774321970A19" class="sect4"><span class="enumeration_section">4.1.4</span> FLWOR表达式</h4>
                  <div>
                     <p>就像一般的XQuery一样，特别是有关FLWOR表达式的知识有很多。本节提供简要概述。</p>
                     <div class="section">
                        <p>FLWOR是XQuery中最通用的表达式语法。FLWOR（发音为“花”）代表<code class="codeph">for</code> ， <code class="codeph">let</code> ， <code class="codeph">where</code> ， <code class="codeph">order by</code>和<code class="codeph">return</code> 。FLWOR表达式至少有一个<code class="codeph">for</code>或<code class="codeph">let</code>子句和一个<code class="codeph">return</code>子句;单个<code class="codeph">where</code>和<code class="codeph">order by</code>子句是可选的。只有<code class="codeph">return</code>子句可以包含更新表达式;其他条款不能。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold"><code class="codeph">for</code></span> - 依次将一个或多个变量绑定到任意数量的值。也就是说，对于每个变量，迭代，将变量绑定到每次迭代的不同值。
                              </p>
                              <p>在每次迭代中，变量按它们出现的顺序绑定，因此在<code class="codeph">for</code>列表中<code class="codeph">$later</code>的变量<code class="codeph">$earlier</code>列出的变量<code class="codeph">$later</code>的值可以用于变量<code class="codeph">$later</code>的绑定。例如，在第二次迭代期间，此表达式将<code class="codeph">$i</code>绑定到<code class="codeph">4</code> ，将<code class="codeph">$j</code>绑定到<code class="codeph">6</code> （2 + 4）：</p><pre class="oac_no_warn" dir="ltr">for $ i in（3,4），$ j in（$ i，2 + $ i）</pre></li>
                           <li>
                              <p><span class="bold"><code class="codeph">let</code></span> - 绑定一个或多个变量。
                              </p>
                              <p>与<code class="codeph">for</code> ，变量可以通过<code class="codeph">let</code>绑定到使用另一个变量计算的值，该变量先前在<code class="codeph">let</code>的绑定列表中列出（或者包含<code class="codeph">for</code>或<code class="codeph">let</code> ）。例如，此表达式将<code class="codeph">$j</code>绑定到<code class="codeph">5</code> （3 + 2）：</p><pre class="oac_no_warn" dir="ltr">让$ i：= 3，$ j：= $ i + 2</pre></li>
                           <li>
                              <p><span class="bold"><code class="codeph">where</code></span> - 根据某些条件过滤<code class="codeph">for</code>和<code class="codeph">let</code>变量绑定。这类似于SQL <code class="codeph">WHERE</code>子句。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold"><code class="codeph">order by</code></span> -排序的结果<code class="codeph">where</code>滤波。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold"><code class="codeph">return</code></span> - 根据有序的过滤值构造结果。这是整个FLWOR表达的结果。这是一个扁平的序列。
                              </p>
                              <p>如果<code class="codeph">return</code>子句包含更新表达式，则对其他子句生成的每个元组计算该表达式。然后，将这些评估中的挂起更新列表合并为FLWOR表达式的结果。
                              </p>
                           </li>
                        </ul>
                        <p>表达<code class="codeph">for</code>和<code class="codeph">let</code>作用类似于一个SQL <code class="codeph">FROM</code>子句。表达<code class="codeph">where</code>就像一个SQL <code class="codeph">WHERE</code>子句表达式<code class="codeph">order by</code>类似于<code class="codeph">ORDER BY</code>的SQL。表达式<code class="codeph">return</code>就像SQL中的<code class="codeph">SELECT</code>一样。除了在两种语言中名称相同的两个关键字（ <code class="codeph">where</code> ， <code class="codeph">order by</code> ）之外，FLWOR子句顺序或多或少与SQL子句顺序相反，但相应子句的含义非常相似。
                        </p>
                        <p>使用FLWOR表达式（带有<code class="codeph">order by</code> ）是以除文档顺序之外的任何顺序构造XQuery序列的<span class="italic">唯一</span>方法。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-927FB610-9553-4772-8D3E-FAA7546C4371" title="XQuery是专为查询和更新XML数据而设计的W3C语言。">XQuery语言概述</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDB5088"></a><div class="props_rev_3"><a id="GUID-7DB63F8C-F441-4635-A185-4016016B22CE" name="GUID-7DB63F8C-F441-4635-A185-4016016B22CE"></a><h3 id="ADXDB-GUID-7DB63F8C-F441-4635-A185-4016016B22CE" class="sect3"><span class="enumeration_section">4.2</span> Oracle XML DB中的XQuery概述</h3>
               <div>
                  <p>Oracle XML DB对XQuery语言的支持是通过SQL / XML函数<code class="codeph">XMLQuery</code> ， <code class="codeph">XMLTable</code> ， <code class="codeph">XMLExists</code>和<code class="codeph">XMLCast</code>的本机实现提供的。为方便起见，还提供了SQL * Plus命令<code class="codeph">XQUERY</code> ，它允许您直接输入XQuery表达式 - 实际上，此命令将SQL * Plus转换为XQuery命令行解释器。
                  </p>
                  <p>Oracle XML DB编译XQuery表达式，这些表达式作为参数传递给SQL / XML函数<code class="codeph">XMLQuery</code> ， <code class="codeph">XMLTable</code> ， <code class="codeph">XMLExists</code>和<code class="codeph">XMLCast</code> 。此编译生成使用SQL / XML函数和XPath函数的SQL查询块和运算符树。包含<code class="codeph">XMLQuery</code> ， <code class="codeph">XMLTable</code> ， <code class="codeph">XMLExists</code>或<code class="codeph">XMLCast</code>的SQL语句作为一个整体进行编译和优化，同时利用关系数据库和XQuery特定的优化技术。根据所使用的XML存储和索引方法，可以进一步优化XPath函数。生成的优化运算符树以流方式执行。
                  </p>
                  <div class="infoboxnote" id="GUID-7DB63F8C-F441-4635-A185-4016016B22CE__GUID-782F88A1-4C1E-49D8-9A87-926C369F0A33">
                     <p class="notep1">注意：</p>
                     <p>Oracle XML Developer's Kit（XDK）支持中间层的XQuery。您无需访问Oracle数据库即可使用XQuery。XDK允许您使用XQuery API for Java（XQJ）评估XQuery表达式。</p>
                  </div>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-8686CFE4-C9C3-44A3-8A45-868A5EA34FA8">何时使用XQuery</a><br>您可以使用XQuery执行许多与使用SQL / XML生成函数或XSLT相同的操作;有很多重叠。使用一个或另一个工具完成给定任务的决定可以基于许多考虑因素，其中大多数考虑因素并非特定于Oracle数据库。有关此一般问题，请参阅外部文档。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-2DBF9D49-9C20-45F8-BB11-CB68DAF4F702">预定义的XQuery命名空间和前缀</a><br>预定义了几个名称空间和前缀，以便与Oracle XML DB中的XQuery一起使用。</li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="xquery-and-XML-DB.html#GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392" title="SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast由SQL / XML标准定义为SQL和XQuery语言之间的通用接口。">SQL / XML函数XMLQUERY，XMLTABLE，XMLExists和XMLCast</a></li>
                        <li><a href="query-and-update-XML.html#GUID-4C3665D9-5502-4D05-A1AE-9E8B4D7E64C1" title="您可以使用SQL * Plus XQUERY命令评估XQuery表达式。">使用SQL * Plus XQUERY命令</a></li>
                        <li><a href="query-and-update-XML.html#GUID-01C75289-804F-4BAA-AE7C-DFA73198581E" title="应用程序有许多方法可以查询和更新Oracle数据库中的XML数据，包括基于XML模式和非基于模式的数据。">查询和更新XML数据</a></li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-7DB63F8C-F441-4635-A185-4016016B22CE__GUID-1F192021-649E-4547-B18B-3A10DE22BEAB">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>用于特定于Oracle的XQuery函数的<a href="xquery-and-XML-DB.html#GUID-E04FDA5E-EBF1-42C9-8103-C089B2CF7513" title="Oracle XML DB为W3C标准中提供的功能添加了一些XQuery功能。这些附加功能位于Oracle XML DB命名空间http://xmlns.oracle.com/xdb中，该命名空间使用预定义的前缀ora。">Oracle XQuery扩展函数，</a>用于扩展语言</p>
                        </li>
                        <li>
                           <p><a href="xquery-and-XML-DB.html#GUID-2D63B8EA-DC49-409F-B5DF-34A679AB2A99" title="Oracle XML DB support for the XQuery language includes SQL support and support for XQuery functions and operators.">Oracle XML DB对XQuery的支持，以</a>获取有关<a href="xquery-and-XML-DB.html#GUID-2D63B8EA-DC49-409F-B5DF-34A679AB2A99" title="Oracle XML DB对XQuery语言的支持包括SQL支持和对XQuery函数和运算符的支持。">XQuery的Oracle XML DB支持的</a>详细信息</p>
                        </li>
                        <li>
                           <p>有关使用XQJ的信息，请参阅<a href="../adxdk/using-xquery-processor-for-Java.html#ADXDK99930" target="_blank"><span><cite>Oracle XML Developer's Kit程序员指南</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" title="XQuery语言是您与Oracle XML DB中的XML数据交互的主要方式之一。对该语言的支持包括SQL * Plus commandXQUERY和SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast。">XQuery和Oracle XML DB</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB5103"></a><div class="props_rev_3"><a id="GUID-8686CFE4-C9C3-44A3-8A45-868A5EA34FA8" name="GUID-8686CFE4-C9C3-44A3-8A45-868A5EA34FA8"></a><h4 id="ADXDB-GUID-8686CFE4-C9C3-44A3-8A45-868A5EA34FA8" class="sect4"><span class="enumeration_section">4.2.1</span>何时使用XQuery</h4>
                  <div>
                     <p>您可以使用XQuery执行许多与使用SQL / XML生成函数或XSLT相同的操作;有很多重叠。使用一个或另一个工具完成给定任务的决定可以基于许多考虑因素，其中大多数考虑因素并非特定于Oracle数据库。有关此一般问题，请参阅外部文档。</p>
                     <p>一般的使用模式是，当焦点是XML数据的世界时经常使用XQuery，并且当焦点是关系数据的世界时，经常使用SQL / XML生成函数（ <code class="codeph">XMLElement</code> ， <code class="codeph">XMLAgg</code>等）。
                     </p>
                     <p>在其他条件相同的情况下，如果查询从现有XML文档中提取的片段构造XML文档，那么XQuery FLOWR表达式可能比从关系数据中提取标量值并使用SQL构造适当的XML数据更简单（简化代码维护） / XML生成函数。相反，如果查询从现有关系数据构造XML文档，则SQL / XML生成函数通常更合适。</p>
                     <p>对于Oracle XML DB，使用SQL / XML生成函数可以获得与<code class="codeph">XMLQuery</code>和<code class="codeph">XMLTable</code>相同的一般性能级别 - 所有这些都需要进行重写优化。
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-7DB63F8C-F441-4635-A185-4016016B22CE" title="Oracle XML DB对XQuery语言的支持是通过SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast的本机实现提供的。为方便起见，还提供了SQL * Plus命令XQUERY，它允许您直接输入XQuery表达式 - 实际上，此命令将SQL * Plus转换为XQuery命令行解释器。">Oracle XML DB中的XQuery概述</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5105"></a><a id="ADXDB5104"></a><div class="props_rev_3"><a id="GUID-2DBF9D49-9C20-45F8-BB11-CB68DAF4F702" name="GUID-2DBF9D49-9C20-45F8-BB11-CB68DAF4F702"></a><h4 id="ADXDB-GUID-2DBF9D49-9C20-45F8-BB11-CB68DAF4F702" class="sect4"><span class="enumeration_section">4.2.2</span>预定义的XQuery命名空间和前缀</h4>
                  <div>
                     <p>预定义了几个名称空间和前缀，以便与Oracle XML DB中的XQuery一起使用。</p>
                     <div class="tblformalwide" id="GUID-2DBF9D49-9C20-45F8-BB11-CB68DAF4F702__GUID-C082A7D9-3289-4D4E-8F2A-BFA3AA934064">
                        <p class="titleintable">表4-2预定义的命名空间和前缀</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="预定义的命名空间和前缀" width="100%" border="1" summary="This table lists predefined namespaces and prefixes  for use with XQuery in Oracle XML DB." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="7%" id="d20054e1921">字首</th>
                                 <th align="left" valign="bottom" width="56%" id="d20054e1924">命名空间</th>
                                 <th align="left" valign="bottom" width="37%" id="d20054e1927">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="7%" id="d20054e1932" headers="d20054e1921 ">
                                    <p><code class="codeph">ORA</code></p>
                                 </td>
                                 <td align="left" valign="top" width="56%" headers="d20054e1932 d20054e1924 ">
                                    <p><code class="codeph">http://xmlns.oracle.com/xdb</code></p>
                                 </td>
                                 <td align="left" valign="top" width="37%" headers="d20054e1932 d20054e1927 ">
                                    <p>Oracle XML DB命名空间</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="7%" id="d20054e1944" headers="d20054e1921 ">
                                    <p><code class="codeph">本地</code></p>
                                 </td>
                                 <td align="left" valign="top" width="56%" headers="d20054e1944 d20054e1924 ">
                                    <p><code class="codeph">http://www.w3.org/2003/11/xpath-local-functions</code></p>
                                 </td>
                                 <td align="left" valign="top" width="37%" headers="d20054e1944 d20054e1927 ">
                                    <p>XPath本地函数声明命名空间</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="7%" id="d20054e1956" headers="d20054e1921 ">
                                    <p><code class="codeph">FN</code></p>
                                 </td>
                                 <td align="left" valign="top" width="56%" headers="d20054e1956 d20054e1924 ">
                                    <p><code class="codeph">http://www.w3.org/2003/11/xpath-functions</code></p>
                                 </td>
                                 <td align="left" valign="top" width="37%" headers="d20054e1956 d20054e1927 ">
                                    <p>XPath函数名称空间</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="7%" id="d20054e1968" headers="d20054e1921 ">
                                    <p><code class="codeph">XML</code></p>
                                 </td>
                                 <td align="left" valign="top" width="56%" headers="d20054e1968 d20054e1924 ">
                                    <p><code class="codeph">http://www.w3.org/XML/1998/namespace</code></p>
                                 </td>
                                 <td align="left" valign="top" width="37%" headers="d20054e1968 d20054e1927 ">
                                    <p>XML命名空间</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="7%" id="d20054e1980" headers="d20054e1921 ">
                                    <p><code class="codeph">XS</code></p>
                                 </td>
                                 <td align="left" valign="top" width="56%" headers="d20054e1980 d20054e1924 ">
                                    <p><code class="codeph">http://www.w3.org/2001/XMLSchema</code></p>
                                 </td>
                                 <td align="left" valign="top" width="37%" headers="d20054e1980 d20054e1927 ">
                                    <p>XML Schema名称空间</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="7%" id="d20054e1992" headers="d20054e1921 ">
                                    <p><code class="codeph">XSI</code></p>
                                 </td>
                                 <td align="left" valign="top" width="56%" headers="d20054e1992 d20054e1924 ">
                                    <p><code class="codeph">http://www.w3.org/2001/XMLSchema-instance</code></p>
                                 </td>
                                 <td align="left" valign="top" width="37%" headers="d20054e1992 d20054e1927 ">
                                    <p>XML Schema实例名称空间</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p>您可以在XQuery表达式中使用这些前缀，而无需先在XQuery表达式序言中声明它们。你可以在prolog中重新定义<span class="italic">除</span> <code class="codeph">xml</code> <span class="italic">之外的</span>任何一个。除<code class="codeph">ora</code>之外的所有这些前缀都是在XQuery标准中预定义的。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-7DB63F8C-F441-4635-A185-4016016B22CE" title="Oracle XML DB对XQuery语言的支持是通过SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast的本机实现提供的。为方便起见，还提供了SQL * Plus命令XQUERY，它允许您直接输入XQuery表达式 - 实际上，此命令将SQL * Plus转换为XQuery命令行解释器。">Oracle XML DB中的XQuery概述</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDB5093"></a><div class="props_rev_3"><a id="GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392" name="GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392"></a><h3 id="ADXDB-GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392" class="sect3"><span class="enumeration_section">4.3</span> SQL / XML函数XMLQUERY，XMLTABLE，XMLExists和XMLCast</h3>
               <div>
                  <p>SQL / XML函数<code class="codeph">XMLQuery</code> ， <code class="codeph">XMLTable</code> ， <code class="codeph">XMLExists</code>和<code class="codeph">XMLCast</code>由SQL / XML标准定义为SQL和XQuery语言之间的通用接口。
                  </p>
                  <p>它们在本书中称为SQL / XML <span class="italic">查询和更新</span>函数。与其他SQL / XML函数一样，这些函数可以让您充分利用SQL和XML的强大功能和灵活性。使用这些函数，您可以使用关系数据构建XML数据，查询关系数据，就像它是XML一样，并从XML数据构造关系数据。
                  </p>
                  <p>SQL函数<code class="codeph">XMLExists</code>和<code class="codeph">XMLCast</code>在本章的其他地方有记录。本节介绍<code class="codeph">XMLQuery</code>和<code class="codeph">XMLTable</code>函数，但本章中的许多示例也使用<code class="codeph">XMLExists</code>和<code class="codeph">XMLCast</code> 。在典型用途方面：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">XMLQuery</code>和<code class="codeph">XMLCast</code>通常用于<code class="codeph">SELECT</code>列表。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">XMLTable</code>通常用在SQL <code class="codeph">FROM</code>子句中。
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">XMLExists</code>通常用于SQL <code class="codeph">WHERE</code>子句中。
                        </p>
                     </li>
                  </ul>
                  <p><code class="codeph">XMLQuery</code>和<code class="codeph">XMLTable</code>评估XQuery表达式。在XQuery语言中，表达式始终返回一系列项。函数<code class="codeph">XMLQuery</code>聚合此序列中的项以返回单个XML文档或片段。函数<code class="codeph">XMLTable</code>返回一个SQL表，其每行包含XQuery序列中的一个项。
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-39CDBF4D-258D-4CFE-AEBF-06ECD660C08D">Oracle XML DB中的XMLQUERY SQL / XML函数</a><br>使用SQL / XML函数<code class="codeph">XMLQuery</code>构造或查询XML数据。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-F4508470-D420-4B5A-B5DF-59A424887F10">Oracle XML DB中的XMLTABLE SQL / XML函数</a><br>您可以使用SQL / XML函数<code class="codeph">XMLTable</code>将XQuery表达式求值的结果分解为新虚拟表的关系行和列。您可以将此数据插入到预先存在的数据库表中，也可以使用SQL在连接表达式中查询它。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-46B9D31A-3A4B-4902-A8C8-E6C72E0E74B6">XMLEXISTS Oracle XML DB中的SQL / XML函数</a><br>SQL / XML标准函数<code class="codeph">XMLExists</code>检查给定的XQuery表达式是否返回非空的XQuery序列。如果是，则该函数返回<code class="codeph">TRUE</code> 。否则，它返回<code class="codeph">FALSE</code> 。</li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-5BE322B0-9CAD-4FC9-A9B5-4BB24B5A9F09">使用XMLExists查找节点</a><br>您可以使用SQL / XML标准函数<code class="codeph">XMLExists</code>来查找给定节点。您可以使用<code class="codeph">XMLExists</code>创建基于函数的索引。您还可以创建<code class="codeph">XMLIndex</code>索引以帮助加速任意XQuery搜索。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-5FE935A0-FA5A-447F-8F23-9AE2AF7BB6CB">Oracle XML DB中的XMLCAST SQL / XML函数</a><br>您可以使用SQL / XML函数<code class="codeph">XMLCast</code>将XQuery值转换为SQL数据类型。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-A96B4300-2478-43AF-855F-7E104CCE925A">使用XMLCAST提取XML片段的标量值</a><br>您可以使用标准SQL / XML函数<code class="codeph">XMLCast</code>来提取XML片段的标量值。
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392__GUID-F1AFE77A-6B26-4920-BC53-E8AFFB715196">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关Oracle对SQL / XML标准的支持的信息，请<a href="../sqlrf/Oracle-Compliance-with-SQLXML2011.html#SQLRF55529" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                        </li>
                        <li>
                           <p>有关XQuery语言的信息， <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdb&amp;id=w3_org_xquery_30" target="_blank"><code class="codeph">http://www.w3.org/TR/xquery-30/</code></a></p>
                        </li>
                        <li>
                           <p><a href="generation-of-XML-data-from-relational-data.html#GUID-0B4F8285-CB3B-42D1-94AC-7397BBAFC967" title="Oracle XML DB提供了可用于构造XML数据的SQL函数。其中大多数都属于SQL / XML标准。">使用SQL函数生成XML数据，</a>以获取有关将其他SQL / XML函数与Oracle XML DB一起使用的信息</p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" title="XQuery语言是您与Oracle XML DB中的XML数据交互的主要方式之一。对该语言的支持包括SQL * Plus commandXQUERY和SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast。">XQuery和Oracle XML DB</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB5095"></a><a id="ADXDB5096"></a><a id="ADXDB5094"></a><div class="props_rev_3"><a id="GUID-39CDBF4D-258D-4CFE-AEBF-06ECD660C08D" name="GUID-39CDBF4D-258D-4CFE-AEBF-06ECD660C08D"></a><h4 id="ADXDB-GUID-39CDBF4D-258D-4CFE-AEBF-06ECD660C08D" class="sect4"><span class="enumeration_section">4.3.1</span> Oracle XML DB中的XMLQUERY SQL / XML函数</h4>
                  <div>
                     <p>使用SQL / XML函数<code class="codeph">XMLQuery</code>构造或查询XML数据。
                     </p>
                     <div class="section">
                        <p>该函数将<span class="italic">XQuery表达式</span> （作为字符串文字）和可选的XQuery <span class="italic">上下文项</span>作为参数作为SQL表达式。上下文项建立了评估XQuery表达式的XPath上下文。此外， <code class="codeph">XMLQuery</code>接受任意数量的SQL表达式作为参数，这些表达式的值在XQuery表达式求值期间绑定到XQuery变量。
                        </p>
                        <p>该函数返回评估XQuery表达式的结果，作为<code class="codeph">XMLType</code>实例。
                        </p>
                        <div class="figure" id="GUID-39CDBF4D-258D-4CFE-AEBF-06ECD660C08D__GUID-5949ADC3-2BA0-4D1B-B977-2392E58209CE">
                           <p class="titleinfigure">图4-1 XMLQUERY语法</p><img src="img/xmlquery.gif" width="572" alt="下面是图4-1的描述" title="下面是图4-1的描述" longdesc="img_text/xmlquery.html"><br><a href="img_text/xmlquery.html">“图4-1 XMLQUERY语法”的说明</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-39CDBF4D-258D-4CFE-AEBF-06ECD660C08D__GUID-EE69233D-3CC9-4A42-8370-347462A28F2C"><span class="italic">XML_passing_clause :: =</span></p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="figure" id="GUID-39CDBF4D-258D-4CFE-AEBF-06ECD660C08D__GUID-8DD05470-F308-4A02-B114-EEFFB46AA784"><img src="img/xml_passing_clause.gif" width="373" alt="下面是xml_passing_clause.eps的描述" title="下面是xml_passing_clause.eps的描述" longdesc="img_text/xml_passing_clause.html"><br><a href="img_text/xml_passing_clause.html">插图说明xml_passing_clause.eps</a></div>
                        <!-- class="figure" -->
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="italic"><code class="codeph">XQuery_string</code></span>是一个完整的XQuery表达式，可能包括一个prolog，作为文字字符串。
                              </p>
                           </li>
                           <li>
                              <p>该<span class="italic"><code class="codeph">XML_passing_clause</code></span>是关键字<code class="codeph">PASSING</code>接着是一个或多个SQL表达式（ <span class="italic"><code class="codeph">expr</code></span> ），每个返回<code class="codeph">XMLType</code>实例或SQL标量数据类型的实例（即，不是一个对象或集合数据类型）。每个表达式（ <span class="italic"><code class="codeph">expr</code></span> ）可以是表或视图列值，PL / SQL变量或具有适当强制转换的绑定变量。除了可能的一个表达式之外，所有表达式都必须后跟关键字<code class="codeph">AS</code>和XQuery <span class="italic"><code class="codeph">identifier</code></span> 。评估每个<span class="italic"><code class="codeph">expr</code></span>的结果绑定到用于评估<span class="italic"><code class="codeph">XQuery_string</code></span>的相应<span class="italic"><code class="codeph">identifier</code></span> 。如果存在未跟随<code class="codeph">AS</code>子句的<span class="italic"><code class="codeph">expr</code></span> ，则评估该<span class="italic"><code class="codeph">expr</code></span>的结果将用作评估<span class="italic"><code class="codeph">XQuery_string</code></span>的<span class="italic">上下文</span>项。Oracle XML DB仅支持传递<code class="codeph">BY VALUE</code> ，而不传递<code class="codeph">BY REFERENCE</code> ，因此<code class="codeph">BY VALUE</code>子句是隐式的，可以省略。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">RETURNING</code> <code class="codeph">CONTENT</code>表示<code class="codeph">XMLQuery</code>应用程序返回的值是参数化XML类型<code class="codeph">XML(CONTENT)</code>的实例，而不是参数化类型<code class="codeph">XML(SEQUENCE)</code> 。它是符合<span class="italic">扩展</span> Infoset数据模型的文档片段。因此，它是具有任意数量子节点的单个文档节点。子节点可以是任何XML节点类型;特别是，它们可以是文本节点。
                              </p>
                              <p>Oracle XML DB仅支持SQL / XML函数<code class="codeph">XMLQuery</code>的<code class="codeph">RETURNING CONTENT</code>子句;它<span class="italic">不</span>支持<code class="codeph">RETURNING SEQUENCE</code>子句。
                              </p>
                           </li>
                        </ul>
                        <p>您可以将<code class="codeph">XMLType</code>列，表或视图作为context-item参数传递给函数<code class="codeph">XMLQuery</code> - 例如，请参见<a href="query-and-update-XML.html#GUID-1165391D-BA6A-460F-BA44-66AA4A1F6595__CBADDAEJ">示例5-8</a> 。
                        </p>
                        <p>要查询关系表或视图，就好像它是XML数据一样，而不必先在其上创建SQL / XML视图，在XQuery表达式中使用XQuery函数<code class="codeph">fn:collection</code> ，将URI作为参数传递给使用URI的URI- scheme name <code class="codeph">oradb</code>以及数据的数据库位置。请参阅<a href="xquery-and-XML-DB.html#GUID-7B039748-7C2A-4D86-9C54-55F4D08ED59B" title="您可以使用XQuery函数fn：collection来查询数据库表和视图中的数据。">URI Scheme oradb：使用XQuery查询表或查看数据</a> 。
                        </p>
                        <div class="infoboxnote" id="GUID-39CDBF4D-258D-4CFE-AEBF-06ECD660C08D__GUID-26743142-E095-4BF3-91EE-6E9917038A40">
                           <p class="notep1">注意：</p>
                           <p>在Oracle Database 11g第2版之前，一些用户使用Oracle SQL函数<code class="codeph">extract</code>和<code class="codeph">extractValue</code>来完成使用SQL / XML函数<code class="codeph">XMLQuery</code>和<code class="codeph">XMLCast</code>可以做得更好的一些事情。Oracle Database 11g第2版中<span class="italic">不推荐使用</span> SQL函数<code class="codeph">extract</code>和<code class="codeph">extractValue</code> 。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-39CDBF4D-258D-4CFE-AEBF-06ECD660C08D__GUID-057688BE-89D5-4DE4-8F00-3BE6BA782D4C">
                        <p class="notep1">也可以看看：</p>
                        <p><a href="../sqlrf/XMLQUERY.html#SQLRF06209" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a>有关Oracle数据库中SQL / XML函数<code class="codeph">XMLQuery</code>参考信息</p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392" title="SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast由SQL / XML标准定义为SQL和XQuery语言之间的通用接口。">SQL / XML函数XMLQUERY，XMLTABLE，XMLExists和XMLCast</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5098"></a><a id="ADXDB5099"></a><a id="ADXDB5100"></a><a id="ADXDB5101"></a><a id="ADXDB5102"></a><a id="ADXDB5097"></a><div class="props_rev_3"><a id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10" name="GUID-F4508470-D420-4B5A-B5DF-59A424887F10"></a><h4 id="ADXDB-GUID-F4508470-D420-4B5A-B5DF-59A424887F10" class="sect4"><span class="enumeration_section">4.3.2</span> Oracle XML DB中的XMLTABLE SQL / XML函数</h4>
                  <div>
                     <p>您可以使用SQL / XML函数<code class="codeph">XMLTable</code>将XQuery表达式求值的结果分解为新虚拟表的关系行和列。您可以将此数据插入到预先存在的数据库表中，也可以使用SQL在连接表达式中查询它。
                     </p>
                     <div class="section">
                        <p>见<a href="query-and-update-XML.html#GUID-1165391D-BA6A-460F-BA44-66AA4A1F6595__CBAHBFGE">例5-9</a> 。
                        </p>
                        <p>您在SQL <code class="codeph">FROM</code>子句中使用<code class="codeph">XMLTable</code> 。
                        </p>
                        <div class="figure" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-B85490F0-F81B-4EBA-B66B-CAA4F604A14F">
                           <p class="titleinfigure">图4-2 XMLTABLE语法</p><img src="img/xmltable.gif" width="482" alt="下面是图4-2的描述" title="下面是图4-2的描述" longdesc="img_text/xmltable.html"><br><a href="img_text/xmltable.html">“图4-2 XMLTABLE语法”的说明</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-C23FDE22-744A-4F94-8233-4FD96ECD7B56"><span class="italic">XML_namespaces_clause :: =</span></p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="figure" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-55CA4B10-7AF2-4267-B4E9-97D32D783A1B"><img src="img/xml_namespaces_clause.gif" alt="下面是xml_namespaces_clause.eps的说明" title="下面是xml_namespaces_clause.eps的说明" longdesc="img_text/xml_namespaces_clause.html"><br><a href="img_text/xml_namespaces_clause.html">插图说明xml_namespaces_clause.eps</a><p><span class="bold">注意：</span>您最多可以指定一个DEFAULT <span class="italic">字符串</span>子句。
                           </p>
                        </div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-DC1611CC-1F25-4A30-809D-D266AA170CD7"><span class="italic">XMLTABLE_options :: =</span></p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="figure" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-1F93FAB4-CDF9-4E02-ADE6-0AAEA6CC6D48"><img src="img/xmltable_options.gif" width="619" alt="下面是xmltable_options.eps的描述" title="下面是xmltable_options.eps的描述" longdesc="img_text/xmltable_options.html"><br><a href="img_text/xmltable_options.html">说明xmltable_options.eps的说明</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-CD5685A9-97FD-412C-8252-1DACCCD76675"><span class="italic">XML_passing_clause :: =</span></p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="figure" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-447FD369-E6FC-40BE-8617-22B8E9C6DDD5"><img src="img/xml_passing_clause.gif" width="373" alt="下面是xml_passing_clause.eps的描述" title="下面是xml_passing_clause.eps的描述" longdesc="img_text/xml_passing_clause.html"><br><a href="img_text/xml_passing_clause.html">插图说明xml_passing_clause.eps</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-1D3F22F4-928E-4EAE-952D-BFC9D6FEAFC7"><span class="italic">XML_table_column :: =</span></p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="figure" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-C286CD70-ABAA-48B9-92F5-2408B2C78985"><img src="img/xml_table_column.gif" width="598" alt="下面是xml_table_column.eps的描述" title="下面是xml_table_column.eps的描述" longdesc="img_text/xml_table_column.html"><br><a href="img_text/xml_table_column.html">插图说明xml_table_column.eps</a></div>
                        <!-- class="figure" -->
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="italic"><code class="codeph">XQuery_string</code></span>有时被称为XMLTable调用的<strong class="term">行模式</strong> 。它是一个完整的XQuery表达式，可能包括一个prolog，作为文字字符串。表达式的值用作<code class="codeph">XMLTable</code>函数的输入;这个XQuery结果被分解并存储为关系数据。
                              </p>
                           </li>
                           <li>
                              <p>可选的<code class="codeph">XMLNAMESPACES</code>子句包含被引用的XML命名空间声明<span class="italic"><code class="codeph">XQuery_string</code></span>并通过在XPath表达式<code class="codeph">PATH</code>的条款<span class="italic"><code class="codeph">XML_table_column</code></span> 。
                              </p>
                           </li>
                           <li>
                              <p>该<span class="italic"><code class="codeph">XML_passing_clause</code></span>是关键字<code class="codeph">PASSING</code>接着是一个或多个SQL表达式（ <span class="italic"><code class="codeph">expr</code></span> ），每个返回<code class="codeph">XMLType</code>实例或SQL标量数据类型的实例（即，不是一个对象或集合数据类型）。每个表达式（ <span class="italic"><code class="codeph">expr</code></span> ）可以是表或视图列值，PL / SQL变量或具有适当强制转换的绑定变量。除了可能的一个表达式之外，所有表达式都必须后跟关键字<code class="codeph">AS</code>和XQuery <span class="italic"><code class="codeph">identifier</code></span> 。评估每个<span class="italic"><code class="codeph">expr</code></span>的结果绑定到用于评估<span class="italic"><code class="codeph">XQuery_string</code></span>的相应<span class="italic"><code class="codeph">identifier</code></span> 。如果存在未跟随<code class="codeph">AS</code>子句的<span class="italic"><code class="codeph">expr</code></span> ，则评估该<span class="italic"><code class="codeph">expr</code></span>的结果将用作评估<span class="italic"><code class="codeph">XQuery_string</code></span>的<span class="italic">上下文</span>项。Oracle XML DB仅支持传递<code class="codeph">BY VALUE</code> ，而不传递<code class="codeph">BY REFERENCE</code> ，因此<code class="codeph">BY VALUE</code>子句是隐式的，可以省略。
                              </p>
                           </li>
                           <li>
                              <p>可选的<code class="codeph">COLUMNS</code>子句定义要由<code class="codeph">XMLTable</code>创建的虚拟表的列。
                              </p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>如果省略<code class="codeph">COLUMNS</code>子句，则<code class="codeph">XMLTable</code>将返回一个具有单个<code class="codeph">XMLType</code>伪列的行，名为<span class="bold"><code class="codeph">COLUMN_VALUE</code></span> 。</p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">FOR ORDINALITY</code>指定该<span class="italic"><code class="codeph">column</code></span>是生成的行号列（SQL数据类型<code class="codeph">NUMBER</code> ）。行号以1开头。最多必须有一个<code class="codeph">FOR ORDINALITY</code>条款。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于除<code class="codeph">FOR ORDINALITY</code> <span class="italic"><code class="codeph">column</code></span>之外的每个结果<span class="italic"><code class="codeph">column</code></span> ，必须指定列数据类型，该类型可以是<code class="codeph">XMLType</code>或任何其他SQL数据类型（在语法描述中称为<span class="italic"><code class="codeph">datatype</code></span> ）。
                                    </p>
                                 </li>
                                 <li>
                                    <p>对于数据类型<code class="codeph">XMLType</code> ，如果还包括规范<code class="codeph">(SEQUENCE) BY REF</code>则返回对<code class="codeph">PATH</code>表达式（ <span class="italic"><code class="codeph">string</code></span> ）所针对的源数据的<span class="italic">引用</span>作为<span class="italic"><code class="codeph">column</code></span>内容。否则， <span class="italic"><code class="codeph">column</code></span>包含该目标数据的<span class="italic">副本</span> 。
                                    </p>
                                    <p>通过引用返回<code class="codeph">XMLType</code>数据，您可以指定其路径以源数据中的节点为目标，而不是<span class="italic"><code class="codeph">column</code></span>的<code class="codeph">PATH</code>表达式所针对的节点的其他列。见<a href="query-and-update-XML.html#GUID-1165391D-BA6A-460F-BA44-66AA4A1F6595__BABIDCFE">例5-13</a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>可选的<code class="codeph">PATH</code>子句指定由XQuery表达式<span class="italic"><code class="codeph">string</code></span>寻址的XQuery结果部分将用作<span class="italic"><code class="codeph">column</code></span>内容。此XQuery表达式有时称为<span class="bold">列模式</span> 。您可以使用多个<code class="codeph">PATH</code>子句将XQuery结果拆分为不同的虚拟表列。
                                    </p>
                                    <p>如果省略<code class="codeph">PATH</code> ，则假定使用XQuery表达式<span class="italic"><code class="codeph">column</code></span> 。例如，这两个表达式是等价的：</p><pre class="oac_no_warn" dir="ltr">XMLTable的（...COLUMNS foo）XMLTable（...专栏foo PATH'FOO'）</pre><p>XQuery表达式<span class="italic"><code class="codeph">string</code></span>必须表示<span class="italic">相对</span>路径;它相对于路径<span class="italic"><code class="codeph">XQuery_string</code></span> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>可选的<code class="codeph">DEFAULT</code>子句指定<code class="codeph">PATH</code>表达式导致空序列（或<code class="codeph">NULL</code> ）时要使用的值。它的<span class="italic"><code class="codeph">expr</code></span>是一个XQuery表达式，它被计算以产生默认值。
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-FF0F3AA8-D2A7-457A-97B7-EBB42D7C4ACB">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="../sqlrf/XMLTABLE.html#SQLRF06232" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a>有关Oracle数据库中SQL / XML函数<code class="codeph">XMLTable</code>参考信息</p>
                        </div>
                        <div class="infoboxnote" id="GUID-F4508470-D420-4B5A-B5DF-59A424887F10__GUID-A2D89F13-FE6B-424B-BF70-BC904227B704">
                           <p class="notep1">注意：</p>
                           <p>在Oracle Database 11g第2版之前，一些用户在SQL <code class="codeph">TABLE</code>集合表达式中使用Oracle SQL函数<code class="codeph">XMLSequence</code> ，即<code class="codeph">TABLE (XMLSequence(...))</code> ，可以使用SQL / XML函数<code class="codeph">XMLTable</code>做一些可以做得更好的事情。 。函数<code class="codeph">XMLSequence</code>在Oracle Database 11g第2版中<span class="italic">已弃用</span> 。
                           </p>
                           <p>有关SQL <code class="codeph">TABLE</code>集合表达式的信息，请参见<a href="../sqlrf/SELECT.html#SQLRF30047" target="_blank"><span><cite>Oracle数据库SQL语言参考</cite></span></a> 。
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-B5B1706E-21E9-4F05-8AD6-C179F705888E">链接调用SQL / XML函数XMLTABLE</a><br>当您需要将<code class="codeph">XMLType</code>表中多个级别包含的数据公开为关系表（或视图）中的各个行时，使用与拆分单个级别相同的一般方法：使用SQL / XML函数<code class="codeph">XMLTable</code>定义列组成表并将XML节点映射到这些列。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392" title="SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast由SQL / XML标准定义为SQL和XQuery语言之间的通用接口。">SQL / XML函数XMLQUERY，XMLTABLE，XMLExists和XMLCast</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADXDB6416"></a><a id="ADXDB6415"></a><div class="props_rev_3"><a id="GUID-B5B1706E-21E9-4F05-8AD6-C179F705888E" name="GUID-B5B1706E-21E9-4F05-8AD6-C179F705888E"></a><h5 id="ADXDB-GUID-B5B1706E-21E9-4F05-8AD6-C179F705888E" class="sect5"><span class="enumeration_section">4.3.2.1</span>链接调用SQL / XML函数XMLTABLE</h5>
                     <div>
                        <p>当您需要将<code class="codeph">XMLType</code>表中多个级别包含的数据公开为关系表（或视图）中的各个行时，使用与拆分单个级别相同的一般方法：使用SQL / XML函数<code class="codeph">XMLTable</code>定义列组成表并将XML节点映射到这些列。
                        </p>
                        <div class="section">
                           <p>但在这种情况下，您将函数<code class="codeph">XMLTable</code>应用于要<code class="codeph">XMLTable</code>并存储在关系列中的每个文档级别。只要<code class="codeph">XMLType</code>表中的文档与关系表中的行之间存在<span class="italic">一对多</span> （1：N）关系，就可以使用这种<strong class="term">链接</strong>多个<code class="codeph">XMLTable</code>调用的技术。
                           </p>
                           <p>您将一个<code class="codeph">XMLType</code>数据从一个<code class="codeph">XMLTable</code>调用传递到下一个，将其列类型指定为<code class="codeph">XMLType</code> 。
                           </p>
                           <p>当您链接两个<code class="codeph">XMLTable</code>调用时，每个调用的<span class="italic">行模式</span>应该以<span class="italic">最深节点为</span>目标，该节点是该调用的<span class="italic">列模式</span>中引用的所有<span class="italic">节点的共同祖先</span> 。
                           </p>
                           <p>这在<a href="xquery-and-XML-DB.html#GUID-B5B1706E-21E9-4F05-8AD6-C179F705888E__BABGABBE">例4-1中</a>说明。
                           </p>
                           <p><code class="codeph">XMLType</code>表<code class="codeph">po_binaryxml</code>中的每个<code class="codeph">PurchaseOrder</code>元素<code class="codeph">po_binaryxml</code>包含一个<code class="codeph">LineItems</code>元素，该元素又包含一个或多个<code class="codeph">LineItem</code>元素。每个<code class="codeph">LineItem</code>元素都有子元素，例如<code class="codeph">Description</code>和<code class="codeph">ItemNumber</code>属性。要使这些较低级别的数据可作为关系值访问，可以使用<code class="codeph">XMLTable</code>来投影<code class="codeph">LineItem</code>元素的集合。
                           </p>
                           <p>当元素<code class="codeph">PurchaseOrder</code>通过第一次调用<code class="codeph">XMLTable</code>分解时，其后代<code class="codeph">LineItem</code>元素将映射到<code class="codeph">XMLType</code>类型的列，该列包含XML片段。然后将该列传<code class="codeph">XMLTable</code>对<code class="codeph">XMLTable</code>的第二次调用，将其作为多列关系值分解为各个部分。
                           </p>
                           <p>对<code class="codeph">XMLTable</code>的第一次调用使用<code class="codeph">/PurchaseOrder</code>作为行模式，因为<code class="codeph">PurchaseOrder</code>是列模式的最深的共同祖先节点， <code class="codeph">Reference</code>和<code class="codeph">LineItems/LineItem</code> 。
                           </p>
                           <p>对<code class="codeph">XMLTable</code>的第二次调用使用<code class="codeph">/LineItem</code>作为其行模式，因为该节点是其每个列模式（ <code class="codeph">Part/@Id</code> <code class="codeph">@ItemNumber</code> ， <code class="codeph">Description</code> ， <code class="codeph">Part/@Id</code>等）的最深的共同祖先节点。
                           </p>
                           <p>从第一个<code class="codeph">XMLTable</code>调用传递到第二个的列（ <code class="codeph">po.lineitem</code> ）的<span class="italic">列模式</span> （ <code class="codeph">LineItems/LineItem</code> ）以第二个<code class="codeph">XMLTable</code>调用分解<span class="italic">的重复元素</span> （ <code class="codeph">LineItem</code> ） <span class="italic">结束</span> 。用前导斜杠（ <code class="codeph">/</code> ）编写的重复元素用作第二个<code class="codeph">XMLTable</code>调用的<span class="italic">行模式</span>的第一个元素。
                           </p>
                           <p>因此，每种情况下的行模式表示为<span class="italic">绝对</span>路径;也就是说，它以<code class="codeph">/</code>开头。它是<code class="codeph">XMLTable</code>分解的起点。另一方面，列模式<span class="italic">从不</span>以斜杠（ <code class="codeph">/</code> ）开头;它们始终相对于同一<code class="codeph">XMLTable</code>调用的行模式。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-B5B1706E-21E9-4F05-8AD6-C179F705888E__BABGABBE">
                           <p class="titleinexample">示例4-1链接XMLTable调用</p><pre class="oac_no_warn" dir="ltr">SELECT po.reference，li。* FROM po_binaryxml p，XMLTable（' <span class="bold">/ PurchaseOrder'PASSING</span> p。OBJECT_VALUE COLUMNS引用VARCHAR2（30）PATH'引用'， <span class="bold">lineitem</span> XMLType PATH'LineItems <span class="bold">/ LineItem</span> '）po，XMLTable（' <span class="bold">/ LineItem'PASSING</span> <span class="bold">po.lineitem</span> COLUMNS itemno NUMBER（38）PATH' @ ItemNumber'，description VARCHAR2（256） PATH'描述'，partno VARCHAR2（14）PATH'Part / @ Id'，数量NUMBER（12,2）PATH'Part / @ Quantity'，unitprice NUMBER（8,4）PATH'Part / @ UnitPrice'）li;</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-F4508470-D420-4B5A-B5DF-59A424887F10" title="您可以使用SQL / XML函数XMLTable将XQuery表达式求值的结果分解为新虚拟表的关系行和列。您可以将此数据插入到预先存在的数据库表中，也可以使用SQL在连接表达式中查询它。">Oracle XML DB中的XMLTABLE SQL / XML函数</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="ADXDB4239"></a><a id="ADXDB4240"></a><a id="ADXDB4238"></a><div class="props_rev_3"><a id="GUID-46B9D31A-3A4B-4902-A8C8-E6C72E0E74B6" name="GUID-46B9D31A-3A4B-4902-A8C8-E6C72E0E74B6"></a><h4 id="ADXDB-GUID-46B9D31A-3A4B-4902-A8C8-E6C72E0E74B6" class="sect4"><span class="enumeration_section">4.3.3</span> XMLEXISTS Oracle XML DB中的SQL / XML函数</h4>
                  <div>
                     <p>SQL / XML标准函数<code class="codeph">XMLExists</code>检查给定的XQuery表达式是否返回非空的XQuery序列。如果是，则该函数返回<code class="codeph">TRUE</code> 。否则，它返回<code class="codeph">FALSE</code> 。</p>
                     <div class="section">
                        <p><a href="xquery-and-XML-DB.html#GUID-46B9D31A-3A4B-4902-A8C8-E6C72E0E74B6__CFHIBEGB">图4-3</a>描述了函数<code class="codeph">XMLExists</code>的语法。
                        </p>
                        <div class="figure" id="GUID-46B9D31A-3A4B-4902-A8C8-E6C72E0E74B6__CFHIBEGB">
                           <p class="titleinfigure">图4-3 XMLExists语法</p><img src="img/xmlexists.gif" width="475" alt="下面是图4-3的描述" title="下面是图4-3的描述" longdesc="img_text/xmlexists.html"><br><a href="img_text/xmlexists.html">“图4-3 XMLExists语法”的说明</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-46B9D31A-3A4B-4902-A8C8-E6C72E0E74B6__GUID-EB8CA0CA-4546-48C8-8E00-323EC13AC98D"><span class="italic">XML_passing_clause :: =</span></p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="figure" id="GUID-46B9D31A-3A4B-4902-A8C8-E6C72E0E74B6__GUID-8C4E0A2C-FA1A-4D29-BFD8-62AA1CBCE53C"><img src="img/xml_passing_clause.gif" width="373" alt="下面是xml_passing_clause.eps的描述" title="下面是xml_passing_clause.eps的描述" longdesc="img_text/xml_passing_clause.html"><br><a href="img_text/xml_passing_clause.html">插图说明xml_passing_clause.eps</a></div>
                        <!-- class="figure" -->
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="italic"><code class="codeph">XQuery_string</code></span>是一个完整的XQuery表达式，可能包括一个prolog，作为文字字符串。它可以包含绑定使用的XQuery XQuery的变量<code class="codeph">PASSING</code>子句（ <span class="italic"><code class="codeph">XML_passing_clause</code></span>语法图）。为SQL / XML函数<code class="codeph">XMLQuery</code>识别的预定义名称空间前缀也在<span class="italic"><code class="codeph">XQuery_string</code></span>被识别 - 请参阅<a href="xquery-and-XML-DB.html#GUID-2DBF9D49-9C20-45F8-BB11-CB68DAF4F702" title="预定义了几个名称空间和前缀，以便与Oracle XML DB中的XQuery一起使用。">预定义的XQuery命名空间和前缀</a> 。
                              </p>
                           </li>
                           <li>
                              <p>该<span class="italic"><code class="codeph">XML_passing_clause</code></span>是关键字<code class="codeph">PASSING</code>接着是一个或多个SQL表达式（ <span class="italic"><code class="codeph">expr</code></span> ），每个返回<code class="codeph">XMLType</code>实例或SQL标量数据类型的一个实例。除了可能的一个表达式之外，所有表达式都必须后跟关键字<code class="codeph">AS</code>和XQuery <span class="italic"><code class="codeph">identifier</code></span> 。评估每个<span class="italic"><code class="codeph">expr</code></span>的结果绑定到用于评估<span class="italic"><code class="codeph">XQuery_string</code></span>的相应<span class="italic"><code class="codeph">identifier</code></span> 。如果存在未跟随<code class="codeph">AS</code>子句的<span class="italic"><code class="codeph">expr</code></span> ，则评估该<span class="italic"><code class="codeph">expr</code></span>的结果将用作评估<span class="italic"><code class="codeph">XQuery_string</code></span>的<span class="italic">上下文</span>项。Oracle XML DB仅支持传递<code class="codeph">BY VALUE</code> ，而不传递<code class="codeph">BY REFERENCE</code> ，因此<code class="codeph">BY VALUE</code>子句是隐式的，可以省略。
                              </p>
                           </li>
                        </ul>
                        <p>如果<code class="codeph">/PurchaseOrder/Reference</code>或<code class="codeph">/PurchaseOrder/Reference/text()</code>等XQuery表达式以单个节点为目标，则<code class="codeph">XMLExists</code>将为该表达式返回<code class="codeph">true</code> 。如果使用不定位节点的XQuery表达式调用<code class="codeph">XMLExists</code> ，则<code class="codeph">XMLExists</code>返回<code class="codeph">false</code> 。
                        </p>
                        <p>函数<code class="codeph">XMLExists</code>可用于查询，它可用于创建基于函数的索引以加快查询评估。
                        </p>
                        <div class="infoboxnote" id="GUID-46B9D31A-3A4B-4902-A8C8-E6C72E0E74B6__GUID-0CE1B7FB-A216-4280-A7D2-CDE65A76F854">
                           <p class="notep1">注意：</p>
                           <p>Oracle XML DB将<code class="codeph">XMLExists</code>的使用限制为SQL <code class="codeph">WHERE</code>子句或<code class="codeph">CASE</code>表达式。如果需要在<code class="codeph">SELECT</code>列表中使用<code class="codeph">XMLExists</code> ，请将其包装在<code class="codeph">CASE</code>表达式中：</p><pre class="oac_no_warn" dir="ltr">XMLExists（...）的情况那么'真''错'错'结束</pre></div>
                        <div class="infoboxnote" id="GUID-46B9D31A-3A4B-4902-A8C8-E6C72E0E74B6__GUID-13AC1800-DF31-4342-9A28-9D11C62444D6">
                           <p class="notep1">注意：</p>
                           <p>在Oracle Database 11g第2版之前，一些用户使用Oracle SQL函数<code class="codeph">existsNode</code>来做一些可以使用SQL / XML函数<code class="codeph">XMLExists</code>做得更好的事情。函数<code class="codeph">existsNode</code>在Oracle Database 11g第2版中<span class="italic">已弃用</span> 。这两个函数在这些重要方面有所不同：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>函数<code class="codeph">existsNode</code>返回<code class="codeph">0</code>或<code class="codeph">1</code> 。函数<code class="codeph">XMLExists</code>返回一个布尔值， <code class="codeph">TRUE</code>或<code class="codeph">FALSE</code> 。</p>
                              </li>
                              <li>
                                 <p>您可以在查询<code class="codeph">SELECT</code>列表中使用<code class="codeph">existsNode</code> 。不能使用<code class="codeph">XMLExists</code>在直接<code class="codeph">SELECT</code>列表中，但可以使用<code class="codeph">XMLExists</code>一个内<code class="codeph">CASE</code>的表达<code class="codeph">SELECT</code>列表。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392" title="SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast由SQL / XML标准定义为SQL和XQuery语言之间的通用接口。">SQL / XML函数XMLQUERY，XMLTABLE，XMLExists和XMLCast</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB4241"></a><div class="props_rev_3"><a id="GUID-5BE322B0-9CAD-4FC9-A9B5-4BB24B5A9F09" name="GUID-5BE322B0-9CAD-4FC9-A9B5-4BB24B5A9F09"></a><h4 id="ADXDB-GUID-5BE322B0-9CAD-4FC9-A9B5-4BB24B5A9F09" class="sect4"><span class="enumeration_section">4.3.4</span>使用XMLExists查找节点</h4>
                  <div>
                     <p>您可以使用SQL / XML标准函数<code class="codeph">XMLExists</code>来查找给定节点。您可以使用<code class="codeph">XMLExists</code>创建基于函数的索引。您还可以创建<code class="codeph">XMLIndex</code>索引以帮助加速任意XQuery搜索。
                     </p>
                     <div class="section">
                        <p><a href="xquery-and-XML-DB.html#GUID-5BE322B0-9CAD-4FC9-A9B5-4BB24B5A9F09__CHDIJGAB">示例4-2</a>使用<code class="codeph">XMLExists</code>选择<code class="codeph">SpecialInstructions</code>设置为<code class="codeph">Expedite</code>行。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-5BE322B0-9CAD-4FC9-A9B5-4BB24B5A9F09__CHDIJGAB">
                        <p class="titleinexample">示例4-2使用SQL / XML函数XMLExists查找节点</p><pre class="pre codeblock"><code>SELECT OBJECT_VALUE FROM purchaseorder WHERE XMLExists（'/ PurchaseOrder [SpecialInstructions =“Expedite”]'PASSING OBJECT_VALUE）; OBJECT_VALUE ------------------------------------------------- ------------------- &lt;PurchaseOrder xmlns：xsi =“http://www.w3.org/2001/XMLSchema-instance”&lt;PurchaseOrder xmlns：xsi =“http ：//www.w3.org/2001/XMLSchema-instance“&lt;PurchaseOrder xmlns：xsi =”http://www.w3.org/2001/XMLSchema-instance“&lt;PurchaseOrder xmlns：xsi =”http：// www .w3.org / 2001 / XMLSchema-instance“&lt;PurchaseOrder xmlns：xsi =”http://www.w3.org/2001/XMLSchema-instance“&lt;PurchaseOrder xmlns：xsi =”http://www.w3.org / 2001 / XMLSchema-instance“&lt;PurchaseOrder xmlns：xsi =”http://www.w3.org/2001/XMLSchema-instance“&lt;PurchaseOrder xmlns：xsi =”http://www.w3.org/2001/XMLSchema -instance“&lt;PurchaseOrder xmlns：xsi =”http://www.w3.org/2001/XMLSchema-instance“&lt;PurchaseOrder xmlns：xsi =”http://www.w3.org/2001/XMLSchema-instance“&lt; PurchaseOrder xmlns：xsi =“http://www.w3.org/2001/XMLSchema-instance”&lt;PurchaseOrder xmlns：xsi =“http://www.w3.org/2001/XMLSchema-instance”&lt;PurchaseOrder xmlns：xsi =“http://www.w3.org/2001/XMLSchema-instance”选择了13行。
</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392" title="SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast由SQL / XML标准定义为SQL和XQuery语言之间的通用接口。">SQL / XML函数XMLQUERY，XMLTABLE，XMLExists和XMLCast</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB4250"></a><a id="ADXDB4249"></a><div class="props_rev_3"><a id="GUID-5FE935A0-FA5A-447F-8F23-9AE2AF7BB6CB" name="GUID-5FE935A0-FA5A-447F-8F23-9AE2AF7BB6CB"></a><h4 id="ADXDB-GUID-5FE935A0-FA5A-447F-8F23-9AE2AF7BB6CB" class="sect4"><span class="enumeration_section">4.3.5</span> Oracle XML DB中的XMLCAST SQL / XML函数</h4>
                  <div>
                     <p>您可以使用SQL / XML函数<code class="codeph">XMLCast</code>将XQuery值转换为SQL数据类型。
                     </p>
                     <div class="section">
                        <p><a href="xquery-and-XML-DB.html#GUID-5FE935A0-FA5A-447F-8F23-9AE2AF7BB6CB__CFHFDHHJ">图4-4</a>描述了SQL / XML标准函数<code class="codeph">XMLCast</code>的语法。
                        </p>
                        <div class="figure" id="GUID-5FE935A0-FA5A-447F-8F23-9AE2AF7BB6CB__CFHFDHHJ">
                           <p class="titleinfigure">图4-4 XMLCast语法</p><img src="img/xmlcast.gif" width="475" alt="下面是图4-4的描述" title="下面是图4-4的描述" longdesc="img_text/xmlcast.html"><br><a href="img_text/xmlcast.html">“图4-4 XMLCast语法”的说明</a></div>
                        <!-- class="figure" -->
                        <p>SQL / XML标准函数<code class="codeph">XMLCast</code>将其第一个参数强制转换为由其第二个参数指定的标量SQL数据类型。第一个参数是一个被评估的SQL表达式。可以使用以下任何SQL数据类型作为第二个参数：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">数</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">VARCHAR2</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">CHAR</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">CLOB</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">BLOB</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">REF XMLTYPE</code></p>
                           </li>
                           <li>
                              <p>任何SQL日期或时间数据类型</p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-5FE935A0-FA5A-447F-8F23-9AE2AF7BB6CB__GUID-865D0C07-DE7D-4FB2-A5F1-4A1471F7A912">
                           <p class="notep1">注意：</p>
                           <p>与SQL / XML标准不同，Oracle XML DB限制使用<code class="codeph">XMLCast</code>将XML转换为SQL标量数据类型。Oracle XML DB不支持将XML转换为XML或将标量SQL类型转换为XML。</p>
                        </div>
                        <p>评估第一个<code class="codeph">XMLCast</code>参数的结果是XML值。它通过使用XQuery雾化过程转换为目标SQL数据类型，然后将XQuery原子值转换为目标数据类型。如果此转换失败，则会引发错误。如果转换成功，则返回的结果是目标数据类型的实例。
                        </p>
                        <div class="infoboxnote" id="GUID-5FE935A0-FA5A-447F-8F23-9AE2AF7BB6CB__GUID-6C201840-E65C-4C21-9AF4-AE2CDE8E6511">
                           <p class="notep1">注意：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>在Oracle Database 11g第2版之前，一些用户使用Oracle SQL函数<code class="codeph">extractValue</code>来完成使用SQL / XML函数<code class="codeph">XMLQuery</code>和<code class="codeph">XMLCast</code>可以做得更好的一些事情。在Oracle Database 11g第2版中<span class="italic">不推荐使用</span>函数<code class="codeph">extractValue</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>函数<code class="codeph">extractValue</code>在其XPath表达式参数与多个文本节点匹配时引发错误。<code class="codeph">XMLCast</code>应用到<code class="codeph">XMLQuery</code>结果返回文本节点的拼接-它<span class="italic">不会</span>引发错误。
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="indexes-for-XMLType-data.html#GUID-BF638421-9D6E-4D72-8371-79D084A04BCA" title="通过在与XML节点对应的基础数据库列上创建B树索引，可以有效地索引以对象关系存储的XMLType数据。">索引XMLType数据存储对象 - 关系</a></li>
                           <li><a href="indexes-for-XMLType-data.html#GUID-6E6A5BA7-9B84-4E3D-B556-B3B286D26B46">的XMLIndex</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392" title="SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast由SQL / XML标准定义为SQL和XQuery语言之间的通用接口。">SQL / XML函数XMLQUERY，XMLTABLE，XMLExists和XMLCast</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB4251"></a><div class="props_rev_3"><a id="GUID-A96B4300-2478-43AF-855F-7E104CCE925A" name="GUID-A96B4300-2478-43AF-855F-7E104CCE925A"></a><h4 id="ADXDB-GUID-A96B4300-2478-43AF-855F-7E104CCE925A" class="sect4"><span class="enumeration_section">4.3.6</span>使用XMLCAST提取XML片段的标量值</h4>
                  <div>
                     <p>您可以使用标准SQL / XML函数<code class="codeph">XMLCast</code>来提取XML片段的标量值。
                     </p>
                     <div class="section">
                        <p><a href="xquery-and-XML-DB.html#GUID-A96B4300-2478-43AF-855F-7E104CCE925A__CHDGFGBA">例4-3中</a>的查询提取节点<code class="codeph">Reference</code>的标量值。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-A96B4300-2478-43AF-855F-7E104CCE925A__CHDGFGBA">
                        <p class="titleinexample">示例4-3使用XMLCAST提取XML片段的标量值</p><pre class="pre codeblock"><code>SELECT XMLCast（XMLQuery（'/ PurchaseOrder / Reference'PASSING OBJECT_VALUE RETURNING CONTENT）AS VARCHAR2（100））“REFERENCE”from purchaseorder WHERE XMLExists（'/ PurchaseOrder [SpecialInstructions =“Expedite”]'PASSING OBJECT_VALUE）;参考---------------------------- AMCEWEN-20021009123336271PDT SKING-20021009123336321PDT AWALSH-20021009123337303PDT JCHEN-20021009123337123PDT AWALSH-20021009123336642PDT SKING-20021009123336622PDT SKING-20021009123336822PDT AWALSH-20021009123336101PDT WSMITH-20021009123336412PDT AWALSH-20021009123337954PDT SKING-20021009123338294PDT WSMITH-20021009123338154PDT TFOX-20021009123337463PDT 13行选择。</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4805CF1C-A00D-4B88-AF2E-00A9DB6F3392" title="SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast由SQL / XML标准定义为SQL和XQuery语言之间的通用接口。">SQL / XML函数XMLQUERY，XMLTABLE，XMLExists和XMLCast</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDB5995"></a><a id="ADXDB5994"></a><div class="props_rev_3"><a id="GUID-7B039748-7C2A-4D86-9C54-55F4D08ED59B" name="GUID-7B039748-7C2A-4D86-9C54-55F4D08ED59B"></a><h3 id="ADXDB-GUID-7B039748-7C2A-4D86-9C54-55F4D08ED59B" class="sect3"><span class="enumeration_section">4.4</span> URI方案oradb：使用XQuery查询表或查看数据</h3>
               <div>
                  <p>您可以使用XQuery函数<code class="codeph">fn:collection</code>来查询数据库表和视图中的数据。
                  </p>
                  <div class="section">
                     <p>除了使用XQuery函数<code class="codeph">fn:doc</code>和<code class="codeph">fn:collection</code>来查询Oracle XML DB Repository中的资源（请参阅<a href="query-and-update-XML.html#GUID-767E262F-559F-4EBE-84C1-65683879E1D5" title="提供了在Oracle XML DB Repository中使用XQuery和XML数据的示例。您可以使用XQuery函数fn：doc和fn：collection分别查询存储库中的文件和文件夹资源。">使用XQuery查询Oracle XML DB Repository中的XML数据</a> ），您可以使用<code class="codeph">fn:collection</code>来查询数据库表和视图中的数据。
                     </p>
                     <p>为此，您可以向函数<code class="codeph">fn:collection</code>传递一个URI参数，该参数指定要查询的表或视图。Oracle URI方案<code class="codeph">oradb</code>标识了这种用法：没有它，该参数将被视为存储库位置。
                     </p>
                     <p>查询的表或视图可以是关系型或<code class="codeph">XMLType</code>类型。如果是关系型的，它的数据会即时转换并视为XML。 <code class="codeph">fn:collection</code>返回的结果始终是XQuery序列。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>对于<code class="codeph">XMLType</code>表， <code class="codeph">fn:collection</code>返回的每个XML文档的根元素与表中XML文档的根元素相同。
                           </p>
                        </li>
                        <li>
                           <p>对于关系表， <code class="codeph">fn:collection</code>返回的每个XML文档的根元素是<code class="codeph">ROW</code> 。 <code class="codeph">ROW</code>元素的子元素是与表的列具有相同名称（大写）的元素。子元素的内容对应于列数据。如果列的类型为<code class="codeph">XMLType</code> ，则该内容是XML元素;否则（列是标量类型），内容类型为<code class="codeph">xs:string</code> 。
                           </p>
                        </li>
                     </ul>
                     <p>传递给<code class="codeph">fn:collection</code>的URI参数的格式如下：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>对于数据库模式<span class="italic"><code class="codeph">DB-SCHEMA</code></span>的<code class="codeph">XMLType</code>或关系表或视图<span class="italic"><code class="codeph">TABLE</code></span> ：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">oradb：</span> / <span class="italic">DB-SCHEMA</span> / <span class="italic">TABLE</span> /</pre><p>如果<span class="italic"><code class="codeph">TABLE</code></span>是公共同义词，则可以将<span class="bold"><code class="codeph">PUBLIC</code></span>用于<span class="italic"><code class="codeph">DB-SCHEMA</code></span> ，或者<span class="italic"><code class="codeph">TABLE</code></span>是当前登录的数据库用户可访问的表或视图。
                           </p>
                        </li>
                        <li>
                           <p>对于<span class="italic">关系</span>表或视图中的<code class="codeph">XMLType</code>列：</p><pre class="oac_no_warn" dir="ltr"><span class="bold">oradb：</span> / <span class="italic">DB-SCHEMA</span> / <span class="italic">REL-TABLE</span> / <span class="bold">ROW</span> <span class="italic">PRED</span> / <span class="italic">X-COL</span>
</pre><p><span class="italic"><code class="codeph">REL-TABLE</code></span>是关系表或视图; <span class="italic"><code class="codeph">PRED</code></span>是一个XPath谓词，不涉及任何<code class="codeph">XMLType</code>列;和<span class="italic"><code class="codeph">X-COL</code></span>是<span class="italic"><code class="codeph">REL-TABLE</code></span>的<code class="codeph">XMLType</code>列。 <span class="italic"><code class="codeph">PRED</code></span>是可选的; <span class="italic"><code class="codeph">DB-SCHEMA</code></span> ， <span class="italic"><code class="codeph">REL-TABLE</code></span>和<span class="italic"><code class="codeph">X-COL</code></span> 。
                           </p>
                        </li>
                     </ul>
                     <p>可选的XPath谓词<span class="italic"><code class="codeph">PRED</code></span>必须满足以下条件：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>它不涉及任何<code class="codeph">XMLType</code>列。
                           </p>
                        </li>
                        <li>
                           <p>它只涉及一般平等和不等式比较的连词（ <code class="codeph">and</code> ）和析取（ <code class="codeph">or</code> ）（ <code class="codeph">=</code> , <code class="codeph">!=</code> ， <code class="codeph">&gt;</code> ， <code class="codeph">&lt;</code> ， <code class="codeph">&gt;=</code>和<code class="codeph">&lt;=</code> ）。
                           </p>
                        </li>
                        <li>
                           <p>对于每个比较操作： <span class="italic"><code class="codeph">REL-TABLE</code></span>双方都指定（非XML）列，或者一侧指定这样的列，另一个是正确类型的值，如<a href="xquery-and-XML-DB.html#GUID-7B039748-7C2A-4D86-9C54-55F4D08ED59B__BABCEJCJ" title="此表显示oradb谓词的比较表达式中允许的列类型。">表4-3中</a>所指定。使用任何其他类型都会引发错误。
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-7B039748-7C2A-4D86-9C54-55F4D08ED59B__BABCEJCJ">
                     <p class="titleintable">表4-3 oradb表达式：比较的列类型</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="oradb表达式：比较的列类型" width="100%" border="1" summary="This table shows the column types allowed in comparison expressions of oradb predicates." frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="56%" id="d20054e4151">关系列类型</th>
                              <th align="left" valign="bottom" width="44%" id="d20054e4154">XQuery值类型</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="56%" id="d20054e4159" headers="d20054e4151 ">
                                 <p><code class="codeph">VARCHAR2</code> ， <code class="codeph">CHAR</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d20054e4159 d20054e4154 ">
                                 <p><code class="codeph">xs:string</code>或字符串文字</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="56%" id="d20054e4172" headers="d20054e4151 ">
                                 <p><code class="codeph">NUMBER</code> ， <code class="codeph">FLOAT</code> ， <code class="codeph">BINARY_FLOAT</code> ， <code class="codeph">BINARY_DOUBLE</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d20054e4172 d20054e4154 ">
                                 <p><code class="codeph">xs:decimal</code> ， <code class="codeph">xs:float</code> ， <code class="codeph">xs:double</code>或numeric literal</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="56%" id="d20054e4197" headers="d20054e4151 ">
                                 <p><code class="codeph">DATE</code> ， <code class="codeph">TIMESTAMP</code> ， <code class="codeph">TIMESTAMP WITH TIMEZONE</code> ， <code class="codeph">TIMESTAMP WITH LOCAL TIMEZONE</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d20054e4197 d20054e4154 ">
                                 <p><code class="codeph">xs:date</code> ， <code class="codeph">xs:time</code>或<code class="codeph">xs:dateTime</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="56%" id="d20054e4221" headers="d20054e4151 ">
                                 <p><code class="codeph">间隔年至月</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d20054e4221 d20054e4154 ">
                                 <p><code class="codeph">XS：yearMonthDuration</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="56%" id="d20054e4230" headers="d20054e4151 ">
                                 <p><code class="codeph">间隔第二天</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d20054e4230 d20054e4154 ">
                                 <p><code class="codeph">XS：dayTimeDuration</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="56%" id="d20054e4239" headers="d20054e4151 ">
                                 <p><code class="codeph">生的</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d20054e4239 d20054e4154 ">
                                 <p><code class="codeph">XS：hexBinary的</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="56%" id="d20054e4248" headers="d20054e4151 ">
                                 <p><code class="codeph">ROWID</code></p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d20054e4248 d20054e4154 ">
                                 <p><code class="codeph">xs:string</code>或字符串文字</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>例如，对于列<code class="codeph">warehouse_id</code>的值小于6的行，此XQuery表达式表示表<code class="codeph">oe.warehouses</code> <code class="codeph">XMLType</code>列<code class="codeph">warehouse_spec</code>的所有XML文档：</p><pre class="pre codeblock"><code>fn：collection（'oradb：/ OE / WAREHOUSES / ROW [WAREHOUSE_ID &lt;6] / WAREHOUSE_SPEC'）</code></pre></div>
                  <!-- class="section" -->
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>相关话题</strong></p>
                     <ul>
                        <li><a href="query-and-update-XML.html#GUID-E62C830B-F3FB-4381-9F74-BF5F2C417CD0" title="提供了使用XQuery查询关系表或查看数据的示例，就好像它是XML数据一样。这些示例使用XQuery函数fn：collection，将URI作为参数传递给URI，该URI使用URI方案名称oradb以及数据的数据库位置。">使用XQuery和URI方案查询关系数据oradb</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" title="XQuery语言是您与Oracle XML DB中的XML数据交互的主要方式之一。对该语言的支持包括SQL * Plus commandXQUERY和SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast。">XQuery和Oracle XML DB</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB5106"></a><div class="props_rev_3"><a id="GUID-E04FDA5E-EBF1-42C9-8103-C089B2CF7513" name="GUID-E04FDA5E-EBF1-42C9-8103-C089B2CF7513"></a><h3 id="ADXDB-GUID-E04FDA5E-EBF1-42C9-8103-C089B2CF7513" class="sect3"><span class="enumeration_section">4.5</span> Oracle XQuery扩展函数</h3>
               <div>
                  <p>Oracle XML DB为W3C标准中提供的功能添加了一些XQuery功能。这些附加功能位于Oracle XML DB命名空间<code class="codeph">http://xmlns.oracle.com/xdb</code> ，该命名空间使用预定义的前缀<span class="bold"><code class="codeph">ora</code></span> 。
                  </p>
                  <div class="infoboxnote" id="GUID-E04FDA5E-EBF1-42C9-8103-C089B2CF7513__GUID-5AC0B0E7-1356-4EBF-854F-111529A1E06D">
                     <p class="notep1">注意：</p>
                     <p>在Oracle Database 12c第2版（12.2.0.1）中<span class="italic">不推荐使用</span> Oracle XQuery函数<code class="codeph">ora:contains</code> 。请改用XQuery Full Text。
                     </p>
                  </div>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-E93BBF0C-D473-4988-A132-DB7EE8B6E0C1">ora：包含XQuery函数（已弃用）</a><br>描述了Oracle XQuery和XPath函数<code class="codeph">ora:contains</code> 。Oracle Database 12c第2版（12.2.0.1）中<span class="italic">不推荐使用</span>此函数。请改用XQuery Full Text。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-8F31DED8-C232-4E19-8A62-32F5765BE4DB">ora：sqrt XQuery函数</a><br>Oracle XQuery函数<code class="codeph">ora:sqrt</code>返回其数字参数的平方根，可以是XQuery类型<code class="codeph">xs:decimal</code> ， <code class="codeph">xs:float</code>或<code class="codeph">xs:double</code> 。返回的值与参数的XQuery类型相同。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-57984592-3A02-4DB4-9FDA-D5E2CCB3A797">ora：tokenize XQuery Function</a><br>Oracle XQuery函数<code class="codeph">ora:tokenize</code>允许您使用正则表达式将输入字符串<span class="italic"><code class="codeph">target_string</code></span>拆分为一系列字符串。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" title="XQuery语言是您与Oracle XML DB中的XML数据交互的主要方式之一。对该语言的支持包括SQL * Plus commandXQUERY和SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast。">XQuery和Oracle XML DB</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB5110"></a><a id="ADXDB5109"></a><div class="props_rev_3"><a id="GUID-E93BBF0C-D473-4988-A132-DB7EE8B6E0C1" name="GUID-E93BBF0C-D473-4988-A132-DB7EE8B6E0C1"></a><h4 id="ADXDB-GUID-E93BBF0C-D473-4988-A132-DB7EE8B6E0C1" class="sect4"><span class="enumeration_section">4.5.1</span> ora：包含XQuery函数（已弃用）</h4>
                  <div>
                     <p>描述了Oracle XQuery和XPath函数<code class="codeph">ora:contains</code> 。Oracle Database 12c第2版（12.2.0.1）中<span class="italic">不推荐使用</span>此函数。请改用XQuery Full Text。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-E93BBF0C-D473-4988-A132-DB7EE8B6E0C1__GUID-5EB1ADAC-44DE-42C1-8630-C507470F6717">ora：包含语法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="pre codeblock"><code>ora：contains（ <span class="italic">input_text</span> ， <span class="italic">text_query</span> [， <span class="italic">policy_name</span> ] [， <span class="italic">policy_owner</span> ]）</code></pre><p>不推荐使用Oracle XQuery和XPath函数<code class="codeph">ora:contains</code>可以在调用SQL / XML函数<code class="codeph">XMLQuery</code> ， <code class="codeph">XMLTable</code>或<code class="codeph">XMLExists</code>用于XQuery表达式。它用于使用全文谓词限制结构搜索。函数<code class="codeph">ora:contains</code>当<span class="italic"><code class="codeph">input_text</code></span>与<span class="italic"><code class="codeph">text_query</code></span>匹配时返回正整数（数字越大，匹配越相关），否则返回零。当在XQuery表达式中使用时（也不是XPath表达式），XQuery返回类型是<code class="codeph">xs:integer()</code> ;当在XQuery表达式之外的XPath表达式中使用时，XPath返回类型是<code class="codeph">number</code> 。
                        </p>
                        <p>参数<span class="italic"><code class="codeph">input_text</code></span>必须求值为单个文本节点或属性。语法和语义<span class="italic"><code class="codeph">text_query</code></span>在<code class="codeph">ora:contains</code>作为相同<span class="italic"><code class="codeph">text_query</code></span>中<code class="codeph">contains</code> ，有一些限制。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-E04FDA5E-EBF1-42C9-8103-C089B2CF7513" title="Oracle XML DB为W3C标准中提供的功能添加了一些XQuery功能。这些附加功能位于Oracle XML DB命名空间http://xmlns.oracle.com/xdb中，该命名空间使用预定义的前缀ora。">Oracle XQuery扩展函数</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5116"></a><a id="ADXDB5115"></a><div class="props_rev_3"><a id="GUID-8F31DED8-C232-4E19-8A62-32F5765BE4DB" name="GUID-8F31DED8-C232-4E19-8A62-32F5765BE4DB"></a><h4 id="ADXDB-GUID-8F31DED8-C232-4E19-8A62-32F5765BE4DB" class="sect4"><span class="enumeration_section">4.5.2</span> ora：sqrt XQuery函数</h4>
                  <div>
                     <p>Oracle XQuery函数<code class="codeph">ora:sqrt</code>返回其数字参数的平方根，可以是XQuery类型<code class="codeph">xs:decimal</code> ， <code class="codeph">xs:float</code>或<code class="codeph">xs:double</code> 。返回的值与参数的XQuery类型相同。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-8F31DED8-C232-4E19-8A62-32F5765BE4DB__GUID-26D14541-6000-4404-BDE4-453F3484F9E1">ora：sqrt语法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="pre codeblock"><code>ora：sqrt（ <span class="italic">数字</span> ）</code></pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-E04FDA5E-EBF1-42C9-8103-C089B2CF7513" title="Oracle XML DB为W3C标准中提供的功能添加了一些XQuery功能。这些附加功能位于Oracle XML DB命名空间http://xmlns.oracle.com/xdb中，该命名空间使用预定义的前缀ora。">Oracle XQuery扩展函数</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="ADXDB5118"></a><a id="ADXDB5117"></a><div class="props_rev_3"><a id="GUID-57984592-3A02-4DB4-9FDA-D5E2CCB3A797" name="GUID-57984592-3A02-4DB4-9FDA-D5E2CCB3A797"></a><h4 id="ADXDB-GUID-57984592-3A02-4DB4-9FDA-D5E2CCB3A797" class="sect4"><span class="enumeration_section">4.5.3</span> ora：tokenize XQuery函数</h4>
                  <div>
                     <p>Oracle XQuery函数<code class="codeph">ora:tokenize</code>允许您使用正则表达式将输入字符串<span class="italic"><code class="codeph">target_string</code></span>拆分为一系列字符串。
                     </p>
                     <div class="section"></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-57984592-3A02-4DB4-9FDA-D5E2CCB3A797__GUID-A98C4610-B449-4FB5-83F9-FF7C072D7BB3">ora：tokenize语法</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="pre codeblock"><code>ora：tokenize（ <span class="italic">target_string</span> ， <span class="italic">match_pattern</span> [， <span class="italic">match_parameter</span> ]）</code></pre><p></p>
                        <p>函数<code class="codeph">ora:tokenize</code>将与regular-expression <span class="italic"><code class="codeph">match_pattern</code></span>匹配的每个子字符串视为指示拆分位置的分隔符。它返回标记序列作为<code class="codeph">xs:string*</code>类型的XQuery值（ <code class="codeph">xs:string</code>值的序列）。如果<span class="italic"><code class="codeph">target_string</code></span>是空序列，则返回它。可选参数<span class="italic"><code class="codeph">match_parameter</code></span>是一个符合匹配条件的代码：区分大小写等。
                        </p>
                        <p>参数类型如下：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="italic"><code class="codeph">target_string</code></span> - <code class="codeph">xs:string?</code><a id="fn_3" name="fn_3" href="#fn_3" the="" question="" mark="" (?)="" here="" is="" a="" zero-or-one="" occurrence="" indicator="" that="" indicates="" argument="" can="" be="" empty="" sequence.="" see="" xquery="" expressions=")" ="" ="" onclick="footdisplay(3, "><sup>脚3</sup></a></p>
                           </li>
                           <li>
                              <p><span class="italic"><code class="codeph">match_pattern</code></span> - <code class="codeph">xs:string</code></p>
                           </li>
                           <li>
                              <p><span class="italic"><code class="codeph">match_parameter</code></span> - <code class="codeph">xs:string</code></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-E04FDA5E-EBF1-42C9-8103-C089B2CF7513" title="Oracle XML DB为W3C标准中提供的功能添加了一些XQuery功能。这些附加功能位于Oracle XML DB命名空间http://xmlns.oracle.com/xdb中，该命名空间使用预定义的前缀ora。">Oracle XQuery扩展函数</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDB5996"></a><div class="props_rev_3"><a id="GUID-09066C46-8272-461A-ADE7-2F1B0FCDA948" name="GUID-09066C46-8272-461A-ADE7-2F1B0FCDA948"></a><h3 id="ADXDB-GUID-09066C46-8272-461A-ADE7-2F1B0FCDA948" class="sect3"><span class="enumeration_section">4.6</span> Oracle XQuery扩展 - 表达式编译</h3>
               <div>
                  <p>W3C XQuery规范允许实现提供实现定义的扩展表达式。XQuery扩展表达式是一个XQuery表达式，它包含在大括号（ <code class="codeph">{</code> ， <code class="codeph">}</code> ）中，并以实现定义的pragma为前缀。Oracle实现提供了几个这样的编译指示。
                  </p>
                  <div class="section">
                     <p>没有其他pragma被认可比这里列出的那些。使用任何其他编译指示，或使用具有不正确的编译指示内容的任何这些编译指示（例如， <code class="codeph">(#ora:view_on_null something_else #)</code> ）会引发错误。
                     </p>
                     <p>在这里的<code class="codeph">ora:view_on_null</code>示例中，假设表<code class="codeph">null_test</code>具有类型为<code class="codeph">VARCHAR2(10)</code>列<code class="codeph">a</code>和<code class="codeph">b</code> ，并且该列<code class="codeph">b</code> （但不是<code class="codeph">a</code> ）为空。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">(#ora:child-element-name</code> <span class="italic"><code class="codeph">name</code></span> <code class="codeph">#)</code> - 指定要用于插入的子元素的名称。通常，如果没有此编译指示，则要在插入时插入的元素的名称是未知的。指定名称允许编译时优化，以提高运行时性能。
                           </p>
                           <p>例如，以下SQL语句将<code class="codeph">LineItem</code>指定为作为元素<code class="codeph">LineItems</code>的子元素插入的元素节点的名称。要插入的元素数据是XQuery变量<code class="codeph">p2</code>的值，它来自绑定变量<code class="codeph">:1</code> 。
                           </p><pre class="pre codeblock"><code>更新oe.purchaseorder p SET p。OBJECT_VALUE = XMLQuery（'copy $ i：= $ p1 modify（for $ j in $ i / PurchaseOrder / LineItems return <span class="bold">（#ora：child-element-name LineItem＃）</span> {将node $ p2插入$ j）返回$ i'通过p。OBJECT_VALUE AS“p1”，：1 AS“p2”返回内容）XMLQuery（'/ PurchaseOrder / Reference / text（）'PASSING p。OBJECT_VALUE RETURNING CONTENT）。getStringVal（）='EMPTY_LINES';</code></pre><p>此pragma适用于以对象关系或二进制XML存储的<code class="codeph">XMLType</code>数据。</p>
                        </li>
                        <li>
                           <p><code class="codeph">(#ora:defaultTable #)</code> - 指定用于存储存储库数据的默认表。使用此选项可提高使用Query函数<code class="codeph">fn:doc</code>或<code class="codeph">fn:collection</code>的存储库查询的性能。请参阅<a href="query-and-update-XML.html#GUID-749BD49D-46E2-4B15-8B9E-1097D6952047" title="您可以使用Oracle XQuery扩展表达式pragma ora：defaultTable来提高查询存储库数据的性能。">使用Oracle XQuery Pragma ora：defaultTable</a> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">(#ora:invalid_path empty #)</code> - 将无效的XPath表达式视为其目标节点不存在。例如：</p><pre class="pre codeblock"><code>SELECT XMLQuery（' <span class="bold">（#ora：invalid_path empty＃）</span> {exists（$ p / PurchaseOrder // NotInTheSchema）}'PASSING OBJECT_VALUE as“p”RETURNING CONTENT）from oe.purchaseorder p;</code></pre><p>表<code class="codeph">oe.purchaseorder</code>的XML模式不允许任何此类节点<code class="codeph">NotInTheSchema</code>作为节点<code class="codeph">PurchaseOrder</code>的后代。如果没有编译指示，使用此无效的XPath表达式将引发错误。但是使用pragma，调用上下文就像XPath表达式没有针对任何节点一样。此示例中的调用上下文是XQuery函数<code class="codeph">exists</code> ，它在传递空节点序列时返回XQuery布尔值<code class="codeph">false</code> 。（XQuery函数<code class="codeph">exists</code>用于在该示例只是为了说明的行为;所述pragma未特别是有关功能<code class="codeph">exists</code> 。）
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">(#ora:view_on_null empty #)</code> -  XQuery函数<code class="codeph">fn:collection</code>为每个<code class="codeph">NULL</code>列返回一个空的XML元素。例如，以下查询返回<code class="codeph">&lt;ROW&gt;&lt;A&gt;x&lt;/A&gt;</code> <span class="bold"><code class="codeph">&lt;B&gt;&lt;/B&gt;</code></span> <code class="codeph">&lt;/ROW&gt;</code> ：</p><pre class="pre codeblock"><code>SELECT XMLQuery（' <span class="bold">（#ora：view_on_null empty＃）</span> {for $ i in fn：collection（“oradb：/ PUBLIC / NULL_TEST”）/ ROW return $ i}'RETURNING CONTENT）FROM DUAL;</code></pre></li>
                        <li>
                           <p><code class="codeph">(#ora:view_on_null null #)</code> -  XQuery函数<code class="codeph">fn:collection</code>返回<code class="codeph">NULL</code>列的元素。例如，以下查询返回<code class="codeph">&lt;ROW&gt;&lt;A&gt;x&lt;/A&gt;&lt;/ROW&gt;</code> ：</p><pre class="pre codeblock"><code>SELECT XMLQuery（' <span class="bold">（#ora：view_on_null null＃）</span> {for $ i in fn：collection（“oradb：/ PUBLIC / NULL_TEST”）/ ROW return $ i}'RETURNING CONTENT）FROM DUAL;</code></pre></li>
                        <li>
                           <p><code class="codeph">(#ora:no_xmlquery_rewrite #)</code> <a id="GUID-09066C46-8272-461A-ADE7-2F1B0FCDA948__BABBJEDA" name="GUID-09066C46-8272-461A-ADE7-2F1B0FCDA948__BABBJEDA" href="#GUID-09066C46-8272-461A-ADE7-2F1B0FCDA948__BABBJEDA" prior="" to="" oracle="" database="" 12c="" release="" 1="" (12.1.0.1),="" pragmas="" ora:no_xmlquery_rewrite="" and="" ora:xmlquery_rewrite="" were="" named="" ora:xq_proc="" ora:xq_qry,="" respectively.="" they="" renamed="" for="" readability,="" with="" no="" change="" in="" meaning=")" ="" ="" onclick="footdisplay(4, "><sup>脚4</sup></a> - 不要在pragma <code class="codeph">(#ora:no_xmlquery_rewrite #)</code>的XQuery表达式中优化XQuery过程调用;而是使用功能评估。
                           </p>
                           <p>这与SQL提示<code class="codeph">/*+ NO_XML_QUERY_REWRITE */</code>具有相同的效果，但是pragma的范围只是它<code class="codeph">/*+ NO_XML_QUERY_REWRITE */</code>的XQuery表达式（不是整个SQL语句）。
                           </p>
                           <div class="infoboxnotealso" id="GUID-09066C46-8272-461A-ADE7-2F1B0FCDA948__GUID-6BD8322E-AFDD-4325-B85F-6BEEBBD5837A">
                              <p class="notep1">也可以看看：</p>
                              <p><a href="indexes-for-XMLType-data.html#GUID-572DB598-0A31-4143-889B-98D883211FC6" title="您可以使用优化程序提示关闭XMLIndex的使用：/ * + NO_XML_QUERY_REWRITE * /或优化程序提示/ * + NO_XMLINDEX_REWRITE * /。">关闭使用XMLIndex</a>获取有关优化程序提示<code class="codeph">NO_XML_QUERY_REWRITE</code></p>
                           </div>
                        </li>
                        <li>
                           <p><code class="codeph">(#ora:xmlquery_rewrite #)</code> <a id="fnsrc_d20054e5052" name="fnsrc_d20054e5052" href="#fnsrc_d20054e5052" prior="" to="" oracle="" database="" 12c="" release="" 1="" (12.1.0.1),="" pragmas="" ora:no_xmlquery_rewrite="" and="" ora:xmlquery_rewrite="" were="" named="" ora:xq_proc="" ora:xq_qry,="" respectively.="" they="" renamed="" for="" readability,="" with="" no="" change="" in="" meaning=")" ="" ="" onclick="footdisplay(4, "><sup>Footref 4</sup></a> - 尝试优化pragma之后的XQuery表达式。也就是说，如果可能的话，不要在功能上进行评估。
                           </p>
                           <p>作为同时使用<code class="codeph">ora:no_xmlquery_rewrite</code>和<code class="codeph">ora:xmlquery_rewrite</code> ，在以下查询中， <code class="codeph">XMLQuery</code>的XQuery表达式参数通常将在功能上进行评估，但是<code class="codeph">ora:xmlquery_rewrite</code>使用pragma <code class="codeph">ora:xmlquery_rewrite</code>之前的<code class="codeph">fn:collection</code>子表达式，如果可能。
                           </p><pre class="pre codeblock"><code>SELECT XMLQuery（' <span class="bold">（#ora：no_xmlquery_rewrite＃）</span> （：不优化表达式:) {for $ i in <span class="bold">（#ora：xmlquery_rewrite＃）</span> （：Optimize subexp。:) {fn：collection（“oradb：/ HR / REGIONS “）}，$ j in <span class="bold">（#ora：xmlquery_rewrite＃）</span> （：Optimize subexpr。:) {fn：collection（”oradb：/ HR / COUNTRIES“）}其中$ i / ROW / REGION_ID = $ j / ROW / REGION_ID和$ i / ROW / REGION_NAME = $ regionname返回$ j}'PASSING CAST（'＆REGION'AS VARCHAR2（40））AS“regionname”RETURNING CONTENT）AS asian_countries FROM DUAL;</code></pre></li>
                        <li>
                           <p><code class="codeph">(#ora:no_schema #)</code> - 如果XQuery Full Text表达式与基于XML Schema的<code class="codeph">XMLType</code>数据一起使用，则不会引发错误。而是隐式地将数据转换为非基于XML模式的数据。特别是，这意味着忽略XML Schema数据类型。
                           </p>
                           <p>Oracle仅支持存储为二进制XML的<code class="codeph">XMLType</code>数据的XQuery Full Text，因此该pragma仅适用于相同的情况。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">(#ora:use_xmltext_idx #)</code> - 使用XML搜索索引（如果可用）来评估查询。不要使用<code class="codeph">XMLIndex</code>索引或流评估。
                           </p>
                           <p>XML搜索索引仅适用于存储为二进制XML的<code class="codeph">XMLType</code>数据，因此该pragma也可以。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">(#ora:transform_keep_schema #)</code> - 保留由pragma <code class="codeph">(#ora:transform_keep_schema #)</code>的XQuery表达式返回的文档的XML Schema信息。这对于使用复制语义的XQuery Update很有用。
                           </p>
                           <p>如果没有编译指示，在XQuery Update操作期间复制基于XML模式的数据时，XML模式信息将丢失。这是XQuery Update标准指定的行为。然后，如果您尝试将更新的数据插入到基于XML模式的列或表中，则会引发错误：要插入的数据是无类型的，因此它不符合XML模式。</p>
                           <p>如果使用pragma，则数据会保留其XML架构信息，从而防止插入错误。以下是使用pragma的示例：</p><pre class="pre codeblock"><code>SELECT XMLQuery（'declare default element namespace“http://xmlns.oracle.com/xdb/xdbconfig.xsd”;（：:) <span class="bold">（#ora：transform_keep_schema＃）</span> {copy $ NEWXML：= $ XML modify（for $ CFG）在$ NEWXML / xdbconfig中// httpconfig返回（用xs：int（$ PORTNO）替换节点$ CFG / http-port的值））返回$ NEWXML}'通过CFG AS“XML”，81作为“PORTNO”返回内容）来自双重;</code></pre></li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" title="XQuery语言是您与Oracle XML DB中的XML数据交互的主要方式之一。对该语言的支持包括SQL * Plus commandXQUERY和SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast。">XQuery和Oracle XML DB</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB5151"></a><a id="ADXDB5152"></a><a id="ADXDB5150"></a><div class="props_rev_3"><a id="GUID-B7DB8827-C930-4711-A134-FA2BC58D749B" name="GUID-B7DB8827-C930-4711-A134-FA2BC58D749B"></a><h3 id="ADXDB-GUID-B7DB8827-C930-4711-A134-FA2BC58D749B" class="sect3"><span class="enumeration_section">4.7</span> Oracle XML DB中的XQuery静态类型检查</h3>
               <div>
                  <p>如果可能，Oracle XML DB会对查询执行静态（编译时）类型检查。</p>
                  <p>Oracle XML DB类型检查<span class="italic">所有</span> XQuery表达式。但是，在运行时执行此操作可能会很昂贵。作为一种优化技术，只要在编译时有足够的静态类型信息可用于给定查询，Oracle XML DB就会对该查询执行<span class="italic">静态</span> （编译时）类型检查。只要在编译时没有足够的静态类型信息用于给定查询，Oracle XML DB就会对该查询使用动态（运行时）类型检查。
                  </p>
                  <p>静态类型检查可以通过在编译时引发错误来节省执行时间。静态类型检查错误包括数据类型错误和使用对XML模式无效的XPath表达式。</p>
                  <p>在查询编译时提供足够的静态类型信息的典型方法包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>在关系数据上使用带有<code class="codeph">fn:doc</code>或<code class="codeph">fn:collection</code> XQuery。
                        </p>
                     </li>
                     <li>
                        <p>使用XQuery查询在查询编译时XML模式信息可用的<code class="codeph">XMLType</code>表，列或视图。
                        </p>
                     </li>
                     <li>
                        <p>将XQuery Update与转换表达式一起使用，该表达式的输入来自<code class="codeph">XMLType</code>表或基于XML架构的列。
                        </p>
                     </li>
                  </ul>
                  <p>本节介绍了演示静态类型检查的实用程序以及使用这两种通信类型信息的方法的示例。</p>
                  <p>由<code class="codeph">fn:collection</code>和URI方案<code class="codeph">oradb</code>一起生成的XML数据将<code class="codeph">ROW</code>作为其顶级元素，但是<a href="xquery-and-XML-DB.html#GUID-B7DB8827-C930-4711-A134-FA2BC58D749B__BABFDFHI">示例4-4</a>的查询错误地缺少该<code class="codeph">ROW</code>包装元素。此省略会引发查询编译时错误。忘记使用<code class="codeph">oradb</code> <code class="codeph">fn:collection</code>以这种方式包装关系数据是一个容易犯的错误，而且如果没有静态类型检查就很难诊断。<a href="query-and-update-XML.html#GUID-E62C830B-F3FB-4381-9F74-BF5F2C417CD0__CBAFCFCF">例5-5</a>显示了正确的代码。
                  </p>
                  <p>在<a href="xquery-and-XML-DB.html#GUID-B7DB8827-C930-4711-A134-FA2BC58D749B__BABIDDDF">示例4-5中</a> ，XQuery静态类型检查发现XPath表达式与其基于目标XML模式的数据之间不匹配。Element <code class="codeph">CostCenter</code>在这里拼写错误，因为<code class="codeph">costcenter</code> （XQuery和XPath区分大小写）。<a href="query-and-update-XML.html#GUID-1165391D-BA6A-460F-BA44-66AA4A1F6595__CBAJEEFD">例5-11</a>显示了正确的代码。
                  </p>
                  <div class="example" id="GUID-B7DB8827-C930-4711-A134-FA2BC58D749B__BABFDFHI">
                     <p class="titleinexample">示例4-4 XQuery表达式的静态类型检查：oradb URI方案</p><pre class="pre codeblock"><code>- 这会产生静态类型检查错误，因为缺少“ROW”。SELECT XMLQuery（'fn：collection中的$ i（“oradb：/ HR / REGIONS”），fn：collection中的$ j（“oradb：/ HR / COUNTRIES”）其中$ i / REGION_ID = $ j / REGION_ID和$ i / REGION_NAME =“Asia”返回$ j'返回内容）as asian_countries FROM DUAL; SELECT XMLQuery（'for fn：collection中的$ i（“oradb：/ HR / REGIONS”），第1行的* ERROR：ORA-19276：XPST0005  -  XPath步骤指定无效的元素/属性名称：（REGION_ID）</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-B7DB8827-C930-4711-A134-FA2BC58D749B__BABIDDDF">
                     <p class="titleinexample">示例4-5 XQuery表达式的静态类型检查：基于XML模式的数据</p><pre class="pre codeblock"><code>- 这会导致静态类型检查错误：CostCenter不是正确的情况。SELECT xtab.poref，xtab.usr，xtab.requestor FROM purchaseorder，XMLTable（'for $ i in / PurchaseOrder其中$ i / <span class="bold">costcenter</span> eq“A10”返回$ i'PASSING OBJECT_VALUE COLUMNS poref VARCHAR2（20）PATH'Reference'， usr VARCHAR2（20）路径'用户'DEFAULT'未知'，请求者VARCHAR2（20）路径'请求者'）xtab; FROM purchaseorder，*第2行的错误：ORA-19276：XPST0005  -  XPath步骤指定了无效的元素/属性名称:( costcenter）</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" title="XQuery语言是您与Oracle XML DB中的XML数据交互的主要方式之一。对该语言的支持包括SQL * Plus commandXQUERY和SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast。">XQuery和Oracle XML DB</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADXDB5159"></a><div class="props_rev_3"><a id="GUID-2D63B8EA-DC49-409F-B5DF-34A679AB2A99" name="GUID-2D63B8EA-DC49-409F-B5DF-34A679AB2A99"></a><h3 id="ADXDB-GUID-2D63B8EA-DC49-409F-B5DF-34A679AB2A99" class="sect3"><span class="enumeration_section">4.8</span> Oracle XML DB对XQuery的支持</h3>
               <div>
                  <p>Oracle XML DB对XQuery语言的支持包括SQL支持和对XQuery函数和运算符的支持。</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-B239D5DC-DEA9-401B-A249-9CDCC1A7781D">支持XQuery和SQL</a><br>Oracle XML DB中对XQuery语言的支持旨在提供关系存储和查询XML数据之间的最佳匹配。Oracle XML DB是一个通用的XQuery实现，但它还专门用于使关系和XQuery查询能够很好地协同工作。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-22940B8D-1468-4966-9F55-7DD4518E9612">支持XQuery函数和运算符</a><br>Oracle XML DB支持最新的<span class="italic">XQuery 1.0和XPath 2.0函数和运算符</span>规范中包含的所有XQuery函数和运算<span class="italic">符</span> ，但有一些例外。
                     </li>
                     <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048">支持XQuery全文</a><br>Oracle XML DB支持存储为二进制XML的<code class="codeph">XMLType</code>数据的XQuery Full Text。 Oracle Text技术提供全文索引和搜索，这是此支持的基础。
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" title="XQuery语言是您与Oracle XML DB中的XML数据交互的主要方式之一。对该语言的支持包括SQL * Plus commandXQUERY和SQL / XML函数XMLQuery，XMLTable，XMLExists和XMLCast。">XQuery和Oracle XML DB</a></p>
                     </div>
                  </div>
               </div>
               <a id="ADXDB5160"></a><div class="props_rev_3"><a id="GUID-B239D5DC-DEA9-401B-A249-9CDCC1A7781D" name="GUID-B239D5DC-DEA9-401B-A249-9CDCC1A7781D"></a><h4 id="ADXDB-GUID-B239D5DC-DEA9-401B-A249-9CDCC1A7781D" class="sect4"><span class="enumeration_section">4.8.1</span>支持XQuery和SQL</h4>
                  <div>
                     <p>Oracle XML DB中对XQuery语言的支持旨在提供关系存储和查询XML数据之间的最佳匹配。Oracle XML DB是一个通用的XQuery实现，但它还专门用于使关系和XQuery查询能够很好地协同工作。</p>
                     <div class="section">
                        <p>本节将介绍Oracle XML DB XQuery实现的特定属性。XQuery标准明确地将语言处理的某些方面称为实现定义或依赖于实现。还有一些由XQuery标准指定但Oracle XML DB不支持的功能。</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-50FD7517-AEBE-4C78-8B20-50DC72FBDB16">XQuery标准中指定的实现选择</a><br>XQuery标准指定了由实现定义的语言处理的几个方面。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-7E668693-38C0-481A-B118-2E1A654D6E0D">Oracle XML DB不支持XQuery功能</a><br>指定了Oracle XML DB不支持的XQuery标准指定的功能。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-11B622EC-8551-43E9-BE1C-1E5EBE777C9E">XQuery可选功能</a><br>指定了Oracle XML DB不支持的可选XQuery功能。
                        </li>
                     </ul>
                     <div class="relinfo">
                        <p><strong>相关话题</strong></p>
                        <ul>
                           <li><a href="xquery-and-XML-DB.html#GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048" title="Oracle XML DB支持存储为二进制XML的XMLType数据的XQuery Full Text。 Oracle Text技术提供全文索引和搜索，这是此支持的基础。">支持XQuery全文</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-2D63B8EA-DC49-409F-B5DF-34A679AB2A99" title="Oracle XML DB对XQuery语言的支持包括SQL支持和对XQuery函数和运算符的支持。">XQuery的Oracle XML DB支持</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADXDB5161"></a><div class="props_rev_3"><a id="GUID-50FD7517-AEBE-4C78-8B20-50DC72FBDB16" name="GUID-50FD7517-AEBE-4C78-8B20-50DC72FBDB16"></a><h5 id="ADXDB-GUID-50FD7517-AEBE-4C78-8B20-50DC72FBDB16" class="sect5"><span class="enumeration_section">4.8.1.1</span> XQuery标准中指定的实现选择</h5>
                     <div>
                        <p>XQuery标准指定了由实现定义的语言处理的几个方面。</p>
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="italic">隐式时区支持 -</span>在Oracle XML DB中，隐式时区始终假定为<code class="codeph">Z</code> ，并且缺少时区的<code class="codeph">xs:date</code> ， <code class="codeph">xs:time</code>和<code class="codeph">xs:datetime</code>实例会自动转换为UTC。</p>
                              </li>
                              <li>
                                 <p><span class="italic"><code class="codeph">copy-namespaces</code></span> <span class="italic">默认值 -</span> <code class="codeph">copy-namespaces</code>声明（在XQuery Update中使用）的默认值是<code class="codeph">inherit</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p><span class="italic">重新验证模式</span> - <code class="codeph">skip</code> XQuery Update转换表达式重新验证的默认模式。但是，如果转换表达式的结果是对<code class="codeph">XMLType</code>表或列中基于XML模式的数据的更新，则会强制执行XML模式验证。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-B239D5DC-DEA9-401B-A249-9CDCC1A7781D" title="Oracle XML DB中对XQuery语言的支持旨在提供关系存储和查询XML数据之间的最佳匹配。Oracle XML DB是一个通用的XQuery实现，但它还专门用于使关系和XQuery查询能够很好地协同工作。">支持XQuery和SQL</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB5162"></a><div class="props_rev_3"><a id="GUID-7E668693-38C0-481A-B118-2E1A654D6E0D" name="GUID-7E668693-38C0-481A-B118-2E1A654D6E0D"></a><h5 id="ADXDB-GUID-7E668693-38C0-481A-B118-2E1A654D6E0D" class="sect5"><span class="enumeration_section">4.8.1.2</span> Oracle XML DB不支持的XQuery功能</h5>
                     <div>
                        <p>指定了Oracle XML DB不支持的XQuery标准指定的功能。</p>
                        <div class="section">
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="italic">复制命名空间模式 -</span> Oracle XML DB仅支持<code class="codeph">preserve</code>和<code class="codeph">inherit</code> <code class="codeph">copy-namespaces</code>声明。如果现有元素节点由元素构造函数或文档构造函数复制，则原始元素的所有范围内命名空间都将保留在副本中。否则，复制的节点将继承构造节点的所有范围内命名空间。如果指定<code class="codeph">no-preserve</code>或<code class="codeph">no-inherit</code>则会引发错误。
                                 </p>
                              </li>
                              <li>
                                 <p><span class="italic">版本编码</span> -  Oracle XML DB不支持版本声明中的可选编码声明。也就是说，您不能在声明<code class="codeph">xquery version</code> <span class="italic"><code class="codeph">a-version</code></span>包含<code class="codeph">(encoding</code> <span class="italic"><code class="codeph">an-encoding</code></span> <code class="codeph">)</code> <code class="codeph">;</code> 。特别是，您无法指定查询中使用的编码。如果包含编码声明，则会引发错误。
                                 </p>
                              </li>
                              <li>
                                 <p><span class="italic">xml：id</span> -  Oracle XML DB不支持使用<code class="codeph">xml:id</code> 。如果使用<code class="codeph">xml:id</code> ，则会引发错误。
                                 </p>
                              </li>
                              <li>
                                 <p>XQuery prolog默认排序声明。</p>
                              </li>
                              <li>
                                 <p>XQuery prolog边界空间声明。</p>
                              </li>
                              <li>
                                 <p>XQuery数据类型<code class="codeph">xs:duration</code> 。请改用<code class="codeph">xs:yearMonthDuration</code>或<code class="codeph">xs:DayTimeDuration</code> 。
                                 </p>
                              </li>
                              <li>
                                 <p>XQuery Update函数<code class="codeph">fn:put</code> 。
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-B239D5DC-DEA9-401B-A249-9CDCC1A7781D" title="Oracle XML DB中对XQuery语言的支持旨在提供关系存储和查询XML数据之间的最佳匹配。Oracle XML DB是一个通用的XQuery实现，但它还专门用于使关系和XQuery查询能够很好地协同工作。">支持XQuery和SQL</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB5163"></a><div class="props_rev_3"><a id="GUID-11B622EC-8551-43E9-BE1C-1E5EBE777C9E" name="GUID-11B622EC-8551-43E9-BE1C-1E5EBE777C9E"></a><h5 id="ADXDB-GUID-11B622EC-8551-43E9-BE1C-1E5EBE777C9E" class="sect5"><span class="enumeration_section">4.8.1.3</span> XQuery可选功能</h5>
                     <div>
                        <p>指定了Oracle XML DB不支持的可选XQuery功能。</p>
                        <div class="section">
                           <p>XQuery标准指定某些功能对于给定的实现是<span class="italic">可选</span>的。Oracle XML DB <span class="italic">不</span>支持以下可选XQuery功能：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>模式验证功能</p>
                              </li>
                              <li>
                                 <p>模块功能</p>
                              </li>
                           </ul>
                           <p>Oracle XML DB支持以下可选的XQuery功能：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>XQuery静态打字功能</p>
                              </li>
                              <li>
                                 <p>XQuery更新静态类型功能</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="xquery-and-XML-DB.html#GUID-B7DB8827-C930-4711-A134-FA2BC58D749B" title="如果可能，Oracle XML DB会对查询执行静态（编译时）类型检查。">Oracle XML DB中的XQuery静态类型检查</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-B239D5DC-DEA9-401B-A249-9CDCC1A7781D" title="Oracle XML DB中对XQuery语言的支持旨在提供关系存储和查询XML数据之间的最佳匹配。Oracle XML DB是一个通用的XQuery实现，但它还专门用于使关系和XQuery查询能够很好地协同工作。">支持XQuery和SQL</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="ADXDB5164"></a><div class="props_rev_3"><a id="GUID-22940B8D-1468-4966-9F55-7DD4518E9612" name="GUID-22940B8D-1468-4966-9F55-7DD4518E9612"></a><h4 id="ADXDB-GUID-22940B8D-1468-4966-9F55-7DD4518E9612" class="sect4"><span class="enumeration_section">4.8.2</span>支持XQuery函数和操作符</h4>
                  <div>
                     <p>Oracle XML DB支持最新的<span class="italic">XQuery 1.0和XPath 2.0函数和运算符</span>规范中包含的所有XQuery函数和运算<span class="italic">符</span> ，但有一些例外。
                     </p>
                     <div class="section">
                        <p>Oracle XML DB信息<span class="italic">不</span>支持下面的XQuery函数和运算符：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>函数<code class="codeph">fn:tokenize</code> 。使用Oracle XQuery函数<code class="codeph">ora:tokenize</code>代替。
                              </p>
                           </li>
                           <li>
                              <p>函数<code class="codeph">fn:id</code>和<code class="codeph">fn:idref</code> 。
                              </p>
                           </li>
                           <li>
                              <p>函数<code class="codeph">fn:collection</code>不带参数的<code class="codeph">fn:collection</code> 。
                              </p>
                           </li>
                           <li>
                              <p>XQuery函数的可选排序规则参数。</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-0988D78A-DDB3-4DC2-9ED9-052B37952FE1">XQuery函数fn：doc，fn：collection和fn：doc-available</a><br>Oracle XML DB支持XQuery函数<code class="codeph">fn:doc</code> ， <code class="codeph">fn:collection</code>和<code class="codeph">fn:doc-available</code>用于Oracle XML DB Repository中的所有资源。
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-2D63B8EA-DC49-409F-B5DF-34A679AB2A99" title="Oracle XML DB对XQuery语言的支持包括SQL支持和对XQuery函数和运算符的支持。">XQuery的Oracle XML DB支持</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADXDB5165"></a><div class="props_rev_3"><a id="GUID-0988D78A-DDB3-4DC2-9ED9-052B37952FE1" name="GUID-0988D78A-DDB3-4DC2-9ED9-052B37952FE1"></a><h5 id="ADXDB-GUID-0988D78A-DDB3-4DC2-9ED9-052B37952FE1" class="sect5"><span class="enumeration_section">4.8.2.1</span> XQuery函数fn：doc，fn：collection和fn：doc-available</h5>
                     <div>
                        <p>Oracle XML DB支持XQuery函数<code class="codeph">fn:doc</code> ， <code class="codeph">fn:collection</code>和<code class="codeph">fn:doc-available</code>用于Oracle XML DB Repository中的所有资源。
                        </p>
                        <div class="section">
                           <p>函数<code class="codeph">fn:doc</code>返回其URI参数所针对的存储库<span class="italic">文件</span>资源;它必须是格式良好的XML数据文件。函数<code class="codeph">fn:collection</code>类似，但适用于存储库<span class="italic">文件夹</span>资源（文件夹中的每个文件都必须包含格式良好的XML数据）。
                           </p>
                           <p>当与Oracle URI方案<code class="codeph">oradb</code> ， <code class="codeph">fn:collection</code>可以从不在存储库中的现有关系数据中返回动态派生的XML数据。
                           </p>
                           <p>XQuery函数<code class="codeph">fn:collection</code>与URI方案<code class="codeph">oradb</code>一起使用时会引发错误，如果它的目标表或视图或目标列不存在。函数<code class="codeph">fn:doc</code>和<code class="codeph">fn:collection</code>如果找不到作为参数传递的存储库资源，则<span class="italic">不会</span>引发错误。相反，它们返回一个空序列。
                           </p>
                           <p>您可以使用XQuery函数<code class="codeph">fn:doc-available</code>确定给定文档是否存在。如果文档参数存在则返回<code class="codeph">true</code>否则返回<code class="codeph">false</code> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-0988D78A-DDB3-4DC2-9ED9-052B37952FE1__GUID-9C6BF6CF-A679-46EB-8942-0615AE0D9E8D">
                           <p class="notep1">也可以看看：</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/adxdb&amp;id=w3_org_tr_xquery30_fn_op" target="_blank">XQuery 3.0函数和操作符</a></p>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-22940B8D-1468-4966-9F55-7DD4518E9612" title="Oracle XML DB支持最新的XQuery 1.0和XPath 2.0函数和运算符规范中包含的所有XQuery函数和运算符，但有一些例外。">支持XQuery函数和运算符</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="ADXDB6134"></a><div class="props_rev_3"><a id="GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048" name="GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048"></a><h4 id="ADXDB-GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048" class="sect4"><span class="enumeration_section">4.8.3</span>支持XQuery全文</h4>
                  <div>
                     <p>Oracle XML DB支持存储为二进制XML的<code class="codeph">XMLType</code>数据的XQuery Full Text。 Oracle Text技术提供全文索引和搜索，这是此支持的基础。
                     </p>
                     <div class="section">
                        <p>有关此处未详述的任何术语的信息，请参阅XQuery和XPath全文1.0建议（以下简称XQuery全文或XQFT）。</p>
                        <p>Oracle <span class="italic">仅</span>支持存储为<span class="italic">二进制XML的</span> <code class="codeph">XMLType</code>数据的XQuery Full Text。您可以使用Oracle Text索引执行对象关系存储的<code class="codeph">XMLType</code>数据的全文搜索，但不能使用XQuery Full Text。
                        </p>
                        <p>理解Oracle对XQuery Full Text的支持的一般规则是XQFT的Oracle实现基于Oracle Text，后者提供对Oracle产品和使用它们开发的应用程序的全文索引和搜索。本节中提供的XQFT支持详细信息是此基于Oracle Text的实现的结果。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-1066B062-BEDE-4384-B0A7-2DEE8D7EA28E">XQuery全文，基于XML模式的数据和Pragma ora：no_schema</a><br>使用Oracle pragma <code class="codeph">ora:no_schema</code>和XQuery Full Text来查询存储为二进制XML的基于XML Schema的<code class="codeph">XMLType</code>数据。数据被视为非XML Schema。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-A3A8DD96-851D-4433-955E-3FD697E6EE6A">XMLExists使用XQuery全文的限制</a><br>为使用带有SQL / XML函数<code class="codeph">XMLExists</code> XQuery Full Text指定了限制。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-6BB43AAA-6C8F-49F4-8EDF-4CBA4EC0E78C">支持的XQuery全文FTSelection操作符</a><br>Oracle XML DB支持XQuery Full Text FTSelection运算符的子集。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-9EA2F0C3-6CB6-41FE-A20B-6A861576786E">支持的XQuery全文匹配选项</a><br>Oracle XML DB支持XQuery全文匹配选项的子集。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-4D1A5EE7-2A6C-4ED8-B4AC-CA2E1E1030C6">不受支持的XQuery全文功能</a><br>指定了Oracle XML DB不支持的XQuery全文功能。
                        </li>
                        <li class="ulchildlink"><a href="xquery-and-XML-DB.html#GUID-4F5DE0AB-F407-4A2C-A417-C1EDBCE461AD">XQuery全文错误</a><br>描述了使用XQuery Full Text时可能引发的编译时错误。
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048__GUID-05F84375-25A7-4C56-ABDD-73AF10606155">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><a href="../ccapp/index.html" target="_blank"><span><cite>Oracle Text Application Developer's Guide</cite></span></a></p>
                           </li>
                           <li>
                              <p><a href="../ccref/index.html" target="_blank"><span><cite>Oracle Text Reference</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-2D63B8EA-DC49-409F-B5DF-34A679AB2A99" title="Oracle XML DB对XQuery语言的支持包括SQL支持和对XQuery函数和运算符的支持。">XQuery的Oracle XML DB支持</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="ADXDB6141"></a><div class="props_rev_3"><a id="GUID-1066B062-BEDE-4384-B0A7-2DEE8D7EA28E" name="GUID-1066B062-BEDE-4384-B0A7-2DEE8D7EA28E"></a><h5 id="ADXDB-GUID-1066B062-BEDE-4384-B0A7-2DEE8D7EA28E" class="sect5"><span class="enumeration_section">4.8.3.1</span> XQuery全文，基于XML模式的数据和Pragma ora：no_schema</h5>
                     <div>
                        <p>使用Oracle pragma <code class="codeph">ora:no_schema</code>和XQuery Full Text来查询存储为二进制XML的基于XML Schema的<code class="codeph">XMLType</code>数据。数据被视为非XML Schema。
                        </p>
                        <div class="section">
                           <p>您可以使用XQuery Full Text查询存储为二进制XML的<code class="codeph">XMLType</code>数据。但是，如果将其与基于XML模式的数据一起使用，则还必须在查询中使用XQuery扩展表达式pragma <code class="codeph">ora:no_schema</code> ，否则会引发错误。
                           </p>
                           <p>如果你使用<code class="codeph">ora:no_schema</code>那么，为了XQuery Full Text的目的，XML数据被隐式地转换为非基于XML Schema的数据。换句话说，Oracle对XQuery Full Text的支持将所有XML数据视为不基于XML模式。
                           </p>
                           <p>特别是，这意味着如果在查询中包含使用XML Schema数据类型的XQuery Full Text条件，则忽略此类型注意事项。例如，两个XML Schema日期值的比较被处理为简单的字符串比较。Oracle对XQuery Full Text的支持不支持XML Schema。</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="indexes-for-XMLType-data.html#GUID-E53BBE3C-CDFB-4A64-96E0-C16497D060C2" title="Oracle建议您在使用XQuery Full Text和XML搜索索引时使用非基于XML Schema的XMLType数据。但在某些情况下，您可以使用存储为二进制XML的基于XML Schema的XMLType数据。 Oracle XQuery pragma ora：no_schema在此上下文中非常有用。">Pragma ora：no_schema：在XQuery全文中使用基于XML模式的数据</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048" title="Oracle XML DB支持存储为二进制XML的XMLType数据的XQuery Full Text。 Oracle Text技术提供全文索引和搜索，这是此支持的基础。">支持XQuery全文</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB6142"></a><div class="props_rev_3"><a id="GUID-A3A8DD96-851D-4433-955E-3FD697E6EE6A" name="GUID-A3A8DD96-851D-4433-955E-3FD697E6EE6A"></a><h5 id="ADXDB-GUID-A3A8DD96-851D-4433-955E-3FD697E6EE6A" class="sect5"><span class="enumeration_section">4.8.3.2</span> XMLExists使用XQuery全文的限制</h5>
                     <div>
                        <p>为使用带有SQL / XML函数<code class="codeph">XMLExists</code> XQuery Full Text指定了限制。
                        </p>
                        <div class="section">
                           <p>您只能在SQL / XML函数<code class="codeph">XMLExists</code>的<code class="codeph">PASSING</code>子句中传递一个<code class="codeph">XMLType</code>实例作为SQL表达式，并且该子句中的每个其他非<code class="codeph">XMLType</code> SQL表达式必须是SQL内置的<span class="italic">编译时常</span>量数据类型或绑定到此类数据类型的实例的<span class="italic">绑定变量</span> 。如果不遵守此限制，则引发编译时错误ORA-18177。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048" title="Oracle XML DB支持存储为二进制XML的XMLType数据的XQuery Full Text。 Oracle Text技术提供全文索引和搜索，这是此支持的基础。">支持XQuery全文</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB6135"></a><div class="props_rev_3"><a id="GUID-6BB43AAA-6C8F-49F4-8EDF-4CBA4EC0E78C" name="GUID-6BB43AAA-6C8F-49F4-8EDF-4CBA4EC0E78C"></a><h5 id="ADXDB-GUID-6BB43AAA-6C8F-49F4-8EDF-4CBA4EC0E78C" class="sect5"><span class="enumeration_section">4.8.3.3</span>支持的XQuery全文FTSelection操作符</h5>
                     <div>
                        <p>Oracle XML DB支持XQuery Full Text FTSelection运算符的子集。</p>
                        <div class="section">
                           <p>Oracle XML DB <span class="italic">仅</span>支持以下XQuery Full Text FTSelection运算符。注意到任何适用的限制。使用术语“必须”和“不得”意味着如果不遵守指定的限制，则会引发错误。使用此处未列出的任何运算符会引发错误。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>FTAnd（ <code class="codeph">ftand</code> ）</p>
                              </li>
                              <li>
                                 <p>FTMildNot（ <code class="codeph">not in</code> ）</p>
                                 <p>运算符FTMildNot的每个操作数必须是术语或短语，即FTWords的实例。它绝不是表达。Oracle处理FTMildNot的方式与处理Oracle Text operator <code class="codeph">MNOT</code>方式相同。</p>
                              </li>
                              <li>
                                 <p>FTOr（ <code class="codeph">ftor</code> ）</p>
                              </li>
                              <li>
                                 <p>FTOrder（ <code class="codeph">ordered</code> ）</p>
                                 <p>Oracle <span class="italic">仅</span>在窗口（FTWindow）的上下文中使用<span class="italic">时才</span>支持使用FTOrder。否则，它不受支持。例如，您可以使用<code class="codeph">ordered window 5 words</code> ，但不能仅使用<code class="codeph">ordered</code>而不使用<code class="codeph">window</code> 。Oracle处理FTOrder的方式与处理Oracle Text operator <code class="codeph">NEAR</code>方式相同，选项<code class="codeph">ORDER</code>值为<code class="codeph">TRUE</code> 。</p>
                              </li>
                              <li>
                                 <p>FTUnaryNot（ <code class="codeph">ftnot</code> ）</p>
                                 <p>FTUnaryNot必须与FTAnd一起使用。您不能单独使用FTUnaryNot。例如，你可以使用<code class="codeph">ftand ftnot</code> ，但是你不能只使用<code class="codeph">ftnot</code>而不使用<code class="codeph">ftand</code> 。Oracle处理FTUnaryNot的方式与处理Oracle Text operator <code class="codeph">NOT</code>方式相同。</p>
                              </li>
                              <li>
                                 <p>FTWindow（ <code class="codeph">window</code> ）</p>
                                 <p>Oracle处理FTWindow的方式与处理Oracle Text运算符<code class="codeph">NEAR</code>方式相同。您必须仅在单词中指定窗口大小，而不是在句子或段落中指定窗口大小（例如， <code class="codeph">window 2 paragraphs</code> ），并且必须将其指定为小于或等于100的数字常量。
                                 </p>
                              </li>
                              <li>
                                 <p>FTWords</p>
                                 <p>FTWordsValue必须是XQuery文字字符串或SQL绑定变量，其值从SQL表达式传递给SQL函数<code class="codeph">XMLExists</code>或<code class="codeph">XMLQuery</code> ，其SQL评估返回非<code class="codeph">XMLType</code>值。
                                 </p>
                                 <p>此外，FTAnyallOption（如果存在）必须是<code class="codeph">any</code> 。也就是说，FTWords必须对应于只有一个项目的序列。
                                 </p>
                                 <div class="infoboxnote" id="GUID-6BB43AAA-6C8F-49F4-8EDF-4CBA4EC0E78C__GUID-C2D9AC8E-1D67-41D3-A06A-A7445EA3454D">
                                    <p class="notep1">注意：</p>
                                    <p>即使FTWords只对应于一个项目的序列，您仍然可以通过对整个短语使用单个字符串来搜索多个单词的短语。例如，虽然Oracle XML DB不支持对FTWords使用<code class="codeph">{"found" "necklace"}</code> ，但您可以使用<code class="codeph">"found necklace"</code> 。
                                    </p>
                                 </div>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048" title="Oracle XML DB支持存储为二进制XML的XMLType数据的XQuery Full Text。 Oracle Text技术提供全文索引和搜索，这是此支持的基础。">支持XQuery全文</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB6136"></a><div class="props_rev_3"><a id="GUID-9EA2F0C3-6CB6-41FE-A20B-6A861576786E" name="GUID-9EA2F0C3-6CB6-41FE-A20B-6A861576786E"></a><h5 id="ADXDB-GUID-9EA2F0C3-6CB6-41FE-A20B-6A861576786E" class="sect5"><span class="enumeration_section">4.8.3.4</span>支持的XQuery全文匹配选项</h5>
                     <div>
                        <p>Oracle XML DB支持XQuery全文匹配选项的子集。</p>
                        <div class="section">
                           <p>Oracle XML DB <span class="italic">仅</span>支持以下XQuery全文匹配选项。注意到任何适用的限制。使用术语“必须”和“不得”意味着如果不遵守指定的限制，则会引发错误。使用此处未列出的任何匹配选项会引发错误。
                           </p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>FTStemOption（ <code class="codeph">stemming</code> ， <code class="codeph">no stemming</code> ）</p>
                              </li>
                           </ul>
                           <p>XQuery和XPath全文1.0建议中指定的默认行为用于每个不受支持的匹配选项，但以下情况除外：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>FTLanguage（不支持） - 使用的语言是<span class="italic">默认词法分析器</span>定义的语言，表示安装数据库时使用的语言。
                                 </p>
                              </li>
                              <li>
                                 <p>FTStopWordOption（不支持） - 使用的停止列表是为该语言定义的停止列表。</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="infoboxnotealso" id="GUID-9EA2F0C3-6CB6-41FE-A20B-6A861576786E__GUID-75B2B68B-5437-4B05-9721-DB9390636137">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>有关默认词法分析器的信息，请参阅<a href="../ccref/oracle-text-indexing-elements.html#CCREF2052" target="_blank"><span><cite>Oracle Text Reference</cite></span></a></p>
                              </li>
                              <li>
                                 <p>有关每种支持语言使用的停止列表的信息，请参阅<a href="../ccref/oracle-text-supplied-stoplists.html#CCREF1400" target="_blank"><span><cite>Oracle Text Reference</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048" title="Oracle XML DB支持存储为二进制XML的XMLType数据的XQuery Full Text。 Oracle Text技术提供全文索引和搜索，这是此支持的基础。">支持XQuery全文</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB6143"></a><div class="props_rev_3"><a id="GUID-4D1A5EE7-2A6C-4ED8-B4AC-CA2E1E1030C6" name="GUID-4D1A5EE7-2A6C-4ED8-B4AC-CA2E1E1030C6"></a><h5 id="ADXDB-GUID-4D1A5EE7-2A6C-4ED8-B4AC-CA2E1E1030C6" class="sect5"><span class="enumeration_section">4.8.3.5</span>不支持的XQuery全文功能</h5>
                     <div>
                        <p>指定了Oracle XML DB不支持的XQuery全文功能。</p>
                        <div class="section">
                           <p>除了没有提到的所有FTSelection运营商<a href="xquery-and-XML-DB.html#GUID-6BB43AAA-6C8F-49F4-8EDF-4CBA4EC0E78C" title="Oracle XML DB支持XQuery Full Text FTSelection运算符的子集。">支持XQuery的全文FTSelection运营商</a>中提到的所有匹配选项不<a href="xquery-and-XML-DB.html#GUID-9EA2F0C3-6CB6-41FE-A20B-6A861576786E" title="Oracle XML DB支持XQuery全文匹配选项的子集。">支持XQuery的全文匹配选项</a>中，Oracle XML DB <span class="italic">不</span>支持下面的XQuery全文特点：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>FTIgnoreOption</p>
                              </li>
                              <li>
                                 <p>FTWeight（权重声明，与FTPrimaryWithOptions一起使用）</p>
                              </li>
                              <li>
                                 <p>FTScoreVar（得分变量，与XQuery ForClause和LetClause一起使用或与XPath 2.0 SimpleForClause一起使用）</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048" title="Oracle XML DB支持存储为二进制XML的XMLType数据的XQuery Full Text。 Oracle Text技术提供全文索引和搜索，这是此支持的基础。">支持XQuery全文</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="ADXDB6144"></a><div class="props_rev_3"><a id="GUID-4F5DE0AB-F407-4A2C-A417-C1EDBCE461AD" name="GUID-4F5DE0AB-F407-4A2C-A417-C1EDBCE461AD"></a><h5 id="ADXDB-GUID-4F5DE0AB-F407-4A2C-A417-C1EDBCE461AD" class="sect5"><span class="enumeration_section">4.8.3.6</span> XQuery全文错误</h5>
                     <div>
                        <p>描述了使用XQuery Full Text时可能引发的编译时错误。</p>
                        <div class="section">
                           <p>每当您使用Oracle不支持的XQuery Full Text（XQFT）功能时，都会引发编译时错误。</p>
                           <p>此外，如果您没有创建相应的XML搜索索引或未获取该索引，则只要在SQL <code class="codeph">WHERE</code>子句中使用受支持的XQFT表达式（通常在<code class="codeph">XMLExists</code> ），就会引发编译时错误ORA-18177。
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"></div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>相关话题</strong></p>
                           <ul>
                              <li><a href="xquery-and-XML-DB.html#GUID-4D1A5EE7-2A6C-4ED8-B4AC-CA2E1E1030C6" title="指定了Oracle XML DB不支持的XQuery全文功能。">不受支持的XQuery全文功能</a></li>
                           </ul>
                        </div>
                        <div class="infoboxnotealso" id="GUID-4F5DE0AB-F407-4A2C-A417-C1EDBCE461AD__GUID-78DB5F8A-98CF-45B1-9CBF-68359076D4A8">
                           <p class="notep1">也可以看看：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><a href="indexes-for-XMLType-data.html#GUID-FAB7C619-902A-40CF-98B7-6D358E1AD49C" title="当您需要对XML数据进行全文搜索时，Oracle建议您将XMLType数据存储为二进制XML，并使用XQuery Full Text（XQFT）。您可以使用XML搜索索引。这是本节的主题。">为全文查询索引XML数据，</a>以获取有关创建XML搜索索引和处理错误的信息ORA-18177</p>
                              </li>
                              <li>
                                 <p><a href="query-and-update-XML.html#GUID-F72DC7CD-40A9-4F07-9350-B80D2AD1F4D0" title="涉及XQuery表达式的SQL查询通常可以通过一种或多种方式自动重写（优化）。此优化称为XML查询重写或优化。发生这种情况时，实际上，XQuery表达式直接针对XML文档进行评估，而无需在内存中构建DOM。">XQuery的性能调优，</a>用于有关除forward和descendent之外的轴的信息</p>
                              </li>
                              <li>
                                 <p>有关SQL内置数据类型的信息，请<a href="../sqlrf/Data-Types.html#SQLRF50972" target="_blank"><span><cite>参见Oracle数据库SQL语言参考</cite></span></a></p>
                              </li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>父主题：</strong> <a href="xquery-and-XML-DB.html#GUID-B87B6721-11A8-4E6F-A693-97DC4AAE2048" title="Oracle XML DB支持存储为二进制XML的XMLType数据的XQuery Full Text。 Oracle Text技术提供全文索引和搜索，这是此支持的基础。">支持XQuery全文</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
            <hr><br><p style="text-decoration:underline">脚注图例</p>脚注1：<p>返回的值一如既往地是一个序列。但是，在XQuery中，一个项目的序列等同于该项目本身。在这种情况下，单个项目是布尔值。</p><br>脚注2：<p>名称空间前缀<code class="codeph">xs</code>是为XML Schema名称空间预定义的， <code class="codeph">http://www.w3.org/2001/XMLSchema</code> 。</p><br>脚注3：<p>问号（ <code class="codeph">?</code> ）这是一个零或一个出现指示符，指示参数可以是空序列。请参阅<a href="xquery-and-XML-DB.html#GUID-1F1A44CF-793C-4033-B91B-F519FB6B3BED" title="XQuery表达式区分大小写。XQuery表达式是简单表达式或更新表达式，后者是表示数据修改的表达式。更准确地说，这些是可能的XQuery表达式：">XQuery表达式</a> 。
            </p><br>脚注4：<p>在Oracle Database 12c第1版（12.1.0.1）之前，pragmas <code class="codeph">ora:no_xmlquery_rewrite</code>和<code class="codeph">ora:xmlquery_rewrite</code>分别命名为<code class="codeph">ora:xq_proc</code>和<code class="codeph">ora:xq_qry</code> 。它们被重新命名为可读性，意义没有变化。
            </p><br></div>
      </article>
   </body>
</html>