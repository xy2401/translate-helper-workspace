<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>恢复</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Backup and Recovery Reference"></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Backup and Recovery Reference"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="database-backup-and-recovery-reference.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-01-09T19:31:58-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96242-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="RESET-DATABASE.html" title="Previous" type="text/html"></link>
      <link rel="next" href="RESYNC-CATALOG.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery Reference"></meta>
    <meta name="dcterms.isVersionOf" content="RCMRF"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="RESET-DATABASE.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="RESYNC-CATALOG.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">备份和恢复参考</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="rman-commands-recover-to-validate.html" property="item" typeof="WebPage"><span property="name">RMAN命令：RECOVER to VALIDATE</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">恢复</li>
            </ol>
            <a id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B" name="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B"></a><a id="RCMRF90294"></a><a id="RCMRF90622"></a><a id="RCMRF90295"></a><a id="RCMRF90296"></a><a id="RCMRF90297"></a><a id="RCMRF90298"></a><a id="RCMRF90299"></a><a id="RCMRF90300"></a><a id="RCMRF90301"></a><a id="RCMRF90302"></a><a id="RCMRF90623"></a><a id="RCMRF90303"></a><a id="RCMRF90304"></a><a id="RCMRF90305"></a><a id="RCMRF90306"></a><a id="RCMRF90307"></a><a id="RCMRF90308"></a><a id="RCMRF90309"></a><a id="RCMRF90310"></a><a id="RCMRF90311"></a><a id="RCMRF90312"></a><a id="RCMRF90313"></a><a id="RCMRF90314"></a><a id="RCMRF90315"></a><a id="RCMRF90316"></a><a id="RCMRF90317"></a><a id="RCMRF90318"></a><a id="RCMRF90319"></a><a id="RCMRF90624"></a><a id="RCMRF90625"></a><a id="RCMRF90626"></a><a id="RCMRF90627"></a><a id="RCMRF90628"></a><a id="RCMRF90629"></a><a id="RCMRF149"></a>
            
            <h2 id="RCMRF-GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B" class="sect2"><span class="enumeration_section">3.8</span>恢复</h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p class="subhead1" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-38EB3B5B-F7F7-4C9D-8E8D-6F75B60D68B4">目的</p>
                  <p>使用<code class="codeph">RESTORE</code>命令还原，验证或预览RMAN备份。通常，在介质故障损坏当前数据文件，控制文件或归档重做日志时或在执行时间点恢复之前还原备份。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-443D7784-C602-4DB7-B0F8-6D8B23C14E46">先决条件</p>
                  <p>要将数据文件还原到其当前位置，必须使用要脱机还原的表空间或数据文件启动，装入或打开数据库。</p>
                  <p>如果在Data Guard环境中使用RMAN，则将RMAN连接到恢复目录。</p>
                  <p>如果要对生产数据库执行试验性还原，请在测试环境中还原数据库之前执行以下任一操作：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>如果测试数据库使用的物理快速恢复区域与生产数据库使用的恢复区域<span class="italic">不同</span> ，则将测试数据库实例中的<code class="codeph">DB_RECOVERY_FILE_DEST</code>设置为新位置。
                        </p>
                     </li>
                     <li>
                        <p>如果测试数据库使用的快速恢复区域与生产数据库使用的恢复区域在物理上<span class="italic">相同</span> ，则将测试数据库实例中的<code class="codeph">DB_UNIQUE_NAME</code>设置为与生产数据库不同的名称。
                        </p>
                     </li>
                  </ul>
                  <p>如果不执行上述任一操作，则RMAN会假定您要还原生产数据库并删除<a id="d82198e229" class="indexterm-anchor"></a>闪回日志来自快速恢复区域，因为它们被认为是不可用的。
                  </p>
                  <p>如果还原加密数据库或表空间，则必须先打开Oracle密钥库，然后再执行还原操作。</p>
                  <p></p>
                  <p>要使用预刷新备份还原目标CDB中的数据文件，必须打开root用户，并且必须以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的公共用户身份连接到root用户。
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-A8181FDC-09AE-4A86-9399-6E1D2AEB5FF6">使用说明</p>
                  <p><code class="codeph">RESTORE</code>命令可还原完整备份，0级增量备份或映像副本。您可以将文件还原到其默认位置或其他位置。
                  </p>
                  <p>默认情况下，RMAN会检查只读数据文件以确保它们存在，可读并具有正确的检查点。如果不满足任何条件，则RMAN将恢复文件。如果满足所有条件，则RMAN不会还原文件。</p>
                  <p></p>
                  <p>您不能使用单个<code class="codeph">RESTORE</code>命令来还原属于多个PDB备份的数据文件。
                  </p>
                  <p><span class="bold">备份选择</span></p>
                  <p>默认情况下， <code class="codeph">RESTORE</code>选择最新的备份集或文件副本，即需要最少介质恢复的文件副本或备份集。RMAN仅还原在<code class="codeph">RESTORE</code>命令分配的相同类型通道上创建的备份。例如，如果使用<code class="codeph">DISK</code>和<code class="codeph">sbt</code>通道备份数据文件，并且仅为<code class="codeph">RESTORE</code>命令分配了<code class="codeph">DISK</code>通道，则RMAN不会还原<code class="codeph">sbt</code>备份。如果您不手动分配频道，则RMAN会根据<code class="codeph">DEVICE TYPE</code>选项施加的任何限制来分配它可能需要的所有自动频道。
                  </p>
                  <p>在Oracle RAC配置中，RMAN会自动从可以读取磁带或本地文件系统上的文件的通道还原备份，控制文件副本和数据文件副本。例如，如果信道<code class="codeph">ch1</code>连接到<code class="codeph">inst1</code>可以读取它的磁带驱动器日志1000，但信道<code class="codeph">ch2</code>连接到<code class="codeph">inst2</code>不能读取从它的磁带驱动器相同的日志，然后<code class="codeph">ch2</code>不能参与恢复日志等<code class="codeph">ch1</code>恢复日志。当通道具有不同的<code class="codeph">PARMS</code>或<code class="codeph">CONNECT</code>设置时，将自动启用自动<code class="codeph">PARMS</code> 。
                  </p>
                  <p>如果数据文件名是符号链接，则控制文件存储链接文件的文件名，但RMAN对链接文件指向的数据文件执行I / O.如果链接文件丢失并且您在不重新创建符号链接的情况下还原数据文件，则RMAN会将数据文件还原到链接文件的位置，而不是链接文件指向的位置。</p>
                  <div class="infoboxnotealso" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-7648D567-3EEA-4A1B-B0D3-45460A104162">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../bradv/rman-data-repair-concepts.html#BRADV30001" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a> ，了解有关还原故障转移的详细信息</p>
                  </div>
                  <p><span class="bold">恢复CDB和PDB的操作</span><a id="d82198e328" class="indexterm-anchor"></a><a id="d82198e332" class="indexterm-anchor"></a><a id="d82198e336" class="indexterm-anchor"></a><a id="d82198e340" class="indexterm-anchor"></a></p>
                  <p><code class="codeph">RESTORE</code>命令可用于还原整个多租户容器数据库（CDB），根，一个或多个可插拔数据库（PDB）以及PDB中的表空间。本节中有关恢复数据的信息也适用于恢复CDB和PDB。
                  </p>
                  <p>恢复CDB和PDB的过程类似于非CDB的过程。唯一的区别在于连接数据库和使用的命令。要还原整个CDB，根或多个PDB，请连接到根。要还原特定PDB，请连接到该PDB。在还原PDB时，请使用<code class="codeph">RESTORE PLUGGABLE DATABASE</code> 。要还原CDB，请使用<code class="codeph">RESTORE DATABASE</code>并还原根，请使用<code class="codeph">RESTORE DATABASE ROOT</code> 。</p>
                  <div class="infoboxnotealso" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-EFA9690C-7997-40F0-83A5-E68819C273EB">
                     <p class="notep1">也可以看看：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="CONNECT.html#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67">CONNECT</a></p>
                        </li>
                        <li>
                           <p>有关如何还原CDB和PDB的详细信息，请参见<a href="../bradv/rman-complete-database-recovery.html#BRADV-GUID-D908719C-9D46-4084-850C-0F81C25094EB" target="_blank"><span><cite>“Oracle数据库备份和恢复用户指南”</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
                  <p><span class="bold">稀疏数据库的还原操作</span></p>
                  <p>RMAN还允许您在<code class="codeph">COMPATIBLE</code>初始化参数设置为12.2或更高的情况下对多租户和非CDB稀疏数据库执行还原。RMAN允许您通过识别所选稀疏备份的最相关备份集或映像副本来还原数据文件，表空间，PDB或CDB。要还原稀疏备份，请运行<code class="codeph">RESTORE FROM SPARSE</code>命令。
                  </p>
                  <p></p>
                  <p>对于非临时稀疏文件，如果稀疏数据文件最初位于稀疏磁盘组上，但<code class="codeph">DB_CREATE_FILE_DEST</code>指定的备用位置是非稀疏磁盘组，则RMAN会在其原始磁盘组（而不是磁盘组）中创建数据文件由<code class="codeph">DB_CREATE_FILE_DEST</code>指定）</p>
                  <p><span class="bold">使用加密备份集还原操作</span></p>
                  <p><a id="d82198e400" class="indexterm-anchor"></a>如<span class="q">“ <a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50__CHDIHIGD">备份集加密</a> ”中所述</span> ，RMAN在还原操作期间如何处理加密备份集取决于创建备份的加密模式。您可以使用<code class="codeph"><a href="CONFIGURE.html#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code>和<code class="codeph"><a href="SET.html#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code>来管理数据库的RMAN备份加密设置。请注意以下还原注意事项：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a id="d82198e422" class="indexterm-anchor"></a>对于透明模式加密备份，必须在Oracle软件密钥库中提供所需的密码。创建备份时使用的相同密钥库必须在打开并在还原时可用。如果在创建备份时使用了基于密码的密钥库，则必须使用<code class="codeph">SET DECRYPTION WALLET OPEN IDENTIFIED BY</code>来提供用于打开密钥库的密码。
                        </p>
                     </li>
                     <li>
                        <p><a id="d82198e430" class="indexterm-anchor"></a>对于密码模式加密备份，必须使用<code class="codeph">SET DECRYPTION</code>提供所需的密码。</p>
                     </li>
                     <li>
                        <p>对于双模式加密备份，必须在Oracle软件密钥库中提供所需的密码，或者使用<code class="codeph">SET DECRYPTION</code>提供所需的密码。</p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-6C245F3A-6EDA-4339-994F-5DD3315343FA">
                     <p class="notep1">注意：</p>
                     <p>基于密钥库的加密比基于密码的加密更安全，因为不涉及密码。仅在绝对必要时才使用基于密码的加密，因为备份必须是可传输的。</p>
                  </div>
                  <p><span class="bold">还原故障转移</span></p>
                  <p>如果无法访问备份片，映像副本或代理副本，或者块已损坏，则RMAN会执行<a id="d82198e453" class="indexterm-anchor"></a><a id="d82198e455" class="indexterm-anchor"></a><a id="d82198e459" class="indexterm-anchor"></a><a id="d82198e463" class="indexterm-anchor"></a><a id="d82198e467" class="indexterm-anchor"></a>恢复故障转移。<code class="codeph">RESTORE</code>命令自动在同一设备和其他设备上查找备份或映像副本的另一个可用副本。如果没有可用的副本，则RMAN将搜索以前的备份。RMAN会不断搜索以前可用的备份，直到它耗尽所有可能性。如果需要，RMAN会自动使用以前数据库版本中符合条件的备份。
                  </p>
                  <p>如果要还原没有可用备份的数据文件，则RMAN会创建一个空数据文件，并将检查点更改为创建SCN。在恢复期间，将恢复所有存档的重做日志文件回到数据文件的创建，并重新应用数据文件历史记录期间的所有更改以重新创建其内容。</p>
                  <div class="infoboxnotealso" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-897548D0-B773-41A9-BDA6-3BE44939323E">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50__CHDIHIGD">备份集的加密</a> ”</span>以及“ <a href="../bradv/backing-up-database-advanced.html#BRADV72450" target="_blank"><span class="italic">Oracle数据库备份和恢复用户指南</span></a> <span class="q">”中</span>的扩展讨论</p>
                  </div>
                  <p><span class="bold">已还原数据文件的位置</span></p>
                  <p><a id="d82198e491" class="indexterm-anchor"></a>如果将数据文件还原到默认位置，则RMAN将使用相同的文件名覆盖文件。默认情况下，如果数据文件位于正确的位置且其标头包含预期数据，则RMAN不会还原该数据文件。RMAN不会扫描数据文件正文以查找损坏的块。
                  </p>
                  <p>如果RMAN检测到无法使用默认文件名（例如，该文件可能是Oracle管理的文件，或者是<a id="d82198e498" class="indexterm-anchor"></a>自动存储管理磁盘组），然后RMAN尝试在同一位置或磁盘组中创建新文件。
                  </p>
                  <p>RMAN将数据文件还原到当前存储在恢复目录中的位置。此默认行为消除了将数据文件还原到自原始备份以来可能已过时的位置的问题。这也意味着，如果您已从原始备份位置更改了数据文件的位置，则该RMAN会将文件还原到最新或更改的位置。</p>
                  <p>要将文件还原到非默认位置，请使用<code class="codeph"><a href="SET.html#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">NEWNAME</code>命令重命名还原的文件，然后使用<code class="codeph"><a href="SWITCH.html#GUID-BEA73581-C6F4-4346-A61B-B6C19513BF1C">SWITCH</a></code>命令使还原的文件保持最新（如<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEAAH">示例3-25中所示</a> ）。如果不发出<code class="codeph">SWITCH</code>命令，则RMAN会将还原的文件视为有效副本，以便在将来的还原操作中使用。<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDCJADE" title="解释SET NEWNAME，SWITCH和RESTORE之间的交互">表3-8</a>介绍了<code class="codeph">RESTORE</code> ， <code class="codeph">SET NEWNAME</code>和<code class="codeph">SWITCH</code>命令的行为。
                  </p>
                  <div class="tblformal" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDCJADE">
                     <p class="titleintable">表3-8设置NEWNAME，SWITCH和RESTORE</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="设置NEWNAME，SWITCH和RESTORE" width="100%" border="1" summary="Explains the interaction between SET NEWNAME, SWITCH, and RESTORE" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="17%" id="d82198e551">SET NEWNAME运行</th>
                              <th align="left" valign="bottom" width="17%" id="d82198e554">SWITCH Run</th>
                              <th align="left" valign="bottom" width="67%" id="d82198e557">恢复行为</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="17%" id="d82198e562" headers="d82198e551 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d82198e562 d82198e554 ">
                                 <p>N / A</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d82198e562 d82198e557 ">
                                 <p>RMAN将文件还原到存储在恢复目录中的最新位置。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="17%" id="d82198e572" headers="d82198e551 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d82198e572 d82198e554 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d82198e572 d82198e557 ">
                                 <p>RMAN将文件还原为<code class="codeph">SET</code> <code class="codeph">NEWNAME</code>指定的路径名。 RMAN使用还原文件的名称替换控制文件中的当前数据文件名。RMAN使用旧名称记录数据文件作为数据文件副本。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="17%" id="d82198e588" headers="d82198e551 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d82198e588 d82198e554 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="67%" headers="d82198e588 d82198e557 ">
                                 <p>RMAN将文件还原为<code class="codeph">SET</code> <code class="codeph">NEWNAME</code>指定的路径名。 RMAN不会更新控制文件中的当前数据文件名。还原的文件在RMAN存储库中列为数据文件副本。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>由于无法备份临时文件，并且因为没有为它们生成重做，因此RMAN永远不会恢复或恢复临时文件。RMAN会跟踪临时文件的名称，但只能在需要时自动重新创建它们。</p>
                  <p><span class="bold">还原控制文件时的RMAN行为</span></p>
                  <p>恢复控制文件时RMAN的行为取决于各种因素，如<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEFBD" title="描述在各种情况下恢复控制文件">表3-9所示</a> 。<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDBGBBD" title="描述使用各种选项从自动备份恢复">表3-10</a>总结了还原自动备份所需的命令和选项。
                  </p>
                  <div class="tblformalwide" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEFBD">
                     <p class="titleintable">表3-9 RESTORE CONTROLFILE场景</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="恢复控制文件场景" width="100%" border="1" summary="Describes restoration of control files under various scenarios" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="12%" id="d82198e634">RMAN连接</th>
                              <th align="left" valign="bottom" width="12%" id="d82198e637">RESTORE CONTROLFILE;</th>
                              <th align="left" valign="bottom" width="25%" id="d82198e640">从AUTOBACKUP恢复CONTROLFILE;</th>
                              <th align="left" valign="bottom" width="25%" id="d82198e643">恢复控制文件...TO'文件名';</th>
                              <th align="left" valign="bottom" width="25%" id="d82198e649">恢复控制文件...来自'media_handle'或TAG'user_tag';</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="12%" id="d82198e660" headers="d82198e634 ">
                                 <p>没有目录，目标数据库在<code class="codeph">NOMOUNT</code>状态下启动</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d82198e660 d82198e637 ">
                                 <p>错误。必须指定<code class="codeph">FROM AUTOBACKUP</code> 。</p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e660 d82198e640 ">
                                 <p>恢复到<code class="codeph">CONTROL_FILES</code>位置。有关所需的命令和选项，请参阅<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDBGBBD" title="描述使用各种选项从自动备份恢复">表3-10</a> 。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e660 d82198e643 ">
                                 <p>必须指定<code class="codeph">FROM AUTOBACKUP</code> 。仅恢复到<span class="italic"><code class="codeph">filename</code></span> 。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e660 d82198e649 ">
                                 <p>首先运行<code class="codeph"><a href="SET.html#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">DBID</code> 。从指定文件恢复（无法从<code class="codeph">TAG</code>恢复）。如果<code class="codeph">TO</code> “ <span class="italic"><code class="codeph">filename</code></span>不使用”，恢复到全部<code class="codeph">CONTROL_FILES</code>位置。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="12%" id="d82198e719" headers="d82198e634 ">
                                 <p>没有目录，目标数据库已挂载或打开</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d82198e719 d82198e637 ">
                                 <p>错误。必须使用<code class="codeph">TO</code> “ <span class="italic"><code class="codeph">filename</code></span> ”，其中<span class="italic"><code class="codeph">filename</code></span>是不是在<code class="codeph">CONTROL_FILES</code>列表。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e719 d82198e640 ">
                                 <p>错误。必须使用<code class="codeph">TO</code> “ <span class="italic"><code class="codeph">filename</code></span> ”，其中<span class="italic"><code class="codeph">filename</code></span>是不是在<code class="codeph">CONTROL_FILES</code>列表。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e719 d82198e643 ">
                                 <p>仅恢复为<span class="italic"><code class="codeph">filename</code></span> ，其中<span class="italic"><code class="codeph">filename</code></span>不在<code class="codeph">CONTROL_FILES</code>列表中。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e719 d82198e649 ">
                                 <p>RMAN发出错误<a id="d82198e773" class="indexterm-anchor"></a><a id="d82198e775" class="indexterm-anchor"></a> <code class="codeph">RMAN-06496</code> 。使用<code class="codeph">TO</code> “ <span class="italic"><code class="codeph">filename</code></span> ”代替。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="12%" id="d82198e790" headers="d82198e634 ">
                                 <p>目录，目标数据库在<code class="codeph">NOMOUNT</code>状态下启动</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d82198e790 d82198e637 ">
                                 <p>恢复到<code class="codeph">CONTROL_FILES</code>位置。仅当<code class="codeph">DB_NAME</code>在目录中不唯一时才运行<code class="codeph"><a href="SET.html#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">DBID</code> 。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e790 d82198e640 ">
                                 <p>仅用于恢复目录以进行测试。</p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e790 d82198e643 ">
                                 <p>仅恢复为<span class="italic"><code class="codeph">filename</code></span> ，其中<span class="italic"><code class="codeph">filename</code></span>不在<code class="codeph">CONTROL_FILES</code>列表中。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e790 d82198e649 ">
                                 <p>从指定文件恢复。如果<code class="codeph">TO</code> “ <span class="italic"><code class="codeph">filename</code></span>不使用”，恢复到全部<code class="codeph">CONTROL_FILES</code>位置。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="12%" id="d82198e844" headers="d82198e634 ">
                                 <p>目录，目标数据库已安装或打开</p>
                              </td>
                              <td align="left" valign="top" width="12%" headers="d82198e844 d82198e637 ">
                                 <p>错误。必须使用<code class="codeph">TO</code> “ <span class="italic"><code class="codeph">filename</code></span> ”，其中<span class="italic"><code class="codeph">filename</code></span>是不是在<code class="codeph">CONTROL_FILES</code>列表。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e844 d82198e640 ">
                                 <p>不要与恢复目录一起使用。</p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e844 d82198e643 ">
                                 <p>仅恢复为<span class="italic"><code class="codeph">filename</code></span> ，其中<span class="italic"><code class="codeph">filename</code></span>不在<code class="codeph">CONTROL_FILES</code>列表中。
                                 </p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d82198e844 d82198e649 ">
                                 <p>RMAN发出错误<a id="d82198e884" class="indexterm-anchor"></a><a id="d82198e886" class="indexterm-anchor"></a> <code class="codeph">RMAN-06496</code> 。使用<code class="codeph">TO</code> “ <span class="italic"><code class="codeph">filename</code></span> ”代替。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>如果你在一个使用RMAN <a id="d82198e902" class="indexterm-anchor"></a> Data Guard环境，然后RMAN透明地将主控制文件转换为备用控制文件，反之亦然。当您发出<code class="codeph">RESTORE</code>和<code class="codeph"><a href="RECOVER.html#GUID-CA98040F-9865-4F4F-BAF2-91C518612E95">RECOVER</a></code>时，RMAN会自动更新数据文件，联机重做日志，备用重做日志和临时文件的文件名。恢复目录始终包含有关每个数据库的备份文件名的正确信息，如<span class="q">“ <a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50__CHDJIIGD">Data Guard环境中的RMAN备份”中所述</a></span> 。
                  </p>
                  <p><span class="bold">控制文件和服务器参数文件自动备份选项</span></p>
                  <p><a id="d82198e923" class="indexterm-anchor"></a><a id="d82198e927" class="indexterm-anchor"></a><a id="d82198e931" class="indexterm-anchor"></a>还原自动备份时，您使用的命令和选项取决于自动备份类型（控制文件或服务器参数文件）和位置（快速恢复区域内部或外部）。<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDBGBBD" title="描述使用各种选项从自动备份恢复">表3-10</a>总结了这些选项。
                  </p>
                  <div class="tblformalwide" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDBGBBD">
                     <p class="titleintable">表3-10 RESTORE ...来自AUTOBACKUP</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="恢复......来自AUTOBACKUP" width="100%" border="1" summary="Describes restoration from autobackups using various options" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="11%" id="d82198e955">恢复对象</th>
                              <th align="left" valign="bottom" width="16%" id="d82198e958">自动备份位置</th>
                              <th align="left" valign="bottom" width="15%" id="d82198e961">运行SET DBID？</th>
                              <th align="left" valign="bottom" width="17%" id="d82198e964">在RESTORE上指定RECOVERY AREA？</th>
                              <th align="left" valign="bottom" width="20%" id="d82198e967">在RESTORE上指定DB_NAME或DB_UNIQUE_NAME？</th>
                              <th align="left" valign="bottom" width="22%" id="d82198e970">运行SET CONTROLFILE AUTOBACKUP格式？</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="11%" id="d82198e975" headers="d82198e955 ">
                                 <p>SPFILE</p>
                              </td>
                              <td align="left" valign="top" width="16%" headers="d82198e975 d82198e958 ">
                                 <p>恢复区</p>
                              </td>
                              <td align="left" valign="top" width="15%" headers="d82198e975 d82198e961 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d82198e975 d82198e964 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d82198e975 d82198e967 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d82198e975 d82198e970 ">
                                 <p>没有</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="11%" id="d82198e994" headers="d82198e955 ">
                                 <p>SPFILE</p>
                              </td>
                              <td align="left" valign="top" width="16%" headers="d82198e994 d82198e958 ">
                                 <p>外部恢复区</p>
                              </td>
                              <td align="left" valign="top" width="15%" headers="d82198e994 d82198e961 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d82198e994 d82198e964 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d82198e994 d82198e967 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d82198e994 d82198e970 ">
                                 <p>仅当自动备份不在默认位置时</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="11%" id="d82198e1013" headers="d82198e955 ">
                                 <p>控制文件</p>
                              </td>
                              <td align="left" valign="top" width="16%" headers="d82198e1013 d82198e958 ">
                                 <p>恢复区</p>
                              </td>
                              <td align="left" valign="top" width="15%" headers="d82198e1013 d82198e961 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d82198e1013 d82198e964 ">
                                 <p>仅当自动备份处于非当前恢复区域时</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d82198e1013 d82198e967 ">
                                 <p>仅当自动备份位于非当前恢复区域并使用非当前<code class="codeph">DB_UNIQUE_NAME</code></p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d82198e1013 d82198e970 ">
                                 <p>没有</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="11%" id="d82198e1034" headers="d82198e955 ">
                                 <p>控制文件</p>
                              </td>
                              <td align="left" valign="top" width="16%" headers="d82198e1034 d82198e958 ">
                                 <p>外部恢复区</p>
                              </td>
                              <td align="left" valign="top" width="15%" headers="d82198e1034 d82198e961 ">
                                 <p>是</p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d82198e1034 d82198e964 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d82198e1034 d82198e967 ">
                                 <p>没有</p>
                              </td>
                              <td align="left" valign="top" width="22%" headers="d82198e1034 d82198e970 ">
                                 <p>仅当自动备份不在默认位置时</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p><span class="bold">在NOCATALOG模式下从存档备份还原控制文件</span></p>
                  <p>您可以将存储在磁盘上的备份卸载到磁带或Oracle Cloud。启用控制文件自动备份并使用以下命令之一将磁盘备份存档到磁带或Oracle Cloud时，RMAN包括最新控制文件到磁带或Oracle Cloud的备份：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">BACKUP BACKUPSET ALL</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">备份恢复区域</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">备份数据文件复制全部</code></p>
                     </li>
                  </ul>
                  <p>要还原这些备份，在未使用恢复目录时，必须配置一个或多个磁盘和SBT通道（用于磁带或Oracle Cloud）。</p>
                  <p>参见<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-24D7B81E-CECC-44EF-B6B7-6DD2F4766423">例3-29</a> 。
                  </p>
                  <p id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CFAFGIJJ"><span class="bold">使用远程主机中的文件还原数据文件和控制文件</span><a id="d82198e1080" class="indexterm-anchor"></a><a id="d82198e1084" class="indexterm-anchor"></a><a id="d82198e1088" class="indexterm-anchor"></a><a id="d82198e1092" class="indexterm-anchor"></a></p>
                  <p>与Oracle数据库<span class="italic">12c的</span>开始，你可以恢复数据库，数据文件，控制文件，表空间，或使用文件从远程数据库的是spfile。RMAN连接到远程数据库，并使用备份集将所需文件通过网络传输到目标数据库。这在Data Guard环境中非常有用。您可以通过网络连接到备用数据库来还原主数据库上的数据文件。您还可以通过连接到主数据库来还原备用数据库上的数据文件。
                  </p>
                  <p>通过网络从远程主机还原文件时，必须使用<code class="codeph">FROM SERVICE</code>指定从中获取文件的远程主机的服务名称。（可选）使用<code class="codeph">SECTION SIZE</code>将源数据库中的文件还原为多节备份集。您可以通过指定<code class="codeph">USING COMPRESSED BACKUPSET</code>来压缩传输的文件。</p>
                  <p>要加密从源数据库传输的文件，请在RESTORE命令之前使用<code class="codeph">SET ENCRYPTION</code>命令。您还可以使用<code class="codeph">SET COMPRESSION ALGORITHM</code>指定在通过网络传输备份集之前压缩备份集的算法。
                  </p>
                  <p><span class="bold">使用远程主机还原文件的先决条件</span></p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>源数据库和目标数据库上的密码文件必须相同。</p>
                     </li>
                     <li>
                        <p>目标数据库中的<code class="codeph">tnsnames.ora</code>文件必须包含与远程数据库对应的条目。
                        </p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-EAECBC7B-CE1C-4344-924C-FBEDBFF6ECC8">句法</p>
                  <p><a id="d82198e1137" class="indexterm-anchor"></a><a id="d82198e1141" class="indexterm-anchor"></a> <span class="bold"><span class="italic">restore</span> :: =</span></p>
                  <div class="figure" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-13F7CB53-33B9-4CF4-B2C7-6EB2C07473F1"><img src="img/restore.gif" alt="restore.eps的描述如下" title="restore.eps的描述如下" longdesc="img_text/restore.html"><br><a href="img_text/restore.html">说明restore.eps的说明</a></div>
                  <!-- class="figure" -->
                  <p>（ <span class="italic"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDIJJJD">restoreObject :: =</a></span> ， <span class="italic"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDCEJCJ">restoreSpecOperand :: =</a></span> ， <span class="italic"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC__BABDEJAC">deviceSpecifier :: =</a></span> ， <span class="italic"><a href="untilClause.html#GUID-6A6C502A-6E21-4673-9FC9-C075D1E2F97A__BABEDABD">untilClause :: =</a></span> ）</p>
                  <p id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDIJJJD"><a id="d82198e1171" class="indexterm-anchor"></a><a id="d82198e1175" class="indexterm-anchor"></a> <span class="bold"><span class="italic">restoreObject</span> :: =</span></p>
                  <div class="figure" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-A2277858-B4FD-425A-B3D1-CE25FADD42C1"><img src="img/restoreobject.gif" alt="restoreobject.eps的描述如下" title="restoreobject.eps的描述如下" longdesc="img_text/restoreobject.html"><br><a href="img_text/restoreobject.html">说明restoreobject.eps的说明</a></div>
                  <!-- class="figure" -->
                  <p>（ <span class="italic"><a href="archivelogRecordSpecifier.html#GUID-DDF929FF-796B-4AD6-AE58-F831CAFC7703__BABJGBFG">archivelogRecordSpecifier :: =</a></span> ， <span class="italic"><a href="datafileSpec.html#GUID-A0A69931-D404-4D89-8F95-3AB898B6A220__BABCCBBJ">datafileSpec :: =</a></span> ， <span class="italic"><a href="foreignFileSpec.html#GUID-38CC0715-B32B-4394-92FB-3E0CB7C3ABE3__CIHFBDBF">foreignFileSpec :: =</a></span> ）</p>
                  <p id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDCEJCJ"><a id="d82198e1201" class="indexterm-anchor"></a><a id="d82198e1203" class="indexterm-anchor"></a> <span class="bold"><span class="italic">restoreSpecOperand</span> :: =</span></p>
                  <div class="figure" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-BA92DFD7-1618-4B78-A4F0-1247AF3194B9"><img src="img/restorespecoperand.gif" alt="restorespecoperand.eps的描述如下" title="restorespecoperand.eps的描述如下" longdesc="img_text/restorespecoperand.html"><br><a href="img_text/restorespecoperand.html">说明restorespecoperand.eps的说明</a></div>
                  <!-- class="figure" -->
                  <p><a id="d82198e1215" class="indexterm-anchor"></a><a id="d82198e1219" class="indexterm-anchor"></a> <span class="bold"><span class="italic">autoBackupOptList</span> :: =</span></p>
                  <div class="figure" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-805921B0-4F3B-4C1C-AF5D-103F0AAF2A83"><img src="img/autobackupoptlist.gif" alt="autobackupoptlist.eps的描述如下" title="autobackupoptlist.eps的描述如下" longdesc="img_text/autobackupoptlist.html"><br><a href="img_text/autobackupoptlist.html">autobackupoptlist.eps插图的说明</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-B62EA39D-58EE-46D2-88E7-AF7EF5207F25">语义</p>
                  <p id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__I1017375"><span class="bold"><span class="italic">恢复</span></span></p>
                  <p>此子句使您可以选择要还原的文件，并指定控制还原操作行为的参数。</p>
                  <div class="tblformalwide" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-8DE95FE2-A16D-4EF1-8B52-859C89D4AB6E">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Describes RESTORE command parameters" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d82198e1247">语法元素</th>
                              <th align="left" valign="bottom" width="71%" id="d82198e1250">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1255" headers="d82198e1247 ">
                                 <p><span class="italic"><code class="codeph"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__BGBJJGCB">restoreObject</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1255 d82198e1250 ">
                                 <p>指定要还原的文件。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1265" headers="d82198e1247 ">
                                 <p><span class="italic"><code class="codeph"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__I1036865">restoreSpecOperand</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1265 d82198e1250 ">
                                 <p>指定<span class="italic"><code class="codeph"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__BGBJJGCB">restoreObject</a></code></span>子句的选项。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1280" headers="d82198e1247 ">
                                 <p><code class="codeph">作为加密</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1280 d82198e1250 ">
                                 <p></p>
                                 <p>通过加密已还原的数据文件块来还原数据库或指定表空间的备份。当您希望使用现有RMAN备份将内部部署数据库移动到Oracle Cloud时，这非常有用。内部部署数据库及其备份未加密。使用<code class="codeph">AS ENCRYPTED</code>还原这些备份可确保Oracle Cloud数据库已加密。RMAN使用数据库密钥加密数据。
                                 </p>
                                 <p>必须安装目标数据库。在运行<code class="codeph">RESTORE...之前，必须创建并打开钱包<code class="codeph">RESTORE...AS ENCRYPTED</code>命令。
                                 </p>
                                 <p>要使用此子句，必须将目标数据库的<code class="codeph">COMPATIBLE</code>参数设置为12.2或更高，并且必须在<code class="codeph">COMPATIBLE</code>设置为12.2或更高时创建所使用的备份。
                                 </p>
                                 <p><span class="bold">注意：</span>仅在还原整个数据库或表空间时才支持此子句。
                                 </p>
                                 <p><span class="bold">注意：</span>您不能对<code class="codeph">AS ENCRYPTED</code>使用<code class="codeph">DATAFILE</code> ， <code class="codeph">FOREIGN DATAFILE</code> ， <code class="codeph">ARCHIVELOG</code> ， <code class="codeph">FOREIGN ARCHIVELOG</code> ， <code class="codeph">SPFILE</code>和<code class="codeph">CONTROLFILE</code>子句。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1335" headers="d82198e1247 ">
                                 <p><code class="codeph">作为解密</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1335 d82198e1250 ">
                                 <p></p>
                                 <p>恢复加密数据库或表空间的备份，以便恢复的数据块不加密。通过使用现有RMAN备份将Oracle云上的数据库移动到本地安装时，这非常有用。加密用于Oracle Cloud中的数据文件和备份。您可以选择还原在Oracle Cloud上创建的加密数据库或表空间的备份，并创建不使用加密的内部部署数据库。必须安装目标数据库。</p>
                                 <p>您只能将使用数据库密钥加密的表空间还原为未加密的备份。这包括先前使用在Oracle Cloud上创建的加密或表空间进行恢复的表空间，而没有显式加密子句。创建为加密的表空间或在使用加密的还原操作后显式重新键入的表空间将不会被解密。</p>
                                 <p>要使用此子句，必须将<code class="codeph">COMPATIBLE</code>参数设置为12.2或更高，并且必须在<code class="codeph">COMPATIBLE</code>设置为12.2或更高时创建备份。
                                 </p>
                                 <p><span class="bold">注意：</span>建议您在加密后不解密<code class="codeph">SYSTEM</code>和<code class="codeph">UNDO</code>表空间。这将导致加密表空间的回滚段被解密。
                                 </p>
                                 <p><span class="bold">注意：</span>仅在还原整个数据库或表空间时才支持此子句。
                                 </p>
                                 <p><span class="bold">注意：</span>您不能对<code class="codeph">AS DECRYPTED</code>使用<code class="codeph">DATAFILE</code> ， <code class="codeph">FOREIGN DATAFILE</code> ， <code class="codeph">ARCHIVELOG</code> ， <code class="codeph">FOREIGN ARCHIVELOG</code> ， <code class="codeph">SPFILE</code>和<code class="codeph">CONTROLFILE</code>子句。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1394" headers="d82198e1247 ">
                                 <p><code class="codeph">CHANNEL</code> <span class="italic"><code class="codeph">channel_id</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1394 d82198e1250 ">
                                 <p>请参阅<span class="italic"><code class="codeph"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__I1036865">restoreSpecOperand</a></code></span>子句。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1411" headers="d82198e1247 ">
                                 <p><code class="codeph">检查逻辑</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1411 d82198e1250 ">
                                 <p>测试通过物理损坏检查逻辑损坏的数据和索引块，例如，行片段或索引条目的损坏。如果RMAN发现逻辑损坏，则它会将该日志记录在警报日志和服务器会话跟踪文件中。</p>
                                 <p>如果文件中检测到的物理和逻辑损坏总数小于其<code class="codeph"><a href="SET.html#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">MAXCORRUPT</code>设置，则RMAN命令完成，数据库将填充具有损坏块范围的<code class="codeph">V$DATABASE_BLOCK_CORRUPTION</code>视图。如果超过<code class="codeph">MAXCORRUPT</code> ，则命令终止而不填充视图。
                                 </p>
                                 <p>还原备份数据文件时，RMAN <code class="codeph">DB_BLOCK_CHECKSUM</code>初始化参数设置。如果<code class="codeph">DB_BLOCK_CHECKSUM</code>设置为<code class="codeph">false</code> RMAN将清除校验和。如果设置为<code class="codeph">typical</code> ，则RMAN会在从备份还原并写入数据文件时验证校验和。如果初始化参数<code class="codeph">DB_BLOCK_CHECKSUM=typical</code> ，并且未设置<code class="codeph">MAXCORRUPT</code> ，则指定<code class="codeph">CHECK LOGICAL</code>会检测可能检测到的所有类型的损坏。
                                 </p>
                                 <p><span class="bold">注意：</span> <code class="codeph">MAXCORRUPT</code>设置表示文件允许的物理和逻辑损坏总数。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1466" headers="d82198e1247 ">
                                 <p><code class="codeph">DEVICE TYPE</code> <span class="italic"><code class="codeph"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC">deviceSpecifier</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1466 d82198e1250 ">
                                 <p>仅为指定的设备类型分配自动通道。例如，如果配置自动磁盘和磁带通道，并发出<code class="codeph">RESTORE ...DEVICE TYPE DISK</code> ，然后RMAN仅分配磁盘通道。在指定<code class="codeph">DEVICE TYPE</code>选项之前，必须使用<code class="codeph"><a href="CONFIGURE.html#GUID-B5094E73-C26C-4FED-AE39-8C2E9540050A">CONFIGURE</a></code> （预先配置的<code class="codeph">DISK</code>除外）配置<code class="codeph">DEVICE TYPE</code> 。
                                 </p>
                                 <p><span class="bold">注意：</span>您无法在<code class="codeph"><a href="RUN.html#GUID-88250EEF-DC49-42A9-822C-4011B1345C7B">RUN</a></code>块中手动分配通道，然后使用<code class="codeph">DEVICE TYPE</code>子句运行<code class="codeph">RESTORE</code> 。
                                 </p>
                                 <p> <span class="bold">另请参见：</span> <span class="italic"><code class="codeph"><a href="deviceSpecifier.html#GUID-F653748D-4AB5-4A0E-B6E5-D891A000ADAC__BABHDFAD">deviceSpecifier</a></code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1517" headers="d82198e1247 ">
                                 <p><code class="codeph">力</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1517 d82198e1250 ">
                                 <p>覆盖可重新启动的还原功能并还原所有文件，无论它们是否必须还原。如果未指定<code class="codeph">FORCE</code> ，则仅当RMAN的标头信息与控制文件中的信息不匹配时，RMAN才会还原该文件。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1528" headers="d82198e1247 "><code class="codeph">FROM COPY NUMBER <span class="codeinlineitalic">整数</span></code></td>
                              <td align="left" valign="top" width="71%" headers="d82198e1528 d82198e1250 ">指定一组双工备份片段中备份片的副本号。如果未执行双面打印，则副本编号为<code class="codeph">1</code> 。否则，拷贝数值的范围是<code class="codeph">2</code>到<code class="codeph">4</code> 。
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1545" headers="d82198e1247 ">
                                 <p><code class="codeph">来自BACKUPSET</code> 
                                 </p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1545 d82198e1250 ">
                                 <p>仅从备份集还原。默认情况下， <code class="codeph">RESTORE</code>选择需要最少介质恢复的文件副本或备份集。
                                 </p>
                                 <p>如果使用<code class="codeph">FROM BACKUPSET</code>选项，则必须为必须还原的备份集分配适当类型的存储设备的通道。例如，如果所需备份仅在磁带上可用，并且未分配任何<code class="codeph">sbt</code>通道，则RMAN无法找到要还原的候选备份集，并且<code class="codeph">RESTORE</code>命令将失败。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1568" headers="d82198e1247 ">
                                 <p><code class="codeph">来自DATAFILECOPY</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1568 d82198e1250 ">
                                 <p>仅恢复数据文件副本。默认情况下， <code class="codeph">RESTORE</code>选择需要最少介质恢复的文件副本或备份集。如果使用<code class="codeph">FROM DATAFILECOPY</code>选项，则分配的通道必须为<code class="codeph">DEVICE TYPE DISK</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1586" headers="d82198e1247 ">
                                 <p></p><code class="codeph">从SPARSE</code></td>
                              <td align="left" valign="top" width="71%" headers="d82198e1586 d82198e1250 ">从适当的稀疏备份集或所选备份的映像副本还原数据文件。恢复的数据文件很稀疏。如果此操作没有可用的稀疏备份，则还原将失败。
                                 <p>必须将数据库兼容性参数设置为12.2或更高才能执行<code class="codeph">RESTORE FROM SPARSE</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1598" headers="d82198e1247 "><code class="codeph">来自NONSPARSE</code></td>
                              <td align="left" valign="top" width="71%" headers="d82198e1598 d82198e1250 ">
                                 <p>从适当的非稀疏备份还原数据文件。此选定备份可以是备份集格式或映像副本格式。恢复的数据文件是非稀疏的。如果此操作没有可用的非稀疏备份，则还原将失败。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1605" headers="d82198e1247 ">
                                 <p> <code class="codeph">即时完整</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1605 d82198e1250 ">
                                 <p>本条款保留给将来的版本。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1614" headers="d82198e1247 ">
                                 <p><code class="codeph">即时消息</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1614 d82198e1250 ">
                                 <p>本条款保留给将来的版本。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1622" headers="d82198e1247 ">
                                 <p><code class="codeph">FROM PLATFORM</code> <span class="italic"><code class="codeph">platform</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1622 d82198e1250 ">
                                 <p>指定创建跨平台备份的平台的名称。从Oracle Database 12 <span class="italic">c</span>第1版（12.1）开始支持跨平台数据传输。此子句必须附带<span class="italic"><code class="codeph">foreignFileSpec</code></span> ，该指定指定包含要还原的数据的备份集。<code class="codeph">FROM PLATFORM</code>子句是可选的。您可以通过仅指定<span class="italic"><code class="codeph">foreignFileSpec</code></span>来还原跨平台备份。但是，如果使用<code class="codeph">FROM PLATFORM</code>指定平台名称，则该名称必须与存储在跨平台备份标头中的平台标识符匹配。
                                 </p>
                                 <p></p>
                                 <p>要通过网络连接到远程数据库来执行跨平台表空间传输，请使用带有<code class="codeph">FROM SERVICE</code>子句的<code class="codeph">FROM PLATFORM</code>子句。然后，RMAN在源数据库上创建所需的备份集，将它们传输到目标数据库，然后在目标上还原它们。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1660" headers="d82198e1247 ">
                                 <p><code class="codeph">来自PREPLUGIN</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1660 d82198e1250 ">
                                 <p>通过使用在源非CDB或PDB作为PDB插入目标CDB之前创建的预刷新备份来还原目标CDB中的数据文件和归档重做日志文件。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1668" headers="d82198e1247 ">
                                 <p><code class="codeph">FROM SERVICE</code> <span class="italic"><code class="codeph">service_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1668 d82198e1250 ">
                                 <p>使用通过网络从远程数据库传输的文件还原目标数据库上的数据文件，控制文件或spfile。 <span class="italic"><code class="codeph">service_name</code></span>指定远程数据库的服务名称。
                                 </p>
                                 <p></p>
                                 <p>要通过网络连接到远程数据库来执行跨平台表空间传输，请使用带有<code class="codeph">FROM SERVICE</code>子句的<code class="codeph">FROM PLATFORM</code>子句。RMAN连接到源数据库，创建所需的备份，将它们传输到目标，然后还原目标上的备份。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1693" headers="d82198e1247 ">
                                 <p><code class="codeph">FROM TAG</code> <span class="italic"><code class="codeph">tag_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1693 d82198e1250 ">
                                 <p>请参阅<span class="italic"><code class="codeph"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__I1036865">restoreSpecOperand</a></code></span>子句。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1710" headers="d82198e1247 ">
                                 <p><code class="codeph">FILE_NAME_CONVERT</code> <code class="codeph"><span class="codeinlineitalic">string_pattern</span></code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1710 d82198e1250 ">
                                 <p>指定在将PDB跨平台传输到目标CDB期间，源CDB上的Oracle数据库文件名如何映射到目标CDB上的相应文件。</p>
                                 <p>指定用于转换文件名的字符串对。您可以根据需要使用多对源和目标替换字符串。例如，您可以将字符串模式设置为以下值：</p>
                                 <p><code class="codeph">FILE_NAME_CONVERT =（'str1'，'str2'，'str3'，'str4'...）</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1727" headers="d82198e1247 ">
                                 <p id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFAJFI"><code class="codeph">预习</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1727 d82198e1250 ">
                                 <p>报告 - 但不还原 -  RMAN可用于将数据库还原并恢复到指定时间的备份和归档重做日志文件。RMAN查询元数据，但实际上并未读取备份文件。</p>
                                 <p><code class="codeph">RESTORE ...PREVIEW</code>输出的格式与<code class="codeph"><a href="LIST.html#GUID-2BAB704C-A3C9-4F76-8D96-4BD961FBEF2E">LIST</a></code> <code class="codeph">BACKUP</code>输出的格式相同（参见<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDEFIAA">例3-31</a> ）。
                                 </p>
                                 <p><a id="d82198e1750" class="indexterm-anchor"></a><a id="d82198e1752" class="indexterm-anchor"></a>某些媒体管理器向RMAN提供有关哪些备份不在现场的状态信息。异地备份存储在远程位置，例如安全存储设施，并且不能在不检索媒体的情况下使用。
                                 </p>
                                 <p>即使必须从存储中检索介质，然后才能恢复备份，异地备份在RMAN存储库中标记为<code class="codeph">AVAILABLE</code> 。如果RMAN尝试还原非现场备份，则还原操作将失败。<code class="codeph">恢复......PREVIEW</code>可以识别存储在需要检索的介质上的<code class="codeph">RESTORE</code>操作所需的备份。输出指示备份是否存储在异地。
                                 </p>
                                 <p>如果需要的备份存储在异地，但媒体管理器不支持异地备份，那么您的选项是：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>使用<code class="codeph"><a href="CHANGE.html#GUID-961151C6-EEFF-4347-AF1E-93EFDD5F5BF2">CHANGE</a></code> <code class="codeph">...UNAVAILABLE</code>阻止RMAN选择所需的异地备份，并尝试<code class="codeph">RESTORE ...再次执行PREVIEW</code>操作以确定RMAN是否选择另一个异地备份。当RMAN未选择任何异地备份时，您可以执行还原操作。
                                       </p>
                                    </li>
                                    <li>
                                       <p>使用<code class="codeph">RESTORE ...使用<code class="codeph">RECALL</code>选项进行PREVIEW</code> 。
                                       </p>
                                    </li>
                                 </ul>
                                 <p><span class="bold">另请参阅：</span> <code class="codeph"><a href="LIST.html#GUID-2BAB704C-A3C9-4F76-8D96-4BD961FBEF2E">LIST</a></code> ，特别是<code class="codeph">BACKUPS</code>和<code class="codeph">SUMMARY</code>选项，以及<code class="codeph"><a href="RECOVER.html#GUID-CA98040F-9865-4F4F-BAF2-91C518612E95">RECOVER</a></code> <code class="codeph">...VALIDATE HEADER</code>命令</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1818" headers="d82198e1247 ">
                                 <p><code class="codeph">召回</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1818 d82198e1250 ">
                                 <p>指示介质管理器从非现场存储中检索指定还原操作所需的备份介质（请参阅<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDDHJHH">示例3-32</a> ）。
                                 </p>
                                 <p></p>
                                 <p>还原存储在Oracle Cloud Infrastructure Classic中的存档存储中的备份时，请使用此选项在还原之前首先调用备份。</p>
                                 <p><span class="bold">注意：</span>此选项仅在媒体管理器支持此功能时有效。你可以使用<code class="codeph">RESTORE ...定期PREVIEW</code>以监视所需备份是否再次存储在本地。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1839" headers="d82198e1247 ">
                                 <p><code class="codeph">摘要</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1839 d82198e1250 ">
                                 <p>总结RMAN将还原的备份。输出格式与<code class="codeph">LIST BACKUPS ...的输出格式相同<code class="codeph">LIST BACKUPS ...SUMMARY</code>命令。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1850" headers="d82198e1247 ">
                                 <p><code class="codeph">部分尺寸</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1850 d82198e1250 ">
                                 <p>恢复多节备份。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1858" headers="d82198e1247 ">
                                 <p></p>
                                 <p><code class="codeph">跳过预备</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1858 d82198e1250 ">
                                 <p>排除预先存储的数据文件。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1867" headers="d82198e1247 ">
                                 <p><code class="codeph">跳过READONLY</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1867 d82198e1250 ">
                                 <p>不还原只读文件。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1875" headers="d82198e1247 "><code class="codeph">TO RESTORE POINT</code> <span class="italic"><code class="codeph">restore_point_name</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d82198e1875 d82198e1250 ">
                                 <p>指定还原点，其中创建还原点的SCN为包含上限的上限。由于限制是包含的，因此RMAN仅选择可用于还原文件的文件<span class="italic">，包括</span>与还原点对应的SCN。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1889" headers="d82198e1247 ">
                                 <p><span class="italic"><code class="codeph"><a href="untilClause.html#GUID-6A6C502A-6E21-4673-9FC9-C075D1E2F97A">untilClause</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1889 d82198e1250 ">
                                 <p>将选择限制为适合于时间点恢复到指定时间，SCN或日志序列号的备份集或文件副本。</p>
                                 <p>在没有任何其他条件的情况下，RMAN会选择要还原的最新文件副本或备份集。<code class="codeph">UNTIL</code>子句中指定的时间必须属于当前的数据库化身。
                                 </p>
                                 <p><span class="bold">另见：</span> <span class="italic"><code class="codeph"><a href="untilClause.html#GUID-6A6C502A-6E21-4673-9FC9-C075D1E2F97A">untilClause</a></code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1914" headers="d82198e1247 ">
                                 <p><code class="codeph">使用[COMPRESSED] BACKUPSET</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1914 d82198e1250 ">
                                 <p>指定必须通过网络还原的文件作为压缩备份集从远程数据库传输。默认情况下，RMAN将文件作为备份集传输。因此，即使省略<code class="codeph">USING BACKUPSET</code>子句，文件也会作为备份集传输。默认情况下，使用RMAN配置中设置的压缩算法执行压缩。在执行<code class="codeph">RESTORE</code>命令之前，可以通过执行<code class="codeph">SET COMPRESSION ALGORITHM</code>命令来使用不同的压缩算法。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1931" headers="d82198e1247 ">
                                 <p><code class="codeph">VALIDATE</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1931 d82198e1250 ">
                                 <p>RMAN标识必须还原哪些备份集，数据文件副本和归档重做日志文件，然后验证它们（请参阅<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDHIEJA">示例3-33</a> ）。没有文件被恢复。
                                 </p>
                                 <p>对于磁盘和磁带上的文件，RMAN读取备份片或映像副本中的所有块。RMAN还验证异地备份。除了RMAN不写输出文件之外，验证与实际还原操作相同。</p>
                                 <p><span class="bold">注意：</span>如果将<code class="codeph">RESTORE</code>与<code class="codeph">VALIDATE</code>选项一起使用，则可以使用联机数据文件打开数据库。
                                 </p>
                                 <p><span class="bold">另请参阅：</span> <code class="codeph"><a href="VALIDATE.html#GUID-ECE57997-40CE-4029-A434-320441D2AD1E">VALIDATE</a></code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e1961" headers="d82198e1247 ">
                                 <p><code class="codeph">HEADER</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e1961 d82198e1250 ">
                                 <p>报告和验证 - 但不还原 -  RMAN可用于还原到指定时间的备份。</p>
                                 <p>指定此选项时，RMAN执行与使用<code class="codeph"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFAJFI">PREVIEW</a></code>选项运行<code class="codeph">RESTORE</code>时相同的功能。但是，除了列出还原和恢复所需的文件之外，RMAN还会验证备份文件头，以确定磁盘上或介质管理目录中的文件是否与RMAN存储库中的元数据相对应。
                                 </p>
                                 <p><span class="bold">另请参阅：</span> <code class="codeph">RESTORE</code> <code class="codeph"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFAJFI">PREVIEW</a></code>选项和<code class="codeph"><a href="RECOVER.html#GUID-CA98040F-9865-4F4F-BAF2-91C518612E95">RECOVER</a></code> <code class="codeph">...VALIDATE HEADER</code>选项</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__BGBJJGCB"><span class="bold"><span class="italic">restoreObject</span></span></p>
                  <p>本小节指定要还原的对象：控制文件，数据文件，归档重做日志文件或服务器参数文件。RMAN不支持备份和恢复更改跟踪文件。数据库恢复和恢复后，RMAN重新创建更改跟踪文件;任何恢复后的下一个增量备份都可以使用该文件。因此，还原和恢复对更改跟踪没有用户可见的影响。</p>
                  <div class="tblformalwide" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-4DD39ED2-61C4-486B-89CD-377539B3CCA6">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Describes RESTORE command restoreObject parameters" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d82198e2010">语法元素</th>
                              <th align="left" valign="bottom" width="71%" id="d82198e2013">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2018" headers="d82198e2010 ">
                                 <p><span class="italic"><code class="codeph"><a href="archivelogRecordSpecifier.html#GUID-DDF929FF-796B-4AD6-AE58-F831CAFC7703">archivelogRecordSpecifier</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2018 d82198e2013 ">
                                 <p><a id="d82198e2027" class="indexterm-anchor"></a>恢复指定范围的归档重做日志文件。
                                 </p>
                                 <p>默认还原位置为<code class="codeph">DB_RECOVERY_FILE_DEST</code> （如果其中一个<code class="codeph">LOG_ARCHIVE_DEST_n</code>被隐式或显式配置为<code class="codeph">USE_DB_RECOVERY_FILE_DEST</code> ）。否则，使用目标数据库的<code class="codeph">LOG_ARCHIVE_FORMAT</code>和<code class="codeph">LOG_ARCHIVE_DEST_1</code>初始化参数构造默认恢复文件名。这些参数以特定于端口的方式组合，以导出已还原日志的名称。您可以使用<code class="codeph"><a href="SET.html#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">ARCHIVELOG DESTINATION</code>命令覆盖默认位置。
                                 </p>
                                 <p>由于<code class="codeph"><a href="RECOVER.html#GUID-CA98040F-9865-4F4F-BAF2-91C518612E95">RECOVER</a></code>命令会根据需要自动还原存档的重做日志文件，因此您很少需要手动还原日志。手动还原存档重做日志文件的可能原因是加速恢复，将日志分级到多个目标，或者在时间点恢复后分析日志内容。要在不关闭数据库的情况下还原以前版本的日志，可以使用<code class="codeph">RESTORE ARCHIVELOG</code> ：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>...<code class="codeph">来自SCN</code></p>
                                    </li>
                                    <li>
                                       <p>.. <code class="codeph">.SCN BETWEEN ......和</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">来自SCN ......INCARNATION &lt;整数&gt;</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">来自SCN ......否定所有</code> 
                                       </p>
                                    </li>
                                 </ul>
                                 <p><span class="bold">注意：</span>可以为此操作启动，装入或打开数据库。
                                 </p>
                                 <p><span class="bold">另请参见：</span> <span class="italic"><code class="codeph"><a href="archivelogRecordSpecifier.html#GUID-DDF929FF-796B-4AD6-AE58-F831CAFC7703">archivelogRecordSpecifier</a></code></span> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2103" headers="d82198e2010 ">
                                 <p><code class="codeph">CONTROLFILE</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2103 d82198e2013 ">
                                 <p>根据目标数据库角色还原备用或备份控制文件。</p>
                                 <p>如果控制文件丢失，则还原控制文件（请参阅<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEFBD" title="描述在各种情况下恢复控制文件">表3-9</a> ）并在安装还原的控制文件后还原数据库。在安装已还原的控制文件后，必须始终运行<code class="codeph"><a href="RECOVER.html#GUID-CA98040F-9865-4F4F-BAF2-91C518612E95">RECOVER</a></code>命令，并且必须使用<code class="codeph">RESETLOGS</code>选项打开数据库。
                                 </p>
                                 <p><span class="bold">注意：</span>如果未装入目标数据库，并且RMAN未连接到恢复目录，则必须使用<code class="codeph">RESTORE CONTROLFILE</code>指定<code class="codeph">FROM AUTOBACKUP</code>子句。如果自动备份是非默认格式，则首先使用<code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code>命令指定格式。如果已挂载或打开目标数据库，则必须使用<code class="codeph">RESTORE CONTROLFILE</code>指定<code class="codeph">TO</code> <span class="italic"><code class="codeph">filename</code></span>子句。</p>
                                 <p>在连接到恢复目录时使用备份控制文件运行<code class="codeph">RESTORE</code> （请参阅<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDGHAJH">示例3-26</a> ），RMAN会根据目录中的元数据自动更新控制文件以反映已还原数据库的结构。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2157" headers="d82198e2010 ">
                                 <p><code class="codeph">TO</code> <code class="codeph">'</code> <span class="italic"><code class="codeph">filename</code></span> <code class="codeph">'</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2157 d82198e2013 ">
                                 <p>将控制文件还原为指定的文件名。</p>
                                 <p><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEFBD" title="描述在各种情况下恢复控制文件">表3-9</a>说明了使用<code class="codeph">TO</code>子句还原控制文件时的RMAN行为。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2182" headers="d82198e2010 "><code class="codeph">应用根数据库</code></td>
                              <td align="left" valign="top" width="71%" headers="d82198e2182 d82198e2013 ">
                                 <p></p>
                                 <p>指定应用程序根目录中的所有数据文件。</p>
                                 <p>使用<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限以普通用户身份连接到CDB根目录。或者，以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的应用程序通用用户身份连接到应用程序根目录。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2204" headers="d82198e2010 ">
                                 <p><code class="codeph">数据库</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2204 d82198e2013 ">
                                 <p>恢复数据库中除脱机之外的所有数据文件。默认情况下，RMAN将数据文件还原到只读表空间中。</p>
                                 <p>在CDB中，恢复整个CDB。您连接到根以还原CDB。在PDB中，还原指定PDB中的数据文件。要备份PDB，请连接到该PDB。请参阅<span class="q">“ <a href="CONNECT.html#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67__BGBGAIGG">连接到CDB和PDB</a> ”</span> 。
                                 </p>
                                 <p></p>
                                 <p>在应用程序容器中，还原整个应用程序容器。这包括应用程序根目录和属于此应用程序根目录的所有应用程序PDB。您以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的应用程序通用用户身份连接到应用程序根目录。
                                 </p>
                                 <p>与<code class="codeph"><a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50">BACKUP</a></code> <code class="codeph">DATABASE</code> ， <code class="codeph">RESTORE DATABASE</code> <span class="italic">并不</span>自动包括控制文件和服务器参数文件，则必须增发<code class="codeph">RESTORE CONTROLFILE</code>和<code class="codeph">RESTORE SPFILE</code>命令来恢复这些文件。
                                 </p>
                                 <p><span class="bold">注意：</span>要还原脱机数据文件，必须使用<code class="codeph">RESTORE DATAFILE</code>或<code class="codeph">RESTORE TABLESPACE</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2260" headers="d82198e2010 ">
                                 <p><code class="codeph">数据库根</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2260 d82198e2013 ">
                                 <p>在CDB中，还原属于根的所有在线数据文件。按照<span class="q">“ <a href="CONNECT.html#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67__BGBGAIGG">连接到CDB和PDB</a> ”中的说明</span>连接到根目录。
                                 </p>
                                 <p></p>
                                 <p>在应用程序容器中，还原属于应用程序根目录和所有应用程序PDB的联机数据文件。以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限的应用程序通用用户身份连接到应用程序根目录。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2281" headers="d82198e2010 ">
                                 <p><code class="codeph">PLUGGABLE DATABASE</code> <span class="italic"><code class="codeph">pdb_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2281 d82198e2013 ">
                                 <p>在CDB中，还原属于指定PDB的所有数据文件。没有其他PDB受到影响;他们可以保持开放和运作。使用逗号分隔列表还原多个PDB。按照<span class="q">“ <a href="CONNECT.html#GUID-64ECF1B8-4F70-413E-BEBE-1D5E8CD48B67__BGBGAIGG">连接到CDB和PDB</a> ”中的说明</span>连接到根目录。
                                 </p>
                                 <p></p>
                                 <p>在应用程序容器，连接到CDB根作为与普通用户<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACKUP</code>权限和指定应用程序根目录的名称<code class="codeph">pdb_name</code>恢复属于该应用程序根目录和所有的应用程序PDBS的数据文件。
                                 </p>
                                 <p>要还原属于指定应用程序PDB的所有数据文件，请以具有<code class="codeph">SYSDBA</code>或<code class="codeph">SYSBACK</code>权限的应用程序通用用户身份连接到应用程序根目录。要还原多个应用程序PDB的文件，请指定应用程序PDB名称的公共分隔列表。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2317" headers="d82198e2010 "><code class="codeph">SKIP [FOREVER]</code> <code class="codeph">TABLESPACE</code> <span class="italic"><code class="codeph">tablespace_name</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d82198e2317 d82198e2013 ">
                                 <p>从还原操作中排除指定的表空间。此选项对于避免还原包含临时数据的表空间很有用。在CDB中，当连接到根时指向根中的表空间，并且当直接连接到PDB时引用PDB中的表空间。</p>
                                 <p>指定<code class="codeph">FOREVER</code>关键字不会更改<code class="codeph">SKIP</code>的行为。 <code class="codeph">FOREVER</code>关键字仅用于维护<code class="codeph">RESTORE SKIP FOREVER</code>和<code class="codeph">RECOVER SKIP FOREVER</code>之间的兼容语法。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2348" headers="d82198e2010 ">
                                 <p><code class="codeph">TABLESPACE</code> <span class="italic"><code class="codeph">pdb_name</code></span> <code class="codeph">:</code> <span class="italic"><code class="codeph">tablespace_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2348 d82198e2013 ">
                                 <p>在CDB中，从还原操作中排除指定的表空间。仅当连接到根时才需要此语法。直接连接到PDB时，请使用<code class="codeph">TABLESPACE</code> <span class="italic"><code class="codeph">tablespace_name</code></span> 。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2371" headers="d82198e2010 ">
                                 <p><code class="codeph">DATAFILE</code> <span class="italic"><code class="codeph"><a href="datafileSpec.html#GUID-A0A69931-D404-4D89-8F95-3AB898B6A220">datafileSpec</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2371 d82198e2013 ">
                                 <p>恢复由文件名或绝对数据文件号指定的数据文件（参见<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEAAH">例3-25</a> ）。
                                 </p>
                                 <p><span class="bold">注意：</span>请勿在还原作业中多次指定数据文件。例如，以下命令无效，因为数据文件1既被显式指定又被<code class="codeph">SYSTEM</code>表空间隐含：</p><pre class="oac_no_warn" dir="ltr">RESTORE TABLESPACE SYSTEM DATAFILE 1;</pre><p><span class="bold">另请参见：</span> <span class="italic"><code class="codeph"><a href="datafileSpec.html#GUID-A0A69931-D404-4D89-8F95-3AB898B6A220">datafileSpec</a></code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2405" headers="d82198e2010 ">
                                 <p><code class="codeph">   </code><span class="italic"><code class="codeph"><a href="foreignFileSpec.html#GUID-38CC0715-B32B-4394-92FB-3E0CB7C3ABE3">foreignFileSpec</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2405 d82198e2013 ">
                                 <p>还原使用备份集的跨平台备份。执行跨平台还原操作时，必须指定<span class="italic"><code class="codeph"><a href="foreignFileSpec.html#GUID-38CC0715-B32B-4394-92FB-3E0CB7C3ABE3">foreignFileSpec</a></code></span> 。此子句指定必须还原的数据（数据文件，表空间或整个数据库）以及包含要还原的数据的备份集。正在还原的跨平台备份可以包含多个备份集或多个备份片。
                                 </p>
                                 <p>使用<code class="codeph">BACKUPSET</code>语法指定要还原的备份集。要恢复数据文件，请使用<code class="codeph">ALL FOREIGN DATAFILES</code>或<code class="codeph">FOREIGN DATAFILE</code> 。要还原表空间。使用<code class="codeph">FOREIGN TABLESPACE</code> 。要还原整个数据库，请使用<code class="codeph">FOREIGN DATABASE</code> 。</p>
                                 <p>要将已还原的表空间插入目标数据库，请使用包含与备份一起创建的表空间元数据的导出转储文件。使用<code class="codeph">DUMP FILE</code> ，以表明备份包含导出转储文件和<code class="codeph">BACKUPSET</code>指定包含导出转储文件的备份集。
                                 </p>
                                 <p><span class="bold">注意：</span>此子句仅可用于还原使用备份集备份的数据。它不能用于作为映像副本创建的备份。
                                 </p>
                                 <p><span class="bold">另请参见：</span> <span class="italic"><code class="codeph"><a href="foreignFileSpec.html#GUID-38CC0715-B32B-4394-92FB-3E0CB7C3ABE3">foreignFileSpec</a></code></span></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2463" headers="d82198e2010 ">
                                 <p><code class="codeph">FOREIGN PLUGGABLE DATABASE</code> <span class="italic"><code class="codeph">pdb_name</code></span> FROM SERVICE</p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2463 d82198e2013 ">
                                 <p></p>
                                 <p></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2476" headers="d82198e2010 ">
                                 <p><code class="codeph">主要控制文件</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2476 d82198e2013 ">
                                 <p>在Data Guard环境中还原主数据库的控制文件。</p>
                                 <p>RMAN根据适当情况恢复正常或备用控制文件，具体取决于目标数据库的恢复目录（ <code class="codeph"><a href="RC_SITE.html#GUID-5A53B4D3-7E4C-40AF-B5DB-560FCAFB8293" title="此视图列出了有关恢复目录中已知的Data Guard环境中所有数据库的信息。">RC_SITE</a></code> <code class="codeph">.DATABASE_ROLE</code> ）已知的最新数据库角色。此选项的目的是在最新数据库角色已过期的情况下覆盖默认设置。
                                 </p>
                                 <p><a id="d82198e2496" class="indexterm-anchor"></a>假设您执行从主数据库<code class="codeph">dgny</code>到备用数据库<code class="codeph">dgsf</code> ，以便<code class="codeph">dgsf</code>是新的主数据库。您希望在<code class="codeph">dgsf</code>上还原控制文件，但恢复目录未重新同步，仍将<code class="codeph">dgsf</code>显示为备用数据库。在这种情况下，您可以指定<code class="codeph">PRIMARY CONTROLFILE</code>以覆盖默认的RMAN行为并恢复正常的控制文件。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2521" headers="d82198e2010 ">
                                 <p><code class="codeph">SPFILE</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2521 d82198e2013 ">
                                 <p>将主服务器或备用服务器参数文件还原到备份它的位置。RMAN无法覆盖目标数据库当前使用的服务器参数文件。</p>
                                 <p>默认情况下，RMAN会还原最新的服务器参数文件。指定<code class="codeph">UNTIL</code>或<code class="codeph">TAG</code>选项以还原旧版本的服务器参数文件。
                                 </p>
                                 <p>如果服务器参数文件丢失，则将RMAN连接到目标数据库（如果使用的话还有恢复目录）并运行<code class="codeph"><a href="SET.html#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">DBID</code> 。在运行<code class="codeph">RESTORE SPFILE</code>之前运行<code class="codeph"><a href="STARTUP.html#GUID-96DFEF80-A2D1-493C-8CFF-BF0CB4BE281D">STARTUP</a></code> <code class="codeph">FORCE NOMOUNT</code> 。然后运行<code class="codeph">STARTUP FORCE</code>以使用还原的服务器参数文件重新启动数据库实例。
                                 </p>
                                 <p><span class="bold">注意：</span>如果未装入目标数据库，并且RMAN未连接到恢复目录，则必须使用<code class="codeph">RESTORE SPFILE</code>指定<code class="codeph">FROM AUTOBACKUP</code>子句。如果自动备份是非默认格式，则首先使用<code class="codeph">SET CONTROLFILE AUTOBACKUP FORMAT</code>命令指定格式。如果目标数据库已启动，装入或打开，并且数据库是使用服务器参数文件启动的，则必须使用<code class="codeph">RESTORE SPFILE</code>指定<code class="codeph">TO</code> <span class="italic"><code class="codeph">filename</code></span>子句。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2586" headers="d82198e2010 ">
                                 <p><code class="codeph">TO [PFILE]</code> <code class="codeph">'</code> <span class="italic"><code class="codeph">filename</code></span> <code class="codeph">'</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2586 d82198e2013 ">
                                 <p><a id="d82198e2600" class="indexterm-anchor"></a><a id="d82198e2602" class="indexterm-anchor"></a>将主服务器或备用服务器参数文件还原到<code class="codeph">TO</code>子句指定的位置。指定<code class="codeph">PFILE</code>以将服务器参数文件另存为基于文本的初始化参数文件。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2612" headers="d82198e2010 "><code class="codeph">FOR DB_UNIQUE_NAME</code> <span class="italic"><code class="codeph">db_unique_name</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d82198e2612 d82198e2013 ">
                                 <p>未启动实例时指定目标数据库的<code class="codeph">DB_UNIQUE_NAME</code> 。此参数仅在Data Guard环境中有用。
                                 </p>
                                 <p><a id="d82198e2626" class="indexterm-anchor"></a>指定<code class="codeph">FOR DB_UNIQUE_NAME</code> ，RMAN可以为正在还原<code class="codeph">SPFILE</code>的主机找到正确的RMAN配置，并使用它们来访问备份设备。否则，RMAN无法选择正确的通道配置并返回<a id="d82198e2637" class="indexterm-anchor"></a><a id="d82198e2639" class="indexterm-anchor"></a> <code class="codeph">RMAN-6758</code>错误。
                                 </p>
                                 <p>在Data Guard环境中，主要主机和备用主机可能具有不同的通道配置，以便与其关联的SBT备份和磁盘设备进行通信。如果恢复目录中已知主数据库和备用数据库，则两个数据库的配置设置都将记录在恢复目录中。由于这两个数据库具有相同的<code class="codeph">DB_NAME</code> ，因此只能使用<code class="codeph">DB_UNIQUE_NAME</code>初始化参数区分恢复目录中的记录。
                                 </p>
                                 <p><span class="bold">注意：</span>当<code class="codeph">DB_NAME</code>在恢复目录中不唯一时，使用<code class="codeph">RESTORE SPFILE</code>会产生<code class="codeph">RMAN-6758</code>错误。
                                 </p>
                                 <p><span class="bold">另请参阅：</span> <a href="../sbydb/using-RMAN-in-oracle-data-guard-configurations.html#SBYDB04700" target="_blank"><span class="italic">Oracle Data Guard概念和管理</span></a> ，以获取在Data Guard环境中还原服务器参数文件的详细过程</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2677" headers="d82198e2010 ">
                                 <p><code class="codeph">TO</code> <code class="codeph">'</code> <span class="italic"><code class="codeph">filename</code></span> <code class="codeph">'</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2677 d82198e2013 ">
                                 <p>将备用控制文件还原为指定的文件名。<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEFBD" title="描述在各种情况下恢复控制文件">表3-9</a>说明了使用<code class="codeph">TO</code>子句还原控制文件时的RMAN行为。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2701" headers="d82198e2010 ">
                                 <p><code class="codeph">备用控制文件</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2701 d82198e2013 ">
                                 <p>恢复备用数据库的控制文件。RMAN可以透明地还原正常的控制文件备份，并使其可用于备用数据库。</p>
                                 <p>RMAN根据适当情况恢复正常或备用控制文件，具体取决于目标数据库的恢复目录（ <code class="codeph"><a href="RC_SITE.html#GUID-5A53B4D3-7E4C-40AF-B5DB-560FCAFB8293" title="此视图列出了有关恢复目录中已知的Data Guard环境中所有数据库的信息。">RC_SITE</a></code> <code class="codeph">.DATABASE_ROLE</code> ）已知的最新数据库角色。此选项的目的是在最新数据库角色已过期的情况下覆盖默认设置。假设您执行从主数据库<code class="codeph">dgny</code>到备用数据库<code class="codeph">dgsf</code> ，以便<code class="codeph">dgsf</code>是新的主数据库。后来，你让<code class="codeph">dgny</code>一个备用数据库<code class="codeph">dgsf</code> 。您希望在<code class="codeph">dgny</code>上还原控制文件，但恢复目录未重新同步，仍将<code class="codeph">dgny</code>显示为主数据库。在这种情况下，您可以指定<code class="codeph">STANDBY CONTROLFILE</code>以覆盖默认的RMAN行为并还原备用控制文件。
                                 </p>
                                 <p>如果还原其恢复目录已知<code class="codeph">DB_UNIQUE_NAME</code>的数据库的控制文件，则RMAN会将控制文件中的所有文件名更新为恢复目录中已知的文件名。使用<code class="codeph">ALTER DATABASE RENAME FILE</code>显式重命名的任何文件名优先于恢复目录中的文件名。
                                 </p>
                                 <p><span class="bold">另请参阅：</span> <a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEFBD" title="描述在各种情况下恢复控制文件">表3-9</a>了解限制和使用说明</p>
                                 <p><span class="bold">注意：</span>必须始终在安装已还原的控制文件后运行<code class="codeph"><a href="RECOVER.html#GUID-CA98040F-9865-4F4F-BAF2-91C518612E95">RECOVER</a></code>命令，并且还必须始终使用<code class="codeph">RESETLOGS</code>选项打开数据库。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2775" headers="d82198e2010 ">
                                 <p><code class="codeph">TABLESPACE</code> <span class="italic"><code class="codeph">tablespace_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2775 d82198e2013 ">
                                 <p>恢复指定表空间中的所有数据文件（请参见<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDGADCD">示例3-24</a> ）。
                                 </p>
                                 <p>RMAN将表空间名称内部转换为数据文件列表。如果重命名表空间（例如，从<code class="codeph">users</code>重命名为<code class="codeph">customers</code> ），则只要尚未创建具有旧名称（ <code class="codeph">users</code> ）的其他表空间，就可以使用旧名称（ <code class="codeph">users</code> ）或新名称（ <code class="codeph">customers</code> ）用于表空间。RMAN检测到表空间已更改其名称，并在下次重新同步时更新恢复目录。
                                 </p>
                                 <p><span class="bold">注意：</span> RMAN可以备份和还原由字典管理的临时表空间，但它无法备份本地管理的临时表空间。但是，RMAN会在还原数据库后自动重新创建本地管理的临时表空间。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__I1036865"><span class="bold"><span class="italic">restoreSpecOperand</span></span></p>
                  <p><span class="italic"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__BGBJJGCB">本子</a></span>条款指定<span class="italic"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__BGBJJGCB">restoreObject</a></span>子句的选项。这些参数在<code class="codeph">RESTORE</code>命令级别覆盖具有相同名称的参数。
                  </p>
                  <div class="tblformalwide" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-7A286BD4-5147-4DE8-841F-7567B8D0B30F">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Describes RESTORE command restoreSpecOperand parameters" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d82198e2830">语法元素</th>
                              <th align="left" valign="bottom" width="71%" id="d82198e2833">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2838" headers="d82198e2830 ">
                                 <p><code class="codeph">CHANNEL</code> <span class="italic"><code class="codeph">channel_id</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2838 d82198e2833 ">
                                 <p>指定用于此还原操作的通道的区分大小写的名称。如果未指定通道，则<code class="codeph">RESTORE</code>将使用使用正确设备类型分配的任何可用通道。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2853" headers="d82198e2830 ">
                                 <p><a id="d82198e2855" class="indexterm-anchor"></a><a id="d82198e2857" class="indexterm-anchor"></a><a id="d82198e2859" class="indexterm-anchor"></a><code class="codeph">FROM AUTOBACKUP</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2853 d82198e2833 ">
                                 <p>恢复控制文件自动备份（参见<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDBAFDB">例3-27</a> ）。
                                 </p>
                                 <p>此选项仅对<code class="codeph">RESTORE CONTROLFILE</code>和<code class="codeph">RESTORE SPFILE</code>命令有效。在<code class="codeph">NOCATALOG</code>模式下还原任一类型的文件时，需要<code class="codeph">FROM AUTOBACKUP</code>子句。
                                 </p>
                                 <p>RMAN在当前日或在<code class="codeph"><a href="SET.html#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3">SET</a></code> <code class="codeph">UNTIL</code>指定的日期开始搜索。在搜索的第一天，搜索从序列号256（或<code class="codeph">MAXSEQ</code>指定的序列号，如果提供）开始，并计数回到序列0。如果在当前或<code class="codeph">SET UNTIL</code>日没有找到自动备份，则RMAN将检查前几天，从序列256开始并重新计数到0。在当前或<code class="codeph">SET UNTIL</code>日之前，搜索将持续到<code class="codeph">MAXDAYS</code>天（默认值为7，最多为366）。如果在<code class="codeph">MAXDAYS</code>天内未找到自动备份，则RMAN发出错误信号并停止命令。
                                 </p>
                                 <p><span class="bold">另请参阅：</span> <a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEFBD" title="描述在各种情况下恢复控制文件">表3-9</a>了解限制和使用说明。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2920" headers="d82198e2830 ">
                                 <p><code class="codeph">   </code><span class="italic"><code class="codeph"><a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__BGBHBIAC">autoBackupOptList</a></code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2920 d82198e2833 ">
                                 <p>指定控制搜索控制文件自动备份的参数。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2932" headers="d82198e2830 ">
                                 <p><code class="codeph">   </code> <code class="codeph">'</code> <span class="italic"><code class="codeph">media_handle</code></span> <code class="codeph">'</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2932 d82198e2833 ">
                                 <p>指定包含控制文件的控制文件副本或备份片的名称。<span class="italic"><code class="codeph">media_handle</code></span>可以是包含控制文件备份的任何备份片段：控制文件备份不需要是自动备份。
                                 </p>
                                 <p><span class="bold">另请参阅：</span> <a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEFBD" title="描述在各种情况下恢复控制文件">表3-9</a>了解限制和使用说明。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2960" headers="d82198e2830 ">
                                 <p><code class="codeph">FROM SERVICE</code> <span class="italic"><code class="codeph">service_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2960 d82198e2833 ">
                                 <p>使用通过网络从远程数据库传输的备份来还原数据文件或控制文件。 <span class="italic"><code class="codeph">service_name</code></span>指定远程数据库的服务名称。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e2976" headers="d82198e2830 ">
                                 <p><code class="codeph">FROM TAG</code> <span class="italic"><code class="codeph">tag_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e2976 d82198e2833 ">
                                 <p>覆盖最新备份或可用文件副本的默认选择。标签将自动选择限制为使用指定标签创建的备份集或文件副本。如果多个备份集或副本具有匹配的标记，则RMAN将选择最新的备份集。标记名称不区分大小写。</p>
                                 <p><span class="bold">另请参阅：</span> <code class="codeph"><a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50">BACKUP</a></code>以获取有关如何将标记应用于双工备份集的单个副本的说明，以及有关标记的默认文件名格式的说明。
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__BGBHBIAC"><span class="bold"><span class="italic">autoBackupOptList</span></span></p>
                  <p>本小节指定控制搜索控制文件自动备份的参数。</p>
                  <div class="tblformalwide" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-F53EFB76-A84F-4C8B-9261-F596381C8164">
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="" width="100%" border="1" summary="Describes RESTORE command autoBackupOptList parameters" frame="hsides" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="29%" id="d82198e3011">语法元素</th>
                              <th align="left" valign="bottom" width="71%" id="d82198e3014">描述</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e3019" headers="d82198e3011 ">
                                 <p><code class="codeph">DB_NAME</code> <span class="italic"><code class="codeph">database_name</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e3019 d82198e3014 ">
                                 <p>提供用于搜索控制文件自动备份的<code class="codeph">DB_NAME</code> 。请参阅<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDBGBBD" title="描述使用各种选项从自动备份恢复">表3-10</a>以确定何时设置此参数。
                                 </p>
                                 <p>默认值<a id="d82198e3040" class="indexterm-anchor"></a><a id="d82198e3042" class="indexterm-anchor"></a> <code class="codeph">DB_UNIQUE_NAME</code>初始化参数是<code class="codeph">DB_NAME</code>初始化参数设置。如果没有为目标数据库设置<code class="codeph">DB_UNIQUE_NAME</code>初始化参数，则使用<code class="codeph">RESTORE ...DB_NAME</code>或<code class="codeph">RESTORE ...DB_UNIQUE_NAME</code> 。如果目标数据库的<code class="codeph">DB_UNIQUE_NAME</code>初始化参数设置与<code class="codeph">DB_NAME</code>不同，则使用<code class="codeph">RESTORE ...DB_UNIQUE_NAME</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e3072" headers="d82198e3011 ">
                                 <p><code class="codeph">MAXDAYS</code> <span class="italic"><code class="codeph">integer</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e3072 d82198e3014 ">
                                 <p>将搜索控制文件自动备份限制在指定的天数之内。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e3084" headers="d82198e3011 ">
                                 <p><code class="codeph">MAXSEQ</code> <span class="italic"><code class="codeph">integer</code></span></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e3084 d82198e3014 ">
                                 <p>指定控制文件自动备份搜索的最高序列号。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e3096" headers="d82198e3011 ">
                                 <p><code class="codeph">RECOVERY AREA</code> <code class="codeph">'</code> <span class="italic"><code class="codeph">pathname</code></span> <code class="codeph">'</code></p>
                              </td>
                              <td align="left" valign="top" width="71%" headers="d82198e3096 d82198e3014 ">
                                 <p>指定快速恢复区域的路径以搜索自动备份。<code class="codeph">RECOVERY AREA</code>和<code class="codeph">DB_RECOVERY_FILE_DEST</code>是同义词。请参阅<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDBGBBD" title="描述使用各种选项从自动备份恢复">表3-10</a>以确定何时设置此参数。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e3123" headers="d82198e3011 "><code class="codeph">DB_RECOVERY_FILE_DEST</code> <code class="codeph">'</code> <span class="italic"><code class="codeph">pathname</code></span> <code class="codeph">'</code></td>
                              <td align="left" valign="top" width="71%" headers="d82198e3123 d82198e3014 ">
                                 <p><code class="codeph">RECOVERY AREA</code>和<code class="codeph">DB_RECOVERY_FILE_DEST</code>是同义词。
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e3143" headers="d82198e3011 "><code class="codeph">DB_NAME</code> <span class="italic"><code class="codeph">database_name</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d82198e3143 d82198e3014 ">
                                 <p>提供用于搜索控制文件自动备份的<code class="codeph">DB_NAME</code> 。请参阅<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDBGBBD" title="描述使用各种选项从自动备份恢复">表3-10</a>以确定何时设置此参数。
                                 </p>
                                 <p><code class="codeph">DB_UNIQUE_NAME</code>初始化参数的默认值是<code class="codeph">DB_NAME</code>初始化参数设置。如果没有为目标数据库设置<code class="codeph">DB_UNIQUE_NAME</code>初始化参数，则使用<code class="codeph">RESTORE ...DB_NAME</code>或<code class="codeph">RESTORE ...DB_UNIQUE_NAME</code> 。如果目标数据库的<code class="codeph">DB_UNIQUE_NAME</code>初始化参数设置与<code class="codeph">DB_NAME</code>不同，则使用<code class="codeph">RESTORE ...DB_UNIQUE_NAME</code> 。</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="29%" id="d82198e3189" headers="d82198e3011 "><code class="codeph">   DB_UNIQUE_NAME</code> <code class="codeph">   </code><span class="italic"><code class="codeph">db_unique_name</code></span></td>
                              <td align="left" valign="top" width="71%" headers="d82198e3189 d82198e3014 ">
                                 <p>指定作为还原操作目标的指定快速恢复区域中数据库的<code class="codeph">DB_UNIQUE_NAME</code> 。
                                 </p>
                                 <p><code class="codeph">DB_UNIQUE_NAME</code>初始化参数的默认值是<code class="codeph">DB_NAME</code>初始化参数设置。如果没有为目标数据库设置<code class="codeph">DB_UNIQUE_NAME</code>初始化参数，则使用<code class="codeph">RESTORE ...DB_NAME</code>或<code class="codeph">RESTORE ...DB_UNIQUE_NAME</code> 。如果目标数据库的<code class="codeph">DB_UNIQUE_NAME</code>初始化参数设置与<code class="codeph">DB_NAME</code>不同，则使用<code class="codeph">RESTORE ...DB_UNIQUE_NAME</code> 。</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-ACC21950-8201-4FA4-9121-234121C8C39F">例子</p>
               </div>
               <!-- class="section" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDGADCD">
                  <p class="titleinexample">示例3-24恢复表空间</p>
                  <p>此示例使表空间脱机，恢复它，然后执行介质恢复。</p><pre class="oac_no_warn" dir="ltr">ALTER TABLESPACE用户立即离线; RESTORE TABLESPACE用户; RECOVER TABLESPACE用户; ALTER TABLESPACE用户在线;</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDFEAAH">
                  <p class="titleinexample">示例3-25为还原的数据文件设置新名称</p>
                  <p>假设包含数据文件<code class="codeph">9</code> <code class="codeph">/disk1</code>遭受介质故障。此示例为数据文件指定新名称，还原它，更新控制文件以使用新名称，将其恢复，然后将其联机：</p><pre class="oac_no_warn" dir="ltr">运行{ALTER DATABASE DATAFILE 9 OFFLINE;将DATAFILE 9的NEWNAME设置为'/disk2/users01.dbf'; RESTORE DATAFILE 9; SWITCH DATAFILE ALL; RECOVER DATAFILE 9; ALTER DATABASE DATAFILE 9 ONLINE; }</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDGHAJH">
                  <p class="titleinexample">示例3-26使用恢复目录时恢复控制文件</p>
                  <p>假设您要使用标记<code class="codeph">monday_cf_backup</code>恢复控制文件备份。启动RMAN客户端，连接到目标和恢复目录数据库，然后运行以下命令：</p><pre class="oac_no_warn" dir="ltr">当RMAN连接到恢复目录STARTUP FORCE NOMOUNT时，不需要运行{#SET DBID;从TAG'mondday_cf_backup'恢复CONTROLFILE; ALTER DATABASE MOUNT; RESTORE DATABASE;恢复数据库; ALTER DATABASE OPEN RESETLOGS;使用备份控制文件恢复后需要＃</pre><p>RMAN将控制文件还原到其默认位置，并自动将其复制到所有<code class="codeph">CONTROL_FILES</code>位置。RMAN安装控制文件并恢复和恢复数据库。RMAN根据恢复目录中的元数据自动更新控制文件以反映已还原数据库的结构。
                  </p>
               </div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDBAFDB">
                  <p class="titleinexample">示例3-27使用控制文件自动备份恢复数据库</p>
                  <p>假设控制文件和某些数据文件丢失，必须从磁带恢复。由于RMAN在此方案中不使用恢复目录，因此需要<a href="SET.html#GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3__CHDFHGDI">SET</a> <code class="codeph">DBID</code>命令来标识要还原的控制文件。该示例从磁带还原控制文件，装入数据库，然后还原和恢复数据库。
                  </p><pre class="oac_no_warn" dir="ltr">连接目标/启动力量NOMOUNT; SET DBID 36508508; ＃在NOCATALOG模式下恢复控制文件时需要RUN {ALLOCATE CHANNEL c1 DEVICE TYPE sbt;从AUTOBACKUP恢复CONTROLFILE; ALTER DATABASE MOUNT; RESTORE DATABASE;恢复数据库; ALTER DATABASE OPEN RESETLOGS;</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-C8B73D43-EF8C-44F6-825F-1BC8730CB692">
                  <p class="titleinexample">示例3-28将控制文件自动备份还原到非缺省位置</p>
                  <p>此示例是<a href="RESTORE.html#GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDBAFDB">示例3-27</a>的变体。在此方案中，控制文件自动备份位于非默认位置的磁盘上。RMAN开始搜索序列号为20的备份，并向后搜索5个月：</p><pre class="oac_no_warn" dir="ltr">CONNECT TARGET / STARTUP FORCE NOMOUNT SET DBID 36508508; ＃在NOCATALOG模式下恢复控制文件时需要RUN {设备类型磁盘的SET CONTROLFILE AUTOBACKUP格式为'/ disk1 / prod_cf_auto_％F';从AUTOBACKUP MAXSEQ 20 MAXDAYS 150恢复CONTROLFILE到'/tmp/cf_auto.dbf'; ALTER DATABASE MOUNT; RESTORE DATABASE;恢复数据库; ALTER DATABASE OPEN RESETLOGS;</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-24D7B81E-CECC-44EF-B6B7-6DD2F4766423">
                  <p class="titleinexample">示例3-29恢复存储在磁带或Oracle Cloud上的控制文件自动备份</p>
                  <p>根据备份计划在磁盘上创建数据库备份。已启用控制文件自动备份，但未使用恢复目录。随后，使用<code class="codeph">BACKUP BACKUPSET ALL</code>命令将这些备份集备份到Oracle Cloud。此示例使用在Oracle Cloud上创建的自动备份还原控制文件。RMAN扫描磁盘和Oracle云备份，然后检索最新的控制文件自动备份。您必须为Oracle Cloud配置一个磁盘通道和一个SBT通道。
                  </p><pre class="pre codeblock"><code>RUN {SET DBID 1928835918; ALLOCATE CHANNEL disk1 DEVICE TYPE DISK; ALLOCATE CHANNEL sbt1设备类型'SBT_TAPE'参数'SBT_LIBRARY = / disk1 / oss / libopc.so ENV =（OPC_PFILE = / disk1 / oss / opc_sbt.ora）';从AUTOBACKUP恢复CONTROLFILE; }</code></pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-24AA3226-F3F0-4E61-B8AC-A9F5DE32B281">
                  <p class="titleinexample">示例3-30恢复服务器参数文件自动备份到当前位置</p>
                  <p>以下一系列命令以<code class="codeph">NOCATALOG</code>模式还原当前服务器参数文件，然后使用还原的服务器参数文件启动实例。
                  </p><pre class="oac_no_warn" dir="ltr">CONNECT TARGET / SET DBID 1620189241; ＃将dbid设置为目标数据库的dbid STARTUP FORCE NOMOUNT; #start instance with dummy SPFILE RUN {ALLOCATE CHANNEL c1 DEVICE TYPE sbt;从AUTOBACKUP恢复SPFILE; ＃FROM AUTOBACKUP在NOCATALOG模式下需要STARTUP FORCE; #recovery with restored SPFILE}</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDEFIAA">
                  <p class="titleinexample">示例3-31预览备份</p>
                  <p>此示例显示<code class="codeph">RESTORE ...的结果<code class="codeph">RESTORE ...PREVIEW</code>命令，用于标识RMAN选择用于还原存档重做日志文件的备份集。
                  </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; RESTORE ARCHIVELOG所有设备类型sbt预览;在01-MAR-13发布通道开始恢复：ORA_SBT_TAPE_1已分配通道：ORA_SBT_TAPE_1通道ORA_SBT_TAPE_1：SID = 85设备类型= SBT_TAPE通道ORA_SBT_TAPE_1：Oracle安全备份备份集列表============== ===== BS密钥大小设备类型经过时间完成时间------- ---------- ----------- -------- ---- --------------- 53 1.25M SBT_TAPE 00:00:18 01-MAR-13 BP Key：53状态：AVAILABLE压缩：无标签：TAG20130301T150155手柄：2aibhej3_1_1媒体：RMAN-DEFAULT-000001备份集中的存档日志列表53 Thrd Seq低SCN低时间下一个SCN下一次---- ------- ---------- ----- ---- ---------- --------- 1 8 526376 01-MAR-13 527059 01-MAR-13 1 9 527059 01-MAR-13 527074 01-MAR- 13 1 10 527074 01-MAR-13 527091 01-MAR-13 1 11 527091 01-MAR-13 527568 01-MAR-13 1 12 527568 01-MAR-13 527598 01-MAR-13验证成功备份件完成恢复在1月1日至3月13日</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDDHJHH">
                  <p class="titleinexample">示例3-32从非现场存储中调用非现场备份</p>
                  <p>与媒体管理器一起使用时，它会报告有关备份的异地存储的信息，并支持调用异地备份， <code class="codeph">RESTORE ...PREVIEW RECALL</code>请求从异地存储中调用从备份还原归档重做日志文件所需的任何介质。
                  </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; RESTORE ARCHIVELOG ALL PREVIEW RECALL;使用通道ORA_DBK_1使用通道ORA_DISK_1在10-JUN-13开始恢复ORA_SBT_TAPE_1备份集列表=================== BS密钥大小设备类型经过时间完成时间---- --- ---------- ----------- ------------ -------------- -  31 12.75M SBT_TAPE 00:00:02 10-JUN-13 BP密钥：33状态：可用压缩：无标签：TAG20130610T152755句柄：15gmknbs媒体：/ v1,15gmknbs备份集中的存档日志列表31 Thrd Seq低SCN低下一次SCN的下一次---- ------- ---------- --------- ---------- ----- ---- 1 1 221154 06-JUN-13 222548 06-JUN-13 1 2 222548 06-JUN-13 222554 06-JUN-13 1 3 222554 06-JUN-13 222591 06-JUN-13 1 4 222591 06 -JUN-13 246629 07-JUN-13 1 5 246629 07-JUN-13 262451 10-JUN-13 BS密钥尺寸设备类型经过时间完成时间------- ---------- ----------- ------------ --------------- 32 256.00K SBT_TAPE 00:00:01 10-JUN -13 BP Key：34状态：AVAILABLE压缩：无标签：TAG20130610T153105句柄：17gmknhp_1_1媒体：/ v1,17gmknhp_1_1 b中的存档日志列表ackup设置32 Thrd Seq低SCN低时间下一个SCN下一次---- ------- ---------- --------- ------- --- --------- 1 6 262451 10-JUN-13 262547 10-JUN-13 1 7 262547 10-JUN-13 262565 10-JUN-13启动召回以下异地备份文件列表================================================== ========句柄：15gmknbs媒体：/ v1,15gmknbs在10-JUN-13完成恢复</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CHDHIEJA">
                  <p class="titleinexample">示例3-33验证备份的还原</p>
                  <p>以下示例说明如何使用<code class="codeph">RESTORE...VALIDATE</code>确认恢复数据库所需的备份存在于磁盘或磁带，可读的，并没有损坏：</p><pre class="oac_no_warn" dir="ltr">RMAN&gt; RESTORE DATABASE VALIDATE;使用通道ORA_DISK_1分配的通道在0-MAR-13开始恢复：ORA_SBT_TAPE_1通道ORA_SBT_TAPE_1：SID = 85设备类型= SBT_TAPE通道ORA_SBT_TAPE_1：Oracle安全备份通道ORA_DISK_1：开始验证数据文件备份集通道ORA_DISK_1：从备份片/ disk2读取/ PROD / backupset / 2013_03_01 / o1_mf_nnndf_TAG20130301T161038_2ygtvzg0_.bkp channel ORA_DISK_1：piece handle = / disk2 / PROD / backupset / 2013_03_01 / o1_mf_nnndf_TAG20130301T161038_2ygtvzg0_.bkp tag = TAG20130301T161038 channel ORA_DISK_1：恢复备份1通道ORA_DISK_1：验证完成，已用时间：00：00： 16完成恢复于01-MAR-13</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-F3A8E3B5-91C6-4528-994C-2BEB2DB49A33">
                  <p class="titleinexample">示例3-34使用备用数据库恢复主数据库上的数据文件</p>
                  <p>此示例通过网络从备用数据库恢复在主数据库上丢失的数据文件<code class="codeph">users.dbf</code> ：</p><pre class="oac_no_warn" dir="ltr">RESTORE DATAFILE'/oradata/files/users.dbf' FROM SERVICE standby_tns SECTION SIZE 200M使用COMPRESSED BACKUPSET;</pre><p>包含要还原的数据文件的远程数据库的服务名称是<code class="codeph">standby_tns</code> 。<code class="codeph">SECTION SIZE</code>子句指示使用多节备份集还原数据文件。<code class="codeph">USING COMPRESSED BACKUPSET</code>子句指定使用为RMAN配置的默认压缩算法压缩备份集。</p>
               </div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-4A098666-190F-41FD-8F74-FA59042AEBE2">
                  <p class="titleinexample">示例3-35从跨平台数据库备份还原数据库</p>
                  <p>此示例使用在<a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50__BGBECGFG">示例2-34</a>中创建的跨平台备份还原数据库。此备份是在Microsoft Windows IA（32位）平台上创建的，并且正在Linux x86 64位上进行还原。包含数据库的备份集存储在<code class="codeph">/tmp/xplat_restores/full_db.bck</code> 。已恢复的数据文件使用以<code class="codeph">df_</code>开头的唯一文件名存储在<code class="codeph">/oradata/datafiles</code></p><pre class="oac_no_warn" dir="ltr">从平台恢复'Microsoft Windows IA（32位）'所有外国数据文件格式'/ oradata / datafiles / df_％U'从BACKUPSET'/ tmp / xplat_restores / full_db.bck';</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-30865953-C561-49AF-AC5A-3310E3BF6431">
                  <p class="titleinexample">示例3-36从跨平台表空间备份还原表空间</p>
                  <p>此示例从<a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50__BGBJFJAC">示例2-35中</a>创建的跨平台备份还原表空间<code class="codeph">example</code> 。包含要还原的表空间的备份集存储在<code class="codeph">/tmp/xplat_restores/example_readonly.bck</code> 。已还原的数据文件使用与<code class="codeph">example_readonly_</code>一起使用的唯一名称。将此表空间插入目标数据库所需的元数据存储在备份集<code class="codeph">/tmp/xplat_restores/example_dmp.bck</code> 。
                  </p><pre class="oac_no_warn" dir="ltr">RESTORE FOREIGN TABLESPACE示例格式'/ tmp / xplat_restores / example_readonly_％U_％n'来自BACKUPSET'/ tmp / xplat_restores / example_readonly.bck'DUMP FILE DATAPUMP DESTINATION'/ tmp / datapump'FROM BACKUPSET'/tmp/xplat_restores/example_dmp.bck “;</pre><div class="infoboxnotealso" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-CE4AC678-A9C0-4AB7-9DF0-23AFD016AF6B">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../bradv/rman-transporting-data-across-platforms.html#BRADV-GUID-7E1B3B10-CDA2-4E79-9F4C-AC8E51BCDE54" target="_blank"><span class="italic">“Oracle数据库备份和恢复用户指南”</span></a> ，提供备份和还原多个表空间的示例</p>
                  </div>
               </div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-0D8CF88F-B6D9-4EBD-91F9-14995B61CFFB">
                  <p class="titleinexample">示例3-37使用由多个备份集组成的跨平台备份还原表空间</p>
                  <p>此示例从跨平台备份还原表空间<code class="codeph">example</code> ，该备份包含在<a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50__BGBFJIGG">示例2-36</a>中创建的多个备份集。您必须为每个备份集使用单独的<code class="codeph">BACKUPSET</code>子句。必须按照创建顺序列出备份集，从第一个备份集开始。
                  </p><pre class="oac_no_warn" dir="ltr">RESTORE BACKUPSET '/ TMP / xplat_restores / db_multiple_59nkcln6_1_1' BACKUPSET '/ TMP / xplat_restores / db_multiple_5ankcln7_1_1' BACKUPSET '/ TMP / xplat_restores / db_multiple_5bnkcln8_1_1' BACKUPSET '/ TMP / xplat_restores / db_multiple_5cnkcln9_1_1' 转储文件FROM BACKUPSET“/tmp/xplat_restores/db_multiple.dmp “;</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__CFADGAFF">
                  <p class="titleinexample">示例3-38使用包含多个备份片的跨平台一致性备份还原表空间</p>
                  <p>此示例从跨平台备份还原表空间<code class="codeph">example</code> ，该备份包含在<a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50__BGBCECEE">示例2-37</a>中创建的多个备份片段。包含表空间元数据的导出转储文件存储在<code class="codeph">/tmp/xplat_restores/example_mutli-piece_dmp.bck</code> 。<code class="codeph">FROM BACKUPSET</code>子句包含所有备份片段的逗号分隔列表。按照创建备份的顺序列出备份件。
                  </p><pre class="oac_no_warn" dir="ltr">RESTORE FOREIGN TABLESPACE销售FORMAT'/ tmp / xplat_restores / datafiles / example_mult_％u'FROM BACKUPSET'/ tmp / xplat_restores / example_multi-piece_0lnjnujs_1_1'，'/ tmp / xplat_restores / example_multi-piece_0lnjnujs_2_1'，'/ tmp / xplat_restores / example_multi-piece_0lnjnujs_3_1 '来自BACKUPSET的DUMP文件'/tmp/xplat_restores/example_multi-piece_dmp.bck';</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-8C951D9D-F006-4F24-98EB-230D83085F77">
                  <p class="titleinexample">示例3-39恢复跨平台不一致的表空间备份</p>
                  <p>此示例从<a href="BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50__BGBEJBGF">示例2-38中</a>创建的跨平台不一致备份还原表空间<code class="codeph">example</code> 。使用以<code class="codeph">inconsist_</code>开头的唯一名称存储还原的数据文件。由于在创建备份时表空间不是只读的，因此无法将其直接插入目标数据库。当表空间只读取到恢复的外部数据文件时，必须对表空间应用增量备份。
                  </p><pre class="oac_no_warn" dir="ltr">RESTORE FOREIGN TABLESPACE示例FORMAT'/ tmp / xplat_restores / datafiles / inconsist_％u'FROM BACKUPSET'/tmp/xplat_backups/example_inconsist.bck';</pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-337C1520-09A8-4B2F-9372-C029D4ADCD3E">
                  <p class="titleinexample">示例3-40 <span class="bold">使用PDB的跨平台备份将PDB还原到新CDB</span></p>
                  <p></p>
                  <p>此示例还原目标CDB上的可插拔数据库（PDB） <code class="codeph">pdb3</code>的跨平台备份。目标CDB和源CDB位于不同的平台上，但使用相同的endian格式。
                  </p>
                  <p>目标CDB以读写模式打开。包含源PDB的跨平台备份的备份集存储在<code class="codeph">/u02/backups/backup_full_pdb3.bck</code> 。将源PDB插入目标CDB所需的元数据存储在<code class="codeph">/u02/backups/metadata_pdb3.xml</code> 。<code class="codeph">FILE_NAME_CONVERT</code>子句指定必须如何在目标CDB中重命名源CDB上的文件名。</p><pre class="pre codeblock"><code>从PLATFORM恢复'Linux x86 64位'使用'/u02/backups/metadata_pdb3.xml'FILE_NAME_CONVERT =（'/ u01 / oradata'，'/ u02 / oradata / cdb'）FOREIGN PLUGGABLE DATABASE pdb3 FORMAT'/ u02 / oradata / cdb / pdb3_％U'FROM BACKUPSET'/u02/backups/backup_full_pdb3.bck';</code></pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-A97F11DD-1E97-43A9-A857-4D2E87EA236E">
                  <p class="titleinexample">示例3-41使用加密将内部部署数据库移动到Oracle Cloud</p>
                  <p></p>
                  <p>此示例通过还原数据库备份将内部部署数据库移动到Oracle Cloud。内部部署数据库不使用加密，数据库备份也不加密。但是，Oracle Cloud上的数据库必须使用加密。因此，为了保持一致性和安全性，必须使用加密在Oracle Cloud上恢复未加密数据库的备份。您可以通过使用<code class="codeph">AS ENCRYPTED</code>子句和<code class="codeph">RESTORE</code>命令来实现此目的。必须在<code class="codeph">RESTORE...之前打开Oracle密钥库<code class="codeph">RESTORE...AS ENCRYPTED</code>命令运行。
                  </p>
                  <p>内部部署数据库的<code class="codeph">COMPATIBLE</code>参数设置为12.2，并且<code class="codeph">COMPATIBLE</code>设置为12.2创建备份。以下命令还原未加密的备份以在Oracle Cloud上通过加密创建数据库：</p><pre class="pre codeblock"><code>SELECT ts＃，encryptionalg，encryptedts，key_version，status FROM v $ encrypted_tablespaces; STARTUP FORCE MOUNT; RESTORE DATABASE as ENCRYPTED;恢复数据库; ALTER DATABASE OPEN;</code></pre></div>
               <!-- class="example" -->
               <div class="example" id="GUID-4491C03F-C5F8-43E5-B4C4-FE26C70F2E9B__GUID-1C6A58BB-9484-4EDF-A9CB-8B0CE2ECB61C">
                  <p class="titleinexample">示例3-42将数据库从Oracle Cloud移动到内部部署模型</p>
                  <p></p>
                  <p>此示例将数据库从使用加密的Oracle Cloud移动到内部部署模型。由于加密对于内部部署数据库不是必需的，因此您决定在不使用加密的情况下从Oracle Cloud还原加密的备份。使用<code class="codeph">RESTORE</code>命令的<code class="codeph">AS DECRYPTED</code>子句执行此还原操作。
                  </p>
                  <p>内部部署数据库的<code class="codeph">COMPATIBLE</code>参数设置为12.2。使用<code class="codeph">COMPATIBLE</code>设置为12.2创建备份。以下命令将加密的备份从Oracle Cloud还原到内部部署数据库，而不使用加密：</p><pre class="pre codeblock"><code>SELECT ts＃，encryptionalg，encryptedts，key_version，status FROM v $ encrypted_tablespaces; STARTUP FORCE MOUNT; RESTORE DATABASE as DECRYPTED RECOVER DATABASE; ALTER DATABASE OPEN;</code></pre></div>
               <!-- class="example" -->
            </div>
         </div>
      </article>
   </body>
</html>