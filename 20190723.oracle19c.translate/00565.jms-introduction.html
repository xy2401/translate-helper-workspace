<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <title>Oracle Java消息服务简介</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Advanced Queuing User&#39;s Guide "></meta>
      <meta property="og:description" content=""></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Advanced Queuing User&#39;s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="oracle-database-advanced-queuing.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-02-12T10:53:09-08:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96511-01"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="aq-operations-using-pl-sql.html" title="Previous" type="text/html"></link>
      <link rel="next" href="jms-basic-operation.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Oracle® Database Advanced Queuing"></meta>
    <meta name="dcterms.isVersionOf" content="ADQUE"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="aq-operations-using-pl-sql.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="jms-basic-operation.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">高级排队用户指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle Java消息服务简介</li>
            </ol>
            <a id="GUID-6A777116-92A8-4C49-92E2-10CCF558E58E" name="GUID-6A777116-92A8-4C49-92E2-10CCF558E58E"></a><a id="ADQUE1100"></a>
            
            <h2 id="ADQUE-GUID-6A777116-92A8-4C49-92E2-10CCF558E58E" class="sect2"><span class="enumeration_chapter">11</span> Oracle Java消息服务简介</h2>
         </header>
         <div class="ind">
            <div>
               <p>以下主题描述了Oracle数据库高级队列（AQ）的Oracle <a href="glossary.html#GUID-3A98EBD4-296B-4BE8-82AE-5B42D07E9894"><span class="xrefglossterm">Java消息服务</span></a> （JMS）接口。
               </p>
               <ul style="list-style-type:disc">
                  <li>
                     <p><a href="jms-introduction.html#GUID-1AC3E0F3-4641-495F-82C4-9E8D67C67FF3">JMS和Oracle JMS的一般特性</a></p>
                  </li>
                  <li>
                     <p><a href="jms-introduction.html#GUID-555A7DAB-4117-4B7F-9A68-3716C83F9F7C">JMS中的结构化有效负载/消息类型</a></p>
                  </li>
                  <li>
                     <p><a href="jms-introduction.html#GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F">JMS中的缓冲消息传递</a></p>
                  </li>
                  <li>
                     <p><a href="jms-introduction.html#GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA">JMS点对点模型特征</a></p>
                  </li>
                  <li>
                     <p><a href="jms-introduction.html#GUID-C6B0D221-741E-4C66-82D9-EBCCD870B339">JMS发布/订阅模型功能</a></p>
                  </li>
                  <li>
                     <p><a href="jms-introduction.html#GUID-14D8B416-BEC1-4C58-83C1-D6FD16B6961D">JMS消息生成器功能</a></p>
                  </li>
                  <li>
                     <p><a href="jms-introduction.html#GUID-4A309A42-7301-4B28-8B0B-A59D75DF9ECE">JMS消息消费者功能</a></p>
                  </li>
                  <li>
                     <p><a href="jms-introduction.html#GUID-9453B830-327C-46F2-8F0F-BFD8897B8A5E">JMS传播</a></p>
                  </li>
                  <li>
                     <p><a href="jms-introduction.html#GUID-B91F9B8D-0600-47AC-ABE2-F984676B5DFB">使用JMS AQ进行消息转换</a></p>
                  </li>
                  <li>
                     <p><a href="jms-introduction.html#GUID-3C01DF53-88AE-4A33-986A-5C259230491F">JMS流媒体</a></p>
                  </li>
                  <li>
                     <p><a href="jms-introduction.html#GUID-7D8D9257-574D-4378-B580-DA656D2F0511">Java EE合规性</a></p>
                  </li>
               </ul>
            </div><a id="ADQUE2858"></a><div class="props_rev_3"><a id="GUID-1AC3E0F3-4641-495F-82C4-9E8D67C67FF3" name="GUID-1AC3E0F3-4641-495F-82C4-9E8D67C67FF3"></a><h3 id="ADQUE-GUID-1AC3E0F3-4641-495F-82C4-9E8D67C67FF3" class="sect3"><span class="enumeration_section">11.1</span> JMS和Oracle JMS的一般功能</h3>
               <div>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="jms-introduction.html#GUID-0EC8127B-2B2F-4767-A027-F8B0F298EDEA">JMS连接和会话</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-03A2BF32-F7F3-469E-A5EB-1ED60985C6C2">JMS目的地</a> 
                        </p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-04C64423-595C-42F2-A86A-E7FE04BDC72E">JMS中的系统级访问控制</a> 
                        </p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-7EDEBA8C-1543-4ED0-A5A6-96E303CE3502">JMS中的目标级访问控制</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-9A30E012-E54F-44E2-92C6-8EC75FEB15BC">JMS中的保留和消息历史记录</a> 
                        </p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-170E2DC8-7418-44D9-9AA8-4303DE60453F">在JMS中支持Oracle Real Application Clusters</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-E00A2653-462B-4158-B2B1-90348E19D0CB">支持JMS中的统计视图</a> 
                        </p>
                     </li>
                  </ul>
               </div><a id="ADQUE2859"></a><div class="props_rev_3"><a id="GUID-0EC8127B-2B2F-4767-A027-F8B0F298EDEA" name="GUID-0EC8127B-2B2F-4767-A027-F8B0F298EDEA"></a><h4 id="ADQUE-GUID-0EC8127B-2B2F-4767-A027-F8B0F298EDEA" class="sect4"><span class="enumeration_section">11.1.1</span> JMS连接和会话</h4>
                  <div>
                     <p>本节包含以下主题：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="jms-introduction.html#GUID-9912D681-B4FE-4086-8F4E-FE2F4144D020">ConnectionFactory对象</a></p>
                        </li>
                        <li>
                           <p><a href="jms-introduction.html#GUID-111B6378-1EA4-424C-AAF0-1C943C9530D5">使用AQjmsFactory获取ConnectionFactory对象</a></p>
                        </li>
                        <li>
                           <p><a href="jms-introduction.html#GUID-DFA37C65-C451-41FA-9E71-ECE8A3B1F35C">使用JNDI查找ConnectionFactory对象</a></p>
                        </li>
                        <li>
                           <p><a href="jms-introduction.html#GUID-E635265C-6771-4CC1-8C32-FF3DA9716879">JMS连接</a></p>
                        </li>
                        <li>
                           <p><a href="jms-introduction.html#GUID-0ACF176D-A419-4EE2-AF2B-3321A167E104">JMS会话</a></p>
                        </li>
                     </ul>
                  </div><a id="ADQUE2860"></a><div class="props_rev_3"><a id="GUID-9912D681-B4FE-4086-8F4E-FE2F4144D020" name="GUID-9912D681-B4FE-4086-8F4E-FE2F4144D020"></a><h5 id="ADQUE-GUID-9912D681-B4FE-4086-8F4E-FE2F4144D020" class="sect5"><span class="enumeration_section">11.1.1.1</span> ConnectionFactory对象</h5>
                     <div>
                        <p><code class="codeph">ConnectionFactory</code>封装了一组由管理员定义的连接配置参数。客户端使用它来创建与JMS提供程序的连接。在这种情况下，Oracle JMS（Oracle数据库的一部分）是JMS提供者。
                        </p>
                        <p><code class="codeph">ConnectionFactory</code>对象的三种类型是：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">连接工厂</code> 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">的QueueConnectionFactory</code> 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">TopicConnectionFactory的</code> 
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="ADQUE2861"></a><div class="props_rev_3"><a id="GUID-111B6378-1EA4-424C-AAF0-1C943C9530D5" name="GUID-111B6378-1EA4-424C-AAF0-1C943C9530D5"></a><h5 id="ADQUE-GUID-111B6378-1EA4-424C-AAF0-1C943C9530D5" class="sect5"><span class="enumeration_section">11.1.1.2</span>使用AQjmsFactory获取ConnectionFactory对象</h5>
                     <div>
                        <div class="section">
                           <p>您可以使用<code class="codeph">AQjmsFactory</code>类来获取<code class="codeph">ConnectionFactory</code> ， <code class="codeph">QueueConnectionFactory</code>或<code class="codeph">TopicConnectionFactory</code>对象的句柄。
                           </p>
                           <p>为了获得<code class="codeph">ConnectionFactory</code> ，它支持点至点和发布/订阅操作，可使用<code class="codeph">AQjmsFactory.getConnectionFactory()</code>要获取<code class="codeph">QueueConnectionFactory</code> ，请使用<code class="codeph">AQjmsFactory.getQueueConnectionFactory()</code> 。要获取<code class="codeph">TopicConnectionFactory</code> ，请使用<code class="codeph">AQjmsFactory.getTopicConnectionFactory()</code> 。
                           </p>
                           <p>可以使用主机名，端口号和SID驱动程序或使用JDBC URL和属性创建<code class="codeph">ConnectionFactory</code> ， <code class="codeph">QueueConnectionFactory</code>或<code class="codeph">TopicConnectionFactory</code> 。
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="ADQUE2863"></a><a id="ADQUE2862"></a><div class="props_rev_3"><a id="GUID-DFA37C65-C451-41FA-9E71-ECE8A3B1F35C" name="GUID-DFA37C65-C451-41FA-9E71-ECE8A3B1F35C"></a><h5 id="ADQUE-GUID-DFA37C65-C451-41FA-9E71-ECE8A3B1F35C" class="sect5"><span class="enumeration_section">11.1.1.3</span>使用JNDI查找ConnectionFactory对象</h5>
                     <div>
                        <div class="section">
                           <p>JMS管理员可以在<a href="glossary.html#GUID-6BF3485C-E98F-4344-A7DE-64950BCCE160"><span class="xrefglossterm">轻量级目录访问协议</span></a> （LDAP）服务器中注册<code class="codeph">ConnectionFactory</code>对象。要在JMS中启用<a href="glossary.html#GUID-73476CA0-7AD9-41B9-97E6-7A34F0D4161F"><span class="xrefglossterm">Java命名和目录接口</span></a> （JNDI）查找，需要以下设置：</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>注册数据库</span><div>
                                 <p>安装Oracle数据库服务器时，必须向LDAP服务器注册数据库。这可以使用<a href="glossary.html#GUID-B4030090-6D19-4654-8DE8-DF067ABBC2B5"><span class="xrefglossterm">Database Configuration Assistant</span></a> （DBCA）来完成。<a href="jms-introduction.html#GUID-DFA37C65-C451-41FA-9E71-ECE8A3B1F35C__CIAIHEII">图11-1</a>显示了LDAP服务器中Oracle Database Advanced Queuing条目的结构。<code class="codeph">ConnectionFactory</code>信息存储在<code class="codeph">&lt;cn=OracleDBConnections&gt;</code> ，而主题和队列存储在<code class="codeph">&lt;cn=OracleDBQueues&gt;</code> 。
                                 </p>
                                 <div class="figure" id="GUID-DFA37C65-C451-41FA-9E71-ECE8A3B1F35C__CIAIHEII">
                                    <p class="titleinfigure">图11-1 LDAP服务器中Oracle数据库高级队列条目的结构</p><img width="496" src="img/adque446.gif" alt="下面是图11-1的描述" title="下面是图11-1的描述" longdesc="img_text/adque446.html"><br><a href="img_text/adque446.html">“图11-1 LDAP服务器中Oracle数据库高级队列条目的结构”的说明</a></div>
                                 <!-- class="figure" -->
                              </div>
                           </li>
                           <li class="stepexpand"><span>设置参数<code class="codeph">GLOBAL_TOPIC_ENABLED</code> 。</span><div>
                                 <p>必须将数据库的<code class="codeph">GLOBAL_TOPIC_ENABLED</code>系统参数设置为<code class="codeph">TRUE</code> 。这可确保在Oracle数据库高级队列中创建的所有队列和主题都自动注册到LDAP服务器。可以使用<code class="codeph">ALTER SYSTEM SET GLOBAL_TOPIC_ENABLED = TRUE</code>设置此参数。</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>注册<code class="codeph">ConnectionFactory</code>对象</span><div>
                                 <p>在将数据库设置为使用LDAP服务器之后，JMS管理员可以使用<code class="codeph">AQjmsFactory.registerConnectionFactory()</code>在LDAP中注册<code class="codeph">ConnectionFactory</code> ， <code class="codeph">QueueConnectionFactory</code>和<code class="codeph">TopicConnectionFactory</code>对象。
                                 </p>
                                 <p>注册可以通过以下方式之一完成：</p>
                                 <ul style="list-style-type:disc">
                                    <li>
                                       <p>直接连接到LDAP服务器</p>
                                       <p><a id="d64698e585" class="indexterm-anchor"></a><a id="d64698e589" class="indexterm-anchor"></a>用户必须具有<code class="codeph">GLOBAL_AQ_USER_ROLE</code>才能在LDAP中注册连接工厂。</p>
                                       <p>要直接连接到LDAP， <code class="codeph">registerConnectionFactory</code>方法的参数包括LDAP上下文， <code class="codeph">ConnectionFactory</code>的名称， <code class="codeph">QueueConnectionFactory</code>或<code class="codeph">TopicConnectionFactory</code> ，主机名，数据库SID，端口号， <a href="glossary.html#GUID-F112AB6B-FC1B-48D6-8E40-1CB9BAE724EF"><span class="xrefglossterm">JDBC驱动程序</span></a> （thin或oci8）和工厂类型（队列或主题） ）。
                                       </p>
                                    </li>
                                    <li>
                                       <p>通过数据库服务器连接到LDAP</p>
                                       <p><a id="d64698e619" class="indexterm-anchor"></a><a id="d64698e623" class="indexterm-anchor"></a>用户可以先登录Oracle数据库，然后让数据库更新LDAP条目。登录到数据库的用户必须具有<code class="codeph">AQ_ADMINISTRATOR_ROLE</code>才能执行此操作。
                                       </p>
                                       <p>要通过数据库服务器连接到LDAP， <code class="codeph">registerConnectionFactory</code>方法的参数包括JDBC连接（具有<code class="codeph">AQ_ADMINISTRATOR_ROLE</code>的用户）， <code class="codeph">ConnectionFactory</code>的名称， <code class="codeph">QueueConnectionFactory</code>或<code class="codeph">TopicConnectionFactory</code> ，主机名，数据库SID，端口号，JDBC驱动程序（瘦）或oci8）和工厂类型（队列或主题）。
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div><a id="ADQUE2864"></a><div class="props_rev_3"><a id="GUID-E635265C-6771-4CC1-8C32-FF3DA9716879" name="GUID-E635265C-6771-4CC1-8C32-FF3DA9716879"></a><h5 id="ADQUE-GUID-E635265C-6771-4CC1-8C32-FF3DA9716879" class="sect5"><span class="enumeration_section">11.1.1.4</span> JMS连接</h5>
                     <div>
                        <p>JMS <code class="codeph">Connection</code>是客户端与其JMS提供程序之间的活动连接。JMS <code class="codeph">Connection</code>执行几项关键服务：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>使用JMS提供程序封装打开的连接或连接池</p>
                           </li>
                           <li>
                              <p>通常表示客户端和提供者的服务守护程序之间的开放TCP / IP套接字（或一组打开的套接字）</p>
                           </li>
                           <li>
                              <p>提供用于在创建客户端时对其进行身份验证的结构</p>
                           </li>
                           <li>
                              <p>创建<code class="codeph">Sessions</code></p>
                           </li>
                           <li>
                              <p>提供连接元数据</p>
                           </li>
                           <li>
                              <p>支持可选的<code class="codeph">ExceptionListener</code></p>
                           </li>
                        </ul>
                        <p>可以通过调用<code class="codeph">createConnection()</code> ， <code class="codeph">createQueueConnection()</code>或<code class="codeph">createTopicConnection()</code>并分别在<code class="codeph">ConnectionFactory</code> ， <code class="codeph">QueueConnectionFactory</code>或<code class="codeph">TopicConnectionFactory</code>对象上传递参数<code class="codeph">username</code>和<code class="codeph">password</code>来创建与数据库的JMS <code class="codeph">Connection</code> 。
                        </p>
                        <p><code class="codeph">Connection</code>对象支持的一些方法是</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">开始（）</code> 
                              </p>
                              <p>此方法启动或重新启动传入消息的传递。</p>
                           </li>
                           <li>
                              <p><code class="codeph">停（）</code></p>
                              <p>此方法暂时停止传入消息的传递。当<code class="codeph">Connection</code>对象停止时，将禁止向其所有消息使用者传递。此外， <a href="glossary.html#GUID-BC2328C0-3548-45D1-9B5C-64DB4573984C"><span class="xrefglossterm">同步</span></a>接收的块和消息不会传递给消息侦听器。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">关（）</code></p>
                              <p>此方法关闭<a href="glossary.html#GUID-F7331CE7-BF82-4FA0-81B3-42D454068F03"><span class="xrefglossterm">JMS会话</span></a>并释放所有关联的资源。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">createSession（true，0）</code></p>
                              <p>此方法使用JMS <code class="codeph">Connection</code>实例创建JMS <code class="codeph">Session</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">createQueueSession(true,</code> <code class="codeph">0)</code></p>
                              <p>此方法创建<code class="codeph">QueueSession</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">createTopicSession(true,</code> <code class="codeph">0</code> ）</p>
                              <p>此方法创建<code class="codeph">TopicSession</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">setExceptionListener（的ExceptionListener）</code></p>
                              <p>此方法为<code class="codeph">Connection</code>设置异常侦听器。这允许客户端异步通知问题。如果<code class="codeph">Connection</code>只消耗消息，那么它没有其他方法可以学习它已经失败。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">getExceptionListener（）</code></p>
                              <p>此方法获取此<code class="codeph">Connection</code>的<code class="codeph">ExceptionListener</code> 。
                              </p>
                           </li>
                        </ul>
                        <p>JMS客户端通常创建一个<code class="codeph">Connection</code> ，一个<code class="codeph">Session</code>以及几个<code class="codeph">MessageProducer</code>和<code class="codeph">MessageConsumer</code>对象。在当前版本中，每个<code class="codeph">Connection</code>只允许一个打开的<code class="codeph">Session</code> ，但以下情况除外：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>如果JDBC oci8驱动程序用于创建<a href="glossary.html#GUID-D081F8A3-08E7-4621-B4EA-5AFD8BD61745"><span class="xrefglossterm">JMS连接</span></a></p>
                           </li>
                           <li>
                              <p>如果用户在创建JMS连接期间提供<code class="codeph">OracleOCIConnectionPool</code>实例</p>
                           </li>
                        </ul>
                        <p>创建<code class="codeph">Connection</code> ，它处于停止模式。在此状态下，不会向其传递任何消息。通常将<code class="codeph">Connection</code>在停止模式，直到设置完成。此时，将调用<code class="codeph">Connection</code> <code class="codeph">start()</code>方法，并且消息开始到达<code class="codeph">Connection</code>使用者。此设置约定最大限度地减少了客户端仍处于设置过程中时<a href="glossary.html#GUID-2869CF65-0641-4E97-9203-3BD8ED03F8D0"><span class="xrefglossterm">异步</span></a>消息传递可能导致的任何客户端混淆。
                        </p>
                        <p>可以启动<code class="codeph">Connection</code>并随后执行设置。执行此操作的客户端必须准备好在仍处于设置过程中时处理异步消息传递。<code class="codeph">MessageProducer</code>可以在<code class="codeph">Connection</code>停止时<a href="glossary.html#GUID-23702F6A-28F1-42D5-BBF6-CCFAACD2B784"><span class="xrefglossterm">发送</span></a>消息。
                        </p>
                     </div>
                  </div><a id="ADQUE2865"></a><div class="props_rev_3"><a id="GUID-0ACF176D-A419-4EE2-AF2B-3321A167E104" name="GUID-0ACF176D-A419-4EE2-AF2B-3321A167E104"></a><h5 id="ADQUE-GUID-0ACF176D-A419-4EE2-AF2B-3321A167E104" class="sect5"><span class="enumeration_section">11.1.1.5</span> JMS会话</h5>
                     <div>
                        <p>JMS <code class="codeph">Session</code>是用于生成和使用消息的单线程上下文。虽然它可以在<a href="glossary.html#GUID-A164150F-BD11-449E-9BDC-28E2A1D9CD52"><span class="xrefglossterm">Java虚拟机</span></a> （JVM）之外分配提供程序资源，但它被视为轻量级JMS对象。
                        </p>
                        <p><code class="codeph">Session</code>几个目的：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>构成<code class="codeph">MessageProducer</code>和<code class="codeph">MessageConsumer</code>对象的工厂</p>
                           </li>
                           <li>
                              <p>提供获取目标对象句柄的方法（队列/主题）</p>
                           </li>
                           <li>
                              <p>供应商优化的消息工厂</p>
                           </li>
                           <li>
                              <p>支持一系列事务，它们结合了工作跨越会话<code class="codeph">MessageProducer</code>和<code class="codeph">MessageConsumer</code>对象，将这些对象组织成单元</p>
                           </li>
                           <li>
                              <p>为其消耗的消息及其生成的消息定义序列顺序</p>
                           </li>
                           <li>
                              <p>序列化使用它注册的<code class="codeph">MessageListener</code>对象的执行</p>
                           </li>
                        </ul>
                        <p>在Oracle数据库<span class="italic">10g中</span> ，当使用JDBC瘦或JDBC厚（OCI）驱动程序时，您可以使用单个JMS <code class="codeph">Connection</code>创建与资源允许一样多的JMS <code class="codeph">Sessions</code> 。
                        </p>
                        <p>由于提供程序可以代表JVM外部的<code class="codeph">Session</code>分配一些资源，因此客户端应在不需要时关闭它们。依靠垃圾收集来最终收回这些资源可能不够及时。对于<code class="codeph">Session</code>创建的<code class="codeph">MessageProducer</code>和<code class="codeph">MessageConsumer</code>对象也是如此。
                        </p>
                        <p><code class="codeph">Session</code>对象的方法包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">承诺（）</code></p>
                              <p>此方法提交事务中执行的所有消息，并释放当前持有的锁。</p>
                           </li>
                           <li>
                              <p><code class="codeph">回滚（）</code></p>
                              <p>此方法回滚在事务中完成的任何消息并释放当前持有的锁。</p>
                           </li>
                           <li>
                              <p><code class="codeph">关（）</code></p>
                              <p>此方法关闭<code class="codeph">Session</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">getDBConnection（）</code></p>
                              <p>此方法获取底层JDBC连接的句柄。此句柄可用于执行其他SQL <a href="glossary.html#GUID-86C2F323-8484-41FB-8E51-BF0462F041DF"><span class="xrefglossterm">DML</span></a>操作作为同一<code class="codeph">Session</code>一部分。该方法特定于Oracle JMS。</p>
                           </li>
                           <li>
                              <p><code class="codeph">确认（）</code></p>
                              <p>此方法确认非事务会话中的消息接收。</p>
                           </li>
                           <li>
                              <p><code class="codeph">恢复（）</code></p>
                              <p>此方法在非事务性会话中重新启动消息传递。实际上，会话中传递的一系列消息将重置为最后一次确认消息之后的点。</p>
                           </li>
                        </ul>
                        <p>以下是一些Oracle JMS扩展：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">createQueueTable（）</code> 
                              </p>
                              <p>此方法创建一个<a href="glossary.html#GUID-45894F1F-4871-4A00-9171-2743821BAD3A"><span class="xrefglossterm">队列表</span></a> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">getQueueTable（）</code></p>
                              <p>此方法获取现有队列表的句柄。</p>
                           </li>
                           <li>
                              <p><code class="codeph">createQueue方法（）</code></p>
                              <p>此方法创建一个队列。</p>
                           </li>
                           <li>
                              <p><code class="codeph">getQueue（）</code></p>
                              <p>此方法获取现有队列的句柄。</p>
                           </li>
                           <li>
                              <p><code class="codeph">createTopic（）</code></p>
                              <p>此方法创建一个主题。</p>
                           </li>
                           <li>
                              <p><code class="codeph">getTopic（）</code></p>
                              <p>此方法获取现有主题的句柄。</p>
                           </li>
                        </ul>
                        <p>必须将<code class="codeph">Session</code>对象<code class="codeph">AQjmsSession</code>转换为<code class="codeph">AQjmsSession</code>才能使用任何扩展。
                        </p>
                        <div class="infoboxnote" id="GUID-0ACF176D-A419-4EE2-AF2B-3321A167E104__GUID-24E3913D-81D9-4086-9043-DFB6E08A79DC">
                           <p class="notep1">注意：</p>
                           <p>JMS规范要求提供程序在尚未启动的JMS <code class="codeph">Connection</code>实例上完成接收时返回空消息。
                           </p>
                           <p>创建<code class="codeph">javax.jms.Connection</code>实例，必须先调用<code class="codeph">start()</code>方法才能接收消息。如果添加像<code class="codeph">t_conn.start();</code>这样的行<code class="codeph">t_conn.start();</code>在创建连接之后，但在实际接收之前的任何时间，您都可以收到您的消息。
                           </p>
                        </div>
                     </div>
                  </div>
               </div><a id="ADQUE2866"></a><div class="props_rev_3"><a id="GUID-03A2BF32-F7F3-469E-A5EB-1ED60985C6C2" name="GUID-03A2BF32-F7F3-469E-A5EB-1ED60985C6C2"></a><h4 id="ADQUE-GUID-03A2BF32-F7F3-469E-A5EB-1ED60985C6C2" class="sect4"><span class="enumeration_section">11.1.2</span> JMS目的地</h4>
                  <div>
                     <p><code class="codeph">Destination</code>是客户端用于指定发送消息的目标的对象，以及从中接收消息的源。<code class="codeph">Destination</code>对象可以是<code class="codeph">Queue</code>或<code class="codeph">Topic</code> 。在Oracle Database Advanced Queuing中，这些映射到特定数据库中的<span class="italic"><code class="codeph">schema.queue</code></span> 。<code class="codeph">Queue</code>映射到单用户队列， <code class="codeph">Topic</code>映射到多用户队列。
                     </p>
                  </div><a id="ADQUE2867"></a><div class="props_rev_3"><a id="GUID-18E9ED1C-059B-428C-8DD5-67A63671C563" name="GUID-18E9ED1C-059B-428C-8DD5-67A63671C563"></a><h5 id="ADQUE-GUID-18E9ED1C-059B-428C-8DD5-67A63671C563" class="sect5"><span class="enumeration_section">11.1.2.1</span>使用JMS会话获取目标对象</h5>
                     <div>
                        <p>使用以下特定于域的<code class="codeph">Session</code>方法从<code class="codeph">Session</code>对象创建<code class="codeph">Destination</code>对象：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">AQjmsSession.getQueue（queue_owner，queue_name）</code> 
                              </p>
                              <p>此方法获取JMS队列的句柄。</p>
                           </li>
                           <li>
                              <p><code class="codeph">AQjmsSession.getTopic（topic_owner，topic_name）</code></p>
                              <p>此方法获取<a href="glossary.html#GUID-F601025D-262D-4ECD-A274-1E1F92D9D4EA"><span class="xrefglossterm">JMS主题</span></a>的句柄。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="ADQUE2868"></a><div class="props_rev_3"><a id="GUID-462C000B-FFFC-4568-97CD-9D1F079E6618" name="GUID-462C000B-FFFC-4568-97CD-9D1F079E6618"></a><h5 id="ADQUE-GUID-462C000B-FFFC-4568-97CD-9D1F079E6618" class="sect5"><span class="enumeration_section">11.1.2.2</span>使用JNDI查找目标对象</h5>
                     <div>
                        <p>可以将数据库配置为使用LDAP服务器注册<a href="glossary.html#GUID-CBE1EC43-DFD2-4701-B758-DCE2C98C277A"><span class="xrefglossterm">模式</span></a>对象。如果已将数据库配置为使用LDAP并且GLOBAL_TOPIC_ENABLED参数已设置为TRUE，则在创建LDAP服务器时，将自动向LDAP服务器注册所有JMS队列和主题。管理员还可以为LDAP中注册的队列和主题创建别名。可以使用队列或主题的名称或别名通过JNDI查找在LDAP中注册的队列和主题。
                        </p>
                        <div class="infoboxnotealso" id="GUID-462C000B-FFFC-4568-97CD-9D1F079E6618__GUID-5FA4C2B7-8F4D-4533-8602-CA793D4EC5CC">
                           <p class="notep1">也可以看看：</p>
                           <p><span class="q">“ <a href="aq-administrative-interface.html#GUID-05DCD3B5-48BF-42B4-9D88-A54D9127F61F" title="DBMS_AQADM.ADD_ALIAS_TO_LDAP为LDAP服务器添加别名。">向LDAP服务器添加别名</a> ”</span></p>
                        </div>
                     </div>
                  </div><a id="ADQUE2869"></a><div class="props_rev_3"><a id="GUID-E789D407-83BE-492E-A9C1-22FC2206A533" name="GUID-E789D407-83BE-492E-A9C1-22FC2206A533"></a><h5 id="ADQUE-GUID-E789D407-83BE-492E-A9C1-22FC2206A533" class="sect5"><span class="enumeration_section">11.1.2.3</span> JMS目标方法</h5>
                     <div>
                        <p><code class="codeph">Destination</code>对象的方法包括：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">改变（）</code></p>
                              <p>此方法会更改<code class="codeph">Queue</code>或<code class="codeph">Topic</code> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">schedulePropagation（）</code></p>
                              <p>此方法安排从源到目标的<a href="glossary.html#GUID-DE5B852F-823C-4DC8-B6BB-4825D688A00A"><span class="xrefglossterm">传播</span></a> 。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">unschedulePropagation（）</code> 
                              </p>
                              <p>此方法取消预先安排先前安排的传播。</p>
                           </li>
                           <li>
                              <p><code class="codeph">enablePropagationSchedule（）</code></p>
                              <p>该方法实现了传播计划。</p>
                           </li>
                           <li>
                              <p><code class="codeph">disablePropagationSchedule（）</code></p>
                              <p>此方法禁用传播计划。</p>
                           </li>
                           <li>
                              <p><code class="codeph">开始（）</code></p>
                              <p>此方法启动<code class="codeph">Queue</code>或<code class="codeph">Topic</code> 。可以启动队列以进行入队或<a href="glossary.html#GUID-BC8D60E8-953A-4C6C-8163-F7AE187B768B"><span class="xrefglossterm">出队</span></a> 。可以启动主题以进行发布或订阅。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">停（）</code></p>
                              <p>此方法会停止<code class="codeph">Queue</code>或<code class="codeph">Topic</code> 。队列停止以进行入队或出队。主题已停止发布或订阅。
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">下降（）</code></p>
                              <p>此方法删除<code class="codeph">Queue</code>或<code class="codeph">Topic</code> 。
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADQUE2870"></a><div class="props_rev_3"><a id="GUID-04C64423-595C-42F2-A86A-E7FE04BDC72E" name="GUID-04C64423-595C-42F2-A86A-E7FE04BDC72E"></a><h4 id="ADQUE-GUID-04C64423-595C-42F2-A86A-E7FE04BDC72E" class="sect4"><span class="enumeration_section">11.1.3</span> JMS中的系统级访问控制</h4>
                  <div>
                     <p>Oracle8 <span class="italic">i</span>或更高版本支持所有排队操作的系统级访问控制。此功能允许应用程序设计人员或DBA将用户创建为队列管理员。队列管理员可以在数据库中的任何队列上调用管理和操作JMS接口。这简化了管理工作，因为可以在一个模式下管理数据库中队列的所有管理脚本。
                     </p>
                     <p>当消息到达目标队列时，基于源队列模式名称的会话用于将新到达的消息排入目标队列。这意味着您必须将目标队列的入队权限授予源队列的模式。</p>
                     <p>要传播到远程目标队列，登录用户（在代理结构的地址字段中的数据库链接中指定）应该被授予<code class="codeph">ENQUEUE_ANY</code>权限，或者被授予入队到目标队列的权限。但是，如果数据库链接中的登录用户还拥有目标上的队列表，则不需要授予任何显式权限。
                     </p>
                     <div class="infoboxnotealso" id="GUID-04C64423-595C-42F2-A86A-E7FE04BDC72E__GUID-E6E5D40D-3223-4DC7-AF29-92BA67C6E53B">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="managing-aq.html#GUID-F8529236-38AD-4C3C-ADD9-4AE9E63E5623" title="Oracle Enterprise Manager支持Oracle Database Advanced Queuing的大多数管理功能。Oracle Database Advanced Queuing功能位于Enterprise Manager控制台导航树中的Distributed node下。">Oracle企业管理器支持</a> ”</span></p>
                     </div>
                  </div>
               </div><a id="ADQUE2871"></a><div class="props_rev_3"><a id="GUID-7EDEBA8C-1543-4ED0-A5A6-96E303CE3502" name="GUID-7EDEBA8C-1543-4ED0-A5A6-96E303CE3502"></a><h4 id="ADQUE-GUID-7EDEBA8C-1543-4ED0-A5A6-96E303CE3502" class="sect4"><span class="enumeration_section">11.1.4</span> JMS中的目标级访问控制</h4>
                  <div>
                     <p>Oracle8 <span class="italic">i</span>或更高版本支持对队列或主题级别的入队和出队操作进行访问控制。此功能允许应用程序设计人员保护在一个模式中创建的队列和主题，以及在其他模式中运行的应用程序。您只能为在队列或主题的模式之外运行的应用程序授予最小访问权限。队列或主题支持的访问权限是<code class="codeph">ENQUEUE</code> ， <code class="codeph">DEQUEUE</code>和<code class="codeph">ALL</code> 。</p>
                     <div class="infoboxnotealso" id="GUID-7EDEBA8C-1543-4ED0-A5A6-96E303CE3502__GUID-DFD16C7E-EE09-488A-A37E-2AD17B7BCF74">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="managing-aq.html#GUID-F8529236-38AD-4C3C-ADD9-4AE9E63E5623" title="Oracle Enterprise Manager支持Oracle Database Advanced Queuing的大多数管理功能。Oracle Database Advanced Queuing功能位于Enterprise Manager控制台导航树中的Distributed node下。">Oracle企业管理器支持</a> ”</span></p>
                     </div>
                  </div>
               </div><a id="ADQUE2872"></a><div class="props_rev_3"><a id="GUID-9A30E012-E54F-44E2-92C6-8EC75FEB15BC" name="GUID-9A30E012-E54F-44E2-92C6-8EC75FEB15BC"></a><h4 id="ADQUE-GUID-9A30E012-E54F-44E2-92C6-8EC75FEB15BC" class="sect4"><span class="enumeration_section">11.1.5</span> JMS中的保留和消息历史记录</h4>
                  <div>
                     <p>消息通常彼此相关。例如，如果消息是由于消耗了另一条消息而产生的，那么这两条消息是相关的。作为应用程序设计人员，您可能希望跟踪这些关系。Oracle Database Advanced Queuing允许用户在队列表中保留消息，然后可以在SQL中查询消息以进行分析。</p>
                     <p>除了保留和消息标识符，Oracle数据库高级队列还允许您自动创建消息日志，也称为跟踪日记或事件日志。保留，消息标识符和SQL查询结合在一起，可以构建功能强大的消息仓库。</p>
                  </div>
               </div><a id="ADQUE2873"></a><div class="props_rev_3"><a id="GUID-170E2DC8-7418-44D9-9AA8-4303DE60453F" name="GUID-170E2DC8-7418-44D9-9AA8-4303DE60453F"></a><h4 id="ADQUE-GUID-170E2DC8-7418-44D9-9AA8-4303DE60453F" class="sect4"><span class="enumeration_section">11.1.6</span>在JMS中支持Oracle Real Application Clusters</h4>
                  <div>
                     <p>在Oracle数据库12 <span class="italic">c</span>解除1（12.1），高级队列引入高性能和可扩展的JMS队列分片。分片队列是单个逻辑队列，通过系统维护的分区划分为多个独立的物理队列。对于具有高入队或出队率的队列，或者对于具有多个订户的队列，分片队列是跨Rora实例使用的队列的首选JMS队列。有关详细信息，请参阅<span class="q">“ <a href="aq-performance-scalability.html#GUID-1B18AD7E-2F02-4208-A059-6B4531586C75">Sharded Queues和Oracle Real Application Clusters（Oracle RAC）</a> ”</span> 。
                     </p>
                     <p>对于非分片队列，Oracle Real Application Clusters（Oracle RAC）可用于通过允许不同实例管理不同队列来提高Oracle数据库高级队列性能。您可以通过为存储队列的队列表指定不同的实例关联（首选项）来完成此操作。这允许并行发生不同队列或主题上的队列操作（入队/出队）或主题操作（ <a href="glossary.html#GUID-C1099A1A-C20D-4C9C-AD73-BBF6BC8939B5"><span class="xrefglossterm">发布/订阅</span></a> ）。
                     </p>
                     <p>Oracle数据库高级队列队列监视器进程持续监视队列表的实例关联性。队列监视器将队列表的所有权分配给指定的主实例（如果可用），否则会将其分配给指定的辅助实例。</p>
                     <p>如果队列表的所有者实例终止，则队列监视器将所有权更改为合适的实例，例如辅助实例。</p>
                     <p>Oracle数据库高级队列传播可以使用Oracle Real Application Clusters，尽管它对用户是透明的。代表传播时间表提交的作业的亲和力被设置为与各个队列表的亲和力相同的值。因此，与队列表的所有者实例相关联的<code class="codeph">job_queue_process</code>正在处理来自存储在<code class="codeph">job_queue_process</code>列表中的队列的传播，从而最小化ping。
                     </p>
                     <div class="infoboxnotealso" id="GUID-170E2DC8-7418-44D9-9AA8-4303DE60453F__GUID-0C1C687A-30DC-4592-A0D1-A910A2D1E1AD">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="aq-performance-scalability.html#GUID-30265296-1110-47C0-B949-D22520D04197" title="应用程序可以决定在分片队列中对消息进行分片的方式。在这种情况下，应用程序显式指定将消息排入特定分片。">Sharded Queues</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="aq-administrative-interface.html#GUID-3B8E1DFE-0A6A-4CF2-8069-8DAECB5359A2" title="DBMS_AQADM.SCHEDULE_PROPAGATION计划消息的传播。">调度队列传播</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="../racad/introduction-to-oracle-rac.html#RACAD1111" target="_blank"><span class="italic">“Oracle Real Application Clusters管理和部署指南”</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADQUE2874"></a><div class="props_rev_3"><a id="GUID-E00A2653-462B-4158-B2B1-90348E19D0CB" name="GUID-E00A2653-462B-4158-B2B1-90348E19D0CB"></a><h4 id="ADQUE-GUID-E00A2653-462B-4158-B2B1-90348E19D0CB" class="sect4"><span class="enumeration_section">11.1.7</span>支持JMS中的统计视图</h4>
                  <div>
                     <p>每个实例都在其自己的<a href="glossary.html#GUID-F71A41B0-927F-45BF-97D6-18B4BBCADFB4"><span class="xrefglossterm">系统全局区域</span></a> （SGA）中保留自己的Oracle数据库高级队列统计信息，并且不了解其他实例收集的统计信息。然后，当实例查询<code class="codeph">GV$AQ</code>视图时，所有其他实例将其统计信息汇集到发出查询的实例。
                     </p>
                     <p>可以随时查询<code class="codeph">GV$AQ</code>视图，以查看处于等待，就绪或过期状态的消息数。该视图还显示消息等待处理的平均秒数。
                     </p>
                     <div class="infoboxnotealso" id="GUID-E00A2653-462B-4158-B2B1-90348E19D0CB__GUID-5C33433C-8166-4DC8-91D5-AC41382F9B25">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="aq-messaging-gateway-views.html#GUID-E0673077-05DC-41AC-B796-DC408DBE8C7F" title="V $ AQ视图提供有关整个数据库的不同状态的消息数的信息。">V $ AQ：数据库中不同状态的消息数</a> ”</span></p>
                     </div>
                  </div>
               </div>
            </div><a id="ADQUE2875"></a><div class="props_rev_3"><a id="GUID-555A7DAB-4117-4B7F-9A68-3716C83F9F7C" name="GUID-555A7DAB-4117-4B7F-9A68-3716C83F9F7C"></a><h3 id="ADQUE-GUID-555A7DAB-4117-4B7F-9A68-3716C83F9F7C" class="sect3"><span class="enumeration_section">11.2</span> JMS中的结构化有效载荷/消息类型</h3>
               <div>
                  <p>JMS消息由标题，属性和正文组成。</p>
                  <p>标头由标头字段组成，标头字段包含客户端和提供程序用于标识和路由消息的值。所有消息都支持同一组头字段。</p>
                  <p>属性是可选的标题字段。除了JMS定义的标准属性外，还可以提供特定于提供程序的属性和特定于应用程序的属性。</p>
                  <p>正文是消息有效负载。JMS定义了各种类型的消息有效负载，以及可以存储任何或所有JMS指定消息类型的JMS消息的类型。</p>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="jms-introduction.html#GUID-ECCD89DD-CDB3-4455-AA9E-28ABA53488FC">JMS消息头</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-2A32B19E-DA83-4BF9-80CF-EAB04B08CD66">JMS消息属性</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-E857403A-614C-41D3-9F72-0B5D5D8698F7">JMS消息体</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-4119D22E-DA5F-4842-862D-01935994548B">使用具有不同消息类型的消息属性</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B">使用Oracle JMS缓冲消息传递</a></p>
                     </li>
                  </ul>
               </div><a id="ADQUE2876"></a><div class="props_rev_3"><a id="GUID-ECCD89DD-CDB3-4455-AA9E-28ABA53488FC" name="GUID-ECCD89DD-CDB3-4455-AA9E-28ABA53488FC"></a><h4 id="ADQUE-GUID-ECCD89DD-CDB3-4455-AA9E-28ABA53488FC" class="sect4"><span class="enumeration_section">11.2.1</span> JMS消息头</h4>
                  <div>
                     <p>JMS消息头包含以下字段：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">JMSDestination</code> 
                           </p>
                           <p>该字段包含消息发送到的目标。在Oracle数据库高级队列中，这对应于目标队列/主题。它是<code class="codeph">Send</code>方法完成后由JMS设置的<code class="codeph">Destination</code>类型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSDeliveryMode</code> 
                           </p>
                           <p>此字段确定是否记录消息。JMS支持<code class="codeph">PERSISTENT</code>传递（消息记录到稳定存储）和<code class="codeph">NONPERSISTENT</code>传递（未记录消息）。在<code class="codeph">Send</code>方法完成后，它是由JMS设置的<code class="codeph">INTEGER</code> 。JMS允许管理员配置JMS以覆盖<code class="codeph">JMSDeliveryMode</code>的客户端指定值。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSMessageID按</code> 
                           </p>
                           <p>该字段唯一标识提供者中的消息。所有消息ID必须以字符串<code class="codeph">ID:</code>开头<code class="codeph">ID:</code> 。它是<code class="codeph">Send</code>方法完成后由JMS设置的<code class="codeph">String</code>类型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSTimeStamp</code></p>
                           <p>此字段包含将消息移交给要发送的提供程序的时间。这将映射到Oracle数据库高级队列消息排队时间。它是<code class="codeph">Send</code>方法完成后由JMS设置的<code class="codeph">Long</code>类型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSCorrelationID</code></p>
                           <p>客户端可以使用此字段将一条消息与另一条消息相链接。它是由JMS客户端设置的<code class="codeph">String</code>类型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSReplyTo</code></p>
                           <p>此字段包含客户端在发送邮件时提供的<code class="codeph">Destination</code>类型。客户端可以使用<code class="codeph">oracle.jms.AQjmsAgent</code> ; <code class="codeph">javax.jms.Queue</code> ;或者<code class="codeph">javax.jms.Topic</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">的JMSType</code></p>
                           <p>该字段包含客户端在发送时提供的消息类型标识符。它是一种<code class="codeph">String</code>类型。为了便于移植，Oracle建议<code class="codeph">JMSType</code>为符号值。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSExpiration</code></p>
                           <p>此字段是非Java EE合规性模式中的入队时间和<code class="codeph">TimeToLive</code>的总和。在兼容模式下，出列消息中的<code class="codeph">JMSExpiration</code>标头值是消息入<code class="codeph">JMSTimeStamp</code>时的<code class="codeph">JMSTimeStamp</code> （格林威治标准时间，以毫秒为单位）和<code class="codeph">TimeToLive</code> （以毫秒为单位）的总和。它是<code class="codeph">Send</code>方法完成后由JMS设置的<code class="codeph">Long</code>类型。JMS允许管理员配置JMS以覆盖<code class="codeph">JMSExpiration</code>的客户端指定值。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSPriority</code></p>
                           <p>该字段包含消息的优先级。在<code class="codeph">Send</code>方法完成后，它是由JMS设置的<code class="codeph">INTEGER</code> 。在Java EE兼容模式下，优先级的允许值为<code class="codeph">0</code> - <code class="codeph">9</code> ，其中<code class="codeph">9</code>为最高优先级， <code class="codeph">4</code>为默认值，符合Sun Microsystem JMS 1.1标准。不合规模式是默认模式。JMS允许管理员配置JMS以覆盖<code class="codeph">JMSPriority</code>的客户端指定值。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSRedelivered</code> 
                           </p>
                           <p>此字段是JMS提供程序设置的布尔值。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-ECCD89DD-CDB3-4455-AA9E-28ABA53488FC__GUID-591DB427-9906-445C-A5BC-118577B9FDEA">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="jms-introduction.html#GUID-7D8D9257-574D-4378-B580-DA656D2F0511">Java EE合规性</a> ”</span></p>
                     </div>
                  </div>
               </div><a id="ADQUE2877"></a><div class="props_rev_3"><a id="GUID-2A32B19E-DA83-4BF9-80CF-EAB04B08CD66" name="GUID-2A32B19E-DA83-4BF9-80CF-EAB04B08CD66"></a><h4 id="ADQUE-GUID-2A32B19E-DA83-4BF9-80CF-EAB04B08CD66" class="sect4"><span class="enumeration_section">11.2.2</span> JMS消息属性</h4>
                  <div>
                     <p>JMS属性由客户端显式设置或由JMS提供程序自动设置（这些通常是只读的）。使用“ <code class="codeph">Send</code>和“ <code class="codeph">Receive</code>操作中指定的参数设置某些JMS属性。
                     </p>
                     <p>属性将可选的标头字段添加到消息中。属性允许客户端使用<code class="codeph">messageSelector</code>让JMS提供程序使用特定于应用程序的条件代表它选择消息。属性名称是字符串，值可以是： <code class="codeph">Boolean</code> ， <code class="codeph">byte</code> ， <code class="codeph">short</code> ， <code class="codeph">int</code> ， <code class="codeph">long</code> ， <code class="codeph">float</code> ， <code class="codeph">double</code>和<code class="codeph">string</code> 。
                     </p>
                     <p>JMS定义的属性都以<code class="codeph">"JMSX"</code>开头，包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">JMSXUserID</code></p>
                           <p>该字段是发送消息的用户的标识。它是<code class="codeph">Send</code>方法完成后由JMS设置的<code class="codeph">String</code>类型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSXAppID</code></p>
                           <p>该字段是发送消息的应用程序的标识。它是<code class="codeph">Send</code>方法完成后由JMS设置的<code class="codeph">String</code>类型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSXDeliveryCount</code></p>
                           <p>此字段是邮件传递尝试的数量。它是<code class="codeph">Send</code>方法完成后由JMS设置的<code class="codeph">Integer</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">的JMSXGroupID</code></p>
                           <p>此字段是此消息所属的消息组的标识。它是由JMS客户端设置的<code class="codeph">String</code>类型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">了JMSXGroupSeq</code></p>
                           <p>该字段是组内消息的序列号。它是由JMS客户端设置的<code class="codeph">Integer</code> 。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSXRcvTimeStamp</code></p>
                           <p>该字段是消息传递给消费者的时间（出队时间）。它是在<code class="codeph">Receive</code>方法完成后由JMS设置的<code class="codeph">String</code>类型。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSXState</code></p>
                           <p>此字段是由提供程序设置的消息状态。消息状态可以是<code class="codeph">WAITING</code> ， <code class="codeph">READY</code> ， <code class="codeph">EXPIRED</code>或<code class="codeph">RETAINED</code> 。</p>
                        </li>
                     </ul>
                     <p>特定于Oracle的JMS属性（ <code class="codeph">JMS_Oracle</code> ）包括以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">JMS_OracleExcpQ</code></p>
                           <p>如果无法将消息传递到原始目标，则此字段是发送消息的队列名称。它是由JMS客户端设置的<code class="codeph">String</code>类型。只能在<code class="codeph">JMS_OracleExcpQ</code>属性中指定类型为<code class="codeph">EXCEPTION</code>目标。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMS_OracleDelay</code></p>
                           <p>此字段是延迟传递邮件的时间（以秒为单位）。它是由JMS客户端设置的<code class="codeph">Integer</code> 。这可能会影响邮件传递的顺序。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMS_OracleOriginalMessageId</code></p>
                           <p>如果消息从一个目的地传播到另一个目的地，则此字段设置为源中消息的消息标识符。它是由JMS提供程序设置的<code class="codeph">String</code>类型。如果未传播消息，则此属性与<code class="codeph">JMSMessageId</code>具有相同的值。
                           </p>
                        </li>
                     </ul>
                     <p>客户端可以通过定义属性向消息添加其他标头字段。然后可以在<code class="codeph">messageSelector</code>使用这些属性来选择特定的消息。
                     </p>
                  </div>
               </div><a id="ADQUE2878"></a><div class="props_rev_3"><a id="GUID-E857403A-614C-41D3-9F72-0B5D5D8698F7" name="GUID-E857403A-614C-41D3-9F72-0B5D5D8698F7"></a><h4 id="ADQUE-GUID-E857403A-614C-41D3-9F72-0B5D5D8698F7" class="sect4"><span class="enumeration_section">11.2.3</span> JMS消息体</h4>
                  <div>
                     <p>JMS提供了五种形式的消息体：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="jms-introduction.html#GUID-D10737AD-7143-4A27-8BE2-E8E931F63C7D">StreamMessage</a></p>
                        </li>
                        <li>
                           <p><a href="jms-introduction.html#GUID-5465D000-FF48-4244-A404-E9F51BB7F847">BytesMessage</a></p>
                        </li>
                        <li>
                           <p><a href="jms-introduction.html#GUID-54C9B48C-99B0-46B1-A647-796F1A874A23">MapMessage消息</a></p>
                        </li>
                        <li>
                           <p><a href="jms-introduction.html#GUID-95727DD7-873B-4B3D-8933-BA0A15F42CD3">TextMessage的</a></p>
                        </li>
                        <li>
                           <p><a href="jms-introduction.html#GUID-689A3D3E-8019-4CBD-AD32-87F2D0CC2B3C">ObjectMessage</a></p>
                        </li>
                        <li>
                           <p><a href="jms-introduction.html#GUID-D6751C95-0290-47AF-B7C8-7D77E3AF6FC9">AdtMessage</a></p>
                        </li>
                     </ul>
                  </div><a id="ADQUE2880"></a><a id="ADQUE2879"></a><div class="props_rev_3"><a id="GUID-D10737AD-7143-4A27-8BE2-E8E931F63C7D" name="GUID-D10737AD-7143-4A27-8BE2-E8E931F63C7D"></a><h5 id="ADQUE-GUID-D10737AD-7143-4A27-8BE2-E8E931F63C7D" class="sect5"><span class="enumeration_section">11.2.3.1</span> StreamMessage</h5>
                     <div>
                        <p><code class="codeph">StreamMessage</code>对象用于发送Java原语流。它按顺序填充和读取。它继承自<code class="codeph">Message</code>并添加了一个<code class="codeph">StreamMessage</code>主体。它的方法主要基于java.io中的<code class="codeph">java.io.DataInputStream</code>和<code class="codeph">java.io.DataOutputStream</code> 。
                        </p>
                        <p>可以使用每种类型的方法显式读取或写入基元类型。它们也可以作为对象一般地读取或写入。要使用<code class="codeph">StreamMessage</code>对象，请使用<code class="codeph">SYS.AQ$_JMS_STREAM_MESSAGE</code>或<code class="codeph">AQ$_JMS_MESSAGE</code>有效内容类型创建队列表。
                        </p>
                        <p><code class="codeph">StreamMessage</code>对象支持<a href="jms-introduction.html#GUID-D10737AD-7143-4A27-8BE2-E8E931F63C7D__CACEJAJJ" title="行是输入消息类型，列是输出消息类型。一个" type="" ="=" ="=" ="">表11-1中</a>显示的转换。写入行类型的值可以作为列类型读取。
                        </p>
                        <div class="tblformalwide" id="GUID-D10737AD-7143-4A27-8BE2-E8E931F63C7D__CACEJAJJ">
                           <p class="titleintable">表11-1 StreamMessage转换</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="StreamMessage转换" type="" width="100%" border="1" summary="Rows are input message types, and columns are output message types. An " ="=" ="=" ="" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="11%" id="d64698e2680">输入</th>
                                    <th align="left" valign="bottom" width="10%" id="d64698e2683">布尔</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e2686">字节</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e2689">短</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e2692">烧焦</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e2695">INT</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e2698">长</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e2701">浮动</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e2704">双</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e2707">串</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e2710">字节[]</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e2715" headers="d64698e2680 ">
                                       <p><code class="codeph">布尔</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e2715 d64698e2683 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2715 d64698e2686 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2715 d64698e2689 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2715 d64698e2692 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2715 d64698e2695 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2715 d64698e2698 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2715 d64698e2701 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2715 d64698e2704 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2715 d64698e2707 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2715 d64698e2710 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e2751" headers="d64698e2680 ">
                                       <p><code class="codeph">字节</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e2751 d64698e2683 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2751 d64698e2686 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2751 d64698e2689 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2751 d64698e2692 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2751 d64698e2695 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2751 d64698e2698 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2751 d64698e2701 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2751 d64698e2704 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2751 d64698e2707 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2751 d64698e2710 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e2787" headers="d64698e2680 ">
                                       <p><code class="codeph">短</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e2787 d64698e2683 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2787 d64698e2686 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2787 d64698e2689 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2787 d64698e2692 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2787 d64698e2695 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2787 d64698e2698 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2787 d64698e2701 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2787 d64698e2704 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2787 d64698e2707 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2787 d64698e2710 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e2823" headers="d64698e2680 ">
                                       <p><code class="codeph">烧焦</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e2823 d64698e2683 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2823 d64698e2686 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2823 d64698e2689 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2823 d64698e2692 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2823 d64698e2695 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2823 d64698e2698 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2823 d64698e2701 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2823 d64698e2704 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2823 d64698e2707 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2823 d64698e2710 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e2859" headers="d64698e2680 ">
                                       <p><code class="codeph">INT</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e2859 d64698e2683 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2859 d64698e2686 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2859 d64698e2689 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2859 d64698e2692 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2859 d64698e2695 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2859 d64698e2698 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2859 d64698e2701 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2859 d64698e2704 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2859 d64698e2707 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2859 d64698e2710 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e2895" headers="d64698e2680 ">
                                       <p><code class="codeph">长</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e2895 d64698e2683 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2895 d64698e2686 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2895 d64698e2689 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2895 d64698e2692 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2895 d64698e2695 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2895 d64698e2698 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2895 d64698e2701 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2895 d64698e2704 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2895 d64698e2707 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2895 d64698e2710 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e2931" headers="d64698e2680 ">
                                       <p><code class="codeph">浮动</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e2931 d64698e2683 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2931 d64698e2686 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2931 d64698e2689 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2931 d64698e2692 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2931 d64698e2695 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2931 d64698e2698 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2931 d64698e2701 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2931 d64698e2704 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2931 d64698e2707 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2931 d64698e2710 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e2967" headers="d64698e2680 ">
                                       <p><code class="codeph">双</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e2967 d64698e2683 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2967 d64698e2686 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2967 d64698e2689 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2967 d64698e2692 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2967 d64698e2695 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2967 d64698e2698 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2967 d64698e2701 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2967 d64698e2704 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2967 d64698e2707 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e2967 d64698e2710 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3003" headers="d64698e2680 ">
                                       <p><code class="codeph">串</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3003 d64698e2683 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3003 d64698e2686 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3003 d64698e2689 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3003 d64698e2692 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3003 d64698e2695 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3003 d64698e2698 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3003 d64698e2701 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3003 d64698e2704 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3003 d64698e2707 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3003 d64698e2710 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3039" headers="d64698e2680 ">
                                       <p><code class="codeph">字节[]</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3039 d64698e2683 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3039 d64698e2686 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3039 d64698e2689 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3039 d64698e2692 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3039 d64698e2695 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3039 d64698e2698 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3039 d64698e2701 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3039 d64698e2704 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3039 d64698e2707 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3039 d64698e2710 ">
                                       <p>X</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div><a id="ADQUE2881"></a><div class="props_rev_3"><a id="GUID-5465D000-FF48-4244-A404-E9F51BB7F847" name="GUID-5465D000-FF48-4244-A404-E9F51BB7F847"></a><h5 id="ADQUE-GUID-5465D000-FF48-4244-A404-E9F51BB7F847" class="sect5"><span class="enumeration_section">11.2.3.2</span> BytesMessage</h5>
                     <div>
                        <p><code class="codeph">BytesMessage</code>对象用于发送包含未解释字节流的消息。它继承<code class="codeph">Message</code>并添加<code class="codeph">BytesMessage</code>主体。消息的接收者解释字节。它的方法主要基于java.io中的<code class="codeph">java.io.DataInputStream</code>和<code class="codeph">java.io.DataOutputStream</code> 。
                        </p>
                        <p>此消息类型用于现有消息格式的客户端编码。如果可能，应该使用其他自定义消息类型之一。</p>
                        <p>可以使用每种类型的方法显式写入基元类型。它们也可以一般地写为对象。要使用<code class="codeph">BytesMessage</code>对象，创建与队列表<code class="codeph">SYS.AQ$_JMS_BYTES_MESSAGE</code>或<code class="codeph">AQ$_JMS_MESSAGE</code>负载类型。
                        </p>
                     </div>
                  </div><a id="ADQUE2883"></a><a id="ADQUE2882"></a><div class="props_rev_3"><a id="GUID-54C9B48C-99B0-46B1-A647-796F1A874A23" name="GUID-54C9B48C-99B0-46B1-A647-796F1A874A23"></a><h5 id="ADQUE-GUID-54C9B48C-99B0-46B1-A647-796F1A874A23" class="sect5"><span class="enumeration_section">11.2.3.3</span> MapMessage</h5>
                     <div>
                        <p><code class="codeph">MapMessage</code>对象用于发送一组名称 - 值对，其中名称是<code class="codeph">String</code>类型，值是Java基元类型。可以按顺序或按名称随机访问条目。条目的顺序未定义。它继承自<code class="codeph">Message</code>并添加了<code class="codeph">MapMessage</code>主体。可以使用每种类型的方法显式读取或写入基元类型。它们也可以作为对象一般地读取或写入。
                        </p>
                        <p>要使用<code class="codeph">MapMessage</code>对象，请使用<code class="codeph">SYS.AQ$_JMS_MAP_MESSAGE</code>或<code class="codeph">AQ$_JMS_MESSAGE</code>有效内容类型创建队列表。<code class="codeph">MapMessage</code>对象支持<a href="jms-introduction.html#GUID-54C9B48C-99B0-46B1-A647-796F1A874A23__CACBFIDD" title="行是输入消息类型，列是输出消息类型。一个" type="" ="=" ="=" ="">表11-2中</a>显示的转换。表中的“X”表示作为行类型写入的值可以作为列类型读取。
                        </p>
                        <div class="tblformalwide" id="GUID-54C9B48C-99B0-46B1-A647-796F1A874A23__CACBFIDD">
                           <p class="titleintable">表11-2 MapMessage转换</p>
                           <table cellpadding="4" cellspacing="0" class="FormalWide" title="MapMessage转换" type="" width="100%" border="1" summary="Rows are input message types, and columns are output message types. An " ="=" ="=" ="" frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="11%" id="d64698e3265">输入</th>
                                    <th align="left" valign="bottom" width="10%" id="d64698e3268">布尔</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e3271">字节</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e3274">短</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e3277">烧焦</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e3280">INT</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e3283">长</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e3286">浮动</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e3289">双</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e3292">串</th>
                                    <th align="left" valign="bottom" width="9%" id="d64698e3295">字节[]</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3300" headers="d64698e3265 ">
                                       <p><code class="codeph">布尔</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3300 d64698e3268 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3300 d64698e3271 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3300 d64698e3274 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3300 d64698e3277 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3300 d64698e3280 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3300 d64698e3283 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3300 d64698e3286 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3300 d64698e3289 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3300 d64698e3292 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3300 d64698e3295 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3336" headers="d64698e3265 ">
                                       <p><code class="codeph">字节</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3336 d64698e3268 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3336 d64698e3271 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3336 d64698e3274 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3336 d64698e3277 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3336 d64698e3280 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3336 d64698e3283 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3336 d64698e3286 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3336 d64698e3289 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3336 d64698e3292 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3336 d64698e3295 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3372" headers="d64698e3265 ">
                                       <p><code class="codeph">短</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3372 d64698e3268 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3372 d64698e3271 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3372 d64698e3274 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3372 d64698e3277 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3372 d64698e3280 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3372 d64698e3283 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3372 d64698e3286 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3372 d64698e3289 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3372 d64698e3292 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3372 d64698e3295 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3408" headers="d64698e3265 ">
                                       <p><code class="codeph">烧焦</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3408 d64698e3268 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3408 d64698e3271 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3408 d64698e3274 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3408 d64698e3277 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3408 d64698e3280 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3408 d64698e3283 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3408 d64698e3286 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3408 d64698e3289 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3408 d64698e3292 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3408 d64698e3295 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3444" headers="d64698e3265 ">
                                       <p><code class="codeph">INT</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3444 d64698e3268 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3444 d64698e3271 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3444 d64698e3274 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3444 d64698e3277 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3444 d64698e3280 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3444 d64698e3283 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3444 d64698e3286 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3444 d64698e3289 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3444 d64698e3292 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3444 d64698e3295 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3480" headers="d64698e3265 ">
                                       <p><code class="codeph">长</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3480 d64698e3268 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3480 d64698e3271 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3480 d64698e3274 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3480 d64698e3277 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3480 d64698e3280 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3480 d64698e3283 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3480 d64698e3286 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3480 d64698e3289 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3480 d64698e3292 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3480 d64698e3295 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3516" headers="d64698e3265 ">
                                       <p><code class="codeph">浮动</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3516 d64698e3268 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3516 d64698e3271 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3516 d64698e3274 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3516 d64698e3277 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3516 d64698e3280 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3516 d64698e3283 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3516 d64698e3286 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3516 d64698e3289 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3516 d64698e3292 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3516 d64698e3295 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3552" headers="d64698e3265 ">
                                       <p><code class="codeph">双</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3552 d64698e3268 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3552 d64698e3271 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3552 d64698e3274 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3552 d64698e3277 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3552 d64698e3280 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3552 d64698e3283 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3552 d64698e3286 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3552 d64698e3289 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3552 d64698e3292 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3552 d64698e3295 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3588" headers="d64698e3265 ">
                                       <p><code class="codeph">串</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3588 d64698e3268 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3588 d64698e3271 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3588 d64698e3274 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3588 d64698e3277 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3588 d64698e3280 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3588 d64698e3283 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3588 d64698e3286 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3588 d64698e3289 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3588 d64698e3292 ">
                                       <p>X</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3588 d64698e3295 ">
                                       <p>-</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="11%" id="d64698e3624" headers="d64698e3265 ">
                                       <p><code class="codeph">字节[]</code> 
                                       </p>
                                    </td>
                                    <td align="left" valign="top" width="10%" headers="d64698e3624 d64698e3268 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3624 d64698e3271 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3624 d64698e3274 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3624 d64698e3277 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3624 d64698e3280 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3624 d64698e3283 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3624 d64698e3286 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3624 d64698e3289 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3624 d64698e3292 ">
                                       <p>-</p>
                                    </td>
                                    <td align="left" valign="top" width="9%" headers="d64698e3624 d64698e3295 ">
                                       <p>X</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div><a id="ADQUE2884"></a><div class="props_rev_3"><a id="GUID-95727DD7-873B-4B3D-8933-BA0A15F42CD3" name="GUID-95727DD7-873B-4B3D-8933-BA0A15F42CD3"></a><h5 id="ADQUE-GUID-95727DD7-873B-4B3D-8933-BA0A15F42CD3" class="sect5"><span class="enumeration_section">11.2.3.4</span> TextMessage</h5>
                     <div>
                        <p><code class="codeph">TextMessage</code>对象用于发送包含<code class="codeph">java.lang.的消息<code class="codeph">java.lang.StringBuffer</code> 。它继承自<code class="codeph">Message</code>并添加<code class="codeph">TextMessage</code>主体。可以使用<code class="codeph">getText()</code>和<code class="codeph">setText(</code> ... <code class="codeph">)</code>方法读取或写入文本信息。要使用<code class="codeph">TextMessage</code>对象，请使用<code class="codeph">SYS.AQ$_JMS_TEXT_MESSAGE</code>或<code class="codeph">AQ$_JMS_MESSAGE</code>有效内容类型创建队列表。
                        </p>
                     </div>
                  </div><a id="ADQUE2885"></a><div class="props_rev_3"><a id="GUID-689A3D3E-8019-4CBD-AD32-87F2D0CC2B3C" name="GUID-689A3D3E-8019-4CBD-AD32-87F2D0CC2B3C"></a><h5 id="ADQUE-GUID-689A3D3E-8019-4CBD-AD32-87F2D0CC2B3C" class="sect5"><span class="enumeration_section">11.2.3.5</span> ObjectMessage</h5>
                     <div>
                        <p><code class="codeph">ObjectMessage</code>对象用于发送包含可序列化Java对象的消息。它继承自Message并添加包含单个Java引用的主体。只能使用可序列化的Java对象。如果必须发送Java对象集合，则可以使用JDK 1.4中提供的集合类之一。可以使用<code class="codeph">getObject()</code>和<code class="codeph">setObject(</code> ... <code class="codeph">)</code>方法读取或写入对象。要使用<code class="codeph">ObjectMessage</code>对象，创建与队列表<code class="codeph">SYS.AQ$_JMS_OBJECT_MESSAGE</code>或<code class="codeph">AQ$_JMS_MESSAGE</code>负载类型。
                        </p>
                     </div>
                  </div><a id="ADQUE2886"></a><div class="props_rev_3"><a id="GUID-D6751C95-0290-47AF-B7C8-7D77E3AF6FC9" name="GUID-D6751C95-0290-47AF-B7C8-7D77E3AF6FC9"></a><h5 id="ADQUE-GUID-D6751C95-0290-47AF-B7C8-7D77E3AF6FC9" class="sect5"><span class="enumeration_section">11.2.3.6</span> AdtMessage</h5>
                     <div>
                        <p><code class="codeph">AdtMessage</code>对象用于发送包含映射到Oracle对象类型的Java对象的消息。这些对象继承自<code class="codeph">Message</code>并添加包含实现<code class="codeph">CustomDatum</code>或<code class="codeph">ORAData</code>接口的Java对象的主体。
                        </p>
                        <p>要使用<code class="codeph">AdtMessage</code>对象，请创建具有有效内容类型作为Oracle对象类型的队列表。可以使用<code class="codeph">getAdtPayload</code>和<code class="codeph">setAdtPayload</code>方法读取和写入<code class="codeph">AdtMessage</code>有效内容。
                        </p>
                        <p>您还可以使用<code class="codeph">AdtMessage</code>对象将消息发送到<code class="codeph">SYS.XMLType</code>类型的队列。您必须使用<code class="codeph">oracle.xdb.用于创建消息的XMLType</code>类。
                        </p>
                        <p>对于<code class="codeph">AdtMessage</code>对象，客户端可以获得：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">JMSXDeliveryCount</code> 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">JMSXRecvTimeStamp</code> 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">JMSXState</code> 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">JMS_OracleExcpQ</code> 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">JMS_OracleDelay</code> 
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-D6751C95-0290-47AF-B7C8-7D77E3AF6FC9__GUID-E4986693-AA7F-43AC-AB0A-279AA466134D">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">CustomDatum</code>和<code class="codeph">ORAData</code>接口的信息，请<code class="codeph">ORAData</code> <a href="../jjdev/Java-overview.html#JJDEV01100" target="_blank"><span class="italic">“Oracle数据库Java开发人员指南”</span></a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="ADQUE2887"></a><div class="props_rev_3"><a id="GUID-4119D22E-DA5F-4842-862D-01935994548B" name="GUID-4119D22E-DA5F-4842-862D-01935994548B"></a><h4 id="ADQUE-GUID-4119D22E-DA5F-4842-862D-01935994548B" class="sect4"><span class="enumeration_section">11.2.4</span>使用具有不同消息类型的消息属性</h4>
                  <div>
                     <p>客户端可以使用<code class="codeph">setProperty</code>调用设置以下消息属性。对于<code class="codeph">StreamMessage</code> ， <code class="codeph">BytesMessage</code> ， <code class="codeph">ObjectMessage</code> ， <code class="codeph">TextMessage</code>和<code class="codeph">MapMessage</code>对象，客户端可以设置：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">JMSXAppID</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">的JMSXGroupID</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">了JMSXGroupSeq</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMS_OracleExcpQ</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMS_OracleDelay</code> 
                           </p>
                        </li>
                     </ul>
                     <p>对于<code class="codeph">AdtMessage</code>对象，客户端可以设置：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">JMS_OracleExcpQ</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMS_OracleDelay</code> 
                           </p>
                        </li>
                     </ul>
                     <p>客户端可以使用<code class="codeph">getProperty</code>调用获取以下消息属性。对于<code class="codeph">StreamMessage</code> ， <code class="codeph">BytesMessage</code> ， <code class="codeph">ObjectMessage</code> ， <code class="codeph">TextMessage</code>和<code class="codeph">MapMessage</code>对象，客户端可以获得：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">JMSXuserID</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSXAppID</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSXDeliveryCount</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">的JMSXGroupID</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">了JMSXGroupSeq</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSXRecvTimeStamp</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMSXState</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMS_OracleExcpQ</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMS_OracleDelay</code> 
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">JMS_OracleOriginalMessageID</code> 
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADQUE2889"></a><a id="ADQUE2890"></a><a id="ADQUE2891"></a><a id="ADQUE2892"></a><a id="ADQUE2893"></a><a id="ADQUE2888"></a><div class="props_rev_3"><a id="GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B" name="GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B"></a><h4 id="ADQUE-GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B" class="sect4"><span class="enumeration_section">11.2.5</span>使用Oracle JMS进行缓冲消息传递</h4>
                  <div>
                     <p>用户可以通过在发送消息时将<code class="codeph">deliveryMode</code>指定为<code class="codeph">NON_PERSISTENT</code>来发送非持久性JMS消息。JMS非持久消息不需要记录到稳定存储，因此在JMS系统发生故障后它们可能会丢失。JMS非持久消息类似于Oracle Database Advanced Queuing中可用的缓冲消息，但两者之间也存在重要差异。
                     </p>
                     <div class="infoboxnote" id="GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B__GUID-2DF95CA4-FD4C-4DF9-82BD-1911DAA02EB5">
                        <p class="notep1">注意：</p>
                        <p>不要将Oracle JMS非持久消息与Oracle数据库高级队列非持久队列混淆，Oracle数据库<span class="italic">10g</span>第2版（10.2）中不推荐使用这些队列。
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B__GUID-9C719FBC-2EE2-425D-80D2-ADE55D113A52">
                        <p class="notep1">也可以看看：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27" title="缓冲消息传递结合了该产品始终提供的丰富功能和更快的排队实现。缓冲消息传递非常适合不需要Oracle数据库高级队列持久消息传递的可靠性和事务支持的应用程序。">缓冲消息</a> ”</span></p>
                           </li>
                           <li>
                              <p><a href="non-persistent-queues.html#GUID-53FA8763-D0CA-4EE4-A3B2-606CE01AE702">非持久性队列</a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B__GUID-A2B1DE41-4F6B-4ADE-B371-96251A3AB8E5">交易提交和客户确认</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>JMS <code class="codeph">deliveryMode</code>与消息的事务属性正交。JMS非持久消息可以由事务会话或非事务会话发送和接收。如果事务会话发送和接收JMS非持久消息，则JMS操作的效果仅在事务会话提交后才可见。如果它是由具有<code class="codeph">CLIENT_ACKNOWLEDGE</code>确认模式的非事务会话接收的，则只有在客户端确认消息后才能看到接收此消息的效果。如果没有确认，则不会删除该消息，并且如果客户端调用<code class="codeph">Session.recover</code> ，则将重新传递该消息。
                        </p>
                        <p>但是，Oracle数据库高级队列缓冲消息不支持这些事务或确认概念。发送和接收缓冲消息都必须处于<code class="codeph">IMMEDIATE</code>可见性模式。因此，无论是提交会话还是确认消息，用户都可以立即看到发送和接收操作的效果。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B__GUID-F534C745-B00B-4F40-B3B4-C4BA2C647469">不同的API</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>使用常规JMS发送和发布方法发送的消息将被Oracle数据库高级队列视为持久消息。常规JMS接收方法仅接收AQ持久性消息。要发送和接收缓冲消息，必须使用Oracle扩展API <code class="codeph">bufferSend</code> ， <code class="codeph">bufferPublish</code>和<code class="codeph">bufferReceive</code> 。
                        </p>
                        <div class="infoboxnotealso" id="GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B__GUID-27E5C783-A539-4CEB-83B9-CC01A2AD535D">
                           <p class="notep1">也可以看看：</p>
                           <p>有关<code class="codeph">bufferSend</code> ， <code class="codeph">bufferPublish</code>和<code class="codeph">bufferReceive</code>更多信息，请<code class="codeph">bufferSend</code> <a href="../jajms/index.html" target="_blank"><span class="italic">Oracle Database Advanced Queuing Java API Reference</span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B__GUID-52641433-C2D5-424D-9D54-698D59EEB46A">有效载荷限制</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>缓冲消息的Oracle数据库高级队列实现不支持<code class="codeph">LOB</code>属性。这限制了五种标准JMS消息的有效负载：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>JMS <code class="codeph">TextMessage</code>有效负载不能超过4000个字节。
                              </p>
                              <p>对于某些数据库字符集，此限制可能更低，因为在Oracle JMS字符集转换期间，Oracle JMS有时必须保守选择使用<code class="codeph">CLOB</code>而不是<code class="codeph">VARCHAR</code>将文本有效负载存储在数据库中。
                              </p>
                           </li>
                           <li>
                              <p>JMS <code class="codeph">BytesMessage</code>有效负载不能超过2000个字节。
                              </p>
                           </li>
                           <li>
                              <p>JAVA序列化的JMS <code class="codeph">ObjectMessage</code> ， <code class="codeph">StreamMessage</code>和<code class="codeph">MapMessage</code>数据不能超过2000个字节。
                              </p>
                           </li>
                           <li>
                              <p>对于所有其他Oracle JMS ADT消息，相应的Oracle数据库ADT不能包含<code class="codeph">LOB</code>属性。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B__GUID-0AD913F0-DC4D-4522-B51B-43F14447C3C6">不同的常数</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Oracle数据库高级队列和Oracle JMS API使用不同的数值来指定缓冲和持久消息，如<a href="jms-introduction.html#GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B__CIAHFDBG" title="此表显示了Oracle Streams AQ和Oracle JMS的缓冲消息传递常量。第一列是API，第二列是持久常量，第三列是缓冲常量。">表11-3</a>所示。
                        </p>
                        <div class="tblformal" id="GUID-FA74C4F3-7F5C-47A2-B2AE-472640EB799B__CIAHFDBG">
                           <p class="titleintable">表11-3 Oracle数据库AQ和Oracle JMS缓冲消息传递常量</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Oracle数据库AQ和Oracle JMS缓冲消息传递常量" width="100%" border="1" summary="This table shows buffered messaging constants for Oracle Streams AQ and Oracle JMS. The first column is the API, the second column is the persistent constant, and the third column is the buffered constant." frame="hsides" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="29%" id="d64698e4356">API</th>
                                    <th align="left" valign="bottom" width="35%" id="d64698e4359">持久的消息</th>
                                    <th align="left" valign="bottom" width="36%" id="d64698e4362">缓冲消息</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="29%" id="d64698e4367" headers="d64698e4356 ">
                                       <p>Oracle数据库高级队列</p>
                                    </td>
                                    <td align="left" valign="top" width="35%" headers="d64698e4367 d64698e4359 ">
                                       <p><code class="codeph">持久性：= 1</code></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d64698e4367 d64698e4362 ">
                                       <p><code class="codeph">BUFFERED：= 2</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="29%" id="d64698e4379" headers="d64698e4356 ">
                                       <p>Oracle JMS</p>
                                    </td>
                                    <td align="left" valign="top" width="35%" headers="d64698e4379 d64698e4359 ">
                                       <p><code class="codeph">PERSISTENT：= 2</code></p>
                                    </td>
                                    <td align="left" valign="top" width="36%" headers="d64698e4379 d64698e4362 ">
                                       <p><code class="codeph">NON_PERSISTENT：= 1</code></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="ADQUE2895"></a><a id="ADQUE2896"></a><a id="ADQUE2897"></a><a id="ADQUE2898"></a><a id="ADQUE2899"></a><a id="ADQUE2900"></a><a id="ADQUE2894"></a><div class="props_rev_3"><a id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F" name="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F"></a><h3 id="ADQUE-GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F" class="sect3"><span class="enumeration_section">11.3</span> JMS中的缓冲消息传递</h3>
               <div>
                  <p>缓冲消息传递完全支持JMS消息传递标准。Oracle JMS以多种方式扩展了这些标准。</p>
                  <div class="infoboxnotealso" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-3F4E1FB2-9AB5-4CBB-97CA-A08831150C34">
                     <p class="notep1">也可以看看：</p>
                     <p><span class="q">“ <a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27" title="缓冲消息传递结合了该产品始终提供的丰富功能和更快的排队实现。缓冲消息传递非常适合不需要Oracle数据库高级队列持久消息传递的可靠性和事务支持的应用程序。">缓冲消息</a> ”</span></p>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-4B86B9BE-62CB-4F69-87F6-5170D47CFF5E">排队JMS缓冲消息</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle JMS允许应用程序通过为单个消息设置<code class="codeph">JMSDeliveryMode</code>来发送缓冲消息，因此持久性和缓冲消息可以排入同一JMS队列/主题。
                     </p>
                     <p>可以按排队时间，优先级或两者来排序Oracle JMS缓冲消息。排序不会扩展到消息类型。因此，例如，稍后发送的持久消息可以在先前发送的缓冲消息之前传递。Oracle JMS中的缓冲消息也支持到期。</p>
                     <div class="infoboxnotealso" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-D3F0EFB3-97D9-4610-841A-A151EBD8D1EB">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="jms-introduction.html#GUID-ECCD89DD-CDB3-4455-AA9E-28ABA53488FC">JMS消息标题</a> ”</span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-9AE99F99-B315-4DE8-8B89-D4A9951E1440">出列JMS缓冲消息</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>JMS不要求订阅者只声明对持久消息或缓冲消息的兴趣，因此JMS订阅者可能对这两种消息类型都感兴趣。</p>
                     <p>Oracle JMS支持<code class="codeph">JMSMessageID</code> ，消息头上的选择器和消息属性上的选择器快速有效地出列消息。Oracle JMS出列调用检查持久消息和缓冲消息。
                     </p>
                     <div class="infoboxnote" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-FADF08E1-F20E-4876-B898-C8D40C0EA425">
                        <p class="notep1">注意：</p>
                        <p>Oracle JMS持久性消息具有唯一的消息标识符。Oracle JMS缓冲消息标识符仅在队列/主题中是唯一的。</p>
                     </div>
                     <p>如果并发出列进程从与同一订户相同的队列中出列，则它们将跳过由其他进程锁定的消息。</p>
                     <div class="infoboxnotealso" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-BB94FD9F-25ED-4122-839A-4201CC49EB69">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="jms-introduction.html#GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA__CACBBCBJ">MessageSelector</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="jms-introduction.html#GUID-CC78CBF0-6A8B-4230-BE93-4C1BB778A08D">接收消息</a> ”</span></p>
                              <p></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-7FC71B2F-3726-4AFD-9CF7-60C6A34D8C24">交易支持</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>如果缓冲消息在事务会话中入队，则JMS需要对它们进行事务支持。Oracle JMS保证涉及缓冲消息的事务会话符合以下标准：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>原子性</p>
                           <p>Oracle JMS事务中的持久性和缓冲式消息都以原子方式提交或回滚。即使缓冲的消息被写入磁盘，就像涉及LOB的消息一样，回滚仍然会删除它们。</p>
                        </li>
                        <li>
                           <p>一致性</p>
                           <p>如果持久性和缓冲的消息传递操作在事务中交错，则所有Oracle JMS用户共享受影响的队列/主题的一致视图。在事务处理时排队的所有持久和缓冲消息都会变为可见。如果进程在事务中间结束，则撤消持久和缓冲的消息。Oracle JMS用户在事务中看到所有持久消息和缓冲消息，或者都看不到。</p>
                        </li>
                        <li>
                           <p>隔离</p>
                           <p>事务中的缓冲入队操作仅在提交事务之前对所有者事务可见。提交事务后，所有消费者都可以看到它。</p>
                        </li>
                     </ul>
                     <p>可以浏览由出列交易锁定的消息。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-03CE9C8E-2B7D-42CA-ACE4-DAB73CE8F090">确认邮件收据</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>为<code class="codeph">ack_mode</code>参数定义了三个值，用于确认非事务处理会话中的消息接收：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">DUPS_OK_ACKNOWLEDGE</code></p>
                           <p>在此模式下，允许重复的消息。</p>
                        </li>
                        <li>
                           <p><code class="codeph">AUTO_ACKNOWLEDGE</code></p>
                           <p>在此模式下，会话自动确认消息。</p>
                        </li>
                        <li>
                           <p><code class="codeph">CLIENT_ACKNOWLEDGE</code></p>
                           <p>在此模式下，客户端通过调用消息生成器确认方法显式确认消息。确认消息确认所有先前消耗的消息。</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-E770674B-B6DA-49AA-94B8-9693FE5708CE">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="jms-point-to-point.html#GUID-B555FE46-E029-4961-8AEE-DA8C3415C192">创建会话</a> ”</span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-5DEFD332-0470-4E04-8C07-F0A8A059B8B3">缓冲消息传递服务质量</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>JMS要求提供程序支持最多一次传送未传播的缓冲消息。如果禁用了缓冲消息的恢复，则Oracle JMS符合此标准。</p>
                     <p>当前的消息传播实现可以实现重复的消息传递。但这并不违反JMS标准，因为消息传播是Oracle JMS提供的扩展。</p>
                     <div class="infoboxnotealso" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-F2C49E0F-BC82-406E-9D0E-6CE3C8F632AC">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDHFACF">传播缓冲的消息</a> ”</span>以了解缓冲消息的重复传递的原因</p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-B4D5D0F7-FAD5-46EB-B2F7-C0E304D43FEB">JMS类型支持缓冲消息</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>Oracle JMS将JMS定义的类型映射到Oracle用户定义的类型，并创建这些用户定义类型的队列以存储JMS消息。其中一些类型具有LOB属性，无论消息是持久消息还是缓冲消息，Oracle JMS都会将其写入磁盘。</p>
                     <p>例如，JMS类型<code class="codeph">JMSTextMessage</code>的用户定义类型<code class="codeph">SYS.AQ$_JMS_TEXT_MESSAGE</code>在<code class="codeph">VARCHAR2</code>列中存储小于4k的文本字符串。但它有一个CLOB属性用于存储大于4k的文本字符串。
                     </p>
                     <p>由于JMS消息通常大于4k，因此Oracle JMS提供了一种新的ADT，允许将更大的消息存储在内存中。ADT的磁盘表示保持不变，但是几个<code class="codeph">VARCHAR2</code> / <code class="codeph">RAW</code>属性允许将大小高达100k的JMS消息存储在内存中。大于100k的消息仍可作为缓冲消息发布，但它们将写入磁盘。
                     </p>
                     <div class="infoboxnotealso" id="GUID-1110B630-581F-41FD-8EC2-CBEBCF75912F__GUID-5A49C4EC-E529-47C9-80A8-60BF6D164AC6">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="aq-introduction.html#GUID-E87DA98A-4188-4E5A-9984-7311F4C3BA27__CHDFICID">排队缓冲消息</a> ”</span></p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2902"></a><a id="ADQUE2903"></a><a id="ADQUE2904"></a><a id="ADQUE2905"></a><a id="ADQUE2901"></a><div class="props_rev_3"><a id="GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA" name="GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA"></a><h3 id="ADQUE-GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA" class="sect3"><span class="enumeration_section">11.4</span> JMS点对点模型特征</h3>
               <div>
                  <p>在点对点模型中，客户端将消息从一个点交换到另一个点。消息生成者和使用者使用单个使用者队列发送和接收消息。管理员创建与单消费者队列<code class="codeph">createQueue</code>的方法<code class="codeph">AQjmsSession</code> 。在使用它们之前，必须使用<code class="codeph">AQjmsDestination</code>的<code class="codeph">start</code>调用启用队列以进行入队/出队。客户端使用<code class="codeph">AQjmsSession</code>上的<code class="codeph">getQueue</code>方法获取先前创建的队列的<code class="codeph">AQjmsSession</code> 。
                  </p>
                  <p>在单个使用者队列中，单个使用者只能消息一次消息。如果有多个进程或操作系统线程同时从同一队列中出队，则每个进程将队列头部的第一个未锁定消息出列。锁定的消息不能由创建锁定的进程以外的进程出列。</p>
                  <p>处理完成后，如果队列的保留时间为0，则会删除该消息，或者在指定的保留时间内保留该消息。只要保留了消息，就可以在队列表视图上使用SQL查询，也可以通过在<code class="codeph">QueueBrowser</code>指定已处理消息的消息标识符来出列。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA__GUID-79717332-4D3F-41A9-A62B-5CF279D49E55">QueueSender</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>客户端使用<code class="codeph">QueueSender</code>将消息发送到队列。它是通过将队列传递到客户端<code class="codeph">Session</code>的<code class="codeph">createSender</code>方法来创建的。客户端还可以选择在不提供队列的情况下创建<code class="codeph">QueueSender</code> 。在这种情况下，必须在每个发送操作上指定一个队列。
                     </p>
                     <p>客户端可以为<code class="codeph">QueueSender</code>发送的所有消息指定默认传递模式，优先级和<code class="codeph">TimeToLive</code> 。或者，客户端可以为每个消息定义这些选项。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA__GUID-5AC5531C-A3A7-4FFB-B6D2-465225D122DE">的QueueReceiver</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>客户端使用<code class="codeph">QueueReceiver</code>从队列接收消息。它是在客户端<code class="codeph">Session</code>使用<code class="codeph">createQueueReceiver</code>方法创建的。可以使用或不使用<code class="codeph">messageSelector</code>创建它。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA__GUID-B3D5D211-52A9-4C5B-9566-8C0A95F2F10F">QueueBrowser</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>客户端使用<code class="codeph">QueueBrowser</code>查看队列中的消息而不删除它们。浏览器方法返回一个<code class="codeph">java</code> 。 <code class="codeph">util</code> 。用于扫描队列中的消息的<code class="codeph">Enumeration</code> 。对<code class="codeph">nextElement</code>的第一次调用获取队列的快照。可以使用或不使用<code class="codeph">messageSelector</code>创建<code class="codeph">QueueBrowser</code> 。
                     </p>
                     <p><code class="codeph">QueueBrowser</code>还可以选择在扫描邮件时锁定邮件。这类似于消息上的“ <code class="codeph">SELECT</code> ... <code class="codeph">for</code> <code class="codeph">UPDATE"</code>命令。这可以防止其他消费者在扫描时删除消息。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA__CACBBCBJ">
                     <p class="subhead2" id="GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA__GUID-91099DDC-D6E0-41A7-90B5-479168971C40">MessageSelector</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p><code class="codeph">messageSelector</code>允许客户端将传递给使用者的消息限制为与<code class="codeph">messageSelector</code>表达式匹配的<code class="codeph">messageSelector</code> 。包含<code class="codeph">TextMessage</code> ， <code class="codeph">StreamMessage</code> ， <code class="codeph">BytesMessage</code> ， <code class="codeph">ObjectMessage</code>或<code class="codeph">MapMessage</code>类型的有效内容的队列的<code class="codeph">messageSelector</code>可以包含具有以下一项或多项的任何表达式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>JMS消息标识符，前缀为“ID：”</p><pre class="oac_no_warn" dir="ltr">JMSMessageID ='ID：23452345'</pre></li>
                        <li>
                           <p>JMS消息头字段或属性</p><pre class="oac_no_warn" dir="ltr">JMSPriority &lt;3 AND JMSCorrelationID ='Fiction'JMSCorrelationID LIKE'RE％'</pre></li>
                        <li>
                           <p>用户定义的消息属性</p><pre class="oac_no_warn" dir="ltr">颜色IN（'RED'，BLUE'，'GREEN'）和价格&lt;30000</pre></li>
                     </ul>
                     <p>包含<code class="codeph">AdtMessage</code>类型的有效内容的队列的<code class="codeph">messageSelector</code>可以包含具有以下一个或多个的任何表达式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>没有“ID：”前缀的消息标识符</p><pre class="oac_no_warn" dir="ltr">msgstr ='23434556566767676'</pre></li>
                        <li>
                           <p>优先级，相关标识符或两者</p><pre class="oac_no_warn" dir="ltr">优先级&lt;3 AND corrid ='小说'</pre></li>
                        <li>
                           <p>消息负载</p><pre class="oac_no_warn" dir="ltr">tab.user_data.color ='GREEN'和tab.user_data.price &lt;30000</pre></li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ADQUE2906"></a><div class="props_rev_3"><a id="GUID-C6B0D221-741E-4C66-82D9-EBCCD870B339" name="GUID-C6B0D221-741E-4C66-82D9-EBCCD870B339"></a><h3 id="ADQUE-GUID-C6B0D221-741E-4C66-82D9-EBCCD870B339" class="sect3"><span class="enumeration_section">11.5</span> JMS发布/订阅模型功能</h3>
               <div>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="jms-introduction.html#GUID-453F20B1-2967-4188-BBAC-AA9D6EB30610">JMS发布/订阅概述</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-4E251F18-4AC4-46E3-A6A2-F9A89BE978B5">DurableSubscriber</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-DAB377B8-9D2F-4463-8F28-CCC5BC43DE1C">RemoteSubscriber</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-3397743E-5AB0-4B67-BD37-3F9E8C9B5CB0">的TopicPublisher</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-5491402A-8BCC-4B29-93AC-585729985631">收件人列表</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-D433AA47-72A0-49C3-A430-35D2E7776D49">TopicReceiver</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-C3D00EB6-3884-41A8-A70B-EC901D08C7A9">TopicBrowser</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-B81578CB-EB0A-4386-BC61-9865A600B65C">设置JMS发布/订阅操作</a></p>
                     </li>
                  </ul>
               </div><a id="ADQUE2907"></a><div class="props_rev_3"><a id="GUID-453F20B1-2967-4188-BBAC-AA9D6EB30610" name="GUID-453F20B1-2967-4188-BBAC-AA9D6EB30610"></a><h4 id="ADQUE-GUID-453F20B1-2967-4188-BBAC-AA9D6EB30610" class="sect4"><span class="enumeration_section">11.5.1</span> JMS发布/订阅概述</h4>
                  <div>
                     <p>JMS支持在作为发布者的应用程序和充当订阅者角色的应用程序之间进行灵活和动态的通信。应用程序没有耦合在一起;它们基于消息和消息内容进行交互。</p>
                     <p>在分发邮件时，发布者应用程序不需要显式处理或管理邮件收件人。这允许动态添加新订户应用程序，而无需更改任何发布者应用程序逻辑。</p>
                     <p>类似地，订户应用程序基于消息内容接收消息，而不管哪个发布者应用程序正在发送消息。这允许动态添加新的发布者应用程序而不更改任何订阅者应用程序逻辑。</p>
                     <p>订阅者应用程序通过在消息属性或主题的消息内容上定义基于规则的订阅来指定兴趣。系统使用基于规则的订阅通过计算收件人为已发布消息自动路由消息。</p>
                     <p>在发布/订阅模型中，消息将发布到主题并从主题接收。主题是使用所创建的<code class="codeph">CreateTopic()</code>中的方法<code class="codeph">AQjmsSession</code> 。客户端可以使用<code class="codeph">AQjmsSession</code>的<code class="codeph">getTopic()</code>方法获取先前创建的主题的<code class="codeph">AQjmsSession</code> 。
                     </p>
                  </div>
               </div><a id="ADQUE2908"></a><div class="props_rev_3"><a id="GUID-4E251F18-4AC4-46E3-A6A2-F9A89BE978B5" name="GUID-4E251F18-4AC4-46E3-A6A2-F9A89BE978B5"></a><h4 id="ADQUE-GUID-4E251F18-4AC4-46E3-A6A2-F9A89BE978B5" class="sect4"><span class="enumeration_section">11.5.2</span> DurableSubscriber</h4>
                  <div>
                     <p>客户端在客户端<code class="codeph">Session</code>使用<code class="codeph">createDurableSubscriber()</code>方法创建<code class="codeph">DurableSubscriber</code> 。可以使用或不使用<code class="codeph">messageSelector</code>创建它。
                     </p>
                     <p><code class="codeph">messageSelector</code>允许客户端将传递给订阅者的消息限制为与选择器匹配的消息。<a href="../jajms/index.html" target="_blank"><span class="italic">Oracle Database Advanced Queuing Java API Reference</span></a>中的<code class="codeph">createDurableSubscriber</code>中详细描述了选择器的语法。
                     </p>
                     <p>当订户使用相同的名称时，持久订阅者操作取决于在运行时为<a href="glossary.html#GUID-9885B911-8AC1-49F3-922E-1F8D64C4501D"><span class="xrefglossterm">Oracle Java消息服务</span></a> （Oracle JMS）客户端设置的Java EE合规性模式。
                     </p>
                     <p>在不符合要求的模式下，两个具有相同名称的持久<code class="codeph">TopicSubscriber</code>对象可以针对两个不同的主题进行激活。在兼容模式下，不允许使用具有相同名称的持久订阅者。如果两个订阅者使用相同的名称并针对同一主题创建，但每个订阅者使用的选择器不同，则使用内部<code class="codeph">DBMS_AQJMS.ALTER_SUBSCRIBER()</code>调用更改基础Oracle数据库高级队列订阅。
                     </p>
                     <p>如果两个订阅者使用相同的名称并针对两个不同的主题创建，并且如果使用相同订阅名称的客户端最初也创建了订阅名称，则会删除现有订阅并创建新订阅。</p>
                     <p>如果两个订阅者使用相同的名称并针对两个不同的主题创建，并且如果另一个客户端（未发起订阅名称的客户端）使用现有订阅名称，则不会删除订阅并引发错误。由于不知道订阅是由JMS还是PL / SQL创建的，因此不应删除其他主题的订阅。</p>
                     <div class="infoboxnotealso" id="GUID-4E251F18-4AC4-46E3-A6A2-F9A89BE978B5__GUID-9E32377E-F756-4F15-8B57-39F5BF7FE740">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="jms-introduction.html#GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA__CACBBCBJ">MessageSelector</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="jms-introduction.html#GUID-7D8D9257-574D-4378-B580-DA656D2F0511">Java EE合规性</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADQUE2909"></a><div class="props_rev_3"><a id="GUID-DAB377B8-9D2F-4463-8F28-CCC5BC43DE1C" name="GUID-DAB377B8-9D2F-4463-8F28-CCC5BC43DE1C"></a><h4 id="ADQUE-GUID-DAB377B8-9D2F-4463-8F28-CCC5BC43DE1C" class="sect4"><span class="enumeration_section">11.5.3</span> RemoteSubscriber</h4>
                  <div>
                     <p>使用<code class="codeph">createRemoteSubscriber</code>调用定义远程订户。远程订户可以是远程主题的特定消费者或远程主题的所有订户</p>
                     <p>使用<code class="codeph">AQjmsAgent</code>结构定义远程订户。<code class="codeph">AQjmsAgent</code>由名称和地址组成。该名称引用远程主题的<code class="codeph">consumer_name</code> 。地址指的是远程主题：</p><pre class="oac_no_warn" dir="ltr"><span class="italic">schema.topic_name</span> [@dblink]</pre><p>在远程主题消息发布到特定的消费者来说， <code class="codeph">subscription_name</code>中的<a href="glossary.html#GUID-F50CE039-717A-4D4C-B4D9-62EB3191885A"><span class="xrefglossterm">收件人</span></a>在远程话题必须在名称字段中指定<code class="codeph">AQjmsAgent</code> 。必须在<code class="codeph">AQjmsAgent</code>的地址字段中指定远程主题。
                     </p>
                     <p>要将消息发布到远程主题的所有订户，必须将<code class="codeph">AQjmsAgent</code>的名称字段设置为null。必须在<code class="codeph">AQjmsAgent</code>的地址字段中指定远程主题。
                     </p>
                  </div>
               </div><a id="ADQUE2910"></a><div class="props_rev_3"><a id="GUID-3397743E-5AB0-4B67-BD37-3F9E8C9B5CB0" name="GUID-3397743E-5AB0-4B67-BD37-3F9E8C9B5CB0"></a><h4 id="ADQUE-GUID-3397743E-5AB0-4B67-BD37-3F9E8C9B5CB0" class="sect4"><span class="enumeration_section">11.5.4</span> TopicPublisher</h4>
                  <div>
                     <p>使用<code class="codeph">TopicPublisher</code>发布消息， <code class="codeph">TopicPublisher</code>是通过将<code class="codeph">Topic</code>传递给<code class="codeph">createPublisher</code>方法创建的。客户端还可以选择在不提供<code class="codeph">Topic</code>情况下创建<code class="codeph">TopicPublisher</code> 。在这种情况下，必须在每个发布操作上指定<code class="codeph">Topic</code> 。客户端可以为<code class="codeph">TopicPublisher</code>发送的所有消息指定默认传递模式，优先级和<code class="codeph">TimeToLive</code> 。它还可以为每条消息指定这些选项。
                     </p>
                  </div>
               </div><a id="ADQUE2911"></a><div class="props_rev_3"><a id="GUID-5491402A-8BCC-4B29-93AC-585729985631" name="GUID-5491402A-8BCC-4B29-93AC-585729985631"></a><h4 id="ADQUE-GUID-5491402A-8BCC-4B29-93AC-585729985631" class="sect4"><span class="enumeration_section">11.5.5</span>收件人列表</h4>
                  <div>
                     <p>在JMS发布/订阅模型中，客户端可以指定显式收件人列表，而不是将消息发送给主题的所有订阅者。这些收件人可能是也可能不是该主题的现有订阅者。收件人列表会覆盖此邮件主题的订阅列表。收件人列表功能是JMS的Oracle扩展。</p>
                  </div>
               </div><a id="ADQUE2912"></a><div class="props_rev_3"><a id="GUID-D433AA47-72A0-49C3-A430-35D2E7776D49" name="GUID-D433AA47-72A0-49C3-A430-35D2E7776D49"></a><h4 id="ADQUE-GUID-D433AA47-72A0-49C3-A430-35D2E7776D49" class="sect4"><span class="enumeration_section">11.5.6</span> TopicReceiver</h4>
                  <div>
                     <p>如果在收件人列表中明确指定了收件人名称，但该收件人不是队列的订阅者，则可以通过创建<code class="codeph">TopicReceiver</code>来接收发送给它的<code class="codeph">TopicReceiver</code> 。如果未指定订户名称，则客户端必须使用远程站点上的持久订户来接收消息。<code class="codeph">TopicReceiver</code>是JMS的Oracle扩展。</p>
                     <p>可以使用<code class="codeph">messageSelector</code>创建<code class="codeph">TopicReceiver</code> 。这允许客户端将传递给收件人的邮件限制为与选择器匹配的邮件。
                     </p>
                     <div class="infoboxnotealso" id="GUID-D433AA47-72A0-49C3-A430-35D2E7776D49__GUID-FE33B9FA-09E5-414B-B39E-7AA1A8C9CBE2">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="jms-introduction.html#GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA__CACBBCBJ">MessageSelector</a> ”</span></p>
                     </div>
                  </div>
               </div><a id="ADQUE2913"></a><div class="props_rev_3"><a id="GUID-C3D00EB6-3884-41A8-A70B-EC901D08C7A9" name="GUID-C3D00EB6-3884-41A8-A70B-EC901D08C7A9"></a><h4 id="ADQUE-GUID-C3D00EB6-3884-41A8-A70B-EC901D08C7A9" class="sect4"><span class="enumeration_section">11.5.7</span> TopicBrowser</h4>
                  <div>
                     <p>客户端使用<code class="codeph">TopicBrowser</code>查看主题上的消息而不删除它们。浏览器方法返回<code class="codeph">java.util.用于扫描主题消息的Enumeration</code> 。只允许持久订阅者创建<code class="codeph">TopicBrowser</code> 。第一次调用<code class="codeph">nextElement</code>会获得该主题的快照。
                     </p>
                     <p><code class="codeph">TopicBrowser</code>可以选择在扫描邮件时锁定邮件。这类似于消息上的<code class="codeph">SELECT</code> ... <code class="codeph">for</code> <code class="codeph">UPDATE</code>命令。这可以防止其他消费者在扫描时删除消息。
                     </p>
                     <p>可以使用<code class="codeph">messageSelector</code>创建<code class="codeph">TopicBrowser</code> 。这允许客户端将传递给浏览器的消息限制为与选择器匹配的消息。
                     </p>
                     <p><code class="codeph">TopicBrowser</code>支持清除功能。这允许使用<code class="codeph">TopicBrowser</code>的客户端丢弃在主题的当前浏览操作期间看到的所有消息。清除等同于对所有看到的消息的破坏性接收（就像使用<code class="codeph">TopicSubscriber</code>执行一样）。
                     </p>
                     <p>对于清除，如果使用对<code class="codeph">java.lang.上的<code class="codeph">nextElement()</code>操作的调用将消息返回给客户端，则会认为该消息是可见的<code class="codeph">java.lang.<code class="codeph">TopicBrowser</code> Enumeration</code> 。在清除期间不会丢弃客户端尚未看到的消息。可以在同一<code class="codeph">TopicBrowser</code>上多次执行清除操作。
                     </p>
                     <p>当用于创建<code class="codeph">TopicBrowser</code>的JMS <code class="codeph">Session</code>被提交时，清除的效果变得稳定。如果会话中的操作被回滚，则清除操作的效果也将被撤消。
                     </p>
                     <div class="infoboxnotealso" id="GUID-C3D00EB6-3884-41A8-A70B-EC901D08C7A9__GUID-D30348FC-9B07-42CB-A0F7-0B30CB7A67EC">
                        <p class="notep1">也可以看看：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="q">“ <a href="jms-publish-subscribe.html#GUID-B5A94557-8D39-4C3E-9D76-E78BA526E440">为标准JMS消息创建TopicBrowser</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="jms-publish-subscribe.html#GUID-95BE7FA2-76E1-40CD-90BB-0E96D6E39F54">为标准JMS消息创建TopicBrowser_锁定消息</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="jms-introduction.html#GUID-9CD17AB0-4085-4E8C-A7FF-E5C15A4BAEFA__CACBBCBJ">MessageSelector</a> ”</span></p>
                           </li>
                           <li>
                              <p><span class="q">“ <a href="jms-publish-subscribe.html#GUID-073E8D0D-703B-4941-869A-7AA8C9F4CCC1">使用TopicBrowser浏览邮件</a> ”</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADQUE2914"></a><div class="props_rev_3"><a id="GUID-B81578CB-EB0A-4386-BC61-9865A600B65C" name="GUID-B81578CB-EB0A-4386-BC61-9865A600B65C"></a><h4 id="ADQUE-GUID-B81578CB-EB0A-4386-BC61-9865A600B65C" class="sect4"><span class="enumeration_section">11.5.8</span>设置JMS发布/订阅操作</h4>
                  <div>
                     <div class="section">
                        <p>请按照以下步骤在JMS中使用发布/订阅通信模型：</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>设置一个或多个主题以保存邮件。这些主题代表感兴趣的领域或主题。例如，主题可以表示结算订单。</span></li>
                        <li class="stepexpand"><span>使用<code class="codeph">AQjmsDestination</code>的<code class="codeph">start</code>调用启用对主题的入队/出队。</span></li>
                        <li class="stepexpand"><span>创建一组持久订阅者。每个订户可以指定一个<code class="codeph">messageSelector</code> ，用于选择订户希望接收的消息。null <code class="codeph">messageSelector</code>指示订户希望接收关于该主题发布的所有消息。</span><div>
                              <p>订户可以是本地的或远程的。本地订户是在发布消息的同一主题上定义的持久订阅者。远程订户是其他主题，或其他主题上的接收者，这些主题被定义为特定队列的订户。要使用远程订阅者，您必须在源主题和目标主题之间设置传播。远程订户和传播是JMS的Oracle扩展。</p>
                              <div class="infoboxnotealso" id="GUID-B81578CB-EB0A-4386-BC61-9865A600B65C__GUID-16155B4A-63A6-431D-8584-1EB1FED9BBFB">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="aq-administrative-interface.html#GUID-1BAEBA4C-441A-43FE-B822-14E9A6E33A0E" title="可以在队列生命周期的任何时间更改或删除为队列定义的传播计划。">管理传播</a> ”</span></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>使用发布者<code class="codeph">Session</code>的<code class="codeph">createPublisher()</code>方法创建<code class="codeph">TopicPublisher</code>对象。使用<code class="codeph">publish</code>调用<code class="codeph">publish</code>消息。可以将消息发布到主题的所有订阅者或该主题的指定接收者子集。</span></li>
                        <li class="stepexpand"><span>订阅者使用<code class="codeph">receive</code>方法接收有关该主题的消息。</span></li>
                        <li class="stepexpand"><span>订阅者还可以使用消息侦听器异步接收消息。</span><div>
                              <div class="infoboxnotealso" id="GUID-B81578CB-EB0A-4386-BC61-9865A600B65C__GUID-2E0E6E98-8160-47EF-8470-DD42EFC22C7C">
                                 <p class="notep1">也可以看看：</p>
                                 <p><span class="q">“ <a href="aq-operations-using-pl-sql.html#GUID-B5606574-8C70-41AE-A362-A753033C3A70" title="此过程指定要监视的队列。">倾听一个或多个队列</a> ”</span></p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="ADQUE2915"></a><div class="props_rev_3"><a id="GUID-14D8B416-BEC1-4C58-83C1-D6FD16B6961D" name="GUID-14D8B416-BEC1-4C58-83C1-D6FD16B6961D"></a><h3 id="ADQUE-GUID-14D8B416-BEC1-4C58-83C1-D6FD16B6961D" class="sect3"><span class="enumeration_section">11.6</span> JMS消息生成器功能</h3>
               <div>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="jms-introduction.html#GUID-9B57C751-DF54-41DA-B247-8B0B62BA3821">消息的优先级和排序</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-EB2FF63A-0C15-4065-8EA7-EFFAD3FC1624">指定消息延迟</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-8CBF2F33-E4D3-4F01-94E4-D2D52EF20CDA">指定邮件过期</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-C37EB8B1-0FE5-44CF-8531-DA7AAE3C7F25">消息分组</a></p>
                     </li>
                  </ul>
               </div><a id="ADQUE2916"></a><div class="props_rev_3"><a id="GUID-9B57C751-DF54-41DA-B247-8B0B62BA3821" name="GUID-9B57C751-DF54-41DA-B247-8B0B62BA3821"></a><h4 id="ADQUE-GUID-9B57C751-DF54-41DA-B247-8B0B62BA3821" class="sect4"><span class="enumeration_section">11.6.1</span>消息的优先级和排序</h4>
                  <div>
                     <p>消息排序决定了从队列或主题接收消息的顺序。在创建队列或主题的队列表时指定排序方法。目前，Oracle数据库高级队列支持对消息优先级和排队时间进行排序，产生四种可能的排序方式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>先进先出（FIFO）</p>
                           <p>如果选择入队时间作为排序标准，则按入队时间的顺序接收消息。排队时间由Oracle数据库高级队列在消息发布/发送时分配给消息。这也是默认排序。</p>
                        </li>
                        <li>
                           <p>优先订购</p>
                           <p>如果选择了优先级排序，则为每条消息分配优先级。可以在<code class="codeph">MessageProducer</code>发布/发送时将优先级指定为消息属性。消息按指定的优先级顺序接收。
                           </p>
                        </li>
                        <li>
                           <p>FIFO优先级</p>
                           <p>如果选择了FIFO优先级排序，则主题/队列就像一个优先级队列。如果为两条消息分配了相同的优先级，则按照其入队时间的顺序接收它们。</p>
                        </li>
                        <li>
                           <p>入队时间优先顺序</p>
                           <p>根据优先级接收具有相同排队时间的消息。如果两条消息的排序标准相同，则接收它们的顺序是不确定的。但是，Oracle数据库高级队列确保按照发送顺序接收在具有特定排序条件的一个会话中生成的消息。</p>
                        </li>
                     </ul>
                     <p>可用于持久消息的所有排序方案也可用于缓冲消息，但仅适用于每个消息类。目前不支持在同一会话中排队/发布的持久和缓冲消息之间进行排序。</p>
                  </div>
               </div><a id="ADQUE2917"></a><div class="props_rev_3"><a id="GUID-EB2FF63A-0C15-4065-8EA7-EFFAD3FC1624" name="GUID-EB2FF63A-0C15-4065-8EA7-EFFAD3FC1624"></a><h4 id="ADQUE-GUID-EB2FF63A-0C15-4065-8EA7-EFFAD3FC1624" class="sect4"><span class="enumeration_section">11.6.2</span>指定消息延迟</h4>
                  <div>
                     <p>消息可以延迟发送/发布到队列/主题。延迟表示消息可供消息使用者使用的时间间隔。延迟指定的消息处于等待状态，直到延迟到期。通过消息标识符接收会覆盖延迟规范。</p>
                     <p>Delay是JMS消息属性的Oracle Database Advanced Queuing扩展。它需要启动Oracle数据库高级队列后台进程队列监视器。</p>
                  </div>
               </div><a id="ADQUE2918"></a><div class="props_rev_3"><a id="GUID-8CBF2F33-E4D3-4F01-94E4-D2D52EF20CDA" name="GUID-8CBF2F33-E4D3-4F01-94E4-D2D52EF20CDA"></a><h4 id="ADQUE-GUID-8CBF2F33-E4D3-4F01-94E4-D2D52EF20CDA" class="sect4"><span class="enumeration_section">11.6.3</span>指定消息过期</h4>
                  <div>
                     <p>消息生产者可以为消息指定过期限制或<code class="codeph">TimeToLive</code> 。这定义了消息可用于消息使用者的时间段。
                     </p>
                     <p>可以在发送/发布时指定<code class="codeph">TimeToLive</code>也可以使用<code class="codeph">MessageProducer</code> <code class="codeph">TimeToLive</code>方法指定<code class="codeph">TimeToLive</code> ，前者覆盖后者。必须运行Oracle数据库高级队列后台进程队列监视器才能实现<code class="codeph">TimeToLive</code> 。
                     </p>
                  </div>
               </div><a id="ADQUE2919"></a><div class="props_rev_3"><a id="GUID-C37EB8B1-0FE5-44CF-8531-DA7AAE3C7F25" name="GUID-C37EB8B1-0FE5-44CF-8531-DA7AAE3C7F25"></a><h4 id="ADQUE-GUID-C37EB8B1-0FE5-44CF-8531-DA7AAE3C7F25" class="sect4"><span class="enumeration_section">11.6.4</span>消息分组</h4>
                  <div>
                     <p>属于队列/主题的消息可以被分组以形成一次只能由一个消费者使用的集合。这要求在为<a href="glossary.html#GUID-4956C594-EE49-498B-A9DD-7371518B4EBA"><span class="xrefglossterm">事务性</span></a>消息分组启用的队列表中创建队列/主题。属于组的所有消息必须在同一事务中创建，并且在一个事务中创建的所有消息都属于同一组。
                     </p>
                     <p>消息分组是JMS规范的Oracle数据库高级队列扩展。</p>
                     <p>您可以使用此功能将复杂消息划分为一系列链接的简单消息。例如，指向发票队列的发票可以分为标题消息，后面跟几个表示详细信息的消息，然后是预告片消息。</p>
                     <p>如果消息有效负载包含可以分割成较小对象的复杂大对象（如图像和视频），则消息分组也非常有用。</p>
                     <p>组中消息的优先级，延迟和到期属性仅由为组的第一个消息（头部）指定的消息属性确定。为组中的后续消息指定的属性将被忽略。</p>
                     <p>传播期间保留消息分组。必须为事务分组启用目标主题。</p>
                     <div class="infoboxnotealso" id="GUID-C37EB8B1-0FE5-44CF-8531-DA7AAE3C7F25__GUID-0B44EA56-330D-4BA5-939E-464719739ADC">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="aq-introduction.html#GUID-AA8621D3-88E6-460A-8EC4-8EE6F53DE56A" title="本主题讨论出列特征并发出列，出列方法，出列模式，出列消息，消息状态，出列消息导航，等待消息，带延迟的重试，可选事务保护和异常队列。">Dequeue Features</a> ”</span>用于讨论限制，如果要在保留事务分组的队列中的消息出列时保留消息分组，则必须记住这些限制</p>
                     </div>
                  </div>
               </div>
            </div><a id="ADQUE2920"></a><div class="props_rev_3"><a id="GUID-4A309A42-7301-4B28-8B0B-A59D75DF9ECE" name="GUID-4A309A42-7301-4B28-8B0B-A59D75DF9ECE"></a><h3 id="ADQUE-GUID-4A309A42-7301-4B28-8B0B-A59D75DF9ECE" class="sect3"><span class="enumeration_section">11.7</span> JMS消息使用者功能</h3>
               <div>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="jms-introduction.html#GUID-CC78CBF0-6A8B-4230-BE93-4C1BB778A08D">接收消息</a> 
                        </p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-B7DE3FC0-AE4B-4808-9B3E-5A7C3A8CF350">接收中的消息导航</a> 
                        </p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-94202770-6C08-49B8-853B-8AED68954CB3">浏览消息</a> 
                        </p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-6375C108-8DD2-4969-A199-5BED02ABD9FF">删除无数据</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-4961B293-410F-4449-A432-F8E9F569716A">使用延迟间隔重试</a> 
                        </p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-E697CC68-4C52-40E6-893B-6721E7BB767E">使用MessageListener异步接收消息</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-0C224DAC-F3AD-4966-BB97-70EA9802C57E">异常队列</a></p>
                     </li>
                  </ul>
               </div><a id="ADQUE2921"></a><div class="props_rev_3"><a id="GUID-CC78CBF0-6A8B-4230-BE93-4C1BB778A08D" name="GUID-CC78CBF0-6A8B-4230-BE93-4C1BB778A08D"></a><h4 id="ADQUE-GUID-CC78CBF0-6A8B-4230-BE93-4C1BB778A08D" class="sect4"><span class="enumeration_section">11.7.1</span>接收消息</h4>
                  <div>
                     <p>JMS应用程序可以通过创建消息使用者来接收消息。可以使用<code class="codeph">receive</code>调用同步<code class="codeph">receive</code>消息，也可以使用消息监听器异步<code class="codeph">receive</code>消息。
                     </p>
                     <p>有三种接收方式：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>阻止消息到达消费者</p>
                        </li>
                        <li>
                           <p>阻止最多指定时间</p>
                        </li>
                        <li>
                           <p>非阻塞</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADQUE2922"></a><div class="props_rev_3"><a id="GUID-B7DE3FC0-AE4B-4808-9B3E-5A7C3A8CF350" name="GUID-B7DE3FC0-AE4B-4808-9B3E-5A7C3A8CF350"></a><h4 id="ADQUE-GUID-B7DE3FC0-AE4B-4808-9B3E-5A7C3A8CF350" class="sect4"><span class="enumeration_section">11.7.2</span>接收中的消息导航</h4>
                  <div>
                     <p>如果消费者未指定导航模式，则其在会话中的第一次<code class="codeph">receive</code>将检索队列或主题中的第一条消息，其第二次<code class="codeph">receive</code>将获取下一条消息，依此类推。如果消费者收到高优先级消息，则消费者在清除之前已经存在的消息之前不会收到消息。
                     </p>
                     <p>为了让消费者更好地控制导航队列中的消息，Oracle Database Advanced Queuing提供了几种导航模式作为JMS扩展。可以在<code class="codeph">TopicSubscriber</code> ， <code class="codeph">QueueReceiver</code>或<code class="codeph">TopicReceiver</code>设置这些模式。
                     </p>
                     <p>有两种模式可用于未分组的消息：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">FIRST_MESSAGE</code></p>
                           <p>此模式将位置重置为队列的开头。它对优先级排序的队列很有用，因为它允许使用者删除队列顶部的消息。</p>
                        </li>
                        <li>
                           <p><code class="codeph">NEXT_MESSAGE</code></p>
                           <p>此模式获取消费者的既定位置之后的任何消息。例如，当位置在第四个消息时应用的<code class="codeph">NEXT_MESSAGE</code>将获得队列中的第五个消息。这是默认操作。
                           </p>
                        </li>
                     </ul>
                     <p>有三种模式可用于分组消息：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">FIRST_MESSAGE</code></p>
                           <p>此模式将位置重置为队列的开头。</p>
                        </li>
                        <li>
                           <p><code class="codeph">NEXT_MESSAGE</code></p>
                           <p>此模式将位置设置为同一事务中的下一条消息。</p>
                        </li>
                        <li>
                           <p><code class="codeph">NEXT_TRANSACTION</code></p>
                           <p>此模式将位置设置为下一个事务中的第一条消息。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-B7DE3FC0-AE4B-4808-9B3E-5A7C3A8CF350__GUID-A368DD9E-8F51-4644-98A3-934764B0BEED">
                        <p class="notep1">注意：</p>
                        <p>分片队列不支持前三种模式。</p>
                     </div>
                     <p>如果通过以下方式接收消息，则可以取消事务分组属性：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>通过在选择器中指定相关标识符来接收</p>
                        </li>
                        <li>
                           <p>通过在选择器中指定消息标识符来接收</p>
                        </li>
                        <li>
                           <p>在收到交易组的所有消息之前提交</p>
                        </li>
                     </ul>
                     <p>如果使用者在使用<code class="codeph">NEXT</code> _ <code class="codeph">MESSAGE</code>或<code class="codeph">NEXT</code> _ <code class="codeph">TRANSACTION</code>选项时到达队列末尾，并且您已指定阻塞<code class="codeph">receive()</code> ，则导航位置将自动更改为队列的开头。
                     </p>
                     <p>默认情况下， <code class="codeph">QueueReceiver</code> ， <code class="codeph">TopicReceiver</code>或<code class="codeph">TopicSubscriber</code>使用<code class="codeph">FIRST_MESSAGE</code>进行第一次接收呼叫，使用<code class="codeph">NEXT_MESSAGE</code>进行后续的<code class="codeph">receive()</code>调用。
                     </p>
                  </div>
               </div><a id="ADQUE2923"></a><div class="props_rev_3"><a id="GUID-94202770-6C08-49B8-853B-8AED68954CB3" name="GUID-94202770-6C08-49B8-853B-8AED68954CB3"></a><h4 id="ADQUE-GUID-94202770-6C08-49B8-853B-8AED68954CB3" class="sect4"><span class="enumeration_section">11.7.3</span>浏览消息</h4>
                  <div>
                     <p>除了允许出队客户端从队列中删除消息的常规<code class="codeph">receive</code>之外，JMS还提供了一个允许JMS客户端浏览队列中消息的接口。可以使用<code class="codeph">QueueSession</code>的<code class="codeph">createBrowser</code>方法创建<code class="codeph">QueueBrowser</code> 。
                     </p>
                     <p>如果浏览了消息，则它仍可用于进一步处理。这并不一定意味着消息在浏览后仍然可用于JMS会话，因为来自并发会话的<code class="codeph">receive</code>呼叫可能会将其删除。
                     </p>
                     <p>要防止并发JMS客户端删除已查看的消息，您可以在锁定模式下查看该消息。要执行此操作，必须使用JMS接口的Oracle Database Advanced Queuing扩展创建具有锁定模式的<code class="codeph">QueueBrowser</code> 。当会话执行提交或回滚时，将释放对消息的锁定。
                     </p>
                     <p>要删除<code class="codeph">QueueBrowser</code>查看的消息，会话必须创建<code class="codeph">QueueReceiver</code>并使用<code class="codeph">JMSmesssageID</code>作为选择器。
                     </p>
                  </div>
               </div><a id="ADQUE2924"></a><div class="props_rev_3"><a id="GUID-6375C108-8DD2-4969-A199-5BED02ABD9FF" name="GUID-6375C108-8DD2-4969-A199-5BED02ABD9FF"></a><h4 id="ADQUE-GUID-6375C108-8DD2-4969-A199-5BED02ABD9FF" class="sect4"><span class="enumeration_section">11.7.4</span>删除无数据</h4>
                  <div>
                     <p>使用者可以使用<code class="codeph">receiveNoData</code>调用从队列或主题中删除消息而无需检索消息。当应用程序已经使用<code class="codeph">QueueBrowser</code>检查了消息时，这很有<code class="codeph">QueueBrowser</code> 。此模式允许JMS客户端避免从数据库检索有效负载的开销，这对于大型消息而言可能是实质性的。
                     </p>
                  </div>
               </div><a id="ADQUE2925"></a><div class="props_rev_3"><a id="GUID-4961B293-410F-4449-A432-F8E9F569716A" name="GUID-4961B293-410F-4449-A432-F8E9F569716A"></a><h4 id="ADQUE-GUID-4961B293-410F-4449-A432-F8E9F569716A" class="sect4"><span class="enumeration_section">11.7.5</span>使用延迟间隔重试</h4>
                  <div>
                     <p>如果从队列/主题接收消息的事务失败，则认为是删除该消息的尝试失败。Oracle数据库高级队列记录了在消息历史记录中删除消息的失败尝试次数。</p>
                     <p>应用程序可以指定队列/主题级别的消息支持的最大重试次数。如果删除邮件的失败尝试次数超过此最大值，则邮件将移至异常队列。</p>
                     <p>Oracle Database Advanced Queuing允许用户指定<code class="codeph">retry_delay</code>和<code class="codeph">max_retries</code> 。这意味着在<code class="codeph">retry_delay</code>间隔之后，已经过检索失败尝试的消息在队列中仍然可见，以便出<code class="codeph">retry_delay</code> 。在那之前，它处于<code class="codeph">WAITING</code>状态。Oracle数据库高级队列后台进程时间管理器强制执行重试延迟属性。
                     </p>
                     <p>最大重试次数和重试延迟是队列/主题的属性。可以在创建队列/主题时设置它们，也可以在队列/主题上使用alter方法设置它们。<code class="codeph">MAX_RETRIES</code>的默认值为<code class="codeph">5</code> 。
                     </p>
                     <div class="infoboxnote" id="GUID-4961B293-410F-4449-A432-F8E9F569716A__GUID-147EB27F-FCA1-4F04-AA92-3CDE7938A31C">
                        <p class="notep1">注意：</p>
                        <p>分片队列不支持重试延迟。</p>
                     </div>
                  </div>
               </div><a id="ADQUE2926"></a><div class="props_rev_3"><a id="GUID-E697CC68-4C52-40E6-893B-6721E7BB767E" name="GUID-E697CC68-4C52-40E6-893B-6721E7BB767E"></a><h4 id="ADQUE-GUID-E697CC68-4C52-40E6-893B-6721E7BB767E" class="sect4"><span class="enumeration_section">11.7.6</span>使用MessageListener异步接收消息</h4>
                  <div>
                     <p>JMS客户端可以通过使用<code class="codeph">setMessageListener</code>方法设置<code class="codeph">MessageListener</code>来异步接收消息。
                     </p>
                     <p>当消息到达使用者时，将使用该消息调用消息侦听器的<code class="codeph">onMessage</code>方法。消息侦听器可以提交或终止消息的接收。如果已停止JMS <code class="codeph">Connection</code>则消息侦听器不会收到消息。一旦为消费者设置了消息监听器，就不能使用<code class="codeph">receive</code>呼叫来接收消息。
                     </p>
                     <p>通过在会话中设置<code class="codeph">MessageListener</code> ，JMS客户端可以为会话中的所有使用者异步接收消息。一旦设置了消息侦听器，就不能在会话中使用其他用于接收消息的模式。
                     </p>
                  </div>
               </div><a id="ADQUE2927"></a><div class="props_rev_3"><a id="GUID-0C224DAC-F3AD-4966-BB97-70EA9802C57E" name="GUID-0C224DAC-F3AD-4966-BB97-70EA9802C57E"></a><h4 id="ADQUE-GUID-0C224DAC-F3AD-4966-BB97-70EA9802C57E" class="sect4"><span class="enumeration_section">11.7.7</span>异常队列</h4>
                  <div>
                     <p>异常队列是所有过期或无法使用的消息的存储库。应用程序无法直接排入异常队列。但是，打算处理这些过期或无法使用的消息的应用程序可以从异常队列中接收/删除它们。</p>
                     <p>要从异常队列中检索消息，JMS客户端必须使用点对点接口。用于主题的消息的异常队列必须在启用了多个使用者的队列表中创建。与任何其他队列一样，必须启用异常队列以使用<code class="codeph">AQOracleQueue</code>类中的<code class="codeph">start</code>方法接收消息。如果您尝试将其启用为enqueue，则会出现异常。
                     </p>
                     <p>Sharded队列现在通过<code class="codeph">DBMS_AQADM.CREATE_EXCEPTION_QUEUE</code> API支持异常队列。</p><pre class="pre codeblock"><code>PROCEDURE CREATE_EXCEPTION_QUEUE（在VARCHAR2中为sharded_queue_name，在VARCHAR2 DEFAULT中为exception_queue_name，在OUCHAR2 DEFAULT为空时为multiple_consumers，在RAMCHAR2 DEFAULT中为storage_clause，sort_list为VARCHAR DEFAULT NULL，注释为VARCHAR2 DEFAULT NULL）;</code></pre><p>异常队列是一个名为<code class="codeph">"JMS_OracleExcpQ"</code>的特定于Oracle的消息属性，可以在发送/发布消息之前使用该消息进行设置。如果未指定异常队列，则使用缺省异常队列。对于非分片队列，在创建队列表时会自动创建缺省异常队列，并将其命名为<code class="codeph">AQ$_</code> <span class="italic"><code class="codeph">queue_table_name</code></span> <code class="codeph">_E</code> 。默认情况下，不会为分片队列创建任何异常队列。
                     </p>
                     <p>在以下条件下，消息将移动到异常队列：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>消息未在指定的<code class="codeph">timeToLive</code> 。
                           </p>
                           <p>对于针对多个订户的消息，如果一个或多个预期收件人无法在指定的<code class="codeph">timeToLive</code>内使消息出列，则将消息移动到异常队列。
                           </p>
                        </li>
                        <li>
                           <p>消息已成功接收，但应用程序因处理消息时出错而终止了执行<code class="codeph">receive</code>的事务。消息将返回到队列/主题，并且可供等待接收消息的任何应用程序使用。
                           </p>
                           <p>如果应用程序终止整个事务，或者它回滚到在<code class="codeph">receive</code>之前<code class="codeph">receive</code>的保存点，则认为<code class="codeph">receive</code>被回滚或撤消。
                           </p>
                           <p>因为这是尝试接收消息失败，所以更新了其重试计数。如果消息的重试计数超过为其所在的队列/主题指定的最大值，则将其移至异常队列。</p>
                           <p>如果邮件具有多个订阅者，则仅当邮件的所有收件人都超过重试限制时，才会将邮件移动到例外队列。</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-0C224DAC-F3AD-4966-BB97-70EA9802C57E__GUID-2F13AC5A-F925-411D-A14E-5713FB8CADE2">
                        <p class="notep1">注意：</p>
                        <p>如果由于服务器进程在实例上死亡（包括<code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">KILL</code> <code class="codeph">SESSION</code> ）或<code class="codeph">SHUTDOWN</code> <code class="codeph">ABORT</code>而导致dequeue事务失败，则<code class="codeph">RETRY_COUNT</code>不会递增。
                        </p>
                     </div>
                  </div>
               </div>
            </div><a id="ADQUE2928"></a><div class="props_rev_3"><a id="GUID-9453B830-327C-46F2-8F0F-BFD8897B8A5E" name="GUID-9453B830-327C-46F2-8F0F-BFD8897B8A5E"></a><h3 id="ADQUE-GUID-9453B830-327C-46F2-8F0F-BFD8897B8A5E" class="sect3"><span class="enumeration_section">11.8</span> JMS传播</h3>
               <div>
                  <p>本节包含以下主题：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="jms-introduction.html#GUID-35A7EA77-F91A-4526-BFAA-2C466FBEA4D7">RemoteSubscriber</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-E90592C1-949D-43F4-AAC8-701DD54E7BA2">调度传播</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-360ABCB4-C151-4092-AE60-CF23E3A85AB3">增强的传播调度功能</a></p>
                     </li>
                     <li>
                        <p><a href="jms-introduction.html#GUID-D506C8D1-91AC-4DA8-A5D7-0C37611459AF">传播过程中的异常处理</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-9453B830-327C-46F2-8F0F-BFD8897B8A5E__GUID-6973CD18-F5F8-42A1-8224-B2B248400F24">
                     <p class="notep1">注意：</p>
                     <p>分片队列不支持RemoteSubscriber，调度传播，增强传播调度功能和传播期间的异常处理。</p>
                  </div>
               </div><a id="ADQUE2929"></a><div class="props_rev_3"><a id="GUID-35A7EA77-F91A-4526-BFAA-2C466FBEA4D7" name="GUID-35A7EA77-F91A-4526-BFAA-2C466FBEA4D7"></a><h4 id="ADQUE-GUID-35A7EA77-F91A-4526-BFAA-2C466FBEA4D7" class="sect4"><span class="enumeration_section">11.8.1</span> RemoteSubscriber</h4>
                  <div>
                     <p>Oracle Database Advanced Queuing允许其他数据库的订阅者订阅主题。如果发布到主题的消息符合远程订户的标准，则它将自动传播到为远程订户指定的远程数据库的队列/主题。使用数据库链接和Oracle Net Services执行传播。这使应用程序可以相互通信，而无需连接到同一数据库。</p>
                     <p>有两种方法可以实现远程用户：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><code class="codeph">createRemoteSubscriber</code>方法可用于创建主题上的远程订阅者。远程订户被指定为<code class="codeph">AQjmsAgent</code>类的实例。
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">AQjmsAgent</code>有一个名称和一个地址。该地址由队列/主题和到订户数据库的数据库链接组成。
                           </p>
                        </li>
                     </ul>
                     <p>有两种远程用户：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>远程订户是一个主题。</p>
                           <p>如果未在<code class="codeph">AQjmsAgent</code>对象中为远程订户指定名称且地址是主题，则会发生这种情况。满足订户订阅的消息将传播到远程主题。传播的消息现在可供其满足的远程主题的所有订阅使用。
                           </p>
                        </li>
                        <li>
                           <p>为邮件指定了特定的远程收件人。</p>
                           <p>远程订阅可以用于远程数据库中的特定消费者。如果指定了远程收件人的名称（在<code class="codeph">AQjmsAgent</code>对象中），则满足订阅的邮件将仅传播到该收件人的远程数据库。远程数据库的收件人使用<code class="codeph">TopicReceiver</code>接口检索其消息。远程订阅也可以用于点对点队列。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="ADQUE2930"></a><div class="props_rev_3"><a id="GUID-E90592C1-949D-43F4-AAC8-701DD54E7BA2" name="GUID-E90592C1-949D-43F4-AAC8-701DD54E7BA2"></a><h4 id="ADQUE-GUID-E90592C1-949D-43F4-AAC8-701DD54E7BA2" class="sect4"><span class="enumeration_section">11.8.2</span>调度传播</h4>
                  <div>
                     <p>必须使用<code class="codeph">schedule_propagation</code>方法为传播到目标目标数据库的每个主题<code class="codeph">schedule_propagation</code>传播。
                     </p>
                     <p>计划表示可以从源主题传播消息的时间范围。此时间范围可能取决于多种因素，例如网络流量，源数据库的负载，目标数据库的负载等。因此，必须根据具体的来源和目的地量身定制时间表。创建计划后，作业将自动提交给<code class="codeph">job_queue</code>工具以处理传播。
                     </p>
                     <p>传播调度的管理调用为管理调度提供了极大的灵活性。时间表的持续时间或传播窗口参数指定必须进行传播的时间范围。如果未指定持续时间，则时间范围是无限单个窗口。如果必须周期性地重复窗口，则指定有限持续时间以及定义连续窗口之间的周期性间隔的<code class="codeph">next_time</code>函数。
                     </p>
                     <p>可以在队列生命周期的任何时间更改或删除为队列定义的传播计划。此外，还要求暂时禁用计划（而不是删除计划）并启用禁用的计划。在该计划中传播消息时，计划处于活动状态。无论计划是否有效，都可以进行所有管理呼叫。如果计划处于活动状态，则执行调用需要几秒钟。</p>
                     <p>必须启动作业队列进程才能进行传播。必须至少启动2个作业队列进程。到目标数据库的数据库链接也必须有效。传播的源和目标主题必须具有相同的消息类型。必须启用远程主题以进行入队。数据库链接的用户还必须具有远程主题的入队权限。</p>
                     <div class="infoboxnotealso" id="GUID-E90592C1-949D-43F4-AAC8-701DD54E7BA2__GUID-476D5910-4BD0-44C5-B450-F8DCED7CA1D0">
                        <p class="notep1">也可以看看：</p>
                        <p><span class="q">“ <a href="jms-basic-operation.html#GUID-6AE9BA1A-2413-4656-855D-62470AD0328D">安排传播</a> ”</span></p>
                     </div>
                  </div>
               </div><a id="ADQUE2931"></a><div class="props_rev_3"><a id="GUID-360ABCB4-C151-4092-AE60-CF23E3A85AB3" name="GUID-360ABCB4-C151-4092-AE60-CF23E3A85AB3"></a><h4 id="ADQUE-GUID-360ABCB4-C151-4092-AE60-CF23E3A85AB3" class="sect4"><span class="enumeration_section">11.8.3</span>增强传播调度功能</h4>
                  <div>
                     <p>为传播定义的目录视图提供有关活动计划的以下信息：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>处理计划的后台进程的名称</p>
                        </li>
                        <li>
                           <p>处理传播的会话的SID（会话和序列号）</p>
                        </li>
                        <li>
                           <p>处理计划的实例（如果使用Oracle RAC）</p>
                        </li>
                        <li>
                           <p>以前成功执行计划</p>
                        </li>
                        <li>
                           <p>下一步计划执行计划</p>
                        </li>
                     </ul>
                     <p>为每个计划维护以下传播统计信息，为队列管理员提供有用信息以进行调整：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>计划中传播的消息总数</p>
                        </li>
                        <li>
                           <p>计划中传播的总字节数</p>
                        </li>
                        <li>
                           <p>窗口中传播的最大消息数</p>
                        </li>
                        <li>
                           <p>窗口中传播的最大字节数</p>
                        </li>
                        <li>
                           <p>窗口中传播的平均消息数</p>
                        </li>
                        <li>
                           <p>传播消息的平均大小</p>
                        </li>
                        <li>
                           <p>传播消息的平均时间</p>
                        </li>
                     </ul>
                     <p>传播具有处理故障和报告错误的内置支持。例如，如果指定的数据库链接无效，或者远程数据库不可用，或者未启用远程主题/队列进行排队，则会报告相应的错误消息。传播使用指数退避方案来重试来自遇到故障的调度的传播。如果时间表连续遇到故障，则第一次重试在30秒后发生，第二次在60秒后发生，第三次在120秒后发生，依此类推。如果重试时间超出当前窗口的到期时间，则在下一个窗口的开始时间尝试下一次重试。最多进行16次重试尝试，之后将自动禁用计划。</p>
                     <div class="infoboxnote" id="GUID-360ABCB4-C151-4092-AE60-CF23E3A85AB3__GUID-A76E781A-C9B6-4EBE-9DDA-02BAA8E773C1">
                        <p class="notep1">注意：</p>
                        <p>一旦重试尝试滑入下一个传播窗口，它将始终这样做;指数退避方案不再支配重试调度。如果在<code class="codeph">DBMS_AQADM.SCHEDULE_PROPAGATION()</code>的<code class="codeph">next_time</code>参数中指定的日期函数导致窗口之间的间隔很短，则不成功的重试尝试次数可以快速达到16，从而禁用该计划。
                        </p>
                     </div>
                     <p>由于故障而自动禁用计划时，相关信息将写入警报日志。可以随时检查计划是否遇到故障，如果遇到了多少连续故障，则会显示错误消息，指出故障原因以及遇到上次故障的时间。通过检查此信息，管理员可以修复故障并启用计划。</p>
                     <p>如果在重试期间传播成功，则将失败次数重置为0。</p>
                     <p>Propagation内置了对Oracle Real Application Clusters的支持，对用户和管理员都是透明的。处理传播的作业将提交给与源主题所在的队列表的所有者相同的实例。如果在任何时候实例发生故障并且存储该主题的队列表迁移到其他实例，则传播作业也会自动迁移到新实例。这最小化了实例之间的ping，从而提供了更好的性能。传播已设计为处理任意数量的并发计划。</p>
                     <p><code class="codeph">job_queue_processes</code>的数量限制为最多1000个，其中一些可用于处理与传播无关的作业。因此，传播已经内置了对多任务和负载平衡的支持。设计传播算法使得可以通过单个快照（ <code class="codeph">job_queue</code> ）过程处理多个调度。<code class="codeph">job_queue</code>进程上的传播负载可能会根据不同源主题中消息的到达率而出现偏差。如果一个进程因多个活动调度而负担过重而另一个进程负载较少，则会有很多被动调度，则传播会自动在进程之间重新分配调度，以便统一加载它们。
                     </p>
                  </div>
               </div><a id="ADQUE2932"></a><div class="props_rev_3"><a id="GUID-D506C8D1-91AC-4DA8-A5D7-0C37611459AF" name="GUID-D506C8D1-91AC-4DA8-A5D7-0C37611459AF"></a><h4 id="ADQUE-GUID-D506C8D1-91AC-4DA8-A5D7-0C37611459AF" class="sect4"><span class="enumeration_section">11.8.4</span>传播过程中的异常处理</h4>
                  <div>
                     <p>当发生网络故障等系统错误时，Oracle数据库高级队列将继续尝试使用指数退避算法传播消息。在某些表示队列到数据链路传播中的应用程序错误的情况下，Oracle数据库高级队列将消息标记为<code class="codeph">UNDELIVERABLE</code>并在<code class="codeph">alert.log</code>记录消息。此类错误的示例是当远程队列不存在或源队列与远程队列之间存在类型不匹配时。<code class="codeph">background_dump_dest</code>目录中的跟踪文件可以提供有关错误的其他信息。
                     </p>
                     <p>当新的作业队列进程启动时，它会清除不匹配的类型错误，以便可以重新验证类型。如果您已限制作业队列进程数并且传播仍然繁忙，那么您可能不希望等待作业队列进程终止并重新启动。可以使用<code class="codeph">DBMS_AQADM.VERIFY_QUEUE_TYPES</code>随时重新验证队列类型。</p>
                     <div class="infoboxnote" id="GUID-D506C8D1-91AC-4DA8-A5D7-0C37611459AF__GUID-D66FAF3A-1233-4B87-97B3-1A61C3C4EA13">
                        <p class="notep1">注意：</p>
                        <p>在队列到队列传播中检测到类型不匹配时，传播将停止并引发错误。在这种情况下，您必须查询<code class="codeph">DBA_SCHEDULES</code>视图以确定在传播到特定目标期间发生的最后一个错误。邮件未标记为<code class="codeph">UNDELIVERABLE</code> 。</p>
                     </div>
                  </div>
               </div>
            </div><a id="ADQUE2933"></a><div class="props_rev_3"><a id="GUID-B91F9B8D-0600-47AC-ABE2-F984676B5DFB" name="GUID-B91F9B8D-0600-47AC-ABE2-F984676B5DFB"></a><h3 id="ADQUE-GUID-B91F9B8D-0600-47AC-ABE2-F984676B5DFB" class="sect3"><span class="enumeration_section">11.9</span>使用JMS AQ进行消息转换</h3>
               <div>
                  <p>可以定义<a href="glossary.html#GUID-A668A987-B1D3-4330-97FD-0589DB780225"><span class="xrefglossterm">转换</span></a>以将一种格式的消息映射到另一种格式。当必须集成使用不同格式表示相同信息的应用程序时，转换很有用。转换可以是SQL表达式和PL / SQL函数。消息转换是标准JMS接口的Oracle数据库高级队列扩展。
                  </p>
                  <p>可以使用<code class="codeph">DBMS_TRANSFORM.create_transformation</code>过程创建转换。可以为以下操作指定转换：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>将消息发送到队列或主题</p>
                     </li>
                     <li>
                        <p>从队列或主题接收消息</p>
                     </li>
                     <li>
                        <p>创建<code class="codeph">TopicSubscriber</code></p>
                     </li>
                     <li>
                        <p>创建<code class="codeph">RemoteSubscriber</code> 。这使得能够在不同格式的主题之间传播消息。
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-B91F9B8D-0600-47AC-ABE2-F984676B5DFB__GUID-AD3C4234-D802-42FF-B89D-D21B5EE57A1E">
                     <p class="notep1">注意：</p>
                     <p>JMS Sharded Queues不支持消息转换。</p>
                  </div>
               </div>
            </div><a id="ADQUE3688"></a><div class="props_rev_3"><a id="GUID-3C01DF53-88AE-4A33-986A-5C259230491F" name="GUID-3C01DF53-88AE-4A33-986A-5C259230491F"></a><h3 id="ADQUE-GUID-3C01DF53-88AE-4A33-986A-5C259230491F" class="sect3"><span class="enumeration_section">11.10</span> JMS Streaming</h3>
               <div>
                  <p>AQ JMS支持通过<code class="codeph">AQjmsBytesMessage</code>和<code class="codeph">AQjmsStreamMessage</code>对分片队列进行<code class="codeph">AQjmsBytesMessage</code>队和出队，以便应用程序发送和接收大型消息数据或有效负载。
                  </p>
                  <p>通过将消息有效负载分成小块而不是发送或接收大的连续字节数组，JMS流在处理大消息时减少了内存需求。由于JMS标准没有任何流机制，AQ JMS将提供专有接口来公开AQ流入队和出队功能。这允许用户容易地使用现有的Java输入输出流来发送和接收消息数据或有效载荷。</p>
                  <p>为了允许现有应用程序在没有任何更改将数据库升级到RDBMS 12.2的情况下工作，默认情况下将禁用流式API。</p>
                  <p>客户端应用程序可以使用系统属性<code class="codeph">oracle.jms.useJmsStreaming</code>设置为<code class="codeph">true</code>来启用JMS Streaming。
                  </p>
                  <div class="infoboxnote" id="GUID-3C01DF53-88AE-4A33-986A-5C259230491F__GUID-2C0BC6CA-07E2-4402-AFC6-7B48E0527BE7">
                     <p class="notep1">注意：</p>
                     <p>仅支持瘦驱动程序JMS Streaming。</p>
                  </div>
               </div><a id="ADQUE3689"></a><div class="props_rev_3"><a id="GUID-4920395C-1DD7-41DB-92BA-13273513DEDA" name="GUID-4920395C-1DD7-41DB-92BA-13273513DEDA"></a><h4 id="ADQUE-GUID-4920395C-1DD7-41DB-92BA-13273513DEDA" class="sect4"><span class="enumeration_section">11.10.1带入队的</span> JMS流式传输</h4>
                  <div>
                     <p>AQ JMS提供了新的API <code class="codeph">setInputStream(java.io.在<code class="codeph">AQjmsBytesMessage</code>和<code class="codeph">AQjmsStreamMessage</code> InputStream)</code> ，为消息数据设置输入流。
                     </p><pre class="oac_no_warn" dir="ltr">/ ** * @param inputStream  - 用于读取消息有效负载的InputStream * @throws JMSException  - 如果提供的JMS由于*某些内部错误而无法读取有效负载* / public void setInputStream（InputStream inputStream）抛出JMSException</pre><p>以下代码段创建<code class="codeph">AQjmsBytesMessage</code>类型的消息，并为消息数据设置<code class="codeph">FileInputStream</code> 。
                     </p><pre class="oac_no_warn" dir="ltr">Session session = connection.createSession（false，Session。CLIENT_ACKNOWLEDGE）;目的地目的地= session.createQueue（“queueName”）; MessageProducer producer = session.createProducer（destination）; AQjmsBytesMessage bytesMessage =（AQjmsBytesMessage）session.createBytesMessage（）; InputStream input = new FileInputStream（“somefile.data”）; bytesMessage.setInputStream（输入）; producer.send（bytesMessage）;</pre><div class="infoboxnote" id="GUID-4920395C-1DD7-41DB-92BA-13273513DEDA__GUID-05D4169F-5852-4060-AFD9-96BB512F10E8">
                        <p class="notep1">注意：</p>
                        <p></p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>在这些方法<code class="codeph">BytesMessage</code>和<code class="codeph">StreamMessage</code>是基于发现的方法<code class="codeph">java.io.DataInputStream</code>和<code class="codeph">java.io.DataOutputStream</code> ，因此，流式传输无法实现各种<code class="codeph">read*()</code>和<code class="codeph">write*()</code>方法的有意义转换。以下方案将导致异常：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p><code class="codeph">bytesMessage.setInputStream（输入）;</code></p>
                                    <p><code class="codeph">bytesMessage.writeInt（99）;</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">bytesMessage.writeInt（99）;</code></p>
                                    <p><code class="codeph">bytesMessage.setInputStream（输入）;</code></p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>与正常的入队操作一样，带有流的入队将是同步的，只有在入队完成后我们才会将控制返回给客户端。</p>
                           </li>
                           <li>
                              <p>仅当客户端明确使用这些API时，流才会与enqueue一起使用。无论消息数据的大小如何，AQ JMS都不会使用带有正常入队队列的流式传输。</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="ADQUE3690"></a><div class="props_rev_3"><a id="GUID-887FA744-B586-4EB8-87FC-E49F9B59E961" name="GUID-887FA744-B586-4EB8-87FC-E49F9B59E961"></a><h4 id="ADQUE-GUID-887FA744-B586-4EB8-87FC-E49F9B59E961" class="sect4"><span class="enumeration_section">11.10.2</span>使用Dequeue进行JMS流式传输</h4>
                  <div>
                     <p>具有流传输的出队操作分两步完成。服务器根据邮件正文的大小决定是否流式传输邮件正文。默认阈值限制为10 MB。因此，当消息体大于10MB并且客户端使用系统属性oracle.jms.useJmsStreaming启用流式传输时，服务器将使用带有dequeue的流式传输。</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>这是客户端调用<code class="codeph">receive()</code>方法的正常出队过程。
                           </p><pre class="oac_no_warn" dir="ltr">目的地目的地= session.createQueue（“queueName”）; AQjmsConsumer consumer =（AQjmsConsumer）session.createConsumer（destination）;消息消息= consumer.receive（10000）;</pre></li>
                        <li>
                           <p>当客户端收到没有有效负载的消息时，客户端可以通过在接收到的消息上调用<code class="codeph">isLargeBody()</code>来确定流是否用于出队。
                           </p><pre class="oac_no_warn" dir="ltr">/ ** *客户端应用程序可以使用此方法来检查消息*是否包含大型messaege主体，因此需要使用dequeue进行流式传输。* * @return当消息体很大并且服务器决定使用dequeue * / public boolean isLargeBody（）来流*有效负载时返回true</pre><p><code class="codeph">isLargeBody()</code>返回的值true表示使用dequeue进行流式处理。当dequeue使用流式传输时，AQ JMS将为<code class="codeph">AQjmsStreamMessage</code>和<code class="codeph">AQjmsBytesMessage</code>正确填充消息体的长度。因此，客户端应用程序可以调用消息上的<code class="codeph">getBodyLength()</code>来确定有效负载的大小。
                           </p><pre class="oac_no_warn" dir="ltr">public long getBodyLength（）</pre></li>
                     </ul>
                     <p>一旦客户端了解了带队列的流式传输，就可以通过在接收到的消息上使用以下API之一来获取消息数据。</p>
                     <p>客户端应用程序可以使用<code class="codeph">AQjmsBytesMessage</code>和<code class="codeph">AQjmsStreamMessage</code>提供的以下API来接收消息数据。
                     </p><pre class="oac_no_warn" dir="ltr">/ ** *将消息体写入指定的OutputStream。* * @param outputStream  - 可以写入消息体的OutputStream * @return包含消息体的OutputStream。* @throws JMSException  - 如果提供的JMS由于某些内部错误而无法接收消息体* / public OutputStream getBody（OutputStream outputStream）抛出JMSException / ** *将消息体写入指定的OutputStream，并写入chunkSize字节*一次。* * @param outputStream  - 可以写入消息体的OutputStream * @param chunkSize  - 一次写入的字节数，默认值* 8192（即。8KB）* @return包含消息体的OutputStream。* @throws JMSException  - 如果提供的JMS由于某些内部错误而无法接收消息体* * public OutputStream getBody（OutputStream outputStream，int chunkSize）抛出JMSException / ** *将消息体写入指定的OutputStream。此方法等待，直到*消息正文完全写入OutputStream或超时到期。* *超时零永不过期，忽略负值超时。* * @param outputStream  - 可以写入消息体的OutputStream * @param timeout  - 超时值（以毫秒为单位）* @return包含消息体的OutputStream。* @throws JMSException  - 如果提供的JMS由于某些内部错误而无法接收消息体* * / public OutputStream getBody（OutputStream outputStream，long timeout）抛出JMSException / ** *将消息体写入指定的OutputStream，chunkSize字节一次。*此方法等待消息正文完全写入OutputStream *或超时到期。* *超时零永不过期，忽略负值超时。* * @param outputStream  - 可以写入消息体的OutputStream * @param chunkSize  - 一次写入的字节数，*默认值8192（即。8KB）* @param timeout  - 超时值（以毫秒为单位）* @return包含消息体的OutputStream。* @throws JMSException  - 如果由于某些内部错误* / public OutputStream getBody（OutputStream outputStream，int chunkSize，long timeout）提供的JMS无法接收消息体*，则抛出JMSException</pre><p>以下代码片段检查流是否与出队一起使用，并且接收的有效负载将写入<code class="codeph">FileOutputStream</code> 。
                     </p><pre class="oac_no_warn" dir="ltr">if（message instanceof BytesMessage &amp;&amp;（AQjmsBytesMessage）message.isLargeBody（））{//可选：检查有效负载的大小，并在//接收有效负载之前采取适当的措施。（AQjmsBytesMessage）message.getBody（new FileOutputStream（new File（“...”）））; } else {// normal dequeue}</pre><p>通常，当两个步骤都完成时，消息被视为完全消耗。AQ服务器在步骤1之后保持对消息的锁定，该消息仅在步骤2之后释放。</p>
                     <p>考虑到消息使用者部分消费消息可能存在的问题，我们使用确认模式<code class="codeph">CLIENT_ACKNOWLEDGE</code>和<code class="codeph">SESSION_TRANSACTED</code>限制了会话的Streaming API。</p>
                     <p>因此，在以下情况下，所有消息（包括部分消</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>使用<code class="codeph">CLIENT_ACKNOWLEDGE</code>会话调用<code class="codeph">message.acknowledge()</code> 。
                           </p>
                        </li>
                        <li>
                           <p>会话的<code class="codeph">commit()</code>在事务会话中调用。
                           </p>
                        </li>
                     </ul>
                     <p>与正常情况一样，会话<code class="codeph">rollback()</code>在该会话中收到的消息。
                     </p>
                     <p>JMS Streaming具有以下限制：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>默认情况下禁用流，并且可以使用系统属性<code class="codeph">oracle.jms.useJmsStreaming</code>由客户端应用程序启用流</p>
                        </li>
                        <li>
                           <p>当消息数据的大小大于阈值时，Dequeue使用流式传输。默认阈值为10 MB。</p>
                        </li>
                        <li>
                           <p><code class="codeph">AQjmsBytesMessage</code>和<code class="codeph">AQjmsStreamMessage</code>提供流支持</p>
                        </li>
                        <li>
                           <p>流支持仅适用于分片队列</p>
                        </li>
                        <li>
                           <p>流媒体支持仅适用于瘦驱动程序</p>
                        </li>
                        <li>
                           <p>当消息生产者使用消息传递模式为<code class="codeph">NON_PERSISTENT</code>时，流支持不可用</p>
                        </li>
                        <li>
                           <p>消息侦听器不支持流式传输。因此，当MessageConsumer设置了消息监听器并且消息数据超过阈值限制时，我们将在内部使用正常的dequeue。</p>
                        </li>
                        <li>
                           <p>使用确认模式<code class="codeph">CLIENT_ACKNOWLEDGE</code>和<code class="codeph">SESSION_TRANSACTED</code> ，Sessions可以使用流支持。</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ADQUE2934"></a><div class="props_rev_2"><a id="GUID-7D8D9257-574D-4378-B580-DA656D2F0511" name="GUID-7D8D9257-574D-4378-B580-DA656D2F0511"></a><h3 id="ADQUE-GUID-7D8D9257-574D-4378-B580-DA656D2F0511" class="sect3"><span class="enumeration_section">11.11</span> Java EE合规性</h3>
               <div>
                  <p>Oracle JMS符合Oracle Sun Microsystems JMS 1.1标准。您可以在运行时为<a href="glossary.html#GUID-9885B911-8AC1-49F3-922E-1F8D64C4501D"><span class="xrefglossterm">Oracle Java消息服务</span></a> （Oracle JMS）客户端定义Java EE合规性模式。要获得合规性，请将Java属性<code class="codeph">oracle.jms.j2eeCompliant</code>设置为<code class="codeph">TRUE</code>作为命令行选项。对于不合规，什么都不做。<code class="codeph">FALSE</code>是默认值。
                  </p>
                  <p>支持Java EE合规性的Oracle数据库高级队列中的功能（并且在非兼容模式下也可用）包括：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>非交易会话</p>
                     </li>
                     <li>
                        <p>持久的订阅者</p>
                     </li>
                     <li>
                        <p>临时队列和主题</p>
                     </li>
                     <li>
                        <p>非持续交付模式</p>
                     </li>
                     <li>
                        <p>单个JMS <a href="glossary.html#GUID-583DEF67-C9BC-4B83-B8DC-2375A5BE08BB"><span class="xrefglossterm">队列</span></a>或主题上的多个JMS消息类型（使用<code class="codeph">AQ$_JMS_MESSAGE</code>类型的Oracle数据库高级队列队列）</p>
                     </li>
                     <li>
                        <p>持久订阅者的<code class="codeph">noLocal</code>选项</p>
                     </li>
                     <li>
                        <p>JMS Sharded Queues具有本机JMS支持并符合Java EE合规性</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-7D8D9257-574D-4378-B580-DA656D2F0511__GUID-7C96F334-84F3-461D-A0B7-D59490679665">
                     <p class="notep1">也可以看看：</p>
                     <p></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="italic">Java消息服务规范</span> ，版本1。1，2002年3月18日，Sun Microsystems，Inc。</p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="jms-introduction.html#GUID-ECCD89DD-CDB3-4455-AA9E-28ABA53488FC">JMS消息头</a> ”</span> ，了解有关Java属性<code class="codeph">oracle.jms.j2eeCompliant</code>如何影响JMSPriority和JMSExpiration的信息</p>
                        </li>
                        <li>
                           <p><span class="q">“ <a href="jms-introduction.html#GUID-4E251F18-4AC4-46E3-A6A2-F9A89BE978B5">DurableSubscriber</a> ”</span>获取有关Java属性<code class="codeph">oracle.jms.j2eeCompliant</code>如何影响持久订阅者的信息</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>