<html lang="en-us" dir="ltr" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="abstract" content="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB)."></meta>
      <meta name="description" content="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB)."></meta>
      <title>将Oracle Scheduler与CDB一起使用</title>
      <meta property="og:site_name" content="Oracle Help Center"></meta>
      <meta property="og:title" content="Administrator’s Guide "></meta>
      <meta property="og:description" content="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB)."></meta>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css"></link>
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico"></link>
      <meta name="application-name" content="Administrator’s Guide"></meta>
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)"></meta>
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2"></meta>
      <link rel="alternate" href="multitenant-administrators-guide.pdf" title="PDF File" type="application/pdf"></link>
      <meta name="robots" content="all"></meta>
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/"></link>
      <meta name="dcterms.created" content="2019-03-20T09:59:22-07:00"></meta>
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2019"></meta>
      <meta name="dcterms.category" content="database"></meta>
      <meta name="dcterms.identifier" content="E96136-03"></meta>
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19"></meta>
      
      <link rel="prev" href="using-oracle-resource-manager-for-pdbs-with-sql-plus.html" title="Previous" type="text/html"></link>
      <link rel="next" href="using-oracle-database-vault-with-a-cdb.html" title="Next" type="text/html"></link>
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script src="/sp_common/book-template/requirejs/require.js" data-main="/sp_common/book-template/ohc-book-template/js/book-config"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Multitenant Administrator&#39;s Guide"></meta>
    <meta name="dcterms.isVersionOf" content="MULTI"></meta>
    <meta name="dcterms.release" content="Release 19"></meta>
  </head>
   <body dir="ltr">
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-oracle-resource-manager-for-pdbs-with-sql-plus.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一页</a> <a href="using-oracle-database-vault-with-a-cdb.html" class="pull-right">下一页<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">管理员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="using-oracle-features-in-a-multitenant-environment.html" property="item" typeof="WebPage"><span property="name">在多租户环境中使用Oracle功能</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">将Oracle Scheduler与CDB一起使用</li>
            </ol>
            <a id="GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" name="GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554"></a><a id="ADMIN13888"></a>
            
            <h2 id="MULTI-GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" class="sect2"><span class="enumeration_chapter">23</span>将Oracle Scheduler与CDB一起使用</h2>
         </header>
         <div class="ind">
            <div>
               <p>您可以使用Oracle Scheduler在多租户容器数据库（CDB）中计划作业。</p>
               <p>在将Oracle Scheduler与CDB一起使用之前，请满足以下要求：</p>
               <ul style="list-style-type:disc">
                  <li>
                     <p>您了解如何配置和管理CDB。</p>
                  </li>
                  <li>
                     <p>您了解如何使用Oracle Scheduler在非CDB中计划作业。</p>
                  </li>
               </ul>
               <p>本章包含以下主题：</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-oracle-scheduler-with-a-cdb.html#GUID-997A97BA-765B-46EA-90C1-0656E86C1967">DBMS_SCHEDULER CDB中的调用</a><br>除了两个调度程序全局属性之外，大多数调度程序调用的工作方式与在非CDB中的调用方式相同。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-scheduler-with-a-cdb.html#GUID-BB55E3D0-E9D0-4A47-A5FF-C9E6D4D195F9">CDB中的工作协调员和奴隶程序</a><br>与CDB相关的主要变化是工作协调员流程。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-scheduler-with-a-cdb.html#GUID-1089C97D-A3BF-48FC-92F7-0992C632124F">DBMS_JOB和DBMS_SCHEDULER</a><br>仅当您向提交<code class="codeph">DBMS_JOB</code>作业的模式授予<code class="codeph">CREATE JOB</code>特权时，才能在PDB中使用<code class="codeph">DBMS_JOB</code> 。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-scheduler-with-a-cdb.html#GUID-4EABC5E2-765C-418E-B889-A59538118E9D">关闭PDB的过程</a><br>如果使用immediate选项关闭PDB，则协调器将终止在PDB中运行的作业，并且必须先恢复作业，然后才能再次运行。
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-scheduler-with-a-cdb.html#GUID-FD194174-7E62-4825-A988-EDB944F4D6CF">新的和更改的CDB视图</a><br>一些CDB视图特定于CDB，而其他视图具有CDB特定列。
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554__GUID-012F234F-F8C5-4A41-842F-5CD34058CF48">
                  <p class="notep1">也可以看看：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><span class="q">“ <a href="managing-a-multitenant-environment.html#GUID-93F1E584-D309-4301-82E0-AD0E60D4977C" title="您可以使用SQL * Plus或企业管理器云控制（云控制）管理多租户环境。">管理多租户环境</a> ”</span></p>
                     </li>
                     <li>
                        <p><a href="../admin/oracle-scheduler-concepts.html#ADMIN-GUID-6B8C0335-D36B-44D3-95BC-82FA2141D967" target="_blank"><span><cite>Oracle数据库管理员指南</cite></span></a></p>
                     </li>
                  </ul>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>父主题：</strong> <a href="using-oracle-features-in-a-multitenant-environment.html#GUID-CE922DAA-66FB-430B-96E5-29FF50BFD2FF" title="您可以在多租户环境中使用Oracle数据库功能。">在多租户环境中使用Oracle功能</a></p>
                  </div>
               </div>
            </div>
            <a id="ADMIN13889"></a><div class="props_rev_3"><a id="GUID-997A97BA-765B-46EA-90C1-0656E86C1967" name="GUID-997A97BA-765B-46EA-90C1-0656E86C1967"></a><h3 id="MULTI-GUID-997A97BA-765B-46EA-90C1-0656E86C1967" class="sect3"><span class="enumeration_section">23.1</span> CDB中的DBMS_SCHEDULER调用</h3>
               <div>
                  <p>除了两个调度程序全局属性之外，大多数调度程序调用的工作方式与在非CDB中的调用方式相同。</p>
                  <p><code class="codeph">JOB_QUEUE_PROCESSES</code>初始化参数指定可以为执行<code class="codeph">DBMS_JOB</code>作业和Oracle Scheduler（ <code class="codeph">DBMS_SCHEDULER</code> ）作业创建的每个实例的最大作业从站数。值的范围是<code class="codeph">0</code>到<code class="codeph">4000</code> （默认值）。
                  </p>
                  <p>要限制CDB环境中的作业从站，可以在以下位置设置<code class="codeph">JOB_QUEUE_PROCESSES</code> ：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>CDB根</p>
                        <p>将<code class="codeph">JOB_QUEUE_PROCESSES</code>设置为Scheduler可以在整个数据库实例中同时使用的最大从属进程数。
                        </p>
                        <p>如果CDB根目录中的<code class="codeph">JOB_QUEUE_PROCESSES</code>为<code class="codeph">0</code> ，则无论PDB级别的<code class="codeph">JOB_QUEUE_PROCESSES</code>设置如何， <code class="codeph">DBMS_JOB</code>和Oracle Scheduler作业都无法在根或任何PDB中运行。
                        </p>
                     </li>
                     <li>
                        <p>PDB</p>
                        <p>将<code class="codeph">JOB_QUEUE_PROCESSES</code>设置为此PDB的最大并发作业数。实际数量取决于资源管理器分配的资源以及其他容器中的需求。当多个PDB请求作业时，Oracle Scheduler会尝试为所有PDB提供公平的进程份额。
                        </p>
                        <p>如果PDB中的<code class="codeph">JOB_QUEUE_PROCESSES</code>为<code class="codeph">0</code> ，则无论CDB根目录中的<code class="codeph">JOB_QUEUE_PROCESSES</code>设置如何， <code class="codeph">DBMS_JOB</code>和Oracle Scheduler作业都无法在此PDB中运行。
                        </p>
                     </li>
                  </ul>
                  <p>您必须在PDB级别设置所有全局Oracle Scheduler属性。例如，如果使用<code class="codeph">DBMS_SCHEDULER.SET_ATTRIBUTE</code>在根数据库中设置<code class="codeph">EMAIL_SENDER</code>属性，则它将应用于在根中运行的作业，而不是在特定PDB中运行的作业。如果为PDB选择新的<code class="codeph">EMAIL_SENDER</code> ，则必须在此PDB中设置全局属性。</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-997A97BA-765B-46EA-90C1-0656E86C1967__GUID-BC155438-939A-4562-A51A-B86716D91CD0">
                     <p class="notep1">也可以看看：</p>
                     <p><a href="../refrn/JOB_QUEUE_PROCESSES.html#GUID-B8B68D16-00A3-43DD-BE39-01F877880955" target="_blank"><span><cite>Oracle Database Reference</cite></span></a>了解有关<code class="codeph">JOB_QUEUE_PROCESSES</code>更多信息</p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-scheduler-with-a-cdb.html#GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" title="您可以使用Oracle Scheduler在多租户容器数据库（CDB）中计划作业。">将Oracle Scheduler与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13890"></a><div class="props_rev_3"><a id="GUID-BB55E3D0-E9D0-4A47-A5FF-C9E6D4D195F9" name="GUID-BB55E3D0-E9D0-4A47-A5FF-C9E6D4D195F9"></a><h3 id="MULTI-GUID-BB55E3D0-E9D0-4A47-A5FF-C9E6D4D195F9" class="sect3"><span class="enumeration_section">23.2</span> CDB中的工作协调员和从属流程</h3>
               <div>
                  <p>与CDB相关的主要变化是工作协调员流程。</p>
                  <p>在非CDB中，协调器查看准备运行的所有作业，选择要运行的子集，并将它们分配给作业从站。它还会打开和关闭窗口，这会更改对数据库有效的资源计划。</p>
                  <p>这基本上是CDB内部发生的事情，除了以下情况：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>从所有PDB中选择作业</p>
                        <p>协调器查看根数据库和所有子PDB，并根据作业优先级，作业计划开始时间以及运行作业的资源可用性选择作业。后一标准取决于工作的消费者群体和当前有效的资源计划。协调员不会试图对每个PDB公平。确保PDB中的作业不会缺乏的唯一方法是为其分配足够的资源。</p>
                     </li>
                     <li>
                        <p>Windows在PDB和根数据库级别中打开</p>
                        <p>在非CDB中，在任何给定时间只能打开一个窗口。在CDB中，有两个级别的窗口。在PDB级别，窗口可用于设置资源计划，该资源计划在属于该PDB的消费者组之间分配资源。在根数据库级别，Windows可以将资源分配给不同的PDB。因此，在任何时候，根数据库中都可以打开一个窗口，每个PDB中都有一个窗口。</p>
                     </li>
                     <li>
                        <p>作业从站切换到它所属的特定PDB</p>
                        <p>作业从属基本上与非CDB中的相同，除了当从属执行作业时，它切换到作业所属的PDB然后执行它。其余的代码基本上没有变化。</p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-scheduler-with-a-cdb.html#GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" title="您可以使用Oracle Scheduler在多租户容器数据库（CDB）中计划作业。">将Oracle Scheduler与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13891"></a><div class="props_rev_3"><a id="GUID-1089C97D-A3BF-48FC-92F7-0992C632124F" name="GUID-1089C97D-A3BF-48FC-92F7-0992C632124F"></a><h3 id="MULTI-GUID-1089C97D-A3BF-48FC-92F7-0992C632124F" class="sect3"><span class="enumeration_section">23.3</span> DBMS_JOB和DBMS_SCHEDULER</h3>
               <div>
                  <p>仅当您向提交<code class="codeph">DBMS_JOB</code>作业的模式授予<code class="codeph">CREATE JOB</code>特权时，才能在PDB中使用<code class="codeph">DBMS_JOB</code> 。
                  </p>
                  <p><code class="codeph">DBMS_JOB</code>接口使用<code class="codeph">DBMS_SCHEDULER</code>实现。因此，Oracle建议您从<code class="codeph">DBMS_JOB</code>切换到<code class="codeph">DBMS_SCHEDULER</code> 。</p>
                  <p>对于调度程序，协调器选择要从每个PDB运行的作业。此外，对于调度程序，从属进程在执行作业之前切换到PDB;否则，代码基本不变。</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-1089C97D-A3BF-48FC-92F7-0992C632124F__GUID-25E90CB0-D4B0-42A7-BB52-926103528BDB">
                     <p class="notep1">也可以看看：</p>
                     <p>有关支持<code class="codeph">DBMS_JOB</code>信息，请<code class="codeph">DBMS_JOB</code> <a href="../admin/support-for-DBMS_JOB.html#ADMIN-GUID-CC42E8DA-7203-449E-BCEA-8187ECC4BCDF" target="_blank"><span><cite>“Oracle数据库管理员指南”</cite></span></a></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-scheduler-with-a-cdb.html#GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" title="您可以使用Oracle Scheduler在多租户容器数据库（CDB）中计划作业。">将Oracle Scheduler与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13892"></a><div class="props_rev_3"><a id="GUID-4EABC5E2-765C-418E-B889-A59538118E9D" name="GUID-4EABC5E2-765C-418E-B889-A59538118E9D"></a><h3 id="MULTI-GUID-4EABC5E2-765C-418E-B889-A59538118E9D" class="sect3"><span class="enumeration_section">23.4</span>关闭PDB的过程</h3>
               <div>
                  <p>如果使用immediate选项关闭PDB，则协调器将终止在PDB中运行的作业，并且必须先恢复作业，然后才能再次运行。</p>
                  <p>在Oracle RAC数据库中，协调器在大多数情况下可以在该PDB处于打开状态的另一个实例上恢复作业。因此，如果第一个实例上的协调器可以找到PDB仍处于打开状态的另一个实例，则会将作业移动到那里。在某些情况下，可能无法将作业移动到另一个实例。例如，如果相关的PDB未在其他任何位置打开，则无法移动作业。此外，当作业设置了<code class="codeph">INSTANCE_ID</code>属性时，无法将作业移动到另一个实例。在这种情况下，作业无法运行，直到该实例上的PDB再次打开。
                  </p>
                  <p>在非Oracle RAC案例中，不会出现移动作业的问题。只有在再次打开PDB后才能恢复已终止的作业。</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-scheduler-with-a-cdb.html#GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" title="您可以使用Oracle Scheduler在多租户容器数据库（CDB）中计划作业。">将Oracle Scheduler与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13893"></a><div class="props_rev_3"><a id="GUID-FD194174-7E62-4825-A988-EDB944F4D6CF" name="GUID-FD194174-7E62-4825-A988-EDB944F4D6CF"></a><h3 id="MULTI-GUID-FD194174-7E62-4825-A988-EDB944F4D6CF" class="sect3"><span class="enumeration_section">23.5</span>新的和更改的CDB视图</h3>
               <div>
                  <p>一些CDB视图特定于CDB，而其他视图具有CDB特定列。</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><code class="codeph">V$</code>和<code class="codeph">GV$</code>视图有一个<code class="codeph">CON_ID</code>列，用于标识其数据由<code class="codeph">CDB_*</code>行表示的容器。在非CDB中， <code class="codeph">CON_ID</code> <code class="codeph">NULL</code> 。</p>
                     </li>
                     <li>
                        <p><code class="codeph">CDB_*</code>视图对应于所有Scheduler <code class="codeph">DBA_*</code>视图。
                        </p>
                        <p>在PDB中，这些视图仅显示通过相应<code class="codeph">DBA_*</code>视图可见的对象，但所有对象在根中都可见。<code class="codeph">CDB_*</code>视图包含在给定<code class="codeph">DBA_*</code>视图和列（ <code class="codeph">CON_ID</code> ）中找到的所有列。在非CDB中，此列为<code class="codeph">NULL</code> 。</p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>父主题：</strong> <a href="using-oracle-scheduler-with-a-cdb.html#GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" title="您可以使用Oracle Scheduler在多租户容器数据库（CDB）中计划作业。">将Oracle Scheduler与CDB一起使用</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>