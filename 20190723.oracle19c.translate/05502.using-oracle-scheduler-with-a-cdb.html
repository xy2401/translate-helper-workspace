<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB).">
      <meta name="description" content="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB).">
      <title>Using Oracle Scheduler with a CDB</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Administrator’s Guide ">
      <meta property="og:description" content="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB).">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Administrator’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="multitenant-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-20T09:59:22-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96136-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-oracle-resource-manager-for-pdbs-with-sql-plus.html" title="Previous" type="text/html">
      <link rel="next" href="using-oracle-database-vault-with-a-cdb.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Multitenant Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="MULTI">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-oracle-resource-manager-for-pdbs-with-sql-plus.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-oracle-database-vault-with-a-cdb.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Administrator’s Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="using-oracle-features-in-a-multitenant-environment.html" property="item" typeof="WebPage"><span property="name">Using Oracle Features in a Multitenant Environment</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Using Oracle Scheduler with a CDB</li>
            </ol>
            <a id="GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" name="GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554"></a><a id="ADMIN13888"></a>
            
            <h2 id="MULTI-GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" class="sect2"><span class="enumeration_chapter">23 </span> Using Oracle Scheduler with a CDB
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>You can use  Oracle Scheduler to schedule jobs in a multitenant container database (CDB).</p>
               <p>Before using Oracle Scheduler with a CDB, meet the following requirements:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p>You understand how to configure and manage a CDB.</p>
                  </li>
                  <li>
                     <p>You understand how to use Oracle Scheduler to schedule jobs in a non-CDB.</p>
                  </li>
               </ul>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-oracle-scheduler-with-a-cdb.html#GUID-997A97BA-765B-46EA-90C1-0656E86C1967">DBMS_SCHEDULER Invocations in a CDB</a><br>Most scheduler calls work the same way as they do in non-CDBs, except for two scheduler global attributes.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-scheduler-with-a-cdb.html#GUID-BB55E3D0-E9D0-4A47-A5FF-C9E6D4D195F9">Job Coordinator and Slave Processes in a CDB</a><br>The major CDB-related changes are to the job coordinator process.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-scheduler-with-a-cdb.html#GUID-1089C97D-A3BF-48FC-92F7-0992C632124F">DBMS_JOB and DBMS_SCHEDULER</a><br>You can use <code class="codeph">DBMS_JOB</code> within a PDB only if you grant the <code class="codeph">CREATE JOB</code> privilege to the schemas that submit <code class="codeph">DBMS_JOB</code> jobs.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-scheduler-with-a-cdb.html#GUID-4EABC5E2-765C-418E-B889-A59538118E9D">Processes to Close a PDB</a><br>If a PDB is closed with the immediate option, then the coordinator terminates jobs running in the PDB, and the jobs must be recovered before they can run again.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-scheduler-with-a-cdb.html#GUID-FD194174-7E62-4825-A988-EDB944F4D6CF">New and Changed CDB Views</a><br>Some CDB views are specific to CDBs, whereas others have a CDB-specific column.
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554__GUID-012F234F-F8C5-4A41-842F-5CD34058CF48">
                  <p class="notep1">See Also:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="q">"<a href="managing-a-multitenant-environment.html#GUID-93F1E584-D309-4301-82E0-AD0E60D4977C" title="You can administer a multitenant environment using SQL*Plus or Enterprise Manager Cloud Control (Cloud Control).">Administering a Multitenant Environment</a>"</span></p>
                     </li>
                     <li>
                        <p><a href="../admin/oracle-scheduler-concepts.html#ADMIN-GUID-6B8C0335-D36B-44D3-95BC-82FA2141D967" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a></p>
                     </li>
                  </ul>
               </div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="using-oracle-features-in-a-multitenant-environment.html#GUID-CE922DAA-66FB-430B-96E5-29FF50BFD2FF" title="You can use Oracle Database features in a multitenant environment.">Using Oracle Features in a Multitenant Environment</a></p>
                  </div>
               </div>
            </div>
            <a id="ADMIN13889"></a><div class="props_rev_3"><a id="GUID-997A97BA-765B-46EA-90C1-0656E86C1967" name="GUID-997A97BA-765B-46EA-90C1-0656E86C1967"></a><h3 id="MULTI-GUID-997A97BA-765B-46EA-90C1-0656E86C1967" class="sect3"><span class="enumeration_section">23.1 </span>DBMS_SCHEDULER Invocations in a CDB
               </h3>
               <div>
                  <p>Most scheduler calls work the same way as they do in non-CDBs, except for two scheduler global attributes.</p>
                  <p>The <code class="codeph">JOB_QUEUE_PROCESSES</code> initialization parameter specifies the maximum number of job slaves per instance that can be created for the execution of <code class="codeph">DBMS_JOB</code> jobs and Oracle Scheduler (<code class="codeph">DBMS_SCHEDULER</code>) jobs. The range of values is <code class="codeph">0</code> to <code class="codeph">4000</code> (default).
                  </p>
                  <p>To limit job slaves in a CDB environment, you can set <code class="codeph">JOB_QUEUE_PROCESSES</code> in the following locations:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>CDB root</p>
                        <p>Set <code class="codeph">JOB_QUEUE_PROCESSES</code> to the maximum number of slave processes that Scheduler can use simultaneously in the entire database instance. 
                        </p>
                        <p>If <code class="codeph">JOB_QUEUE_PROCESSES</code> is <code class="codeph">0</code> in the CDB root, then <code class="codeph">DBMS_JOB</code> and Oracle Scheduler jobs cannot run in the root or any PDB, regardless of&nbsp;the <code class="codeph">JOB_QUEUE_PROCESSES</code> setting at the PDB level.
                        </p>
                     </li>
                     <li>
                        <p>PDB</p>
                        <p>Set <code class="codeph">JOB_QUEUE_PROCESSES</code> to the maximum number of simultaneous jobs for this PDB. The actual number depends on the resources assigned by Resource Manager and the demand in other containers. When multiple PDBs request jobs, Oracle Scheduler attempts to give all PDBs a fair share of the processes.
                        </p>
                        <p>If <code class="codeph">JOB_QUEUE_PROCESSES</code> is <code class="codeph">0</code> in a PDB, then <code class="codeph">DBMS_JOB</code> and Oracle Scheduler jobs cannot run in this PDB, regardless of&nbsp;the <code class="codeph">JOB_QUEUE_PROCESSES</code> setting in the CDB root.
                        </p>
                     </li>
                  </ul>
                  <p>You must set all global Oracle Scheduler attributes at the PDB level. For example, if you set the <code class="codeph">EMAIL_SENDER</code> attribute in the root database using <code class="codeph">DBMS_SCHEDULER.SET_ATTRIBUTE</code>, then it applies to the jobs that run in the root, not the jobs running in a specific PDB. If you choose a new <code class="codeph">EMAIL_SENDER</code> for a PDB, then you must set the global attribute in this PDB.
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-997A97BA-765B-46EA-90C1-0656E86C1967__GUID-BC155438-939A-4562-A51A-B86716D91CD0">
                     <p class="notep1">See Also:</p>
                     <p><a href="../refrn/JOB_QUEUE_PROCESSES.html#GUID-B8B68D16-00A3-43DD-BE39-01F877880955" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn more about <code class="codeph">JOB_QUEUE_PROCESSES</code></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-scheduler-with-a-cdb.html#GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" title="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB).">Using Oracle Scheduler with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13890"></a><div class="props_rev_3"><a id="GUID-BB55E3D0-E9D0-4A47-A5FF-C9E6D4D195F9" name="GUID-BB55E3D0-E9D0-4A47-A5FF-C9E6D4D195F9"></a><h3 id="MULTI-GUID-BB55E3D0-E9D0-4A47-A5FF-C9E6D4D195F9" class="sect3"><span class="enumeration_section">23.2 </span>Job Coordinator and Slave Processes in a CDB
               </h3>
               <div>
                  <p>The major CDB-related changes are to the job coordinator process.</p>
                  <p>In a non-CDB, the coordinator looks at all jobs that are ready to run, picks a subset of them to run, and assigns them to job slaves. It also opens and closes windows, which changes the resource plan in effect for the database.</p>
                  <p>That is essentially what happens inside a CDB except for the following:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Jobs are selected from all PDBs</p>
                        <p>The coordinator looks at the root database and all the child PDBs and selects jobs based on the job priority, the job scheduled start time, and the availability of resources to run the job. The latter criterion depends on the consumer group of the job and the resource plan currently in effect. The coordinator makes no attempt to be fair to every PDB. The only way to ensure that jobs from a PDB are not starved is to allocate enough resources to it.</p>
                     </li>
                     <li>
                        <p>Windows are open in the PDB and root database levels </p>
                        <p>In a non-CDB, only one window can be open at any given time. In a CDB, there are two levels of windows. At the PDB level, windows can be used to set resource plans that allocate resources among consumer groups belonging to that PDB. At the root database level, windows can allocate resources to different PDBs. Therefore, at any time, there can be a window open in the root database and one in each PDB.</p>
                     </li>
                     <li>
                        <p>Job slave switches to the specific PDB it belongs to</p>
                        <p>The job slaves are essentially the same as in a non-CDB, except that when a slave executes a job, it switches to the PDB that the job belongs to and then executes it. The rest of the code is essentially unchanged.</p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-scheduler-with-a-cdb.html#GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" title="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB).">Using Oracle Scheduler with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13891"></a><div class="props_rev_3"><a id="GUID-1089C97D-A3BF-48FC-92F7-0992C632124F" name="GUID-1089C97D-A3BF-48FC-92F7-0992C632124F"></a><h3 id="MULTI-GUID-1089C97D-A3BF-48FC-92F7-0992C632124F" class="sect3"><span class="enumeration_section">23.3 </span>DBMS_JOB and DBMS_SCHEDULER
               </h3>
               <div>
                  <p>You can use <code class="codeph">DBMS_JOB</code> within a PDB only if you grant the <code class="codeph">CREATE JOB</code> privilege to the schemas that submit <code class="codeph">DBMS_JOB</code> jobs.
                  </p>
                  <p>The <code class="codeph">DBMS_JOB</code> interface is implemented using <code class="codeph">DBMS_SCHEDULER</code>. For this reason, Oracle recommends that you switch from <code class="codeph">DBMS_JOB</code> to <code class="codeph">DBMS_SCHEDULER</code>.
                  </p>
                  <p>For the scheduler, the coordinator selects jobs to run from every PDB. Also, for the scheduler, the slave process switches into a PDB before executing a job; otherwise, the code is essentially unchanged.</p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-1089C97D-A3BF-48FC-92F7-0992C632124F__GUID-25E90CB0-D4B0-42A7-BB52-926103528BDB">
                     <p class="notep1">See Also:</p>
                     <p><a href="../admin/support-for-DBMS_JOB.html#ADMIN-GUID-CC42E8DA-7203-449E-BCEA-8187ECC4BCDF" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> for information about support for <code class="codeph">DBMS_JOB</code></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-scheduler-with-a-cdb.html#GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" title="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB).">Using Oracle Scheduler with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13892"></a><div class="props_rev_3"><a id="GUID-4EABC5E2-765C-418E-B889-A59538118E9D" name="GUID-4EABC5E2-765C-418E-B889-A59538118E9D"></a><h3 id="MULTI-GUID-4EABC5E2-765C-418E-B889-A59538118E9D" class="sect3"><span class="enumeration_section">23.4 </span>Processes to Close a PDB
               </h3>
               <div>
                  <p>If a PDB is closed with the immediate option, then the coordinator terminates jobs running in the PDB, and the jobs must be recovered before they can run again.</p>
                  <p>In an Oracle RAC database, the coordinator can, in most cases, recover the jobs on another instance where that PDB is open. So, if the coordinator on the first instance can find another instance where the PDB is still open, it moves the jobs there. In certain cases, moving the jobs to another instance may not be possible. For example, if the PDB in question is not open anywhere else, the jobs cannot be moved. Also, moving a job to another instance is not possible when the job has the <code class="codeph">INSTANCE_ID</code> attribute set. In this case the job cannot run until the PDB on that instance is open again.
                  </p>
                  <p>In a non-Oracle RAC case, the question of moving jobs does not arise. Terminated jobs can only be recovered after the PDB is opened again.</p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-scheduler-with-a-cdb.html#GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" title="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB).">Using Oracle Scheduler with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="ADMIN13893"></a><div class="props_rev_3"><a id="GUID-FD194174-7E62-4825-A988-EDB944F4D6CF" name="GUID-FD194174-7E62-4825-A988-EDB944F4D6CF"></a><h3 id="MULTI-GUID-FD194174-7E62-4825-A988-EDB944F4D6CF" class="sect3"><span class="enumeration_section">23.5 </span>New and Changed CDB Views
               </h3>
               <div>
                  <p>Some CDB views are specific to CDBs, whereas others have a CDB-specific column.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">V$</code> and <code class="codeph">GV$</code> views have a <code class="codeph">CON_ID</code> column that identifies a container whose data is represented by a <code class="codeph">CDB_*</code> row. In non-CDBs, the <code class="codeph">CON_ID</code> column is <code class="codeph">NULL</code>.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">CDB_*</code> views correspond to all Scheduler <code class="codeph">DBA_*</code> views.
                        </p>
                        <p>In a PDB, these views only show objects visible through a corresponding <code class="codeph">DBA_*</code> view, but all objects are visible in the root. The <code class="codeph">CDB_*</code> view contains all columns found in a given <code class="codeph">DBA_*</code> view and the column (<code class="codeph">CON_ID</code>). In non-CDBs, this column is <code class="codeph">NULL</code>.
                        </p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-scheduler-with-a-cdb.html#GUID-5BD1ACC9-D10D-4573-860F-5F8A65AE8554" title="You can use Oracle Scheduler to schedule jobs in a multitenant container database (CDB).">Using Oracle Scheduler with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>